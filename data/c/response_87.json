[{"tags": ["c", "for-loop", "format"], "comments": [{"owner": {"reputation": 1577, "user_id": 6776535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c515e458c92c554943b271a6789f0372?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Pr&#233;vost", "link": "https://stackoverflow.com/users/6776535/robert-pr%c3%a9vost"}, "edited": false, "score": 0, "creation_date": 1473291231, "post_id": 39380364, "comment_id": 66088750, "body": "It looks like you&#39;re using scanf incorrectly.  Right now it is trying to read a format specified by nums[i] into no variables.  Also, the comparison between i and nums is incorrect."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473292132, "post_id": 39380364, "comment_id": 66088982, "body": "You haven&#39;t allocated any space for <code>nums[i]</code>, so you&#39;re causing undefined behavior."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473292486, "creation_date": 1473292486, "answer_id": 39380615, "question_id": 39380364, "link": "https://stackoverflow.com/questions/39380364/input-to-array-of-strings-wont-show/39380615#39380615", "title": "Input to array of strings won&#39;t show?", "body": "<p>You have an array of 400 pointers, but you've never initialized them. Instead, you could declare a 2-dimension array:</p>\n\n<pre><code>char nums[400][4];\n</code></pre>\n\n<p>Then you're trying to use <code>nums</code> as a limit to the <code>for</code> loop. What you actually want is the number of elements in <code>nums</code>, which is <code>sizeof(nums)/sizeof(nums[0])</code>; or you could define a macro that specifies the size of the array.</p>\n\n<p>Next, you left out the format string argument to <code>scanf()</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#declare SIZE 400\n\nint main()\n{\n\n  int i;\n  char *nums[SIZE][4];\n\n  for(i=0; i&lt;SIZE; i++){\n\n    scanf(\"%3s\", nums[i]);\n    printf( \"%.*s\", 3, nums[i] );    \n  }\n  return 0;\n}    \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6781210, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188335954546656/picture?type=large", "display_name": "Brett Malmquist", "link": "https://stackoverflow.com/users/6781210/brett-malmquist"}, "edited": false, "score": 0, "creation_date": 1473300250, "post_id": 39380940, "comment_id": 66090656, "body": "I get what you are saying, but the input I will be receiving are numbers like 4356.34543543 and separated by whitelines."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "reply_to_user": {"reputation": 15, "user_id": 6781210, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188335954546656/picture?type=large", "display_name": "Brett Malmquist", "link": "https://stackoverflow.com/users/6781210/brett-malmquist"}, "edited": false, "score": 0, "creation_date": 1473300797, "post_id": 39380940, "comment_id": 66090789, "body": "The <code>4356.34543543</code> I understand, just use <code>scanf(&quot;%f&quot;,&amp;in)</code> and use <code>double</code> (or <code>float</code>) for the variables holding the numbers. But what are &quot;whitelines&quot;? Is there an empty line between every number? Please add an example input to your post (you can format it like code to show whitespace etc.)"}, {"owner": {"reputation": 15, "user_id": 6781210, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188335954546656/picture?type=large", "display_name": "Brett Malmquist", "link": "https://stackoverflow.com/users/6781210/brett-malmquist"}, "edited": false, "score": 0, "creation_date": 1473301096, "post_id": 39380940, "comment_id": 66090861, "body": "Whitelines as in spaces, tabs, etc. Here is an example. <a href=\"https://gyazo.com/30a6e016c1a0c9a3b6007354ee532e1c\" rel=\"nofollow noreferrer\">gyazo.com/30a6e016c1a0c9a3b6007354ee532e1c</a>"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "reply_to_user": {"reputation": 15, "user_id": 6781210, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188335954546656/picture?type=large", "display_name": "Brett Malmquist", "link": "https://stackoverflow.com/users/6781210/brett-malmquist"}, "edited": false, "score": 0, "creation_date": 1473301819, "post_id": 39380940, "comment_id": 66091026, "body": "@BrettMalmquist please don&#39;t use images, text is better to C&amp;P. Thank you. Changed the code (the last one) to accept floating point values. Is that more to your taste?"}, {"owner": {"reputation": 15, "user_id": 6781210, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188335954546656/picture?type=large", "display_name": "Brett Malmquist", "link": "https://stackoverflow.com/users/6781210/brett-malmquist"}, "edited": false, "score": 0, "creation_date": 1473302846, "post_id": 39380940, "comment_id": 66091265, "body": "Last question, is there any possible way to line up the decimal places in each column?"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "reply_to_user": {"reputation": 15, "user_id": 6781210, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188335954546656/picture?type=large", "display_name": "Brett Malmquist", "link": "https://stackoverflow.com/users/6781210/brett-malmquist"}, "edited": false, "score": 0, "creation_date": 1473303991, "post_id": 39380940, "comment_id": 66091499, "body": "@BrettMalmquist yes, but that gets complicated, you need to know where the period is. You could change the <code>printf()</code> formats for example, to print an exact amount of digits before and after the period (may not work with trailing zeros). Or use <code>%e</code>. Otherwise you need find the size of the integer part (in decimal) to find the position of the period and fill up with spaces/tabs accordingly. Won&#39;t be easy, especially because you do not know the size of the biggest one."}], "tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": false, "score": 0, "last_activity_date": 1473301735, "last_edit_date": 1473301735, "creation_date": 1473295217, "answer_id": 39380940, "question_id": 39380364, "link": "https://stackoverflow.com/questions/39380364/input-to-array-of-strings-wont-show/39380940#39380940", "title": "Input to array of strings won&#39;t show?", "body": "<p>As Baramar correctly and thoroughly explained your main problems, I think I might have a different understanding of your problem. You want a given string of number, e.g.: <code>2134567896543245678</code> and print it out in a single column, neatly formated in rows of three digits each like that: </p>\n\n<pre><code>213\n456\n789\n654\n324\n567\n8\n</code></pre>\n\n<p>without an intermittent array of integers.</p>\n\n<p>That could be done like e.g.: this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define BUFFER_SIZE 512\n\nint main()\n{\n\n  int res;\n  // for the scanf input, set all to '\\0'\n  char buffer[BUFFER_SIZE + 1] = { '\\0' }, *idx;\n  size_t len, i;\n\n  // restrict max-size to BUFFER_SIZE\n  res = scanf(\"%512s\", buffer);\n  if (res != 1) {\n    exit(EXIT_FAILURE);\n  } else {\n    if (strcmp(buffer, \"exit\") == 0) {\n      exit(EXIT_SUCCESS);\n    }\n    // TODO: check if the buffer contains all digits\n    len = strlen(buffer);\n    idx = buffer;\n    for (i = len; i &gt;= 3; i -= 3, idx += 3) {\n      printf(\"%.3s\\n\", idx);\n    }\n    // last entries, if any\n    if (*idx != '\\0') {\n      printf(\"%s\\n\", idx);\n    }\n  }\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>If you get actual integers in a row like e.g.: <code>12 3123 23478 34 5456 567456 567 678</code> you can use something like that:</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>After the comment by the OP to use floating points I changed the code to accept input of the form:</p>\n\n<pre><code>24722.319352                51433.662233\n     56087.991042             49357.684934  67875.375848      68421.563197\n\n54521.615295\n\n22744.470483\n\n38097.001461    80878.250982\n92131.575748                7217.137271\n20750.671365 7620.695008 37118.391541   28655.609469    46885.110202    87114.202312\n46462.577299\n\n\n\n\n\n\n\n\n20557.716648\n</code></pre>\n\n<p>And the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXNUM 400\nint main()\n{\n  int res;\n  int i = 0, m;\n  // input and two temporary variables\n  double in, in1, in2;\n\n  for (m = 0; m &lt; MAXNUM; m++) {\n    res = scanf(\"%lf\", &amp;in);\n    if (res != 1) {\n      break;\n    } else {\n      switch (i) {\n        case 0:\n          // set value of first temporary variable to input\n          in1 = in;\n          // increment indicator indicating position in output row\n          i++;\n          break;\n        case 1:\n          in2 = in;\n          i++;\n          break;\n        case 2:\n          // print the three numbers and a newline\n          fprintf(stdout, \"%f %f %f\\n\", in1, in2, in);\n          // reset counter\n          i = 0;\n          break;\n      }\n    }\n  }\n  // if there are still numbers, print them\n  if (i != 0) {\n    if (i == 1) {\n      fprintf(stdout, \"%f\\n\", in1);\n    } else {\n      fprintf(stdout, \"%f %f\\n\", in1, in2);\n    }\n  }\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Try it out with </p>\n\n<pre><code> $ gcc-4.9 -O3 -g3  -W -Wall -Wextra  -std=c11 sc.c -o sc\n $ ./sc &lt; floatin \n 24722.319352 51433.662233 56087.991042\n 49357.684934 67875.375848 68421.563197\n 54521.615295 22744.470483 38097.001461\n 80878.250982 92131.575748 7217.137271\n 20750.671365 7620.695008 37118.391541\n 28655.609469 46885.110202 87114.202312\n 46462.577299 20557.716648\n</code></pre>\n\n<p>If you enter less than 400 entries you need to end with <code>EOF</code> which can be triggered in most Unix shells with <code>ctrl+d</code> or set an entry to end the entries like e.g.: <code>-1</code> if all you have is positive numbers and check for it to break out of the loop. If you submit a file like in the example above it works automatically.</p>\n"}], "owner": {"reputation": 15, "user_id": 6781210, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188335954546656/picture?type=large", "display_name": "Brett Malmquist", "link": "https://stackoverflow.com/users/6781210/brett-malmquist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1473301735, "creation_date": 1473290345, "last_edit_date": 1473293670, "question_id": 39380364, "link": "https://stackoverflow.com/questions/39380364/input-to-array-of-strings-wont-show", "title": "Input to array of strings won&#39;t show?", "body": "<p>I'm in C and I'm supposed to have an input of numbers (don't know how many) formatted into one column without storing them into an array of integers. I can't figure out why my code won't read the input and out put it. Please help.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int i;\n    char *nums[400];\n\n    for (i=0; i&lt;nums; i++) {\n        scanf(nums[i]);\n        printf( \"%.*s\", 3, nums[i] );\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "scanf"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1473288602, "post_id": 39380118, "comment_id": 66088104, "body": "You&#39;re not making a copy of <code>string</code> before you insert it. The <code>insert</code> function is just saving a pointer, and all the tree entries point to the same string."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473290104, "post_id": 39380118, "comment_id": 66088508, "body": "Please provide a complete example program showing the bug, to save us from guessing what the rest of your code looks like."}], "answers": [{"comments": [{"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473289566, "post_id": 39380172, "comment_id": 66088365, "body": "This will always insert the same <code>int *</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473289601, "post_id": 39380172, "comment_id": 66088373, "body": "@RolandIllig No it won&#39;t. Integers are passed by value to functions."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473289681, "post_id": 39380172, "comment_id": 66088402, "body": "But <code>x</code> is not an <code>int</code>, it is an <code>int *</code>. Otherwise the call to <code>fscanf</code> would invoke undefined behavior."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473289713, "post_id": 39380172, "comment_id": 66088410, "body": "Oops, didn&#39;t notice that."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1473289905, "last_edit_date": 1473289905, "creation_date": 1473288862, "answer_id": 39380172, "question_id": 39380118, "link": "https://stackoverflow.com/questions/39380118/fscanf-that-reads-only-a-last-word-from-a-file/39380172#39380172", "title": "Fscanf that reads only a last word from a file", "body": "<p><code>insert()</code> doesn't make a copy of the string, it just stores the pointer you give it in the tree. So all the tree entries contain a pointer to the same string, which you're overwriting each time you call <code>fscanf</code>.</p>\n\n<p>The same problem happens with the <code>x</code> argument, you're passing the same pointer each time. You need to allocate a new <code>int</code> for each of the values as well.</p>\n\n<pre><code>while (1) {\n    if (fscanf(f, \"%s %d\", string, x) == EOF) {\n        break;\n    }\n    char *new_str = malloc(strlen(string)+1);\n    strcpy(new_str, string);\n    int *new_int = malloc(sizeof(*x));\n    *new_int = *x;\n    tree = insert(tree, new_str, new_int);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473289838, "post_id": 39380265, "comment_id": 66088442, "body": "The second argument to <code>insert()</code> should be <code>int *</code>, you&#39;re passing <code>int</code>."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473289949, "post_id": 39380265, "comment_id": 66088474, "body": "I think inserting the <code>int</code> is more sensible in this case, though this is not clear from the question."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473290008, "post_id": 39380265, "comment_id": 66088486, "body": "The tree might be designed to allow any type of data to be stored, so the value would be <code>void*</code>."}, {"owner": {"reputation": 15, "user_id": 6801803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e058179ed09ffbe1c6fda9768b4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Bojana B", "link": "https://stackoverflow.com/users/6801803/bojana-b"}, "edited": false, "score": 0, "creation_date": 1473290101, "post_id": 39380265, "comment_id": 66088505, "body": "Thanks for the answer but is it safe using strdup since it&#39;s not part of standard c library?my actual code did have &#39;&amp;&#39; just forgot it while typing it in here"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473290222, "post_id": 39380265, "comment_id": 66088536, "body": "Next time, prefer copy &amp; paste over typing it. :)"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473290260, "post_id": 39380265, "comment_id": 66088549, "body": "Regarding <code>strdup</code>, it depends on the platform you are developing for."}], "tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 0, "last_activity_date": 1473289783, "last_edit_date": 1473289783, "creation_date": 1473289473, "answer_id": 39380265, "question_id": 39380118, "link": "https://stackoverflow.com/questions/39380118/fscanf-that-reads-only-a-last-word-from-a-file/39380265#39380265", "title": "Fscanf that reads only a last word from a file", "body": "<p>Your code should look like this:</p>\n\n<pre><code>while (fscanf(f, \"%s %d\", string, &amp;val) == 2) {\n    char *copy = malloc(strlen(string) + 1);\n    if (copy == NULL)\n        break;\n    strcpy(copy, string);\n    insert(copy, val);\n}\n</code></pre>\n\n<p>Note the error handling for <code>fscanf</code>, which checks if both fields could be read. Also note the <code>&amp;</code> in front of <code>val</code>, which probably prevents a compiler warning. By the way, you should enable all available compiler warnings, so you don't have to search for the bugs yourself.</p>\n"}], "owner": {"reputation": 15, "user_id": 6801803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e058179ed09ffbe1c6fda9768b4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Bojana B", "link": "https://stackoverflow.com/users/6801803/bojana-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 39380172, "answer_count": 2, "score": 1, "last_activity_date": 1473290157, "creation_date": 1473288489, "last_edit_date": 1473290157, "question_id": 39380118, "link": "https://stackoverflow.com/questions/39380118/fscanf-that-reads-only-a-last-word-from-a-file", "title": "Fscanf that reads only a last word from a file", "body": "<p>I'm trying to insert words from a file into a binary tree.The insert function works when not reading from a file also when I tried to print every read string after fscanf it it also works,but when I try to insert it into a tree only the last string from a file is read.Why does this happen?</p>\n\n<pre><code>    while(1){\n\n    if(fscanf(f,\"%s %d\",string,&amp;x)==EOF)\n          break;\n\n      tree=insert(tree,string,x);\n    }  \n</code></pre>\n"}, {"tags": ["c", "language-lawyer", "memcpy", "c11"], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473311281, "post_id": 39380179, "comment_id": 66093116, "body": "There is no basis for assuming that <code>buffer</code> is properly aligned for type <code>struct aaaa</code>."}, {"owner": {"reputation": 310, "user_id": 6769270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a411cf1a45892aac989c5f1c7ab40?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Sugioarto", "link": "https://stackoverflow.com/users/6769270/martin-sugioarto"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473312443, "post_id": 39380179, "comment_id": 66093540, "body": "Yes, this is usually enforced by compiler-specific align attributes, I forgot. It&#39;s still true that there are no problems, when <code>buffer[0]</code> is aligned."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473312527, "post_id": 39380179, "comment_id": 66093574, "body": "Your answer still assumes that <code>buffer</code> is aligned."}], "tags": [], "owner": {"reputation": 310, "user_id": 6769270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a411cf1a45892aac989c5f1c7ab40?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Sugioarto", "link": "https://stackoverflow.com/users/6769270/martin-sugioarto"}, "is_accepted": false, "score": -1, "last_activity_date": 1473314688, "last_edit_date": 1473314688, "creation_date": 1473288943, "answer_id": 39380179, "question_id": 39379970, "link": "https://stackoverflow.com/questions/39379970/is-a-memcpy-between-differently-aligned-pointers-ub/39380179#39380179", "title": "Is a memcpy between differently aligned pointers UB?", "body": "<p>From what I understand, both cases are UB (but not because of the call to <code>memcpy</code>), because the compiler does not enforce alignment of start offsets of variables properly. You can enforce alignment with compiler-specific attributes to be sure, but this is of course a platform-specific solution.</p>\n\n<p>Assuming the start offsets are aligned (this is an assumption from practice), like compilers usually do it to gain perfomance:</p>\n\n<p>In your first example you assign at first buffer index 0. <code>buffer</code> is usually aligned correctly. <code>cccc</code> will be aligned, too, because the <code>struct</code> is not packed. It should not cause a problem in this case.</p>\n\n<p>In second example when using <code>memcpy</code> everything will copy properly, because (internally) it tries its best to do aligned copy for performance and when it is not possible, it copies byte-wise. And here again, all structures and buffers are aligned with the restrictions I mentioned above.</p>\n\n<p>What is the actual problem here?</p>\n\n<p>You would risk it (visibly in practice) if you assign <code>&amp;buffer[1]</code> (given, it is usually not aligned). An access to <code>cccc</code> will load a word from unaligned address. On some architectures it causes the dreaded SIGBUS. x86 detects unaligned addressing and slows down a bit (perhaps), but does not crash.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1473289332, "post_id": 39380180, "comment_id": 66088306, "body": "But what does it mean to &quot;copy byte by byte&quot; in C11? Maybe the first byte will be fine, but how will you copy <code>buffer[1]</code> to <code>*(((unsigned char *)&amp;target)+1)</code>? Surely, the latter expression has UB..."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1473289563, "post_id": 39380180, "comment_id": 66088362, "body": "@Rhymoid, it is the same as casting the addresses to <code>char*</code> and <code>char const*</code>, respectively, and then doing a <code>for</code> loop for copying. Accessing individual bytes through character pointers is always allowed."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473971765, "post_id": 39380180, "comment_id": 66355536, "body": "While <code>memcpy</code> itself does not generally make assumptions about alignment, it may exploit assumptions a compiler makes <i>elsewhere</i> about alignment.  For example,if a compiler sees that the arguments to <code>memcpy</code> are of type <code>uint32_t</code>, it may generate <code>memcpy</code> code that will fail if the pointers aren&#39;t aligned for that type.  Whether or not the compiler would normally care about the alignment of a pointer which is converted to <code>uint32_t*</code> and back to <code>void*</code> without being dereferenced as a <code>uint32_t</code>, conversion of a pointer to <code>uint32_t*</code> will invoke Undefined Behavior if it is not aligned..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473971909, "post_id": 39380180, "comment_id": 66355610, "body": "...for that type (even if it is never dereferenced as that type).  Since the only way <code>memcpy</code> would receive unaligned pointers would be if UB had already occurred, there would be no need for the compiler to handle that case."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 5, "last_activity_date": 1473289412, "last_edit_date": 1473289412, "creation_date": 1473288946, "answer_id": 39380180, "question_id": 39379970, "link": "https://stackoverflow.com/questions/39379970/is-a-memcpy-between-differently-aligned-pointers-ub/39380180#39380180", "title": "Is a memcpy between differently aligned pointers UB?", "body": "<p>No, <code>memcpy</code> doesn't make any assumptions about alignement. It is functionally equivalent to copying byte by byte.</p>\n\n<p>BTW, accessing an <code>auto</code> object through an lvalue of a different type that is not a character type leads to undefined behavior, regardless of alignment. This is a violation of the <em>effective type rule</em>, C11 6.5 p6 and p7.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 39380180, "answer_count": 2, "score": 3, "last_activity_date": 1473415186, "creation_date": 1473287538, "last_edit_date": 1473415186, "question_id": 39379970, "link": "https://stackoverflow.com/questions/39379970/is-a-memcpy-between-differently-aligned-pointers-ub", "title": "Is a memcpy between differently aligned pointers UB?", "body": "<p>As far as I understand, the following piece of code exhibits undefined behaviour in C11:</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nstruct aaaa { char bbbb; int cccc; };\n\nint main(void) {\n    unsigned char buffer[sizeof(struct aaaa)] = { 0 };\n    struct aaaa *pointer = &amp;buffer[0];\n\n    return (*pointer).cccc;\n}\n</code></pre>\n\n<p>According to <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">N1570</a> section 6.5.3.2 clause 4,</p>\n\n<blockquote>\n  <p>If an invalid value has been assigned to the pointer, the behavior of the unary <code>*</code> operator is undefined.</p>\n</blockquote>\n\n<p>which is accompanied by a footnote that clarifies that</p>\n\n<blockquote>\n  <p>Among the invalid values for dereferencing a pointer by the unary <code>*</code> operator are a null pointer, an address inappropriately aligned for the type of object pointed to, and the address of an object after the end of its lifetime.</p>\n</blockquote>\n\n<p>It's unlikely that <code>struct aaaa *</code> and <code>unsigned char *</code> have the same alignment, so we assigned an invalid value to <code>pointer</code>, and using <code>*pointer</code> therefore causes UB.</p>\n\n<p>However, can I copy the structure?</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nstruct aaaa { char bbbb; int cccc; };\n\nint main(void) {\n    unsigned char buffer[sizeof(struct aaaa)] = { 0 };\n    struct aaaa target;\n\n    memcpy(&amp;target, buffer, sizeof(struct aaaa));\n\n    return target.cccc;\n}\n</code></pre>\n\n<p>Here, we pass a <code>struct aaaa *</code> and <code>unsigned char *</code> to <code>memcpy</code>. While that seems just as bad as the first piece of code, I can't find any wording in C11 that rules that this code exhibits UB. <strong>Does this usage of <code>memcpy</code> cause undefined behaviour?</strong></p>\n"}, {"tags": ["c", "algorithm", "primes", "scientific-computing", "primality-test"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473288819, "post_id": 39379968, "comment_id": 66088159, "body": "Don&#39;t post images of text! And start using the debugger."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1473301609, "post_id": 39379968, "comment_id": 66090981, "body": "Simplify <code>(unsigned long) pow(2, (double)i) - 1;</code> --&gt; <code>(1ul &lt;&lt; i) - 1;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1473290019, "post_id": 39380277, "comment_id": 66088490, "body": "Ha, you posted the answer when I was updating. We are almost on the same track, which sounds good! :)"}], "tags": [], "owner": {"reputation": 1119, "user_id": 6797534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tu8Gt9iJGt8/AAAAAAAAAAI/AAAAAAAAAI0/Diz261BzMYk/photo.jpg?sz=128", "display_name": "Ray Hamel", "link": "https://stackoverflow.com/users/6797534/ray-hamel"}, "is_accepted": false, "score": 3, "last_activity_date": 1473289564, "creation_date": 1473289564, "answer_id": 39380277, "question_id": 39379968, "link": "https://stackoverflow.com/questions/39379968/mersenne-primes-using-lucas-lehmer-primality-test/39380277#39380277", "title": "Mersenne primes using Lucas-Lehmer primality test", "body": "<p>Likely integer overflow at <code>termN * termN</code>. In general you should represent values that could be very large numbers as doubles, and avoid casting between different numeric types, especially between integers and floats, whenever possible.</p>\n"}, {"comments": [{"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "edited": false, "score": 1, "creation_date": 1473364178, "post_id": 39380289, "comment_id": 66124218, "body": "\u0395\u03c5\u03c7\u03b1\u03c1\u03b9\u03c3\u03c4\u03ce \u03b3\u03b9\u03b1 \u03c4\u03bf\u03bd \u03c7\u03c1\u03cc\u03bd\u03bf \u03c0\u03bf\u03c5 \u03b1\u03c6\u03b9\u03b5\u03c1\u03ce\u03c3\u03b1\u03c4\u03b5 \u03ba\u03b1\u03b9 \u03b3\u03b9\u03b1 \u03c4\u03b7\u03bd \u03c0\u03bb\u03ae\u03c1\u03b7 \u03b1\u03c0\u03ac\u03bd\u03c4\u03b7\u03c3\u03b7!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1473289633, "creation_date": 1473289633, "answer_id": 39380289, "question_id": 39379968, "link": "https://stackoverflow.com/questions/39379968/mersenne-primes-using-lucas-lehmer-primality-test/39380289#39380289", "title": "Mersenne primes using Lucas-Lehmer primality test", "body": "<p>Change this:</p>\n\n<pre><code>unsigned int termN = 4;\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>unsigned long int termN = 4;\n</code></pre>\n\n<p>mostly because you later do <code>termN * termN</code> which is likely to cause an overflow when a type of <code>unsigned int</code>.</p>\n\n<p>Output:</p>\n\n<pre><code>current = 0, mersenne = 3, index = 2\ncurrent = 1, mersenne = 7, index = 3\ncurrent = 2, mersenne = 31, index = 5\ncurrent = 3, mersenne = 127, index = 7\ncurrent = 4, mersenne = 8191, index = 13\ncurrent = 5, mersenne = 131071, index = 17\ncurrent = 6, mersenne = 524287, index = 19\ncurrent = 7, mersenne = 2147483647, index = 31\n</code></pre>\n\n<hr>\n\n<p>It would be nice to print your types as you ought to:</p>\n\n<pre><code>C02QT2UBFVH6-lm:~ gsamaras$ gcc -Wall main.c\nmain.c:58:67: warning: format specifies type 'unsigned long' but the argument has type 'unsigned int' [-Wformat]\n            printf(\"current = %lu, mersenne = %lu, index = %u\\n\", current, mersenne, i);\n                              ~~~                                 ^~~~~~~\n                              %u\n</code></pre>\n\n<p>So change <code>%lu</code> to <code>%u</code>.</p>\n\n<hr>\n\n<p>How did I start debugging?</p>\n\n<p>By using a print statement in the start of your loop, like this:</p>\n\n<pre><code>for (i = 2; i &lt;= bitsInLong; i++)\n{\n    printf(\"Loop i = %u, current = %u\\n\", i, current);\n    ...\n</code></pre>\n\n<p>You will see this:</p>\n\n<pre><code>current = 4, mersenne = 8191, index = 13\nLoop i = 14, current = 5\n...\nLoop i = 63, current = 5\nLoop i = 64, current = 5\n</code></pre>\n\n<p>which means that you don't see 8 Mersenne numbers, because you are ending your loop, before <em>your</em> function fins 8 of them!</p>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1473291882, "post_id": 39380491, "comment_id": 66088917, "body": "Correct approach, but just for 8 numbers <code>unsigned long int</code> is enough. But if you want something that can scale, I like that too, +1! :)"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1473292502, "post_id": 39380491, "comment_id": 66089075, "body": "@gsamaras I thougth the same, but in that site, for example, the compiler is running on a machine (VM probably) with a 32bit <code>unsigned long int</code>..."}], "tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 2, "last_activity_date": 1473291359, "creation_date": 1473291359, "answer_id": 39380491, "question_id": 39379968, "link": "https://stackoverflow.com/questions/39379968/mersenne-primes-using-lucas-lehmer-primality-test/39380491#39380491", "title": "Mersenne primes using Lucas-Lehmer primality test", "body": "<p>The issue is in the line:</p>\n\n<pre><code>termN = (termN * termN - 2) % mersenne;\n</code></pre>\n\n<p>You declared <code>termN</code> as an <code>unsigned int</code> (32 bit, in your environment) but that product can become so big not to be representable by this type and the resulting overflow cause the loop to diverge.</p>\n\n<p>The solution is to use a type with a bigger range, like <code>unsigned long long int</code> (64 bit).</p>\n\n<p>See the example at <a href=\"https://ideone.com/Whmqur\" rel=\"nofollow\">Ideone.com</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 2, "last_activity_date": 1473317990, "creation_date": 1473317990, "answer_id": 39384451, "question_id": 39379968, "link": "https://stackoverflow.com/questions/39379968/mersenne-primes-using-lucas-lehmer-primality-test/39384451#39384451", "title": "Mersenne primes using Lucas-Lehmer primality test", "body": "<p>Let's push this one number further and toss all that floating point code.  Although the next mersenne prime will fit into 64 bits, the issue is the <code>termN * termN</code> expression which will overflow before the modulus can reign it in.  If we had true modular exponentiation, we might avoid this problem.  Instead, we'll use the emulated 128 bit type in GCC/clang while computing that value:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef unsigned __int128 uint128_t;\n\nbool isPrime(unsigned number)\n{\n    if (number % 2 == 0)\n    {\n        return number == 2;\n    }\n\n    for (unsigned i = 3; i * i &lt;= number; i += 2)\n    {\n        if (number % i == 0)\n        {\n            return false;\n        }\n    }\n\n    return true;\n}\n\nbool isMersenneExponent(unsigned exponent)\n{\n    if (exponent == 2)\n    {\n        return true;\n    }\n\n    if (!isPrime(exponent))\n    {\n        return false;\n    }\n\n    unsigned long termN = 4, mersenne = (1L &lt;&lt; exponent) - 1;\n\n    unsigned limit = exponent - 1;\n\n    for (unsigned i = 1; i &lt; limit; i++)\n    {\n        termN = (((uint128_t) termN * termN) % mersenne) - 2;\n    }\n\n    return termN == 0;\n}\n\nvoid findMersennePrime(unsigned limit)\n{\n    unsigned bit_limit = sizeof(unsigned long) * 8;\n\n    for (unsigned current = 0, i = 2; current &lt; limit &amp;&amp; i &lt; bit_limit; i++)\n    {\n        if (isMersenneExponent(i)) \n        {\n            unsigned long mersenne = (1L &lt;&lt; i) - 1;\n            printf(\"current = %u, mersenne = %lu, index = %u\\n\", current++, mersenne, i);\n        }\n    }\n}\n\nint main()\n{\n    unsigned limit = 9;\n    findMersennePrime(limit);\n    return 0;\n}\n</code></pre>\n\n<p>The <code>i * i</code> in <code>isPrime()</code> is a slight inefficiency but since the exponent primes are tiny, it hardly matters.</p>\n\n<p><strong>OUTPUT</strong></p>\n\n<pre><code>current = 0, mersenne = 3, index = 2\ncurrent = 1, mersenne = 7, index = 3\ncurrent = 2, mersenne = 31, index = 5\ncurrent = 3, mersenne = 127, index = 7\ncurrent = 4, mersenne = 8191, index = 13\ncurrent = 5, mersenne = 131071, index = 17\ncurrent = 6, mersenne = 524287, index = 19\ncurrent = 7, mersenne = 2147483647, index = 31\ncurrent = 8, mersenne = 2305843009213693951, index = 61\n</code></pre>\n"}], "owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 39380289, "answer_count": 4, "score": 2, "last_activity_date": 1473317990, "creation_date": 1473287530, "last_edit_date": 1592644375, "question_id": 39379968, "link": "https://stackoverflow.com/questions/39379968/mersenne-primes-using-lucas-lehmer-primality-test", "title": "Mersenne primes using Lucas-Lehmer primality test", "body": "<p>Here is the code, where <code>limit = 8</code>:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt; // pow(x, exp)\n\n//----------------------------------------------------------\n\nchar isMersenneLucasLehmer(unsigned int prime)\n{\n    unsigned int i, termN = 4;\n    unsigned long mersenne;\n    unsigned int limit;\n    int res;\n\n    mersenne = (unsigned long) pow(2, (double)prime) - 1;\n    if (prime % 2 == 0)\n    {\n        return prime == 2;\n    }\n    else \n    {\n        res = (int) sqrt((double) prime);\n        for (i = 3; i &lt;= res; i += 2)\n        {\n            if (prime % i == 0)\n            {\n                return 0;  \n            }\n        }\n\n        limit = prime - 2;\n        for (i = 1; i &lt;= limit; ++i)\n        {\n            termN = (termN * termN - 2) % mersenne;\n        }\n    }\n    return termN == 0;\n}\n//----------------------------------------------------------\n\n/*\n    Function: findMersenneLucasLehmer()\n\n*/\nvoid findMersenneLucasLehmer(unsigned int limit)\n{\n    unsigned int i, current = 0;\n    unsigned long mersenne, bitsInLong = 64;\n\n    for (i = 2; i &lt;= bitsInLong; i++)\n    {\n        if (current &gt;= limit)\n        {\n            break;\n        }\n\n        if (isMersenneLucasLehmer(i))   \n        {\n            mersenne = (unsigned long) pow(2, (double)i) - 1;\n            printf(&quot;current = %lu, mersenne = %lu, index = %u\\n&quot;, current, mersenne, i);\n            ++current;\n        } \n    }\n}\n//----------------------------------------------------------\n\nint main()\n{\n    unsigned int limit = 8;\n    findMersenneLucasLehmer(limit);\n    return 0;\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>current = 0, mersenne = 3, index = 2\ncurrent = 1, mersenne = 7, index = 3\ncurrent = 2, mersenne = 31, index = 5\ncurrent = 3, mersenne = 127, index = 7\ncurrent = 4, mersenne = 8191, index = 13\n</code></pre>\n<p>It is only returning the first <code>5</code> instead of <code>8</code> and I can't figure out why.</p>\n<hr />\n<h2>Update:</h2>\n<p>it is skipping all the indexes from 13 and on. I suspect that the error is in somewhere in the last lines of <code>isMersenneLucasLehmer(unsigned int)</code>. I've been staring for too long and couldn't find it.</p>\n"}, {"tags": ["c", "random", "time", "srand", "ucontext"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 2, "creation_date": 1473286810, "post_id": 39379824, "comment_id": 66087562, "body": "Just OOC, why are you calling <code>ccreate</code> twice in a row with the same arguments? Are you 100% sure the seg fault is actually on the line that <code>seed</code>s?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1473286959, "post_id": 39379824, "comment_id": 66087603, "body": "<code>ccreate((void*)&amp;test, 0);</code> There is no reason to cast here."}, {"owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "edited": false, "score": 0, "creation_date": 1473286999, "post_id": 39379824, "comment_id": 66087620, "body": "I don&#39;t have <code>ucontext.h</code> so I had to remove all of ccreate, but I didn&#39;t get a seg vault. Are you sure srand is the problem? Can you put together a smaller example? (<a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1473287004, "post_id": 39379824, "comment_id": 66087621, "body": "it&#39;s more likely that <code>ccreate((void*)&amp;test, 0);</code> causes the segfault but it is misreported as being on the srand line"}], "answers": [{"tags": [], "owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "is_accepted": false, "score": 5, "last_activity_date": 1473296754, "last_edit_date": 1473296754, "creation_date": 1473287232, "answer_id": 39379924, "question_id": 39379824, "link": "https://stackoverflow.com/questions/39379824/why-does-srandtimenull-gives-me-segmentation-fault-on-main/39379924#39379924", "title": "Why does srand(time(NULL)) gives me segmentation fault on main?", "body": "<p>The problem is not with <code>srand(time(NULL))</code>, but with <code>makecontext</code>.<br>\nYou can run your code through a sanatizer to confirm:    </p>\n\n<pre><code>gcc-6 -fsanitize=undefined -fsanitize=address -fsanitize=leak -fsanitize-recover=all -fuse-ld=gold -o main main.c\n./main \nASAN:DEADLYSIGNAL\n=================================================================\n==8841==ERROR: AddressSanitizer: SEGV on unknown address 0x7fc342ade618 (pc 0x7fc340aad235 bp 0x7ffd1b945950 sp 0x7ffd1b9454f8 T0)\n    #0 0x7fc340aad234 in makecontext (/lib/x86_64-linux-gnu/libc.so.6+0x47234)\n    #1 0x400d2f in ccreate (/home/malko/Desktop/main+0x400d2f)\n    #2 0x400c19 in main (/home/malko/Desktop/main+0x400c19)\n    #3 0x7fc340a87f44 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21f44)\n    #4 0x400b28  (/home/malko/Desktop/main+0x400b28)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV (/lib/x86_64-linux-gnu/libc.so.6+0x47234) in makecontext\n==8841==ABORTING\n</code></pre>\n\n<p>You can solve the problem by setting a stack size <strong>before</strong> making the context:  </p>\n\n<pre><code>char stack[20000];\nthreadContext.uc_stack.ss_sp = stack;\nthreadContext.uc_stack.ss_size = sizeof(stack);\nmakecontext(&amp;threadContext, (void*)start, 0);\n</code></pre>\n\n<hr>\n\n<p>Unrelated, but make sure you also free that malloc'd memory in your sample code.</p>\n"}], "owner": {"reputation": 53, "user_id": 5774346, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MFFytTVcYpA/AAAAAAAAAAI/AAAAAAAARuA/FUd5DnSOMEA/photo.jpg?sz=128", "display_name": "Guilherme Tassinari", "link": "https://stackoverflow.com/users/5774346/guilherme-tassinari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473296754, "creation_date": 1473286570, "question_id": 39379824, "link": "https://stackoverflow.com/questions/39379824/why-does-srandtimenull-gives-me-segmentation-fault-on-main", "title": "Why does srand(time(NULL)) gives me segmentation fault on main?", "body": "<p>Need some help here.</p>\n\n<p>I want to understand what's happening in this code.</p>\n\n<p>I'm trying to generate random numbers as <code>tickets</code> to the <code>TCP_t</code> struct created inside <code>ccreate</code> function.</p>\n\n<p>The problem is, everytime I executed this code WITHOUT the <code>srand(time(NULL))</code> it returned the same sequence of <i>\"random\"</i> numbers over and over, for example:</p>\n\n<pre><code>TID: 0 | TICKET : 103\nTID: 1 | TICKET : 198\n</code></pre>\n\n<p>So I seeded it with time, to generate really random numbers.</p>\n\n<p>When I put the seed inside the <code>newTicket</code> function, it brings different numbers in every execution, but the same numbers for every thread. Here is an example of output:</p>\n\n<p>Execution 1:</p>\n\n<pre><code>TID: 0 | TICKET : 148\nTID: 1 | TICKET : 148\n</code></pre>\n\n<p>Execution 2:</p>\n\n<pre><code>TID: 0 | TICKET : 96\nTID: 1 | TICKET : 96\n</code></pre>\n\n<p>So, after some research, I found out I shouldn't seed it everytime I call <code>rand</code> but only once, in the beginning of the program. Now, after putting the seed inside the <code>main</code> function, it gives me segmentation fault, and I have NO IDEA why.</p>\n\n<p>This might be a stupid question, but I really want to understand what's happening.</p>\n\n<p>Is the seed screwing anything, somehow?\nAm I missing something?\nShould I generate random number in another way? </p>\n\n<pre><code>#include &lt;ucontext.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\n#define MAX_TICKET 255\n#define STACK_SIZE 32000\n\ntypedef struct s_TCB {\n  int threadId;\n  int ticket;\n  ucontext_t context;\n} TCB_t;\n\nvoid test();\nint newTicket();\nint newThreadId();\nint ccreate (void* (*start)(void*), void *arg);\nint threadId = 0;\n\nint main(){\n  srand(time(NULL)); //&lt;&lt;&lt;============== HERE = SEGMENTATION FAULT\n  ccreate((void*)&amp;test, 0);\n  ccreate((void*)&amp;test, 0);\n}\n\nint ccreate (void* (*start)(void*), void *arg){\n    if(start == NULL) return -1;\n\n    ucontext_t threadContext;\n    getcontext(&amp;threadContext);\n    makecontext(&amp;threadContext, (void*)start, 0);\n    threadContext.uc_stack.ss_sp = malloc(STACK_SIZE);\n    threadContext.uc_stack.ss_size = STACK_SIZE;\n\n    TCB_t * newThread = malloc(sizeof(TCB_t));\n    if (newThread == NULL) return -1;\n\n    int threadThreadId = newThreadId();\n    newThread-&gt;threadId = threadThreadId;\n    newThread-&gt;ticket = newTicket();\n\n    printf(\"TID: %d | TICKET : %d\\n\", newThread-&gt;threadId, newThread-&gt;ticket);\n\n    return threadThreadId;\n}\n\nint newThreadId(){\n  int newThreadId = threadId;\n  threadId++;\n  return newThreadId;\n}\n\nint newTicket(){\n  //srand(time(NULL)); //&lt;&lt;&lt;============== HERE = IT PARTIALLY WORKS\n  return (rand() % (MAX_TICKET+1));\n}\n\nvoid test(){\n  printf(\"this is a test function\");\n}\n</code></pre>\n\n<p>Thanks to everyone who lends me a hand here.</p>\n\n<p>And sorry if the code is too ugly to read. Tried to simplify it as much as I could.</p>\n"}, {"tags": ["c", "gdb", "gdbserver"], "comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1473286101, "post_id": 39379714, "comment_id": 66087337, "body": "How did you compile this program? What command?"}, {"owner": {"reputation": 195, "user_id": 1090596, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/313e98d8ac8e536e3578e2952bbcdd63?s=128&d=identicon&r=PG", "display_name": "rivenmyst137", "link": "https://stackoverflow.com/users/1090596/rivenmyst137"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1473294509, "post_id": 39379714, "comment_id": 66089482, "body": "gcc -std=c99 -D_GNU_SOURCE -O0 -g3 -Wall -c -fmessage-length=0 -ggdb -fPIC -MMD -MP -MF&quot;foo.d&quot; -MT&quot;foo.o&quot; -o &quot;foo.o&quot; &quot;../foo.c&quot;      linker: gcc -L../../library/Debug -o &quot;bitbucket&quot;  ./bitbucket.o   -lentangle -lrt"}], "answers": [{"tags": [], "owner": {"reputation": 2173, "user_id": 6577680, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BNh_9G6Q-1M/AAAAAAAAAAI/AAAAAAAAAA8/uTxVAAioLfw/photo.jpg?sz=128", "display_name": "Matthew Fisher", "link": "https://stackoverflow.com/users/6577680/matthew-fisher"}, "is_accepted": false, "score": 0, "last_activity_date": 1473288197, "creation_date": 1473288197, "answer_id": 39380076, "question_id": 39379714, "link": "https://stackoverflow.com/questions/39379714/no-symbols-just-question-marks-in-stack-trace-in-remote-gdb/39380076#39380076", "title": "no symbols (just question marks) in stack trace in remote gdb", "body": "<p>A few ideas:</p>\n\n<p>Make sure the remote program and shared libraries are compiled with -g to add debug symbols.  The <code>(no debugging symbols found)</code> message may mean that the debug symbols are missing from the whole executable. </p>\n\n<p>Make sure the local and remote program are the same image. You can do a 'sum' on each.  This may be the problem as the <code>#1  0x0000000000000003 in ?? ()</code> line looks to be corrupt. </p>\n\n<p>Are you able to manually debug the target on the remote box?  If so, check for symbols to see if it something about the remote/local debug session.  You can check for debug symbols by doing a <code>list &lt;function&gt;</code> </p>\n\n<p>The address ranges are often mapped the same on local system versus remote.  You can disassemble an address on a local debug session and see what function/method it maps to.  This can be helpful if the remote program is crashing, at least you can get an idea of where the trouble is. </p>\n"}, {"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1473622345, "last_edit_date": 1473622345, "creation_date": 1473291321, "answer_id": 39380490, "question_id": 39379714, "link": "https://stackoverflow.com/questions/39379714/no-symbols-just-question-marks-in-stack-trace-in-remote-gdb/39380490#39380490", "title": "no symbols (just question marks) in stack trace in remote gdb", "body": "<blockquote>\n  <p>I'm at a bit of a loss for what could be wrong</p>\n</blockquote>\n\n<p>It could be that there is <em>nothing</em> wrong at all.</p>\n\n<p>Here is what I get on a local machine:</p>\n\n<pre><code>gdbserver :0 /bin/date\nProcess /bin/date created; pid = 132826\nListening on port 57966\nRemote debugging from host 127.0.0.1\n</code></pre>\n\n<p>In a separate window:</p>\n\n<pre><code>gdb -q /bin/date\n(gdb) target remote localhost:57966\nRemote debugging using localhost:57966\nLoading symbols for shared libraries.\nLoading symbols for shared libraries.\n0x00007ffff7ddb2d0 in _start () at rtld.c:871\n871 rtld.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff7ddb2d0 in _start () at rtld.c:871\n#1  0x0000000000000001 in ?? ()\n#2  0x00007fffffffe157 in ?? ()\n#3  0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>What's happening here is that gdbserver stopped the inferior (being debugged) process very early on. Before the loader zeroed out stack, and before entering <code>main</code>.</p>\n\n<p>The symbols for main executable should already be loaded, and you should be able to set breakpoints on them. Set a breakpoint on <code>main</code>, and just continue from there, and you should soon see your breakpoint getting hit.</p>\n\n<p><strong>Update:</strong></p>\n\n<blockquote>\n  <p>I expected it to start running and break on the start on main when I connected.</p>\n</blockquote>\n\n<p>Your expectation is incorrect.</p>\n\n<p>In a typical dynamically-linked binary, there are 1000s of instructions between <code>_start</code> and getting to <code>main</code>. Sometimes these instructions are the ones where a crash happens. If GDB automatically continued to <code>main</code> without giving you a chance to set breakpoints or watchpoints, then debugging such crashes would be much more difficult than it is now.</p>\n"}, {"tags": [], "owner": {"reputation": 1939, "user_id": 3416302, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e06a91ad0f7bb56b03929c75bb866852?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Azim", "link": "https://stackoverflow.com/users/3416302/mohammad-azim"}, "is_accepted": false, "score": 0, "last_activity_date": 1513005674, "creation_date": 1513005674, "answer_id": 47756023, "question_id": 39379714, "link": "https://stackoverflow.com/questions/39379714/no-symbols-just-question-marks-in-stack-trace-in-remote-gdb/47756023#47756023", "title": "no symbols (just question marks) in stack trace in remote gdb", "body": "<p>When debugging remote, gdb client does not know where to load symbols from. You have two options:</p>\n\n<pre><code>1. specify executable when starting gdb\n\ngdb &lt;executable&gt;\n(gdb) target remote &lt;IP&gt;:&lt;port&gt;\n(gdb) load &lt;executable&gt;\n gdb should know symbols now\n(gdb) b main\n(gdb) mon reset\n(gdb) contnue\n it should break at main\n(gdb) bt\n\n2. use file command to tell about the symbols.\n\ngdb\n(gdb) target remote &lt;IP&gt;:&lt;port&gt;\n(gdb) load &lt;executable&gt;\n(gdb) file &lt;executable&gt;\n gdb should know symbols now\n(gdb) b main\n(gdb) mon reset\n(gdb) contnue\n it should break at main\n(gdb) bt\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 1090596, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/313e98d8ac8e536e3578e2952bbcdd63?s=128&d=identicon&r=PG", "display_name": "rivenmyst137", "link": "https://stackoverflow.com/users/1090596/rivenmyst137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3696, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1513005674, "creation_date": 1473285939, "last_edit_date": 1473597283, "question_id": 39379714, "link": "https://stackoverflow.com/questions/39379714/no-symbols-just-question-marks-in-stack-trace-in-remote-gdb", "title": "no symbols (just question marks) in stack trace in remote gdb", "body": "<p>I have a relatively simple application (that links in another simple library) that refuses to let me remotely debug it with gdb.  I've checked that gdb and gdbserver versions match.  It's actually even the same OS (ubuntu) on both machines.  It seems to be happily loading symbols from the executable.  So I'm at a bit of a loss for what could be wrong.  Any suggestions appreciated.  Here is the transcript from gdb:</p>\n\n<pre><code>dev:/fast/git/archive/foo$ gdb /fast/git/foo \nGNU gdb (Ubuntu 7.11.1-0ubuntu1~16.04) 7.11.1\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n&lt;http://www.gnu.org/software/gdb/documentation/&gt;.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from /fast/git/foo...done.\n(gdb) target remote test1:5000\nRemote debugging using test1:5000\nReading /lib64/ld-linux-x86-64.so.2 from remote target...\nwarning: File transfers from remote targets can be slow. Use \"set sysroot\" to access files locally instead.\nReading /lib64/ld-linux-x86-64.so.2 from remote target...\nReading symbols from target:/lib64/ld-linux-x86-64.so.2...Reading /lib64/ld-2.23.so from remote target...\nReading /lib64/.debug/ld-2.23.so from remote target...\n(no debugging symbols found)...done.\n0x00007ffff7dd7cc0 in ?? () from target:/lib64/ld-linux-x86-64.so.2\n(gdb) bt\n#0  0x00007ffff7dd7cc0 in ?? () from target:/lib64/ld-linux-x86-64.so.2\n#1  0x0000000000000003 in ?? ()\n#2  0x00007fffffffce02 in ?? ()\n#3  0x00007fffffffce2f in ?? ()\n#4  0x00007fffffffce32 in ?? ()\n#5  0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>Ah, so interesting. I'm still not sure why, but it only prints that (bogus stack trace) on connect. If I then \"continue,\" it will happily print the right symbols if I trigger a break.</p>\n\n<p>Odd...maybe this is partly user error, but I expected it to start running and break on the start on main when I connected.</p>\n"}, {"tags": ["c", "unit-testing"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473285438, "post_id": 39379540, "comment_id": 66087104, "body": "Make the <code>TEST</code> macro also add the function pointer into some global function pointers array. Then make <code>RUN_ALL_TESTS</code> to iterate that array."}, {"owner": {"reputation": 2224, "user_id": 1721424, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/215f7e243f29cacab4e533dad1bf1f67?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1721424/ryan"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473286606, "post_id": 39379540, "comment_id": 66087499, "body": "@EugeneSh. I don&#39;t believe what you&#39;re suggesting is possible in C without using any extensions. There is no way to run code before the main function which makes it impossible to add the function pointer to an array. However, it is possible in C++ because constructors can run before main."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473287062, "post_id": 39379540, "comment_id": 66087644, "body": "Oh, I&#39;ve started to write an answer based on this suggestion and got an almost working example. Almost is because there is no way to get the name of the test while iterating. But it can be achieved if the name is passed as a parameter to the unit test function. Unfortunately I was distracted in the middle an now I am away from that computer..."}], "answers": [{"comments": [{"owner": {"reputation": 2013, "user_id": 70405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0b3885b5364a53cb8bbdaf498a32d0d3?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/70405/alex"}, "edited": false, "score": 0, "creation_date": 1608288696, "post_id": 39379595, "comment_id": 115543418, "body": "<i>how</i> the wheel works is what this site is all about! It is not about common advices"}], "tags": [], "owner": {"reputation": 967, "user_id": 5294619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afe990a13c278488b9e2268e226f082a?s=128&d=identicon&r=PG&f=1", "display_name": "ddbug", "link": "https://stackoverflow.com/users/5294619/ddbug"}, "is_accepted": false, "score": -1, "last_activity_date": 1473285323, "creation_date": 1473285323, "answer_id": 39379595, "question_id": 39379540, "link": "https://stackoverflow.com/questions/39379540/automically-register-unit-tests-in-c/39379595#39379595", "title": "Automically Register Unit Tests in C", "body": "<p>There are some quirky ways to enumerate functions in an executable file (kind of \"reflection\" in pure c) or clever placement of function pointers in a special data section, etc. </p>\n\n<p>A common advice is not to reinvent the wheel.  Google for existing unit test frameworks, pick one, use it, enjoy. </p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1473286104, "creation_date": 1473286104, "answer_id": 39379743, "question_id": 39379540, "link": "https://stackoverflow.com/questions/39379540/automically-register-unit-tests-in-c/39379743#39379743", "title": "Automically Register Unit Tests in C", "body": "<p>Since you are starting with a macro-based approach, you might be interested in a solution built around X macros.  It would be a bit ugly, and a lot idiosyncratic, but it could do what you want:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// Test definitions\n#define TESTS \\\n  X(addition,  ASSERT_EQ(1 + 2, 3) ) \\\n  X(mult_fail, ASSERT_EQ(42, 6 * 9))\n\n// Helper macros    \n#define ASSERT_EQ(left, right) \\\n    do {return (left) == (right);} while(0)\n\n// declare test functions\n#define X(name, body) int test_##name(void) { body; }\nTESTS\n#undef X\n\nint main(void) {\n    // run tests\n    #define X(name, ignored) \\\n      printf(\"%s\\t%s\\n\", #name, test_##name() ? \"OK\" : \"FAIL\");\n    TESTS\n    #undef X\n}\n</code></pre>\n\n<p>To add, remove, or modify tests, you just modify the definition of macro <code>TESTS</code>; the preprocessor generates everything else you need from that.</p>\n"}], "owner": {"reputation": 2224, "user_id": 1721424, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/215f7e243f29cacab4e533dad1bf1f67?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1721424/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1473286104, "creation_date": 1473285005, "question_id": 39379540, "link": "https://stackoverflow.com/questions/39379540/automically-register-unit-tests-in-c", "title": "Automically Register Unit Tests in C", "body": "<p>Consider this minimal framework for running unit tests:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define TEST(name) int test_##name()\n#define RUN_TEST(name) \\\n    do {printf(\"%s\\t%s\\n\", #name, test_##name() ? \"OK\" : \"FAIL\");} while(0)\n#define ASSERT_EQ(left, right) \\\n    do {return (left) == (right);} while(0)\n\nTEST(addition) {\n    ASSERT_EQ(1 + 2, 3);\n}\n\nTEST(mult_fail) {\n    ASSERT_EQ(42, 6 * 9);\n}\n\nint main() {\n    RUN_TEST(addition);\n    RUN_TEST(mult_fail);\n}\n</code></pre>\n\n<p>It is used like so:</p>\n\n<pre><code>&gt; gcc test_runner.c &amp;&amp; ./a.out\naddition        OK\nmult_fail       FAIL\n</code></pre>\n\n<p>How can it be made so that the TEST macro automatically registers the tests? I want the main function to contain a single RUN_ALL_TESTS statement without having to refer to all the tests by name.</p>\n\n<p>I know this can easily be done in C++, but I would prefer to see a purely C solution.</p>\n"}, {"tags": ["c", "gtk", "gtkbuilder"], "owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1473283345, "creation_date": 1473283345, "question_id": 39379199, "link": "https://stackoverflow.com/questions/39379199/how-to-merge-gtk-builder", "title": "How to merge Gtk+ builder", "body": "<p>I'm building a GTK+ gui and I'm trying to use the GtkBuilder to do it.</p>\n\n<p>There is a main window in which there is a notebook, a menu and two buttons.\nI want to fill the notebook with tabs when I click on a button.</p>\n\n<p>So I created the main window from a file with a GtkBuilder, and then I try to add each tab to the builder.</p>\n\n<p>For now, I did this <em>(the unindented code are debug print)</em>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;string.h&gt;\n\n#include &lt;gtk/gtk.h&gt;\n\n#include \"main.h\"\n\nGtkBuilder* build;\nint i;\n\n#define TAB\\\n  \"&lt;interface&gt;\\\n    &lt;object class=\\\"GtkNotebook\\\" id=\\\"note\\\"&gt;\\\n      &lt;property name=\\\"scrollable\\\"&gt;t&lt;/property&gt;\\\n      &lt;property name=\\\"show-border\\\"&gt;t&lt;/property&gt;\\\n      &lt;property name=\\\"show-tabs\\\"&gt;t&lt;/property&gt;\\\n      &lt;child&gt;\\\n        &lt;object class=\\\"GtkLabel\\\" id=\\\"tab%d\\\"&gt;\\\n          &lt;property name=\\\"label\\\"&gt;Content%d&lt;/property&gt;\\\n        &lt;/object&gt;\\\n      &lt;/child&gt;\\\n      &lt;child type=\\\"tab\\\"&gt;\\\n        &lt;object class=\\\"GtkLabel\\\" id=\\\"labTab%d\\\"&gt;\\\n          &lt;property name=\\\"label\\\"&gt;Label%d&lt;/property&gt;\\\n        &lt;/object&gt;\\\n      &lt;/child&gt;\\\n    &lt;/object&gt;\\\n  &lt;/interface&gt;\"\n\nint main(int argc, char** argv) {\n  GtkWidget* window;\n//  GtkWidget* item;\n  GError* error=NULL;\n  GtkAccelGroup* accel_group;\n\n  i=0;\n\n  gtk_init(&amp;argc, &amp;argv);\n\n  build=gtk_builder_new();\n  if (gtk_builder_add_from_file(build, \"gui.ui\", &amp;error)==0)\n    printf(\"erreur %s\\n\", error-&gt;message);\n\n  gtk_builder_add_callback_symbol(build, \"quit\", func);\n  gtk_builder_add_callback_symbol(build, \"add\", add);\n\n  gtk_builder_connect_signals(build, NULL);\n\n  window=(GtkWidget*)gtk_builder_get_object(build, \"main\");\n  gtk_window_maximize(GTK_WINDOW(window));\n\n  gtk_widget_show_all(window);\n\n  gtk_main();\n\n\n  return EXIT_SUCCESS;\n}\n\nvoid add() {\n  char* str;\n  GtkWidget* window;\n  GError* error=NULL;\n  FILE* file=NULL;\n\nprintf(\"in add 1\\n\");\n  if ((str=malloc(sizeof(TAB)+20))==NULL) {\n    perror(\"malloc\");\n    exit(EXIT_FAILURE);\n  }\nprintf(\"in add 2\\n\");\n\n  snprintf(str, sizeof(TAB)+20, TAB, i, i, i, i);\nprintf(\"in add 3, str : %s\\n\", str);\n\n  if ((file=fopen(\"tmp.ui\", \"w\"))==NULL) {\n    free(str);\n    perror(\"fopen\");\n    exit(EXIT_FAILURE);\n  }\n\n  fprintf(file, TAB, i, i, i, i);\n\n  fclose(file);\n\n/*  if (gtk_builder_add_from_file(build, \"tmp.ui\", &amp;error)==0)\n    printf(\"erreur %s\\n\", error-&gt;message);*/\n  if (gtk_builder_add_from_string(build, str, sizeof(str), &amp;error)==0)\n    printf(\"erreur %s\\n\", error-&gt;message);\nprintf(\"in add 4\\n\");\n\n  if ((window=(GtkWidget*)gtk_builder_get_object(build, \"main\"))==NULL)\n    printf(\"Can't find\\n\");\n  else\n    gtk_widget_show_all(window);\n\n  sprintf(str, \"tab%d\", i);\n  if ((window=(GtkWidget*)gtk_builder_get_object(build, str))==NULL)\n    printf(\"in add, Does not exist (%s)\\n\", str);\n  else\n    printf(\"in add, Exist (%s)\\n\", str);\n\n  remove(\"tmp.ui\");\n  free(str);\n  ++i;\n//  free(error);\n}\n</code></pre>\n\n<p>Here is my builder definition:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;interface&gt;\n  &lt;!-- Main window --&gt;\n  &lt;object class=\"GtkWindow\" id=\"main\"&gt;\n    &lt;property name=\"title\"&gt;Test Xml&lt;/property&gt;\n    &lt;property name=\"window-position\"&gt;GTK_WIN_POS_CENTER&lt;/property&gt;\n    &lt;property name=\"default-width\"&gt;1024&lt;/property&gt;\n    &lt;property name=\"default-height\"&gt;512&lt;/property&gt;\n    &lt;signal name=\"delete-event\" handler=\"quit\"/&gt;\n\n    &lt;child&gt;\n      &lt;object class=\"GtkBox\" id=\"mainBox\"&gt;\n        &lt;property name=\"orientation\"&gt;GTK_ORIENTATION_VERTICAL&lt;/property&gt;\n        &lt;property name=\"spacing\"&gt;5&lt;/property&gt;\n\n        &lt;!-- Menu --&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkMenuBar\" id=\"menuBar\"&gt;\n            &lt;child&gt;\n\n              &lt;!-- Menu fichier --&gt;\n              &lt;object class=\"GtkMenuItem\" id=\"m1\"&gt;\n                &lt;property name=\"label\"&gt;_Fichier&lt;/property&gt;\n                &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                &lt;child type=\"submenu\"&gt;\n                  &lt;object class=\"GtkMenu\" id=\"menu\"&gt;\n                    &lt;property name=\"accel-group\"&gt;accel_group&lt;/property&gt;\n                    &lt;child&gt;\n\n                      &lt;!-- Item Quitter --&gt;\n                      &lt;object class=\"GtkMenuItem\" id=\"i1\"&gt;\n                        &lt;property name=\"accel-path\"&gt;&amp;lt;Test&amp;gt;/FILE/QUIT&lt;/property&gt;\n                        &lt;property name=\"label\"&gt;_Quitter&lt;/property&gt;\n                        &lt;property name=\"use_underline\"&gt;True&lt;/property&gt;\n                        &lt;signal name=\"activate\" handler=\"quit\"/&gt;\n                      &lt;/object&gt;\n                      &lt;!-- End Item Quitter --&gt;\n\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n              &lt;!-- End Menu fichier --&gt;\n\n            &lt;/child&gt;\n          &lt;/object&gt;\n        &lt;/child&gt;\n        &lt;!-- End Menu --&gt;\n\n        &lt;!-- Frame --&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkFrame\" id=\"mainframe\"&gt;\n            &lt;property name=\"expand\"&gt;t&lt;/property&gt;\n\n            &lt;!-- Note book --&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkNotebook\" id=\"note\"&gt;\n                &lt;property name=\"scrollable\"&gt;t&lt;/property&gt;\n                &lt;property name=\"show-border\"&gt;t&lt;/property&gt;\n                &lt;property name=\"show-tabs\"&gt;t&lt;/property&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n            &lt;!-- Note book --&gt;\n          &lt;/object&gt;\n        &lt;/child&gt;\n        &lt;!-- End Frame --&gt;\n\n        &lt;!-- Bottom box --&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkBox\" id=\"bottomBox\"&gt;\n            &lt;property name=\"orientation\"&gt;GTK_ORIENTATION_HORIZONTAL&lt;/property&gt;\n            &lt;property name=\"spacing\"&gt;5&lt;/property&gt;\n\n            &lt;!-- Buttons --&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkButton\" id=\"boutonPlus\"&gt;\n                &lt;property name=\"label\"&gt;_Ajouter&lt;/property&gt;\n                &lt;property name=\"use-underline\"&gt;t&lt;/property&gt;\n                &lt;signal name=\"activate\" handler=\"add\"/&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkButton\" id=\"boutonMoins\"&gt;\n                &lt;property name=\"label\"&gt;_Enlever&lt;/property&gt;\n                &lt;property name=\"use-underline\"&gt;t&lt;/property&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n            &lt;!-- End buttons --&gt;\n          &lt;/object&gt;\n        &lt;/child&gt;\n        &lt;!-- End Bottom box --&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n\n<p>And here is the output:</p>\n\n<pre><code>in add 1\nin add 2\nin add 3, str : &lt;interface&gt;\n    &lt;object class=\"GtkNotebook\" id=\"note\"&gt;\n      &lt;property name=\"scrollable\"&gt;t&lt;/property&gt;\n      &lt;property name=\"show-border\"&gt;t&lt;/property&gt;\n      &lt;property name=\"show-tabs\"&gt;t&lt;/property&gt;\n      &lt;child&gt;\n        &lt;object class=\"GtkLabel\" id=\"tab0\"&gt;\n          &lt;property name=\"label\"&gt;Content0&lt;/property&gt;\n        &lt;/object&gt;\n      &lt;/child&gt;\n      &lt;child type=\"tab\"&gt;\n        &lt;object class=\"GtkLabel\" id=\"labTab0\"&gt;\n          &lt;property name=\"label\"&gt;Label0&lt;/property&gt;\n        &lt;/object&gt;\n      &lt;/child&gt;\n    &lt;/object&gt;\n  &lt;/interface&gt;\nin add 4\nin add, Does not exist (tab0)\n</code></pre>\n\n<p>As we can see, the tab is not add in the builder, but it seems there is no error when I add it.</p>\n\n<ul>\n<li>In the documentation it's said that, in case we want to merge some ui definitions we must use <code>gtk_builder_new()</code>, and then use <code>gtk_builder_add_from_...()</code>. So I did it, and in my <code>add</code> function, I try to add tab from string or from file just to see the problem was because I start to add from file and then from string, but it does not.</li>\n<li>In the documentation, I didn't find anything about what it's needed to do the merge. So, to add the tab, I tried with/without the <code>&lt;interface&gt;</code> and the nodebook definition. But it didn't change anything.</li>\n</ul>\n\n<p>Is there some documentations about merging ui definitions with a <code>GtkBulder</code>, or can someone explain me what I'm doing wrong ?</p>\n"}, {"tags": ["c", "makefile", "build"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473282271, "post_id": 39378948, "comment_id": 66085860, "body": "Maybe they are compiled into two different binaries? Or have a mutually exclusive preprocessor guards? Or just ask the senior guy who is familiar with the code."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 3, "creation_date": 1473282686, "post_id": 39378948, "comment_id": 66086065, "body": "You <i>do</i> have to understand the build process. The standard way is that multiple <code>.c</code> files may have multiple <code>main</code> functions (e.g. <code>foo.c</code> and <code>bar.c</code>--in different directories or not). They will generate two separate programs <code>foo</code> and <code>bar</code>. Some of the programs may be test programs or side utilities. However, you can &quot;embed&quot; one <code>main</code> into another with some CPP/macro trickery. In <code>bar.c</code>: <code>#define main bar_main</code>. Then, the <code>main</code> in <code>foo.c</code> can call <code>bar_main</code>. Not a great way to do it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1473282759, "post_id": 39378948, "comment_id": 66086104, "body": "take a long, hard look at the makefile(s) and read the documentation for the project.   Is it a single executable or multiple executables Are all the files that contain a <code>main()</code> function actually included in the final executable"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1473282899, "post_id": 39378948, "comment_id": 66086156, "body": "stackoverflow is NOT for recommending books, tutorials, etc."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1473283793, "post_id": 39378948, "comment_id": 66086495, "body": "If the project&#39;s build process is too complex to understand, then that&#39;s a serious liability for the project.  If it&#39;s just that you&#39;re having trouble understanding it, though, then you&#39;re experiencing what one might call &quot;jumping in at the deep end.&quot;  It&#39;s a heck of a way to learn to swim, but effective.  Searching for <code>main()</code>s isn&#39;t a bad thing to do, but I usually start with a look at the <code>Makefile</code>(s), or their source or equivalent."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1473336657, "post_id": 39378948, "comment_id": 66107126, "body": "If you link two <code>main</code> functions into an executable, the linker will fail complainting about multiple <code>_main</code> definitions in the program."}], "answers": [{"comments": [{"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1473310899, "post_id": 39379102, "comment_id": 66093015, "body": "Good trick i will use it, one point, you mentioned &quot;Or perhaps the application consists of multiple executables&quot;, when a designer have to choose multiple executable in the application, is it only for organisation stuff (it&#39;s very ugly for me) or sth else"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1473310965, "post_id": 39379102, "comment_id": 66093029, "body": "@Mouin: One example: GNU Coreutils."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 5, "last_activity_date": 1473284689, "last_edit_date": 1473284689, "creation_date": 1473282880, "answer_id": 39379102, "question_id": 39378948, "link": "https://stackoverflow.com/questions/39378948/two-main-functions-in-a-c-application/39379102#39379102", "title": "Two main functions in a C application", "body": "<p>You can't have multiple <code>main</code> functions for a single executable. There are several possibilities.</p>\n\n<p>If doing a build builds only a single application, then only one of the <code>main</code> functions will be compiled. (Or none, if there's an option to build a library rather than an executable.) There are probably options that determine which one to build, depending on which variant of the application you want, the target system, or something else.</p>\n\n<p>Or perhaps the application consists of multiple executables, with one <code>main</code> function for each one.</p>\n\n<p>If running the build doesn't take too long, a trick I've used to determine which of several source files is actually compiled is to temporarily add <code>#error</code> directives, like:</p>\n\n<pre><code>#error \"TEMPORARY: This is /full/path/to/source.cpp\"\n</code></pre>\n\n<p>The resulting error message will tell you which source file was actually compiled. (You can also use <code>#warning</code> directives if your compiler supports them.)</p>\n"}, {"comments": [{"owner": {"reputation": 967, "user_id": 5294619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afe990a13c278488b9e2268e226f082a?s=128&d=identicon&r=PG&f=1", "display_name": "ddbug", "link": "https://stackoverflow.com/users/5294619/ddbug"}, "edited": false, "score": 1, "creation_date": 1473283849, "post_id": 39379188, "comment_id": 66086515, "body": "Short answer - when being put in a big project, you cannot understand nothing. You must know something. Learn, ask your peers."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1473283294, "creation_date": 1473283294, "answer_id": 39379188, "question_id": 39378948, "link": "https://stackoverflow.com/questions/39378948/two-main-functions-in-a-c-application/39379188#39379188", "title": "Two main functions in a C application", "body": "<blockquote>\n  <p>Should i have theorical background to undestand this, suggest me articles book what ever you want</p>\n</blockquote>\n\n<p>You need to have some understanding of what a build means but, more importantly, you have to understand the build process in your specific environment. You need to have an understanding of:</p>\n\n<ol>\n<li>The list of build targets (executables and shared libraries)</li>\n<li>The compiler settings used by them (you could be building DLLs for VS 2010 as well as VS 2012).</li>\n</ol>\n\n<blockquote>\n  <p>When do we have to use several main functions in one application?</p>\n</blockquote>\n\n<ol>\n<li><p>When your build system builds multiple executables, you will need multiple <code>main</code> functions.</p></li>\n<li><p>When your build system chooses file1.c or file2.c for building an executable depending on some settings, you might find <code>main</code> functions in file1.c as well file2.c. This will be a rather poor way to organize code but it is possible.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1473337106, "creation_date": 1473337106, "answer_id": 39390713, "question_id": 39378948, "link": "https://stackoverflow.com/questions/39378948/two-main-functions-in-a-c-application/39390713#39390713", "title": "Two main functions in a C application", "body": "<p>Trying to link an executable with multiple definitions for the same identifier (aka <code>main</code> in this case) will fail as the linker cannot select one or the other.</p>\n\n<p>There's one possibility, though that allows you to have multiple <code>main</code> entry points, but assuring you only select one in the building process.</p>\n\n<p>I'll illustrate this with a simple example: suppose you have a library (a <code>.a</code> static library) that has a module that includes a <code>main</code> definition.  As library modules are selected at link time depending on the actual need of the identifiers at the time the library is linked, you can have a <code>main</code> definition in a module to supply when you don't have one, or that module is not linked in case you have a proper definition of it.  This is exploited in some standard libraries like <code>-ll</code> (flex has a definition of main that calls the <code>yylex()</code> function), <code>-ly</code> (bison has a main definition that call the <code>yyparse()</code> routine)  These modules are included if you don't have done it before.</p>\n\n<p>But beware, as if you link your main function after the library <code>-ll</code>, for example, it will be included (as <code>main</code> was not resolved at the time he library was included, and then you included the second, duplicated entry, making the <code>ld</code> linker to complaint)</p>\n"}], "owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 39379102, "answer_count": 3, "score": 0, "last_activity_date": 1473337106, "creation_date": 1473282144, "last_edit_date": 1473283001, "question_id": 39378948, "link": "https://stackoverflow.com/questions/39378948/two-main-functions-in-a-c-application", "title": "Two main functions in a C application", "body": "<p>I'm actually put in a big project. My first step to understand the code was to search the <code>main</code> function so that I have a vision of the architecture.</p>\n\n<p>What I discovered is that there is more than one main function. It's true that they are in different folders, but I don't understand how this application succeed to build. What I know is that the linker expects one <code>main</code> function (Entry point).</p>\n\n<p>I believe it's too hard to understand the build process of the application, so I'm asking because for sure some of you have encountered this.</p>\n\n<p>1 - Should I have theoretical background to understand this?  If so, please suggest me articles, books, what ever you want.</p>\n\n<p>2 - When <em>do</em> we have to use several <code>main</code> functions in one application?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1473282064, "post_id": 39378892, "comment_id": 66085778, "body": "<a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">Explanation can be found here</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473283351, "post_id": 39378892, "comment_id": 66086346, "body": "How else would you return a pointer from a function?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473283390, "post_id": 39378892, "comment_id": 66086360, "body": "@Olaf with a <code>**</code> argument?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473283586, "post_id": 39378892, "comment_id": 66086424, "body": "@It still would be a pointer, wouldn&#39;t it? (But yes, that&#39;s a typical beginner&#39;s function: <code>void f(int **);</code> ... :-}"}], "answers": [{"comments": [{"owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473282195, "post_id": 39378926, "comment_id": 66085833, "body": "@KeithThompson that&#39;s why I said it can be interpreted as one, if it is what the programmer wants. Edit: ok, got what you meant, thanks."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1473282553, "post_id": 39378926, "comment_id": 66086011, "body": "Decent answer to a crap question."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473282708, "post_id": 39378926, "comment_id": 66086074, "body": "I would reduce it to &quot;<code>char</code> and <code>char*</code> are different types&quot;."}], "tags": [], "owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "is_accepted": false, "score": 4, "last_activity_date": 1473282176, "last_edit_date": 1473282176, "creation_date": 1473282058, "answer_id": 39378926, "question_id": 39378892, "link": "https://stackoverflow.com/questions/39378892/function-with-a-pointer-in-its-declaration-why/39378926#39378926", "title": "Function with a pointer in its declaration. Why?", "body": "<ul>\n<li><code>char s_gets(char * st, int n);</code> returns a character, that's all.</li>\n<li><code>char *s_gets(char * st, int n);</code> returns a pointer to a character, which can be interpreted as a pointer to a string, if it is the programmer's will.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1473287853, "creation_date": 1473287853, "answer_id": 39380033, "question_id": 39378892, "link": "https://stackoverflow.com/questions/39378892/function-with-a-pointer-in-its-declaration-why/39380033#39380033", "title": "Function with a pointer in its declaration. Why?", "body": "<pre><code>char *s_gets(char * st, int n);\n</code></pre>\n\n<p>returns a pointer to <code>char</code>, while</p>\n\n<pre><code>char s_gets(char * st, int n);\n</code></pre>\n\n<p>returns a plain <code>char</code>.</p>\n\n<blockquote>\n  <p>I would like to ask also why is there a pointer in the function declaration in the first place? What is its purpose?</p>\n</blockquote>\n\n<p>It indicates that the function returns a <em>pointer</em> value.  </p>\n\n<p>C declaration syntax uses something called a <em>declarator</em> to convey the pointer-ness, array-ness, function-ness, or combination thereof of an item.  For example, take the declaration</p>\n\n<pre><code>int *p;\n</code></pre>\n\n<p>The <em>type</em> of <code>p</code> is <code>int *</code> (pointer to <code>int</code>).  The type is specified by the combination of the type specifier <code>int</code> and the <em>declarator</em> <code>*p</code>.  The <code>int</code>-ness of <code>p</code> is given by the type specifier <code>int</code> and the pointer-ness is given by the declarator <code>*p</code>.  </p>\n\n<p>If you substitute <code>p</code> with <code>f(void)</code>, you get</p>\n\n<pre><code>int *f(void); \n</code></pre>\n\n<p>The type of <code>f</code> is \"function returning pointer to <code>int</code>\".  The pointer-ness and function-ness of <code>f</code> are specified with the declarator <code>*f(void)</code>.  </p>\n\n<p>For any type <em><code>T</code></em> and any declarator <em><code>D</code></em>, the following are true:</p>\n\n<pre><code>T D;        // D is an instance of T\nT D[N];     // D is an array of T\nT D();      // D is a function returning T\n\nT *D;       // D is a *pointer* to T\nT *D[N];    // D is an array of pointers to T\nT *D();     // D is a function returning a pointer to T\n\nT (*D)[N];  // D is a pointer to an array of T\nT (*D)();   // D is a pointer to a function returning T\n</code></pre>\n\n<p>In both declarations and expressions, the postfix <code>[]</code> subscript and <code>()</code> function-call operators have higher precedence than unary <code>*</code>, so <code>*a[N]</code> will always be parsed as <code>*(a[N])</code> (array of pointers).  To declare something as a pointer <em>to an array</em> or a pointer <em>to a function</em>, you need to explicitly group the <code>*</code> operator with the declarator using parentheses.  </p>\n\n<p>Declarators can get arbitrarily complex:</p>\n\n<pre><code>T (*D())[N];      // D is a function returning a pointer to an array of T\nT (*D[N])();      // D is an array of pointers to functions returning T\nT *(*(*D)[N])[M]; // D is a pointer to an array of pointers to an array of pointers to T\n</code></pre>\n"}], "owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1473287853, "creation_date": 1473281911, "question_id": 39378892, "link": "https://stackoverflow.com/questions/39378892/function-with-a-pointer-in-its-declaration-why", "title": "Function with a pointer in its declaration. Why?", "body": "<p>Not sure if the title explains it. What is the difference between:</p>\n\n<pre><code>char *s_gets(char * st, int n);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>char s_gets(char * st, int n);\n</code></pre>\n\n<p>I would like to ask also why is there a pointer in the function declaration in the first place? What is its purpose?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1473281444, "post_id": 39378746, "comment_id": 66085495, "body": "Yes. Is that all?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1473281537, "post_id": 39378746, "comment_id": 66085547, "body": "... and use <code>(sizeof analysis_space &#47; sizeof analysis_space[0])</code> for the element count. <code>()</code> not needed after <code>sizeof</code> when item is an object."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1473281591, "post_id": 39378746, "comment_id": 66085571, "body": "@chux I find it more readable with <code>()</code>..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473281694, "post_id": 39378746, "comment_id": 66085609, "body": "Also:  <code>sizeof</code> returns type <code>size_t</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473282942, "post_id": 39378746, "comment_id": 66086174, "body": "@EugeneSh. Agreed. As you know brackets are needed for a type but not for a variable, but a statement like <code>ptr = malloc(elements * sizeof * ptr);</code> is more readable as <code>ptr = malloc(elements * sizeof(*ptr));</code> However I have seen complaints that &quot;<code>sizeof</code> is not a function.&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473283488, "post_id": 39378746, "comment_id": 66086397, "body": "@WeatherVane: You mean parentheses (<code>()</code>)? Brackets are square (<code>[]</code>)."}, {"owner": {"reputation": 193, "user_id": 6079824, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66858cc4efcc57b306294ea130a731f?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6079824/patrick"}, "edited": false, "score": 0, "creation_date": 1473283549, "post_id": 39378746, "comment_id": 66086412, "body": "@EugeneSh.How about the additional question. Thanks for all your answers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473283679, "post_id": 39378746, "comment_id": 66086457, "body": "@Olaf so you spotted my subtext, well done! As we say &quot;if the hat fits, wear it&quot;."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473283751, "post_id": 39378746, "comment_id": 66086479, "body": "@Patrick No. But come on. Ask a real question, not the yes/no ones..."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473283841, "post_id": 39378746, "comment_id": 66086514, "body": "@chux: More generally, the operand of <code>sizeof</code> can be either a parenthesized type name or an <i>expression</i> (not just an object). (Specifically a <i>unary-expression</i>.) As for the parentheses, I personally find <code>sizeof foo</code> clearer than <code>sizeof(foo)</code>, precisely because <code>sizeof</code> is an operator (and a keyword), not a function. It&#39;s similar to using <code>return foo;</code> rather than <code>return(foo);</code>. It&#39;s not a function call, so it shouldn&#39;t look like a function call. OTOH, <code>sizeof (foo)</code> is perfectly legal; <code>(foo)</code> is a parenthesized expression."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473283851, "post_id": 39378746, "comment_id": 66086517, "body": "@WeatherVane: To be honest: I did not (not really good at that). There&#39;s just enough confusion about those names, so I wanted to state that clear. But maybe that&#39;s mostly a problem of us non-native speakers."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1473283904, "post_id": 39378746, "comment_id": 66086533, "body": "@Olaf: These <code>(</code> <code>)</code> are very commonly called &quot;brackets&quot; in UK English. It&#39;s best to show the actual characters where there might be any confusion, or to refer to &quot;square brackets&quot; and &quot;curly braces&quot;."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1473284008, "post_id": 39378746, "comment_id": 66086573, "body": "<code>analysis_space[0] = &#39;\\0&#39;</code> isn&#39;t going to compile, since <code>analysis_space[0]</code> is of type <code>struct Analysis</code>, not some scalar type. There&#39;s no need to initialize the array before storing results in it, as long as you&#39;re careful not to read elements that haven&#39;t had values assigned to them."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473284045, "post_id": 39378746, "comment_id": 66086586, "body": "As a non-native English speaker I find the word &quot;parentheses&quot; and its singular form rather difficult to spell, so replacing it with &quot;brackets&quot; in most cases :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473284070, "post_id": 39378746, "comment_id": 66086593, "body": "@KeithThompson: As most times for C questions, I refered to the C standard. But agreed, that is EN_US. OTOH, I never saw something different for &quot;parentheses&quot; than those round things <code>()</code>. The confusion is more - as you wrote - about the other two (three if we add the angular whatevers <code>&lt;&gt;</code> of C++."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473284136, "post_id": 39378746, "comment_id": 66086614, "body": "There is a definite difference in opinion. Similarly if I have an expression which computes a boolean value to be returned by a function (or assigned to a variable) I will use brackets for clarity, although redundant."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473284176, "post_id": 39378746, "comment_id": 66086630, "body": "@Olaf: Yes, I think &quot;parentheses&quot; is unambiguous. <code>&lt;</code> and <code>&gt;</code> (when used in pairs rather than as less-than and greater-than operators, or half of a shift operator) are commonly called &quot;angle brackets&quot;."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473284197, "post_id": 39378746, "comment_id": 66086641, "body": "Well, German has actually one word for all (&quot;Klammern&quot;), so we indeed <b>have to</b> qualify them anyway. But I got used to the english terms (wonder how that happended ... :-)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473284211, "post_id": 39378746, "comment_id": 66086648, "body": "@EugeneSh.: Perhaps &quot;parens&quot; would be easier?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473284236, "post_id": 39378746, "comment_id": 66086653, "body": "@KeithThompson: &quot;Paren<b>t</b>s&quot;? ;-) Maybe that is some close-to-false friend thing? I also have some words I have to think twice."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473284291, "post_id": 39378746, "comment_id": 66086677, "body": "@Olaf: No, &quot;parens&quot;. It&#39;s a common abbreviation for &quot;parentheses&quot;. (I saw the smiley, but I&#39;m taking the question seriously anyway.)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473284412, "post_id": 39378746, "comment_id": 66086726, "body": "@KeithThompson: Hmm, thanks; I was never sure if that is commonly accepted or more of a &quot;slang&quot;. As a student I once (long time ago) got a harsh comment for using &quot;nibble&quot; in a FPGA-documentation (yes, I know since long time that Dr. Ing. was wrong). Since then I&#39;m careful, if I&#39;m not really sure."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473284845, "post_id": 39378746, "comment_id": 66086882, "body": "@Patrick your gentle reminder about the second question, initialising a <code>struct</code>. Your idea <code>analysis_space[0] = &#39;\\0&#39;;</code> is the wrong type. I suggest <code>struct Analysis analysis_space[32] = {0};</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1473285488, "post_id": 39378746, "comment_id": 66087125, "body": "the answer to your last question is &#39;no&#39;, you can use it directly. People are showing you how to set it to empty, but you dont need to do that before you can set it to a valid entry"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1473285543, "last_edit_date": 1495542167, "creation_date": 1473284669, "answer_id": 39379468, "question_id": 39378746, "link": "https://stackoverflow.com/questions/39378746/size-of-each-element-of-a-struct-array-in-c/39379468#39379468", "title": "size of each element of a struct array in c", "body": "<blockquote>\n  <p>... to get the size of each one of <code>analysis_space</code>, It should be <code>sizeof(analysis_space[0])</code> which returns the size of each element.</p>\n</blockquote>\n\n<p><code>sizeof(analysis_space[0])</code> returns the value of the <code>char</code> size of <code>analysis_space[0]</code>.  The type returned is <code>size_t</code> and the matching <code>printf()</code> specifier is <code>\"%zu\"</code>, <code>\"%zX\"</code> and others.  When using the <code>sizeof</code> operator, code needs to use <code>()</code> with types.  <code>()</code> are optional with objects.</p>\n\n<pre><code>printf(\"One element size %zu\\n\", sizeof analysis_space[0]);\n</code></pre>\n\n<blockquote>\n  <p>And <code>sizeof(analysis_space)</code> returns the whole array size?</p>\n</blockquote>\n\n<p>Yes,</p>\n\n<pre><code>printf(\"Array size %zu\\n\", sizeof analysis_space);\n</code></pre>\n\n<blockquote>\n  <p>I suppose to initialize it before I store results into it? Something like: <code>analysis_space[0] = '\\0'</code> ?</p>\n</blockquote>\n\n<p><code>analysis_space[0] = '\\0'</code> is an assignment, not initialization.  Further, <code>struct Analysis</code> expects a structure assignment/initialization, not scalar.  Initialization is not required before <em>writing</em>\n to it. <a href=\"https://stackoverflow.com/questions/39378746/size-of-each-element-of-a-struct-array-in-c?noredirect=1#comment66087125_39378746\">@pm100</a></p>\n\n<pre><code>struct Analysis {\n   int a;\n   double b;\n};\n\n// Sample initialization\nstruct Analysis analysis_space[32] = { \n    {0, 0.0}, {1, 1.0} , {2, 2.0} }; // remainder zero initialized.\n</code></pre>\n\n<p>To compute the array element count: </p>\n\n<pre><code>// the type of the quotient is size_t\n#define analysis_space_N (sizeof analysis_space / sizeof analysis_space[0])\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 6079824, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66858cc4efcc57b306294ea130a731f?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6079824/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473285543, "creation_date": 1473281257, "last_edit_date": 1473283291, "question_id": 39378746, "link": "https://stackoverflow.com/questions/39378746/size-of-each-element-of-a-struct-array-in-c", "title": "size of each element of a struct array in c", "body": "<p>First, I have a struct here:</p>\n\n<pre><code>//Space to store the results for analysis map\nstruct Analysis analysis_space[32];\n</code></pre>\n\n<p>Each element of analysis_space array is for one file to store the results by some calculations;</p>\n\n<p>So, my question is </p>\n\n<p>If I want to get the size of each one of analysis_space,</p>\n\n<p>It should be <code>sizeof(analysis_space[0])</code> which returns the size of each element.</p>\n\n<p>And <code>sizeof(analysis_space)</code> returns the whole array size? </p>\n\n<p>Additional question:</p>\n\n<p>Since analysis_space is an array, I suppose to initialize it before I store results into it?</p>\n\n<p>Something like: <code>analysis_space[0] = '\\0'</code> ?</p>\n"}, {"tags": ["c", "ibm-midrange"], "comments": [{"owner": {"reputation": 2113, "user_id": 2338816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdca08e3dceb1f254e907d6f4e7faec?s=128&d=identicon&r=PG", "display_name": "user2338816", "link": "https://stackoverflow.com/users/2338816/user2338816"}, "edited": false, "score": 0, "creation_date": 1473285222, "post_id": 39378068, "comment_id": 66087021, "body": "Can you edit your question to include (1) the DDS for file DISPLAY, and (2) the creation commands for the file and the program? We need to know the DSPF attributes as well as the creation options for all objects. Also, does your joblog show any error messages when you call the program?"}, {"owner": {"reputation": 787, "user_id": 6784916, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/0E15Z.png?s=128&g=1", "display_name": "aganm", "link": "https://stackoverflow.com/users/6784916/aganm"}, "reply_to_user": {"reputation": 2113, "user_id": 2338816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdca08e3dceb1f254e907d6f4e7faec?s=128&d=identicon&r=PG", "display_name": "user2338816", "link": "https://stackoverflow.com/users/2338816/user2338816"}, "edited": false, "score": 0, "creation_date": 1473286684, "post_id": 39378068, "comment_id": 66087522, "body": "@user2338816  I added what you asked. By joblog, do you mean spool files?"}], "answers": [{"tags": [], "owner": {"reputation": 2113, "user_id": 2338816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdca08e3dceb1f254e907d6f4e7faec?s=128&d=identicon&r=PG", "display_name": "user2338816", "link": "https://stackoverflow.com/users/2338816/user2338816"}, "is_accepted": true, "score": 2, "last_activity_date": 1473297041, "creation_date": 1473297041, "answer_id": 39381134, "question_id": 39378068, "link": "https://stackoverflow.com/questions/39378068/as400-what-is-the-c-equivalent-of-sndrcvf/39381134#39381134", "title": "as400: what is the C equivalent of SNDRCVF", "body": "<p>I made a few minor changes. First, for your TYPEDEFs, I used this:</p>\n\n<pre><code>// Shortcuts to the generated structs.\ntypedef MYLIB_CDSPMNU_DISPLAY_both_t input_t;\ntypedef MYLIB_CDSPMNU_DISPLAY_both_t output_t;\n</code></pre>\n\n<p>Because you specified \"both\", the referenced identifier name should have 'both' rather than 'i' or 'o'. It's not clear how you could've successfully compiled as you had it. Perhaps you had an earlier successful compilation so that your CALL command worked, but the compiled program wasn't a current version.</p>\n\n<p>Then I opened the file with this mode:</p>\n\n<pre><code>   // The file opens fine.\n   dspf = _Ropen(\"mylib/cdspmnu\", \"rr+\");\n</code></pre>\n\n<p>You had \"wr\", so it it was opened only for output (\"wr\"iting). You need it for input and output. Your joblog should show a C2M3005 \"File is not opened for read operations.\" after you CALL your program (depending on what compiled version you actually CALL).</p>\n\n<p>And I changed your _Rformat() function:</p>\n\n<pre><code>   // I tell which record format to use.\n   _Rformat(dspf, \"DISPLAY\");\n</code></pre>\n\n<p>From the ILE C/C++ Runtime Library Functions manual, the definition of _Rformat() says:</p>\n\n<blockquote>\n  <p>The <em>fmt</em> parameter is a null-ended C string. The <em>fmt</em> parameter must\n  be in uppercase.</p>\n</blockquote>\n\n<p>The format name isn't folded to uppercase like file and library names are in other places. No idea why not; it's just the way it is. Personally, I'd use uppercase wherever it actually means an uppercase name without relying on the compiler; so I'd also change a couple other places in the code.</p>\n\n<p>Technically, I also changed the DSPF source to reference the F3 key rather than the F1 key that you show in your DDS. The F1 key would normally be for 'help' functions while F3 is a standard for 'Exit'. That doesn't really matter, but it's one habit to get started. And a name or two was changed just to fit within my environment.</p>\n\n<p>No spooled files were necessary. Easiest way to view your job's \"joblog\" after a CALL command is to run a DSPJOBLOG command. Perhaps better, though, is to use the basic command entry display provided by CALL QCMD. Basic joblog messages can be toggled on/off on that display by use of the F10 key to either \"Include detailed messages\" or \"Exclude detailed messages\".</p>\n\n<p>All in all, you were pretty close. Not bad at all if this was your first attempt to work with a DSPF.</p>\n"}], "owner": {"reputation": 787, "user_id": 6784916, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/0E15Z.png?s=128&g=1", "display_name": "aganm", "link": "https://stackoverflow.com/users/6784916/aganm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 39381134, "answer_count": 1, "score": 0, "last_activity_date": 1473337601, "creation_date": 1473278249, "last_edit_date": 1473337601, "question_id": 39378068, "link": "https://stackoverflow.com/questions/39378068/as400-what-is-the-c-equivalent-of-sndrcvf", "title": "as400: what is the C equivalent of SNDRCVF", "body": "<p>I have a display file for a menu. I successfully made a working CL program which displays the menu and waits for input. Simply enough, all it does is display the file and waits for the user to press F1 to quit.</p>\n\n<p>Display file (approximation):</p>\n\n<pre><code>    A     R DISPLAY\n    A                        CA01(01 'Exit')\n    A                    2  2'some text....'\n</code></pre>\n\n<p>Creation command: <code>crtdspf file(display) srcfile(test) srcmbr(display)</code></p>\n\n<p>CL program:</p>\n\n<pre><code>PGM\nDCLF FILE(DISPLAY) RCDFMT(DISPLAY)\nLOOP: SNDRCVF\n      IF COND(&amp;IN01 *EQ '1') THEN(DO)\n          GOTO END\n      ENDDO\n      GOTO LOOP\nEND:\nENDPGM\n</code></pre>\n\n<p>Compile command: <code>crtclpgm pgm(test) srcfile(test) srcmbr(clsrc) output(*print)</code></p>\n\n<p>What is the equivalent of SNDRCVF in C?</p>\n\n<p>Here is what I've come with so far. It compiles fine, but when I call it, it does nothing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;recio.h&gt;\n\n// Include my display file. \n#pragma mapinc(\"display\",\"lib/display(display)\", \"both\", \"\")\n#include \"display\"\n\n// Shortcuts to the generated structs.\ntypedef LIB_DISPLAY_DISPLAY_i_t input_t;\ntypedef LIB_DISPLAY_DISPLAY_o_t output_t;\n\nint main(int argc, char* argv[]){\n    input_t input;\n    output_t output;\n    _RFILE* dspf;\n\n    // The file opens fine.\n    dspf = _Ropen(\"lib/display\", \"wr\");\n    if(dspf == NULL){\n        printf(\"ERROR: Display file open failed.\\n\");\n        return 0;\n    }\n\n    // I tell which record format to use.\n    _Rformat(dspf, \"display\");\n\n    // Write my file to display?\n    _Rwrite(dspf, \"\", 0);\n\n    // Wait for input.\n    _Rreadn(dspf, &amp;input, sizeof(input), __DFT);\n\n    // Close it and quit.\n    _Rclose(dspf);\n    return 0;\n}        \n</code></pre>\n\n<p>Compile command: <code>crtbndc pgm(test) srcfile(test) srcmbr(main) output(*print)</code></p>\n\n<p>Then call: <code>call test</code></p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1473282379, "post_id": 39378027, "comment_id": 66085916, "body": "Which <code>make</code> are you using?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1473284460, "post_id": 39378027, "comment_id": 66086743, "body": "first, place the macro definitions in the order they are used.  Second, when macro definitions will not change use <code>:=</code> not <code>=</code>.  Third, variable names (including macro names) that begin with <code>_</code> followed by a capital letter and begin with <code>__</code> are reserved for the system, The user should not be polluting the system name space with names like <code>_OBJ</code>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1473337351, "post_id": 39378027, "comment_id": 66107610, "body": "@user3629249, it&#39;s clear he is using gmake (gnu make) as % suffix notation is an extension of it.  What I don&#39;t have for clear is if it&#39;s possible to add more dependencies (as he does in <code>$(ODIR)&#47;%.o: %.c $(DEPS)</code>) or he has to make the dependencies not templated in a different rule."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1473283192, "creation_date": 1473283192, "answer_id": 39379161, "question_id": 39378027, "link": "https://stackoverflow.com/questions/39378027/storing-object-files-in-a-build-directory-makefile/39379161#39379161", "title": "Storing object files in a build directory (Makefile)", "body": "<p>Consider this rule:</p>\n\n<pre><code>$(ODIR)/%.o: %.c $(DEPS)\n    gcc -c -o $@ $&lt; $(CFLAGS)\n</code></pre>\n\n<p>It is a pattern rule (which is a feature specific to GNU make) describing how to build a file whose name has the form <code>$(ODIR)/%.o</code>, based on a file of form <code>%.c</code> and the various files listed in variable <code>$(DEPS)</code>.</p>\n\n<p>Supposing your files are arranged as you describe, however, and that you run <code>make</code> with the directory containing the <code>Makefile</code> as the initial working directory, that rule never applies, even though one of the intermediate targets that needs to be built indeed does match the target pattern in that rule.  That's because <em>the dependencies</em> expressed by the rule do not all exist, and <code>make</code> can't determine any way to build the missing one.</p>\n\n<p>The problem is that the dependencies you want live in subdirectories, but the rule is written to expect the .c file to be present directly in the working directory.  You want something more like this:</p>\n\n<pre><code>$(ODIR)/%.o: $(SRCDIR)/%.c $(DEPS)\n    gcc -c -o $@ $(DIRS) $(CFLAGS) $&lt;\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 3957782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef40c419e6c9920bc37bec279ee274d?s=128&d=identicon&r=PG&f=1", "display_name": "mdadurian", "link": "https://stackoverflow.com/users/3957782/mdadurian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1056, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473283192, "creation_date": 1473277994, "question_id": 39378027, "link": "https://stackoverflow.com/questions/39378027/storing-object-files-in-a-build-directory-makefile", "title": "Storing object files in a build directory (Makefile)", "body": "<p>I know this has been asked a lot, I've looked at a couple of responses but can't figure out what's wrong. I'm trying to store all my object files in a build directory. In the root folder I have my Makefile, and the following directories: include, bin, build, src, and rsrc. I want the object files stored in the build directory, and executables stored in bin. Here is my Makefile.</p>\n\n<pre><code>CFLAGS = -Wall -Werror\nDIRS = -I $(IDIR) -I $(SRCDIR) -I $(ODIR)\n\nIDIR = include\nSRCDIR = src\nODIR = build\n\n\nDEPS = include/map_reduce.h include/const.h\n\nBINS = mapreduce\n\nall: $(BINS)\n\n_OBJ = map_reduce.o main.o\nOBJ = $(patsubst %, $(ODIR)/%,$(_OBJ))\n\n$(ODIR)/%.o: %.c $(DEPS)\n    gcc -c -o $@ $&lt; $(CFLAGS)\n\nmapreduce: $(OBJ)\n    gcc $(CFLAGS) $(DIRS) $^ -o $@ \n\n\nclean:\n    rm -f *.o $(BINS)\n</code></pre>\n\n<p>I currently don't have a rule for storing executables in the bin folder, but I figure if I can understand how to store the object files in build then that part should not be difficult. </p>\n\n<p>I'm getting the error \"No rule to make target build/map_reduce.o needed by mapreduce\"</p>\n\n<p>Any insight to help me understand what's going on here would be greatly appreciated!</p>\n"}, {"tags": ["c", "pointers", "struct", "raw-sockets"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1473277634, "post_id": 39377902, "comment_id": 66083791, "body": "Commentary: I know a lot of old code uses <code>short</code>, <code>int</code>, etc. but I find the better way to go is <code>uint16_t</code>. And not only that, but typedef it and use <code>uint16be_t</code> for Big Endian. In C it can&#39;t be enforced, which makes C++ better because you can construct a C++ class that makes it impossible to get the BE and LE integers mixed up."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1473277716, "post_id": 39377902, "comment_id": 66083835, "body": "Although, actually, you can in C build it as <code>typedef struct { uint16_t value; } uint16be;</code> and only access it using inline getter and setter functions."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1473277733, "post_id": 39377902, "comment_id": 66083844, "body": "I think the example you linked to has everything you need, including the <code>memcpy</code> ..."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1473277909, "post_id": 39377902, "comment_id": 66083918, "body": "Also &quot;copying a data structure to a char array&quot; is exactly what you need, because all that you can send to a network is bytes. AKA a char array."}, {"owner": {"reputation": 311, "user_id": 2030998, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/84080a7f0e855ba320bae612ac2bf907?s=128&d=identicon&r=PG", "display_name": "mazkopolo", "link": "https://stackoverflow.com/users/2030998/mazkopolo"}, "edited": false, "score": 0, "creation_date": 1473277957, "post_id": 39377902, "comment_id": 66083939, "body": "I have used memcpy(data, pd-&gt;dns,12); and memcpy (data+12, pd-&gt;data, strlen(data); but I got funny errors."}, {"owner": {"reputation": 311, "user_id": 2030998, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/84080a7f0e855ba320bae612ac2bf907?s=128&d=identicon&r=PG", "display_name": "mazkopolo", "link": "https://stackoverflow.com/users/2030998/mazkopolo"}, "edited": false, "score": 0, "creation_date": 1473278031, "post_id": 39377902, "comment_id": 66083968, "body": "isn&#39;t data defined as char * data in the example code? (line 64)"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1473278158, "post_id": 39377902, "comment_id": 66084025, "body": "don&#39;t use <code>strlen(data)</code> for binary data. Did you allocate space for your destination buffer?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1473278201, "post_id": 39377902, "comment_id": 66084041, "body": "Funny errors need to be a lot more specific. I&#39;m betting, completely at random, that your code is copying into <code>data</code> without allocating any memory for it. You have a <code>char data[0]</code> in that struct, which is a non-standard C extension supported by most compilers, but all that does is create a pointer offset for you at the end of the struct. You still have to malloc the space past the end."}, {"owner": {"reputation": 311, "user_id": 2030998, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/84080a7f0e855ba320bae612ac2bf907?s=128&d=identicon&r=PG", "display_name": "mazkopolo", "link": "https://stackoverflow.com/users/2030998/mazkopolo"}, "edited": false, "score": 0, "creation_date": 1473281743, "post_id": 39377902, "comment_id": 66085633, "body": "I am using: data = datagram + sizeof(struct iphdr) + sizeof(struct udphdr);  and strcpy(data, pd); and I get  /usr/include/x86_64-linux-gnu/bits/string3.h:108:1: note: expected \u2018const char * restrict\u2019 but argument is of type \u2018packet_desc * {aka struct &lt;anonymous&gt; *}\u2019  __NTH (strcpy (char *__restrict __dest, const char *__restrict __src))"}, {"owner": {"reputation": 311, "user_id": 2030998, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/84080a7f0e855ba320bae612ac2bf907?s=128&d=identicon&r=PG", "display_name": "mazkopolo", "link": "https://stackoverflow.com/users/2030998/mazkopolo"}, "edited": false, "score": 0, "creation_date": 1473281837, "post_id": 39377902, "comment_id": 66085682, "body": "should I use char * data in packet_desc;"}], "owner": {"reputation": 311, "user_id": 2030998, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/84080a7f0e855ba320bae612ac2bf907?s=128&d=identicon&r=PG", "display_name": "mazkopolo", "link": "https://stackoverflow.com/users/2030998/mazkopolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1473277424, "creation_date": 1473277424, "question_id": 39377902, "link": "https://stackoverflow.com/questions/39377902/copy-struct-to-char-pointer-in-c", "title": "copy struct to char pointer in C", "body": "<p>I have the following Data Structure:</p>\n\n<pre><code>/*DNS Header Data Structure*/\nstruct dns_header {\n    unsigned short id;\n    unsigned short flags;\n    unsigned short qdcount;\n    unsigned short ancount;\n    unsigned short nscount;\n    unsigned short arcount;\n};\n\n/*DNS Packet Structure*/\ntypedef struct {\n    struct dns_header dns;\n    char data[0];\n} packet_desc;\n</code></pre>\n\n<p>and I am using </p>\n\n<pre><code>packet_desc* pd;\n</code></pre>\n\n<p>to fill up the information. Now I want to send it as a payload of UDP RAW socket described <a href=\"http://www.binarytides.com/raw-udp-sockets-c-linux/\" rel=\"nofollow\">here</a>. </p>\n\n<p>I need to copy the (pd) into a char pointer (similar to line 80 of the example code). How can I do that? I have tried different approaches explained in StackOverflow but they were mainly describing copying a data structure to a char array. </p>\n"}, {"tags": ["python", "c", "numpy"], "comments": [{"owner": {"reputation": 8147, "user_id": 2149741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1374188e1ceb9d62123af4aece7c4ee4?s=128&d=identicon&r=PG", "display_name": "Jeremy West", "link": "https://stackoverflow.com/users/2149741/jeremy-west"}, "edited": false, "score": 2, "creation_date": 1473277563, "post_id": 39377866, "comment_id": 66083759, "body": "It appears as if it stores arrays of both dimensions and strides, however. In most implementations involving array operations, this is the information actually required rather than total number of items which does nothing to help you access them systematically."}, {"owner": {"reputation": 1091, "user_id": 5302241, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b58e25a907ac8e47c48204ba7e7a45f?s=128&d=identicon&r=PG&f=1", "display_name": "rxu", "link": "https://stackoverflow.com/users/5302241/rxu"}, "reply_to_user": {"reputation": 8147, "user_id": 2149741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1374188e1ceb9d62123af4aece7c4ee4?s=128&d=identicon&r=PG", "display_name": "Jeremy West", "link": "https://stackoverflow.com/users/2149741/jeremy-west"}, "edited": false, "score": 0, "creation_date": 1473434099, "post_id": 39377866, "comment_id": 66153997, "body": "I guess I get this now. When the size of array is large, multiplying the dimensions to get the size would only take a tiny fraction of time for the whole calculation."}], "answers": [{"tags": [], "owner": {"reputation": 171439, "user_id": 5741205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SG6BE.png?s=128&g=1", "display_name": "MaxU", "link": "https://stackoverflow.com/users/5741205/maxu"}, "is_accepted": false, "score": 2, "last_activity_date": 1473277597, "creation_date": 1473277597, "answer_id": 39377943, "question_id": 39377866, "link": "https://stackoverflow.com/questions/39377866/does-numpy-internally-store-size-of-an-array/39377943#39377943", "title": "Does numpy internally store size of an array?", "body": "<p>Look at <code>PyArray_ArrayDescr *PyArray_Descr.subarray</code>:</p>\n\n<blockquote>\n  <p>If this is non- NULL, then this data-type descriptor is a C-style\n  contiguous array of another data-type descriptor. In other-words, each\n  element that this descriptor describes is actually an array of some\n  other base descriptor. This is most useful as the data-type descriptor\n  for a field in another data-type descriptor. The fields member should\n  be NULL if this is non- NULL (the fields member of the base descriptor\n  can be non- NULL however). The PyArray_ArrayDescr structure is defined\n  using</p>\n</blockquote>\n\n<pre><code>typedef struct {\n    PyArray_Descr *base;\n    PyObject *shape;      /* &lt;-------- */\n} PyArray_ArrayDescr;\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>PyObject *PyArray_ArrayDescr.shape\n</code></pre>\n\n<blockquote>\n  <p>The shape (always C-style contiguous) of the sub-array as a Python tuple.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 92118, "user_id": 1217358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2aafb97833979e3668c61d36e697bfc?s=128&d=identicon&r=PG", "display_name": "Warren Weckesser", "link": "https://stackoverflow.com/users/1217358/warren-weckesser"}, "is_accepted": true, "score": 5, "last_activity_date": 1473279168, "last_edit_date": 1473279168, "creation_date": 1473278864, "answer_id": 39378201, "question_id": 39377866, "link": "https://stackoverflow.com/questions/39377866/does-numpy-internally-store-size-of-an-array/39378201#39378201", "title": "Does numpy internally store size of an array?", "body": "<p>The size (that is, the total number of elements in the array) is computed as the product of the values in the array <code>dimensions</code>.  The length of that array is <code>nd</code>.</p>\n\n<p>In the C code that implements the core of numpy, you'll find many uses of the macro <code>PyArray_SIZE(obj)</code>.  Here's the definition of that macro:</p>\n\n<pre><code>#define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))\n</code></pre>\n\n<p>The advantage of not storing it is, well, not storing redundant data.</p>\n"}], "owner": {"reputation": 1091, "user_id": 5302241, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b58e25a907ac8e47c48204ba7e7a45f?s=128&d=identicon&r=PG&f=1", "display_name": "rxu", "link": "https://stackoverflow.com/users/5302241/rxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 39378201, "answer_count": 2, "score": 3, "last_activity_date": 1473279168, "creation_date": 1473277273, "question_id": 39377866, "link": "https://stackoverflow.com/questions/39377866/does-numpy-internally-store-size-of-an-array", "title": "Does numpy internally store size of an array?", "body": "<p>From specification of a numpy array at <a href=\"http://docs.scipy.org/doc/numpy-1.10.0/reference/c-api.types-and-structures.html#c.PyArrayObject\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>typedef struct PyArrayObject {\n    PyObject_HEAD\n    char *data;\n    int nd;\n    npy_intp *dimensions;\n    npy_intp *strides;\n    PyObject *base;\n    PyArray_Descr *descr;\n    int flags;\n    PyObject *weakreflist;\n} PyArrayObject;\n</code></pre>\n\n<p>When I look at the specification of a numpy array, I don't see that it stores number of elements of the array. Is that really the case?</p>\n\n<p>What is the advantage of not storing that?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "pointers", "malloc", "sizeof"], "comments": [{"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "edited": false, "score": 0, "creation_date": 1473276358, "post_id": 39377615, "comment_id": 66083218, "body": "<code>sizeof</code> can take a type or a variable"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "reply_to_user": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "edited": false, "score": 1, "creation_date": 1473277184, "post_id": 39377615, "comment_id": 66083605, "body": "I guess my take on it is since they decided to cast the malloc, why not just have ThreadParms in the sizeof()?  That said, I will confess the syntax of sizeof(* something) threw me a bit.  That is my shortcoming."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1473277689, "post_id": 39377615, "comment_id": 66083821, "body": "<code>*params</code> dereferences to a <code>ThreadParams</code> type, so you&#39;ll <code>malloc</code> the full size of the structure with either method. As the answers say this saves on maintenance costs should the <code>params</code> type ever change."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1473337563, "post_id": 39377615, "comment_id": 66107768, "body": "<code>sizeof *params</code> is the same as <code>sizeof (ThreadParms)</code>, as <code>*parms</code> dereferences the pointer, getting to the full type <code>ThreadParms</code>.  What actually would be an error is to <code>malloc(sizeof(parms));</code> which is actually the pointer value, without any derreference, and should alloc the size of a pointer."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473342826, "post_id": 39377615, "comment_id": 66111693, "body": "So in the code, the parens around *parms for the sizeof are extraneous, and perhaps, even improper (though it still works fine)."}], "answers": [{"comments": [{"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473276723, "post_id": 39377648, "comment_id": 66083383, "body": "Right.  But you&#39;d still have to change the casting of the malloc in this case, no?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473276971, "post_id": 39377648, "comment_id": 66083496, "body": "no need to cast because malloc returns void* (generic pointer). I&#39;m saying that but I learned that only a few days ago and had to make a compile test to make sure :)"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 3, "last_activity_date": 1473276351, "creation_date": 1473276351, "answer_id": 39377648, "question_id": 39377615, "link": "https://stackoverflow.com/questions/39377615/use-of-malloc-in-pthreads/39377648#39377648", "title": "Use of malloc in Pthreads", "body": "<p><code>*parms</code> is of <code>ThreadParms</code> type so size is OK</p>\n\n<p>It's sometimes seen as better to do like this than the old <code>sizeof(ThreadParms)</code>, so if type of <code>parms</code> changes the size follows (the assignment and the <code>sizeof</code> statement are on the same line)</p>\n\n<p>(however that's not perfect and does not protect against a copy/paste error when allocating some other type with the same line, but it's generally better)</p>\n"}, {"comments": [{"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473276664, "post_id": 39377650, "comment_id": 66083356, "body": "I see that.  But they didn&#39;t quite do that, did they?  Because of the (unneeded) casting of the malloc? LOL.  (I&#39;m thinking they casted it to make the code C++ compliant, but I am not sure.)"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473276895, "post_id": 39377650, "comment_id": 66083460, "body": "@Jiminion I&#39;m pretty sure it&#39;s for C++, too."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473276991, "post_id": 39377650, "comment_id": 66083503, "body": "It&#39;s from a .c file.  (create.c).  Maybe it is habit.  (And I don&#39;t want to get into the cast or don&#39;t cast malloc() debate.... ) :)"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473337777, "post_id": 39377650, "comment_id": 66107911, "body": "@Jiminion, nope, that notation is valid in C++ without a cast, as <code>malloc(3)</code> in c++ has the same prototype as in C, returning a <code>void *</code>, which is compatible with any other pointer.  Indeed, malloc <b>is not a C++ function</b>.  In C++ you must use <code>new</code> and <code>delete</code> operators, and never <code>malloc(3)</code> (which is not an operator, but a library function)  If <code>malloc(3)</code> is allowed in C++ is because it (C++) is source code compatible with C, allowing you to use the majority of C functions without having to write a C++ binding for them."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1473276376, "creation_date": 1473276376, "answer_id": 39377650, "question_id": 39377615, "link": "https://stackoverflow.com/questions/39377615/use-of-malloc-in-pthreads/39377650#39377650", "title": "Use of malloc in Pthreads", "body": "<p>This is a common trick in C - using dereference pointer expression in place of the actual type.</p>\n\n<p>The rationale is as follows: if you have</p>\n\n<pre><code>some_type *some_var = malloc(sizeof(*some_var));\n</code></pre>\n\n<p>and then change <code>some_type</code> to <code>some_other_type</code>, the code would continue working fine with only one change.</p>\n\n<p>However, if you start with</p>\n\n<pre><code>some_type *some_var = malloc(sizeof(some_type));\n</code></pre>\n\n<p>then you have to change <code>some_type</code> in two places:</p>\n\n<pre><code>some_other_type *some_var = malloc(sizeof(some_other_type));\n</code></pre>\n\n<p>or your code would have an error.</p>\n\n<blockquote>\n  <p>It looks like it is allocating only a pointer (which would be an error)</p>\n</blockquote>\n\n<p>The asterisk makes <code>sizeof</code> evaluate to the size of the entire <code>struct</code>, so the code is correct.</p>\n"}, {"comments": [{"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473276523, "post_id": 39377657, "comment_id": 66083290, "body": "wouldn&#39;t sizeof(char *) evaluate to a pointer?  (Not a char?)"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473276638, "post_id": 39377657, "comment_id": 66083344, "body": "Yes. But that&#39;s not the case here. <code>sizeof</code> only needs to the <i>type</i> of <code>*parms</code> which is <code>ThreadParms</code>."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1473276828, "post_id": 39377657, "comment_id": 66083426, "body": "@dasblinkenlight Yes, just clarifying the &#39;evaluation of operand&#39; point."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1473338135, "post_id": 39377657, "comment_id": 66108201, "body": "@Jiminion, yes, but that&#39;s a type definition, not an expression.  <code>Sizeof</code> is an operator in C, and it requires parenthesis when you use a type, and does not when you are using an lvalue.  You can try <code>sizeof *parms</code> and it compiles ok, but <code>sizeof ThreadParms</code> will tell you that you need to put parenthesis around a type name. Indeed, you can assume you need an expressi&#243;n, and consider that enclosing a type in parenthesis forms a cast of the null expression to the proper type."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1473276724, "last_edit_date": 1473276724, "creation_date": 1473276391, "answer_id": 39377657, "question_id": 39377615, "link": "https://stackoverflow.com/questions/39377615/use-of-malloc-in-pthreads/39377657#39377657", "title": "Use of malloc in Pthreads", "body": "<blockquote>\n  <p>Why did they choose to malloc *parms instead of ThreadParms.</p>\n</blockquote>\n\n<p>It's a common practice to use so in case if the type of <code>parms</code> changes in the future, then maintenance is easier. But using <code>ThreadParms</code> would work just as well.</p>\n\n<blockquote>\n  <p>It looks like it is allocating only a pointer (which would be an\n  error), but it apparently allocating the size of the whole structure.\n  Is this correct?</p>\n</blockquote>\n\n<p>No. It's actually equivalent to using <code>sizeof(ThreadParms)</code> as the sizeof operator only needs the type information and it doesn't evaluate its operand (except C99 <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow\">Variable Length Arrays</a>). The type of <code>*parms</code> is <code>ThreadParms</code> and that's all <code>sizeof</code> needs to know.</p>\n\n<p>Side note: the cast to <code>ThreadParms *</code> is unnecessary in C as <code>void *</code> can be assigned any other data pointer.</p>\n"}], "owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1736, "favorite_count": 0, "accepted_answer_id": 39377650, "answer_count": 3, "score": 4, "last_activity_date": 1473344126, "creation_date": 1473276144, "last_edit_date": 1473344126, "question_id": 39377615, "link": "https://stackoverflow.com/questions/39377615/use-of-malloc-in-pthreads", "title": "Use of malloc in Pthreads", "body": "<p>This is actual C code from Pthreads:</p>\n\n<pre><code>ThreadParms *parms = NULL; \nif ((parms = (ThreadParms *) malloc (sizeof (*parms))) == NULL)\n    {\n      goto FAIL0;\n    }\n\n  parms-&gt;tid = thread;\n  parms-&gt;start = start;\n  parms-&gt;arg = arg;\n</code></pre>\n\n<p>Why did they choose to malloc *parms instead of ThreadParms?  It looks like it is allocating only a pointer (which would be an error), but it apparently allocating the size of the whole structure.  Is this correct?</p>\n"}, {"tags": ["c", "static"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473275378, "post_id": 39377411, "comment_id": 66082724, "body": "All variables can only be initialised once during their lifetime (i.e. when they come to lif). Not sure what your problem is. What do you mean with &quot;updated&quot;? They are simply written to."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1473275431, "post_id": 39377411, "comment_id": 66082745, "body": "Both programs shown here have the same output. It might help to clarify your question by showing an example where the static variable is in a function other than <code>main()</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473275519, "post_id": 39377411, "comment_id": 66082787, "body": "It makes more sense in a function other than <code>main</code> which may be called many times. The <code>static</code> local scope variable is <i>initialised</i> only once, but that is quite different from assigning another value as the code runs. The <code>static</code> qualifier just means that after the function ends, and the variable goes out of scope, it retains its value."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473275535, "post_id": 39377453, "comment_id": 66082795, "body": "The C standard does not require using a stack nor a heap. And typical implementations don&#39;t allocate statric variables on the heap, even <b>iff</b> they support one for dynamicc memory allocation."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473275553, "post_id": 39377453, "comment_id": 66082805, "body": "The edit is wrong, too. Of course static variables (like any other variable) can be access from a different subroutine. For statics, this is true even when the function has terminated."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473275712, "post_id": 39377453, "comment_id": 66082889, "body": "heap is wrong, you&#39;re right it&#39;s for malloc and such. Is that bss then? well, I have edited my question so it is more generic. after all, implementation is at the compiler discretion.."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1473275908, "post_id": 39377453, "comment_id": 66082991, "body": "This is a good answer, but I wouldn&#39;t say &quot;heap&quot; and allocated. I&#39;d use [as your edit] &quot;global memory&quot; or &quot;data segment&quot; and &quot;linked into&quot;. <code>static int x = 5</code> goes to <code>data</code> and [global scope] <code>int y;</code> goes to <code>bss</code>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473276087, "post_id": 39377453, "comment_id": 66083068, "body": "I have tried to account for all good remarks. is &quot;global linkage&quot; better?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1473276255, "post_id": 39377453, "comment_id": 66083156, "body": "No, all local variables have <i>no</i> linkage, regardless of their storage duration.  Being able to return a pointer to the variable that remains valid has nothing to do with linkage, and everything to do with duration."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473276373, "post_id": 39377453, "comment_id": 66083227, "body": "The C standard does not have &quot;global&quot; linkage. Static variables can have internal, external or no linkage. Static variables in a function have none. Anyway, that is not a matter of linkage, but storage duration. And passing the address of a local variable is common practice. Actually the code in the question shows one typical usage. There is nothing weird about that."}, {"owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473276588, "post_id": 39377453, "comment_id": 66083315, "body": "what is a linkage?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473276843, "post_id": 39377453, "comment_id": 66083435, "body": "typical me, always try to get down to assembly code. We didn&#39;t need all that linkage/heap/stack information, just the correct way to use the vars. thanks."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473276861, "post_id": 39377453, "comment_id": 66083441, "body": "@simrandhamija, linkage is, roughly, a characteristic describing what parts of a program can refer <i>directly</i> to a function or object.  It is related to &quot;scope&quot;, but the two are not the same thing."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1473277066, "post_id": 39377453, "comment_id": 66083544, "body": "In an ELF executable [at least], when you specify a global <code>static int xxx = 23;</code> you get a symbol with a <code>LOCAL</code> binding. When you have a function scoped <code>static int yyy = 37;</code> you get a symbol with <code>LOCAL</code> binding and a uniquely generated name, such as <code>yyy.1836</code>. So, they are both visible in the symbol table of the executable as they both need to be relocated when the executable is loaded."}, {"owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473277104, "post_id": 39377453, "comment_id": 66083563, "body": "I see. Since static variables maintain their value between function invocations, I was confused as to how they are &quot;updated&quot; or changed in any way. I also wanted to know how their &quot;updation&quot; is different from any non-static variable&#39;s &quot;updation&quot;."}, {"owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473277265, "post_id": 39377453, "comment_id": 66083638, "body": "@Jean-Francois Fabre also, what is edge effect? when might it be used? I am editing my question so that it can illustrate your answer :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1473277896, "post_id": 39377453, "comment_id": 66083914, "body": "damn my French betrayed me. I think it&#39;s called a side effect. Means that if you call the subroutine and ignore the results, the state of the program is different on subroutine exit. It can be a simple print to the console, write a file to disk, or modifying a global variable."}, {"owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473278479, "post_id": 39377453, "comment_id": 66084172, "body": "@Jean-Francois Fabre Thanks! edited my question so that it matches your answer :)"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1473278865, "post_id": 39377453, "comment_id": 66084352, "body": "Mais, oui. L&#39;expression idiomatique, c&#39;est <i>side effect</i>. And, I won&#39;t embarrass myself further with my long forgotten high school French. The other idiom is &quot;edge case&quot;, for something obscure/extreme that might not show up in most data, usually as a starting or ending condition. (e.g.) All prime numbers are odd, except for 2. Thus, 2 may be considered an &quot;edge case&quot;"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473279474, "post_id": 39377453, "comment_id": 66084630, "body": "A French enthusiast :) we call that &quot;effet de bord&quot; (bord=edge) also used to describe what happens on the edges, and &quot;generalized&quot; (by people who don&#39;t know zit about computers) to describe a &quot;side effect&quot;. But a side effect is not evil, it may be done on purpose and rightly!"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1473280442, "post_id": 39377453, "comment_id": 66085053, "body": "Oui. A Paris, je suis all&#233; voir la pi&#232;ce d&#39;Eug&#232;ne Ionesco, &#171;La Cantatrice chauve&#187;, en fran&#231;ais, naturellement :-) A side effect is anything a function modifies/uses that is <i>not</i> just its arguments and/or return value [or derived thereof]. That is, a function that is not <i>pure</i>. OP&#39;s first <code>foo</code> is <i>not</i> pure, because <code>a</code> is <code>static</code>. OP&#39;s second <code>foo</code> <i>is</i> pure."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 1, "creation_date": 1473282507, "post_id": 39377453, "comment_id": 66085988, "body": "@simrandhamija: If you want it exactly, read the standard: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.2\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.2.2</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1473282673, "post_id": 39377453, "comment_id": 66086056, "body": "@CraigEstey: I don&#39;t see anything about that - or the requirement to use ELF - in the C standard. I think this is TMI for OP."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1473283127, "post_id": 39377453, "comment_id": 66086255, "body": "@CraigEstey: Edge case is not the same as side-effect. A side-effect is something not along the straight program flow, an edge-case is when values are at the edge of range. Those are the most interesting cases when testing software, as they often generate unexpected (and unwanted) results."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473283992, "post_id": 39377453, "comment_id": 66086568, "body": "@Olaf ELF was a practical example, but works for a.out, COFF, etc as well because it <i>has</i> to. It is how the compiler must generate the symbol(s) to support <code>void foo(void) { static int x = 72; } void bar(void) { static int x = 97; } in the same </code>.c` file. An <code>nm</code> would show these as type <code>d</code> (vs. <code>D</code>). Or, you could never have <code>static</code> anything because you couldn&#39;t link it/to it."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473284534, "post_id": 39377453, "comment_id": 66086768, "body": "@Olaf I had two comments about &quot;side effect&quot; and &quot;edge case&quot;. In the first one I said: &quot;The idiomatic expression is <i>side effect</i>&quot;. And, then [in the same comment], I said: &quot;The <i>other</i> idiom is &#39;edge case&#39;&quot;. But, saying this doesn&#39;t imply that the two terms are synonymous [nor did I intend it that way]. If you look at both comments, I believe you&#39;ll see that I got both terms correct. In context [of a &quot;pure&quot; function], side effect is as I&#39;ve described."}, {"owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473291294, "post_id": 39377453, "comment_id": 66088767, "body": "@olaf thankyou for pointing out that subtle distinction between side-effect and edge-case. I should post this topic as a seperate question perhaps."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 1, "creation_date": 1473298444, "post_id": 39377453, "comment_id": 66090247, "body": "@simrandhamija: Please not on this site! They are common terms and not directly related to programming."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 5, "last_activity_date": 1473277781, "last_edit_date": 1473277781, "creation_date": 1473275415, "answer_id": 39377453, "question_id": 39377411, "link": "https://stackoverflow.com/questions/39377411/initialization-and-updation-of-variable-types/39377453#39377453", "title": "Initialization and updation of variable types", "body": "<p><strong>in your first example</strong>, the static variable has local scope, but has the same lifecycle as a global variable, and initialized once at program startup.  You do that when you want to achieve a side effect\n(something is initialized, global function call counter...: calling the subroutine has an effect even if it returns nothing...)</p>\n\n<p>It has the same address at every call (which means you could return its address and modify it from somewhere).</p>\n\n<p><strong>in your second example</strong>, you define an auto variable, allocated and initialized each time. It may have a different address depending on the call chain (in all calls, recursive, threaded, the variable is guaranteed to be unique, and not modifiable by other calls/threads: no edge effect, reetrant)</p>\n\n<p>Won't make much difference on a <code>main()</code>, but if you put that in a subroutine, in the first case, 2 consecutive calls will yield a different result (2,3, then 3,4), whereas in the second case, 2 consecutive calls will yield the same result (2,3 twice)</p>\n"}, {"comments": [{"owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473278714, "post_id": 39378024, "comment_id": 66084286, "body": "as per your answer, it is possible to assign a variable without initializing it (in your second piece of code you declare a and assign it a value.)  What constitutes initialization then?"}, {"owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473278903, "post_id": 39378024, "comment_id": 66084379, "body": "also, what do you mean by side effect?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473280729, "post_id": 39378024, "comment_id": 66085154, "body": "@simrandhamija, Initialization is the process of giving a variable the value that it has <i>at the beginning</i> of its lifetime.  From the perspective of C semantics, variables have their initial values as soon as they come into existence.  In particular, all variables with static duration have their initial values by the time execution begins in <code>main()</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 0, "creation_date": 1473280887, "post_id": 39378024, "comment_id": 66085229, "body": "@simrandhamija, all variables with static storage duration are initialized.  If you do not specifiy an explicit initializer, then they take an initial value specified by C.  Automatic variables, on the other hand, (local variables not declared <code>static</code>) have an indeterminate initial value if you do not provide an explicit initializer.  Not only <i>may</i> you assign a value to such variables, you <i>must</i> assign a value to such variables before you use their values.  If you do not do so then undefined behavior results."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 1, "creation_date": 1473281116, "post_id": 39378024, "comment_id": 66085340, "body": "@simrandhamija: Yes, you may assign to a variable without first initializing it.  A <code>static</code> variable (declared with the <code>static</code> keyword or at file scope) is implicitly initialized to zero, depending on its type.  An <code>auto</code> variable (declared within a function or block without the <code>static</code> keyword) without an initializer has an <i>indeterminate</i> value, which can include a <i>trap representation</i> (a bit pattern that doesn&#39;t correspond to a valid value for that type).  Attempting to read an uninitialized <code>auto</code> variable leads to undefined behavior."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "edited": false, "score": 1, "creation_date": 1473281226, "post_id": 39378024, "comment_id": 66085389, "body": "@simrandhamija, every expression in C whose type is not <code>void</code> produces a value.  Expressions may also have other effects on the execution environment, such as modifying the value of a variable -- all such effects other than computation of the value are &quot;side effects&quot;.  For example, evaluating the expression <code>a = 2</code> yields the value 2, and has the side effect of setting <code>a</code>&#39;s value to 2.  Evaluating the expression <code>puts(&quot;Hello world!&quot;)</code> produces a value indicative of the success or failure of the function in causing the <i>side effect</i> of sending the string to the standard output."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1473277973, "creation_date": 1473277973, "answer_id": 39378024, "question_id": 39377411, "link": "https://stackoverflow.com/questions/39377411/initialization-and-updation-of-variable-types/39378024#39378024", "title": "Initialization and updation of variable types", "body": "<blockquote>\n  <p>How is the static variable updated?</p>\n</blockquote>\n\n<p>I suspect you are getting confused by the fact that a variable declaration that includes an initializer is syntactically similar to an assignment expression.  The fact that a variable with static duration (or any other variable) is initialized at most once does not have anything to do with how you can modify that variable later.  It is a statement about program semantics, not a restriction on your code.</p>\n\n<p>Alternatively, you are perhaps confused about the difference between \"initialization\" and \"assignment\".  These have specific, different meanings in this context.  This contains an initialization of variable <code>a</code>, but no assignment to it:</p>\n\n<pre><code>int main() {\n   int a = 2;  /* initialization */\n   printf(\"%d\",a);\n}\n</code></pre>\n\n<p>This contains an assignment to variable <code>a</code>, but no initialization of it:</p>\n\n<pre><code>int main() {\n   int a;  /* no initialization */\n   a = 2;  /* assignment */\n   printf(\"%d\",a);\n}\n</code></pre>\n\n<p>This contains both an initialization of <code>a</code> and an assignment to it:</p>\n\n<pre><code>int main() {\n   int a = 2;\n   printf(\"%d\",a);\n   a = 3;\n   printf(\"%d\",a);\n}\n</code></pre>\n\n<p>You can update a static variable via any operator suitable for its type that has a side effect of modifying its operand (<code>=</code>, <code>+=</code>, <code>++</code>, <em>etc</em>.), or in any number of indirect ways via pointer.  For most purposes, code using a variable does not need to pay any attention to its storage duration.  In particular, the two examples above are equally valid and produce the same output if variable <code>a</code> is made static.  Don't take that to mean that static variables are without characteristic uses, but \"What are static variables useful for?\" is an entirely separate question.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 4, "last_activity_date": 1473280569, "creation_date": 1473280569, "answer_id": 39378580, "question_id": 39377411, "link": "https://stackoverflow.com/questions/39377411/initialization-and-updation-of-variable-types/39378580#39378580", "title": "Initialization and updation of variable types", "body": "<p>A different example may make this a bit more clear.</p>\n\n<p>Assume you have the following function:</p>\n\n<pre><code>void foo( void )\n{\n  int a = 1;\n  printf( \"&amp;a = %p, a = %d\\n\", (void *) &amp;a, a++ );\n}\n</code></pre>\n\n<p>We create a variable <code>a</code> with an initial value of <code>1</code>, print out its address and value, and then increment it.  This variable is not visible outside the scope of the <code>foo</code> function.  </p>\n\n<p>The variable <code>a</code> has <code>auto</code> storage duration; its <em>lifetime</em> is limited to the lifetime of the <code>foo</code> function.  A new instance of <code>a</code> will be created and initialized every time <code>foo</code> is entered, and that instance is destroyed every time <code>foo</code> exits<sup>1</sup>.  </p>\n\n<p>Now we add the <code>static</code> keyword to the declaration:</p>\n\n<pre><code>void foo( void )\n{\n  static int a = 1;\n  printf( \"&amp;a = %p, a = %d\\n\", (void *) &amp;a, a++ );\n}\n</code></pre>\n\n<p><code>a</code> now has <em><code>static</code></em> storage duration; a <em>single</em> instance of <code>a</code> is created and initialized <em>once</em> at program startup, and that instance is maintained until the program exits.  <code>a</code> is still only visible by name within the scope of <code>foo</code>, but its <em>lifetime</em> extends beyond the lifetime of the <code>foo</code> function.  </p>\n\n<p>In both cases, the value of <code>a</code> is updated in exactly the same way; we update the contents of the memory location that <code>a</code> corresponds to.  The only difference is how the contents of that memory location are maintained over the lifetime of the program.</p>\n\n<p>To drive this home, take the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid foo( void )\n{\n  int a = 1;\n  printf( \"&amp;a = %p, a = %d\\n\", (void *) &amp;a, a );\n  a++;\n}\n\nvoid bar( void )\n{\n  int b = 2;\n  foo();\n  printf( \"&amp;b = %p, b = %d\\n\", (void *) &amp;b, b );\n  b++;\n}\n\nvoid bletch( void )\n{\n  int c = 3;\n  bar();\n  printf( \"&amp;c = %p, c = %d\\n\", (void *) &amp;c, c );\n  c++;\n}\n\nint main( void )\n{\n  foo();\n  bar();\n  bletch();\n  bar();\n  foo();\n  return 0;\n}\n</code></pre>\n\n<p>All of <code>a</code>, <code>b</code>, and <code>c</code> are declared <code>auto</code> (which is the default).  When I build and run this code, I get the following output:</p>\n\n<pre><code>&amp;a = 0x7fff701d234c, a = 1\n&amp;a = 0x7fff701d232c, a = 1\n&amp;b = 0x7fff701d234c, b = 2\n&amp;a = 0x7fff701d230c, a = 1\n&amp;b = 0x7fff701d232c, b = 2\n&amp;c = 0x7fff701d234c, c = 3\n&amp;a = 0x7fff701d232c, a = 1\n&amp;b = 0x7fff701d234c, b = 2\n&amp;a = 0x7fff701d234c, a = 1\n</code></pre>\n\n<p>New instances of <code>a</code>, <code>b</code>, and <code>c</code> are created and initialized when their respective functions are entered and destroyed when the functions exit.  They get different addresses depending on where the functions are in the call chain<sup>2</sup>.  </p>\n\n<p>If I change that code such that <code>a</code> is declared </p>\n\n<pre><code>static int a = 1;\n</code></pre>\n\n<p>I get the following output:</p>\n\n<pre><code>&amp;a = 0x500a58, a = 1\n&amp;a = 0x500a58, a = 2\n&amp;b = 0x7fffd1e75ccc, b = 2\n&amp;a = 0x500a58, a = 3\n&amp;b = 0x7fffd1e75cac, b = 2\n&amp;c = 0x7fffd1e75ccc, c = 3\n&amp;a = 0x500a58, a = 4\n&amp;b = 0x7fffd1e75ccc, b = 2\n&amp;a = 0x500a58, a = 5\n</code></pre>\n\n<p>So, a couple of things are immediately apparent - the address of <code>a</code> doesn't change with each call to <code>foo</code>, and the value of <code>a</code> is not re-initialized every call.  Again, the instance for <code>a</code> is created and initialized <em>once</em> when the program starts up, and that instance persists beyond the lifetime of <code>foo</code>.  </p>\n\n<p>Declaring <code>b</code> as <code>static</code> gives us</p>\n\n<pre><code>&amp;a = 0x500a58, a = 1\n&amp;a = 0x500a58, a = 2\n&amp;b = 0x500a5c, b = 2\n&amp;a = 0x500a58, a = 3\n&amp;b = 0x500a5c, b = 3\n&amp;c = 0x7fffc301f8cc, c = 3\n&amp;a = 0x500a58, a = 4\n&amp;b = 0x500a5c, b = 4\n&amp;a = 0x500a58, a = 5\n</code></pre>\n\n<p>Don't read too much into the address values themselves; that all depends on the platform.  Obviously, on my platform, <code>static</code> items are stored in a very different location than <code>auto</code> items, but another platform might not show as obvious a difference.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>In practice, the space for <code>auto</code> variables is taken from the runtime stack, although that's an implementation detail, not a language requirement.  \n<li>Notice how the same addresses may be re-used for different objects depending on where the function is in the call chain. \n</ol>\n\n<p></sup></p>\n"}, {"tags": [], "owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "is_accepted": true, "score": 0, "last_activity_date": 1473780915, "last_edit_date": 1495535354, "creation_date": 1473780915, "answer_id": 39473926, "question_id": 39377411, "link": "https://stackoverflow.com/questions/39377411/initialization-and-updation-of-variable-types/39473926#39473926", "title": "Initialization and updation of variable types", "body": "<p>The question aims to draw out how static variables are modified, given the fact that static variables maintain their value between function invocations. I also wanted to know how the above would be different from the modification of any non-static variable.</p>\n\n<p>As per the answers posted, it turns out that <em>all</em> variables are modified either <em>directly</em> (via operands) or <em>indirectly</em> (via pointers). </p>\n\n<p><strong>However, the answers posted emphasize the difference in storage duration of static and non-static variables.</strong></p>\n\n<p>Firstly, it is important that one understands the difference between <em>Initialization</em>, <em>Declaration</em> and <em>Assignment</em>, as pointed out (quite consicely) by <a href=\"https://stackoverflow.com/a/39378024/5076511\">John Bollinger's answer.</a> The answer points out that none of the italicized operations performed on any kind of variable affect it's storage duration.</p>\n\n<p>Next, it is important one understands that a static variable has the same life-cycle as that of a global variable (regardless of whether the static variable has a local or global scope). This is pointed out by <a href=\"https://stackoverflow.com/a/39377453/5076511\">Jean-Francois Fabre's answer</a>. Additionally, one might rule out the play of <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.2\" rel=\"nofollow noreferrer\">linkage</a> since, as pointed out in the comments by <a href=\"https://stackoverflow.com/users/4774918/olaf\">@Olaf</a>, a local variable has no linkage, whilst a static variable might have internal,external or no linkage. However, a static variable <em>inside a function</em> has no linkage.</p>\n\n<p>Finally, one must realize how static variables behave, as pointed out brilliantly by <a href=\"https://stackoverflow.com/a/39378580/5076511\">John Bode's Answer</a></p>\n"}], "owner": {"reputation": 669, "user_id": 5076511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WubM0.jpg?s=128&g=1", "display_name": "Fabulous", "link": "https://stackoverflow.com/users/5076511/fabulous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 39473926, "answer_count": 4, "score": 3, "last_activity_date": 1473780915, "creation_date": 1473275181, "last_edit_date": 1495535354, "question_id": 39377411, "link": "https://stackoverflow.com/questions/39377411/initialization-and-updation-of-variable-types", "title": "Initialization and updation of variable types", "body": "<p>I understand that static variables are initialized only <em>once</em> during the lifetime of the program (see <a href=\"https://stackoverflow.com/questions/246564/what-is-the-lifetime-of-a-static-variable-in-a-c-function\">here</a> for reference). Also, Static variables maintain their value between function invocations. How then, are static variables modified?</p>\n\n<p>For example how is \"a\" modified in the following piece of code:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n\nvoid foo(){\n    static int a;\n    printf(\"%d\\n\",a);\n    a++;\n    printf(\"%d\\n\",a);\n}\nint main()\n{\nfoo();\nfoo();\nreturn 0;\n}\n</code></pre>\n\n<p>Contrariwise, how are non-static variables modified? more specifically, how is \"a\" modified in the following peice of code?</p>\n\n<pre><code> #include &lt;stdbool.h&gt;\n\nvoid foo(){\n    int a = 2;\n    printf(\"%d\\n\",a);\n    a++;\n    printf(\"%d\\n\",a);\n}\nint main()\n{\nfoo();\nfoo();\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "list", "logging"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473281059, "post_id": 39377379, "comment_id": 66085305, "body": "Post what you have done for <code>addmsg</code> and <code>clearlog,</code> and detail issues with the other 2."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5613947"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473292889, "post_id": 39377379, "comment_id": 66089145, "body": "Did as asked. I know as soon as I know how to do getlog I can do savelog."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473297741, "post_id": 39377379, "comment_id": 66090095, "body": "1) <code>siezeof</code> --&gt; <code>sizeof</code>  2)  <code>if ((newnode = (log_t *) (malloc(nodesize))) == NULL</code> --&gt; <code>if ((newnode = (log_t *) (malloc(nodesize))) == NULL) {</code>  3) <code>date.time;</code> --&gt; <code>data.time</code> <code>log_t *current = *headptr;</code> and <code>*headptr = NULL;</code> are wrong - unclear what you want.  5) Suggest compiling with all warning enabled and fix code until it has no warnings/errors and then post that."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473281266, "post_id": 39378690, "comment_id": 66085412, "body": "For a <i>log file</i>, better to use <code>&quot;r+&quot;</code> than <code>&quot;w+&quot;</code> to avoid re-writing history."}, {"owner": {"reputation": 61, "user_id": 4434772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8979782e33fa071e5de2bd702924124?s=128&d=identicon&r=PG&f=1", "display_name": "Developer102938", "link": "https://stackoverflow.com/users/4434772/developer102938"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1473282043, "post_id": 39378690, "comment_id": 66085771, "body": "It depends on the nature of their logging system. His logging system may read the file into memory and write the entire log out again when saving, in which case you&#39;d want w. If his log is incremental then you&#39;d want &quot;a&quot;. OP needs to understand his question and check which mode best suits his use-case."}], "tags": [], "owner": {"reputation": 61, "user_id": 4434772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8979782e33fa071e5de2bd702924124?s=128&d=identicon&r=PG&f=1", "display_name": "Developer102938", "link": "https://stackoverflow.com/users/4434772/developer102938"}, "is_accepted": false, "score": 1, "last_activity_date": 1473281040, "creation_date": 1473281040, "answer_id": 39378690, "question_id": 39377379, "link": "https://stackoverflow.com/questions/39377379/log-file-as-a-list/39378690#39378690", "title": "Log File as a List?", "body": "<p>This isn't really the correct place to ask a question of this nature. You are basically asking us to do your homework.</p>\n\n<p>Your homework questions can be broken down into two main parts though</p>\n\n<ul>\n<li>how to write to a file</li>\n<li>how to get the log as a string from the data structure, allocating memory as needed</li>\n</ul>\n\n<p>Writing to a file is easy, and this question has been asked many times before. The best resource is the standard library documentation, and you can find such here <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_fprintf.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/c_standard_library/c_function_fprintf.htm</a></p>\n\n<p>For the purpose of this question, I'll copy the salient example, which should be enough information to simply save a file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n   FILE * fp;\n\n   fp = fopen (\"file.txt\", \"w+\");\n   fprintf(fp, \"%s %s %s %d\", \"We\", \"are\", \"in\", 2012);\n\n   fclose(fp);\n\n   return(0);\n}\n</code></pre>\n\n<p>You open the file, you write the contents, you close the file, and you're done.</p>\n\n<p>Now the other part of your question, in regards to allocating enough memory for the log string.</p>\n\n<p>I would first ask the question, do they want a string containing all the log files, or just the last log file? The solution is very different for each.</p>\n\n<p>I will first say that this code:\n    int logsize = sizeof(log_t) + 1;\nis wrong. it's getting the size of the log_t struct, + 1, which is not correct. You want the size of the final string. This <code>log_t</code> struct is really the size of a <code>data_t</code> struct, plus a pointer to a <code>data_t</code>. The size of a <code>data_t</code> is the size of <code>time_t</code>, plus a char-pointer.</p>\n\n<p>First ask yourself what a log entry will even look like. The data-structure is a string, the log message, plus a time_t entity. What is the length of time_t? It actually depends how you format it. What is the length of the string? Well you don't know, you need another function to tell you this.</p>\n\n<p>The size of a single log message will be:\n    strlen(logMessage) + strlen(format(time))</p>\n\n<p>Where <code>format()</code> is a function which formats the time appropriately. You then need to recurse over all of the log entries, adding up each of their lengths. Be sure to add in memory for newlines between log-line entries, and then the final null-character.</p>\n\n<p>This should be enough help to get you started.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5613947"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1473311084, "answer_count": 1, "score": 0, "last_activity_date": 1473292839, "creation_date": 1473275037, "last_edit_date": 1592644375, "question_id": 39377379, "link": "https://stackoverflow.com/questions/39377379/log-file-as-a-list", "closed_reason": "Needs more focus", "title": "Log File as a List?", "body": "<p>For a project I have to complete a log template provided by the text book.</p>\n<p>The code provided is as follows:</p>\n<pre><code>#include &lt;time.h&gt;\ntypedef struct data_struct {\n  time_t time;\n  char *string;\n} data_t;\n\nint addmsg(data_t data);\nvoid clearlog(void);\nchar *getlog(void);\nint savelog(char *filename);\n\n//\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &quot;log.h&quot;\n\ntypedef struct list_struct {\n  data_t item;\n  struct list_struct *next;\n} log_t;\n\nstatic log_t *headptr = NULL;\nstatic log_t *tailptr = NULL;\n\nint addmsg(data_t data) {\n  return 0;\n}\n\nvoid clearlog(void) {\n}\n\nchar *getlog(void) {\n  return NULL;\n}\n\nint savelog(char *filename) {\n  return 0;\n}\n</code></pre>\n<p>Now, I think I was able to do <code>addmsg</code> and <code>clearlog</code>, but I'm coming up short for <code>getlog</code> and <code>savelog</code>.</p>\n<p>Instructions for these two functions are:</p>\n<blockquote>\n<p>The <code>getlog</code> function allocates enough space for a string containing the entire log, copies the log into this string, and returns a pointer to the string. It is the responsibility of the calling program to free this memory when necessary. A successful <code>getlog</code> call returns a pointer to the log string. An unsuccessful <code>getlog</code> call returns <code>NULL</code>.</p>\n<p>The <code>savelog</code> function saves the logged messages to a disk file. If successful, <code>savelog</code> return 0, otherwise return -1.</p>\n<p>These functions also set <code>errno</code> on failure.</p>\n</blockquote>\n<p>So far, all I have is trying to determine the size of the log, with</p>\n<pre><code>int logsize = sizeof(log_t) + 1;\n</code></pre>\n<p>I don't really know where to go from here. Any help would be appreciated.</p>\n<p>EDIT:</p>\n<p>For <code>addmsg</code>, we were given a program that had similar functionality to work with, and when adapted for this program I ended up with</p>\n<pre><code>int addmsg(data_t data) {\n  log_t *newnode;\n  int nodesize;\n  nodesize = siezeof(log_t) + strlen(data.string) + 1;\n  if ((newnode = (log_t *)(malloc(nodesize))) == NULL //can't add\n    return -1; //add failed\n  newnode-&gt;item.time = date.time;\n  newnode-&gt;item.string = (char *)newnode + sizeof(log_t);\n  strcpy(newnode-&gt;item.string, data.string);\n  newnode-&gt;next = NULL;\n  if (headptr == NULL)\n    headptr = newnode;\n  else\n    tailptr-&gt;next = newnode;\n  tailptr = newnode;\n  return 0;\n}\n</code></pre>\n<p>If it were as simple as iterating through a file, I wouldn't have an issue. I'm just not used to handling nodes and pointers. I don't know how to iterate through these (as they aren't automatically put into a file when the message is added) to find the string length and allocate the proper memory for <code>getlog</code>.</p>\n<p>For <code>clearlog</code>:</p>\n<pre><code>void clearlog(void) {\n  static log_t *current = *headptr;\n  static log_t *next;\n  while (current != NULL) {\n    next = current-&gt;next;\n    free(current);\n    current = next;\n  }\n  *headptr = NULL;\n}\n</code></pre>\n<p>This iterates through the messages, but I don't know how to implement this to copy the string in each node for <code>getlog</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 3, "creation_date": 1473274429, "post_id": 39377184, "comment_id": 66082272, "body": "<code>%u</code> is incorrect format specifier for <code>Data</code> declared as <code>char</code>"}, {"owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "edited": false, "score": 0, "creation_date": 1473274506, "post_id": 39377184, "comment_id": 66082305, "body": "Also, what values do you type in when prompted?"}, {"owner": {"reputation": 315, "user_id": 2737685, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ff361abc2689d970135f8a77c55b8f09?s=128&d=identicon&r=PG&f=1", "display_name": "yath", "link": "https://stackoverflow.com/users/2737685/yath"}, "edited": false, "score": 0, "creation_date": 1473274650, "post_id": 39377184, "comment_id": 66082379, "body": "command to run: ./out 0x1e 0x2e"}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473274935, "post_id": 39377240, "comment_id": 66082517, "body": "I tried with <code>%x</code> which should fail but it worked. Why? Because I was on a PC and it&#39;s little endian? Did the stack got corrupted afterwards?"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473275065, "post_id": 39377240, "comment_id": 66082581, "body": "It could work. However, 1) it will corrupt memory outside the Data; 2) on systems that do not allow unaligned access and in case the Data is misaligned with int type, it will cause segfault"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1473275136, "post_id": 39377240, "comment_id": 66082616, "body": "@Jean-Fran&#231;oisFabre When using the incorrect specifier like I did first (i.e. %x) the <code>sscanf</code> expects a <code>int*</code> and it may write more than just an <code>unsigned char</code>. In other words, write outside the allocated memory (and cause UB). It was a mistake from my side to write <code>%x</code> in the orginal answer- it has been corrected now (with help from Serge)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473275163, "post_id": 39377240, "comment_id": 66082628, "body": "The correct term is <i>undefined behaviour</i>. That is something one should avoid under all circumstances."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473275225, "post_id": 39377240, "comment_id": 66082658, "body": "@Olaf apart from mentioning the UB it is important to show what IS the UB ;)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473275275, "post_id": 39377240, "comment_id": 66082686, "body": "@Serge I leave that to you or the answerer."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 3, "last_activity_date": 1473276017, "last_edit_date": 1473276017, "creation_date": 1473274475, "answer_id": 39377240, "question_id": 39377184, "link": "https://stackoverflow.com/questions/39377184/reading-hex-from-command-line-to-unsigned-char-and-unsigned-short/39377240#39377240", "title": "Reading Hex from command line to unsigned char and unsigned short", "body": "<p>By using the <code>%u</code> specifier you tell <code>sscanf</code> that you want to read an <code>an unsigned int</code> in decimal format (base 10). If you want hex input (base 16) you must use the <code>%x</code> specifier. Further you need to specify the correct integer size. For <code>unsigned char</code> you will need <code>hh</code> as length modifier. Using the wrong length modifier is a cause of undefined behaviour.</p>\n\n<p>So you should try the <code>%hhx</code> specifier. Something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n    unsigned char Data = 0xff;\n\n    char argv1[20] = \"0x40\";\n\n    sscanf(argv1, \"0x%hhx\", &amp;Data);\n\n    printf(\"data is %u\\n\", Data);\n\n    return 0;\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Output: data is 64</p>\n</blockquote>\n\n<p>For <code>unsigned short</code> in hex you should use <code>%hx</code></p>\n"}, {"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 2, "last_activity_date": 1473274620, "last_edit_date": 1473274620, "creation_date": 1473274551, "answer_id": 39377270, "question_id": 39377184, "link": "https://stackoverflow.com/questions/39377184/reading-hex-from-command-line-to-unsigned-char-and-unsigned-short/39377270#39377270", "title": "Reading Hex from command line to unsigned char and unsigned short", "body": "<p>The <code>unsigned char</code> specificier for C99 and later is <code>%hhx</code></p>\n"}], "owner": {"reputation": 315, "user_id": 2737685, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ff361abc2689d970135f8a77c55b8f09?s=128&d=identicon&r=PG&f=1", "display_name": "yath", "link": "https://stackoverflow.com/users/2737685/yath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473276017, "creation_date": 1473274247, "last_edit_date": 1473274431, "question_id": 39377184, "link": "https://stackoverflow.com/questions/39377184/reading-hex-from-command-line-to-unsigned-char-and-unsigned-short", "title": "Reading Hex from command line to unsigned char and unsigned short", "body": "<pre><code>int main(int argc, char *argv[]){\n    unsigned char Data = 0xff;\n    unsigned short addr = 0xff;\n\n    sscanf(argv[1], \"%u\", &amp;Data);\n    sscanf(argv[2], \"%hu\", &amp;addr);\n\n    printf(\"data is %u addr is %hu \", Data, addr);\n\n    return 0;\n}\n</code></pre>\n\n<p>Hi, I am trying to read command line arguments of hex format into unsigned char and unsigned short. Please check the above code snippet. The output is always 0xff (initialized value). May I know what needs to be changed to read the inputs? </p>\n"}, {"tags": ["c", "zeromq"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 2850099, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/56dccb745c60548b7d2588127aa2943f?s=128&d=identicon&r=PG&f=1", "display_name": "user2850099", "link": "https://stackoverflow.com/users/2850099/user2850099"}, "edited": false, "score": 0, "creation_date": 1473359933, "post_id": 39377745, "comment_id": 66122007, "body": "Thanks for the tips - do you know of any examples of zpoller and/or zloop for czmq that you could point me to?"}, {"owner": {"reputation": 1450, "user_id": 6216811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c3f4852b869530a7fcca4d2f1d615e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6216811/david"}, "reply_to_user": {"reputation": 73, "user_id": 2850099, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/56dccb745c60548b7d2588127aa2943f?s=128&d=identicon&r=PG&f=1", "display_name": "user2850099", "link": "https://stackoverflow.com/users/2850099/user2850099"}, "edited": false, "score": 0, "creation_date": 1473374622, "post_id": 39377745, "comment_id": 66128528, "body": "I Couldn&#39;t find any examples of usage within a while loop, but there is an example of basic usage here : <a href=\"http://api.zeromq.org/czmq3-0:zpoller\" rel=\"nofollow noreferrer\">api.zeromq.org/czmq3-0:zpoller</a>. You&#39;ll need to set the 2nd argument of zpoller_wait to something positive (its a timeout in ms) and then the return value of zpoller_expired tells you it it times out rather than receiving a message."}], "tags": [], "owner": {"reputation": 1450, "user_id": 6216811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c3f4852b869530a7fcca4d2f1d615e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6216811/david"}, "is_accepted": false, "score": 2, "last_activity_date": 1473276793, "creation_date": 1473276793, "answer_id": 39377745, "question_id": 39377166, "link": "https://stackoverflow.com/questions/39377166/using-router-identity-as-an-exit-condition-for-a-simple-client-server-program/39377745#39377745", "title": "Using router identity as an exit condition for a simple client/server program", "body": "<p>The read in your server is blocking, i.e it will only return if a message was actually received.</p>\n\n<p>Here are a couple of options to get the behavior you want :</p>\n\n<ol>\n<li>Get the client to send a 'shutdown' message (much like you send a 'fetch' message) when its finished and then add logic to the server when processing the 2nd frame so it breaks out of the loop on receipt of this shutdown message.</li>\n<li>Change the server to do a non-blocking receive call (check out zpoller and zloop) and deal with the absence of messages correctly.</li>\n</ol>\n"}], "owner": {"reputation": 73, "user_id": 2850099, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/56dccb745c60548b7d2588127aa2943f?s=128&d=identicon&r=PG&f=1", "display_name": "user2850099", "link": "https://stackoverflow.com/users/2850099/user2850099"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473276793, "creation_date": 1473274182, "last_edit_date": 1473274528, "question_id": 39377166, "link": "https://stackoverflow.com/questions/39377166/using-router-identity-as-an-exit-condition-for-a-simple-client-server-program", "title": "Using router identity as an exit condition for a simple client/server program", "body": "<p>I have two separate C programs using CZMQ. One is a client and one is a server. The server transfers data from a file to the client, which writes the data received to a new file, called \"testdata_out.\" Once the client receives the final chunk of data from the server, the client exits. </p>\n\n<p>The problem is that the server sits there, waiting to send more data to the client, but the client program has exited completely. I've had a look in GDB and the server just gets stuck at </p>\n\n<pre><code>zframe_t *identity = zframe_recv( router );\n</code></pre>\n\n<p>I've done detailed logging using fprintf() to confirm that this is the case.</p>\n\n<p>I'm using the <a href=\"http://zguide.zeromq.org/c:fileio3\" rel=\"nofollow\">ZMQ File transfer model 3</a> as my example - I've copied the exact code and test it to make sure it works as well.</p>\n\n<p>Basically I'm looking for ideas - what can I use as an exit condition if identity validation doesn't work? <strong>Could I send an abort signal somehow, since I can't edit the ZeroMQ function 'zframe_recv?' Or if someone can see what the problem is with my code or setup, a fix that lets me use ID validation as an exit condition would be awesome.</strong></p>\n\n<p>Here's the server function:</p>\n\n<pre><code>int zmq_send_internal_file( struct arg_struct *args )\n{\n   struct arg_struct *input = (struct arg_struct *)args;\n   int node_num = input-&gt;node;\n   const char *fp = input-&gt;file_name;\n   int chunkNum = 0;\n   FILE *file_to_xfer = fopen( fp, \"r\" );\n   zctx_t *ctx = zctx_new( );\n   void *router = zsocket_new (ctx, ZMQ_ROUTER);\n\n   //two parts per msg so HWM is size PIPELINE * 2\n   zsocket_set_hwm (router, PIPELINE * 2);\n   char *complete_address = \"tcp://127.0.0.1:6000\";\n   if( 0 == zsocket_connect (router, complete_address ) )\n   {\n       printf(\"logging here\\n\");\n   }\n   else\n   {\n       printf(\"logging here\\n\");\n   }\n   while (true)\n   {\n        //what if we don't check the sender identity as a breaking condition?\n        //what if we check chunk size as the breaking condition instead? - this causes program to exit too early\n       //first frame in each message is the sender identity\n       zframe_t *identity = zframe_recv( router );\n       if (!identity)\n       {\n           printf(\"no identity, breaking.\\n\");\n           break; //if we can't find an id, we're all set\n       }\n       //second frame is 'fetch' command\n       char *command = zstr_recv (router);\n       assert (streq (command, \"fetch\"));\n       free (command);\n\n       //third frame is chunk offset in file\n       char *offset_str = zstr_recv (router);\n       size_t offset = atoi (offset_str);\n       free (offset_str);\n\n       fprintf( fp_clnt_log, \"%s : zmq:frame 4\\n\", time_str );\n       //fourth frame is max chunk size\n       char *chunksz_str = zstr_recv (router);\n       size_t chunksz = atoi (chunksz_str);\n       free (chunksz_str);\n\n       //read chunk of data from file\n       fseek (file_to_xfer, offset, SEEK_SET);\n       byte *data = malloc (chunksz);\n       assert (data);\n\n       //send resulting chunk to client\n       size_t size = fread (data, 1, chunksz, file_to_xfer);\n       zframe_t *chunk = zframe_new (data, size);\n       zframe_send (&amp;identity, router, ZFRAME_MORE);\n       zframe_send (&amp;chunk, router, 0);\n       chunkNum++;\n   }\n   if ( 0 == fclose( file_to_xfer ) )\n   {\n      printf(\"file_to_xfer closed successfully. \\n\");\n   }\n   else\n   {\n      printf(\"failed to close file_to_xfer. Exiting.\\n\");\n      return -1;\n   }\n      return 0;\n}\n</code></pre>\n\n<p>Here's the client function:</p>\n\n<pre><code>void\nzmq_receive_file()\n{\n   FILE *fp_out = fopen (\"/usr/vos/bin/testdata_out\",\"w\");\n   if ( NULL == fp_out )\n   {\n       printf( \"fp_out pointer is NULL.\\n\");\n   }\n       return;\n   }\n\n   zctx_t *ctx = zctx_new ();\n   void *dealer = zsocket_new (ctx, ZMQ_DEALER);\n   zsocket_bind (dealer, \"tcp://*:6000\");\n   //up to PIPELINE number of chunks can be in transit\n   size_t credit = PIPELINE;\n   size_t total = 0; //total bytes received\n   size_t chunks = 0; //total chunks received\n   size_t offset = 0; //offset of next chunk request\n   int chunkNum = 0;\n\n   while (true)\n   {\n       while (credit) //ask for next chunks until credit is 0\n       {\n           printf(\"%s : ft_server has credit, requesting next chunk...\\n\", time_str);\n           zstr_sendm (dealer, \"fetch\");\n           zstr_sendfm (dealer, \"%ld\", offset);\n           chunkNum++;\n           chunks++;\n       }\n\n       zframe_t *chunk = zframe_recv (dealer);\n       if( !chunk )\n       {\n           break; //shut down and quit\n       }\n       //if there IS a chunk, write it to testdata_out\n       else\n       {\n           size_t bytes_in_frame = zframe_size( chunk );\n           char *data = zframe_data( chunk );\n           fwrite( data, bytes_in_frame, 1, fp_out );\n       }\n\n       time_str = asctime( timeinfo );\n       chunks++;\n       credit++;\n       size_t size = zframe_size (chunk);\n       total+=size;\n\n       if (size &lt; CHUNK_SIZE)\n       {\n           printf ( \"%s : Chunk smaller than CHUNK_SIZE, all done.\\n\");\n           break; //last chunk received, exit\n\n//program exits and leaves server hanging and waiting for an identity, so it never exits\n       }\n   }\n   fclose( fp_out );\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "casting"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1473268267, "post_id": 39375727, "comment_id": 66079410, "body": "Can you provide a concrete code snippet?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1473268268, "post_id": 39375727, "comment_id": 66079411, "body": "Generic code..."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1473268680, "post_id": 39375727, "comment_id": 66079611, "body": "stab in the dark: <code>(void *) variable</code>&lt;-- the variable is probably a pointer of some sort, and is being cast to a <code>void *</code>. Similarly, <code>(void *) &amp;variable</code> is casting <i>the address for <code>variable</code></i> to a <code>void *</code>, suggesting <code>variable</code> is <b>not</b> a pointer, but you need a generic void pointer"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1473268991, "last_edit_date": 1473268991, "creation_date": 1473268335, "answer_id": 39375763, "question_id": 39375727, "link": "https://stackoverflow.com/questions/39375727/what-is-meant-by-void-variable-and-void-variable-in-c/39375763#39375763", "title": "what is meant by (void *) variable and (void *) &amp; variable in C", "body": "<p>That is to <em>consider</em> an integer value <em>as</em> a pointer (expecting to access the memory pointed out by that <em>integer</em> value), nothing else.</p>\n\n<p>However, this is not a very good practice. Quoting the <code>C11</code>, chapter \u00a76.3.2.3</p>\n\n<blockquote>\n  <p>An integer may be converted to any pointer type. Except as previously specified, the\n  result is implementation-defined, might not be correctly aligned, might not point to an\n  entity of the referenced type, and might be a trap representation.</p>\n</blockquote>\n\n<p>For a <em>safer</em> integer to pointer (and vice-versa) conversion, there are two types defined explicitly, <code>intptr_t</code> and <code>uintptr_t</code>. From chapter \u00a77.20.1.4</p>\n\n<blockquote>\n  <p>The following type designates a signed integer type with the property that any valid\n  pointer to void can be converted to this type, then converted back to pointer to void,\n  and the result will compare equal to the original pointer:</p>\n\n<pre><code>intptr_t\n</code></pre>\n</blockquote>\n\n<p>and it's unsigned counterpart, <code>uintptr_t</code>.</p>\n\n<p>The standard makes these types as <em>optional</em>, so, again, no guarantee of availability across all implementations.</p>\n\n<p>However, regarding the <code>(void *) &amp;variable</code> is to consider a pointer to a certain type as a pointer to <code>void</code>. This sometimes can be useful, if the pointer is later converted to the original type before dereferencing. That is perfectly defined behavior. Quoting the standard again (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p><strong>A pointer to an object type may be converted to a pointer to a different object type.</strong> If the\n  resulting pointer is not correctly aligned for the referenced type, the behavior is\n  undefined. <strong>Otherwise, when converted back again, the result shall compare equal to the\n  original pointer.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6805790, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yFCv8H5Atho/AAAAAAAAAAI/AAAAAAAABYM/8sdvP2wV3h0/photo.jpg?sz=128", "display_name": "Hari Ramakrishnan", "link": "https://stackoverflow.com/users/6805790/hari-ramakrishnan"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3691, "favorite_count": 0, "closed_date": 1473268369, "answer_count": 1, "score": -8, "last_activity_date": 1473268991, "creation_date": 1473268181, "last_edit_date": 1473268788, "question_id": 39375727, "link": "https://stackoverflow.com/questions/39375727/what-is-meant-by-void-variable-and-void-variable-in-c", "closed_reason": "Needs details or clarity", "title": "what is meant by (void *) variable and (void *) &amp; variable in C", "body": "<p>Normally a pointer variable can be typecasted to a void pointer by <code>(void *)Pointervariable</code> but I have seen a program where normal a <code>int</code> variable is used  as <code>(void *)variable</code> and that same <code>int</code> variable is also used as <code>(void *) &amp;variable</code>.</p>\n\n<p>what is the meaning of these two?</p>\n"}, {"tags": ["c", "cmake", "imagemagick", "magickwand"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1473264822, "post_id": 39374812, "comment_id": 66077605, "body": "Please be more specific, you mean that the compiler tells you there are undefined references to these functions?"}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1473266480, "post_id": 39374812, "comment_id": 66078474, "body": "sorry, I have edited"}, {"owner": {"reputation": 20869, "user_id": 438117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec2e8d45b1a0210065d1a4e3800f151?s=128&d=identicon&r=PG", "display_name": "emcconville", "link": "https://stackoverflow.com/users/438117/emcconville"}, "edited": false, "score": 0, "creation_date": 1473269422, "post_id": 39374812, "comment_id": 66079987, "body": "<code>ImageMagick-7</code> should be apart of <code>${ImageMagick_INCLUDE_DIRS}</code>, so the main source should only have: <code>#include &lt;MagickWand&#47;MagickWand.h&gt;</code>."}, {"owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "edited": false, "score": 0, "creation_date": 1473270680, "post_id": 39374812, "comment_id": 66080573, "body": "with <code>&lt;MagickWand&#47;MagickWand.h&gt;</code> I obtain  <code>fatal error: MagickWand&#47;MagickWand.h: File or directory not exist</code> Only with <code>&lt;MagickWand.h&gt;</code> I get the same result described in the post"}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "is_accepted": true, "score": 1, "last_activity_date": 1473273306, "creation_date": 1473273306, "answer_id": 39376941, "question_id": 39374812, "link": "https://stackoverflow.com/questions/39374812/use-imagewand-component-of-imagemagick-lib-with-cmake/39376941#39376941", "title": "Use ImageWand component of ImageMagick lib with CMake", "body": "<p>The library structure is that:</p>\n\n<pre><code>ImageMagick-7\n    \u251c\u2500\u2500 MagickCore\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 magick-config.h\n    |\n    \u2514\u2500\u2500 MagickWand\n        \u251c\u2500\u2500 MagickWand.h\n</code></pre>\n\n<p><code>MagickWand.h</code> includes some header in MagickCore.\nI fix replacing <code>include_directories(${ImageMagick_INCLUDE_DIRS})</code>\nwith <code>include_directories(/usr/local/include/ImageMagick-7)</code>.\nI don't know why but if i print <code>${ImageMagick_INCLUDE_DIRS}</code> this is not set.</p>\n"}], "owner": {"reputation": 189, "user_id": 6545142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3d6d4a23008a1b338ee7e9902a5b2a25?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Vannacci", "link": "https://stackoverflow.com/users/6545142/emanuele-vannacci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 39376941, "answer_count": 1, "score": 0, "last_activity_date": 1473273306, "creation_date": 1473264689, "last_edit_date": 1495540305, "question_id": 39374812, "link": "https://stackoverflow.com/questions/39374812/use-imagewand-component-of-imagemagick-lib-with-cmake", "title": "Use ImageWand component of ImageMagick lib with CMake", "body": "<p>I'm programming in C. I want use ImageMagick library but some fuction can't be resolved.</p>\n\n<p>This is my cMakeList.txt file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.3)\nproject(WebServer)\n\nset(CMAKE_C_COMPILER \"/usr/bin/gcc\")\n\nset(SOURCE_FILES io.c server.c lock_fcntl.c sig_handler.c thread_job.c    msg_parser.c)\nset(LIB http-parser-master/http_parser.c )\n\nset(CMAKE_USE_PTHREADS_INIT true)\nset(CMAKE_USE_PTHREADS_INIT ON)\n\nfind_package(Threads REQUIRED)\nfind_package(ImageMagick COMPONENTS ImageWand)\n\ninclude_directories(header)\ninclude_directories(http-parser-master)\n\n#include_directories(/usr/local/include/ImageMagick-7/MagickWand)\ninclude_directories(${ImageMagick_INCLUDE_DIRS})\n\nadd_executable(server ${SOURCE_FILES} ${LIB})\nadd_executable(client client.c io.c)\nadd_executable(main main.c io.c)\n\ntarget_link_libraries(main ${ImageMagick_LIBRARIES})\ntarget_link_libraries(server Threads::Threads)\n</code></pre>\n\n<p>and this is the source main.c:</p>\n\n<pre><code>#include &lt;ImageMagick-7/MagickWand/MagickWand.h&gt;\n#include \"basic.h\"\n\nvoid convert_image(char *path, float quality_factor, char *out) {\n\n    int width, height;\n    MagickWand *n_wand = NULL;\n\n    MagickWandGenesis();\n\n    m_wand = (struct MagickWand *) NewMagickWand();\n\n\n    MagickReadImage(m_wand,\"logo:\");\n\n    width = MagickGetImageWidth(m_wand);\n    height = MagickGetImageHeight(m_wand);\n\n    if((width /= 2) &lt; 1)width = 1;\n    if((height /= 2) &lt; 1)height = 1;\n\n    MagickResizeImage(m_wand,width,height,LanczosFilter,1);\n\n    MagickSetImageCompressionQuality(m_wand,95);\n\n    MagickWriteImage(m_wand,\"logo_resize.jpg\");\n\n   if(m_wand)m_wand = (struct MagickWand *) DestroyMagickWand(m_wand);\n\n    MagickWandTerminus();\n}\n</code></pre>\n\n<p>Only <code>MagickWandGenesis()</code> and <code>MagickWandTerminus()</code> are resolved.\nThe installation of the library ends correctly. How to solve?</p>\n\n<p>edit:</p>\n\n<p>Running I get the error:</p>\n\n<pre><code>/usr/local/include/ImageMagick-7/MagickWand/MagickWand.h:29:40: fatal     error: MagickCore/magick-config.h: File o directory non esistente\n #  include \"MagickCore/magick-config.h\"\n                                    ^\ncompilation terminated.\nmake[3]: *** [CMakeFiles/main.dir/main.c.o] Errore 1\nmake[2]: *** [CMakeFiles/main.dir/all] Errore 2\nmake[1]: *** [CMakeFiles/main.dir/rule] Errore 2\nmake: *** [main] Errore 2\n</code></pre>\n\n<p>I tried the solution shown here but does not work:\n<a href=\"https://stackoverflow.com/questions/16352640/imagemagick-no-such-file-or-directory\">ImageMagick No such file or directory</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473264374, "post_id": 39374680, "comment_id": 66077339, "body": "Any reason you&#39;re not using a library function like <code>inet_addr()</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1473264455, "post_id": 39374680, "comment_id": 66077394, "body": "Why do you need 4 functions? Use <code>strtok()</code> to split up the string and process it in a loop."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1473264570, "post_id": 39374680, "comment_id": 66077460, "body": "unrelated <code>bin_verify</code> is nonsense."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1473264574, "post_id": 39374680, "comment_id": 66077463, "body": "<code>separate4()</code> looks for a <code>.</code> and then copies all the characters up to the <code>.</code> into <code>a</code>. But there&#39;s no <code>.</code> after the last number."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473264651, "post_id": 39374680, "comment_id": 66077500, "body": "Why do you need two loops in each of the <code>separateX()</code> functions, one to search for <code>.</code> and then another to copy to <code>a[]</code>? Why not just copy to <code>a[]</code> in the main loop?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473266703, "post_id": 39374680, "comment_id": 66078597, "body": "<code>a[]</code> may lack null character in <code>atoi(a)</code> call."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1473267921, "post_id": 39374680, "comment_id": 66079246, "body": "<code>int n[4]; if (scanf(&quot;%d.%d.%d.%d&quot;,n,n+1,n+2,n+3) == 4)</code> gives you an array of integers to work with. All you need to do is convert each one to binary."}], "answers": [{"tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": false, "score": 1, "last_activity_date": 1473274018, "creation_date": 1473274018, "answer_id": 39377128, "question_id": 39374680, "link": "https://stackoverflow.com/questions/39374680/why-the-last-number-in-doted-decimal-is-not-converted-to-binary/39377128#39377128", "title": "why the last number in doted decimal is not converted to binary?", "body": "<p>What you have done wrong is already listed in the comments but you are doing it overly complicated, nearly Rube-Goldberg like. It is quite simple and can be done without any complicated tricks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// ALL CHECKS OMMITTED!\n\nchar *int8_to_bin(int n, char *buf)\n{\n  int i = 8;\n  // we need an unsigned integer for the bit-juggling\n  // because of two's complement numbers.\n  // Not really needed here because the input is positive\n  unsigned int N;\n  // check for proper size\n  if (n &lt; 0 || n &gt; 255) {\n    return NULL;\n  }\n  // is safe now\n  N = (unsigned int) n;\n  // we work backwards here, least significant bit first\n  // but we want it least significant bit last.\n  while (i--) {\n    // make a (character) digit out of an integer\n    buf[i] = (char) (N &amp; 0x1) + '0';\n    // shift one bit to the right and\n    // drop the least significant bit by doing it\n    N &gt;&gt;= 1;\n  }\n  // return the pointer to the buffer we got (for easier use)\n  return buf;\n}\n\nint main(int argc, char **argv)\n{\n  // keeps the intermediate integer\n  int addr;\n  // command-line argument, helper for strtol() and int8_to_bin()\n  char *s, *endptr, *cp;\n  // buffer for int8_to_bin() to work with\n  // initialize to all '\\0';\n  char buf[9] = { '\\0' };\n  // array holding the end-result\n  // four 8-character groups with three periods and one NUL\n  char binaddr[4 * 8 + 3 + 1];\n  // iterator\n  int i;\n\n  if (argc &lt; 2) {\n    fprintf(stderr, \"Usage: %s dotted_ipv4\\n\", argv[0]);\n    exit(EXIT_FAILURE);\n  }\n  // set a pointer pointing to the first argument as a shortcut\n  s = argv[1];\n\n  // the following can be done in a single loop, of course\n\n  // strtol() skips leading spaces and parses up to the first non-digit.\n  // endptr points to that point in the input where strtol() decided\n  // it to be the first non-digit\n  addr = (int) strtol(s, &amp;endptr, 0);\n\n  // work on copy to check for NULL while keeping the content of buf\n  // (checking not done here)\n  cp = int8_to_bin(addr, buf);\n  // if(cp == NULL)...\n\n  // copy the result to the result-array\n  // cp has a NUL, is a proper C-string\n  strcpy(binaddr, cp);\n\n  // rinse and repeat three times\n  for (i = 1; i &lt; 4; i++) {\n    // skip anything between number and period,\n    // (or use strchr() to do so)\n    while (*endptr != '.'){\n      endptr++;\n    }\n    // skip the period itself\n    endptr++;\n    // add a period to the output\n    strcat(binaddr, \".\");\n    // get next number\n    addr = (int) strtol(endptr, &amp;endptr, 0);\n    cp = int8_to_bin(addr, buf);\n    // if(cp == NULL)...\n    strcat(binaddr, cp);\n  }\n  printf(\"INPUT:  %s\\n\", s);\n  printf(\"OUTPUT: %s\\n\", binaddr);\n\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>We don't need a complicated parsing algorithm, <code>strtol()</code> does it for us, we just need to find the next period ourselves. The size of all in- and output is known and/or can be easily checked if they are inside their limits--e.g.: no need for tedious and error-prone memory allocations, we can use fixed size buffers and <code>strcat()</code>.</p>\n\n<p>There is a principle, that holds not only in the Navy but also in programming: <a href=\"https://en.wikipedia.org/wiki/KISS_principle\" rel=\"nofollow\">KISS</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5352828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7dd576448231bbc73ce02dc61056658?s=128&d=identicon&r=PG&f=1", "display_name": "shubhangi", "link": "https://stackoverflow.com/users/5352828/shubhangi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1473274018, "creation_date": 1473264249, "last_edit_date": 1473264356, "question_id": 39374680, "link": "https://stackoverflow.com/questions/39374680/why-the-last-number-in-doted-decimal-is-not-converted-to-binary", "title": "why the last number in doted decimal is not converted to binary?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include &lt;math.h&gt;\nlong long convertDecimalToBinary(int n);\n\nint main() {\n    int verify;\n    long long  bip, dip;\n    char str1[100];\n    printf(\"Enter dotted decimal ip address :\\n\");\n    scanf(\"%s\",str1);\n    verify = bin_verify(str1);\n\n        seperate(str1); \n\n    return 0;\n\n}\nint bin_verify(char str1[]) {\n    int i;\n    for(i = 0; i &lt; strlen(str1); i++) {\n        if((str1[i] &lt; 255) &amp;&amp; (str1[i] &gt; 0)) {\n            return 1;\n        }\n    }\n}\n\n// function to get first decimal no sepreted\n\nint seperate(char str1[]) {\n    int s1, s2, s3, s4;\n    int i, j, k = 0, m, cnt = 0, cnt1 = 0, pos = 0;\n    char a[4], str2[100];\n    for(i = 0; i &lt; strlen(str1); i++) {\n        pos = cnt;\n        if(str1[i] == '.') {\n            k = i;\n            pos = cnt;\n            for(j = 0; j &lt; i; j++) {\n                a[j] = str1[k-cnt];\n                cnt = cnt - 1;\n            }\n        break;\n        }\n        else {\n            cnt++;\n            //goto one;\n        }\n\n    }\n    for(m = 0; m &lt;= pos; m++) {\n        str1++;\n    }\n    s1 = atoi(a);\n    s1 = convertDecimalToBinary(s1);\n    printf(\"Binary Format of IP :\\n\");\n    printf(\"%d.\",s1);\n    seperate2(str1);\n    return 0;\n}\n\n\n\n\n // function to get second decimal no sepreted\nint seperate2(char str1[]) {\n    int s1, s2, s3, s4;\n    int i, j, k = 0, m, cnt = 0, cnt1 = 0, pos = 0;\n    char a[4], str2[100];\n    for(i = 0; i &lt; strlen(str1); i++) {\n        pos = cnt;\n        if(str1[i] == '.') {\n            k = i;\n            pos = cnt;\n            for(j = 0; j &lt; i; j++) {\n                a[j] = str1[k-cnt];\n                cnt = cnt - 1;\n            }\n        break;\n        }\n        else {\n            cnt++;\n            //goto one;\n        }\n\n    }\n    for(m = 0; m &lt;= pos; m++) {\n        str1++;\n    }\n    s2 = atoi(a);\n    s2 = convertDecimalToBinary(s2);\n    printf(\"%d.\",s2);\n    seperate3(str1);\n    return 0;\n}\n\n\n// function to get third decimal no sepreted\n\nint seperate3(char str1[]) {\n    int s1, s2, s3, s4;\n    int i, j, k = 0, m, cnt = 0, cnt1 = 0, pos = 0;\n    char a[4], str2[100];\n    for(i = 0; i &lt; strlen(str1); i++) {\n        pos = cnt;\n        if(str1[i] == '.') {\n            k = i;\n            pos = cnt;\n            for(j = 0; j &lt; i; j++) {\n                a[j] = str1[k-cnt];\n                cnt = cnt - 1;\n            }\n        break;\n        }\n        else {\n            cnt++;\n            //goto one;\n        }\n\n    }\n    for(m = 0; m &lt;= pos; m++) {\n        str1++;\n    }\n    s3 = atoi(a);\n    s3 = convertDecimalToBinary(s3);\n    printf(\"%d.\",s3);\n    seperate4(str1);\n    return 0;\n}\n\n// function to get fourth decimal no sepreted\n\nint seperate4(char str1[]) {\n    int s1, s2, s3, s4;\n    int i, j, k = 0, m, cnt = 0, cnt1 = 0, pos = 0;\n    char a[4], str2[100];\n    for(i = 0; i &lt; strlen(str1); i++) {\n        pos = cnt;\n        if(str1[i] == '.') {\n            k = i;\n            pos = cnt;\n            for(j = 0; j &lt; i; j++) {\n                a[j] = str1[k-cnt];\n                cnt = cnt - 1;\n            }\n        break;\n        }\n        else {\n            cnt++;\n\n\n        }\n\n    }\n\n    for(m = 0; m &lt;= pos; m++) {\n        str1++;\n    }\n    s4 = atoi(a);\n    s4 = convertDecimalToBinary(s4);\n    printf(\"%d\\n\",s4);\n\n    return 0;\n}\n\n//to convert decimal to binary\n\nlong long convertDecimalToBinary(int n)\n{\n\n//printf(\"%d\", n);\n    long long binaryNumber = 0;\n    int remainder, i = 1,step=0;\n\n    while (n!=0)\n    {\n        remainder = n%2;\n      // printf(\"Step %d: %d/2, Remainder = %d, Quotient = %d\\n\", step++, n, remainder, n/2);\n\n        n /= 2;\n\n        binaryNumber += remainder*i;\n        i *= 10;\n    }\n    return binaryNumber;\n}\n</code></pre>\n\n<hr>\n\n<p>output:</p>\n\n<pre><code>Enter dotted decimal ip address :\n\n192.15.7.4\nBinary Format of IP :\n11000000.1111.111.0\n</code></pre>\n\n<p>I want to convert ip address to binary but,\nIt always return 0 as binary of last decimal number.\nwhy it is not performing <code>seperate4()</code> function?</p>\n"}, {"tags": ["c", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473264248, "post_id": 39374538, "comment_id": 66077267, "body": "1) What <i>value</i> is <code>C</code> as in <code>double C ; ... L=-(1&#47;C)*log(u);</code>?  2) Suggest use <code>cosl(nt.d)</code> instead of <code>cos(nt.d)</code>.  3) Enable compiler warnings - saves you time."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1473264412, "post_id": 39374538, "comment_id": 66077361, "body": "As far as I can see you never initialize <code>C</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1473264579, "post_id": 39374538, "comment_id": 66077467, "body": "Of topic: Always check the value returned by <code>scanf</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1473265366, "last_edit_date": 1473265366, "creation_date": 1473264925, "answer_id": 39374895, "question_id": 39374538, "link": "https://stackoverflow.com/questions/39374538/difficulty-in-implementing-the-neutron-transport-model/39374895#39374895", "title": "Difficulty in implementing the neutron transport model", "body": "<p>You have at least one uninitialized variables so your code is UB (undefined behavior).</p>\n\n<pre><code>L=-(1/C)*log(u);\n      ^\n      uninitialized\n</code></pre>\n\n<p>Further, this looks strange:</p>\n\n<pre><code>while(a)\n{\n    ....\n}\n</code></pre>\n\n<p>So <code>a</code> will always be zero when leaving the <code>while</code>. But still you do:</p>\n\n<pre><code>p=(a/n)*100;\n</code></pre>\n\n<p>which will cause <code>p</code> to be always zero. That is probably not what you want.</p>\n\n<p>However, I see this line:</p>\n\n<pre><code>b++;\n</code></pre>\n\n<p>but I can't find any code where you are using <code>b</code>.</p>\n\n<p>Did you really want to do it like this?</p>\n\n<pre><code>p=(b/n)*100;  // b instead of a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 2, "last_activity_date": 1473265152, "creation_date": 1473265152, "answer_id": 39374973, "question_id": 39374538, "link": "https://stackoverflow.com/questions/39374538/difficulty-in-implementing-the-neutron-transport-model/39374973#39374973", "title": "Difficulty in implementing the neutron transport model", "body": "<p>You have </p>\n\n<pre><code>o=(r/n)*100;\n</code></pre>\n\n<p>which performs an integer division before the multiplication. Since your expected output is <code>25.31</code> that would mean the result of <code>r / n</code> should be <code>0.2531</code>, but the result of such an integer division is <code>0</code> which supports the <code>0</code> you are getting.</p>\n\n<p>I suggest this</p>\n\n<pre><code>o = 100.0 * r / n\np = 100.0 * a / n;\nq = 100.0 * t / n;    \n</code></pre>\n\n<p>This will perform the correct arithmetic.</p>\n\n<p>In addition you are using <em>uninitialised variables</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 6498069, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c89732a0a767cdf2b71a21d6de284c1?s=128&d=identicon&r=PG&f=1", "display_name": "R.Anush", "link": "https://stackoverflow.com/users/6498069/r-anush"}, "is_accepted": false, "score": 0, "last_activity_date": 1473827865, "creation_date": 1473827865, "answer_id": 39482562, "question_id": 39374538, "link": "https://stackoverflow.com/questions/39374538/difficulty-in-implementing-the-neutron-transport-model/39482562#39482562", "title": "Difficulty in implementing the neutron transport model", "body": "<p>I found the mistakes in my code by discussing with my classmates and rectified it and parallelized the code too here are the following  code:</p>\n\n<pre><code>/**\n    To compile the program:         gcc sequential.c -lm\n    To run the program:         ./a.out\n**/\n#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n\n#define TOTAL_NUMBER_OF_NEUTRONS 10000000                               //Total number of neutrons\n#define SCATTERING_COMPONENT 0.7                                    // Scattering component of C\n#define ABSORBING_COMPONENT  0.3                                    // Absorbing  component of C\n#define THICKNESS_OF_THE_PLATE 8                                    //Thickness of the Plate\n#define NUMBER_OF_ITERATIONS 1000\nint no_of_particles_reflected=0, no_of_particles_absorbed=0, no_of_particles_transmitted=0;\ndouble total_amount_absorbed,total_amount_reflected,total_amount_transmitted;\ndouble distance_travelled_before_collision;                                     // Distance travelled by neutron before colliding from the plate\ndouble C ;                                              // mean distance between neutron/atom interactions is 1/C\nint flag= 1;                                                                                           int counter= 0;\nstruct neutron\n{\n    double d;                                           // Direction of the neutron (measured in radians between 0 and pi)\n    double x;                                           // Position of particle in plate(0&lt;=x&lt;=H),H is the thickness of the plate\n};\nstruct neutron nt;\nvoid neutron_model()\n{\n    double random_number_generator;                                         // Uniform random number generator\n    total_amount_absorbed=0,total_amount_reflected=0,total_amount_transmitted=0;\n    for(int i=1;i&lt;=TOTAL_NUMBER_OF_NEUTRONS;i++)\n    {\n        random_number_generator=rand()%TOTAL_NUMBER_OF_NEUTRONS;\n        random_number_generator=1/random_number_generator;\n        nt.d=0;\n        nt.x=0;\n        flag=1;\n        while(flag)\n                {\n            distance_travelled_before_collision=-(1/C)*log(random_number_generator);\n            nt.x=distance_travelled_before_collision*cos(nt.d);\n\n            if (nt.x&lt;0)\n            {\n                no_of_particles_reflected++;\n                flag=0;\n            }\n            else if(nt.x&gt;=THICKNESS_OF_THE_PLATE)\n            {\n                no_of_particles_transmitted++;\n                flag=0;\n            }\n            else\n            {\n                if(random_number_generator&lt;(ABSORBING_COMPONENT/C))\n                {\n                    no_of_particles_absorbed++;\n                    flag=0;\n                }\n                else\n                {\n                    nt.d=random_number_generator*(22.0/7.0);\n                    counter++;\n                    if(counter==NUMBER_OF_ITERATIONS)\n                    {\n                        no_of_particles_absorbed++;\n                        flag=0;\n                        counter=0;\n                    }\n                }\n            }\n        }\n    }\n}\nint main(int argc, char *argv[])\n{\n    C=SCATTERING_COMPONENT + ABSORBING_COMPONENT;   \n\n\n    clock_t start, end;\n    double diff_t;\n    diff_t = 0.0;\n    //start the clock\n    start= clock();\n    neutron_model();\n    //stop the clock\n    end = clock();\n    diff_t = ((double) (end - start)) / CLOCKS_PER_SEC;\n    total_amount_reflected=((double)no_of_particles_reflected/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n    total_amount_absorbed=((double)no_of_particles_absorbed/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n    total_amount_transmitted=((double)no_of_particles_transmitted/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n\n    printf(\"\\nDATA VALUE ASSUMED:-\\n\");\n    printf(\"***********************************************************************\\n\");\n    printf(\"TOTAL_NUMBER_OF_NEUTRONS:  %d\\n\",TOTAL_NUMBER_OF_NEUTRONS);\n    printf(\"SCATTERING_COMPONENT: %f\\n\",SCATTERING_COMPONENT);\n    printf(\"ABSORBING_COMPONENT: %f\\n\",ABSORBING_COMPONENT);\n    printf(\"THICKNESS_OF_THE_PLATE: %d\\n\",THICKNESS_OF_THE_PLATE);\n    printf(\"***********************************************************************\\n\\n\");\n    printf(\"Total particles reflected,absorbed and transmitted respectively are: %d, %d, %d     \\n\",no_of_particles_reflected,no_of_particles_absorbed,no_of_particles_transmitted);\n        printf(\"Percentage of particles reflected,absorbed and transmitted respectively are: %lf, %lf, %lf\\n\", total_amount_reflected, total_amount_absorbed, total_amount_transmitted);\n    printf(\"Total time taken in sec %10.6lf\\n\",diff_t);\n    return 0;\n}\n</code></pre>\n\n<p>MPI version:</p>\n\n<pre><code>/**\n    To compile the program:         mpicc -o neutron_transport with_MPI.c -lm\n    To run the program:         mpirun -np &lt;specify no. of processes&gt; neutron_transport \n**/\n#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n#include&lt;mpi.h&gt;\n\n#define TOTAL_NUMBER_OF_NEUTRONS 1000                       //Total number of neutrons\n#define SCATTERING_COMPONENT 0.7                            // Scattering component of C\n#define ABSORBING_COMPONENT  0.3                            // Absorbing  component of C\n#define THICKNESS_OF_THE_PLATE 4                            //Thickness of the Plate\n#define NUMBER_OF_ITERATIONS 1000\n#define BLOCK_LOW(id,p,n)   ((id)*(n)/(p))\n#define BLOCK_HIGH(id,p,n)  (BLOCK_LOW((id)+1,p,n)-1)\n#define BLOCK_SIZE(id,p,n)  (BLOCK_LOW((id)+1,p,n)-BLOCK_LOW(id,p,n))       //Block Size for each process\n\nstruct neutron\n{\n    long double d;                                  // Direction of the neutron (measured in radians between 0 and pi)\n    long double x;                                  // Position of particle in plate(0&lt;=x&lt;=H) where H is the thickness of the plate\n};\n\nint main(int argc, char *argv[])\n{\n    int process_id;                                 //Process Identifier\n    int number_of_processes;                            //Number of Processes in the communicator\n    MPI_Init(&amp;argc,&amp;argv);                              //Starting of MPI program\n    MPI_Comm_rank(MPI_COMM_WORLD,&amp;process_id);                  //Determine the process ID number in the communicator\n    MPI_Comm_size(MPI_COMM_WORLD,&amp;number_of_processes);             //Determine the number of processes in the communicator\n    int i=0;                                    //Loop iterator\n    int counter=0;\n    int buffer_share_for_each_process=0;\n    double C ;                                      // mean distance between neutron/atom interactions is 1/C\n    C=SCATTERING_COMPONENT + ABSORBING_COMPONENT;   \n    int flag= 1;                                                    \n    double random_number_generator;                                 // Uniform random number\n    double distance_travelled_before_collision;                         // Distance travelled by neutron before collision\n    struct neutron nt;\n    double total_amount_absorbed,total_amount_reflected,total_amount_transmitted;\n    int count_of_reflected_absorbed_transmitted[3];\n    count_of_reflected_absorbed_transmitted[0]=0;\n    count_of_reflected_absorbed_transmitted[1]=0;\n    count_of_reflected_absorbed_transmitted[2]=0;\n    int global_count_of_reflected_absorbed_transmitted[3];\n    buffer_share_for_each_process= BLOCK_SIZE(process_id,number_of_processes,TOTAL_NUMBER_OF_NEUTRONS);\n    double elapsed_time1;                   //Timer variables\n    elapsed_time1= -MPI_Wtime();\n    if(number_of_processes &gt; TOTAL_NUMBER_OF_NEUTRONS)\n    {\n        if(!process_id) \n            printf(\"Too many processes. Kindly provide lesser number of processes.\\n\");\n        MPI_Finalize();\n        exit(1);\n    }\n\n    for(int i=1;i&lt;=buffer_share_for_each_process;i++)\n    {\n        random_number_generator=rand()%TOTAL_NUMBER_OF_NEUTRONS;\n        random_number_generator=1/random_number_generator;\n        nt.d=0;\n        nt.x=0;\n        flag=1;\n        distance_travelled_before_collision=-(1/C)*log(random_number_generator);\n        nt.x=distance_travelled_before_collision*cos(nt.d);\n\n        while(flag)\n                {\n            distance_travelled_before_collision=-(1/C)*log(random_number_generator);\n            nt.x=distance_travelled_before_collision*cos(nt.d);\n\n            if (nt.x&lt;0)\n            {\n                count_of_reflected_absorbed_transmitted[0]++;\n                flag=0;\n            }\n            else if(nt.x&gt;=THICKNESS_OF_THE_PLATE)\n            {\n                count_of_reflected_absorbed_transmitted[2]++;\n                flag=0;\n            }\n            else\n            {\n                if(random_number_generator&lt;(ABSORBING_COMPONENT/C))\n                {\n                    count_of_reflected_absorbed_transmitted[1]++;\n                    flag=0;\n                }\n                else\n                {\n                    nt.d=random_number_generator*(22.0/7.0);\n                    counter++;\n                    if(counter==NUMBER_OF_ITERATIONS)\n                    {\n                        count_of_reflected_absorbed_transmitted[1]++;\n                        flag=0;\n                        counter=0;\n                    }\n                }\n            }\n        }\n    }\n    for(int i= 0 ; i &lt; 3 ; i ++)\n        MPI_Reduce(&amp;count_of_reflected_absorbed_transmitted[i], &amp;global_count_of_reflected_absorbed_transmitted[i], 1, MPI_INT,MPI_SUM,0, MPI_COMM_WORLD) ; \n    elapsed_time1+= MPI_Wtime();\n    MPI_Barrier(MPI_COMM_WORLD);\n    if(!process_id)\n    {\n        total_amount_reflected=((double)global_count_of_reflected_absorbed_transmitted[0]/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n        total_amount_absorbed=((double)global_count_of_reflected_absorbed_transmitted[1]/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n        total_amount_transmitted=((double)global_count_of_reflected_absorbed_transmitted[2]/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n\n        printf(\"\\nDATA VALUE ASSUMED:-\\n\");\n        printf(\"*****************************************************************************************\\n\");\n        printf(\"TOTAL_NUMBER_OF_NEUTRONS:  %d\\n\",TOTAL_NUMBER_OF_NEUTRONS);\n        printf(\"SCATTERING_COMPONENT: %f\\n\",SCATTERING_COMPONENT);\n        printf(\"ABSORBING_COMPONENT: %f\\n\",ABSORBING_COMPONENT);\n        printf(\"THICKNESS_OF_THE_PLATE: %d\\n\",THICKNESS_OF_THE_PLATE);\n        printf(\"TOTAL NUMBER OF PROCESSES: %d\\n\",number_of_processes);\n        printf(\"*****************************************************************************************\\n\\n\");\n        printf(\"Total particles reflected,absorbed and transmitted respectively are: %d, %d, %d \\n\",global_count_of_reflected_absorbed_transmitted[0],global_count_of_reflected_absorbed_transmitted[1],global_count_of_reflected_absorbed_transmitted[2]);\n            printf(\"Percentage of particles reflected,absorbed and transmitted respectively are: %lf, %lf, %lf\\n\", total_amount_reflected, total_amount_absorbed,   total_amount_transmitted);\n        printf(\"Total time taken in sec %10.6f\\n\",elapsed_time1);\n    }\n    MPI_Finalize();\n    return 0;\n}\n</code></pre>\n\n<p>OpenMP version:</p>\n\n<pre><code> /**\n    To compile the program:         gcc -fopenmp with_open_mp.c -lm\n    To run the program:         ./a.out\n**/\n#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n#include&lt;omp.h&gt;\n\n#define TOTAL_NUMBER_OF_NEUTRONS 10000000                               //Total number of neutrons\n#define SCATTERING_COMPONENT 0.7                                    // Scattering component of C\n#define ABSORBING_COMPONENT  0.3                                    // Absorbing  component of C\n#define THICKNESS_OF_THE_PLATE 5                                    //Thickness of the Plate\n#define NUMBER_OF_ITERATIONS 1000\n#define TOTAL_NUMBER_OF_THREADS 500\nstruct neutron\n{\n    double d;                                           // Direction of the neutron (measured in radians between 0 and pi)\n    double x;                                         // Position of particle in plate(0&lt;=x&lt;=H) where H is the thickness of the plate\n};\n\nint main(int argc, char *argv[])\n{\n    double C ;                                              // mean distance between neutron/atom interactions is 1/C\n    C=SCATTERING_COMPONENT + ABSORBING_COMPONENT;   \n    int no_of_particles_reflected=0, no_of_particles_absorbed=0, no_of_particles_transmitted=0;\n    int flag= 1;                                                    \n    double random_number_generator;                                         // Uniform random number\n    double distance_travelled_before_collision;                                 // Distance travelled by neutron before collision\n    struct neutron nt;\n    double total_amount_absorbed,total_amount_reflected,total_amount_transmitted;\n    int counter= 0;\n        srand(time(NULL));\n    clock_t start, end;\n    double diff_t;\n    diff_t = 0.0;\n    //start the clock\n    start= clock();\n    //int t=omp_get_num_procs();\n    omp_set_num_threads(TOTAL_NUMBER_OF_THREADS);\n    #pragma omp parallel for reduction(+:no_of_particles_reflected,no_of_particles_absorbed,no_of_particles_transmitted)\n    for(int i=1;i&lt;=TOTAL_NUMBER_OF_NEUTRONS;i++)\n    {\n        random_number_generator=rand()%TOTAL_NUMBER_OF_NEUTRONS;\n        random_number_generator=1/random_number_generator;\n        nt.d=0;\n        nt.x=0;\n        flag=1;\n        while(flag)\n                {\n            distance_travelled_before_collision=-(1/C)*log(random_number_generator);\n            nt.x=distance_travelled_before_collision*cos(nt.d);\n\n            if (nt.x&lt;0)\n            {\n                no_of_particles_reflected++;\n                flag=0;\n            }\n            else if(nt.x&gt;=THICKNESS_OF_THE_PLATE)\n            {\n                no_of_particles_transmitted++;\n                flag=0;\n            }\n            else\n            {\n                if(random_number_generator&lt;(ABSORBING_COMPONENT/C))\n                {\n                    no_of_particles_absorbed++;\n                    flag=0;\n                }\n                else\n                {\n                    nt.d=random_number_generator*(22.0/7.0);\n                    counter++;\n                    if(counter==NUMBER_OF_ITERATIONS)\n                    {\n\n                        no_of_particles_absorbed++;\n                        flag=0;\n                        counter=0;\n                    }\n                }\n            }\n        }\n    }\n    //stop the clock\n    end = clock();\n    diff_t = ((double) (end - start)) / CLOCKS_PER_SEC;\n    printf(\"\\nDATA VALUE ASSUMED:-\\n\");\n    printf(\"*****************************************************************************************\\n\");\n    printf(\"TOTAL_NUMBER_OF_NEUTRONS:  %d\\n\",TOTAL_NUMBER_OF_NEUTRONS);\n    printf(\"SCATTERING_COMPONENT: %f\\n\",SCATTERING_COMPONENT);\n    printf(\"ABSORBING_COMPONENT: %f\\n\",ABSORBING_COMPONENT);\n    printf(\"THICKNESS_OF_THE_PLATE: %d\\n\",THICKNESS_OF_THE_PLATE);\n    printf(\"TOTAL NUMBER OF THREADS: %d\\n\",TOTAL_NUMBER_OF_THREADS);\n    printf(\"*****************************************************************************************\\n\\n\");\n    total_amount_reflected=((double)no_of_particles_reflected/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n    total_amount_absorbed=((double)no_of_particles_absorbed/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n    total_amount_transmitted=((double)no_of_particles_transmitted/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\nprintf(\"Total particles reflected,absorbed and transmitted respectively are: %d, %d, %d \\n\",no_of_particles_reflected,no_of_particles_absorbed,no_of_particles_transmitted);\n        printf(\"The amount reflected,absorbed and transmitted respectively are: %lf, %lf, %lf\\n\", total_amount_reflected, total_amount_absorbed, total_amount_transmitted);\n    printf(\"Total time taken in sec %10.6lf\\n\",diff_t);\n    return 0;\n}\n</code></pre>\n\n<p>Hybrid version of MPI and OpenMP:</p>\n\n<pre><code>/**\n    To compile the program:         mpicc -fopenmp mpi_openmp.c -o hybrid -lm\n    To run the program:         mpirun -np &lt;specify number of processes&gt; ./hybrid\n**/\n#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n#include&lt;omp.h&gt;\n#include&lt;mpi.h&gt;\n\n#define TOTAL_NUMBER_OF_NEUTRONS 10000000                               //Total number of neutrons\n#define SCATTERING_COMPONENT 0.7                                    // Scattering component of C\n#define ABSORBING_COMPONENT  0.3                                    // Absorbing  component of C\n#define THICKNESS_OF_THE_PLATE 3                                    //Thickness of the Plate\n#define BLOCK_LOW(id,p,n)   ((id)*(n)/(p))\n#define BLOCK_HIGH(id,p,n)  (BLOCK_LOW((id)+1,p,n)-1)\n#define BLOCK_SIZE(id,p,n)  (BLOCK_LOW((id)+1,p,n)-BLOCK_LOW(id,p,n))               //Block Size for each process\n#define NUMBER_OF_ITERATIONS 1000\n#define TOTAL_NUMBER_OF_THREADS 500                                 //Total number of threads\nstruct neutron\n{\n    double d;                                           // Direction of the neutron (measured in radians between 0 and pi)\n    double x;                                         // Position of particle in plate(0&lt;=x&lt;=H) where H is the thickness of the plate\n};\n\nint main(int argc, char *argv[])\n{\n    struct neutron nt;\n    int process_id;                                         //Process Identifier\n    int number_of_processes;                                    //Number of Processes in the communicator\n    MPI_Init(&amp;argc,&amp;argv);                                      //Starting of MPI program\n    MPI_Comm_rank(MPI_COMM_WORLD,&amp;process_id);                          //Determine the process ID number in the communicator\n    MPI_Comm_size(MPI_COMM_WORLD,&amp;number_of_processes);                     //Determine the number of processes in the communicator\n\n    double C ;                                              // mean distance between neutron/atom interactions is 1/C\n    C=SCATTERING_COMPONENT + ABSORBING_COMPONENT;   \n    int flag= 1;                                                    \n    double random_number_generator;                                         // Uniform random number\n    double distance_travelled_before_collision;                                 // Distance travelled by neutron before collision\n    int no_of_particles_reflected=0, no_of_particles_absorbed=0, no_of_particles_transmitted=0;\n    double total_amount_absorbed,total_amount_reflected,total_amount_transmitted;\n\n    int counter= 0;\n    int buffer_share_for_each_process=0;\n        srand(time(NULL));\n\n    int count_of_reflected_absorbed_transmitted[3];\n    count_of_reflected_absorbed_transmitted[0]=0;\n    count_of_reflected_absorbed_transmitted[1]=0;\n    count_of_reflected_absorbed_transmitted[2]=0;\n    int global_count_of_reflected_absorbed_transmitted[3];\n    buffer_share_for_each_process= BLOCK_SIZE(process_id,number_of_processes,TOTAL_NUMBER_OF_NEUTRONS);\n    double elapsed_time1;                   //Timer variables\n    elapsed_time1= -MPI_Wtime();\n\n    //int t=omp_get_num_procs();\n    omp_set_num_threads(TOTAL_NUMBER_OF_THREADS);\n    if((number_of_processes) &gt; TOTAL_NUMBER_OF_NEUTRONS)\n    {\n        if(!process_id) \n            printf(\"Too many processes. Kindly provide lesser number of processes.\\n\");\n        MPI_Finalize();\n        exit(1);\n    }\n\n    #pragma omp parallel for \n    for(int i=1;i&lt;=buffer_share_for_each_process;i++)\n    {\n        //printf(\"Buffer_Share= %d by process %d (thread %d out of %d)\\n\",buffer_share_for_each_process,process_id,omp_get_thread_num(),omp_get_num_threads());\n        random_number_generator=rand()%TOTAL_NUMBER_OF_NEUTRONS;\n        random_number_generator=1/random_number_generator;\n        nt.d=0;\n        nt.x=0;\n        flag=1;\n        while(flag)\n                {\n            distance_travelled_before_collision=-(1/C)*log(random_number_generator);\n            nt.x=distance_travelled_before_collision*cos(nt.d);\n\n            if (nt.x&lt;0)\n            {\n                count_of_reflected_absorbed_transmitted[0]++;\n                flag=0;\n            }\n            else if(nt.x&gt;=THICKNESS_OF_THE_PLATE)\n            {\n                count_of_reflected_absorbed_transmitted[2]++;\n                flag=0;\n            }\n            else\n            {\n                if(random_number_generator&lt;(ABSORBING_COMPONENT/C))\n                {\n                    count_of_reflected_absorbed_transmitted[1]++;\n                    flag=0;\n                }\n                else\n                {\n                    nt.d=random_number_generator*(22.0/7.0);\n                    counter++;\n                    if(counter==NUMBER_OF_ITERATIONS)\n                    {\n                        count_of_reflected_absorbed_transmitted[1]++;\n                        flag=0;\n                        counter=0;\n                    }\n                }\n            }\n        }\n    }\n    for(int i= 0 ; i &lt; 3 ; i ++)\n        MPI_Reduce(&amp;count_of_reflected_absorbed_transmitted[i], &amp;global_count_of_reflected_absorbed_transmitted[i], 1, MPI_INT,MPI_SUM,0, MPI_COMM_WORLD) ; \n    elapsed_time1+= MPI_Wtime();\n    MPI_Barrier(MPI_COMM_WORLD);\n    if(!process_id)\n    {\n        total_amount_reflected=((double)global_count_of_reflected_absorbed_transmitted[0]/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n        total_amount_absorbed=((double)global_count_of_reflected_absorbed_transmitted[1]/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n        total_amount_transmitted=((double)global_count_of_reflected_absorbed_transmitted[2]/(double)TOTAL_NUMBER_OF_NEUTRONS)*100.0;\n\n        printf(\"\\nDATA VALUE ASSUMED:-\\n\");\n        printf(\"*****************************************************************************************\\n\");\n        printf(\"TOTAL_NUMBER_OF_NEUTRONS:  %d\\n\",TOTAL_NUMBER_OF_NEUTRONS);\n        printf(\"SCATTERING_COMPONENT: %f\\n\",SCATTERING_COMPONENT);\n        printf(\"ABSORBING_COMPONENT: %f\\n\",ABSORBING_COMPONENT);\n        printf(\"THICKNESS_OF_THE_PLATE: %d\\n\",THICKNESS_OF_THE_PLATE);\n        printf(\"TOTAL NUMBER OF PROCESSES: %d\\n\",number_of_processes);\n        printf(\"TOTAL NUMBER OF THREADS: %d\\n\",TOTAL_NUMBER_OF_THREADS);\n        printf(\"*****************************************************************************************\\n\\n\");\n        printf(\"Total particles reflected,absorbed and transmitted respectively are: %d, %d, %d \\n\",global_count_of_reflected_absorbed_transmitted[0],global_count_of_reflected_absorbed_transmitted[1],global_count_of_reflected_absorbed_transmitted[2]);\n            printf(\"Percentage of particles reflected,absorbed and transmitted respectively are: %lf, %lf, %lf\\n\", total_amount_reflected, total_amount_absorbed,   total_amount_transmitted);\n        printf(\"Total time taken in sec %10.6f\\n\",elapsed_time1);\n    }\n    MPI_Finalize();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6498069, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1c89732a0a767cdf2b71a21d6de284c1?s=128&d=identicon&r=PG&f=1", "display_name": "R.Anush", "link": "https://stackoverflow.com/users/6498069/r-anush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 39374973, "answer_count": 3, "score": 3, "last_activity_date": 1473827865, "creation_date": 1473263878, "last_edit_date": 1473265745, "question_id": 39374538, "link": "https://stackoverflow.com/questions/39374538/difficulty-in-implementing-the-neutron-transport-model", "title": "Difficulty in implementing the neutron transport model", "body": "<p>I'm working on simulation of neutron transport model using monte carlo method. I'm first implementing the sequential algorithm that is given in the book  <em>parallel programming with openmp and MPI by M. J. Quinn</em></p>\n\n<p>The below (sequential) code given is a simulation of neutron transport model. when i run the executable file for the first time, it is running in infinite loop. When i stopped and ran again, the output i'm getting is 0, 0, 0 and is not the expected output for all possible values of input parameters, given in the question as mentioned in solution manual of M.J.Quinn parallel programming with openmp and MPI (Q.No 10.8).</p>\n\n<p>The soft copy for the book is given below:\n <a href=\"https://docs.google.com/document/d/19aKs6XF3Gt6BRGSGVysZqam3Cb97rgRvTCYP2Nw-C5M/edit\" rel=\"nofollow\">https://docs.google.com/document/d/19aKs6XF3Gt6BRGSGVysZqam3Cb97rgRvTCYP2Nw-C5M/edit</a></p>\n\n<p><em>The expected output is: the amount of reflected, absorbed and transmitted rates are: 25.31, 46.13, 28.56.</em>  No error was given when the code was compiled. please help me out. here is the following code that i wrote:                                                             </p>\n\n<pre><code>struct neutron\n{\n    long double d    ;  // Direction of the neutron (measured in radians between 0 and pi)\n    long double x    ;  // Position of particle in plate(0&lt;=x&lt;=H)where H is the thickness of the plate\n};\ntypedef struct neutron neutron;\n\n\nint  main()\n{\n    srand(time(NULL));\n    double C ;   // mean distance between neutron/atom interactions is 1/C\n    double C_s;  // Scattering component of C\n    double C_c;  // Absorbing  component of C\n    int r=0, b=0, t=0; //Counts of reflected, absorbed, transmitted neutrons\n    int i=0;\n    int n;                   // Number of Samples\n\n    //double d;                //Direction of the neutron (measured in radians between 0 and pi)\n    int a;                   //a==0 implies false 1 otherwise\n    double u;                // Uniform random number\n    double L;                // Distance neutron travels before collision\n    neutron nt;\n    double H;\n    double p,q,o;\n\n\n    printf(\"\\n Enter the value of C_s:\\n\");\n    scanf(\"%lf\",&amp;C_s);\n    printf(\"\\nEnter the value of C_c:\\n\");\n    scanf(\"%lf\",&amp;C_c);\n    //printf(\"\\nEnter the value of L:\\n\");\n    //scanf(\"%lf\",&amp;L);\n    printf(\"\\nEnter the value of H (Thickness of the plate):\\n\");\n    scanf(\"%lf\",&amp;H);\n    printf(\"\\n Enter the number of samples you want to simulate for....\\n\");\n    scanf(\"%d\",&amp;n);\n    for(i=1;i&lt;=n;i++)\n    {\n        u=rand()%n;\n        u=1/u;\n        nt.d=0;\n        nt.x=0;\n        a=1;\n        while(a)\n        {\n            L=-(1/C)*log(u);\n            nt.x=nt.x+L*cos(nt.d);\n            if (nt.x&lt;0)\n            {\n                //      printf(\"\\nparticle %d got reflected\\n\",i);\n                r++;\n                a=0;\n            }\n            else\n            {\n                if(nt.x&gt;=H)\n                {\n                    //      printf(\"\\n particle %d got transmitted\\n\",i);\n                    t++;\n                    a=0;\n                }\n                else\n                {\n                    if(u&lt;C_c/C)\n                    {\n                        //      printf(\"\\n the particle %d got absorbed\\n\",i);\n                        b++;\n                        a=0;\n                    }\n                    else\n                        nt.d=u*(22/7);\n                }\n            }\n        }\n    }\n    o=(r/n)*100;\n    p=(a/n)*100;\n    q=(t/n)*100;\n    printf(\"\\nthe amount of reflected, absorbed and transmitted rates are: %lf, %lf, %lf\\n\", o, p, q);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "binary"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 3, "creation_date": 1473263672, "post_id": 39374403, "comment_id": 66076882, "body": "Start with stopping using illegal (at least in standard C) characters <code>\u201c</code> and <code>\u201d</code> instead of <code>&quot;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1473263796, "post_id": 39374403, "comment_id": 66076965, "body": "Read the result of <code>fread()</code> to avoid problems.  Code does not know it read 8 <code>char</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473263802, "post_id": 39374403, "comment_id": 66076970, "body": "In <code>printf(&quot;%s&quot;, d.chunk);</code> how do you ensure you have the <code>nul</code> terminated string required by <code>printf</code>?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1473263856, "post_id": 39374403, "comment_id": 66077006, "body": "<i>Why do I have to loop over each 8 bytes?</i> I don&#39;t know, why do you? You also have undefined behavior since you read 8 bytes and give it to printf as a null terminated string without null terminating it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473263948, "post_id": 39374403, "comment_id": 66077063, "body": "Could use <code>printf(\u201c%.8s\u201d, d.chunk);</code> to limit output to 8 <code>char</code>, even without a null character - but this still hides previous problems."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1473263952, "post_id": 39374403, "comment_id": 66077067, "body": "Sorry am a bit new to all this, how do I null terminate the string in the context of my code? Any examples for this? How will that actually get me closer to getting a hex encode of the whole binary file????"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473264011, "post_id": 39374403, "comment_id": 66077119, "body": "You ask for examples, yet do not provide examples to your post.  Post example input data and expected output."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1473264236, "post_id": 39374403, "comment_id": 66077258, "body": "As I say, the output is expected, it&#39;s just that it prints out line by line (8 chars at a time). i just want the whole file in one variable, so I can hex encode the whole thing. Is there really no way to do this?"}], "answers": [{"comments": [{"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1473264269, "post_id": 39374600, "comment_id": 66077283, "body": "Hi, iret is an int? My data is char?"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1473272590, "post_id": 39374600, "comment_id": 66081454, "body": "@Ke. The man page for <a href=\"http://man7.org/linux/man-pages/man3/fread.3.html\" rel=\"nofollow noreferrer\"><code>fread</code></a> ..."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1473318094, "post_id": 39374600, "comment_id": 66095992, "body": "but why do I need how many complete records? I&#39;m after the data inside the chunk, not the amount of records..."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 0, "creation_date": 1473318135, "post_id": 39374600, "comment_id": 66096020, "body": "but why do I need how many complete records? I&#39;m after the data inside the chunk, not the amount of records..."}, {"owner": {"reputation": 4973, "user_id": 153891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b287bcae476beaa660680430cd399c0?s=128&d=identicon&r=PG", "display_name": "woolstar", "link": "https://stackoverflow.com/users/153891/woolstar"}, "edited": false, "score": 0, "creation_date": 1473554668, "post_id": 39374600, "comment_id": 66186899, "body": "I was guessing that there was more than a single 8 byte record in the file and that you would eventually need to look at more than one of them.  If not, you can ignore the return value, except to check that you read at least one."}], "tags": [], "owner": {"reputation": 4973, "user_id": 153891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b287bcae476beaa660680430cd399c0?s=128&d=identicon&r=PG", "display_name": "woolstar", "link": "https://stackoverflow.com/users/153891/woolstar"}, "is_accepted": false, "score": 1, "last_activity_date": 1473264043, "creation_date": 1473264043, "answer_id": 39374600, "question_id": 39374403, "link": "https://stackoverflow.com/questions/39374403/read-binary-file-into-struct-handle-char-8-using-c/39374600#39374600", "title": "Read binary file into struct, handle char [8], using C", "body": "<p>I am not sure of the history of this file, or the other parts of the structure that are defined, but from a strict <code>C</code> standpoint, the file is simply a large quantity of 8 byte values, with nulls in them (or else the <code>printf</code> would be completely invalid.)</p>\n\n<p>So yes, the following is possible if your code is valid:</p>\n\n<pre><code>typedef struct justchunk { char chunk[8] ; } chunker ;\nchunker * ptr ;\n\nptr= (chunker * ) malloc( 1000000 * sizeof( chunker ) ) ;\nint iret ;\nf= fopen( \"myfile.txt\", \"rb\") ;\niret= fread( ptr, sizeof( chunker), 1000000, f) ;\n</code></pre>\n\n<p>The value returned in <code>iret</code> will be how many complete records were read.</p>\n\n<p>Error handling, and file closing left as an exercise to the reader.</p>\n"}], "owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1473264043, "creation_date": 1473263533, "last_edit_date": 1473263784, "question_id": 39374403, "link": "https://stackoverflow.com/questions/39374403/read-binary-file-into-struct-handle-char-8-using-c", "title": "Read binary file into struct, handle char [8], using C", "body": "<p>I have the following code, which prints out the binary perfectly (prints the first 4 characters (I'm guessing 2 bits per character, so 8 chars in total?</p>\n\n<pre><code>void myChunks(){\n\n    struct chunkStorage\n    {\n        long sxID;\n        char chunk[8];      // \u2018Chunk of Data\u2019\n\n    };\n\n        FILE *p;\n        struct chunkStorage d;\n        p=fopen(\"myfile.txt\",\"rb\");\n        while(1){\n            fread(&amp;d.chunk,sizeof(d.chunk),1,p);\n            if(feof(p)!=0)\n                break;\n            printf(\u201c%s\u201d, d.chunk);\n            }\n    fclose(p);\n}\nmyChunks();\n</code></pre>\n\n<p>So the only way for me to be able to get at the data, seems to be using a while loop in this way. I'm wondering how I can concatenate this, and also hex encode it?</p>\n\n<p>What does the char chunk[8] do? Why do I have to loop over each 8 bytes? Why cant I just forget the \"while\" loops and just read the full chunk after the fopen statement and then convert the full data to hex?</p>\n\n<p>Is it right to concatenate, to get the full file, or is this likely to be erroneous?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1473263250, "post_id": 39374253, "comment_id": 66076627, "body": "You call <code>strcat()</code> to append to a newly <code>malloc()</code>ed, uninitialised array... this will only work as you seem to expect if it happens to start with a null byte (which is not at all guaranteed)."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1473263326, "post_id": 39374253, "comment_id": 66076675, "body": "Easy fix would be to change that first <code>strcat()</code> to a <code>strcpy()</code> (and also get rid of the <code>printf()</code> right before it which tries to print that uninitialised string)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1473263698, "post_id": 39374253, "comment_id": 66076904, "body": "@Dmitri In fact, none of the above: <code>snprintf()</code>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1473264006, "post_id": 39374253, "comment_id": 66077115, "body": "@iharob <code>sprintf()</code> or <code>snprintf()</code> would probably be better, but the <code>strcpy()</code> fix is a much smaller change."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1473264047, "post_id": 39374253, "comment_id": 66077148, "body": "@Dmitri Agree, except that there is no reason to use <code>sprintf()</code> when you have <code>snprintf()</code>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1473264252, "post_id": 39374253, "comment_id": 66077270, "body": "@iharob Only that <code>snprintf()</code> will check the length as it goes, which is not necessary when you&#39;ve already ensured that the buffer length is adequate... but yes, <code>snprintf()</code> is a safer choice to make a habit of."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473280327, "post_id": 39374253, "comment_id": 66085009, "body": "Using <code>snprintf()</code> without checking results trades one problem (buffer overrun) with incorrect shortened-string.  Use an adequate buffer (see <code>MAXPATH</code>) or use <code>snprintf()</code> and check its results."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 6079824, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66858cc4efcc57b306294ea130a731f?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6079824/patrick"}, "edited": false, "score": 0, "creation_date": 1473264088, "post_id": 39374296, "comment_id": 66077184, "body": "Thank you so much for the help, and also the extra advise."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 4, "last_activity_date": 1473263642, "last_edit_date": 1473263642, "creation_date": 1473263202, "answer_id": 39374296, "question_id": 39374253, "link": "https://stackoverflow.com/questions/39374253/char-array-has-some-garbage-after-first-loop-in-c/39374296#39374296", "title": "char array has some garbage after first loop in c", "body": "<p>Because <code>fullpath</code> is not initialized. You should not use and you don't need to use <code>strcat()</code> in this situation, but if you want it to work simply make the first parameter of <code>strcat()</code> a valid string, it can be an empty string.</p>\n\n<p>Right after <code>malloc()</code></p>\n\n<pre><code>if (fullpath == NULL)\n    exit(-1);\nfullpath[0] = '\\0';\n</code></pre>\n\n<p>after that, you can use <code>fullpath</code> as the first parameter to <code>strcat()</code>.</p>\n\n<p>You see, <code>strcat()</code> is bad to use because it scans the first paramter checking for the <code>null</code> terminator but, in your case the contents of  <code>fullpath</code> are undeterminate and it might happen that the first character is a <code>'\\0'</code> but there is no guarantee.</p>\n\n<p>You can see how, searching for the <code>'\\0'</code> terminator every time you pass the string to <code>strcat()</code> which is presumably growing will be inefficient.</p>\n\n<p>Also, since you are going to <code>free()</code> <code>fullpath</code> inside the loop, don't use <code>malloc()</code> at all. You can use a VLA (<em>Variable length array</em>) or a fixed length one too. Calling <code>malloc()</code> and <code>free()</code> is not cheap and you will already need <code>strcpy()</code> or better <code>snprintf()</code> in this case is more suitable.</p>\n"}], "owner": {"reputation": 193, "user_id": 6079824, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66858cc4efcc57b306294ea130a731f?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6079824/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 39374296, "answer_count": 1, "score": -1, "last_activity_date": 1473264622, "creation_date": 1473263070, "last_edit_date": 1473264622, "question_id": 39374253, "link": "https://stackoverflow.com/questions/39374253/char-array-has-some-garbage-after-first-loop-in-c", "title": "char array has some garbage after first loop in c", "body": "<p><a href=\"https://i.stack.imgur.com/G5Ygt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G5Ygt.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    while( (entry = readdir(dir_pointer)) != NULL)\n        {\n                char *fullpath = malloc(dir_len + strlen(entry-&gt;d_name) + 2);\n                printf(\"\\nfullpath: %s\\n\", fullpath);\n                strcat(fullpath, dir);  // concatenate file directory;\n                printf(\"\\ndir: %s\\n\",fullpath);\n                strcat(fullpath, \"/\");  // concatenate \"/\";\n                strcat(fullpath, entry-&gt;d_name);    // concatenate filename;\n                printf(\"\\nfullpath: %s\\n\", fullpath);   // print to check;\n\n                free(fullpath);\n                // close the file;\n\n\n\n        }\n</code></pre>\n\n<p>From the output, the first round of while loop works fine, the file full path is correct;</p>\n\n<p>However, for the second round, the file full path contains some garbage, </p>\n\n<p>Where does the garbage come from?</p>\n\n<p>How to solve this, I have tried the memset() but it didn't work.</p>\n"}, {"tags": ["c++", "c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1473263055, "post_id": 39374219, "comment_id": 66076495, "body": "Your macro would not make sense."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1473263122, "post_id": 39374219, "comment_id": 66076546, "body": "Are you using C or C++?  In C++ I would suggest making a template function."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1473263244, "post_id": 39374219, "comment_id": 66076624, "body": "<code>##</code> is used for pasting two tokens into a single token, e.g. <code>MYMACRO(foo, bar)</code> results in the variable <code>foobar</code>. But <code>this-&gt;var++</code> is multiple tokens, so you can&#39;t paste them together like that. It doesn&#39;t work at the text level, so it doesn&#39;t just put things next to each other and reparse it."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1473265965, "post_id": 39374219, "comment_id": 66078226, "body": "There is no place for macros such as this in c++. You&#39;re 15 years behind."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 4, "creation_date": 1473263577, "post_id": 39374344, "comment_id": 66076820, "body": "I&#39;m pretty sure you <i>would have preferred to answer that as</i> <code>#define MYMACRO(a, op) ((a)op)</code> instead (but what the OP wants is kind of silly, including the semicolon in the macro)."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473263934, "post_id": 39374344, "comment_id": 66077047, "body": "Technically you&#39;re not doing what the OP asked for. The OP&#39;s example does <i>not</i> introduce parentheses."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473264260, "post_id": 39374344, "comment_id": 66077277, "body": "@EOF True, but parentheses are needed in case <code>a</code> has subexpressions that have lower precedence than the operator."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473266143, "post_id": 39374344, "comment_id": 66078306, "body": "@Barmar Unless the OP <i>wants</i> <code>MYMACRO(*ptr, ++)</code> to modify the pointer rather than the pointed-to object. In the absence of anything the OP has said about this, you should <i>probably</i> not introduce bugs for them."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1473266315, "post_id": 39374344, "comment_id": 66078396, "body": "If the parentheses are unwanted, a space would work too: <code>#define MYMACRO(a, op) a op</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473282291, "post_id": 39374344, "comment_id": 66085871, "body": "@EOF Without specific information to the contrary, I assume that people want function-like macros to be parsed similar to functions, where the comma has the lowest precedence. Failing to add parentheses is usually the <i>cause</i> of unexpected behavior."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473282429, "post_id": 39374344, "comment_id": 66085940, "body": "@EOF <a href=\"http://stackoverflow.com/questions/36862207/bad-parentheses-in-macro-definition?s=1|1.8332\" title=\"bad parentheses in macro definition\">stackoverflow.com/questions/36862207/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 6805507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226a5e70421d2fcb4ddabeb5ff664e90?s=128&d=identicon&r=PG&f=1", "display_name": "Georgios Chatzigiannis", "link": "https://stackoverflow.com/users/6805507/georgios-chatzigiannis"}, "edited": false, "score": 0, "creation_date": 1473404384, "post_id": 39374344, "comment_id": 66136423, "body": "thanks @Barmar. Thats what i was looking for. Although i had already somehow found a way around it to do what i needed"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1473437572, "post_id": 39374344, "comment_id": 66156122, "body": "I wonder why you accepted the other answer instead of mine. The code is the same, but I added more explanation of the problem with your code."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 6, "last_activity_date": 1473263345, "creation_date": 1473263345, "answer_id": 39374344, "question_id": 39374219, "link": "https://stackoverflow.com/questions/39374219/c-c-how-to-create-a-macro-that-accepts-the-increment-operator/39374344#39374344", "title": "(C/C++) how to create a macro that accepts the increment operator", "body": "<p>You don't need the <code>##</code> token pasting operator, because you're not trying to combine the parameters into a single token. Just use:</p>\n\n<pre><code>#define MYMACRO(a, op) (a)op;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": true, "score": 0, "last_activity_date": 1473263557, "creation_date": 1473263557, "answer_id": 39374415, "question_id": 39374219, "link": "https://stackoverflow.com/questions/39374219/c-c-how-to-create-a-macro-that-accepts-the-increment-operator/39374415#39374415", "title": "(C/C++) how to create a macro that accepts the increment operator", "body": "<p>You just need to combine the tokens like this:</p>\n\n<pre><code>#define MYMACRO(a, incrdecr) (a)incrdecr\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6805507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226a5e70421d2fcb4ddabeb5ff664e90?s=128&d=identicon&r=PG&f=1", "display_name": "Georgios Chatzigiannis", "link": "https://stackoverflow.com/users/6805507/georgios-chatzigiannis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 39374415, "answer_count": 2, "score": -2, "last_activity_date": 1473264511, "creation_date": 1473262972, "last_edit_date": 1473264511, "question_id": 39374219, "link": "https://stackoverflow.com/questions/39374219/c-c-how-to-create-a-macro-that-accepts-the-increment-operator", "title": "(C/C++) how to create a macro that accepts the increment operator", "body": "<p>to make my question precise i would like to create a macro that accepts as variable ++ and pastes it with another variable. In code:</p>\n\n<pre><code>#define MYMACRO(A, OP) /* .... */\n</code></pre>\n\n<p>and then if i write in the source file</p>\n\n<pre><code>MYMACRO(this-&gt;var, ++)\n</code></pre>\n\n<p>the preprocessor should paste in the code</p>\n\n<pre><code>this-&gt;var++;\n</code></pre>\n\n<p>When i am trying to define the macro as A##OP , it provides the following error:</p>\n\n<blockquote>\n  <p>pasting \"++\" and \"var\" does not give a valid preprocessing token</p>\n</blockquote>\n\n<p>Is it possible to do what i am trying?</p>\n\n<p>thanks in advance for the answer</p>\n"}, {"tags": ["c", "restrict", "strict-aliasing"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 3, "creation_date": 1473262327, "post_id": 39373964, "comment_id": 66076011, "body": "strict aliasing isn&#39;t a guarantee that something won&#39;t be accessed via more than one pointer -- just that it won&#39;t be accessed (generally) through a pointer to a different type.  <code>restrict</code> is different."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1473262356, "post_id": 39373964, "comment_id": 66076030, "body": "Do you have a concrete MVCE?"}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "edited": false, "score": 0, "creation_date": 1473262517, "post_id": 39373964, "comment_id": 66076155, "body": "I am implementing an XOR linked list which will typecast two different types of pointers. This makes GCC be confused and produce segfault excutables without setting <code>-fno-strict-aliasing</code> flag. I think that disabling global optimization is such a pity."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 2, "creation_date": 1473262660, "post_id": 39373964, "comment_id": 66076253, "body": "@KevinDong I&#39;d be interested to see the code that produces the error.  Would you please post?"}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "edited": false, "score": 0, "creation_date": 1473262784, "post_id": 39373964, "comment_id": 66076343, "body": "The code is really huge and complicated currently. It may take me some time to clean it up. ;-(. I may post the MVCE if the cleaning is done."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1473263107, "post_id": 39373964, "comment_id": 66076532, "body": "Pointer aliases because pointers points to the same object &quot;at the same time&quot;. Are you sure that is necessarily the case? E.g. you put aliasing pointers into different scopes so that although they point to the same thing, they don&#39;t point to it at the same time?"}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1473263356, "post_id": 39373964, "comment_id": 66076695, "body": "@user3528438 It is necessary if implementing an XOR linked list with two sentinel nodes with pointers rather than nodes themselves for reducing memory usage."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1473263478, "post_id": 39373964, "comment_id": 66076756, "body": "&quot;why not introduce an opposite keyword of restrict which tells compiler that do not assume that those two pointers point to different addresses.&quot;  --&gt; Is not this the result of not coding <code>restrict</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1473263485, "post_id": 39373964, "comment_id": 66076758, "body": "@KevinDong Perhaps you could use GCC&#39;s <code>__may_alias__</code> attribute to solve the problem."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473263545, "post_id": 39373964, "comment_id": 66076798, "body": "@chux Not really. The GCC optimization will produce erroneous code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473263642, "post_id": 39373964, "comment_id": 66076866, "body": "So you want a GCC keyword to <i>selectively</i> undo the GCC compiler flag.  Maybe a GCC <code>#pragma</code> would do?  Better than a language addition."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1473264050, "post_id": 39373964, "comment_id": 66077153, "body": "@IanAbbott Thanks for the information, but it seems not working in my code. ;-("}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 1, "creation_date": 1473270047, "post_id": 39373964, "comment_id": 66080272, "body": "@KevinDong I somehow doubt that this is your real problem. I&#39;m strongly suggesting searching your code for undefined behaviour. When talking about an xor list, do you mean a doubly linked list in which the pointer to the previous and next node are stored xor&#39;ed in a single pointer? Do you use <code>uintptr_t</code> for that?"}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1473270363, "post_id": 39373964, "comment_id": 66080414, "body": "@DanielJour Yes. I use <code>(uintptr_t)(void*)</code> instead. The problem appears around the list body and the two sentinel nodes which are declared of type <code>struct node*</code> rather than <code>void*</code>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1473272115, "post_id": 39373964, "comment_id": 66081269, "body": "A possible solution is to wrap all the pointer types you&#39;ll use in a <code>union</code>, then use the appropriate member of that <code>union</code> at the appropriate time. See <a href=\"http://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\" title=\"what is the strict aliasing rule\">stackoverflow.com/questions/98650/&hellip;</a>"}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1473272601, "post_id": 39373964, "comment_id": 66081458, "body": "@yano Brilliant! This is what I need. ;-) Thanks a lot."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1473274550, "post_id": 39373964, "comment_id": 66082333, "body": "@yano After some minor fixes, my code can be compiled and execute correctly without <code>-fno-strict-aliasing</code> and get some performance enhancement. Thanks again."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1473281935, "post_id": 39373964, "comment_id": 66085721, "body": "&quot;Therefore, the workaround method is to disable the global strict aliasing optimization&quot;  - this is a feature of Standard C, not an optimization. A better workaround is to not write code that breaks the rule."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473287507, "post_id": 39373964, "comment_id": 66087784, "body": "@M.M: The term &quot;C&quot; is used to refer to two languages--a semantically-powerful one invented by Dennis Ritchie, and a semantically-weakened version which has become popular.  Given that the semantics of the former have been stable for decades, while the semantics of the latter are being eroded, I favor targeting the former for any code which would benefit from type punning.  When using <code>-fno-strict-aliasing</code> performance benefit of using the <code>restrict</code> qualifier when possible (or cost of failing to use it) is increased, but if code uses <code>restrict</code> properly the <code>-fno-strict-alising</code> dialect..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473287627, "post_id": 39373964, "comment_id": 66087823, "body": "@M.M: ...will often have baseline performance almost as good as the strict-aliasing dialect; in cases where punning can offer performance gains they can more than offset the losses from -fno-strict-aliasing."}], "answers": [{"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1489167863, "creation_date": 1489167863, "answer_id": 42724622, "question_id": 39373964, "link": "https://stackoverflow.com/questions/39373964/opposite-keyword-of-restrict-in-c/42724622#42724622", "title": "Opposite keyword of &quot;restrict&quot; in C?", "body": "<p>Given the code:</p>\n\n<pre><code>int foo(int * restrict p)\n{\n  *p = 3;\n  someOutsideFunction();\n  return *p;\n}\n</code></pre>\n\n<p>a compiler is entitled to assume that as long as <code>p</code> is in scope, no object\nwhich is written using <code>*p</code> will be accessed via any means other than via\npointer which is copied or otherwise \"derived\" <em>from</em> <code>p</code>.  Other pointers to the object may exist elsewhere in the universe, but until <code>foo</code> returns none of them will be usable to access <code>*p</code>.  Consequently, a compiler could replace the above with</p>\n\n<pre><code>int foo(int * restrict p)\n{\n  someOutsideFunction();\n  *p = 3;\n  return 3;\n}\n</code></pre>\n\n<p>since it can see that no pointer copied or derived from <code>p</code> is ever exposed in a way that <code>someOutsideFunction</code> could see it, and thus no legitimate way for <code>someOutsideFunction</code> to access the object <code>*p</code>.</p>\n\n<p>If <code>someOutsideFunction</code> could--unbeknownst to the compiler processing <code>foo</code>--include a keyword that behaved as the opposite of <code>restrict</code>, and could allow it to access the object identified by <code>p</code> [receiving a pointer to that object from a global variable or other such means], that would make it impossible for the compiler processing <code>foo</code> to know whether <code>someOutsideFunction</code> might access <code>*p</code>, and thus impossible for it to know whether it could safely apply the indicated optimization.</p>\n"}], "owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1489167863, "creation_date": 1473262144, "last_edit_date": 1495539986, "question_id": 39373964, "link": "https://stackoverflow.com/questions/39373964/opposite-keyword-of-restrict-in-c", "title": "Opposite keyword of &quot;restrict&quot; in C?", "body": "<p>Since strict aliasing may help compiler optimize better, C99 introduced the <code>restrict</code> keyword which can be used as a qualifier of a variable if programmers guarantee that it won't be accessed through a pointer to a different type. However, typecasting between different types is inevitable for several reasons and this will make compiler assume that one pointer is not an alias of the other. Therefore, the workaround method is to disable the global strict aliasing optimization by passing <code>-fno-strict-aliasing</code> (a GCC flag). This makes totally no sense because there may only have two pointers that should not be fully optimized. Hence, why not introduce an opposite keyword of <code>restrict</code> which tells compiler that do not assume that those two pointers point to different addresses. This is somewhat similar to what <code>volatile</code> does, and that tells compiler this variable is changed vastly, so treat them in a special way. Is it possible to create such keyword?</p>\n\n<p><strong>EDIT:</strong> There is a way to solve this problem. Please see <a href=\"https://stackoverflow.com/questions/39373964/opposite-keyword-of-restrict-in-c#comment66081269_39373964\">yano's</a> comment below.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473262186, "post_id": 39373918, "comment_id": 66075914, "body": "If you use prototypes rather than K&amp;R old-style function declarations, the compiler is obligated to issue a diagnostic if you pass an incorrect pointer-type."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1473262188, "post_id": 39373918, "comment_id": 66075915, "body": "@LPs , nope, it&#39;s okay. Returning a <code>struct</code> copies the data (like returning an <code>int</code>)."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1473262207, "post_id": 39373918, "comment_id": 66075929, "body": "Enable compiler warnings and listen to it."}, {"owner": {"reputation": 12137, "user_id": 451007, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3a48b34dda00ca0a5745a5c285068c?s=128&d=identicon&r=PG", "display_name": "010110110101", "link": "https://stackoverflow.com/users/451007/010110110101"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1473262241, "post_id": 39373918, "comment_id": 66075949, "body": "@MikeCAT I&#39;ve got alot of them turned on and nothing so far.  Any one in particular you think will catch this?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1473262342, "post_id": 39373918, "comment_id": 66076016, "body": "Passing a pointer to pointer to a function expecting a single pointer should emit a warning with <code>-Wall -pedantic</code> flags on, or are you passing to a function expecting a <code>void *</code>?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1473262395, "post_id": 39373918, "comment_id": 66076057, "body": "@Myst My bad. I cancelled"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1473262491, "post_id": 39373918, "comment_id": 66076139, "body": "What is the prototype of <code>initialize()</code>? What kind of pointer does it take? <code>struct my_struct *</code> or <code>void *</code>?"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1473262533, "post_id": 39373918, "comment_id": 66076166, "body": "What? And you&#39;re <i>not</i> getting a warning? Is your GCC ancient?"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 1, "creation_date": 1473262593, "post_id": 39373918, "comment_id": 66076209, "body": "Ah ... wait. Why do you live 27 years in the past? (C89)"}, {"owner": {"reputation": 12137, "user_id": 451007, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3a48b34dda00ca0a5745a5c285068c?s=128&d=identicon&r=PG", "display_name": "010110110101", "link": "https://stackoverflow.com/users/451007/010110110101"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1473262697, "post_id": 39373918, "comment_id": 66076281, "body": "@Daniel Jour -- nope - C99 takes it too."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473262842, "post_id": 39373918, "comment_id": 66076378, "body": "If the prototype for <code>initialize()</code> is visible at the point it is called, and the argument passed to it cannot be converted to the type of the parameter as if by conversion, the compiler <i>must</i> issue a diagnostic message. If your compiler doesn&#39;t, file a bug report."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1473263062, "post_id": 39373918, "comment_id": 66076499, "body": "The option is <code>-Wincompatible-pointer-types</code>, and should be included in <code>-Wall</code>, I believe."}, {"owner": {"reputation": 12137, "user_id": 451007, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3a48b34dda00ca0a5745a5c285068c?s=128&d=identicon&r=PG", "display_name": "010110110101", "link": "https://stackoverflow.com/users/451007/010110110101"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1473263151, "post_id": 39373918, "comment_id": 66076567, "body": "Thanks @Groo.  That was it.  A stupid mistake was causing that warning from not firing.  It&#39;s showing the error now"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 1, "creation_date": 1473263462, "post_id": 39373918, "comment_id": 66076747, "body": "@010110110101 Can you share the mistake that caused this? I think this could be useful information for future readers."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1473263636, "post_id": 39373918, "comment_id": 66076862, "body": "@LPs, it wasn&#39;t a &quot;bad&quot;, you might have known about <code>struct</code> return behavior, but future readers might not. Mistakes get the knowledge out there, which is good for future readers :)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473265400, "post_id": 39373918, "comment_id": 66077924, "body": "It looks like a misuse of C, that is some kind of undefined behavior. Shared names should be declared the same, so practically should be declared in a single <i>common</i> header file suitably included in every compilation unit using these names."}], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1473263744, "post_id": 39374311, "comment_id": 66076933, "body": "But using different signatures in the header and in the unit must emit a warning too, isn&#39;t it?"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1473263997, "post_id": 39374311, "comment_id": 66077102, "body": "@AlterMann Only if all translation units actually include that header with the signature."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1473264421, "post_id": 39374311, "comment_id": 66077369, "body": "<code>init.c:2:6: warning: no previous prototype for \u2018init\u2019 [-Wmissing-prototypes]</code>"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1473264540, "post_id": 39374311, "comment_id": 66077441, "body": "@AlterMann True, though I&#39;ve seen (mostly legacy) code doing what I added in my edit..."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1473264652, "post_id": 39374311, "comment_id": 66077501, "body": "Yes, after your last edit it compiles without warnings"}], "tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": true, "score": 3, "last_activity_date": 1473264673, "last_edit_date": 1473264673, "creation_date": 1473263248, "answer_id": 39374311, "question_id": 39373918, "link": "https://stackoverflow.com/questions/39373918/how-to-detect-instances-where-code-accidentally-creates-a-pointer-to-a-pointer/39374311#39374311", "title": "How to detect instances where code accidentally creates a pointer to a pointer?", "body": "<p>Passing a pointer to a pointer where only a pointer is expected must cause a compiler error. Thus I cannot reproduce what your example is suggesting (GCC 5.4.0, C99).</p>\n\n<p>But there is a situation that can cause this kind of error:</p>\n\n<p>foo.h:</p>\n\n<pre><code>struct foo {\n  int dummy;\n};\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include \"foo.h\"\nvoid init(void *);\nint main() {\n  struct foo f;\n  struct foo * fp = &amp;f;\n  init(&amp;f);\n  init(&amp;fp);\n  return 0;\n}\n</code></pre>\n\n<p>init.c:</p>\n\n<pre><code>#include \"foo.h\"\n// Need a prototype because otherwise -Wmissing-prototypes issues a warning\n// Such code is not that uncommon, though, especially when e.g. there\n// are C preprocessor macros that help defining some kinds of functions.\nvoid init(struct foo *f);\nvoid init(struct foo *f) {\n  f-&gt;dummy = 42;\n}\n</code></pre>\n\n<p>This compiles fine without any warning. The translation unit <code>main.c</code> sees the (wrong) declaration <code>void init(void *)</code> and thus emits no warning when passing different pointer types (as they're all implicitly convertible to <code>void *</code>). Since C compilers usually don't mangle parameter types into the symbols of the resulting object files, the linker will happily resolve the reference to the function <code>init</code> from <code>main.o</code> with the function symbol <code>init</code> in <code>init.o</code>.</p>\n\n<pre><code>[nix-shell:/tmp/wtf]$ nm init.o \n0000000000000000 T init\n[nix-shell:/tmp/wtf]$ nm main.o \n                 U _GLOBAL_OFFSET_TABLE_\n                 U init\n0000000000000000 T main\n                 U __stack_chk_fail\n</code></pre>\n\n<p>C++ compilers <em>do</em> mangle parameter types into the symbols, thus:</p>\n\n<pre><code>[nix-shell:/tmp/wtf]$ LANG= g++ -Wall -Wextra main.c init.c \n/run/user/1000/cctWt0Nl.o: In function `main':\nmain.c:(.text.startup+0x1d): undefined reference to `init(void*)'\nmain.c:(.text.startup+0x27): undefined reference to `init(void*)'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p><em>Note: I'm <strong>not</strong> suggesting to compile your C code with a C++ compiler. Don't do that, please.</em></p>\n"}], "owner": {"reputation": 12137, "user_id": 451007, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3a48b34dda00ca0a5745a5c285068c?s=128&d=identicon&r=PG", "display_name": "010110110101", "link": "https://stackoverflow.com/users/451007/010110110101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 39374311, "answer_count": 1, "score": -1, "last_activity_date": 1473264673, "creation_date": 1473262009, "last_edit_date": 1473262850, "question_id": 39373918, "link": "https://stackoverflow.com/questions/39373918/how-to-detect-instances-where-code-accidentally-creates-a-pointer-to-a-pointer", "title": "How to detect instances where code accidentally creates a pointer to a pointer?", "body": "<p>In doing some wholesale refactoring, I've come across instances where I've made the same mistake.  I have accidentally passed a pointer to a pointer instead of just the pointer.   </p>\n\n<p>Code explains it best. Look for the <code>/* oops */</code> below.</p>\n\n<p>The struct:</p>\n\n<pre><code>struct my_struct {\n    int x;\n    int y;\n    int z;\n    int value;\n}\n</code></pre>\n\n<p>Initialize function:</p>\n\n<pre><code>void initialize(struct my_struct *s)\n{\n    s-&gt;x = 0;\n    s-&gt;y = 0;\n    s-&gt;z = 0;\n    s-&gt;value = 0;\n}\n</code></pre>\n\n<p>The original function:</p>\n\n<pre><code>struct my_struct do_something()\n{\n    struct my_struct s;\n\n    initialize(&amp;s);\n\n    s.value = 27;\n\n    return s;\n}\n</code></pre>\n\n<p>The new function</p>\n\n<pre><code>void do_something(struct my_struct *s)\n{\n    initialize(&amp;s); /* oops! */\n\n    s-&gt;value = 27;\n}\n</code></pre>\n\n<p>It should have been:</p>\n\n<pre><code>void do_something(struct my_struct *s)\n{\n    initialize(s); /* fixed */\n\n    s-&gt;value = 27;\n}\n</code></pre>\n\n<p>Is there a way, maybe a compiler flag or a linter that can help me locate these oopsies?</p>\n\n<p><strong>NOTES:</strong>\nI'm using gcc (but if another compiler or linter can find this, please tell)</p>\n\n<p>I'm using these compiler flags and they don't catch it:</p>\n\n<pre><code>CFLAGS = \\\n    -std=c89 \\\n    -pedantic \\\n    -pedantic-errors \\\n    -Werror \\\n    -Wextra \\\n    -Wmissing-prototypes \\\n    -Wall \\\n    -Wold-style-definition \\\n    -Wdeclaration-after-statement \\\n    -Wundef \\\n    -Wpointer-arith \\\n    -Wcast-qual \\\n    -Wcast-align \\\n    -Wfloat-equal \\\n    -Wno-missing-braces\n</code></pre>\n\n<p>I have prototypes in a header for everything.</p>\n\n<p>It's not the standard I picked -- C90. C99 and C11 all take it too.  </p>\n\n<pre><code>$ gcc --version\ngcc (GCC) 6.1.1 20160621 (Red Hat 6.1.1-3)\n</code></pre>\n"}, {"tags": ["c", "struct", "free", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1473261764, "post_id": 39373747, "comment_id": 66075648, "body": "OT: function names in UPPER are usually used for function-like macros, not for normal functions."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6276294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-3Pxl6hHCA3s/AAAAAAAAAAI/AAAAAAAAAE8/9X5NTYxm6Ew/photo.jpg?sz=128", "display_name": "lvl", "link": "https://stackoverflow.com/users/6276294/lvl"}, "edited": false, "score": 0, "creation_date": 1473262669, "post_id": 39373851, "comment_id": 66076261, "body": "So in order to &quot;free&quot; those two pointers, will: A[i].hijo1 = NULL; A[i].hijo2 = NULL; be enough?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 77, "user_id": 6276294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-3Pxl6hHCA3s/AAAAAAAAAAI/AAAAAAAAAE8/9X5NTYxm6Ew/photo.jpg?sz=128", "display_name": "lvl", "link": "https://stackoverflow.com/users/6276294/lvl"}, "edited": false, "score": 0, "creation_date": 1473262972, "post_id": 39373851, "comment_id": 66076455, "body": "@Luis_V You could set them to NULL. Also take into account that for example function INIC_ARBOL sets this data fields only for less than a half of nodes."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1473261851, "creation_date": 1473261851, "answer_id": 39373851, "question_id": 39373747, "link": "https://stackoverflow.com/questions/39373747/memory-error-trying-to-free-pointers-in-struct-c/39373851#39373851", "title": "Memory error trying to free pointers in struct - C", "body": "<p>In this function</p>\n\n<pre><code>Arreglo INIC_ARR(int longitud){\n    int i;\n    Arreglo A = (Arreglo)calloc(longitud,sizeof(Nodo));\n    for(i = 0; i &lt; longitud; i++){\n        A[i].valor = rand()%10;\n    }\n    return A;\n}\n</code></pre>\n\n<p>there is allocated one extent of memory using statement</p>\n\n<pre><code>Arreglo A = (Arreglo)calloc(longitud,sizeof(Nodo));\n</code></pre>\n\n<p>You may not free elements of the dynamically allocated array </p>\n\n<pre><code>void FREE_ARBOL(Arreglo A, int longitud){\n    int i;\n    for(i = 0; i &lt; longitud; i++){\n        free(A[i].hijo1);\n        free(A[i].hijo2);\n    }\n    free(A);\n}\n</code></pre>\n\n<p>because they are parts of the extent and were not allocated themselves dynamically.</p>\n"}, {"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 1, "last_activity_date": 1473261936, "creation_date": 1473261936, "answer_id": 39373887, "question_id": 39373747, "link": "https://stackoverflow.com/questions/39373747/memory-error-trying-to-free-pointers-in-struct-c/39373887#39373887", "title": "Memory error trying to free pointers in struct - C", "body": "<p>Do not pass what is neither returned from memory management functions nor null pointer, or you will invoke <em>undefined behavior</em>.</p>\n\n<p>Remove the problematic part</p>\n\n<pre><code>for(i = 0; i &lt; longitud; i++){\n    free(A[i].hijo1);\n    free(A[i].hijo2);\n}\n</code></pre>\n\n<p>from the function <code>FREE_ARBOL()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "is_accepted": false, "score": 1, "last_activity_date": 1473262501, "creation_date": 1473262501, "answer_id": 39374071, "question_id": 39373747, "link": "https://stackoverflow.com/questions/39373747/memory-error-trying-to-free-pointers-in-struct-c/39374071#39374071", "title": "Memory error trying to free pointers in struct - C", "body": "<p>Short story: You only have one <code>calloc</code>, so you should only have one <code>free</code>. </p>\n\n<p>Additionally, since you have those <code>if</code>s (e.g.<code>if (2*i + 1 &lt; longitud)</code>) inside <code>INIC_ARBOL</code>, half nodes in your array don't even point to anything. And I would remove <code>typedef Nodo *Arreglo</code> completely and just use <code>Node*</code> within the rest of the code, it would make reading the code much easier.</p>\n"}], "owner": {"reputation": 77, "user_id": 6276294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-3Pxl6hHCA3s/AAAAAAAAAAI/AAAAAAAAAE8/9X5NTYxm6Ew/photo.jpg?sz=128", "display_name": "lvl", "link": "https://stackoverflow.com/users/6276294/lvl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 39373851, "answer_count": 3, "score": 3, "last_activity_date": 1473262501, "creation_date": 1473261520, "question_id": 39373747, "link": "https://stackoverflow.com/questions/39373747/memory-error-trying-to-free-pointers-in-struct-c", "title": "Memory error trying to free pointers in struct - C", "body": "<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Nodo{\n    int valor;\n    struct Nodo* hijo1;\n    struct Nodo* hijo2;\n}Nodo;\n\ntypedef Nodo* Arreglo;\n\nArreglo INIC_ARR(int longitud);\nvoid IMP_ARR(Arreglo A,int longitud);\nvoid INIC_ARBOL(Arreglo A, int longitud);\nvoid FREE_ARBOL(Arreglo A, int longitud);\n\n\nint main(){\n    Arreglo A;\n    int longitud = 10;\n    A = INIC_ARR(10);\n    INIC_ARBOL(A,longitud);\n    IMP_ARR(A,longitud);\n    FREE_ARBOL(A,longitud);\n    return 0;\n}\n\nArreglo INIC_ARR(int longitud){\n    int i;\n    Arreglo A = (Arreglo)calloc(longitud,sizeof(Nodo));\n    for(i = 0; i &lt; longitud; i++){\n        A[i].valor = rand()%10;\n    }\n    return A;\n}\n\nvoid IMP_ARR(Arreglo A,int longitud){\n    int i;\n    for(i = 0;i &lt; longitud; i++){\n        printf(\"[%d,\",A[i].valor);\n        if(A[i].hijo1 == NULL){\n            printf(\"-,\");\n        }\n        else{\n            printf(\"%d,\",(*(A[i].hijo1)).valor);\n        }\n        if(A[i].hijo2 == NULL){\n            printf(\"-]\");\n        }\n        else{\n            printf(\"%d]\",(*(A[i].hijo2)).valor);\n        }\n\n    }\n    printf(\"\\n\");\n}\n\nvoid INIC_ARBOL(Arreglo A, int longitud){\n    int i;\n    for(i = 0; i &lt; longitud; i++){\n        if(2*i + 1 &lt; longitud)\n            A[i].hijo1 = &amp;A[2*i + 1];\n        if(2*i + 2 &lt; longitud)\n            A[i].hijo2 = &amp;A[2*i + 2];\n    }\n}\n\n\nvoid FREE_ARBOL(Arreglo A, int longitud){\n    int i;\n    for(i = 0; i &lt; longitud; i++){\n        free(A[i].hijo1);\n        free(A[i].hijo2);\n    }\n    free(A);\n}\n</code></pre>\n\n<p>I created an arrary of structs (Nodo); each have two pointers that are initialised in INIC_ARBOL function. I tried to print and then free them using FREE_ARBOL, and then this shows up:</p>\n\n<pre><code>[3,6,7][6,5,3][7,5,6][5,2,9][3,1,-][5,-,-][6,-,-][2,-,-][9,-,-][1,-,-]\n*** Error in `./a.out': free(): invalid pointer: 0x0000000000a31028 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x77725)[0x7f3f8adea725]\n/lib/x86_64-linux-gnu/libc.so.6(+0x7ff4a)[0x7f3f8adf2f4a]\n/lib/x86_64-linux-gnu/libc.so.6(cfree+0x4c)[0x7f3f8adf6abc]\n./a.out[0x40096b]\n./a.out[0x400696]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0)[0x7f3f8ad93830]\n./a.out[0x400579]\n======= Memory map: ========\n00400000-00401000 r-xp 00000000 08:0a 140095                             /home/luis/Documentos/Programacion/C/a.out\n00600000-00601000 r--p 00000000 08:0a 140095                             /home/luis/Documentos/Programacion/C/a.out\n00601000-00602000 rw-p 00001000 08:0a 140095                             /home/luis/Documentos/Programacion/C/a.out\n00a31000-00a52000 rw-p 00000000 00:00 0                                  [heap]\n7f3f84000000-7f3f84021000 rw-p 00000000 00:00 0 \n7f3f84021000-7f3f88000000 ---p 00000000 00:00 0 \n7f3f8ab5d000-7f3f8ab73000 r-xp 00000000 08:09 135547                     /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f3f8ab73000-7f3f8ad72000 ---p 00016000 08:09 135547                     /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f3f8ad72000-7f3f8ad73000 rw-p 00015000 08:09 135547                     /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f3f8ad73000-7f3f8af33000 r-xp 00000000 08:09 141748                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f3f8af33000-7f3f8b132000 ---p 001c0000 08:09 141748                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f3f8b132000-7f3f8b136000 r--p 001bf000 08:09 141748                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f3f8b136000-7f3f8b138000 rw-p 001c3000 08:09 141748                     /lib/x86_64-linux-gnu/libc-2.23.so\n7f3f8b138000-7f3f8b13c000 rw-p 00000000 00:00 0 \n7f3f8b13c000-7f3f8b162000 r-xp 00000000 08:09 141744                     /lib/x86_64-linux-gnu/ld-2.23.so\n7f3f8b340000-7f3f8b343000 rw-p 00000000 00:00 0 \n7f3f8b35e000-7f3f8b361000 rw-p 00000000 00:00 0 \n7f3f8b361000-7f3f8b362000 r--p 00025000 08:09 141744                     /lib/x86_64-linux-gnu/ld-2.23.so\n7f3f8b362000-7f3f8b363000 rw-p 00026000 08:09 141744                     /lib/x86_64-linux-gnu/ld-2.23.so\n7f3f8b363000-7f3f8b364000 rw-p 00000000 00:00 0 \n7fffddc61000-7fffddc82000 rw-p 00000000 00:00 0                          [stack]\n7fffddd39000-7fffddd3b000 r--p 00000000 00:00 0                          [vvar]\n7fffddd3b000-7fffddd3d000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\nAbortado (`\n</code></pre>\n\n<p>core' generado)</p>\n\n<p>I have zero knowledge on tools like valgrind so if you could explain me slowly what to do to fix I'd appreciate it.</p>\n"}, {"tags": ["c", "undefined-behavior"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1473261073, "post_id": 39373525, "comment_id": 66075186, "body": "Because undefined behaviour is allowed to do that. By the way, I don&#39;t see anything wrong with this question. Upvoted."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 3, "creation_date": 1473261114, "post_id": 39373525, "comment_id": 66075223, "body": "Its because your program is very simple. Try to insert a call to some other function between calls to <code>abc()</code> and <code>printf()</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1473261248, "post_id": 39373525, "comment_id": 66075319, "body": "So what? &quot;Undefined&quot; doesn&#39;t mean &quot;random&quot;..."}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1473261600, "post_id": 39373525, "comment_id": 66075533, "body": "Add this, immediately after the call to <code>abc()</code> and before the existing <code>printf</code>: <code>printf(&quot;Test string %d %d %d %d\\n&quot;, 1, 2, 3, 4)</code>. Then see what happens :)"}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1473262465, "post_id": 39373525, "comment_id": 66076123, "body": "Call <i>abc()</i> then call <i>def()</i> and after check what <i>p</i> points to... You could make <i>i</i> static, as long as there is no reentrance issue... (e.g. threads modifying <code>*p</code> ...)"}], "answers": [{"comments": [{"owner": {"reputation": 1990, "user_id": 2402971, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/58f832c3d3522e39d5c468e1114a33a1?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/2402971/cody"}, "edited": false, "score": 0, "creation_date": 1473261285, "post_id": 39373563, "comment_id": 66075342, "body": "what&#39;s UB ?? pls define"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1990, "user_id": 2402971, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/58f832c3d3522e39d5c468e1114a33a1?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/2402971/cody"}, "edited": false, "score": 1, "creation_date": 1473261313, "post_id": 39373563, "comment_id": 66075362, "body": "@Cody UB -&gt; undefined behavior."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1473261295, "last_edit_date": 1473261295, "creation_date": 1473261062, "answer_id": 39373563, "question_id": 39373525, "link": "https://stackoverflow.com/questions/39373525/c-function-returning-a-pointer-to-a-local-variable/39373563#39373563", "title": "C - function returning a pointer to a local variable", "body": "<p>Well, undefined behavior is, undefined. You can never <strong>rely</strong> on UB (<em>or on an output of a program invoking UB</em>).</p>\n\n<p>Maybe, <em>just maybe</em> in your environment and for <em>your</em> code, the memory location allocated for the local variable is not <em>reclaimed</em> by the OS and still <em>accessible</em>, but there's no guarantee that it will have the same behavior for any other platform.</p>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1473261355, "post_id": 39373656, "comment_id": 66075385, "body": "This is <i>very</i> implementation specific."}, {"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473261473, "post_id": 39373656, "comment_id": 66075446, "body": "Yes, I am only explaining the behavior to satisfy his curiosity."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473261500, "post_id": 39373656, "comment_id": 66075462, "body": "As an example Keil C compiler for i8051: It allocates locals in data segment by building a calling tree at link time, so stack is used only to pass control"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473261571, "post_id": 39373656, "comment_id": 66075503, "body": "@Serge: How does it handle recursion?"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473261738, "post_id": 39373656, "comment_id": 66075631, "body": "@EOF Well, it has a special keyword <code>recursion</code> (or <code>-ive</code>, I can&#39;t recall) to declare a function as a recursive one. Then it maintains an software stack to copy locals on that stack upon second entry to that function. TBH, they did a good job taking to account capabilities of that mCPU"}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1473261746, "post_id": 39373656, "comment_id": 66075636, "body": "Generally speaking, such compilers (same as with those for Microchip 8 bit ones) don&#39;t allow recursion (they detect it at link time). They will also often complain about calling the same function from background and ISRs (i.e. no such thing as re-entrant code)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1473261861, "post_id": 39373656, "comment_id": 66075704, "body": "@kdopen: C <i>requires</i> recursion to be possible: C11 draft standard n1570: <i>6.5.2.2 Function calls 11 Recursive function calls shall be permitted, both directly and indirectly through any chain of other functions.</i> If the compiler doesn&#39;t allow recursion, it&#39;s not a C-compiler."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473261936, "post_id": 39373656, "comment_id": 66075753, "body": "@EOF when Keil released the MCS51 comiler <code>C11</code> did not exist yet)"}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 1, "creation_date": 1473262000, "post_id": 39373656, "comment_id": 66075795, "body": "Which is where the spec meets reality. I&#39;ve had this discussion with others. Sometimes, there is no way to create a conformant compiler for a given chip architecture. That doesn&#39;t mean an almost-compliant compiler isn&#39;t better than raw assembler. Also, those compilers are usually C90"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473262062, "post_id": 39373656, "comment_id": 66075833, "body": "@Serge: C99 draft standard n1256: <i>6.5.2.2 Function calls 11 Recursive function calls shall be permitted, both directly and indirectly through any chain of other functions.</i> This is not new."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473262130, "post_id": 39373656, "comment_id": 66075877, "body": "@EOF I used that compiler in the beginning of 00&#39;s. Anyway, it is a history now."}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473262261, "post_id": 39373656, "comment_id": 66075964, "body": "@Serge the one I&#39;m talking about is still available and still in use: &quot;All the MPLAB XC compilers conform to the ANSI X3.159-1989 Standard for programming languages (with the exception of the MPLAB XC8 compiler\u2019s inability to allow recursion, as mentioned in the footnote). This is commonly called the C89 Standard. Some features from the later standard, C99, are also supported. &quot;"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "reply_to_user": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1473262410, "post_id": 39373656, "comment_id": 66076065, "body": "@kdopen I doubt you would find anything significantly newer for MCS51, so that Keil&#39;s compiler is still available in a sense. At least I still have it :)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473287046, "post_id": 39373656, "comment_id": 66087641, "body": "@EOF: Does the Standard specify any minimum depth that an implementation must support without UB?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473287442, "post_id": 39373656, "comment_id": 66087757, "body": "@supercat: None that I&#39;m aware of."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473288915, "post_id": 39373656, "comment_id": 66088185, "body": "@EOF: Some implementations that statically allocate stacks will only run programs that can be guaranteed not to die from a stack overflow.  While there are purposes for which recursion is needed, a guarantee that a program will work without stack overflow seems more useful than saying that an implementation must &quot;try&quot; to run a program, but can do anything it likes if it overflows an arbitrarily-small stack [the &quot;one program&quot; rule could be satisfied by a contrived program whose stack usage could be optimized away]."}, {"owner": {"reputation": 12724, "user_id": 12139179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50aa08ca41bf24e8478a9b4dbc067c3?s=128&d=identicon&r=PG&f=1", "display_name": "RobertS supports Monica Cellio", "link": "https://stackoverflow.com/users/12139179/roberts-supports-monica-cellio"}, "edited": false, "score": 0, "creation_date": 1592936748, "post_id": 39373656, "comment_id": 110602347, "body": "Suggestion: &quot;you should not rely on that behavior.&quot; -&gt; &quot;you should not rely on that behavior, which is undefined per the standard.&quot;"}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": true, "score": 5, "last_activity_date": 1473261802, "last_edit_date": 1473261802, "creation_date": 1473261319, "answer_id": 39373656, "question_id": 39373525, "link": "https://stackoverflow.com/questions/39373525/c-function-returning-a-pointer-to-a-local-variable/39373656#39373656", "title": "C - function returning a pointer to a local variable", "body": "<p>Every time you call <code>abc</code> it \"marks\" a region at the top of the stack as the place where it will write all of its local variables. It does that by moving the pointer that indicates where the top of stack is. That region is called the stack frame. When the function returns, it indicates that it does not want to use that region anymore by moving the stack pointer to where it was originally. As a result, if you call other functions afterwards, they will reuse that region of the stack for their own purposes. But in your case, you haven't called any other functions yet. So that region of the stack is left in the same state.</p>\n\n<p>All the above explain the behavior of your code. It is not necessary that all C compilers implement functions that way and therefore <strong>you should not rely on that behavior</strong>.</p>\n"}], "owner": {"reputation": 1990, "user_id": 2402971, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/58f832c3d3522e39d5c468e1114a33a1?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/2402971/cody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 0, "accepted_answer_id": 39373656, "answer_count": 2, "score": 6, "last_activity_date": 1473261966, "creation_date": 1473260983, "last_edit_date": 1495540305, "question_id": 39373525, "link": "https://stackoverflow.com/questions/39373525/c-function-returning-a-pointer-to-a-local-variable", "title": "C - function returning a pointer to a local variable", "body": "<p>Consider the following code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint *abc(); // this function returns a pointer of type int\n\nint main()\n{\n    int *ptr;\n    ptr = abc();\n    printf(\"%d\", *ptr);\n    return 0;\n}\n\nint *abc()\n{\n    int i = 45500, *p;\n    p = &amp;i;\n    return p;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<p>45500</p>\n\n<p>I know according to <a href=\"https://stackoverflow.com/questions/4570366/pointer-to-local-variable\">link</a> this type of behavior is undefined. But why i am getting correct value everytime i run the program.</p>\n"}, {"tags": ["c", "windows", "gcc", "cygwin"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1473261148, "post_id": 39373512, "comment_id": 66075246, "body": "Print the value of <code>f</code> after each step using <code>&quot;%.16f&quot;</code> format and you will notice when the value of <code>f</code> starts to deviate from the analytical value."}, {"owner": {"reputation": 101, "user_id": 6805105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nmi1q.png?s=128&g=1", "display_name": "Yoshino Taro", "link": "https://stackoverflow.com/users/6805105/yoshino-taro"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1473262645, "post_id": 39373512, "comment_id": 66076245, "body": "Thanks for the quick responses guys. It seems this is well known problem. I don&#39;t want to leave it as it is, but there seems to be no way to avoid..."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1473264507, "post_id": 39373512, "comment_id": 66077423, "body": "@YoshinoTaro You could avoid it by using the <code>round</code> function before casting to <code>int</code>, e.g. <code>d = (int)round(f);</code>. Also, your <code>%lf</code> printf conversion specifier can be shortened to <code>%f</code> as the <code>l</code> is ignored in this case."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1473265787, "post_id": 39373512, "comment_id": 66078148, "body": "@IanAbbott I don&#39;t think <code>round</code> would be appropriate very often. You might try multiplying by (1 + epsilon) before truncating."}, {"owner": {"reputation": 101, "user_id": 6805105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nmi1q.png?s=128&g=1", "display_name": "Yoshino Taro", "link": "https://stackoverflow.com/users/6805105/yoshino-taro"}, "edited": false, "score": 0, "creation_date": 1473266920, "post_id": 39373512, "comment_id": 66078718, "body": "Thank you for the information!  I&#39;ll try the way you guys teach me. I appreciate it very much. :)"}], "owner": {"reputation": 101, "user_id": 6805105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nmi1q.png?s=128&g=1", "display_name": "Yoshino Taro", "link": "https://stackoverflow.com/users/6805105/yoshino-taro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1473261537, "answer_count": 0, "score": 0, "last_activity_date": 1473260934, "creation_date": 1473260934, "question_id": 39373512, "link": "https://stackoverflow.com/questions/39373512/simple-c-program-using-0-12-gets-a-weird-result-with-gcc-on-cygwin", "closed_reason": "Duplicate", "title": "Simple &quot;C&quot; program using &quot;0.12&quot; gets a weird result with GCC on cygwin", "body": "<p>When I was making a ftoa function by myself for my IoT product, I've got a weird problem with GCC on cygwin.</p>\n\n<p>The program below should get zero. But the result is 1.000000!?</p>\n\n<p><strong>gcctest.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main()\n{\n    double f = 0.12;\n    int d;\n    f *= 10;    // f = 1.2\n    d = (int)f; // d = 1\n    f -= d;     // f = 0.2\n    f *= 10;    // f = 2.0\n    d = (int)f; // d should be 2\n    f -= d;     // f should be 0.0\n    printf(\"%lf\\n\", f);\n}\n</code></pre>\n\n<p>if you try f = 0.11 or 0.13, you'll get zero correctly.</p>\n\n<p>Since I doubt the \"cast\" operation at \"d = (int)f\", I tried a test program below.</p>\n\n<p><strong>gcctest2.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    double f = 2.0;\n    int d;\n    d = (int)f;  // d = 2\n    f -= d;      // f = 0.0\n    printf(\"%lf\\n\", f);\n}\n</code></pre>\n\n<p>With this case, the result is zero. It seems the procedure of \"gcctest.c\" holds some problem. </p>\n\n<p>Is this known problem? Do you know how to avoid this case to get the correct result? I would appreciate it if I could get any helps.</p>\n\n<p>The versions of gcc and cygwin are below.</p>\n\n<pre><code>$ gcc --version\ngcc (GCC) 4.8.2\nCopyright (C) 2013 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n$ cygcheck -c cygwin\nCygwin Package Information\nPackage              Version        Status\ncygwin               1.7.28-2       OK\n</code></pre>\n\n<p>Thanks, taro</p>\n"}, {"tags": ["c", "linux", "system-calls"], "comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 1, "creation_date": 1473259853, "post_id": 39373063, "comment_id": 66074266, "body": "Since you don&#39;t show your <code>#include</code>s, we can&#39;t know what prototypes are in scope. Please provide a short, <b>complete</b> program that demonstrates the error you are having.  See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for more info."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1473259872, "post_id": 39373063, "comment_id": 66074290, "body": "Use constants instead of the magic numbers! Why do we need to translate them into anything meaningful?"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5695385, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-sff0LhDONtY/AAAAAAAAAAI/AAAAAAAAAIU/aknPgRSI6DA/photo.jpg?sz=128", "display_name": "Maxwell Powell", "link": "https://stackoverflow.com/users/5695385/maxwell-powell"}, "edited": false, "score": 0, "creation_date": 1473260457, "post_id": 39373185, "comment_id": 66074740, "body": "The headers solve the issue. And the flags I copy-pasted strictly for the example."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473260458, "post_id": 39373185, "comment_id": 66074742, "body": "@EugeneSh.  The canonical flags for <code>creat()</code> \u2014 or the third argument of <code>open()</code> \u2014 are direly verbose: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/sys_stat.h.html\" rel=\"nofollow noreferrer\"><code>S_IRWXU | S_IRGRP | S_IXGRP | S_IXOTH</code></a> for <code>0751</code>.  It&#39;s a lot easier to read the octal than the standardese."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1473261101, "post_id": 39373185, "comment_id": 66075210, "body": "Well, I suppose I could live with <code>#define MODE_0751 (S_IRWXU | S_IRGRP | S_IXGRP | S_IXOTH)</code>; that keeps both parties relatively happy.  :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1473261640, "post_id": 39373185, "comment_id": 66075559, "body": "Note that modern POSIX (2004, 2008/2013) does not require <code>&lt;sys&#47;types.h&gt;</code>.  The code shown doesn&#39;t seem to use anything from <code>&lt;sys&#47;stat.h&gt;</code> either AFAICS, though if you go for the symbolic permissions, that&#39;s where they&#39;re found."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1473262497, "post_id": 39373185, "comment_id": 66076141, "body": "Thanks, @JonathanLeffler. I don&#39;t have POSIX handy, so I relied upon Linux man pages. <code>man lseek</code> lists <code>&lt;sys&#47;types.h&gt;</code>, and <code>man 2 open</code> lists <code>&lt;sys&#47;stat.h&gt;</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1473262701, "post_id": 39373185, "comment_id": 66076285, "body": "The headers fcntl.h and says/stat.h have a complex inter-relation.   The sys/types.h was once important, but it is almost accurate to say &quot;in another millennium&quot;."}], "tags": [], "owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "is_accepted": false, "score": 3, "last_activity_date": 1473261576, "last_edit_date": 1473261576, "creation_date": 1473260002, "answer_id": 39373185, "question_id": 39373063, "link": "https://stackoverflow.com/questions/39373063/accidently-creating-gigantic-file-with-write/39373185#39373185", "title": "Accidently creating gigantic file with write", "body": "<p>You have failed to include the appropriate header files. You should include, at a minimum:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n</code></pre>\n\n<p>Additionally, this will give you access to the symbolic constants required to make your code maintainable.</p>\n\n<p>Here is a working version of your program:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\n\nint main() {\n char swap_array[2];\n int test = creat(\"TEST\",0751);\n close(test);\n test = open(\"TEST\",O_RDWR);\n write(test, \"123456789101112131415\",21);\n lseek(test,-2,SEEK_END);\n read(test,swap_array,2);\n write(test,swap_array,2);\n lseek(test,-6, SEEK_CUR);\n write(test,\"xx\",2);\n return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473260503, "post_id": 39373194, "comment_id": 66074776, "body": "&#39;so the two 2&#39;s are treated...&#39; I doubt: both AMD and MS ABI would use registers to pass first 4 arguments on x64."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473260593, "post_id": 39373194, "comment_id": 66074850, "body": "@Serge maybe it&#39;s i386."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473260652, "post_id": 39373194, "comment_id": 66074890, "body": "Technically the second argument to <code>lseek()</code> is <code>off_t</code>, not <code>int</code> or <code>long</code>."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1473260689, "post_id": 39373194, "comment_id": 66074920, "body": "@FUZxxl still, the original statement misleading."}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1473260763, "post_id": 39373194, "comment_id": 66074973, "body": "That does not excuse the lack of headers, e.t.c., of course"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 3, "last_activity_date": 1473267199, "last_edit_date": 1473267199, "creation_date": 1473260016, "answer_id": 39373194, "question_id": 39373063, "link": "https://stackoverflow.com/questions/39373063/accidently-creating-gigantic-file-with-write/39373194#39373194", "title": "Accidently creating gigantic file with write", "body": "<p>You probably aren't including the headers, so there's probably no prototype for <code>lseek()</code> in scope, so the <code>2</code> in the middle argument is an <code>int</code>, but <code>lseek()</code> expects (<s>a <code>long</code></s>) an <code>off_t</code>, and you're on a 64-bit machine where <code>sizeof(int) != sizeof(long)</code> so the two <code>2</code>'s are misinterpreted by the system call (maybe treating them as the offset and for whatever reason what's left on the stack is interpreted as <code>SEEK_SET</code> or otherwise jumps to a large offset).</p>\n\n<p>Basically, you're probably passing inaccurately typed information to the system call because you haven't included the correct headers.  Classically (before POSIX interfered), the middle <code>2</code> would be <code>2L</code> because the <code>l</code> in <code>lseek()</code> stood for 'long' \u2014 prior to that, there was a <code>seek()</code> which took a plain <code>int</code> (in the days of 16-bit <code>int</code> types) \u2014 to ensure that a <code>long</code> is passed as <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/lseek.html\" rel=\"nofollow\"><code>lseek()</code></a>\nrequires.  These days, <code>lseek()</code> requires an <code>off_t</code>; using the prototype is crucial to ensure that what you write is interpreted correctly as an <code>off_t</code>.</p>\n\n<p>There's a lot of UB lurking in that description, but the fact that you're not using <code>SEEK_SET</code> etc raises warning flags.  Also, why is the file executable?  That doesn't look like executable code you're writing.</p>\n\n<p>This variant of the code is more careful (and doesn't create an 8 GiB file on Mac OS X 10.11.6 with GCC 6.2.0).</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MODE_0751 (S_IRWXU | S_IRGRP | S_IXGRP | S_IXOTH)\n\nint main(void)\n{\n    // All error checking omitted\n    char swap_array[2];\n    int test = creat(\"TEST\", MODE_0751);\n    close(test);\n    test = open(\"TEST\", O_RDWR);\n    write(test, \"123456789101112131415\", 21);\n    lseek(test, -2L, SEEK_END);\n    read(test, swap_array, 2);\n    write(test, swap_array, 2);\n    lseek(test, -6L, SEEK_CUR);\n    write(test, \"xx\", 2);\n    close(test);\n    return 0;\n}\n</code></pre>\n\n<p>I use the <code>L</code>'s out of (very) old habit, but they're optional.  The various 2's could be replaced by <code>sizeof(swap_array)</code> (and <code>sizeof(\"xx\")-1</code>).  I learned C long enough ago that the octal permissions were the only way of doing business; the <code>S_IRWXU</code> and related names were years in the future.  I find a 4-digit or 5-digit octal number more readable than a string of <code>S_Iwxyz</code> names.</p>\n\n<p>Make sure you compile your code with options set so that prototypes are required before you can use functions.  For example, I use:</p>\n\n<pre><code>$ gcc -O3 -g -std=c11 -Wall -Wextra -Werror -Wmissing-prototypes \\\n&gt;     -Wstrict-prototypes -Wold-style-definition mx19.c -o mx19\n$\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5695385, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-sff0LhDONtY/AAAAAAAAAAI/AAAAAAAAAIU/aknPgRSI6DA/photo.jpg?sz=128", "display_name": "Maxwell Powell", "link": "https://stackoverflow.com/users/5695385/maxwell-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1473267199, "creation_date": 1473259677, "last_edit_date": 1473260142, "question_id": 39373063, "link": "https://stackoverflow.com/questions/39373063/accidently-creating-gigantic-file-with-write", "title": "Accidently creating gigantic file with write", "body": "<p>this is the code I am using:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n void main(){\n  test = creat(\"TEST\",0751);\n  close(test);\n  test = open(\"TEST\",2);\n  write(test, \"123456789101112131415\",21);\n  lseek(test,-2,2);\n  read(test,swap_array,2);\n  write(test,swap_array,2);\n  lseek(test,-6, 1);\n  write(test,\"xx\",2);\n }\n</code></pre>\n\n<p>This creates an 8gb file containing instead of inserting \"xx\" in between the numbers as I intend. What is wrong with the code as I have it?</p>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 2295, "user_id": 792779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99528e625676b23a593f5a3daa005793?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/792779/john"}, "edited": false, "score": 0, "creation_date": 1473259254, "post_id": 39372821, "comment_id": 66073773, "body": "What is the problem? You mention what you want it to do, but not what it is doing."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473259341, "post_id": 39372821, "comment_id": 66073846, "body": "Your code makes absolutely no sense whatsoever. You should probably start with a simpler exercise. If you have questions about a <i>minimal</i> example, you have much better odds of getting useful answers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473259503, "post_id": 39372821, "comment_id": 66073976, "body": "Does <code>typedef struct game{     int n;     int field[]; }game;</code> compile without error for you?  What compiler are you using?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473259711, "post_id": 39372821, "comment_id": 66074146, "body": "@chux, <code>int field[]</code> is a flexible array member, valid since C99"}, {"owner": {"reputation": 1, "user_id": 6805067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d112959ef1e9b2c5b0eb3701fd2c8e89?s=128&d=identicon&r=PG&f=1", "display_name": "Schiggy", "link": "https://stackoverflow.com/users/6805067/schiggy"}, "reply_to_user": {"reputation": 2295, "user_id": 792779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99528e625676b23a593f5a3daa005793?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/792779/john"}, "edited": false, "score": 0, "creation_date": 1473259820, "post_id": 39372821, "comment_id": 66074234, "body": "@Trey added my problem"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1473260486, "post_id": 39372821, "comment_id": 66074757, "body": "@Alter Yes a flexible array member.  I was incorrectly thinking about restrictions with VLA."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473260472, "post_id": 39373181, "comment_id": 66074749, "body": "According to the definition of <code>struct game</code>, trying to assign to <code>g.field</code> is incorrect regardless of the argument to <code>malloc()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473260573, "post_id": 39373181, "comment_id": 66074836, "body": "Recommend <code>g.field = malloc(sizeof *(g.field) * a);</code>  Avoid getting the type wrong."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473260782, "post_id": 39373181, "comment_id": 66074984, "body": "@EOF, you are right, I forget the flexible array, edited, thanks!."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473260961, "post_id": 39373181, "comment_id": 66075107, "body": "@chux, as pointed by EOF, you can not use <code>malloc</code> with the flexible array member, you need to reserve space for the whole <code>struct</code> including the size of the flexible array member"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1473262789, "post_id": 39373181, "comment_id": 66076344, "body": "Right you are.  Yet in that case suggest  <code>malloc(sizeof *g +  n * sizeof g.field[0]);</code>"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1473263042, "last_edit_date": 1473263042, "creation_date": 1473259995, "answer_id": 39373181, "question_id": 39372821, "link": "https://stackoverflow.com/questions/39372821/trying-to-understand-the-usage-of-multidimension-dynamic-fields-in-c/39373181#39373181", "title": "Trying to understand the usage of multidimension dynamic fields in C", "body": "<pre><code>struct g = NULL;//this is my problem\nint g.field = NULL;//this too\n</code></pre>\n\n<p>You are right, this is your problem</p>\n\n<p>1) You mean <code>game g</code> instead of <code>struct g</code></p>\n\n<p>2) You can not use <code>NULL</code> without a pointer:</p>\n\n<pre><code>game *g = NULL; /* Ok */\n</code></pre>\n\n<p>3) You can not access a member (<code>g.field</code>) of an uninitialized <code>struct</code> (<code>g</code>)</p>\n\n<p>More problems:</p>\n\n<pre><code>g.field = malloc(a * sizeof(int*));\n</code></pre>\n\n<p>You can not use <code>malloc</code> with the flexible array member, you need to reserve space for the whole <code>struct</code> including the size of the flexible array member:</p>\n\n<pre><code>game *g = malloc(sizeof(*g) + (n * sizeof(int)));\n</code></pre>\n\n<p>or better yet</p>\n\n<pre><code>game *g = malloc(sizeof(*g) + (n * sizeof(g-&gt;field[0])));\n</code></pre>\n\n<p>Note <code>sizeof(int)</code> instead of <code>sizeof(int *)</code>, you want to reserve space for <code>n</code> <code>int</code>s not for n pointers to <code>int</code>s</p>\n\n<p>or change <code>field</code> to </p>\n\n<pre><code>typedef struct game {\n    int n;\n    int *field;\n} game;\n</code></pre>\n\n<p>in order to use <code>malloc</code> with the member directly.</p>\n"}], "owner": {"reputation": 1, "user_id": 6805067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d112959ef1e9b2c5b0eb3701fd2c8e89?s=128&d=identicon&r=PG&f=1", "display_name": "Schiggy", "link": "https://stackoverflow.com/users/6805067/schiggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473263042, "creation_date": 1473258990, "last_edit_date": 1473260246, "question_id": 39372821, "link": "https://stackoverflow.com/questions/39372821/trying-to-understand-the-usage-of-multidimension-dynamic-fields-in-c", "title": "Trying to understand the usage of multidimension dynamic fields in C", "body": "<p>I'm trying to learn C at the moment and have encountered a task I cannot solve on my own. This is a simple minesweeper implementation.</p>\n\n<p>Short description what the program should do:\nIt gets the input files via the command line, opens them one at the time, creates the minesweeper field for each and if multiple files are opened the program saves them formatted in one file. I don't want to format them one beneath the other, I want to use a dynamic two dimensional array, so that the matrix expands without losing the already saved mines. </p>\n\n<p>Each input file has the same build:</p>\n\n<pre><code>3\\t5\\n\n0\\t3\\n\n3\\t7\\n\n...\n</code></pre>\n\n<p>The first line always indicates the size of the n x m matrix and all following lines are the coordinates of the mines.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct game{\n    int n;\n    int field[];\n}game;\n\n\nint read_files(char **input, int length);\nint make_field(char *input, int i, int *ptr);\nvoid increment(int i, int j, game);\nint is_inside_bounds(int i, int j, game);\nvoid free_field();\nvoid safe_field();\n\n\nint main(int argc, char **argv){\n\n    read_files(argv, argc);\n    return 0;\n} \n\n\n\n//read_files reads all files given to the programm via the commandline\n\nint read_files(char **input, int length){\n    int i= 1; \n    char string[20];              //input goes into this via fgets\n    int filecount = 0;            //counts the amount of files\n    int fieldptr[100];           // is an int array with the purpose of memorizing the size of all gamefields I create\n    int j = 0;\n\n    for (; i&lt; length-1; i++){\n        FILE *in;\n        if(!(in = fopen(input[i], \"r\"))){\n            fprintf(stderr, \"File not found.\\n\"); \n            err = 2;\n            return err;\n        }\n        while (fgets(string,20,in)){ \n\n            make_field(string, filecount, fieldptr); //gives all relevan info to the make_field function\n            j++;\n        }\n        fclose(in);\n        filecount++;\n    }\n    return 0;\n}\n\n\n\nint make_field(char *string, int file, int *fieldptr){\n    struct g = NULL;//this is my problem\n    int g.field = NULL;//this too\n    char delimiter[] = \"\\t\\n\";     //the input file cuts the chars with \\n and \\t\n    char *ptr;                     //needed for strtok\n    file= file * 2;               //this is used for the filehandling\n    ptr = strtok(string, delimiter);\n    int a = atoi(ptr);           //cast to int so I have the gamefield size as a int\n    ptr = strtok(NULL, delimiter);\n    int b = atoi(ptr);       //cast to int so I have the gamefield size as a int\n\n\n    if (fieldptr[file] == 0 &amp;&amp; file == 0){//init field\n        fieldptr[0] = a; //memorize first call\n        fieldptr [1] = b;\n        g.field = malloc(a * sizeof(int*));\n        if (NULL == field){\n            fprintf(stderr, \"Memory error.\\n\");\n            return 3;\n        }\n        for(int j = 0; j &lt; a; j++){\n            g.field[j] = malloc(b * sizeof(int));\n            if(NULL==g.field[j]){ allocated\n                fprintf(stderr, \"Memory error.\\n\");\n                return 3;\n            }\n        }\n    }else if (fieldptr[file] == 0 &amp;&amp; file != 0){ //if it is the first line and but not the first file\n        field = realloc(g.field, a * sizeof(int*));\n        if (NULL == field){\n            fprintf(stderr, \"Memory error.\\n\");\n            return 3;\n        }\n        for(int j = 0; j &lt; a; j++){\n            field[j] = realloc(field[j], b * sizeof(int));\n            if(NULL==g.field[j])\n                fprintf(stderr, \"Memory error.\\n\");\n                return 3;\n            }\n        }\n        fieldptr[file] = a;      //filehandling memory\n        fieldptr[file+1] = b;\n\n    }else if(fieldptr[file] != 0 &amp;&amp; file == 0){    //fill the mines +indicators into the array\n        g.field[a][b] = -1;\n        int m;\n        for (m = -1; m &lt;= 1; m++) {\n            int n;\n            for (n = -1; n &lt;= 1; n++) {\n                increment(a + m, (fieldptr[file+b]) + n, g);\n            }\n        }\n\n    }else if (fieldptr[file] != 0 &amp;&amp; file != 0){     //fill the mines +indicators into the bigger array\n        g.field[a][fieldptr[file+b]] = -1;\n\n        int m;\n        for (m = -1; m &lt;= 1; m++) {\n            int n;\n            for (n = -1; n &lt;= 1; n++) {\n                increment(a + m, (fieldptr[file+b]) + n, g);\n            }\n        }\n    }\n    return field; //not sure about the return yet\n}\n\n\n\nvoid increment(int i, int j, game *g) {       //increments the neighbours of the minefield\n    if (is_inside_bounds(i, j, g) &amp;&amp; field[i][j] != -1) {\n        ++g.field[i][j];\n    }\n}\n\nint is_inside_bounds(int i, int j, game *g) {         //checks if the access of increment is inside the array\n    int nLines = sizeof(g.field) / sizeof(g.field[0][0]);\n    int nColumns = sizeof(g.field[0]) / sizeof(field[0][0]);\n    return i &gt;= 0 &amp;&amp; i &lt; nLines &amp;&amp; j &gt;=0 &amp;&amp; j &lt; nColumns;\n}\n</code></pre>\n\n<p>Coming from java, in my eyes this should work, but I really don't get how C works with multidim arrays. Can anybody point me into the right direction?</p>\n\n<p>EDIT:</p>\n\n<p>gcc has following output:</p>\n\n<pre><code>error: invalid use of flexible array member\n   g.field = realloc(g.field, a * sizeof(int*));\n\nIn function \u2018increment\u2019:\nnote: the ABI of passing struct with a flexible array member has changed in GCC 4.4\n void increment(int i, int j, game g) {\n</code></pre>\n\n<p>So my problem is that I don't really know how to declare and use the array the right way.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 2, "creation_date": 1473257102, "post_id": 39372041, "comment_id": 66072064, "body": "<i>when the value of px</i> &lt;= It&#39;s not the value of <code>px</code>, it&#39;s the value of the <code>int</code> <code>px</code> points to."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473257147, "post_id": 39372041, "comment_id": 66072100, "body": "It is completely unclear what you are asking. You cannot just pass values and expect they change the originals. Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>!"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1473257872, "post_id": 39372041, "comment_id": 66072618, "body": "If you are asking how the second version could work being temp an int, and not a pointer like the two parameters, it&#39;s because it swaps the values pointed to by them, not the pointers themselves."}, {"owner": {"reputation": 13, "user_id": 2528404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b7eced82aa7cc2712c642896540a4b?s=128&d=identicon&r=PG", "display_name": "Kwaku", "link": "https://stackoverflow.com/users/2528404/kwaku"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473260263, "post_id": 39372041, "comment_id": 66074606, "body": "@Olaf the first function give wrong answers because there is pointer pointing to an address so the results are not what is expected but in the second version there is also no pointer pointing to the (int temp) so why is giving the expected value and not changing the value that was put into it?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1473264187, "post_id": 39372041, "comment_id": 66077229, "body": "@Themind - do you consider your question answered by one of the two answers? If so, please accept the relevant answer."}, {"owner": {"reputation": 13, "user_id": 2528404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b7eced82aa7cc2712c642896540a4b?s=128&d=identicon&r=PG", "display_name": "Kwaku", "link": "https://stackoverflow.com/users/2528404/kwaku"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1473265690, "post_id": 39372041, "comment_id": 66078095, "body": "@4386427 no please i understand all they are saying but my question is but why that?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473267338, "post_id": 39372041, "comment_id": 66078943, "body": "@Themind: The first version does not even have a pointer, so what are you talking about? No offence, but your last comment is also unclear. I&#39;d strongly recommend to read a good C book; I have the impression that quite some of the basics about functions and pointers are either missing or there is a massive missconception. Anyway, when reading the chapters <b>in order</b> this should become clear."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1473268161, "post_id": 39372041, "comment_id": 66079352, "body": "@Themind - I tried to explain it using some other words."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1473258143, "last_edit_date": 1473258143, "creation_date": 1473257550, "answer_id": 39372256, "question_id": 39372041, "link": "https://stackoverflow.com/questions/39372041/swap-using-pointers/39372256#39372256", "title": "Swap using Pointers", "body": "<p>In this function</p>\n\n<pre><code>void swap(int *px, int *py)\n{\n    int temp;\n    temp = *px;\n    *px = *py;\n    *py = temp;\n}\n</code></pre>\n\n<p>there are swapped values pointed to by <code>px</code> and <code>py</code>. The function does not swap the pointers themselves.</p>\n\n<p>To swap the values pointed to by the pointers you need an intermediate memory where temporary to store the value pointed to by <code>px</code> that will be overwritten by the value pointed to by <code>py</code>.</p>\n\n<p>Thus the function uses local variable <code>temp</code> that temporary stores the value <code>*px</code>.</p>\n\n<p>Pay attention to that in this assignment statement</p>\n\n<pre><code>temp = *px;\n</code></pre>\n\n<p>the variable <code>temp</code> stores the value pointed to by <code>px</code> that is <code>*px</code> that has type <code>int</code>. It is not the pointer <code>px</code> itself that is assigned to <code>temp</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1473259261, "last_edit_date": 1473259261, "creation_date": 1473257661, "answer_id": 39372292, "question_id": 39372041, "link": "https://stackoverflow.com/questions/39372041/swap-using-pointers/39372292#39372292", "title": "Swap using Pointers", "body": "<p>Both functions swap the <code>int</code> values.  But does that swap affect the calling code's <code>int</code>s?</p>\n\n<p>With the second <code>swap()</code>, the effect of the swap is seen in the original <code>a,b</code> as that function works with the addresses of the <em>original</em> <code>a,b</code>.</p>\n\n<pre><code>int a = 1;\nint b = 2;\nswap_version2(&amp;a, &amp;b);\nprintf(\"%d %d\\n\", a, b);  // prints 2 1\n</code></pre>\n\n<p>With the first <code>swap()</code>, the effect of the swapped is <em>not</em> seen in the original <code>c,d</code>. as the <code>swap()</code> function was swapping copies of <code>c,d</code>.  Net effect: the first swap function simply wastes time.  It does not swap <code>c,d</code>.</p>\n\n<pre><code>int c = 3;\nint d = 4;\nswap_version1(c, d);\nprintf(\"%d %d\\n\", c, d);  // prints 3 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1473268128, "last_edit_date": 1473268128, "creation_date": 1473266831, "answer_id": 39375399, "question_id": 39372041, "link": "https://stackoverflow.com/questions/39372041/swap-using-pointers/39375399#39375399", "title": "Swap using Pointers", "body": "<p>There are two important things you need to know.</p>\n\n<p>1) When calling a function in C, the arguments are always passed by value. If you make changes <strong>inside the functions</strong> to the variables holding the passed value, the changes will be lost the moment the function returns. In other words - any change made inside the function can't be seen outside the function.</p>\n\n<p>2) When working with pointer the <code>*</code> operator in front of the pointer means <code>the location pointed to by the pointer</code>. It is called dereferencing the pointer. So if you do <code>*px = 5;</code> you do <strong>not</strong> change any pointer value! You change the value at the location pointed to by the pointer. </p>\n\n<p>A closer look at your code:</p>\n\n<p>In your first example you have something like:</p>\n\n<pre><code>void swap(int px, int py)\n{\n    int temp;\n    temp = px;\n    px = py;\n    py = temp;\n}\n\nint main(void)\n{\n    int x = 10;\n    int y = 100;\n    swap(x, y);\n    printf(\"%d %d\\n\", x, y);\n    return 0;\n }\n</code></pre>\n\n<p>In C everything is passed by value. So when you call <code>swap</code> it is the values <code>10</code> and <code>100</code> which is passed to the function. It is <strong>not</strong> the variables <code>x</code> and <code>y</code>. In other words - <code>px</code> and <code>py</code> in the function has nothing to do with the variable <code>x</code> and <code>y</code> in <code>main</code>. This means that any change made to the variables <code>px</code> and <code>py</code> is lost when the function returns and <code>x</code> and <code>y</code> does <strong>not</strong> change.</p>\n\n<p>Your second example is like this:</p>\n\n<pre><code>void swap(int px, int py)\n{\n    int temp;\n    temp = *px;\n    *px = *py;\n    *py = temp;\n}\n\nint main(void)\n{\n    int x = 10;\n    int y = 100;\n    swap(&amp;x, &amp;y);  // Notice the &amp; operator\n    printf(\"%d %d\\n\", x, y);\n    return 0;\n }\n</code></pre>\n\n<p>As always we have pass by value. But in this case the values that you pass is the values of two <code>pointer to int</code>. More specific you pass the address of <code>x</code> and <code>y</code>. </p>\n\n<p>Like before you can't change the <strong>value</strong> that is passed to the function (just like the first example) but you <strong>can</strong> change the value of whatever the pointer is pointing to.</p>\n\n<p>Here you need to know that <code>*</code> in front of the pointer access whatever the pointer is pointing to. </p>\n\n<p>So doing <code>temp = *px</code> will read the value pointed to by <code>px</code>. In this case it is <code>10</code> so <code>temp</code> gets the value <code>10</code>. </p>\n\n<p>Doing <code>*px = *py</code> reads the value <code>py</code> points to (i.e. 100) and place it where <code>px</code> points (i.e. <code>x</code> in <code>main</code> is now <code>100</code>).</p>\n\n<p>Doing <code>*py = temp</code> reads the value <code>temp</code> holds (i.e. 10) and place it where <code>py</code> points (i.e. <code>y</code> in <code>main</code> is now <code>10</code>).</p>\n\n<p>So when the function returns, the value of <code>x</code> and <code>y</code> has been swapped.</p>\n\n<p>Notice that the code never uses a pointer to (aka the address of) <code>temp</code>. The variable <code>temp</code> is just used as an ordinary <code>int</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 2528404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b7eced82aa7cc2712c642896540a4b?s=128&d=identicon&r=PG", "display_name": "Kwaku", "link": "https://stackoverflow.com/users/2528404/kwaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 0, "closed_date": 1473435643, "answer_count": 3, "score": -3, "last_activity_date": 1473268128, "creation_date": 1473256962, "last_edit_date": 1473261156, "question_id": 39372041, "link": "https://stackoverflow.com/questions/39372041/swap-using-pointers", "closed_reason": "Needs details or clarity", "title": "Swap using Pointers", "body": "<p>In the code below in order to swap between <code>px</code> and <code>py</code> you need a pointer to point to the address of <code>py</code> and <code>px</code> to swap them effectively.  </p>\n\n<p>My question is with the <code>int temp</code> when the value of <code>px</code> is put into it how does it give the correct value back because there is no pointer pointing to it to be able to give the right value and how is the address of <code>int temp</code> not clone to give a wrong value?</p>\n\n<pre><code>void swap(int px, int py)\n{\n    int temp;\n    temp = px;\n    px = py;\n    py = temp;\n}\n\n//pointer version\n\nvoid swap(int *px, int *py)\n{\n    int temp;\n    temp = *px;\n    *px = *py;\n    *py = temp;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "kernel", "client", "i2c"], "comments": [{"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 1, "creation_date": 1473252982, "post_id": 39370398, "comment_id": 66069058, "body": "I think your confusing &quot;driver&quot; and &quot;device&quot;. You register 1 driver (per device type), which will handle multiple devices, depending on their I2C slave addresses. Of course the driver has to be written to support &gt;1 device, but any decent driver should."}, {"owner": {"reputation": 241, "user_id": 4058889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Y5kH-VbJDf8/AAAAAAAAAAI/AAAAAAAAAfE/Y9vZARB1UAw/photo.jpg?sz=128", "display_name": "Mert Can Erg&#252;n", "link": "https://stackoverflow.com/users/4058889/mert-can-erg%c3%bcn"}, "reply_to_user": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 0, "creation_date": 1473253177, "post_id": 39370398, "comment_id": 66069213, "body": "@domen yeah i can understand that but registers are hard-coded into device trees. so instantiating one only allows me to read/write from/to one slave."}, {"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 1, "creation_date": 1473255640, "post_id": 39370398, "comment_id": 66070945, "body": "I don&#39;t think you do. You only need one driver with one probe function. Device driver system will then call that probe for each of matching DT definitions. I don&#39;t have a good reference handy, sorry, have you checked ldd3? <a href=\"https://www.kernel.org/doc/Documentation/driver-model/platform.txt\" rel=\"nofollow noreferrer\">kernel.org/doc/Documentation/driver-model/platform.txt</a> also contains some info."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1473261803, "post_id": 39370398, "comment_id": 66075669, "body": "You can have one I2C device as &quot;primary&quot; in the device tree to instantiate the driver, then put the info of second device (i2c bus, slave address, pins) as a sub-node in the primary device&#39;s node and read those info in the primary device probe function. Basically you add secondary device&#39;s i2c information as additional information to the primary device&#39;s device tree node."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1473262569, "post_id": 39370398, "comment_id": 66076192, "body": "I guess you are trying to make a dual camera setup for imx6. Usually just like you just have 2 hardware devices and two driver instances and they export two v4l2 devices to user space, just like you connect two USB webcams to a computer. But the way imx6 v4l2 &quot;capture&quot; driver allocates driver data statically makes it impossible to be instantiated twice. So IMO you are on the wrong track trying to manage two camera in one driver instance, rather you should fix the driver to be able to be instantiated twice and let each camera have its own driver instances Let user space decide how to use them."}, {"owner": {"reputation": 241, "user_id": 4058889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Y5kH-VbJDf8/AAAAAAAAAAI/AAAAAAAAAfE/Y9vZARB1UAw/photo.jpg?sz=128", "display_name": "Mert Can Erg&#252;n", "link": "https://stackoverflow.com/users/4058889/mert-can-erg%c3%bcn"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1473262791, "post_id": 39370398, "comment_id": 66076345, "body": "@user3528438 I am interfacing with a camera that supplies <b>1</b> output data but requires separate messages to 2 separate i2c slaves residing in the system. By the way I am afraid I didn&#39;t understand your comment about primary and sub nodes"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1473262904, "post_id": 39370398, "comment_id": 66076423, "body": "@MertCanErg&#252;n Then I think you are OK."}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 4058889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Y5kH-VbJDf8/AAAAAAAAAAI/AAAAAAAAAfE/Y9vZARB1UAw/photo.jpg?sz=128", "display_name": "Mert Can Erg&#252;n", "link": "https://stackoverflow.com/users/4058889/mert-can-erg%c3%bcn"}, "is_accepted": false, "score": 2, "last_activity_date": 1473426838, "creation_date": 1473426838, "answer_id": 39412425, "question_id": 39370398, "link": "https://stackoverflow.com/questions/39370398/how-to-write-multiple-slave-i2c-client-device-driver/39412425#39412425", "title": "How to write multiple slave i2c client device driver?", "body": "<p>This is a workaround I am using right now, I will not accept this one as answer as this method doesn't feel right.</p>\n\n<pre><code>struct i2c_client *foo_i2c_client;\n\nstatic int foo_probe(struct i2c_client *client,\n                          const struct i2c_device_id *device_id)\n{\n    foo_i2c_client = client;\n    // implementation\n}\n\nstatic int foo_remove(struct i2c_client *client)\n{\n    // implementation\n}\n\nstatic const struct i2c_device_id foo_id[] = {\n    {\"foo0\", 0},\n    {},\n};\n\nstatic struct i2c_driver foo0_i2c_driver = {\n    .driver = {\n        .owner = THIS_MODULE,\n        .name = \"foo0\",\n    },\n    .probe = foo0_probe,\n    .remove = foo0_remove,\n    .id_table = foo_id,\n};\n\nstatic int send_cmd(u8 slv_addr, u8 *buffer, u16 size)\n{\n    foo_i2c_client-&gt;address = slv_addr;\n    i2c_master_send(foo_i2c_client, buffer, size);\n    // rest of implementation\n} \n\nMODULE_DEVICE_TABLE(i2c, foo_id);\n\nmodule_i2c_driver(foo0_i2c_driver);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 241, "user_id": 4058889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Y5kH-VbJDf8/AAAAAAAAAAI/AAAAAAAAAfE/Y9vZARB1UAw/photo.jpg?sz=128", "display_name": "Mert Can Erg&#252;n", "link": "https://stackoverflow.com/users/4058889/mert-can-erg%c3%bcn"}, "edited": false, "score": 0, "creation_date": 1487152393, "post_id": 42235875, "comment_id": 71650035, "body": "that looks far more elegant than my workaround which registers one device but changes device when needed which can be confusing"}], "tags": [], "owner": {"reputation": 476, "user_id": 1781025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/adb8b1e62d53d4a1e0c264e8f57a742e?s=128&d=identicon&r=PG", "display_name": "Splaty", "link": "https://stackoverflow.com/users/1781025/splaty"}, "is_accepted": true, "score": 6, "last_activity_date": 1487106260, "last_edit_date": 1487106260, "creation_date": 1487105167, "answer_id": 42235875, "question_id": 39370398, "link": "https://stackoverflow.com/questions/39370398/how-to-write-multiple-slave-i2c-client-device-driver/42235875#42235875", "title": "How to write multiple slave i2c client device driver?", "body": "<p>This answer is late by 5 months but hopefully it will help someone else who had the same issue (as I did) and could not find a suitable answer.</p>\n\n<p><strong>In short</strong> the solution is to use a minor number to represent each slave. Your driver will look up that minor number in your stored list of clients to obtain the proper i2c_client.</p>\n\n<p><strong>Long version</strong>\nYour I2C driver will eventually probably be a character device driver for such an unique device. Otherwise a framework (such as hwmon) may already be implemented and handling multiple slaves is already done by the framework so you need not worry about it. See <a href=\"http://lxr.free-electrons.com/source/drivers/hwmon/\" rel=\"noreferrer\">http://lxr.free-electrons.com/source/drivers/hwmon/</a> for examples.</p>\n\n<p>Now assuming it is a character device driver, in your driver __init you need to allocate as many minor numbers as slave devices:</p>\n\n<pre><code>alloc_chrdev_region(&amp;dev, *MINOR_START*, *NUM_DEVICES*, name)    \n/* for each minor or slave device, do cdev_init and cdev_add */\n</code></pre>\n\n<p>Now onto your <code>MODULE_DEVICE_TABLE</code>. Enter the entries for each slave remembering that the string must match the device tree compatible entry. The 2nd field is a number, we will use it as both an unique identifier and a minor number (this is the trick):</p>\n\n<pre><code>struct i2c_device_id foo_idtable[] = {\n    { \"foo_1\", 0 },\n    { \"foo_2\", 1 },\n    { },\n};\nMODULE_DEVICE_TABLE(i2c, foo_idtable);\n</code></pre>\n\n<p>Ok with that in place, your <code>.probe</code> function will be called for each matching device-tree entry. When the <code>.probe</code> function is called, Linux passes in the i2c_client pointer it has instantiated for you. Here's the other part of the trick, have a global table that stores these individual i2c_client pointers. The index of the global table is the minor number. The minor number is the <code>id-&gt;driver_data</code> that is also passed in, which was the number you assigned in the <code>foo_idtable</code> before.</p>\n\n<pre><code>static int foo_probe(struct i2c_client *client, const struct i2c_device_id *id)\n{\n    /* Store the i2c_client pointer in a global table using minor number as index \n     * make sure to allocate the global table dynamically */\n    that_table[id-&gt;driver_data] = client;\n    /* The id-&gt;driver_data is the minor number! */\n}\n</code></pre>\n\n<p>Hopefully you are catching on now.\nWhen you insmod your .ko, you want to make multiple nodes, one for each minor number:</p>\n\n<pre><code>insmod foo.ko\nmake_dir /dev/foo\nfind_major foo\nmake_node /dev/foo/foo_0 c &lt;major&gt; 0\nmake_node /dev/foo/foo_1 c &lt;major&gt; 1\n</code></pre>\n\n<p>Now when your userspace code tries to use your driver, it will open the file that corresponds to the correct minor number (slave device). In userspace you would do something like:</p>\n\n<pre><code>/* Accessing slave #0 */\nint fd = open(\"/dev/foo/foo_0\", O_RDWR);\n\n/* Accessing slave #1 */\nint fd_1 = open(\"/dev/foo/foo_1\", O_RDWR);\n</code></pre>\n\n<p>Your .open implementation will get called.</p>\n\n<pre><code>static int foo_driver_open(struct inode *inode, struct file *filep)\n{\n    int minor_num = MINOR(inode-&gt;i_rdev);\n    /* remember the global table we had before that was indexed using the minor number?\n     * Let's get the i2c_client stored there and get filep-&gt;private_data\n     * to point to that i2c_client. Then subsequent read/write/ioctl can just\n     * obtain the i2c_client from filep-&gt;private_data */\n    filep-&gt;private_data = that_table[minor_num];\n}\n</code></pre>\n\n<p>Then for example your userspace code makes a call to the driver's ioctl:</p>\n\n<pre><code>ioctl(fd, FOO_IOCTL_DO_READ, &amp;msg);\nioctl(fd_1, FOO_IOCTL_DO_WRITE, &amp;msg);\n</code></pre>\n\n<p>In your driver's ioctl implementation:</p>\n\n<pre><code>long foo_driver_ioctl(struct file *filep, unsinged int cmd, unsigned long arg)\n{\n    /* the filep-&gt;private_data has the i2c_client pointer! yay! */\n    struct i2c_client *client = filep-&gt;private_data;\n\n    /* now you can talk to your slave device with the i2c_client knowing\n     * it is the correct i2c_client */\n}\n</code></pre>\n\n<p>That's it :). \nI hope that makes sense. It's a long explanation but I hope I was thorough but not too confusing. The biggest problem is that we have a global table that stores the i2c_cient pointers, but I can't think of a way not to have it since <code>.probe</code> and <code>.open</code> have no way to pass parameters between each other. If anyone has a better solution let me know.</p>\n"}], "owner": {"reputation": 241, "user_id": 4058889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Y5kH-VbJDf8/AAAAAAAAAAI/AAAAAAAAAfE/Y9vZARB1UAw/photo.jpg?sz=128", "display_name": "Mert Can Erg&#252;n", "link": "https://stackoverflow.com/users/4058889/mert-can-erg%c3%bcn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5151, "favorite_count": 1, "accepted_answer_id": 42235875, "answer_count": 2, "score": 11, "last_activity_date": 1487106260, "creation_date": 1473252546, "last_edit_date": 1473259388, "question_id": 39370398, "link": "https://stackoverflow.com/questions/39370398/how-to-write-multiple-slave-i2c-client-device-driver", "title": "How to write multiple slave i2c client device driver?", "body": "<p>I am trying to develop a driver for an embedded board. The driver is supposed to open up an interface for <strong>v4l2</strong> and communicate with 2 devices using <strong>i2c</strong>. the driver will act as a master.</p>\n\n<p>I can't seem to understand how <code>i2c_device_id</code> array and <code>i2c_add_driver</code> functions work. I read documentation in kernel source but it won't help me on multiple slave clients.</p>\n\n<ul>\n<li>Do I have to have two seperate probe functions? </li>\n<li>Do i have to call <code>i2c_add_driver</code> two times? </li>\n<li>If not how am I going to be able to save two different clients to be able to send different bytes to different addresses.</li>\n</ul>\n\n<p>I am pasting my code here. I tried to instantiate two <code>i2c_drivers</code>, called <code>i2c_driver_add</code> two times and implemented i2c probe seperately. The code doesn't work telling me that <code>foo1</code>  is already registered when it calls <code>i2c_add_driver</code> for the second time.</p>\n\n<p>I defined two blocks under <code>i2c1</code> in my dts file like:</p>\n\n<pre><code>&amp;i2c1 {\n\n...\n    foo0: foo0@00 {\n        compatible = \"bar,foo0\";\n        reg = &lt;0x00&gt;;\n        pinctrl-names = \"default\";\n        pinctrl-0 = &lt;&amp;pinctrl_ipu1_2&gt;;\n        clocks = &lt;&amp;clks IMX6QDL_CLK_CKO&gt;;\n        clock-names = \"csi_mclk\";\n        DOVDD-supply = &lt;&amp;vgen4_reg&gt;; /* 1.8v */\n        AVDD-supply = &lt;&amp;vgen3_reg&gt;;  /* 2.8v, on rev C board is VGEN3,\n                        on rev B board is VGEN5 */\n        DVDD-supply = &lt;&amp;vgen2_reg&gt;;  /* 1.5v*/\n        pwn-gpios = &lt;&amp;gpio1 16 1&gt;;   /* active low: SD1_DAT0 */\n        rst-gpios = &lt;&amp;gpio1 17 0&gt;;   /* active high: SD1_DAT1 */\n        csi_id = &lt;0&gt;;\n        mclk = &lt;24000000&gt;;\n        mclk_source = &lt;0&gt;;\n    };\n\n    foo1: foo1@02 {\n        compatible = \"bar, foo1\";\n        reg = &lt;0x02&gt;;\n        pinctrl-names = \"default\";\n        pinctrl-0 = &lt;&amp;pinctrl_ipu1_2&gt;;\n        clocks = &lt;&amp;clks IMX6QDL_CLK_CKO&gt;;\n        clock-names = \"csi_mclk\";\n        DOVDD-supply = &lt;&amp;vgen4_reg&gt;; /* 1.8v */\n        AVDD-supply = &lt;&amp;vgen3_reg&gt;;  /* 2.8v, on rev C board is VGEN3,\n                        on rev B board is VGEN5 */\n        DVDD-supply = &lt;&amp;vgen2_reg&gt;;  /* 1.5v*/\n        pwn-gpios = &lt;&amp;gpio1 16 1&gt;;   /* active low: SD1_DAT0 */\n        rst-gpios = &lt;&amp;gpio1 17 0&gt;;   /* active high: SD1_DAT1 */\n        csi_id = &lt;0&gt;;\n        mclk = &lt;24000000&gt;;\n        mclk_source = &lt;0&gt;;\n    };\n\n...\n</code></pre>\n\n<p>Two blocks are exactly the same except their names.</p>\n\n<p>In the driver file I instantiated following structs:</p>\n\n<pre><code>static const struct i2c_device_id foo_id[] = {\n    {\"foo0\", 0},\n    {\"foo1\", 1},\n    {},\n};\n\nstatic struct i2c_driver foo0_i2c_driver = {\n    .driver = {\n        .owner = THIS_MODULE,\n        .name = \"foo0\",\n    },\n    .probe = foo0_probe,\n    .remove = foo0_remove,\n    .id_table = foo_id,\n};\n\nstatic struct i2c_driver foo1_i2c_driver = {\n    .driver = {\n        .owner = THIS_MODULE,\n        .name = \"foo1\",\n    },\n    .probe = foo1_probe,\n    .remove = foo1_remove,\n    .id_table = foo_id,\n};\n</code></pre>\n\n<p>Below are my <code>init</code> and <code>exit</code> functions:</p>\n\n<pre><code>MODULE_DEVICE_TABLE(i2c, foo_id);\n\nstatic __init int foo_init(void)\n{\n    u8 err;\n\n    err = i2c_add_driver(&amp;foo0_i2c_driver);\n    if (err != 0)\n        pr_err(\"%s:driver registration failed i2c-slave0, error=%d\\n\",\n            __func__, err);\n\n    err = i2c_add_driver(&amp;foo1_i2c_driver);\n    if (err != 0)\n        pr_err(\"%s:driver registration failed i2c-slave1, error=%d\\n\",\n            __func__, err);\n\n    return err;\n}\nstatic void __exit foo_clean(void)\n{\n    if((&amp;foo0_i2c_driver) != NULL &amp;&amp; i2c0initialized)\n    {\n        i2c_del_driver(&amp;foo0_i2c_driver);\n        i2c0initialized = 0;\n    }\n    if((&amp;foo1_i2c_driver) != NULL &amp;&amp; i2c1initialized)\n    {\n        i2c_del_driver(&amp;foo1_i2c_driver);\n        i2c1initialized = 0;\n    }\n}\n\nmodule_init(foo_init);\nmodule_exit(foo_clean);\n</code></pre>\n\n<p>Below is my <code>probe</code> function. I have two copies for it for both slaves.</p>\n\n<pre><code>static int foo_probe(struct i2c_client *client,\n                          const struct i2c_device_id *device_id)\n{\n    struct pinctrl *pinctrls;\n    struct device *dev = &amp;client-&gt;dev;\n\n    int ret = 0;\n\n    pinctrls = devm_pinctrl_get_select_default(dev);\n    if(IS_ERR(pinctrls))\n    {\n        dev_err(dev, \"pinctrl setup failed\\n\");\n        return PTR_ERR(pinctrls);\n    }\n\n    memset(&amp;foo_data, 0, sizeof(foo_data));\n    foo_data.sensor_clk = devm_clk_get(dev, \"csi_mclk\");\n    if(IS_ERR(foo_data.sensor_clk))\n    {\n        dev_err(dev, \"get mclk failed\\n\");\n        return PTR_ERR(foo_data.sensor_clk);\n    }\n\n    ret = of_property_read_u32(dev-&gt;of_node, \"mclk\", &amp;(foo_data.mclk));\n    if(ret &lt; 0)\n    {\n        dev_err(dev, \"mclk frequency is invalid\\n\");\n        return ret;\n    }\n\n    ret = of_property_read_u32(dev-&gt;of_node, \"mclk_source\",\n                               (u32 *)&amp;(foo_data.mclk_source));\n    if(ret &lt; 0)\n    {\n        dev_err(dev, \"mclk source is invalid\\n\");\n        return ret;\n    }\n\n    ret = of_property_read_u32(dev-&gt;of_node, \"csi_id\", &amp;(foo_data.csi));\n    if(ret &lt; 0)\n    {\n        dev_err(dev, \"csi_id invalid\\n\");\n        return ret;\n    }\n\n    clk_prepare_enable(foo_data.sensor_clk);\n    i2c_client0 = client;\n\n    /* custom data structures are set here */   \n\n    foo_reset();\n\n    ret = foo_get_id();\n\n    if(ret &lt; 0 /* || ret != foo_ID */)\n    {\n        clk_disable_unprepare(foo_data.sensor_clk);\n        pr_warning(\"foo is not found\\n\");\n        return -ENODEV;\n    }\n\n    clk_disable_unprepare(foo_data.sensor_clk);\n    foo_int_device.priv = &amp;foo_data;\n    ret = v4l2_int_device_register(&amp;foo_int_device);\n\n    pr_info(\"foo is found\\n\");\n    i2c0initialized = 1;\n    return ret;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 4, "creation_date": 1473252326, "post_id": 39370316, "comment_id": 66068534, "body": "use <code>%lf</code> (not <code>%1f</code>) with <code>double</code>s in <code>scanf</code>"}, {"owner": {"reputation": 126, "user_id": 6288232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/31b4af300de80f5948bc08638711e260?s=128&d=identicon&r=PG&f=1", "display_name": "Youssef Sakuragi", "link": "https://stackoverflow.com/users/6288232/youssef-sakuragi"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1473252594, "post_id": 39370316, "comment_id": 66068718, "body": "@AlterMann, thanks!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473255010, "post_id": 39370316, "comment_id": 66070526, "body": "Are you trying to use <code>,</code> and <code>.</code> as the decimal separator with <code>d = 5,125 and m = 1.256</code>.  I have never come across a system that allows both."}], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 6288232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/31b4af300de80f5948bc08638711e260?s=128&d=identicon&r=PG&f=1", "display_name": "Youssef Sakuragi", "link": "https://stackoverflow.com/users/6288232/youssef-sakuragi"}, "edited": false, "score": 0, "creation_date": 1473252677, "post_id": 39370385, "comment_id": 66068780, "body": "Thanks for the tip, but i also want to try it with scanf, The problem is I typed 2 scanf but it reads only one double. Why is that?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 126, "user_id": 6288232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/31b4af300de80f5948bc08638711e260?s=128&d=identicon&r=PG&f=1", "display_name": "Youssef Sakuragi", "link": "https://stackoverflow.com/users/6288232/youssef-sakuragi"}, "edited": false, "score": 0, "creation_date": 1473252824, "post_id": 39370385, "comment_id": 66068927, "body": "Probably the peculiar and inconvenient way <code>scanf</code> treats the space character <i>between</i> the numbers and/or the carriage return <i>after</i> one or both of the numbers, but I don&#39;t actually bother remembering how <code>scanf</code> works in detail, because it&#39;s so broken that the only thing worth knowing about it is that it shouldn&#39;t be used."}, {"owner": {"reputation": 126, "user_id": 6288232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/31b4af300de80f5948bc08638711e260?s=128&d=identicon&r=PG&f=1", "display_name": "Youssef Sakuragi", "link": "https://stackoverflow.com/users/6288232/youssef-sakuragi"}, "edited": false, "score": 0, "creation_date": 1473253294, "post_id": 39370385, "comment_id": 66069296, "body": "Thanks for your time and tips! getline also worked, and I figured it out with the scanf"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 0, "last_activity_date": 1473252944, "last_edit_date": 1473252944, "creation_date": 1473252515, "answer_id": 39370385, "question_id": 39370316, "link": "https://stackoverflow.com/questions/39370316/adding-2-doubles-and-print-them/39370385#39370385", "title": "Adding 2 doubles and print them", "body": "<p>Don't use <code>scanf</code> ever; it is <a href=\"https://stackoverflow.com/questions/15664664/scanf-regex-c/15664816#15664816\">broken-as-specified</a>.</p>\n\n<p>Use <code>getline</code> to read an entire line (if you don't have <code>getline</code>, <code>fgets</code> will do), and then <code>strtod</code> to parse it into numbers.  (In this case it's possible to do the entire job with just <code>strtod</code>, but you may find it easier to write code that splits up the line with <code>strsep</code> first.  If you don't have <code>strsep</code>, <code>strtok</code> will do.)</p>\n\n<p>Once you make those changes your program should work.</p>\n"}, {"comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 5, "creation_date": 1473252946, "post_id": 39370514, "comment_id": 66069020, "body": "Whitespace is discarded automatically, so the space won&#39;t change anything."}, {"owner": {"reputation": 126, "user_id": 6288232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/31b4af300de80f5948bc08638711e260?s=128&d=identicon&r=PG&f=1", "display_name": "Youssef Sakuragi", "link": "https://stackoverflow.com/users/6288232/youssef-sakuragi"}, "edited": false, "score": 1, "creation_date": 1473253123, "post_id": 39370514, "comment_id": 66069175, "body": "@M.S Chaudhari, It actually Worked Thanks!"}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": true, "score": -2, "last_activity_date": 1473252841, "creation_date": 1473252841, "answer_id": 39370514, "question_id": 39370316, "link": "https://stackoverflow.com/questions/39370316/adding-2-doubles-and-print-them/39370514#39370514", "title": "Adding 2 doubles and print them", "body": "<p>Here, might be <strong>Input Buffer Problems With Scanf</strong>. So, you can add a <code>space</code> in the <code>scanf</code>. like,</p>\n\n<pre><code> scanf(\"%lf\", &amp;d);\n\n scanf(\" %lf\", &amp;m);\n</code></pre>\n\n<p>Also, use <code>%lf</code> in <code>scanf</code> instead of <code>%1f</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1473255297, "last_edit_date": 1495542767, "creation_date": 1473255297, "answer_id": 39371380, "question_id": 39370316, "link": "https://stackoverflow.com/questions/39370316/adding-2-doubles-and-print-them/39371380#39371380", "title": "Adding 2 doubles and print them", "body": "<p>Code is using a width limit of <code>1</code> in <code>scanf(\"%1f\", &amp;d);</code>.  That digit one limits the user input to 1 non-whitespace character and then attempts to save the result in a <code>float</code>.  Results are not defined.</p>\n\n<p>Be sure to enable all warnings.  Many compilers will warn that <code>double d; scanf(\"%1f\", &amp;d);</code> do not match.</p>\n\n<p>To save input to a <code>double</code> use an ell <code>l</code>.  <a href=\"https://stackoverflow.com/questions/39370316/adding-2-doubles-and-print-them/39371380#comment66068534_39370316\">@Alter Mann</a>  Be sure to check results too.</p>\n\n<pre><code>//          ell, not one\n//          v \nif (scanf(\"%lf\", &amp;d) != 1) puts(\"Number was not entered.\");\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 6288232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/31b4af300de80f5948bc08638711e260?s=128&d=identicon&r=PG&f=1", "display_name": "Youssef Sakuragi", "link": "https://stackoverflow.com/users/6288232/youssef-sakuragi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1473435637, "accepted_answer_id": 39370514, "answer_count": 3, "score": -1, "last_activity_date": 1473255297, "creation_date": 1473252281, "last_edit_date": 1473252489, "question_id": 39370316, "link": "https://stackoverflow.com/questions/39370316/adding-2-doubles-and-print-them", "closed_reason": "Not suitable for this site", "title": "Adding 2 doubles and print them", "body": "<p>Iam new to C and I have a problem with adding and printing some doubles in 09.3f format. This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv)\n{\n   double d, m, c;\n\n\n   scanf(\"%1f\", &amp;d);\n\n   scanf(\"%1f\", &amp;m);\n\n   c = d + m;\n   printf(\"%09.3f\\n\", c);\n\n\n}\n</code></pre>\n\n<p>And I have typed twice <code>scanf</code>yet I can only insert 1 number, why is that?\nwhat i get from the printf is 00000.000</p>\n\n<p>Example: d = 5,125 and m = 1.256, then i want C to be: 00006.381</p>\n"}, {"tags": ["c#", ".net", "c", "sockets", "ssh"], "owner": {"reputation": 721, "user_id": 2058437, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6523c487573ebe86d079edaa3d957520?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#225;s Geiszl", "link": "https://stackoverflow.com/users/2058437/andr%c3%a1s-geiszl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1473252158, "creation_date": 1473251673, "last_edit_date": 1473252158, "question_id": 39370117, "link": "https://stackoverflow.com/questions/39370117/create-tcp-socket-from-unmanaged-file-descriptor-in-c", "title": "Create TCP socket from unmanaged file descriptor in C#", "body": "<p>I'm using an unmanaged C library, <code>libusbmuxd</code>, to create a tunnel to my phone though a USB cable. It connects to the device and returns a file descriptor socket of the connection.</p>\n\n<pre><code>/**\n * Request proxy connect to \n *\n * @param handle returned by 'usbmuxd_scan()'\n *\n * @param tcp_port TCP port number on device, in range 0-65535.\n *  common values are 62078 for lockdown, and 22 for SSH.\n *\n * @return file descriptor socket of the connection, or -1 on error\n */\nint usbmuxd_connect(const int handle, const unsigned short tcp_port);\n</code></pre>\n\n<p>I want to send SSH commands through it using SSH.NET, however SSH.NET only supports communication through a TCP port. How can I make a listening TCP socket from this file descriptor so I can use SSH.NET with it (e.g. <code>var connectionInfo = new ConnectionInfo(\"127.0.0.1\", \"22\", \"mobile\", authenticationMethod)</code>)?</p>\n\n<p>I know I can make a <code>FileStream</code> object from the unmanaged file descriptor. Can I maybe use that C# object to create a socket though which SSH.NET could communicate?</p>\n"}, {"tags": ["c", "http", "microcontroller"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1473248631, "post_id": 39368829, "comment_id": 66065877, "body": "What HTTP related library are you using? On what operating system? You should mention it in your question. For client HTTP, I suggest <a href=\"https://curl.haxx.se/libcurl/\" rel=\"nofollow noreferrer\">libcurl</a>. For server HTTP, I suggest <a href=\"http://coralbits.com/libonion/\" rel=\"nofollow noreferrer\">libonion</a>. HTTP is complex enough to avoid losing your time to code your own HTTP implementation."}, {"owner": {"reputation": 167, "user_id": 6612656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4da284d4bde7cf7fc55a99a7cfe74cb?s=128&d=identicon&r=PG&f=1", "display_name": "lmbcerqueira", "link": "https://stackoverflow.com/users/6612656/lmbcerqueira"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473249457, "post_id": 39368829, "comment_id": 66066442, "body": "Hi @BasileStarynkevitch thanks for the advice, I&#39;ve just edited my post. I&#39;m using a bosch device - XDK. I&#39;m using the functions they provide so we can trust that all functions like HttpClient_initRequest were well implemented."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473323062, "post_id": 39368829, "comment_id": 66098811, "body": "<a href=\"http://xdk.bosch-connectivity.com/community\" rel=\"nofollow noreferrer\">xdk.bosch-connectivity.com/community</a> is probably a better place to ask. But be specific and give not only the above code snippet, but also some more context &amp; motivation."}], "owner": {"reputation": 167, "user_id": 6612656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4da284d4bde7cf7fc55a99a7cfe74cb?s=128&d=identicon&r=PG&f=1", "display_name": "lmbcerqueira", "link": "https://stackoverflow.com/users/6612656/lmbcerqueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473249266, "creation_date": 1473248139, "last_edit_date": 1473249266, "question_id": 39368829, "link": "https://stackoverflow.com/questions/39368829/c-application-http-failing-when-re-establishing-a-connection", "title": "C application HTTP failing when re-establishing a connection", "body": "<p>I'm developping an application which will run on a bosch device - XDK - <a href=\"http://xdk.bosch-connectivity.com/\" rel=\"nofollow\">http://xdk.bosch-connectivity.com/</a>. </p>\n\n<p>At this moment, I have a task which implements an http client and sends POST requests to a server. However, the main purpose of my application is to be able to move between areas with network coverage/no coverage. This means that I'm constantly suspending/re-starting the task that implements the http client. </p>\n\n<p>So I'm having problem with the http client in the following scenario: I start the application in a region with coverage, then I move to a region with no coverage and finally, go back again to a region with coverage. That's here I'm getting problems. From that moment, I can't connect anymore with the http client. </p>\n\n<p>I'll post here pieces of code of my application so that you can suggest me some alterations to solve the problem.\nAll the functions such as HttpClient_initRequest, HttpMsg_setReqUrl, Msg_prependPartFactory, ..., belong to the API provided for the XDK.</p>\n\n<pre><code>void appInitSystem(xTimerHandle xTimer) {\n    (void) (xTimer);\n\n    return_t retValue = FAILURE;\n    retcode_t wlanRet = RC_PLATFORM_ERROR;\n\n    wlanRet = wlan_init();\n    if (wlanRet != RC_OK){\n        printf(\"Network init/connection failed %i \\r\\n\", wlanRet);\n        assert(0);\n    }\n\n    wlanRet = PAL_initialize();\n    if (wlanRet != RC_OK){\n        printf(\"PAL and network initialize %i \\r\\n\", wlanRet);\n        assert(0);\n    }\n\n    PAL_socketMonitorInit();\n\n    /* start http client */\n    wlanRet = HttpClient_initialize();\n    if (wlanRet != RC_OK){\n        printf(\"Failed to initialize http client\\r\\n \");\n        assert(0);\n    }\n\n    if (RC_OK != PAL_getIpaddress((uint8_t*) \"52.58.121.5\", &amp;destAddr))\n       return;\n\n    retValue = createTasks();\n    if (retValue == FAILURE)\n        assert(0);\n}\n\nretcode_t wlan_init(void) {\n    WLI_connectStatus_t retconnection;\n    NCI_ipSettings_t myIpSettings;\n    char ipAddress[PAL_IP_ADDRESS_SIZE] = { 0 };\n    Ip_Address_T* IpaddressHex = Ip_getMyIpAddr();\n    WLI_connectSSID_t connectSSID;\n    WLI_connectPassPhrase_t connectPassPhrase;\n    NCI_return_t ReturnValue = NCI_FAILURE;\n    int32_t Result = INT32_C(-1);\n    if (WLI_SUCCESS != WLI_init())\n        return (RC_PLATFORM_ERROR);\n\n    connectSSID = (WLI_connectSSID_t) WLAN_CONNECT_WPA_SSID;\n    connectPassPhrase = (WLI_connectPassPhrase_t) WLAN_CONNECT_WPA_PASS;\n\n    /*DHCP */\n    ReturnValue = NCI_setIpDhcp(NULL);\n    if (ReturnValue != NCI_SUCCESS){\n        printf(\"Error in setting IP to DHCP\\n\\r\");\n        return (RC_PLATFORM_ERROR);\n    }\n\n    if (WLI_SUCCESS == WLI_connectWPA(connectSSID, connectPassPhrase, NULL){\n\n        ReturnValue = NCI_getIpSettings(&amp;myIpSettings);\n        if (NCI_SUCCESS == ReturnValue){\n            *IpaddressHex = Basics_htonl(myIpSettings.ipV4);\n            Result = Ip_convertAddrToString(IpaddressHex, ipAddress);\n            if (Result &lt; 0){\n                printf(\"Couldn't convert the IP address to string format \\r\\n \");\n                return (RC_PLATFORM_ERROR);\n            }\n            printf(\"Connected to WPA network successfully \\r\\n \");\n            printf(\" Ip address of the device %s \\r\\n \", ipAddress);\n            return (RC_OK);\n        }\n        else{\n            printf(\"Error in getting IP settings\\n\\r\");\n            return (RC_PLATFORM_ERROR);\n        }\n\n   }\n   else\n      return (RC_PLATFORM_ERROR);\n\n   return RC_OK;\n}\n\n\n/* Task which calls the nttp client */\nvoid dataOffload(void* handle) {\n    (void) handle;\n\n     for (;;){\n         ....\n         http_connServer(NULL);\n         ...\n         vTaskDelay(1000/portTICK_RATE_MS);\n     }\n }\n\nvoid http_connServer(void * pvParameters){\n\n    retcode_t rc = RC_OK;\n    Msg_T* msg_ptr;\n    Ip_Port_T destPort = (Ip_Port_T) DEST_PORT_NUMBER;\n    static Callable_T SentCallable;\n    char const *url_ptr = \"/\";  \n    Callable_T * Callable_pointer;\n    Callable_pointer = Callable_assign(&amp;SentCallable, http_callbackOnSent);\n    if (Callable_pointer == NULL)\n        return;\n\n    rc = HttpClient_initRequest(&amp;destAddr, Ip_convertIntToPort(destPort), &amp;msg_ptr);\n    if (rc != RC_OK || msg_ptr == NULL)\n        return;\n\n    rc = Msg_prependPartFactory( msg_ptr, &amp;http_setContent);\n    if (rc != RC_OK) \n      return;\n\n    rc = HttpMsg_setReqUrl(msg_ptr, url_ptr);\n    if (rc != RC_OK) \n        return;\n\n    HttpMsg_setReqMethod(msg_ptr, Http_Method_Post);\n\n    rc = HttpClient_pushRequest(msg_ptr, &amp;SentCallable,\n        http_clientResponseCallback);\n    if (rc != RC_OK){\n        printf(\"Failed HttpClient_pushRequest \\r\\n  \");\n        return;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "ld", "msp430", "linker-scripts"], "comments": [{"owner": {"reputation": 241, "user_id": 1685935, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55c96f77781f7b1d260cd4eeb3488222?s=128&d=identicon&r=PG", "display_name": "P Mendham", "link": "https://stackoverflow.com/users/1685935/p-mendham"}, "edited": false, "score": 0, "creation_date": 1473248490, "post_id": 39368730, "comment_id": 66065776, "body": "I guess another way of asking this question is: how do I stop the linker from discarding the section without adding anything extra to it (if the vector is defined it must not be any bigger)?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473255765, "post_id": 39368730, "comment_id": 66071042, "body": "This is an XY problem. Instead of having a single section for every vector, you should use a single <b>table</b> in your code in its single section. Then place this section at the appropriate address. You might want to have a look at typical startup code not only for the MSP430, but also other MCUs like ARM Cortex-M."}, {"owner": {"reputation": 1610, "user_id": 502189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cba4d424ecb01d45a923636bef46cc7?s=128&d=identicon&r=PG", "display_name": "rjp", "link": "https://stackoverflow.com/users/502189/rjp"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473256116, "post_id": 39368730, "comment_id": 66071308, "body": "I&#39;d go with what @Olaf is suggesting. The typical way this is done is with a table defined in either an assembly file or a C file that gets placed in the interrupt vector section. You can hammer that square peg into the round hole if you use enough force, but it&#39;s easier to just use the round peg."}, {"owner": {"reputation": 241, "user_id": 1685935, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55c96f77781f7b1d260cd4eeb3488222?s=128&d=identicon&r=PG", "display_name": "P Mendham", "link": "https://stackoverflow.com/users/1685935/p-mendham"}, "edited": false, "score": 0, "creation_date": 1473324213, "post_id": 39368730, "comment_id": 66099453, "body": "Thanks for the input. I would normally go for a single table in the actual code, I do on some other platforms, but I was trying to retain as much compatibility with the standard MSP430 toolchain as possible. The toolchain uses a specific GCC attribute to specify an interrupt handler which then directs the tooling to insert the correct preamble/return code but also sorts out the vector table entry and ensures that the interrupt service routine is in low memory. I could do all of that manually but I would be fighting the tools. I&#39;d prefer to deviate from the standard as little as possible."}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 1685935, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55c96f77781f7b1d260cd4eeb3488222?s=128&d=identicon&r=PG", "display_name": "P Mendham", "link": "https://stackoverflow.com/users/1685935/p-mendham"}, "is_accepted": false, "score": 1, "last_activity_date": 1473252022, "creation_date": 1473252022, "answer_id": 39370233, "question_id": 39368730, "link": "https://stackoverflow.com/questions/39368730/force-minimum-size-of-linker-script-section/39370233#39370233", "title": "Force minimum size of linker script section", "body": "<p>I have created a work around. In retrospect it's obvious, but in case this helps anyone else, I will describe it here.</p>\n\n<p>My location pointer advancement doesn't help because if there is no data in the input section the linker discards the output section. This means that no data will get added to ROM. I need there to be padding added to ROM because I need to the vector table to always be the same size. I worked around this by using the location pointer advancement but putting all of the interrupt vectors into a single section:</p>\n\n<pre><code>OUTPUT_ARCH(msp430)\nENTRY(_start)\n\nMEMORY {\n  ROM (rx)         : ORIGIN = 0x9C02, LENGTH = 0x61FE\n  VECTABLE         : ORIGIN = 0x5B80, LENGTH = 0x007E\n}\n\nSECTIONS\n{\n  .vector_table :\n  {\n    __vectable_load__ = LOADADDR(.vector_table);\n    __vectable_start__ = .;\n    __interrupt_vector_1__ = .;\n    KEEP (*(__interrupt_vector_1))\n    . = __interrupt_vector_1__ + 2;\n    __interrupt_vector_2__ = .;\n    KEEP (*(__interrupt_vector_2)) \n    . = __interrupt_vector_2__ + 2;\n    ...\n    __interrupt_vector_63__ = .;\n    KEEP (*(__interrupt_vector_63))\n    KEEP (*(__interrupt_vector_sysnmi))\n    . = __interrupt_vector_63__ + 2;\n    __vectable_end__ = .;\n  } &gt; VECTABLE AT&gt; ROM\n}\n</code></pre>\n\n<p>Now the necessary padding will get added to both RAM and ROM provided that the vector table is not completely empty. If it is that doesn't bother me, it just doesn't get copied, the main thing is that vectors don't end up in the wrong places.</p>\n"}], "owner": {"reputation": 241, "user_id": 1685935, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55c96f77781f7b1d260cd4eeb3488222?s=128&d=identicon&r=PG", "display_name": "P Mendham", "link": "https://stackoverflow.com/users/1685935/p-mendham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1896, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473252022, "creation_date": 1473247798, "question_id": 39368730, "link": "https://stackoverflow.com/questions/39368730/force-minimum-size-of-linker-script-section", "title": "Force minimum size of linker script section", "body": "<p>I have a set of linker script sections for an interrupt vector table. The sections will be located in RAM and will be loaded into RAM by my code. As each vector must be at an absolute location, there is a separate section (and a separate memory region) for each vector.</p>\n\n<p>Some vectors may not be used by the application, whilst others will. To ensure that the copy code still works I need to make sure that, if a vector is not present, the equivalent space in ROM (two bytes) is filled. I tried to do this by advancing the location pointer but of course this only affects the VMA and so doesn't help me at all.</p>\n\n<p>How can I ensure that a section always takes up the required amount of space in ROM? i.e. how can I move the LMA on if there is no data in the section?</p>\n\n<p>Any hints or tips would be greatly appreciated.</p>\n\n<p>I have abridged my current linker script below:</p>\n\n<pre><code>OUTPUT_ARCH(msp430)\nENTRY(_start)\n\nMEMORY {\n  ROM (rx)         : ORIGIN = 0x9C02, LENGTH = 0x61FE\n  VECT1            : ORIGIN = 0x5B80, LENGTH = 0x0002\n  VECT2            : ORIGIN = 0x5B82, LENGTH = 0x0002\n  ...\n  VECT63           : ORIGIN = 0x5BFC, LENGTH = 0x0002\n}\n\nSECTIONS\n{\n  __interrupt_vector_1 : \n  { \n    __vectable_load__ = LOADADDR(__interrupt_vector_1);\n    __vectable_start__ = .;\n    __interrupt_vector_1__ = .;\n    KEEP (*(__interrupt_vector_1))\n    . = __interrupt_vector_1__ + 2;\n  } &gt; VECT1 AT&gt; ROM\n  __interrupt_vector_2 : \n  { \n    __interrupt_vector_2__ = .;\n    KEEP (*(__interrupt_vector_2)) \n    . = __interrupt_vector_2__ + 2;\n  } &gt; VECT2 AT&gt; ROM\n\n  ...\n\n  { \n    __interrupt_vector_63__ = .;\n    KEEP (*(__interrupt_vector_63))\n    KEEP (*(__interrupt_vector_sysnmi))\n    . = __interrupt_vector_63__ + 2;\n    __vectable_end__ = .;\n  } &gt; VECT63 AT&gt; ROM\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "memory"], "comments": [{"owner": {"reputation": 135, "user_id": 6012983, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/86ac0f66662fc92aa5670c9dddeb6c29?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/6012983/alex"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1473248005, "post_id": 39368726, "comment_id": 66065459, "body": "Sorry, it&#39;s in C."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1473248099, "post_id": 39368726, "comment_id": 66065520, "body": "Can you show us what you&#39;re putting into <code>s_in</code>?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1473248908, "post_id": 39368726, "comment_id": 66066072, "body": "Where are you printing <code>x</code>. Is it inside the <code>frame</code> for loop, or outside?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1473249089, "post_id": 39368726, "comment_id": 66066190, "body": "When indexing <code>x</code> you must always use a value between 0 and 479. When <code>frame</code> &gt; 0 then <code>i</code> will have values that are &gt;480."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 6781862, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208811408976888/picture?type=large", "display_name": "Javier Bellver Garc&#237;a", "link": "https://stackoverflow.com/users/6781862/javier-bellver-garc%c3%ada"}, "is_accepted": false, "score": 1, "last_activity_date": 1473249446, "creation_date": 1473249446, "answer_id": 39369318, "question_id": 39368726, "link": "https://stackoverflow.com/questions/39368726/filling-array-gives-unexpected-values/39369318#39369318", "title": "Filling array gives unexpected values", "body": "<p>You algorithm get's out of the bounds of the x array. When you iterate over the frames you get values longer than the max size of the x array and then you try to access x positions that doesn't have been reserved on memory, hence the weird numbers. Always remember that C doesn't check if an array is out of bounds</p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 6012983, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/86ac0f66662fc92aa5670c9dddeb6c29?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/6012983/alex"}, "edited": false, "score": 0, "creation_date": 1473310995, "post_id": 39369880, "comment_id": 66093041, "body": "Thank you for the answer! I changed the code and applied your suggestions. Now I am getting a segmentation fault at frame 253, and I just don&#39;t know why. I only get the error when I try to print out the values of the x[]. I am  sure, that the s_in[] is filled within this frame, but how can it be, that it only gives me the segmentation fault when I try to read and print the x[] array?"}], "tags": [], "owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": true, "score": 1, "last_activity_date": 1473250965, "creation_date": 1473250965, "answer_id": 39369880, "question_id": 39368726, "link": "https://stackoverflow.com/questions/39368726/filling-array-gives-unexpected-values/39369880#39369880", "title": "Filling array gives unexpected values", "body": "<p>There are two problems in the line:</p>\n\n<pre><code>x[i] = s_in[i];\n</code></pre>\n\n<p>On the very first iteration, when the aboce line is executed, the values of the variables are:</p>\n\n<pre><code>frame:    0\nleft:  -239\ni:     -240\n</code></pre>\n\n<p><strong>The code attempts to read from outside of bounds of <code>s_in[]</code> and to write writes outside of bounds of <code>x[]</code>.</strong></p>\n\n<p>This is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behaviour</a>.</p>\n\n<p>It's difficult to provide a fix to the code without knowing how the information is laid out in <code>s_in[]</code>. Assuming a frame is 240 bytes and on each iteration you want to copy the values for two consecutive frames from <code>s_in[]</code> into <code>x[]</code>, the code should look something along these lines:</p>\n\n<pre><code>int s_in[]; /* Array filled with a lot of integer values */\nfor (frame = 1; frame &lt; maxFrames; frame ++) {\n  left  = 240 * (frame - 1);        /* the first value of the previous frame */\n  right = 240 * (frame + 1);        /* the first value of the next frame */\n  int x[480];                       /* is always 480 long */\n\n  for (i = 0; i &lt; 480; i ++) {\n    x[i] = s_in[left + i];\n  }\n}\n</code></pre>\n\n<p>There is no point in computing <code>right-left+1</code> on each iteration since you already know it must be <code>480</code>. As you can see from the code above, the value of <code>right</code> is not even needed.</p>\n\n<p>The outer loop should start with <code>frame = 0</code> but for frame <code>#0</code> the offending line attempts to read from outside <code>s_in[]</code>; this is why it starts with frame <code>#1</code>. </p>\n\n<p>I suppose you do more processing inside the inner loop. Otherwise you can replace it with a call to <a href=\"http://en.cppreference.com/w/c/string/byte/memcpy\" rel=\"nofollow\"><code>memcpy(&amp;x, &amp;s_in[left], 480);</code></a>. It does the same as the current status of the <code>for</code> loop but it runs much faster.</p>\n"}], "owner": {"reputation": 135, "user_id": 6012983, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/86ac0f66662fc92aa5670c9dddeb6c29?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/6012983/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 39369880, "answer_count": 2, "score": 1, "last_activity_date": 1473250965, "creation_date": 1473247783, "last_edit_date": 1473247977, "question_id": 39368726, "link": "https://stackoverflow.com/questions/39368726/filling-array-gives-unexpected-values", "title": "Filling array gives unexpected values", "body": "<p>I have a serious problem when filling an array. My functions looks like this:</p>\n\n<pre><code>int s_in[]; /* Array filled with a lot of integer values */\nfor(frame=0; frame&lt;maxFrames; frame++){\n  left = 240*(frame-1) + 1;\n  right = 240*(frame +1);\n  int x[right-left+1]; /* is always 480 long */\n\n  for(i=left-1;i&lt;right;i++){\n    x[i] = s_in[i];\n  }\n</code></pre>\n\n<p>When I now try to print out the values stored in x[] for each run, I often either get an empty x[] or some random numbers that do not appear in the s_in[].\nCan that problem be solved with some kind of memory management?</p>\n"}, {"tags": ["c", "stm8"], "comments": [{"owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "edited": false, "score": 3, "creation_date": 1473247791, "post_id": 39368700, "comment_id": 66065303, "body": "no, any value in a float will always fit in a double too. They are coerced automatically"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473256436, "post_id": 39368700, "comment_id": 66071563, "body": "Why use <code>fabs(some_float)</code>?  Instead recommend <code>fabsf(some_float)</code>."}, {"owner": {"reputation": 11, "user_id": 6804364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6208e1f421b0aaf05b8e63aefc98e43?s=128&d=identicon&r=PG&f=1", "display_name": "DukeNukem49", "link": "https://stackoverflow.com/users/6804364/dukenukem49"}, "edited": false, "score": 0, "creation_date": 1473321489, "post_id": 39368700, "comment_id": 66097966, "body": "<code>fabsf(some_float)</code> is not supplied by the compiler."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1473338823, "post_id": 39368700, "comment_id": 66108730, "body": "it should behave as when you use <code>long</code> and <code>int</code> in 32bit architectures, that both types are completely interchangeable."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473254056, "post_id": 39368785, "comment_id": 66069846, "body": "First of, the question is tagged <code>c</code>, not <code>c++</code>. Second, much of this post is incomprehensible."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473256730, "post_id": 39368785, "comment_id": 66071793, "body": "&quot;and no data loss will result.&quot; --&gt; Not always.  Consider <code>fabs(LLONG_MAX)</code>.  Conversion of wide integer types to FP types can often result in loss of precision (common) or even range in extreme cases like <code>(float) some_128_bit_int</code>."}, {"owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "edited": false, "score": 0, "creation_date": 1473265611, "post_id": 39368785, "comment_id": 66078041, "body": "integer to floating point promotion does not exist. The article is talking about small int to larger int and small float to larger float. not large int to large float which of course will not be correct all the time"}], "tags": [], "owner": {"reputation": 7937, "user_id": 1866300, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab16abeddf6aa51bb13e7fe06d70b2c?s=128&d=identicon&r=PG", "display_name": "Serve Laurijssen", "link": "https://stackoverflow.com/users/1866300/serve-laurijssen"}, "is_accepted": false, "score": 0, "last_activity_date": 1473247953, "creation_date": 1473247953, "answer_id": 39368785, "question_id": 39368700, "link": "https://stackoverflow.com/questions/39368700/is-it-needed-to-typecast-float-to-double-when-using-math-h/39368785#39368785", "title": "Is it needed to typecast float to double when using math.h?", "body": "<p>Numeric promotion</p>\n\n<p>Whenever a value from one type is converted into a value of a larger similar data type, this is called a numeric promotion (or widening, though this term is usually reserved for integers). For example, an int can be widened into a long, or a float promoted into a double:</p>\n\n<p>1\n2\nlong l(64); // widen the integer 64 into a long\ndouble d(0.12f); // promote the float 0.12 into a double\nWhile the term \u201cnumeric promotion\u201d covers any type of promotion, there are two other terms with specific meanings in C++:</p>\n\n<p>Integral promotion involves the conversion of integer types narrower than int (which includes bool, char, unsigned char, signed char, unsigned short, signed short) to an integer (if possible) or an unsigned int.\nFloating point promotion involves the conversion of a float to a double.\nIntegral promotion and floating point promotion are used in specific cases to convert smaller data types to int/unsigned int or double, because those data types are generally the most performant to perform operations on.</p>\n\n<p>The important thing to remember about promotions is that they are always safe, and no data loss will result.</p>\n\n<p>Source:</p>\n\n<p><a href=\"http://www.learncpp.com/cpp-tutorial/44-implicit-type-conversion-coercion/\" rel=\"nofollow\">http://www.learncpp.com/cpp-tutorial/44-implicit-type-conversion-coercion/</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6804364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6208e1f421b0aaf05b8e63aefc98e43?s=128&d=identicon&r=PG&f=1", "display_name": "DukeNukem49", "link": "https://stackoverflow.com/users/6804364/dukenukem49"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473247953, "creation_date": 1473247716, "question_id": 39368700, "link": "https://stackoverflow.com/questions/39368700/is-it-needed-to-typecast-float-to-double-when-using-math-h", "title": "Is it needed to typecast float to double when using math.h?", "body": "<p>I use the Cosmic C Compiler for STM8 micro controllers and use float variables. For the currently used platform the compiler does not provide double types. Anyway, when one uses doubles they are treated as floats.</p>\n\n<p>I wonder whether it is needed to typecast float to double when using e.g. fabs()?\nIt is declared as <code>double fabs(double x);</code></p>\n\n<p>I haven't found anything in the compiler docs regarding this.</p>\n\n<p>But even without typecasting, it compiles without warnings.\nBy the way, the GCC compiles also without warnings when I mix up double with float.</p>\n"}, {"tags": ["c", "memory-management", "out-of-memory", "sigabrt"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1473248066, "post_id": 39368659, "comment_id": 66065499, "body": "The code in the link writes to <code>start[n]</code> (which is outside the bounds of the buffer) <code>n</code> times, instead of filling it. And the code you posted is not a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 67, "user_id": 6563413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00d6a28f94d55bb7f05aa182a52de39?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz.R", "link": "https://stackoverflow.com/users/6563413/vinz-r"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1473252302, "post_id": 39368659, "comment_id": 66068514, "body": "Yes, you are right about that code, but my purpose of providing that link was to show the source of the information is a high lever contributor of a decent forum. And i have provided some explanation of the code i posted to make my problem clear."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1473253934, "post_id": 39368659, "comment_id": 66069759, "body": "I refer back to the mcve issue. Stop describing your problem code. Show it in the smallest example possible."}, {"owner": {"reputation": 67, "user_id": 6563413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00d6a28f94d55bb7f05aa182a52de39?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz.R", "link": "https://stackoverflow.com/users/6563413/vinz-r"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1473254331, "post_id": 39368659, "comment_id": 66070046, "body": "I am sorry, i thought the code i provided earlier was insufficient or unclear. I corrected that best to my knowledge. Thank you."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1473254520, "post_id": 39368659, "comment_id": 66070202, "body": "Look, the code you provided, doesn&#39;t compile. Now it&#39;s true that it&#39;s simple enough to fix. But if you haven&#39;t provided a compilable example, how is anybody here to know you haven&#39;t omitted anything else that pertains to the issue you face? Also, if it&#39;s a run-time problem, you need to provide inputs that will demonstrate it. 25 lines of code and some input go further in helping us help you, than a wall of text."}], "answers": [{"comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 1, "creation_date": 1473248099, "post_id": 39368764, "comment_id": 66065521, "body": "Access via invalid pointer often results in <code>SIGSEGV</code>, not in <code>SIGABRT</code>."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1473248154, "post_id": 39368764, "comment_id": 66065552, "body": "@Serhio: yes, but it <i>can</i> result in <i>any</i> behaviour. That is, after all, what &quot;undefined&quot; means :-). In other words, regardless of the <i>actual</i> issue, you should be checking these things."}, {"owner": {"reputation": 67, "user_id": 6563413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00d6a28f94d55bb7f05aa182a52de39?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz.R", "link": "https://stackoverflow.com/users/6563413/vinz-r"}, "edited": false, "score": 0, "creation_date": 1473252581, "post_id": 39368764, "comment_id": 66068712, "body": "As for the scanf i have checked that it is scanning two values. I need to submit the code on a website which do not allow file i/o. Is there any other way to handle this problem ?"}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1473253454, "last_edit_date": 1473253454, "creation_date": 1473247881, "answer_id": 39368764, "question_id": 39368659, "link": "https://stackoverflow.com/questions/39368659/what-is-the-cause-of-sigabrt-error-in-my-c-code-and-how-to-overcome-this/39368764#39368764", "title": "What is the cause of SIGABRT error in my C code and how to overcome this?", "body": "<p>For a start, you really should check the return value of <code>malloc</code>, <em>especially</em> if you're allocating large chunks of memory as you are.</p>\n\n<p>If it cannot allocate memory, it will return <code>NULL</code> which, should you then attempt to dereference, will give you undefined behaviour.</p>\n\n<p>If that is the case, you will need to find a way to store your data that <em>doesn't</em> exhaust memory, such as using a file to store it and only loading sections of the file at a time.</p>\n\n<p>You should also be checking the return value from <code>scanf</code> to ensure that it's actually scanning two items, lest <code>friends</code> and/or <code>relations</code> may be set to some arbitrarily value.</p>\n\n<p>The other thing to watch out for is that you're actually <em>freeing</em> that memory allocated within <code>findresult</code>. You haven't <em>shown</em> us the entire function but failure to free the memory before returning to the loop in <code>main</code> will result in a memory leak of millions of bytes (e.g., about 8MB assuming your <code>int</code> type is four bytes long) every single time through that loop. That could quickly exhaust your memory depending on what value you're entered for <code>test_cases</code>.</p>\n"}], "owner": {"reputation": 67, "user_id": 6563413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00d6a28f94d55bb7f05aa182a52de39?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz.R", "link": "https://stackoverflow.com/users/6563413/vinz-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1439, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473254216, "creation_date": 1473247611, "last_edit_date": 1473254216, "question_id": 39368659, "link": "https://stackoverflow.com/questions/39368659/what-is-the-cause-of-sigabrt-error-in-my-c-code-and-how-to-overcome-this", "title": "What is the cause of SIGABRT error in my C code and how to overcome this?", "body": "<p>The error only occurs when i try to input large data. After reading a lot of resources I found the causes of this error as follows-\n1. touching the memory location we are not allowed to.\n2. using free() on the memory we have not reserved or double free() a pointer.\n3. initializing invalid index (such as creating arrays with negative index)\n I found one cause which may have caused this error in my code-</p>\n\n<p>link - <a href=\"https://discuss.codechef.com/questions/59703/prime-number-generation-sigabrt-problem-c\" rel=\"nofollow\">https://discuss.codechef.com/questions/59703/prime-number-generation-sigabrt-problem-c</a></p>\n\n<p>which says-\n\"May be the limit on n is quite large! You can atmost make an array of 10^8 size for online judges. \nThat too in the heap memory ie. outside the main function. Making an array of size of even 10^7 in the main function can lead to runtime errors.\nTry not to use more than of the order 10^8 elements for the array.. :)</p>\n\n<p>In the question you are attempting the upper limit is 10^9\nYou can make an array of that size. Thats why SIGABRT error which means you exceeded the memory limit.\"</p>\n\n<p>then i modified the declaration and input part to this- </p>\n\n<pre><code>int main(void)\n{\n    int test_cases;\n    scanf(\"%i\",&amp;test_cases);\n\n    for (int i=0; i&lt;test_cases; i++)\n    {\n        findresult(i);\n    }\n\nvoid findresult(int i)\n{\n        int relations; // of the size 10^6\n        scanf(\"%i\",&amp;relations);\n\n        int* pair1 = malloc(sizeof(int)*relations);\n        int* pair2 = malloc(sizeof(int)*relations);\n        for (int j=0; j&lt;relations; j++)\n        {\n            scanf(\"%i %i\",&amp;pair1[j],&amp;pair2[j]);\n        }\n</code></pre>\n\n<p>What i got to know is that creating a big array <code>int pairs[relations][2]</code> (int relations is 10^6) on stack memory causes this error and also creating such big array in main function itself will also cause the error. So, as can be seen in the code above, i created a function and allocated the memory in the heap instead, using malloc (pair1 and pair2). Still i am getting the same error. Also there is not errors in the rest of the code as it is working fine for small data. If the problem related to creating the arrays of big sizes is indeed the problem then please help me how to overcome this.</p>\n\n<p>EDIT 1- Explaining the code-\nFor every test case \"i\" a function \"findresult\" is called. For every \"i\" The function takes input for two integers and as per the second input \"relations\" it declares two integers arrays of size \"relations\". Then user povide input for every element of both the arrays. Then the rest of the functions just involves reading from the arrays and checking some conditions.</p>\n\n<p>EDIT 2- I need to store all the data first and then perfom the condition checking which require the precense of all the data. That is why  i can not do it one by one (i.e taking first elements of both the arrays then performing checks then second and so on)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 12, "creation_date": 1473241284, "post_id": 39366400, "comment_id": 66061169, "body": "42 is <a href=\"https://www.google.it/?client=ubuntu#channel=fs&amp;q=the+answer+to+life%2C+the+universe+and+everything&amp;gfe_rd=cr\" rel=\"nofollow noreferrer\">the answer to life, the universe and everything!</a>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1473241337, "post_id": 39366400, "comment_id": 66061204, "body": "Because 127 was taken?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 6, "creation_date": 1473241373, "post_id": 39366400, "comment_id": 66061221, "body": "42 is clearly the <i>opposite</i> of  a named value -- it&#39;s a magic value that only the author of the code knows why it&#39;s there. It&#39;s not portable, though, the only portable exit values are 0, <code>EXIT_SUCCESS</code> and <code>EXIT_FAILURE</code>."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1473241402, "post_id": 39366400, "comment_id": 66061239, "body": "To be more explicit about what others have said: Don&#39;t think too hard about it. It&#39;s just a pop culture reference without any special significance to the C language."}], "answers": [{"comments": [{"owner": {"reputation": 876, "user_id": 6742754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m8Z1g.png?s=128&g=1", "display_name": "zeroDivider", "link": "https://stackoverflow.com/users/6742754/zerodivider"}, "edited": false, "score": 1, "creation_date": 1473242130, "post_id": 39366444, "comment_id": 66061743, "body": "Oh, man, I knew it, but it was too funny to be true xD"}], "tags": [], "owner": {"reputation": 64505, "user_id": 413337, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/783783f968e84cf5047544e9a0f3ccf4?s=128&d=identicon&r=PG", "display_name": "Codo", "link": "https://stackoverflow.com/users/413337/codo"}, "is_accepted": true, "score": 9, "last_activity_date": 1473241746, "last_edit_date": 1473241746, "creation_date": 1473241338, "answer_id": 39366444, "question_id": 39366400, "link": "https://stackoverflow.com/questions/39366400/why-is-it-exit42/39366444#39366444", "title": "Why is it exit(42)?", "body": "<p>Any number except for 0 would have done. But 42 is the <a href=\"https://en.wikipedia.org/wiki/Phrases_from_The_Hitchhiker%27s_Guide_to_the_Galaxy#Answer_to_the_Ultimate_Question_of_Life.2C_the_Universe.2C_and_Everything_.2842.29\" rel=\"noreferrer\">Answer to the Ultimate Question of Life, the Universe, and Everything</a>.</p>\n\n<p>Very popular among IT people...</p>\n\n<p>But why did Douglas Adams pick 42?</p>\n\n<blockquote>\n  <p>I sat at my desk, stared into the garden and thought '42 will do'. I\n  typed it out. End of story</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 836, "user_id": 6541288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d0b24428d61a0adbae78280ca52cdc?s=128&d=identicon&r=PG&f=1", "display_name": "\u03bbuser", "link": "https://stackoverflow.com/users/6541288/%ce%bbuser"}, "edited": false, "score": 1, "creation_date": 1473241779, "post_id": 39366532, "comment_id": 66061492, "body": "If possible, values from <a href=\"https://www.freebsd.org/cgi/man.cgi?query=sysexits&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+4.3-RELEASE&amp;format=html\" rel=\"nofollow noreferrer\">sysexits.h</a> should be preferred. It&#39;s fairly standard."}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 2, "last_activity_date": 1473241786, "last_edit_date": 1473241786, "creation_date": 1473241591, "answer_id": 39366532, "question_id": 39366400, "link": "https://stackoverflow.com/questions/39366400/why-is-it-exit42/39366532#39366532", "title": "Why is it exit(42)?", "body": "<p>Such magic value may be used to indicate exact exit reason to parent process. You may threat it like a some kind of minimalistic IPC. Of course both processes must agree about actual values and their meanings, as well as do not use special reserved exit codes.</p>\n"}, {"comments": [{"owner": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 1, "creation_date": 1550031331, "post_id": 39367021, "comment_id": 96115761, "body": "Are 37, 62 and 41 just random numbers you just typed, or is it a certain convention?"}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "reply_to_user": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 0, "creation_date": 1550035657, "post_id": 39367021, "comment_id": 96116864, "body": "Random numbers between <code>1</code> and <code>127</code>. <code>0</code> is the exit code for success, values larger than <code>127</code> are not interpreted the same way on all Unix systems."}, {"owner": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 0, "creation_date": 1550035967, "post_id": 39367021, "comment_id": 96116953, "body": "I see. The way you are referencing 37/62/41 in the answer looks as if it is the standard of a certain class of programs. (Just like <code>--gnu-options</code> is a standard in GNU programs but not in Windows or Java programs etc.)"}], "tags": [], "owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": false, "score": 1, "last_activity_date": 1473243041, "creation_date": 1473243041, "answer_id": 39367021, "question_id": 39366400, "link": "https://stackoverflow.com/questions/39366400/why-is-it-exit42/39367021#39367021", "title": "Why is it exit(42)?", "body": "<blockquote>\n  <p>It is kind of clear that it doesn't matter if I use exit(1) or exit(42)</p>\n</blockquote>\n\n<p>It actually matters a lot.</p>\n\n<p>The exit code can be used by the process that launches the exiting process to know how it completed and why it failed.</p>\n\n<p>The process that launches your program can inspect the value of the environment variable <code>$?</code> immediately after your program completes to know if it succeeded or why it failed, if it didn't succeed.</p>\n\n<p>Let's say your program downloads a file from a remote site and stores it in a local directory. It expects to use an existing local directory and it doesn't attempt to create it if it doesn't exist. It can exit, for example, with code <code>37</code> when the remote file cannot be downloaded because the remote site return <code>404 Not Found</code>, with code <code>62</code> when it cannot download the file because the network is down (or a timeout happens) and code <code>41</code> when the local directory does not exist.</p>\n\n<p>A <code>bash</code> script, for example, that invokes your program can check the value of the environment variable <code>$?</code> immediately after your program completes. If its value is <code>37</code> (remote file is not found) it must not attempt to retry because the error is permanent. On exit code <code>62</code> (network issues) it can wait a couple of seconds and try again (the error condition is transient, it could disappear after a while). On exit code <code>41</code> (local directory not found) it can create the local directory then launch your program again (a precondition was not met).</p>\n"}], "owner": {"reputation": 876, "user_id": 6742754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m8Z1g.png?s=128&g=1", "display_name": "zeroDivider", "link": "https://stackoverflow.com/users/6742754/zerodivider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5378, "favorite_count": 2, "closed_date": 1473243125, "accepted_answer_id": 39366444, "answer_count": 3, "score": 2, "last_activity_date": 1473243041, "creation_date": 1473241193, "question_id": 39366400, "link": "https://stackoverflow.com/questions/39366400/why-is-it-exit42", "closed_reason": "Duplicate", "title": "Why is it exit(42)?", "body": "<p>Why do we use 42 as an argument of exit while exiting the process? I am wondering is it some macro value (like 1 is value of EXIT_FAILURE macro) or it has some deeper meaning?</p>\n\n<pre><code>if(pid == 0) {\n    printf(\"something\\n\");\n    exit(42);\n}\n</code></pre>\n\n<p>It is kind of clear that it doesn't matter if I use exit(1) or exit(42), but why just 42? </p>\n"}, {"tags": ["c++", "c", "windows"], "comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1473241618, "post_id": 39366383, "comment_id": 66061382, "body": "It appears that the SID you&#39;re getting with this code has a different domain/local ID. How are you determining &quot;the user&#39;s actual SID&quot; to which you are comparing it? Is the machine attached to a domain?"}, {"owner": {"reputation": 81, "user_id": 5946120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea497ea7e70476d95caae8082df13ac?s=128&d=identicon&r=PG", "display_name": "Blaze", "link": "https://stackoverflow.com/users/5946120/blaze"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1473249085, "post_id": 39366383, "comment_id": 66066185, "body": "@CodyGray Updated the question. By actual SID I mean the one I get through looking at the process owner (code not shown) or by looking at the user&#39;s registry key under HKEY_USERS."}, {"owner": {"reputation": 81, "user_id": 5946120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea497ea7e70476d95caae8082df13ac?s=128&d=identicon&r=PG", "display_name": "Blaze", "link": "https://stackoverflow.com/users/5946120/blaze"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1473266141, "post_id": 39366383, "comment_id": 66078304, "body": "It looks like WTSQueryUserToken would be quite helpful, as I could get the SessionID (not to be confused with SID) using WTS functions and then get the SID from the user token. However, WTSQueryUserToken requires special prvilieges (i.e. a service) whereas I need this to work in an ordinary, non-elevated process."}, {"owner": {"reputation": 81, "user_id": 5946120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea497ea7e70476d95caae8082df13ac?s=128&d=identicon&r=PG", "display_name": "Blaze", "link": "https://stackoverflow.com/users/5946120/blaze"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1473266244, "post_id": 39366383, "comment_id": 66078360, "body": "A colleague suggested getting the SID from the owner of explorer.exe. This would be somewhat effective but doesn&#39;t handle edge cases where explorer is relaunched by a different user or multiple users are logged on (and so multiple explorer processes exist) at the same time."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1473295307, "post_id": 39366383, "comment_id": 66089628, "body": "It might be possible to extract the SID you&#39;re after from the window station or the desktop object, e.g., the user might be the owner.  But I can&#39;t really imagine any legitimate reason for non-elevated code to care about the logged-on user as opposed to the user the code is running as.  Can you clarify what you are actually trying to achieve, i.e., what will you do with the SID once you&#39;ve got it?"}, {"owner": {"reputation": 81, "user_id": 5946120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea497ea7e70476d95caae8082df13ac?s=128&d=identicon&r=PG", "display_name": "Blaze", "link": "https://stackoverflow.com/users/5946120/blaze"}, "edited": false, "score": 0, "creation_date": 1473345621, "post_id": 39366383, "comment_id": 66113805, "body": "I&#39;m working on a suite of functions for working with users/administrators/elevation in an installer. The SID could be used to address HKEY_USERS or simply to compare the process owner against the logged-on user for detecting impersonation, etc. This may be used by multiple developers for their own use cases, and may or may not be the right way to do what they want."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5946120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea497ea7e70476d95caae8082df13ac?s=128&d=identicon&r=PG", "display_name": "Blaze", "link": "https://stackoverflow.com/users/5946120/blaze"}, "edited": false, "score": 0, "creation_date": 1473345356, "post_id": 39381006, "comment_id": 66113612, "body": "Thank you! This worked so it does appear to be my improperly sized buffer that caused the weird result (the account name I was using was along the lines of &quot;Dave-PC\\\\Dave&quot;, which was correct)."}], "tags": [], "owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "is_accepted": true, "score": 4, "last_activity_date": 1473295889, "creation_date": 1473295889, "answer_id": 39381006, "question_id": 39366383, "link": "https://stackoverflow.com/questions/39366383/how-to-get-the-logged-on-users-sid-in-windows/39381006#39381006", "title": "How to get the logged-on user&#39;s SID in Windows", "body": "<p>Your code doesn't provide a properly-sized buffer for the SID returned by LookupAccountName().  This results in stack corruption and undefined behaviour, which <em>might</em> conceivably explain why you're not getting the SID you were expecting.  (Although I rather suspect that you're actually passing in the wrong username, or an improperly formatted username.)</p>\n\n<p>Anyway, to fix the most obvious problem, the code should look more like this:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;Sddl.h&gt;\n\n#include &lt;stdio.h&gt;\n\nint main(int argc, char ** argv)\n{\n    LPCTSTR wszAccName = TEXT(\"domainname\\\\username\");\n    LPTSTR wszDomainName = (LPTSTR)GlobalAlloc(GPTR, sizeof(TCHAR) * 1024);\n    DWORD cchDomainName = 1024;\n    SID_NAME_USE eSidType;\n    LPTSTR sidstring;\n    char sid_buffer[1024];\n    DWORD cbSid = 1024;\n    SID * sid = (SID *)sid_buffer;\n\n    if (!LookupAccountName(NULL, wszAccName, sid_buffer, &amp;cbSid, wszDomainName, &amp;cchDomainName, &amp;eSidType)) {\n        return GetLastError();\n    }\n\n    if (!ConvertSidToStringSid(sid, &amp;sidstring)) {\n        return GetLastError();\n    }\n\n    printf(\"%ws\\n\", sidstring);\n    return 0;\n\n}\n</code></pre>\n\n<p>That's still not the correct way to do it, of course; you are supposed to call LookupAccountName() twice, once to determine the buffer length and then a second time to retrieve the actual information.  But it demonstrates what you've done wrong, and is good enough for testing purposes.</p>\n"}], "owner": {"reputation": 81, "user_id": 5946120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea497ea7e70476d95caae8082df13ac?s=128&d=identicon&r=PG", "display_name": "Blaze", "link": "https://stackoverflow.com/users/5946120/blaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3557, "favorite_count": 4, "accepted_answer_id": 39381006, "answer_count": 1, "score": 5, "last_activity_date": 1473295889, "creation_date": 1473241130, "last_edit_date": 1473266370, "question_id": 39366383, "link": "https://stackoverflow.com/questions/39366383/how-to-get-the-logged-on-users-sid-in-windows", "title": "How to get the logged-on user&#39;s SID in Windows", "body": "<p>I need to get the string format SID of the logged-on user. I already have the username and am trying to use LookupAccountName to get the SID. This works partly - I do get a SID but it is only a partial match to the user's actual SID.</p>\n\n<p>I do not want the SID of the process owner as the process may be elevated (impersonating), but rather I want the SID of the user who is logged on where the process is running.</p>\n\n<p>The code needs to work with non-elevated privileges.</p>\n\n<p>This is my code so far</p>\n\n<pre><code>LPCTSTR wszAccName = TEXT(\"hardcoded username for testing\");\nLPTSTR wszDomainName = (LPTSTR)GlobalAlloc(GPTR, sizeof(TCHAR) * 1024);\nDWORD cchDomainName = 1024;\nSID_NAME_USE eSidType;\nSID sid;\nDWORD cbSid = 1024;\nif (!LookupAccountName(NULL, wszAccName, &amp;sid, &amp;cbSid, wszDomainName, &amp;cchDomainName, &amp;eSidType)) {\n    return GetLastError();\n}\n\nif (!ConvertSidToStringSid(&amp;sid, &amp;pszSidBuffer)) {\n    return GetLastError();\n}\n</code></pre>\n\n<p>This yields a SID like \"S-1-5-21-1-1234567890-9-1000\"\nBut the user's actual SID is like \"S-1-5-21-3214321539-1234567890-2233445522-1000\"\n(as per the process owner and the registry key under HKEY_USERS).\nNote how the SIDs are the same except for the 5th and 7th components, which are only 1 digit each but should be longer.</p>\n\n<p>How do I get the user's actual/complete SID?</p>\n\n<p>Also, I'm a total C/C++ newbie (and the code above is not production quality at all). And I'm using /NODEFAULTLIB in order to avoid linking VC runtimes. Sorry about that. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1473241136, "post_id": 39366352, "comment_id": 66061069, "body": "Punch &quot;file alteration monitor&quot; into your favorite search engine."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1473241234, "post_id": 39366352, "comment_id": 66061139, "body": "You can&#39;t do this in pure C. If you&#39;re on a Linux system, have a look at <code>inotify</code>."}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1473244961, "post_id": 39366352, "comment_id": 66063455, "body": "... created by what/how?"}, {"owner": {"reputation": 553, "user_id": 4830306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cIfRj.png?s=128&g=1", "display_name": "Nicolas Jean", "link": "https://stackoverflow.com/users/4830306/nicolas-jean"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1473249468, "post_id": 39366352, "comment_id": 66066453, "body": "@DavidSchwartz seems that I wasn&#39;t punching the right keywords in my favorite search engine, the results with &quot;file alteration monitor&quot; is indeed much more interesting than what I found previously, thanks for your comment!"}, {"owner": {"reputation": 553, "user_id": 4830306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cIfRj.png?s=128&g=1", "display_name": "Nicolas Jean", "link": "https://stackoverflow.com/users/4830306/nicolas-jean"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473249508, "post_id": 39366352, "comment_id": 66066488, "body": "Thank you @EOF I think this is what I was looking for"}, {"owner": {"reputation": 553, "user_id": 4830306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cIfRj.png?s=128&g=1", "display_name": "Nicolas Jean", "link": "https://stackoverflow.com/users/4830306/nicolas-jean"}, "reply_to_user": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1473249548, "post_id": 39366352, "comment_id": 66066523, "body": "@where_is_tftp : created by another thread or process, on a linux system"}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1473242989, "post_id": 39366454, "comment_id": 66062186, "body": "There are <a href=\"http://stackoverflow.com/a/3517567/364696\">APIs with similar features (but completely different names and functions) for Windows and OSX</a>."}, {"owner": {"reputation": 553, "user_id": 4830306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cIfRj.png?s=128&g=1", "display_name": "Nicolas Jean", "link": "https://stackoverflow.com/users/4830306/nicolas-jean"}, "edited": false, "score": 0, "creation_date": 1473249711, "post_id": 39366454, "comment_id": 66066633, "body": "@usr: thank you, I think this is what I was looking for. More precisely, watching the directory that will contain the file for the IN_CREATE event and then checking if the file is there should work fine!"}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1473241363, "creation_date": 1473241363, "answer_id": 39366454, "question_id": 39366352, "link": "https://stackoverflow.com/questions/39366352/how-to-wait-until-a-file-is-created-in-c/39366454#39366454", "title": "How to wait until a file is created in C", "body": "<p>You are probably looking for <a href=\"http://man7.org/linux/man-pages/man7/inotify.7.html\" rel=\"nofollow\"><code>inotify(7)</code></a>. At the botton of the man page linked, there's example showing how to monitor for various events.</p>\n"}], "owner": {"reputation": 553, "user_id": 4830306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cIfRj.png?s=128&g=1", "display_name": "Nicolas Jean", "link": "https://stackoverflow.com/users/4830306/nicolas-jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2164, "favorite_count": 1, "accepted_answer_id": 39366454, "answer_count": 1, "score": 2, "last_activity_date": 1473241363, "creation_date": 1473241054, "question_id": 39366352, "link": "https://stackoverflow.com/questions/39366352/how-to-wait-until-a-file-is-created-in-c", "title": "How to wait until a file is created in C", "body": "<p>How can I stop the execution of a thread until a file is created ?<br/>\nI would like to avoid doing it in a busy loop, and use something with a behavior similar to select(). Is something like this possible?<br/>\nI only found ways to check if a file exists at a given time.</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473243053, "post_id": 39366288, "comment_id": 66062221, "body": "Which stdio.h functions are available?"}, {"owner": {"reputation": 51, "user_id": 6804026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8ff4eb93c6d859fe673f7afd48512f2?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6804026/andre"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473243798, "post_id": 39366288, "comment_id": 66062679, "body": "I can&#39;t use it, it will increase the overhead in terms of size in the firmware"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1473243857, "post_id": 39366288, "comment_id": 66062721, "body": "You can avoid <code>sprintf</code> if you send raw bytes. BTW Are you sure data from ADC are <code>float</code>...?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473243921, "post_id": 39366288, "comment_id": 66062762, "body": "@Andre You can&#39;t use the st library at all?"}, {"owner": {"reputation": 51, "user_id": 6804026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8ff4eb93c6d859fe673f7afd48512f2?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6804026/andre"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473244112, "post_id": 39366288, "comment_id": 66062884, "body": "@2501 no, it will increase the size of the executable. and that&#39;s not needed"}, {"owner": {"reputation": 51, "user_id": 6804026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8ff4eb93c6d859fe673f7afd48512f2?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6804026/andre"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1473244147, "post_id": 39366288, "comment_id": 66062916, "body": "@LPs, how would I represent 1.5f into ASCII string, to display it over UART"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1473244213, "post_id": 39366288, "comment_id": 66062964, "body": "Are you sending data to an ASCII terminal or to a slave device? Not clear."}, {"owner": {"reputation": 51, "user_id": 6804026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8ff4eb93c6d859fe673f7afd48512f2?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6804026/andre"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1473244214, "post_id": 39366288, "comment_id": 66062965, "body": "@LPs the receiver should decode the bytes and then convert them to float, which is something that I don&#39;t need to do, because it needs modification in the other side"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1473249880, "post_id": 39366288, "comment_id": 66066749, "body": "Is the receiver an higher level device? Use a fixed-point decimal and transmit it as an integer. Simple to reconvert back to float on the other side."}, {"owner": {"reputation": 3572, "user_id": 412044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WZZOJ.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/412044/martin"}, "edited": false, "score": 0, "creation_date": 1473253164, "post_id": 39366288, "comment_id": 66069204, "body": "Can you implement your own?"}], "owner": {"reputation": 51, "user_id": 6804026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8ff4eb93c6d859fe673f7afd48512f2?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6804026/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "closed_date": 1473245072, "answer_count": 0, "score": 0, "last_activity_date": 1473242840, "creation_date": 1473240866, "last_edit_date": 1473242840, "question_id": 39366288, "link": "https://stackoverflow.com/questions/39366288/sprintf-replacement-for-embedded-systems", "closed_reason": "Duplicate", "title": "sprintf replacement for embedded systems", "body": "<p>In my current embedded system, I don't have the access to the standard library of sprintf. Is there a replacement ? </p>\n\n<p>I would like to convert a <code>float</code> to bytes and send that in the UART to be read. </p>\n\n<p>The float comes from an ADC as temperature and I would like to send \"ADC read= temperature\"</p>\n\n<p>I'm using blackfin 533 DSP.</p>\n"}, {"tags": ["c", "linux", "gtk", "gtk3"], "comments": [{"owner": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "edited": false, "score": 0, "creation_date": 1473416607, "post_id": 39366248, "comment_id": 66143113, "body": "Just responding to the bounty, I do have a hunch how to do it but I normally program GTK3 stuff in Python. So is it okay for you to use Pseudocode/python in the answer?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "edited": false, "score": 0, "creation_date": 1473417669, "post_id": 39366248, "comment_id": 66143712, "body": "I&#39;m not very familiar with Python, so I would prefer an answer in C. However, I probably would try to adapt a Python based answer -much better than nothing- to C. Notice also that all the GTK <a href=\"http://developer.gnome.org/gtk3/stable/\" rel=\"nofollow noreferrer\">reference documentation</a> is about C functions of my system&#39;s <code>libgtk-3.so.0</code>. So perhaps you might name some functions there..."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1473459919, "post_id": 39366248, "comment_id": 66166037, "body": "I&#39;ve added the way I would approach this as an &quot;answer&quot;. The key difference is that I&#39;d use a <code>GtkListStore</code> model in the <code>GtkComboBox</code> to maintain the list of copies of the matching keywords (letting Gtk+ reference-count and garbage-collect them as it sees fit), with the <code>popup</code> signal triggering list regeneration. This seems to work fine for about a thousand matches based on my crude test program (although it could just be the stupid way it creates the <code>GtkListStore</code> is the bottleneck).  I do not consider it a <i>complete</i> or <i>real</i> answer; just my starting point towards a solution."}], "answers": [{"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473486357, "post_id": 39420466, "comment_id": 66170354, "body": "Thanks. It is probably the answer I was hoping. I will probably accept in a few hours or days, when I&#39;ll code something with it. BTW, is your crude working example available somewhere as free software (e.g. on github)?"}, {"owner": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "edited": false, "score": 1, "creation_date": 1473513520, "post_id": 39420466, "comment_id": 66176666, "body": "The problem with this code is that it ignores an important comment in the documentation namely: &quot;You should not call <code>gtk_combo_box_set_model()</code> or attempt to pack more cells into this combo box via its GtkCellLayout interface.&quot; (<a href=\"https://developer.gnome.org/gtk3/stable/GtkComboBoxText.html\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/stable/GtkComboBoxText.html</a>)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "edited": false, "score": 0, "creation_date": 1473514034, "post_id": 39420466, "comment_id": 66176776, "body": "@B8vrede: you are right. But then do you have a constructive suggestion? If yes, please try to write some answer...."}, {"owner": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "edited": false, "score": 0, "creation_date": 1473514079, "post_id": 39420466, "comment_id": 66176789, "body": "I&#39;m currently writing one, that is how I found the comment ;)"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "edited": false, "score": 0, "creation_date": 1473529363, "post_id": 39420466, "comment_id": 66181147, "body": "Basile, @B8vrede: I missed that comment (apologies! -- this is why I always say I make errors; thank you for noting it), ouch. Fortunately, it is actually trivial to fix: just switch to a <code>GtkComboBox</code> instead of <code>GtkComboBoxText</code>. I shall fix my answer."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473531507, "post_id": 39420466, "comment_id": 66181771, "body": "@BasileStarynkevitch: I don&#39;t use social sites. GitHub is borderline; I will create an account when/if I feel socially functional enough. In any case, I added an explicit CC0 licensing note in the new tarballs (covers both source and the Makefile)."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473882886, "post_id": 39420466, "comment_id": 66314765, "body": "I am trying exactly your downloaded <a href=\"http://www.nominal-animal.net/answers/combo-box-example.tar.xz\" rel=\"nofollow noreferrer\">example</a>, and it does not work. The widget remains blank. I also committed my <a href=\"https://github.com/bstarynk/melt-monitor-2015/commit/635c3805cb8c42ab185a7ba79144f93a7a8edf6a\" rel=\"nofollow noreferrer\">635c3805cb8c42ab1</a> and it does not work (my GTK is 3.21.5) neither. If you prefer to contact me by email, please do (to basile at starynkevitch dot net...)"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 4, "last_activity_date": 1473531212, "last_edit_date": 1473531212, "creation_date": 1473459505, "answer_id": 39420466, "question_id": 39366248, "link": "https://stackoverflow.com/questions/39366248/customizing-completion-of-gtkcomboboxtext/39420466#39420466", "title": "customizing completion of GtkComboBoxText", "body": "<p>Here is my suggestion:</p>\n\n<p>Use a <a href=\"https://developer.gnome.org/gtk3/stable/GtkListStore.html\" rel=\"nofollow\">GtkListStore</a> to contain a list of GTK-managed strings (essentially, copies of your identifier string) that match the current prefix string. </p>\n\n<p>(As documented for <a href=\"https://developer.gnome.org/gtk3/stable/GtkListStore.html#gtk-list-store-set\" rel=\"nofollow\"><code>gtk_list_store_set()</code></a>, a <code>G_TYPE_STRING</code> item is copied. I consider the overhead of the extra copy acceptable here; it should not affect real-world performance much anyway, I think, and in return, GTK+ will manage the reference counting for us.)</p>\n\n<p>The above is implemented in a GTK+ callback function, which gets an extra pointer as payload (set at the time the GUI is created or activated; I suggest you use some structure to keep references you need to generate the matches). The callback is connected to the combobox <code>popup</code> signal, so that it gets called whenever the list is expanded.</p>\n\n<p>Note that as B8vrede noted in a comment, a <code>GtkComboBoxText</code> should not be modified via its model; that is why one should/must use a <code>GtkComboBox</code> instead.</p>\n\n<p><strong>Practical example</strong></p>\n\n<p>For simplicity, let's assume all the data you need to find or generate all known identifiers matched against is held in a structure, say</p>\n\n<pre><code>struct generator {\n    /* Whatever data you need to generate prefix matches */\n};\n</code></pre>\n\n<p>and the combo box populator helper function is then something like</p>\n\n<pre><code>static void combo_box_populator(GtkComboBox *combobox, gpointer genptr)\n{\n    struct generator *const generator = genptr;\n\n    GtkListStore *combo_list = GTK_LIST_STORE(gtk_combo_box_get_model(combobox));\n\n    GtkWidget *entry = gtk_bin_get_child(GTK_BIN(combobox));\n    const char *prefix = gtk_entry_get_text(GTK_ENTRY(entry));\n    const size_t prefix_len = (prefix) ? strlen(prefix) : 0;\n\n    GtkTreeIter iterator;\n\n    /* Clear the current store */\n    gtk_list_store_clear(combo_list);\n\n    /* Initialize the list iterator */\n    gtk_tree_model_get_iter_first(GTK_TREE_MODEL(combo_list), &amp;iterator);\n\n    /* Find all you want to have in the combo box;\n       for each  const char *match, do:\n    */\n\n        gtk_list_store_append(combo_list, &amp;iterator);\n        gtk_list_store_set(combo_list, &amp;iterator, 0, match, -1);\n\n    /* Note that the string pointed to by match is copied;\n       match is not referred to after the _set() returns.\n    */\n}\n</code></pre>\n\n<p>When the UI is built or activated, you need to ensure the <code>GtkComboBox</code> has an entry (so the user can write text into it), and a <code>GtkListStore</code> model:</p>\n\n<pre><code>    struct generator *generator;\n    GtkWidget *combobox;\n    GtkListStore *combo_list;\n\n    combo_list = gtk_list_store_new(1, G_TYPE_STRING);\n    combobox = gtk_combo_box_new_with_model_and_entry(GTK_TREE_MODEL(combo_list));\n    gtk_combo_box_set_id_column(GTK_COMBO_BOX(combobox), 0);\n    gtk_combo_box_set_entry_text_column(GTK_COMBO_BOX(combobox), 0);\n    gtk_combo_box_set_button_sensitivity(GTK_COMBO_BOX(combobox), GTK_SENSITIVITY_ON);\n\n    g_signal_connect(combobox, \"popup\", G_CALLBACK(combo_box_populator), generator);\n</code></pre>\n\n<p>On my system, the default pop-up accelerator is <kbd>Alt</kbd>+<kbd>Down</kbd>, but I assume you've already changed that to <kbd>Tab</kbd>.</p>\n\n<p>I have a crude working example <a href=\"http://www.nominal-animal.net/answers/combo-box-example.tar.xz\" rel=\"nofollow\">here</a> (a <code>.tar.xz</code> tarball, <a href=\"https://creativecommons.org/publicdomain/zero/1.0/\" rel=\"nofollow\">CC0</a>): it reads lines from standard input, and lists the ones matching the user prefix in reverse order in the combo box list (when popped-up). If the entry is empty, the combobox will contain all input lines. I didn't change the default accelerators, so instead of <kbd>Tab</kbd>, try <kbd>Alt+Down</kbd>.</p>\n\n<p>I also have the same example, but using <code>GtkComboBoxText</code> instead, <a href=\"http://www.nominal-animal.net/answers/combo-box-text-example.tar.xz\" rel=\"nofollow\">here</a> (also <a href=\"https://creativecommons.org/publicdomain/zero/1.0/\" rel=\"nofollow\">CC0</a>). This does not use a <code>GtkListStore</code> model, but uses <a href=\"https://developer.gnome.org/gtk3/stable/GtkComboBoxText.html#gtk-combo-box-text-remove-all\" rel=\"nofollow\"><code>gtk_combo_box_text_remove_all()</code></a> and <a href=\"https://developer.gnome.org/gtk3/stable/GtkComboBoxText.html#gtk-combo-box-text-append-text\" rel=\"nofollow\"><code>gtk_combo_box_text_append_text()</code></a> functions to manipulate the list contents directly. (There is just a few different lines in the two examples.) Unfortunately, the documentation is not explicit whether this interface references or copies the strings. Although copying is the only option that makes sense, and this can be verified from the current Gtk+ sources, the lack of explicit documentation makes me hesitant.</p>\n\n<p>Comparing the two examples I linked to above (both grab some 500 random words from <code>/usr/share/dict/words</code> if you compile and run it with <code>make</code>), I don't see any speed difference. Both use the same na\u00efve way of picking prefix matches from a linked list, which means the two methods (<code>GtkComboBox</code> + model, or <code>GtkComboBoxText</code>) should be about equally fast.</p>\n\n<p>On my own machine, both get annoyingly slow with more than 1000 or so matches in the popup; with just a hundred or less matches, it feels instantaneous. This, to me, indicates that the slow/na\u00efve way of picking prefix matches from a linked list is not the culprit (because the entire list is traversed in both cases), but that the GTK+ combo boxes are just not designed for large lists. (The slowdown is definitely much, much worse than linear.)</p>\n"}, {"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1473532411, "post_id": 39426800, "comment_id": 66182061, "body": "Other than adding the inline completion (in addition to the popup completion), are there any reasons to use a <code>GtkEntryCompletion</code> and <code>GtkComboBoxText</code> rather than a <code>GtkComboBox</code>? Only <code>GtkComboBoxText</code> has the don&#39;t-mess-with-the-model restriction."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473883133, "post_id": 39426800, "comment_id": 66314883, "body": "Do you have some Python code to share with us? And what exact GTK3 version?"}, {"owner": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1473923043, "post_id": 39426800, "comment_id": 66326702, "body": "@NominalAnimal Sorry missed your comment, the advantage is mainly the inline completion. Which for a user experience perspective makes more sense then a combo box. But I guess your answer is closer to OP&#39;s request now that you solve the issue with the restriction."}, {"owner": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1473924483, "post_id": 39426800, "comment_id": 66327405, "body": "@BasileStarynkevitch Added a demo with a lot of comments :)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1473968770, "post_id": 39426800, "comment_id": 66354066, "body": "It probably could be the right answer (because sadly @NominalAnimal&#39;s <a href=\"http://stackoverflow.com/a/39420466/841108\">answer</a> and demo leave a blank window on my system)."}], "tags": [], "owner": {"reputation": 3724, "user_id": 2263652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eX05O.jpg?s=128&g=1", "display_name": "B8vrede", "link": "https://stackoverflow.com/users/2263652/b8vrede"}, "is_accepted": false, "score": 5, "last_activity_date": 1473924429, "last_edit_date": 1473924429, "creation_date": 1473516008, "answer_id": 39426800, "question_id": 39366248, "link": "https://stackoverflow.com/questions/39366248/customizing-completion-of-gtkcomboboxtext/39426800#39426800", "title": "customizing completion of GtkComboBoxText", "body": "<p>I will not show exact code on how to do it because I never did GTK &amp; C only GTK &amp; Python, but it should be fine as the functions in C and Python functions can easily be translated.</p>\n\n<p>OP's approach is actually the right one, so I will try to fill in the gaps. As the amount of static options is limited probably won't change to much it indeed makes sense to add them using <code>gtk_combo_box_text_append</code> which will add them to the internal model of the <code>GtkComboBoxText</code>. </p>\n\n<p>Thats covers the static part, for the dynamic part it would be perfect if we could just store this static model and replace it with a temporay model using <code>gtk_combo_box_set_model()</code> when a <code>_</code> was found at the start of the string. But we shouldn't do this as the documentation says:</p>\n\n<blockquote>\n  <p>You should not call gtk_combo_box_set_model() or attempt to pack more cells into this combo box via its GtkCellLayout interface.</p>\n</blockquote>\n\n<p>So we need to work around this, one way of doing this is by adding a <code>GtkEntryCompletion</code> to the entry of the <code>GtkComboBoxText</code>. This will make the entry attempt to complete the current string based on its current model. As an added bonus it can also add all the character all options have in common like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w6kxQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w6kxQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>As we don't want to load all the dynamic options before hand I think the best approach will be to connect a <code>changed</code> listener to the <code>GtkEntry</code>, this way we can load the dynamic options when we have a underscore and some characters. </p>\n\n<p>As the <code>GtkEntryCompletion</code> uses a <code>GtkListStore</code> internally, we can <strong>reuse part of the code Nominal Animal provided in his answer</strong>. The main difference being: the <code>connect</code> is done on the <code>GtkEntry</code> and the replacing of <code>GtkComboText</code> with <code>GtkEntryCompletion</code> inside the populator. Then everything should be fine, I wish I would be able to write decent C then I would have provided you with code but this will have to do.</p>\n\n<p><strong>Edit:</strong> A small demo in Python with GTK3</p>\n\n<pre><code>import gi\n\ngi.require_version('Gtk', '3.0')\n\nimport gi.repository.Gtk as Gtk\n\nclass CompletingComboBoxText(Gtk.ComboBoxText):\n    def __init__(self, static_options, populator, **kwargs):\n        # Set up the ComboBox with the Entry\n        Gtk.ComboBoxText.__init__(self, has_entry=True, **kwargs)\n\n        # Store the populator reference in the object\n        self.populator = populator\n\n        # Create the completion\n        completion = Gtk.EntryCompletion(inline_completion=True)\n\n        # Specify that we want to use the first col of the model for completion\n        completion.set_text_column(0)\n        completion.set_minimum_key_length(2)\n\n        # Set the completion model to the combobox model such that we can also autocomplete these options\n        self.static_options_model = self.get_model()\n        completion.set_model(self.static_options_model)\n\n        # The child of the combobox is the entry if 'has_entry' was set to True\n        entry = self.get_child()\n        entry.set_completion(completion)\n\n        # Set the active option of the combobox to 0 (which is an empty field)\n        self.set_active(0)\n\n        # Fill the model with the static options (could also be used for a history or something)\n        for option in static_options:\n            self.append_text(option)\n\n        # Connect a listener to adjust the model when the user types something\n        entry.connect(\"changed\", self.update_completion, True)\n\n\n    def update_completion(self, entry, editable):\n        # Get the current content of the entry\n        text = entry.get_text()\n\n        # Get the completion which needs to be updated\n        completion = entry.get_completion()\n\n        if text.startswith(\"_\") and len(text) &gt;= completion.get_minimum_key_length():\n            # Fetch the options from the populator for a given text\n            completion_options = self.populator(text)\n\n            # Create a temporary model for the completion and fill it\n            dynamic_model = Gtk.ListStore.new([str])\n            for completion_option in completion_options:\n                dynamic_model.append([completion_option])\n            completion.set_model(dynamic_model)\n        else:\n            # Restore the default static options\n            completion.set_model(self.static_options_model)\n\n\ndef demo():\n    # Create the window\n    window = Gtk.Window()\n\n    # Add some static options\n    fake_static_options = [\n        \"comment\",\n        \"if\",\n        \"the_GUI\",\n        \"the_system\",\n        \"payload_json\",\n        \"x1\",\n        \"payload_json\",\n        \"payload_vectval\"\n    ]\n\n    # Add the the Combobox\n    ccb = CompletingComboBoxText(fake_static_options, dynamic_option_populator)\n    window.add(ccb)\n\n    # Show it\n    window.show_all()\n    Gtk.main()\n\n\ndef dynamic_option_populator(text):\n    # Some fake returns for the populator\n    fake_dynamic_options = [\n        \"_5Hf0fFKvRVa71ZPM0\",\n        \"_8261sbF1f9ohzu2Iu\",\n        \"_0BV96V94PJIn9si1K\",\n        \"_0BV1sbF1f9ohzu2Iu\",\n        \"_0BV0fFKvRVa71ZPM0\",\n        \"_0Hf0fF4PJIn9si1Ks\",\n        \"_6KvRVa71JIn9si1Kw\",\n        \"_5HKvRVa71Va71ZPM0\",\n        \"_8261sbF1KvRVa71ZP\",\n        \"_0BKvRVa71JIn9si1K\",\n        \"_0BV1KvRVa71ZPu2Iu\",\n        \"_0BV0fKvRVa71ZZPM0\",\n        \"_0Hf0fF4PJIbF1f9oh\",\n        \"_61sbFV0fFKn9si1Kw\",\n        \"_5Hf0fFKvRVa71ozu2\",\n    ]\n\n    # Only return those that start with the text\n    return [fake_dynamic_option for fake_dynamic_option in fake_dynamic_options if fake_dynamic_option.startswith(text)]\n\n\nif __name__ == '__main__':\n    demo()\n    Gtk.main()\n</code></pre>\n"}], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1661, "favorite_count": 0, "accepted_answer_id": 39420466, "answer_count": 2, "score": 11, "last_activity_date": 1473924429, "creation_date": 1473240763, "last_edit_date": 1473264347, "question_id": 39366248, "link": "https://stackoverflow.com/questions/39366248/customizing-completion-of-gtkcomboboxtext", "title": "customizing completion of GtkComboBoxText", "body": "<p>How can I customize the completion of a <a href=\"https://developer.gnome.org/gtk3/stable/GtkComboBoxText.html\" rel=\"noreferrer\"><code>GtkComboBoxText</code></a> with both a \"static\" aspect and a \"dynamic\" one? The static aspect is because some entries are known and added to the combo-box-text at construction time with <code>gtk_combo_box_text_append_text</code>. The dynamic aspect is because I also need to complete thru some callback function(s), that is to complete <em>dynamically</em> -after creation of the <code>GtkComboBoxText</code> widget- once several characters has been typed. </p>\n\n<p>My application uses Boehm's GC (except for GTK objects of course) like Guile or SCM or Bigloo are doing. It can be seen as an experimental <em>persistent</em> dynamic-typed programming language implementation with an integrated editor coded on and for Debian/Linux/x86-64 with the system GTK3.21 library, it is coded in C99 (some of which is generated) and is compiled with GCC6. </p>\n\n<p><sup>(I don't care about non-Linux systems, GTK3 libraries older than GTK3.20, GCC compiler older that GCC6)</sup></p>\n\n<h3>question details</h3>\n\n<p>I'm entering (inputting into the <code>GtkComboBoxText</code>) either a <em>name</em>, or an <em>object-id</em>.</p>\n\n<ul>\n<li><p>The <em>name</em> is C-identifier-like but starts with a letter and cannot end with an underscore. For example, <code>comment</code>, <code>if</code>, <code>the_GUI</code>, <code>the_system</code>, <code>payload_json</code>, or <code>x1</code> are valid names (but <strike><code>_a0bcd</code></strike> or <strike><code>foobar_</code></strike> are invalid names, because they start or end with an underscore). I currently have a big dozen of names, but I could have a few thousands of them. So it would be reasonable to offer a completion once only a single or perhaps two letters has been typed, and completion for names can happen statically because they are not many of them (so I feel reasonable to call <code>gtk_combo_box_append_text</code> for each name).</p></li>\n<li><p>The <em>object-id</em> starts with an underscore followed by a digit and has exactly 18 alphanumeric (sort-of random) characters. For example, <code>_5Hf0fFKvRVa71ZPM0</code>, <code>_8261sbF1f9ohzu2Iu</code>, <code>_0BV96V94PJIn9si1K</code> are possible object-ids. Actually it is 96 almost random bits (probably only 2<sup>94</sup> are possible). The object-id plays the role of <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"noreferrer\">UUID</a>s (in the sense that it is assumed to be world-wide unique for distinct objects) but has a C friendly syntax. I currently have a few dozen of objects-ids, but I could have a few hundred of thousands (or maybe a million) of them. But given a prefix of four characters like <code>_6S3</code> or <code>_22z</code>, I am assuming that only a reasonable number (probably at most a dozen, and surely no more than a thousand) <em>object-ids</em> exist in my application with that prefix. Of course it would be unreasonable to register (statically) <em>a priori</em> all the object ids (the completion has to happen after four characters have been typed, and should happen dynamically).</p></li>\n</ul>\n\n<p>So I want a completion that works both on names (e.g. typing one letter perhaps followed by another alphanum character should be enough to propose a completion of at most a hundred choices), and on object-ids (typing four characters like <code>_826</code> should be enough to trigger a completion of probably at most a few dozen choices, perhaps a thousand ones if unlucky). </p>\n\n<p>Hence typing the three keys <kbd>p</kbd> <kbd>a</kbd> <kbd>tab</kbd> would offer completion with a few names like <code>payload_json</code> or <code>payload_vectval</code> etc... and typing the five keys <kbd>_</kbd> <kbd>5</kbd> <kbd>H</kbd> <kbd>f</kbd> <kbd>tab</kbd> would offer completion with very few object-ids, notably <code>_5Hf0fFKvRVa71ZPM0</code></p>\n\n<h3>sample <em>incomplete</em> code</h3>\n\n<p>So far I coded the following:</p>\n\n<pre><code>static GtkWidget *\nmom_objectentry (void)\n{\n  GtkWidget *obent = gtk_combo_box_text_new_with_entry ();\n  gtk_widget_set_size_request (obent, 30, 10);\n  mo_value_t namsetv = mo_named_objects_set ();\n</code></pre>\n\n<p>I have Boehm-garbage-collected values, and <code>mo_value_t</code> is a pointer to any of them. Values can be tagged integers, pointers to strings, objects, or tuples or sets of objects. So <code>namesetv</code> now contains the set of named objects (probably less than a few thousand of named objects).</p>\n\n<pre><code>  int nbnam = mo_set_size (namsetv);\n  MOM_ASSERTPRINTF (nbnam &gt; 0, \"bad nbnam\");\n  mo_value_t *namarr = mom_gc_alloc (nbnam * sizeof (mo_value_t));\n  int cntnam = 0;\n  for (int ix = 0; ix &lt; nbnam; ix++)\n    {\n      mo_objref_t curobr = mo_set_nth (namsetv, ix);\n      mo_value_t curnamv = mo_objref_namev (curobr);\n      if (mo_dyncast_string (curnamv))\n        namarr[cntnam++] = curnamv;\n    }\n  qsort (namarr, cntnam, sizeof (mo_value_t), mom_obname_cmp);\n  for (int ix = 0; ix &lt; cntnam; ix++)\n    gtk_combo_box_text_append_text (GTK_COMBO_BOX_TEXT (obent),\n                    mo_string_cstr (namarr[ix]));\n</code></pre>\n\n<p>at this point I have sorted all the (few thousands at most)  names and added \"statically\" them using <code>gtk_combo_box_text_append_text</code>.</p>\n\n<pre><code>  GtkWidget *combtextent = gtk_bin_get_child (GTK_BIN (obent));\n  MOM_ASSERTPRINTF (GTK_IS_ENTRY (combtextent), \"bad combtextent\");\n  MOM_ASSERTPRINTF (gtk_entry_get_completion (GTK_ENTRY (combtextent)) ==\n                    NULL, \"got completion in combtextent\");\n</code></pre>\n\n<p>I noticed with a bit of surprise that <code>gtk_entry_get_completion (GTK_ENTRY (combtextent))</code> is null. </p>\n\n<p>But I am stuck here. I am thinking of:</p>\n\n<ol>\n<li><p>Having some <code>mom_set_complete_objectid(const char*prefix)</code> which given a <code>prefix</code> like <code>\"_47n\"</code> of at least four characters would return a garbage collected <code>mo_value_t</code> representing the set of objects with that prefix. This is very easy to code for me, and is nearly done.</p></li>\n<li><p>Make my own local <code>GtkEntryCompletion* mycompl =</code> ..., which would complete like I want. Then I would put it in the text entry <code>combtextent</code> of my <em>gtk-combo-box-text</em> using <code>gtk_entry_set_completion(GTK_ENTRY(combtextent), mycompl);</code></p></li>\n</ol>\n\n<p>Should it use the entries added with <code>gtk_combo_box_text_append_text</code> for the \"static\" name completion role? How should I dynamically complete using the dynamic set value returned from my <code>mom_set_complete_objectid</code>; given some object-pointer <code>obr</code> and some <code>char bufid[20];</code> I am easily and quickly able to fill it with the object-id of that object <code>obr</code> with <code>mo_cstring_from_hi_lo_ids(bufid, obr-&gt;mo_ob_hid, obr-&gt;mo_ob_loid)</code>..</p>\n\n<p>I don't know how to code the above. For reference, I am now just returning the combo-box-text:</p>\n\n<pre><code>  // if the entered text starts with a letter, I want it to be\n  // completed with the appended text above if the entered text starts\n  // with an undersore, then a digit, then two alphanum (like _0BV or\n  // _6S3 for example), I want to call a completion function.\n#warning objectentry: what should I code here?\n  return obent;\n}  /* end mom_objectentry */\n</code></pre>\n\n<p>Is my approach the right one?</p>\n\n<p>The <code>mom_objectentry</code> function above is used to fill modal dialogs with short lifetime.</p>\n\n<p>I am favoring simple code over efficiency. Actually, my code is temporary (I'm hoping to bootstrap my language, and generate all its C code!) and in practice I'll probably have only a few hundred names and at most a few dozen of thousands of object-ids. So performance is not very important, but simplicity of coding (some conceptually \"throw away\" code) is more important.</p>\n\n<p>I don't want (if possible) to add my own GTK classes. I prefer using existing GTK classes and widgets, customizing them with GTK signals and callbacks.</p>\n\n<h3>context</h3>\n\n<p>My application is an experimental <a href=\"https://en.wikipedia.org/wiki/Persistence_%28computer_science%29\" rel=\"noreferrer\"><strong>persistent</strong></a> programming language and implementation with a near Scheme or Python (or JavaScript, ignoring the prototype aspect, ...) <em>semantics</em> but with a widely different (not yet implemented in september 7<sup>th</sup>, 2016) syntax (to be shown &amp; input in GTK widgets), using the Boehm garbage collector for values (including objects, sets, tuples, strings...)... Values (including objects) are generally persistent (except the GTK related data : the application starts with a nearly empty window). The entire language heap is persisted in JSON-like syntax in some Sqlite \"database\" (generated at application exit) dumped into <a href=\"https://github.com/bstarynk/melt-monitor-2015/blob/e2b3b99ef663947201df7b389a02230c6b82dcf6/_momstate.sql\" rel=\"noreferrer\"><code>_momstate.sql</code></a> which is re-loaded at application startup. Object-ids are useful to show object references to the user in GTK widgets, for persistence, and to generate C code related to the objects (e.g. the object of id <code>_76f7e2VcL8IJC1hq6</code> could be related to a <code>mo_76f7e2VcL8IJC1hq6</code> identifier in some generated C code; this is partly why I have my object-id format instead of using UUIDs).</p>\n\n<p>PS. My C code is GPLv3 free software and available on github. It is the MELT monitor, branch <a href=\"https://github.com/bstarynk/melt-monitor-2015/tree/expjs\" rel=\"noreferrer\">expjs</a>, commit <a href=\"https://github.com/bstarynk/melt-monitor-2015/commit/e2b3b99ef663947201df7b389a02230c6b82dcf6\" rel=\"noreferrer\">e2b3b99ef66394...</a></p>\n\n<p><sup>NB: The objects mentioned here are implicitly my language objects, not GTK objects. The all have a unique object-id, and some but not most of them are named.</sup></p>\n"}, {"tags": ["c", "parsing", "bnf", "mpc"], "comments": [{"owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1483608064, "post_id": 39364747, "comment_id": 70167521, "body": "So, you provide MPC with a grammar and it parses.  But it appears to have a lot of runtime overhead.  Why are you using this, rather than a more conventional parser generator (e.g., &quot;yacc&quot;) where you give it a grammar, and it parses, without all that overhead?  Even if you need it at runtime, you can always shell out to a make script that runs the parser generator for you."}, {"owner": {"reputation": 51, "user_id": 3212180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b0eada5f990a0764c395208328bdbc?s=128&d=identicon&r=PG&f=1", "display_name": "GodTaxist", "link": "https://stackoverflow.com/users/3212180/godtaxist"}, "reply_to_user": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1483627023, "post_id": 39364747, "comment_id": 70180603, "body": "<a href=\"http://buildyourownlisp.com/\" rel=\"nofollow noreferrer\">buildyourownlisp.com</a> this was the reason, moreover it&#39;s very easy to use compared to yacc or antlr"}, {"owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1483630283, "post_id": 39364747, "comment_id": 70182906, "body": "Why does &quot;building LISP with C&quot; require you to use a runtime configurable parser? Lisp syntax is <i>simple</i> and <i>static</i>, and especially at the level you are talking about here, could be coded directly in C in about 2 hours.  You&#39;re just adding a peculiar parser to your process.    &quot;Easy compared to ANTLR?&quot;  How so?    I don&#39;t buy your argument.  Is this based on long experience with MPC, ANTLR and YACC?"}, {"owner": {"reputation": 51, "user_id": 3212180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b0eada5f990a0764c395208328bdbc?s=128&d=identicon&r=PG&f=1", "display_name": "GodTaxist", "link": "https://stackoverflow.com/users/3212180/godtaxist"}, "reply_to_user": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1483634308, "post_id": 39364747, "comment_id": 70185873, "body": "Is there a real point in your comments or are you just trying to start a useless flame war?"}, {"owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1483635124, "post_id": 39364747, "comment_id": 70186404, "body": "Believe it or not, I think I&#39;m trying to help.  I have a LOT of experience with parsers and parser generators.    I just don&#39;t see the point of MPC or how it really provides you with any help over the many other available approaches.  With that, I&#39;ll shut up."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3212180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b0eada5f990a0764c395208328bdbc?s=128&d=identicon&r=PG&f=1", "display_name": "GodTaxist", "link": "https://stackoverflow.com/users/3212180/godtaxist"}, "edited": false, "score": 0, "creation_date": 1483606504, "post_id": 41475249, "comment_id": 70166646, "body": "I moved forward part of the variable definition and it started to work"}], "tags": [], "owner": {"reputation": 103, "user_id": 5024960, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sCPCGr5J0HE/AAAAAAAAAAI/AAAAAAAAAqE/FWBe6QzXmD8/photo.jpg?sz=128", "display_name": "Dustin Gulley", "link": "https://stackoverflow.com/users/5024960/dustin-gulley"}, "is_accepted": false, "score": 0, "last_activity_date": 1483574828, "last_edit_date": 1483574828, "creation_date": 1483574490, "answer_id": 41475249, "question_id": 39364747, "link": "https://stackoverflow.com/questions/39364747/parsing-with-mpc-library-returns-error-on-grammar-definition/41475249#41475249", "title": "Parsing with MPC library returns error on grammar definition", "body": "<p>I'm not an expert on mpc and I may be wrong, in fact I'm having my own problems with it at the moment, but I don't think it supports left recursion.  So since expr is contained within the expr rule it causes an error.</p>\n\n<p>Edit* I was able to solve my issue by moving part of my expansion over.  So the equivalent for yours would be to move variable all the way to the right so it tries to parse using the other two expansions first.  I can't say for sure if that's causing your issue, but it could be worth a shot.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 3212180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b0eada5f990a0764c395208328bdbc?s=128&d=identicon&r=PG&f=1", "display_name": "GodTaxist", "link": "https://stackoverflow.com/users/3212180/godtaxist"}, "is_accepted": true, "score": 0, "last_activity_date": 1483606409, "creation_date": 1483606409, "answer_id": 41480685, "question_id": 39364747, "link": "https://stackoverflow.com/questions/39364747/parsing-with-mpc-library-returns-error-on-grammar-definition/41480685#41480685", "title": "Parsing with MPC library returns error on grammar definition", "body": "<p>I had my question answered from the author of mpc <a href=\"https://github.com/orangeduck/BuildYourOwnLisp/issues/109\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<p>I simply changed the part of rule definition from</p>\n\n<pre><code>\" expr         : &lt;variable&gt; | &lt;remind&gt; &lt;variable&gt; '}' | &lt;variable&gt; &lt;assign&gt; &lt;expr&gt;+ '}' ;\"\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>\" expr         : &lt;remind&gt; &lt;variable&gt; '}' |  &lt;variable&gt; &lt;assign&gt; &lt;expr&gt;+ '}' | &lt;variable&gt;;\"\n</code></pre>\n\n<p>it was happening because there's no backtracking in mpc, so the evaluation rule order is important</p>\n"}], "owner": {"reputation": 51, "user_id": 3212180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b0eada5f990a0764c395208328bdbc?s=128&d=identicon&r=PG&f=1", "display_name": "GodTaxist", "link": "https://stackoverflow.com/users/3212180/godtaxist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 41480685, "answer_count": 2, "score": 0, "last_activity_date": 1483606409, "creation_date": 1473236531, "last_edit_date": 1473239408, "question_id": 39364747, "link": "https://stackoverflow.com/questions/39364747/parsing-with-mpc-library-returns-error-on-grammar-definition", "title": "Parsing with MPC library returns error on grammar definition", "body": "<p>I'm trying to use MPC to define a grammar for a language called Wittgen (<a href=\"https://esolangs.org/wiki/Wittgen\" rel=\"nofollow\">https://esolangs.org/wiki/Wittgen</a>)</p>\n\n<p>I defined the following grammar:</p>\n\n<pre><code>mpc_parser_t* Variable        = mpc_new(\"variable\");\nmpc_parser_t* Assign_Operator = mpc_new(\"assign\");\nmpc_parser_t* Remind_Operator = mpc_new(\"remind\");\nmpc_parser_t* Expr            = mpc_new(\"expr\");\nmpc_parser_t* Envinronment    = mpc_new(\"envinronment\");\n\nmpca_lang(MPCA_LANG_DEFAULT,\n  \" variable     : /[a-zA-Z0-9]+/ ;\"                                                     \n  \" assign       : '=' ;\"                                         \n  \" remind       : '@' ;\"                                                                \n  \" expr         : &lt;variable&gt; | &lt;remind&gt; &lt;variable&gt; '}' | &lt;variable&gt; &lt;assign&gt; &lt;expr&gt;+ '}' ;\"\n  \" envinronment : /^/&lt;expr&gt;+/$/ ;\",\n  Variable, Assign_Operator, Remind_Operator, Expr, Envinronment);\n</code></pre>\n\n<p>when I try to input a variable or a remind operator (like \"foo247\" or \"@foo247}\") it parses it correctly,\nbut when I try to parse an assignment (\"foo247=foo}\"), it returns me just</p>\n\n<pre><code>WITTGEN&gt; foo357=foo}\n&lt;stdin&gt;:1:7: error: expected one of 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ', one or more of one of 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ', '@' or end of input at '='\n</code></pre>\n\n<p>I can't find the error, I'm sure something is wrong defined in the grammar, but I can't find any clue in the official documentation or in the examples</p>\n"}, {"tags": ["c", "string", "csv", "parsing", "token"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1473235129, "post_id": 39364170, "comment_id": 66057358, "body": "A couple of minutes stepping through the code in a debugger would probably have been very enlightening. Please learn how to use a debugger, and simple problems like this could be solved very quickly."}], "answers": [{"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": true, "score": 3, "last_activity_date": 1473235016, "creation_date": 1473235016, "answer_id": 39364273, "question_id": 39364170, "link": "https://stackoverflow.com/questions/39364170/parsing-csv-file-by-splitting-with-strsep/39364273#39364273", "title": "Parsing CSV file by splitting with strsep", "body": "<p>It is because you are creating elements by using every characters in the token returned by <code>strsep()</code> as start via the loop</p>\n\n<pre><code>for (idx=token; *idx; idx++) {\n        data[i][j] = atoi(idx);\n        j++;\n}\n</code></pre>\n\n<p>Stop doing that and create just one element from one token to correct:</p>\n\n<pre><code>while((token = strsep(&amp;tmp, \",\"))) {\n\n        data[i][j] = atoi(token);\n        j++;\n}\n</code></pre>\n\n<p>Also <code>free(tmp);</code> will do nothing because <code>tmp</code> will be set to <code>NULL</code> by <code>strsep()</code>. To free the buffer allocated via <code>strdup()</code>, keep the pointer in another variable and use it for freeing.</p>\n"}], "owner": {"reputation": 65, "user_id": 4194025, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc01dd84522c18eab1a697345f04a073?s=128&d=identicon&r=PG&f=1", "display_name": "noobatrilla", "link": "https://stackoverflow.com/users/4194025/noobatrilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 39364273, "answer_count": 1, "score": 1, "last_activity_date": 1473235016, "creation_date": 1473234682, "question_id": 39364170, "link": "https://stackoverflow.com/questions/39364170/parsing-csv-file-by-splitting-with-strsep", "title": "Parsing CSV file by splitting with strsep", "body": "<p>I'm getting some unwanted output when attempting to parse a comma seperated value file with strsep(). It seems be be working for half of the file, with a number with only one value (ie. 0-9), but as soon as multiple values are added like for instance 512, </p>\n\n<p>It will print 512 12 2 512 12 2 and so on. I'm not exactly sure if this is due to the particular style that I'm looping? Not really sure. </p>\n\n<pre><code>int main() {\n\n        char line[1024];\n\n        FILE *fp;\n\n        int data[10][10];\n\n        int i = 0;\n        int j = 0;\n\n        fp = fopen(\"file.csv\", \"r\");\n\n        while(fgets(line, 1024, fp)) {\n\n                char* tmp = strdup(line);\n                char* token;\n                char* idx;\n\n                while((token = strsep(&amp;tmp, \",\"))) {\n\n                        for (idx=token; *idx; idx++) {\n                                data[i][j] = atoi(idx);\n                                j++;\n                        }\n                }\n                i++;\n                j=0;\n\n                free(tmp);\n\n        }\n\n\n         for(i = 0; i &lt; 10; i++) {\n\n                for(j = 0; j &lt; 10; j++) {\n                printf(\"%d \", data[i][j]);\n                }\n                printf(\"\\n\");\n        }\n\n        fclose(fp);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "x11", "xlib", "xcb"], "answers": [{"comments": [{"owner": {"reputation": 15836, "user_id": 1675492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HsMph.jpg?s=128&g=1", "display_name": "Ingo B&#252;rk", "link": "https://stackoverflow.com/users/1675492/ingo-b%c3%bcrk"}, "edited": false, "score": 1, "creation_date": 1473263954, "post_id": 39364590, "comment_id": 66077071, "body": "On a side note, last time I checked the XI2 extensions in xcb were pretty much unusable in the released versions. Perhaps this changed by now, though."}], "tags": [], "owner": {"reputation": 3489, "user_id": 1350184, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EQnef.jpg?s=128&g=1", "display_name": "tversteeg", "link": "https://stackoverflow.com/users/1350184/tversteeg"}, "is_accepted": true, "score": 4, "last_activity_date": 1473236040, "creation_date": 1473236040, "answer_id": 39364590, "question_id": 39363761, "link": "https://stackoverflow.com/questions/39363761/convert-from-xlib-to-xcb/39364590#39364590", "title": "Convert from Xlib to xcb", "body": "<p>You basically have 2 options:</p>\n\n<h2>Option 1</h2>\n\n<p>Call the regular <code>XI*</code> Xinput2 functions and poll them in your event loop with a generic event. A event loop would probably look like similar to this:</p>\n\n<pre><code>xcb_generic_event_t *event;\nwhile ((event = xcb_wait_for_event(connection))) {\n    xcb_ge_generic_event_t *generic_event = (xcb_ge_generic_event_t*)event;\n    if (generic_event-&gt;response_type == XCB_GE_GENERIC &amp;&amp; generic_event-&gt;extension == xinput_ext_opcode &amp;&amp; generic_event-&gt;event_type == XI_RawMotion) {\n        // Handle motion\n        continue;\n    }\n}\n</code></pre>\n\n<p>Also take a look at the <a href=\"https://xcb.freedesktop.org/ProtocolExtensionApi/\" rel=\"nofollow\">XCB Protocol Extension API</a>.</p>\n\n<h2>Option 2</h2>\n\n<p>You can use the <code>xcb_input_*</code> xcb-xinput extension functions. According to the <a href=\"https://www.x.org/wiki/guide/xlib-and-xcb/#index4h2\" rel=\"nofollow\">official documentation</a>: </p>\n\n<blockquote>\n  <p>When XCB added its API style to the mix, it followed the newer style and created a \"libxcb\"-prefixed library for each extension---libxcb-composite, libxcb-render, etc. Since XCB can generates the API code for an extension automatically from an XML description of the extension protocol, new extension API's are created by simply adding the extension description to the xcb-proto package and rebuilding.</p>\n</blockquote>\n\n<p>Take a look at the <a href=\"https://xcb.freedesktop.org/manual/xinput_8h_source.html\" rel=\"nofollow\"><code>xinput.h</code> header</a>.</p>\n"}], "owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 4, "accepted_answer_id": 39364590, "answer_count": 1, "score": 6, "last_activity_date": 1473236040, "creation_date": 1473233340, "question_id": 39363761, "link": "https://stackoverflow.com/questions/39363761/convert-from-xlib-to-xcb", "title": "Convert from Xlib to xcb", "body": "<p>I am currently porting one of my applications from Xlib to libxcb and I am having a bit trouble finding informations on the XInput2 extension I use at some point. Is there an XInput2 implementation in libxcb? If yes, where can I find the documentation.</p>\n\n<p>Currently I am having trouble for example with this functions: <code>XIQueryDevice</code>, <code>XISelectEvents</code>. These are mainly the functions I use.</p>\n\n<p>Maybe someone can point out the documentation for me or provide me a very small example to get started.</p>\n"}, {"tags": ["c++", "c", "driver", "digital-signature", "filter-driver"], "owner": {"reputation": 1719, "user_id": 5306861, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZbylG.png?s=128&g=1", "display_name": "codeDom", "link": "https://stackoverflow.com/users/5306861/codedom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1473232288, "creation_date": 1473232288, "question_id": 39363415, "link": "https://stackoverflow.com/questions/39363415/what-is-the-alternative-for-winverifytrust-api-in-driver", "title": "What is the alternative for WinVerifyTrust Api in Driver?", "body": "<p>From what I have seen <a href=\"http://forum.sysinternals.com/how-to-use-winverifytrust-api-in-driver_topic20372.html\" rel=\"nofollow\">here</a> can not use <code>WinVerifyTrust</code> Api in Driver.</p>\n\n<p>So my question How can I check digital signature in filter driver?</p>\n"}, {"tags": ["c", "console", "curses"], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1473236663, "creation_date": 1473236663, "answer_id": 39364788, "question_id": 39363157, "link": "https://stackoverflow.com/questions/39363157/how-to-make-console-output-fixed-in-place/39364788#39364788", "title": "How to make console output fixed in place", "body": "<p>You can use something like this:</p>\n\n<p>/!\\ Warning: If you stop your curses program without call <code>endwin()</code> before, the terminal used to launch the program will have a very strange behavior.</p>\n\n<pre><code>include &lt;curses.h&gt;\n\nint main(int argc, char *argv[]) \n{\n    // init curses\n    Xinitscr(argc, argv); \n\n    // init time\n    time_t t = 0, t2;\n    time(&amp;t2);\n\n    // main loop\n    while (1) {\n        if (t2 - t &gt; 0) \n        {\n            time(&amp;t);\n\n            clear();\n            mvprintw(1,1, \"%u\", (unsigned int)t);\n            refresh();\n        }\n        time(&amp;t2);\n\n    }\n\n    // end curses mode\n    // warning: if you do not call this at the end of your program,\n    // your terminal won't be usable.\n    endwin();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158, "user_id": 6792759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8036b5701f5cac87b5726dfa995599f4?s=128&d=identicon&r=PG&f=1", "display_name": "gravell", "link": "https://stackoverflow.com/users/6792759/gravell"}, "is_accepted": false, "score": 1, "last_activity_date": 1473241626, "creation_date": 1473241626, "answer_id": 39366546, "question_id": 39363157, "link": "https://stackoverflow.com/questions/39363157/how-to-make-console-output-fixed-in-place/39366546#39366546", "title": "How to make console output fixed in place", "body": "<p>According to <a href=\"http://falsinsoft.blogspot.com/2014/05/set-console-cursor-position-in-windows.html\" rel=\"nofollow\">http://falsinsoft.blogspot.com/2014/05/set-console-cursor-position-in-windows.html</a></p>\n\n<p>Windows:</p>\n\n<pre><code>void SetCursorPos(int XPos, int YPos)\n{\n    COORD Coord;\n    Coord.X = XPos;\n    Coord.Y = YPos;\n    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), Coord);\n}\n</code></pre>\n\n<p>Linux:</p>\n\n<pre><code>void SetCursorPos(int XPos, int YPos)\n{\n    printf(\"\\033[%d;%dH\", YPos+1, XPos+1);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 0, "last_activity_date": 1473281447, "creation_date": 1473281447, "answer_id": 39378789, "question_id": 39363157, "link": "https://stackoverflow.com/questions/39363157/how-to-make-console-output-fixed-in-place/39378789#39378789", "title": "How to make console output fixed in place", "body": "<p>The example shown by @purplepsycho has some issues, addressed in this revision (works with \"any\" X/Open Curses implementation):</p>\n\n<pre><code>#include &lt;curses.h&gt;\n\nint main(int argc, char *argv[]) \n{\n    filter();\n    initscr();\n\n    // init time\n    time_t t = 0, t2;\n    time(&amp;t2);\n\n    // main loop\n    while (1) {\n        if (t2 - t &gt; 0) \n        {\n            time(&amp;t);\n\n            erase();\n            mvprintw(1,1, \"%u\", (unsigned int)t);\n            refresh();\n        }\n        time(&amp;t2);\n\n    }\n    endwin();\n\n    return 0;\n}\n</code></pre>\n\n<p>That is:</p>\n\n<ul>\n<li>use <a href=\"http://invisible-island.net/ncurses/man/curs_initscr.3x.html#h3-initscr\" rel=\"nofollow\"><code>initscr</code></a> for initializing curses (<a href=\"https://github.com/macton/pdcurses/blob/master/pdcurses/initscr.c\" rel=\"nofollow\">PDCurses</a> provides a non-standard function <code>Xinitscr</code> which is not what OP had in mind: it certainly is not often used).</li>\n<li>use <a href=\"http://invisible-island.net/ncurses/man/curs_clear.3x.html\" rel=\"nofollow\"><code>erase</code></a> rather than <code>clear</code> (to avoid screen-flicker):\n\n<blockquote>\n  <p>The  <strong><code>clear</code></strong>  and <strong><code>wclear</code></strong> routines are like <strong><code>erase</code></strong> and <strong><code>werase</code></strong>,\n  but they also call <strong><code>clearok</code></strong>, so that the screen is  cleared\n  completely  on  the  next call to <strong><code>wrefresh</code></strong> for that window\n  and repainted from scratch.</p>\n</blockquote></li>\n<li>use <a href=\"http://invisible-island.net/ncurses/man/curs_util.3x.html#h3-filter_nofilter\" rel=\"nofollow\"><code>filter</code></a> to keep the output on a single line.  <br>If your terminal switches to the alternate screen, the screen will appear to be cleared.  There is a workaround available with ncurses (see <a href=\"https://github.com/ThomasDickey/ncurses-snapshots/blob/master/test/filter.c\" rel=\"nofollow\"><code>filter.c</code></a> in <a href=\"http://invisible-island.net/ncurses/ncurses-examples.html\" rel=\"nofollow\">ncurses-examples</a>).</li>\n</ul>\n\n<p>Better than <code>erase()</code> would be <code>wclrtoeol()</code>, called after the <code>mvprintw</code>.</p>\n"}], "owner": {"reputation": 636, "user_id": 3333488, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/49Fx1.jpg?s=128&g=1", "display_name": "lash", "link": "https://stackoverflow.com/users/3333488/lash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1473281447, "creation_date": 1473231487, "last_edit_date": 1495540302, "question_id": 39363157, "link": "https://stackoverflow.com/questions/39363157/how-to-make-console-output-fixed-in-place", "title": "How to make console output fixed in place", "body": "<p>My LAME (v3.99.5) outputs progress in console by moving up x lines in the console and overwriting the previous lines. It's pretty cool.</p>\n\n<p>I've read in a <a href=\"https://stackoverflow.com/questions/2336474/in-place-progress-output-in-the-terminal-or-console\">different post</a> that such behavior for a single line can be achieved with a mere <code>\"\\r\"</code> instead of <code>\"\\n\"</code> - although the post was for Ruby, it seems to be the same for <strong>C</strong> on my system at least:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main() {\n\n    time_t t;\n    time_t t2;\n\n    time(&amp;t);\n    t2 = t;\n\n    printf(\"%u\\r\", (unsigned int)t);        \n    fflush(stdout);\n\n    while (1) {\n        if (t2 - t &gt; 0) {\n            time(&amp;t);\n            printf(\"%u\\r\", (unsigned int)t);        \n            fflush(stdout);\n        }\n        time(&amp;t2);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The post further suggests a <a href=\"https://www.gnu.org/software/ncurses/ncurses.html\" rel=\"nofollow noreferrer\">curses library</a> can be used to make the same behavior multi-line.</p>\n\n<p>What would be a boilerplate example of such code in <strong>C</strong>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1473231228, "post_id": 39363009, "comment_id": 66055115, "body": "No, because <code>a</code> is not initialized."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1473231315, "post_id": 39363009, "comment_id": 66055174, "body": "Bit a bit negation is <code>~</code> not <code>!</code>"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1473231973, "post_id": 39363009, "comment_id": 66055560, "body": "Do some testing before asking, and you will soon find this condition is not correct."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1473309746, "post_id": 39363009, "comment_id": 66092720, "body": "no, <code>if ((a &amp; ((1&lt;&lt;3) | (1&lt;&lt;5)) == ((1&lt;&lt;3)|(1&lt;&lt;5))) ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1473231709, "last_edit_date": 1473231709, "creation_date": 1473231362, "answer_id": 39363102, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification/39363102#39363102", "title": "A bit value verification", "body": "<p>Assuming that <code>a</code> actually <em>is</em> initialized, then the expression will not work as you expect. The logical not operator <code>!</code> gives you a one or a zero (boolean true or false), which you then use in a bitwise and operation. That will not give you the correct result.</p>\n\n<p>I suppose you mean to use the bitwise complement operator <code>~</code> instead, as in <code>~(1 &lt;&lt; 3)</code>. Not that it would work anyway, as that will just check that any of the other bits in <code>a</code> is non-zero.</p>\n\n<p>Instead check if the bit is one, and then turn around the logic using the logic not operator <code>!</code>, as in <code>!(a &amp; 1 &lt;&lt; 3)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "is_accepted": false, "score": 1, "last_activity_date": 1473231445, "creation_date": 1473231445, "answer_id": 39363138, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification/39363138#39363138", "title": "A bit value verification", "body": "<p>It is not correct.</p>\n\n<p>The <code>!</code> operator is boolean NOT, not a bitwise NOT.</p>\n\n<p>So, if you want to check if bits 3 &amp; 5 are both zeroes you should write:</p>\n\n<pre><code>uint8 a;\n...\nif (!(a &amp; (1&lt;&lt;3)) &amp;&amp; !(a &amp; (1&lt;&lt;5)))\n{\n    Instructions..\n}\n</code></pre>\n\n<p>Further optimisation of the expression in <code>if</code> is possible.</p>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1473231540, "creation_date": 1473231540, "answer_id": 39363173, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification/39363173#39363173", "title": "A bit value verification", "body": "<p>Your expression is false, you should not negate the masks this way and you must ignore other bits so don't use a negation. Simply:</p>\n\n<pre><code>(a &amp; (1&lt;&lt;3)) + (a &amp; (1&lt;&lt;5))\n</code></pre>\n\n<p>gives 0 if both are 0s.</p>\n"}, {"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 0, "last_activity_date": 1473231736, "creation_date": 1473231736, "answer_id": 39363231, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification/39363231#39363231", "title": "A bit value verification", "body": "<p>No. <code>!</code> operator does logical negation, and since <code>1&lt;&lt;3</code> is not zero, <code>!(1&lt;&lt;3)</code> is zero. It means <code>a &amp; !(1&lt;&lt;3)</code> will always be zero and therefore the condition will never be true.</p>\n\n<p>I think masking is one of good ways to do what you want to do.</p>\n\n<pre><code>uint8 a;\n/* assign something to a */\nreturn (a &amp; ((1 &lt;&lt; 3) | (1 &lt;&lt; 5))) == 0;\n</code></pre>\n\n<p><code>a &amp; ((1 &lt;&lt; 3) | (1 &lt;&lt; 5))</code> is a value in which the 3rd and 5th bit (0-origin) of <code>a</code> keep their original value and all other bits is turned to zero. Checking if the value is zero means checking if all of the bits to check are zero while not careing other bits. <code>==</code> operator will return 1 if two operands are equal and 0 otherwise.</p>\n"}, {"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 4, "last_activity_date": 1473237492, "last_edit_date": 1473237492, "creation_date": 1473231868, "answer_id": 39363263, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification/39363263#39363263", "title": "A bit value verification", "body": "<p>No, your code won't work in way that you want. <code>!</code> operator results only in <code>0</code> or <code>1</code> and info about actual non-zero bit is lost anyway. You may use something like this:</p>\n\n<pre><code>if(!(a &amp; ((1 &lt;&lt; 3) | (1 &lt;&lt; 5))) {\n    /* ... */\n}\n</code></pre>\n\n<p>At first stage you are creating mask with <code>|</code> operator. This mask has non-zero bits only at positions that you are interested in. Then this mask is combined with tested value via <code>&amp;</code>. As result you get <code>0</code> only if value has zero bits at tested positions. And then just inverse <code>0</code> to <code>1</code> with <code>!</code> to obtain true condition.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473237338, "last_edit_date": 1473237338, "creation_date": 1473236911, "answer_id": 39364868, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification/39364868#39364868", "title": "A bit value verification", "body": "<p>This is trivial if you don't attempt to write it as a single, messy expression. There is no advantage of doing so - contrary to popular belief, mashing as many operators into a single line is actually very bad practice. It destroys readability and you gain no performance benefits what-so-ever.</p>\n\n<p>So start by creating a bit mask:</p>\n\n<pre><code>uint8_t mask = (1&lt;&lt;3) | (1&lt;&lt;5);\n</code></pre>\n\n<p>(The parenthesis are actually not needed, but not everyone can cite the C operator precedence table in their sleep, so this is recommended style.)</p>\n\n<p>Then check the data against the mask:</p>\n\n<pre><code>if(data &amp; mask) // if any bit contains value 1\n  return 0;\nelse            // if no bit contains value 1\n  return 1;\n</code></pre>\n\n<p>Which, if you will, can be rewritten as a boolean expression:</p>\n\n<pre><code>return !(data &amp; mask);\n</code></pre>\n\n<p>The complete function could look like this:</p>\n\n<pre><code>bool check_bits (uint8_t data)\n{\n  uint8_t mask = (1&lt;&lt;3) | (1&lt;&lt;5);\n  return !(data &amp; mask);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1473311536, "last_edit_date": 1473311536, "creation_date": 1473310778, "answer_id": 39382888, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification/39382888#39382888", "title": "A bit value verification", "body": "<p>If you want to test for some combination of <code>BIT_A</code> and <code>BIT_B</code> (or whatever number of bits you can have) You can do this:</p>\n\n<pre><code>#define BIT_A (1 &lt;&lt; 3)\n#define BIT_B (1 &lt;&lt; 5)\n...\n#define BIT_Z (1 &lt;&lt; Z)\n\n...\n/*      |here you put all bits           |here you put only the ones you want set */\n/*      V                                V                                               */\nif (a &amp; (BIT_A | BIT_B | ... | BIT_Z) == (BIT_A | ... | BIT_I | ...))\n{\n    /* here you will know that bits BIT_A,..., BIT_I,... will **only**\n     * be set in the mask of (BIT_A | BIT_B | ... | BIT_Z) */\n} \n</code></pre>\n\n<p>as with <code>a &amp; (BIT_A | BIT_B | ... )</code> you force all bits not in the set to be zero, so only the bits in the set will conserve their values.  With the second mask, you generate a bitmap with only the bits of the set you want to be set (and of course the bits that are not in the set forced zero) so if you compare both values for equalness, you'll get the expected result.</p>\n\n<h1>NOTE</h1>\n\n<p>As an answer to your question, the particular case in which you want all the bits equal to one, is to make both masks equal.  For your case, you want to check if <strong>both bits are zero</strong>, then your test is (the second mask has no bits set, so it is zero):</p>\n\n<pre><code>if (a &amp; ((1 &lt;&lt; 3) | (1 &lt;&lt; 5)) == 0) { ...\n</code></pre>\n\n<p>(All bits in the second mask are zero as the required mask, and both, the third and the fifth bits are set in the first mask)  This can be written in a more compact form as (you can see it written as):</p>\n\n<pre><code>if (!(a &amp; 0x28)) { /* 0x28 is the octal for 00101000, with the bits you require */\n</code></pre>\n\n<h1>WHY THE CODE YOU WROTE IS NOT CORRECT</h1>\n\n<p>First you mix logical operators like <code>!</code> with bitmasks, making <code>!(1&lt;&lt;3)</code>to eval to <code>0</code> (<code>1&lt;&lt;3</code> is different of <code>0</code> so it is true, negating gives <code>0</code>) and the same for the <code>!(1&lt;&lt;5)</code> subexpression.  When you mask a with those values makes you get <code>a &amp; 0 ==&gt; 0</code> and <code>a &amp; 0 ==&gt; 0</code> and anding both together gives <code>0 &amp;&amp; 0 ==&gt; 0</code>. So the result value of your expression is <code>0 -- false</code> always, independent of the original value of <code>a</code>.</p>\n"}], "owner": {"reputation": 59, "user_id": 5316242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4368c5c4c55485238c1b5ed25a2c4eb?s=128&d=identicon&r=PG&f=1", "display_name": "Tova", "link": "https://stackoverflow.com/users/5316242/tova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 7, "score": 4, "last_activity_date": 1473311536, "creation_date": 1473231056, "last_edit_date": 1473231145, "question_id": 39363009, "link": "https://stackoverflow.com/questions/39363009/a-bit-value-verification", "title": "A bit value verification", "body": "<p>I want to verify two bits (for example the bit number 3 and 5) values of a uint8\nif their value is 0, I want to return 1</p>\n\n<pre><code>uint8 a;\nif ((a &amp; !(1&lt;&lt;3)) &amp;&amp; (a &amp; !(1&lt;&lt;5)))\n{\n    Instructions..\n}\n</code></pre>\n\n<p>Is this code correct ?</p>\n"}, {"tags": ["c", "linux", "operating-system", "gdb", "bfd"], "answers": [{"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1473231433, "creation_date": 1473231433, "answer_id": 39363132, "question_id": 39362852, "link": "https://stackoverflow.com/questions/39362852/instruction-pointer-to-function-name-input-parameters/39363132#39363132", "title": "Instruction pointer to function name, input parameters, ?", "body": "<p>Per the man page, be sure to <code>#define _GNU_SOURCE</code> before you <code>#include &lt;dlfcn.h&gt;</code>.  This structure, and <code>dladdr()</code>, are GNU extensions.</p>\n"}], "owner": {"reputation": 401, "user_id": 627133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0866344757d01287615f1e4aa1c654a1?s=128&d=identicon&r=PG", "display_name": "app", "link": "https://stackoverflow.com/users/627133/app"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1473231433, "creation_date": 1473230635, "question_id": 39362852, "link": "https://stackoverflow.com/questions/39362852/instruction-pointer-to-function-name-input-parameters", "title": "Instruction pointer to function name, input parameters, ?", "body": "<p>I am trying to implement backtrace like function call myself . I have been successfully able to unroll stack and i have all return address present on my stack . Now i want to get function name, variable name input to my function from this information. Also i want to do this programmatically i.e at run time i should be able to get info about all the functions that have been called till now in my program. \nLets assume i am fine compiling my with -g flag while compiling. </p>\n\n<p>I am trying to use dladdr() function to get function name, but this did not work . It gives me error that \"error: unknown type name \u2018Dl_info\u2019\" . \nHere is my code snippet : </p>\n\n<pre><code>const char * get_func_name(void *ip){\n        Dl_info info;\n        int ret;\n        ret = dladdr(ip,&amp;info);\n        if(ret &lt; 0)\n                return NULL;\n        return info.dli_fname;\n}\n</code></pre>\n\n<p>I tried researching bfd library , but didnt  have good example/tutorial , any help ? \nI am using ubunutu 14.04 </p>\n"}, {"tags": ["c", "makefile", "macros", "gnu-make"], "comments": [{"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 2, "creation_date": 1473228664, "post_id": 39362327, "comment_id": 66053760, "body": "make CFLAGS=&quot;-DENABLE_OPT=1&quot;"}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 1, "creation_date": 1473228706, "post_id": 39362327, "comment_id": 66053784, "body": "Related question <a href=\"http://stackoverflow.com/questions/9052792/how-to-pass-macro-definition-from-make-command-line-arguments-d-to-c-source\" title=\"how to pass macro definition from make command line arguments d to c source\">stackoverflow.com/questions/9052792/&hellip;</a>"}, {"owner": {"reputation": 311, "user_id": 5023617, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ddf595f5ae6cdc2279451e890fb502b7?s=128&d=identicon&r=PG&f=1", "display_name": "Anupama G", "link": "https://stackoverflow.com/users/5023617/anupama-g"}, "edited": false, "score": 0, "creation_date": 1473229163, "post_id": 39362327, "comment_id": 66054006, "body": "Thank you. I have only LOCAL_CFLAGS defined in the makefile, so this wouldn&#39;t override anything. Sounds good!"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1473236292, "post_id": 39362327, "comment_id": 66058044, "body": "Even if CFLAGS is defined before, you can use <code>CFLAGS+=</code> to add the macro to CFLAGS"}], "answers": [{"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 4, "last_activity_date": 1473230588, "last_edit_date": 1473230588, "creation_date": 1473229130, "answer_id": 39362458, "question_id": 39362327, "link": "https://stackoverflow.com/questions/39362327/how-can-a-macro-definition-be-passed-as-an-argument-to-make/39362458#39362458", "title": "How can a macro definition be passed as an argument to make?", "body": "<p>You can use <code>--eval</code>, which will evaluate the string as a makefile statement:</p>\n\n<pre><code>make --eval=\"FLAGS+= -D ENABLE_OPT=1\"\n</code></pre>\n\n<p>The make variable FLAGS is then used as a compiler argument to compile the code.</p>\n"}], "owner": {"reputation": 311, "user_id": 5023617, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ddf595f5ae6cdc2279451e890fb502b7?s=128&d=identicon&r=PG&f=1", "display_name": "Anupama G", "link": "https://stackoverflow.com/users/5023617/anupama-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 39362458, "answer_count": 1, "score": 5, "last_activity_date": 1473230588, "creation_date": 1473228585, "question_id": 39362327, "link": "https://stackoverflow.com/questions/39362327/how-can-a-macro-definition-be-passed-as-an-argument-to-make", "title": "How can a macro definition be passed as an argument to make?", "body": "<p>I wish to define a C macro by passing it as an argument to <code>make</code>, which is called from the command-line. </p>\n\n<p>Background: I want the directive <code>#define ENABLE_OPT 1</code> to be included in my C source code when a certain build option is chosen. Thus, I want this to be done via the <code>make</code> command-line instead of modifying the source code <em>or</em> the makefile. </p>\n\n<p>How can this be achieved? I find that <code>make -DENABLE_OPT=1 -f Makefile</code> throws errors that 'E', 'N' etc. are invalid arguments to make. </p>\n"}, {"tags": ["c", "struct", "binary", "fopen"], "comments": [{"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 4, "creation_date": 1473228430, "post_id": 39362227, "comment_id": 66053646, "body": "You misunderstood the meaning of &#39;binary&#39;."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1473228466, "post_id": 39362227, "comment_id": 66053657, "body": "<code>int hex_binary(char * res){</code> ...<code>return res;}</code> ...???? o.O"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1473229136, "post_id": 39362227, "comment_id": 66053988, "body": "Typical C compiler will emit compile error for the line <code>p=fopen(\u201cmyfile.txt\u201d,\u201drb&quot;);</code>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1473229214, "post_id": 39362227, "comment_id": 66054027, "body": "<code>printf(d.chunk);</code> has a big chance of causing <i>undefined behavior</i> for passing an invalid pointer (a pointer converted from the integer in implementation-defined manner or a null pointer) to <code>printf()</code>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1473229273, "post_id": 39362227, "comment_id": 66054060, "body": "You have never read anything to <code>input</code>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1473229344, "post_id": 39362227, "comment_id": 66054091, "body": "Would you mind giving us some example of input file and expected output for the input?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1473229517, "post_id": 39362227, "comment_id": 66054167, "body": "Checking if <code>v</code> isn&#39;t <code>NULL</code> <i>after</i> reading <code>v[0]</code> doesn&#39;t make much sense. Dereferencing null pointer invokes <i>undefined behavior</i>."}, {"owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "edited": false, "score": 1, "creation_date": 1473229786, "post_id": 39362227, "comment_id": 66054305, "body": "Have you got a binary to hex function that works better?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1473234458, "post_id": 39362227, "comment_id": 66056962, "body": "The problem in <code>myChunks()</code> is you declare <code>chunkStorage</code> with a <i>single</i> character <code>chunk</code> as a member. (if you ever bothered to call <code>myChunks()</code>, you <code>fread</code> <i>1-byte</i> into <code>d.chunk</code>. So how do you ever expect a long string from <code>1-byte</code>? This notwithstanding the fact that you never show <code>myChunks()</code> actually being called in your code."}], "answers": [{"tags": [], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1473240204, "creation_date": 1473240204, "answer_id": 39366024, "question_id": 39362227, "link": "https://stackoverflow.com/questions/39362227/read-struct-from-binary-file-and-convert-to-hex-in-c/39366024#39366024", "title": "Read struct from binary file and convert to Hex in C", "body": "<p>Binary to hex should work in this code. It compiles with <code>gcc</code> but I didn't test it. I hope the code below can help you use binary to hex the way you want. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint binary2hex(char bin) {\n    char *a = &amp;bin;\n    int num = 0;\n    do {\n        int b = *a == '1' ? 1 : 0;\n        num = (num &lt;&lt; 1) | b;\n        a++;\n    } while (*a);\n    printf(\"%X\\n\", num);\n    return num;\n}\n\nvoid main() {\n    struct chunkStorage {\n        char chunk;     // \u2018Chunk of Data\u2019\n    };\n    unsigned long e;\n    FILE *p;\n    struct chunkStorage d;\n    p = fopen(\"myfile.txt\", \"rb\");\n    fread(&amp;d.chunk, sizeof(d.chunk), 1, p);\n    printf(\"%c\", d.chunk);\n    e = binary2hex(d.chunk);\n    printf(\"%lu\", e);\n    fclose(p);\n}\n</code></pre>\n"}], "owner": {"reputation": 2234, "user_id": 264975, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/724f00af96c47f8bccfd9aad176b918d?s=128&d=identicon&r=PG", "display_name": "Ke.", "link": "https://stackoverflow.com/users/264975/ke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 928, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473240204, "creation_date": 1473228150, "question_id": 39362227, "link": "https://stackoverflow.com/questions/39362227/read-struct-from-binary-file-and-convert-to-hex-in-c", "title": "Read struct from binary file and convert to Hex in C", "body": "<p>I'm trying to read a simple struct from a binary file, and turn it into hex.</p>\n\n<p>I'm running into problems trying to print things out into the window. The \"chunk\" data is one big chunk, so I'm expecting it to print a lot of binary out into the window for the first printf and then hex for the 2nd printf. However, it just prints one line of an int that definitely isnt the hex it should be (it should be a very long char)</p>\n\n<p>I'm wondering what I'm doing wrong? Do I have to iterate with a while loop over every byte and turn it into a byte_array before hexing? Or have I got my types wrong?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>void myChunks(){\n\n    struct chunkStorage\n    {\n        char chunk;     // \u2018Chunk of Data\u2019\n    };\n\n    unsigned long e;\n\n            FILE *p;\n            struct chunkStorage d;\n            p=fopen(\u201cmyfile.txt\u201d,\u201drb\");\n            fread(&amp;d.chunk,sizeof(d.chunk),1,p);\n            printf(d.chunk);\n            e = hex_binary(d.chunk);\n            printf(e);\n            fclose(p);\n\n}\n\nint hex_binary(char * res){\n    char binary[16][5] = {\"0000\", \"0001\", \"0010\", \"0011\", \"0100\", \"0101\",\"0110\", \"0111\", \"1000\", \"1001\", \"1010\", \"1011\", \"1100\", \"1101\", \"1110\",\"1111\"};\n    char digits [] = \"0123456789abcdef\";\n\n    const char input[] = \"\"; // input value\n    res[0] = '\\0';\n    int p = 0;\n    int value =0;\n    while(input[p])\n    {\n        const char *v = strchr(digits, tolower(input[p]));\n        if(v[0]&gt;96){\n            value=v[0]-87;\n        }\n        else{\n            value=v[0]-48;\n        }\n        if (v){\n            strcat(res, binary[value]);\n        }\n        p++;\n    }\n    return res;\n    //printf(\"Res:%s\\n\", res);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 856, "user_id": 5486078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3949196f452be4bc39e48ba8835ec4ed?s=128&d=identicon&r=PG&f=1", "display_name": "jbsu32", "link": "https://stackoverflow.com/users/5486078/jbsu32"}, "edited": false, "score": 0, "creation_date": 1473225550, "post_id": 39361680, "comment_id": 66052550, "body": "What would be your output in this case??"}, {"owner": {"reputation": 34061, "user_id": 616460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yiloe.png?s=128&g=1", "display_name": "Jason C", "link": "https://stackoverflow.com/users/616460/jason-c"}, "edited": false, "score": 0, "creation_date": 1473225629, "post_id": 39361680, "comment_id": 66052577, "body": "Can you give this question a meaningful title? See <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> for some title ideas."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1473226188, "post_id": 39361680, "comment_id": 66052768, "body": "<a href=\"http://ideone.com/yRxumu\" rel=\"nofollow noreferrer\">See <b>here</b></a> for how the duplicate link relates to your code.."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1473225679, "creation_date": 1473225679, "answer_id": 39361715, "question_id": 39361680, "link": "https://stackoverflow.com/questions/39361680/some-issue-with-string-in-c/39361715#39361715", "title": "some issue with string in C", "body": "<p>In <code>main</code>, you pass string constants to <code>squeeze</code>. But then <code>squeeze</code> tries to modify them with code like <code>s1[k++] = s1[i]</code>. You can't modify a constant -- that's what makes it a constant.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1473225686, "creation_date": 1473225686, "answer_id": 39361716, "question_id": 39361680, "link": "https://stackoverflow.com/questions/39361680/some-issue-with-string-in-c/39361716#39361716", "title": "some issue with string in C", "body": "<p>String literals (like <code>\"tabcdge\"</code>) are <em>read-only</em>. Attempting to modify one leads to <em>undefined behavior</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "is_accepted": false, "score": 0, "last_activity_date": 1473226026, "last_edit_date": 1495542765, "creation_date": 1473226026, "answer_id": 39361785, "question_id": 39361680, "link": "https://stackoverflow.com/questions/39361680/some-issue-with-string-in-c/39361785#39361785", "title": "some issue with string in C", "body": "<p>The String constatns are stored in read-only memory. As @Joachim said, modifying them (deleting in your case) is <code>Undefined behaviour</code>. </p>\n\n<p>I suspect your program is crashing. For more info where the variables and constants are stored <a href=\"https://stackoverflow.com/a/18479996/3747770\">https://stackoverflow.com/a/18479996/3747770</a></p>\n"}], "owner": {"reputation": 51, "user_id": 4628328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41337dc429eb1f371340e5e77242479e?s=128&d=identicon&r=PG&f=1", "display_name": "Micheal", "link": "https://stackoverflow.com/users/4628328/micheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1473226047, "answer_count": 3, "score": -4, "last_activity_date": 1473226026, "creation_date": 1473225439, "question_id": 39361680, "link": "https://stackoverflow.com/questions/39361680/some-issue-with-string-in-c", "closed_reason": "Duplicate", "title": "some issue with string in C", "body": "<p>i'm reading the C programming language, question 2-4 asks to write a function called squeeze to delete all char in s1 which is in s2, so i write the code, but it can't run at all.</p>\n\n<p>here is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid squeeze(char s1[], char s2[]);\n\nint main()\n{\n    squeeze(\"tabcdge\", \"abc\");\n}\n\nvoid squeeze(char s1[], char s2[])\n{\n    int i, j, k;\n\n    for (i = k = 0; s1[i] != '\\0'; i++) {\n        for (j = 0; s2[j] != '\\0' &amp;&amp; s2[j] != s1[i]; j++)\n            ;\n        if (s2[j] == '\\0')\n            s1[k++] = s1[i];\n    }\n    s1[k] = '\\0';\n    for (i = 0; s1[i] != '\\0'; i++)\n        printf(\"%c\", s1[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "multidimensional-array"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1473223190, "post_id": 39361255, "comment_id": 66051868, "body": "The array cannot exceed <code>SIZE_MAX</code> bytes (this constant is defined in <code>limits.h</code>).  Particular systems might have smaller limits depending on how much memory is available."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1473223202, "post_id": 39361255, "comment_id": 66051872, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/216259/is-there-a-max-array-length-limit-in-c\" title=\"is there a max array length limit in c\">stackoverflow.com/questions/216259/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1473223258, "post_id": 39361255, "comment_id": 66051894, "body": "@RishikeshRaje that&#39;s a C++ question"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1473229844, "post_id": 39361418, "comment_id": 66054346, "body": "This isn&#39;t really true. For example, on 32 bit Windows you couldn&#39;t allocate more than 4,29Gb even if your computer had more RAM than that. Anyway, C provides the <code>size_t</code> type as a way to find out how much memory you can allocate in one object."}, {"owner": {"reputation": 856, "user_id": 5486078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3949196f452be4bc39e48ba8835ec4ed?s=128&d=identicon&r=PG&f=1", "display_name": "jbsu32", "link": "https://stackoverflow.com/users/5486078/jbsu32"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1473231561, "post_id": 39361418, "comment_id": 66055329, "body": "@Lundin : Thanks for clearing my misconception. I think i got it now."}], "tags": [], "owner": {"reputation": 856, "user_id": 5486078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3949196f452be4bc39e48ba8835ec4ed?s=128&d=identicon&r=PG&f=1", "display_name": "jbsu32", "link": "https://stackoverflow.com/users/5486078/jbsu32"}, "is_accepted": true, "score": 1, "last_activity_date": 1473224486, "last_edit_date": 1473224486, "creation_date": 1473223767, "answer_id": 39361418, "question_id": 39361255, "link": "https://stackoverflow.com/questions/39361255/maximum-number-of-elements-in-a-2d-integer-array/39361418#39361418", "title": "Maximum number of elements in a 2D integer array", "body": "<p>It depends on your <code>RAM</code> or the memory available for you. </p>\n\n<p><code>i:e:</code> My program used to crash when I declared a global array <code>a[100000][10000]</code>, but this declaration is fine with the system now I have.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": -1, "last_activity_date": 1473229566, "creation_date": 1473229566, "answer_id": 39362566, "question_id": 39361255, "link": "https://stackoverflow.com/questions/39361255/maximum-number-of-elements-in-a-2d-integer-array/39362566#39362566", "title": "Maximum number of elements in a 2D integer array", "body": "<p>The <code>size_t</code> type is defined to be large enough to contain the size of any object in the program, including arrays. So the largest possible array size can be described as <code>2^(8*sizeof(size_t)</code> bytes. </p>\n\n<p>For convenience, this value can be obtained through the <code>SIZE_MAX</code> constant in limits.h. It is guaranteed to be at least 65535 but is realistically a larger value, most likely 2^32 on 32 bit systems and 2^64 on 64 bit systems.</p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 3470630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53ffcadf9aa396bb5596dc63e2e5a466?s=128&d=identicon&r=PG", "display_name": "TezlaCoil", "link": "https://stackoverflow.com/users/3470630/tezlacoil"}, "is_accepted": false, "score": -1, "last_activity_date": 1473230387, "creation_date": 1473230387, "answer_id": 39362784, "question_id": 39361255, "link": "https://stackoverflow.com/questions/39361255/maximum-number-of-elements-in-a-2d-integer-array/39362784#39362784", "title": "Maximum number of elements in a 2D integer array", "body": "<p>Maximum imposed by the C/C++ standard: <code>x * y * z &lt;= SIZE_MAX</code>, where SIZE_MAX is implementation defined, x is one dimension of the array, y is the other dimension, and z is the size of the element in bytes. e.g. <code>element_t A[x][y]</code>, <code>z = sizeof(element_t)</code>.</p>\n"}], "owner": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 39361418, "answer_count": 3, "score": 1, "last_activity_date": 1473230387, "creation_date": 1473222823, "last_edit_date": 1473229287, "question_id": 39361255, "link": "https://stackoverflow.com/questions/39361255/maximum-number-of-elements-in-a-2d-integer-array", "title": "Maximum number of elements in a 2D integer array", "body": "<p>Is there any limit as to how many elements a <code>2D integer array</code> can contain in <code>C</code>?<br>\nPS : I was expecting there would be some space limitations in declaring an array but could not find any such reference in the internet.</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1473226454, "post_id": 39361186, "comment_id": 66052857, "body": "disabling something in C is just not possible, that is the whole idea behind the language is that you better know what you are doing"}], "answers": [{"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 2, "last_activity_date": 1473227224, "last_edit_date": 1473227224, "creation_date": 1473224058, "answer_id": 39361461, "question_id": 39361186, "link": "https://stackoverflow.com/questions/39361186/why-is-arrayi-1-0-how-does-one-prevent-undefined-variables-from-being-us/39361461#39361461", "title": "Why is array[i][-1] == 0? How does one prevent undefined variables from being used?", "body": "<p>You have <code>int board[DIM_MAX][DIM_MAX];</code> where <code>#define DIM_MIN 3</code> and the memory allocated for elements are contiguous, so typically you will access <code>board[1][2]</code> by using <code>board[2][-1]</code>. But this is <em>undefined behavior</em>, which allows anything to happen, and you mustn't use that.</p>\n\n<p>Quote from <a href=\"http://chimera.roma1.infn.it/SP/COMMON/iso-iec-9899-1990.pdf\" rel=\"nofollow\">N1570</a> J.2 Undefined behavior:</p>\n\n<blockquote>\n  <p>An array subscript is out of range, even if an object is apparently accessible with the\n  given subscript (as in the lvalue expression a[1][7] given the declaration int\n  a[4][5]) (6.5.6).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "edited": false, "score": 0, "creation_date": 1473225284, "post_id": 39361489, "comment_id": 66052478, "body": "Thank you. How would one prevent it accessing undefined behavior?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "edited": false, "score": 0, "creation_date": 1473225834, "post_id": 39361489, "comment_id": 66052638, "body": "@KevJpg By learning the rules of the language and then not writing code that violates the rules."}, {"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "reply_to_user": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "edited": false, "score": 0, "creation_date": 1473225841, "post_id": 39361489, "comment_id": 66052644, "body": "@KevJpg compile your code with all of your compiler warnings, and hopefully this will be caught at compilation stage as opposed to runtime. Depending upon your compiler, you could try <code>-Wall</code>"}, {"owner": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "reply_to_user": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 0, "creation_date": 1473225928, "post_id": 39361489, "comment_id": 66052676, "body": "@NoseKnowsAll Thank you for the help! I appreciate it."}, {"owner": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473225979, "post_id": 39361489, "comment_id": 66052692, "body": "@M.M That&#39;s what I&#39;m trying to do... I get you&#39;ve been a professional for 16 years, but how about some empathy for people just starting?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "edited": false, "score": 0, "creation_date": 1473226673, "post_id": 39361489, "comment_id": 66052936, "body": "@KevJpg That really is the only way, it wasn&#39;t a joke or something"}, {"owner": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473227260, "post_id": 39361489, "comment_id": 66053157, "body": "@M.M I understand that, but that&#39;s what I&#39;m trying to do - learn. You learn from mistakes. That&#39;s why I&#39;m asking for help here."}, {"owner": {"reputation": 44753, "user_id": 365237, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fb9385b7f1a792d5159eca8bbb2c34f8?s=128&d=identicon&r=PG", "display_name": "eis", "link": "https://stackoverflow.com/users/365237/eis"}, "reply_to_user": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "edited": false, "score": 3, "creation_date": 1473227471, "post_id": 39361489, "comment_id": 66053248, "body": "@KevJpg I don&#39;t think M.M was trying to be mean. By &quot;rules of the language&quot; we refer to C standard definition, which tells you what is undefined behaviour and what is not. You can get warnings out of doing wrong things from compiler, but the only real &quot;cure&quot; is to try to familiarize yourself with the standard, either through study material or through standard itself."}, {"owner": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "reply_to_user": {"reputation": 44753, "user_id": 365237, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fb9385b7f1a792d5159eca8bbb2c34f8?s=128&d=identicon&r=PG", "display_name": "eis", "link": "https://stackoverflow.com/users/365237/eis"}, "edited": false, "score": 0, "creation_date": 1473228003, "post_id": 39361489, "comment_id": 66053460, "body": "@eis Thanks for clarifying."}], "tags": [], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "is_accepted": false, "score": 2, "last_activity_date": 1526784319, "last_edit_date": 1526784319, "creation_date": 1473224247, "answer_id": 39361489, "question_id": 39361186, "link": "https://stackoverflow.com/questions/39361186/why-is-arrayi-1-0-how-does-one-prevent-undefined-variables-from-being-us/39361489#39361489", "title": "Why is array[i][-1] == 0? How does one prevent undefined variables from being used?", "body": "<blockquote>\n  <p>board[2][-1]. Why is that allow</p>\n</blockquote>\n\n<p>C does allow you access out of range of an array. But it is <em>Undefined Behavior</em>.</p>\n\n<blockquote>\n  <p>why does that equal 0?</p>\n</blockquote>\n\n<p>By accident. It's Undefined Behavior and it could be <em>anything</em>.</p>\n"}], "owner": {"reputation": 7, "user_id": 6784859, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AoKQ9CXCr4Q/AAAAAAAAAAI/AAAAAAACAQk/GIGZg3b2qCE/photo.jpg?sz=128", "display_name": "KevJpg", "link": "https://stackoverflow.com/users/6784859/kevjpg"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1473230164, "answer_count": 2, "score": -1, "last_activity_date": 1526784319, "creation_date": 1473222333, "last_edit_date": 1473225479, "question_id": 39361186, "link": "https://stackoverflow.com/questions/39361186/why-is-arrayi-1-0-how-does-one-prevent-undefined-variables-from-being-us", "closed_reason": "Duplicate", "title": "Why is array[i][-1] == 0? How does one prevent undefined variables from being used?", "body": "<pre><code>/**\n * fifteen.c\n *\n * Computer Science 50\n * Problem Set 3\n *\n * Implements Game of Fifteen (generalized to d x d).\n *\n * Usage: fifteen d\n *\n * whereby the board's dimensions are to be d x d,\n * where d must be in [DIM_MIN,DIM_MAX]\n *\n * Note that usleep is obsolete, but it offers more granularity than\n * sleep and is simpler to use than nanosleep; `man usleep` for more.\n */\n\n#define _XOPEN_SOURCE 500\n\n#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n// constants\n#define DIM_MIN 3\n#define DIM_MAX 9\n\n// board\nint board[DIM_MAX][DIM_MAX];\nint b;\n\n// dimensions\nint d;\n\n// prototypes\nvoid clear(void);\nvoid greet(void);\nvoid init(void);\nvoid draw(void);\nbool move(int tile);\nbool won(void);\n\nint main(int argc, string argv[])\n{\n    // ensure proper usage\n    if (argc != 2)\n    {\n        printf(\"Usage: fifteen d\\n\");\n        return 1;\n    }\n\n    // ensure valid dimensions\n    d = atoi(argv[1]);\n    if (d &lt; DIM_MIN || d &gt; DIM_MAX)\n    {\n        printf(\"Board must be between %i x %i and %i x %i, inclusive.\\n\",\n            DIM_MIN, DIM_MIN, DIM_MAX, DIM_MAX);\n        return 2;\n    }\n\n    // open log\n    FILE* file = fopen(\"log.txt\", \"w\");\n    if (file == NULL)\n    {\n        return 3;\n    }\n\n    // greet user with instructions\n    greet();\n\n    // initialize the board\n    init();\n\n    // accept moves until game is won\n    while (true)\n    {\n        // clear the screen\n        clear();\n\n        // draw the current state of the board\n        draw();\n\n        // log the current state of the board (for testing)\n        for (int i = 0; i &lt; d; i++)\n        {\n            for (int j = 0; j &lt; d; j++)\n            {\n                fprintf(file, \"%i\", board[i][j]);\n                if (j &lt; d - 1)\n                {\n                    fprintf(file, \"|\");\n                }\n            }\n            fprintf(file, \"\\n\");\n        }\n        fflush(file);\n\n        // check for win\n        if (won())\n        {\n            printf(\"ftw!\\n\");\n            break;\n        }\n\n        // prompt for move\n        printf(\"Tile to move: \");\n        int tile = GetInt();\n\n        // quit if user inputs 0 (for testing)\n        if (tile == 0)\n        {\n            break;\n        }\n\n        // log move (for testing)\n        fprintf(file, \"%i\\n\", tile);\n        fflush(file);\n\n        // move if possible, else report illegality\n        if (!move(tile))\n        {\n            printf(\"\\nIllegal move.\\n\");\n            usleep(500000);\n        }\n\n        // sleep thread for animation's sake\n        usleep(500000);\n    }\n\n    // close log\n    fclose(file);\n\n    // success\n    return 0;\n}\n\n/**\n * Clears screen using ANSI escape sequences.\n */\nvoid clear(void)\n{\n    printf(\"\\033[2J\");\n    printf(\"\\033[%d;%dH\", 0, 0);\n}\n\n/**\n * Greets player.\n */\nvoid greet(void)\n{\n    clear();\n    printf(\"WELCOME TO GAME OF FIFTEEN\\n\");\n    usleep(2000000);\n}\n\n/**\n * Initializes the game's board with tiles numbered 1 through d*d - 1\n * (i.e., fills 2D array with values but does not actually print them).  \n */\nvoid init(void)\n{\n    for(int i = 0, j = 0, k = ((d*d)-1); i &lt; d; j++, k--)\n    {\n        if(j == d)\n        {\n            i = i + 1;\n            j = 0;\n        }\n        board[i][j] = k;\n    }\n    if((d*d)%2 == 0)\n    {\n        board[(d-1)][(d-2)] = 2;\n        board[(d-1)][(d-3)] = 1;\n    }\n    board[(d-1)][(d-1)] = 0;\n    b = board[(d-1)][(d-1)];\n\n\n}\n\n/**\n * Prints the board in its current state.\n */\nvoid draw(void)\n{\n    for(int i = 0, j = 0; i !=(d-1) || j!=d; j++)\n    {\n        if(j == d)\n        {\n          i = i + 1;\n          j = 0;\n          printf(\"\\n\");\n         }\n        if(board[i][j] == 0) //b used to be 99\n        {\n            printf(\"  _\");\n        }\n        else\n        {\n            printf(\" %2d\", board[i][j]);\n        }\n    }\n    printf(\"\\n\");\n}\n\n/**\n * If tile borders empty space, moves tile and returns true, else\n * returns false. \n */\nbool move(int tile)\n{\n    //find tile\n    for(int i = 0, j = 0; i !=(d-1) || j!=d; j++)\n    {\n        if(j == d)\n        {\n          i = i + 1;\n          j = 0;\n        }\n        if (board[i][j] == tile)\n        {\n            //check if tile position is in valid perimeter of blank space\n            if (board[i+1][j] == b)\n            {\n               board[i+1][j] = tile;\n               board[i][j] = 0;\n               b = board[i][j];\n                return true;\n            }\n            if (board[i-1][j] == b)\n            {\n               board[i-1][j] = tile;\n               board[i][j] = 0;\n               b = board[i][j];\n                return true;\n            }\n            if (board[i][j+1] == b)\n            {\n               board[i][j+1] = tile;\n               board[i][j] = 0;\n               b = board[i][j];\n                return true;\n            }\n            if (board[i][j-1] == b)\n            {\n               printf(\"%i\", board[i][j-1]);\n               board[i][j-1] = tile;\n               board[i][j] = 0;\n               b = board[i][j];\n                return true;\n            }\n        }\n    }\n    return false;\n}\n\n/**\n * Returns true if game is won (i.e., board is in winning configuration), \n * else false.\n */\nbool won(void)\n{\n    for(int i = 0, j = 0, k = 1; i !=(d-1) || j!=d; j++)\n    {\n        if(j == d)\n        {\n          i = i + 1;\n          j = 0;\n        }\n        if (k == (d*d)-1)\n        {\n            return true;\n        }\n        if (board[i][j] == k)\n        {\n            k = k + 1;\n        }\n    }\n    return false;\n}\n</code></pre>\n\n<p>I originally had </p>\n\n<pre><code>board[(d-1)][(d-1)] = 0;\n</code></pre>\n\n<p>equal to 99 along with the move function look for 99. For my problem set I was supposed to use 0. Once I changed 99 to 0, for some reason 0 is being found if board[i][j-1] even if that means board[2][-1]. Why is that allow/why does that equal 0? and how can I disable this? </p>\n"}, {"tags": ["c", "dll"], "comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1473222054, "post_id": 39361120, "comment_id": 66051567, "body": "your invocation is calling <code>sampledllmain</code> with <code>DllMain</code> and with the <code>rundll32</code> invocation, please add a second dummy function for your tests so you can use <code>rundll32 &quot;path to DLL&quot;,dummy</code>"}, {"owner": {"reputation": 4791, "user_id": 1609614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvIBD.jpg?s=128&g=1", "display_name": "Ari0nhh", "link": "https://stackoverflow.com/users/1609614/ari0nhh"}, "edited": false, "score": 2, "creation_date": 1473222296, "post_id": 39361120, "comment_id": 66051625, "body": "Of course it would be called twice. Remove <code>sampledllmain</code> from the <code>DllMain</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2761, "user_id": 985179, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7f9f118aa571a5e0ebcfe240add2d868?s=128&d=identicon&r=PG", "display_name": "Neon Flash", "link": "https://stackoverflow.com/users/985179/neon-flash"}, "edited": false, "score": 0, "creation_date": 1473223202, "post_id": 39361243, "comment_id": 66051873, "body": "I want the MessageBox to displayed when the DLL is loaded by the Process. But when I place the call to MessageBox directly in the DllMain function it is called 4 times. I read somewhere that we should create a different export function for it and invoke it from DLL main based on a condition like DLL_PROCESS_ATTACH. So, how do I display the Message Box on the call to DllMain()?"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "reply_to_user": {"reputation": 2761, "user_id": 985179, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7f9f118aa571a5e0ebcfe240add2d868?s=128&d=identicon&r=PG", "display_name": "Neon Flash", "link": "https://stackoverflow.com/users/985179/neon-flash"}, "edited": false, "score": 0, "creation_date": 1473223413, "post_id": 39361243, "comment_id": 66051933, "body": "but why do you invoke it a second time with <code>rundll32.exe</code> ( passing it as a parameter ) ?"}, {"owner": {"reputation": 2761, "user_id": 985179, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7f9f118aa571a5e0ebcfe240add2d868?s=128&d=identicon&r=PG", "display_name": "Neon Flash", "link": "https://stackoverflow.com/users/985179/neon-flash"}, "edited": false, "score": 0, "creation_date": 1473223657, "post_id": 39361243, "comment_id": 66052005, "body": "I use rundll32 only for testing. How can I execute MessageBox function only once when a DLL is loaded? When LoadLibrary() is used to load a DLL, DllMain() function is called automatically. So, ideally, if I place a call directly inside DllMain() for MessageBox, then it should execute MessageBox() only once right? Why does it happen two times or more times then? You can test this yourself."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "reply_to_user": {"reputation": 2761, "user_id": 985179, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7f9f118aa571a5e0ebcfe240add2d868?s=128&d=identicon&r=PG", "display_name": "Neon Flash", "link": "https://stackoverflow.com/users/985179/neon-flash"}, "edited": false, "score": 0, "creation_date": 1473223819, "post_id": 39361243, "comment_id": 66052055, "body": "couldn&#39;t you add another function, and call it with rundll32 instead of <code>sampledllmain</code> ?"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "reply_to_user": {"reputation": 2761, "user_id": 985179, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7f9f118aa571a5e0ebcfe240add2d868?s=128&d=identicon&r=PG", "display_name": "Neon Flash", "link": "https://stackoverflow.com/users/985179/neon-flash"}, "edited": false, "score": 0, "creation_date": 1473226619, "post_id": 39361243, "comment_id": 66052916, "body": "My guess is that your multiple call to message box have to do with the different call to <code>DllMain</code> with different <code>dwReason</code>"}], "tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": true, "score": 2, "last_activity_date": 1473226909, "last_edit_date": 1473226909, "creation_date": 1473222752, "answer_id": 39361243, "question_id": 39361120, "link": "https://stackoverflow.com/questions/39361120/dll-export-function-called-twice/39361243#39361243", "title": "DLL Export Function Called Twice", "body": "<p>As described by the <a href=\"https://support.microsoft.com/en-us/kb/164787\" rel=\"nofollow\">information page about rundll32.exe</a> :</p>\n\n<blockquote>\n  <ol>\n  <li>It loads the specified DLL via <code>LoadLibrary()</code>.</li>\n  <li>It obtains the address of the  function via <code>GetProcAddress()</code>.</li>\n  <li>It calls the  function, passing the command line tail which is the .</li>\n  </ol>\n</blockquote>\n\n<p>In your case :</p>\n\n<ol>\n<li>When <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684175(v=vs.85).aspx\" rel=\"nofollow\"><code>LoadLibrary()</code></a> is invoked it calls <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682583(v=vs.85).aspx\" rel=\"nofollow\"><code>DllMain</code></a>, in your case <code>DllMain</code> calls <code>sampledllmain</code>.</li>\n<li>Obtains the address of <code>sampledllmain</code></li>\n<li>calls <code>sampledllmain</code> ( second time ).</li>\n</ol>\n\n<p>to fix your issue:</p>\n\n<ul>\n<li>add a second function <code>dummy</code> (for example )</li>\n<li>use <code>rundll32 \"path to DLL\",dummy</code> on the command line</li>\n</ul>\n\n<p>PS: On an additional note you could also debug your dll there are <a href=\"https://msdn.microsoft.com/en-us/library/605a12zt.aspx\" rel=\"nofollow\">guides that describe how to do it</a></p>\n\n<p>An example with <code>MessageBox</code> call in <code>dllMain</code> </p>\n\n<pre><code>#include &lt;windows.h&gt;\n__declspec(dllexport) void sample(void)\n{\n    MessageBox(NULL, \"sample text test\", \"sample title test\", 0);\n}\nBOOL APIENTRY DllMain( HMODULE hModule,\n                       DWORD  ul_reason_for_call,\n                       LPVOID lpReserved\n                     )\n{\n    switch (ul_reason_for_call)\n    {\n    case DLL_PROCESS_ATTACH:\n        MessageBox(NULL, \"attach\", \"DllMain\", 0);\n        break;\n    case DLL_THREAD_ATTACH:\n        break;\n    case DLL_THREAD_DETACH:\n        break;\n    case DLL_PROCESS_DETACH:\n        MessageBox(NULL, \"detach\", \"DllMain\", 0);\n        break;\n    }\n    return TRUE;\n}\n</code></pre>\n\n<p>Run with <code>rundll32.exe lib.dll,sample</code></p>\n"}], "owner": {"reputation": 2761, "user_id": 985179, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7f9f118aa571a5e0ebcfe240add2d868?s=128&d=identicon&r=PG", "display_name": "Neon Flash", "link": "https://stackoverflow.com/users/985179/neon-flash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 39361243, "answer_count": 1, "score": 0, "last_activity_date": 1473226909, "creation_date": 1473221900, "question_id": 39361120, "link": "https://stackoverflow.com/questions/39361120/dll-export-function-called-twice", "title": "DLL Export Function Called Twice", "body": "<p>I have made a short DLL which will display a MessageBox when it is loaded by a process. However, the message box is displayed two times. So, it looks like the DLL Export Function is called twice. Could you please see if there is something that needs to be modified in my code so that the MessageBox is displayed only once?</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\n__declspec(dllexport) void sampledllmain()\n{\n    MessageBox(NULL, \"sample text\",\"sample title\", 0);\n}\n\nBOOL APIENTRY DllMain(HANDLE hHandle, DWORD dwReason, LPVOID Reserved)\n{\n    switch(dwReason)\n    {\n        case DLL_PROCESS_ATTACH:\n                sampledllmain();\n                break;\n    }\n    return 1;\n}\n</code></pre>\n\n<p>I load the DLL using rundll32 as shown below:</p>\n\n<pre><code>rundll32 \"path to DLL\",sampledllmain\n</code></pre>\n"}, {"tags": ["c", "sockets", "setsockopt"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1473223272, "post_id": 39361016, "comment_id": 66051899, "body": "How do you know the options are not being set? Is <code>setsockopt()</code> failing with an error? Does <code>getsocktop()</code> return values you are not expecting? Does the socket simply behave differently than expected? If so, how? What platform is this code running on? On most platforms <code>SO_RCVTIMEO</code> and <code>SO_SENDTIMEO</code> do indeed take a <code>timeval</code> struct as input. But on Windows, they take a <code>DWORD</code> instead."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1473223352, "post_id": 39361016, "comment_id": 66051918, "body": "Also, your <code>Accept Error</code> message will never be reported, since your loop only enters the loop body when <code>new_socket_fd &gt; 0</code>.  If you want to do error handling on <code>accept()</code>, you should move it inside the loop instead."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473223261, "post_id": 39361299, "comment_id": 66051895, "body": "Or, simply use <code>select()</code> or <code>epoll()</code> to implement the timeout instead.  Put the socket into non-blocking mode, and then 1) before reading, poll for readability with timeout; 2) if sending fails with ` EAGAIN` or <code>EWOULDBLOCK</code>, poll for writability with timeout. If either operation times out, close the connection."}], "tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 1, "last_activity_date": 1473223083, "creation_date": 1473223083, "answer_id": 39361299, "question_id": 39361016, "link": "https://stackoverflow.com/questions/39361016/setting-sockopt-for-client-socket-returned-from-accept/39361299#39361299", "title": "Setting sockopt for client socket returned from accept()", "body": "<blockquote>\n  <p>My aim is to time out the client after a particular time of\n  inactivity. [...] can you please suggest what when wrong..?</p>\n</blockquote>\n\n<p>I suspect what's wrong is that you're misunderstanding what SO_RCVTIMEO and SO_SNDTIMEO are intended to do.  From the <a href=\"http://linux.die.net/man/7/socket\" rel=\"nofollow\">man page</a>:</p>\n\n<blockquote>\n  <p>SO_RCVTIMEO and SO_SNDTIMEO Specify the receiving or sending timeouts\n  until reporting an error. The argument is a struct timeval. If an\n  input or output function blocks for this period of time, and data has\n  been sent or received, the return value of that function will be the\n  amount of data transferred; if no data has been transferred and the\n  timeout has been reached then -1 is returned with errno set to EAGAIN\n  or EWOULDBLOCK, or EINPROGRESS (for connect(2)) just as if the socket\n  was specified to be nonblocking. If the timeout is set to zero (the\n  default) then the operation will never timeout.</p>\n</blockquote>\n\n<p>... but it sounds like what you want is for the TCP connection be automatically closed after a certain amount of time with no traffic on the TCP connection, which is not the same thing as forcing a call to send() or recv() to return after a specified amount of time.</p>\n\n<p>If what you are looking for is a mechanism to close an idle TCP connection, you can implement that yourself by recording the current time whenever data is sent or received on the socket.  At a later time (e.g. after send() or recv() times out), you can subtract your recorded last-traffic-seen-at-time from the current time; if the difference is greater than your idle-timeout value, call close() on the socket yourself.</p>\n"}], "owner": {"reputation": 691, "user_id": 1257420, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/cOXmL.png?s=128&g=1", "display_name": "3lokh", "link": "https://stackoverflow.com/users/1257420/3lokh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473223093, "creation_date": 1473221010, "last_edit_date": 1473223093, "question_id": 39361016, "link": "https://stackoverflow.com/questions/39361016/setting-sockopt-for-client-socket-returned-from-accept", "title": "Setting sockopt for client socket returned from accept()", "body": "<p>I'm trying to set socket options for a client socket returned from the <code>accept()</code> function. But they are not getting set correctly.</p>\n\n<p>My aim is to time out the client after a particular time of inactivity. But the server should still be able to accept other client connections.</p>\n\n<p>Below is my code where I set the socket option.  Can you please suggest what is wrong?</p>\n\n<pre><code>while ((new_sock_fd = accept(socket_fd, (struct sockaddr *) &amp;cli_addr, &amp;clilen)) &gt; 0)\n{\n    if (new_sock_fd &lt; 0)\n        printf(\"Accept Error\");\n    else\n    {\n        struct timeval timeout;      \n        timeout.tv_sec = 10;\n        timeout.tv_usec = 0;\n        if (setsockopt(new_sock_fd, SOL_SOCKET, SO_RCVTIMEO, (char *)&amp;timeout, sizeof(timeout)) &lt; 0)\n            error(\"setsockopt failed\\n\");\n        if (setsockopt(new_sock_fd, SOL_SOCKET, SO_SNDTIMEO, (char *)&amp;timeout, sizeof(timeout)) &lt; 0)\n            error(\"setsockopt failed\\n\");\n        pthread_create(&amp;thread, NULL, client_handler, (void *) (intptr_t)new_sock_fd); //intptr_t is big enough to hold the integer prt\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "stack", "x86-64"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 8, "creation_date": 1473220261, "post_id": 39360897, "comment_id": 66051176, "body": "To give the stack 16 byte alignment. Calling the function pushes an 8 byte return address on the stack so the function needs to allocate 8 more bytes to align the stack again."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1473221696, "post_id": 39360897, "comment_id": 66051472, "body": "@RossRidge: Make that an answer. Also mention that the reason alignment is mandatory here is to meet the ABI calling other functions (<code>strings_not_equal</code>, <code>explode_bomb</code>)."}, {"owner": {"reputation": 113, "user_id": 6802693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdeea33341bff0f0486e7ab1a3073c4?s=128&d=identicon&r=PG&f=1", "display_name": "Qin Yixiao", "link": "https://stackoverflow.com/users/6802693/qin-yixiao"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1473397953, "post_id": 39360897, "comment_id": 66133874, "body": "@RossRidge: Thanks for pointing out the 16-byte alignment. But in the additional example in my edit, why does the compiler decrement <code>%rsp</code> by 16 instead of 8 bytes in <code>call_incr</code>?"}, {"owner": {"reputation": 8686, "user_id": 268025, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eb39f8801f5c6b47bab7d5e91bf513f4?s=128&d=identicon&r=PG", "display_name": "tangrs", "link": "https://stackoverflow.com/users/268025/tangrs"}, "edited": false, "score": 0, "creation_date": 1473401067, "post_id": 39360897, "comment_id": 66134944, "body": "The <code>subq $16, %rsp</code> is optimised out on my machine at <code>-O2</code>"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1473403923, "post_id": 39360897, "comment_id": 66136221, "body": "It&#39;s probably allocating 16 bytes on the stack because you have 16 bytes of local variables (<code>v1</code> and <code>v2</code>) and it&#39;s not bothering to align the stack because it determined that <code>incr</code> doesn&#39;t actually need the stack to be aligned. If you remove the definition of <code>incr</code> then the compiler allocates 24 bytes on the stack which results in a correctly aligned stack in case <code>incr</code> needs it."}, {"owner": {"reputation": 113, "user_id": 6802693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdeea33341bff0f0486e7ab1a3073c4?s=128&d=identicon&r=PG&f=1", "display_name": "Qin Yixiao", "link": "https://stackoverflow.com/users/6802693/qin-yixiao"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1473409658, "post_id": 39360897, "comment_id": 66139137, "body": "@RossRidge: Thank you for being helpful."}], "owner": {"reputation": 113, "user_id": 6802693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdeea33341bff0f0486e7ab1a3073c4?s=128&d=identicon&r=PG&f=1", "display_name": "Qin Yixiao", "link": "https://stackoverflow.com/users/6802693/qin-yixiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "closed_date": 1473239299, "answer_count": 0, "score": 2, "last_activity_date": 1473397691, "creation_date": 1473219901, "last_edit_date": 1473397691, "question_id": 39360897, "link": "https://stackoverflow.com/questions/39360897/why-decrement-rsp-even-when-the-reserved-space-on-stack-is-never-used", "closed_reason": "Duplicate", "title": "Why decrement %rsp even when the reserved space on stack is never used?", "body": "<p>I understand the convention of decrementing <code>%rsp</code> to reserve space for local variables at the beginning of a function in x86-64 assembly. However, in the below function, <code>%rsp</code> is decremented but the reserved space of 8 bytes on the stack is never used in the function. So why would the compiler decrement <code>%rsp</code> at the beginning? Source code and compiler information are not available.</p>\n\n<pre><code>0000000000400ef0 &lt;phase_1&gt;:\n    0x0000000000400ee0 &lt;+0&gt;:    sub    $0x8, %rsp \n    0x0000000000400ee4 &lt;+4&gt;:    mov    $0x402400, %esi \n    0x0000000000400ee9 &lt;+9&gt;:    callq  0x401338 &lt;strings_not_equal&gt;\n    0x0000000000400eee &lt;+14&gt;:   test   %eax, %eax\n    0x0000000000400ef0 &lt;+16&gt;:   je     0x400ef7 &lt;phase_1+23&gt;\n    0x0000000000400ef2 &lt;+18&gt;:   callq  0x40143a &lt;explode_bomb&gt;\n    0x0000000000400ef7 &lt;+23&gt;:   add    $0x8, %rsp\n    0x0000000000400efb &lt;+27&gt;:   retq  \n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n\n<p><strong>EDIT:</strong>\nIf the reason is to give the stack 16-byte alignment, here is another example that seems to be a contradiction. Doesn't <code>subq $16, %rsp</code> at the beginning of <code>call_incr</code> break the 16-bit alignment of stack prior to <code>call incr</code>? Why not just decrement <code>%rsp</code> by 8 bytes?</p>\n\n<p>Source:</p>\n\n<pre><code>long incr(long *p, long val) {\n    long x = *p;\n    long y = x + val;\n    *p = y;\n    return x;\n}\n\nlong call_incr() {\n    long v1 = 1000;\n    long v2 = incr(&amp;v1, 3000);\n    return v1+v2;\n}\n</code></pre>\n\n<p>Assembly (compiled with <code>gcc -Og -fno-stack-protector -S</code>)</p>\n\n<pre><code>incr:\n.LFB0:\n    .cfi_startproc\n    movq    (%rdi), %rax\n    addq    %rax, %rsi\n    movq    %rsi, (%rdi)\n    ret\n    .cfi_endproc\n\ncall_incr:\n.LFB1:\n    .cfi_startproc\n    subq    $16, %rsp   # why decrement by 16 bytes here?\n    .cfi_def_cfa_offset 24\n    movq    $1000, 8(%rsp)\n    movl    $3000, %esi\n    leaq    8(%rsp), %rdi\n    call    incr\n    addq    8(%rsp), %rax\n    addq    $16, %rsp\n    .cfi_def_cfa_offset 8\n    ret\n    .cfi_endproc\n</code></pre>\n"}, {"tags": ["c", "stdin", "fgets"], "comments": [{"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1473220231, "post_id": 39360883, "comment_id": 66051171, "body": "What operating system are you using, and exactly how are you providing the input?"}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1473220457, "post_id": 39360883, "comment_id": 66051213, "body": "This code is strange. Are you sure you&#39;re calling fgets not gets? Your extra \\n on the printf suggests you are calling gets."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473221675, "post_id": 39360883, "comment_id": 66051468, "body": "There is no need for <code>BUFFERSIZE-1</code> use <code>BUFFERSIZE</code> with <code>fgets</code>. Also what OS are you running on?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473222508, "post_id": 39360883, "comment_id": 66051682, "body": "There is no limit on <code>stdin</code> on Linux and I doubt there is one on OSX (though I don&#39;t use OSX, so I cannot confirm). I have redirected 800K+ files to <code>stdin</code> for reading by <code>fgets</code> without issue. Your code should read up to <code>2048</code> (chars, that&#39;s <code>2047 + nul-byte</code> as you have it correctly edited). Changing <code>printf(&quot;%s(%zu chars [including &#39;\\\\n&#39;])\\n&quot;, buffer, strlen (buffer));</code> and using your input, I get the full output along with <code>(1025 chars [including &#39;\\n&#39;])</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1473223677, "post_id": 39360883, "comment_id": 66052011, "body": "Note that if it was a file that was redirected as standard input, Mac OS X has no specific limit on the length of a line.  It is the terminal driver that has the limit."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1473222728, "creation_date": 1473222728, "answer_id": 39361239, "question_id": 39360883, "link": "https://stackoverflow.com/questions/39360883/using-fgets-to-read-a-line-from-stdin-terminal-the-maximum-length-is-1024/39361239#39361239", "title": "Using fgets to read a line from stdin (terminal), the maximum length is 1024?", "body": "<p>There's nothing wrong with the code per se.  The problem is the terminal driver which has a limit of 1 KiB in its buffer, so you can't input more than the 1023 characters plus a newline.  Most systems have a similar limit.  Historically, the limit was a lot smaller, like 256 bytes.  </p>\n"}], "owner": {"reputation": 27, "user_id": 2106065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fXhJH.jpg?s=128&g=1", "display_name": "beautifularea", "link": "https://stackoverflow.com/users/2106065/beautifularea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3011, "favorite_count": 1, "closed_date": 1473223202, "accepted_answer_id": 39361239, "answer_count": 1, "score": 1, "last_activity_date": 1580682050, "creation_date": 1473219792, "last_edit_date": 1580682050, "question_id": 39360883, "link": "https://stackoverflow.com/questions/39360883/using-fgets-to-read-a-line-from-stdin-terminal-the-maximum-length-is-1024", "closed_reason": "Duplicate", "title": "Using fgets to read a line from stdin (terminal), the maximum length is 1024?", "body": "<p>Update:<br>\nOSX El Capitan, Xcode 7.3</p>\n\n<p>Input:</p>\n\n<pre><code>0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890001\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define BUFFERSIZE 2048\n\nint \nmain()\n{\n    char buffer[BUFFERSIZE];\n    printf(\"Enter a message: \\n\");\n    while (fgets( buffer, BUFFERSIZE, stdin) != NULL)\n    {\n        printf(\"%s\\n\", buffer);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>compile and run it in terminal.</p>\n\n<pre><code>./test\n</code></pre>\n\n<p>then input one line characters and length is 1024. It doesn't work; it cannot print the buffer. When I input 1023 characters, it will print the 1023 characters. It can print more than 1024 characters which <code>fgets</code> reads from a local open file.</p>\n\n<p>So, with standard input from a terminal, the max length is 1024, even though <code>&lt;syslimits.h&gt;</code> shows ARG_MAX is (256 * 1024).</p>\n\n<p>What is wrong with my code?</p>\n\n<p>I have some references\uff1a</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/3919009/how-to-read-from-stdin-with-fgets\">How to read from stdin with fgets()?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/26718332/c-read-line-from-stdin-with-fgets-in-function\">c-read-line-from-stdin-with-fgets-in-function</a></li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2522, "user_id": 5976576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ec90d5b8c13f25c3eae9fe8a9df6fc8?s=128&d=identicon&r=PG&f=1", "display_name": "MotKohn", "link": "https://stackoverflow.com/users/5976576/motkohn"}, "edited": false, "score": 0, "creation_date": 1473219211, "post_id": 39360722, "comment_id": 66050964, "body": "I am not good at GDB. So might be a silly question. Are you stepping into <code>get_num_accounts</code> or stepping over. If you are stepping over by the time you are reading <code>*num_accounts_ptr</code> it is out of scope."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 2522, "user_id": 5976576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ec90d5b8c13f25c3eae9fe8a9df6fc8?s=128&d=identicon&r=PG&f=1", "display_name": "MotKohn", "link": "https://stackoverflow.com/users/5976576/motkohn"}, "edited": false, "score": 0, "creation_date": 1473219365, "post_id": 39360722, "comment_id": 66050995, "body": "@MotKohn stepping into it , with the &#39;s&#39; command, to step over it is the command &#39;n&#39;"}, {"owner": {"reputation": 2522, "user_id": 5976576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ec90d5b8c13f25c3eae9fe8a9df6fc8?s=128&d=identicon&r=PG&f=1", "display_name": "MotKohn", "link": "https://stackoverflow.com/users/5976576/motkohn"}, "edited": false, "score": 0, "creation_date": 1473219702, "post_id": 39360722, "comment_id": 66051074, "body": "Sorry for asking again but 0x7ffff767c640 does not look like a valid address to me. A little too high, isn&#39;t it?"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 2522, "user_id": 5976576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ec90d5b8c13f25c3eae9fe8a9df6fc8?s=128&d=identicon&r=PG&f=1", "display_name": "MotKohn", "link": "https://stackoverflow.com/users/5976576/motkohn"}, "edited": false, "score": 0, "creation_date": 1473220117, "post_id": 39360722, "comment_id": 66051151, "body": "@MotKohn yes, but it is a shared object, it has a different (virtual) address  space, could be different from the data segment of the main program afaik"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 2522, "user_id": 5976576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ec90d5b8c13f25c3eae9fe8a9df6fc8?s=128&d=identicon&r=PG&f=1", "display_name": "MotKohn", "link": "https://stackoverflow.com/users/5976576/motkohn"}, "edited": false, "score": 0, "creation_date": 1473221213, "post_id": 39360722, "comment_id": 66051366, "body": "There is no malloc() in my code, all variables are statically allocated, so, no bugs of that type are possible"}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1473222665, "post_id": 39360722, "comment_id": 66051725, "body": "If you could provide a short compilable example that people can actually compile and run and reproduce the problem, it would be a lot easier for folks to help."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473222863, "post_id": 39360722, "comment_id": 66051778, "body": "Moreover -- why would you every expect a variable to have the same address on two successive runs of a program? That isn&#39;t something you have control over, that&#39;s up to your OS memory manager. You also cannot draw any correlation between addresses assigned within GDB and without it. GDB uses isn&#39;t own buffers to aid in debugging that are not present when you run your code outside GDB."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1473223655, "post_id": 39360722, "comment_id": 66052003, "body": "@PaulGriffiths , I have made such short compilable example, but it works fine, the address of the global variable remains the same. In my code it is replaced by another address during the call. I do not use mallocs, but maybe I overwrote something in my code and the address of the variable somehow changed ??? If you tell me where to debug or how, that will solve this issue. But I dont know where too look."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473223761, "post_id": 39360722, "comment_id": 66052036, "body": "The point isn&#39;t to say you <i>can&#39;t</i> get the same address back, the point is that you have no guarantee of it happening."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473223767, "post_id": 39360722, "comment_id": 66052040, "body": "@DavidC.Rankin , I have made a short example of a function call passing a global variable, and debugged it with GDB, the address does not change, so GDB is fine."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473223826, "post_id": 39360722, "comment_id": 66052060, "body": "@DavidC.Rankin , the  GDB session posted in the question description is a single run."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1473224433, "post_id": 39360722, "comment_id": 66052226, "body": "I just ran the program without GDB and it runs fine. the num_accounts is set correctly as the data was read from file. It is only when I step through the program with the debugger I see &quot;bugs&quot;. I ran valgrind on my program too, nothing bad was reported. Maybe I found a bug in GDB ???"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1473346955, "post_id": 39360722, "comment_id": 66114780, "body": "I believe I do have a bug despite that the program runs fine, it just doesn&#39;t show up. The variable num_accounts is declared in the code that compiles as a shared library and is loaded at runtime. The only way I fixed it is by moving the num_accounts variable from the library code into the main application code. This was the fix. But I yet do not understand why referencing a global variable declared inside shared library causes this problem."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1473348885, "post_id": 39360722, "comment_id": 66116120, "body": "@PaulGriffiths I have made a short compilable example here: <a href=\"http://stackoverflow.com/questions/39394971/can-i-declare-a-global-variable-in-a-shared-library\" title=\"can i declare a global variable in a shared library\">stackoverflow.com/questions/39394971/&hellip;</a>"}, {"owner": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 0, "creation_date": 1473349941, "post_id": 39360722, "comment_id": 66116815, "body": "Can you compile your program with <code>--warn-common</code> linker flag?"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 0, "creation_date": 1473354618, "post_id": 39360722, "comment_id": 66119308, "body": "@RomanKhimov thanks for the tip! however, adding -Wl,--warn-common produced no warnings"}], "answers": [{"comments": [{"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1473354872, "post_id": 39395715, "comment_id": 66119415, "body": "I think what in the ouput &quot; (num_accounts_ptr=0x604780 &lt;num_accounts&gt;) &quot; GDB is saying is that num_accounts_ptr is pointing to the &quot;num_accounts&quot;, which is a global variable. In fact, I am passing as a parameter the global variable itself. I do not need to do this because the variable is global and I can access it anywhere, but passing it in a parameter is valid too. I do not have duplicated symbols, otherwise I wouldn&#39;t be able to link"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1473361348, "post_id": 39395715, "comment_id": 66122742, "body": "Duplicate symbols between a shared lib and an executable will not prevent linking unless you specifically request it with the appropriate linking flags.  Try running nm on both your executable and shared library and seeing which symbols are defined in each."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1473350932, "creation_date": 1473350932, "answer_id": 39395715, "question_id": 39360722, "link": "https://stackoverflow.com/questions/39360722/getting-incorrect-address-of-a-variable-during-a-function-call/39395715#39395715", "title": "getting incorrect address of a variable during a function call", "body": "<p>You have two distinct symbols called <code>num_accounts</code> in the executable image that gdb is looking at.  gdb tells you that directly, as whenever you tell it to print something that has a pointer-type value, gdb will do a reverse-lookup on that address in the symbol table of the executable and, if it finds something, will print the name of the symbol in &lt;>.  So when you do the gdb command:</p>\n\n<pre><code>(gdb) print &amp;num_accounts\n$2 = (account_idx_t *) 0x7ffff767c640 &lt;num_accounts&gt;\n</code></pre>\n\n<p>gdb is telling you that <code>0x7ffff767c640</code> points at a symbol called <code>num_accounts</code>.  Similarly,</p>\n\n<pre><code>(gdb) print num_accounts_ptr\n$6 = (account_idx_t *) 0x604780 &lt;num_accounts&gt;\n</code></pre>\n\n<p>tells you <code>0x604780</code> points at a symbol that is also called <code>num_accounts</code>.</p>\n\n<p>Now the question is how you got two symbols with the same name.  The large address <code>0x7ffff767c640</code> is going to be in a shared library, as shared libraries load at addresses like that.  The small address <code>0x604780</code> is in the base executable.</p>\n"}], "owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473350932, "creation_date": 1473218461, "question_id": 39360722, "link": "https://stackoverflow.com/questions/39360722/getting-incorrect-address-of-a-variable-during-a-function-call", "title": "getting incorrect address of a variable during a function call", "body": "<p>I am losing the address of a (global) variable (defined in a shared object) when a function call is made. To prove it, I intentionally set the value of the variable num_accounts to 55, when the function get_num_accounts() began the execution, the pointer to this variable was received incorrectly. My proof is this gdb session:</p>\n\n<pre><code>accounts_init () at accounts.c:31\n31      err_code=read_accounts();\n(gdb) print num_accounts\n$1 = 0\n(gdb) print &amp;num_accounts\n$2 = (account_idx_t *) 0x7ffff767c640 &lt;num_accounts&gt;\n(gdb) set var num_accounts=55\n(gdb) print num_accounts\n$3 = 55\n(gdb) s\nread_accounts () at accounts.c:66\n66      err_code=get_num_accounts(&amp;num_accounts);\n(gdb) s\nget_num_accounts (num_accounts_ptr=0x604780 &lt;num_accounts&gt;) at accounts.c:119\n119     *num_accounts_ptr=0;\n(gdb) print num_accounts\n$4 = 55\n(gdb) print *num_accounts_ptr\n$5 = 0\n(gdb) \n(gdb) print num_accounts_ptr\n$6 = (account_idx_t *) 0x604780 &lt;num_accounts&gt;\n(gdb) \n</code></pre>\n\n<p>The address of the variable num_accounts is <strong>0x7ffff767c640</strong> , but I get <strong>0x604780</strong> when the function is executed, why such a weird stuff happens ?</p>\n\n<p>The source code of the function <strong>get_num_accounts()</strong> is this:</p>\n\n<pre><code>err_code_t get_num_accounts(account_idx_t *num_accounts_ptr) {\n    err_code_t err_code;\n    uint32_t file_size;\n    div_t div_result;\n    unsigned short number;\n\n    *num_accounts_ptr=0;\n    err_code=get_dir();\n    if (err_code!=ERR_NO_ERROR) return err_code;\n    err_code=get_file(ACCOUNTS_FILENAME,sizeof(ACCOUNTS_FILENAME),&amp;file_size);\n    if (err_code!=ERR_NO_ERROR) return err_code;\n\n    div_result=div(file_size,sizeof(tbl_account_t));\n    if (div_result.rem!=0) {\n        return ERR_BAD_CONFIG_FILE_FORMAT;\n    }\n    number=div_result.quot;\n    *num_accounts_ptr=number;\n    return ERR_NO_ERROR;\n}\n</code></pre>\n\n<p>Type account_idx_t is defined as:</p>\n\n<pre><code>typedef         unsigned short          account_idx_t;\n</code></pre>\n\n<p>The global variable num_accounts is defined in accounts.c file at the beginning:</p>\n\n<pre><code>account_idx_t       num_accounts=0;\n</code></pre>\n\n<p>Basically, what the function does, is to get the size of the file and calculate the number of records that the file contains, before reading it. (its a database)</p>\n\n<p>And this is the calling code, which calles get_num_accounts() function:</p>\n\n<pre><code>err_code_t accounts_init(void) {\n    err_code_t err_code;\n\n    err_code=read_accounts();\n    if (err_code!=ERR_NO_ERROR) return err_code;\n\n    return ERR_NO_ERROR;\n}\nerr_code_t read_accounts(void) {\n    err_code_t err_code;\n    int ret;\n\n    err_code=get_num_accounts(&amp;num_accounts);\n    if (err_code!=ERR_NO_ERROR) return err_code;\n    if (num_accounts==0) return ERR_NO_ERROR;\n\n    int fd=open(filename_buf,O_RDONLY); // filename_buf is global, it holds filename from previous call\n    if (fd==-1) {\n        return ERR_SYS_ERROR;\n    }\n    ret=read(fd,accounts,sizeof(tbl_account_t)*num_accounts);\n    if (ret==-1) {\n        return ERR_SYS_ERROR;\n    }\n    ret=close(fd);  // TO_DO: validate return value of close(fd)\n    if (ret==-1) {\n        return ERR_SYS_ERROR;\n    }\n    return ERR_NO_ERROR;\n}\n</code></pre>\n\n<p>I am compiling the library with -fPIC flag:</p>\n\n<pre><code>[niko@dev1 src]$ make accounts.o\ngcc -g -ffunction-sections -fdata-sections -Wall -Wextra -Wunreachable-code -Wmissing-prototypes -Wmissing-declarations -Wunused -Winline -Wstrict-prototypes -Wimplicit-function-declaration -Wformat -D_GNU_SOURCE -fshort-enums -fPIC -c accounts.c\n</code></pre>\n\n<p>There is no another 'num_accounts' symbol anywhere in the source code, I double checked that:</p>\n\n<pre><code>[niko@dev1 src]$ nm *o|grep num_accounts \n0000000000000000 T get_num_accounts\n0000000000000000 B num_accounts\n[niko@dev1 src]$ \n</code></pre>\n\n<p>Any suggestion on further debugging steps?</p>\n"}, {"tags": ["c", "mode"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 2, "creation_date": 1473217198, "post_id": 39360552, "comment_id": 66050571, "body": "Your second-last <code>if</code> accesses one past the last element of the array, and should the two statements after the last <code>if</code> be in <code>{}</code>?"}, {"owner": {"reputation": 327, "user_id": 6581455, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-ZRKH7WIHZVQ/AAAAAAAAAAI/AAAAAAAAChM/YJPpyK-CRro/photo.jpg?sz=128", "display_name": "The-Han-Emperor", "link": "https://stackoverflow.com/users/6581455/the-han-emperor"}, "reply_to_user": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1473217676, "post_id": 39360552, "comment_id": 66050656, "body": "I include them in one {}, but it still doesn&#39;t work the way I want"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1473218129, "post_id": 39360552, "comment_id": 66050754, "body": "Use a debugger and/or debug print statements to trace the execution of your program."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473222514, "post_id": 39360552, "comment_id": 66051683, "body": "You can use <code>else</code> instead of repeating the test with <code>!=</code> instead of <code>==</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4665, "user_id": 6383857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPDaW.jpg?s=128&g=1", "display_name": "StaticBeagle", "link": "https://stackoverflow.com/users/6383857/staticbeagle"}, "is_accepted": true, "score": 0, "last_activity_date": 1473223103, "creation_date": 1473223103, "answer_id": 39361307, "question_id": 39360552, "link": "https://stackoverflow.com/questions/39360552/wrote-my-code-to-look-for-a-mode-but-gives-me-the-largest-number/39361307#39361307", "title": "Wrote my code to look for a mode but gives me the largest number", "body": "<p>I've modified your code using <code>if</code> and <code>else</code> combo to count the number of occurrences of a given number or <code>else</code> start over by setting the counter to one. In the last if you can check whether or not the current occurrence count is bigger than the one we've stored before and swap the current mode and size.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct mode\n{\n  int self;\n  int size;\n} mode;\n\nmode findmode(int *arr, int size) \n{\n  mode x;\n  x.self = arr[0];\n  x.size = 1;\n  int i;\n  int count = 1;\n  for (i = 1; i &lt; size; i++) \n  {\n      if(arr[i - 1] == arr[i])\n      {\n          count++;\n      }\n      else\n      {\n          count = 1;\n      }\n      if(count &gt;= x.size)\n      {\n          x.self = arr[i];\n          x.size = count;\n      }\n  }\n  return x;\n}\n\nint main()\n{\n   int  arr[20] = {1,1,1,4,4,4,4,5,5,5,5,5,5,6,6,7,7,7,8,8};\n   mode m = findmode(arr, 20);\n\n   printf(\"The mode is %d with a occurrence count of %d\\n\", m.self, m.size);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 327, "user_id": 6581455, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-ZRKH7WIHZVQ/AAAAAAAAAAI/AAAAAAAAChM/YJPpyK-CRro/photo.jpg?sz=128", "display_name": "The-Han-Emperor", "link": "https://stackoverflow.com/users/6581455/the-han-emperor"}, "is_accepted": false, "score": 1, "last_activity_date": 1473224492, "creation_date": 1473224492, "answer_id": 39361526, "question_id": 39360552, "link": "https://stackoverflow.com/questions/39360552/wrote-my-code-to-look-for-a-mode-but-gives-me-the-largest-number/39361526#39361526", "title": "Wrote my code to look for a mode but gives me the largest number", "body": "<p>I also figured that out by my self. Thank you so much guys for helping me tho.\nhere is my new code.</p>\n\n<pre><code>mode findmode(int *arr,int size)\n{\nmode x;\nint i=0;\nint count=1;\nx.size=0;\n   for(i=0;i&lt;size;i++)\n   {\n    if(i&gt;0)\n    {\n        if(arr[i]==arr[i-1])\n        {\n            ++count;\n\n\n        }\n\n        if (arr[i]!=arr[i-1])\n        {\n            if(count&gt;x.size)\n            {x.size=count;\n            x.self=arr[i-1];}   \n            count= 0;\n            ++count;\n\n\n\n        }\n    }\n\n    }\n    return x;\n}\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6581455, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-ZRKH7WIHZVQ/AAAAAAAAAAI/AAAAAAAAChM/YJPpyK-CRro/photo.jpg?sz=128", "display_name": "The-Han-Emperor", "link": "https://stackoverflow.com/users/6581455/the-han-emperor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 39361307, "answer_count": 2, "score": 0, "last_activity_date": 1473224492, "creation_date": 1473216849, "last_edit_date": 1473217874, "question_id": 39360552, "link": "https://stackoverflow.com/questions/39360552/wrote-my-code-to-look-for-a-mode-but-gives-me-the-largest-number", "title": "Wrote my code to look for a mode but gives me the largest number", "body": "<p>I'm trying to find the mode of an sorted array, so I wrote the following code; However, it gives me the largest number in that array. </p>\n\n<p>Can anyone help me out?</p>\n\n<pre><code>typedef struct mode {\n  int self;\n  int size;\n} mode;\n\nmode findmode(int *arr, int size) {\n  mode x;\n  int i = 0;\n  int count = 1;\n  for (i = 0; i &lt; size; i++) {\n    if (i &gt; 1 &amp;&amp; i &lt; size) {\n      if (arr[i] == arr[i - 1]) ++count;\n      if (arr[i] != arr[i - 1]) {\n        x.size = count;\n        x.self = arr[i - 1];\n        count = 0;\n        ++count;\n      }\n      if (arr[i] != arr[i + 1]) {\n        if (count &gt; x.size) x.size = count;\n        x.self = arr[i];\n      }\n    }\n  }\n  return x;\n}\n</code></pre>\n"}, {"tags": ["java", "python", "c", "node.js"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 3, "creation_date": 1473215996, "post_id": 39360403, "comment_id": 66050345, "body": "<a href=\"http://jayconrod.com/posts/54/a-tour-of-v8-crankshaft-the-optimizing-compiler\" rel=\"nofollow noreferrer\">v8</a> is <i>optimizing</i>. In fact, <i>v8</i> is <b>very</b> <i>optimizing</i>. However, <b><i>beware</i></b> micro-benchmarks."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 1, "creation_date": 1473216116, "post_id": 39360403, "comment_id": 66050372, "body": "maybe you are putting a finger onto something with the <code>long</code> to <code>double</code> conversion, these might be costly on the long run"}, {"owner": {"reputation": 2298, "user_id": 2547372, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a08da629e075eaf15789c12d3341d8c4?s=128&d=identicon&r=PG", "display_name": "enRaiser", "link": "https://stackoverflow.com/users/2547372/enraiser"}, "edited": false, "score": 1, "creation_date": 1473216271, "post_id": 39360403, "comment_id": 66050395, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/27432973/why-is-this-nodejs-2x-faster-than-native-c\">Why is this NodeJS 2x faster than native C?</a>"}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "reply_to_user": {"reputation": 2298, "user_id": 2547372, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a08da629e075eaf15789c12d3341d8c4?s=128&d=identicon&r=PG", "display_name": "enRaiser", "link": "https://stackoverflow.com/users/2547372/enraiser"}, "edited": false, "score": 1, "creation_date": 1473216475, "post_id": 39360403, "comment_id": 66050427, "body": "@enRaiser Here, <code>gcc</code> is being passed <code>-O2</code> already."}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1473216704, "post_id": 39360403, "comment_id": 66050470, "body": "I wonder if using <code>-m64</code> to force a 64-bit build would make a difference? v8 can probably optimise for the current processor, but without flags gcc is building a generic executable for the whole x86 family?"}, {"owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "edited": false, "score": 1, "creation_date": 1473218696, "post_id": 39360403, "comment_id": 66050858, "body": "-O2 -m64 dropped the average on three runs from 6.66 to 6.41 seconds, but the results vary by a couple of tenths of a second each time so I can&#39;t say it actually had any significant result."}, {"owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "edited": false, "score": 0, "creation_date": 1473218844, "post_id": 39360403, "comment_id": 66050893, "body": "Is there a more representative benchmark or a standard benchmark that can be used in these languages?"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1473221078, "post_id": 39360403, "comment_id": 66051340, "body": "Compile C code with -msse4.2 option and check if the results improve"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473223344, "post_id": 39360403, "comment_id": 66051915, "body": "Remove the register keywords and install the latest version of gcc."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 1, "creation_date": 1473223914, "post_id": 39360403, "comment_id": 66052083, "body": "@dvhh You&#39;re right, the conversion of i to double on each iterations costs about 20%."}, {"owner": {"reputation": 1137, "user_id": 3395374, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/285a4a5200f609969d811d471ae2c846?s=128&d=identicon&r=PG&f=1", "display_name": "Muposat", "link": "https://stackoverflow.com/users/3395374/muposat"}, "edited": false, "score": 1, "creation_date": 1473225084, "post_id": 39360403, "comment_id": 66052412, "body": "On my AMD A8-5500: gcc 5.4.0 -- 4.5 s; nodejs 4.2.6 -- 4.7 s"}, {"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1473225946, "post_id": 39360403, "comment_id": 66052682, "body": "It feels like that squareroot is giving js an unfair edge, because it only knows doubles as @dvhh noted.You might want to see if letting them all use a truncated long integer squareroot that pulls out no real operations might make it closer. Here is such a function that uses the fact that sum of the first n odd numbers is n^2. var truncSqrt=function(n){ var oddNumber=1; var result=0; while (n&gt;=oddNumber) {n-=oddNumber; oddNumber+=2; result++; } return result; }//wrote in js, freshest for me"}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1473226200, "post_id": 39360403, "comment_id": 66052774, "body": "Related question : <a href=\"https://www.quora.com/How-can-the-performance-of-Node-js-be-better-than-Java-Python-PHP-or-C\" rel=\"nofollow noreferrer\">quora.com/&hellip;</a>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1473280120, "post_id": 39360403, "comment_id": 66084926, "body": "The call to sqrt is actually completely unnecessary. You could replace the test with <code>i*i&lt;=n</code>, for example. And what on earth is the point of <code>if (n % 1)      return false;</code>? If n is an integer, <code>n%1</code> is never true (and in C, <code>%</code> is only defined for integer arguments)."}, {"owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1473295003, "post_id": 39360403, "comment_id": 66089572, "body": "I tried changing the sort to i<i>i &lt;= n as @rici suggested.  The execution time for the c code went from 6.66 to 7.22 seconds.  I think this is because the sqrt() is only called once each isPrime(), where as the i</i>i is calculated each pass of the for loop.  I profiled this program in Xcode on a different computer and found that the sqrt() is only 0.02% of the execution time.  This is because the sqrt() is only called once for each isPrime() call and only if the other tests prior to it fail to catch a non prime number.  This seems to rule out sqrt()."}, {"owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "edited": false, "score": 0, "creation_date": 1473295061, "post_id": 39360403, "comment_id": 66089586, "body": "I had to modify the program somewhat to get a profile of where the execution is taking place"}, {"owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "edited": false, "score": 0, "creation_date": 1473295408, "post_id": 39360403, "comment_id": 66089644, "body": "I had to modify the program somewhat to get a profile of where the execution is taking place. 52.5% inside the for loop of isPrime(), 47.1% in isPrime() just prior to the for loop with the if statments and &lt; 0.1% calculating the sqrt and about 0.3% in main.  My conclusion is that sqrt is not skewing the results."}, {"owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "reply_to_user": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1473295530, "post_id": 39360403, "comment_id": 66089662, "body": "I tried the -msse4.2 parameter as @Nulik suggested.  Execution time dropped from 6.66 to 6.62 seconds."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1473314093, "post_id": 39360403, "comment_id": 66094097, "body": "@timothy: yes, the problem isn&#39;t really the sqrt but rather the conversion from int to float (unless the compiler optimizes it away). But it&#39;s not going be a big difference. I&#39;d suggest getting rid of all those tests at the entry to isPrime by starting with <code>if (n &lt; 6) switch n) ...</code> That won&#39;t help much, but it is at least noticeable."}, {"owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1473373250, "post_id": 39360403, "comment_id": 66128146, "body": "@rici I put sqrt inside a function that returns a long and it made essentially no difference in execution time.  Is there another conversion from into to float with the modulus or something else?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1473382079, "post_id": 39360403, "comment_id": 66130277, "body": "@timothy: You don&#39;t need a function. C(++) will happily truncate a double to a long in an assignment operator. As I said, it won&#39;t make much difference (particularly on x86 hardware). For me, changing <code>i</code> from <code>long</code> to <code>unsigned int</code> made the most difference (about 15%). (This must be safe on x86 since the square root of a 63-bit signed long will definitely fit in a 32 unsigned int.) I also changed <code>sqrtOfN</code> to the same type, which made about 5% difference."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 27522, "user_id": 6394138, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/u64Lc.png?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/6394138/leon"}, "edited": false, "score": 0, "creation_date": 1489586238, "post_id": 39360403, "comment_id": 72735793, "body": "@Leon This question has been reopened.  You can submit your answer now."}], "answers": [{"tags": [], "owner": {"reputation": 27522, "user_id": 6394138, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/u64Lc.png?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/6394138/leon"}, "is_accepted": true, "score": 32, "last_activity_date": 1489593446, "last_edit_date": 1489593446, "creation_date": 1489593076, "answer_id": 42814674, "question_id": 39360403, "link": "https://stackoverflow.com/questions/39360403/how-can-node-js-be-faster-than-c-and-java-benchmark-comparing-node-js-c-java/42814674#42814674", "title": "How can node.js be faster than c and java? Benchmark comparing node.js, c, java and python", "body": "<p>I spent a couple of days investigating the performance difference between JS/V8 and C, focusing first of all on the Hydrogen IR generated by the V8 engine. However, after making sure that no extraordinary optimizations are present there, I got back to the analysis of the assembly output and it struck me that the answer was a very simple one, boiling down to the couple of sentences in <a href=\"http://jayconrod.com/posts/52/a-tour-of-v8-object-representation\" rel=\"noreferrer\">Jay Conrod's blog post</a> on internals of V8:</p>\n\n<blockquote>\n  <p>According to the spec, all numbers in JavaScript are 64-bit floating point doubles. We frequently work with integers though, so <strong><em>V8 represents numbers with 31-bit signed integers whenever possible</em></strong>.</p>\n</blockquote>\n\n<p>The example at hand allows fitting all computations in 32 bits and node.js takes full advantage of that! The C code utilizes the <code>long</code> type, which on OP's (as well as my) platform happens to be a 64-bit type. Thus, it is a 32-bit arithmetic vs 64-bit arithmetic issue, mostly due to the expensive division/remainder operation.</p>\n\n<p>If <code>long</code> in the C code is replaced with <code>int</code>, then the binary produced by gcc beats node.js.</p>\n\n<p>Also, if the loop is made to look for primes over a range that is outside the realm of 32-bit numbers the performance of the node.js version drops significantly.</p>\n\n<hr>\n\n<h2>Proof</h2>\n\n<p>The used source code is found further in the answer, below the results.</p>\n\n<blockquote>\n  <h3>Counting primes less than 10 million with C and node.js</h3>\n</blockquote>\n\n<pre><code>$ gcc count_primes.c -std=c99 -O3 -lm -o count_primes_long\n$ sed 's/long/int/g; s/%li/%i/g' count_primes.c &gt; count_primes_int.c\n$ gcc count_primes_int.c -std=c99 -O3 -lm -o count_primes_int\n\n# Count primes &lt;10M using C code with (64-bit) long type\n$ time ./count_primes_long 0 10000000\nThe range [0, 10000000) contains 664579 primes\n\nreal    0m4.394s\nuser    0m4.392s\nsys 0m0.000s\n\n# Count primes &lt;10M using C code with (32-bit) int type\n$ time ./count_primes_int 0 10000000\nThe range [0, 10000000) contains 664579 primes\n\nreal    0m1.386s\nuser    0m1.384s\nsys 0m0.000s\n\n# Count primes &lt;10M using node.js/V8 which transparently does the\n# job utilizing 32-bit types\n$ time nodejs ./count_primes.js 0 10000000\nThe range [ 0 , 10000000 ) contains 664579 primes\n\nreal    0m1.828s\nuser    0m1.820s\nsys 0m0.004s\n</code></pre>\n\n<blockquote>\n  <h3>Performance figures in the vicinity of the limit of signed 32-bit integers</h3>\n</blockquote>\n\n<p>Counting the primes in the range of length 100,000 starting at the number contained in the first column:</p>\n\n<pre><code>              | node.js | C (long) \n-----------------------------------\n2,000,000,000 | 0.293s  | 0.639s    # fully within the 32-bit range\n-----------------------------------\n2,147,383,647 | 0.296s  | 0.655s    # fully within the 32-bit range\n-----------------------------------\n2,147,453,647 | 2.498s  | 0.646s    # 50% within the 32-bit range\n-----------------------------------\n2,147,483,647 | 4.717s  | 0.652s    # fully outside the 32-bit range\n-----------------------------------\n3,000,000,000 | 5.449s  | 0.755s    # fully outside the 32-bit range\n-----------------------------------\n</code></pre>\n\n<hr>\n\n<p><strong>count_primes.js</strong></p>\n\n<pre><code>\"use strict\";\n\nvar isPrime = function(n){\n    if (n &lt; 2) {return false};\n    if (n === 2) {return true};\n    if (n === 3) {return true};\n    if (n % 2 === 0) {return false};\n    if (n % 3 === 0) {return false};\n    var sqrtOfN = Math.sqrt(n);\n    for (var i = 5; i &lt;= sqrtOfN; i += 6){\n        if (n % i === 0) {return false}\n        if (n % (i + 2) === 0) {return false}\n    }\n    return true;\n};\n\nvar countPrime = function(S, E){\n    var count = 0;\n    for (let i = S; i &lt; E;i++){\n        if ( isPrime(i) ) { ++count; }\n    }\n    return count;\n};\n\nif( process.argv.length != 4) {\n    console.log('Usage: nodejs count_prime.js &lt;range_start&gt; &lt;range_length&gt;');\n    process.exit();\n}\n\nvar S = parseInt(process.argv[2]);\nvar N = parseInt(process.argv[3]);\nvar E = S+N;\nvar P = countPrime(S, E);\nconsole.log('The range [', S, ',', E, ') contains', P, 'primes');\n</code></pre>\n\n<hr>\n\n<p><strong>count_primes.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n#define true 1\n#define false 0\n\nint isPrime (register long n){\n    if (n &lt; 2)      return false;\n    if (n == 2)     return true;\n    if (n == 3)     return true;\n    if (n % 2 == 0) return false;\n    if (n % 3 == 0) return false;\n    double sqrtOfN = sqrt(n);\n    for (long i = 5; i &lt;= sqrtOfN; i += 6){\n        if (n % i == 0) return false;\n        if (n % (i + 2) == 0) return false;\n    }\n    return true;\n};\n\nint main(int argc, const char * argv[]) {\n    if ( argc != 3 ) {\n        fprintf(stderr, \"Usage: count_primes &lt;range_start&gt; &lt;range_length&gt;\\n\");\n        exit(1);\n    }\n    const long S = atol(argv[1]);\n    const long N = atol(argv[2]);\n    register long count = 0;\n    for (register long i = S; i &lt; S + N; i++){\n        if ( isPrime(i) ) ++count;\n    }\n    printf(\"The range [%li, %li) contains %li primes\\n\", S, S+N, count);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13137850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6d4b926d32b994d139a2bdf76b8f5c?s=128&d=identicon&r=PG", "display_name": "Randiaz", "link": "https://stackoverflow.com/users/13137850/randiaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1585348076, "last_edit_date": 1585348076, "creation_date": 1585343623, "answer_id": 60894196, "question_id": 39360403, "link": "https://stackoverflow.com/questions/39360403/how-can-node-js-be-faster-than-c-and-java-benchmark-comparing-node-js-c-java/60894196#60894196", "title": "How can node.js be faster than c and java? Benchmark comparing node.js, c, java and python", "body": "<p>When I ran your code in python with a new algorithm:</p>\n\n<pre><code>real    0m3.583s\nuser    0m3.297s\nsys     0m0.094s\n</code></pre>\n\n<p>Faster than the C benchmark you have above. I think that a simpler language helps you design better algorithms, but that is my opinion.\n(Also can use multiprocessing to make even faster)</p>\n\n<pre><code>def allPrimes(N):\n    is_prime = [1]*N\n    # We know 0 and 1 are composites\n    is_prime[0] = 0\n    is_prime[1] = 0\n\n    i = 2\n    # This will loop from 2 to int(sqrt(x))\n    while i*i &lt;= N:\n        # If we already crossed out this number, then continue\n        if is_prime[i] == 0:\n            i += 1\n            continue\n\n        j = 2*i\n        while j &lt; N:\n            # Cross out this as it is composite\n            is_prime[j] = 0\n            # j is incremented by i, because we want to cover all multiples of i\n            j += i\n\n        i += 1\n    return is_prime\n\n\n\n\nprint(\"total\", sum(allPrimes(10000000)))\n</code></pre>\n"}], "owner": {"reputation": 1889, "user_id": 3029576, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49d6e2443cbe31fde9e80f42ee445263?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Vann", "link": "https://stackoverflow.com/users/3029576/timothy-vann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6400, "favorite_count": 11, "accepted_answer_id": 42814674, "answer_count": 2, "score": 25, "last_activity_date": 1585348076, "creation_date": 1473215477, "last_edit_date": 1495539993, "question_id": 39360403, "link": "https://stackoverflow.com/questions/39360403/how-can-node-js-be-faster-than-c-and-java-benchmark-comparing-node-js-c-java", "title": "How can node.js be faster than c and java? Benchmark comparing node.js, c, java and python", "body": "<p>I made a very simple benchmarking program that calculates all the prime numbers up to 10,000,000 in 4 different languages. </p>\n\n<ul>\n<li>(2.97 seconds) - node.js (javascript) (4.4.5) </li>\n<li>(6.96 seconds) - c (c99)</li>\n<li>(6.91 seconds) - java (1.7) </li>\n<li>(45.5 seconds) - python (2.7)</li>\n</ul>\n\n<p><em>above is average of 3 runs each, user time</em></p>\n\n<p>Node.js runs by far the fastest.  This is confusing to me for two reasons: </p>\n\n<ol>\n<li>javascript always uses double precision floats for variables while c and java are using (long) integers in this case.  Math with integers should be faster. </li>\n<li>javascript is often referred to as interpreted when actually it is a just in time compiled language.  But even so how can the JIT compiler be faster than a fully compiled language? \nThe python code runs the slowest which is no surprise, but why isn't the node.js code running at a similar speed to the python?</li>\n</ol>\n\n<p>I compiled the c code with -O2 optimization, but I tried it with all levels of optimization and it didn't make a noticeable difference.  </p>\n\n<h2>countPrime.js</h2>\n\n<pre><code>\"use strict\";\n\nvar isPrime = function(n){\n    //if (n !== parseInt(n,10)) {return false};\n    if (n &lt; 2) {return false};\n    if (n === 2) {return true};\n    if (n === 3) {return true};\n    if (n % 2 === 0) {return false};\n    if (n % 3 === 0) {return false};\n    if (n % 1) {return false};\n    var sqrtOfN = Math.sqrt(n);\n    for (var i = 5; i &lt;= sqrtOfN; i += 6){\n        if (n % i === 0) {return false}\n        if (n % (i + 2) === 0) {return false}\n    }\n    return true;\n};\n\nvar countPrime = function(){\n    var count = 0;\n    for (let i = 1; i &lt; 10000000;i++){\n        if (isPrime(i)){\n            count++;\n        }\n    }\n    console.log('total',count);\n};\n\ncountPrime();\n</code></pre>\n\n<h2>node.js results</h2>\n\n<pre><code>$ time node primeCalc.js\ntotal 664579\n\nreal    0m2.965s\nuser    0m2.928s\nsys     0m0.016s\n\n$ node --version\nv4.4.5\n</code></pre>\n\n<h2>primeCalc.c</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\n#define true 1\n#define false 0\n\nint isPrime (register long n){\n    if (n &lt; 2)      return false;\n    if (n == 2)     return true;\n    if (n == 3)     return true;\n    if (n % 2 == 0) return false;\n    if (n % 3 == 0) return false;\n    if (n % 1)      return false;\n    double sqrtOfN = sqrt(n);\n    for (long i = 5; i &lt;= sqrtOfN; i += 6){\n        if (n % i == 0) return false;\n        if (n % (i + 2) == 0) return false;\n    }\n    return true;\n};\n\nint main(int argc, const char * argv[]) {\n    register long count = 0;\n    for (register long i = 0; i &lt; 10000000; i++){\n        if (isPrime(i)){\n            count++;\n        }\n    }\n\n    printf(\"total %li\\n\",count);\n    return 0;\n}\n</code></pre>\n\n<h2>c results</h2>\n\n<pre><code>$ gcc primeCalc.c -lm -g -O2 -std=c99 -Wall\n$ time ./a.out\ntotal 664579\nreal    0m6.718s\nuser    0m6.668s\nsys     0m0.008s\n</code></pre>\n\n<h2>PrimeCalc.java</h2>\n\n<p>public class PrimeCalc {</p>\n\n<pre><code>  public static void main(String[] args) {\n     long count = 0;\n     for (long i = 0; i &lt; 10000000; i++){\n        if (isPrime(i)){\n           count++;\n        }\n     }\n     System.out.println(\"total \"+count);\n  }\n\n\n  public static boolean isPrime(long n) {\n     if (n &lt; 2)      return false;\n     if (n == 2)     return true;\n     if (n == 3)     return true;\n     if (n % 2 == 0) return false;\n     if (n % 3 == 0) return false;\n     if (n % 1 &gt; 0)  return false;\n     double sqrtOfN = Math.sqrt(n);\n     for (long i = 5; i &lt;= sqrtOfN; i += 6){\n        if (n % i == 0) return false;\n        if (n % (i + 2) == 0) return false;\n     }\n     return true;\n  };\n\n}\n</code></pre>\n\n<h2>java results</h2>\n\n<pre><code> $ javac PrimeCalc.java \n $ time java PrimeCalc\n total 664579\n real    0m7.197s\n user    0m7.036s\n sys     0m0.040s\n $ java -version\n java version \"1.7.0_111\"\n OpenJDK Runtime Environment (IcedTea 2.6.7) (7u111-2.6.7-0ubuntu0.14.04.3)\n OpenJDK 64-Bit Server VM (build 24.111-b01, mixed mode)\n</code></pre>\n\n<h2>primeCalc.py</h2>\n\n<pre><code>import math\n\ndef isPrime (n):\n    if n &lt; 2       : return False\n    if n == 2      : return True\n    if n == 3      : return True\n    if n % 2 == 0  : return False\n    if n % 3 == 0  : return False\n    if n % 1 &gt;0    : return False\n    sqrtOfN = int(math.sqrt(n)) + 1\n    for i in xrange (5, sqrtOfN, 6):\n        if n % i == 0       : return False;\n        if n % (i + 2) == 0 : return False;\n    return True\n\ncount = 0;\nfor i in xrange(10000000) :\n    if isPrime(i) :\n        count+=1\n\nprint \"total \",count\n</code></pre>\n\n<h2>python results</h2>\n\n<pre><code>time python primeCalc.py\ntotal  664579\nreal    0m46.588s\nuser    0m45.732s\nsys     0m0.156s \n$ python --version\nPython 2.7.6 \n</code></pre>\n\n<h2>linux</h2>\n\n<pre><code>$ uname -a\nLinux hoarfrost-node_6-3667558 4.2.0-c9 #1 SMP Wed Sep 30 16:14:37 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n\n<h2>additional c run times (addendum)</h2>\n\n<ul>\n<li>(7.81 s) no optimization, gcc primeCalc.c -lm -std=c99 -Wall</li>\n<li>(8.13 s) optimization 0, gcc primeCalc.c -lm -O0 -std=c99 -Wall</li>\n<li>(7.30 s) optimization 1, gcc primeCalc.c -lm -O1 -std=c99 -Wall</li>\n<li><p>(6.66 s) optimization 2, gcc primeCalc.c -lm -O2 -std=c99 -Wall</p>\n\n<ul>\n<li>average of 3 new runs each optimization level user time *</li>\n</ul></li>\n</ul>\n\n<p>I read the post here:\n<a href=\"https://stackoverflow.com/questions/27432973/why-is-this-nodejs-2x-faster-than-native-c\">Why is this NodeJS 2x faster than native C?</a>\nThis code uses an example that doesn't actually do anything significant.    It's as if the compiler can figure out the result at compile time and it doesn't even need to execute the loop 100000000 times to come up with the answer.\nIf one adds another division step to the calculation the optimization is much less significant.</p>\n\n<pre><code>for (long i = 0; i &lt; 100000000; i++) {\n  d += i &gt;&gt; 1;    \n  d = d / (i +1); // &lt;-- New Term \n}\n</code></pre>\n\n<ul>\n<li>(1.88 seconds) without optimization </li>\n<li>(1.53 seconds) with optimization (-O2)</li>\n</ul>\n\n<hr>\n\n<p><strong>Update 03/15/2017</strong>\nAfter reading the answer from @leon I ran a few verification tests.</p>\n\n<p><strong>Test 1 - 32 Bit Beaglebone Black, 664,579 primes up to 10,000,000</strong></p>\n\n<p>Unedited calcPrime.js and calcPrime.c running on the Beaglebone black which has a 32 bit processor.</p>\n\n<ul>\n<li>C code = 62 seconds   (gcc, long datatype)</li>\n<li>JS code = 102 seconds  (node v4)</li>\n</ul>\n\n<p><strong>Test 2 - 64 Bit Macbook Pro, 664,579 primes up to 10,000,000</strong></p>\n\n<p>Replace long datatypes in calcPrime.c code with uint32_t and running on my MacBook pro which has a 64 bit processor.</p>\n\n<ul>\n<li>C code = 5.73 seconds (clang, long datatype)</li>\n<li>C code = 2.43 seconds (clang, uint_32_t datatype)</li>\n<li>JS code = 2.12 seconds (node v4)</li>\n</ul>\n\n<p><strong>Test 3 - 64 Bit Macbook Pro, 91,836 primes (i=1; i &lt; 8,000,000,000; i+=10000)</strong></p>\n\n<p>Use unsigned long datatypes in C code, force javascript to use some 64 bit.\n - C code = 20.4 seconds (clang, long datatype) \n - JS code = 17.8 seconds (node v4)</p>\n\n<p><strong>Test 4 - 64 Bit Macbook Pro, 86,277 primes (i = 8,000,00,001; i &lt; 16,000,000,000; i+=10000)</strong></p>\n\n<p>Use unsigned long datatypes in C code, force javascript to use all 64 bit.\n - C code = 35.8 seconds (clang, long datatype) \n - JS code = 34.1  seconds (node v4)</p>\n\n<p><strong>Test 5 - Cloud9 64-Bit Linux, (i = 0; i &lt; 10000000; i++)</strong></p>\n\n<pre><code>language    datatype    time    % to C\njavascript  auto        3.22      31%\nC           long        7.95     224%\nC           int         2.46       0%\nJava        long        8.08     229%\nJava        int         2.15     -12%\nPython      auto       48.43    1872%\nPypy        auto        9.51     287%\n</code></pre>\n\n<p><strong>Test 6 - Cloud9 64-Bit Linux, (i = 8000000001; i &lt; 16000000000;i+=10000)</strong></p>\n\n<pre><code>javascript  auto       52.38      12%\nC           long       46.80       0%\nJava        long       49.70       6%\nPython      auto      268.47     474%\nPypy        auto       56.55      21%\n</code></pre>\n\n<p>(All results are the average of the user seconds for three runs, time variation between runs &lt; 10%)</p>\n\n<p><strong>Mixed Results</strong></p>\n\n<p>Changing the C and Java datatype to integer when in the range of integers significantly sped up execution.  On the BBB and Cloud9 computers switching to ints made C faster than node.js.  But on my Mac the node.js program still ran faster.  Perhaps because the Mac is using clang and the BBB and Cloud 9 computers are using gcc.  Does anyone know if gcc compiles faster programs than gcc?</p>\n\n<p>When using all 64 bit integers C was a bit faster than node.js on the BBB and Cloud9 PC but a little slower on my MAC.</p>\n\n<p>You can also see that pypy is about four times faster than standard python in these tests.</p>\n\n<p>The fact that node.js is even compatible to C amazes me.</p>\n"}, {"tags": ["c", "linux", "qsort"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473215550, "post_id": 39360391, "comment_id": 66050263, "body": "Fundamental <code>char buf[][]</code> is <i>an array of arrays of type char</i>, <code>char **buf</code> is <i>a pointer to a pointer to type char</i>.(the values are not guaranteed to be contiguous in memory)"}, {"owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473216949, "post_id": 39360391, "comment_id": 66050513, "body": "so, I can&#39;t use malloc here?"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473222843, "post_id": 39360572, "comment_id": 66051770, "body": "note: it&#39;d also be possible to pass <code>ap</code> directly to <code>qsort</code>. <code>buf</code> is unnecessary but presumably provided to be illustrative to OP"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473223150, "post_id": 39360572, "comment_id": 66051851, "body": "Yes, that&#39;s how I would do it, but I wanted to fully provide an example of allocating and sorting on the pointer to pointer to char. Good point."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1473217022, "creation_date": 1473217022, "answer_id": 39360572, "question_id": 39360391, "link": "https://stackoverflow.com/questions/39360391/about-qsort-in-c-difference-between-buf-and-buf/39360572#39360572", "title": "About qsort() in C, difference between ** buf and buf[][]", "body": "<p>When you attempt to <code>qsort</code> <code>buf</code> declared as <code>char **buf</code>, you are using the wrong comparison function. As I noted in the comment, <code>char buf[x][y]</code> is an <em><code>x</code> array of character arrays of <code>y</code> chars</em>, e.g. <code>char (*)[y]</code> when passed as a parameter. When you declare <code>buf</code> as <code>char **buf;</code>, you declare a <em>pointer to a pointer to type char</em>. In either case, you have a <em>pointer to string</em>, and you must dereference each value passed to <code>qsort</code> one additional level of indirection., e.g.</p>\n\n<pre><code>int cmpstrings (const void *a, const void *b) {\n    return strcmp (*(char * const *)a, *(char * const *)b);\n}\n</code></pre>\n\n<p>A short example using <code>char **buf;</code> would be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/* qsort string comparison - for pointer to pointer to char */\nint cmpstrings (const void *a, const void *b) {\n    return strcmp (*(char * const *)a, *(char * const *)b);\n}\n\nint main (void) {\n\n    char *ap[] = { \"This is a tale\",\n                    \"of captian Jack Sparrow\",\n                    \"a pirate so brave\",\n                    \"on the seven seas.\" },\n        **buf = NULL;\n    int n = sizeof ap/sizeof *ap;    \n\n    if (!(buf = malloc (n * sizeof *buf))) { /* allocate pointers */\n        fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n        return 1;\n    }\n\n    for (int i = 0; i &lt; n; i++)\n        buf[i] = strdup (ap[i]);    /* allocate/copy strings */\n\n    qsort (buf, n, sizeof *buf, cmpstrings);\n\n    for (int i = 0; i &lt; n; i++) {   /* print and free */\n        printf (\"buf[%d] : %s\\n\", i, buf[i]);\n        free (buf[i]);\n    }\n    free (buf);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>$ ./bin/qsortptp\nbuf[0] : This is a tale\nbuf[1] : a pirate so brave\nbuf[2] : of captian Jack Sparrow\nbuf[3] : on the seven seas.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1486380327, "post_id": 39363946, "comment_id": 71304560, "body": "Well, I&#39;d point out that qsort swapping items of <i>1024 bytes</i> is going to be slower on any practical architecture than swapping pointers..."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473233936, "last_edit_date": 1495535373, "creation_date": 1473233936, "answer_id": 39363946, "question_id": 39360391, "link": "https://stackoverflow.com/questions/39360391/about-qsort-in-c-difference-between-buf-and-buf/39363946#39363946", "title": "About qsort() in C, difference between ** buf and buf[][]", "body": "<p><code>qsort</code>, <code>memcpy</code> and similar functions assumes that the pointer passed points at an array. The very definition of an array is x number of items <em>allocated contiguously</em>, in adjacent memory cells. For example <code>char array [x][y];</code>.</p>\n\n<p>There is wide-spread confusion about the use of pointer-to-pointers. There's an old trick you can use to declare a look-up table, where each item points to an array of variable length, which goes like this:</p>\n\n<pre><code>char** ptr = malloc(x * sizeof(char*));\nfor(int i=0; i&lt;x; i++)\n{\n  ptr[i] = malloc(y * sizeof(char));\n}\n</code></pre>\n\n<p>This allows you to access the look-up table with array-like syntax, <code>ptr[i][j]</code>. But that <em>does not</em> mean that this is an array, there is no relation whatsoever beween a pointer-to-pointer and a 2D array! This is rather <code>x</code> number of segments, where each segment allocated at any place on the heap.</p>\n\n<p>The <em>only</em> reason why you would <em>ever</em> use the above pointer-to-pointer trick is when you must have variable length for each item in the look-up table. If you don't need that, then the above method is plain bad and always incorrect - it is much slower than a real array, both in terms of allocation overhead, heap fragmentation and poor data cache use. And as you discovered, it can't even be used as an array... because it isn't one.</p>\n\n<p>Now there are unfortunately numerous incompetent would-be gurus all over the world incorrectly teaching the above as the way to allocate a multi-dimensional array dynamically. Which is complete nonsense. It is not a multi-dimensional array and can't be used as one. <a href=\"https://stackoverflow.com/questions/32050256/function-to-dynamically-allocate-matrix/32050859#32050859\">See this</a> for an explanation of how you actually should allocate multi-dimensional arrays dynamically.</p>\n"}], "owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 1, "accepted_answer_id": 39360572, "answer_count": 2, "score": 1, "last_activity_date": 1473233936, "creation_date": 1473215356, "last_edit_date": 1473215698, "question_id": 39360391, "link": "https://stackoverflow.com/questions/39360391/about-qsort-in-c-difference-between-buf-and-buf", "title": "About qsort() in C, difference between ** buf and buf[][]", "body": "<p>When I use qsort() in the C on my Mac, these code works well, It can sort every lines in one file well.</p>\n\n<pre><code>int compare(const void *p, const void *q) {\n    return strcmp(p,q);\n}\n\nvoid function_name(){\n        char buf[1024][1024];\n        int i=0;\n        FILE * fp;\n        if(!(fp=fopen(filename,\"r\"))){\n            perror(\"Open error!\");\n            exit(0);\n        }\n        while(fgets(buf[i],1024,fp)){\n            //printf(\"%s\",buf[i]);\n            i++;\n        }\n        qsort(buf, i, sizeof(buf[0]), compare);\n    }\n</code></pre>\n\n<p>However, when I use malloc to assign the space, it sucks.  Why is that?\nThe code below shows I use malloc to make one two-dimension array. I print the content of buf before and after. It seems that lose all the information.</p>\n\n<pre><code>    int i=0;\n    FILE * fp;\n    char ** buf;\n    buf = (char **)malloc(sizeof(char*)*1024);\n    if(!(fp=fopen(filename,\"r\"))){\n        perror(\"Open error!\");\n        exit(0);\n    }\n    buf[0]=(char *)malloc(sizeof(char)*1024);\n    while(fgets(buf[i],1024,fp)){\n        i++;\n        buf[i]=(char *)malloc(sizeof(char)*1024);\n    }\n    for(int j=0;j&lt;i;j++){\n        printf(\"%s\",buf[j]);\n    }\n    printf(\"hehe%ld\\n\",sizeof(char)*1024);\n\n    qsort(buf, i, sizeof(char)*1024, compare);\n\n    printf(\"hehe\\n\");\n    for(int j=0;j&lt;i;j++){\n        printf(\"%s\",buf[j]);\n    }\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>a\nA\nb\nc\nd\nD\nC\n\nE\ne\nB\nd\ne\nf\na\nhehe1024\nhehe\n(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)\n</code></pre>\n\n<p>Most important, how to fix my malloc version?</p>\n"}, {"tags": ["c", "arrays", "function", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 2, "creation_date": 1473210938, "post_id": 39359891, "comment_id": 66049466, "body": "<code>Even the error messages aren&#39;t helping me</code> ... but they might help us.  What errors do you get?"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4752978, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-nBCvyFlMdAM/AAAAAAAAAAI/AAAAAAAAAB0/oilbe6fgRkE/photo.jpg?sz=128", "display_name": "Tyler McAnally", "link": "https://stackoverflow.com/users/4752978/tyler-mcanally"}, "edited": false, "score": 1, "creation_date": 1473211823, "post_id": 39359966, "comment_id": 66049604, "body": "Thank you! Exactly what I was looking for!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473217990, "post_id": 39359966, "comment_id": 66050726, "body": "Well done, it may be worth introducing the OP to the syntax that allows you to specify the parameter <code>char array[n][m]</code> as <code>char (*array)[m]</code> which reflects the conversion of the first level of indirection to a pointer when the array is passed as a parameter. (and also makes clear why any attempt to use <code>sizeof</code> within the function will fail)"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473218880, "post_id": 39359966, "comment_id": 66050901, "body": "While I agree @DavidC.Rankin, M.M&#39;s answer seems to touch that and my answer is already big.. :) Thanks!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1473239137, "post_id": 39359966, "comment_id": 66059798, "body": "@DavidC.Rankin The language intentionally allows you to pass an array in this manner so that we don&#39;t need to worry our pretty heads about things like array decay, array pointers and pass by reference. Introducing an array pointer will just make the code ugly."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1473211986, "last_edit_date": 1495542767, "creation_date": 1473211425, "answer_id": 39359966, "question_id": 39359891, "link": "https://stackoverflow.com/questions/39359891/pointer-to-2d-array-with-function/39359966#39359966", "title": "Pointer to 2D array with function", "body": "<p>Allow me to say that you are making your life hard for no reason at all! :) You see when one wants to manipulate a 2D array, he can work on the array directly, by passing the array itself to the function, like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nvoid init(int n, int m, char array[n][m]);\n\nint main(int argc, char *argv[]) {\n  const int n = 21, m = 80;\n  char grid[n][m];\n  int i, j;\n  init(n, m, grid);\n\n  for (i = 0; i &lt; n; i++) {\n    for (j = 0; j &lt; m; j++) {\n      printf(\"%c\", grid[i][j]);\n    }\n    printf(\"\\n\");\n  }\n\n  return 0;\n}\n\nvoid init(int n, int m, char array[n][m]) {\n  int i,j;\n  for (i = 0; i &lt; n; i++) {\n    for (j = 0; j &lt; m; j++) {\n      array[i][j] = ' ';\n    }\n  }\n  for (i = 0; i &lt; n; i++) {\n    array[i][0] = '|';\n    array[i][m - 1] = '|';\n  }\n  for (i = 0; i &lt; m; i++) {\n    array[0][i] = '-';\n    array[n - 1][i] = '-';\n  }\n}\n</code></pre>\n\n<p>which gives this lovely rectangle:</p>\n\n<pre><code>C02QT2UBFVH6-lm:~ gsamaras$ gcc -Wall main.c\nC02QT2UBFVH6-lm:~ gsamaras$ ./a.out \n--------------------------------------------------------------------------------\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n|                                                                              |\n--------------------------------------------------------------------------------\n</code></pre>\n\n<p>Now notice the changes I made to your code:</p>\n\n<ol>\n<li>I got rid of the pointer that refers to the array, since it's\nredundant.</li>\n<li>I passed the array itself as a parameter to the function, as\ndescribed <a href=\"https://stackoverflow.com/questions/6862813/c-passing-a-2d-array-as-a-function-argument\">here</a>.</li>\n<li>Instead of using magic numbers (21 and 80) all over the place, I\ndeclared two new constant variables, <code>n</code> and <code>m</code>, which are the\ndimension of your 2D array, <code>n</code> rows x <code>m</code> columns.<sup>*</sup></li>\n<li>I use the dimensions to implement the very same logic you had\nimplemented so far. Notice that I have to pass them as function\nparameters too.</li>\n</ol>\n\n<hr>\n\n<p>As for the error, it implies that you are not accessing what you think that you are accessing! But let me not expand on this and keep it minimal here. :)</p>\n\n<hr>\n\n<p><sup>*</sup>Now if you want to change the dimensions of your 2D array, you just need to change <code>n</code> and/or <code>m</code> once, not everywhere in your code (which is bug prone).</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1473239737, "post_id": 39360240, "comment_id": 66060163, "body": "In the absence of a standard compiler, I think one should do either a &quot;mangled&quot; 2D array with variable dimensions, <code>init (int rows, int cols, char* array)</code>, or a hard-coded &quot;magic number&quot; array: <code>init (char [21][80])</code>. This seems like a hybrid of those two."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1473214062, "creation_date": 1473214062, "answer_id": 39360240, "question_id": 39359891, "link": "https://stackoverflow.com/questions/39359891/pointer-to-2d-array-with-function/39360240#39360240", "title": "Pointer to 2D array with function", "body": "<p>In case anyone is using a C compiler that does not support the optional \"variable length arrays\" feature (e.g. the Microsoft compiler), here is another way:</p>\n\n<pre><code>void init( int rows, char (*array)[80] );\n\n    // ... in main ...\n    char grid[21][80];\n    init(grid);          // use of grid_ptr is not required\n    // ...\n\nvoid init(int rows, char (*array)[80])\n{\n    int i,j;\n    for (i = 0; i &lt; rows; i++) {\n      for (j = 0; j &lt; 80; j++) {\n        array[i][j] = ' ';\n</code></pre>\n\n<p>In the <code>j</code> loop you could replace <code>80</code> with <code>sizeof *array</code>. Or you could replace the entire <code>j</code> loop (in fact, both loops) with a call to <code>memset</code>.</p>\n"}], "owner": {"reputation": 89, "user_id": 4752978, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-nBCvyFlMdAM/AAAAAAAAAAI/AAAAAAAAAB0/oilbe6fgRkE/photo.jpg?sz=128", "display_name": "Tyler McAnally", "link": "https://stackoverflow.com/users/4752978/tyler-mcanally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3174, "favorite_count": 1, "accepted_answer_id": 39359966, "answer_count": 2, "score": 2, "last_activity_date": 1473214062, "creation_date": 1473210666, "last_edit_date": 1473211787, "question_id": 39359891, "link": "https://stackoverflow.com/questions/39359891/pointer-to-2d-array-with-function", "title": "Pointer to 2D array with function", "body": "<p>I'm having some trouble understanding how pointers work with two dimensional arrays. Even the error messages aren't helping me. I have a 2D array that I need a pointer for so I may manipulate it inside of functions (I think that's how you're supposed to do it anyway). Could someone please point out what I'm doing wrong and point me in the right direction?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nvoid init(char *array);\n\nint main(int argc, char *argv[]) {\n  char grid[21][80];\n  char (*grid_ptr)[80];\n  grid_ptr = grid;\n  int i, j;\n  init(*grid_ptr);\n\n  for (i=0; i&lt;21; i++) {\n    for (j=0; j&lt;80; j++) {\n      printf(\"%c\", grid_ptr[i][j]);\n    }\n    printf(\"\\n\");\n  }\n\n  return 0;\n}\n\nvoid init(char *array) {\n  int i,j;\n  for (i=0; i&lt;21; i++) {\n    for (j=0; j&lt;80; j++) {\n      *array[i][j] = ' ';\n    }\n  }\n  for (i=0; i&lt;21; i++) {\n    *array[i][0] = '|';\n    *array[i][79] = '|';\n  }\n  for (i=0; i&lt;80; i++) {\n    *array[0][i] = '-';\n    *array[20][i] = '-';\n  }\n}\n</code></pre>\n\n<p>The errors are of this nature:</p>\n\n<pre><code>main.c:27:16: error: subscripted value is not an array, pointer, or vector\n      *array[i][j] = ' ';\n</code></pre>\n"}, {"tags": ["c", "linux", "macos", "signals"], "comments": [{"owner": {"reputation": 2330, "user_id": 24734, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2EYui.jpg?s=128&g=1", "display_name": "Kevin Beck", "link": "https://stackoverflow.com/users/24734/kevin-beck"}, "edited": false, "score": 0, "creation_date": 1473209702, "post_id": 39359774, "comment_id": 66049243, "body": "Try declaring flag as volatile.  I suspect that the C compiler is pulling the flag==1 check out of the loop otherwise."}], "answers": [{"tags": [], "owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "is_accepted": true, "score": 0, "last_activity_date": 1473215938, "last_edit_date": 1473215938, "creation_date": 1473214192, "answer_id": 39360257, "question_id": 39359774, "link": "https://stackoverflow.com/questions/39359774/c-in-mac-about-signal-and-flag-from-handler-in-loop-different-behavior-on-diffe/39360257#39360257", "title": "C in mac, about signal and flag from handler in loop different behavior on different device", "body": "<p>I know it, I didn't reset the signal(). Why nobody tell me.</p>\n\n<pre><code>void sigint(int sig){\n    flag=1;\n    signal(SIGINT, sigint);\n}\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 39360257, "answer_count": 1, "score": 0, "last_activity_date": 1473215938, "creation_date": 1473209455, "last_edit_date": 1495541303, "question_id": 39359774, "link": "https://stackoverflow.com/questions/39359774/c-in-mac-about-signal-and-flag-from-handler-in-loop-different-behavior-on-diffe", "title": "C in mac, about signal and flag from handler in loop different behavior on different device", "body": "<p>This question is based on one question I asked yesterday:\n<a href=\"https://stackoverflow.com/questions/39338347/in-c-linux-about-kill-signal-and-sleep-in-loop\">In C, linux, about kill signal and sleep() in loop</a></p>\n\n<p>These code are part of my all code.</p>\n\n<pre><code>int flag=0;\n\nvoid sigint(int sig){\n    flag=1;\n}\n\n\nvoid alive(void) {\n    signal(SIGINT, sigint);\n    while(1){\n        //printf(\"%d\\n\",out);\n        //pause();\n        //sleep(1);\n        if(flag==1){\n            printf(\"no\\n\");\n            flag=0;\n        }\n    }\n}\n</code></pre>\n\n<p>Technically what I want is when I press ctrl-c program can output \"no\".\nYesterday, on my Mac, I run these code and it can't output anything, then I add sleep(1), it works well as well as adding pause()\nI thought that is it. In fact, this is part of assignment my professor left for us to do in our sunlab system. After I copy these code on my sunlab account (a linux platform). Run it. the output is as follow:</p>\n\n<pre><code>^Cno\n^C\n</code></pre>\n\n<p>I can only use the sigint signal for only one time, when press ctrl-c for second time it exit, I don't know why.\nMy friend shows me his code, his code is just like what I attach here, have no pause or sleep, only use while(1) or for(;;). And works well on his sunlab account.</p>\n\n<p>Here I mentioned three device. </p>\n\n<p>My Mac: I need to use pause() or sleep(1) and can implement the function I want. Some seems correctly answer is here:<a href=\"https://stackoverflow.com/questions/39338347/in-c-linux-about-kill-signal-and-sleep-in-loop\">In C, linux, about kill signal and sleep() in loop</a></p>\n\n<p>My sunlab account: exit after second ctrl-c, can output 'no' after first ctrl-c. Existence of pause() doesn't influence my result obviously</p>\n\n<p>My friends sunlab account: works well. Existence of pause() doesn't influence my result obviously\nWhy is the difference.</p>\n\n<p>Supplyment: According to my professor's word the third should be right.</p>\n"}, {"tags": ["c", "linux", "multithreading", "sockets"], "comments": [{"owner": {"reputation": 209, "user_id": 1956878, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5cd22461215d9f39b725fc33e438041e?s=128&d=identicon&r=PG", "display_name": "Steve S", "link": "https://stackoverflow.com/users/1956878/steve-s"}, "edited": false, "score": 0, "creation_date": 1473207604, "post_id": 39359519, "comment_id": 66048849, "body": "Also should have mentioned that the number of commands and size of packets will vary greatly.  So this system needs to run the entire time the application is running.  There just might not always be a client connected."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1473207738, "post_id": 39359519, "comment_id": 66048874, "body": "Is the critical thread going to have this data anyway? Or will it have to get/compute it to react to the request? If the data will already be available, then the thread that handles the client can just do a simple read/process/write loop and no need for the queue. The &quot;process&quot; portion would just access the data from some thread-safe storage."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1473207990, "post_id": 39359519, "comment_id": 66048932, "body": "The question is a little broad as it stands. You will get higher quality answers if you make an attempt, and write a post about why you find it unsatisfactory."}, {"owner": {"reputation": 209, "user_id": 1956878, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5cd22461215d9f39b725fc33e438041e?s=128&d=identicon&r=PG", "display_name": "Steve S", "link": "https://stackoverflow.com/users/1956878/steve-s"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1473208919, "post_id": 39359519, "comment_id": 66049114, "body": "@jxh I agree with you totally just did not know where to start.  I think I will attempt the select approach detailed below by sashang and see if that works.  I will post a follow up if it does not meet my needs."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1473209242, "post_id": 39359519, "comment_id": 66049169, "body": "On linux look into <code>epoll</code>, it&#39;s more performant than <code>select</code> and requires less storage in userspace. I implemented <a href=\"https://github.com/boazsegev/c-server-tools\" rel=\"nofollow noreferrer\">a server library using epoll</a> and was happy with it&#39;s performance (even though the HTTP layer has some unaligned memory access, it&#39;s running quite smoothly). Multi-threading is a question of preferences and requirements. Does RasPI have multi-cores or threads to it&#39;s ARM CPU? I suspect a single thread might work better if you keep to an evented design."}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 1956878, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5cd22461215d9f39b725fc33e438041e?s=128&d=identicon&r=PG", "display_name": "Steve S", "link": "https://stackoverflow.com/users/1956878/steve-s"}, "edited": false, "score": 0, "creation_date": 1473207526, "post_id": 39359563, "comment_id": 66048839, "body": "Sorry I should have mentioned there will only be one client.  My issue is more to do with actually handling the incoming data so that it does not disturb my main thread with time critical tasks.  Hope that makes sense :)"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1473207336, "creation_date": 1473207336, "answer_id": 39359563, "question_id": 39359519, "link": "https://stackoverflow.com/questions/39359519/tcp-client-server-with-linux/39359563#39359563", "title": "TCP Client/Server with Linux", "body": "<p>the ultra classic linux approach is to have a listener program that forks a new copy of itself for each new client. Linux even has a built in demon that does that for you (initd - although that might have changed with all the systemd stuff). Thats how sshd, telnetd, ftpd all work. No threads</p>\n"}, {"comments": [{"owner": {"reputation": 209, "user_id": 1956878, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5cd22461215d9f39b725fc33e438041e?s=128&d=identicon&r=PG", "display_name": "Steve S", "link": "https://stackoverflow.com/users/1956878/steve-s"}, "edited": false, "score": 0, "creation_date": 1473208029, "post_id": 39359596, "comment_id": 66048938, "body": "Hmm I like this approach.  Being a deeply embedded developer I never use threads.  I was not aware of the select approach.  This could work if select does not block.  I will reasearch now."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1473209360, "post_id": 39359596, "comment_id": 66049187, "body": "Since OP was referencing linux, I feel <code>epoll</code> might be a better option... what do you think?"}, {"owner": {"reputation": 10338, "user_id": 366817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e6631edabd90d685482b23efec1058a1?s=128&d=identicon&r=PG", "display_name": "sashang", "link": "https://stackoverflow.com/users/366817/sashang"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1473209872, "post_id": 39359596, "comment_id": 66049267, "body": "@Myst: yes epoll works if the kernel supports it. I&#39;ve never used epoll directly but used libevent which wraps epoll."}, {"owner": {"reputation": 209, "user_id": 1956878, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5cd22461215d9f39b725fc33e438041e?s=128&d=identicon&r=PG", "display_name": "Steve S", "link": "https://stackoverflow.com/users/1956878/steve-s"}, "edited": false, "score": 0, "creation_date": 1473212768, "post_id": 39359596, "comment_id": 66049761, "body": "I marked this as a solution because it does seem to work as needed,  I will look into epoll as well.  i need to see if raspbian (jessie) (based on debian) supports it."}], "tags": [], "owner": {"reputation": 10338, "user_id": 366817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e6631edabd90d685482b23efec1058a1?s=128&d=identicon&r=PG", "display_name": "sashang", "link": "https://stackoverflow.com/users/366817/sashang"}, "is_accepted": true, "score": 2, "last_activity_date": 1473207645, "creation_date": 1473207645, "answer_id": 39359596, "question_id": 39359519, "link": "https://stackoverflow.com/questions/39359519/tcp-client-server-with-linux/39359596#39359596", "title": "TCP Client/Server with Linux", "body": "<p>I tend to avoid threads if I can and only use them if I have to because they make debugging the program harder. They turn a determinsitic problem into a non-deterministic one. So my initial approach would be to see if I can do this without a thread and still achieve concurrency. This is possible using <code>select</code> which will notify your main program when there is something on the socket that needs to be read. Then, when there is something on the socket, it can read the data, process it, and wait for the next event. Problems with this approach is if the computation on the received data takes longer than the acceptable time wanted to process the next element of data, you could end up with a backlog of unprocessed data on the socket. If this is going to happen then you can go ahead and run the receive loop in thread, and the work function in another thread, or fork a new process and deal with a copy of the data from the new process.</p>\n"}], "owner": {"reputation": 209, "user_id": 1956878, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5cd22461215d9f39b725fc33e438041e?s=128&d=identicon&r=PG", "display_name": "Steve S", "link": "https://stackoverflow.com/users/1956878/steve-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 39359596, "answer_count": 2, "score": 0, "last_activity_date": 1473207645, "creation_date": 1473207010, "question_id": 39359519, "link": "https://stackoverflow.com/questions/39359519/tcp-client-server-with-linux", "title": "TCP Client/Server with Linux", "body": "<p>This may be a very basic question/design but I am struggling with the correct method to handle the system I am going to define here.</p>\n\n<p>I have a system with a single client (PC) that will connect to an embedded Linux board (Raspberry Pi) via TCP/IP protocol.  This will be a command/response system where the PC will ask for something and the raspberry PI will respond with the results.</p>\n\n<p>For Example:<br>\n   CMD => Read/Return ADC Channel X</p>\n\n<p>RSP => ADC Channel X Data</p>\n\n<p>For this type of system I have already defined a packet protocol that will allow for this interaction.  My problem is how to handle this on the Raspberry PI.  I envision having a single thread handling the TCP connection; placing incomming data into a thread safe queue and pulling outgoing data from a thread safe queue.  Then the main thread would poll the queue periodically looking for data.  When data is found the command would be processed and a response will be generated.  All commands have a response.  </p>\n\n<p>The main thread will also be doing other time critical tasks (PID control loop) so it cannot wait for incoming or outgoing data.</p>\n\n<p>My guess is this type of system is fairly common and there is probably a good approach to implementing this type of system.  I am very new to Linux programming but I have been programming highly embedded systems (No OS) forever.  Just struggling with the correct approach for this type of design.</p>\n\n<p>Note I chose TCP/IP because it handles retying in case of failure.  In my case every command has a response so UDP could be used if it makes the design easier/more flexible.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["c", "list", "pointers", "crash", "segmentation-fault"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 6, "creation_date": 1473205816, "post_id": 39359326, "comment_id": 66048416, "body": "<code>if (atual = NULL)</code>  --&gt; <code>if (atual == NULL)</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473205913, "post_id": 39359326, "comment_id": 66048440, "body": "&quot;I can&#39;t specify my *prev and *next pointers, they have to be *A and *B, because they may assume each others functions as I tamper with the list&quot; - What? Just use the common names, don&#39;t try being creative at the cost of readability! (And don&#39;t use all-uppercase names for anything else than macros and enum-constants)"}, {"owner": {"reputation": 188, "user_id": 6759414, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CupJXHUKMVc/AAAAAAAAAAI/AAAAAAAAAAo/ZRc8Ux7BvpA/photo.jpg?sz=128", "display_name": "Matheus Rotta", "link": "https://stackoverflow.com/users/6759414/matheus-rotta"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473208579, "post_id": 39359326, "comment_id": 66049043, "body": "@Olaf You don&#39;t understand, I am not being creative. I need A and B because sometimes A will be prev and other times it will be next. That&#39;s what I said about the list being symmetric. Did you read the whole thing?"}, {"owner": {"reputation": 188, "user_id": 6759414, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CupJXHUKMVc/AAAAAAAAAAI/AAAAAAAAAAo/ZRc8Ux7BvpA/photo.jpg?sz=128", "display_name": "Matheus Rotta", "link": "https://stackoverflow.com/users/6759414/matheus-rotta"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473210698, "post_id": 39359326, "comment_id": 66049429, "body": "@Olaf Hey! Thanks for the observation, you are correct. However, I have changed it and it still does not work."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1473214306, "post_id": 39359326, "comment_id": 66050016, "body": "Did you use a debugger? At a minimum it will tell you which line caused the seg fault and that is the <i>minimum</i> debugging info you should share with us."}, {"owner": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 0, "creation_date": 1473218218, "post_id": 39359326, "comment_id": 66050766, "body": "<i>&quot;However, I have changed it and it still does not work.&quot;</i>  You are learning about doubly linked lists, and you don&#39;t fully understand how variables truly work...the variable name doesn&#39;t even matter! I believe you are in serious need of a <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">C book companion</a>.  This will help you throughout your ventures into the C programming language, and is a great help at times.  Good luck!"}], "owner": {"reputation": 188, "user_id": 6759414, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CupJXHUKMVc/AAAAAAAAAAI/AAAAAAAAAAo/ZRc8Ux7BvpA/photo.jpg?sz=128", "display_name": "Matheus Rotta", "link": "https://stackoverflow.com/users/6759414/matheus-rotta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1473208678, "creation_date": 1473205509, "last_edit_date": 1592644375, "question_id": 39359326, "link": "https://stackoverflow.com/questions/39359326/i-cant-insert-a-node-into-this-doubly-linked-list-probable-segfault", "title": "I can&#39;t insert a node into this doubly linked list, probable segfault", "body": "<p>I need to develop a doubly linked list in which I can't specify my *prev and *next pointers, they have to be *A and *B, because they may assume each others functions as I tamper with the list. It is probably called a symmetric list in english.</p>\n<p>I am having trouble inserting a node in this list. The program crashes (probably a segfault), and I don't know why, because I did use a special case for when the list is empty (if(atual == NULL)). The program is not over yet, there is more to implemente, so don't mind the stuff inside the switch that you don't see implemented yet. One more thing: each node has *A or *B to go along the list. That is why I check which one is looking back, in order to use the other one to go forward.</p>\n<p>Sample input:</p>\n<blockquote>\n<p>i  0  1.2</p>\n<p>i  1  2.3</p>\n<p>i  2  3.4</p>\n</blockquote>\n<p>Here's the code:</p>\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\ntypedef struct no {\n    double num;\n    struct no *A;\n    struct no *B;\n} no;\n\ntypedef struct lista {\n    no *cabo;\n    no *rabo;\n} lista;\n\nlista* criar(void) {\n    lista *L = malloc(sizeof(lista));\n    L-&gt;cabo = NULL;\n    L-&gt;rabo = NULL;\n    return L;\n}\n\nvoid inserir(lista *L, int posicao, double num) { //testar se funciona e verificar com pad se eh o melhor modo.\n    no *novo = malloc(sizeof(no));\n    no *atual, *aux;\n    atual = L-&gt;cabo;\n    aux = NULL;\n    char ref;\n    int i;\n    if (atual == NULL) { //a lista nao tem elementos\n        novo-&gt;A = L-&gt;cabo; //inserindo primeiro elemento, que tem contato tanto com a cabeca quanto com o rabo\n        novo-&gt;B = L-&gt;rabo;\n        L-&gt;cabo = novo;\n        L-&gt;rabo = novo;\n        return;\n    }\n    for (i = 0; i != posicao; i++) {\n        if (atual-&gt;A == aux) { //entao A aponta para tras. Para prosseguir uso B.\n            aux = atual;\n            atual = atual-&gt;B;\n            ref = 'B';  //o no para onde aux aponta tem seu proximo em B\n        }\n        else {\n            aux = atual;\n            atual = atual-&gt;A;\n            ref = 'A';  //o no para onde aux aponta tem seu proximo em A\n        }\n    }\n    if(ref == 'B') {\n        novo-&gt;B = aux-&gt;B;\n        aux-&gt;B = novo;\n        if (atual-&gt;A == aux) {\n            atual-&gt;A = novo;\n        }\n        else {\n            atual-&gt;B = novo;\n        }\n        novo-&gt;A = aux;\n    }   \n    else if(ref == 'A') {\n        novo-&gt;B = aux-&gt;A;\n        aux-&gt;A = novo;\n        if (atual-&gt;A == aux) {\n            atual-&gt;A = novo;\n        }\n        else {\n            atual-&gt;B = novo;\n        }\n        novo-&gt;A = aux;\n    }\n}\n\nvoid reverter(lista *L, int inicio, int fim) {\n    \n}\nint main(void) {\n    \n    lista *L = criar();\n    char comando;\n    int posicao, inicio, fim;\n    double num;\n    while(1) {\n        scanf(&quot;%c&quot;, &amp;comando);\n        if(comando == 't') break;\n        switch(comando) {\n            case 'i' :  scanf(&quot;%d&quot;, &amp;posicao);\n                        scanf(&quot;%lf&quot;, &amp;num);\n                        inserir(L, posicao, num);\n                        break;\n            //case 'p' :    imprimir(L);\n                        break;\n            case 'v' :  scanf(&quot;%d&quot;, &amp;inicio);\n                        scanf(&quot;%d&quot;, &amp;fim);\n                        reverter(L, inicio, fim);\n                        break;\n        }\n    }\n\n    return 0;\n}\n\n    \n</code></pre>\n"}, {"tags": ["c", "sleep"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1473205438, "post_id": 39359310, "comment_id": 66048322, "body": "<code>stdout</code> is line-buffered."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1473205619, "post_id": 39359310, "comment_id": 66048359, "body": "Add <code>fflush(stdout);</code> after each <code>putchar</code>."}, {"owner": {"reputation": 1, "user_id": 5016021, "user_type": "registered", "profile_image": "https://graph.facebook.com/1081772141850348/picture?type=large", "display_name": "Diogo Meneses", "link": "https://stackoverflow.com/users/5016021/diogo-meneses"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473205628, "post_id": 39359310, "comment_id": 66048363, "body": "I&#39;m sorry @EOF, can you expand on that statement? I can&#39;t quite understand."}, {"owner": {"reputation": 1, "user_id": 5016021, "user_type": "registered", "profile_image": "https://graph.facebook.com/1081772141850348/picture?type=large", "display_name": "Diogo Meneses", "link": "https://stackoverflow.com/users/5016021/diogo-meneses"}, "edited": false, "score": 0, "creation_date": 1473205724, "post_id": 39359310, "comment_id": 66048393, "body": "It works perfectly now. Can you explain why it was behaving like that?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473205760, "post_id": 39359310, "comment_id": 66048399, "body": "@DiogoMeneses: Output on line-buffered streams is potentially delayed until the stream is flushed, a newline is written to the stream, or input is read from an interactive stream."}, {"owner": {"reputation": 1, "user_id": 5016021, "user_type": "registered", "profile_image": "https://graph.facebook.com/1081772141850348/picture?type=large", "display_name": "Diogo Meneses", "link": "https://stackoverflow.com/users/5016021/diogo-meneses"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1473206003, "post_id": 39359310, "comment_id": 66048460, "body": "Thank you! It makes sense now @EOF"}, {"owner": {"reputation": 6413, "user_id": 5555803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4823cf23548ba1e4634ad67e78468e67?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Alikhanov", "link": "https://stackoverflow.com/users/5555803/orkhan-alikhanov"}, "edited": false, "score": 0, "creation_date": 1473207184, "post_id": 39359310, "comment_id": 66048762, "body": "@DiogoMeneses the characters are buffered and then printed on demand. This increases performance significantly on large outputs. See answers in the this <a href=\"http://stackoverflow.com/a/15042979\">question</a>"}], "owner": {"reputation": 1, "user_id": 5016021, "user_type": "registered", "profile_image": "https://graph.facebook.com/1081772141850348/picture?type=large", "display_name": "Diogo Meneses", "link": "https://stackoverflow.com/users/5016021/diogo-meneses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1473205980, "answer_count": 0, "score": 0, "last_activity_date": 1473205339, "creation_date": 1473205339, "question_id": 39359310, "link": "https://stackoverflow.com/questions/39359310/unexplained-behaviour-with-sleep-functions-in-c", "closed_reason": "Duplicate", "title": "Unexplained behaviour with sleep functions in C", "body": "<p>I want my program to print a given file but instead of printing it at once I want the characters to appear with a certain interval.</p>\n\n<p>Instead of waiting, for example, 1 second and then printing the character, it seems to wait 1 sec for every character it has to print in the current line and then prints all the characters at once.</p>\n\n<p>I've tried using usleep() and sleep(), before and after the putchar() function, albeit with no success. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char **argv)\n{\n    FILE *fp;\n    char ch;\n\n    if(argc != 2)\n    {\n    puts(\"The syntax of the command is incorrect: \\n*Program* *file*\");\n    exit(0);\n    }\n    if((fp = fopen(argv[1], \"r\")) == 0)\n    {\n    puts(\"Error opening file\");\n    exit(1);\n    }\n\n    while((ch = fgetc(fp))!= EOF)\n    {\n      switch (ch)\n        {\n            case ' ': putchar(ch);\n                      usleep(1000000/3);\n                      break;\n\n            case '\\n':putchar(ch);\n                      usleep(1000000/2);\n                      break;\n\n            default: putchar(ch);\n                     usleep(1000000/4);\n        }\n\n    }\n\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<p>I've read about the sleep function behavior and haven't found anything relevant.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "api", "memory", "lua", "garbage-collection"], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 5977178, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/60b1c37ee4867cda9f4c9e77a9a172ea?s=128&d=identicon&r=PG&f=1", "display_name": "Lars", "link": "https://stackoverflow.com/users/5977178/lars"}, "edited": false, "score": 0, "creation_date": 1473263728, "post_id": 39360313, "comment_id": 66076923, "body": "Ok, so one garbage collection method called per userdata created on the C side. Thanks."}], "tags": [], "owner": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 2, "last_activity_date": 1473214738, "creation_date": 1473214738, "answer_id": 39360313, "question_id": 39359257, "link": "https://stackoverflow.com/questions/39359257/lua-garbage-collection-will-reassigned-userdata-have-its-gc-meta-event-trigge/39360313#39360313", "title": "Lua garbage collection: Will reassigned userdata have its __gc meta event triggered?", "body": "<p>You seem to be misunderstanding the difference between \"variables\" and \"values\" in Lua. A \"variable\" is just a holder of some value. A \"value\" is the actual data.</p>\n\n<p>This is different from C, where a variable <em>is an object</em>. In Lua, variables are just named holders for objects.</p>\n\n<p>It is wrong to say that <code>a</code> is \"userdata with a defined __gc meta-event.\" The <em>value held by <code>a</code></em> does. There's a difference.</p>\n\n<p>The value of tables/userdata/functions are references to the table/userdata/function. Therefore assigning the contents of one variable to another will just transfer the reference.</p>\n\n<p>The garbage collection metamethod will happen exactly when the Lua reference manual says it will: when (or after) the object is garbage collected. And that only happens if it is impossible for your code to access that object anymore, when you cannot access references to it.</p>\n\n<p>If you have a reference in <code>a</code>, then you have access to it. So no garbage collection will happen.</p>\n"}], "owner": {"reputation": 203, "user_id": 5977178, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/60b1c37ee4867cda9f4c9e77a9a172ea?s=128&d=identicon&r=PG&f=1", "display_name": "Lars", "link": "https://stackoverflow.com/users/5977178/lars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473214738, "creation_date": 1473204993, "last_edit_date": 1473208055, "question_id": 39359257, "link": "https://stackoverflow.com/questions/39359257/lua-garbage-collection-will-reassigned-userdata-have-its-gc-meta-event-trigge", "title": "Lua garbage collection: Will reassigned userdata have its __gc meta event triggered?", "body": "<p>When a userdata value is reassigned, i.e. </p>\n\n<pre><code>a = lib.new()\na = b\n</code></pre>\n\n<p>Where <code>a</code>, <code>b</code>, and the result of <code>lib.new()</code> are all userdata with a defined <code>__gc</code> meta-event, will the garbage collector be called for both values of a (i.e. the return value of <code>lib.new()</code> AND the value of <code>b</code>)? This appears to be the case here for general Lua objects: <a href=\"http://lua-users.org/wiki/GarbageCollectionTutorial\" rel=\"nofollow\">Garbage Collection Tutorial</a>.</p>\n\n<p>Secondly, if <code>a</code> is assigned to the value of <code>b</code> (<code>a=b</code>), will the garbage collector be called twice on the userdata value? (Is the userdata copied or referenced?)  </p>\n\n<p>However it is unclear whether this applies to userdata with metatables. For my particular application, I would expect to be receiving seg faults if it is the case for userdata meta-events.</p>\n"}, {"tags": ["c", "pointers", "dynamic", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1473203472, "post_id": 39359045, "comment_id": 66047826, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Don&#39;t break up the code. Post it all in one complete, minimal block."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1473203562, "post_id": 39359045, "comment_id": 66047850, "body": "You never initialized <code>coord</code> for the first 2 nodes. But your loop tries to dereference that."}, {"owner": {"reputation": 416, "user_id": 3183526, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwNsS.png?s=128&g=1", "display_name": "64_", "link": "https://stackoverflow.com/users/3183526/64"}, "edited": false, "score": 2, "creation_date": 1473204089, "post_id": 39359045, "comment_id": 66047981, "body": "Please use more descriptive variable names than <code>cap</code>, <code>crt</code>, and <code>urm</code>. I have no idea what they do and it makes it a lot harder to read."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473204295, "post_id": 39359045, "comment_id": 66048016, "body": "And don&#39;t cast the result of <code>malloc</code> &amp; friends in C!"}, {"owner": {"reputation": 21, "user_id": 6753184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f454ca09fd4090421a3e9367cfc1d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/6753184/alex-johnson"}, "edited": false, "score": 0, "creation_date": 1473204567, "post_id": 39359045, "comment_id": 66048089, "body": "Yep, I&#39;ve added  &quot;crt-&gt;coord= (COORD*)malloc(sizeof(COORD));&quot; and it works ok now. Thanks guys!"}], "owner": {"reputation": 21, "user_id": 6753184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f454ca09fd4090421a3e9367cfc1d6a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Johnson", "link": "https://stackoverflow.com/users/6753184/alex-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1473234740, "answer_count": 0, "score": 2, "last_activity_date": 1473210331, "creation_date": 1473203241, "question_id": 39359045, "link": "https://stackoverflow.com/questions/39359045/cant-access-memory-and-segmentation-fault", "closed_reason": "Not suitable for this site", "title": "Can&#39;t access memory and segmentation fault", "body": "<p>I am trying to implement two structures and they work fine till one point.</p>\n\n<pre><code>typedef struct punct{\nint x;\nint y;\n\n} COORD;\n\ntypedef struct nod{\nCOORD *coord;\nstruct nod *urm;\n\n} NOD;\n</code></pre>\n\n<p>I think the problem is that I am pointing to the wrong place here:</p>\n\n<pre><code>NOD *crt, *cap, *urm;\ncrt=(NOD*)malloc(sizeof(NOD));\ncap=(NOD*)malloc(sizeof(NOD));\ncap-&gt;urm=crt;\ncrt-&gt;urm=NULL;\n\n\nfor(i=0;i&lt;n;i++)\n{\n\n    NOD *next=(NOD*)malloc(sizeof(NOD));\n    next-&gt;urm =NULL;\n    COORD *coordo = (COORD*)malloc(sizeof(COORD));\n    coordo-&gt;x=coordonate[i].x; //these are just some elements from an array, they work fine\n    coordo-&gt;y=coordonate[i].y;\n    next-&gt;coord=coordo; //here I think is what is causing the problem\n    crt-&gt;urm=next;\n\n    crt=next;\n}\n</code></pre>\n\n<p>Although I think that there is the place where I am missing something, the error appears later when I try to print the coordinates:</p>\n\n<pre><code> crt=cap-&gt;urm;\nfor(i=0;i&lt;n;i++)\n{\n    printf(\"%d %d\\n\",crt-&gt;coord-&gt;x,crt-&gt;coord-&gt;y); //this is where the \"Can't acces memory at adress ...\"    \nerror and the segmentation fault appears from. I've tested with the debuger.\n    urm=crt-&gt;urm;\n    crt=urm;\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c++", "c", "ssl", "encryption"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1473201842, "post_id": 39358826, "comment_id": 66047423, "body": "Is that C or C++? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1473202180, "post_id": 39358826, "comment_id": 66047514, "body": "You don&#39;t need to extract the public key from the private key. You need to sign something with the private key, get the public key from the <i>certificate</i>, and see if the signature verifies with it."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1473245452, "post_id": 39358826, "comment_id": 66063762, "body": "If users are doing it wrong then you are asking them wrong. Capture and upload the pieces separately."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1473292879, "post_id": 39358826, "comment_id": 66089143, "body": "Why are users providing you with their private key? You do understand that it therefore ceases to be private? And is now useless?"}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "edited": false, "score": 0, "creation_date": 1473699512, "post_id": 39358826, "comment_id": 66231631, "body": "Thank you for your comments. OpenSSL is C, of course, and what I&#39;m"}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "edited": false, "score": 0, "creation_date": 1473702135, "post_id": 39358826, "comment_id": 66232891, "body": "Try this again...Thank you for your comments. I see there are space limitations..."}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473702160, "post_id": 39358826, "comment_id": 66232902, "body": "@Olaf: OpenSSL is C, of course, and what this is contained in, is C++. I&#39;d prefer to avoid putting in all the classes and such. For example, the GetX509 returns an X509 OpenSSL structure (obviously for the certificate); the GetBIO returns an already created BIO source/sink structure, and I allocate a BIO for both the private key and certificate. Everything except for this particular check works. Mostly I was looking for guidance on the proper mechanism for programmatically checking private key vs. certificate; I assumed this was a well-known process, just not so well-known to me."}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1473702243, "post_id": 39358826, "comment_id": 66232934, "body": "@EJP: It&#39;s the seeing that&#39;s the problem. As I mentioned, I&#39;ve tried several approaches; the one above the one that got to the verify without a null pointer. I believe the x509_verify does compare the public key in the certificate with whatever EVP_PKEY structure it&#39;s fed. Manufacturing &#39;something&#39;, signing it with the private key, and trying that is...roundabout. It seems like everything I need is here. Still, my way doesn&#39;t work, so it doesn&#39;t make any difference how straightforward it is."}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "edited": false, "score": 0, "creation_date": 1473702251, "post_id": 39358826, "comment_id": 66232936, "body": "I believe the _PUBKEY call in rsa.c would be helpful as that&#39;s the rsa pubout option does, if only I could identify where it actually is."}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1473702273, "post_id": 39358826, "comment_id": 66232948, "body": "@EJP: When done correctly, as most users do, they create a CSR with their private key, put on their CA hat and sign the CSR, put client stuff into the single file, and then they&#39;re set, client credential-wise. This code resides in the client and is part of client initialization. These checks are one of the typical ways users (i.e., clients) go astray. As this connection is TLS, both ends authenticate, as you know. Well, usually both ends do."}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1473702302, "post_id": 39358826, "comment_id": 66232963, "body": "@stark: The private key, CSR, and certificate are concatenated for portability and coherence. Think of it as a simple keystore. This is a means to help keep the right private key with the right CSR and the right certificate. I could load them separately, but then I&#39;d get even more instances of mismatches. For example, a user created a key on linux, cut and paste into windows to create a CSR, back to linux to have the CA sign it: the private key &amp; certificate didn&#39;t agree. Line termination characters."}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "edited": false, "score": 0, "creation_date": 1473703055, "post_id": 39358826, "comment_id": 66233254, "body": "If some of my commentary doen&#39;t flow logically, it&#39;s because I had to chop out the connecting thoughts. I hope the salient points are present, though."}, {"owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "edited": false, "score": 0, "creation_date": 1473704448, "post_id": 39358826, "comment_id": 66233921, "body": "One last item: The user (people) initially set a client system up with client credentials {private key, CSR, and certificate}, and a CA certificate. The certificates all have expiration dates, as you know. The system is started. Months go by...Say, for example, the client (or CA, or both for that matter) certificate approaches its expiration date, and the user (people) use the CSR to respin their certificate. Or, perhaps they&#39;ve rekeyed. Or changed their DN. I dunno: something. Nevertheless, I have to validity check what&#39;s there initially and on triggering events."}], "owner": {"reputation": 9, "user_id": 6801664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c46128b4be4eb17febf628c359652cc?s=128&d=identicon&r=PG&f=1", "display_name": "Lark", "link": "https://stackoverflow.com/users/6801664/lark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 696, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473201656, "creation_date": 1473201656, "question_id": 39358826, "link": "https://stackoverflow.com/questions/39358826/trying-to-extract-public-key-from-private-key-and-then-validate-the-associated", "title": "Trying to extract public key from private key, and then validate the associated certificate", "body": "<p>I realize similar questions have been addressed elsewhere, on SO and on people's web pages. However, these solutions do not work. I have tried all of them, in various combinations, after my solo attempts failed.</p>\n\n<p>Background: \nI have a file containing a private key (typically RSA), a CSR, and a X509 client certificate. These structures are all in PEM form. Users are supposed to concatenate these three components into a single file. Sometimes they don't, or do it improperly - for example, they'll omit the private key, or put the certificate in twice, or respin the private key without updating the certificate. I would like to detect these situations at system startup and point out to the user why they aren't going to contact the key manager server.</p>\n\n<p>Problem: \nPrimarily, I want to verify that the certificate corresponds to the private key. Of secondary interest is that the CSR corresponds to the certificate/private key.</p>\n\n<p>The OpenSSL 'rsa' and 'x509' command line utilities indeed verify my sample test file, and that same file does allow my client to contact the key manager servers. These are fairly good validity indications.</p>\n\n<p>Inspecting the OpenSSL module 'rsa.c', I see that the 'pubout' parameter winds up calling - I think - PEM_write_bio_RSA_PUBKEY. In OpenSSL 1.0.2f and OpenSSL 1.1.0, there is no source code I can find for PEM_write_bio_RSA_PUBKEY...yet rsa.c evidently compiles and links, and the VS debugger takes me into some assembly code, all of which suggests this is some sort of dynamically manufactured routine that the linker is plumbing in; if true, this doesn't seem particularly 'open source' to me, but there you go. Keep in mind that the structures don't have to be manually extracted from the consolidated file for the OpenSSL utilities to work - the utilities figure out what's of interest to them in a file (whether rsa, req, or x509) and that's what they play with.</p>\n\n<p>Implementation:\nThe routine 'X509_verify' requires an X509 structure and an EVP_PKEY structure. The EVP_PKEY structure is supposed to be the public key (although one of the web pages I referenced has the author claiming it's a private key, which <em>might</em> work as RSA keys are interchangeable, as long as they're consistently interchanged...but as I can't get what's supposed to work, to work, I can't say one way or the other).</p>\n\n<p>If 'X509_verify(...)' is to be used when all one has is a private key and certficate, the public key must be extracted from the private key, and supplied to 'X509_verify(...)' in an EVP_PKEY structure.</p>\n\n<p>Here's one of the many, many ways I've tried this. This one actually gets to the X509_verify call with non-null pointers, but unhappily always returns a\nzero from the verify. I skip over the CheckError calls, null checks and various 'free's: </p>\n\n<pre><code>//  Retrieve the BIO allocated earlier for the file, and\n//  extract the private key...\n\nEVP_PKEY * pPKEYPrivateKey = PEM_read_bio_PrivateKey(GetBIO(), NULL, NULL, NULL);    \n\nint type = EVP_PKEY_type(pPKEYPrivateKey-&gt;type);\n\nswitch (type)\n{\n    case EVP_PKEY_RSA:\n    case EVP_PKEY_RSA2:\n    {\n        //  Convert the EVP_PKEY private key structure to an\n        //  RSA private key, then check it...\n\n        RSA * pRSAPrivateKey = EVP_PKEY_get1_RSA(pPKEYPrivateKey);\n\n        if (1 != RSA_check_key(pRSAPrivateKey))\n        {\n            ...no good, exit, stage right...\n        }\n\n        //  Using the RSA private key, extract and copy the\n        //  public key into its own RSA structure...\n\n        RSA * pRSAPublicKey = RSAPublicKey_dup(pRSAPrivateKey);\n\n        //  Get a PKEY area...\n\n        EVP_PKEY * pPKEYPublicKey = EVP_PKEY_new();\n\n        //  Convert the public RSA key data into a EVP_PKEY structure...  \n\n        int evtrc = EVP_PKEY_assign_RSA(pPKEYPublicKey, pRSAPublicKey);\n\n        //  We now have the public key extracted into an EVP_PKEY\n        //  structure (or do we?)...\n\n        int verifyrc = X509_verify(ipCertificate-&gt;GetX509(), pPKEYPublicKey);\n\n        //  ...but the above call always returns zero...\n\n        if (1 != verifyrc\n        {\n    ...\n</code></pre>\n\n<p>An optimum solution would be key-type agnostic, where I don't have to distinguish between RSA or DSA, PEM or DER, or anything else. However, segregation of the various key types and formats is as close as I can get to the X509_verify call with something looking like a valid public key pointer. The workaround of comparing modulus values is just that - because, if that's how things are supposed to be verified, why are there X509 verify functions? Sure, the verify function itself might be comparing the modulus values...in which case, whether or not modulus values should be checked is irrelevant to the discussion at hand.</p>\n\n<p>I've used the RSA_PUBKEY functions but these always return a null pointer. Since I don't know what they're doing, I can't figure out what's wrong.</p>\n\n<p>An alternative is to extract the public key from the X509 certificate and compare it to the public key extracted from the private key, but that also seems like a workaround. Plus, if I'm not doing something right to start with, I'm no further ahead.</p>\n\n<p>On the other hand, the perfect is the enemy of the good.</p>\n\n<p>Summary:\nOne would think that this is not blazing a trail of any sort, and that this is pretty much a run-of-the-mill everyday sort of programmatic check - does this private key go with this X509 certificate? Even what I do have seems way too convoluted for something so mundane.</p>\n\n<p>If someone is kind enough to provide a solution, please check it first. Trust but verify.</p>\n\n<p>And: if someone can point me at the PEM_write_bio_RSA_PUBKEY source code, or PEM_write_bio_PUBKEY source code for that matter, I suspect that might clear up some of my confusion. Perhaps.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1473200447, "post_id": 39358658, "comment_id": 66047178, "body": "HOMEWORK ALERT -- Let me tell you: it involves a loop and 1 if statement (naive way), might want to use strchr"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1473201220, "post_id": 39358658, "comment_id": 66047274, "body": "If you use <code>scanf</code> (or <code>sscanf</code> on the input obtained with <code>fgets</code>) it won&#39;t accept an input that is all whitespace. In the case of <code>scanf</code> it will wait for input, in the case of <code>sscanf</code> its return value will not be the <code>1</code> that it should be."}], "answers": [{"tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": true, "score": 0, "last_activity_date": 1473201454, "creation_date": 1473201454, "answer_id": 39358802, "question_id": 39358658, "link": "https://stackoverflow.com/questions/39358658/how-to-check-if-user-did-not-enter-all-whitespace-characters-in-c/39358802#39358802", "title": "How to check if user did not enter all whitespace characters in C", "body": "<p>One way to test is to check all characters if they are space.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n// TODO: you should use bool instead\nint is_all_space(const char *s)\n{\n  char *tmp;\n  tmp = (char *) s;\n  // you might check for '\\n' instead in your case\n  // or even '\\r'\n  while (*tmp != '\\0') {\n    // TODO: this check will fail if the input has zero length\n    if (*tmp != ' ') {\n      return 0;\n    }\n    tmp++;\n  }\n  return 1;\n}\n// don't forget to put the argument in quotes if it contains spaces\nint main(int argc, char **argv)\n{\n  if (argc &lt; 2) {\n    fprintf(stderr, \"Usage: %s somestring\\n\", argv[0]);\n    exit(EXIT_FAILURE);\n  }\n\n  if (is_all_space(argv[1])) {\n    puts(\"Input is all-space and nothing else\");\n  } else {\n    puts(\"Input it not all-space\");\n  }\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5628721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2ab63d7fc70e25691d23fb91664dd7?s=128&d=identicon&r=PG&f=1", "display_name": "chris360", "link": "https://stackoverflow.com/users/5628721/chris360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1473201594, "accepted_answer_id": 39358802, "answer_count": 1, "score": -2, "last_activity_date": 1473201454, "creation_date": 1473200221, "question_id": 39358658, "link": "https://stackoverflow.com/questions/39358658/how-to-check-if-user-did-not-enter-all-whitespace-characters-in-c", "closed_reason": "Needs more focus", "title": "How to check if user did not enter all whitespace characters in C", "body": "<p>When prompting the user to enter there name, it is necessary that the user indeed entered a name and not just whitespace.</p>\n\n<p>Output ex:\nName:<br>\nYour name is: /<em>user entered only whitespace</em>/</p>\n\n<p>How would one validate that characters were actually implemented, and not just spaces? Im using fgets() to retreive my input however i am unable to post the code now for I am at work and doing this off my mobile device. If code is nessesary i will post what im working on late tonight (pacific standard time). Thank you!</p>\n"}, {"tags": ["c", "encryption"], "comments": [{"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "edited": false, "score": 0, "creation_date": 1473199856, "post_id": 39358577, "comment_id": 66047009, "body": "From a quick glance, I think <code>for(i = 1; i &lt;= sl; i++) {</code> should be  <code>for(i = 0; i &lt; sl; i++) {</code>."}, {"owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "reply_to_user": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "edited": false, "score": 0, "creation_date": 1473199989, "post_id": 39358577, "comment_id": 66047047, "body": "You&#39;re right, I changed it"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1473199990, "post_id": 39358577, "comment_id": 66047048, "body": "<code>isalpha(key)</code> should take a single <code>char</code> (actually <code>int</code>) not a pointer. Do you have compiler warnings enabled? in the same staement, you left it too late to check <code>argc == 3</code> which is <i>after</i> you have accessed <code>*argv[]</code>"}, {"owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "edited": false, "score": 0, "creation_date": 1473200292, "post_id": 39358577, "comment_id": 66047140, "body": "Okay, I tried isalpha((char)key) but I still get a segmentation fault"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473200327, "post_id": 39358577, "comment_id": 66047150, "body": "I am talking about line 14. <code>if(isalpha(key) &amp;&amp; argc == 3) {</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1473201046, "post_id": 39358577, "comment_id": 66047232, "body": "show your (program started) command line."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473201056, "post_id": 39358577, "comment_id": 66047235, "body": "You can&#39;t just make a cast and hope the problem goes away. It only hides an error. In a later line you did <code>if(isalpha(msg[i]))</code> but the line 14 has no sense."}, {"owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "edited": false, "score": 0, "creation_date": 1473201236, "post_id": 39358577, "comment_id": 66047281, "body": "I understand, so if I wanted to use isalpha to check the string I would to index through it in a for loop?"}, {"owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "edited": false, "score": 0, "creation_date": 1473201514, "post_id": 39358577, "comment_id": 66047337, "body": "I thought that argv[i] was a string, therefore it is a character array, and that means char *msg = argv[1] is a char ** and in order to pass it to isalpha() I need to dereference i.e. pass as isalpha(*msg[i])"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1473202208, "post_id": 39358577, "comment_id": 66047522, "body": "Well, If you declare it as <code>char *</code> it can&#39;t be a <code>char **</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1473202923, "post_id": 39358577, "comment_id": 66047689, "body": "You should check <code>argc</code> before doing anything with <code>argv[1]</code> and <code>argv[2]</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1473203105, "post_id": 39358577, "comment_id": 66047736, "body": "The <code>return 1;</code> line is not part of the <code>else</code> block, so this will always return from <code>main</code> at that point.  Execution never reaches the <code>j</code> line. The only way you would get a segmentation fault is if you did not actually provide 2 commandline arugments."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1473203290, "post_id": 39358577, "comment_id": 66047782, "body": "Bad allocation and type: <code>int encrypt[strlen(msg)];</code> should be <code>char encrypt[strlen(msg)+1];</code> for loop should start at 1 and ending condition should be strict. Lot of other strange things, mg, ky..."}], "answers": [{"comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1473359613, "post_id": 39359003, "comment_id": 66121838, "body": "When you subtract <code>&#39;A&#39;</code>, for example, from <code>msg[i]</code>, you previously have checked if it is uppercase. But then you subtract <code>&#39;A&#39;</code> from <code>key[j]</code> too, without checking if it is uppercase (or even a letter). At the end you can print <code>encrypt</code> in a single line, no need to loop: <code>printf(&quot;%s\\n&quot;, encrypt);</code>. It was declared as <code>char encrypt[strlen(msg)+1];</code>, right?"}], "tags": [], "owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "is_accepted": false, "score": -1, "last_activity_date": 1473202938, "creation_date": 1473202938, "answer_id": 39359003, "question_id": 39358577, "link": "https://stackoverflow.com/questions/39358577/my-vignere-cipher-produces-a-segmentation-fault-am-i-reading-or-writing-an-ille/39359003#39359003", "title": "My Vignere Cipher produces a segmentation fault, am I reading or writing an illegal memory location, or am I using pointers incorrectly?", "body": "<p>Okay well I fixed some oversights such as lines 38 and 42. This snippet of code works as a cipher but it only works some of the time.</p>\n\n<hr>\n\n<pre><code>for(i = 0; i &lt; sl; i++) {\n\n    (i % strlen(key) == 0) ? j = 0 : j++;\n\n    mg = msg[i];\n    ky = key[j];\n\n    if(isalpha(msg[i])) {\n\n        if(isupper(msg[i])) {\n            encrypt[i] = 'A' + ((( msg[i] - 'A') + (key[j]) - 'A') % 26);\n        }\n\n        else if(islower(msg[i])) {\n            encrypt[i] = 'a' + (((msg[i] - 'a') + (key[j]) - 'a') % 26);\n        }\n    else {\n        encrypt[i] = msg[i];\n    }\n    }\n}\n\nfor(i = 0; i &lt; strlen(msg); i++) {\n\n    printf(\"%c\", encrypt[i]);\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1473202938, "creation_date": 1473199760, "question_id": 39358577, "link": "https://stackoverflow.com/questions/39358577/my-vignere-cipher-produces-a-segmentation-fault-am-i-reading-or-writing-an-ille", "title": "My Vignere Cipher produces a segmentation fault, am I reading or writing an illegal memory location, or am I using pointers incorrectly?", "body": "<p>My intent with this code is to make a vignere cipher.</p>\n\n<p>I can compile my code with gcc but when I run the program and pass 2 strings in the command line I have a segmentation fault. Initially I had tried to control the int value of j with a separate if-statement in my for-loop such as:</p>\n\n<hr>\n\n<pre><code>if( i % strlen(msg) == 0) {\n    j = 0;\n}\nelse {\n    j++;\n}\n</code></pre>\n\n<hr>\n\n<p>However, it was not clear to me if this would produce my intended result, to execute an expression in this if-statement and to then continue with the next if-statement. So, I substitute a conditional statement and the code compiles. However, in <strong>both</strong> cases I get a segmentation fault, using either method with j.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(int argc, char *argv[]) {\n\nchar *msg = argv[1];\nchar *key = argv[2];\nint i, j, sl, ky, mg;\nsl = strlen(key);\nj = 1;\nint encrypt[strlen(msg)];\n\nif(isalpha(key) &amp;&amp; argc == 3) {\n    ;\n}\nelse\n    perror(\"run program from cmd line with 2 strings \\n\");\n    return 1;\n\nfor(i = 1; i &lt;= sl; i++) {\n\n    (i % strlen(key) == 0) ? j = 0 : j++;\n\n    mg = msg[i];\n    ky = key[j];\n\n    if(isalpha(msg[i])) {\n\n        if(isupper(msg[i])) {\n            msg[i] = 'A' + (('A' - msg[i]) + ('A' - key[j]) % 26);\n        }\n\n        else if(islower(msg[i])) {\n            msg[i] = 'a' + (('a' - msg[i]) + ('a' - key[j]) % 26);\n        }\n    else {\n        msg[i] = msg[i];\n    }\n    }\n}\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473198930, "post_id": 39358199, "comment_id": 66046732, "body": "Does <code>max</code> need to change if <code>min</code> changes?"}, {"owner": {"reputation": 31, "user_id": 6381778, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-IVzpY3XkEys/AAAAAAAAAAI/AAAAAAAAJNE/VCgiBTmY99I/photo.jpg?sz=128", "display_name": "Mr.A.N", "link": "https://stackoverflow.com/users/6381778/mr-a-n"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473199433, "post_id": 39358199, "comment_id": 66046878, "body": "No need of changing max if min changes. Only problem is the window of L days. In the array given as input answer should be 597 (from 3 and 600) but since 1 is minimum my algorithm ignores this part and scans only till next L element after encountering minimum"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473199490, "post_id": 39358199, "comment_id": 66046902, "body": "Please don&#39;t use <code>l</code> (ell) as a variable name, it is too easily confused with <code>1</code> (one). I was about to say the the only condition that satisfies <code>i&lt;j&lt;=i+1</code> is <code>j=i+1</code>. Be informative, imaginative. How the devil is anyone going to know what a function argument <code>int l</code> is for?"}, {"owner": {"reputation": 31, "user_id": 6381778, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-IVzpY3XkEys/AAAAAAAAAAI/AAAAAAAAJNE/VCgiBTmY99I/photo.jpg?sz=128", "display_name": "Mr.A.N", "link": "https://stackoverflow.com/users/6381778/mr-a-n"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473199734, "post_id": 39358199, "comment_id": 66046976, "body": "Point noted @weather"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473200064, "post_id": 39358199, "comment_id": 66047080, "body": "So <code>min</code> should change if <code>max</code> changes then.  Disagree with <a href=\"http://stackoverflow.com/questions/39358199/maximum-profit-of-stock-selling-such-that-there-is-atmost-l-days-difference-be?noredirect=1#comment66046878_39358199\">comment</a>.  You have a sliding window of 5 or  <code>l</code> days.  As that window slides, the <code>min</code> needs to update also.  OTOH perhaps I do not follow the problem right."}, {"owner": {"reputation": 31, "user_id": 6381778, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-IVzpY3XkEys/AAAAAAAAAAI/AAAAAAAAJNE/VCgiBTmY99I/photo.jpg?sz=128", "display_name": "Mr.A.N", "link": "https://stackoverflow.com/users/6381778/mr-a-n"}, "edited": false, "score": 0, "creation_date": 1473200943, "post_id": 39358199, "comment_id": 66047212, "body": "You are right Cox..  Just I need to update minimum after windows closes. I&#39;m trying to solve In linear time,  if you have any suggestion tell me. Thnx"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473201312, "post_id": 39358199, "comment_id": 66047297, "body": "I see an <code>O(n*l)</code> solution, but not <code>O(n)</code>.  Each time min falls out of the windows, find new min.  Will ponder.  I suspect a <code>O(n+l)</code> solution exists"}, {"owner": {"reputation": 41174, "user_id": 270287, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1GwpB.jpg?s=128&g=1", "display_name": "IVlad", "link": "https://stackoverflow.com/users/270287/ivlad"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484602313, "post_id": 39358199, "comment_id": 70567711, "body": "@chux I believe I&#39;ve found such an <code>O(n)</code> solution, if you would like to review it."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1484605824, "post_id": 41685223, "comment_id": 70569237, "body": "This is certainly a <code>O(size)</code> algorithm.  Likely functions as desired - unable to review that at this time."}], "tags": [], "owner": {"reputation": 41174, "user_id": 270287, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1GwpB.jpg?s=128&g=1", "display_name": "IVlad", "link": "https://stackoverflow.com/users/270287/ivlad"}, "is_accepted": false, "score": 1, "last_activity_date": 1484602373, "last_edit_date": 1484602373, "creation_date": 1484601979, "answer_id": 41685223, "question_id": 39358199, "link": "https://stackoverflow.com/questions/39358199/maximum-profit-of-stock-selling-such-that-there-is-atmost-l-days-difference-be/41685223#41685223", "title": "Maximum Profit of stock selling such that there is atmost &quot;L&quot; days difference between buying and selling", "body": "<p>So for each <code>i</code>, we need the minimum in <code>[i - len, i-1]</code>. We can do this using a <a href=\"https://en.wikipedia.org/wiki/Double-ended_queue\" rel=\"nofollow noreferrer\">deque</a> that we will keep sorted ascendingly from front to back. The first element will always be the minimum. We will store indexes in the deque, not actual values.</p>\n\n<pre><code>st.push_back(0)\nmax_profit = 0\nfor i = 1 to size - 1:\n    while !st.empty() &amp;&amp; i - st.front() &gt; len: // remove elements farther than len from i \n        st.pop_front()\n    if array[i] - array[ st.front() ] &gt; max_profit:\n        max_profit = array[i] - array[ st.front() ]\n\n    // add array[i] to the deque, while keeping it sorted.\n    while !st.empty() &amp;&amp; array[ st.back() ] &gt; array[i]:\n        st.pop_back()\n    st.push_back(i)\n</code></pre>\n\n<p>Since each element can enter and leave the deque at most once, this is <code>O(n)</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 6381778, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-IVzpY3XkEys/AAAAAAAAAAI/AAAAAAAAJNE/VCgiBTmY99I/photo.jpg?sz=128", "display_name": "Mr.A.N", "link": "https://stackoverflow.com/users/6381778/mr-a-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1484602759, "creation_date": 1473197770, "last_edit_date": 1484602759, "question_id": 39358199, "link": "https://stackoverflow.com/questions/39358199/maximum-profit-of-stock-selling-such-that-there-is-atmost-l-days-difference-be", "title": "Maximum Profit of stock selling such that there is atmost &quot;L&quot; days difference between buying and selling", "body": "<p>I'm trying to solve Stock Selling problem by using Max Difference algorithm, but I'm not able to solve for the condition <code>i&lt;j&lt;=i+l</code>, where <code>i</code> is the index of day of buying and <code>j</code> is index of selling , <code>l</code> is the maximum days stock must be sold. I need O(n) algorithm. </p>\n\n<pre><code>/* \nMaximum absolute difference with i&lt;j&lt;=i+l   --&gt; \nKeeping track of two elements --&gt; \nMax difference and minimum element found so far --&gt; O(n) \n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint maxDifference(int arr[] , int size , int l){\n    int max = abs(arr[1] - arr[0]) ;\n    int min = arr[0] ;\n    int minIndex = 0;\n    int maxIndex = 1;\n    for(int i = 1 ; i &lt; size ; i++){\n\n        if(abs(arr[i] - min) &gt; max){\n            maxIndex = i;\n            printf(\"%d maxOuter\\n\",i);\n            if((maxIndex - minIndex) &lt;= l &amp;&amp; minIndex &lt; maxIndex){\n                printf(\"%d max\\n\",i);\n                max = arr[i] - min ;\n            }\n        }\n\n        if(arr[i] &lt;= min){\n            printf(\"%d min\\n\",i);\n            min = arr[i] ;\n            minIndex = i ;\n        }\n\n    }\n    return max;\n}\n\nint main(){\n    int arr[] = { \n        2, 3, 1, 15, 4, 8, 15, 35, 1, 55, 203, 3, 450, 550, 100, 600}; //3 and 600\n    int size = sizeof(arr) / sizeof(arr[0]);\n    int l = 5;\n    printf(\"%d\" , maxDifference(arr , size , l)) ;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "memory-management", "opencl", "gpgpu"], "comments": [{"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1473251063, "post_id": 39358077, "comment_id": 66067609, "body": "I think 3-4TB/s of local memory is insane. I do not know where if comes from, but it the device is capable of just 700 GFLOP/s, it is literally impossible to have 4TB/s of transfer speed. From a HW desing point of view, it means the memory is overdesigned, able to provide x4 more data than the ALUs can process. It would make more sense that is 4Tb/s or 200GB/s. Similar to what you are obtaining."}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1473257802, "post_id": 39358077, "comment_id": 66072568, "body": "Approaching to bandwidth limit, not a single computation could be done; and similary when approaching to compute limit, not a single cache operation could be done."}], "answers": [{"comments": [{"owner": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473203748, "post_id": 39358812, "comment_id": 66047892, "body": "Thanks for the thorough (and quick) response! You mention that the use of __private registers, which in this case would be rtemp if I inderstand correctly, isn&#39;t supported on the iGPU and forces GPU-CPU communication-- how would this account for similar performance on nvidia GPUs? Thank you for the float8 suggestion; it doesn&#39;t seem to be affecting performance, but I&#39;ll try some different access methods with it and see what happens. Omitting &quot;loc[23] = 34;&quot; also doesn&#39;t seem to affect performance; the execution takes the same amount of time with the default values of zero for the local array."}, {"owner": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473204146, "post_id": 39358812, "comment_id": 66047989, "body": "I moved rtemp to local memory and execution time doubled; changing it back to private cut execution time back down, which hopefully rules out private registers being a bottleneck."}, {"owner": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473205786, "post_id": 39358812, "comment_id": 66048409, "body": "After some checking of glGetDeviceIDs and clGetDeviceInfo I was using the integrated intel GPUs on the machines I tested on instead of the Nvidia / AMD dGPUs, which led to times around 35% faster than mine-- at this point there&#39;s a strong case for 150 GB/s being a typical local memory speed. Was the figure you used a one you&#39;ve seen, or just an example to illustrate the point you were making?"}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "reply_to_user": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473247220, "post_id": 39358812, "comment_id": 66064926, "body": "@LukasPalmer added the answer at the end, please check."}, {"owner": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473256434, "post_id": 39358812, "comment_id": 66071560, "body": "great! In my case it still seems like global memory is only around half as fast as local memory, even without optimization, but this is some good information! I didn&#39;t think about all the threads looking in the same spot, the idL trick fixed that."}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "reply_to_user": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473257086, "post_id": 39358812, "comment_id": 66072051, "body": "@LukasPalmer if device has &quot;broadcast&quot; ability, you are measuring its bandwidth instead of cache/local. When more than one threads are accessing same location, the worg group access only once and then broadcast to all threads that needs it. Random accesses to Loc array may be triggering this but with a very low probability of course. For the bandwith table, <a href=\"http://developer.amd.com/wordpress/media/2013/07/AMD_Accelerated_Parallel_Processing_OpenCL_Programming_Guide-rev-2.7.pdf\" rel=\"nofollow noreferrer\">developer.amd.com/wordpress/media/2013/07/&hellip;</a> look at appendix-d table D-2. R7-240 should be 500 GB/s for LDS according to table."}], "tags": [], "owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "is_accepted": false, "score": 1, "last_activity_date": 1478739376, "last_edit_date": 1478739376, "creation_date": 1473201552, "answer_id": 39358812, "question_id": 39358077, "link": "https://stackoverflow.com/questions/39358077/intel-hd-6000-local-memory-bandwidth-with-opencl/39358812#39358812", "title": "Intel HD 6000 local memory bandwidth with OpenCL", "body": "<p>Answer is at <strong>edit2</strong> part at the end of answer.</p>\n\n<p>If dedicated gpu timings are bad, you can try pipelining read+compute+write operations like</p>\n\n<p><a href=\"https://i.stack.imgur.com/pTgx4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pTgx4.png\" alt=\"enter image description here\"></a></p>\n\n<p>from left to right, it starts overlapped operations in the second step so compute latency is hidden, then third step hides write latency too. This is an example of dividing a seperable work into 4 parts. Maybe more parts give slower result that should be benchmarked per device. Kernel execution is just an \"adding\" so it is always hidden but heavier ones may not be. This decreases I/O latencies if that graphics card can do read and write at the same time. Picture also shows idle(vertically empty) timelines because of redundant synchronizations to make it more readable than a packed but faster version.</p>\n\n<p>Your igpu 151 GB/s bandwidth could be cpu-cache. It doesnt have addressable register space so even using __private registers could make it fetch from cache. Also caches have different line widths per cpu or gpu.</p>\n\n<blockquote>\n  <p>loc[23] = 34;</p>\n</blockquote>\n\n<p>has race condition by multiple threads and gets serialized.</p>\n\n<p>And there is a possibility of</p>\n\n<blockquote>\n  <p>for(int i = 0; i &lt; 1024; i ++) {\n           rtemp += loc[(i * 445) % 1024];\n        }</p>\n</blockquote>\n\n<p>being unrolled automatically and putting pressure on instruction cache and cache/memory. You could try different levels of unrolling.</p>\n\n<p>Are you sure 8 cores per execution unit of that igpu, utilized? Maybe only 1 core per EU is used that may not be enough for fully stressing cache/memory(such as cache line collision by using all 1st cores but nothing else)? Try with float8 version instead of just float. Latest intel cpus have over a TB per second.</p>\n\n<p>GFLOPS limit is rarely approached. Around %50 with optimized code, %75 with unreadeable code, %90 with no-meaningful code.</p>\n\n<hr>\n\n<p><strong>Edit:</strong> below code was run on an AMD-R7-240 card at 900MHz(no more than 30 GB/s memory and 600 GFlops) for 16M elements of results.</p>\n\n<pre><code>        __kernel void vecAdd(__global float* results )\n        {\n           int id = get_global_id(0);\n           __local float loc[1024]; // some devices may slow with this\n           if(id &lt; (4096*4096)) {\n              float rtemp = 0;\n              loc[23] = 34;\n              for(int i = 0; i &lt; 1024; i ++) {\n                 rtemp += loc[(i * 445) % 1024];\n              }\n              results[id] = rtemp;\n           }\n        }\n</code></pre>\n\n<p>it took </p>\n\n<ul>\n<li>575 milliseconds(no pipeline) to write+compute+read</li>\n<li>530 milliseconds(2-part pipelined) to write+compute+read</li>\n<li>510 milliseconds(8-part pipelined) to write+compute+read</li>\n<li>455 milliseconds to compute (140 GB/s local memory bandwidth )</li>\n</ul>\n\n<p><strong>Edit2:</strong> optimizing for cache line utilization, compute simplification and less bubbles in shader cores:</p>\n\n<pre><code>        __kernel void vecAdd(__global float* results )\n        {\n           int id = get_global_id(0);\n           int idL = get_local_id(0);\n           __local float loc[1024];\n           float rtemp = 0;\n           if(id &lt; (4096*4096)) {\n\n              loc[23] = 34;\n           }\n\n           barrier (CLK_LOCAL_MEM_FENCE);\n\n           if(id &lt; (4096*4096)) {\n              for(int i = 0; i &lt; 1024; i ++) {\n                 rtemp += loc[(i * 445+ idL) &amp; 1023];\n              }\n              results[id] = rtemp;\n           }\n        }\n</code></pre>\n\n<ul>\n<li>325 milliseconds (16-part pipelined) to write+compute+read</li>\n<li>270 milliseconds to compute (235 GB/s local memory bandwidth )</li>\n</ul>\n\n<blockquote>\n  <p>loc[(i * 445) % 1024];</p>\n</blockquote>\n\n<p>is same for all threads, all random but changing to same value at each step, accessing through same cache line. Adding a local variation to all threads but having same summation in the end, uses more lines. </p>\n\n<blockquote>\n  <p>% 1024</p>\n</blockquote>\n\n<p>is optimized with </p>\n\n<blockquote>\n  <p>&amp;1023</p>\n</blockquote>\n\n<p>lastly, barrier to elliminate any instruction bubbles in SIMD after loc[23] = 34;</p>\n\n<p><strong>Edit3:</strong> Adding some loop-unrolling and increasing local work group size from 64 to 256 (edit and edit2 were 64)</p>\n\n<pre><code>        __kernel void vecAdd(__global float* results )\n        {\n           int id = get_global_id(0);\n           int idL = get_local_id(0);\n           __local float loc[1024];\n           float rtemp = 0;\n           float rtemp2 = 0;\n           float rtemp3 = 0;\n           float rtemp4 = 0;\n           if(id &lt; (4096*4096)) {\n\n              loc[23] = 34;\n           }\n\n           barrier (CLK_LOCAL_MEM_FENCE);\n\n           if(id &lt; (4096*4096)) {\n              int higherLimitOfI=1024*445+idL;\n              int lowerLimitOfI=idL;\n              int stepSize=445*4;\n              for(int i = lowerLimitOfI; i &lt; higherLimitOfI; i+=stepSize) {\n                 rtemp += loc[i &amp; 1023];\n                 rtemp2 += loc[(i+445) &amp; 1023];\n                 rtemp3 += loc[(i+445*2) &amp; 1023];\n                 rtemp4 += loc[(i+445*3) &amp; 1023];\n              }\n              results[id] = rtemp+rtemp2+rtemp3+rtemp4;\n           }\n        }\n</code></pre>\n\n<ul>\n<li>290 milliseconds (8-part pipelined) to write+compute+read without redundant sync(forgot this at other benchmarks)</li>\n<li>278 miliseconds on pci-e 2.0 8x instead of 4x</li>\n<li>249 milliseconds on 4 queues(rcw + rcw + rcw + rcw) with no events instead of 3 queues(r+c+w) with event flow. (32 parts for each queue so 128x rcw parts total )</li>\n<li>243 milliseconds to compute + (map/unmap instead of read/write)</li>\n<li>240 milliseconds to compute (264 GB/s local memory bandwidth )</li>\n<li>1410 ms for <strong>Intel(R) HD Graphics 400</strong> @ 600 MHz (45 GB/s)\n<ul><li>warning: it is the __global array access </li>\n</ul>\n\n\n<blockquote>\n  <p>results[id] = ...</p>\n  \n  <p>__global array access is bottleneck for this device for this algorithm.</p>\n  \n  <p>230 ms instead of 1410 ms for HD 400 !!!! (this should be cache/local bandwidth)</p>\n</blockquote>\n\n </li><li>12 compute units each with 8 cores =>96 cores 45 GB/s means 1 core 0.5 GB/s @600 MHz or **nearly 1 byte per core per clock** </li><li>Your igpu can read 1B per core per 3 cycles but it has 384 cores total => **192 GB/s (you are close to limit)**</li><li>Look at this picture, it writes 64B per slice which means 64 bytes per 192 cores per cycle or 192bytes read per 192 cores per 3 cycles:  </li></ul>\n\n<p>- VGPR usage limits kernel occupancy to %60 according to profiler.\n<a href=\"https://i.stack.imgur.com/NhreP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NhreP.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473277572, "post_id": 39376397, "comment_id": 66083764, "body": "Thanks, this is great information? How would I go about calculating the expected (peak) local memory bandwidth from an Nvidia card like the GTX 1070 that doesn&#39;t have architectural data like &quot;slices&quot; and &quot;subslices&quot; listed?"}, {"owner": {"reputation": 212, "user_id": 5001337, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153369288784800/picture?type=large", "display_name": "Robert Ioffe", "link": "https://stackoverflow.com/users/5001337/robert-ioffe"}, "reply_to_user": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "edited": false, "score": 0, "creation_date": 1473381805, "post_id": 39376397, "comment_id": 66130214, "body": "Sorry, Lukas, I am an Intel guy :) Maybe someone else here knows Nvidia hardware."}], "tags": [], "owner": {"reputation": 212, "user_id": 5001337, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153369288784800/picture?type=large", "display_name": "Robert Ioffe", "link": "https://stackoverflow.com/users/5001337/robert-ioffe"}, "is_accepted": true, "score": 3, "last_activity_date": 1473270806, "creation_date": 1473270806, "answer_id": 39376397, "question_id": 39358077, "link": "https://stackoverflow.com/questions/39358077/intel-hd-6000-local-memory-bandwidth-with-opencl/39376397#39376397", "title": "Intel HD 6000 local memory bandwidth with OpenCL", "body": "<p>Intel HD 6000 has two slices with three subslices each, each subslice separately connected to Shared Local Memory (see diagram here <a href=\"http://www.notebookcheck.net/Intel-HD-Graphics-6000.125588.0.html\" rel=\"nofollow\">http://www.notebookcheck.net/Intel-HD-Graphics-6000.125588.0.html</a> ) with a bandwidth of 64 bytes per cycle, so assuming 1 GHz clock, you get 6 * 64 * 1 GHz = 384 GB/s of peak BW from local memory. You get that if you are hitting every one of 16 banks of local memory (local memory is highly banked so you could fetch 4 bytes per cycle from each bank independently). You get that kind of pattern with loc[id] access or something like that. Download Intel SDK for OpenCL <a href=\"https://software.intel.com/en-us/intel-opencl\" rel=\"nofollow\">https://software.intel.com/en-us/intel-opencl</a> - it gives you the assembly view among other things: your code will be compiled SIMD32, but the assembly your code generates is pretty horrible, since you keep pounding the same location from every SIMD lane, so you are lucky that you got as high as 151 GB/s.</p>\n"}], "owner": {"reputation": 378, "user_id": 5930527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7hFCc.png?s=128&g=1", "display_name": "Lukas Palmer", "link": "https://stackoverflow.com/users/5930527/lukas-palmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "closed_date": 1473435603, "accepted_answer_id": 39376397, "answer_count": 2, "score": 1, "last_activity_date": 1478739376, "creation_date": 1473197053, "last_edit_date": 1495542637, "question_id": 39358077, "link": "https://stackoverflow.com/questions/39358077/intel-hd-6000-local-memory-bandwidth-with-opencl", "closed_reason": "Needs more focus", "title": "Intel HD 6000 local memory bandwidth with OpenCL", "body": "<p>I'm working on some local/global memory optimization in OpenCL; after looking at <a href=\"https://stackoverflow.com/questions/21872810/whats-the-advantage-of-the-local-memory-in-opencl\">this question</a> from two years ago, I think I'm doing something wrong since local memory IO seems to be considerably slower than it should be. My GPU is an Intel HD 6000.</p>\n\n<p>This is my testing setup, with kernel source:</p>\n\n<pre><code>__kernel void vecAdd(__global float* results, const unsigned int n, __local float* loc)\n{\n   int id = get_global_id(0);\n   if(id &lt; n) {\n      float rtemp = 0;\n      loc[23] = 34;\n      for(int i = 0; i &lt; 1024; i ++) {\n         rtemp += loc[(i * 445) % 1024];\n      }\n      results[id] = rtemp;\n   }\n}\n</code></pre>\n\n<p>All the kernel does is take the local float array <em>loc</em> and add random values from it into a global output vector. The fragment \"(i * 445) % 1024\" is used to ensure the local memory is randomly accessed; performance is a little better (~30% speedup) than the figure mentioned at the end without the randomization.</p>\n\n<ul>\n<li><p>I queued the kernel for 16777216 / 16M iterations, with a work group size of 256 and a local buffer of 1024 floats, all zeroes except l[23].</p></li>\n<li><p>Overall, this makes a total of 16M * 1 = 16M writes and 16M * 1024 = 16G reads to the local memory.</p></li>\n<li><p>There're also around 16M * 1024 * 2 floating point operations, likely more depending on how modulo is calculated, but the HD 6000 has floating point performance around 768 GFLOPS which shouldn't be a bottleneck.</p></li>\n<li><p>16G reads of float values lead to 64G of memory being read; execution of the kernel took 453945 \u03bcs to complete, giving an estimated local memory bandwidth of <strong>151 GB/s</strong>.</p></li>\n</ul>\n\n<p>The figures thrown around in the referenced question suggest that modern graphics cards (from 2014) potentially have much higher memory bandwidth than I measured on my machine; the figure quoted in the article (which may have been a random example for comparison) was 3-4 TB/s; while my card is an integrated card as opposed to dedicated, this still seems like a slow figure considering it's release in 2015.</p>\n\n<p>To make things even more confusing, I'm getting worse performance on some dedicated mid-range GPUs: both an AMD R9 m370x and an Nvidia GT 750m took 700-800 ms. These are slightly older cards than Intel's HD 6000, so that could have something to do with it.</p>\n\n<p>Is there any potential way to squeeze more performance out of local memory, or am I utilizing local memory as efficiently as possible?</p>\n"}, {"tags": ["c", "swift", "macos", "swift2"], "comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 1, "creation_date": 1473196610, "post_id": 39357921, "comment_id": 66045845, "body": "Your code compiles and runs with Xcode 8 beta 6."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1473197259, "post_id": 39357921, "comment_id": 66046085, "body": "@MartinR Yeah, this somehow sounds like a bug in the C bridging and most likely it got fixed in Swift 3. Yet I need a solution that works with Swift 2.3 :-("}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 1, "creation_date": 1473198991, "post_id": 39357921, "comment_id": 66046759, "body": "@Mecki: <code>let s2 = someString.map { embeddedSize($0) } ?? embeddedSize(nil)</code> would be an option."}], "answers": [{"comments": [{"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1473196940, "post_id": 39357963, "comment_id": 66045968, "body": "You analyzed the problem pretty well... but the question is, do you have a work-a-round? I tried something like <code>let s = (string ?? nil)</code> but that won&#39;t work, as of course <code>nil</code> means <code>nil string</code> and thus <code>s</code> will also be <code>String?</code> :-( I also tried <code>let s = (maybeString ?? UnsafePointer&lt;UInt8&gt;(nil))</code> but that won&#39;t work either as of course, what type shall <code>s</code> then be?"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1473197564, "post_id": 39357963, "comment_id": 66046200, "body": "The best that I could come up with is this: <a href=\"http://iswift.org/playground?TpbkmE\" rel=\"nofollow noreferrer\">iswift.org/playground?TpbkmE</a> (EDIT: wtf, the website discarded everything between generic brackets! It should be <code>UnsafePointer&lt;CChar&gt;</code> and <code>withOptionalStringPointer&lt;T&gt;</code>.)"}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1473199558, "post_id": 39357963, "comment_id": 66046914, "body": "@zneak: Why don&#39;t you add that to your answer?"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1473199727, "post_id": 39357963, "comment_id": 66046974, "body": "I don&#39;t think that it&#39;s particularly satisfactory. I&#39;m not sure that I can think of anything better, though."}], "tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": false, "score": 2, "last_activity_date": 1473196543, "creation_date": 1473196543, "answer_id": 39357963, "question_id": 39357921, "link": "https://stackoverflow.com/questions/39357921/why-cant-i-pass-an-optional-swift-string-to-c-function-that-allows-null-pointer/39357963#39357963", "title": "Why can&#39;t I pass an optional Swift String to C function that allows NULL pointers?", "body": "<p>The most likely answer is that while string literals are convertible to <code>UnsafePointer&lt;CChar&gt;</code>, and <code>nil</code> is convertible to <code>UnsafePointer&lt;CChar&gt;</code>, and <code>String</code> also is, <code>String?</code> might not be in Swift 2.</p>\n"}, {"comments": [{"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1473237791, "post_id": 39363769, "comment_id": 66058971, "body": "While this workaround works for <code>embeddedSize()</code>, I have other functions like that and they use multiple <code>const char *</code> arguments and if you have multiple, you&#39;d have to make <code>if</code>s for all possible combinations, so I must find more generic way."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "reply_to_user": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1473238321, "post_id": 39363769, "comment_id": 66059279, "body": "@Mecki: OK, I see what you mean. Did you have a look at the code that sneak  linked to in his comment? I don&#39;t know if a more elegant solution is possible, because a (optional) UTF-8 string must be generated for each Swift string, and the lifetime of that UTF-8 string must be at least until the function returns."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "reply_to_user": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1473268918, "post_id": 39363769, "comment_id": 66079748, "body": "@Mecki: I have seen that you already figured out a solution. I have added another one (which at least resembles existing methods) to this answer."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1473288607, "post_id": 39363769, "comment_id": 66088105, "body": "I like your second solution more than your first one; not that  \tpyramiding <code>if</code> statements are particular nice if you have a lot of strings to pass to a single C function call, but they&#39;ll still look nicer than the solution I came up with; and to be honest, I had never even gotten the idea to extend the Optional type, that&#39;s pretty nifty :-)"}], "tags": [], "owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1473268888, "last_edit_date": 1495540862, "creation_date": 1473233364, "answer_id": 39363769, "question_id": 39357921, "link": "https://stackoverflow.com/questions/39357921/why-cant-i-pass-an-optional-swift-string-to-c-function-that-allows-null-pointer/39363769#39363769", "title": "Why can&#39;t I pass an optional Swift String to C function that allows NULL pointers?", "body": "<p>In Swift 2, the C function</p>\n\n<pre><code>size_t embeddedSize ( const char *_Nullable string );\n</code></pre>\n\n<p>is mapped to Swift as</p>\n\n<pre><code>func embeddedSize(string: UnsafePointer&lt;Int8&gt;) -&gt; Int\n</code></pre>\n\n<p>and you can pass a (non-optional) Swift string as the argument, \nas documented in \n<a href=\"https://developer.apple.com/library/prerelease/content/documentation/Swift/Conceptual/BuildingCocoaApps/InteractingWithCAPIs.html\" rel=\"nofollow noreferrer\">Interacting with C APIs</a> in the\n\"Using Swift with Cocoa and Objective-C\" reference:</p>\n\n<blockquote>\n  <p><strong>Constant Pointers</strong></p>\n  \n  <p>When a function is declared as taking a <code>UnsafePointer&lt;Type&gt;</code> argument, it can accept any of the following:</p>\n  \n  <ul>\n  <li>...</li>\n  <li>A <code>String</code> value, if <code>Type</code> is <code>Int8</code> or <code>UInt8</code>. The string will automatically be converted to UTF8 in a buffer, and a pointer to that buffer is passed to the function.</li>\n  <li>...</li>\n  </ul>\n</blockquote>\n\n<p>You can also pass <code>nil</code> because in Swift 2, <code>nil</code> is an allowed value\nfor <code>UnsafePointer</code>.</p>\n\n<p>As @zneak pointed out, the \"automatic conversion\" to UTF-8 does not work for <em>optional</em> strings in Swift 2, so you have to (conditionally)\nunwrap the string:</p>\n\n<pre><code>let someString: String? = \"Some String\"\nlet s2: size_t\nif let str = someString {\n    s2 = embeddedSize(str)\n} else {\n    s2 = embeddedSize(nil)\n}\n</code></pre>\n\n<p>Using the <code>map</code> method of <code>Optional</code> and the nil-coalescing \noperator <code>??</code>, this can be written more compactly as</p>\n\n<pre><code>let someString: String? = \"Some String\"\nlet s2 = someString.map { embeddedSize($0) } ?? embeddedSize(nil)\n</code></pre>\n\n<p>One generic solution was <a href=\"https://stackoverflow.com/questions/39357921/why-cant-i-pass-an-optional-swift-string-to-c-function-that-allows-null-pointer?noredirect=1#comment66046200_39357963\">suggested by @zneak</a>.</p>\n\n<p>Here is another possible solution. <code>String</code> has a method</p>\n\n<pre><code>func withCString&lt;Result&gt;(@noescape f: UnsafePointer&lt;Int8&gt; throws -&gt; Result) rethrows -&gt; Result\n</code></pre>\n\n<p>which calls the closure with a pointer to the UTF-8 representation\nof the string, life-extended through the execution of <code>f</code>. So \nfor a non-optional string, the following two statements are\nequivalent:</p>\n\n<pre><code>let s1 = embeddedSize(\"Test\")\nlet s1 = \"Test\".withCString { embeddedSize($0) }\n</code></pre>\n\n<p>We can define a similar method for optional strings. Since \nextensions of generic types can restrict the type placeholder only\nto protocols and not to concrete types, we have to define a\nprotocol that <code>String</code> conforms to:</p>\n\n<pre><code>protocol CStringConvertible {\n    func withCString&lt;Result&gt;(@noescape f: UnsafePointer&lt;Int8&gt; throws -&gt; Result) rethrows -&gt; Result\n}\n\nextension String: CStringConvertible { }\n\nextension Optional where Wrapped: CStringConvertible {\n    func withOptionalCString&lt;Result&gt;(@noescape f: UnsafePointer&lt;Int8&gt; -&gt; Result) -&gt; Result {\n        if let string = self {\n            return string.withCString(f)\n        } else {\n            return f(nil)\n        }\n    }\n}\n</code></pre>\n\n<p>Now the above C function can be called with the optional\nstring argument as</p>\n\n<pre><code>let someString: String? = \"Some String\"\nlet s2 = someString.withOptionalCString { embeddedSize($0) }\n</code></pre>\n\n<p>For multiple C string arguments, the closure can be nested:</p>\n\n<pre><code>let string1: String? = \"Hello\"\nlet string2: String? = \"World\"\n\nlet result = string1.withOptionalCString { s1 in\n    string2.withOptionalCString { s2 in\n        calculateTotalLength(s1, s2)\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Apparently, the problem has been solved in Swift 3.\nHere the C function is mapped to</p>\n\n<pre><code>func embeddedSize(_ string: UnsafePointer&lt;Int8&gt;?) -&gt; Int\n</code></pre>\n\n<p>and passing a <code>String?</code> compiles and works as expected, both for\n<code>nil</code> and non-<code>nil</code> arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "is_accepted": false, "score": 1, "last_activity_date": 1473281129, "last_edit_date": 1473281129, "creation_date": 1473242023, "answer_id": 39366693, "question_id": 39357921, "link": "https://stackoverflow.com/questions/39357921/why-cant-i-pass-an-optional-swift-string-to-c-function-that-allows-null-pointer/39366693#39366693", "title": "Why can&#39;t I pass an optional Swift String to C function that allows NULL pointers?", "body": "<p>All the solutions that indirect the call by extra swift level, work fine if you only have one parameter. But I also have C functions like this (<code>strX</code> are not the real parameter names, the call is actually simplified):</p>\n\n<pre><code>size_t calculateTotalLength (\n    const char *_Nullable str1,\n    const char *_Nullable str2,\n    const char *_Nullable str3,\n    const char *_Nullable str4,\n    const char *_Nullable str5\n);\n</code></pre>\n\n<p>And here this indirection becomes impractical, as I need one indirection per argument, 5 indirections for the function above.</p>\n\n<p>Here's the best (ugly) \"hack\" I came up with so far, that avoids this problem (I'm still happy to see any better solutions, maybe someone gets an idea seeing that code):</p>\n\n<pre><code>private\nfunc SwiftStringToData ( string: String? ) -&gt; NSData? {\n    guard let str = string else { return nil }\n    return str.dataUsingEncoding(NSUTF8StringEncoding)\n}\n\nlet str1 = SwiftStringToData(string1)\nlet str2 = SwiftStringToData(string2)\nlet str3 = SwiftStringToData(string3)\nlet str4 = SwiftStringToData(string4)\nlet str5 = SwiftStringToData(string5)\n\nlet totalLength = calculateTotalLength(\n    str1 == nil ? \n        UnsafePointer&lt;Int8&gt;(nil) : UnsafePointer&lt;Int8&gt;(str1!.bytes),\n    str2 == nil ? \n        UnsafePointer&lt;Int8&gt;(nil) : UnsafePointer&lt;Int8&gt;(str2!.bytes),\n    str3 == nil ? \n        UnsafePointer&lt;Int8&gt;(nil) : UnsafePointer&lt;Int8&gt;(str3!.bytes),\n    str4 == nil ? \n        UnsafePointer&lt;Int8&gt;(nil) : UnsafePointer&lt;Int8&gt;(str4!.bytes),\n    str5 == nil ? \n        UnsafePointer&lt;Int8&gt;(nil) : UnsafePointer&lt;Int8&gt;(str5!.bytes),\n)\n</code></pre>\n\n<p>In case someone thinks about just passing the result of <code>data.bytes</code> back to the caller, this is a very bad idea! The pointer returned by <code>data.bytes</code> is only guaranteed to stay valid as long as <code>data</code> itself stays alive and ARC will kill <code>data</code> as soon as it can. So the following is not valid code:</p>\n\n<pre><code>// --- !!! BAD CODE, DO NOT USE !!! ---\nprivate\nfunc SwiftStringToData ( string: String? ) -&gt; UnsafePointer&lt;Int8&gt;? {\n    guard let str = string else { UnsafePointer&lt;Int8&gt;(nil) }\n    let data = str.dataUsingEncoding(NSUTF8StringEncoding)\n    return UnsafePointer&lt;Int8&gt;(data.bytes)\n}\n</code></pre>\n\n<p>There is no guarantee that data is still alive when this method returns, the returned pointer might be a dangling pointer! Then I thought about the following:</p>\n\n<pre><code>// --- !!! BAD CODE, DO NOT USE !!! ---\nprivate\nfunc DataToCString ( data: NSData? ) -&gt; UnsafePointer&lt;Int8&gt;? {\n    guard let d = data else { UnsafePointer&lt;Int8&gt;(nil) }\n    return UnsafePointer&lt;Int8&gt;(d.bytes)\n}\n\nlet str1 = SwiftStringToData(string1)\nlet cstr1 = DataToCString(str1)\n// (*1)\n// ....\nlet totalLength = calculateTotalLength(cstr1, /* ... */)\n</code></pre>\n\n<p>But that is not guaranteed to be safe either. The compiler sees that <code>str1</code> is not referenced anymore when it gets to <code>(*1)</code>, so it may not keep it alive and when we reach the last line, <code>cstr1</code> is already a dangling pointer.</p>\n\n<p>It is only safe as shown in my first sample, since there the <code>NSData</code> objects (<code>str1</code> etc.) must be kept alive to the <code>calculateTotalLength()</code> function call and some methods (like <code>bytes</code> of <code>NSData</code> or <code>UTF8String</code> of <code>NSString</code>) are tagged to return an internal pointer, in which case the compiler will make sure the lifetime of the object is extended in the current scope as long as <em>the object or such an internal pointer is still referenced</em>. This mechanism makes sure, that the returned pointers (<code>str1.bytes</code> etc.) will definitely stay valid until the C function call has returned. Without that special tagging, not even that was guaranteed! The compiler may otherwise release the <code>NSData</code> objects directly after retrieving the byte pointers but prior to making the function call, as it had no knowledge that releasing the data object makes the pointers dangling.</p>\n"}], "owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1473281129, "creation_date": 1473196340, "last_edit_date": 1473196542, "question_id": 39357921, "link": "https://stackoverflow.com/questions/39357921/why-cant-i-pass-an-optional-swift-string-to-c-function-that-allows-null-pointer", "title": "Why can&#39;t I pass an optional Swift String to C function that allows NULL pointers?", "body": "<p>I have a C function that deals with C strings. The function actually allows strings to be NULL pointers. The declaration is like follows:</p>\n\n<pre><code>size_t embeddedSize ( const char *_Nullable string );\n</code></pre>\n\n<p>It is no problem to use this function like this in C:</p>\n\n<pre><code>size_t s1 = embeddedSize(\"Test\");\nsize_t s2 = embeddedSize(NULL); // s2 will be 0\n</code></pre>\n\n<p>Now I'm trying to use it from Swift. The following code works</p>\n\n<pre><code>let s1 = embeddedSize(\"Test\")\nlet s2 = embeddedSize(nil) // s2 will be 0\n</code></pre>\n\n<p>But what doesn't work is passing an optional string to it! This code will not compile:</p>\n\n<pre><code>let someString: String? = \"Some String\"\nlet s2 = embeddedSize(someString)\n</code></pre>\n\n<p>The compiler throws an error about the optional not being unwrapped and Xcode asks me if I maybe forgot to add <code>!</code> or <code>?</code>. However, why would I want to unwrap it? <code>NULL</code> or <code>nil</code> are valid values to be fed to the function. See above, I just passed <code>nil</code> to it directly and that compiled just well and returned the expected result. In my real code the string is fed from external and it is optional, I cannot force unwrap it, that will break if the string was <code>nil</code>. So how can I call that function with an optional string?</p>\n"}, {"tags": ["c", "gcc", "goto", "language-extension"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 11, "creation_date": 1473196321, "post_id": 39357887, "comment_id": 66045708, "body": "That&#39;s not one <code>&amp;&amp;</code> but two <code>&amp;</code>. And invalid in C, as the result of <code>&amp;</code> is no valid expression for another <code>&amp;</code>. Sure that is not C++ code??"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 37, "creation_date": 1473196361, "post_id": 39357887, "comment_id": 66045734, "body": "This looks kind of like GCC&#39;s <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.1.1/gcc/Labels-as-Values.html\" rel=\"nofollow noreferrer\">computed gotos</a>. Are <code>varOne</code>, <code>varTwo</code>, and <code>varThree</code> labels?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 13, "creation_date": 1473196454, "post_id": 39357887, "comment_id": 66045772, "body": "@user2357112: Good point. Once more a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would have helped."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473196672, "post_id": 39357887, "comment_id": 66045865, "body": "Hehe.. everyday there is something new.."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 13, "creation_date": 1473197003, "post_id": 39357887, "comment_id": 66045989, "body": "@Olaf: No, because <code>&amp;&amp;</code> will always be treated as a single unit by the lexer. Its the same reason why something like <code>return0</code> will be treated as a single identifier instead of as <code>return 0</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1473197434, "post_id": 39357887, "comment_id": 66046147, "body": "@hugomg: Good point. Anyway, that is no standard C and very likely a compiler extension."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 12, "creation_date": 1473199809, "post_id": 39357887, "comment_id": 66046994, "body": "I voted to reopen, because closing as &quot;off-topic&quot; seems wrong to me here: This is very certainly about GCC&#39;s computed gotos, and from a quick search it seems we don&#39;t have a question that&#39;s dealing with that in particular. Having such a question would be nice, saving potentially future &quot;that&#39;s a computed goto&quot; .. &quot;what&#39;s a computed goto&quot; discussions. Though it should be tagged appropriately (gcc and language-extension?)"}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1473220001, "post_id": 39357887, "comment_id": 66051125, "body": "Note that these are only useful for computed gotos - not for comparing the sizes of different blocks of code.  gcc has a tendency to move operations freely across label boundaries, so you cannot for instance label multiple implementations of the same algorithm and only use the smallest computed one (eliminating the others via dead code elimination) to optimize for size on different platforms where one algorithm may be smaller while a different algorithm is smaller on another platform."}, {"owner": {"reputation": 5164, "user_id": 1872046, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2GC1B.jpg?s=128&g=1", "display_name": "polkovnikov.ph", "link": "https://stackoverflow.com/users/1872046/polkovnikov-ph"}, "edited": false, "score": 0, "creation_date": 1473241818, "post_id": 39357887, "comment_id": 66061520, "body": "This is a pointer to a temporary pointer. Temporary pointer is an rvalue. You can take a pointer of lvalue only. So the correct answer to the question should be &quot;this leads to compile-time error unless unary operator&amp; is overloaded&quot;."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1473260062, "post_id": 39357887, "comment_id": 66074448, "body": "@technosaurus Not only that, but computed gotos are <i>not</i> guaranteed to be implemented as actual instruction pointers at all. One of the reasons GCC tells you not to share them between scopes is because it will often implement them as the equivalent of a <code>switch</code> block, so the &quot;pointer&quot; is actually just a <code>case</code> index and doesn&#39;t actually point to anything."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473206908, "post_id": 39358376, "comment_id": 66048694, "body": "It&#39;s a gcc extension. See the other answers."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 12, "creation_date": 1473206943, "post_id": 39358376, "comment_id": 66048702, "body": "This is correct information, but unfortunately, is not related to the question"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 1, "creation_date": 1473261633, "post_id": 39358376, "comment_id": 66075551, "body": "Ouch, meta effect gone bad. This answer is (or better was) good before it got closed and reopened again, changing in the mean time."}, {"owner": {"reputation": 9, "user_id": 5721348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/843bc0bc6402b4a2da45535f4440c3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Garnier", "link": "https://stackoverflow.com/users/5721348/fred-garnier"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1473270974, "post_id": 39358376, "comment_id": 66080723, "body": "@KeithThompson I wasn&#39;t aware of the extension in particular, but I did mention that it probably is an extension, in any case thanks for the info :)"}, {"owner": {"reputation": 13143, "user_id": 525036, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2cb78e30e3a47ab2311e1ccb83f5ee88?s=128&d=identicon&r=PG", "display_name": "Didier L", "link": "https://stackoverflow.com/users/525036/didier-l"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1473805471, "post_id": 39358376, "comment_id": 66278832, "body": "@Daniel Was this question discussed on meta? I couldn&#39;t find it. It is a bit unfortunate that the question got modified in a way that invalidates this answer."}, {"owner": {"reputation": 13143, "user_id": 525036, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2cb78e30e3a47ab2311e1ccb83f5ee88?s=128&d=identicon&r=PG", "display_name": "Didier L", "link": "https://stackoverflow.com/users/525036/didier-l"}, "edited": false, "score": 0, "creation_date": 1473805501, "post_id": 39358376, "comment_id": 66278843, "body": "@Fred, Don&#39;t get downhearted by the downvotes. If you want to do something about it, I think you have 2 possibilities: edit the answer to put a notice at the beginning that it is a gcc extension and refer to the other answers, or just delete it and get the <a href=\"http://stackoverflow.com/help/badges/38/peer-pressure\">peer pressure badge</a> \u2013 though I think the latter would actually be a loss of value for SO\u2026 Maybe move it to documentation?"}, {"owner": {"reputation": 9, "user_id": 5721348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/843bc0bc6402b4a2da45535f4440c3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Garnier", "link": "https://stackoverflow.com/users/5721348/fred-garnier"}, "reply_to_user": {"reputation": 13143, "user_id": 525036, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2cb78e30e3a47ab2311e1ccb83f5ee88?s=128&d=identicon&r=PG", "display_name": "Didier L", "link": "https://stackoverflow.com/users/525036/didier-l"}, "edited": false, "score": 0, "creation_date": 1473808108, "post_id": 39358376, "comment_id": 66279612, "body": "@DidierL Thanks for the comment and the nice words! :) I&#39;ll go with adding this to the documentation and will keep the answer here"}], "tags": [], "owner": {"reputation": 9, "user_id": 5721348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/843bc0bc6402b4a2da45535f4440c3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Garnier", "link": "https://stackoverflow.com/users/5721348/fred-garnier"}, "is_accepted": false, "score": -6, "last_activity_date": 1473198646, "creation_date": 1473198646, "answer_id": 39358376, "question_id": 39357887, "link": "https://stackoverflow.com/questions/39357887/what-does-a-operator-do-when-there-is-no-left-side-in-c/39358376#39358376", "title": "What does a &amp;&amp; operator do when there is no left side in C?", "body": "<p>I'm not aware of any operator that works this way in C. \nDepending on the context, the ampersand in C can mean many different things. </p>\n\n<h1>Address-Of operator</h1>\n\n<p>Right before an lvalue, e.g.</p>\n\n<pre><code>int j;\nint* ptr = &amp;j;\n</code></pre>\n\n<p>In the code above, <strong>ptr</strong> stores the address of j, &amp; in this context is taking the address of any lvalue. The code below, would have made more sense to me if it was written that way.</p>\n\n<pre><code>static int varOne;\nstatic int varTwo;\nstatic int varThree;\n\nstatic void *arr[1][8432] = { { &amp;varOne,&amp;varTwo, &amp;varThree } };\n</code></pre>\n\n<h1>Logical AND</h1>\n\n<p>The logical AND operator is more simple, unlike the operator above, it's a binary operator, meaning it requires a left and right operand. The way it works is by evaluating the left and right operand and returning true, iff both are true, or greater than 0 if they are not bool.</p>\n\n<pre><code>bool flag = true;\nbool flag2 = false;\nif (flag &amp;&amp; flag2) {\n    // Not evaluated\n}\nflag2 = true;\nif (flag &amp;&amp; flag2) {\n   // Evaluated\n}\n</code></pre>\n\n<h1>Bitwise AND</h1>\n\n<p>Another use of the ampersand in C, is performing a bitwise AND. It's similar as the logical AND operator, except it uses only one ampersand, and performs an AND operation at the bit level.</p>\n\n<p>Let's assume we have a number and that it maps to the binary representation shown below, the AND operation works like so:</p>\n\n<pre><code>0 0 0 0 0 0 1 0\n1 0 0 1 0 1 1 0\n---------------\n0 0 0 0 0 0 1 0\n</code></pre>\n\n<p>In C++ land, things get more complicated. The ampersand can be placed after a type as to denote a reference type (you can think of it as a less powerful but safe kind of pointer), then things get even more complicated with 1) r-value reference when two ampersands are placed after a type. 2) Universal references when two ampersands are placed after a template type or auto deducted type.</p>\n\n<p>I think your code probably compiles only in your compiler due to an extension of some sorts. I was thinking of this <a href=\"https://en.wikipedia.org/wiki/Digraphs_and_trigraphs#C\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Digraphs_and_trigraphs#C</a> but I doubt that's the case. </p>\n"}, {"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1473207126, "post_id": 39359469, "comment_id": 66048741, "body": "so the next question is why its <code>*arr[1][8432]</code>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1473207317, "post_id": 39359469, "comment_id": 66048783, "body": "@pm100: No idea without seeing some context. It&#39;s an array 1 of array 8432 of <code>void*</code> pointers. The first 3 are initialized; presumably the rest have values assigned to them later. I don&#39;t know why it&#39;s a 2-d array rather than a 1-d array (maybe some pseudo-pass-by-reference hackery). But the OP didn&#39;t ask about it, so ..."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 4, "creation_date": 1473253371, "post_id": 39359469, "comment_id": 66069354, "body": "In case you&#39;re wondering, the extension uses <code>&amp;&amp;label</code> instead of the more natural <code>&amp;label</code> because you can have both a label and a variable with the same name in the same function."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 62, "last_activity_date": 1473272375, "last_edit_date": 1473272375, "creation_date": 1473206586, "answer_id": 39359469, "question_id": 39357887, "link": "https://stackoverflow.com/questions/39357887/what-does-a-operator-do-when-there-is-no-left-side-in-c/39359469#39359469", "title": "What does a &amp;&amp; operator do when there is no left side in C?", "body": "<p>It's a gcc-specific extension, a unary <code>&amp;&amp;</code> operator that can be applied to a label name, yielding its address as a <code>void*</code> value.</p>\n\n<p>As part of the extension, <code>goto *ptr;</code> is allowed where <code>ptr</code> is an expression of type <code>void*</code>.</p>\n\n<p>It's documented <a href=\"https://gcc.gnu.org/onlinedocs/gcc-6.2.0/gcc/Labels-as-Values.html\">here</a> in the gcc manual.</p>\n\n<blockquote>\n  <p>You can get the address of a label defined in the current function (or\n  a containing function) with the unary operator <code>&amp;&amp;</code>. The value has\n  type <code>void *</code>. This value is a constant and can be used wherever a\n  constant of that type is valid. For example:</p>\n\n<pre><code>void *ptr;\n/* ... */\nptr = &amp;&amp;foo;\n</code></pre>\n  \n  <p>To use these values, you need to be able to jump to one. This is done\n  with the computed goto statement, <code>goto *exp;</code>. For example,</p>\n\n<pre><code>goto *ptr;\n</code></pre>\n  \n  <p>Any expression of type <code>void *</code> is allowed.</p>\n</blockquote>\n\n<p>As zwol points out in a comment, gcc uses <code>&amp;&amp;</code> rather than the more obvious <code>&amp;</code> because a label and an object with the same name can be visible simultaneously, making <code>&amp;foo</code> potentially ambiguous if <code>&amp;</code> means \"address of label\". Label names occupy their own namespace (not in the C++ sense), and can appear only in specific contexts: defined by a <em>labeled-statement</em>, as the target of a <code>goto</code> statement, or, for gcc, as the operand of unary <code>&amp;&amp;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1473207073, "post_id": 39359472, "comment_id": 66048728, "body": "The example in the gcc docs uses <code>int</code> as the type for the result of subtraction - not sure what happens if the difference exceeds the range of <code>int</code>. Perhaps that is actually not possible due to the requirement for both to be in the same function, but maybe <code>ptrdiff_t</code> would be better."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1473254368, "post_id": 39359472, "comment_id": 66070082, "body": "The proper type is in fact <code>ptrdiff_t</code>; this is just an error in the manual (probably dates to the days when <code>ptrdiff_t</code> and <code>int</code> were almost always the same type).  You can see this for yourself by compiling <code>void test(void) { a:; b:; __typeof (&amp;&amp;a - &amp;&amp;b) d; ptrdiff_t *pd = &amp;d; int *qd = &amp;d; }</code> on an ABI where they are not the same type."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 17, "last_activity_date": 1473280203, "last_edit_date": 1473280203, "creation_date": 1473206625, "answer_id": 39359472, "question_id": 39357887, "link": "https://stackoverflow.com/questions/39357887/what-does-a-operator-do-when-there-is-no-left-side-in-c/39359472#39359472", "title": "What does a &amp;&amp; operator do when there is no left side in C?", "body": "<p>This is a gcc extension, known as \"Labels as Values\". <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html\">Link to gcc documentation</a>.</p>\n\n<p>In this extension, <code>&amp;&amp;</code> is a unary operator that can be applied to a <em>label</em>. The result is a value of type <code>void *</code>.  This value may later be dereferenced in a <code>goto</code> statement to cause execution to jump to that label.  Also, pointer arithmetic is permitted on this value.</p>\n\n<p>The label must be in the same function; or in an enclosing function in case the code is also using the gcc extension of \"nested functions\".</p>\n\n<p>Here is a sample program where the feature is used to implement a state machine:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n    void *tab[] = { &amp;&amp;foo, &amp;&amp;bar, &amp;&amp;qux };\n\n    // Alternative method\n    //ptrdiff_t otab[] = { &amp;&amp;foo - &amp;&amp;foo, &amp;&amp;bar - &amp;&amp;foo, &amp;&amp;qux - &amp;&amp;foo };\n\n    int i, state = 0;\n\n    srand(time(NULL));\n\n    for (i = 0; i &lt; 10; ++i)\n    {\n        goto *tab[state];\n\n        //goto *(&amp;&amp;foo + otab[state]);\n\n    foo:\n        printf(\"Foo\\n\");\n        state = 2;\n        continue;\n    bar:\n        printf(\"Bar\\n\");\n        state = 0;\n        continue;\n    qux:\n        printf(\"Qux\\n\");\n        state = rand() % 3;\n        continue;\n    }\n}\n</code></pre>\n\n<p>Compiling and execution:</p>\n\n<pre><code>$ gcc -o x x.c &amp;&amp; ./x\nFoo\nQux\nFoo\nQux\nBar\nFoo\nQux\nQux\nBar\nFoo\n</code></pre>\n"}], "owner": {"reputation": 547, "user_id": 5458252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3f86a1748abac608b13c2e08ae18be?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/5458252/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3501, "favorite_count": 6, "accepted_answer_id": 39359469, "answer_count": 3, "score": 50, "last_activity_date": 1473280203, "creation_date": 1473196182, "last_edit_date": 1473209703, "question_id": 39357887, "link": "https://stackoverflow.com/questions/39357887/what-does-a-operator-do-when-there-is-no-left-side-in-c", "title": "What does a &amp;&amp; operator do when there is no left side in C?", "body": "<p>I saw a program in C that had code like the following:</p>\n\n<pre><code>static void *arr[1]  = {&amp;&amp; varOne,&amp;&amp; varTwo,&amp;&amp; varThree};\n\nvarOne: printf(\"One\") ;\nvarTwo: printf(\"Two\") ;\nvarThree: printf(\"Three\") ;\n</code></pre>\n\n<p>I am confused about what the <code>&amp;&amp;</code> does because there is nothing to the left of it. Does it evaluate as null by default? Or is this a special case?</p>\n\n<p>Edit: \nAdded some more information to make the question/code more clear for my question.\nThank you all for the help. This was a case of the gcc specific extension.</p>\n"}, {"tags": ["c", "arrays", "string", "split"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1473196334, "post_id": 39357861, "comment_id": 66045719, "body": "<code>malloc(strlen(token))</code> --&gt; <code>malloc(strlen(token)+1)</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1473196685, "post_id": 39357861, "comment_id": 66045868, "body": "in order to find where it fails, a) run under a debugger, b) use valgrind (If using linux)"}, {"owner": {"reputation": 1258, "user_id": 3680301, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2cb1423ce8e33f52dc8f01ae174f44da?s=128&d=identicon&r=PG&f=1", "display_name": "Parthian Shot", "link": "https://stackoverflow.com/users/3680301/parthian-shot"}, "edited": false, "score": 0, "creation_date": 1473197098, "post_id": 39357861, "comment_id": 66046029, "body": "c) just add print statements like a sane person"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 6801959, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dc28fa49ec84fcd8b88396feef24ce7?s=128&d=identicon&r=PG&f=1", "display_name": "LuftWoofe", "link": "https://stackoverflow.com/users/6801959/luftwoofe"}, "edited": false, "score": 0, "creation_date": 1473231602, "post_id": 39357941, "comment_id": 66055365, "body": "Pass a pointer to  a modifiable memory location? Could you give an example? I thought char* s (parameter) is already a pointer"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 95, "user_id": 6801959, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dc28fa49ec84fcd8b88396feef24ce7?s=128&d=identicon&r=PG&f=1", "display_name": "LuftWoofe", "link": "https://stackoverflow.com/users/6801959/luftwoofe"}, "edited": false, "score": 0, "creation_date": 1473231653, "post_id": 39357941, "comment_id": 66055392, "body": "For example: passing an array. <code>char arr[] = &quot;Hello world&quot;; split(arr);</code>"}, {"owner": {"reputation": 95, "user_id": 6801959, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dc28fa49ec84fcd8b88396feef24ce7?s=128&d=identicon&r=PG&f=1", "display_name": "LuftWoofe", "link": "https://stackoverflow.com/users/6801959/luftwoofe"}, "edited": false, "score": 0, "creation_date": 1473231980, "post_id": 39357941, "comment_id": 66055565, "body": "Ohhhh I see. I&#39;ll experiment with this then report back how it goes!"}, {"owner": {"reputation": 95, "user_id": 6801959, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dc28fa49ec84fcd8b88396feef24ce7?s=128&d=identicon&r=PG&f=1", "display_name": "LuftWoofe", "link": "https://stackoverflow.com/users/6801959/luftwoofe"}, "edited": false, "score": 0, "creation_date": 1473232609, "post_id": 39357941, "comment_id": 66055913, "body": "Man, thank you so much for the help! I was able to fix the problem by passing an array to the split function. Couple of questions: when you wrote &quot;string literal&quot; does that mean that I aren&#39;t able to write &quot;split(&quot;hello world)&quot; but instead I need to make an variable which stores the string in and then send the variable into the split() function?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 95, "user_id": 6801959, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dc28fa49ec84fcd8b88396feef24ce7?s=128&d=identicon&r=PG&f=1", "display_name": "LuftWoofe", "link": "https://stackoverflow.com/users/6801959/luftwoofe"}, "edited": false, "score": 0, "creation_date": 1473232812, "post_id": 39357941, "comment_id": 66056017, "body": "<code>char arr[] = &quot;Hello world&quot;;</code> <i>copies</i> it. But if you had <code>char *p = &quot;hello world&quot;; split(arr);</code> you&#39;ll have exactly the same problem. So, it&#39;s not passing a variable that makes the difference but <i>what</i> you pass."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1505363199, "last_edit_date": 1505363199, "creation_date": 1473196436, "answer_id": 39357941, "question_id": 39357861, "link": "https://stackoverflow.com/questions/39357861/splitting-a-string-into-an-array-of-words-in-c/39357941#39357941", "title": "Splitting a string into an array of words in C", "body": "<blockquote>\n  <p>if I send in \"Hello world\" then I'd get an array with two places where\n  the 1st place has the element \"Hello\", second \"world\".</p>\n</blockquote>\n\n<p>No. You can't pass a string literal to that function. Because <code>strtok()</code> modifies its input. So, it'll attempt to modify string literal, resulting in <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behaviour</em></a>.</p>\n\n<p>Be aware of the limitations of <code>strtok()</code>. From the man page of <code>strtok()</code>:</p>\n\n<blockquote>\n<pre><code>   Be cautious when using these functions.  If you do use them, note\n   that:\n\n   * These functions modify their first argument.\n\n   * These functions cannot be used on constant strings.\n\n   * The identity of the delimiting byte is lost.\n\n   * The strtok() function uses a static buffer while parsing, so it's\n     not thread safe.  Use strtok_r() if this matters to you.\n</code></pre>\n</blockquote>\n\n<p>So, you need to pass a pointer to a modifiable memory location if you want to use <code>strtok()</code>.</p>\n\n<hr>\n\n<p>As BLUPIXY pointed out, your <code>malloc()</code> call doesn't allocate sufficient space. You need one more byte than the string length (for the terminating nul byte).</p>\n"}], "owner": {"reputation": 95, "user_id": 6801959, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dc28fa49ec84fcd8b88396feef24ce7?s=128&d=identicon&r=PG&f=1", "display_name": "LuftWoofe", "link": "https://stackoverflow.com/users/6801959/luftwoofe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 39357941, "answer_count": 1, "score": 1, "last_activity_date": 1505363199, "creation_date": 1473196066, "last_edit_date": 1473196224, "question_id": 39357861, "link": "https://stackoverflow.com/questions/39357861/splitting-a-string-into-an-array-of-words-in-c", "title": "Splitting a string into an array of words in C", "body": "<p>I'm trying to make a function that splits a cstring into an array of words. Eg. if I send in \"Hello world\" then I'd get an array with two places where the 1st place has the element \"Hello\", second \"world\". I'm getting segmentation fault and I can't for the life of me figure out what seems to be wrong. </p>\n\n<ul>\n<li><p>In the for-loop I am checking how many spaces there are, which determines how many words there are in total (spacing is always N-1, N = number of words). Then I tell the program to add 1 to the counter (Because of N-1). </p></li>\n<li><p>I declare a char* array[] in order to keep each of the individual words seperated, not sure if I need counter+1 here (because of the \\0?)</p></li>\n<li><p>This is where the tricky part comes in. I use strtok to seperate each words (using \" \"). I then malloc each position of char*array[] so that it has enough memory to store the words. This is done until there are no more words to put in.</p></li>\n</ul>\n\n<p>I would really appreciate it if someone could give me a hint of which part is causing the segmentation fault!</p>\n\n<pre><code>void split(char* s){\n\n    int counter = 0;\n    int pos = 0;\n\n    for(int i=0; s[i]!='\\0'; i++){\n        if(s[i] == ' '){\n            counter ++;\n        }\n    }\n    counter += 1;\n\n    char* array[counter+1];\n\n    char *token = strtok(s, \" \");\n\n    while(token != NULL){\n        array[pos] = malloc(strlen(token));\n        strcpy(array[pos], token);\n        token = strtok(NULL, \" \");\n        pos++;\n    }\n</code></pre>\n"}, {"tags": ["c", "ssl", "openssl"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 4, "creation_date": 1473196043, "post_id": 39357788, "comment_id": 66045580, "body": "It&#39;s an opaque structure, the application doesn&#39;t need to know the contents."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473196101, "post_id": 39357788, "comment_id": 66045606, "body": "Whatever reason you think you have to know its contents: you don&#39;t. If you&#39;re curious or want to aid in the development: read the source code."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1473196144, "post_id": 39357788, "comment_id": 66045626, "body": "Just like you don&#39;t need to know the structure of <code>FILE</code> when you use <code>stdio</code>."}, {"owner": {"reputation": 121, "user_id": 5086000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/490465054440553/picture?type=large", "display_name": "Choi", "link": "https://stackoverflow.com/users/5086000/choi"}, "edited": false, "score": 0, "creation_date": 1473197096, "post_id": 39357788, "comment_id": 66046028, "body": "I am just curious for now and I cannot find its definition in the header files (<a href=\"https://github.com/openssl/openssl\" rel=\"nofollow noreferrer\">github.com/openssl/openssl</a>). I have checked openssl/include/openssl/ssl.h and a bunch of other files. Basically I want to know which structure holds the keys generated at the end of a handshake."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1473227156, "post_id": 39357788, "comment_id": 66053120, "body": "@Olaf - <i>&quot;Whatever reason you think you have to know its contents: you don&#39;t&quot;</i> - there&#39;s lots of reasons one may want to see the contents. I can think of a handful without trying, like logging and offline analysis of a session. Other reasons include studying and tracing the source to solve a problem because of missing documentation."}, {"owner": {"reputation": 121, "user_id": 5086000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/490465054440553/picture?type=large", "display_name": "Choi", "link": "https://stackoverflow.com/users/5086000/choi"}, "edited": false, "score": 0, "creation_date": 1473227386, "post_id": 39357788, "comment_id": 66053218, "body": "@steffen did point to the right answer and like I mentioned I did go through that file but I missed it. As of my understanding by going through the other files as well, there is no structure to hold the keys generated after the handshake (there is a structure for master secret but not for the read/write encryption and mac keys."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1473227536, "post_id": 39357788, "comment_id": 66053274, "body": "@Choi - Yes, Steffen is well versed in OpenSSL. Folks like SU know how OpenSSL typedef&#39;s structures and hides implementations. Regarding <i>&quot;keys generated after the handshake&quot;</i>... In the past, you wanted/needed access to either the premaster secret or the master secret. From there, you could get the 4 sessions keys (SSLv2) or 6 sessions keys (SSLv3 and above). Also see questions like <a href=\"http://stackoverflow.com/q/36240279\">How do I extract the pre-master secret using an OpenSSL-based client?</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1473243042, "post_id": 39357788, "comment_id": 66062215, "body": "@jww: I clearly covered valid reasons, e.g. work on the sources themselves. I don&#39;t see a problem with the opaque <code>struct</code> for users of this lib here. For debugging the lib, use the debug versions and should have all information available. Logging like any other application code should not rely on intternal data which can change anytime without notice."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473243155, "post_id": 39361284, "comment_id": 66062289, "body": "I somehow miss a clear warning not to use this <code>struct</code> in the user code. Typically there is a good reason to hide implementation details of a <code>struct</code> from the application code."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473243367, "post_id": 39361284, "comment_id": 66062408, "body": "@Olaf: first these are header files installed during the openssl installation, so the information are not that hidden from the application. Then I wrote: &quot;Note that location and content of the structure might differ in other versions of openssl.&quot;. Apart from that - depending on the version of OpenSSL several internals which are needed by code are only reachable by using undocumented functions or reaching into the internals. They&#39;ve changed a lot with 1.1.0 by both making internals less visible and publishing stable API&#39;s for things previously only offered by reaching into the internals."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473243601, "post_id": 39361284, "comment_id": 66062551, "body": "&quot;depending on the version of OpenSSL several internals which are needed by code are only reachable by using undocumented functions or reaching into the internals.&quot; - Ok, that&#39;s the only valid reason. It is a design-flaw in the lib, though and against common practice."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473243813, "post_id": 39361284, "comment_id": 66062689, "body": "@Olaf: of course, if there is an API suitable to solve the specific problem one should always use it instead of reaching into the internals. Otherwise code maintenance would be a nightmare."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 6, "last_activity_date": 1473222988, "creation_date": 1473222988, "answer_id": 39361284, "question_id": 39357788, "link": "https://stackoverflow.com/questions/39357788/members-of-ssl-structure/39361284#39361284", "title": "Members of SSL structure", "body": "<blockquote>\n  <p>I have been unable to find its structure type in the header files from the openssl library.</p>\n</blockquote>\n\n<p>It's unclear which version of openssl you are referring too and how did you look but a <code>grep -r ' SSL;' /usr/include/openssl/</code> quickly turned up a match in openssl/ossl_typ.h for openssl 1.0.2:</p>\n\n<pre><code>   typedef struct ssl_st SSL;\n</code></pre>\n\n<p>A following grep for 'ssl_st' lead to its definition in openssl/ssl.h:</p>\n\n<pre><code>#ifndef OPENSSL_NO_SSL_INTERN\n\nstruct ssl_st\n        {\n        /* protocol version\n         * (one of SSL2_VERSION, SSL3_VERSION, TLS1_VERSION, DTLS1_VERSION)\n         */\n        int version;\n        int type; /* SSL_ST_CONNECT or SSL_ST_ACCEPT */\n...\n</code></pre>\n\n<p>Note that location and content of the structure might differ in other versions of openssl.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12147287, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a1021e83b202b7acd51eb8f4e70c9401?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/12147287/ivan"}, "is_accepted": false, "score": 2, "last_activity_date": 1569918299, "creation_date": 1569918299, "answer_id": 58180799, "question_id": 39357788, "link": "https://stackoverflow.com/questions/39357788/members-of-ssl-structure/58180799#58180799", "title": "Members of SSL structure", "body": "<p>In openssl 1.1.1 <code>ssl_st</code> is defined in /ssl/ssl_local.h, line 1080.  </p>\n\n<p>For some reason this seems to be a hidden definition, even though some callback require this structure as an argument.</p>\n"}], "owner": {"reputation": 121, "user_id": 5086000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/490465054440553/picture?type=large", "display_name": "Choi", "link": "https://stackoverflow.com/users/5086000/choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3464, "favorite_count": 0, "accepted_answer_id": 39361284, "answer_count": 2, "score": 4, "last_activity_date": 1569918299, "creation_date": 1473195731, "last_edit_date": 1473227261, "question_id": 39357788, "link": "https://stackoverflow.com/questions/39357788/members-of-ssl-structure", "title": "Members of SSL structure", "body": "<p>In a OpenSSL's SSL/TLS client <a href=\"https://wiki.openssl.org/index.php/SSL/TLS_Client\" rel=\"nofollow\">implementation</a>, a structure <code>SSL</code> is defined. For example here is usually the first few lines (from the link). </p>\n\n<pre><code>SSL_CTX* ctx = NULL;\nBIO *web = NULL, *out = NULL;\nSSL *ssl = NULL;\n\ninit_openssl_library();\n</code></pre>\n\n<p>I have been unable to find its structure in the header files from the OpenSSL library. How can I learn the contents of <code>SSL * ssl</code>?</p>\n"}, {"tags": ["c", "shell", "command-line", "sublimetext3"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1473193372, "post_id": 39357207, "comment_id": 66044380, "body": "&lt;s&gt;C (as said in your question and tags) or C++ (as in the title)?&lt;/s&gt; Nevermind, probably not that important for your question."}, {"owner": {"reputation": 721, "user_id": 5666203, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fo0sw.jpg?s=128&g=1", "display_name": "AaronJPung", "link": "https://stackoverflow.com/users/5666203/aaronjpung"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1473193518, "post_id": 39357207, "comment_id": 66044455, "body": "I&#39;ll be honest, I&#39;m pretty new to C/C++ altogether -- I don&#39;t know the difference well enough to answer.  My background is in MATLAB and Python."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473193692, "post_id": 39357207, "comment_id": 66044517, "body": "Have no idea about Sublime Text, but I would try to change <code>&quot;shell&quot;: true</code> to <code>&quot;shell&quot;: false</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473193849, "post_id": 39357207, "comment_id": 66044591, "body": "Or, more likely, replace the <code>&#47;k</code> switch to <code>&#47;c</code>"}, {"owner": {"reputation": 721, "user_id": 5666203, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fo0sw.jpg?s=128&g=1", "display_name": "AaronJPung", "link": "https://stackoverflow.com/users/5666203/aaronjpung"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473193881, "post_id": 39357207, "comment_id": 66044604, "body": "@EugeneSh., I tried that -- for some reason, I get an error from other things, that I can post if necessary.  Changing <code>&#47;k</code> to <code>&#47;c</code> closes the command window, but my printed solution also closes w/ the command window. I would like to see the output of my program for sanity checking."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473194036, "post_id": 39357207, "comment_id": 66044675, "body": "So you have some conflicting requirements, don&#39;t you? You want the window to close, but don&#39;t want it to close."}, {"owner": {"reputation": 721, "user_id": 5666203, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fo0sw.jpg?s=128&g=1", "display_name": "AaronJPung", "link": "https://stackoverflow.com/users/5666203/aaronjpung"}, "edited": false, "score": 0, "creation_date": 1473194130, "post_id": 39357207, "comment_id": 66044717, "body": "I suppose that&#39;s true, but it seems like I should be able to have both -- like the solution being printed in the SublimeText compiler output window, that tells me the script completion time."}], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 5666203, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fo0sw.jpg?s=128&g=1", "display_name": "AaronJPung", "link": "https://stackoverflow.com/users/5666203/aaronjpung"}, "is_accepted": true, "score": 0, "last_activity_date": 1473263487, "creation_date": 1473263487, "answer_id": 39374393, "question_id": 39357207, "link": "https://stackoverflow.com/questions/39357207/output-of-c-via-sublime-text-closing-the-command-console/39374393#39374393", "title": "Output of C via Sublime Text / closing the command console", "body": "<p>This problem was eventually solved -- the output, and the time elapsed for the script is shown in the bottom of the Sublime Text window as illustrated. The steps I took before it was solved were as follows:</p>\n\n<ul>\n<li>Use MinGW to install all C and C++ compiling packages.</li>\n<li>Using Sublime Text 3's \"C++ Single File\" build system. </li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/m0fS2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m0fS2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 721, "user_id": 5666203, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fo0sw.jpg?s=128&g=1", "display_name": "AaronJPung", "link": "https://stackoverflow.com/users/5666203/aaronjpung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 39374393, "answer_count": 1, "score": 0, "last_activity_date": 1473263487, "creation_date": 1473193255, "last_edit_date": 1473193482, "question_id": 39357207, "link": "https://stackoverflow.com/questions/39357207/output-of-c-via-sublime-text-closing-the-command-console", "title": "Output of C via Sublime Text / closing the command console", "body": "<p>I'm new to compiling/running C scripts via Sublime Text 3, and I have a question on the output. My build in C is currently:</p>\n\n<pre><code>{\n\"cmd\": [\"gcc\", \"-Wall\", \"-ansi\", \"-pedantic-errors\", \"$file_name\", \"-o\",     \"${file_base_name}.exe\", \"&amp;&amp;\", \"start\", \"cmd\", \"/k\" , \"$file_base_name\"],\n\"selector\": \"source.c\",\n\"working_dir\": \"${file_path}\",\n\"shell\": true\n}\n</code></pre>\n\n<p>This works great, but it opens a new Windows cmd console everytime I run a script. Two questions:</p>\n\n<p>1 - I am used to editing Python in Sublime Text, and running a script via the command line as: <code>python prognam.py</code>. How can I do this with C? I have the MinGW path set in my PATH environment variables, so I'd think it would be similar.</p>\n\n<p>2 - Is it possible to edit my build script such that a new command console does not pop up every time?</p>\n"}, {"tags": ["c", "sockets", "ssl", "openssl"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 5, "creation_date": 1473193737, "post_id": 39356888, "comment_id": 66044543, "body": "The SSL API sits on top of the BIO API. By default, the SSL API uses a socket BIO to handle all socket I/O for you, requiring you to re-write your existing code logic, ie to use <code>SSL_recv()</code>/<code>SSL_write()</code> instead of <code>recv()</code>/<code>send()</code>. If you want to do your own I/O, you can create a couple of memory BIO pairs and link them to an SSL session with <code>SSL_set_bio()</code>. This way, any raw data you receive can be pushed into one BIO pair and <code>SSL_recv()</code> will decrypt what it reads from it, and <code>SSL_write()</code> will push encrypted data into the other BIO pair and you can then send whatever you read from it."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473194214, "post_id": 39356888, "comment_id": 66044751, "body": "So, if I only want to send/receive through the socket, I don&#39;t need to use the BIO functions? SSL functions will suffice?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1473194245, "post_id": 39356888, "comment_id": 66044773, "body": "In other words, if you use the BIO API in conjunction with the SSL API,  you can preserve your existing socket I/O logic with the I/O API of your choice, while still adding SSL encryption/decryption on top of it.  Otherwise, you have to re-write your socket logic to split encrypted and non-encrypted socket handing using separate I/O APIs, and that is not always desirable (especially when it comes to reading and error handling (especially because OpenSSL tends to work opposite to how socket developers are traditionally taught to manage socket I/O)."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473194333, "post_id": 39356888, "comment_id": 66044815, "body": "You don&#39;t NEED to use the BIO API directly at all, but it is <i>preferred</i> when applicable.  It really depends on your existing socket codebase and how much effort you want to put into rewriting it to make it SSL-enabled."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1473194439, "post_id": 39356888, "comment_id": 66044861, "body": "As I understand it, you think it is easier to keep my socket code unchanged and add another layer on top of it using BIOs to encrypt/decrypt data. Is that what you mean?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 4, "creation_date": 1473196117, "post_id": 39356888, "comment_id": 66045614, "body": "I said that is up to you to decide based on your codebase and level of effort desired. You can go either way. The SSL API by itself is a bit simpler to use, but does have some different semantics than traditional socket APIs (for example, in non-blocking mode, don&#39;t call <code>select()</code>/<code>poll()</code> until OpenSSL asks you to first, whereas in traditional APIs you would call <code>recv()</code>/<code>send()</code> when <code>select()</code>/<code>poll()</code> tells you its OK). On the other hand, the BIO API is a bit more work to use, but it offers more flexibility in how you handle I/O operations."}], "owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2587, "favorite_count": 1, "answer_count": 0, "score": 9, "last_activity_date": 1473191869, "creation_date": 1473191869, "last_edit_date": 1495542712, "question_id": 39356888, "link": "https://stackoverflow.com/questions/39356888/confusion-between-using-bio-and-ssl-functions-on-openssl", "title": "Confusion between using BIO and SSL functions on OpenSSL", "body": "<p>I have to secure an existing socket client connection using OpenSSL to replace <code>connect</code>, <code>send</code>, <code>receive</code>, <code>close</code> functions.<br>\nBut I'm not really comfortable with the use of the <strong>SSL</strong> and <strong>BIO</strong> functions.<br>\nI know there have been some questioning about it <a href=\"https://stackoverflow.com/questions/38516584/what-is-the-difference-between-bio-read-bio-write-and-ssl-read-ssl-write-when-th\">here</a> and <a href=\"https://stackoverflow.com/questions/28319112/ssl-vs-bio-object-in-openssl\">here</a>, but it is still not clear to me the exact difference between them.\nCan anyone help me understand the exact relation between them (1)?</p>\n\n<p>OpenSSL <a href=\"https://www.openssl.org/docs/manmaster/ssl/SSL_do_handshake.html\" rel=\"noreferrer\">documentation</a> always refer to <strong>BIO</strong> as an underlying structure, but there is no further explanation on the subject.\nAs I understand it, any call to <code>SSL_write</code> will also write to a <strong>BIO</strong>, that can be handled or not.<br>\nIs there any difference in doing a <code>BIO_write</code> or a <code>SSL_write</code> to send data to the socket (2)?<br>\nIf no, what is the advantage of using the <strong>BIO</strong> functions in my case (3)? Is there any (4)?</p>\n\n<p>I have found some useful examples on SSL clients <a href=\"https://github.com/iSECPartners/ssl-conservatory/tree/master/openssl\" rel=\"noreferrer\">here</a> and <a href=\"http://simplestcodings.blogspot.com.br/2010/08/secure-server-client-using-openssl-in-c.html\" rel=\"noreferrer\">here</a>.\nThe first one mix up the use of <strong>BIO</strong> and <strong>SSL</strong> functions like using <code>SSL_do_handshake</code> instead of <code>BIO_do_handshake</code>. Is that ok (5)?</p>\n\n<p>Since <strong>BIO</strong> is underlying to <strong>SSL</strong> functions, should I avoid using it (6)?</p>\n"}, {"tags": ["c", "arrays", "string", "sorting", "lexicographic"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1473191368, "post_id": 39356623, "comment_id": 66043462, "body": "In your <a href=\"http://stackoverflow.com/questions/39355208/sort-the-words-of-a-string-a-lexicographical-order-dictionary-order-in-c?noredirect=1#comment66042921_39355208\">previous question</a> you were advised that <code>gets</code> is obsolete, and that hard-coded sizes are difficult to maintain, and about safeguards with string lengths."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1473191563, "post_id": 39356623, "comment_id": 66043551, "body": "Your loop to count words is not right. First, it counts only spaces while you&#39;re using other delimiter characters for <code>strtok</code>. Second, you do that loop AFTER the first call to <code>strtok</code>, which terminates the string after the first word. So you only ever get <code>count</code> set to 1. Why not just count words in the <code>strtok</code> loop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473191618, "post_id": 39356623, "comment_id": 66043591, "body": "You should not be working with <code>char s[200];</code> once you have passed it to <code>strtok</code>. From that point, you work with the token pointer <code>pch</code>, because <code>strtok</code> breaks the original string."}, {"owner": {"reputation": 41, "user_id": 6598073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18fe3bcbcffba9c24336d1435a590c0d?s=128&d=identicon&r=PG&f=1", "display_name": "Tabassum Ahmed", "link": "https://stackoverflow.com/users/6598073/tabassum-ahmed"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1473192074, "post_id": 39356623, "comment_id": 66043780, "body": "@FredLarson Thanks a ton, <code>strtok</code> breaks the string at the first instance only, so was there wasthe problem. :)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473192282, "post_id": 39356623, "comment_id": 66043883, "body": "@TabassumAhmed <code>strtok</code> inserts <code>nul</code> terminators all the way along the string it was given, at the next match with the delimitor set. The pointer returned, is to the start of the &quot;token&quot; which it has <code>nul</code>-terminated, so you can process it as a string itself."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1473192485, "post_id": 39356623, "comment_id": 66043974, "body": "Honestly, if your strings are broken up in that line anyway, there is no need for a <code>char a[25][25]</code>. Just store the pointers returned from <code>strtok</code> into a <code>char *a[25]</code> array of pointers. It also makes swapping array elements (which are simple pointers into the line buffer) <i>trivial</i>, as no <code>strcpy</code> is required."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473192748, "post_id": 39356623, "comment_id": 66044106, "body": "... and much more efficient when sorting."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1473197352, "post_id": 39356623, "comment_id": 66046122, "body": "NB: See <a href=\"http://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why <code>gets()</code> is too dangerous to be used \u2014 ever!</a>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1473314674, "post_id": 39356623, "comment_id": 66094337, "body": "@TabassumAhmed, I&#39;m afraid that <code>strtok(3)</code> breaks the string at all instances, and assuming what is the string contents after it has passed scanning on the original string is undefined behaviour (implementation dependant).  Don&#39;t assume anything about the string contents after <code>strtok(3)</code> has passed over it."}], "answers": [{"tags": [], "owner": {"reputation": 1119, "user_id": 6797534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tu8Gt9iJGt8/AAAAAAAAAAI/AAAAAAAAAI0/Diz261BzMYk/photo.jpg?sz=128", "display_name": "Ray Hamel", "link": "https://stackoverflow.com/users/6797534/ray-hamel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473195938, "creation_date": 1473195938, "answer_id": 39357833, "question_id": 39356623, "link": "https://stackoverflow.com/questions/39356623/sorting-string-lexicographically-in-c/39357833#39357833", "title": "Sorting string lexicographically in c", "body": "<p>Use <code>qsort()</code> for this sort of thing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define BUF_SIZE 0x100\n\nint strcmp_wrapper(const void *a, const void *b) {\n        return strcmp(*(const char **)a, *(const char **)b);\n}\n\nint main () {\n        char buffer[BUF_SIZE], *tokens[BUF_SIZE / 2 + 1];\n        int i = 0, j = 0;\n\n        printf(\"Enter a string: \");\n        fgets(buffer, BUF_SIZE, stdin);\n\n        tokens[0] = strtok(buffer, \" ,.-\\n\");\n        while ((tokens[++i] = strtok(NULL, \" ,.-\\n\")));\n\n        qsort(tokens, i, sizeof(tokens[0]), strcmp_wrapper);\n\n        while (j &lt; i)\n                printf(\"%s\\n\", tokens[j++]);\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 657, "user_id": 6732642, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e1f2f507154f6956f86e3881cc92560?s=128&d=identicon&r=PG", "display_name": "JJTO", "link": "https://stackoverflow.com/users/6732642/jjto"}, "is_accepted": true, "score": 0, "last_activity_date": 1473196829, "creation_date": 1473196829, "answer_id": 39358020, "question_id": 39356623, "link": "https://stackoverflow.com/questions/39356623/sorting-string-lexicographically-in-c/39358020#39358020", "title": "Sorting string lexicographically in c", "body": "<p>If you try to print your string after you pch = strtok (s,\" ,.-\"), you'll notice that your string is broken up. That's because strtok() is destructive and breaks up the string into tokens so you need to count the number of white spaces before calling strtok():</p>\n\n<pre><code>printf(\"enter the string\\n\");\n    gets(s);\n\n    for (i = 0;s[i] != '\\0';i++)\n    {\n        if (s[i] == ' ')\n            count++;    \n    }\n    count=count+1;\n    i=0;\n    pch = strtok (s,\" ,.-\");\n</code></pre>\n\n<p>Also like Weather Vane said, don't use gets(), use fgets() instead oand remove the '\\n' from end of the string afterwards. Also you can use realloc() to assign more memory to a dynamic array instead of using a static array since you wouldn't know the number of words in a string beforehand. </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nvoid main()\n{\n    char** a = NULL;\n    char t[25];\n    char s[512];\n    char * pch;\n    int count = 0;\n    int i,j ,n;\n\n    printf(\"enter the string\\n\");\n  if(fgets(s,512, stdin)==NULL)\n  {\n    printf(\"failed to read string\\n\");\n    exit(-1);\n  }\n  /*remove '\\n' from end of the string*/\n  char *pos;\n  if ((pos=strchr(s, '\\n')) != NULL)\n    *pos = '\\0';\n\n  pch = strtok(s, \" ,.-\");\n  while(pch)\n  {\n    a = realloc(a, sizeof(char*)*++count);\n    if(a==NULL)\n    { \n      perror(\"failed to allocate memory\\n\");\n      exit(-1);\n    }\n\n    a[count-1] = pch;\n    pch = strtok(NULL, \" ,.-\");\n  }\n   for(i=0;i&lt;count;i++)\n    printf(\"%d: %s\\n\", i, a[i]);\n    ///...compare array\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1473314465, "creation_date": 1473314465, "answer_id": 39383517, "question_id": 39356623, "link": "https://stackoverflow.com/questions/39356623/sorting-string-lexicographically-in-c/39383517#39383517", "title": "Sorting string lexicographically in c", "body": "<p>below is a compact working way of doing what you want.  It prints the words of each line, sorted and separated by one space, without repeating words being repeated (if you want them repeated for sure you will be able to touch the program to make it work)</p>\n\n<pre><code>$ cat pru799.c\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define DELIMITERS  \" \\t\\n,.-()&amp;%$\\\"\\'[]{}+-*/;:@#|!\\\\&lt;&gt;=?\"\n#define LINE_SIZE   1024\n#define MAX_WORDS   256\n\nint compare(const char **p, const char **q)\n{\n    return strcmp(*p, *q);\n}\n\nint main()\n{\n    char line[LINE_SIZE];\n    char *words[MAX_WORDS];\n    int n_words;\n\n    while (fgets(line, sizeof line, stdin)) { /* while not eof */\n        char *p;\n        int i;\n\n        /* first get the words */\n        n_words = 0;\n        for (p = strtok(line, DELIMITERS); p; p = strtok(NULL, DELIMITERS)) {\n            if (strlen(p) == 0) continue; /* word is zero length */\n            if (n_words &gt;= MAX_WORDS) {\n                fprintf(stderr, \"MAX_WORDS(%d) exceeded\\n\", MAX_WORDS);\n                exit(EXIT_FAILURE);\n            }\n            words[n_words++] = p;\n        } /* for */\n\n        /* now we have all the words in the array of strings words, sort it */\n        qsort(words, n_words, sizeof words[0], (int(*)(const void *, const void *))&amp;compare);\n\n        /* now print the words */\n        for (i = 0; i &lt; n_words; i++) {\n            if (i) { /* all but the first one */\n                /* don't repeat words */\n                if (!strcmp(words[i], words[i-1])) \n                    continue;\n                printf(\" \"); /* print a space between words */\n            }\n            printf(\"%s\", words[i]);\n        }\n        printf(\"\\n\");\n    } /* while */\n} /* main */\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6598073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18fe3bcbcffba9c24336d1435a590c0d?s=128&d=identicon&r=PG&f=1", "display_name": "Tabassum Ahmed", "link": "https://stackoverflow.com/users/6598073/tabassum-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2472, "favorite_count": 1, "accepted_answer_id": 39358020, "answer_count": 3, "score": 1, "last_activity_date": 1473314465, "creation_date": 1473190820, "question_id": 39356623, "link": "https://stackoverflow.com/questions/39356623/sorting-string-lexicographically-in-c", "title": "Sorting string lexicographically in c", "body": "<p>I want to sort words of a string in lexicographical order.</p>\n\n<p>For Example:</p>\n\n<p>I have a string: <code>I am Apple</code></p>\n\n<p>Output should be: <code>am Apple I</code></p>\n\n<p>Problem (output): </p>\n\n<pre><code>enter the string\n\nhello shamsh\n\nthe sorted array:\n\nhello\n</code></pre>\n\n<p>It's not sorting the string and whole string is not being shown in the output, can anyone help me out here. Thanks!</p>\n\n<p>Program code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nvoid main()\n{\n    char a[25][25],t[25];\n    char s[200];\n    char * pch;\n    int count = 0;\n    int i,j ,n;\n    printf(\"enter the string\\n\");\n    gets(s);\n    pch = strtok (s,\" ,.-\");\n    for (i = 0;s[i] != '\\0';i++)\n    {\n        if (s[i] == ' ')\n            count++;    \n    }\n    count=count+1;\n    i=0;\n    while(pch != NULL)\n    {\n        strcpy(a[i],pch);\n        pch = strtok (NULL, \" ,.-\");\n        i++;\n    }\n\n    for(i=0;i&lt;count-1;i++)\n    {\n        for(j=i+1;j&lt;count;j++)\n        {\n            if(strcmp(a[i],a[j])&gt;0)\n            {\n                strcpy(t,a[i]);\n                strcpy(a[i],a[j]);\n                strcpy(a[j],t);\n            }\n        }\n    }\nprintf(\"the sorted array:\\n\");\nfor(i=0;i&lt;count;i++)\nprintf(\"%s\\n\",a[i]);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20489, "user_id": 2026606, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Ksr3L.jpg?s=128&g=1", "display_name": "Tyler Roper", "link": "https://stackoverflow.com/users/2026606/tyler-roper"}, "edited": false, "score": 1, "creation_date": 1473188612, "post_id": 39356103, "comment_id": 66042202, "body": "Cast <code>winsA</code>, <code>winsB</code>, <code>lossA</code>, and <code>lossB</code> as <code>double</code> in the operation."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1473188653, "post_id": 39356103, "comment_id": 66042221, "body": "integer division A / B with A &lt; B gives zero."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1473188758, "post_id": 39356103, "comment_id": 66042277, "body": "Minus one for jumping straight into difficult code without attempting to understand simple code first."}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1473189201, "post_id": 39356103, "comment_id": 66042455, "body": "multiply int variable by 1.0. Example: percA = (double) (winsA *1.0 / (winsA + lossA));"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473191167, "post_id": 39356103, "comment_id": 66043362, "body": "To display percent, <code>double</code> not even needed.  <code>printf(&quot;%d%%\\n&quot;, winsA*100 &#47; (winsA + lossA);</code>  or use <code>(winsA*100 + (winsA + lossA)&#47;2)&#47;(winsA + lossA)</code> for a rounded answer."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1473188641, "creation_date": 1473188641, "answer_id": 39356133, "question_id": 39356103, "link": "https://stackoverflow.com/questions/39356103/why-would-my-variables-titled-perca-and-percb-be-coming-out-as-0-00-no-m/39356133#39356133", "title": "Why would my variables titled &quot;percA&quot; and &quot;percB&quot; be coming out as &quot;0.00..&quot; no matter what?", "body": "<p>You've got your cast in the wrong place.  You need to cast one of the operands of the division operator.  Otherwise, you'll be doing integer division instead of floating point division.</p>\n\n<pre><code>percA = (double)winsA / (winsA + lossA);\npercB = (double)winsB / (winsB + lossB);\n</code></pre>\n\n<p>You're getting zero for the result because you're dividing integers, and the denominator is larger than the numerator.  The integer part is 0 and the fractional part is truncated.</p>\n"}], "owner": {"reputation": 5, "user_id": 6801566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3e1eaffd638ba0cdf18a9b2c7f3545?s=128&d=identicon&r=PG&f=1", "display_name": "MLP M0rgan", "link": "https://stackoverflow.com/users/6801566/mlp-m0rgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1473229385, "answer_count": 1, "score": -3, "last_activity_date": 1473188641, "creation_date": 1473188524, "question_id": 39356103, "link": "https://stackoverflow.com/questions/39356103/why-would-my-variables-titled-perca-and-percb-be-coming-out-as-0-00-no-m", "closed_reason": "Not suitable for this site", "title": "Why would my variables titled &quot;percA&quot; and &quot;percB&quot; be coming out as &quot;0.00..&quot; no matter what?", "body": "<pre><code>int gamesTotal, winsA, lossA, winsB, lossB, magicNum, gamesLeft;\ndouble percA, percB, percToClinch;\n\npercA = (double) (winsA / (winsA + lossA));\npercB = (double) (winsB / (winsB + lossB));\n</code></pre>\n\n<p>(More lines of my program can be included if no problem is found here; only included lines relevant to the problem.)</p>\n"}, {"tags": ["c", "widget", "containers", "gtk3"], "answers": [{"comments": [{"owner": {"reputation": 1427, "user_id": 1599887, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31758de16279cc43ba0bf6094dc4260b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1599887/alex"}, "edited": false, "score": 0, "creation_date": 1473271006, "post_id": 39357674, "comment_id": 66080743, "body": "Thanks, the &quot;position&quot; property did the trick ... I will add some code to the question, since it is not trivial to use."}], "tags": [], "owner": {"reputation": 1487, "user_id": 4954108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/35e4ac731500b39e1284406a3e90b765?s=128&d=identicon&r=PG&f=1", "display_name": "rtpax", "link": "https://stackoverflow.com/users/4954108/rtpax"}, "is_accepted": false, "score": 1, "last_activity_date": 1473195228, "creation_date": 1473195228, "answer_id": 39357674, "question_id": 39355588, "link": "https://stackoverflow.com/questions/39355588/gtk3-how-to-get-the-index-of-a-widget-in-its-container/39357674#39357674", "title": "Gtk3 - How to get the index of a widget in it&#39;s container?", "body": "<p>Not a complete answer, but not enough rep to comment.</p>\n\n<p>Firstly, I'm just going to note that the gtkBox page references a \"position\" child property, though I will be honest I don't remember how to access properties like that.</p>\n\n<p>What I have done in a similar situation that worked is to create a gtkGrid instead of a gtkBox and use the gtk_grid_get_child_at() method to check each child starting from index of 0,0. You could use a for loop similar to this</p>\n\n<pre><code>for(int n=0;n&lt;numChildren;n++)\n{\n    gtkWidget* temp = gtk_grid_get_child_at(myGrid, n, 0);\n    if(temp == myWidget)\n        break;\n}\n//n now holds the index of myWidget in myGrid\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 6740258, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xxOMg.jpg?s=128&g=1", "display_name": "tagelicht", "link": "https://stackoverflow.com/users/6740258/tagelicht"}, "is_accepted": false, "score": 1, "last_activity_date": 1473196925, "creation_date": 1473196925, "answer_id": 39358044, "question_id": 39355588, "link": "https://stackoverflow.com/questions/39355588/gtk3-how-to-get-the-index-of-a-widget-in-its-container/39358044#39358044", "title": "Gtk3 - How to get the index of a widget in it&#39;s container?", "body": "<p>you can use <code>gtk_container_get_children()</code> (<a href=\"https://developer.gnome.org/gtk3/stable/GtkContainer.html#gtk-container-get-children\" rel=\"nofollow\">https://developer.gnome.org/gtk3/stable/GtkContainer.html#gtk-container-get-children</a>), which returns  <code>Glist*</code> (<a href=\"https://developer.gnome.org/glib/stable/glib-Doubly-Linked-Lists.html\" rel=\"nofollow\">https://developer.gnome.org/glib/stable/glib-Doubly-Linked-Lists.html</a>).\nThen, you can loop over the list, or, for, example, check if your widget is in the list with <code>g_list_find()</code></p>\n"}, {"comments": [{"owner": {"reputation": 1427, "user_id": 1599887, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31758de16279cc43ba0bf6094dc4260b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1599887/alex"}, "edited": false, "score": 0, "creation_date": 1473270893, "post_id": 39372491, "comment_id": 66080683, "body": "Thanks, that&#39;s what I was searching for! I&#39;ll add some code to the question, since the <code>child_get_property</code> is not trivial to use."}, {"owner": {"reputation": 23653, "user_id": 507721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/44a20d8ea4197f1fc5022894c053f174?s=128&d=identicon&r=PG", "display_name": "JellicleCat", "link": "https://stackoverflow.com/users/507721/jelliclecat"}, "edited": false, "score": 0, "creation_date": 1615590813, "post_id": 39372491, "comment_id": 117747956, "body": "Some containers (e.g. ListBox) don&#39;t have a &quot;position&quot; property. <a href=\"https://developer.gnome.org/gtk3/stable/GtkContainer.html#gtk-container-class-list-child-properties\" rel=\"nofollow noreferrer\">gtk_container_class_list_child_properties</a> will give you the properties available for a given container."}], "tags": [], "owner": {"reputation": 30485, "user_id": 1222951, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/s64JD.png?s=128&g=1", "display_name": "Aran-Fey", "link": "https://stackoverflow.com/users/1222951/aran-fey"}, "is_accepted": true, "score": 3, "last_activity_date": 1473258133, "creation_date": 1473258133, "answer_id": 39372491, "question_id": 39355588, "link": "https://stackoverflow.com/questions/39355588/gtk3-how-to-get-the-index-of-a-widget-in-its-container/39372491#39372491", "title": "Gtk3 - How to get the index of a widget in it&#39;s container?", "body": "<p>Container widgets save a bunch of \"child properties\" that you can query using <a href=\"https://developer.gnome.org/gtk3/unstable/GtkContainer.html#gtk-container-child-get-property\" rel=\"nofollow\">container.child_get_property</a>. The property you're looking for is called \"position\".</p>\n"}], "owner": {"reputation": 1427, "user_id": 1599887, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31758de16279cc43ba0bf6094dc4260b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1599887/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 1, "accepted_answer_id": 39372491, "answer_count": 3, "score": 4, "last_activity_date": 1473271244, "creation_date": 1473186447, "last_edit_date": 1473271244, "question_id": 39355588, "link": "https://stackoverflow.com/questions/39355588/gtk3-how-to-get-the-index-of-a-widget-in-its-container", "title": "Gtk3 - How to get the index of a widget in it&#39;s container?", "body": "<p>I have pointers to two different widgets which are located in the same container (a GtkBox). I want to use <code>gtk_box_reorder_child(container, widgetToMove, destinationIndex)</code> in order to change the container position of one of them to the index of the other:</p>\n\n<pre><code>GtkWidget *widgetToMove;\nGtkWidget *target;\n// Does something like 'gtk_get_container_index' exist ?\ngint targetIndex = gtk_get_container_index(target) \ngtk_box_reorder_child (myBox,widgetToMove,targetIndex);\n</code></pre>\n\n<p>... sounds stupid, however after 15 min of search I still dont know how to get the index of a widget in it's container.</p>\n\n<p><strong>Edit:  Solved, here the solution</strong></p>\n\n<pre><code>GtkWidget *widgetToMove;\nGtkWidget *target;\nGValue targetIndex = G_VALUE_INIT;\ng_value_init (&amp;targetIndex, G_TYPE_INT);\ngtk_container_child_get_property(myBox,target,\"position\",&amp;targetIndex);\ngtk_box_reorder_child (myBox,widgetToMove,g_value_get_int(&amp;targetIndex));\n</code></pre>\n"}, {"tags": ["c", "list", "file", "struct", "nodes"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1473185480, "post_id": 39355268, "comment_id": 66040560, "body": "You never populate <code>list-&gt;data</code>, so what exactly do you expect?"}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473185552, "post_id": 39355268, "comment_id": 66040587, "body": "@EugeneSh. populate?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1473185590, "post_id": 39355268, "comment_id": 66040606, "body": "Assign, set, initialize or whatever synonym you choose.."}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473185663, "post_id": 39355268, "comment_id": 66040644, "body": "@EugeneSh. i initialize it in the insert method"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473185699, "post_id": 39355268, "comment_id": 66040661, "body": "Show me the line..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1473185733, "post_id": 39355268, "comment_id": 66040679, "body": "That is true (line 14) <code>new_node-&gt;data = data;</code>, but when you print, you do not parse the linked list."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1473185751, "post_id": 39355268, "comment_id": 66040685, "body": "Don&#39;t cast the return value of malloc; don&#39;t disguise pointers behind typedef (at least not on the code that dereferences them)"}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473185775, "post_id": 39355268, "comment_id": 66040698, "body": "@EugeneSh. Line 12"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473185819, "post_id": 39355268, "comment_id": 66040726, "body": "I don&#39;t see any <code>list-&gt;data = ...</code> in neither line."}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473185874, "post_id": 39355268, "comment_id": 66040756, "body": "but new_node-&gt;data = data; ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473185921, "post_id": 39355268, "comment_id": 66040778, "body": "So? <code>new_node</code> is becoming the next one to the <code>list</code>. But you are trying to print <code>list</code>."}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473186007, "post_id": 39355268, "comment_id": 66040823, "body": "No I&#39;m trying to get the first node of the list and this is new_node"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473186053, "post_id": 39355268, "comment_id": 66040853, "body": "Then your code is not doing what you want. <code>new_node</code> is always the second one."}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473186084, "post_id": 39355268, "comment_id": 66040861, "body": "even with the second one it doesnt go"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473186178, "post_id": 39355268, "comment_id": 66040908, "body": "What &quot;doesn&#39;t go&quot;? If you want to ask a different question - ask it. The problem with this one is clear."}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473186289, "post_id": 39355268, "comment_id": 66040968, "body": "No it isn&#39;t? even if i want to get the data from the second node i don&#39;t get anything"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473186422, "post_id": 39355268, "comment_id": 66041029, "body": "How do you do that?"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473186556, "post_id": 39355580, "comment_id": 66041095, "body": "&quot;I am also pretty sure that your list is poor-implement because you will lose track of the first elements of the list&quot; - why? The pointer to the head is maintained."}, {"owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473186634, "post_id": 39355580, "comment_id": 66041142, "body": "@EugeneSh., you are right, I wrongly read the code, will update the answer."}, {"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473186639, "post_id": 39355580, "comment_id": 66041146, "body": "@Mikael Mello Thanks dude :D"}, {"owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "reply_to_user": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473186910, "post_id": 39355580, "comment_id": 66041264, "body": "@Emanuel, I would also recommend to have a different struct for the list and for the element of a list, it helps to understand how it all works. Here it is another &quot;more complete&quot; implementation, it is all in Portuguese but you can understand it by translating a few words. <a href=\"http://pastebin.com/bFZav1Bz\" rel=\"nofollow noreferrer\">pastebin.com/bFZav1Bz</a>"}], "tags": [], "owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "is_accepted": true, "score": 0, "last_activity_date": 1473186708, "last_edit_date": 1473186708, "creation_date": 1473186434, "answer_id": 39355580, "question_id": 39355268, "link": "https://stackoverflow.com/questions/39355268/c-list-data-doesnt-show-on-terminal/39355580#39355580", "title": "C list-&gt;data doesnt show on terminal", "body": "<p>You are allocating memory to a node called <em>list</em>, but yet you do not initialize any value for <strong>data</strong>, it can be garbage or any character that does not show up in the console.</p>\n\n<p>When you insert a new value, a new node is created and the first one, the \"head\" so to speak, is still uninitialized even though it is pointing to a second node that has a meaningful data there.</p>\n\n<p>This is your list:</p>\n\n<pre><code>// Node Y (X) indicates the Y-th node that has a X value.\n\nNode1 (garbage) -&gt; Node2 (value) -&gt; Node3 (value) -&gt; garbage\n</code></pre>\n\n<p>The last node of your list (which is also the first when you create it) should be pointing to NULL instead of being uninitialized.</p>\n\n<p>I am also pretty sure that your list is poor-implemented because the new elements are always being pointed by list, so you lose track of the ones you created before.</p>\n\n<p>Here is a better version, in my opinion:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct list_node{\n    char data;\n    struct list_node* next;\n};\n\ntypedef struct list_node* node;\n\nvoid insert_right(node list,char data)\n{\n    node new_node = (node) malloc(sizeof(struct list_node));\n\n    node temp = list;\n    // It runs through the list until it reaches the last node\n    while(temp-&gt;next != NULL) temp = temp-&gt;next;\n\n    temp-&gt;data = data; \n    temp-&gt;next = new_node;\n    new_node-&gt;next = NULL;\n}\n\nint main()\n{\n    FILE *fr = fopen(\"dat1.txt\",\"r\");\n\n    // List points to only the first element of the list.\n    node list = (node) malloc(sizeof(struct list_node));\n    list-&gt;next = NULL;\n    int i;\n\n    while((i = fgetc(fr)) != EOF){          \n            insert_right(list,i);                   \n    }\n    while(list != NULL) {\n      printf(\"%c\",list-&gt;data);\n      list = list-&gt;next;\n    }\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473186973, "post_id": 39355674, "comment_id": 66041310, "body": "i know that but i was too lazy so I wanted to output just one node"}, {"owner": {"reputation": 11, "user_id": 6780008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa72d56bb37306681be3a15aa0a2fc70?s=128&d=identicon&r=PG&f=1", "display_name": "Elidefoe", "link": "https://stackoverflow.com/users/6780008/elidefoe"}, "reply_to_user": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "edited": false, "score": 0, "creation_date": 1473188670, "post_id": 39355674, "comment_id": 66042232, "body": "No worries. This is the type of question you get in data structures class, CS1 or something along those lines. Keep at it."}], "tags": [], "owner": {"reputation": 11, "user_id": 6780008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa72d56bb37306681be3a15aa0a2fc70?s=128&d=identicon&r=PG&f=1", "display_name": "Elidefoe", "link": "https://stackoverflow.com/users/6780008/elidefoe"}, "is_accepted": false, "score": 1, "last_activity_date": 1473186817, "creation_date": 1473186817, "answer_id": 39355674, "question_id": 39355268, "link": "https://stackoverflow.com/questions/39355268/c-list-data-doesnt-show-on-terminal/39355674#39355674", "title": "C list-&gt;data doesnt show on terminal", "body": "<p>You are creating a linked list. Each node you create needs to point to either NULL or the next node. You were not quite making the links. Also you were not getting the new_node you you were returning. Also when printing out a list you have to go through each node (like an array). </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct list_node{\n    char data;\n    struct list_node* next;\n};\n\ntypedef struct list_node* node;\n\nnode insert_right(node list,char data)\n{\n    node new_node = (node) malloc(sizeof(struct list_node));\n    new_node-&gt;data = data;\n    list-&gt;next = new_node;\n    new_node-&gt;next = NULL;\n    return new_node;\n}\n\nint main()\n{\n    FILE *fr = fopen(\"dat1.txt\",\"r\");\n    node list = (node) malloc(sizeof(struct list_node));\n    int i;\n    node next = list;\n    while((i = fgetc(fr)) != EOF){           \n    next = insert_right(next,i);                   \n    }\n    node print = list;\n    while(print != NULL){\n         printf(\"%c\",print-&gt;data);\n         print = print-&gt;next;\n    }   \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1119, "user_id": 6797534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tu8Gt9iJGt8/AAAAAAAAAAI/AAAAAAAAAI0/Diz261BzMYk/photo.jpg?sz=128", "display_name": "Ray Hamel", "link": "https://stackoverflow.com/users/6797534/ray-hamel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473188517, "creation_date": 1473188517, "answer_id": 39356100, "question_id": 39355268, "link": "https://stackoverflow.com/questions/39355268/c-list-data-doesnt-show-on-terminal/39356100#39356100", "title": "C list-&gt;data doesnt show on terminal", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct list_node {\n        char data;\n        struct list_node* next;\n};\n\nint main()\n{\n        FILE *fr = fopen(\"dat1.txt\",\"r\");\n        struct list_node *list = malloc(sizeof(*list)), *pos = list;\n        int i;\n\n        while ((i = fgetc(fr)) != EOF) {\n                pos-&gt;data = i;\n                pos-&gt;next = malloc(sizeof(*list-&gt;next));\n                pos = pos-&gt;next;\n        }\n\n        pos-&gt;next = NULL;\n\n        while (list-&gt;next) {\n                printf(\"%c \", list-&gt;data);\n\n                free(list); /* important!!!! */\n\n                list = list-&gt;next;\n        }\n\n        putchar('\\n');\n\n        return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4669037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5a85b4ba166f80490f36da373210b1?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/4669037/emanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 39355580, "answer_count": 3, "score": 2, "last_activity_date": 1473188517, "creation_date": 1473185246, "question_id": 39355268, "link": "https://stackoverflow.com/questions/39355268/c-list-data-doesnt-show-on-terminal", "title": "C list-&gt;data doesnt show on terminal", "body": "<p>The console doesnt show the data from my list node.I filled it with chars that i took from a text File.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct list_node{\n    char data;\n    struct list_node* next;\n};\n\ntypedef struct list_node* node;\n\nnode insert_right(node list,char data)\n{\n    node new_node = (node) malloc(sizeof(struct list_node));\n    new_node-&gt;data = data;\n    new_node-&gt;next = list-&gt;next;\n    list-&gt;next = new_node;\n    return new_node;\n}\n\nint main()\n{\n    FILE *fr = fopen(\"dat1.txt\",\"r\");\n    node list = (node) malloc(sizeof(struct list_node));\n    int i;\n\n    while((i = fgetc(fr)) != EOF){          \n            insert_right(list,i);                   \n    }\n    printf(\"%c\",list-&gt;data);\n}\n</code></pre>\n\n<p>The main problem i think would be in the insert method.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 2, "creation_date": 1473184163, "post_id": 39354997, "comment_id": 66039972, "body": "How do you &quot;view the elements of <code>bar</code>&quot;?  Can you provide a <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> ?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 7, "creation_date": 1473184295, "post_id": 39354997, "comment_id": 66040040, "body": "Function arguments are passed by value, so you aren&#39;t modifying the original structure but a copy."}, {"owner": {"reputation": 811, "user_id": 2784165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kq3T2.jpg?s=128&g=1", "display_name": "Gar", "link": "https://stackoverflow.com/users/2784165/gar"}, "edited": false, "score": 0, "creation_date": 1473186480, "post_id": 39354997, "comment_id": 66041057, "body": "change your call by reference (&amp;) and modifiy a bit your function to use a pointer , and it should be ok"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6796338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db94cef5ff0de5f17284332d791fc17f?s=128&d=identicon&r=PG&f=1", "display_name": "L. Zeda", "link": "https://stackoverflow.com/users/6796338/l-zeda"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1473185640, "post_id": 39355252, "comment_id": 66040633, "body": "Yeah, my bad. Edit that post if you find something wrong, I can&#39;t check it on this PC and I am horrible with syntax :D."}], "tags": [], "owner": {"reputation": 113, "user_id": 6796338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db94cef5ff0de5f17284332d791fc17f?s=128&d=identicon&r=PG&f=1", "display_name": "L. Zeda", "link": "https://stackoverflow.com/users/6796338/l-zeda"}, "is_accepted": true, "score": 1, "last_activity_date": 1473185583, "last_edit_date": 1473185583, "creation_date": 1473185182, "answer_id": 39355252, "question_id": 39354997, "link": "https://stackoverflow.com/questions/39354997/add-element-to-array-member-of-a-struct/39355252#39355252", "title": "Add element to array member of a struct", "body": "<p>As interjay wrote, you are not modifying bar, but just a coppy (that is created separately in memory everytime when function myfun is called). Look up difference between functions called by value and functions called by reference. What you need is:</p>\n\n<pre><code>void myfun(foo *x, int new) \n{\n    x-&gt;elt.arr1[x-&gt;size] = new;\n    x-&gt;size += 1;\n    return;\n}\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>myfun(&amp;bar,4)\n</code></pre>\n\n<p>That way, variable bar will be edited.</p>\n"}], "owner": {"reputation": 121, "user_id": 4911890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fsC6Y.jpg?s=128&g=1", "display_name": "BobbyPi", "link": "https://stackoverflow.com/users/4911890/bobbypi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 39355252, "answer_count": 1, "score": 1, "last_activity_date": 1473185583, "creation_date": 1473183997, "last_edit_date": 1473184587, "question_id": 39354997, "link": "https://stackoverflow.com/questions/39354997/add-element-to-array-member-of-a-struct", "title": "Add element to array member of a struct", "body": "<p>I have an union:</p>\n\n<p><code>typedef union { int arr1[5]; char arr2[5]; } type</code> </p>\n\n<p>and a struct:</p>\n\n<p><code>typedef struct { int size; type elt; } foo</code> </p>\n\n<p>and finally a variable:</p>\n\n<p><code>foo bar = { 3, {1,2,3} }</code>.</p>\n\n<p>I want to add an element to bar. Therefore I defined:</p>\n\n<pre><code>void myfun(foo x, int new) \n{\n      x.elt.arr1[x.size] = new;\n      x.size += 1;\n      return;\n}\n</code></pre>\n\n<p>If I call <code>myfun(bar,4)</code> it should change bar appropriately. But if I view the elements of <code>bar</code> before and after the call of <code>myfun</code> it will print <code>bar</code> without the additional element. </p>\n\n<p>Edit: My view function is:</p>\n\n<pre><code>void myprint(foo x)\n{\n     for ( int i = 0; i &lt; x.size; i++) {\n           printf(\"%d \", x.elt.arr1[i]);\n      }\n      return;\n}\n</code></pre>\n\n<p>What's my fault?</p>\n"}, {"tags": ["c", "r", "dll"], "answers": [{"tags": [], "owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "is_accepted": true, "score": 1, "last_activity_date": 1473184497, "last_edit_date": 1592644375, "creation_date": 1473184497, "answer_id": 39355110, "question_id": 39354959, "link": "https://stackoverflow.com/questions/39354959/setting-a-directory-path-to-a-dynamically-linked-library-in-an-r-package/39355110#39355110", "title": "Setting a directory path to a dynamically linked library in an R package", "body": "<p>The standard way to do this, as described in <a href=\"https://cran.r-project.org/doc/manuals/r-release/R-exts.html#useDynLib\" rel=\"nofollow noreferrer\">Writing R Extensions</a>, is:</p>\n<blockquote>\n<p>1.5.4 useDynLib</p>\n<p>A <code>NAMESPACE</code> file can contain one or more <code>useDynLib</code> directives which allows shared objects that need to be loaded.* The directive</p>\n<p><code>useDynLib(foo)</code></p>\n<p>registers the shared object <code>foo</code>** for loading with <code>library.dynam</code>. Loading of registered object(s) occurs after the package code has been loaded and before running the load hook function. Packages that would only need a load hook function to load a shared object can use the <code>useDynLib</code> directive instead.</p>\n<p><code>*</code> NB: this will only be read in all versions of R if the package contains R code in a R directory.\n<code>**</code> Note that this is the basename of the shared object, and the appropriate extension (.so or .dll) will be added.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "is_accepted": false, "score": 1, "last_activity_date": 1473184508, "creation_date": 1473184508, "answer_id": 39355112, "question_id": 39354959, "link": "https://stackoverflow.com/questions/39354959/setting-a-directory-path-to-a-dynamically-linked-library-in-an-r-package/39355112#39355112", "title": "Setting a directory path to a dynamically linked library in an R package", "body": "<p>Quick points:</p>\n\n<ul>\n<li><p>Why do you need to ship a <code>.so</code> file?  This would preclude uploads to common repos like CRAN which will not accept binary content</p></li>\n<li><p>You can compute the full <code>/FULL/PATH/TO/MY/R_PACKAGE/src/my_file.so</code> by using <code>system.file(\"src\", \"my_file.so\", package=\"R_PACKAGE\")</code> (but then make sure you actually install a <code>src/</code> which is not standard)</p></li>\n<li><p>In <em>all other cases</em> (as pointed out by @BenBolker) R will know how to create the dynamic library and load it for you.  Every package with compiled code does that.  Just drop your source code into <code>src/</code> and you are (essentially) done.</p></li>\n</ul>\n"}], "owner": {"reputation": 2505, "user_id": 3878253, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ef826a39bea2cf9fe2883d45353367be?s=128&d=identicon&r=PG&f=1", "display_name": "warship", "link": "https://stackoverflow.com/users/3878253/warship"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 39355110, "answer_count": 2, "score": 2, "last_activity_date": 1473184508, "creation_date": 1473183872, "last_edit_date": 1495541303, "question_id": 39354959, "link": "https://stackoverflow.com/questions/39354959/setting-a-directory-path-to-a-dynamically-linked-library-in-an-r-package", "title": "Setting a directory path to a dynamically linked library in an R package", "body": "<p>What is the proper way to load in a dynamically linked library (i.e., a <code>.so</code> file) when writing an R package? The only solution that has worked for me so far has been to specify the full path to the <code>.so</code> file, e.g.:</p>\n\n<p><code>dyn.load('/FULL/PATH/TO/MY/R_PACKAGE/src/my_file.so')</code></p>\n\n<p>Obviously, this approach will not work for a CRAN/Bioconductor submission since the .so file will not be located. As such, I have (unsuccessfully) tried the following alternatives:</p>\n\n<p>1) <code>library.dynam()</code></p>\n\n<p>2) <code>library.dynam('my_file.so')</code></p>\n\n<p>3) <code>library.dynam('my_file.so', 'R_PACKAGE')</code></p>\n\n<p>4) <code>system.file(\"src\", \"my_file.so\", package = \"R_PACKAGE\")</code></p>\n\n<p>Related links: <a href=\"https://stackoverflow.com/questions/24853377/r-c-symbol-not-in-load-table\">R: C symbol not in load table</a>, <a href=\"https://stackoverflow.com/questions/29443730/r-c-symbol-name-not-in-load-table-error-in-linking-with-external-c-files\">R: C symbol name not in load table - error in linking with external .c files</a>.</p>\n\n<p>Just to be crystal clear, users of my R package may obviously set any arbitrary working directory on their computers. The only way a full path approach (as shown above) would ever work is if they set their working directory to <code>/FULL/PATH/TO/MY/R_PACKAGE/src</code>, which is (of course) impractical.</p>\n"}, {"tags": ["c", "redirect", "printf", "buffer", "stdout"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1473183947, "post_id": 39354868, "comment_id": 66039843, "body": "I cannot reproduce the error; I get the expected output."}, {"owner": {"reputation": 21, "user_id": 4504615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049ceb9191241d72eb084d71fa530570?s=128&d=identicon&r=PG&f=1", "display_name": "marcas756", "link": "https://stackoverflow.com/users/4504615/marcas756"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1473353722, "post_id": 39354868, "comment_id": 66118869, "body": "Thank you for verification. Not sure now if this is a bug in clib buffer handling on my system. What compiler+version did you use to verify?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473354945, "post_id": 39354868, "comment_id": 66119449, "body": "Perhaps using <code>setvbuf()</code> too late?  C11dr 7.21.5.6 2 &quot;The setvbuf function may be used only after the stream pointed to by stream has been associated with an open file <b>and before any other operation</b> (other than an unsuccessful call to setvbuf) is performed on the stream.&quot;"}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1473355567, "post_id": 39354868, "comment_id": 66119746, "body": "I used gcc version 4.2.1, but there may be undefined behavior."}, {"owner": {"reputation": 21, "user_id": 4504615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049ceb9191241d72eb084d71fa530570?s=128&d=identicon&r=PG&f=1", "display_name": "marcas756", "link": "https://stackoverflow.com/users/4504615/marcas756"}, "edited": false, "score": 0, "creation_date": 1473512605, "post_id": 39354868, "comment_id": 66176451, "body": "Seems to be undefined behaviour indeed ... <a href=\"https://en.wikibooks.org/wiki/C_Programming/C_Reference/stdio.h/setvbuf\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/C_Programming/C_Reference/stdio.h/setv&zwnj;&#8203;buf</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4504615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049ceb9191241d72eb084d71fa530570?s=128&d=identicon&r=PG&f=1", "display_name": "marcas756", "link": "https://stackoverflow.com/users/4504615/marcas756"}, "is_accepted": true, "score": 1, "last_activity_date": 1473703740, "last_edit_date": 1495541699, "creation_date": 1473697870, "answer_id": 39454861, "question_id": 39354868, "link": "https://stackoverflow.com/questions/39354868/buffer-handling-for-stdout/39454861#39454861", "title": "Buffer handling for stdout", "body": "<p>After messing around with closing and opening stdout, \"dup\"-ing, writing to file and reading from file  and other weird solutions I found one that fits my needs, but isn't that portable but does not need another file to be opened :</p>\n\n<p><a href=\"https://stackoverflow.com/questions/955962/how-to-buffer-stdout-in-memory-and-write-it-from-a-dedicated-thread\">How to buffer stdout in memory and write it from a dedicated thread</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MAX_LEN 40\n\nint main( int argc, char *argv[] ) {\n  char buffer[MAX_LEN+1] = {0};\n  int out_pipe[2];\n  int saved_stdout;\n\n  saved_stdout = dup(STDOUT_FILENO);  /* save stdout for display later */\n\n  if( pipe(out_pipe) != 0 ) {          /* make a pipe */\n    exit(1);\n  }\n\n  dup2(out_pipe[1], STDOUT_FILENO);   /* redirect stdout to the pipe */\n  close(out_pipe[1]);\n\n  /* anything sent to printf should now go down the pipe */\n  printf(\"ceci n'est pas une pipe\");\n  fflush(stdout);\n\n  read(out_pipe[0], buffer, MAX_LEN); /* read from pipe into buffer */\n\n  dup2(saved_stdout, STDOUT_FILENO);  /* reconnect stdout for testing */\n  printf(\"read: %s\\n\", buffer);\n\n  return 0;\n}\n</code></pre>\n\n<p>After rewriting it to make an own module \"stdout_redirect.c\" this results in :</p>\n\n<pre><code>#define BIGENOUGH 1000\n#define PIPE_READ   0\n#define PIPE_WRITE  1\n\nchar stdout_buffer [BIGENOUGH];\nstatic int stdout_save;\nstatic int stdout_pipe[2];\n\nbool stdout_redirect()\n{\n    stdout_save = dup(STDOUT_FILENO);  /* save stdout for display later */\n\n    if( pipe(stdout_pipe) != 0 ) {          /* make a pipe */\n        return false;\n    }\n\n    dup2(stdout_pipe[PIPE_WRITE], STDOUT_FILENO);   /* redirect stdout to the pipe */\n    close(stdout_pipe[PIPE_WRITE]);\n\n    return true;\n}\n\nssize_t stdout_restore()\n{\n    ssize_t size;\n    fflush(stdout); /* flush if not flushed before */\n    size = read(stdout_pipe[PIPE_READ], stdout_buffer, sizeof(stdout_buffer)); /* read from pipe into buffer */\n    close(stdout_pipe[PIPE_READ]);\n    dup2(stdout_save, STDOUT_FILENO);  /* reconnect stdout */\n    return size;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4504615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049ceb9191241d72eb084d71fa530570?s=128&d=identicon&r=PG&f=1", "display_name": "marcas756", "link": "https://stackoverflow.com/users/4504615/marcas756"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 39454861, "answer_count": 1, "score": 1, "last_activity_date": 1544773476, "creation_date": 1473183481, "last_edit_date": 1544773476, "question_id": 39354868, "link": "https://stackoverflow.com/questions/39354868/buffer-handling-for-stdout", "title": "Buffer handling for stdout", "body": "<p>I try to unittest a terminal output function. The function streams data to stdout, so my idea was to get control of the stdout buffer and to check if the function properly writes the correct data into the buffer.</p>\n\n<p>setvbuf seemed to me to be the ideal thing to achieve this.</p>\n\n<p>I used setvbuf to redirect stdout to use my own specified buffer. </p>\n\n<p>I used streaming mode _IOFBF so that theoretically an internal flush only happens if the buffer is full. BUFSIZ on my system has a size of 8192 bytes ... which is more than big enough for the output of the function under test, without internal flush during invocation.</p>\n\n<p>My source currently looks like :</p>\n\n<pre><code>char buffer [BUFSIZ] = {0};\n\n/* any outputs before redirecting */\nprintf(\"0\\n\");\n\n/* output any remaining data */\nfflush(stdout); \n/* redirect to my buffer with full buffering */\nsetvbuf(stdout,buffer,_IOFBF,BUFSIZ); \n\n/* testcode ... output of the function under test */\nprintf(\"1\\n\");\nprintf(\"2\\n\");\n\n/* output any remaining data */\nfflush(stdout);\n/* restore internal buffering with line buffering */\nsetvbuf(stdout,NULL,_IOLBF,BUFSIZ);\n\n/* let us see what is in our buffer */\nprintf(\"%s\",buffer);\n</code></pre>\n\n<p>Debugging this code shows that \"2\\n\" overwrites \"1\\n\" in the buffer during the testcode section (gcc 5.4.0 x64 GNU libc version: 2.23)</p>\n\n<p>Output is :</p>\n\n<pre><code>0\n1\n2\n2\n</code></pre>\n\n<p>But I expected :</p>\n\n<pre><code>0\n1\n2\n1\n2\n</code></pre>\n\n<p>I would be appreciated for any hint.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1473180839, "post_id": 39354159, "comment_id": 66038127, "body": "Surely this is not the entirety of the compiler&#39;s diagnostic?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473180906, "post_id": 39354159, "comment_id": 66038167, "body": "There is no 2D array, but a 1D array. Any reason you don&#39;t use a 2D array, but do the indexing maths by hand?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473180955, "post_id": 39354159, "comment_id": 66038205, "body": "And what is the error message? See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 615, "user_id": 1864738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/OdNhm.jpg?s=128&g=1", "display_name": "kundrata", "link": "https://stackoverflow.com/users/1864738/kundrata"}, "edited": false, "score": 0, "creation_date": 1473180972, "post_id": 39354159, "comment_id": 66038214, "body": "Can you tell us what the error says?"}, {"owner": {"reputation": 13, "user_id": 6801256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ee50716b92cbbb748b9e7b6a0a39ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Lee", "link": "https://stackoverflow.com/users/6801256/kim-lee"}, "edited": false, "score": 0, "creation_date": 1473181468, "post_id": 39354159, "comment_id": 66038483, "body": "This is the error: ` error: passing &#39;double&#39; to parameter of incompatible type &#39;const void * `"}, {"owner": {"reputation": 13, "user_id": 6801256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ee50716b92cbbb748b9e7b6a0a39ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Lee", "link": "https://stackoverflow.com/users/6801256/kim-lee"}, "edited": false, "score": 0, "creation_date": 1473182387, "post_id": 39354159, "comment_id": 66038975, "body": "-3 votes from the first post !!"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473181016, "post_id": 39354200, "comment_id": 66038240, "body": "Or use a 2D array ..."}, {"owner": {"reputation": 13, "user_id": 6801256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ee50716b92cbbb748b9e7b6a0a39ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Lee", "link": "https://stackoverflow.com/users/6801256/kim-lee"}, "edited": false, "score": 0, "creation_date": 1473181283, "post_id": 39354200, "comment_id": 66038398, "body": "Thank you very much"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473181340, "post_id": 39354200, "comment_id": 66038423, "body": "@Olaf, you are right, but it seems to me that OP wants a flat 2D array (due to the dimensions passed in malloc)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1473181485, "post_id": 39354200, "comment_id": 66038496, "body": "@AlterMann: You have to pass the dimensions anyway to malloc. I don&#39;t think OP <b>wants</b> a 1D array. He just might not know there is a better alternative. (anyway, a better way to get the size of an element is <code>sizeof(* buffer)</code> instead of repeating the type explicitly. And yes, that works for pointers to VLA, too."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473182229, "post_id": 39354200, "comment_id": 66038908, "body": "@Olaf, I mean OP is using (wrong) arithmetic for a flat 2D array and  reserving rows * cols in <code>malloc</code>, but you are right, he might not know there is a better alternative, edited"}, {"owner": {"reputation": 13, "user_id": 6801256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ee50716b92cbbb748b9e7b6a0a39ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Lee", "link": "https://stackoverflow.com/users/6801256/kim-lee"}, "edited": false, "score": 1, "creation_date": 1473182282, "post_id": 39354200, "comment_id": 66038933, "body": "Yes, the alternative you mentioned is just great. However, it says: <code>compound array initializer is expected</code>. Do you know what does this mean"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 13, "user_id": 6801256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ee50716b92cbbb748b9e7b6a0a39ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Lee", "link": "https://stackoverflow.com/users/6801256/kim-lee"}, "edited": false, "score": 0, "creation_date": 1473188287, "post_id": 39354200, "comment_id": 66042046, "body": "@KimLee: There is a lot to be found about 2D arrays. Please first do some research on your own. And I already asked you to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. That&#39;s how it works here."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 2, "last_activity_date": 1473183149, "last_edit_date": 1495542767, "creation_date": 1473180899, "answer_id": 39354200, "question_id": 39354159, "link": "https://stackoverflow.com/questions/39354159/issue-when-copying-blocks-of-memory-using-memcpy/39354200#39354200", "title": "Issue when copying blocks of memory using memcpy", "body": "<pre><code>double *buffer = malloc(10 * 3 * sizeof(double*));\n</code></pre>\n\n<p>This is wrong, a pointer to <code>double</code> wants space for n <code>double</code>s (not for n pointers to <code>double</code>)</p>\n\n<p>Change to</p>\n\n<pre><code>double *buffer = malloc(10 * 3 * sizeof(double));\n</code></pre>\n\n<p>Same for <code>temp</code></p>\n\n<blockquote>\n  <p>I want to copy the first 12 elements of buffer (i.e. the first 4\n  rows) into the second one temp using memcpy</p>\n</blockquote>\n\n<p>Use:</p>\n\n<pre><code>memcpy(temp, buffer, sizeof(double) * 12);\n</code></pre>\n\n<blockquote>\n  <p>I get this error:</p>\n</blockquote>\n\n<pre><code>&gt; memcpy(*(temp+ i*3), *(buffer + i*3), 3 * sizeof(double));\n&gt;        ^~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<blockquote>\n  <p>Can someone tell me why?</p>\n</blockquote>\n\n<p><code>memcpy</code> wants a pointer (an address) but you are dereferencing the pointer (thus passing a value like <code>3.14</code> instead of an address)</p>\n\n<p>Do you want a real 2D array?</p>\n\n<p>In this case you should use</p>\n\n<pre><code>double (*buffer)[cols] = malloc(sizeof(*buffer) * rows); /* VLA (since C99) */\n</code></pre>\n\n<p>Take a look to <a href=\"https://stackoverflow.com/q/3584705/1606345\">defining a 2D array with malloc and modifying it</a></p>\n"}], "owner": {"reputation": 13, "user_id": 6801256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ee50716b92cbbb748b9e7b6a0a39ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Lee", "link": "https://stackoverflow.com/users/6801256/kim-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "closed_date": 1473234885, "accepted_answer_id": 39354200, "answer_count": 1, "score": -3, "last_activity_date": 1473183149, "creation_date": 1473180768, "question_id": 39354159, "link": "https://stackoverflow.com/questions/39354159/issue-when-copying-blocks-of-memory-using-memcpy", "closed_reason": "Not suitable for this site", "title": "Issue when copying blocks of memory using memcpy", "body": "<p>In my following code, I made <code>buffer</code> as a 2D array created using <code>malloc(r * c * sizeof(double*));</code>. I want to copy the first 12 elements of <code>buffer</code> (i.e. the first 4 rows) into the second one <code>temp</code> using <code>memcpy</code>.</p>\n\n<pre><code>double *buffer = malloc(10 * 3 * sizeof(double*));\ndouble *temp = malloc(4 * 3 * sizeof(double*));\n\n    for (int i = 0; i &lt; 4; ++i) {\n        memcpy(*(temp+ i*3), *(buffer + i*3), 3 * sizeof(double));\n    }\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>memcpy(*(temp+ i*3), *(buffer + i*3), 3 * sizeof(double));\n       ^~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>Can someone tell me why?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1473180599, "post_id": 39354064, "comment_id": 66037974, "body": "I&#39;m not seeing a question in there."}, {"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1473180604, "post_id": 39354064, "comment_id": 66037976, "body": "There a question in here somewhere?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1473181703, "post_id": 39354064, "comment_id": 66038630, "body": "Does each list store to list of list?"}, {"owner": {"reputation": 17, "user_id": 6476824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cbdffe78113443ee5a76a5ad67ef074?s=128&d=identicon&r=PG&f=1", "display_name": "AppCode", "link": "https://stackoverflow.com/users/6476824/appcode"}, "edited": false, "score": 0, "creation_date": 1473181866, "post_id": 39354064, "comment_id": 66038714, "body": "No, it should simply print the list , in this case as u see from the sample input , it should create 4 list , as explained in the example."}, {"owner": {"reputation": 17, "user_id": 6476824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cbdffe78113443ee5a76a5ad67ef074?s=128&d=identicon&r=PG&f=1", "display_name": "AppCode", "link": "https://stackoverflow.com/users/6476824/appcode"}, "edited": false, "score": 0, "creation_date": 1473181936, "post_id": 39354064, "comment_id": 66038748, "body": "I am new in Using c as well as in using StackOverflow , If there is some misconception in understanding the question / formatting, kindly add a comment /suggestion and I will make necessary changes before down voting."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1473183983, "post_id": 39354064, "comment_id": 66039863, "body": "@AppCode To be clear, the post does not ask a question.  Lacking that, makes it more difficult for answers to apply to the post.  There is no misconception in understanding the question as there is no question."}], "answers": [{"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": true, "score": 0, "last_activity_date": 1473183562, "creation_date": 1473183562, "answer_id": 39354887, "question_id": 39354064, "link": "https://stackoverflow.com/questions/39354064/creating-a-list/39354887#39354887", "title": "Creating a list", "body": "<p>like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct list {\n    int v;\n    struct list *next;\n};\n\ntypedef struct list LIST;\n\nLIST *makeListFromFile(FILE *fp){\n    int v;\n    LIST *current, *head = NULL;\n\n    while(fscanf(fp, \"%d\", &amp;v) == 1 &amp;&amp; v != -1){\n        LIST *node = malloc(sizeof(LIST));\n        node-&gt;v = v;\n        node-&gt;next = NULL;\n        if (head == NULL)\n            current = head = node;\n        else\n            current = current-&gt;next = node;\n    }\n    return head;\n}\n\nint main(void) {\n    FILE *fp = fopen(\"test.txt\", \"r\");\n\n    while(!feof(fp)){\n        LIST *list = makeListFromFile(fp);\n        while(list){\n            LIST *temp = list-&gt;next;\n            printf(\"%d \", list-&gt;v);\n            free(list);\n            list = temp;\n        }\n        puts(\"NULL\");\n    }\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6476824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cbdffe78113443ee5a76a5ad67ef074?s=128&d=identicon&r=PG&f=1", "display_name": "AppCode", "link": "https://stackoverflow.com/users/6476824/appcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1473233036, "accepted_answer_id": 39354887, "answer_count": 1, "score": -4, "last_activity_date": 1473183562, "creation_date": 1473180390, "last_edit_date": 1473180930, "question_id": 39354064, "link": "https://stackoverflow.com/questions/39354064/creating-a-list", "closed_reason": "Needs details or clarity", "title": "Creating a list", "body": "<p>A  function reads an input \ufb01le containing positive integers (one number per line) and creates a list containing these numbers, one per cell. -1 in the input \ufb01le indicates end of the list. This way you can have multiple lists speci\ufb01ed in the same input \ufb01le. Assume that the input \ufb01le is called \u201cinput\u201d. Each call to a function  reads the numbers in the input \ufb01le, until -1 is reached, and puts these numbers in the list, and returns a pointer to the head of this list. Thus, if the input \ufb01le contains\n1 5 4 -1 4 8 6 -1 -1 7 8\nThen \ufb01rst call to function will return a pointer to the list 1->5->4->null and the second call to a function  will return a pointer to the list 4->8->6->null.\nThird call will return null and 4th call will return 7->8-> null. I wanted to achieve this , So far I am able to read the file from the text file. Now I wanted for each -1 encountered fin file it should take the number until that -1 and create a list . </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct list {\n    char *string;\n    struct list *next;\n};\n\ntypedef struct list LIST;\n\nint main() {\n    FILE *fp;\n    char line[128];\n    LIST *current, *head;\n\n    head = current = NULL;\n    fp = fopen(\"test.txt\", \"r\");\n\n    while (fgets(line, sizeof(line), fp)) {\n        LIST *node = (struct list * )malloc(sizeof(LIST));\n        node-&gt;string = _strdup(line);// strdup(line);//note : strdup is not standard function\n        node-&gt;next = NULL;\n\n        if (head == NULL) {\n            current = head = node;\n        }\n        else {\n            current = current-&gt;next = node;\n        }\n    }\n    fclose(fp);\n    //test print\n    for (current = head; current; current = current-&gt;next) {\n        printf(\"%s\", current-&gt;string);\n    }\n    //need free for each node\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "fcntl"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1473178872, "post_id": 39353442, "comment_id": 66037109, "body": "Exactly which man-page are you referring to, please?"}, {"owner": {"reputation": 2336, "user_id": 1618406, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9fba98cb45aca3fe5f263540f6079214?s=128&d=identicon&r=PG", "display_name": "Tom Seddon", "link": "https://stackoverflow.com/users/1618406/tom-seddon"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1473179019, "post_id": 39353442, "comment_id": 66037192, "body": "The one I get from <code>man fcntl</code>. Looks to be this one: <a href=\"http://man7.org/linux/man-pages/man2/fcntl.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/fcntl.2.html</a> - but I didn&#39;t check every char!"}, {"owner": {"reputation": 2336, "user_id": 1618406, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9fba98cb45aca3fe5f263540f6079214?s=128&d=identicon&r=PG", "display_name": "Tom Seddon", "link": "https://stackoverflow.com/users/1618406/tom-seddon"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1473185309, "post_id": 39353442, "comment_id": 66040483, "body": "I filed a man page bug for this: <a href=\"https://bugzilla.kernel.org/show_bug.cgi?id=156231\" rel=\"nofollow noreferrer\">bugzilla.kernel.org/show_bug.cgi?id=156231</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 2336, "user_id": 1618406, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9fba98cb45aca3fe5f263540f6079214?s=128&d=identicon&r=PG", "display_name": "Tom Seddon", "link": "https://stackoverflow.com/users/1618406/tom-seddon"}, "edited": false, "score": 1, "creation_date": 1473180114, "post_id": 39353581, "comment_id": 66037728, "body": "Nops, I found it on <a href=\"https://searchcode.com/?q=F_SEAL_SEAL%20repo:mirrors/linux-2.6\" rel=\"nofollow noreferrer\">searchcode</a>"}, {"owner": {"reputation": 2336, "user_id": 1618406, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9fba98cb45aca3fe5f263540f6079214?s=128&d=identicon&r=PG", "display_name": "Tom Seddon", "link": "https://stackoverflow.com/users/1618406/tom-seddon"}, "edited": false, "score": 1, "creation_date": 1473184911, "post_id": 39353581, "comment_id": 66040306, "body": "Link noted, thanks - I&#39;m sure that will prove useful."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 2, "last_activity_date": 1473178655, "creation_date": 1473178655, "answer_id": 39353581, "question_id": 39353442, "link": "https://stackoverflow.com/questions/39353442/f-seal-seal-undeclared-even-when-headers-are-included/39353581#39353581", "title": "F_SEAL_SEAL undeclared, even when headers are included", "body": "<p>You want</p>\n\n<pre><code>#include &lt;linux/fcntl.h&gt;\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 2336, "user_id": 1618406, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9fba98cb45aca3fe5f263540f6079214?s=128&d=identicon&r=PG", "display_name": "Tom Seddon", "link": "https://stackoverflow.com/users/1618406/tom-seddon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 39353581, "answer_count": 1, "score": 2, "last_activity_date": 1473178655, "creation_date": 1473178167, "question_id": 39353442, "link": "https://stackoverflow.com/questions/39353442/f-seal-seal-undeclared-even-when-headers-are-included", "title": "F_SEAL_SEAL undeclared, even when headers are included", "body": "<p>I'm trying to use file sealing on Linux. Here's an example C program.</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main(void) {\n    (void)F_SEAL_SEAL;\n}\n</code></pre>\n\n<p>You can build it using <code>gcc -Wall -o ./linux_file_sealing linux_file_sealing.c</code> or similar.</p>\n\n<p>When I build it, I get an error about <code>F_SEAL_SEAL</code>.</p>\n\n<pre><code>gcc -Wall -o ./linux_file_sealing linux_file_sealing.c\nlinux_file_sealing.c: In function \u2018main\u2019:\nlinux_file_sealing.c:7:19: error: \u2018F_SEAL_SEAL\u2019 undeclared (first use in this function)\n     printf(\"%d\\n\",F_SEAL_SEAL);\n                   ^\nlinux_file_sealing.c:7:19: note: each undeclared identifier is reported only once for each function it appears in\n</code></pre>\n\n<p>I'm including <code>unistd.h</code> and <code>fcntl.h</code>, as per the man page... so what else should I be doing, and where is that described?</p>\n\n<p>(The man pages just say that sealing is \"Linux-specific\", but give no further details. This is the reason for including the <code>GNU_SOURCE</code> define, which is how you get the other Linux-specific stuff, but for <code>F_SEAL_SEAL</code> it seems to make no difference.)</p>\n\n<p>(Ubuntu 16.04 LTS, Linux 4.4.0-36)</p>\n"}, {"tags": ["c", "doxygen"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473180515, "post_id": 39353302, "comment_id": 66037930, "body": "<code>\\memberof</code> is related to classes or <code>structs</code> (the former not for C code), not files."}], "answers": [{"tags": [], "owner": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1473178722, "creation_date": 1473178722, "answer_id": 39353596, "question_id": 39353302, "link": "https://stackoverflow.com/questions/39353302/doxygen-cant-generate-extern-api-in-c/39353596#39353596", "title": "doxygen can&#39;t generate extern api in c", "body": "<p>You at least need to document the file itself with <code>\\file</code> for anything to be generated. Not sure if this is enough to generate documentation for the <code>extern</code> function, though.</p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 2699330, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8be620b34b264324753682e6540a13a4?s=128&d=identicon&r=PG&f=1", "display_name": "William Lai", "link": "https://stackoverflow.com/users/2699330/william-lai"}, "is_accepted": false, "score": 0, "last_activity_date": 1473217105, "creation_date": 1473217105, "answer_id": 39360579, "question_id": 39353302, "link": "https://stackoverflow.com/questions/39353302/doxygen-cant-generate-extern-api-in-c/39360579#39360579", "title": "doxygen can&#39;t generate extern api in c", "body": "<p>As hint from @rveerd, I complete the answer. At first it needs a <code>\\file</code> commands to document global objects. At this step all objects are documented include those we don't want to document. So we need discard parts we don't need via adding <code>\\cond HIDDEN_SYMBOLS</code>. The sample code is as below:</p>\n\n<pre><code>/** @file test.h */\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n/**\n * @brief This is foo\n */    \nextern int foo();\n\n/** @cond HIDDEN_SYMBOLS */\n#define JUNK_A DONT_DOC_IT\n#define JUNK_B DONT_DOC_IT\n/** @endcond */\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2699330, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8be620b34b264324753682e6540a13a4?s=128&d=identicon&r=PG&f=1", "display_name": "William Lai", "link": "https://stackoverflow.com/users/2699330/william-lai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473235024, "creation_date": 1473177693, "last_edit_date": 1473235024, "question_id": 39353302, "link": "https://stackoverflow.com/questions/39353302/doxygen-cant-generate-extern-api-in-c", "title": "doxygen can&#39;t generate extern api in c", "body": "<p>I want to document an extern API in an header file as below</p>\n\n<pre><code>// bar.h\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n/**\n * \\memberof bar\n * This is foo\n */    \nextern int foo();\n\n#define JUNK_A DONT_DOC_IT\n#define JUNK_B DONT_DOC_IT\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>Function <code>foo()</code> is defined is somewhere in archive file and \"bar.h\" is exposed as user API and I want to document it. But doxygen cannot generate it.\nI don't want to enable EXTRACT_ALL because there are some other things I don't want to document it.</p>\n\n<p>As sample code shows I've tried <code>\\memberof</code> but it's not work. Could someone can help me?</p>\n"}, {"tags": ["c", "haskell", "segmentation-fault", "z3"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 4, "creation_date": 1473177650, "post_id": 39353100, "comment_id": 66036438, "body": "I would open a bug report in the haskell package, and let them deal with upstream if there&#39;s an issue"}, {"owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1473192209, "post_id": 39353100, "comment_id": 66043850, "body": "I&#39;ve done that: <a href=\"https://bitbucket.org/iago/z3-haskell/issues/12/possible-error-in-package\" rel=\"nofollow noreferrer\">bitbucket.org/iago/z3-haskell/issues/12/&hellip;</a> If iago replies there, and not here, I&#39;ll post an update."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473193135, "post_id": 39357007, "comment_id": 66044277, "body": "Sorry about that error- I had to reindent everything after copying and pasting to SO, and messed up that section (it&#39;s now fixed.) We do have different versions of ghc (I&#39;m on 8.0.1) and z3 (I&#39;m on 4.4.2.)  Same version of the z3 haskell package though. Did you run it with 0 to 70 (or some other larger number), and just cut down your output? I don&#39;t get the segment fault error when I use just [0..9]."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473194479, "post_id": 39357007, "comment_id": 66044878, "body": "I ran with 0..70, just your code with the indentation fixed."}, {"owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473194938, "post_id": 39357007, "comment_id": 66045089, "body": "Alright, well thanks for looking at it anyway.  I&#39;m inclined to doubt it has to do with ghc, but I&#39;ll see if I can give it a shot with 7.10.3, just in case."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473196062, "post_id": 39357007, "comment_id": 66045587, "body": "@Bill I have tried with GHC 8.0.1 and Z3 4.3.2 (commit <code>79326e24dfb9dff723d1ce64b3f50bcf394bd48c</code>).  I can not reproduce your issue."}, {"owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473207851, "post_id": 39357007, "comment_id": 66048902, "body": "Thanks for the information.  I&#39;ll try reinstalling and see what happens..."}, {"owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473208936, "post_id": 39357007, "comment_id": 66049119, "body": "Still not working after reinstalling, unfortunately."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473218714, "post_id": 39357007, "comment_id": 66050860, "body": "@Bill. Not much more I can do from here. If you&#39;re willing to put together a simple vagrant file that can reproduce the issue then I&#39;d likely check it out, but without an ability to reproduce seems unlikely even the z3 maintainers will get anywhere."}, {"owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473219496, "post_id": 39357007, "comment_id": 66051023, "body": "Yeah, I understand, didn&#39;t expect you to be able to help at this point.  I&#39;m not sure how to use Vagrant, but I&#39;ll look into it."}, {"owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "edited": false, "score": 0, "creation_date": 1473220735, "post_id": 39357007, "comment_id": 66051266, "body": "So it appears something was wrong with the way z3 was setup.  I just rebuilt it, and everything works perfectly now.  So I guess if you&#39;re getting a similar error, try that.  Thanks for looking at this, Thomas."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 0, "last_activity_date": 1473196017, "last_edit_date": 1473196017, "creation_date": 1473192334, "answer_id": 39357007, "question_id": 39353100, "link": "https://stackoverflow.com/questions/39353100/segmentation-fault-with-haskell-z3-api/39357007#39357007", "title": "Segmentation fault with Haskell Z3 api", "body": "<p>I see there is one spacing issue in the code you pasted (the alignment of <code>do</code>).  Please ensure that this is otherwise the code causing your issue.</p>\n\n<p>I am unable to reproduce your issue:</p>\n\n<pre><code>% ghc so.hs -fforce-recomp &amp;&amp; ./so 2&gt;&amp;1 | tail ; ghc --version ; z3 -version\n[1 of 1] Compiling Main             ( so.hs, so.o )\nLinking so ...\nSat\nSat\nSat\nSat\nSat\nSat\nSat\nSat\nSat\n[]\nThe Glorious Glasgow Haskell Compilation System, version 7.10.3\nZ3 version 4.4.1\n</code></pre>\n\n<p>Oh, and:</p>\n\n<pre><code>% ghc-pkg list z3\n   z3-4.1.0\n</code></pre>\n\n<p>EDIT: Matching GHC and Z3 versions and I still can not reproduce the issue:</p>\n\n<pre><code>% LD_LIBRARY_PATH=$HOME/lib ghc so.hs -fforce-recomp &amp;&amp; LD_LIBRARY_PATH=$HOME/lib ./so 2&gt;&amp;1 | tail ; ghc --version ; z3 -version\n[1 of 1] Compiling Main             ( so.hs, so.o )\nLinking so ...\nSat\nSat\nSat\nSat\nSat\nSat\nSat\nSat\nSat\n[]\nThe Glorious Glasgow Haskell Compilation System, version 8.0.1\nZ3 version 4.3.2\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 6637204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873781c7b317aaa81b4361cf4500fe6e?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6637204/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473196017, "creation_date": 1473176989, "last_edit_date": 1473193204, "question_id": 39353100, "link": "https://stackoverflow.com/questions/39353100/segmentation-fault-with-haskell-z3-api", "title": "Segmentation fault with Haskell Z3 api", "body": "<p>I'm using Haskell with this Z3 package, which closely mirrors (and makes use of, via Haskell's foreign function interface) the C api: <a href=\"https://hackage.haskell.org/package/z3\" rel=\"nofollow\">https://hackage.haskell.org/package/z3</a></p>\n\n<p>I'm getting a segmentation fault, and have managed to reduce it to the following: </p>\n\n<pre><code>mainx = do\n    print =&lt;&lt; intCheck [0..70]\n\nintCheck :: [Int] -&gt; IO [Int]\nintCheck [] = return []\nintCheck (x:xs) = \n    do\n        checking &lt;- evalZ3 $ checkImpact x\n        print checking\n        return =&lt;&lt; intCheck xs\n\ncheckImpact :: Int -&gt; Z3 Result\ncheckImpact r  = do\n    reset\n\n    xSymb &lt;- mkStringSymbol \"x\"\n    x &lt;- mkConst xSymb  =&lt;&lt; mkIntSort\n    trace (\"asserting = \" ++ show r) assert =&lt;&lt; mkEq x x\n\n    solverCheck\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>asserting = 0\nSat\nasserting = 1\nSat\nasserting = 2\nSat\n...[omitted]\nasserting = 45\nSat\nasserting = 46\nSegmentation fault: 11\n</code></pre>\n\n<p>Usually, the last asserting is somewhere around 46, but it does vary between executions.  My best guess is that memory is not being freed properly (I can't figure out why it would halt at slightly different points otherwise), but I'm unsure if it's a problem with my recursion (in intCheck), or with the z3 api.</p>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1473176477, "post_id": 39352908, "comment_id": 66035685, "body": "No, this does not give you <code>[0-10]</code>."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 4, "creation_date": 1473176590, "post_id": 39352908, "comment_id": 66035755, "body": "Your code gives you what you want, a number between 1 and 10 including 1 and 10: <a href=\"http://ideone.com/PiA1Wn\" rel=\"nofollow noreferrer\">ideone.com/PiA1Wn</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1473180691, "post_id": 39352908, "comment_id": 66038022, "body": "Note this will generate a non-uniform distribution for typical implementations."}], "owner": {"reputation": 25, "user_id": 6792153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd937759f868ce0299b25c460295902?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/6792153/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1473176606, "answer_count": 0, "score": 0, "last_activity_date": 1473176315, "creation_date": 1473176315, "question_id": 39352908, "link": "https://stackoverflow.com/questions/39352908/random-number-within-a-range-but-exclusive", "closed_reason": "Duplicate", "title": "Random Number within a range but exclusive (...]", "body": "<p>For instance, the following gives you a random number between [0-10].</p>\n\n<pre><code>srand(time(NULL));\nint r = ( rand() % 10 ) + 1;\n</code></pre>\n\n<p>I want to make it something like <code>(0-10]</code>, i.e. excluding zero but including 10. I may use if condition here but I want more neat solution.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "structure", "unions"], "comments": [{"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 5, "creation_date": 1473173640, "post_id": 39352005, "comment_id": 66033888, "body": "That&#39;s the point of unions. <code>s1</code> and <code>s2</code> share the same memory."}, {"owner": {"reputation": 3572, "user_id": 412044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WZZOJ.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/412044/martin"}, "edited": false, "score": 0, "creation_date": 1473174813, "post_id": 39352005, "comment_id": 66034661, "body": "What you&#39;re doing is undefined behavior. You&#39;re only supposed to read the union field which was most recently written."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 3572, "user_id": 412044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WZZOJ.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/412044/martin"}, "edited": false, "score": 0, "creation_date": 1473175192, "post_id": 39352005, "comment_id": 66034895, "body": "@Martin In C++ yes, in C it&#39;s OK."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 3572, "user_id": 412044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WZZOJ.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/412044/martin"}, "edited": false, "score": 0, "creation_date": 1473175469, "post_id": 39352005, "comment_id": 66035071, "body": "@Martin Well, it may be, it depends on the implementation. At worst you will get an indeterminate value which will trap."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473176594, "post_id": 39352005, "comment_id": 66035758, "body": "@2501, no this is always well defined, the C standard explicitly allows this."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1473176642, "post_id": 39352005, "comment_id": 66035795, "body": "@JensGustedt Trap values will cause undefined behavior."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473176720, "post_id": 39352005, "comment_id": 66035829, "body": "@2501, how could there be a trap value in this case? The types are all <code>int</code>."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1473176769, "post_id": 39352005, "comment_id": 66035857, "body": "@JensGustedt Padding bytes in between members in one struct but not the other."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473177223, "post_id": 39352005, "comment_id": 66036172, "body": "@2501, not an issue here either, the two union members share an initial sequence that are in fact the members in their entirety."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1473177313, "post_id": 39352005, "comment_id": 66036229, "body": "@JensGustedt There may be padding in the structs themselves, specifically in between their members. As the structs are two different types one may have padding and the other many not."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1473177457, "post_id": 39352005, "comment_id": 66036319, "body": "@2501, no, as I said, the standard guarantees that initial sequences that are composed of elements of the same type can be read interchangeably. this is 6.5.2.3 p6."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1473178156, "post_id": 39352005, "comment_id": 66036719, "body": "@JensGustedt Thanks I wasn&#39;t aware of that rule. However, C still permits that reading will trap. For example: <code>union{ int a; int b }s; s.a = 1; int r = s.b;</code> may trap on an exotic architecture."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1473188280, "post_id": 39352005, "comment_id": 66042042, "body": "@2501, no, not if it is conforming to the C standard."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1473189777, "post_id": 39352005, "comment_id": 66042737, "body": "@JensGustedt Yeah, you&#39;re right, the footnote: <i>If the member used to read the contents of a union object is not the same as the member last used to store a value in the object, the appropriate part of the object representation of the value is reinterpreted as an object representation in the new type as described in 6.2.6</i> mislead me."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 4, "last_activity_date": 1473173874, "creation_date": 1473173874, "answer_id": 39352143, "question_id": 39352005, "link": "https://stackoverflow.com/questions/39352005/what-is-the-logic-behind-this-behavior-in-union/39352143#39352143", "title": "What is the logic behind this behavior in union?", "body": "<p>In order to understand what is going on you need to recall that <code>union</code> members share the same memory. In your case, there are two members of the <code>union</code>: one is called <code>c</code>, and the other is called <code>f</code>.</p>\n\n<p>Any assignment to members of <code>c</code> will change the content of members of <code>f</code>, and vice versa. In your case, the structure of both members are identical, the following pairs share the same space:</p>\n\n<pre><code>x.c.a / x.f.d\nx.c.b / x.f.e\n</code></pre>\n\n<p>Any assignment of one member of the pair leads to the other member of the pair changing its value as well. That is precisely the behavior that you see: both members of each pair have identical values equal to the value from the last assignment.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 4, "last_activity_date": 1473174740, "last_edit_date": 1473174740, "creation_date": 1473174186, "answer_id": 39352249, "question_id": 39352005, "link": "https://stackoverflow.com/questions/39352005/what-is-the-logic-behind-this-behavior-in-union/39352249#39352249", "title": "What is the logic behind this behavior in union?", "body": "<p>A <code>union</code> has enough space to store the largest of its members. In your case, both members are of the same size. The memory layout for <code>x</code> is such that it can hold two <code>int</code>s.</p>\n\n<pre><code>x.c.a=1;    // Sets the value of the first int to 1\nx.f.e=2;    // Sets the value of the second int to 2\nx.c.b=3;    // Sets the value of the second int to 3\nx.f.d=4;    // Sets the value of the first int to 4\n</code></pre>\n\n<p>At the end of those statements, you have <code>3</code> in the first <code>int</code> and <code>4</code> in the second <code>int</code>.</p>\n\n<pre><code>printf(\"%d %d %d %d\\n\", x.c.a, x.f.e, x.c.b, x.f.d);\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>int i1 = x.c.a;  // i1 is 4\nint i2 = x.c.b;  // i2 is 2\n\nprintf(\"%d %d %d %d\\n\", i1, i2, i2, i1);\n</code></pre>\n\n<p>Which produces the output <code>4 3 3 4</code>.</p>\n\n<hr>\n\n<p>When you use:</p>\n\n<pre><code>x.c.b=3;    // Sets the value of the second int to 3 \nx.f.d=4;    // Sets the value of the first int to 4\nx.c.a=1;    // Sets the value of the first int to 1\nx.f.e=2;    // Sets the value of the second int to 2\n</code></pre>\n\n<p>At the end of those statements, you have <code>1</code> in the first <code>int</code> and <code>2</code> in the second <code>int</code>.</p>\n\n<p>That explains the second output.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6801025, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/255e230219247d407c1c5fa7c78b6e97?s=128&d=identicon&r=PG", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/6801025/anonymous"}, "is_accepted": false, "score": 1, "last_activity_date": 1473175954, "creation_date": 1473175954, "answer_id": 39352802, "question_id": 39352005, "link": "https://stackoverflow.com/questions/39352005/what-is-the-logic-behind-this-behavior-in-union/39352802#39352802", "title": "What is the logic behind this behavior in union?", "body": "<p>You might know this already, but <code>union</code>s specify multiple views on the same block of data. You happen to be specifying two identical views (a structure of two <code>int</code>s).</p>\n\n<p>Your two assignment sequences can therefore be re-written, respectively, as:</p>\n\n<pre><code>x.c.a=1;\nx.c.b=2;\nx.c.b=3;\nx.c.a=4;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>x.c.b=3;\nx.c.a=4;\nx.c.a=1;\nx.c.b=2;\n</code></pre>\n\n<p>.</p>\n\n<p>In the first case, the last assignments made to <code>x.c.a</code> and <code>x.c.b</code> are <code>4</code> and <code>3</code> respectively, so they remain. In the second case, these are <code>1</code> and <code>2</code>, so they are reflected in the output instead.</p>\n"}], "owner": {"reputation": 856, "user_id": 5486078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3949196f452be4bc39e48ba8835ec4ed?s=128&d=identicon&r=PG&f=1", "display_name": "jbsu32", "link": "https://stackoverflow.com/users/5486078/jbsu32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 39352249, "answer_count": 3, "score": -2, "last_activity_date": 1473175954, "creation_date": 1473173468, "question_id": 39352005, "link": "https://stackoverflow.com/questions/39352005/what-is-the-logic-behind-this-behavior-in-union", "title": "What is the logic behind this behavior in union?", "body": "<p>I have declared an union with 2 structures and assigned values to each of the elements and then printed them.   </p>\n\n<pre><code>union data {\n    struct s1 {\n        int a;\n        int b;\n    }c;\n    struct s2 {\n        int d;\n        int e;\n    }f;\n} x;\n\n/* Assignment */\nx.c.a=1;\nx.f.e=2;\nx.c.b=3;\nx.f.d=4;\n\nprintf(\"%d %d %d %d\\n\", x.c.a, x.f.e, x.c.b, x.f.d);\n</code></pre>\n\n<p>It outputs like this -> <code>4 3 3 4</code></p>\n\n<p>But, when I assign the values in the follwing order -></p>\n\n<pre><code>x.c.b=3;\nx.f.d=4;\nx.c.a=1;\nx.f.e=2;\n</code></pre>\n\n<p>It outputs like this -> <code>1 2 2 1</code></p>\n\n<p>What is the logic behind this variation ??</p>\n"}]