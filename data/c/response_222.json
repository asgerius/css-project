[{"tags": ["c", "assembly", "audio", "arm"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1554940434, "post_id": 55622782, "comment_id": 97938533, "body": "are all of the numbers 128?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1554941184, "post_id": 55622782, "comment_id": 97938687, "body": "There&#39;s a lot of setup that needs to be done before you can start outputting samples. You haven&#39;t shown any of that. And without detailed information about your hardware, there&#39;s no way to know if you&#39;ve done that correctly."}, {"owner": {"reputation": 341, "user_id": 10071695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a8f69678ab50576449ae3c4cdcc0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby", "link": "https://stackoverflow.com/users/10071695/ruby"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1554941647, "post_id": 55622782, "comment_id": 97938792, "body": "@immibis No, it just happened that the first few lines I showed were 128."}, {"owner": {"reputation": 341, "user_id": 10071695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a8f69678ab50576449ae3c4cdcc0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby", "link": "https://stackoverflow.com/users/10071695/ruby"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1554942620, "post_id": 55622782, "comment_id": 97938976, "body": "@user3386109 I added an edit which has pictures of what I did. Hopefully this clarifies my question. Thanks."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1554946738, "post_id": 55622782, "comment_id": 97939780, "body": "<code>int</code> is signed 32-bit on ARM.  But your 16-bit PCM data is <code>int16_t</code>.  (Assuming the endianness matches).  Also, your code is horribly indented, making it hard to read."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1554949850, "post_id": 55622782, "comment_id": 97940391, "body": "You should ask that someone what the full scale range is on those <b>32-bit signed integer samples</b>. Also, your <code>unsigned char data0</code> array isn&#39;t 16-bit PCM, nor is the <code>die_buffer</code>. So it&#39;s not at all clear what your actual data is."}], "owner": {"reputation": 341, "user_id": 10071695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a8f69678ab50576449ae3c4cdcc0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby", "link": "https://stackoverflow.com/users/10071695/ruby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554942579, "creation_date": 1554940049, "last_edit_date": 1554942579, "question_id": 55622782, "link": "https://stackoverflow.com/questions/55622782/converted-wav-file-to-c-code-not-outputting-sound-in-arm-processor", "title": "Converted .wav file to C code not outputting sound in ARM processor", "body": "<p>I'm currently coding a project using the ARM processor. The code is written in C, and I want to play a sound. I have this bit of code here: </p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n\n\n    void sound(int buffer[], int BUF_SIZE){\n    volatile int * audio_ptr = (int *) 0xFF203040; // audio port address\nint fifospace; \n    int buffer_index = 0;\nint left_buffer[BUF_SIZE];\nint right_buffer[BUF_SIZE];\n\nfifospace = *(audio_ptr + 1); // read the audio port fifospace register\nif ( (fifospace &amp; 0x000000FF) &gt; 96) // check RARC, for &gt; 75% full\n{\n/* store data until the audio-in FIFO is empty or the memory buffer is full */\nwhile ( (fifospace &amp; 0x000000FF) &amp;&amp; (buffer_index &lt; BUF_SIZE) )\n{\n *(audio_ptr + 2)= buffer[buffer_index]; //Leftdata\n *(audio_ptr + 3) = buffer[buffer_index]; //Rightdata\n++buffer_index;\nfifospace = *(audio_ptr + 1); // read the audio port fifospace register\n}\n}\n}\n\nint main(void){\nint die_buffer[26112] = {...}; \n\nint die_buf_size = 26112;    \n sound(die_buffer,die_buf_size);\n\n}\n</code></pre>\n\n<p>I have used a sample <code>die_buffer</code> array that works and can output sound. I tried converting my own <code>.wav</code> file to C code by using a program called <a href=\"https://www.softpedia.com/get/Multimedia/Audio/Other-AUDIO-Tools/WAVToCode.shtml\" rel=\"nofollow noreferrer\">Wav2Code</a>. I uploaded my <code>.wav</code> file (it plays a G note) and selected 16 bits, 1 channel, mix to mono and saved it as a C code. I took the array it outputted in the form of: </p>\n\n<pre><code>#define NUM_ELEMENTS 48651\n\nunsigned char data0[NUM_ELEMENTS] = {\n128, 128, 128, 128, 128, 128, 128, 128, ...}\n</code></pre>\n\n<p>And set it equal to my <code>die_buffer</code>array. However, when I ran the code, no sound came out. Please help! I have no idea how to convert a <code>.wav</code> file correct to C so that it can work with the processor. </p>\n\n<p><strong>Edit:</strong> I got my <code>.wav</code> file using Audacity. I recorded a sound, and I exported it as a <code>.wav</code> and saved it as a \"signed 16-bit PCM\" (since saving it as a 32-bit float PCM didn't work on WaveToCode). I set the project rate to 48000Hz, mono and I exported with those parameters. \n<a href=\"https://i.stack.imgur.com/UtjMF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UtjMF.png\" alt=\"Image of my Audacity export parameters\"></a></p>\n\n<p>Then, I use WaveToCode to change it to C code. Here are the parameters I used (mixed it to mono). </p>\n\n<p><a href=\"https://i.stack.imgur.com/k1bpk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k1bpk.png\" alt=\"Image of my WaveToCode export parameters\"></a></p>\n\n<p>I also talked to someone and they said that the processor expects a <strong>32-bit signed integer samples at a 48kHz sampling rate</strong>, and I'm not sure if I managed to convert to that correctly. Hopefully this edit helped clarified what I'm trying to do. Thanks. </p>\n"}, {"tags": ["c", "swift", "xcode"], "comments": [{"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1554940201, "post_id": 55622764, "comment_id": 97938485, "body": "Why are you trying to convert a path to an integer? That&#39;s never going to work."}, {"owner": {"reputation": 854, "user_id": 6362677, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13be8d12cbcbc70c36fc66f7321d300d?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/6362677/lou"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1554940549, "post_id": 55622764, "comment_id": 97938555, "body": "Sorry it&#39;s just a char. Not a path."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1554941267, "post_id": 55622764, "comment_id": 97938705, "body": "You&#39;re initing it from a path here: <code>Int8((string1?.description)!)</code>. That&#39;s going to give you <code>nil</code> every time."}, {"owner": {"reputation": 854, "user_id": 6362677, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13be8d12cbcbc70c36fc66f7321d300d?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/6362677/lou"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1554941505, "post_id": 55622764, "comment_id": 97938765, "body": "So for this Swift code, I am using an Objective-C file from several years ago and trying to adapt it to Swift. I used this obc-c 2 Swift converter (<a href=\"https://objectivec2swift.com/#/converter/code/\" rel=\"nofollow noreferrer\">objectivec2swift.com/#/converter/code</a>), as I barely understand Swift and can&#39;t read obj-c. The obj-c line I put in was: <code>NSString   * string1     = [[appBundle pathForResource:@&quot;data&quot; ofType:@&quot;&quot;]                                  stringByAppendingString:@&quot;&#47;&quot;];     const char * string1Path = [string1 cStringUsingEncoding:[NSString defaultCStringEncoding]];</code>"}, {"owner": {"reputation": 43976, "user_id": 6541007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2xMee.jpg?s=128&g=1", "display_name": "OOPer", "link": "https://stackoverflow.com/users/6541007/ooper"}, "edited": false, "score": 0, "creation_date": 1554941749, "post_id": 55622764, "comment_id": 97938810, "body": "You should better include such important info into your question. You can edit and update your own question. Better do it."}], "answers": [{"tags": [], "owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "is_accepted": false, "score": 1, "last_activity_date": 1554942106, "last_edit_date": 1554942106, "creation_date": 1554941764, "answer_id": 55622974, "question_id": 55622764, "link": "https://stackoverflow.com/questions/55622764/convert-int8-to-unsafepointerint8/55622974#55622974", "title": "Convert Int8? to UnsafePointer&lt;Int8&gt;?", "body": "<p>Although converting an <code>Int8?</code> to a pointer is simple enough (just unwrap it and use the <code>&amp;</code> operator when passing it as an argument), your real problem is that converting your string to an <code>Int8</code> in the first place is a mistake. The value that <code>Bundle.path(forResource:ofType:)</code> returns is going to be a path, looking something like this:</p>\n\n<pre><code>\"/Applications/MyApp.app/Contents/Resources/Init.dat\"\n</code></pre>\n\n<p>Meanwhile, you're trying to convert this to an <code>Int8</code>, which is an integer type that can store values from -128 to 127, using an initializer that takes a <code>String</code>. The reason this initializer returns an optional is because not every string will contain a number between -128 and 127, so if the string is something else, you get <code>nil</code>.</p>\n\n<p>A string like <code>\"37\"</code> or <code>\"-101\"</code> would convert properly, but a path string like the one above will always just give you <code>nil</code>.</p>\n\n<p>What you actually want to do here is to convert your <code>String</code> to a C string. There are a few different ways to do that, but the way I'd do it would be to use <code>URL</code>'s <code>fileSystemRepresentation</code> feature, like so:</p>\n\n<pre><code>let url1 = appBundle.url(forResource: \"Init\", withExtension: \"dat\")! // instead of path\nurl1.withUnsafeFileSystemRepresentation { cPath in\n    // cPath here is an UnsafePointer&lt;Int8&gt; that you can pass to C APIs inside this block.\n}\n\n// Don't let cPath get out here or bad things will happen.\n</code></pre>\n\n<p>Note that you need to make sure not to let <code>cPath</code> escape the <code>withUnsafeFileSystemRepresentation</code> block here, because it's not defined to be valid outside of that scope.</p>\n\n<p>Also note that due to the <code>!</code>, this will crash your app if the <code>Init.dat</code> file doesn't actually exist inside your application, so you'd better make sure you include it.</p>\n"}, {"tags": [], "owner": {"reputation": 43976, "user_id": 6541007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2xMee.jpg?s=128&g=1", "display_name": "OOPer", "link": "https://stackoverflow.com/users/6541007/ooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1554949729, "creation_date": 1554949729, "answer_id": 55623819, "question_id": 55622764, "link": "https://stackoverflow.com/questions/55622764/convert-int8-to-unsafepointerint8/55623819#55623819", "title": "Convert Int8? to UnsafePointer&lt;Int8&gt;?", "body": "<p>If I were given the C-function and some code shown as your Objective-C lines, I would write something like this:</p>\n\n<pre><code>\nvar mGLUTWindow: UnsafeRawPointer?\n\nclass MyClass {\n\n    func aMethod() {\n        let appBundle = Bundle.main\n\n        let string1 = appBundle.path(forResource: \"Init\", ofType: \"dat\")!\n\n        let string2 = appBundle.path(forResource: \"autostart\", ofType: \"type\")!\n\n        let string3 = (appBundle.path(forResource: \"data\", ofType: \"\") ?? \"\") + (\"/\")\n\n        mGLUTWindow = UnsafeRawPointer(cMethod(string3, string1, string2, \"ios\"))\n    }\n}\n</code></pre>\n\n<p>In Swift, when you pass <code>String</code> to an argument of type <code>char *</code>, Swift generates a temporary C-string buffer and pass the address of the buffer, you have no need to call something like <code>const char * string1Path = [string1 cStringUsingEncoding:[NSString defaultCStringEncoding]];</code>.</p>\n\n<p>If the <code>cMethod</code> keeps any of the pointers for later use, you may need a little more complicated code, but it is not clear that if we need such complicated code as for the current description.</p>\n"}], "owner": {"reputation": 854, "user_id": 6362677, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13be8d12cbcbc70c36fc66f7321d300d?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/6362677/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55623819, "answer_count": 2, "score": -2, "last_activity_date": 1554949729, "creation_date": 1554939891, "last_edit_date": 1554944227, "question_id": 55622764, "link": "https://stackoverflow.com/questions/55622764/convert-int8-to-unsafepointerint8", "title": "Convert Int8? to UnsafePointer&lt;Int8&gt;?", "body": "<p>I am very new to Swift. Trying to write a Swift app that calls an outside C method. However, the Xcode compiler is giving error about type conversion. The C method prototype is of the form:</p>\n\n<pre><code>void * cMethod(const char* string1Path, const char* string2Path, const char* string3Path, const char* string4Path);\n</code></pre>\n\n<p>The gist of the Swift code is: </p>\n\n<pre><code>import OpenGLES\nimport CoreGraphics\nimport GLKit\n\nvar mGLUTWindow: Void?\n\nclass myClass {\n\n    mGLUTWindow = nil\n    let appBundle = Bundle.main\n\n    let string1 = appBundle.path(forResource: \"Init\", ofType: \"dat\")\n    let string1Path = Int8((string1?.description)!)\n\n    let string2 = appBundle.path(forResource: \"autostart\", ofType: \"type\")\n    let string2Path = Int8((string2?.description)!)\n\n    let string3: String? = appBundle.path(forResource: \"data\", ofType: \"\") ?? \"\" + (\"/\")\n    let string3Path = Int8((string3?.description)!)\n\n    mGLUTWindow = cMethod(UnsafePointer(string3Path), string1Path, string2Path, \"ios\")\n}\n</code></pre>\n\n<p>The compiler gives the error:</p>\n\n<pre><code>Cannot convert value of type 'Int8?' to expected argument type 'UnsafePointer&lt;Int8&gt;?'\n</code></pre>\n\n<p>The C method is being brought in by a bridging header. Is there a way to convert this to the expected argument? </p>\n\n<p>NOTE: The Swift code here was brought over from an Objective-C file from several years ago and is being adapted to Swift. I used <a href=\"https://objectivec2swift.com/#/converter/code/\" rel=\"nofollow noreferrer\">this</a> Obj-C to Swift converter, as I barely understand Swift and cannot read Obj-C. The Obj-C lined I put in were of the form: </p>\n\n<pre><code>NSString * string1 = [[appBundle pathForResource:@\"data\" ofType:@\"\"] stringByAppendingString:@\"/\"]; \nconst char * string1Path = [string1 cStringUsingEncoding:[NSString defaultCStringEncoding]];\n</code></pre>\n"}, {"tags": ["c++", "c", "c++11", "visual-c++"], "comments": [{"owner": {"reputation": 289, "user_id": 11231203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/939d1b2bae675bce554d7b467bbf5947?s=128&d=identicon&r=PG&f=1", "display_name": "Tetix", "link": "https://stackoverflow.com/users/11231203/tetix"}, "edited": false, "score": 5, "creation_date": 1554939341, "post_id": 55622688, "comment_id": 97938301, "body": "Someone wants to bot in a game :)"}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1554939681, "post_id": 55622688, "comment_id": 97938380, "body": "<a href=\"https://github.com/Brandon-T/CMML/blob/master/src/finder.c#L170\" rel=\"nofollow noreferrer\">github.com/Brandon-T/CMML/blob/master/src/finder.c#L170</a> &amp;&amp; <a href=\"https://github.com/Brandon-T/CMML/blob/master/src/finder.c#L252\" rel=\"nofollow noreferrer\">github.com/Brandon-T/CMML/blob/master/src/finder.c#L252</a> which uses pythagorean theorem to determine if colours are similar or equal in rgb or hsl space.."}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1554939681, "post_id": 55622688, "comment_id": 97938381, "body": "Using what graphics library/platform?"}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1554940039, "post_id": 55622688, "comment_id": 97938458, "body": "<a href=\"https://en.wikipedia.org/wiki/Color_difference\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Color_difference</a> since no two colours will be exact on each graphics device/card or through software.. ie: in a game.."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1554940520, "post_id": 55622688, "comment_id": 97938548, "body": "When the machines rise up we&#39;ll really regret all of those aim-bots."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11343216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae33f634b6786ca6b7168a917306b02b?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Mendoza", "link": "https://stackoverflow.com/users/11343216/martin-mendoza"}, "edited": false, "score": 0, "creation_date": 1555052594, "post_id": 55622955, "comment_id": 97981679, "body": "Thank you very much for this information. This is exactly what I was looking for, now I can figure it out."}], "tags": [], "owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "is_accepted": false, "score": 2, "last_activity_date": 1554941579, "creation_date": 1554941579, "answer_id": 55622955, "question_id": 55622688, "link": "https://stackoverflow.com/questions/55622688/what-is-the-fastest-way-to-detect-a-certain-color-on-a-specific-pixel-and-send-a/55622955#55622955", "title": "What is the fastest way to detect a certain color on a specific pixel and send a click once detected?", "body": "<p>First you have to know colour theory and how to detect whether two colours are the \"same\" or \"similar\" (different filters will have different outcomes too).. then you'll have to know what image formats you wish to parse into raw RGB pixels.</p>\n\n<p>Finally, you'll compare the colours in the image to the colours you want to find..</p>\n\n<p>First.. Colour similarity is measured with Euclidean distance or \"Pythagorean distance\" given as: </p>\n\n<p><code>distance = squareRoot(of: abs(r1^2 - r2^2) + abs(g1^2 - g2^2) + abs(b1^2 - b2^2))</code></p>\n\n<p>where r1g1b1 is the first colours and r2g2b2 is the second colour in RGB space..\nThen you compare that distance to some tolerance.. IE some threshold that you're okay with as an angle of error..</p>\n\n<p>For example the colour white.. 16777215 as a UInt is the same as 255, 255, 255 in RGB..</p>\n\n<p>Then there is 16777214 as a UInt is the same as 255, 255, 254..</p>\n\n<p>the two colours are white to the eye and extremely similar to the human eye but to the computer they are different! Therefore you use the formula and you compare the distance to some tolerance let's say \"10\".. why? because if the distance is 0, the colours are an exact match. If not, then you know they are not perfect, but they may be similar depending on how much of a threshold you're willing to accept.. That is what the distance represents. Otherwise compare for exact matches by comparing the bytes.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Color_difference\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Color_difference</a></p>\n\n<p>Now, you don't have to do it in RGB space.. you can use HSL and XYZ and CIELAB, etc.. at the end of the day, it will be fairly similar results.</p>\n\n<p>I have written code that does exactly that: <a href=\"https://github.com/Brandon-T/CMML/blob/master/src/finder.c#L252\" rel=\"nofollow noreferrer\">https://github.com/Brandon-T/CMML/blob/master/src/finder.c#L252</a></p>\n\n<p>and <a href=\"https://github.com/Brandon-T/CMML/blob/master/src/finder.c#L30\" rel=\"nofollow noreferrer\">https://github.com/Brandon-T/CMML/blob/master/src/finder.c#L30</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"bitmap.h\"\n#include \"finder.h\"\n\nvoid TestOne(CTSInfo* info)\n{\n    rgb32 colour = {144, 240, 255, 0};\n    PointArray pts;\n    initPointArray(&amp;pts);\n\n    if (findColours(info, &amp;pts, &amp;colour, 0, 0, info-&gt;targetImage-&gt;width, info-&gt;targetImage-&gt;height))\n    {\n        Point *p = pts.p;\n        int I = 0;\n        for (; I &lt; pts.size; ++I, ++p)\n            printf(\"Colour found at: (%d, %d)\\n\", p-&gt;x, p-&gt;y);\n    }\n\n    freePointArray(&amp;pts);\n}\n\nvoid TestTwo(CTSInfo* info, bitmap* bmp_to_find)\n{\n    int x, y;\n\n    if (findImageToleranceIn(info, bmp_to_find, &amp;x, &amp;y, 0, 0, info-&gt;targetImage-&gt;width, info-&gt;targetImage-&gt;height, 0))\n    {\n        printf(\"Image found at: (%d, %d)\\n\", x, y);\n    }\n}\n\nint main()\n{\n    CTSInfo info = {0};\n    bitmap bmp_to_find = {0};\n    bitmap bmp_target = {0};\n\n    defaultCTS(&amp;info);\n    bitmap_from_file(&amp;bmp_to_find, \"C:/Users/Brandon/Desktop/find.bmp\");\n    bitmap_from_file(&amp;bmp_target, \"C:/Users/Brandon/Desktop/target.bmp\");\n    info.targetImage = &amp;bmp_target;\n\n\n\n    TestOne(&amp;info);\n    printf(\"\\n\");\n\n    TestTwo(&amp;info, &amp;bmp_to_find);\n    printf(\"\\n\");\n\n\n    freebmp(&amp;bmp_to_find);\n    freebmp(&amp;bmp_target);\n    return 0;\n}\n</code></pre>\n\n<p>If you are planning on doing this in pure C++ you might have a harder time as you'll either have to learn X11 or WinAPI to get screenshots from windows/games to detect colours within.. The best program I know that does this is located at: <a href=\"https://villavu.com/forum\" rel=\"nofollow noreferrer\">https://villavu.com/forum</a> and it's called \"Simba\". It's written in Pascal and is used to bot Runescape with colours. It's quite successful and I've used it myself.</p>\n\n<p>Someone there wrote a tutorial on CTS (Colour Tolerance Space): <a href=\"https://villavu.com/forum/showthread.php?t=74908\" rel=\"nofollow noreferrer\">https://villavu.com/forum/showthread.php?t=74908</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11343216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae33f634b6786ca6b7168a917306b02b?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Mendoza", "link": "https://stackoverflow.com/users/11343216/martin-mendoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1554941579, "creation_date": 1554939261, "question_id": 55622688, "link": "https://stackoverflow.com/questions/55622688/what-is-the-fastest-way-to-detect-a-certain-color-on-a-specific-pixel-and-send-a", "title": "What is the fastest way to detect a certain color on a specific pixel and send a click once detected?", "body": "<p>Not sure if this code has already been uploaded since I haven't able to find one. I have more experience reading code than writing it so any help is appreciated.</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1554939948, "post_id": 55622634, "comment_id": 97938439, "body": "Lots of problems here.  You are calling <code>dmalloc</code>, then immediately discarding the result.  This is done in many places.  E.g. <code>p = dmalloc(...);</code> followed immediately by <code>p = (something else);</code>  So the first value of <code>p</code> is permanently lost (memory leak), and the <code>dmalloc</code> call serves no purpose."}, {"owner": {"reputation": 11, "user_id": 10339336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a6657f6d06f50ad6ea4545a46c3eca3?s=128&d=identicon&r=PG&f=1", "display_name": "Mentaltrain", "link": "https://stackoverflow.com/users/10339336/mentaltrain"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1554940117, "post_id": 55622634, "comment_id": 97938470, "body": "How do I store the a value to something else without memory leaking?"}, {"owner": {"reputation": 11, "user_id": 10339336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a6657f6d06f50ad6ea4545a46c3eca3?s=128&d=identicon&r=PG&f=1", "display_name": "Mentaltrain", "link": "https://stackoverflow.com/users/10339336/mentaltrain"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1554940211, "post_id": 55622634, "comment_id": 97938488, "body": "should I just get rid of the dmalloc?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554941758, "post_id": 55622634, "comment_id": 97938812, "body": "Only if you immediately assign a different value to the variable, like in <code>addfront</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554942029, "post_id": 55622634, "comment_id": 97938856, "body": "The error indicates that you&#39;re using an uninitialized value of <code>foodNode.data</code>, or maybe you&#39;ve dereferenced an incorrect pointer and overwrite that <code>data</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1554942101, "post_id": 55622634, "comment_id": 97938873, "body": "Why are you calling <code>dmalloc</code> in the first place?  If you need dynamically allocated memory, then you need to save the result of <code>dmalloc</code> and actually <i>use</i> it someplace (which you aren&#39;t).  If you don&#39;t, then sure, remove them all."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554943192, "post_id": 55622634, "comment_id": 97939076, "body": "NEVER <code>#include</code> a *.c file.  Rather, compile it separately into an object file.  then use the <code>link</code> step to combine all the object files into an executable."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554943427, "post_id": 55622634, "comment_id": 97939135, "body": "when compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  Note: other compilers use different options to produce the same thing"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554943639, "post_id": 55622634, "comment_id": 97939176, "body": "regarding: <code>sscanf(l,&quot;%s&quot;,&amp;l);</code>  the array <code>l</code> (terrible name for an array) when referenced ,alone, results in <code>char*</code> of the address of the first byte of the array.  However, <code>&amp;l</code>  results in a type: <code>char (*)[20]</code> which is not correct"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554943884, "post_id": 55622634, "comment_id": 97939227, "body": "regarding the function signature: <code>orderList *createItem()</code>  this indicates that the function returns a pointer to a &#39;orderList&#39; however, the body of the function returns nothing. And where it is called does not expect a returned value,  Suggest changing the signature to: <code>void createitem()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554943982, "post_id": 55622634, "comment_id": 97939242, "body": "regarding: <code>orderList *createItem();</code> in the header file;   this says that the parameter list can be anything.  That is not what you want,  Suggest: <code>orderList *createItem( void );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554944200, "post_id": 55622634, "comment_id": 97939291, "body": "Note: since the function: <code>createItem()</code> does not return the created item AND the caller to this function does not check for a returned value, either the logic is wrong or this function can be removed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554944387, "post_id": 55622634, "comment_id": 97939317, "body": "regarding this kind of statement: <code>printf(&quot;memory allocation failed\\n&quot;);</code>  1) Error messages should be output to <code>stderr</code>, not <code>stdout</code>.   2) when an error indication is from a C library function, should also output the text reason the system thinks the function failed.  The function: <code>perror()</code> outputs both your error message and the text reason the system thinks the error occurred to <code>stderr</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554944476, "post_id": 55622634, "comment_id": 97939337, "body": "this statement: <code>exit(1);</code> in function: <code>dmalloc()</code> will result in a unrecoverable memory leak.  Before calling <code>exit()</code>, the code needs to pass all the pointers to allocated memory to <code>free()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554944639, "post_id": 55622634, "comment_id": 97939367, "body": "in function: <code>strcmpi()</code>, this statement: ` while (*s &amp;&amp; tolower(*s) == tolower(*t))` has the logic error of (possibly) comparing past the end of the char array pointed to by <code>t</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554944778, "post_id": 55622634, "comment_id": 97939401, "body": "regarding: <code>p = (foodNode*)dmalloc(sizeof(foodNode));</code>  The returned type from <code>dmalloc()</code> is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc  Suggest removing the cast"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554944980, "post_id": 55622634, "comment_id": 97939435, "body": "OT: function names should indicate what they do, preferably with an action verb, like <code>get&#47;set&#47;calc&#47;etc</code>  function names like: <code>function2()</code> are meaningless, even in the current context"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554945294, "post_id": 55622634, "comment_id": 97939499, "body": "OT: regarding this kind of statement: <code>typedef struct _foodNode</code>  in C, names starting with an underscore are &#39;reserved&#39; for the environment.  Strongly suggest removing all those leading underscores"}], "owner": {"reputation": 11, "user_id": 10339336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a6657f6d06f50ad6ea4545a46c3eca3?s=128&d=identicon&r=PG&f=1", "display_name": "Mentaltrain", "link": "https://stackoverflow.com/users/10339336/mentaltrain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554941593, "creation_date": 1554938836, "last_edit_date": 1554941593, "question_id": 55622634, "link": "https://stackoverflow.com/questions/55622634/seg-fault-at-memory-that-is-already-there", "title": "seg fault at memory that is already there", "body": "<p>So I just started using valgrind and having a hard time figuring out what all the different errors are and what number means. \nfor example I am getting a seg fault at this line. ( I know this not because valgrind shown me but me just putting each line by line back into my and check it until it seg faults when running my program * which in function2 in my code)</p>\n\n<pre><code> int what = t-&gt;count; \n</code></pre>\n\n<p>Its trying to pull memory from my int count in my struct orderlist, and I know that I inputed it beforehand. I don't know why I cant pull it out.\ncan some tell me what valgrind is trying to tell me?</p>\n\n<p>I have tried making sure the program doesnt seg fault anywhere else.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include \"orderList_ccarver4_211.c\"\n\nvoid selectChoice();\nvoid function1();\nvoid function2();\n\ntypedef struct _robotOrder\n{\n    unsigned char robotNum;\n    orderList *data;\n    char *deliverTo;\n    char *restaurant;\n    struct _robotOrder *next;\n} robotOrder;\n\nrobotOrder *deliveryList; /* the head of linked list of robotOrders */\nrobotOrder *addfront(robotOrder *head, robotOrder *value);\n\nint main(void){\n    deliveryList = (robotOrder*)dmalloc(sizeof(robotOrder)); /* the head of linked list of robotOrders */\n\n    selectChoice(); /* choice menu function*/\n\n    return 0;\n}\n\nvoid selectChoice()\n{\n    int T = 1;\n    char line[4];\n    char c;\n    do{\n        printf(\" New delivery order? (y/n) \"); /* get users choice*/\n        fgets(line, sizeof(line), stdin);\n        c = line[0];\n\n        printf(\"yo this is it = %c\\n\", c);\n\n        switch (c)\n        {\n        case 'y':\n            function1();\n            break;\n        case 'n':\n            printf(\"here\");\n            function2();\n            break;\n        default:\n            printf(\"Invalid Input. Try again\\n\");\n\n        }\n    } while(T &gt; 0);\n}\n\nrobotOrder* addfront(robotOrder *head, robotOrder *value) /* function that adds to the list in the front */\n{\n    robotOrder *p,*q;\n    p = (robotOrder*)dmalloc(sizeof(robotOrder));\n    q = (robotOrder*)dmalloc(sizeof(robotOrder));\n    p = head;\n    q = value;\n    q-&gt;next= p;\n    return (q);\n}\n\nvoid function1(){\n\n    robotOrder *or = (robotOrder*)dmalloc(sizeof(robotOrder)); /* makes a new robot order */\n\n    char string[5];\n    int num;\n    printf(\"Task Robot Number: \"); /* gets the num of the robot*/\n    fgets(string, 4, stdin);\n    num = atoi(string);\n    or-&gt;robotNum = num;\n\n    char *line;\n    line=(char*)malloc(30*sizeof(char));\n    printf(\"Delivery Address for new delivery order: \"); /* gets the address*/\n    fgets(line,sizeof(line), stdin);\n    sscanf(line,\"%s\",&amp;line);\n    or-&gt;deliverTo = line;\n\n\n    char *lines;\n    lines=(char*)malloc(30*sizeof(char));\n    printf(\"Restaurant from which to pick up food: \"); /* gets the name of the restaurant*/\n    fgets(lines,sizeof(lines), stdin);\n    sscanf(lines,\"%s\",&amp;lines);\n    or-&gt;restaurant = lines;\n\n    int loop = 0;\n    char l[20];\n    createItem();\n    orderList *p = (orderList*)dmalloc(sizeof(orderList));\n    int s = 0;\n    while(loop == 0){\n        printf(\"food item: \"); /* keeps asking for food items*/\n        fgets(l,sizeof(l), stdin);\n        sscanf(l,\"%s\",&amp;l);\n        if(l[0] == '\\n'){\n            loop = 1; /* ends the loop if there wasnt any input */\n        }\n        if(l[0] != '\\n'){\n            s = s + insert(l, p); /* takes in the orderlist that in the robotorder */\n        }\n    }\n    p-&gt;count = s;\n    or-&gt;data = p; /* sets the orderlist to the robotOrder */\n\n    deliveryList = addfront(deliveryList, or); /* add the node to the end of the list */\n\n}\n\nvoid function2(){\n    printf(\"hello ?\");\n    robotOrder *p = (robotOrder*)dmalloc(sizeof(robotOrder));\n    p = deliveryList;\n    orderList *t = (orderList*)dmalloc(sizeof(orderList));\n    while(p != NULL){ /* prints out info of the deliveries */\n        t = p-&gt;data;\n        int what = t-&gt;count;\n        printf(\"Robot %d: Delivery order from %s has %d food item(s)\", p-&gt;robotNum, p-&gt;restaurant,what);\n        p = p-&gt;next;\n\n        printf(\"\\n\");\n    }\n    printf(\"goodbye\");\n    exit(0); /* exit program */\n}\n</code></pre>\n\n<p>orderList c file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include \"orderList_ccarver4_211.h\"\n\norderList *createItem(){\n    orderList *lis = (orderList*)dmalloc(sizeof(orderList));\n    lis-&gt;count = 0;\n    lis-&gt;head = NULL;\n}\n\nint insert(char *str, orderList *s){\n    foodNode *h;\n    h = (foodNode*)dmalloc(sizeof(foodNode));\n    h = s-&gt;head;\n    int len = s-&gt;count;\n\n\n    foodNode *q;\n    q = (foodNode*)dmalloc(sizeof(foodNode)); /* makes new node */\n    q-&gt;data = str;\n\n    if(s-&gt;head == NULL){\n        h=q;\n        s-&gt;head = q;\n        len++;\n        s-&gt;count = len;\n        return 1;\n    }\n    char *str2 = h-&gt;data; /* grabs the data*/\n    int com = strcmpi(str, str2);\n    while(h != NULL) {\n        if(h-&gt;next == NULL){\n            h-&gt;next = q;\n            len++;\n            s-&gt;count = len;\n            return 1;\n        }\n        h = h-&gt;next;\n    }\n    return 0;\n}\n\nvoid printItems(orderList *s){\n    foodNode *p;\n    p = (foodNode*)dmalloc(sizeof(foodNode));\n    p = s-&gt;head;\n    while(p != NULL){\n        printf(\"%s\", p-&gt;data);\n        p = p-&gt;next;\n    }\n}\n\n/* compares strings for alphabetical ordering */\nint strcmpi(char *s, char *t)\n{\n    while (*s &amp;&amp; tolower(*s) == tolower(*t))\n    {\n        s++;\n        t++;\n    }\n    return tolower(*s) - tolower(*t);\n}\n\n/* allocates memory with a check for successful allocation */\nvoid *dmalloc(size_t size)\n{\n    void *p = malloc(size);\n    if (!p)\n    {\n        printf(\"memory allocation failed\\n\");\n        exit(1);\n    }\n    return p;\n} \n</code></pre>\n\n<p>orderList h file</p>\n\n<pre><code>#ifndef ORDERLIST_CCARVER4_211_H\n#define ORDERLIST_CCARVER4_211_H\n\ntypedef struct _foodNode\n{\n   char *data;  // Food Item Names\n   struct _foodNode *next;\n} foodNode;\n\ntypedef struct _orderList\n{\n   foodNode *head;  // Pointer to first food item for the order (alphabetical)\n   int count;   // Number of food items in the order\n} orderList;\n\norderList *createItem();\nint insert(char *str, orderList *s);\nvoid printItems(orderList *s);\nint strcmpi(char *s, char *t);\nvoid *dmalloc(size_t size);\n\n#endif\n</code></pre>\n\n<p>This is what valgrind gave me, What does read of size 1 mean and where should I be looking?</p>\n\n<blockquote>\n  <p>==1612== Invalid read of size 1<br>\n  ==1612==    at 0x4E81EF9: vfprintf (vfprintf.c:1635)<br>\n  ==1612==    by 0x4E88328: printf (printf.c:34)<br>\n  ==1612==    by 0x400D5E: function2 (Project3_ccarver4_211.c:127)<br>\n  ==1612==    by 0x400A9C: selectChoice (Project3_ccarver4_211.c:50)<br>\n  ==1612==    by 0x400A10: main (Project3_ccarver4_211.c:26)<br>\n  ==1612==  Address 0x61646e6170 is not stack'd, malloc'd or (recently) free'd<br>\n  ==1612==<br>\n  ==1612==<br>\n  ==1612== Process terminating with default action of signal 11 (SIGSEGV)<br>\n  ==1612==  Access not within mapped region at address 0x61646E6170<br>\n  ==1612==    at 0x4E81EF9: vfprintf (vfprintf.c:1635)<br>\n  ==1612==    by 0x4E88328: printf (printf.c:34)<br>\n  ==1612==    by 0x400D5E: function2 (Project3_ccarver4_211.c:127)<br>\n  ==1612==    by 0x400A9C: selectChoice (Project3_ccarver4_211.c:50)<br>\n  ==1612==    by 0x400A10: main (Project3_ccarver4_211.c:26)<br>\n  ==1612==  If you believe this happened as a result of a stack<br>\n  ==1612==  overflow in your program's main thread (unlikely but<br>\n  ==1612==  possible), you can try to increase the size of the<br>\n  ==1612==  main thread stack using the --main-stacksize= flag.<br>\n  ==1612==  The main thread stack size used in this run was 8388608.<br>\n  herehello ?Robot 27: Delivery order from ==1612==<br></p>\n</blockquote>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 3, "creation_date": 1554938303, "post_id": 55622547, "comment_id": 97938060, "body": "You can&#39;t do this. <code>&quot;cat&quot;</code> is a string literal, not a string. You cannot assign a new value to it, any more than you could do <code>4 = 5;</code>"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554938530, "post_id": 55622547, "comment_id": 97938108, "body": "Assuming <code>&quot;cat&quot;</code> was actually a pointer to a writable char array and not a string literal, that would set the first two elements to <code>&#39;d&#39;</code> and <code>&#39;o&#39;</code> and stop. Don&#39;t use <code>strncpy()</code>."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 1, "creation_date": 1554961358, "post_id": 55622547, "comment_id": 97942996, "body": "Why would you use that function at all?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11317494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rf-L5DYMSbg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr0opp4kYPGHfIlbEA8bQKl1yx0w/mo/photo.jpg?sz=128", "display_name": "Snowflake", "link": "https://stackoverflow.com/users/11317494/snowflake"}, "edited": false, "score": 0, "creation_date": 1554968035, "post_id": 55622771, "comment_id": 97945859, "body": "I have to use it for college, I am also not hapoy about that I have to use it"}], "tags": [], "owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "is_accepted": false, "score": 0, "last_activity_date": 1554940707, "last_edit_date": 1554940707, "creation_date": 1554939953, "answer_id": 55622771, "question_id": 55622547, "link": "https://stackoverflow.com/questions/55622547/example-for-strncpy/55622771#55622771", "title": "Example for strncpy()", "body": "<p>When you write out a string like <code>\"cat\"</code> or <code>\"dog\"</code> in c, the arrays cannot be changed, if you try it will result in undefined behavior. You can only use these if a function expects <code>const char * input</code>, <code>const</code> is telling you that it cannot/will not be changed in the function. When you write <code>\"dog\"</code> the data in the character array will look something like this:</p>\n\n<pre><code>{'d','o','g','\\0'}\n</code></pre>\n\n<p>Notice it is NUL terminated.</p>\n\n<p>The function you are using:</p>\n\n<pre><code>char *strncpy(char *dest, const char *src, size_t n)\n</code></pre>\n\n<p>Copies <code>src</code> to <code>dst</code> with a maximum length of <code>n</code> you cannot copy into <code>\"cat\"</code> as mentioned above, you can see <code>char *dest</code> is not constant but <code>const char * src</code> is constant. So the source could be <code>\"cat\"</code> or <code>\"dog\"</code></p>\n\n<p>If you were to allocate space for the string you are allowed to modify it:</p>\n\n<pre><code>char cat_str[] = \"cat\";\n</code></pre>\n\n<p>now the character array <code>cat_str</code> is initialized to <code>\"cat\"</code> but we can alway change it, note its length will be 4 (one for each letter plus a NUL) because we did not specify the length. So be sure to not change anything past cat_str[3], you can index it by 0 to 3</p>\n"}, {"tags": [], "owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "is_accepted": false, "score": 0, "last_activity_date": 1554940189, "creation_date": 1554940189, "answer_id": 55622799, "question_id": 55622547, "link": "https://stackoverflow.com/questions/55622547/example-for-strncpy/55622799#55622799", "title": "Example for strncpy()", "body": "<p>As torstenvl mentioned, <code>\"cat\"</code> and <code>\"dog\"</code> are string literals, so you're not using the function correctly here. The first parameter is the destination, the second parameter is the source, and the third parameter is the number of bytes to copy.</p>\n\n<pre><code>char *strncpy(char *restrict s1, const char *restrict s2, size_t n)\n</code></pre>\n\n<blockquote>\n  <p>Source: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strncpy.html#top\" rel=\"nofollow noreferrer\">The Open Group Base Specification - strncpy</a></p>\n</blockquote>\n\n<p>To answer your specific question: yes; the null terminator is copied to the destination string. <code>n</code> bytes are written, and if your source string <code>s2</code> is shorter than <code>n</code> bytes, <code>NULL</code> is filled in until <code>n</code> bytes are written.</p>\n\n<p>In your question, it looks like you're trying to append the two strings. To do this in C, you need to first allocate a source string buffer, copy the first string over, then copy the second string, starting from the end of the second string. Depending on where you start the last step, you can end up with either \"catdog\\0\" or \"cat\\0dog\\0\". This is another example of the quintessential \"off by one\" errors.</p>\n\n<p>To start, you have to calculate the length of the two strings you want to append. You can do this using <code>strlen</code>, from <code>string.h</code>. <code>strlen</code> does <strong>not</strong> count the null-terminator as part of the length, so remember that to get the length of the final string, you'll have to do <code>strlen(s1) + strlen(s2) + 1</code>.</p>\n\n<p>You can then copy the first string over as you normally would. An easy way to do the second copy is to do this:</p>\n\n<pre><code>char* s2start = finalString[strlen(s1) + 1];\n</code></pre>\n\n<p>You can then do <code>strncpy(s2start, s2, [the size of s2])</code> and that way you know you're starting right on the s1 null terminator, avoiding the \"cat\\0dog\" error.</p>\n\n<p>Hope this helps, good luck.</p>\n"}, {"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 0, "last_activity_date": 1554961205, "creation_date": 1554961205, "answer_id": 55625427, "question_id": 55622547, "link": "https://stackoverflow.com/questions/55622547/example-for-strncpy/55625427#55625427", "title": "Example for strncpy()", "body": "<p>You should not use the <code>strncpy</code> and <code>strncat</code> functions at all.</p>\n\n<p>Their names start with <code>str</code>, but they do not really work with strings. In C, a string is defined as \"a character sequence terminated by <code>'\\0'</code>\". These functions do not guarantee that the resulting character array is always null-terminated.</p>\n\n<p>The better alternatives are <code>strlcpy</code> and <code>strlcat</code>, but these are not available everywhere.</p>\n\n<p>Even better would be a separate string library in which determining the length of a string were a constant-time operation. But that gets distracting.</p>\n"}], "owner": {"reputation": 37, "user_id": 11317494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rf-L5DYMSbg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr0opp4kYPGHfIlbEA8bQKl1yx0w/mo/photo.jpg?sz=128", "display_name": "Snowflake", "link": "https://stackoverflow.com/users/11317494/snowflake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1554961205, "creation_date": 1554938099, "last_edit_date": 1554960624, "question_id": 55622547, "link": "https://stackoverflow.com/questions/55622547/example-for-strncpy", "title": "Example for strncpy()", "body": "<p>If I would use the <code>strncpy</code> function for the strings <code>cat</code> and <code>dog</code>. I don't understand if the <code>\\0</code> character is counted in or not, so I would like to know if the end result will be <code>catdo</code>? or would it be something like <code>cat\\0do</code></p>\n\n<p><code>strncpy(\"cat\", \"dog\", 2);</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1554937103, "post_id": 55622377, "comment_id": 97937763, "body": "Please provide the exact exit code and message it emits."}, {"owner": {"reputation": 1278, "user_id": 9057499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PvHd7.jpg?s=128&g=1", "display_name": "Arnaud Peralta", "link": "https://stackoverflow.com/users/9057499/arnaud-peralta"}, "edited": false, "score": 1, "creation_date": 1554937233, "post_id": 55622377, "comment_id": 97937793, "body": "You really need to format your code. It will be better for you and us."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1554937234, "post_id": 55622377, "comment_id": 97937794, "body": "Both <code>sizeof(*ptr1)</code> and <code>sizeof(*ptr2)</code> are constants.  Specifically, they are both equal to <code>sizeof(int)</code>.  So that test is always true."}, {"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1554937266, "post_id": 55622377, "comment_id": 97937804, "body": "Additionally, you cannot use <code>%d</code> to print an array. Arrays are not of type <code>int</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10643054"}, "reply_to_user": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1554937541, "post_id": 55622377, "comment_id": 97937892, "body": "@torstenvl exit code for process is -1073741819 (0xC0000005)"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1554938839, "post_id": 55622377, "comment_id": 97938174, "body": "<code>for(int i = 0; i &lt;= MAXIMUM; i++) arrayOne[i] = i;</code> &lt;&lt;--  (and<code>sum</code>  is uninitialized in <code>sumarrays()</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 0, "creation_date": 1554939205, "post_id": 55622643, "comment_id": 97938264, "body": "Happy to help, please look over and if you are unclear why something was changed or what is happening ask here"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 0, "creation_date": 1554939316, "post_id": 55622643, "comment_id": 97938293, "body": "I did not compile or test so there could be problems"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10643054"}, "edited": false, "score": 0, "creation_date": 1554939542, "post_id": 55622643, "comment_id": 97938358, "body": "Liam, question. How does that ARRAY_SZ macro work, exactly? It&#39;s brilliant, but I&#39;m not exactly sure how to explain. Is it the same thing as taking 1000/1 ?"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 0, "creation_date": 1554940307, "post_id": 55622643, "comment_id": 97938508, "body": "First of all it is not my invention, it&#39;s very popular. <code>sizeof(arr)</code> is the total number of bytes in the array, in your case <code>1000 * sizeof(int)</code> because you have 1000 integers, integers are often 4 bytes long (machine dependant). <code>sizeof(arr[0])</code> is the size of the first element in the array, in you case an integer. So if you divide the size of the total array by the size of each element you get the number of elements"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 1, "creation_date": 1554940393, "post_id": 55622643, "comment_id": 97938525, "body": "Assuming an integer is 4 bytes you are doing <code>4000&#47;4</code>"}], "tags": [], "owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "is_accepted": true, "score": 0, "last_activity_date": 1554938927, "creation_date": 1554938927, "answer_id": 55622643, "question_id": 55622377, "link": "https://stackoverflow.com/questions/55622377/why-does-my-addarrays-function-get-a-wedge-exit-compile-code-update-fixed/55622643#55622643", "title": "Why does my addArrays function get a wedge exit compile code? (UPDATE FIXED)", "body": "<p>Here are some notes:</p>\n\n<p>When you assign/pass/print the and array using the name of the array, you are actually passing the memory location of the first element in the array (a pointer).So when you write:</p>\n\n<pre><code>printf(\"Arrayone %d\\n\", arrayOne);\n</code></pre>\n\n<p>You will see the memory address of the first element of the array being printed. If you would like to print the entire array you will need to loop through it. In this case you would be printing 1000 integers which might be undesirable. </p>\n\n<pre><code>void printArray(int * array, size_t len)\n{\n    while(len--)\n    {\n        printf(\"%d \", *array++);\n    }\n}\n</code></pre>\n\n<p>To get the number of elements in an array you can do something like this:</p>\n\n<pre><code>sizeof(arrayOne) / sizeof(arrayOne[0])\n</code></pre>\n\n<p>and you can put it in a macro like this:</p>\n\n<pre><code>#define ARRAY_SZ(x)  (sizeof(x) / sizeof((x)[0]))\n</code></pre>\n\n<p>and call it like this:</p>\n\n<pre><code>ARRAY_SZ(arrayOne);\n</code></pre>\n\n<p>You cannot get the array size if you are receiving an array in a function (it has decayed to a pointer), instead you should pass the array size to the function too. Here because you initialize the arrays with the size <code>MAXIMUM</code> we don't actually need to calculate the array size, but we can just to show it works.</p>\n\n<p>If you want to return an array (like in <code>addArrays()</code>) you should create an empty array and pass it to the function, then the function can update the array with the result.</p>\n\n<p>When looping through an array you never want to do <code>array[maximum]</code> because the array indices range from <code>0</code> to <code>maximum - 1</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXIMUM 1000\n\n#define ARRAY_SZ(x)  (sizeof(x) / sizeof((x)[0]))\n\nint sumArrays(int arr1[], int arr2[]);\nint addArrays(int arr1[], int arr2[]); \n\nint main()\n{\n    int arrayOne[MAXIMUM]; \n    int arrayTwo[MAXIMUM];\n    int arrayThree[MAXIMUM];\n\n    for(int i = 0; i &lt; MAXIMUM; i++)\n       arrayOne[i] = i;\n\n    printf(\"Array one size %d\\n\", ARRAY_SZ(arrayOne));\n\n    for(int j = 0; j &lt; MAXIMUM; j++) \n          arrayTwo[j] = j;  \n    printf(\"Array Two size %d\\n\", ARRAY_SZ(arrayTwo));\n\n    printf(\" The sum of the arrays is : %d\\n\",sumArrays(arrayOne, arrayTwo, ARRAY_SZ(arrayOne)));\n    addArrays(arrayOne, arrayTwo, arrayThree, MAXIMUM);\n    return 0;\n}\n\nint sumArrays(int arr1[],int arr2[], size_t len)\n{\n    int *ptr_1; \n    int *ptr_2;\n\n    ptr_1 = &amp;arr1[0]; \n    ptr_2 = &amp;arr2[0];\n\n    int sum; \n\n    for(int i = 0; i &lt; len; i++){\n        sum += *ptr_1 + i;\n        sum += *ptr_2 + i; \n    } \n\n    return sum; \n}\n\nvoid addArrays(int arr1[], int arr2[], int result[], size_t len){\n\n   int *ptr1 = arr1;\n   int *ptr2 = arr2; \n   int sum = 0; \n   int i = 0;\n\n   for(int i = 0; i &lt; len; i++){\n      sum = *ptr1 +i;\n      sum += *ptr2 +i;   \n      result[i] = sum;\n   }\n\n }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10643054"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 1, "accepted_answer_id": 55622643, "answer_count": 1, "score": -3, "last_activity_date": 1554940599, "creation_date": 1554936794, "last_edit_date": 1554940599, "question_id": 55622377, "link": "https://stackoverflow.com/questions/55622377/why-does-my-addarrays-function-get-a-wedge-exit-compile-code-update-fixed", "title": "Why does my addArrays function get a wedge exit compile code? (UPDATE FIXED)", "body": "<p>The rest of my functions work fabulously, however the last function has my goat. The goal of this function is to use pointers to obtain the values of two different arrays and add those values to a third array. However, when I run the main method to make the function run, it pauses for a second and provides a wedge exit code that does not work. </p>\n\n<p>I've tried removing the if((sizeof(*ptr1)) == (sizeof(*ptr2)){\n---insert code here---\n}</p>\n\n<p>from the for loop, however, the problem seems to be just the for loop itself. </p>\n\n<pre><code>//===================================Broken Code========================================\n#include &lt;stdio.h&gt;\n#define MAXIMUM 1000\n\n\nint sumArrays(int arr1[], int arr2[]);\nint addArrays(int arr1[], int arr2[]); \n\nint main()\n{\n\nint arrayOne[MAXIMUM]; \nint arrayTwo[MAXIMUM];\n\nfor(int i = 0; i &lt;= MAXIMUM; i++)\n\n   arrayOne[i] = i;\n\nprintf(\"Arrayone %d\\n\", arrayOne);\n\nfor(int j = 0; j &lt;= MAXIMUM; j++) \n\n      arrayTwo[j] = j;  \n\nprintf(\"ArrayTwo %d\\n\", arrayTwo);\n\nprintf(\" The sum of the arrays is : %d\\n\",sumArrays(arrayOne, arrayTwo));\n\nprintf(\"%d\", addArrays(arrayOne, arrayTwo));\n\nreturn 0;\n}\n\nint sumArrays(int arr1[],int arr2[]){\n\nint *ptr_1; \nint *ptr_2;\n\nptr_1 = &amp;arr1[0]; \nptr_2 = &amp;arr2[0];\n\nint sum; \n\nfor(int i = 0; i &lt; MAXIMUM; i++){\n\nsum += *ptr_1 + i;\nsum += *ptr_2 + i; \n\n} \n\nreturn sum; \n}\n\nint addArrays(int arr1[],int arr2[]){\n\nint *ptr1 = &amp;arr1[0];\nint *ptr2 = &amp;arr2[0]; \nint sum = 0; \nint i = 0; \nint arr3[0];\n\nif(sizeof(*ptr1) == sizeof(*ptr2)){\n\n   for(int i = 0; i &lt; MAXIMUM; i++){\n\n      sum += *ptr1 +i;\n      sum += *ptr2 +i;   \n      arr3[i] = sum;\n\n      }\n   }\n\n   printf(\"The value of array3 is %d\", arr3); \n }\n</code></pre>\n\n<p>The other function works perfectly, but the addArrays function does a wedge exit and doesn't cooperate.</p>\n\n<p>I expect the addArrays function to take the elements from each array, add them together and assign them to the third array.</p>\n\n<p>Thank you for your time.</p>\n\n<p><strong><em>UPDATE: WORKING CODE</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXIMUM 1000\n\n#define ARRAY_SZ(x) (sizeof(x) / sizeof((x)[0]))\n\n\nint sumArrays(int arr1[], int arr2[], size_t len);\nint addArrays(int arr1[], int arr2[], int arr3[], size_t len); \n\nint main()\n{\n\nint arrayOne[MAXIMUM]; \nint arrayTwo[MAXIMUM];\nint arrayThree[MAXIMUM];\n\nfor(int i = 0; i &lt;= MAXIMUM; i++)\n   arrayOne[i] = i;\n\nprintf(\"Array One %d\\n\", ARRAY_SZ(arrayOne));\n\nfor(int j = 0; j &lt;= MAXIMUM; j++) \n      arrayTwo[j] = j;  \nprintf(\"Array Two %d\\n\", ARRAY_SZ(arrayTwo));\n\nprintf(\" The sum of the arrays is : %d\\n\",sumArrays(arrayOne, arrayTwo, ARRAY_SZ(arrayOne)));\nprintf(\"%d\", addArrays(arrayOne, arrayTwo, arrayThree, MAXIMUM));\nreturn 0;\n}\n\nint sumArrays(int arr1[],int arr2[], size_t len){\n\nint *ptr_1; \nint *ptr_2;\n\nptr_1 = &amp;arr1[0]; \nptr_2 = &amp;arr2[0];\n\nint sum = 0 ; \n\nfor(int i = 0; i &lt; len; i++){\nsum += *ptr_1++;\nsum += *ptr_2++; \n} \n\nreturn sum; \n}\n\nint addArrays(int arr1[],int arr2[], int result[], size_t len){\n\n   int *ptr1 = &amp;arr1[0];\n      int *ptr2 = &amp;arr2[0];\n      int *ptr3 = &amp;result[0]; \n         int sum = 0;\n         int sum2 = 0; \n            int i = 0; \n\n\n\n   for(int i = 0; i &lt; MAXIMUM; i++){\n      sum = *ptr1 ++;\n      sum += *ptr2 ++;   \n      result[i] = sum;\n      printf(\"The result of array 3 is %d\\n\", *ptr3++);\n            }\n\n }\n</code></pre>\n"}, {"tags": ["c", "operating-system", "scheduled-tasks"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554937981, "post_id": 55622292, "comment_id": 97937987, "body": "Any I/O, any calls to &#39;sleep()`, etc etc etc will modify the order of the output,"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1554938255, "post_id": 55622292, "comment_id": 97938042, "body": "exactly what you mean by all those numbers is not quite clear."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1554938353, "post_id": 55622292, "comment_id": 97938075, "body": "stackoverflow is not a free coding service, not a free software design service.  Show us what you have tried and explain how its&#39; output differs from what you expected  I.E. post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it."}], "answers": [{"tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 0, "last_activity_date": 1554960935, "creation_date": 1554960935, "answer_id": 55625378, "question_id": 55622292, "link": "https://stackoverflow.com/questions/55622292/how-to-scheduling-the-processes/55625378#55625378", "title": "How to scheduling the processes", "body": "<p>Assume that there's time. At \"time=0\" you can figure out (for each scheduler, except round robin maybe) which process will be given CPU time first, then determine how much time it will run for (for each scheduler, including round robin), then draw a line on your Gantt chart showing how long the process used the CPU for. Then you'll have a new value for \"time\" (from when the first process stopped using CPU time, at the end of the line you just drew), so you'd repeat the same steps to figure out which process gets CPU time next and draw another line; and you'd keep doing this (for each scheduler) until all the processes have finished.</p>\n\n<p>You can/should try this on a piece of paper - like a rough draft. If you understand how each of the scheduling algorithms work it's not hard (and if you don't know how some of the scheduling algorithms work it's easy to find out - e.g. find a search engine and ...).</p>\n\n<p>The only problem that I can see is that the order that processes are given CPU time isn't specified for round robin. You could say that (for round robin) P1 gets CPU time first,  or P2 gets CPU time first, or ... I'd be tempted to assume they're given CPU time in numerical order (P1 gets CPU time first, then P2, then P3, ..); but I'd also state whatever assumption I made.</p>\n"}], "owner": {"reputation": 1, "user_id": 10586939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Q2qWucQ9rk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDxcKcMekGG6hmEAY0Qi-vdYFnbeg/mo/photo.jpg?sz=128", "display_name": "R. A", "link": "https://stackoverflow.com/users/10586939/r-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554960935, "creation_date": 1554936295, "question_id": 55622292, "link": "https://stackoverflow.com/questions/55622292/how-to-scheduling-the-processes", "title": "How to scheduling the processes", "body": "<p>I have problem with scheduling the processes homework and i need help.</p>\n\n<p>Process         P1    P2    P3     P4   P5\nService time    120   60    180    50   300</p>\n\n<pre><code>Draw a Gantt chart that shows the completion times for each process using \n</code></pre>\n\n<p>the following CPU scheduling: </p>\n\n<ol>\n<li><p>first-come, first served CPU</p></li>\n<li><p>shortest-job-first</p></li>\n<li><p>round-robin with a time slice of 60. </p>\n\n<p>Priority    Arrival Time        Service Time\nP0  1               3                  5\nP1  2               2                  6\nP2  1               4                  7\nP3  2               1                  3</p></li>\n<li><p>Draw a Gantt chart that shows the completion times for each process using each of the following CPU Scheduling Techniques (non-preemptive). Then Calculate the Average Waiting Time and the Average Turn Around Time for each Case.\na)  first-come, first served \nb)  Shortest-Job-First\nc)  Priority Scheduling\nd)  Round Robin Scheduling ( q = 5)</p></li>\n</ol>\n"}, {"tags": ["c", "unix", "fork"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1554936195, "post_id": 55622200, "comment_id": 97937555, "body": "It all hinges on the missing information \u2014 what the macro <code>W</code> is and then, maybe, what the values <code>A</code>, <code>B</code>, <code>C</code> represent.  This isn&#39;t an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) \u2014 it is missing key information, so it is sub-minimal and incomplete and hence unverifiable.   (Saying &quot;<code>W</code> means write, \u2026&quot; isn&#39;t helpful; we need to <i>see</i> how <code>W</code> is defined.  There are all sorts of interesting things that can be done wrong.)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1554936404, "post_id": 55622200, "comment_id": 97937593, "body": "It also isn&#39;t entirely clear what you&#39;re asking.  Are you asking what the output will be, or can be?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1554936785, "post_id": 55622200, "comment_id": 97937683, "body": "As written, the code does not compile.  You&#39;ve omitted the definition of W.  You get different results depending on whether you have <code>#define W(x) write(0, #x, 1)</code> or <code>#define W(x) putchar(#x[0])</code> or <code>#define W(x) fwrite(#x, 1, 1, stdout)</code>, etc.  Which of the many available options have you chosen, or been given?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554937747, "post_id": 55622200, "comment_id": 97937942, "body": "The function: <code>fork()</code> returns three(3) kinds of values: 1) &gt;0 means in the parent  2) ==0 means in the child 3) &lt;0 means an error occurred, not child created, still in parent The posted pseudo code 1) doesn&#39;t compile 2) fails to check for a failure of <code>fork()</code>, etc.  So the actual output sequence is in determinant.  Also, you could have ran some real code in minutes rather than waiting for us to figure out what you think the code was doing, (as against what some real code written in this manner would do.)  In the future, please read/understand the MAN page for the functions you use"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1554937723, "post_id": 55622422, "comment_id": 97937935, "body": "If the output mechanism used standard I/O (<code>#define W(x) putchar(#x[0])</code>), then you would get two A&#39;s printed unless buffering was turned off (e.g. <code>setbuf(stdout, NULL)</code>).  That is probably not what&#39;s being used, but it is annoying that the OP refuses to provide an MCVE.  (Otherwise, nice presentation of the analysis.)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1554937811, "post_id": 55622422, "comment_id": 97937950, "body": "As I said in my last paragraph, I think that&#39;s just a placeholder that could be any statement, as this is an exercise to understand how multiple processes work, not I/O."}, {"owner": {"reputation": 5, "user_id": 4931072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6618ca2e2afd6aba35cdce8becd5e3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4931072/viktor"}, "edited": false, "score": 0, "creation_date": 1554939010, "post_id": 55622422, "comment_id": 97938211, "body": "Yes it is about how multiple processes work and only what I wrote is given. Two of the given answers is said that are correct and they are ABBCC and ABCBC. So Barmar thank you very much."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554939689, "post_id": 55622422, "comment_id": 97938384, "body": "If you want to see a more complicated challenge that I couldn&#39;t figure out the full result, <a href=\"https://stackoverflow.com/questions/55622057/number-of-possible-combinations-of-fork/55622726#55622726\" title=\"number of possible combinations of fork\">stackoverflow.com/questions/55622057/&hellip;</a>"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1554937114, "creation_date": 1554937114, "answer_id": 55622422, "question_id": 55622200, "link": "https://stackoverflow.com/questions/55622200/how-to-know-the-output-in-the-code-with-fork/55622422#55622422", "title": "How to know the output in the code with fork()?", "body": "<p><code>ACCBB</code> is not possible.</p>\n\n<p>I'll add a subscript <sub>p</sub> for letters printed by the parent, <sub>c</sub> for the child.</p>\n\n<p>The parent process prints A<sub>p</sub>B<sub>p</sub>C<sub>p</sub> in that order, and the child process prints B<sub>c</sub>C<sub>c</sub> in that order.</p>\n\n<p>A<sub>p</sub> will be printed first, because it's printed before anything is forked. The parent waits for the child to exit before printing C<sub>p</sub>, so this has to come last. So this means the first and last characters are <code>A</code> and <code>C</code>.</p>\n\n<p>In between this, there are no constraints on the order of execution between the two processes. So the following are possible:</p>\n\n<p>B<sub>p</sub>B<sub>c</sub>C<sub>c</sub><br>\nB<sub>c</sub>B<sub>p</sub>C<sub>c</sub><br>\nB<sub>c</sub>C<sub>c</sub>B<sub>p</sub></p>\n\n<p>The first two look the same in output, since we can't tell the difference between B<sub>p</sub> and B<sub>c</sub></p>\n\n<p>So the possible results are:</p>\n\n<pre><code>ABBCC\nABCBC\n</code></pre>\n\n<p>This all assumes that there's no buffering that might delay the output. I.e. this is just an exercise to examine the order that statements can be executed in concurrent processes, not really about I/O.</p>\n"}], "owner": {"reputation": 5, "user_id": 4931072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6618ca2e2afd6aba35cdce8becd5e3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4931072/viktor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 55622422, "answer_count": 1, "score": -3, "last_activity_date": 1554937114, "creation_date": 1554935672, "last_edit_date": 1554936613, "question_id": 55622200, "link": "https://stackoverflow.com/questions/55622200/how-to-know-the-output-in-the-code-with-fork", "title": "How to know the output in the code with fork()?", "body": "<pre><code>#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\nint main ()\n{\n    W(A);\n    int child=fork();\n    W(B);\n    if (child)\n      wait(NULL);\n    W(C);\n}\n</code></pre>\n\n<p>I think that ABBCC will be one of the outputs, but also one more of the next ones: ACCBB, ABB, ABCBC, ABCAA should be correct. W means write and W(A), W(B), W(C) mean to write A, B, C. Please help. </p>\n"}, {"tags": ["c", "linker", "ld", "binutils", "linker-scripts"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554936516, "post_id": 55622174, "comment_id": 97937626, "body": "The C standard does not define anything at all about linker script symbols. Any specification of behavior is up to the GNU tools. That said, if a linker script symbol identifies a place in memory where some valid object is stored, I would expect accessing the value of that object to work, if it were accessed with its proper type. Supposing <code>__flash_start__</code> is normally accessible memory, and except for any requirements of your system about what is at <code>__flash_start__</code>, you could, in theory, put a <code>uint32_t</code> (using appropriate input to the linker) and then access it via <code>__flash_start__</code>."}, {"owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554938632, "post_id": 55622174, "comment_id": 97938136, "body": "I&#39;m not sure if you&#39;re picking up the subtlety of my question, and I needed more space to respond, so I&#39;ve responded to your comment directly in the bottom of my question above."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554939484, "post_id": 55622174, "comment_id": 97938344, "body": "Why do you think <code>extern uint32_t __flash_start__; uint32_t u32 = *((uint32_t *)&amp;__flash_start__);</code> is a correct way to read a <code>uint32_t</code> that exists at <code>__flash_start__</code> and <code>extern uint32_t __flash_start__; uint32_t u32 = __flash_start__;</code> is not? Apple LLVM 10.0.0 with clang-1000.11.45.5 generates identical assembly code for them."}, {"owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554939783, "post_id": 55622174, "comment_id": 97938408, "body": "Because <code>__flash_start__</code> has no value--literally--accessing its &quot;value&quot; is illegal and has no meaning, according to the manual (<a href=\"https://sourceware.org/binutils/docs-2.32/ld/Source-Code-Reference.html#Source-Code-Reference\" rel=\"nofollow noreferrer\">sourceware.org/binutils/docs-2.32/ld/&hellip;</a>), and the <i>address</i> of <code>__flash_start__</code> is <code>0x8000000</code>. Take a close read in the manual. <a href=\"https://sourceware.org/binutils/docs-2.32/ld/Source-Code-Reference.html#Source-Code-Reference\" rel=\"nofollow noreferrer\">sourceware.org/binutils/docs-2.32/ld/&hellip;</a>. This is an esoteric concept that requires a <i>very close study</i>. Note also that the &quot;Sample printed output&quot; from my question is real output, compiled, run, and copied-pasted, not just typed up."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554940057, "post_id": 55622174, "comment_id": 97938459, "body": "That documentation is not written very well, and you are taking the first sentence too literally. What is really happening here is that the linker\u2019s notion of the \u201cvalue\u201d of a symbol and a programming language\u2019s notion of the \u201cvalue\u201d of an identifier are different things. To the linker, the value of a symbol is simply a number associated with it. In a programming language, the value is a number (or other element in the set of values of some type) stored in the (sometimes notional) storage associated with the identifier.\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1554940225, "post_id": 55622174, "comment_id": 97938491, "body": "\u2026 The documentation is advising you that the linker\u2019s value of a symbol appears inside a language like C as the address associated with the identifier, rather than the contents of its storage. It goes too far when it tells you to \u201cnever attempt to use its value.\u201d It is correct that merely defining a linker symbol does not reserve the necessary storage for a programming language object, and therefore merely having a linker symbol does not provide you storage you can access. However if <b>you</b> ensure storage is allocated by <b>some other means</b>, then, sure,\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1554940278, "post_id": 55622174, "comment_id": 97938502, "body": "\u2026 it can work as a programming language object. <b>There is no general prohibition on using a linker symbol as an identifier in C, including accessing its C value, if you have properly allocated storage and otherwise satisfied the requirements for this.</b> If the linker value of <code>__flash_start__</code> is a valid memory address, and you have ensure there is storage for a <code>uint32_t</code> at that address, and it is a properly aligned address for a <code>uint32_t</code>, then it is okay to access <code>__flash_start__</code> in C as if it were a <code>uint32_t</code>. That would not be defined by the C standard, but by the GNU tools."}, {"owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554941482, "post_id": 55622174, "comment_id": 97938760, "body": "You are correct. I tested the following: <code>extern uint32_t __app_start__; uint32_t u32_1 = __app_start__; uint32_t u32_2 = *((uint32_t *)&amp;__app_start__); printf(&quot;u32_1 = 0x%lX\\n&quot;, u32_1); printf(&quot;u32_2 = 0x%lX\\n&quot;, u32_2);</code>, and both <code>u32_1</code> (what you were saying--which I initially thought was wrong) and <code>u32_2</code> (which I always knew to be correct) produced the same result, so you are correct. Output: <code>u32_1 = 0x20080000</code> and <code>u32_2 = 0x20080000</code>."}, {"owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554943106, "post_id": 55622174, "comment_id": 97939059, "body": "I just wrote an answer to wrap up my findings. This was rather confusing, but also enlightening in the end. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "is_accepted": true, "score": 8, "last_activity_date": 1583517104, "last_edit_date": 1583517104, "creation_date": 1554942145, "answer_id": 55623006, "question_id": 55622174, "link": "https://stackoverflow.com/questions/55622174/is-accessing-the-value-of-a-linker-script-variable-undefined-behavior-in-c/55623006#55623006", "title": "Is accessing the &quot;value&quot; of a linker script variable undefined behavior in C?", "body": "<h1>Shorter answer:</h1>\n\n<p>Accessing the \"value\" of a linker script variable is NOT undefined behavior, and is fine to do, so long as you want the <em>actual data stored at that location in memory</em> and not the address of that memory or the \"value\" of a linkerscript variable which happens to be seen by C code as an <em>address in memory</em> <strong>only</strong> and <strong>not</strong> a value. </p>\n\n<p>Yeah, that's kind of confusing, so re-read that 3 times carefully. <strong>Essentially, if you want to access the value of a linker script variable just ensure your linker script is set up to prevent anything you don't want from ending up in that memory address so that whatever you DO want there is in fact there. This way, reading the value at that memory address will provide you something useful you expect to be there.</strong> </p>\n\n<p>BUT, if you're using linker script variables to store some sort of \"values\" in and of themselves, the way to grab the \"values\" of these linker script variables in C is to read their <strong>addresses</strong>, because the \"value\" you assign to a variable in a linker script IS SEEN BY THE C COMPILER AS THE \"ADDRESS\" of that linker script variable, since linker scripts are designed to manipulate memory and memory addresses, NOT traditional C variables.</p>\n\n<p>Here's some really valuable and correct comments under my question which I think are worth posting in this answer so they never get lost. <em>Please go upvote his comments under my question above.</em></p>\n\n<blockquote>\n  <p>The C standard does not define anything at all about linker script symbols. Any specification of behavior is up to the GNU tools. That said, if a linker script symbol identifies a place in memory where some valid object is stored, I would expect accessing the value of that object to work, if it were accessed with its proper type. Supposing <code>__flash_start__</code> is normally accessible memory, and except for any requirements of your system about what is at <code>__flash_start__</code>, you could, in theory, put a <code>uint32_t</code> (using appropriate input to the linker) and then access it via <code>__flash_start__</code>.<br>\n  \u2013 Eric Postpischil </p>\n  \n  <p>That documentation is not written very well, and you are taking the first sentence too literally. What is really happening here is that the linker\u2019s notion of the \u201cvalue\u201d of a symbol and a programming language\u2019s notion of the \u201cvalue\u201d of an identifier are different things. To the linker, the value of a symbol is simply a number associated with it. In a programming language, the value is a number (or other element in the set of values of some type) stored in the (sometimes notional) storage associated with the identifier. The documentation is advising you that the linker\u2019s value of a symbol appears inside a language like C as the address associated with the identifier, rather than the contents of its storage...</p>\n</blockquote>\n\n<p>THIS PART IS REALLY IMPORTANT and we should get the GNU linker script manual updated:</p>\n\n<blockquote>\n  <p><strong>It goes too far when it tells you to \u201cnever attempt to use its value.\u201d</strong></p>\n  \n  <p>It is correct that merely defining a linker symbol does not reserve the necessary storage for a programming language object, and therefore merely having a linker symbol does not provide you storage you can access. However if <strong>you</strong> ensure storage is allocated by <strong>some other means</strong>, then, sure, it can work as a programming language object. <strong>There is no general prohibition on using a linker symbol as an identifier in C, including accessing its C value, if you have properly allocated storage and otherwise satisfied the requirements for this.</strong> If the linker value of <code>__flash_start__</code> is a valid memory address, and you have ensure there is storage for a <code>uint32_t</code> at that address, and it is a properly aligned address for a <code>uint32_t</code>, then it is okay to access <code>__flash_start__</code> in C as if it were a <code>uint32_t</code>. That would not be defined by the C standard, but by the GNU tools.<br>\n  \u2013 Eric Postpischil </p>\n</blockquote>\n\n<h1>Long answer:</h1>\n\n<p>I said in the question:</p>\n\n<pre><code>// 1. correct way A:\nextern uint32_t __flash_start__;\nprintf(\"__flash_start__ addr = 0x%lX\\n\", (uint32_t)&amp;__flash_start__);\n\n// OR 2. correct way B (my preferred approach):\nextern uint32_t __flash_start__[]; // not a true array; [] is required to access linker script variables (addresses) as though they were normal variables\nprintf(\"__flash_start__ addr = 0x%lX\\n\", (uint32_t)__flash_start__);\n\n// OR 3. COMPLETELY WRONG WAY TO DO IT!\n// - IS THIS UNDEFINED BEHAVIOR?\nextern uint32_t __flash_start__;\nprintf(\"__flash_start__ addr = 0x%lX\\n\", __flash_start__);\n</code></pre>\n\n<p>(See discussion under the question for how I came to this).</p>\n\n<p><strong>Looking specifically at #3 above</strong>:</p>\n\n<p>Well, actually, if your goal is to read the <em>address</em> of <code>__flash_start__</code>, which is <code>0x8000000</code> in this case, then yes, this is completely wrong. But, it is NOT undefined behavior! What it is actually doing, instead, is reading the <em>contents</em> (value) of that address (<code>0x8000000</code>) as a <code>uint32_t</code> type. In other words, it's simply reading the first 4 bytes of the FLASH section, and interpreting them as a <code>uint32_t</code>. The <em>contents</em> (<code>uint32_t</code> value at this address) just so happen to be <code>0x20080000</code> in this case. </p>\n\n<p>To further prove this point, the following are exactly identical:</p>\n\n<pre><code>// Read the actual *contents* of the __flash_start__ address as a 4-byte value!\n// The 2 techniques should be the same.\nextern uint32_t __flash_start__;\nuint32_t u32_1 = __flash_start__;\nuint32_t u32_2 = *((uint32_t *)&amp;__flash_start__);\nprintf(\"u32_1 = 0x%lX\\n\", u32_1);\nprintf(\"u32_2 = 0x%lX\\n\", u32_2);\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>u32_1 = 0x20080000\nu32_2 = 0x20080000\n</code></pre>\n\n<p>Notice they produce the same result. They each are producing a valid <code>uint32_t</code>-type value which is stored at address <code>0x8000000</code>.</p>\n\n<p>It just so turns out, however, that the <code>u32_1</code> technique shown above is a more straight-forward and direct way of reading the value is all, and again, is <em>not</em> undefined behavior. Rather, it is correctly reading the value (contents of) that address.</p>\n\n<p>I seem to be talking in circles. Anyway, mind blown, but I get it now. I was convinced before I was supposed to use the <code>u32_2</code> technique shown above only, but it turns out they are both just fine, and again, the <code>u32_1</code> technique is clearly more straight-forward (there I go talking in circles again). :)</p>\n\n<p>Cheers.</p>\n\n<hr>\n\n<h1>Digging deeper: Where did the <code>0x20080000</code> value stored right at the start of my FLASH memory come from?</h1>\n\n<p>One more little tidbit. I actually ran this test code on an STM32F777 mcu, which has 512KiB of RAM. Since RAM starts at address 0x20000000, this means that 0x20000000 + 512K = 0x20080000. This just so happens to also be the contents of the RAM at address zero because <a href=\"https://www.st.com/content/ccc/resource/technical/document/programming_manual/group0/78/47/33/dd/30/37/4c/66/DM00237416/files/DM00237416.pdf/jcr:content/translations/en.DM00237416.pdf\" rel=\"noreferrer\">Programming Manual PM0253 Rev 4</a>, pg. 42, \"Figure 10. Vector table\" shows that the first 4 bytes of the Vector Table contain the \"Initial SP [Stack Pointer] value\". See here: </p>\n\n<p><a href=\"https://i.stack.imgur.com/kgeZZ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/kgeZZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know that the Vector Table sits right at the start of the program memory, which is located in Flash, so that means that 0x20080000 is my initial stack pointer value. This makes sense, because the <code>Reset_Handler</code> is the start of the program (and its vector just so happens to be the 2nd 4-byte value at the start of the Vector Table, by the way), and the first thing it does, as shown in my \"<strong>startup_stm32f777xx.s</strong>\" startup assembly file, is set the stack pointer (sp) to <code>_estack</code>:</p>\n\n<pre><code>Reset_Handler:  \n  ldr   sp, =_estack      /* set stack pointer */\n</code></pre>\n\n<p>Furthermore, <code>_estack</code> is defined in my linker script as follows:</p>\n\n<pre><code>/* Highest address of the user mode stack */\n_estack = ORIGIN(RAM) + LENGTH(RAM);    /* end of RAM */\n</code></pre>\n\n<p>So there you have it! The first 4-byte value in my Vector Table, right at the start of Flash, is set to be the initial stack pointer value, which is defined as <code>_estack</code> right in my linker script file, and <code>_estack</code> is the address at the end of my RAM, which is 0x20000000 + 512K = 0x20080000. So, it all makes sense! I've just proven I read the right value!</p>\n"}], "owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2038, "favorite_count": 3, "accepted_answer_id": 55623006, "answer_count": 1, "score": 3, "last_activity_date": 1583517104, "creation_date": 1554935548, "last_edit_date": 1583516041, "question_id": 55622174, "link": "https://stackoverflow.com/questions/55622174/is-accessing-the-value-of-a-linker-script-variable-undefined-behavior-in-c", "title": "Is accessing the &quot;value&quot; of a linker script variable undefined behavior in C?", "body": "<p>The GNU ld (linker script) manual Section <a href=\"https://sourceware.org/binutils/docs-2.32/ld/Source-Code-Reference.html#Source-Code-Reference\" rel=\"nofollow noreferrer\">3.5.5 Source Code Reference</a> has some really important information on how to access linker script \"variables\" (which are actually just integer addresses) in C source code. I used this info. to extensively use linker script variables, and I wrote this answer here: <a href=\"https://stackoverflow.com/questions/48561217/how-to-get-value-of-variable-defined-in-ld-linker-script-from-c/54728097#54728097\">How to get value of variable defined in ld linker script from C</a>.</p>\n\n<p>However, it is easy to do it wrong and make the mistake of trying to access a linker script variable's <strong>value</strong> (mistakenly) instead of its address, since this is a bit esoteric. The manual (link above) says: </p>\n\n<blockquote>\n  <p>This means that you cannot access the\n  <em>value</em> of a linker script defined symbol - it has no value - all you can do is access the <em>address</em> of a linker script defined symbol.</p>\n  \n  <p>Hence when you are using a linker script defined symbol in source code you should always take the address of the symbol, <strong>and never attempt to use its value</strong>. </p>\n</blockquote>\n\n<p><strong>The question:</strong> So, if you <em>do</em> attempt to access a linker script variable's <em>value</em>, is this \"undefined behavior\"?</p>\n\n<h2>Quick refresher:</h2>\n\n<p>Imagine in linker script (ex: <strong>STM32F103RBTx_FLASH.ld</strong>) you have:</p>\n\n<pre><code>/* Specify the memory areas */\nMEMORY\n{\n    FLASH (rx)      : ORIGIN = 0x8000000,  LENGTH = 128K\n    RAM (xrw)       : ORIGIN = 0x20000000, LENGTH = 20K\n}\n\n/* Some custom variables (addresses) I intend to access from my C source code */\n__flash_start__ = ORIGIN(FLASH);\n__flash_end__ = ORIGIN(FLASH) + LENGTH(FLASH);\n__ram_start__ = ORIGIN(RAM);\n__ram_end__ = ORIGIIN(RAM) + LENGTH(RAM);\n</code></pre>\n\n<p>And in your C source code you do:</p>\n\n<pre><code>// 1. correct way A:\nextern uint32_t __flash_start__;\nprintf(\"__flash_start__ addr = 0x%lX\\n\", (uint32_t)&amp;__flash_start__);\n\n// OR 2. correct way B (my preferred approach):\nextern uint32_t __flash_start__[]; // not a true array; [] is required to access linker script variables (addresses) as though they were normal variables\nprintf(\"__flash_start__ addr = 0x%lX\\n\", (uint32_t)__flash_start__);\n\n// OR 3. COMPLETELY WRONG WAY TO DO IT!\n// - IS THIS UNDEFINED BEHAVIOR?\nextern uint32_t __flash_start__;\nprintf(\"__flash_start__ addr = 0x%lX\\n\", __flash_start__);\n</code></pre>\n\n<h2>Sample printed output</h2>\n\n<p>(this is real output: it was actually compiled, run, and printed by an STM32 mcu):</p>\n\n<ol>\n<li><code>__flash_start__ addr = 0x8000000</code></li>\n<li><code>__flash_start__ addr = 0x8000000</code></li>\n<li><code>__flash_start__ addr = 0x20080000</code> &lt;== NOTICE LIKE I SAID ABOVE: this one is <em>completely wrong</em> (even though it compiles and runs)! <em>&lt;== Update Mar. 2020: actually, see my answer, this is just fine and right too, it just does something different is all.</em></li>\n</ol>\n\n<hr>\n\n<h2>Update:</h2>\n\n<p>Response to @Eric Postpischil's 1st comment:</p>\n\n<blockquote>\n  <p>The C standard does not define anything at all about linker script symbols. Any specification of behavior is up to the GNU tools. That said, if a linker script symbol identifies a place in memory where some valid object is stored, I would expect accessing the value of that object to work, if it were accessed with its proper type. Supposing <strong>flash_start</strong> is normally accessible memory, and except for any requirements of your system about what is at <strong>flash_start</strong>, you could, in theory, put a uint32_t (using appropriate input to the linker) and then access it via <strong>flash_start</strong>.</p>\n</blockquote>\n\n<p>Yes, but that's not my question. I'm not sure if you're picking up the subtlety of my question. Take a look at the examples I provide. It is true you can access this location just fine, but make sure you understand <em>how</em> you do so, and then my question will become apparent. Look especially at example 3 above, which is <em>wrong</em> even though to a C programmer it <em>looks right</em>. To read a <code>uint32_t</code>, for ex, at <code>__flash_start__</code>, you'd do this: </p>\n\n<pre><code>extern uint32_t __flash_start__;\nuint32_t u32 = *((uint32_t *)&amp;__flash_start__); // correct, even though it *looks like* you're taking the address (&amp;) of an address (__flash_start__)\n</code></pre>\n\n<p>OR this:</p>\n\n<pre><code>extern uint32_t __flash_start__[];\nuint32_t u32 = *((uint32_t *)__flash_start__); // also correct, and my preferred way of doing it because it looks more correct to the trained \"C-programmer\" eye\n</code></pre>\n\n<p>But most definitely NOT this:</p>\n\n<pre><code>extern uint32_t __flash_start__;\nuint32_t u32 = __flash_start__; // incorrect; &lt;==UPDATE: THIS IS ALSO CORRECT! (and more straight-forward too, actually; see comment discussion under this question)\n</code></pre>\n\n<p>and NOT this:</p>\n\n<pre><code>extern uint32_t __flash_start__;\nuint32_t u32 = *((uint32_t *)__flash_start__); // incorrect, but *looks* right\n</code></pre>\n\n<h1>Related:</h1>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/55621981/why-do-stm32-gcc-linker-scripts-automatically-discard-all-input-sections-from-th\">Why do STM32 gcc linker scripts automatically discard all input sections from these standard libraries: libc.a, libm.a, libgcc.a?</a></li>\n<li><a href=\"https://stackoverflow.com/a/54728097/4561887\">https://stackoverflow.com/a/54728097/4561887</a></li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554935425, "post_id": 55622146, "comment_id": 97937360, "body": "Enable compiler warnings.  Or fix the ones you do get."}, {"owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "edited": false, "score": 0, "creation_date": 1554935539, "post_id": 55622146, "comment_id": 97937389, "body": "Did it compile successfully?"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 1, "creation_date": 1554935558, "post_id": 55622146, "comment_id": 97937393, "body": "perhaps you would like <code>cmd</code> to be a character array. <code>char cmd[255];</code>"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 0, "creation_date": 1554935668, "post_id": 55622146, "comment_id": 97937423, "body": "Compiler warnings tell you where you&#39;ve made errors, which there are here"}, {"owner": {"reputation": 13, "user_id": 11132695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V57FYGF-WFA/AAAAAAAAAAI/AAAAAAAAAG4/D6SAYi3F_s4/photo.jpg?sz=128", "display_name": "darrenthebozz", "link": "https://stackoverflow.com/users/11132695/darrenthebozz"}, "edited": false, "score": 0, "creation_date": 1554935711, "post_id": 55622146, "comment_id": 97937432, "body": "if i use [255] it causes errors on line 15"}, {"owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "edited": false, "score": 0, "creation_date": 1554935764, "post_id": 55622146, "comment_id": 97937443, "body": "Why cmd +=2; And how do you plan to exit the loop?"}, {"owner": {"reputation": 13, "user_id": 11132695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V57FYGF-WFA/AAAAAAAAAAI/AAAAAAAAAG4/D6SAYi3F_s4/photo.jpg?sz=128", "display_name": "darrenthebozz", "link": "https://stackoverflow.com/users/11132695/darrenthebozz"}, "edited": false, "score": 0, "creation_date": 1554935825, "post_id": 55622146, "comment_id": 97937460, "body": "i use +=2 to get rid of CD and leave example /users\\username"}, {"owner": {"reputation": 587, "user_id": 6012693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5be83dfa8bf9e72bec3204f60fee1dbd?s=128&d=identicon&r=PG&f=1", "display_name": "tum_", "link": "https://stackoverflow.com/users/6012693/tum"}, "edited": false, "score": 0, "creation_date": 1554935913, "post_id": 55622146, "comment_id": 97937479, "body": "Edit the question to show the actual code and add the compiler output."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11132695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V57FYGF-WFA/AAAAAAAAAAI/AAAAAAAAAG4/D6SAYi3F_s4/photo.jpg?sz=128", "display_name": "darrenthebozz", "link": "https://stackoverflow.com/users/11132695/darrenthebozz"}, "edited": false, "score": 0, "creation_date": 1554936748, "post_id": 55622298, "comment_id": 97937671, "body": "Thank you for your feedback. :)"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "reply_to_user": {"reputation": 13, "user_id": 11132695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V57FYGF-WFA/AAAAAAAAAAI/AAAAAAAAAG4/D6SAYi3F_s4/photo.jpg?sz=128", "display_name": "darrenthebozz", "link": "https://stackoverflow.com/users/11132695/darrenthebozz"}, "edited": false, "score": 1, "creation_date": 1554937030, "post_id": 55622298, "comment_id": 97937749, "body": "Happy to help. If you are looking to learn C you should spend time and try to figure out what each line does and why. It would be very useful to you. Why did using <code>char cmd;</code> not work but using <code>char cmd[255];</code> work? What&#39;s the difference?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 13, "user_id": 11132695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V57FYGF-WFA/AAAAAAAAAAI/AAAAAAAAAG4/D6SAYi3F_s4/photo.jpg?sz=128", "display_name": "darrenthebozz", "link": "https://stackoverflow.com/users/11132695/darrenthebozz"}, "edited": false, "score": 0, "creation_date": 1554938162, "post_id": 55622298, "comment_id": 97938022, "body": "@darrenthebozz :  Consider also using <code>fgets( cmd, sizeof(cmd), stdin ) ;</code>.  Also beware that a user may enter additional whitespace between the command and its the argument."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554939587, "post_id": 55622298, "comment_id": 97938366, "body": "Since this is windows, the user might have entered <code>CD</code> or <code>cd</code> or <code>Cd</code> or <code>cD</code>  the posted code only handles the <code>CD</code>  Also, in windows the user could have placed no white space between the <code>cd</code> and the new directory name"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 0, "creation_date": 1554941158, "post_id": 55622298, "comment_id": 97938684, "body": "Lots of improvements you could make to make it like windows, based on the OP I think it is best to keep it simple so the OP can focus on things like differentiating between <code>char cmd;</code> and <code>char cmd[255];</code> and not worry about extra white space and such yet."}], "tags": [], "owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "is_accepted": true, "score": 1, "last_activity_date": 1554936350, "creation_date": 1554936350, "answer_id": 55622298, "question_id": 55622146, "link": "https://stackoverflow.com/questions/55622146/my-c-program-crashing-for-an-unseen-reason/55622298#55622298", "title": "my C program crashing for an unseen reason", "body": "<p>Maybe you are looking to do something like this:</p>\n\n<pre><code>void main()\n{    \n    char cmd[255]; // this allocate a character array to store the command in\n    for(;;)\n    {\n        fgets(cmd,255,stdin); // get the characters from stdin and store them in the cmd character array with a max length of 255\n        if ( strncmp(cmd, \"CD \", 3) == 0 ) // check if the first three characters are \"CD \"\n        {\n            SetCurrentDirectory(&amp;cmd[3]); // pass the string not including the first 3 charcters, which should be \"CD \"\n        }\n        else\n        {\n            system(cmd);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11132695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V57FYGF-WFA/AAAAAAAAAAI/AAAAAAAAAG4/D6SAYi3F_s4/photo.jpg?sz=128", "display_name": "darrenthebozz", "link": "https://stackoverflow.com/users/11132695/darrenthebozz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55622298, "answer_count": 1, "score": 0, "last_activity_date": 1554938091, "creation_date": 1554935225, "last_edit_date": 1554938091, "question_id": 55622146, "link": "https://stackoverflow.com/questions/55622146/my-c-program-crashing-for-an-unseen-reason", "title": "my C program crashing for an unseen reason", "body": "<p>So my program is meant to be a little command line but it keeps crashing:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;    \n\nvoid main()\n{    \n    char cmd;\n    for(;;)\n    {\n        fgets(cmd,255,stdin);\n        if (strstr(cmd,\"CD\")!=NULL )\n        {\n            cmd +=2;\n            SetCurrentDirectory(cmd);\n        }\n        else\n        {\n            system(cmd);\n        }\n    }\n}\n</code></pre>\n\n<p>the compiler output is lvalue expected.</p>\n"}, {"tags": ["c", "windows", "visual-studio", "sockets", "winsock"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554939893, "post_id": 55622094, "comment_id": 97938431, "body": "in the server code,  This statement: <code>void main(int argc, char* argv[])</code> will cause the compiler to output two warning messages about unused parameters.  Suggest using: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554940278, "post_id": 55622094, "comment_id": 97938503, "body": "in the server, regarding: <code>printf(L&quot;Socket creation failed with error: %ld\\n&quot;, WSAGetLastError());</code>  and <code>wprintf(L&quot;bind failed with error: %ld\\n&quot;, WSAGetLastError());</code>  1) error messages should be output to <code>stderr</code>, not <code>stdout</code>,  Suggest using <code>fprintf( stderr, .... )</code>  2) when an error occurs, that would be time to exit the program, perhaps by: <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554940478, "post_id": 55622094, "comment_id": 97938538, "body": "OT: the server code fails to do anything after establishing the connection with the client"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554940593, "post_id": 55622094, "comment_id": 97938569, "body": "OT: sockets have type <code>sock_t</code>, which might be the same as <code>int</code> but the code should not assume that relationship"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554940719, "post_id": 55622094, "comment_id": 97938598, "body": "regarding: <code>wprintf(&quot;WSAStartup() failed with error: %d\\n&quot;, iResult);</code>  the function: <code>wprintf()</code> expects the text to be &#39;wide&#39;, not ascii.  So the statement should be: <code>wprintf(L&quot;WSAStartup() failed with error: %d\\n&quot;, iResult);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554940987, "post_id": 55622094, "comment_id": 97938650, "body": "the same logic and syntax problems mentioned for the <code>server</code> code also exist for the client code."}, {"owner": {"reputation": 33, "user_id": 1864178, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac13e56967a630d175f909eaa07fc5ba?s=128&d=identicon&r=PG&f=1", "display_name": "NoobxCamper", "link": "https://stackoverflow.com/users/1864178/noobxcamper"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554941106, "post_id": 55622094, "comment_id": 97938669, "body": "@user3629249 Yeah I have my warnings turned off because this is part of a bigger project to cause a buffer overflow on the server side. That said, my client used to be able to connect to my server, now its constantly throwing 10049? I don&#39;t know if the warnings are the problem though."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554941111, "post_id": 55622094, "comment_id": 97938673, "body": "before the client calls <code>send()</code> it should check the returned value from &#39;connect_server()` to assure that a socket was successfully created and connected, which means the function: <code>connect_server()</code> needs to return an indication of success/failure"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554941273, "post_id": 55622094, "comment_id": 97938710, "body": "you might try using <code>perror()</code> (or similar statement in windows) to have the system tell you what the error means"}, {"owner": {"reputation": 33, "user_id": 1864178, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac13e56967a630d175f909eaa07fc5ba?s=128&d=identicon&r=PG&f=1", "display_name": "NoobxCamper", "link": "https://stackoverflow.com/users/1864178/noobxcamper"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554941329, "post_id": 55622094, "comment_id": 97938725, "body": "I tried using perror, returns &quot;No error&quot;. The only error I get is from WSA, 10049"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554972785, "post_id": 55622094, "comment_id": 97948426, "body": "You stated that you turned off the dynamic IP address assigning.  That means that your computer now uses a static address.   This is NOT a good idea.  Better to use an appropriate function to retrieve the current IP address"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 1864178, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac13e56967a630d175f909eaa07fc5ba?s=128&d=identicon&r=PG&f=1", "display_name": "NoobxCamper", "link": "https://stackoverflow.com/users/1864178/noobxcamper"}, "edited": false, "score": 0, "creation_date": 1554942023, "post_id": 55622951, "comment_id": 97938855, "body": "I mentioned this in my question, the IP address is correct for my PC. It hasn&#39;t changed because I turned off automatic IP address assignment."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1554941552, "creation_date": 1554941552, "answer_id": 55622951, "question_id": 55622094, "link": "https://stackoverflow.com/questions/55622094/connect-keeps-failing-with-error-10049-in-c/55622951#55622951", "title": "Connect Keeps Failing With Error 10049 in C", "body": "<p>A very fast/simple search for <code>WSA error 10049</code> results in: </p>\n\n<p>Winsock error 10049 typically occurs when you attempt to create a socket with an address not on this machine. For example if you have MDaemon running on a machine with an IP address of 192.168.0.1 and you attempt to bind MDaemon to 192.168.0.100 you will receive this error message.</p>\n\n<p>So, you need to correct the IP address for the new computer.</p>\n"}], "owner": {"reputation": 33, "user_id": 1864178, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac13e56967a630d175f909eaa07fc5ba?s=128&d=identicon&r=PG&f=1", "display_name": "NoobxCamper", "link": "https://stackoverflow.com/users/1864178/noobxcamper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554941552, "creation_date": 1554934784, "question_id": 55622094, "link": "https://stackoverflow.com/questions/55622094/connect-keeps-failing-with-error-10049-in-c", "title": "Connect Keeps Failing With Error 10049 in C", "body": "<p>I'm new to socket programming and this is my first server-client program. The program was working perfectly fine at first, but when I copied my code from Server.c and Client.c to a new project in Visual Studio, my client is now refusing to connect and throws the error 10049. I can still connect to my server if I use telnet from command prompt.</p>\n\n<p>I am surprised as to why my client would stop working when I copy the code to another empty project, nothing else has changed.</p>\n\n<p>I have tried changing IP addresses, port numbers and port forwarding using my public address to no avail. I have confirmed my computer's IP using ipconfig and it is correctly inputted in my code, as well as the port number. The program compiles fine with no errors whatsoever.</p>\n\n<p>Server.c</p>\n\n<pre><code>#include &lt;winsock2.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;WS2tcpip.h&gt;\n\n\n#pragma comment (lib, \"Ws2_32.lib\")\n\nvoid start_server(const char* ip_address, int port_number);\nint server_sock, client_sock;\n\nvoid main(int argc, char* argv[])\n{\n    start_server(\"192.168.0.24\", 100);\n    system(\"pause\");    \n}\n\nvoid start_server(const char* ip_address, int port_number)\n{\n    WSADATA wsaData;\n\n    int iResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);\n    if (iResult != NO_ERROR) {\n        wprintf(L\"WSAStartup() failed with error: %d\\n\", iResult);\n        return 1;\n    }\n\n    struct sockaddr_in server_addr;\n    memset(&amp;server_addr, 0, sizeof(server_addr));\n\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_port = htons(port_number);\n    InetPton(AF_INET, \"\", &amp;server_addr.sin_addr.s_addr);\n\n    server_sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n    if (server_sock == INVALID_SOCKET)\n    {\n        printf(L\"Socket creation failed with error: %ld\\n\", WSAGetLastError());\n    }\n    else\n    {\n        printf(\"Socket created!\\n\");\n    }\n\n    int bind_status = bind(server_sock, (struct sockaddr*) &amp; server_addr, sizeof(server_addr));\n    if (bind_status == SOCKET_ERROR) {\n        wprintf(L\"bind failed with error: %ld\\n\", WSAGetLastError());\n    }\n    else\n    {\n        printf(\"Bind was successful!\\n\");\n    }\n\n    int listen_status = listen(server_sock, 3);\n    if (listen_status == -1) \n    {\n        wprintf(L\"listen failed with error: %ld\\n\", WSAGetLastError());\n    }\n    else\n    {\n        printf(\"Listening...\\n\");\n    }\n\n    client_sock = accept(server_sock, NULL, NULL);\n    if (client_sock == -1)\n    {\n        wprintf(L\"client socket failed with error: %ld\\n\", WSAGetLastError());\n    }\n    else\n    {\n        printf(\"Accepted new client!\\n\");\n    }\n}\n</code></pre>\n\n<p>Client.c</p>\n\n<pre><code>#include &lt;winsock2.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;WS2tcpip.h&gt;\n\n#pragma comment (lib, \"Ws2_32.lib\")\n\n\nvoid connect_server(const char* ip_address, int port_number);\n\nint sock;\n\nvoid main()\n{\n    connect_server(\"192.168.0.24\", 100);\n    send(sock, \"test\", 5, 0);\n    system(\"pause\");\n}\n\nvoid connect_server(const char* ip_address, int port_number)\n{\n    WSADATA wsaData;\n\n    int iResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);\n    if (iResult != NO_ERROR) {\n        wprintf(\"WSAStartup() failed with error: %d\\n\", iResult);\n        exit(1);\n    }\n\n    struct sockaddr_in server_addr;\n    memset(&amp;server_addr, 0, sizeof(server_addr));\n\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_port = htons(port_number);\n    InetPton(AF_INET, ip_address, &amp;server_addr.sin_addr.s_addr);\n\n    sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n    if (sock == INVALID_SOCKET)\n    {\n        printf(\"Socket creation failed with error: %d\\n\", WSAGetLastError());\n    }\n    else\n    {\n        printf(\"Socket created!\\n\");\n    }\n\n    int connection_status = connect(sock, (struct sockaddr *) &amp;server_addr, sizeof(server_addr));\n    if (connection_status == SOCKET_ERROR)\n    {\n        printf(\"Connection failed with error: %d\\n\", WSAGetLastError());\n    }\n    else\n    {\n        printf(\"Connected.\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "math", "fork", "combinatorics"], "comments": [{"owner": {"reputation": 12572, "user_id": 8534008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2af9937cac66f08b6ee6e4219cc0d?s=128&d=identicon&r=PG&f=1", "display_name": "GBlodgett", "link": "https://stackoverflow.com/users/8534008/gblodgett"}, "edited": false, "score": 0, "creation_date": 1554934654, "post_id": 55622057, "comment_id": 97937095, "body": "What language is this in?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1554934701, "post_id": 55622057, "comment_id": 97937115, "body": "Since output can be interleaved, the possible number of combinations is massive."}, {"owner": {"reputation": 21, "user_id": 8934442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475bbb58bc810f778320211aac4dd8ec?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz D", "link": "https://stackoverflow.com/users/8934442/lukasz-d"}, "edited": false, "score": 0, "creation_date": 1554934771, "post_id": 55622057, "comment_id": 97937148, "body": "This is the c language. And yes I know it is massive. This is a question on an exam asking for an exact answer not a \u201cit\u2019s big\u201d"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554938243, "post_id": 55622057, "comment_id": 97938038, "body": "Please post your answer, and the reasoning you used to calculate it. Then we can help you understand where you went wrong. But isn&#39;t this the job of the professor or teaching assistant? You&#39;re paying them to teach you this stuff."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554938290, "post_id": 55622057, "comment_id": 97938057, "body": "Oops, you <i>are</i> the teacher!"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1554940657, "post_id": 55622057, "comment_id": 97938585, "body": "At least print the process id of the current process:<code>printf(&quot;Process %d[%d] created child %d\\n&quot;, getpid(),id, i);</code> (and the  childs pid,too)"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1554939606, "creation_date": 1554939606, "answer_id": 55622726, "question_id": 55622057, "link": "https://stackoverflow.com/questions/55622057/number-of-possible-combinations-of-fork/55622726#55622726", "title": "Number of possible combinations of fork", "body": "<p>I haven't worked out all the combinations at the end, but this should get you going.</p>\n\n<p>You start with a parent process. It will call <code>fork()</code> 3 times, and print</p>\n\n<pre><code>Process 0 created child 1\nProcess 0 created child 2\nProcess 0 created child 3\n</code></pre>\n\n<p>After its first fork there's one child process with <code>id = 1</code>. This process will continue the loop, so it will print</p>\n\n<pre><code>Process 1 created child 2\nProcess 1 created child 3\n</code></pre>\n\n<p>The parent process will then fork a child with <code>id = 2</code>. This process will also continue its loop, so it will print</p>\n\n<pre><code>Process 2 created child 3\n</code></pre>\n\n<p>That's all the first generation children. But child 1 also forks its own child 2, which will print</p>\n\n<pre><code>Process 2 created child 3\n</code></pre>\n\n<p>All the processes that are forked when <code>i = 3</code> exit the loop immediately. They don't fork any more children, or print anything, so they can be ignored.</p>\n\n<p>Each process prints its own messages in order, but they can be interspersed in any order between the processes. The one constraint is that a a child can't print anything before its parent prints the message saying that it created an earlier child, because the message is printed before the iteration that creates the child (I'm assuming output is line buffered). But it <em>can</em> print its own messages before the message that says it was created!</p>\n\n<p>So the first two messages can be either:</p>\n\n<pre><code>Process 0 created child 1\nProcess 1 created child 2\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Process 1 created child 2\nProcess 0 created child 1\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8934442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475bbb58bc810f778320211aac4dd8ec?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz D", "link": "https://stackoverflow.com/users/8934442/lukasz-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1554939606, "creation_date": 1554934569, "last_edit_date": 1554935204, "question_id": 55622057, "link": "https://stackoverflow.com/questions/55622057/number-of-possible-combinations-of-fork", "title": "Number of possible combinations of fork", "body": "<pre><code>int main(void) { \n  int id = 0;\n  for(int i = 1; i &lt; 4; i++) {\n    if(fork() == 0) {\n      id = i;\n    } else {\n      printf(\"Process %d created child %d\\n\", id, i);\n    }\n  }\n  return 0;\n}\n</code></pre>\n\n<p>In the code above, multiple ordering of the output (printf statements) can be generated based on how the operating system schedules processes for execution. How many different orderings are possible? You may assume that all fork and printf calls succeed.</p>\n\n<p>I'm trying to help my students understand how to approach this problem, however I got a nice 0 on this question when I wrote the exam. I was hoping someone could explain how to go about it? </p>\n"}, {"tags": ["c", "linker", "stm32", "ld", "binutils"], "comments": [{"owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "edited": false, "score": 0, "creation_date": 1611805671, "post_id": 55621981, "comment_id": 116570525, "body": "I think to get an answer for this, someone needs to go ask ST the company and/or ARM the company directly, and report back."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 13027112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c4ce36ac253610b1974e9fdc010b0b?s=128&d=identicon&r=PG&f=1", "display_name": "udik-chudik", "link": "https://stackoverflow.com/users/13027112/udik-chudik"}, "is_accepted": false, "score": 1, "last_activity_date": 1589397420, "creation_date": 1589397420, "answer_id": 61783071, "question_id": 55621981, "link": "https://stackoverflow.com/questions/55621981/why-do-stm32-gcc-linker-scripts-automatically-discard-all-input-sections-from-th/61783071#61783071", "title": "Why do STM32 gcc linker scripts automatically discard all input sections from these standard libraries: libc.a, libm.a, libgcc.a?", "body": "<p>Looks like in this example, <code>/DISCARD/</code> removes any other sections, that are not explicitly defined by script. For example, since <code>*(.text)</code>, <code>*(.data)</code>, <code>*(.bss)</code>, <code>*(.init_array)</code> etc, has been defined earlier in the script, they get into the ELF. But <strong>libc</strong>, <strong>libm</strong> or <strong>libgcc</strong> could contain unnecessary sections for firmware (e.g. .foo, .bar, .debug ...), so /DISCARD/ just wipes them out, but NOT all sections!</p>\n"}], "owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 3, "answer_count": 1, "score": 12, "last_activity_date": 1589397420, "creation_date": 1554934099, "last_edit_date": 1554964758, "question_id": 55621981, "link": "https://stackoverflow.com/questions/55621981/why-do-stm32-gcc-linker-scripts-automatically-discard-all-input-sections-from-th", "title": "Why do STM32 gcc linker scripts automatically discard all input sections from these standard libraries: libc.a, libm.a, libgcc.a?", "body": "<p>From the bottom of any auto-generated STM32CubeMx-generated linker script:</p>\n\n<pre><code>/* Remove information from the standard libraries */\n/DISCARD/ :\n{\n  libc.a ( * )\n  libm.a ( * )\n  libgcc.a ( * )\n}\n</code></pre>\n\n<p>From the GNU Binutils ld (linker script) manual, <a href=\"https://sourceware.org/binutils/docs-2.32/ld/Output-Section-Discarding.html#Output-Section-Discarding\" rel=\"noreferrer\">3.6.7 Output Section Discarding</a>: </p>\n\n<blockquote>\n  <p>The special output section name \u2018/DISCARD/\u2019 may be used to discard input sections. Any input sections which are assigned to an output section named \u2018/DISCARD/\u2019 are not included in the output file.</p>\n</blockquote>\n\n<p>What do these 3 input object files contain, and why do we discard everything (all input sections) from them?</p>\n\n<h1>Other STM32 linker script topics of interest:</h1>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/55622174/is-accessing-the-value-of-a-linker-script-variable-undefined-behavior-in-c\">Is accessing the &quot;value&quot; of a linker script variable undefined behavior in C?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/48561217/how-to-get-value-of-variable-defined-in-ld-linker-script-from-c/54728097#54728097\">How to get value of variable defined in ld linker script from C</a></li>\n</ol>\n"}, {"tags": ["c", "ffmpeg", "rgb", "yuv"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1554932430, "post_id": 55621559, "comment_id": 97936369, "body": "For starters, you need to know <a href=\"https://en.wikipedia.org/wiki/Chroma_subsampling#4:2:0\" rel=\"nofollow noreferrer\">what 420 means</a>."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 2, "creation_date": 1554934581, "post_id": 55621559, "comment_id": 97937071, "body": "the simplest way would probably be to just research the formats in question, and figure out what math is required for the conversion. <i>only after that</i> should you look at the <code>ffmpeg</code> code - copying something that you don&#39;t understand is a recipe for misery and bugs."}, {"owner": {"reputation": 33, "user_id": 1712952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ooUK.jpg?s=128&g=1", "display_name": "MaikonNascimento", "link": "https://stackoverflow.com/users/1712952/maikonnascimento"}, "edited": false, "score": 0, "creation_date": 1554935655, "post_id": 55621559, "comment_id": 97937415, "body": "I know what yuv420 means and have a code to read a yuv file and separate the channels. I already did some conversions using equations in the literature , but I need to have the same output as ffmpeg."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 1712952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ooUK.jpg?s=128&g=1", "display_name": "MaikonNascimento", "link": "https://stackoverflow.com/users/1712952/maikonnascimento"}, "is_accepted": true, "score": 0, "last_activity_date": 1555047952, "creation_date": 1555047952, "answer_id": 55645191, "question_id": 55621559, "link": "https://stackoverflow.com/questions/55621559/what-are-all-the-operations-that-ffmpeg-uses-to-convert-from-yuv420p-to-rgb-bmp/55645191#55645191", "title": "what are all the operations that FFMPEG uses to convert from yuv420p to rgb bmp?", "body": "<p>well, since nobody came out with a solution , I am just gonna post that I found using \nvalgrind tool=callgrind ffmpeg_g \nwhich is a version of ffmpeg with debug objects that showed me the functions being called and inside \\libswscale\\x86 there is yuv2rgb_template.c which seems to have the operations you do yuv2rgb , in assembly</p>\n\n<pre><code> * Conversion is performed in usual way:\n * R = Y' * Ycoef + Vred * V'\n * G = Y' * Ycoef + Vgreen * V' + Ugreen * U'\n * B = Y' * Ycoef               + Ublue * U'\n *\n * where X' = X * 8 - Xoffset (multiplication is performed to increase\n * precision a bit).\n * Since it operates in YUV420 colorspace, Y component is additionally\n * split into Y1 and Y2 for even and odd pixels.\n *\n * Input:\n * mm0 - U (4 elems), mm1 - V (4 elems), mm6 - Y (8 elems), mm4 - zero register\n * Output:\n * mm1 - R, mm2 - G, mm0 - B\n */ ```\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1712952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ooUK.jpg?s=128&g=1", "display_name": "MaikonNascimento", "link": "https://stackoverflow.com/users/1712952/maikonnascimento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 55645191, "answer_count": 1, "score": 0, "last_activity_date": 1555047952, "creation_date": 1554931657, "question_id": 55621559, "link": "https://stackoverflow.com/questions/55621559/what-are-all-the-operations-that-ffmpeg-uses-to-convert-from-yuv420p-to-rgb-bmp", "title": "what are all the operations that FFMPEG uses to convert from yuv420p to rgb bmp?", "body": "<p>I am trying to replicate in my own code, not using ffmpeg libraries, the operations that ffmpeg does to convert yuv420p to rgb. Initially I thought it would be inside the function: xyz12Torgb48 in swscale.c but doing some tracing , it looks to be in yuv2rgb.c  ff_yuv2rgb_c_init_tables, which I can not quite see it.</p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 2349, "user_id": 6794384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153707640356246/picture?type=large", "display_name": "drclaw", "link": "https://stackoverflow.com/users/6794384/drclaw"}, "edited": false, "score": 0, "creation_date": 1554931883, "post_id": 55621427, "comment_id": 97936180, "body": "Hi there. What output are are you currently getting? If you are printing the order or node traversal, you would need to perform a comparison somewhere (compare search value to left node / right node and follow the matching one?)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554931968, "post_id": 55621427, "comment_id": 97936203, "body": "my answer does what you expect"}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 2847543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d50415555f90ae7e1b1042486311545e?s=128&d=identicon&r=PG", "display_name": "Mohammad Noor", "link": "https://stackoverflow.com/users/2847543/mohammad-noor"}, "is_accepted": false, "score": 1, "last_activity_date": 1554931414, "creation_date": 1554931414, "answer_id": 55621515, "question_id": 55621427, "link": "https://stackoverflow.com/questions/55621427/print-level-and-nodes-from-a-binary-search-tree/55621515#55621515", "title": "Print level and nodes from a binary search tree", "body": "<p>I implemented this with Java, but I think you can easily convert it to C:</p>\n\n<pre><code>private static void printWithLevels(TreeNode node) {\n    printWithLevels(node, 0);\n}\n\nprivate static void printWithLevels(TreeNode node, int level) {\n    if (node == null) return;\n\n    System.out.println(node.value + \"(\" + level + \")\");\n\n    printWithLevels(node.left, level + 1);\n    printWithLevels(node.right, level + 1);\n}\n</code></pre>\n\n<p>For my solution to be complete, this is my simple/quick implementation of TreeNode:</p>\n\n<pre><code>private static class TreeNode {\n    int value;\n    TreeNode left;\n    TreeNode right;\n\n    TreeNode(int value, TreeNode left, TreeNode right) {\n        this.value = value;\n        this.left = left;\n        this.right = right;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554932700, "post_id": 55621528, "comment_id": 97936453, "body": "@chill oh you already accepted, I edited to add a full program to show, yes that works ^^"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554932891, "post_id": 55621528, "comment_id": 97936520, "body": "@chill I recommend to not hide a pointer through a <i>typedef</i> because this is a source of a lot of errors and makes the code less readable, it is better to do for instance <code>typedef struct tree bst;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11337153"}, "edited": false, "score": 0, "creation_date": 1554933150, "post_id": 55621528, "comment_id": 97936606, "body": "oooo I&#39;ll take your advice! I&#39;m just starting with C and you have no idea how helpful this is :D"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554933226, "post_id": 55621528, "comment_id": 97936638, "body": "@chill in a lot of case we reuse the name of the struct like <code>typedef struct tree {     int number;     struct tree *izq;     struct tree *der; } tree;</code> but of course this is not mandatory. Note that inside the <i>struct</i> it is needed to write <i>struct tree *</i> rather than directly <i>tree*</i> because the <i>typedef</i> is not yet known"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1554932674, "last_edit_date": 1554932674, "creation_date": 1554931499, "answer_id": 55621528, "question_id": 55621427, "link": "https://stackoverflow.com/questions/55621427/print-level-and-nodes-from-a-binary-search-tree/55621528#55621528", "title": "Print level and nodes from a binary search tree", "body": "<p>warning</p>\n\n<pre><code>struct tree {\n    int number;\n    tree *izq;\n    tree *der;\n};\n</code></pre>\n\n<p>must be</p>\n\n<pre><code>struct tree {\n    int number;\n    struct tree *izq;\n    struct tree *der;\n};\n</code></pre>\n\n<hr>\n\n<p>because the case where node is NULL is checked at the beginning you can simplify :</p>\n\n<pre><code>void printTree(bst node) {\n    if (node != NULL) {\n      printTree(node-&gt;izq);\n      printf(\"%d\", node-&gt;number);\n      printTree(node-&gt;der);\n    }\n}\n</code></pre>\n\n<p>adding the level:</p>\n\n<pre><code>void printTree(bst node, int lvl) {\n    if (node != NULL) {\n      printTree(node-&gt;izq, lvl + 1);\n      printf(\"%d #%d\\n\", node-&gt;number, lvl);\n      printTree(node-&gt;der, lvl + 1);\n    }\n}\n</code></pre>\n\n<p>and you call at the root level with level 0 </p>\n\n<hr>\n\n<p>Making a full program :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct tree {\n    int number;\n    struct tree *izq;\n    struct tree *der;\n};\n\ntypedef struct tree *bst;\n\nvoid printTree(bst node, int lvl) {\n    if (node != NULL) {\n      printTree(node-&gt;izq, lvl + 1);\n      printf(\"%d #%d\\n\", node-&gt;number, lvl);\n      printTree(node-&gt;der, lvl + 1);\n    }\n}\n\nstruct tree * mk(int v, struct tree * l, struct tree * r)\n{\n  struct tree * t = malloc(sizeof(struct tree));\n\n  t-&gt;number = v;\n  t-&gt;izq = l;\n  t-&gt;der = r;\n\n  return t;\n}\n\nint main()\n{\n  struct tree * r = mk(5, mk(4, NULL, NULL), mk(9, mk(7, NULL, NULL), mk(10, NULL, mk(18, NULL, NULL))));\n\n  printTree(r, 0);\n}\n</code></pre>\n\n<p>Compilation an execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wall -Wextra c.c\npi@raspberrypi:/tmp $ ./a.out\n4 #1\n5 #0\n7 #2\n9 #1\n10 #2\n18 #3\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11337153"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 55621528, "answer_count": 2, "score": 0, "last_activity_date": 1554932674, "creation_date": 1554930861, "last_edit_date": 1554931453, "question_id": 55621427, "link": "https://stackoverflow.com/questions/55621427/print-level-and-nodes-from-a-binary-search-tree", "title": "Print level and nodes from a binary search tree", "body": "<p>I need to do an inorder traversal of a binary search tree, and I need to print all the nodes and the level they're at, but I can't think of a way to do this.</p>\n\n<p>For example: </p>\n\n<p>If I have this\n<a href=\"https://i.stack.imgur.com/rD2jd.png\" rel=\"nofollow noreferrer\">bst</a>, the output would be:</p>\n\n<pre><code>4 #1\n5 #0\n9 #1\n7 #2\n10 #2\n18 #3\n</code></pre>\n\n<p>This is so far what I got:</p>\n\n<p>This is the struct I'm using:</p>\n\n<pre><code>struct tree {\n    int number;\n    tree *izq;\n    tree *der;\n};\n\ntypedef struct tree *bst;\n</code></pre>\n\n<p>And this is the function I'm trying to implement:</p>\n\n<pre><code>void printTree(bst node) {\n    if (node==NULL) {\n        return;\n    }\n    else {\n        if (node-&gt;left != NULL) {\n            printTree(node-&gt;left);\n        }\n        printf(\"%d\", node-&gt;number);\n        if (node-&gt;right !=NULL) {\n            printTree(node-&gt;right);\n        }\n    }\n}\n</code></pre>\n\n<p>Does anyone have any ideas? Thank you :)</p>\n"}, {"tags": ["c", "linux", "pipe", "fork"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1554930573, "post_id": 55621308, "comment_id": 97935678, "body": "Note that both the parent and the child will call the <code>navigation</code> function, which means that you have four processes after the <code>fork</code> in <code>navigation</code>."}, {"owner": {"reputation": 51, "user_id": 11342694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9c6oIlRmZU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcCm3aJ5Umka-CNtDwrgueG_6E2jA/mo/photo.jpg?sz=128", "display_name": "Toyo U", "link": "https://stackoverflow.com/users/11342694/toyo-u"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1554930773, "post_id": 55621308, "comment_id": 97935750, "body": "@user3386109 what do you mean ? I am sorry if the answer is obvious, humor me I am still learning. I should not fork in navigation ?"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1554932018, "post_id": 55621308, "comment_id": 97936224, "body": "Your edit seems to have removed much of the code you asked about. Now you just show parts of the program, and it can&#39;t be compiled."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 11342694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9c6oIlRmZU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcCm3aJ5Umka-CNtDwrgueG_6E2jA/mo/photo.jpg?sz=128", "display_name": "Toyo U", "link": "https://stackoverflow.com/users/11342694/toyo-u"}, "edited": false, "score": 0, "creation_date": 1554931089, "post_id": 55621432, "comment_id": 97935902, "body": "Thanks that did it."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1554932101, "last_edit_date": 1554932101, "creation_date": 1554930887, "answer_id": 55621432, "question_id": 55621308, "link": "https://stackoverflow.com/questions/55621308/navigation-function-is-printing-all-its-output-twice/55621432#55621432", "title": "Navigation function is printing all its output twice", "body": "<p>When you call <code>lifeSupport()</code>, it forks a child. The child writes messages to all the <code>myPipeX</code> pipes, the parent reads from them and prints the messages, then both the parent and child return to <code>main()</code>.</p>\n\n<p>Then both processes call <code>navigation()</code>. They each create another child. The two children write to the <code>apipeX</code> pipes, the two parents read from them, and they each print the messages. So you get two copies of all the messages from <code>navigation()</code>.</p>\n\n<p>In each function, the child should call <code>exit()</code> after it's done, rather than returning. Only the parent should return to <code>main()</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 11342694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9c6oIlRmZU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcCm3aJ5Umka-CNtDwrgueG_6E2jA/mo/photo.jpg?sz=128", "display_name": "Toyo U", "link": "https://stackoverflow.com/users/11342694/toyo-u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55621432, "answer_count": 1, "score": 0, "last_activity_date": 1554932101, "creation_date": 1554930297, "last_edit_date": 1554931439, "question_id": 55621308, "link": "https://stackoverflow.com/questions/55621308/navigation-function-is-printing-all-its-output-twice", "title": "Navigation function is printing all its output twice", "body": "<p>When I call the functions individually in main they work fine, just printing the desired message once. Calling both functions, causes navigation to print its messages twice. </p>\n\n<p>I have looked up different solution. I tried using fflush(stdout) to no avail, i tried using a condition in the main to ensure they run individually.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;wait.h&gt;\n#include \"RAND_API.h\"\n#define MAXLEN 500\n\nvoid lifeSupport();\nvoid navigation();\n\nint main()\n{\n\n\n    lifeSupport();\n    navigation();\n    return 0;\n}\n\nvoid lifeSupport()\n{\n        //Create pipe\n\n\n        ret = write( myPipe[1], lifeSup1, strlen( lifeSup1 ) + 1 );\n        //sleep( getRandExponential() * 10 );\n        ret = write( myPipe2[1], lifeSup2, strlen( lifeSup2 ) + 1 );\n        //sleep( getSRand() * 6 );\n        sleep( getRandExponential() * 5 );\n        ret = write( myPipe3[1], lifeSup3, strlen( lifeSup3 ) + 1 );\n        sleep( getRandExponential() * 4 );\n        ret = write( myPipe4[1], lifeSup4, strlen( lifeSup4 ) + 1 );\n        close( myPipe[1] );\n        close( myPipe2[1] );\n        close( myPipe3[1] );\n        close( myPipe4[1] );\n    }\n    else\n    {\n        //wait(NULL);\n        close( myPipe[1] );\n        close( myPipe2[1] );\n        close( myPipe3[1] );\n        close( myPipe4[1] );\n        ret = read( myPipe[0], buffer, MAXLEN );\n        printf( \"%s\", buffer );\n        ret = read( myPipe2[0], buffer, MAXLEN );\n        printf( \"%s\", buffer );\n        ret = read( myPipe3[0], buffer, MAXLEN );\n        printf( \"%s\", buffer );\n        ret = read( myPipe4[0], buffer, MAXLEN );\n        printf( \"%s\", buffer );\n    }\n\n}\n\nvoid navigation()\n{\n       //create pipe\n\n        ret = write( apipe[1], nav1, strlen( nav1 ) + 1 );\n        ret = write( apipe2[1], nav2, strlen( nav2 ) + 1 );\n        //sleep( getSRand() * 6 );\n        ret = write( apipe3[1], nav3, strlen( nav3 ) + 1 );\n\n        close( apipe[1] );\n        close( apipe2[1] );\n        close( apipe3[1] );\n\n    }\n    else\n    {\n        close( apipe[1] );\n        close( apipe2[1] );\n        close( apipe3[1] );\n\n        ret = read( apipe[0], buff, MAXLEN );\n        printf( \"%s\\n\", buff );\n\n        ret = read( apipe2[0], buff, MAXLEN );\n        printf( \"%s\\n\", buff );\n\n        ret = read( apipe3[0], buff, MAXLEN );\n        printf( \"%s\\n\", buff );\n\n        close( apipe[0] );\n        close( apipe2[0] );\n        close( apipe3[0] );\n\n    }\n\n}\n\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Life support system initiiated\nAdjusting breathing gas levels\nAdjusting enviroment\nLife support system terminating\nInitiating navigation system\n\nInitiating navigation system\nMaking adjustments\n\n\nMaking adjustments\nAdjustments done. Navigation system terminating.\n\n\nAdjustments done. Navigation system terminating.\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>Life support system initiiated\nAdjusting breathing gas levels\nAdjusting enviroment\nLife support system terminating\nInitiating navigation system\nMaking adjustments\n\nAdjustments done. Navigation system terminating.\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 0, "creation_date": 1554930908, "post_id": 55621292, "comment_id": 97935806, "body": "What is <code>Line newLine = emptyLine();</code> doing? Perhaps this should be a pointer? Or you should be passing <code>newLine</code> into the function <code>emptyLine(&amp;newLine)</code>"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1554931386, "post_id": 55621292, "comment_id": 97936005, "body": "<code>char* newWord = malloc(sizeof(text));</code> allocates enough space for a single <code>char *</code>.  I don&#39;t think this is what you want unless.  Even if <code>buildWord()</code> somehow resizes this, it still is probably not intended.  I think perhaps you want <code>newWord = malloc(strlen(text));</code> (Note - <code>strlen()</code> is an evil function, prone to failure, but it demonstrates grabbing enough space for your string instead of a pointer.  Ugh - <code>sizeof(newLine.words) + sizeof(word) * 2)</code> does same thing.  these need to be size of array, not pointers...  Ok, every instance of your <code>malloc()</code> calls need changing."}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "edited": false, "score": 0, "creation_date": 1554931853, "post_id": 55621292, "comment_id": 97936166, "body": "Are you allowed to modify the incoming text? If so maybe you don&#39;t need to bother with <code>newWord</code> and you can just modify <code>text</code> directly and do away with the <code>malloc</code>. If not it would be good to declare <code>text</code> as <code>const</code> like <code>Line convertTextToLine(const char * text)</code>"}, {"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1554931909, "post_id": 55621292, "comment_id": 97936189, "body": "If <code>text</code> is a pointer, then <code>sizeof(text)</code> is the size for that pointer. On a PC this is typically 4 bytes.  <code>malloc(strlen(text))</code> can also be dangerous, since you may want to store the termination. I would go with <code>malloc(strlen(text)+1)</code>."}, {"owner": {"reputation": 1, "user_id": 11342730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bDhTo.jpg?s=128&g=1", "display_name": "Lauren Shultz", "link": "https://stackoverflow.com/users/11342730/lauren-shultz"}, "edited": false, "score": 0, "creation_date": 1554931917, "post_id": 55621292, "comment_id": 97936191, "body": "Thank you so much Michael! Changing the allocated space fixed it, I misunderstood what sizeof() was representing."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554931959, "post_id": 55621292, "comment_id": 97936200, "body": "It should be <code>malloc(strlen(text)+1)</code> to allow space for the trailing null byte."}], "owner": {"reputation": 1, "user_id": 11342730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bDhTo.jpg?s=128&g=1", "display_name": "Lauren Shultz", "link": "https://stackoverflow.com/users/11342730/lauren-shultz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554931510, "creation_date": 1554930221, "last_edit_date": 1554931510, "question_id": 55621292, "link": "https://stackoverflow.com/questions/55621292/c-pointer-array-of-structs-adds-3-items-then-each-new-item-added-blanks-out-pr", "title": "C - Pointer array of structs adds 3 items then each new item added blanks out previous items besides first 2", "body": "<p>I am writing a c program to parse a paragraph of text and created 3 structs to aid in the process where a block contains lines, a line contains words, and a word holds the text.</p>\n\n<pre><code>typedef struct word {\n    int length;\n    char* text;\n} Word;\n\ntypedef struct line {\n    int charachterCount;\n    int numberOfWords;\n    Word* words;\n} Line;\n\ntypedef struct textBlock {\n    int numberOfLines;\n    Line* lines;\n} Block;\n</code></pre>\n\n<p>When I try to add words to my line struct, the first 3 add fine. Once I add a fourth word, the 3rd word becomes \"\" and only the first 2 words and the 4th words record accurately. When I add a 5th word, the 3rd and 4th words become \"\" and only the 1st,2nd, and 5th words record accurately. And the cycle continues when more words are added, only the 1st, 2nd, and last words added record, every other address contains \"\". Here is ouput I printed:</p>\n\n<p>This is a key to what information is being printed:</p>\n\n<pre><code>Altered line: [EACH WORD IN LINE IS PRINTED FOLLOWED BY A SPACE]  : Ch#=[CHARACHTER COUNT], Word#=[WORD COUNT], LastAdd=[ADDRESS OF LAST WORD IN ARRAY], tAdd=[ADDRESS OF TEXT IN LAST WORD IN ARRAY]\n</code></pre>\n\n<pre><code>Line #: 13\nText Given: the Northeastern United States and the Southern United \n\nAltered line: the  : Ch#=4, Word#=1, LastAdd=0x7fa7d9d00ac0, tAdd=0x7fa7d9d00ac8\nAltered line: the Northeastern  : Ch#=17, Word#=2, LastAdd=0x7fa7d9d00ad0, tAdd=0x7fa7d9d00ad8\nAltered line: the Northeastern United  : Ch#=24, Word#=3, LastAdd=0x7fa7d9d00ae0, tAdd=0x7fa7d9d00ae8\nAltered line: the Northeastern  States  : Ch#=31, Word#=4, LastAdd=0x7fa7d9d00af0, tAdd=0x7fa7d9d00af8\nAltered line: the Northeastern   and  : Ch#=35, Word#=5, LastAdd=0x7fa7d9d00b00, tAdd=0x7fa7d9d00b08\nAltered line: the Northeastern    the  : Ch#=39, Word#=6, LastAdd=0x7fa7d9d00b10, tAdd=0x7fa7d9d00b18\nAltered line: the Northeastern    Southern  : Ch#=48, Word#=7, LastAdd=0x7fa7d9d00b20, tAdd=0x7fa7d9d00b28\nAltered line: the Northeastern     United  : Ch#=55, Word#=8, LastAdd=0x7fa7d9d00b30, tAdd=0x7fa7d9d00b38\nReturning line: the Northeastern     United  : Ch#=55, Word#=8, LastAdd=0x7fa7d9d00b30, tAdd=0x7fa7d9d00b38\n</code></pre>\n\n<p>Here is the code that is producing it:</p>\n\n<pre><code>void addWordToLine(Line* line, Word word) {\n    line-&gt;charachterCount = line-&gt;charachterCount + word.length + 1;\n    line-&gt;words[line-&gt;numberOfWords] = word;\n    line-&gt;numberOfWords = line-&gt;numberOfWords + 1;\n}\n\nLine convertTextToLine(char* text) {\n    Line newLine = emptyLine();\n    Word word;\n    char* newWord = malloc(sizeof(text));\n    int textIndex = 0;\n    int wordsIndex = 0;\n    int wordIndex = 0;\n\n    while (text[textIndex] != NIL) {\n        if (text[textIndex] == ' ' || text[textIndex] == '\\n') {\n            newWord[wordIndex] = '\\0';\n            if (wordIndex != 0) {\n                word = buildWord(newWord);\n                newLine.words = realloc(newLine.words, sizeof(newLine.words) + sizeof(word) * 2);\n                addWordToLine(&amp;newLine, word);\n                printf(\"Altered line: \");\n                printLine(newLine);\n                wordsIndex = wordsIndex + 1;\n            }\n            wordIndex = 0;\n        } else {\n            newWord[wordIndex] = text[textIndex];\n            wordIndex = wordIndex + 1;\n        }\n        textIndex = textIndex + 1;\n    }\n    if (wordIndex != 0) {\n        newWord[wordIndex] = '\\0';\n        word = buildWord(newWord);\n        newLine.words = realloc(newLine.words, sizeof(newLine.words) + sizeof(word));\n        addWordToLine(&amp;newLine, word);\n    }\n\n    printf(\"Returning line: \");\n    printLine(newLine);\n\n    return newLine;\n}\n\nWord buildWord(char* text) {\n    Word word;\n    word.count = 1;\n    word.text = malloc(sizeof(text));\n    strcpy(word.text, text);\n    word.length = getTextLength(text);\n    return word;\n}\n\nWord emptyWord() {\n    Word newWord;\n    newWord.count = 1;\n    newWord.length = 0;\n    newWord.text = malloc(sizeof(char));\n    return newWord;\n}\n\nLine emptyLine() {\n    Line newLine;\n    newLine.charachterCount = 0;\n    newLine.numberOfWords = 0;\n    newLine.words = malloc(sizeof(Word));\n    return newLine;\n}\n</code></pre>\n\n<p>Any help on why this is happening and how I can fix is appreciated, thanks!</p>\n"}, {"tags": ["c", "unix", "xv6"], "comments": [{"owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "edited": false, "score": 0, "creation_date": 1554930494, "post_id": 55621175, "comment_id": 97935648, "body": "if <code>arg</code> is of type <code>void*</code> then  <code>sizeof(*arg)</code> implies looking for <code>sizeof(void)</code> which I don&#39;t think is what you&#39;re looking for"}], "answers": [{"tags": [], "owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "is_accepted": false, "score": 0, "last_activity_date": 1554932227, "creation_date": 1554932227, "answer_id": 55621654, "question_id": 55621175, "link": "https://stackoverflow.com/questions/55621175/how-can-i-receive-void-0x12345678-argument/55621654#55621654", "title": "How can I receive (void *)0x12345678 argument?", "body": "<p>We don't see the declaration of <code>arg</code>, but it seems it's <code>void* arg</code>, so, your code should be:</p>\n\n<pre><code>argptr(1, (void*)&amp;arg, sizeof(arg))\n</code></pre>\n\n<p>I am not a language lawyer, so I don't know is <code>sizeof(void)</code> valid from a languages standard point of view, but most C compilers I used give <code>1</code> for it. C++ compilers usually report an error. In any case, it's not what you want here, you want <code>sizeof(void*)</code></p>\n"}], "owner": {"reputation": 27, "user_id": 9610447, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "so hyun Park", "link": "https://stackoverflow.com/users/9610447/so-hyun-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554932227, "creation_date": 1554929667, "question_id": 55621175, "link": "https://stackoverflow.com/questions/55621175/how-can-i-receive-void-0x12345678-argument", "title": "How can I receive (void *)0x12345678 argument?", "body": "<p>In test.c (user level)</p>\n\n<pre><code>tid = thread_create(thread, (void *)0x12345678, stack);\n\n</code></pre>\n\n<p>I want to receive arguments of above thread_create function. So, I wrote code in sysproc.c (kernel level)</p>\n\n<pre><code>if(argptr(0, (void*)&amp;function, sizeof(*function)) ||\n   argptr(1, (void*)&amp;arg, sizeof(*arg)) ||\n   argptr(2, (void*)&amp;stack, sizeof(*stack)))\n    return -1;\n</code></pre>\n\n<p>but, only the second line caused error. How can I change the code of this part??</p>\n\n<blockquote>\n  <p>argptr(1, (void*)&amp;arg, sizeof(*arg))</p>\n</blockquote>\n\n<p>I am working on xv6 os, and original defined function is </p>\n\n<pre><code>int thread_create(void *(*function)(void*), void *arg, void *stack);\n</code></pre>\n\n<p>and test.c cannot be chaged.</p>\n"}, {"tags": ["c", "struct", "account"], "comments": [{"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1554929483, "post_id": 55621044, "comment_id": 97935214, "body": "Depends on use case. Does the data need to persist between program executions? If it does (and doesn&#39;t need to be encrypted) I would consider storing it in a standardized format, like JSON, CSV, or XML. Also, what is a &#39;pin list&#39;?"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1554938361, "post_id": 55621044, "comment_id": 97938076, "body": "If you&#39;re practicing, try both approaches and see what works best. Apart from that, this question is kind of unclear because the problem statement assumes readers are aware of how your program works, while they really are not because of missing context."}, {"owner": {"reputation": 9, "user_id": 11317372, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157083031054650/picture?type=large", "display_name": "Lulcatsnin", "link": "https://stackoverflow.com/users/11317372/lulcatsnin"}, "edited": false, "score": 0, "creation_date": 1554965092, "post_id": 55621044, "comment_id": 97944421, "body": "Oh sorry i probably should of reworded the question to  whats the most efficient/ quickest way to store/modify and read data for c language in terms for a user account.  But i do think it would be a good learning opportunity to do both  @spline, il check those out and see if theyre a better alternative"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11317372, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157083031054650/picture?type=large", "display_name": "Lulcatsnin", "link": "https://stackoverflow.com/users/11317372/lulcatsnin"}, "edited": false, "score": 0, "creation_date": 1554965307, "post_id": 55621522, "comment_id": 97944510, "body": "oh ok, il steer clear of txt files then. il look into what  Reticulated Spline mentioned then."}], "tags": [], "owner": {"reputation": 26, "user_id": 2208545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab876c3e5192a6c9dabf35f59e6e75e?s=128&d=identicon&r=PG", "display_name": "Didier", "link": "https://stackoverflow.com/users/2208545/didier"}, "is_accepted": true, "score": 0, "last_activity_date": 1554931472, "creation_date": 1554931472, "answer_id": 55621522, "question_id": 55621044, "link": "https://stackoverflow.com/questions/55621044/storing-data-in-a-struct-or-txt-file/55621522#55621522", "title": "Storing data in a struct or txt file?", "body": "<p>It may depend on your operating system and the language/development tools you use as some will have libraries allowing easy access to structured data in a standardized format as pointed out above.\nText files are rarely the way to go long term since you will have to write all the code yourself, not only creating a lot of work but opening yourself to bugs and potential security issues. If you can use a library, a lot of that work is already done for you.</p>\n"}], "owner": {"reputation": 9, "user_id": 11317372, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157083031054650/picture?type=large", "display_name": "Lulcatsnin", "link": "https://stackoverflow.com/users/11317372/lulcatsnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55621522, "answer_count": 1, "score": 0, "last_activity_date": 1554931472, "creation_date": 1554928955, "last_edit_date": 1554929167, "question_id": 55621044, "link": "https://stackoverflow.com/questions/55621044/storing-data-in-a-struct-or-txt-file", "title": "Storing data in a struct or txt file?", "body": "<p>Im making an mock ATM program for practice and was wondering is it better\nto </p>\n\n<ol>\n<li>store someones account information in a struct on another file and have each users information on that </li>\n<li>Have it all in a txt file and just read it while making an algorithm to grab what you need based on pin location ?</li>\n</ol>\n\n<p>right now iv just made a pin list in a text file which counts and stores the data into an array which i check which then opens an account based on that user input ect ect.</p>\n\n<p>i can see both working but was just wondering whats the proper process for stuff such as this ?</p>\n"}, {"tags": ["c", "fork", "fwrite"], "comments": [{"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1554929205, "post_id": 55621013, "comment_id": 97935105, "body": "Could you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 91, "user_id": 11053625, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2G0mz8F7LQ/AAAAAAAAAAI/AAAAAAAAJko/3E3TwdHZRos/photo.jpg?sz=128", "display_name": "jpedrosous", "link": "https://stackoverflow.com/users/11053625/jpedrosous"}, "reply_to_user": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1554929625, "post_id": 55621013, "comment_id": 97935272, "body": "Hi! I managed to scrub some lines from my code but I think this is really the minimum I can get..."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1554929695, "post_id": 55621013, "comment_id": 97935300, "body": "Output is buffered in the process, not immediately written to disk (or disk cache).  If you want other processes to se the data, then use <code>fflush</code>"}, {"owner": {"reputation": 91, "user_id": 11053625, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2G0mz8F7LQ/AAAAAAAAAAI/AAAAAAAAJko/3E3TwdHZRos/photo.jpg?sz=128", "display_name": "jpedrosous", "link": "https://stackoverflow.com/users/11053625/jpedrosous"}, "edited": false, "score": 0, "creation_date": 1554929773, "post_id": 55621013, "comment_id": 97935334, "body": "Ok, thanks! But where exactly should I put the fflush?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554930356, "post_id": 55621013, "comment_id": 97935591, "body": "I don&#39;t think it&#39;s a flushing problem, since you <code>fclose()</code> immediately after your <code>fwrite()</code>s, and closing also flushes."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554930526, "post_id": 55621013, "comment_id": 97935660, "body": "What are <code>n</code> and <code>np</code>?"}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1554974326, "post_id": 55621013, "comment_id": 97949375, "body": "@Jos&#233;PedroSousa The question has been answered nicely, but still, when we ask for a MCVE is because people don&#39;t like to guess what the variables/function you&#39;re using mean. Your code should be ready to copy and paste in an IDE, compile and run. In your case, for example, n and np are undefined."}, {"owner": {"reputation": 91, "user_id": 11053625, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2G0mz8F7LQ/AAAAAAAAAAI/AAAAAAAAJko/3E3TwdHZRos/photo.jpg?sz=128", "display_name": "jpedrosous", "link": "https://stackoverflow.com/users/11053625/jpedrosous"}, "edited": false, "score": 0, "creation_date": 1554980530, "post_id": 55621013, "comment_id": 97953007, "body": "Oh, I&#39;m very much sorry... I really intended to decrease as much as possible the amount of code, but really forgot to specify the values of n and np. They could be, for example, n = 660 and np = 4. The purpose of the program is to create np processes, each one summing the square of the n/np numbers and then sum them all at the end."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1554931345, "post_id": 55621373, "comment_id": 97935994, "body": "Yes, the problem is likely the open mode.  No, append mode is not the answer, as it always writes at the <i>end</i> of the file, not the current position.  To open a binary file without truncating, and also to allow writing other than at (current) end-of-file, the needed mode would be <code>&quot;r+b&quot;</code> or, equivalently, <code>&quot;rb+&quot;</code>.  The <code>b</code> can be omitted on Linux, and I think on <i>any</i> current platform that supports <code>fork()</code>, but it makes a difference on some other platforms, such as Windows."}, {"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554979523, "post_id": 55621373, "comment_id": 97952481, "body": "Even with his fseek() just after opening the file?"}, {"owner": {"reputation": 91, "user_id": 11053625, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2G0mz8F7LQ/AAAAAAAAAAI/AAAAAAAAJko/3E3TwdHZRos/photo.jpg?sz=128", "display_name": "jpedrosous", "link": "https://stackoverflow.com/users/11053625/jpedrosous"}, "edited": false, "score": 0, "creation_date": 1554980674, "post_id": 55621373, "comment_id": 97953089, "body": "Thank you very much you both! It worked perfectly just by changing &quot;w&quot; to &quot;r+&quot; since I&#39;m on POSIX (mac) and it is meant to be run on a Linux machine. Thank you!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1554983381, "post_id": 55621373, "comment_id": 97954683, "body": "Yes, @B.Go.  That is key characteristic of the append modes: writes <i>always</i> go to the end of the file (they are appended) regardless of the file offset immediately prior to the write."}], "tags": [], "owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "is_accepted": true, "score": 1, "last_activity_date": 1555004527, "last_edit_date": 1555004527, "creation_date": 1554930598, "answer_id": 55621373, "question_id": 55621013, "link": "https://stackoverflow.com/questions/55621013/two-processes-writing-on-the-same-file/55621373#55621373", "title": "Two processes writing on the same file", "body": "<p>The problem is due to <code>fopen(\"./parciais.txt\", \"w\")</code> :<br>\n\"w\" : \"Creates an empty file for writing. If a file with the same name already exists, its content is erased and the file is considered as a new empty file.\"<br>\n<s>Try with \"a\" instead!</s><br>\n(\"Appends to a file. Writing operations, append data at the end of the file. The file is created if it does not exist.\")<br>\n<br>\nAs mentioned in another answer, the \"a\" argument is not enough either. The file must be created once, hence in the main process, and then accessed in \"r+b\" mode for the fseek to work correctly!</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 11053625, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2G0mz8F7LQ/AAAAAAAAAAI/AAAAAAAAJko/3E3TwdHZRos/photo.jpg?sz=128", "display_name": "jpedrosous", "link": "https://stackoverflow.com/users/11053625/jpedrosous"}, "edited": false, "score": 0, "creation_date": 1554980607, "post_id": 55622068, "comment_id": 97953043, "body": "It worked like a charm! I really didn&#39;t read the &quot;it overwrites the current file&quot; in the documentation. A small error that makes a huge difference. Thank you very much!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1554934633, "creation_date": 1554934633, "answer_id": 55622068, "question_id": 55621013, "link": "https://stackoverflow.com/questions/55621013/two-processes-writing-on-the-same-file/55622068#55622068", "title": "Two processes writing on the same file", "body": "<p>As @B.Go already answered, the main problem is that you are opening the file with mode <code>\"w\"</code>, which truncates it to zero length if it already exists.  Each child process does this, clobbering the contents written by the previous one.</p>\n\n<p>You want this combination of behaviors for the file:</p>\n\n<ul>\n<li>it is created if it does not already exist (or I suppose you want this, at least)</li>\n<li>it is <em>not</em> truncated upon opening if it <em>does</em> already exist</li>\n<li>you may write to it</li>\n<li>writes start at the current file offset, as opposed to automatically going to the current end of the file</li>\n<li>the file is binary, not subject to any kind of character translation or to tail truncation upon writing to it</li>\n</ul>\n\n<p>Unfortunately, there is no standard mode that provides all of it: the various <code>r</code> modes require that the file already exist, the <code>w</code> modes truncate the file if it does already exist, and the <code>a</code> modes direct all writes to the current end of the file, regardless of the stream's current offset.  If you can assume that the file will already exist then mode <code>\"r+b\"</code>, which can also be spelled <code>\"rb+\"</code>, has all the wanted characteristics except creating the file if it doesn't exist:</p>\n\n<pre><code>    aux = fopen(\"./parciais.txt\", \"r+b\");\n</code></pre>\n\n<p>That permits reading as well, but just because you <em>can</em> read from the file doesn't mean you have to do.  Additionally, on Linux and POSIX-conforming systems, there is no distinction between binary and text files, so you can omit the <code>b</code> if you are confident that your program needs to run only on POSIX systems.  That you are using <code>fork()</code> suggests that this condition may apply to you.</p>\n\n<p>If you must provide for creating the file, too, then open it once at the very beginning of the program, using any of the <code>w</code> or <code>a</code> modes depending on whether you want to truncate the file, then immediately close it again:</p>\n\n<pre><code>FILE *aux = fopen(\"./parciais.txt\", \"a\");\nif (aux) {\n    fclose(aux);\n} else {\n    // handle error ...\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 11053625, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2G0mz8F7LQ/AAAAAAAAAAI/AAAAAAAAJko/3E3TwdHZRos/photo.jpg?sz=128", "display_name": "jpedrosous", "link": "https://stackoverflow.com/users/11053625/jpedrosous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 55621373, "answer_count": 2, "score": 0, "last_activity_date": 1555004527, "creation_date": 1554928794, "last_edit_date": 1554929730, "question_id": 55621013, "link": "https://stackoverflow.com/questions/55621013/two-processes-writing-on-the-same-file", "title": "Two processes writing on the same file", "body": "<p>I know this is recipe for disaster. And I actually made it work using shared variables. </p>\n\n<p>But it's homework, and teacher definitely wants us to put many processes writing to the same file using different file pointers. I've been trying all day with little success, but I just can't find why this fails.</p>\n\n<p>I have approached the problem in the folowing way:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int status;\n    int process_count = 0;\n\n    do\n    {\n        int from = (n / np) * (process_count) + 1;\n        int to = (n / np) * (process_count + 1);\n\n        if (fork() == 0)\n        {\n            FILE *aux;\n            aux = fopen(\"./parciais.txt\", \"w\");\n            fseek(aux, sizeof(int) * process_count, SEEK_SET);\n\n            int sum = 0;\n            int i = from;\n            while (i &lt;= to)\n            {\n                int square = i * i;\n                sum += square;\n                i++;\n            }\n\n            long int where_am_i = ftell(aux);\n            printf(\"I am process %i writing %i on byte: %li\\n\", process_count, sum, where_am_i);\n\n            fwrite(&amp;sum, sizeof(int), 1, aux);\n            fclose(aux);\n            exit(1);\n        }\n        else\n        {\n            wait(&amp;status);\n            process_count++;\n        }\n    } while (process_count &lt; np);\n\n    FILE *aux;\n    aux = fopen(\"./parciais.txt\", \"r\");\n\n    int sum;\n    for (int i = 0; i &lt;= np - 1; i++)\n    {\n\n        fseek(aux, sizeof(int) * i, SEEK_SET);\n        long int where_am_i = ftell(aux);\n\n        int read;\n        fread(&amp;read, sizeof(int), 1, aux);\n        printf(\"I am reading %i at byte: %li\\n\", read, where_am_i);\n\n        sum += read;\n    }\n}\n</code></pre>\n\n<p>I expected the output to be something such as:</p>\n\n<pre><code>I am process 0 writing 98021 on byte: 0\nI am process 1 writing 677369 on byte: 4\nI am process 2 writing 1911310 on byte: 8\nI am reading 98021 at byte: 0\nI am reading 677369 at byte: 4\nI am reading 1911310 at byte: 8\n</code></pre>\n\n<p>But I get:</p>\n\n<pre><code>I am process 0 writing 98021 on byte: 0\nI am process 1 writing 677369 on byte: 4\nI am process 2 writing 1911310 on byte: 8\nI am reading 0 at byte: 0\nI am reading 0 at byte: 4\nI am reading 1911310 at byte: 8\n</code></pre>\n\n<p>This means, for some reason, only the last value is written.</p>\n\n<p>I've been banging my head on the wall over this and I just can't find where's the catch... Can someone please lend me a hand?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554928348, "post_id": 55620882, "comment_id": 97934728, "body": "Welcome to Stack Overflow! <a href=\"https://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\">Why <code>while (!feof(fd))</code> is wrong</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554928431, "post_id": 55620882, "comment_id": 97934756, "body": "What does the file content look like?"}, {"owner": {"reputation": 1, "user_id": 11342634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb045642cb49fff8957f02163bd7c27c?s=128&d=identicon&r=PG&f=1", "display_name": "Vesprs", "link": "https://stackoverflow.com/users/11342634/vesprs"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554928886, "post_id": 55620882, "comment_id": 97934961, "body": "b.txt is 5 columns of 1234567D 37500 20 10 0 3234567F 40000 20 10 0 5234567G 42000 20 10 0 6234567N 45000 20 10 0 8234567B 47000 20 10 0 4234567F 50000 20 10 0 5234567M 55000 20 10 0 7734567E 60000 20 10 0 2254893R 75000 20 10 0 and e.txt is 7 columns of  Jimmy OBrien 1234567D Irish 40 1 2 David Keogh 3234567F Irish 61 0 0 David Hanahoe 5234567G Irish 48 1 2 Tom Byrne 6234567N Irish 62 1 4 Thomas Collins 8234567B Irish 35 0 0 Aoife Murphy 4234567F Irish 63 1 3 Joan OBrien 5234567M Irish 36 1 1 Maria Ionescu 7734567E Romanian 43 1 2 Celine Keogh 2254893R Irish 38 1 0"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554929009, "post_id": 55620882, "comment_id": 97935005, "body": "Don&#39;t use <code>%c</code> to skip over whitespace between items. Just put a space in the format string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554929061, "post_id": 55620882, "comment_id": 97935035, "body": "Put the space <i>before</i> each item in the format string, it will then do the right thing when going past newlines."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554929216, "post_id": 55620882, "comment_id": 97935107, "body": "One of the first things you need to learn about is debuggers. You can step through the program this way, and see what it&#39;s doing when it crashes."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554929227, "post_id": 55620882, "comment_id": 97935110, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 1, "user_id": 11342634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb045642cb49fff8957f02163bd7c27c?s=128&d=identicon&r=PG&f=1", "display_name": "Vesprs", "link": "https://stackoverflow.com/users/11342634/vesprs"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554929293, "post_id": 55620882, "comment_id": 97935141, "body": "It compiles without any errors but the programme still exits when I select read_files."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554929366, "post_id": 55620882, "comment_id": 97935172, "body": "Compilers can&#39;t detect problems that only occur during runtime. That&#39;s why you need to learn how to debug."}, {"owner": {"reputation": 1, "user_id": 11342634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb045642cb49fff8957f02163bd7c27c?s=128&d=identicon&r=PG&f=1", "display_name": "Vesprs", "link": "https://stackoverflow.com/users/11342634/vesprs"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554929469, "post_id": 55620882, "comment_id": 97935206, "body": "Ok thanks Barmar I&#39;ll give that a try."}], "owner": {"reputation": 1, "user_id": 11342634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb045642cb49fff8957f02163bd7c27c?s=128&d=identicon&r=PG&f=1", "display_name": "Vesprs", "link": "https://stackoverflow.com/users/11342634/vesprs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554928178, "creation_date": 1554928178, "question_id": 55620882, "link": "https://stackoverflow.com/questions/55620882/my-programme-exits-when-i-try-to-read-files-to-a-structure", "title": "My programme exits when I try to read files to a structure", "body": "<p>When I try to read the files to my structure using case 1 in my menu the programme just exits.</p>\n\n<p>I tried reading in both files into the structures as separate functions but both seem to end my function and when I tried to put them in main the same happened again.\nAt this stage I've pretty much run out of ideas as I'm pretty new to c language and only have a few weeks on it.</p>\n\n<pre><code>FILE* fp;\n\n/* structured type definition */\ntypedef struct empl\n{\n    char name[20];\n    char surn[20];\n    char PPS[20];\n    char nat[20];\n    int age;\n    int mar;\n    int cld;\n\n} empl_type;\n\ntypedef struct benf\n{\n    char PPS[20];\n    int sal;\n    int pen;\n    int hlt;\n    int all;\n\n} benf_type;\n\n\n/* 1-dimensional array that stores benefits related data for all registered employees*/\n    benf_type benf[5000];\n    /* 1-dimensional array that stores employees related data */\n    empl_type empl[5000];\n    /* no current registered empl (no records) */\n    int noempl = 0;\n    /* no current benefits (no records) */\n    int nobenf = 0;\n\n\n/* main function */\nint main()\n{\n\n    int ans = 1;\n\n    /* welcome message */\n    printf(\"Welcome to the program!\\n\");\n\n    while(ans != 6)\n    {\n        printf(\"Menu\\n\");\n        printf(\"1-Read data from files\\n\");\n        printf(\"2-Apply allowance\\n\");\n        printf(\"3-Search\\n\");\n        printf(\"4-Print to screen\\n\");\n        printf(\"5-Write data in files\\n\");\n        printf(\"6-Exit\\n\");\n        scanf(\"%d\", &amp;ans);\n\n        switch(ans)\n        {\n            case 1: read_files(); break;\n            case 2: apply_allow(benf, nobenf); break;\n            case 3: search_PPS(); break;\n            case 4: print_screen(); break;\n            case 5: write_file(); break;\n        }\n    }\n    printf(\"Goodbye!\\n\");\n\n    return (EXIT_SUCCESS);\n}\n\nvoid read_files()\n{\n\n        noempl = read_empl_file(\"e.txt\", empl);\n\n        nobenf = read_benf_file(\"b.txt\", benf);\n\n}\n\nint read_empl_file(char* file_name, empl_type empl[])\n{\n\n    char ch;\n\n    /* open file */\n    fp = fopen(file_name, \"r\");\n    while(!feof(fp))\n    {\n        /* read on record from file */\n        fscanf(fp,\"%s%c%s%c%s%c%s%c%d%c%d%c%d%c\", empl[noempl].name, &amp;ch, empl[noempl].surn, &amp;ch, empl[noempl].PPS, &amp;ch, empl[noempl].nat, &amp;ch, &amp;empl[noempl].age, &amp;ch, &amp;empl[noempl].mar, &amp;ch, &amp;empl[noempl].cld, &amp;ch);\n\n        /* increase the number of records read*/\n        noempl++;\n    }\n\n    /* close file */\n    fclose(fp);\n    return noempl;\n}\n\nint read_benf_file(char* file_name, benf_type benf[])\n{\n\n    char ch;\n\n    /* open file */\n    fp = fopen(file_name, \"r\");\n    while(!feof(fp))\n    {\n        /* read on record from file */\n        fscanf(fp,\"%s%c%d%c%d%c%d%c%d%c\", benf[nobenf].PPS, &amp;ch, &amp;benf[nobenf].sal, &amp;ch, &amp;benf[nobenf].pen, &amp;ch, &amp;benf[nobenf].hlt, &amp;ch, &amp;benf[nobenf].all, &amp;ch);\n\n        /* increase the number of records read*/\n        nobenf++;\n    }\n\n    /* close file */\n    fclose(fp);\n    return nobenf;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "dup2"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554928282, "post_id": 55620840, "comment_id": 97934693, "body": "What exactly does &quot;not working for me&quot; mean?  Doesn&#39;t compile?  Crashes at runtime? Produces the wrong result?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1554928288, "post_id": 55620840, "comment_id": 97934697, "body": "Looks OK to me as long as <code>&quot;history.txt&quot;</code> exists, otherwise add <code>O_CREAT</code>. Error checking + <code>perror</code> or running under <code>strace</code> should reveal what the problem is."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554928292, "post_id": 55620840, "comment_id": 97934699, "body": "Does <code>fflush(stdout);</code> after the <code>printf()</code> fix it?"}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554928394, "post_id": 55620840, "comment_id": 97934743, "body": "it does not print into a file just prints into terminal @JohnBollinger"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554928596, "post_id": 55620840, "comment_id": 97934826, "body": "You are not checking the return values of your function calls so as to recognize whether they succeed.  Chances are good that your call to <code>open()</code> is failing, and as a result, your call to <code>dup2()</code> is failing as well.  That would leave you with the standard output still connected to the terminal (or whatever else it was originally connected to)."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1554928737, "post_id": 55620840, "comment_id": 97934872, "body": "if(!fw){perror(&quot;FILE NOT FOUND)&quot;);} is not giving me any error"}, {"owner": {"reputation": 2653, "user_id": 3515931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0edddc6a265a0a22058bb2343328d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnH", "link": "https://stackoverflow.com/users/3515931/johnh"}, "edited": false, "score": 0, "creation_date": 1554929202, "post_id": 55620840, "comment_id": 97935104, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29154056/redirect-stdout-to-a-file\">Redirect stdout to a file</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554930050, "post_id": 55620840, "comment_id": 97935470, "body": "I don&#39;t see why you would expect <code>if (!fw)</code> to detect errors, since <code>open</code> returns -1 on error, and -1 is truthy."}], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1554928814, "post_id": 55620999, "comment_id": 97934907, "body": "This is giving me Permission denied"}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1554928878, "post_id": 55620999, "comment_id": 97934957, "body": "on open in function"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1554929011, "post_id": 55620999, "comment_id": 97935006, "body": "@BassamMetwally And can you not troubleshoot that? What&#39;s your current directory what are its permissions  (try running <code>system(&quot;stat \\&quot;$PWD\\&quot; history.txt&quot;);</code>)."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1554929093, "post_id": 55620999, "comment_id": 97935050, "body": "@BassamMetwally You also need a mode argument with the <code>O_CREAT</code> flag. I had forgotten that one."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 1, "creation_date": 1554929280, "post_id": 55620999, "comment_id": 97935135, "body": "YES! this worked THANK YOU. I just ran chmod to allow for writing and reading."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 1, "last_activity_date": 1554929067, "last_edit_date": 1554929067, "creation_date": 1554928740, "answer_id": 55620999, "question_id": 55620840, "link": "https://stackoverflow.com/questions/55620840/dup2-not-switching-to-file/55620999#55620999", "title": "dup2 not switching to file?", "body": "<p>Your code with error checking:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint saveHistoryToFile(char *history);\n\nint main(int argc, char **argv){\n  char *something = \"hello\";\n  if(0&gt;saveHistoryToFile(something)) return 1;\n  if(0&gt;fclose(stdout)) return perror(\"fclose\"),-1;\n}\n\nint saveHistoryToFile(char *history){\n  int fw = open(\"history.txt\",O_WRONLY | O_APPEND /*|O_CREAT, 0640*/ );\n  if (0&gt;fw) return perror(\"open\"),-1;\n  if (0&gt;dup2(fw, 1)) return perror(\"dup2\"),-1;\n  if (0&gt;(printf(\"%s\", history)))  return perror(\"printf\"),-1;\n}\n</code></pre>\n\n<p>On a first run, I get \"open: No such file or directory\" because I do not have <code>\"history.txt\"</code> in my current directory.</p>\n\n<p>If I add it or uncomment the <code>O_CREAT, 0640</code>, it runs fine on my machine.</p>\n\n<p>Of course, you might run into other problems (e.g, <code>EPERM</code>) but the <code>perror</code>s should give you a hint.</p>\n"}], "owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 55620999, "answer_count": 1, "score": 0, "last_activity_date": 1560680964, "creation_date": 1554928000, "last_edit_date": 1560680964, "question_id": 55620840, "link": "https://stackoverflow.com/questions/55620840/dup2-not-switching-to-file", "title": "dup2 not switching to file?", "body": "<p>I'm trying to learn <code>dup2</code> and switch the stdout to a file rather than terminal. This is the example that works everywhere but not sure why it is not working for me. I don't think I need a fork() because I don't need a different process for execute just the print statement in file.</p>\n\n<p>Where function is called:</p>\n\n<pre><code>int main(int argc, char **argv){\n  char *something = \"hello\";\n  saveHistoryToFile(something);\n}\n</code></pre>\n\n<p>//This is the function. There is a file names history .txt</p>\n\n<pre><code>void saveHistoryToFile(char *history){\n  int fw = open(\"history.txt\",O_WRONLY | O_APPEND);\n  dup2(fw, 1);\n  printf(\"%s\", history);\n}\n</code></pre>\n\n<p>THE ERROR: it prints into terminal not file! </p>\n"}, {"tags": ["c", "function", "static", "int"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8076833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48158d7de65f79717ce89175f4009453?s=128&d=identicon&r=PG&f=1", "display_name": "Matin N.", "link": "https://stackoverflow.com/users/8076833/matin-n"}, "edited": false, "score": 0, "creation_date": 1554928488, "post_id": 55620877, "comment_id": 97934777, "body": "Does this apply to normal integers as well? will int a = 7 when a is already initialized, change its value?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 15, "user_id": 8076833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48158d7de65f79717ce89175f4009453?s=128&d=identicon&r=PG&f=1", "display_name": "Matin N.", "link": "https://stackoverflow.com/users/8076833/matin-n"}, "edited": false, "score": 0, "creation_date": 1554928767, "post_id": 55620877, "comment_id": 97934884, "body": "@MatinN.: When <code>int a = 7;</code> appears inside a function, it has automatic storage duration. A lifetime of an object with storage duration (that is not a variable length array) begins each time its associated block is entered, but the initialization does occur only when program execution reaches the declaration statement. (For a variable length array, a lifetime begins when its declaration is reached.)"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1554928840, "last_edit_date": 1554928840, "creation_date": 1554928168, "answer_id": 55620877, "question_id": 55620830, "link": "https://stackoverflow.com/questions/55620830/not-understanding-the-function-of-static-int-in-c/55620877#55620877", "title": "Not understanding the function of static int in C", "body": "<p>A static object is initialized, conceptually, when it is created.</p>\n\n<p>The lifetime of a static object begins when the program starts executing and continues until execution ends.</p>\n\n<p>So, when the program starts executing, <code>y</code> is initialized to 0. After that, its value changes only when it is modified, as with assignment statements. The statement that defines it, <code>static int y = 0;</code>, does not modify it after the initialization.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1554928219, "creation_date": 1554928219, "answer_id": 55620888, "question_id": 55620830, "link": "https://stackoverflow.com/questions/55620830/not-understanding-the-function-of-static-int-in-c/55620888#55620888", "title": "Not understanding the function of static int in C", "body": "<p>Variables declared as <code>static</code> inside of a function retain their value through the lifetime of the program, even when the variable name goes out of scope.  The initializer for a <code>static</code> variable is <em>only</em> applied at program startup.</p>\n\n<p>So when the program starts, <code>y</code> is initialized to 0.  Then in the first call to <code>func</code> it sets <code>y</code> to 2.  This value is retained even after the function exits.  So when <code>func</code> is called a second time, <code>y</code> is still 2 when the function starts.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 2847543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d50415555f90ae7e1b1042486311545e?s=128&d=identicon&r=PG", "display_name": "Mohammad Noor", "link": "https://stackoverflow.com/users/2847543/mohammad-noor"}, "is_accepted": false, "score": 0, "last_activity_date": 1554928427, "creation_date": 1554928427, "answer_id": 55620931, "question_id": 55620830, "link": "https://stackoverflow.com/questions/55620830/not-understanding-the-function-of-static-int-in-c/55620931#55620931", "title": "Not understanding the function of static int in C", "body": "<p>static means you have only one shared value of the variable, you can imagine it declared as a global variable keeps its value between multiple function calls.</p>\n\n<p>First times you called the funct1 with x = 1 so y returned as 2.\nThe next time you called the function func1 with x = 2, the value of y will not be declared again but will use the last value of last call (y=2), and update it with y = x + 1 to be 3.</p>\n\n<p>TLDR;\nRead the static declaration of a variable only once (static int y = 0), and do not back to it again, use the last value of it next times.</p>\n"}], "owner": {"reputation": 15, "user_id": 8076833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48158d7de65f79717ce89175f4009453?s=128&d=identicon&r=PG&f=1", "display_name": "Matin N.", "link": "https://stackoverflow.com/users/8076833/matin-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55620877, "answer_count": 3, "score": 0, "last_activity_date": 1554928840, "creation_date": 1554927974, "question_id": 55620830, "link": "https://stackoverflow.com/questions/55620830/not-understanding-the-function-of-static-int-in-c", "title": "Not understanding the function of static int in C", "body": "<p>I'm trying to understand this piece of code, but I don't know why the amount of a static variable sometimes changes and sometimes not.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint func1 (int x)\n{\n    extern int a;\n    static int y=0;\n    printf(\"%d\\n%d\\n\",a,y);\n    a=x+5; y=x+1;\n    {int y=10; printf(\"%d\\n\",y);}\n    return y;\n}\nint a;\nint main()\n{\n    a=func1(1);\n    printf(\"%d\\n\",a);\n    {\n        int a=1;\n        printf(\"%d\\n\", a);\n    }\n    a=func1(a);\n    printf(\"%d\",a);\n    return 0;\n}\n\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>0\n\n0\n\n10\n\n2\n\n1\n\n2\n\n2\n\n10\n\n3\n</code></pre>\n\n<p>At first, when <code>a = func(1)</code> is run, <code>y</code> is declared as <code>0</code> and then changes to <code>2</code> and it prints <code>2</code>. But when it runs <code>a = func(a)</code> when <code>a</code> is <code>2</code>, I expected that <code>y</code> will become <code>0</code> through <code>static int y = 0</code> but <code>y</code> doesn't change. Why it doesn't happen?</p>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1555057769, "post_id": 55620699, "comment_id": 97984058, "body": "If you have an OpenMP 5.0 compiler then you don&#39;t need to do any of this since OpenP 5.0 has the &quot;scan&quot; directive... (Section 2.9.6 on p132 of the standard, which you can download from <a href=\"http://openmp.org\" rel=\"nofollow noreferrer\">openmp.org</a> if you follow your nose)."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1554929962, "creation_date": 1554929962, "answer_id": 55621241, "question_id": 55620699, "link": "https://stackoverflow.com/questions/55620699/openmp-prefix-sum-algorithm/55621241#55621241", "title": "OpenMP: Prefix Sum Algorithm", "body": "<blockquote>\n  <p>Above the <code>10 + 5 = 15</code> should be <code>9 + 5 = 14</code>, but the <code>Y[2]</code> was overwritten by another thread. I want to use that <code>Y[2]</code> what was before the for-loop started.</p>\n</blockquote>\n\n<p>With OpenMP, you always have to consider whether your code is correct for the serial case, with a single thread, because</p>\n\n<ol>\n<li>It might in fact run that way, and</li>\n<li>If it's incorrect serially, then it's virtually certain to be incorrect as a parallel program, too.</li>\n</ol>\n\n<p>Your code is not correct serially.  It appears you could fix that by running the problem loop backward, from <code>i</code> = <code>p - 1</code> to <code>k</code>, but in fact that's not sufficient for parallel operation.</p>\n\n<p>Your best bet appears to be to accumulate your partial results into a different array than holds the results of the previous cycle.  For example, you might flip between <code>X</code> and <code>Y</code> as data source and result, with a little pointer wrangling to grease the iterative wheels.  Or you might do it a little more easily by using a 2D array instead of separate X and Y.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11341904, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZeMEMDQXURA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdT5-z9oWugGoW6R0cxPo3b0TecVw/mo/photo.jpg?sz=128", "display_name": "Cluner", "link": "https://stackoverflow.com/users/11341904/cluner"}, "is_accepted": false, "score": 0, "last_activity_date": 1554945814, "creation_date": 1554945814, "answer_id": 55623388, "question_id": 55620699, "link": "https://stackoverflow.com/questions/55620699/openmp-prefix-sum-algorithm/55623388#55623388", "title": "OpenMP: Prefix Sum Algorithm", "body": "<p><strong>UPDATE for Stage III.</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int num_threads = 8;\nint k = 2;\nwhile (k &lt; p)\n{\n    #pragma omp parallel for ordered num_threads(k &lt; num_threads ? 1 : num_threads)\n    for (i = p - 1; i &gt;= k; i--)\n    {\n        Y[i] = Y[i - k] + Y[i];\n    }\n    k += k;\n}\n</code></pre>\n\n<p>The code above solved my problem. It's now working with parallel, except the first few round.</p>\n"}], "owner": {"reputation": 13, "user_id": 11341904, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZeMEMDQXURA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdT5-z9oWugGoW6R0cxPo3b0TecVw/mo/photo.jpg?sz=128", "display_name": "Cluner", "link": "https://stackoverflow.com/users/11341904/cluner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "accepted_answer_id": 55621241, "answer_count": 2, "score": 1, "last_activity_date": 1554945814, "creation_date": 1554927433, "question_id": 55620699, "link": "https://stackoverflow.com/questions/55620699/openmp-prefix-sum-algorithm", "title": "OpenMP: Prefix Sum Algorithm", "body": "<p><strong>I'm trying to implement a Prefix Sum Algorithm in C using OpenMP, and I'm stuck.</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;omp.h&gt;\n\nint main(int argc, char* argv[])\n{\n    int p = 5;\n    int X[5] = { 1, 5, 4, 2, 3 };\n    int* Y = (int*)malloc(p * sizeof(int));\n\n    for (int i = 0; i &lt; p; i++)\n        printf(\"%d \", X[i]);\n    printf(\"\\n\");\n\n    Y[0] = X[0];\n\n    int i;\n    #pragma omp parallel for num_threads(4)\n    for (i = 1; i &lt; p; i++)\n        Y[i] = X[i - 1] + X[i];\n\n    int k = 2;\n    while (k &lt; p)\n    {\n        int i;\n        #pragma omp parallel for\n        for (i = k; i &lt; p; i++)\n            Y[i] = Y[i - k] + Y[i];\n        k += k;\n    }\n\n    for (int i = 0; i &lt; p; i++)\n        printf(\"%d \", Y[i]);\n    printf(\"\\n\");\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p><strong>What this code should do?</strong></p>\n\n<blockquote>\n  <p><em>Input</em> numbers are in <code>X</code>, <br>\n  <em>output</em> numbers are (prefixes) in <code>Y</code> <br>\n  and the <em>number count</em> is <code>p</code>.</p>\n</blockquote>\n\n<p><code>X = 1, 5, 4, 2, 3</code></p>\n\n<p><strong>Stage I.</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>Y[0] = X[0];\n</code></pre>\n\n<blockquote>\n  <p><code>Y[0] = 1</code></p>\n</blockquote>\n\n<p><strong>Stage II.</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int i;\n#pragma omp parallel for num_threads(4)\nfor (i = 1; i &lt; p; i++)\n    Y[i] = X[i - 1] + X[i];\n</code></pre>\n\n<p>Example:</p>\n\n<blockquote>\n  <p><code>Y[1] = X[0] + X[1] = 6</code><br>\n  <code>Y[2] = X[1] + X[2] = 9</code><br>\n  <code>Y[2] = X[2] + X[3] = 6</code><br>\n  <code>Y[4] = X[3] + X[4] = 5</code><br></p>\n</blockquote>\n\n<p><strong>Stage III.</strong>  <em>(where I am stuck)</em></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int k = 2;\nwhile (k &lt; p)\n{\n    int i;\n    #pragma omp parallel for\n    for (i = k; i &lt; p; i++)\n        Y[i] = Y[i - k] + Y[i];\n    k += k;\n}\n</code></pre>\n\n<p>Example:</p>\n\n<blockquote>\n  <p><code>k = 2</code><br>\n  <code>Y[2] = Y[0] + Y[2] = 1 + 9 = 10</code><br>\n  <code>Y[3] = Y[1] + Y[3] = 6 + 6 = 12</code><br>\n  <code>Y[4] = Y[2] + Y[4] = 10 + 5 = 15</code></p>\n</blockquote>\n\n<p><strong>Above the <code>10 + 5 = 15</code> should be <code>9 + 5 = 14</code>, but the <code>Y[2]</code> was overwritten by another thread. I want to use that <code>Y[2]</code> what was before the for-loop started.</strong></p>\n\n<p>Example:</p>\n\n<blockquote>\n  <p><code>k = 4</code><br>\n  <code>Y[4] = Y[0] + Y[4] = 1 + 15 = 16</code><br></p>\n</blockquote>\n\n<p><em>Result:</em> <code>1, 6, 10, 12, 16</code>. <em>Expected good result:</em> <code>1, 6, 10, 12, 15</code>.</p>\n"}, {"tags": ["c", "core", "principles"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1554926001, "post_id": 55620302, "comment_id": 97933709, "body": "What did your compiler tell you when you tried to compile this? If it didn&#39;t give you warnings, enable compiler warnings. If it still doesn&#39;t give you warnings, get a better compiler. Fix the warnings, then ask again."}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554927320, "post_id": 55620371, "comment_id": 97934283, "body": "@EOF <code>gcc -pedantic -Wextra -Wall c.c</code> no warning except about argv argv after the fixes"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554927693, "post_id": 55620371, "comment_id": 97934449, "body": "Uh, this is embarrassing. I was completely wrong. I should probably go to bed."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1554927917, "post_id": 55620371, "comment_id": 97934545, "body": "@chqrlie Where is &quot;here&quot;? Anyway, I absolutely need to get off stack overflow when I start to get belligerent while I am totally wrong (because I apparently can&#39;t read)."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1554927375, "last_edit_date": 1554927375, "creation_date": 1554926074, "answer_id": 55620371, "question_id": 55620302, "link": "https://stackoverflow.com/questions/55620302/segmentation-fault-core-dumped-when-i-run-the-program/55620371#55620371", "title": "&quot;Segmentation fault (core dumped)&quot; when I run the program", "body": "<p>you have several error in your scanf, producing your segmentation fault, they are indicated by the compiler :</p>\n\n<blockquote>\n<pre><code>c.c:38:1: warning: \u2018volumeGood\u2019 is used uninitialized in this function [-Wuninitialized]\nscanf(\"%f\", volumeGood);\n^~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n<pre><code>c.c:38:9: warning: format \u2018%f\u2019 expects argument of type \u2018float *\u2019, but argument 2 has type \u2018double\u2019 [-Wformat=]\nscanf(\"%f\", volumeGood);\n</code></pre>\n</blockquote>\n\n<p>because the undefined value of <em>volumeGood</em> is used as an address where <em>scanf</em> will try to write</p>\n\n<p>you probably wanted </p>\n\n<pre><code>scanf(\"%f\", &amp;volumeGood);\n</code></pre>\n\n<p>and also all these ones :</p>\n\n<blockquote>\n<pre><code>c.c:46:9: warning: format \u2018%f\u2019 expects argument of type \u2018float *\u2019, but argument 2 has type \u2018double\u2019 [-Wformat=]\nscanf(\"%f\", train[0]);\n        ^\nc.c:48:9: warning: format \u2018%f\u2019 expects argument of type \u2018float *\u2019, but argument 2 has type \u2018double\u2019 [-Wformat=]\nscanf(\"%f\", train[1]);\n        ^\nc.c:50:9: warning: format \u2018%f\u2019 expects argument of type \u2018float *\u2019, but argument 2 has type \u2018double\u2019 [-Wformat=]\nscanf(\"%f\", train[2]);\n       ^\nc.c:52:9: warning: format \u2018%f\u2019 expects argument of type \u2018float *\u2019, but argument 2 has type \u2018double\u2019 [-Wformat=]\nscanf(\"%f\", train[3]);\n        ^\nc.c:54:9: warning: format \u2018%f\u2019 expects argument of type \u2018float *\u2019, but argument 2 has type \u2018double\u2019 [-Wformat=]\nscanf(\"%f\", train[4]);\n</code></pre>\n</blockquote>\n\n<p>because the entries in <em>train</em> are used like if they contains addresses, you wanted</p>\n\n<pre><code>scanf(\"%f\", &amp;train[0]);\nscanf(\"%f\", &amp;train[1]);\nscanf(\"%f\", &amp;train[2]);\nscanf(\"%f\", &amp;train[3]);\nscanf(\"%f\", &amp;train[4]);\n</code></pre>\n\n<p>when you use <em>scanf</em> and equivalent you have to give the addresses where the values will be saved</p>\n\n<hr>\n\n<p>Also in</p>\n\n<pre><code>c.c:84:29: warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018int *\u2019 [-Wformat=]\n     printf(\"The Good id is %d\", &amp;idGood);\n                             ^\nc.c:85:38: warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018int *\u2019 [-Wformat=]\n     printf(\"The number of wagons is %d\", &amp;nWagons);\n                                      ^\nc.c:86:40: warning: format \u2018%f\u2019 expects argument of type \u2018double\u2019, but argument 2 has type \u2018float *\u2019 [-Wformat=]\n     printf(\"The price for the good is %f\", &amp;price);\n</code></pre>\n\n<p>that time it is the reverse, you give the address while you have to give the values, must be</p>\n\n<pre><code>     printf(\"The Good id is %d\", idGood);\n     printf(\"The number of wagons is %d\", nWagons);\n     printf(\"The price for the good is %f\", price);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11329914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f54d84d3055c959ec64010e070afed8?s=128&d=identicon&r=PG", "display_name": "Julio", "link": "https://stackoverflow.com/users/11329914/julio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554927426, "creation_date": 1554925793, "last_edit_date": 1554927426, "question_id": 55620302, "link": "https://stackoverflow.com/questions/55620302/segmentation-fault-core-dumped-when-i-run-the-program", "title": "&quot;Segmentation fault (core dumped)&quot; when I run the program", "body": "<p>(Sorry for my bad English btw)\nWell, I'm eve copying the solution of this code. My code is identical to the solution (the code it's ok, it's well done), but when I run the program, it appear a message that says <code>Segmentation fault (core dumped)</code>. I don't know how to show you captures of my program, but my code seems alright.\nWhen I run the program it finishes when it asks for the volume of the Good. Then this message: <code>Segmentation fault (core dumped)</code> appears</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NUM 5\n#define MAX_WAGON_CAPACITY 0.85\n#define MAX_WAGON_CAPACITY_ANIMALS 0.5\n#define LIMIT1 500\n#define LIMIT2 2500\n#define FRAGILE 1.10\n#define DANGEROUS 1.15\n#define FIRST_PRICE 0.50\n#define SECOND_PRICE 0.45\n#define THIRD_PRICE 0.40\n\ntypedef enum { FOOD, CHEMICAL, ANIMALS, VEHICLES,\n               ELECTRONICS, CONSTRUCTION, OTHERS } tGoodType;\ntypedef enum { FALSE, TRUE } boolean;\n\nint main(int argc, char **argv) {\n    int idGood;\n    float volumeGood;\n    tGoodType typeOfGood;\n    boolean isFragile;\n    boolean isDangerous;\n    float train [NUM];\n    int nWagons;\n    float volumeTrain;\n    float price;  \n    float surchargeFragile;\n    float surchargeDangerous;\n\n    printf(\"Good identifier: \\n\");\n    scanf(\"%d\", &amp;idGood);\n    printf(\"\\nInsert volume of Good\\n\");\n    scanf(\"%f\", volumeGood);\n    printf(\"\\nInsert Good type (0-FOOD, 1-CHEMICAL, 2-ANIMALS, 3-VEHICLES, 4-ELECTRONICS, 5-CONSTRUCTION, 6-OTHERS)\\n\");\n    scanf(\"%u\", &amp;typeOfGood);\n    printf(\"\\nIs the Good fragile? (0-FALSE, 1-TRUE)\\n\");\n    scanf(\"%u\", &amp;isFragile);\n    printf(\"\\nIs the Good dangerous) (0-FALSE, 1-TRUE\\n\");\n    scanf(\"%u\", &amp;isDangerous);\n    printf(\"\\nThe maximum length of the train is&gt;&gt; \");\n    scanf(\"%f\", train[0]);\n    printf(\"\\nThe length of the locomotive is&gt;&gt; \");\n    scanf(\"%f\", train[1]);\n    printf(\"\\nThe length of each wagon is&gt;&gt; \");\n    scanf(\"%f\", train[2]);\n    printf(\"\\nThe space between each wagon is&gt;&gt; \");\n    scanf(\"%f\", train[3]);\n    printf(\"\\nThe volume of a wagon is&gt;&gt; \");\n    scanf(\"%f\", train[4]);\n\n    nWagons = (int)((train[1] - train[2]) / (train[3] + train[4]));\n\n    if (typeOfGood == 2)\n        volumeTrain = nWagons * train[4] * MAX_WAGON_CAPACITY_ANIMALS;\n    else\n        volumeTrain = nWagons * train[4] * MAX_WAGON_CAPACITY;\n\n    price = 0.0;\n    surchargeFragile = 0.0;\n    surchargeDangerous = 0.0;\n    if (volumeTrain &gt;= volumeGood) {\n        if (volumeGood &gt; 0 &amp;&amp; volumeGood &lt; LIMIT1) { \n            price = volumeGood * FIRST_PRICE;\n        } else if (volumeGood &gt;= LIMIT1 &amp;&amp; volumeGood &lt;= LIMIT2) {\n            price = volumeGood * SECOND_PRICE;\n        } else {\n            price = volumeGood * THIRD_PRICE;\n        }\n    }\n    if (isFragile == 1) {\n        surchargeFragile = (price * FRAGILE) - price;\n    }\n    if (isDangerous == 1) {\n        surchargeDangerous = (price * DANGEROUS) - price;\n        price = price + surchargeFragile + surchargeDangerous;\n    }   \n\n    if (price &gt; 0.0) {\n        printf(\"The Good id is %d\", &amp;idGood);\n        printf(\"The number of wagons is %d\", &amp;nWagons);\n        printf(\"The price for the good is %f\", &amp;price);\n    } else {\n        printf(\"The good does not fit the train\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "caching"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1554924928, "post_id": 55620000, "comment_id": 97933207, "body": "For me, <code>gcc 8.3.1</code> produces <code>xorl\t%eax, %eax; ret</code> for <code>main()</code>, I&#39;m not sure how you expect to improve on this."}, {"owner": {"reputation": 15, "user_id": 11019750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b3c4b7883eb5ebd0c9763bedf643b5?s=128&d=identicon&r=PG&f=1", "display_name": "Pee Pod", "link": "https://stackoverflow.com/users/11019750/pee-pod"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554925749, "post_id": 55620000, "comment_id": 97933608, "body": "Sorry - I been really stupid here and not posted the correct middle to the loop."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554926948, "post_id": 55620000, "comment_id": 97934118, "body": "What is the cache size? How much data is used in \u201cdo some stuff with d_a\u201d?"}, {"owner": {"reputation": 15, "user_id": 11019750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b3c4b7883eb5ebd0c9763bedf643b5?s=128&d=identicon&r=PG&f=1", "display_name": "Pee Pod", "link": "https://stackoverflow.com/users/11019750/pee-pod"}, "edited": false, "score": 0, "creation_date": 1554931859, "post_id": 55620000, "comment_id": 97936169, "body": "Cache is 32k, 64 B, 8-way associative. Some calculations are made using d_a, and the result out into another size N array indexed by i."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554940603, "post_id": 55620000, "comment_id": 97938570, "body": "Your <code>BLOCK</code> is too big. While processing a block, you will have a block of <code>a</code> indexed by <code>i</code> in cache, and that is 4096 elements of 8 bytes each (presuming <code>double</code> is 8 bytes), which fills your cache. You will also have a block of results also indexed by <code>i</code>, so that is another 4096 elements presumably of 8 bytes each. And you will have <code>a[j]</code> and some miscellaneous data. So your <code>BLOCK</code> needs to be less than half its current size."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11019750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b3c4b7883eb5ebd0c9763bedf643b5?s=128&d=identicon&r=PG&f=1", "display_name": "Pee Pod", "link": "https://stackoverflow.com/users/11019750/pee-pod"}, "edited": false, "score": 0, "creation_date": 1555004999, "post_id": 55620564, "comment_id": 97967958, "body": "Thanks for your help!"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1554927551, "last_edit_date": 1554927551, "creation_date": 1554926887, "answer_id": 55620564, "question_id": 55620000, "link": "https://stackoverflow.com/questions/55620000/creating-a-cache-efficient-version-of-a-loop/55620564#55620564", "title": "creating a cache efficient version of a loop", "body": "<p>Change:</p>\n\n<pre><code>for (i = bbegin; i &lt; bend; i++)\n    for (j = 0; j &lt; i; j++)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>for (j = 0; j &lt; bend-1; j++)\n    for (i = max(bbegin, j+1); i &lt; bend; i++)\n</code></pre>\n\n<p>This processes the same elements but in a different order, with the consequence\nthat every <code>a[i]</code> in the block will be recently used when the next <code>a[j]</code> is\nloaded, so the elements in that block will remain in cache.</p>\n\n<p>(<code>max</code> of course has the obvious definition, analogous to the <code>min</code> show.)</p>\n"}], "owner": {"reputation": 15, "user_id": 11019750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1b3c4b7883eb5ebd0c9763bedf643b5?s=128&d=identicon&r=PG&f=1", "display_name": "Pee Pod", "link": "https://stackoverflow.com/users/11019750/pee-pod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554927551, "creation_date": 1554924530, "last_edit_date": 1554926157, "question_id": 55620000, "link": "https://stackoverflow.com/questions/55620000/creating-a-cache-efficient-version-of-a-loop", "title": "creating a cache efficient version of a loop", "body": "<p>I am trying to create a cache efficient version of a nested loop. The length of the loop is such that the data associated with the loop will be bigger than the cache size. I want to be able to iterate the loops in blocks so that it uses the cache more efficiently, but I don't know is this is possible.</p>\n\n<p>I have tried a conventional blocking approach, but clearly this is not the correct solution for the loops as they stand, as j starts its iteration each time from 0.</p>\n\n<pre><code>#define N     65536\n#define BLOCK 4096\n\nint min(int a, int b);\n\nint main() {\n\n  double a[N];\n  double d_a;\n  int i,j;\n  int bbegin; \n  int bend;\n\n  for(bbegin = 0;bbegin &lt; N;bbegin += BLOCK) {\n\n    bend = min(bbegin + BLOCK, N);\n\n    for(i=bbegin;i&lt;bend;i++){\n      for(j=0;j&lt;i;j++){\n\n        /* array a has been filled up elsewhere */\n        d_a = a[i] - a[j];\n        /* do some stuff with d_a */\n\n      }\n    }\n  }\n\n}\n\ninline int min(int a, int b) { return (a &lt; b) ? a : b; }\n</code></pre>\n"}, {"tags": ["c", "boolean-expression"], "comments": [{"owner": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 0, "creation_date": 1554923201, "post_id": 55619597, "comment_id": 97932497, "body": "Can you use a ternary conditional operator (<code>sum ? &quot;playerA&quot; : len ? &quot;playerB&quot; : &quot;no player was sent&quot;</code>)?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1554923231, "post_id": 55619597, "comment_id": 97932518, "body": "<code>AsciiSum(name)&gt;=20 &amp;&amp; puts(&quot;player A&quot;);</code> on a line by itself. Example: <a href=\"https://ideone.com/tsizHJ\" rel=\"nofollow noreferrer\">ideone.com/tsizHJ</a>"}, {"owner": {"reputation": 23, "user_id": 10718257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vBZCgHniIC0/AAAAAAAAAAI/AAAAAAAAB7M/XCHDz5vHg38/photo.jpg?sz=128", "display_name": "Mary Tim", "link": "https://stackoverflow.com/users/10718257/mary-tim"}, "reply_to_user": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 0, "creation_date": 1554923274, "post_id": 55619597, "comment_id": 97932537, "body": "nope. we cant @Frontear"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554923331, "post_id": 55619597, "comment_id": 97932557, "body": "Get some inspiration from <a href=\"https://stackoverflow.com/questions/55537295/boolean-expressions-short-circuit\">this recent question</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1554923568, "post_id": 55619597, "comment_id": 97932652, "body": "If you use <code>int</code> instead of <code>bool</code> you can use the <code>0</code> or <code>1</code> result to index some 2-element arrays of messages."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1554923870, "post_id": 55619597, "comment_id": 97932770, "body": "Are you sure you want to use multi-character literal constants?"}], "answers": [{"comments": [{"owner": {"reputation": 625, "user_id": 8125224, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jGloyX7Dw8I/AAAAAAAAAAI/AAAAAAAAAJs/thMBqkhvlfo/photo.jpg?sz=128", "display_name": "Muhammed G&#252;l", "link": "https://stackoverflow.com/users/8125224/muhammed-g%c3%bcl"}, "edited": false, "score": 1, "creation_date": 1554924026, "post_id": 55619804, "comment_id": 97932839, "body": "Wow that&#39;s smart."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1554924839, "post_id": 55619804, "comment_id": 97933168, "body": "Or, if the addition of a <code>&#39;\\n&#39;</code> is unwanted <code>fputs (&quot;playerA&quot;, stdout);</code>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1554925923, "post_id": 55619804, "comment_id": 97933675, "body": "This does not apply the if/else-if/else semantics. If both len and sum are true, both messages will be output.   <code>len = !sum &amp;&amp; NameLength(name)&lt;6 &amp;&amp; puts(&quot;playerB&quot;);</code> then <code>!sum &amp;&amp; !len &amp;&amp; puts(&quot;no player&quot;);</code>.  There is a simpler solution however."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1554926902, "post_id": 55619804, "comment_id": 97934090, "body": "<code>puts()</code> returns an undefined &quot;non-negative integer&quot; on success - that could include zero, in which case it would be <code>false</code>.  In my test it happened to work, but I don&#39;t think it is guaranteed.  As it happens in this case it makes no difference because the RHS of the <code>&amp;&amp;</code> will be evaluated and the value is not used because of the issue in my previous comment."}], "tags": [], "owner": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "is_accepted": false, "score": 2, "last_activity_date": 1554924231, "last_edit_date": 1554924231, "creation_date": 1554923669, "answer_id": 55619804, "question_id": 55619597, "link": "https://stackoverflow.com/questions/55619597/using-boolean-expressions-instead-of-if-else-or-similar-condition/55619804#55619804", "title": "using boolean expressions instead of if/else or similar condition", "body": "<p>One way of doing this would be to reroute your input through a custom print function which return a boolean value. That was, you could then just use the AND (&amp;&amp;) operator to call it.</p>\n\n<p>Example code:</p>\n\n<pre><code>bool printMessage(char* string)\n{\n    printf(\"%s\", string);\n    return true;\n}\n\nbool sum = AsciiSum(name)&gt;=20 &amp;&amp; printMessage(\"playerA\");\nbool len = NameLength(name)&lt;6 &amp;&amp; printMessage(\"playerB\");\n// ... etc\n</code></pre>\n\n<p>Why does this work? The AND operator will only allow the next condition to be checked if the first one was true. Since your condition is that sum must be true in order to print the message, this is a way to call the method to print without directly using any if/else statements</p>\n\n<p>Edit: An even better way, as suggested by <a href=\"https://stackoverflow.com/questions/55619597/using-boolen-expressions-instead-of-if-else-or-similar-condition/55619804#comment97932518_55619597\">Johnny Mopp</a> is to use stdio puts(), which returns an integer (that's what a boolean is functionally).</p>\n\n<pre><code>bool sum = AsciiSum(name)&gt;=20 &amp;&amp; puts(\"playerA\");\nbool len = NameLength(name)&lt;6 &amp;&amp; puts(\"playerB\");\n</code></pre>\n\n<p>With this, you don't even have to create a <code>printMessage</code> function, though you should stay with whichever feels more comfortable to work with.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10718257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vBZCgHniIC0/AAAAAAAAAAI/AAAAAAAAB7M/XCHDz5vHg38/photo.jpg?sz=128", "display_name": "Mary Tim", "link": "https://stackoverflow.com/users/10718257/mary-tim"}, "edited": false, "score": 0, "creation_date": 1554929095, "post_id": 55620268, "comment_id": 97935052, "body": "Thank you for this explaining. but when I do that it says (value computed is not used). I tried adding void() before it but then the error would change to ( void value not ignored as it ought to be). what does that mean and how can I fix it?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 23, "user_id": 10718257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vBZCgHniIC0/AAAAAAAAAAI/AAAAAAAAB7M/XCHDz5vHg38/photo.jpg?sz=128", "display_name": "Mary Tim", "link": "https://stackoverflow.com/users/10718257/mary-tim"}, "edited": false, "score": 0, "creation_date": 1554932444, "post_id": 55620268, "comment_id": 97936375, "body": "@MaryTim The expression is not assigned because you are only interested in the side-effects.  The compiler will likely issue a warning.   Simply assign to a dummy Boolean."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1554934368, "last_edit_date": 1554934368, "creation_date": 1554925634, "answer_id": 55620268, "question_id": 55619597, "link": "https://stackoverflow.com/questions/55619597/using-boolean-expressions-instead-of-if-else-or-similar-condition/55620268#55620268", "title": "using boolean expressions instead of if/else or similar condition", "body": "<p>Given an output function that always returns <code>true</code> :</p>\n\n<pre><code>bool print( const char* msg )\n{\n    puts( msg ) ;\n    return true ;\n}\n</code></pre>\n\n<p>You can then exploit short-circuit evaluation thus:</p>\n\n<pre><code>bool sum = AsciiSum(name)&gt;=20;\nbool len = NameLength(name)&lt;6;\n\n(sum &amp;&amp; print(\"playerA\")) || \n(len &amp;&amp; print(\"playerB\")) || \nprint(\"no player was sent\") ;\n</code></pre>\n\n<p>Testing all combinations thus:</p>\n\n<pre><code>bool sum = false, len = false ;\n(sum &amp;&amp; print(\"playerA\")) || (len &amp;&amp; print(\"playerB\")) || print(\"no player was sent\") ;\n\nsum = false, len = true ;\n(sum &amp;&amp; print(\"playerA\")) || (len &amp;&amp; print(\"playerB\")) || print(\"no player was sent\") ;\n\nsum = true, len = false ;\n(sum &amp;&amp; print(\"playerA\")) || (len &amp;&amp; print(\"playerB\")) || print(\"no player was sent\") ;\n\nsum = true, len = true ;\n(sum &amp;&amp; print(\"playerA\")) || (len &amp;&amp; print(\"playerB\")) || print(\"no player was sent\") ;\n</code></pre>\n\n<p>correctly outputs:</p>\n\n<pre><code>no player was sent                                                                                                                                       \nplayerB                                                                                                                                                  \nplayerA                                                                                                                                                  \nplayerA  \n</code></pre>\n\n<p>Your compiler may issue a diagnostic regarding the result of the expression being unused; that can be supressed by a dummy assignment:</p>\n\n<pre><code>bool dummy = (sum &amp;&amp; print(\"playerA\")) || \n             (len &amp;&amp; print(\"playerB\")) ||  \n             print(\"no player was sent\") ; \n</code></pre>\n\n<p>or by casting the whole expression to void:</p>\n\n<pre><code>(void)((sum &amp;&amp; print(\"playerA\")) || \n       (len &amp;&amp; print(\"playerB\")) || \n       print(\"no player was sent\")) ;\n</code></pre>\n\n<p>The only requirement of the output function is that it returns a non-zero value to short-circuit the <code>||</code>, to that end <code>printf()</code> will work if the message is not an empty string, and avoid the need to define a specific output function.:</p>\n\n<pre><code>(void)((sum &amp;&amp; printf(\"playerA\\n\")) || \n       (len &amp;&amp; printf(\"playerB\\n\")) || \n       printf(\"no player was sent\\n\")) ; \n</code></pre>\n\n<p><code>puts()</code> however only guarantees to return a non-negative value on success, which includes zero, so should not be used.</p>\n"}], "owner": {"reputation": 23, "user_id": 10718257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vBZCgHniIC0/AAAAAAAAAAI/AAAAAAAAB7M/XCHDz5vHg38/photo.jpg?sz=128", "display_name": "Mary Tim", "link": "https://stackoverflow.com/users/10718257/mary-tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1554934368, "creation_date": 1554922793, "last_edit_date": 1554924595, "question_id": 55619597, "link": "https://stackoverflow.com/questions/55619597/using-boolean-expressions-instead-of-if-else-or-similar-condition", "title": "using boolean expressions instead of if/else or similar condition", "body": "<p>I need to use boolen expressions instead of using terms such as: c: b? A, switch, else ... if. and using for / while-do / while as if is also not allowed.</p>\n\n<p>My question is when receiving a name, based on its value we decide what to print. For example, if the name is shorter than 6 letters we print \"player A is sent\", if the letters sum (in ascii values) is more than 20 we send player B and stuff like that. In addition, if we can send more than one player, we will choose to send the largest lexicographic player (playerC &lt; playerB &lt; playerA.)</p>\n\n<p>what I tried to do is something like this </p>\n\n<pre><code>  bool sum = AsciiSum(name)&gt;=20;\n  bool len = NameLength(name)&lt;6;\n...\n</code></pre>\n\n<p>so the rest should be that </p>\n\n<pre><code>if(sum) \n  printf(\"%c\\n\" ,'playerA');\nelse if (len) \n  printf(\"%c\\n\" ,'playerB');\nelse \n  printf(\"%c\\n\" ,'no player was sent');\n</code></pre>\n\n<p>But as I said , I cant use if and else or similar conditions. Will be grateful for any help in that last part.</p>\n"}, {"tags": ["c", "asynchronous", "winapi", "stdin", "iocp"], "comments": [{"owner": {"reputation": 26818, "user_id": 209199, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b64963e747bf4c8fc20fb379105f204?s=128&d=identicon&r=PG", "display_name": "Cory Nelson", "link": "https://stackoverflow.com/users/209199/cory-nelson"}, "edited": false, "score": 1, "creation_date": 1554923219, "post_id": 55619555, "comment_id": 97932509, "body": "IOCP requires file handles that were opened with async. I don&#39;t believe it&#39;s possible to open stdin/stdout with async."}, {"owner": {"reputation": 181, "user_id": 7515769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd0d2e1c0a8b67f82f475a2b935dffb?s=128&d=identicon&r=PG&f=1", "display_name": "holo", "link": "https://stackoverflow.com/users/7515769/holo"}, "edited": false, "score": 0, "creation_date": 1554923548, "post_id": 55619555, "comment_id": 97932643, "body": "I don&#39;t find anything to open stdin with async..."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1554924341, "post_id": 55619555, "comment_id": 97932963, "body": "if you target only latest windows version (8+) you need <code>CreateFile(L&quot;CONIN$&quot;, FILE_GENERIC_READ, FILE_SHARE_VALID_FLAGS, 0, OPEN_EXISTING, FILE_FLAG_OVERLAPPED, 0);</code> instead <code>GetStdHandle(STD_INPUT_HANDLE);</code> after this you can use <code>CreateIoCompletionPort</code> but much better and simply use <code>BindIoCompletionCallback</code> here. another question which general logic sckeleton you want get here"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7515769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd0d2e1c0a8b67f82f475a2b935dffb?s=128&d=identicon&r=PG&f=1", "display_name": "holo", "link": "https://stackoverflow.com/users/7515769/holo"}, "edited": false, "score": 0, "creation_date": 1554923212, "post_id": 55619619, "comment_id": 97932503, "body": "Thank you ! I think I will create a thread...the Windows API is very strange in comparaison to the UNIX API"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "reply_to_user": {"reputation": 181, "user_id": 7515769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd0d2e1c0a8b67f82f475a2b935dffb?s=128&d=identicon&r=PG&f=1", "display_name": "holo", "link": "https://stackoverflow.com/users/7515769/holo"}, "edited": false, "score": 0, "creation_date": 1554923393, "post_id": 55619619, "comment_id": 97932579, "body": "Forget everything that comes from unix when programming windows and also use std::thread for simple threads."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1554924195, "post_id": 55619619, "comment_id": 97932911, "body": "really can be used. we can open console in asynchronous mode <code>CreateFile(L&quot;CONIN$&quot;, FILE_GENERIC_READ, FILE_SHARE_VALID_FLAGS, 0, OPEN_EXISTING, FILE_FLAG_OVERLAPPED, 0);</code> and then bind it to iocp or better via <code>BindIoCompletionCallback</code>. but this will be work from win7 or win8 (forgot already) when console model changed and not console handles really file handle"}], "tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": true, "score": 1, "last_activity_date": 1554922910, "creation_date": 1554922910, "answer_id": 55619619, "question_id": 55619555, "link": "https://stackoverflow.com/questions/55619555/win32-impossible-to-use-iocp-with-stdin-handle/55619619#55619619", "title": "Win32: Impossible to use iocp with stdin handle", "body": "<p>CreateIOCompletionPort cannot be used directly with stdin/stdout.\nCheck <a href=\"https://tim.mcnamara.nz/post/176613307022/iocp-and-stdio\" rel=\"nofollow noreferrer\">this</a>. Either use a thread, or redirect stdin/stdout to named pipes.</p>\n"}], "owner": {"reputation": 181, "user_id": 7515769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd0d2e1c0a8b67f82f475a2b935dffb?s=128&d=identicon&r=PG&f=1", "display_name": "holo", "link": "https://stackoverflow.com/users/7515769/holo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 55619619, "answer_count": 1, "score": 1, "last_activity_date": 1554922953, "creation_date": 1554922602, "last_edit_date": 1554922953, "question_id": 55619555, "link": "https://stackoverflow.com/questions/55619555/win32-impossible-to-use-iocp-with-stdin-handle", "title": "Win32: Impossible to use iocp with stdin handle", "body": "<p>I want to make asynchronous read on stdin in Windows with I/O Completion Ports but this code doesn't works :</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\n#pragma comment(lib, \"Kernel32.lib\")\n\nint main() {\n    HANDLE handle = GetStdHandle(STD_INPUT_HANDLE);\n    DWORD number;\n\n    HANDLE iocp = CreateIoCompletionPort(handle, NULL, 0, 0);\n\n    if(iocp == NULL) {\n        printf(\"error : %d\\n\", GetLastError());\n    }\n}\n</code></pre>\n\n<p>I get the error 87 : ERROR_INVALID_PARAMETER</p>\n"}, {"tags": ["c", "linux", "openssl", "rc4-cipher"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554922716, "post_id": 55619347, "comment_id": 97932273, "body": "<a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.2\" rel=\"nofollow noreferrer\"><code>fseek(inFile, 0, SEEK_END);</code></a> is <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note268\" rel=\"nofollow noreferrer\">undefined behavior for a binary stream</a> in strictly-conforming C code.  Why that gets taught as &quot;how to get the size of a file&quot; is beyond me.  &quot;Size of a file&quot; requires implementation-specific methods to determine, and <code>ftell()</code> is limited to 2 GB on 32-bit machines in any case."}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 0, "last_activity_date": 1554922075, "creation_date": 1554922075, "answer_id": 55619439, "question_id": 55619347, "link": "https://stackoverflow.com/questions/55619347/issue-compiling-code-with-openssl-rc4-header-in-c/55619439#55619439", "title": "Issue compiling code with openssl RC4 header in C", "body": "<blockquote>\n  <p>my compile line is: gcc rc4.c -o rc4</p>\n</blockquote>\n\n<p>The <code>&lt;openssl/rc4.h&gt;</code> header only includes declarations of the RC4 functions, not their definitions. These functions are defined in the libcrypto library, which is part of OpenSSL. Add <code>-lcrypto</code> to your command line to link against this library.</p>\n\n<p>As an aside, RC4 is not considered secure. Avoid using it.</p>\n"}], "owner": {"reputation": 75, "user_id": 9643123, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/9643123/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "closed_date": 1554953749, "accepted_answer_id": 55619439, "answer_count": 1, "score": 0, "last_activity_date": 1554953911, "creation_date": 1554921765, "last_edit_date": 1554953498, "question_id": 55619347, "link": "https://stackoverflow.com/questions/55619347/issue-compiling-code-with-openssl-rc4-header-in-c", "closed_reason": "Duplicate", "title": "Issue compiling code with openssl RC4 header in C", "body": "<p>I am working on adding a test program in C that implements openssl RC4 functions. The man page in Linux gives me the format for the functions and says to include the  header file, which I did. However, when I try to compile, it keeps giving me errors.</p>\n\n<pre><code>/tmp/ccQwY6Sr.o: In function `main': \nrc4.c:(.text+0xd5): undefined reference to `RC4_set_key'\nrc4.c:(.text+0xef): undefined reference to `RC4'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Surprisingly, I can not seem to find any info on this specific issue online. How is an undefined reference in I included the header file that's supposed to define them?</p>\n\n<p>If anyone could point me in the right direction here, I would appreciate the help.</p>\n\n<p>my compile line is:</p>\n\n<pre><code>gcc rc4.c -o rc4\n</code></pre>\n\n<p>my program is:</p>\n\n<pre><code>#include &lt;openssl/rc4.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char* argv[])\n{\n    FILE* inFile;\n    char * bufferIn;\n    char * bufferOut;\n    char data[] = \"PASSword123\";\n    RC4_KEY * key;\n\n    inFile = fopen(\"/home/chris/Desktop/testfile.txt\", \"rb+\");\n\n    fseek(inFile, 0, SEEK_END);\n    int size = ftell(inFile);\n    rewind(inFile);\n\n    bufferIn = (char*)malloc(sizeof(char)*size);\n    bufferOut = (char*)malloc(sizeof(char)*size);\n    fread(bufferIn, 1, size, inFile);\n    rewind(inFile);\n\n    RC4_set_key(key, 11, data);\n    RC4(key, size, bufferIn, bufferOut);\n\n    free(bufferIn);\n    free(bufferOut);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "stack"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 4, "creation_date": 1554921465, "post_id": 55619258, "comment_id": 97931677, "body": "Which part don&#39;t you know: how to identify prime numbers, or how to remove them from a stack?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554921621, "post_id": 55619258, "comment_id": 97931759, "body": "For <code>int *st</code> and <code>int *vf</code>, <code>st[vf]</code> is  a constraint violation. C11 draft standard n1570: <i>6.5.2.1 Array subscripting Constraints 1 One of the expressions shall have type \u2018\u2018pointer to complete object type\u2019\u2019, the other expression shall have integer type, and the result has type \u2018\u2018type\u2019\u2019.</i>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1554921696, "post_id": 55619258, "comment_id": 97931802, "body": "The second function has syntax errors, perhaps it should be <code>st[*vf]=nrnou; (*vf)++;</code>. The first is similarly incorrect and also discards the popped value."}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 0, "last_activity_date": 1554923184, "last_edit_date": 1554923184, "creation_date": 1554921898, "answer_id": 55619386, "question_id": 55619258, "link": "https://stackoverflow.com/questions/55619258/how-can-i-delete-the-prime-numbers-out-of-a-stack/55619386#55619386", "title": "How can i delete the prime numbers out of a stack", "body": "<p>Use a temporary stack.</p>\n\n<p>Pop all entries from original stack and, if not prime, push them into the temporary stack (discarding prime entries).</p>\n\n<p>Then do the opposite: pop from temporary stack and push into the original stack.</p>\n"}], "owner": {"reputation": 1, "user_id": 11342198, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RJjjOKmnG34/AAAAAAAAAAI/AAAAAAAAACQ/XnTrO-EBEqo/photo.jpg?sz=128", "display_name": "Emy Oltean", "link": "https://stackoverflow.com/users/11342198/emy-oltean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1554923184, "creation_date": 1554921392, "question_id": 55619258, "link": "https://stackoverflow.com/questions/55619258/how-can-i-delete-the-prime-numbers-out-of-a-stack", "title": "How can i delete the prime numbers out of a stack", "body": "<p>i don`t know the steps of deleting prime numbers out of a stack st[10] using the functions pop and push</p>\n\n<pre><code>void pop(int *st,int*vf)\n{\n    vf--;\n}\nvoid push(int *st,int *vf,int nrnou)\n{\n    st[vf]=nrnou;\n    vf++;\n\n}\n</code></pre>\n"}, {"tags": ["c", "debugging"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1554921396, "post_id": 55619222, "comment_id": 97931646, "body": "Why are you using <code>static bool</code> for what&#39;s effectively a throw-away variable? Just <code>return false</code> instead."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 9, "creation_date": 1554921400, "post_id": 55619222, "comment_id": 97931649, "body": "that&#39;s a clear sign of <i>undefined behaviour</i>. But this code is probably not at fault. The caller is."}, {"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554921688, "post_id": 55619222, "comment_id": 97931798, "body": "I used static bool because I was trying to get Visual studio to display the boolean variable&#39;s value in watch window even when the variable was outside of scope, it didn&#39;t work and I forgot to remove static. The problem is there whether I use static or not however."}, {"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554921885, "post_id": 55619222, "comment_id": 97931895, "body": "An undefined behavior. How could I troubleshoot and debug such a thing?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554922698, "post_id": 55619222, "comment_id": 97932266, "body": "You are not <i>using</i> the result of <code>collision()</code> anywhere in the code you have shown. A reasonable compiler will optimize out a computation if its result is unneeded."}, {"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554931126, "post_id": 55619222, "comment_id": 97935914, "body": "I removed<code>collision</code> calls later and forgot to add them back before posting the question. I have added them back now anyway, and I apologize for the inconvenience caused by my carelessness."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554924366, "post_id": 55619655, "comment_id": 97932973, "body": "Thanks for your reply. In fact I removed the collision function call later and forgot to add them back before posting the question. I have added them back now anyway, and I apologize for the inconvenience caused by my carelessness."}, {"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554924421, "post_id": 55619655, "comment_id": 97932995, "body": "Regarding that I might be reading beyond the end of char_rect array, I made sure that it wasn&#39;t happening."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554924912, "post_id": 55619655, "comment_id": 97933199, "body": "Do you still have the crash with optimisations disabled?"}, {"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554926438, "post_id": 55619655, "comment_id": 97933902, "body": "The program didn&#39;t crash but the function collision randomly returns true even if one of the condition in its body (that are followed by return false statement) are met. If I add the aforementioned printf calls however, it works flawlessly. And if you are referring to optimization option that is found under C/C++ in &quot;project properties&quot; , this was turned off by default."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554926924, "post_id": 55619655, "comment_id": 97934101, "body": "Is the second argument <code>&amp;char_rects[2]</code>or should it be <code>&amp;char_rects[1]</code>?"}, {"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554928051, "post_id": 55619655, "comment_id": 97934600, "body": "It was char_rects[1] initially, I created rect[2] after I found the bug hoping something was wrong with char_rects[1], but turned out it did  not have something to do with it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554929121, "post_id": 55619655, "comment_id": 97935069, "body": "@Ramy670: how do you allocate <code>char_rects</code> and the other arguments passed to <code>player_movement_calc</code>?"}, {"owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554930828, "post_id": 55619655, "comment_id": 97935769, "body": "I do not manually allocate memory, I just define the variable and initiate it or pass it to a function that would. Do we need to manually allocate memory in a simple program like that?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "edited": false, "score": 0, "creation_date": 1554932804, "post_id": 55619655, "comment_id": 97936487, "body": "@Ramy670: how do you define these variables? Can you post the code that calls <code>player_movement_calc()</code>?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1554924890, "last_edit_date": 1554924890, "creation_date": 1554923023, "answer_id": 55619655, "question_id": 55619222, "link": "https://stackoverflow.com/questions/55619222/conditional-return-value-bug-fixed-with-a-useless-printf-call/55619655#55619655", "title": "Conditional return value bug fixed with a useless printf call", "body": "<p>In the <code>player_movement_calc()</code> function, you have <code>collision(&amp;char_rects[0], &amp;char_rects[2])</code>. It seems you should be comparing the rectangles of the players with</p>\n\n<pre><code>    bool collided = collision(&amp;char_rects[0], &amp;char_rects[1]);\n</code></pre>\n\n<p>You may be reading beyond the end of the <code>char_rects</code> array, causing undefined behavior. Any side effects caused by <code>printf</code>, such as allocating memory for its own purpose or the the <code>stdout</code> buffer might change the behavior of the program, for example by making the memory accessed beyond the end of the array readable, hence removing the crash and hiding the bug.</p>\n\n<p>Another potential explanation is the call to <code>collision</code> might be omitted by the compiler if its result is unused and if the function <code>collision</code> has no side effects. Without the <code>static</code> and the <code>printf</code>, the function has no side effect (apart from the crash caused by reading beyond the end of the array which is undefined behavior anyway). Changing the <code>static</code> value may be considered useless by the compiler since this variable is not used anywhere and not defined <code>volatile</code>. <code>printf</code> has side effects, so calling it makes <code>collision</code> unpure, hence the call cannot be elided.</p>\n\n<p>It is always difficult to try and make sense of undefined behavior. When debugging, you should first disable all optimizations. The bug is probably visible without the <code>printf</code> with optimizations disabled and tracing the code and watching local variables should be much easier with unoptimised code.</p>\n\n<p>Once you have a reproducible crash bug in a debug build, just use the debugger to show you where it happens. Crash bugs should be easy to investigate.</p>\n"}], "owner": {"reputation": 33, "user_id": 11342145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IHQQUhH-TOs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffqWuGL9MckxZguTY6OViGDirM1w/mo/photo.jpg?sz=128", "display_name": "Ramy670", "link": "https://stackoverflow.com/users/11342145/ramy670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554925682, "creation_date": 1554921245, "last_edit_date": 1554925682, "question_id": 55619222, "link": "https://stackoverflow.com/questions/55619222/conditional-return-value-bug-fixed-with-a-useless-printf-call", "title": "Conditional return value bug fixed with a useless printf call", "body": "<p>I was trying to write a simple function for collision detection for my simple game (school project) and couldn't get a proper return value out of it until I added a meaningless <code>printf</code> line (initially it was intended to assist in debugging ) and it all worked somehow. I wonder what could that bug be? and how I can fix it with a more \"proper\" way. Thanks.</p>\n\n<p>Here is my function (Variable \"rect\" (rectangle)is a standard SDL struct that has 4 integer members representing it's height, width and it's corner's x and y):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>bool collision(SDL_Rect *rect1, SDL_Rect *rect2) {\n    //chekcs to see if rect2 is totally outside of boundaries of rect1\n    static bool collided;\n    if (rect1-&gt;y &gt; rect2-&gt;y + rect2-&gt;h) {\n        printf(\"\");\n        collided = false;\n        return collided;\n    }\n    if (rect1-&gt;y + rect1-&gt;h &lt; rect2-&gt;y) {\n        printf(\"\");\n        collided = false;\n        return collided;\n    }\n    if (rect1-&gt;x &gt; rect2-&gt;x + rect2-&gt;w) {\n        printf(\"\");\n        collided = false;\n        return collided;\n    }   \n    if (rect1-&gt;x + rect1-&gt;w &lt; rect2-&gt;x) {\n        printf(\"\");\n        collided = false;\n        return collided;\n    }\n    //returns 1 if none of above is true\n\n    collided = 1;\n    return collided;\n}\n</code></pre>\n\n<p>Edit:\nI used static bool because I was trying to get Visual studio to display the boolean variable's value in watch window even when it (the variable) was outside of scope, it didn't work and I forgot to remove static. The problem is there whether I use static or not however.</p>\n\n<p>Edit 2:\nHere is the function that is calling the function above (I know digonalMovement needs a small fix to make the speed slower on both directions when moving diagonally (currently only 1 of them becomes slower), but this shouldn't have anything to do with the problem in hand):</p>\n\n<pre><code>void player_movement_calc(int player_nr, SDL_Rect char_rects[], Char character[]) {\n    // determine velocity\n    character[player_nr].x_vel = character[player_nr].y_vel = 0;\n    bool collided = collision(&amp;char_rects[0], &amp;char_rects[2]);\n\n    bool digonalMovement = 0;\n    if (character[player_nr].up &amp;&amp; !character[player_nr].down) {    \n        if (digonalMovement)\n            character[player_nr].y_vel = -SPEED * 0.86; //multiplying by sin(45)\n        else {\n            character[player_nr].y_vel = -SPEED;\n        }\n        digonalMovement = 1;\n        if (collided)\n            character[player_nr].y_vel -= 2 * character[player_nr].y_vel;\n    }\n    if (character[player_nr].down &amp;&amp; !character[player_nr].up) {\n        if (digonalMovement)\n            character[player_nr].y_vel = SPEED * 0.86;\n        else {\n            character[player_nr].y_vel = SPEED;\n        }\n        digonalMovement = 1;\n        if (collided)\n            character[player_nr].y_vel -= 2 * character[player_nr].y_vel;\n    }\n    if (character[player_nr].left &amp;&amp; !character[player_nr].right) {\n        if (digonalMovement)\n            character[player_nr].x_vel = -SPEED * 0.86;\n        else {\n            character[player_nr].x_vel = -SPEED;\n        }\n        digonalMovement = 1;\n        if (collided)\n            character[player_nr].y_vel -= 2 * character[player_nr].y_vel;\n    }\n    if (character[player_nr].right &amp;&amp; !character[player_nr].left) {\n        if (digonalMovement)\n            character[player_nr].x_vel = SPEED * 0.86;\n        else {\n            character[player_nr].x_vel = SPEED;\n        }\n        digonalMovement = 1;\n        if (collided)\n            character[player_nr].y_vel -= 2 * character[player_nr].y_vel;\n    }\n    //clears diagonalMovement to make it false for next fram\n    digonalMovement = 0;\n\n    // update positions\n    character[player_nr].x_pos += character[player_nr].x_vel / 60;\n    character[player_nr].y_pos += character[player_nr].y_vel / 60;\n\n    // collision detection with bounds\n    if (character[player_nr].x_pos &lt;= 0)\n        character[player_nr].x_pos = 0;\n    if (character[player_nr].y_pos &lt;= 0)\n        character[player_nr].y_pos = 0;\n    if (character[player_nr].x_pos &gt;= WINDOW_WIDTH - char_rects[player_nr].w)\n        character[player_nr].x_pos = WINDOW_WIDTH - char_rects[player_nr].w;\n    if (character[player_nr].y_pos &gt;= WINDOW_HEIGHT - char_rects[player_nr].h)\n        character[player_nr].y_pos = WINDOW_HEIGHT - char_rects[player_nr].h;\n\n    // set the positions in the struct \n    char_rects[player_nr].y = (int)character[player_nr].y_pos;\n    char_rects[player_nr].x = (int)character[player_nr].x_pos;\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554921086, "post_id": 55619137, "comment_id": 97931506, "body": "If it&#39;s numbers, why aren&#39;t you using <code>%d</code> instead of <code>%s</code>?"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1554921277, "post_id": 55619137, "comment_id": 97931583, "body": "The syntax of your code is invalid. I suggest you open a good C book and learn the basics."}, {"owner": {"reputation": 67, "user_id": 9715157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rogelio", "link": "https://stackoverflow.com/users/9715157/rogelio"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1554922157, "post_id": 55619137, "comment_id": 97932014, "body": "@Unholysheep, it might, but all of the answer a difficult for me to understand."}, {"owner": {"reputation": 67, "user_id": 9715157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rogelio", "link": "https://stackoverflow.com/users/9715157/rogelio"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554922178, "post_id": 55619137, "comment_id": 97932024, "body": "@Barmar yes thank you, it was a typo."}, {"owner": {"reputation": 67, "user_id": 9715157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rogelio", "link": "https://stackoverflow.com/users/9715157/rogelio"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1554922194, "post_id": 55619137, "comment_id": 97932036, "body": "@machine_1 thanks &quot;genius&quot; you&#39;re SOOO helpful \ud83d\ude44"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9912660, "user_type": "registered", "profile_image": "https://graph.facebook.com/1265688623563502/picture?type=large", "display_name": "Mohamed Nabil", "link": "https://stackoverflow.com/users/9912660/mohamed-nabil"}, "is_accepted": false, "score": -2, "last_activity_date": 1554923442, "last_edit_date": 1554923442, "creation_date": 1554921707, "answer_id": 55619333, "question_id": 55619137, "link": "https://stackoverflow.com/questions/55619137/i-need-to-be-able-to-read-a-string-from-standard-input/55619333#55619333", "title": "I need to be able to read a string from standard input", "body": "<p>try to read a line first then read the integers in the line  </p>\n\n<pre><code>char *x ,*s ;\nint d ;\nwhile (fgets(input, sizeof(input), stdin)) {\nx = input;\nfor (x = input; ; x = s) {\n    d = strtol(x, &amp;s, 10);\n    if (x == s)\n        break;        \n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 0, "last_activity_date": 1554922602, "last_edit_date": 1554922602, "creation_date": 1554922173, "answer_id": 55619463, "question_id": 55619137, "link": "https://stackoverflow.com/questions/55619137/i-need-to-be-able-to-read-a-string-from-standard-input/55619463#55619463", "title": "I need to be able to read a string from standard input", "body": "<p>his an example. You need to add the malloc &amp; realloc result checking (I did not for the sake of simplicity)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define CHUNK   32 \n\nchar *readline(void)\n{\n    size_t csize = CHUNK;\n    size_t cpos = 0;\n    char *str = malloc(CHUNK);\n    int ch;\n    while((ch = fgetc(stdin)) != '\\n' &amp;&amp; ch != '\\r')\n    {\n        str[cpos++] = ch;\n        if(cpos == csize)\n        {\n            csize += CHUNK;\n            str = realloc(str, csize);\n        }\n    }\n    str[cpos] = 0;\n    return str;\n}\n</code></pre>\n\n<p>Then you have the string you can sscanf.  After use free the memory</p>\n\n<p>And to convert it to the array of integers (as you do not know the size of the result array):</p>\n\n<pre><code>int *tointegers(char *str, char *delimiters, size_t *size)\n{\n    int *array = malloc(CHUNK * sizeof(*array));\n    char *ptr;\n\n    *size = 0; \n    ptr = strtok (str, delimiters);\n    while (ptr != NULL)\n    {\n        array[(*size)++] = atoi(ptr);\n        if(*size == CHUNK)\n        {\n            array = malloc((*size + CHUNK) * sizeof(*array));\n        }\n        ptr = strtok (NULL, delimiters);\n    }\n    return array;\n}\n</code></pre>\n\n<p>Same remarks about the malloc &amp; realloc result checking &amp; memory freeing </p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1554925766, "post_id": 55619644, "comment_id": 97933613, "body": "What if the string is longer than 99 chars? If it 1000, 100000, 10000000?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1554925840, "post_id": 55619644, "comment_id": 97933641, "body": "Using the list to store the integers that overkill"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1554926058, "post_id": 55619644, "comment_id": 97933739, "body": "@P_J, you can use <code>fgets</code> in a loop while you don&#39;t find a newline."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1554926109, "post_id": 55619644, "comment_id": 97933765, "body": "Why an overkill?, lists are made for this."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 0, "last_activity_date": 1554924215, "last_edit_date": 1554924215, "creation_date": 1554922984, "answer_id": 55619644, "question_id": 55619137, "link": "https://stackoverflow.com/questions/55619137/i-need-to-be-able-to-read-a-string-from-standard-input/55619644#55619644", "title": "I need to be able to read a string from standard input", "body": "<p>The main problem here is that you don't know the number of elements beforehand, in those cases you need to reserve space to store the elements using dynamic memory, you can use a queue or you can use <code>realloc</code>, also avoid using <code>scanf</code> in this way, always limit the length of the string:</p>\n\n<pre><code>char str[100];\n\nscanf(\"%99s\", str); /* buffer overflow protection */\n</code></pre>\n\n<p>and always check the result: </p>\n\n<pre><code>if (scanf(\"%99s\", str) != 1) {\n    /* something went wrong */\n}\n</code></pre>\n\n<p>An example using <code>fgets</code> (as an alternative to <code>scanf</code>) and <code>strtol</code>, storing the data in a queue:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nstruct node {\n    struct node *next;\n    int data;\n};\n\nvoid *enqueue(struct node **root, int data)\n{\n    struct node *node;\n\n    node = malloc(sizeof *node);\n    if (node == NULL) {\n        return NULL;\n    }\n    if (*root == NULL) {\n        node-&gt;next = node;\n    } else {\n        node-&gt;next = (*root)-&gt;next;\n        (*root)-&gt;next = node;\n    }\n    node-&gt;data = data;\n    *root = node;\n    return node;\n}\n\nint dequeue(struct node **root)\n{\n    struct node *node;\n    int data = 0;\n\n    node = *root;\n    if (node != NULL) {\n        node = node-&gt;next;\n        data = node-&gt;data;\n        if (*root == node) {\n            *root = NULL;\n        } else {\n            (*root)-&gt;next = node-&gt;next;\n        }\n        free(node);\n    }\n    return data;\n}\n\nint main(void)\n{\n    struct node *node = NULL;\n    char str[512];\n    char *ptr;\n    int data;\n\n    ptr = fgets(str, sizeof str, stdin);\n    if (ptr != NULL) {\n        while (*ptr) {\n            data = (int)strtol(ptr, &amp;ptr, 10);\n            if (!isspace(*ptr)) { // If we don't have a blank space\n                break;            // exit the loop\n            }\n            enqueue(&amp;node, data);\n            ptr++;\n        }\n    }\n    while (node != NULL) {\n        data = dequeue(&amp;node);\n        printf(\"%d\\n\", data);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Input</p>\n\n<pre><code>123 456 -789\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>123\n456\n-789\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1555124922, "last_edit_date": 1555124922, "creation_date": 1554928744, "answer_id": 55621000, "question_id": 55619137, "link": "https://stackoverflow.com/questions/55619137/i-need-to-be-able-to-read-a-string-from-standard-input/55621000#55621000", "title": "I need to be able to read a string from standard input", "body": "<p>To read (and store) an unknown number of characters from <code>stdin</code>, you have two basic options:</p>\n\n<ol>\n<li>if available, use POSIX <code>getline()</code> to read all characters into a buffer (<code>getline</code> will reallocate memory as required to store the entire line of input, including the *nul-terminating character), or</li>\n<li>if you need to write truly portable code, handle the initial memory allocation, and reallocation as needed, using <code>malloc</code> and <code>realloc</code>.</li>\n</ol>\n\n<p>As you have found, dynamic memory allocation can be a bit daunting at first, but there really isn't any reason it should be. In any case, you simply allocate some initially sized block of memory, assign the starting address to a pointer, store whatever you need in the block keeping track of the memory used. When then memory used equals the memory available (i.e. when you fill up the block of memory you allocated), you simply reallocate more memory using a temporary pointer, validate that your call to <code>realloc</code> succeeded, and then assign the start of the reallocated block of memory to your original pointer, and keep going and repeat the process each time your fill up your block of memory.</p>\n\n<p>There are many ways to approach the read, using a character-oriented-input function like <code>getchar()</code>, or using some fixed size buffer and <code>fgets</code> to read a fixed number of characters at a time. It's really up to you. Avoid <code>scanf</code> for a single character, there is no need for it. The underlying read is buffered by the filesystem, so there isn't a performance penalty regardless which you choose. (Linux provides an 8192-byte read buffer sized with <code>IO_BUFSIZ</code> (now <code>BUFSIZ</code> now, see <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=libio/stdio.h;h=b63ee88a776aa12586f086ab49d05baadd12aeed;hb=refs/heads/master#l99\" rel=\"nofollow noreferrer\">glibc/libio/stdio.h - #define BUFSIZ 8192</a> and <code>_IO_BUFSIZ</code> changed to <code>BUFSIZ</code> <a href=\"https://sourceware.org/git/?p=glibc.git;a=commit;h=9964a14579e5eef925aaa82facc4980f627802fe\" rel=\"nofollow noreferrer\">glibc commit 9964a14579e5eef9</a>) and windows proves a similar 512-byte buffer)</p>\n\n<p>The key is to take it step-by-step, validate every allocation, and handle the error as required. You use a temporary pointer with <code>realloc</code> because if <code>realloc</code> fails, it returns <code>NULL</code> and if you were assigning the return of <code>realloc</code> to your original pointer, you would overwrite the address to your original block of memory with <code>NULL</code> creating a memory-leak. By using a temp pointer, if <code>realloc</code> fails, your existing data is still accessible through your original pointer. </p>\n\n<p>For example to double the size of a currently allocated <code>buffer</code> with current allocation size of <code>buffersize</code>, you could naively do:</p>\n\n<pre><code>buffer = realloc (buffer, 2 * buffersize);  /* wrong - potential memory leak */\nif (buffer == NULL) {           /* validate reallocation */\n    perror (\"realloc-buffer\");  /* output error message */\n    /* handle error */\n}\nbuffersize *= 2;    /* increment buffersize */\n</code></pre>\n\n<p>Instead, you will do:</p>\n\n<pre><code>void *tmp = realloc (buffer, 2 * buffersize);  /* use a temporary pointer */\nif (tmp == NULL) {              /* validate reallocation */\n    perror (\"realloc-buffer\");  /* output error message */\n    /* handle error, buffer still points to original block */\n}\nbuf = tmp;\nbuffersize *= 2;\n</code></pre>\n\n<p>The way to digest how it works is through a minimal simple example. The following will read a line of unknown size from <code>stdin</code> using the portable <code>getchar()</code>, <code>malloc</code> and <code>realloc</code> making use of a reallocation scheme that simple doubles the size of the buffer each time you fill your buffer. (you are free to increment by any additional amount you like, but avoid reallocating for every character read -- that would be inefficient, doubling the buffer size or some similar increase minimizes the number of times you reallocate)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define NCHR 8  /* initial number of characters to allocate */\n\nint main (void) {\n\n    int c;                      /* char to read from stdin */\n    size_t  ndx = 0,            /* index/count of characters */\n            nchr = NCHR;        /* number of characters allocated in buf */\n    char *buf = malloc (nchr);  /* buffer allocated for nchr chars */\n\n    if (buf == NULL) {          /* validate that allocation succeeds */\n        perror (\"malloc-buf\");  /* otherwise handle error */\n        return 1;               /* bail */\n    }\n\n    /* read chars from stdin until '\\n' or EOF */\n    while ((c = getchar()) != '\\n' &amp;&amp; c != EOF) {\n        if (ndx == nchr - 1) {  /* check if reallocation is needed */\n            void *tmp = realloc (buf, 2 * nchr);    /* double buf size */\n            if (tmp == NULL) {  /* validate realloc succeeds */\n                perror (\"realloc-buf\"); /* handle error */\n                break;          /* break don't bail, buf holds chars read */\n            }\n            buf = tmp;      /* assign newly sized block of mem to buf */\n            nchr *= 2;      /* update nchr to new allocation size */\n        }\n        buf[ndx++] = c;     /* assign char to buf, increment index */\n    }\n    buf[ndx] = 0;       /* nul-terminate buffer */\n\n    if (c == EOF)       /* if read stopped on EOF */\n        putchar ('\\n'); /* tidy up outputting \\n */\n\n    printf (\"length : %zu\\ncontent: %s\\n\", ndx, buf);\n\n    free (buf);     /* don't forget to free what you allocate */\n}\n</code></pre>\n\n<p>(<strong>note:</strong> the check for <code>EOF</code> which will be generated by <kbd>Ctrl + d</kbd> (or <kbd>Ctrl + z</kbd> on windows) and the output of an additional <code>'\\n'</code> when encountered, otherwise your next output will begin at the end of your current input. Also note <code>nchr - 1</code> in <code>if (ndx == nchr - 1)</code> ensure there is always 1-character available for storing the <em>nul-terminating</em> after the loop exits.)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/getchar_dyn\n1234 5678 9012 3456 7890\nlength : 24\ncontent: 1234 5678 9012 3456 7890\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/getchar_dyn\n==28053== Memcheck, a memory error detector\n==28053== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==28053== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==28053== Command: ./bin/getchar_dyn\n==28053==\n1234 5678 9012 3456 7890\nlength : 24\ncontent: 1234 5678 9012 3456 7890\n==28053==\n==28053== HEAP SUMMARY:\n==28053==     in use at exit: 0 bytes in 0 blocks\n==28053==   total heap usage: 3 allocs, 3 frees, 56 bytes allocated\n==28053==\n==28053== All heap blocks were freed -- no leaks are possible\n==28053==\n==28053== For counts of detected and suppressed errors, rerun with: -v\n==28053== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 67, "user_id": 9715157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rogelio", "link": "https://stackoverflow.com/users/9715157/rogelio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "closed_date": 1555129288, "accepted_answer_id": 55619463, "answer_count": 4, "score": 0, "last_activity_date": 1555129175, "creation_date": 1554920891, "last_edit_date": 1555129175, "question_id": 55619137, "link": "https://stackoverflow.com/questions/55619137/i-need-to-be-able-to-read-a-string-from-standard-input", "closed_reason": "Duplicate", "title": "I need to be able to read a string from standard input", "body": "<p>I am trying to read some data from stdin. It will be numbers (any # of digits) which are separated by whitespace. The problem is that I don't know the length beforehand. I want to be able to read from stdin and use that to manipulate something, this repeats until ^d is pressed. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint \nmain(){\n\nchar input[] = scanf(\"%s\", &amp;input);\n\nfor(int i=0; i&lt;sizeof(&amp;input);i++){\n\n//Do something\n\n}\n\n}\n</code></pre>\n\n<p>This does not work, but how can I change it to make it work?</p>\n"}, {"tags": ["c", "list", "malloc", "free"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1554920485, "post_id": 55618924, "comment_id": 97931243, "body": "You don&#39;t really <i>have</i> to free dynamically allocated memory if you&#39;re going to exit right away, but doing so makes your code more flexible for future additions.  If you want to free it all, then you have to free each pointer that was returned by <code>malloc</code>, <code>realloc</code>, etc."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554920799, "post_id": 55618924, "comment_id": 97931369, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 43, "user_id": 10402917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9ae8a4c5ca83ce2dc29521ed645109?s=128&d=identicon&r=PG&f=1", "display_name": "espionn", "link": "https://stackoverflow.com/users/10402917/espionn"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1554920887, "post_id": 55618924, "comment_id": 97931421, "body": "@Tom Karzes This was something I always wondered actually. I always assumed that memory should be released on program exit, but it&#39;s always stressed at university to free dynamically allocated memory so I was unsure. Thanks for clarifying!"}, {"owner": {"reputation": 43, "user_id": 10402917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9ae8a4c5ca83ce2dc29521ed645109?s=128&d=identicon&r=PG&f=1", "display_name": "espionn", "link": "https://stackoverflow.com/users/10402917/espionn"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554921058, "post_id": 55618924, "comment_id": 97931492, "body": "@EOF I&#39;m not asking for help code debugging per se, so I&#39;m not sure how a MCV example is helpful here. I provided the code to give an idea of what I was trying to accomplish, not for readers to compile."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1554921068, "post_id": 55618924, "comment_id": 97931497, "body": "Another reason to do so is to make it easier to use tools that look for memory leaks."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554921357, "post_id": 55618924, "comment_id": 97931630, "body": "@espionn Either you&#39;re asking a question about memory menagement <i>in general</i> (what to <code>free()</code>, for example), in which case you do not need to post <i>any</i> code (least of all the code you have posted), or you&#39;re asking about your <i>specific</i> code and why it crashes, in which case you very much need to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Choose one."}], "answers": [{"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1554922517, "creation_date": 1554922517, "answer_id": 55619538, "question_id": 55618924, "link": "https://stackoverflow.com/questions/55618924/how-to-correctly-free-nested-data-structures/55619538#55619538", "title": "How to correctly free nested data structures?", "body": "<p>Omitting the call to <code>destroy_tree</code> will not free your memory.</p>\n\n<p>I see only two possibilities. Either <code>destroy_tree</code> needs to be armored against <code>NULL</code> or you have heap corruption elsewhere. Armor like so:</p>\n\n<pre><code>void destroy_tree(BST* self)\n{\n    if (!self) return;\n    destroy_tree_node(self-&gt;root);\n    free(self);\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10402917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9ae8a4c5ca83ce2dc29521ed645109?s=128&d=identicon&r=PG&f=1", "display_name": "espionn", "link": "https://stackoverflow.com/users/10402917/espionn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554922517, "creation_date": 1554920069, "last_edit_date": 1554920769, "question_id": 55618924, "link": "https://stackoverflow.com/questions/55618924/how-to-correctly-free-nested-data-structures", "title": "How to correctly free nested data structures?", "body": "<p>I have a small program which creates a linked list, the nodes of which house (pointers to) binary trees. When I exit the program I obviously want to deallocate this memory, I initially thought that I had to free all the tree nodes and the tree, and only then could I free the linked list members otherwise I'd be leaking memory. Is this incorrect? Do I only need to free the linked list nodes, and since these point to the binary trees the trees are automatically freed?</p>\n\n<p>When I destroy the trees first, I get a crash trying to deallocate the list nodes, so I assume I should be just freeing the linked list, but I can't find a good source online for this so I thought I'd ask here.</p>\n\n<p>Here's an excerpt of some of the code, the bit in question is the <code>destroy_list()</code> function, I just want to know if omitting the call to <code>destroy_tree()</code> will correctly free my memory.</p>\n\n<pre><code>typedef struct listNode\n{\n    char* name;\n    BST* customers;\n    struct listNode *next;\n} ListNode;\n\ntypedef struct list\n{\n    ListNode* head;\n} List;\n\ntypedef struct bstnode\n{\n    long data;\n    struct bstnode* left_node;\n    struct bstnode* right_node;\n} bstNode;\n\ntypedef struct bst\n{\n    bstNode* root;\n} BST;\n\nvoid destroy_list(List *self)\n{\n    ListNode* cursor = self-&gt;head;\n    ListNode* prev = NULL;\n\n    while (cursor != NULL)\n    {\n        prev = cursor;\n        cursor = cursor-&gt;next;\n        destroy_tree(prev-&gt;customers);\n        free(prev);\n    }\n    self-&gt;head = NULL;\n}\n\nvoid destroy_tree_node(bstNode* self)\n{\n    if (self == NULL)\n        return;\n    destroy_tree_node(self-&gt;left_node);\n    destroy_tree_node(self-&gt;right_node);\n    free(self);\n}\n\nvoid destroy_tree(BST* self)\n{\n    destroy_tree_node(self-&gt;root);\n    free(self);\n}\n\n</code></pre>\n\n<p>Thanks for your help!</p>\n\n<p>EDIT: I just commented out the line, and it still crashes. I should've done some more investigation before posting a question, but I am going to leave it up since I am still interested in an answer to the question of whether the BST should be free'd independently of the list or not.</p>\n"}, {"tags": ["c", "command-line-arguments", "stdin", "fopen"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1554920251, "post_id": 55618908, "comment_id": 97931127, "body": "You <code>fopen</code>, but I don&#39;t think <code>getchar</code> knows about your <code>fp</code> pointer. Other functions would be better."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554920699, "post_id": 55618908, "comment_id": 97931324, "body": "You should use the <code>SIZE</code> macro in the declaration of <code>binary</code>."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1554920347, "post_id": 55618955, "comment_id": 97931169, "body": "And maybe check argc and assign fp stdin if needed."}, {"owner": {"reputation": 357, "user_id": 4794247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43ea7318d308e90846522cd2b65f1ceb?s=128&d=identicon&r=PG&f=1", "display_name": "RockAndaHardPlace", "link": "https://stackoverflow.com/users/4794247/rockandahardplace"}, "edited": false, "score": 0, "creation_date": 1554920463, "post_id": 55618955, "comment_id": 97931232, "body": "That fixed it, thanks! I was wondering if that&#39;s what I needed to do but felt that ...fopen (argv[1], &quot;r&quot;) : stdin; would mean that I didn&#39;t need to do that."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554920604, "post_id": 55618955, "comment_id": 97931290, "body": "Why would you think that? A program can open files and still read from stdin."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1554920630, "post_id": 55618955, "comment_id": 97931304, "body": "@MichaelDorgan I was adding that to the answer while you commented."}, {"owner": {"reputation": 357, "user_id": 4794247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43ea7318d308e90846522cd2b65f1ceb?s=128&d=identicon&r=PG&f=1", "display_name": "RockAndaHardPlace", "link": "https://stackoverflow.com/users/4794247/rockandahardplace"}, "edited": false, "score": 0, "creation_date": 1554921341, "post_id": 55618955, "comment_id": 97931621, "body": "@Barmar if I were to use your second suggested method, would I need to use getchar() instead of getc(fp) as now stdin would be connected to the file?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554921424, "post_id": 55618955, "comment_id": 97931659, "body": "If you use the second method, there is no <code>fp</code>. You just read from <code>stdin</code> just like normal."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1554920528, "last_edit_date": 1554920528, "creation_date": 1554920219, "answer_id": 55618955, "question_id": 55618908, "link": "https://stackoverflow.com/questions/55618908/c-program-asking-for-user-input-even-when-input-file-is-given-as-an-argument/55618955#55618955", "title": "C: Program asking for user input even when input file is given as an argument", "body": "<p><code>getchar()</code> reads from <code>stdin</code>, but you have to do all your input from <code>fp</code>. Change <code>getchar()</code> to <code>getc(fp)</code>.</p>\n\n<p><code>getchar()</code> is basically just short for <code>getc(stdin)</code>.</p>\n\n<p>Another way to do this is to connect <code>stdin</code> to the file, instead of using another variable.</p>\n\n<pre><code>if (argc &gt; 1) {\n    freopen(argv[1], \"r\", stdin);\n}\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 4794247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43ea7318d308e90846522cd2b65f1ceb?s=128&d=identicon&r=PG&f=1", "display_name": "RockAndaHardPlace", "link": "https://stackoverflow.com/users/4794247/rockandahardplace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55618955, "answer_count": 1, "score": 0, "last_activity_date": 1554920528, "creation_date": 1554920011, "last_edit_date": 1554920369, "question_id": 55618908, "link": "https://stackoverflow.com/questions/55618908/c-program-asking-for-user-input-even-when-input-file-is-given-as-an-argument", "title": "C: Program asking for user input even when input file is given as an argument", "body": "<p>My program needs to take in a file input, and if one is not given, it needs to consider user input as its input. </p>\n\n<p>When I feed an input file into the program like so: </p>\n\n<pre><code>./sim &lt; ex1_in\n</code></pre>\n\n<p>everything works as it should! </p>\n\n<p>However, when I specify an input file as a file argument, like so: </p>\n\n<pre><code>./sim ex1_in\n</code></pre>\n\n<p>the program looks for user input instead. </p>\n\n<p>This is the part of the code that handles input and file arguments: </p>\n\n<pre><code>int main(int argc, char * argv []) {    \n\n    if (argc &gt; 3) {\n        fprintf (stderr, \"Error: Too many arguments.\\n\");\n        return 1;\n    }\n\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* check file */\n        fprintf (stderr, \"Error: File Open Failed '%s'.\\n\", argv[1]);\n        return 2;\n    }    \n\n    //Initializing array of 256 unsigned chars\n    unsigned char binary[256]; \n    int i = 0; \n    unsigned char c;\n    int count2 = 0; \n\n\n    //populate the 256 byte char array from stdin\n    while (count2 &lt; SIZE) {\n        c=getchar();\n        binary[i] = c;\n        i++;\n        count2++;                   \n    }          \n</code></pre>\n\n<p>So far, I've identified this <code>while</code> loop as a problem area as when I comment it out, the unwanted behavior doesn't happen. But I'm not sure why that is. </p>\n\n<p>Later in the <code>main</code> method, the file is closed: </p>\n\n<pre><code>if (fp != stdin) fclose (fp);   /* close file if not stdin */    \n</code></pre>\n\n<p>Another pertinent thing: </p>\n\n<pre><code>#define SIZE 256\n</code></pre>\n"}, {"tags": ["c", "pthreads", "fork", "shared-memory"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1554919354, "post_id": 55618674, "comment_id": 97930678, "body": "It&#39;s technically undefined unless you use some kind of lock, or preferably, make the counter atomic and use atomic operations on it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1554919429, "post_id": 55618674, "comment_id": 97930719, "body": "I recommend writing a simple program for <i>integers</i>. Have multiple threads increment a (<code>volatile</code>) integer a fixed number of times in parallel, without synchronization. Compare the result with the fixed number of increments multiplied by the number of threads. Read about atomicity and undefined behavior."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1554928044, "post_id": 55618674, "comment_id": 97934598, "body": "Why not have a separate counter per thread and combine them at the end?"}, {"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 0, "creation_date": 1554968823, "post_id": 55618674, "comment_id": 97946279, "body": "Also, be very careful to not use volatile as a poor man&#39;s atomic, that is just incorrect usage of volatile. C got a well defined threaded memory model standardized, basically it took the standard C++ concurrency/atomicity model wholesale."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8594982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cRwPspsVovo/AAAAAAAAAAI/AAAAAAAAF18/AobXDq1fdxk/photo.jpg?sz=128", "display_name": " STRIKE-F", "link": "https://stackoverflow.com/users/8594982/strike-f"}, "edited": false, "score": 0, "creation_date": 1555059289, "post_id": 55625433, "comment_id": 97984803, "body": "I guess it&#39;s necessary and safe to implement mutex or semaphore then. Thank you for your kind answer."}], "tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 1, "last_activity_date": 1554961249, "creation_date": 1554961249, "answer_id": 55625433, "question_id": 55618674, "link": "https://stackoverflow.com/questions/55618674/is-implementing-semaphore-or-mutex-necessary-for-simple-counter/55625433#55625433", "title": "Is implementing semaphore or mutex necessary for simple counter?", "body": "<p>If your threads are all racing to update the same object (ie, the <code>targ-&gt;resptr</code> for each thread points at the same thing), then yes - you do have a data race and you can see incorrect results (likely, \"lost updates\" where two threads that happen to finish at the same time try to update the sum, and only one of them is effective).</p>\n\n<p>You probably haven't seen this because the execution time of your <code>integralproc()</code> function is long, so the chances of multiple threads simultaneously getting to the point of updating <code>*targ-&gt;resptr</code> is low.</p>\n\n<p>Nonetheless, you should still fix the problem.  You can either add a mutex lock/unlock around the sum update:</p>\n\n<pre><code>pthread_mutex_lock(&amp;result_lock);\n*(targ-&gt;resptr) += res;\npthread_mutex_unlock(&amp;result_lock);\n</code></pre>\n\n<p>(This shouldn't affect the efficiency of the solution, since you are only locking and unlocking once in the lifetime of each thread).</p>\n\n<p>Alternatively, you can have each thread record its own partial result in its own thread argument structure:</p>\n\n<pre><code>targ-&gt;result = res;\n</code></pre>\n\n<p>Then, once the worker threads have all been <code>pthread_join()</code>ed the parent thread that created them can just go through all the thread argument structures and add up the partial results.</p>\n\n<p>No extra locking is needed here because the worker threads don't access each others result variable, and the <code>pthread_join()</code> provides the necessary synchronisation between the worker setting the result and the parent thread reading it.</p>\n"}], "owner": {"reputation": 33, "user_id": 8594982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cRwPspsVovo/AAAAAAAAAAI/AAAAAAAAF18/AobXDq1fdxk/photo.jpg?sz=128", "display_name": " STRIKE-F", "link": "https://stackoverflow.com/users/8594982/strike-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55625433, "answer_count": 1, "score": 0, "last_activity_date": 1554961249, "creation_date": 1554919032, "question_id": 55618674, "link": "https://stackoverflow.com/questions/55618674/is-implementing-semaphore-or-mutex-necessary-for-simple-counter", "title": "Is implementing semaphore or mutex necessary for simple counter?", "body": "<p>I tried implementing programs that calculates sort of integral. And in order to speed up the computation, one creates multiple processes and other uses multiple threads. In my program, each process adds a double value into shared memory and each thread adds a double value through the pointer.</p>\n\n<p>Here's my question. The add operation obviously loads the value from memory, add a value to that, and stores the result to the memory. So it seems my code is quite prone to producer-consumer problem as many processes/threads access the same memory area. However, I couldn't find the case where somebody used semaphores or mutexes to implement a simple accumulator neither.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// creating processes\nwhile (whatever)\n{\n    pid = fork();\n    if (pid == 0)\n    {\n        res = integralproc(clist, m, tmpcnt, tmpleft, tmpright);\n        *(createshm(shm_key)) += res;\n        exit(1);\n    }\n}\n// creating or retrieving shared memory\nlong double* createshm(int key)\n{\n    int shm_id = -1;\n    void* shm_ptr = (void*)-1;\n    while (shm_id == -1)\n    {\n        shm_id = shmget((key_t)key, sizeof(long double), IPC_CREAT | 0777);\n    }\n    while (shm_ptr == (void*)-1)\n    {\n        shm_ptr = shmat(shm_id, (void*)0, 0);\n    }\n    return (long double*)shm_ptr;\n}\n\n// creating threads\nwhile (whatever)\n{\n    threadres = pthread_create(&amp;(targs[i]-&gt;thread_handle), NULL, integral_thread, (void*)targs[i]);\n}\n// thread function. targ-&gt;resptr is pointer that we add the result to.\nvoid *integral_thread(void *arg)\n{\n    threadarg *targ = (threadarg*)arg;\n    long double res = integralproc(targ-&gt;clist, targ-&gt;m, targ-&gt;n, targ-&gt;left, targ-&gt;right);\n    *(targ-&gt;resptr) += res;\n    //printf(\"thread %ld calculated %Lf\\n\", targ-&gt;i, res);\n    pthread_exit(NULL);\n}\n</code></pre>\n\n<p>So I implemented it this way, and so far no matter how many processes/threads I make, the result was as if it never happened.\nI'm concerned that my codes may still be potentially dangerous, just barely out of my sight. \nIs this code truly safe from any of these problems? Or am I overlooking at something and should the code be revised?</p>\n"}, {"tags": ["c", "http", "client"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1554919161, "post_id": 55618641, "comment_id": 97930589, "body": "For starters, you <i>cannot</i> use <code>fgets()</code> to read binary data.  SUGGESTIONS: 1) If you can use a different language and/or a higher-level HTTP library, then you probably should.  2) Otherwise, Google for some C-language/socket examples.  3) Please post back with what you find, and subsequent questions you might have.  Once you find an alternative to <code>fgets()</code>."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1554919571, "post_id": 55618641, "comment_id": 97930789, "body": "@paulsm4 Hello, I have to use C. All socket examples that I found online are to simple. I can for Example download that .png and open it with <code>fopen</code> and then read the data with <code>rb</code>. Would this be good start?"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1555094004, "post_id": 55618641, "comment_id": 98003892, "body": "Q: Did you get this working?  If not, Q: Is there any reason you have to use &quot;C&quot;?  Q: Can you use C libraries like <a href=\"https://curl.haxx.se/libcurl\" rel=\"nofollow noreferrer\">libCurl</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 9314483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/185735ee8db2a425cc9ff72a69fbca49?s=128&d=identicon&r=PG&f=1", "display_name": "l.k", "link": "https://stackoverflow.com/users/9314483/l-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1554929633, "last_edit_date": 1554929633, "creation_date": 1554926120, "answer_id": 55620378, "question_id": 55618641, "link": "https://stackoverflow.com/questions/55618641/byte-ordering-http-client/55620378#55620378", "title": "Byte ordering HTTP Client", "body": "<p>It wouldn't make a whole lot of sense to write out the image's bytes before deciding which order they should be in.  What would be your next line be, <code>fopen()</code>?</p>\n\n<hr>\n\n<p>If you're doing something architecture dependent like this, it's best to guard the case-specific sections with <code>#if</code>/<em><code>#elif</code></em>, and use <code>#else</code> to emit <code>#error</code> with a diagnostic message.\nIf everything is <em>supposed to</em> still work, it can just be <code>#warning</code>... but do put the warning in.  For later, when it stops working.  </p>\n\n<p>Configuration macros you can test should include <code>#ifdef __BIG_ENDIAN__</code> and <code>#if __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__</code>; you can see what else is available by 'compiling' with <code>-E -dD</code>.  <em>[there will be a lot; grep is your friend]</em></p>\n\n<p>Oh, and \"big endian\" means if you're reading bytes in address order <em>(a[0], a[1], a[2], ...),</em> then the byte at this end is the most significant/highest 'digit'.  Hence  \"big-endian\".</p>\n\n<p>edit: this may also be of concern...</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>FILE *sockfile = fdopen(sockfd, \"r+\");                     // \"r+\"\nif (sockfile == NULL)\n    ERROR_EXIT(\"fdopen: %s\\n\", strerror(errno));\n\nif (fputs(\"GET / HTTP/1.1\\r\\n\\r\\n\", sockfile) == EOF)      // fputs...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": true, "score": 1, "last_activity_date": 1554927156, "creation_date": 1554927156, "answer_id": 55620625, "question_id": 55618641, "link": "https://stackoverflow.com/questions/55618641/byte-ordering-http-client/55620625#55620625", "title": "Byte ordering HTTP Client", "body": "<p>The problem is more complex than just \"byte order\".</p>\n\n<p>The Good News is that byte order is <em>probably irrelevant</em>.  The code you've got now should work just fine sending and receiving text strings with the server.</p>\n\n<p>The Bad News is that you need to connect <em>differently</em> if you want to read <em>binary</em> data from the server.  Several considerations:</p>\n\n<ul>\n<li><p>It sounds like you probably don't need to worry about \"POST\", \"PUT\" ... or anything but \"GET\".</p></li>\n<li><p>It also sounds like you don't need to worry about \"MIME Types\" or \"uuencoding/decoding\" - you'll just be reading the data as-is.</p></li>\n<li><p>You should <em>definitely</em> read the <code>Content-Type</code> and <code>Content-Length</code> headers from the server's HTTP response.</p></li>\n<li><p>Perhaps the simplest approach is just call <code>fgetc()</code> in a loop if you're reading binary data.  Use <code>fgets()</code> for strings, and <code>fgetc()</code> for <code>Content-Length</code> bytes to read the image.</p></li>\n<li><p>You'll probably want to do an <code>fopen()</code> to write the image bytes to a file.</p></li>\n<li><p>But calling fgets() eliminates the need to worry about \"byte order\".</p></li>\n</ul>\n\n<p>Look <a href=\"https://medium.com/from-the-scratch/http-server-what-do-you-need-to-know-to-build-a-simple-http-server-from-scratch-d1ef8945e4fa\" rel=\"nofollow noreferrer\">here</a>, <a href=\"https://stackoverflow.com/questions/28763469/display-image-from-web-server-in-c\">here</a> and <a href=\"http://jkorpela.fi/forms/cgic.html\" rel=\"nofollow noreferrer\">here</a> for examples.</p>\n\n<p>'Hope that helps...</p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 55620625, "answer_count": 2, "score": 0, "last_activity_date": 1554929633, "creation_date": 1554918893, "question_id": 55618641, "link": "https://stackoverflow.com/questions/55618641/byte-ordering-http-client", "title": "Byte ordering HTTP Client", "body": "<p>I wrote a simple HTTP Client that can request data from a host. </p>\n\n<p>I am using getaddrinfo(3). With \"GET / HTTP/1.1\" request I am able to download HTML page of a given http Host. </p>\n\n<p>Here is a part of my code: </p>\n\n<pre><code>struct addrinfo hints, *ai;\nmemset(&amp;hints, 0, sizeof(hints));\nhints.ai_family = AF_INET; // Internet Protocol (IP) socket\nhints.ai_socktype = SOCK_STREAM; // TCP \n\nint res = getaddrinfo(\"example.com\", \"http\", &amp;hints, &amp;ai);\nif (res != 0)\n    ERROR_EXIT(\"getaddrinfo: %s\\n\", gai_strerror(res));\n\nint sockfd = socket(ai-&gt;ai_family, ai-&gt;ai_socktype, ai-&gt;ai_protocol);\nif (sockfd &lt; 0)\n    ERROR_EXIT(\"socket: %s\\n\", strerror(errno));\n\nif (connect(sockfd, ai-&gt;ai_addr, ai-&gt;ai_addrlen) &lt; 0)\n    ERROR_EXIT(\"connect: %s\\n\", strerror(errno));\n\nFILE *sockfile = fdopen(sockfd, \"r+\");\nif (sockfile == NULL)\n    ERROR_EXIT(\"fdopen: %s\\n\", strerror(errno));\n\n// send a GET request to the server:\nif (fputs(\"GET / HTTP/1.1\\r\\n\\r\\n\", sockfile) == EOF)\n    ERROR_EXIT(\"fputs: %s\\n\", strerror(errno));\nif (fflush(sockfile) == EOF)\n    ERROR_EXIT(\"fflush: %s\\n\", strerror(errno));\n\nchar buf[1024];\n\n// print the reply:\nwhile (fgets(buf, sizeof(buf), sockfile) != NULL)\n    fputs(buf, stdout);\n\nfclose(sockfile);\nreturn 0;\n</code></pre>\n\n<p>Downloading a HTML page works ok, but downloading PNG image for example <code>\"GET /image.png HTTP/1.1\\r\\n\\r\\n\"</code> gives something like this:</p>\n\n<pre><code>???????\u0779h??DH\u01f1?yW]%?9a??J?6F?\u0466?E???\u0750Td?US?:)??I??M,?-????=??U??&amp;???Nr? ???\u0431??? \nb??]??8?6+?;??i\u40a2d?G?WA?r\u053a?H[??]?Z5????g?{8??i\\?qAC?@c??v.?rb??'&lt;?T?????O?z? \nq,y\u011c?\u0177ZI???X??fM?l?Z??l:;M???\u06e6?????c?\\\\?W6+???o?}_???\u7d08A??GvG?p??6{??{%?????0?{? \n%??\u0698??l?$r&lt;?????ft*'W?N?m\u07c2\u04be4??E?:^?#?&amp;?%%\n????Dw??Z?$??1?4?l%&amp;2?f-5!?? ?E? 8...\n</code></pre>\n\n<p>I understand that this is a byte transfer and that I have to do byte ordering, but don't know where to begin. </p>\n\n<p>I know that I need to use ntohl(3) and Big-endian order for PNG images. Can Someone give me directions what to look up and how to approach this? </p>\n\n<p>Do I save this output to .png file and then do byte order or do I do before I create a .png file? </p>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1554918122, "post_id": 55618379, "comment_id": 97930129, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. In particular, I&#39;d like to know what inputs you have tried for which <i>any</i> system you run this on will give a correct result."}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1554919916, "post_id": 55618379, "comment_id": 97930945, "body": "Your code has several problems. I do not understand why you reset your global <code>x</code> to 1 in your first loop. This will lead to incorrect results.  You have several globals that are updated incorrectly by the threads:  <code>f</code> and <code>s[0]</code>. For the second, you should use a reduction. For <code>f</code> use a thread local var."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1554924616, "post_id": 55618379, "comment_id": 97933070, "body": "There is a missing <code>}</code> before the second <code>#pragma omp for</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1554925097, "post_id": 55618379, "comment_id": 97933280, "body": "I&#39;m intrigued to see so much effort spent in threading this code, which will not reduce its intrinsic complexity, where the terms could be computed incrementally at a linear cost instead of using a <code>pow</code> function and a nested loop."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1554925259, "post_id": 55618379, "comment_id": 97933364, "body": "What exactly do you expect <code>omp</code> to compute in parallel? The first 2 <code>for</code> loops can compute in separate threads, but the final <code>for</code> loop needs the results of the previous loops, hence cannot be started in parallel with the previous 2. It must first wait for both to complete."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1554925420, "post_id": 55618379, "comment_id": 97933453, "body": "Furthermore, you should compute the sum from the least significant value to the most significant value to minimize the error."}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 1, "last_activity_date": 1554930908, "creation_date": 1554930908, "answer_id": 55621439, "question_id": 55618379, "link": "https://stackoverflow.com/questions/55618379/taylor-series-using-openmp/55621439#55621439", "title": "Taylor series using OpenMP", "body": "<pre><code>for (t = 0; t &lt; 150; t++)\n            s[0] = s[0] + (pwr[t] / fact[t]);\n</code></pre>\n\n<p>This code, when parallelized, will overwrite the same variable concurrently with partial calculation results. This can only work when the threads are coordinated somehow. Fortunately, openmp has a dedicated directive <code>reduce</code> for calculating sums, so you can fix this easily.</p>\n\n<p>In the <code>pthread</code> version of the code, one thread does this calculation, so no problem there.</p>\n"}], "owner": {"reputation": 31, "user_id": 11265149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_BIXnGN3bBY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMX22LEmNjVBHApn4DOsyJXrv3cg/mo/photo.jpg?sz=128", "display_name": "Fatimah Ali", "link": "https://stackoverflow.com/users/11265149/fatimah-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 1, "accepted_answer_id": 55621439, "answer_count": 1, "score": 0, "last_activity_date": 1554930908, "creation_date": 1554917715, "last_edit_date": 1554925517, "question_id": 55618379, "link": "https://stackoverflow.com/questions/55618379/taylor-series-using-openmp", "title": "Taylor series using OpenMP", "body": "<p>e<sup>x</sup> = 1 + x + x<sup>2</sup>/2! + x<sup>3</sup>/3! + x<sup>4</sup>/4! + x<sup>5</sup>/5! +...</p>\n\n<p>I have converted a Taylor series of e<sup>x</sup> (above) into a program of OpenMp.\nAll the codes are written below.</p>\n\n<p>When I run the code through Oracle Ubuntu it works.\nIt is giving me <code>e^0=1,e^1=2.718,e^2=7.389056</code></p>\n\n<p>But when I run it on Ubuntu (not virtually), then it doesn't work right.\nIt is giving me <code>e^0=nan,e^1=0.40..,e^2=4.780</code>.</p>\n\n<p>And output is totally random as in its not exact as I mentioned above.\nI need help.</p>\n\n<pre><code> #include &lt;math.h&gt;\n #include &lt;pthread.h&gt;\n #include &lt;stdlib.h&gt;\n\n long double x, fact[150], pwr[150], s[1];\n int i, term;\n\n void *Power(void *temp) {\n    int k;\n    for (k = 0; k &lt; 150; k++) {\n        pwr[k] = pow(x, k);\n        //printf(\"%.2Lf\\n\", pwr[k]);\n    }\n    return pwr;\n}\n\nvoid *Fact(void *temp) {\n    long double f;\n    int j;\n    fact[0] = 1.0;\n    for (term = 1; term &lt; 150; term++) {\n        f = 1.0;\n        for (j = term; j &gt; 0; j--)\n            f = f * j;\n        fact[term] = f;\n        //printf(\"%.2Lf\\n\", fact[term]);\n    }\n    return fact;\n}\n\nvoid *Exp(void *temp) {\n    int t;\n    s[0] = 0;\n    for (t = 0; t &lt; 150; t++)\n        s[0] = s[0] + (pwr[t] / fact[t]);\n    return s;\n}\n\nint main(void) {\n    pthread_t thread1, thread2, thread3;\n    long double **sum;\n    printf(\"Exponential [PROMPT] Enter the value of x (between 0 to 100) (for calculating exp(x)):\");\n    scanf(\"%Lf\", &amp;x);\n    printf(\"\\nExponential [INFO] Threads creating.....\\n\");\n    pthread_create(&amp;thread1, NULL, Power, NULL); //calling power function\n    pthread_create(&amp;thread2, NULL, Fact, NULL); //calling factorial function\n    printf(\"Exponential [INFO] Threads created\\n\");\n    pthread_join(thread1, NULL);\n    pthread_join(thread2, NULL);\n    printf(\"Exponential [INFO] Master thread and terminated threads are joining\\n\");\n    printf(\"Exponential [INFO] Result collected in Master thread\\n\");\n    pthread_create(&amp;thread3, NULL, Exp, NULL);\n    pthread_join(thread3, sum);\n    printf(\"\\neXPONENTIAL [INFO] Value of exp(%.2Lf) is : %Lf\\n\\n\", x, s[0]);\n    exit(1);\n}\n</code></pre>\n\n<p>The above code is originally for e<sup>x</sup> using threads which works.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;omp.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    long double x, f, fact[150], pwr[150], s[1];\n    int i, term, k, j, t;\n    long double sum;\n\n    printf(\"Exponential [PROMPT] Enter the value of x (between 0 to 100) (for calculating exp(x)):\");\n    scanf(\"%Lf\", &amp;x);\n    #pragma omp parallel num_threads(10)\n    #pragma omp for\n    for (k = 0; k &lt; 150; k++) {\n        for (int h = 0; h &lt;= k; h++) {\n            if (h == 0)\n                x = 1;\n            else\n                pwr[k] = pow(x, k);\n        }\n    #pragma omp for\n        for (term = 1; term &lt; 150; term++) {\n            f = 1.0;\n            for (j = term; j &gt; 0; j--)\n                f = f * j;\n            fact[term] = f;\n        }\n    #pragma omp for\n        for (t = 0; t &lt; 150; t++)\n            s[0] = s[0] + (pwr[t] / fact[t]);\n\n        printf(\"\\neXPONENTIAL [INFO] Value of exp(%.2Lf) is : %Lf\\n\\n\", x, s[0]);\n        exit(1);\n    }\n</code></pre>\n\n<p>And the code above is a conversion of the previous code to an OpenMP.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1554917297, "post_id": 55618088, "comment_id": 97929689, "body": "The implementation of <code>createNode()</code> might be relevant \u2014 see MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  Do you copy the string into newly allocated space, or do you just save the pointer?  You need to copy the string into new space (using <code>strdup()</code> for example).  Also, what is <code>size</code> \u2014 something that would be self-evident if you gave us an MCVE."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1554917317, "post_id": 55618088, "comment_id": 97929701, "body": "What is your question?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554917540, "post_id": 55618088, "comment_id": 97929819, "body": "What is <code>*store=*words[i];</code> supposed to do? You know it&#39;s equal to <code>store[0] = words[i][0];</code>?"}, {"owner": {"reputation": 111, "user_id": 9921472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VyxEBgaBKaY/AAAAAAAAAAI/AAAAAAAABv0/7rGuf07BXAk/photo.jpg?sz=128", "display_name": "Ieshaan Saxena", "link": "https://stackoverflow.com/users/9921472/ieshaan-saxena"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554917638, "post_id": 55618088, "comment_id": 97929867, "body": "I have removed the store, as it was not necessary sorry, for putting it in, @Someprogrammerdude , yes i realized it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554917663, "post_id": 55618088, "comment_id": 97929876, "body": "Oh and <code>*dup=*app;</code> followed by <code>strcat(dup,words[i]);</code> will lead to <i>undefined behavior</i> since the contents of <code>dup</code> is not a null-terminated string. You&#39;ll have UB with <code>strcat(words[i],app);</code> as well since <code>app</code> is also not a null-terminated string."}, {"owner": {"reputation": 111, "user_id": 9921472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VyxEBgaBKaY/AAAAAAAAAAI/AAAAAAAABv0/7rGuf07BXAk/photo.jpg?sz=128", "display_name": "Ieshaan Saxena", "link": "https://stackoverflow.com/users/9921472/ieshaan-saxena"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1554917725, "post_id": 55618088, "comment_id": 97929907, "body": "@Code-Apprentice I am unable to understand how the string tokenizer is working with pointers. Also, I am getting weird results with that."}, {"owner": {"reputation": 111, "user_id": 9921472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VyxEBgaBKaY/AAAAAAAAAAI/AAAAAAAABv0/7rGuf07BXAk/photo.jpg?sz=128", "display_name": "Ieshaan Saxena", "link": "https://stackoverflow.com/users/9921472/ieshaan-saxena"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554917832, "post_id": 55618088, "comment_id": 97929961, "body": "@Someprogrammerdude Yes, that&#39;s the part causing the errors, I understand now."}, {"owner": {"reputation": 111, "user_id": 9921472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VyxEBgaBKaY/AAAAAAAAAAI/AAAAAAAABv0/7rGuf07BXAk/photo.jpg?sz=128", "display_name": "Ieshaan Saxena", "link": "https://stackoverflow.com/users/9921472/ieshaan-saxena"}, "edited": false, "score": 0, "creation_date": 1554918839, "post_id": 55618088, "comment_id": 97930439, "body": "How do I close this question??"}], "owner": {"reputation": 111, "user_id": 9921472, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VyxEBgaBKaY/AAAAAAAAAAI/AAAAAAAABv0/7rGuf07BXAk/photo.jpg?sz=128", "display_name": "Ieshaan Saxena", "link": "https://stackoverflow.com/users/9921472/ieshaan-saxena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554917583, "creation_date": 1554916582, "last_edit_date": 1554917583, "question_id": 55618088, "link": "https://stackoverflow.com/questions/55618088/tokenizing-elements-and-storing-them-in-an-n-ary-tree", "title": "Tokenizing elements and storing them in an n-ary tree", "body": "<p>My goal is to tokenize the strings using delimiter '.' and then store them in the form of n-ary tree, with successive children containing the tokenized elements. I have problem storing the elements in an array of strings. And hence not able to store them. I also want to ask functioning of <code>strtok()</code> in C.\nHere is my code</p>\n\n<pre><code>int main()\n{   int opt,n;\n    printf(\"Option,then number of cases:\\n\");\n    scanf(\"%d %d\",&amp;opt,&amp;n);\n\n    node *root=createNode(\"root\");\n\n    char **words=arr_strings(size,n);\n\n    char *dns_word=malloc(sizeof(char)*size);\n    char *app=malloc(sizeof(char)*size);\n    app[0]='.';\n    char *dup=malloc(sizeof(char)*size);\n    char *store=malloc(sizeof(char)*size);\n\n    for(int i=0;i&lt;n;i++)\n        {printf(\"Word %d: \",i+1);\n        scanf(\"%s\",words[i]);\n        *dup=*app;\n        strcat(dup,words[i]);\n        strcpy(words[i],dup);\n        strcat(words[i],app);\n        *store=*words[i];\n        printf(\"Word %d:%s\\n\",i,words[i]);\n        int j=0;\n        dns_word=strtok(words[i],\".\");\n        node *temp=createNode(dns_word);\n        while(dns_word!=NULL){\n            if(i==0)\n                {//printf(\"Entered one child condition\\n\");\n                if(j==0)\n                    {root-&gt;child=temp;\n                    }\n                else\n                    {\n                    temp-&gt;child=createNode(dns_word);\n                    temp-&gt;children++;\n                    temp=temp-&gt;child;\n                    }\n                }\n            else    \n                {\n                //printf(\"Entering else of inserting loop\\n\");\n                //printf(\"dns_word:%s\\n\",dns_word);\n                int t=root-&gt;children;\n                node* copy=root-&gt;child;\n                for(int j=1;j&lt;root-&gt;children;j++)\n                    {copy=copy-&gt;next;\n                    }\n                if(j==0)\n                    {copy-&gt;next=temp;copy-&gt;children++;}\n                else    \n                    {\n                    temp-&gt;child=createNode(dns_word);\n                    temp-&gt;children++;\n                    temp=temp-&gt;child;                   \n                    }\n                }\n            dns_word=strtok(NULL,\".\");\n            j++;\n            }\n        //printf(\"Word %d:%s\\n\",i,words[i]);\n        root-&gt;children++;\n\n        }   \n    //Ignore this\n    printf(\"Root,child:%s\\n\",root-&gt;child-&gt;word);\n    printf(\"Root,child,next:%s\\n\",((root-&gt;child)-&gt;next)-&gt;word);\n    //print(root-&gt;child);\n    return 0;\n}\n</code></pre>\n\n<p>The structure of the node is provided here. </p>\n\n<pre><code>struct node{\n    char *word;\n    int children;\n    struct node* child; \n    struct node* next;  \n};\ntypedef struct node node;\n</code></pre>\n\n<p>The createNode function is as follows:</p>\n\n<pre><code>node* createNode(char *word)\n    {\n    node* new=malloc(sizeof(node));\n    new-&gt;word=word;\n    new-&gt;child=NULL;\n    new-&gt;next=NULL;\n    new-&gt;children=0;\n    return new;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "tcp", "casting", "pthreads"], "comments": [{"owner": {"reputation": 177, "user_id": 9499535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Horacio Goetendia", "link": "https://stackoverflow.com/users/9499535/horacio-goetendia"}, "edited": false, "score": 0, "creation_date": 1554916826, "post_id": 55618031, "comment_id": 97929448, "body": "Why your function definition &quot;int *clinet_socket;&quot; can&#39;t be &quot;void *clinet_socket&quot; ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554917058, "post_id": 55618031, "comment_id": 97929572, "body": "Multiple problems with the <code>messenger</code> function: 1) The variable <code>sockel</code> is a pointer, <code>&amp;sockel</code> is a pointer to the pointer. 2) You define <code>sockerde</code> as a <i>pointer</i> to an array of <code>30</code> unsigned integers, not as an array of 30 pointers (if that&#39;s what you really wanted). 3) You never initialize the pointer <code>sockerde</code>, so dereferencing it is <i>undefined behavior</i>. 4) <code>(*sockerde)[users]</code> is an <code>unsigned int</code> while <code>(unsigned int(*))&amp;sockel</code> is a pointer, and this is where the warning message comes from."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554917225, "post_id": 55618031, "comment_id": 97929656, "body": "There are other possible problems as well, for example one that depends on the life-time of the <code>new_socket</code> variable compared to the life-time of the thread."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554917238, "post_id": 55618031, "comment_id": 97929662, "body": "All in all, you probably should take a few steps back, and go back to a beginners book or tutorial and read more about pointers and how they work."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554917375, "post_id": 55618031, "comment_id": 97929734, "body": "Oh and lastly, when using <code>pthread_create</code> it&#39;s usually one of the very few times where it&#39;s considered okay to cast a value to a pointer, and in the function do the opposite cast. Like e.g. <code>pthread_create(&amp;thread_id, NULL, messenger, (void *) (intptr_t) new_socket)</code>, and in the function <code>int sock = (int) (intptr_t) sockel;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1554917443, "creation_date": 1554917443, "answer_id": 55618310, "question_id": 55618031, "link": "https://stackoverflow.com/questions/55618031/c-warning-assignment-makes-integer-from-pointer-without-a-cast-pointer-to-int/55618310#55618310", "title": "C warning: assignment makes integer from pointer without a cast / pointer to integer array", "body": "<p>The part you're having trouble with is the least of your problems.</p>\n\n<ul>\n<li>You're not doing error checks.</li>\n<li>You're passing the socket value by reference but you did in no way ensure the <code>new_socket</code> value stays stable before the new thread picks it up.</li>\n<li>you're assigning through the <code>unsigned int (*sockerde)[30];</code> array pointer, which is pointing nowhere!</li>\n<li>you're accessing a global from multiple threads without doing any synchronization</li>\n</ul>\n\n<p>and finally</p>\n\n<ul>\n<li>you're casting the address of a local parameter (no point in doing this) to  <code>unsigned int*</code> using a weird parenthesizing style and then you try to assign it, through an invalid pointer, to an <code>unsigned int</code>, which is what's causing the type error.</li>\n</ul>\n\n<p>Maybe pick up a book?</p>\n"}], "owner": {"reputation": 1, "user_id": 11005539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c8e1c5324af478a6ad4f635562f5009?s=128&d=identicon&r=PG&f=1", "display_name": "ShyHazelnut", "link": "https://stackoverflow.com/users/11005539/shyhazelnut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554924037, "creation_date": 1554916388, "last_edit_date": 1554924037, "question_id": 55618031, "link": "https://stackoverflow.com/questions/55618031/c-warning-assignment-makes-integer-from-pointer-without-a-cast-pointer-to-int", "title": "C warning: assignment makes integer from pointer without a cast / pointer to integer array", "body": "<p>I'm trying to make a chatroom using TCP/IP in C but every new client is a new thread. The clients have to communicate with each other with the server. I have a problem when creating a new thread.</p>\n\n<p>When calling <code>pthread_create(&amp;thread_id, NULL, messenger, (void*)client_socket)</code>, I'm trying to pass the socket descriptor of the new client and add it in an integer array. But no matter what I try, I get this warning:</p>\n\n<blockquote>\n  <p>assignment makes integer from pointer without a cast</p>\n</blockquote>\n\n<p>Here's the code I'm having trouble with. There is a global int variable called <code>users</code> in the <code>main</code> function:</p>\n\n<pre><code>users = 0;\nint new_socket;\nint *clinet_socket;\n\nnew_socket = accept(master_socket, (struct sockaddr *)&amp;address, (socklen_t*)&amp;addrlen);\nclient_socket = &amp;new_socket;\n\npthread_create(&amp;thread_id, NULL, messenger, (void*)client_socket)\n</code></pre>\n\n<p>Here is the <code>messenger</code> function:</p>\n\n<pre><code>void *messenger(void *sockel){\n   unsigned int (*sockerde)[30];\n\n   (*sockerde)[users] = (unsigned int(*))&amp;sockel;\n   users++;\n}\n</code></pre>\n\n<p>The point is to keep an array with the socket descriptors of all connected clients in order to use it later on.</p>\n"}, {"tags": ["c", "addition"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1554915692, "post_id": 55617827, "comment_id": 97928919, "body": "The <code>float</code> type typically has 6-7 decimal digits of accuracy.  You&#39;re pushing beyond those limits and finding that it isn&#39;t accurate.  See <a href=\"https://stackoverflow.com/questions/588004/\">Is floating-point math broken?</a> for more details."}, {"owner": {"reputation": 318, "user_id": 9650663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ANjbi.png?s=128&g=1", "display_name": "Kevin Vandy", "link": "https://stackoverflow.com/users/9650663/kevin-vandy"}, "edited": false, "score": 1, "creation_date": 1554915699, "post_id": 55617827, "comment_id": 97928923, "body": "Floats and Doubles are not exact numbers in C. There is a rounding error."}, {"owner": {"reputation": 1180, "user_id": 4766261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd4d03badb6ebc92b17af75766fdd57?s=128&d=identicon&r=PG", "display_name": "SiggiSv", "link": "https://stackoverflow.com/users/4766261/siggisv"}, "edited": false, "score": 3, "creation_date": 1554916327, "post_id": 55617827, "comment_id": 97929217, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1839, "user_id": 3697441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gQSqt.png?s=128&g=1", "display_name": "EKW", "link": "https://stackoverflow.com/users/3697441/ekw"}, "is_accepted": false, "score": 0, "last_activity_date": 1555047465, "creation_date": 1555047465, "answer_id": 55645106, "question_id": 55617827, "link": "https://stackoverflow.com/questions/55617827/how-to-fix-c-function-giving-wrong-summation-values/55645106#55645106", "title": "How to fix C function giving wrong summation values", "body": "<p>Welcome to the <em>wonderful</em> world of <a href=\"https://en.wikipedia.org/wiki/Floating-point_arithmetic\" rel=\"nofollow noreferrer\">floating point values!</a> Consider this: between 0 and 1, there are infinitely many numbers. There's 0.1, and there's 0.01, and there's 0.001, and so on. But computers do not have infinite space, so how are we supposed to store numbers? Our solution was to limit the precision of the numbers we stored. As others have mentioned, java's float data type only has 6 or 7 digits of accuracy (in base 10). Because of this, you cannot necessarily guarantee that the result of a mathematical operation on floats will be 100% accurate. You can only be sure that the first 6-7 digits of the result will be. </p>\n"}], "owner": {"reputation": 11, "user_id": 3038208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41943156cafea485a619155111d3cb85?s=128&d=identicon&r=PG&f=1", "display_name": "deepds14", "link": "https://stackoverflow.com/users/3038208/deepds14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555047465, "creation_date": 1554915604, "last_edit_date": 1555046527, "question_id": 55617827, "link": "https://stackoverflow.com/questions/55617827/how-to-fix-c-function-giving-wrong-summation-values", "title": "How to fix C function giving wrong summation values", "body": "<p>I have made a simple addition function, but getting wrong summation values, sorry if it is a naive thing to look for. But really want to know why is this happening. I want an alternative solution for this. Thanks in advance!</p>\n\n<p>I am using notepad++ to write the code, and gcc compiler in the windows command prompt to execute the code. </p>\n\n<pre><code>\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nfloat addit(float num1, float num2)\n    {\n        float sumit;\n        sumit = num1 + num2;\n        return sumit;\n    }\n\nint main()\n{\n    float num1, num2;\n    float answer = 0.000000;\n\n    printf(\"Enter first number: \");\n    scanf(\"%f\", &amp;num1);\n    printf(\"Enter second number: \");\n    scanf(\"%f\", &amp;num2);\n\n    answer = addit(num1, num2);\n    printf(\"The summation is: %f\", answer);\n\n    return 0;\n}\n\n</code></pre>\n\n<p>The expected output of the addition of 2345.34 and 432.666 is 2778.006. \nBut, after execution it shows 2778.006104. </p>\n\n<p><a href=\"https://i.stack.imgur.com/HR5DX.png\" rel=\"nofollow noreferrer\">Windows cmd window showing execution result as 2778.006104</a></p>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 2, "creation_date": 1554915558, "post_id": 55617786, "comment_id": 97928845, "body": "Welcome to SO. This question does not specify clearly what the requirements are, and does not show any effort to solve the problem yourself. Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1554915575, "post_id": 55617786, "comment_id": 97928855, "body": "Take two maximum values and sum them?"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1554934790, "post_id": 55618740, "comment_id": 97937161, "body": "Max sum is 7+8=15. Your code seem to do something completely unrelated to the question."}, {"owner": {"reputation": 125, "user_id": 10048386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hWZe.jpg?s=128&g=1", "display_name": "coco97", "link": "https://stackoverflow.com/users/10048386/coco97"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554963714, "post_id": 55618740, "comment_id": 97943858, "body": "The sum should be of alternate indexes (with a difference of two as the question suggests) that&#39;s why 7 and 8 cannot be considered. 7 has to be added with -5 as the difference of indexes are 2 but it turns out that 7-5 = 2 is not the maximum sum."}], "tags": [], "owner": {"reputation": 125, "user_id": 10048386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hWZe.jpg?s=128&g=1", "display_name": "coco97", "link": "https://stackoverflow.com/users/10048386/coco97"}, "is_accepted": true, "score": 1, "last_activity_date": 1554919294, "creation_date": 1554919294, "answer_id": 55618740, "question_id": 55617786, "link": "https://stackoverflow.com/questions/55617786/finding-maximum-sum-possible-of-two-numbers-in-array/55618740#55618740", "title": "Finding maximum sum possible of two numbers in array", "body": "<p>As per assuming few conditions like provided array size and array data type to be integer you can use the following program for reference.\nThis program takes the no. of elements and array as input.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;limits.h&gt;\n\nint main(){\n\n    int n;\n    int a[100];\n    printf(\"Size of the array:\");\n    scanf(\"%d\", &amp;n);\n    for(int i = 0; i &lt; n; i++){\n        printf(\"Enter array element a[%d]:\", i);\n        scanf(\"%d\", &amp;a[i]);\n        printf(\"\\n\");\n    }\n\n    int max = INT_MIN;\n    int sum = 0, k = 0, l = 0;\n    for(int i = 0; i &lt; n-2; i++){\n        sum = a[i] + a[i+2];\n        if(max &lt; sum){\n            max = sum;\n            k = i;\n            l = i+2;\n        }\n    }\n    printf(\"max sum is: %d using index: a[%d] and a[%d]\\n\", max, k, l);\n}\n</code></pre>\n\n<p><em>INPUT</em></p>\n\n<p>5</p>\n\n<p>-1 7 8 -5 4</p>\n\n<p><em>OUTPUT</em></p>\n\n<p>max sum is: 12 using index: a[2] and a[4]</p>\n"}], "owner": {"reputation": 3, "user_id": 11341724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835f8d92c51fef6ac324603259270501?s=128&d=identicon&r=PG&f=1", "display_name": "Nagaveda Reddy", "link": "https://stackoverflow.com/users/11341724/nagaveda-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 55618740, "answer_count": 1, "score": -6, "last_activity_date": 1554919294, "creation_date": 1554915382, "question_id": 55617786, "link": "https://stackoverflow.com/questions/55617786/finding-maximum-sum-possible-of-two-numbers-in-array", "title": "Finding maximum sum possible of two numbers in array", "body": "<p>\"-1 7 8 -5 4  \" This is the array we have to find the maximum alternate sum possible of two integers . For example, for this array the output should be 8+4=12 as the array starts from index 0 and incrementation should be 2</p>\n"}, {"tags": ["c", "pointers", "matrix"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1554915499, "post_id": 55617770, "comment_id": 97928812, "body": "<i>one of the dimensions being different</i> Are you making the rows larger/smaller? Then <code>realloc</code> each row. This may or may not involve copying the data. Can you provide more details?"}, {"owner": {"reputation": 2531, "user_id": 1555662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7046fb9264a333e4c8ac89180f7fed20?s=128&d=identicon&r=PG", "display_name": "olivecoder", "link": "https://stackoverflow.com/users/1555662/olivecoder"}, "edited": false, "score": 0, "creation_date": 1554915651, "post_id": 55617770, "comment_id": 97928891, "body": "can either dimension be different? if the new matrix has fewer rows free the additional rows, if it has more rows allocate additional rows, if it has a different number of columns realloc all the rows as already suggested."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1554916066, "post_id": 55617770, "comment_id": 97929090, "body": "<code>matrix = malloc(rows*sizeof(double));</code> should be <code>matrix = malloc(rows*sizeof(double*));</code>. The <code>matrix</code> parameter in <code>my_function</code> should be type <code>double ***</code> if the function needs to reallocate it."}, {"owner": {"reputation": 13, "user_id": 8353544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f60483c64b9f0c4da243975f60d0f20f?s=128&d=identicon&r=PG&f=1", "display_name": "Ringo_00", "link": "https://stackoverflow.com/users/8353544/ringo-00"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554922904, "post_id": 55617770, "comment_id": 97932367, "body": "@IanAbbott I don&#39;t get the <code>double ***</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554974195, "post_id": 55617770, "comment_id": 97949296, "body": "@Ringo_00 Since it is reallocating the rows, the <code>double**</code> pointer value may change. It needs some way to pass the changed <code>double**</code> value back to the caller. One way to do that is to pass a pointer to the <code>double**</code> variable to the function, i.e. a <code>double***</code> parameter. Another way is to pass the original <code>double**</code> value to the function and make the function return the updated <code>double**</code> value."}], "owner": {"reputation": 13, "user_id": 8353544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f60483c64b9f0c4da243975f60d0f20f?s=128&d=identicon&r=PG&f=1", "display_name": "Ringo_00", "link": "https://stackoverflow.com/users/8353544/ringo-00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554922752, "creation_date": 1554915319, "last_edit_date": 1554922752, "question_id": 55617770, "link": "https://stackoverflow.com/questions/55617770/can-i-change-the-address-of-a-pointer-without-manually-copying-the-whole-matrix", "title": "Can I change the address of a pointer without manually copying the whole matrix?", "body": "<p>I have a matrix defined with pointers and in a function the matrix is passed by reference; in the function I want the matrix to be changed to some other matrix (with one of the dimension being differente) and I would like not to realloc and copy the whole matrix with a for cycle (lot of data). I would like to know how to do it, my code looks something like:</p>\n\n<pre><code>double **matrix;\nmatrix = malloc(rows*sizeof(double*));\nfor(i=0; i&lt;rows; i++){\n    matrix[i] = malloc(columns*sizeof(double));\n    }\n...\nmy_function(matrix,rows, columns);\n</code></pre>\n\n<p>with the function being:</p>\n\n<pre><code>double my_function(double **matrix, int rows, int columns){\ndouble **new_matrix\n...\nreturn new_rows /*the columns stay the same*/\n}\n</code></pre>\n\n<p>EDIT: The number of rows get smaller but all the elements in the matrix get changed; I thought of two way to make this but I don't know if any of them is feasible:</p>\n\n<p>1) Inside the function writing</p>\n\n<pre><code>matrix = new_matrix\n</code></pre>\n\n<p>Does it make it so that after the function has ended I can access new_matrix using matrix?</p>\n\n<p>2) Inside the function writing some kind of nested loop to dealloc all of the column and then rows of <code>matrix</code> and then reallocating them with the new value of <code>new_matrix</code>; although this seem doable it is also very time consuming</p>\n"}, {"tags": ["c", "string", "int"], "comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1554913655, "post_id": 55617286, "comment_id": 97927866, "body": "What is the target platform?  The use of multi-character literals is a relatively uncommon extension."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1554913682, "post_id": 55617286, "comment_id": 97927887, "body": "Just use <code>atoi()</code> or <code>strto(u)l()</code>, it will ignore leading whitespace"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554914093, "post_id": 55617286, "comment_id": 97928091, "body": "you mean <i>chr = &quot; 123&quot;</i> or <i>chr = &quot;\\t123&quot;</i> probably"}, {"owner": {"reputation": 37, "user_id": 9118722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t-C22TcEpXo/AAAAAAAAAAI/AAAAAAAAALI/Dp0DcSsrdNk/photo.jpg?sz=128", "display_name": "DT_NoHope", "link": "https://stackoverflow.com/users/9118722/dt-nohope"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1554914581, "post_id": 55617286, "comment_id": 97928349, "body": "@Ctx atoi() didn&#39;t help."}, {"owner": {"reputation": 37, "user_id": 9118722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t-C22TcEpXo/AAAAAAAAAAI/AAAAAAAAALI/Dp0DcSsrdNk/photo.jpg?sz=128", "display_name": "DT_NoHope", "link": "https://stackoverflow.com/users/9118722/dt-nohope"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554914604, "post_id": 55617286, "comment_id": 97928366, "body": "@bruno both cases."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1554914638, "post_id": 55617286, "comment_id": 97928384, "body": "@\u0110\u1ee9cTu\u1ea5nTr\u01b0\u01a1ng Too bad. Maybe it would help if you showed a minimal compilable code snippet to reproduce the issue."}, {"owner": {"reputation": 37, "user_id": 9118722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t-C22TcEpXo/AAAAAAAAAAI/AAAAAAAAALI/Dp0DcSsrdNk/photo.jpg?sz=128", "display_name": "DT_NoHope", "link": "https://stackoverflow.com/users/9118722/dt-nohope"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1554915655, "post_id": 55617286, "comment_id": 97928892, "body": "@Ctx I have edited"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1554915828, "post_id": 55617286, "comment_id": 97928977, "body": "@\u0110\u1ee9cTu\u1ea5nTr\u01b0\u01a1ng The code has several issues, but looks mostly ok. It still isn&#39;t complete, however, how is &quot;number&quot; declared? How do you observe that it is not working, since there is no output?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554916094, "post_id": 55617286, "comment_id": 97929105, "body": "Edit your question to show the contents of <i>pid.txt</i> and the output when you execute your program. Note you do not check <i>fopen</i> success"}, {"owner": {"reputation": 37, "user_id": 9118722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t-C22TcEpXo/AAAAAAAAAAI/AAAAAAAAALI/Dp0DcSsrdNk/photo.jpg?sz=128", "display_name": "DT_NoHope", "link": "https://stackoverflow.com/users/9118722/dt-nohope"}, "edited": false, "score": 0, "creation_date": 1554916173, "post_id": 55617286, "comment_id": 97929142, "body": "I have fixed it. How fool am I :))"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554916231, "post_id": 55617286, "comment_id": 97929169, "body": "@\u0110\u1ee9cTu\u1ea5nTr\u01b0\u01a1ng again <b>NEVER</b> use <i>atoi</i> !"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554917258, "post_id": 55617286, "comment_id": 97929671, "body": "@bruno Above you write &quot;use one of the atol functions or sscanf&quot;. So, how is atol better than atoi?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1554917935, "post_id": 55617286, "comment_id": 97930015, "body": "@Ctx sorry, typo, I wanted to say strtol, like in my answer ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 10048386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hWZe.jpg?s=128&g=1", "display_name": "coco97", "link": "https://stackoverflow.com/users/10048386/coco97"}, "reply_to_user": {"reputation": 37, "user_id": 9118722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t-C22TcEpXo/AAAAAAAAAAI/AAAAAAAAALI/Dp0DcSsrdNk/photo.jpg?sz=128", "display_name": "DT_NoHope", "link": "https://stackoverflow.com/users/9118722/dt-nohope"}, "edited": false, "score": 0, "creation_date": 1554915618, "post_id": 55617574, "comment_id": 97928876, "body": "is it required to store it in a character variable?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1554984208, "post_id": 55617574, "comment_id": 97955142, "body": "<code>atoi</code> is bad. Use <code>stoi</code> instead. <a href=\"https://stackoverflow.com/q/17710018/995714\">Why shouldn&#39;t I use atoi()?</a>"}], "tags": [], "owner": {"reputation": 125, "user_id": 10048386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hWZe.jpg?s=128&g=1", "display_name": "coco97", "link": "https://stackoverflow.com/users/10048386/coco97"}, "is_accepted": true, "score": 1, "last_activity_date": 1554914662, "creation_date": 1554914662, "answer_id": 55617574, "question_id": 55617286, "link": "https://stackoverflow.com/questions/55617286/convert-char-to-int-with-blank-space-in-c/55617574#55617574", "title": "Convert char to int with blank space in C", "body": "<p>you can use <code>atoi()</code> function to directly convert a string into integer.\nThe C library function:</p>\n\n<p><code>int atoi(const char *str)</code> converts the string argument str to an integer.\nThis function returns the converted integral number as an int value. If no valid conversion could be performed, it returns zero.\ngood part is that it ignores spaces.</p>\n\n<p>you might not want to store multi-character character constant in a character variable. Use character array instead example:</p>\n\n<p><code>char c[] = \" 123\";\nprintf(\"%d\\n\", atoi(c));</code></p>\n"}], "owner": {"reputation": 37, "user_id": 9118722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t-C22TcEpXo/AAAAAAAAAAI/AAAAAAAAALI/Dp0DcSsrdNk/photo.jpg?sz=128", "display_name": "DT_NoHope", "link": "https://stackoverflow.com/users/9118722/dt-nohope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "accepted_answer_id": 55617574, "answer_count": 1, "score": -5, "last_activity_date": 1555004137, "creation_date": 1554913542, "last_edit_date": 1554916061, "question_id": 55617286, "link": "https://stackoverflow.com/questions/55617286/convert-char-to-int-with-blank-space-in-c", "title": "Convert char to int with blank space in C", "body": "<p>I have a char variable such as a = ' 123' or b = '\\t123'. So how to convert them into integer? \nMy problem is read form text file contains multi lines of char like a and b. I want to convert them and save to an array.\nHere is my code:</p>\n\n<pre><code>int main(){\nFILE *file_pid;\nint i = 0;\nint number[100];\nchar line[20];\n    file_pid = fopen(\"pid.txt\",\"r\");\n    while(fgets(line, sizeof line, file_pid) != NULL){\n         number[i] = atoi(line);\n         i++;\n    } \n}\n</code></pre>\n\n<p>Edited: I solved my problem. Many thanks!</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 177, "user_id": 9499535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Horacio Goetendia", "link": "https://stackoverflow.com/users/9499535/horacio-goetendia"}, "edited": false, "score": 0, "creation_date": 1554913656, "post_id": 55617241, "comment_id": 97927869, "body": "This concept is called &quot;reflection&quot; look this <a href=\"https://stackoverflow.com/questions/1353022/reflection-support-in-c\" title=\"reflection support in c\">stackoverflow.com/questions/1353022/reflection-support-in-c</a>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1554914461, "post_id": 55617241, "comment_id": 97928274, "body": "No, this is not possible; indeed the names of the members aren&#39;t stored in the binary at all. If you describe what you want to do with this, maybe someone can come up with a suggestion for an alternative."}], "answers": [{"tags": [], "owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "is_accepted": true, "score": 0, "last_activity_date": 1554924647, "last_edit_date": 1554924647, "creation_date": 1554923830, "answer_id": 55619835, "question_id": 55617241, "link": "https://stackoverflow.com/questions/55617241/get-member-definition-name-given-member-definition-address/55619835#55619835", "title": "Get member definition name given member definition address?", "body": "<p>AFAIK C doesn't natively support reflecton.</p>\n\n<p>So if you really want it, you need to do it yourself. One way you can do it (how acceptable this solution is up to you) is via the preprocessor.</p>\n\n<h2>Using global variables</h2>\n\n<p>The main idea here is that each struct has associated 2 global constants: one specifying the number of fields of the struct (we won't need it but if you want to loop over all the fields name this can be useful) and an array representing the field name. To automatically do it, you need to sacrifice how you define a struct.</p>\n\n<p>The solution here is a little GCC dependent (we will use the <code>##</code> variant) but it should be easy to port.</p>\n\n<p>I'm also using <a href=\"https://github.com/jweyrich/p99\" rel=\"nofollow noreferrer\">P99 project</a> to help me performing the macro processing more easily.</p>\n\n<p>The starting point is how to define a struct:</p>\n\n<pre><code>//variadic a comma separated list of field type and field name\n//example: DEFINE_STRUCT(foo, char, char_1, char char_2)\n#define DEFINE_STRUCT(structName, ...) \\\n    static const int P99_PASTE(_, structName, _, fieldCount) = P99_DIV(P99_NARG(__VA_ARGS__), 2); \\\n    static const char* P99_PASTE(_, structName, _, fieldNames)[] = { _GENERATE_FIELDS_NAME(structName, __VA_ARGS__) }; \\\n    \\\n    struct structName { \\\n        _GENERATE_STRUCT_FIELDS(structName, __VA_ARGS__); \\\n    }\n\n</code></pre>\n\n<p>Basically when calling DEFINE_STRUCT we will generate the 2 global (static) constants. In the example they will be called <code>_struct_name_fieldCount</code> and <code>_struct_name_fieldNames</code>. Staticness isn't really necessary and it can be bad if you want to query the reflection outside the translation unit. </p>\n\n<p>The first constant is easily generated.\nAs for the second constant we need to loop over the pairs \"type field - type name\":</p>\n\n<pre><code>#define _METADATA_REDUCE(NAME, I, REC, RES) REC, RES\n#define _METADATA_MAP(context, length, type, value) #value\n#define _GENERATE_FIELDS_NAME(structName, ...) FOR_PAIR(, _METADATA_REDUCE, _METADATA_MAP, ## __VA_ARGS__)\n</code></pre>\n\n<p><code>FOR_PAIR</code> macro is a macro we need to define: sadly P99 allows you to loop over variadic arguments only one by one,. But we need to cycle over the variadic argument with step of 2. So we define such macro (just for example I allow up to 5 fields, but this limit can be easily update buy adding more macro definitions):</p>\n\n<pre><code>#define FOR_PAIR(CONTEXT, OP, FUNC, ...) P99_PASTE2(_BASE_FOR_PAIR_, P99_NARG(__VA_ARGS__))(CONTEXT, OP, FUNC, ## __VA_ARGS__)\n\n#define _BASE_FOR_PAIR_2(CONTEXT, OP, FUNC, value1, value2) FUNC(CONTEXT, 1, value1, value2)\n#define _BASE_FOR_PAIR_4(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 1, FUNC(CONTEXT, 2, value1, value2), _BASE_FOR_PAIR_2(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n#define _BASE_FOR_PAIR_6(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 2, FUNC(CONTEXT, 3, value1, value2), _BASE_FOR_PAIR_4(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n#define _BASE_FOR_PAIR_8(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 3, FUNC(CONTEXT, 4, value1, value2), _BASE_FOR_PAIR_6(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n#define _BASE_FOR_PAIR_10(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 4, FUNC(CONTEXT, 5, value1, value2), _BASE_FOR_PAIR_8(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n</code></pre>\n\n<p>The variadic argument of <code>_GENERATE_FIELDS_NAME</code> is, as usual, the pair \"type field -type name\". In the example it will generate \"char_1\", \"char_2\". Finally with <code>_GENERATE_STRUCT_FIELDS</code> we generate the actual body of the struct (hewre we use again <code>FOR_PAIR</code>):</p>\n\n<pre><code>#define _STRUCT_REDUCE(NAME, I, REC, RES) REC; RES\n#define _STRUCT_MAP(context, length, type, value) type value\n#define _GENERATE_STRUCT_FIELDS(structName, ...) FOR_PAIR(, _STRUCT_REDUCE, _STRUCT_MAP, ## __VA_ARGS__)\n</code></pre>\n\n<p>in the example it will generate <code>char char_1; char char_2</code>.\nFinally the macro <code>GET_FIELD_NAME</code> allows us to query the 2 static constants.\nWe simply recustruct the array constat <code>_struct_name_fieldsName</code> and access a cell value:</p>\n\n<pre><code>#define GET_FIELD_NAME(structName, id) P99_PASTE(_, structName, _, fieldNames)[id]\n</code></pre>\n\n<p>Following the complete example with a test:</p>\n\n<pre><code>#define FOR_PAIR(CONTEXT, OP, FUNC, ...) P99_PASTE2(_BASE_FOR_PAIR_, P99_NARG(__VA_ARGS__))(CONTEXT, OP, FUNC, ## __VA_ARGS__)\n\n#define _BASE_FOR_PAIR_2(CONTEXT, OP, FUNC, value1, value2) FUNC(CONTEXT, 1, value1, value2)\n#define _BASE_FOR_PAIR_4(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 1, FUNC(CONTEXT, 2, value1, value2), _BASE_FOR_PAIR_2(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n#define _BASE_FOR_PAIR_6(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 2, FUNC(CONTEXT, 3, value1, value2), _BASE_FOR_PAIR_4(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n#define _BASE_FOR_PAIR_8(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 3, FUNC(CONTEXT, 4, value1, value2), _BASE_FOR_PAIR_6(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n#define _BASE_FOR_PAIR_10(CONTEXT, OP, FUNC, value1, value2, ...) OP(CONTEXT, 4, FUNC(CONTEXT, 5, value1, value2), _BASE_FOR_PAIR_8(CONTEXT, OP, FUNC, ## __VA_ARGS__))\n\n#define _METADATA_REDUCE(NAME, I, REC, RES) REC, RES\n#define _METADATA_MAP(context, length, type, value) #value\n#define _GENERATE_FIELDS_NAME(structName, ...) FOR_PAIR(, _METADATA_REDUCE, _METADATA_MAP, ## __VA_ARGS__)\n\n#define _STRUCT_REDUCE(NAME, I, REC, RES) REC; RES\n#define _STRUCT_MAP(context, length, type, value) type value\n#define _GENERATE_STRUCT_FIELDS(structName, ...) FOR_PAIR(, _STRUCT_REDUCE, _STRUCT_MAP, ## __VA_ARGS__)\n\n#define DEFINE_STRUCT(structName, ...) \\\n    static const int P99_PASTE(_, structName, _, fieldCount) = P99_DIV(P99_NARG(__VA_ARGS__), 2); \\\n    static const char* P99_PASTE(_, structName, _, fieldNames)[] = { _GENERATE_FIELDS_NAME(structName, __VA_ARGS__) }; \\\n    \\\n    struct structName { \\\n        _GENERATE_STRUCT_FIELDS(structName, __VA_ARGS__); \\\n    }\n\n#define GET_FIELD_NAME(structName, id) P99_PASTE(_, structName, _, fieldNames)[id]\n\nDEFINE_STRUCT(struct_name, char, char_1, char, char_2);\n\nvoid main(){\n        struct struct_name struct_name;\n        const char* member_name = NULL;\n        member_name = GET_FIELD_NAME(struct_name, 1); // member_name = \"char_2\"\n        printf(\"second member name is %s\\n\", member_name);\n}\n</code></pre>\n\n<h2>Drawbacks</h2>\n\n<p>Reflection is obtained by trading data space and by polluting the global scope. This may be bad for you.\nA solution might be to generate macros instead of constants; however this has several other drawbacks, one being a stronger use of GCC extensions (in particular the definition of macros within other macros).</p>\n"}], "owner": {"reputation": 33, "user_id": 10286043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5206ea1face3aa8fcc85cef36aabfbf4?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/10286043/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 55619835, "answer_count": 1, "score": 1, "last_activity_date": 1554924647, "creation_date": 1554913362, "question_id": 55617241, "link": "https://stackoverflow.com/questions/55617241/get-member-definition-name-given-member-definition-address", "title": "Get member definition name given member definition address?", "body": "<p>Given an address to a structs member variable, is it possible to get the name of the member variable and store it in a character pointer?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstruct struct_name{\n    char char_1;\n    char char_2;\n};\nint main(){\n        struct custom_struct struct_name;\n        char *member_name = NULL;\n        member_name = getName( struct_name + 1); // member_name = \"char_2\"\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "special-characters"], "comments": [{"owner": {"reputation": 2496, "user_id": 3512524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d86f158f96941fef8bb311262cf3ad0e?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Skowronek", "link": "https://stackoverflow.com/users/3512524/krzysztof-skowronek"}, "edited": false, "score": 0, "creation_date": 1554912896, "post_id": 55617026, "comment_id": 97927489, "body": "right now your specCount counts only non-letters - the else applies only to the last if. Since this is uni assigment that&#39;s all I&#39;m gonna say :)"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1554913251, "post_id": 55617026, "comment_id": 97927654, "body": "Advice: run your own testing by reading your own file. Make it contain a very simple test case. When it works well, try another. Only when it looks ok use the final file in the assignment"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7531499, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vU67b0KGnac/AAAAAAAAAAI/AAAAAAAABNQ/2slhSUwA2rw/photo.jpg?sz=128", "display_name": "TGLIDE", "link": "https://stackoverflow.com/users/7531499/tglide"}, "reply_to_user": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "edited": false, "score": 0, "creation_date": 1554914212, "post_id": 55617115, "comment_id": 97928147, "body": "@MichaelVeksler Yes, that is true. I prefer to leave this part to be figured out though. I&#39;ll edit the answer to clarify that."}], "tags": [], "owner": {"reputation": 89, "user_id": 7531499, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vU67b0KGnac/AAAAAAAAAAI/AAAAAAAABNQ/2slhSUwA2rw/photo.jpg?sz=128", "display_name": "TGLIDE", "link": "https://stackoverflow.com/users/7531499/tglide"}, "is_accepted": false, "score": 1, "last_activity_date": 1554914281, "last_edit_date": 1554914281, "creation_date": 1554912882, "answer_id": 55617115, "question_id": 55617026, "link": "https://stackoverflow.com/questions/55617026/how-do-i-count-the-number-of-special-characters-in-a-string/55617115#55617115", "title": "How do I count the number of special characters in a string?", "body": "<p>Your else only matches the if about the numbers. Since that happens, any character that is not a number will count to your special character count.</p>\n\n<p>I suggest the following:</p>\n\n<pre><code>// Declare a pointer to fopen function to access welcome file\n        FILE *fp = fopen(\"/classes/cis158/cntwlc/welcome\", \"r\");\n        char fileName[100];\n        char ch;\n\n        int lineCount, charCount, wordCount, abcCount, numCount, speCount;\n\n\n        lineCount = 0;\n        wordCount = 0;\n        charCount = 0;\n        abcCount  = 0;\n        numCount  = 0;\n        speCount  = 0;\n\n\n        gets(fileName);\n        //fp = fopen(fileName, \"r\");\n\n\n                while((ch = getc(fp)) != EOF) {\n                        if(ch == '\\n')\n                                lineCount++;\n\n                        if(ch == ' ' || ch == '\\n')\n                                wordCount++;\n\n                        if(ch != ' ' || ch != '\\n')\n                                charCount++;\n\n                        if((ch &gt;= 'a' &amp;&amp; ch &lt;= 'z') || (ch &gt;= 'A' &amp;&amp; ch &lt;= 'Z'))\n                                abcCount++;\n\n                        else if(ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n                                ++numCount;\n                        else if(ch != ' ' &amp;&amp; ch != '\\n')\n                                speCount++;\n\n\n                ch++;\n                }\n                /*if(charCount &gt; 0) {\n                        ++lineCount;\n                        ++wordCount;\n                }*/\n\n\n        printf(\"---  Text Statistics:  ---\\n\\n\");\n        printf(\"Lines                %d\\n\", lineCount);\n        printf(\"Words                %d\\n\", wordCount);\n        printf(\"Characters           %d\\n\", charCount);\n        printf(\"Alphabetic           %d\\n\", abcCount);\n        printf(\"Digits               %d\\n\", numCount);\n        printf(\"Special              %d\\n\", speCount);\n\ngetchar();\nreturn 0;\n        //printf(\"%20s\", &amp;userInput);\n\n}// main\n</code></pre>\n\n<p>Note that your word count is fallible, but I'll leave that for you to figure out.</p>\n"}], "owner": {"reputation": 11, "user_id": 11282923, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y4CMeb_M3WU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9gNEw_kxmdLde1fLGXqAThyjuTg/mo/photo.jpg?sz=128", "display_name": "Marco ", "link": "https://stackoverflow.com/users/11282923/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554914281, "creation_date": 1554912596, "question_id": 55617026, "link": "https://stackoverflow.com/questions/55617026/how-do-i-count-the-number-of-special-characters-in-a-string", "title": "How do I count the number of special characters in a string?", "body": "<p>I'm writing a program that will count the number of lines, words, characters, digits, alphabetic letters, and special characters. So far the program is almost complete, but the special characters are giving me trouble. I used a while loop with if statements to count these characters, with the special characters in an else statement. Could somebody please point me in the right direction?</p>\n\n<p>This is the string that I'm using:</p>\n\n<p>Welcome to CIS158.\nC and Tux are working hard, are you?\nHopefully you are having fun and learning a new skill.\nThat being the case, as it should, it is time to say\n\"Have a Nice Semester!\"</p>\n\n<p>Tried an else statement that would increment the special characters.</p>\n\n<pre><code>\n        // Declare a pointer to fopen function to access welcome file\n        FILE *fp = fopen(\"/classes/cis158/cntwlc/welcome\", \"r\");\n        char fileName[100];\n        char ch;\n\n        int lineCount, charCount, wordCount, abcCount, numCount, speCount;\n\n\n        lineCount = 0;\n        wordCount = 0;\n        charCount = 0;\n        abcCount  = 0;\n        numCount  = 0;\n        speCount  = 0;\n\n\n        gets(fileName);\n        //fp = fopen(fileName, \"r\");\n\n\n                while((ch = getc(fp)) != EOF) {\n                        if(ch == '\\n')\n                                lineCount++;\n\n                        if(ch == ' ' || ch == '\\n')\n                                wordCount++;\n\n                        if(ch != ' ' || ch != '\\n')\n                                charCount++;\n\n                        if((ch &gt;= 'a' &amp;&amp; ch &lt;= 'z') || (ch &gt;= 'A' &amp;&amp; ch &lt;= 'Z'))\n                                abcCount++;\n\n                        if(ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n                                ++numCount;\n                        else\n                                speCount++;\n\n\n                ch++;\n                }\n                /*if(charCount &gt; 0) {\n                        ++lineCount;\n                        ++wordCount;\n                }*/\n\n\n        printf(\"---  Text Statistics:  ---\\n\\n\");\n        printf(\"Lines                %d\\n\", lineCount);\n        printf(\"Words                %d\\n\", wordCount);\n        printf(\"Characters           %d\\n\", charCount);\n        printf(\"Alphabetic           %d\\n\", abcCount);\n        printf(\"Digits               %d\\n\", numCount);\n        printf(\"Special              %d\\n\", speCount);\n\ngetchar();\nreturn 0;\n        //printf(\"%20s\", &amp;userInput);\n\n}// main\n</code></pre>\n\n<p>These are the expected results:</p>\n\n<p>--- Text Statistics: ---\nLines 5\nWords 37\nCharacters 188\nAlphabetic 139\nDigits 3\nSpecial 9</p>\n\n<p>This is what I get when I run the program:</p>\n\n<p>---  Text Statistics:  ---</p>\n\n<p>Lines                5\nWords                37\nCharacters           188\nAlphabetic           139\nDigits               3\nSpecial              185</p>\n"}, {"tags": ["c", "struct", "linked-list"], "comments": [{"owner": {"reputation": 1444, "user_id": 6534880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6YTr5.jpg?s=128&g=1", "display_name": "Prodigle", "link": "https://stackoverflow.com/users/6534880/prodigle"}, "edited": false, "score": 0, "creation_date": 1554913279, "post_id": 55616978, "comment_id": 97927666, "body": "int* = this is the memory address of an int int** = this is the memory address that contains a memory address of an int"}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1554915301, "post_id": 55616978, "comment_id": 97928711, "body": "as your function is shown you cannot change the first item in the list (lst) because you would need to change what the pointer points to, then you need the address of the pointer to be able to change it. Compare it with <code>foo(int* n) { *n = 1; }</code> here only what n points to, not the pointer itself"}], "answers": [{"tags": [], "owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "is_accepted": false, "score": 0, "last_activity_date": 1554912668, "creation_date": 1554912668, "answer_id": 55617054, "question_id": 55616978, "link": "https://stackoverflow.com/questions/55616978/difference-between-struct-and-struct-in-function-header/55617054#55617054", "title": "Difference between struct * and struct ** in function header", "body": "<p>The easy way to think about it is that <code>* &lt;something&gt;</code> means pointer to something and '** ` means pointer to a pointer to something.</p>\n\n<p>Since c is pass by value the only way to \"change\" a parameter is to pass a pointer to it.  </p>\n\n<p>So a function with a ** something is going to change what the pointer points to in the function.</p>\n"}, {"tags": [], "owner": {"reputation": 49169, "user_id": 13744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ed60d3cd033224d3ea343433ccf6e62?s=128&d=identicon&r=PG", "display_name": "gbjbaanb", "link": "https://stackoverflow.com/users/13744/gbjbaanb"}, "is_accepted": true, "score": 1, "last_activity_date": 1554913434, "creation_date": 1554913434, "answer_id": 55617256, "question_id": 55616978, "link": "https://stackoverflow.com/questions/55616978/difference-between-struct-and-struct-in-function-header/55617256#55617256", "title": "Difference between struct * and struct ** in function header", "body": "<ul>\n<li>struct - is a data object that occupies memory somewhere. </li>\n<li>struct* - is a pointer to that block of memory </li>\n<li>struct** - is a pointer to the pointer to that block of memory! (yep, now its confusing)</li>\n</ul>\n\n<p>If you pass a struct to a function, because every function take a copy, you cannot change the original data. So you typically pass a pointer to the struct, this means any change you make is applied to the original data. ie you don't update a by-value copy, you update the old memory struct in-place.</p>\n\n<p>However, sometimes there is no struct yet (because you want to construct one in the function for example) so there's no way of telling the caller where you put this new struct. So you have to pass a <code>**</code> to say \"I've created this struct, and its here\" and then pass that location to the caller. ie you point to the memory where the struct is created, and pass that location back via the \"pointer to\" parameter trick.</p>\n\n<p>You cannot simply pass in a pointer to the struct, because that is passed to the function by value, ie copied. so when the function exits, the old pointer value is kept. Hence pointer-to-pointer.</p>\n\n<p>Pointers are conceptually awkward, IMHO the best way to think of them is as an integer value that contains a memory location (which is what they actually are) rather than trying to understand them as some abstract concept. That can hep understand things like performance and memory copying a lot too.</p>\n"}, {"comments": [{"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 0, "creation_date": 1554921491, "post_id": 55617414, "comment_id": 97931694, "body": "This is clearly wrong -- the nodes have a property with a pointer to next this would not work, if the parameter were an array of pointers then the nodes would not need pointers to next."}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "reply_to_user": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 0, "creation_date": 1554922099, "post_id": 55617414, "comment_id": 97931993, "body": "Yea your right. I was trying to think of why the function would be passed <code>Node ** list</code> instead of just <code>Node * list</code> the only thing I could think of was an array, I didn&#39;t look closely enough of implementation that OP posted. Edited that part out."}], "tags": [], "owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "is_accepted": false, "score": 0, "last_activity_date": 1554924450, "last_edit_date": 1554924450, "creation_date": 1554914105, "answer_id": 55617414, "question_id": 55616978, "link": "https://stackoverflow.com/questions/55616978/difference-between-struct-and-struct-in-function-header/55617414#55617414", "title": "Difference between struct * and struct ** in function header", "body": "<p>When you accept an argument with a <code>*</code> you are actually accepting the address to something (this is called a pointer). If you accept a argument with <code>**</code> you are accepting a pointer to a pointer.</p>\n\n<p>So this:</p>\n\n<pre><code>void insert_in_sorted_list(Node *lst, char x)\n</code></pre>\n\n<p>Is accepting a pointer to a <code>Node</code></p>\n\n<p>and this:</p>\n\n<pre><code>void insert_in_sorted_list(Node **lst, char x)\n</code></pre>\n\n<p>is accepting a pointer to a pointer to a <code>Node</code>.</p>\n\n<p>Your implementation will work if we have a list already created and we are not adding to the front or back of the list. But consider what might happen if you need to change the first item in the list. If the user has a pointer to the first node in the list and passes it to the function and the new node needs to be inserted in front of the fist node the function could insert it properly in front of the first node but when the user looks at the list after using this function they will still have a pointer to that same <code>Node</code> (shouldn't be first anymore) and be unaware a node exists in front of it. So the user will need to pass a pointer to the pointer to the first node, that way the pointer to the first <code>Node</code> can be changed.</p>\n\n<p>Updating your code to accept a pointer to a pointer to a <code>Node</code>, now you need to access a pointer to a node with <code>*lst</code> instead of just <code>lst</code></p>\n\n<pre><code>void insert_in_sorted_list(Node ** lst, char x)\n</code></pre>\n\n<p>Another thing to consider what if the user has an empty list, nothing will get inserted. </p>\n\n<p>Consider what would happen if we get to the last node, ie <code>lst-&gt;next</code> is NULL, when we try to access <code>lst-&gt;next-&gt;value</code> we will have some sort of NULL pointer exception. Even if we didn't will this code insert another node at the end?</p>\n"}], "owner": {"reputation": 23, "user_id": 9279888, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IQjUS.jpg?s=128&g=1", "display_name": "R_L", "link": "https://stackoverflow.com/users/9279888/r-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 55617256, "answer_count": 3, "score": 1, "last_activity_date": 1554924450, "creation_date": 1554912478, "last_edit_date": 1554915110, "question_id": 55616978, "link": "https://stackoverflow.com/questions/55616978/difference-between-struct-and-struct-in-function-header", "title": "Difference between struct * and struct ** in function header", "body": "<p>I'm trying to solve my home-work in C which asks me to make a function that puts a char value in the correct place in a sorted linked list.\nactually I don't really get the difference in the function header between making it <code>struct typedef name *struct</code> and <code>struct typedef name **struct</code>.</p>\n\n<p>When I look at my teacher's solution she did that with <code>**</code>, and don't understand the meaning of that.</p>\n\n<pre><code>void insert_in_sorted_list(Node *lst, char x) {\n    Node *temp;\n    while (lst) {\n        if (x &gt; lst-&gt;value &amp;&amp; x &lt; lst-&gt;next-&gt;value) {\n            temp = (Node*)malloc(sizeof(Node));\n            temp-&gt;value = x;\n            temp-&gt;next = lst-&gt;next;\n            lst-&gt;next = temp;\n        }\n        else lst = lst-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "lock-free"], "comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 3, "creation_date": 1554912154, "post_id": 55616648, "comment_id": 97927081, "body": "Is the question only, are atomics useful without threads? The answer to that is <i>maybe</i>, since you can have shared memory even between single-threaded processes."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1554912451, "post_id": 55616648, "comment_id": 97927238, "body": "@Useless Actually 2 questions. 1. Is it possible to make such a program guaranteely lock-free? 2. Is it conforming to <code>N1570 ISO&#47;IEC 9899:201x</code> (or just okay if we take into consideration that we are using <code>pthread</code>s on <code>Linux</code>) to use <code>stdatomic</code>s with <code>pthread</code>s (or any other threading implementation)?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1554912587, "post_id": 55616648, "comment_id": 97927322, "body": "&quot;Is it conforming ....&quot;  Conforming to what? ISO/IEC 9899:2011?"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1554912764, "post_id": 55616648, "comment_id": 97927413, "body": "@4386427 Yes. I&#39;m considering <code>N1570 ISO&#47;IEC 9899:2011</code> and in fact trying to understand how to make use of <code>stdatomic</code>s with absent of <code>threads.h</code>. Does the Standard gurantee the atomic&#39;s behavior to be well-defined with all threading implementations (like <code>pthread</code>s, erlier <code>LinuxThread</code>s, etc...)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1554913671, "post_id": 55616648, "comment_id": 97927880, "body": "@SomeName This unclear to me. You say you want to know if the code is confirming to the C11 standard but the code uses pthread which is not in the standard. Also I don&#39;t see how the assembly code and some Intel specific behavior is relevant if you want to know if some C is conforming to the standard."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1554919202, "post_id": 55616648, "comment_id": 97930605, "body": "@SomeName: There&#39;s a &quot;memory hierarchy&quot; (the relationship between caches, buses/links, memory controllers, RAM chips, ...). An operation is atomic if nothing else sharing (any part of) the memory hierarchy can interfere with the operation (including devices doing DMA/bus mastering, interrupt handlers, kernel code, various CPU features that cause reads/writes, other CPUs running threads in the same or different process, ...) ."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1554919732, "post_id": 55616648, "comment_id": 97930852, "body": "@4386427 Probably the wording in the question is weird. As far as I understand what is specified in <code>5.1.2.3</code>: <i>Under a hosted implementation, a program can have more than one thread of execution (or thread) running concurrently. The execution of each thread proceeds as defined by the remainder of this standard.</i> it is not mentioned that the threads are exactly from <code>threads.h</code>, but as defined in the hosted environment. So the visibility guarantees provided by <code>stdatomic</code> should have been consistent with <code>pthreads</code> as well. Isn&#39;t such reasoning correct?"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1554919786, "post_id": 55616648, "comment_id": 97930876, "body": "@4386427 Since I wanted exact lock-free behavior I looked at assembly fragment to make sure..."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1554919920, "post_id": 55616648, "comment_id": 97930948, "body": "@Brendan So this seems <code>stdatomic</code>s can be used any time I need atomicity/memory ordering guarantees (even if <code>threads.h</code> are not implemented)..."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1554958843, "post_id": 55616648, "comment_id": 97942170, "body": "@SomeName: If the compiler/library isn&#39;t broken and wrong; <code>stdatomic</code> should ensure anything atomic is &quot;atomic from the perspective of any possible external observer&quot; (regardless of whether threads are implemented or used, and which kind of threads). Note that for threads alone you&#39;d only need &quot;atomic from the perspective of another thread&quot;, which is significantly weaker than the &quot;atomic from the perspective of any possible observer&quot; that <code>stdatomic</code> is supposed to provide."}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1554932934, "last_edit_date": 1592644375, "creation_date": 1554932934, "answer_id": 55621786, "question_id": 55616648, "link": "https://stackoverflow.com/questions/55616648/lock-free-ping-pong-in-c11/55621786#55621786", "title": "Lock-free ping-pong in C11", "body": "<p>There are 2 meanings to the term lock-free:</p>\n<ol>\n<li><p>the computer science meaning: one thread getting stuck can't impede the others.  <strong>This task is impossible to make lock-free, you <em>need</em> the threads to wait for each other</strong>.  (<a href=\"https://en.wikipedia.org/wiki/Non-blocking_algorithm\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Non-blocking_algorithm</a>)</p>\n</li>\n<li><p>using lockless atomics.  You're basically creating your own mechanism for making a thread block, waiting in a nasty spin-loop with no fallback to give up the CPU eventually.</p>\n</li>\n</ol>\n<p>The individual stdatomic load and store operations are each separately lock-free, but you're using them to create sort of a 2-thread lock.</p>\n<hr />\n<p>Your attempt looks correct to me.  I don't see a way a thread can &quot;miss&quot; an update, because the other thread won't write another one until after this one finishes.  And I don't see a way for both threads to be inside their critical sections at once.</p>\n<p>A more interesting test would be using unlocked stdio operations, like<br />\n<strong><code>fputs_unlocked(&quot;ping\\n&quot;, stdio);</code></strong> to take advantage of (and depend on) the fact that you've already guaranteed mutual exclusion between threads.  See <a href=\"http://man7.org/linux/man-pages/man3/unlocked_stdio.3.html\" rel=\"nofollow noreferrer\">unlocked_stdio(3)</a>.</p>\n<p>And test with output redirected to a file, so stdio is full buffered instead of line-buffered.  (A system call like <code>write()</code> is fully serializing anyway, like <code>atomic_thread_fence(mo_seq_cst)</code>.)</p>\n<hr />\n<blockquote>\n<p>It either lock-free or does not compile</p>\n</blockquote>\n<p>Ok, why is that weird?  You chose to do that.  It's not necessary; the algorithm would still work on C implementations without always-lock-free <code>atomic_int</code>.</p>\n<p><code>atomic_bool</code> <em>might</em> be a better choice, being lock-free on more platforms including 8-bit platforms where <code>int</code> takes 2 registers (because it has to be at least 16-bit).  Implementations are free to make <code>atomic_bool</code> a 4-byte type on platforms where that's more efficient, but IDK if any actually do.  (On some non-x86 platforms, byte loads / stores cost an extra cycle of latency to read/write in cache.  Negligible here because you're always dealing with the inter-core cache miss case.)</p>\n<p>You'd think <a href=\"https://en.cppreference.com/w/c/atomic/atomic_flag\" rel=\"nofollow noreferrer\"><code>atomic_flag</code></a> would be the right choice for this, but it only provides test-and-set, and clear, as RMW operations.  <em>Not</em> plain load or store.</p>\n<blockquote>\n<p>Such assumptions works only in case we know the hardware memory model which is not portable</p>\n</blockquote>\n<p>Yes, but this no-barriers asm code gen only happens <em>while compiling for x86</em>.  Compilers can and should apply the as-if rule to create asm that runs on the compile target <em>as if</em> the C source was running on the C abstract machine.</p>\n<hr />\n<blockquote>\n<p>Using stdatomics with pthreads</p>\n<p>Does the ISO C Standard guarantee the atomic's behavior to be well-defined with all threading implementations (like pthreads, earlier LinuxThreads, etc...)</p>\n</blockquote>\n<p>No, ISO C has nothing to say about language extensions like POSIX.</p>\n<p>It does say in a footnote (not normative) that lockless atomics <em>should</em> be address-free so they work between different processes accessing the same shared memory.  (Or maybe this footnote is only in ISO C++, I didn't go and re-check).</p>\n<p>That's the only case I can think of ISO C or C++ trying to prescribe behaviour for extensions.</p>\n<p>But the <em>POSIX</em> standard hopefully says something about stdatomic!  That's where you should look; it extends ISO C, not the other way around, so pthreads is the standard that would have to specify that its threads work like C11 <code>thread.h</code> and that atomics work.</p>\n<p><strong>In practice of course, stdatomic is 100% fine with any threading implementation where all threads share the same virtual address space.</strong>  This includes non-lock-free things like <code>_Atomic my_large_struct foo;</code>.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 55621786, "answer_count": 1, "score": 2, "last_activity_date": 1554932934, "creation_date": 1554911209, "question_id": 55616648, "link": "https://stackoverflow.com/questions/55616648/lock-free-ping-pong-in-c11", "title": "Lock-free ping-pong in C11", "body": "<p>I'm very new to concurrency in C and trying to do some basic staff to understand how it works. </p>\n\n<p>I wanted to write a conforming implementation of lock-free ping-pong, i.e. one thread prints <strong>ping</strong>, after that another thread prints <strong>pong</strong> and make it lock-free. Here is my attempt of that:</p>\n\n<pre><code>#if ATOMIC_INT_LOCK_FREE != 2\n    #error atomic int should be always lock-free\n#else\n    static _Atomic int flag;\n#endif\n\nstatic void *ping(void *ignored){\n    while(1){\n        int val = atomic_load_explicit(&amp;flag, memory_order_acquire);\n        if(val){\n            printf(\"ping\\n\");\n            atomic_store_explicit(&amp;flag, !val, memory_order_release);\n        }\n    }\n    return NULL;\n}\nstatic void *pong(void *ignored){\n    while(1){\n        int val = atomic_load_explicit(&amp;flag, memory_order_acquire);\n        if(!val){\n            printf(\"pong\\n\");\n            atomic_store_explicit(&amp;flag, !val, memory_order_release);\n        }\n    }\n    return NULL;\n}\n\nint main(int args, const char *argv[]){\n    pthread_t pthread_ping;\n    pthread_create(&amp;pthread_ping, NULL, &amp;ping, NULL);\n\n    pthread_t pthread_pong;\n    pthread_create(&amp;pthread_pong, NULL, &amp;pong, NULL);\n}\n</code></pre>\n\n<p>I tested it a few times and it worked, but there are things that seems weird:</p>\n\n<ol>\n<li><strong>It either lock-free or does not compile</strong></li>\n</ol>\n\n<p>Since the Standard defines lock-free property to be equal to 2 in order all operations on the atomic type are always lock-free. In particular I checked the compile code and it looks as</p>\n\n<pre><code>sub    $0x8,%rsp\nnopl   0x0(%rax)\nmov    0x20104e(%rip),%eax        # 0x20202c &lt;flag&gt;\ntest   %eax,%eax\nje     0xfd8 &lt;ping+8&gt;\nlea    0xd0(%rip),%rdi        # 0x10b9\ncallq  0xbc0 &lt;puts@plt&gt;\nmovl   $0x0,0x201034(%rip)        # 0x20202c &lt;flag&gt;\njmp    0xfd8 &lt;ping+8&gt;\n</code></pre>\n\n<p>This seems ok and we don't even need some sort of fence since <a href=\"https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-vol-3a-part-1-manual.pdf\" rel=\"nofollow noreferrer\">Intel CPU</a>s does not allow stores to be reordered with earlier loads. Such assumptions works only in case we know the hardware memory model which is not portable</p>\n\n<ol start=\"2\">\n<li><strong>Using stdatomics with pthreads</strong></li>\n</ol>\n\n<p>I'm stuck with glibc 2.27 where <code>threads.h</code> is not yet implemented. The question is if it is strictly-conforming to do so? Anyway this is sort of strange if we have atomics, but do not have threads. What is the conforming usage of <code>stdatomic</code>s in multithreaded application then?</p>\n"}, {"tags": ["c", "bash", "process", "operating-system"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554910654, "post_id": 55616443, "comment_id": 97926194, "body": "You can&#39;t run a <code>.c</code> file directly, you have to compile it to an executable."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1554910763, "post_id": 55616443, "comment_id": 97926249, "body": "The makefile probably created a file named &quot;ex23&quot;.  Run <i>that</i>, instead of the .c file."}, {"owner": {"reputation": 1, "user_id": 11341226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba89e67ac00253d76269138b14c3e57?s=128&d=identicon&r=PG&f=1", "display_name": "JO3YPX", "link": "https://stackoverflow.com/users/11341226/jo3ypx"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1554911062, "post_id": 55616443, "comment_id": 97926428, "body": "@zwol you&#39;re right, I&#39;ve just now run the file as you suggested and it worked normally. thanks"}, {"owner": {"reputation": 1, "user_id": 11341226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba89e67ac00253d76269138b14c3e57?s=128&d=identicon&r=PG&f=1", "display_name": "JO3YPX", "link": "https://stackoverflow.com/users/11341226/jo3ypx"}, "edited": false, "score": 0, "creation_date": 1554911239, "post_id": 55616443, "comment_id": 97926560, "body": "Oh, so I was trying to execute the c file instead of the executable. Silly me :D"}], "owner": {"reputation": 1, "user_id": 11341226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba89e67ac00253d76269138b14c3e57?s=128&d=identicon&r=PG&f=1", "display_name": "JO3YPX", "link": "https://stackoverflow.com/users/11341226/jo3ypx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1554910744, "answer_count": 0, "score": 0, "last_activity_date": 1554910552, "creation_date": 1554910552, "question_id": 55616443, "link": "https://stackoverflow.com/questions/55616443/syntax-error-near-unexpected-token-trying-to-execute-a-file-in-bash-fedora", "closed_reason": "Duplicate", "title": "&quot;Syntax error near unexpected token...&quot;, trying to execute a file in bash Fedora 10", "body": "<p>I'm currently trying to run an executable C file on a Fedora10 Virtual Machine as part of my Operating Systems coursework. However, whenever I try to execute it, it shows some errors. What seems to be the problem here?</p>\n\n<p>I've tested the same file in Linux Mint 19.1 Tessa and it runs without any problems.</p>\n\n<p>Here's the troublesome file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\nint main(int argc, char* argv[])\n{\n    pid_t pid = fork();\n\n    if (pid == 0)\n    {\n        printf(\"I am the child process.\\n\");\n        sleep(20);\n    }\n    else if (pid &gt; 0)\n    {\n        printf(\"I am the parent process.\\n\");\n        sleep(20);\n    }\n    else\n    {\n        printf(\"Fork error!\\n\");\n    }\n    return 0;\n} \n</code></pre>\n\n<p>After compiling with makefile and executing like this \"./ex23.c\":</p>\n\n<pre><code>./ex23.c: line 7: syntax error near unexpected token `('\n./ex23.c: line 7: `int main(int argc, char* argv[])'\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "pic", "uart"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1554912805, "post_id": 55615994, "comment_id": 97927440, "body": "Please add more details to your question what happens and what you would want to happen. &quot;the output being received on the other PIC seems to flash and not stable&quot; is not clear to me. Just a few thoughts without knowing the specific controller: The behavior of <code>interrupt</code> may depend on timing. What means <code>if (RCIF_bit ==1)</code>? Exactly / at least one byte available in receive buffer? Assuming <code>RCREG</code> reads last received byte. Is there a FIFO? What if there is no new data yet? Maybe in <code>interrupt</code> you should read 1 byte only and use a static counter to decide which of <code>PORTA..F</code> to send this byte."}, {"owner": {"reputation": 21, "user_id": 8785622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7q4jBsmG5ZQ/AAAAAAAAAAI/AAAAAAAAAFk/GKMptErry0s/photo.jpg?sz=128", "display_name": "ayman magdy", "link": "https://stackoverflow.com/users/8785622/ayman-magdy"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1554915682, "post_id": 55615994, "comment_id": 97928912, "body": "the whole idea is that I want to read the input from some switches, each port has five switches on it, then send this data by UART to another PIC in which it turns on the corresponding bit for the corresponding port. The program works fine when i transmit data for any three ports but when i add another port the leds on the receiver  keeps flashing and the data being transmitted is not received correctly."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1554960317, "post_id": 55615994, "comment_id": 97942649, "body": "never never never put a delay in your receive interrupt. the interrupt routine should be as short as possible."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1555056159, "post_id": 55615994, "comment_id": 97983275, "body": "@aymanmagdy You should <a href=\"https://stackoverflow.com/posts/55615994/edit\">edit</a> your question to add more information instead of answering in comments. My questions are also intended as hints what you should think about. As others already wrote in the answers your protocol needs synchronization. Your receiver implementation may read the same data more than once which will lead to data being written to the wrong port."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8785622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7q4jBsmG5ZQ/AAAAAAAAAAI/AAAAAAAAAFk/GKMptErry0s/photo.jpg?sz=128", "display_name": "ayman magdy", "link": "https://stackoverflow.com/users/8785622/ayman-magdy"}, "edited": false, "score": 0, "creation_date": 1555091011, "post_id": 55619747, "comment_id": 98002698, "body": "i would appreciate any examples that can guide me."}, {"owner": {"reputation": 21, "user_id": 11342062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa796da9a99e4748b1094d2c08bedcf5?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/11342062/dmitry"}, "reply_to_user": {"reputation": 21, "user_id": 8785622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7q4jBsmG5ZQ/AAAAAAAAAAI/AAAAAAAAAFk/GKMptErry0s/photo.jpg?sz=128", "display_name": "ayman magdy", "link": "https://stackoverflow.com/users/8785622/ayman-magdy"}, "edited": false, "score": 0, "creation_date": 1555092408, "post_id": 55619747, "comment_id": 98003251, "body": "@aymanmagdy Do you use OS or you want a bare metal solution? Does your program need to do something else besides reading and writing ports?"}, {"owner": {"reputation": 21, "user_id": 8785622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7q4jBsmG5ZQ/AAAAAAAAAAI/AAAAAAAAAFk/GKMptErry0s/photo.jpg?sz=128", "display_name": "ayman magdy", "link": "https://stackoverflow.com/users/8785622/ayman-magdy"}, "edited": false, "score": 0, "creation_date": 1555095470, "post_id": 55619747, "comment_id": 98004465, "body": "No I just want to read the value of a port send it read it on the receiver and so on for the other ports."}], "tags": [], "owner": {"reputation": 21, "user_id": 11342062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa796da9a99e4748b1094d2c08bedcf5?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/11342062/dmitry"}, "is_accepted": false, "score": 2, "last_activity_date": 1554923395, "creation_date": 1554923395, "answer_id": 55619747, "question_id": 55615994, "link": "https://stackoverflow.com/questions/55615994/how-to-send-multiple-data-of-ports-through-uart/55619747#55619747", "title": "How to send multiple data of ports through UART?", "body": "<p>First of all I want to say a few words about protocol design. Any communication protocol, if you want it to be reliable, should implement at least two things: frame synchronization and error checking. Okay, there are some specialized protocols that don't use frames and represent data as a continuous stream, but it's definitely not your case. So if you don't want to mess around with weird bugs, I highly recommend you to implement these things.</p>\n\n<p>Now about your code. It looks like <code>GET_data</code> waits for the transmit register to be empty and writes to it one byte. I don't see anything wrong with that. But your receiver looks suspicious. You wait for the <code>RCIF</code> flag to be set and then read 5 times from the input register <code>RCREG</code>. But non-zero <code>RCIF</code> means that you received <strong>one</strong> byte. You can't wait for <code>RCIF</code> once and then read from <code>RCREG</code> multiple times. You should wait for <code>RCIF</code> before <strong>every</strong> read from <code>RCREG</code>.</p>\n\n<p>I would be happy to give you an example of the working code, but I can't come up with a simple solution that will fit your current architecture.\nI can give you example how to do it in a right way, but it will look totally different.</p>\n"}, {"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1554965436, "last_edit_date": 1554965436, "creation_date": 1554962457, "answer_id": 55625655, "question_id": 55615994, "link": "https://stackoverflow.com/questions/55615994/how-to-send-multiple-data-of-ports-through-uart/55625655#55625655", "title": "How to send multiple data of ports through UART?", "body": "<p>Some things:  </p>\n\n<ul>\n<li>the UART receive ISR should be as short as possible and just write the data into a buffer and contain absolutly not any delay routines.  </li>\n<li>use one interupt for every received byte.  </li>\n<li>start your frame with a startbyte. e.g <code>'S'</code>  </li>\n<li>end your frame with a checksum byte.  </li>\n<li>do the portwrite in your mainloop after you detect a complete frame in your buffer (startbyte + databytes + correct chechsum)   </li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 8785622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7q4jBsmG5ZQ/AAAAAAAAAAI/AAAAAAAAAFk/GKMptErry0s/photo.jpg?sz=128", "display_name": "ayman magdy", "link": "https://stackoverflow.com/users/8785622/ayman-magdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556659958, "creation_date": 1554909155, "last_edit_date": 1556659958, "question_id": 55615994, "link": "https://stackoverflow.com/questions/55615994/how-to-send-multiple-data-of-ports-through-uart", "title": "How to send multiple data of ports through UART?", "body": "<p>I've changed the code for the receiver but the transmitter is pretty much the same, so in the receiver I've canceled the Interrupt and instead I read the data in a loop where I check every time for the state of the <code>RC2IF_bit</code> and the check is made by the same order the transmitter sends the data to make sure which port is sending data.\nThe problem is in simulation on proteus when I receive the data and output it on leds they work fine and the data is sent right but in the middle of the simulation when I watch it I found that they change states for a glance, for example if i send <code>PORTA = 0X2D</code>  I receive the same value and the right leds turn-on but for a second they turn-off then they turn-on again, is this a problem in the code written.</p>\n\n<pre><code> /*This is the transmitter code*/\nvoid UART2_TX_init ();      //UART2 transmission initialization function porototype\nvoid SEND_data (int output);     //Send data function prototype\n\n\nvoid main()\n{\n     ANSELA = 0X00;        //Disable analogue function on PORTA\n     ANSELE = 0X00;        //Disable analogue function on PORTE\n     ANSELF = 0X00;        //Disable analogue function on PORTF\n     TRISA = 0XFF;         // SET PORTA AS INPUT (AUTOMATIC BUTTONS)\n     TRISB = 0XFF;         //SET PORTB AS INPUT (OFF BUTTONS)\n     TRISD = 0XFF;         //SET PORTD AS INPUT (MANUAL BUTTONS)\n     TRISE = 0XFF;         //SET PORTE AS INPUT (HIGH BUTTONS)\n     TRISF = 0XFF;         //SET PORTF AS INPUT (LOW BUTTONS)\n     TRISC = 0XFF;         //SET PORTC AS INPUT (TRIP BUTTONS)\n     TRISG0_bit = 0;    //set PORTC pin0 as output for MAX487 DE pin\n     PORTG.F0= 1;      //set PORTC pin0 HIGH , set    MAX487 as transmitter.\n     UART2_TX_init();      //call UART1 transmission initialization\n\n     while (1)\n     {\n                SEND_data(PORTA);   //send data of automatic\n                delay_ms(10);\n               SEND_data(PORTB);    //send data of off\n               delay_ms(10);\n               SEND_data(PORTD);    //send daata of manual\n               delay_ms(10);\n               SEND_data(PORTE);   //send data of high\n               delay_ms(10);\n               SEND_data(PORTF);   //send data of low\n               delay_ms(10);\n               SEND_data(PORTC);   //send data of TRIP\n               delay_ms(10);\n    }\n}\n\n /*This function takes the data needed to be send\n   as an integer. Wait for the TSR to be empty and\n   start the transmission*/\n\nvoid SEND_data (int output)\n{\n         while (!TRMT_TX2STA_bit){};    //checks if TSR is empty or not if empty TRMT_BIT is set and write to transmit register\n         TX2REG = output;        //write data to be send in the transmission register\n\n}\n\n\n\n\n/*This function initializes the UART2 as an asynchronous\n transmitter at a baud rate of 9600kbps*/\n\nvoid UART2_TX_init ()\n{\n    BAUD2CON = 0X08;\n    BRGH_TX2STA_bit = 1;\n    SP2BRGL = 207;\n    SYNC_TX2STA_bit = 0X00;\n    SPEN_RC2STA_bit = 0X01;\n    TRISG1_bit = 0X01;\n    TRISG2_bit = 0X01;\n    TXEN_TX2STA_bit = 0X01;\n\n}\n\n\n\n\n/*This is the receiver code*/\nvoid UART2_RX_init ();   // Receiver initialization function prototype\nvoid main()\n{\n\n     ANSELA = 0X00;       // Disable analog function on PORTA\n     ANSELE = 0X00;       // Disable analog function on PORTE\n     ANSELF = 0X00;       // Disable analog function on PORTF\n     TRISA = 0X00;        //set PORTA as output\n     TRISB = 0X00;        //set PORTB as output\n     TRISD = 0X00;        //set PORTD as output\n     TRISE = 0X00;        //set PORTE as output\n     TRISF = 0X00;        //set PORTF as output\n     TRISC = 0X00;        //set PORTF as output\n     PORTA = 0x00;        //clear PORTA\n     PORTB = 0x00;        //clear PORTB\n     PORTD = 0x00;        //clear PORTD\n     PORTE = 0x00;        //clear PORTE\n     PORTF = 0x00;        //clear PORTF\n     PORTC = 0x00;        //clear PORTC\n     TRISG0_bit = 0x00;   //set PORTC pin0 as output for MAX487 RE pin\n     PORTG.F0 = 0x00;     // set PORTC pin0 as LOW , set MAX487 as receiver\n     UART2_RX_init();     //call receiver initialization function\n     while (1)\n     {\n             while (!RC2IF_bit) ;      //check if the RCIF flag is up to tell if there is a new data\n             PORTA =~ RC2REG;          //write the new data to the specified port\n             while (!RC2IF_bit) ;\n             PORTB =~ RC2REG;\n             while (!RC2IF_bit) ;\n             PORTD =~ RC2REG;\n             while (!RC2IF_bit) ;\n             PORTE =~ RC2REG;\n             while (!RC2IF_bit) ;\n             PORTF =~ RC2REG;\n             while (!RC2IF_bit) ;\n             PORTC =~ RC2REG;\n     }\n\n\n}\n/*This function initializes UART2 as an asynchronous\n  receiver at a baud rate of 9600kbps with continous\n  reception NO INTERRUPT ON RECEIVE*/\nvoid UART2_RX_init ()\n{\n    BAUD2CON = 0X08;\n    BRGH_TX2STA_bit = 1;\n    SP2BRGL = 207;\n    SYNC_TX2STA_bit = 0X00;\n    SPEN_RC2STA_bit = 0X01;\n    TRISG1_bit = 0X01;\n    TRISG2_bit = 0X01;\n    CREN_RC2STA_bit = 0X01;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554908616, "post_id": 55615620, "comment_id": 97925016, "body": "<code>ptrdiff_t</code> seems to always be defined as a larger type than <code>size_t</code>. Related: <a href=\"https://stackoverflow.com/questions/42574890/why-is-the-maximum-size-of-an-array-too-large\" title=\"why is the maximum size of an array too large\">stackoverflow.com/questions/42574890/&hellip;</a>"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554909141, "post_id": 55615620, "comment_id": 97925353, "body": "@Lundin, the actual type or in terms of allowed range? Id expect them to be the same size as a pointer on most platforms (e.g. 4 or 8 bytes), since <code>ptr1 - ptr2</code> is only OK if they are from the same object/allocation. The actual pointer range doesn&#39;t have to be limited, e.g. 3GB usable application memory on some 32bit systems (meaning the high bit of pointers must be used) but still 32bit <code>ptrdiff_t</code> with only 2GB range."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1554909467, "post_id": 55615620, "comment_id": 97925558, "body": "@Lundin I can&#39;t agree with that.  On my not-so-exotic 64-bit Linux system, they&#39;re both 64 bits."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1554910937, "post_id": 55615620, "comment_id": 97926357, "body": "Per C 2018 6.3.2.3 5, the result of <code>(T *) -1</code> is implementation-defined. So the question of whether it can be used as a sentinel in the first place, before even being concerned about the compiler recognizing it could not be the starting address of a <code>T</code>, is dependent on the implementation."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554910977, "post_id": 55615620, "comment_id": 97926382, "body": "Who says there&#39;s an &quot;underlying integer value&quot; at all?  There <i>might</i> be (and typically is) something that could be matched to that description in any given implementation, but C certainly doesn&#39;t promise it."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1554911646, "post_id": 55615620, "comment_id": 97926789, "body": "Well, being used only for equality, what the value is, doesn&#39;t matter, as long as it is given some unique value? Not clear on the unique part from the wording, I understand <code>(T*)(uintptr_t)(T*)p</code> should round-trip, so the implementation can&#39;t for example make every integer into a null pointer. Is &quot;implementation defined...might a...might b...&quot; limited to what is listed? Can be the accepted answer. Personally I was happier with using the address of say a global or better yet an output parameter but only reviewing this code."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554920071, "post_id": 55618708, "comment_id": 97931039, "body": "Given the wording of 6.5.9/6, I don&#39;t think it&#39;s safe to assume <code>( T * ) -1 == ( T * ) -1</code>  Since <code>( T * ) -1</code> is likely not a null pointer constant, the compiler could well assume under 6.5.9/6 that a comparison to that literal value is always false.  (Agreed, though, that POSIX seems to mandate &quot;proper&quot; behavior here.)   So a test such as <code>if ( ptr == ( T * ) -1 )...</code> could very well be optimized away."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1554923224, "post_id": 55618708, "comment_id": 97932512, "body": "I agree in principle, @AndrewHenle, and indeed this answer already speaks to that issue.  I guess you&#39;re saying you have less confidence than I do about the comparison working as intended in practice, which is fair.  Ultimately, I think the take home is &quot;don&#39;t do that&quot;, and I&#39;ll twek my wording a bit to emphasize that."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1554975234, "post_id": 55618708, "comment_id": 97949921, "body": "@JohnBollinger Thanks for the indepth explanation of the standard. The POSIX note is interesting, as that extends to a lot of platforms. I generally agree with &quot;use null pointers as sentinels instead&quot;, surprised that <code>shmat</code> seems not to. In this case it was in addition to in order to cram more data in the return, <code>if (null) else if (-1) else if (-2) else success</code> style rather than doing say <code>int create(obj_t **out)</code> or <code>errno</code> or such which I see far more commonly."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 5, "last_activity_date": 1554984410, "last_edit_date": 1554984410, "creation_date": 1554919144, "answer_id": 55618708, "question_id": 55615620, "link": "https://stackoverflow.com/questions/55615620/is-using-sentinel-pointer-values-near-the-maximum-underlying-integer-value-safe/55618708#55618708", "title": "Is using sentinel pointer values near the maximum underlying integer value safe?", "body": "<p><strong>TL;DR</strong>: <code>(T*)-1</code> will likely work as intended in practice, but for safety, portability, and future-proofing, you should use null pointers as sentinels instead.</p>\n\n<blockquote>\n  <p>I was going through some code, that in addition to null pointers is using some special values like <code>(T*)-1</code>, generally as return values if some \"create\" function fails.</p>\n</blockquote>\n\n<p>In fact, some POSIX interfaces, such as <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/shmat.html\" rel=\"nofollow noreferrer\"><code>shmat()</code></a>, behave similarly, returning <code>(void *)-1</code> to indicate an error.  For them, this is the equivalent of many other standard functions returning the <code>int</code> value -1.  It is a value that is intended never to be a valid return value for a successful call.  That must therefore work on every POSIX-conforming implementation, and I think other POSIX requirements have the combined effect of requiring the same to hold for pointer types other than <code>void *</code>, too.</p>\n\n<p>More generally, C explicitly permits integers to be converted to pointers without restriction, but with the caveat that</p>\n\n<blockquote>\n  <p>Except [for null pointer constants], the result is implementation-defined,\n  might not be correctly aligned, might not point to an entity of the\n  referenced type, and might be a trap representation.</p>\n</blockquote>\n\n<p>(C2011, <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p5\" rel=\"nofollow noreferrer\">6.3.2.3/5</a>). The main concerns with such a conversion, then, are</p>\n\n<ul>\n<li>that the result of <code>(T*)-1</code> is a trap representation, in which case the scheme you describe produces undefined behavior.</li>\n<li>that the result of <code>(T*)-1</code> could be a valid pointer to a <code>T</code>, in which case using it as a sentinel is unsafe.</li>\n</ul>\n\n<p>To the best of my knowledge, the first of those is not an issue for any C implementation you're likely to meet.  I think the second is unlikely to be an issue for you in practice, either, but if you are targeting non-POSIX systems then I am less confident about that one.</p>\n\n<p>You go on to ask,</p>\n\n<blockquote>\n  <p>Where the type being pointed to is a type large enough such that\n  ((T*)-n) + sizeof(T) will overflow, meaning that address could never\n  actually be allocated for an instance of type T, is this OK? Could a\n  compiler see something like if (ptr == (T*)-1), decide that is\n  impossible and optimise it out?</p>\n</blockquote>\n\n<p>This is an interesting question.  Supposing that <code>(T*)-1</code> does not produce a trap representation, this provision applies:</p>\n\n<blockquote>\n  <p>Two pointers compare equal <strong>if and only if</strong> both are null pointers, both\n  are pointers to the same object (including a pointer to an object and\n  a subobject at its beginning) or function, both are pointers to one\n  past the last element of the same array object, or one is a pointer to\n  one past the end of one array object and the other is a pointer to the\n  start of a different array object that happens to immediately follow\n  the first array object in the address space.</p>\n</blockquote>\n\n<p>(C2011, <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.9p6\" rel=\"nofollow noreferrer\">6.5.9/6</a>)</p>\n\n<p>Unfortunately, however, this is a bit of a mess.</p>\n\n<p>Although the standard places constraints on the <em>types</em> of pointer operands of an <code>==</code> expression, it does not require their values to be valid pointers.  Lest there be any doubt about this, it is required for internal consistency with the provisions of section <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3\" rel=\"nofollow noreferrer\">6.3.2.3</a>, which specify results of equality comparisons involving null pointers (not limited to null pointer constants).</p>\n\n<p>If at least one of the operands of <code>x == y</code> is an invalid pointer other than a null pointer, such as, we may presume, <code>(T *)-1</code>, then none of the alternatives given by 6.5.9/6 holds, so the expression should evaluate to 0.  A compiler might use that to justify optimizing out the test and branch.</p>\n\n<p>In practice, however, implementations often fail to conform in this regard.  Instead, they take their cue from historic behavior, perhaps justifying themselves by the fleeting reference to the address space in 6.5.9/6, or maybe taking a liberal view of what an object is.  For implementations that afford a flat view of the address space, this manifests as <code>==</code> being evaluated in terms of whether the addresses to which the pointer values correspond are the same, regardless of those addresses' relationships to any object.  An implementation such as that <em>must not</em> optimize out the <code>==</code> test, because it cannot safely assume that it will always fail.</p>\n\n<p>The bottom line, then, is that although the compiler is <em>unlikely</em> to optimize away the test, you cannot rely on the standard for assurance that it will not do so.  You are on safer ground if you use null pointers as your sentinels, for notwithstanding the inconsistency I called out, in practice, null pointers of the same type <em>do</em> compare equal in all implementations, pursuant to 6.3.2.3/4.</p>\n"}], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 55618708, "answer_count": 1, "score": 5, "last_activity_date": 1554984410, "creation_date": 1554908028, "question_id": 55615620, "link": "https://stackoverflow.com/questions/55615620/is-using-sentinel-pointer-values-near-the-maximum-underlying-integer-value-safe", "title": "Is using sentinel pointer values near the maximum underlying integer value safe?", "body": "<p>I was going through some code, that in addition to null pointers is using some special values like <code>(T*)-1</code>, generally as return values if some \"create\" function fails.</p>\n\n<p>Where the type being pointed to is a type large enough such that <code>((T*)-n) + sizeof(T)</code> will overflow, meaning that address could never actually be allocated for an instance of type T, is this OK? Could a compiler see something like <code>if (ptr == (T*)-1)</code>, decide that is impossible and optimise it out?</p>\n"}, {"tags": ["c", "loops", "while-loop", "openssl", "sha"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554911200, "post_id": 55615607, "comment_id": 97926527, "body": "There are too many definitions hidden, difficult ( or impossible ?) to analyze / check.  A comment says <i>SEARCH FOR NEW FILES WITHIN DIRECTORY</i> but the code <b>never</b> update/set <i>hashInBuf</i> or <i>hashOutBuf</i> so you always open the <i>same</i> files, where is the magic allowing them to refer to the right files ?  From the comment <i>OPEN FILES</i> nothing depends on the event, how can you manage something associated to the event ?"}, {"owner": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554911309, "post_id": 55615607, "comment_id": 97926605, "body": "@bruno well I&#39;ve added everything else - the reason for initially not including it is that it&#39;s perhaps too much for someone to go over. The problem is I can&#39;t localize the issue"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554912144, "post_id": 55615607, "comment_id": 97927077, "body": "your edit confirms my remark, please look at my answer"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "edited": false, "score": 0, "creation_date": 1554912140, "post_id": 55616732, "comment_id": 97927073, "body": "I&#39;ve just updated my code - I very stupidly missed out the snprintf just above where the file opens. My apologies."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "edited": false, "score": 0, "creation_date": 1554912231, "post_id": 55616732, "comment_id": 97927122, "body": "@JosephSmith warning with <i>snprintf</i> if may not put the final null character"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "edited": false, "score": 0, "creation_date": 1554912399, "post_id": 55616732, "comment_id": 97927211, "body": "@JosephSmith so probably you have only the choice to delete your question or to accept my answer to mark the question solved ;-)"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1554912116, "last_edit_date": 1554912116, "creation_date": 1554911560, "answer_id": 55616732, "question_id": 55615607, "link": "https://stackoverflow.com/questions/55615607/hash-function-returning-different-result-after-deleting-replacing-file/55616732#55616732", "title": "Hash function returning different result after deleting &amp; replacing file", "body": "<p>You never set <em>hashInBuf</em> nor <em>hashOutBuf</em> so there contents is undefined and when you do </p>\n\n<blockquote>\n<pre><code>               FILE *ftest=fopen(hashInBuf, \"rb\");    //ORIGINAL FILE\n               FILE *ftest2=fopen(hashOutBuf, \"wt\");  //HASH FILE (stored in separate directory)\n</code></pre>\n</blockquote>\n\n<p>you try to open files whose names was never set, and unfortunately you do not check the open failed, so </p>\n\n<blockquote>\n<pre><code>while ((bytes = fread (data, 1, 1024, ftest)) != 0)\n</code></pre>\n</blockquote>\n\n<p>reads nothing and because <em>ftest</em> values NULL, <code>SHA512_Update (&amp;mdContext, data, bytes);</code> is never called etc</p>\n\n<p>Several variables are never used :</p>\n\n<ul>\n<li>file512</li>\n<li>hashDirectory</li>\n<li>directory</li>\n<li>wd</li>\n<li>argc</li>\n<li>argv</li>\n</ul>\n"}], "owner": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554912116, "creation_date": 1554907979, "last_edit_date": 1554912100, "question_id": 55615607, "link": "https://stackoverflow.com/questions/55615607/hash-function-returning-different-result-after-deleting-replacing-file", "title": "Hash function returning different result after deleting &amp; replacing file", "body": "<p>My issue is that when I have the program running, and delete a file in said directory, when it (the same file) is placed back it returns a different value. I wondered whether this code below is the issue?</p>\n\n<pre><code>int main (int argc, char *argv[])\n{\n        int fd;\n        int wd;\n        unsigned char c[SHA512_DIGEST_LENGTH];\n        int i;\n        SHA512_CTX mdContext;\n        int bytes;\n        unsigned char data[1024];\n        const int event_size = sizeof(struct inotify_event);\n        const int buf_len = 1024 * (event_size + FILENAME_MAX);\n        char *directory = \"/home/joe/Documents/\";\n        char *hashDirectory = \"/home/joe/Documents/_Hash/\";\n        char hashInBuf[500];\n        char hashOutBuf[500];\n        fd = inotify_init();\n\n        if (fd &lt; 0) {\n          perror(\"inotify_init\");\n        }\n\n        wd = inotify_add_watch(fd, \"/home/joe/Documents\", IN_CREATE);\n\n        while (1) {\n          char buff[buf_len];\n          int no_of_events, count = 0;\n          //SEARCH FOR NEW FILES WITHIN DIRECTORY\n          no_of_events = read (fd, buff, buf_len);\n          while (count &lt; no_of_events) {\n            struct inotify_event *event = (struct inotify_event *)&amp;buff[count];\n            if (event-&gt;len) {\n              if ((event-&gt;mask &amp; IN_CREATE))\n              if(!(event-&gt;mask &amp; IN_ISDIR)) {\n                    snprintf(hashInBuf, sizeof(hashInBuf), \"%s/%s\", directory, event-&gt;name);\n                    snprintf(hashOutBuf, sizeof(hashOutBuf), \"%s/%s.txt\", hashDirectory, event-&gt;name);\n                    //OPEN FILES\n                    FILE *ftest=fopen(hashInBuf, \"rb\");    //ORIGINAL FILE\n                    FILE *ftest2=fopen(hashOutBuf, \"wt\");  //HASH FILE (stored in separate directory)\n                    //HASH FUNCTION\n                    SHA512_Init (&amp;mdContext);\n                    while ((bytes = fread (data, 1, 1024, ftest)) != 0)\n                        SHA512_Update (&amp;mdContext, data, bytes);\n                    SHA512_Final (c,&amp;mdContext);\n                    for(i = 0; i &lt; SHA512_DIGEST_LENGTH; i++){\n                      fprintf(ftest2, \"%02x\", c[i]);\n                      printf(\"%02x\", c[i]);\n                    }\n                    fclose (ftest);\n                    fclose (ftest2);\n                    fflush (stdout);\n                  }}\n                  count += event_size + event-&gt;len;\n                 }}\n                 return 0;\n         } //CLOSES INT MAIN\n</code></pre>\n\n<p>I can assure you the variables are defined correctly as for all intensive purposes it does work, just not correctly... </p>\n"}, {"tags": ["c", "posix"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1554907811, "post_id": 55615357, "comment_id": 97924495, "body": "It\u2019s not \u201csince it was called\u201d; the wait system calls report on any unwanted for child process, including those that finished before it was called."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1554909478, "post_id": 55615357, "comment_id": 97925565, "body": "I suggest to use <code>waitpid</code> because this will give you more information about the process that has changed its state. But don&#39;t do this in a signal handler. A signal handler should not do more than write variables of type <code>volatile sig_atomic_t</code>. In your signal handler you can set a flag to indicate that a child has changed state, and in your main processing check this flag, and if it is set, reset it and call <code>waitpid</code> in a loop with <code>WNOHANG</code> until it returns 0  and process all childs as necessary."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1555013251, "post_id": 55639730, "comment_id": 97971437, "body": "<i>Also, <code>SIGCHLD</code> is only ever sent when there is something that can be reaped so it doesn&#39;t really matter if you use <code>WNOHANG</code> or not.</i>  Not quite true.  Multiple <code>SIGCHLD</code> signals that arrive can be coalesced into a single signal.  Per <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_01\" rel=\"nofollow noreferrer\">POSIX  2.4.1 Signal Generation and Delivery</a>: &quot;If a subsequent occurrence of a pending signal is generated, it is implementation-defined as to whether the signal is delivered or accepted more than once in circumstances other than those in which queuing is required.&quot;"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1555013366, "post_id": 55639730, "comment_id": 97971484, "body": "(cont) So it is possible for a single <code>SIGCHLD</code> signal to represent multiple child processes needing to be reaped.  In order to ensure all children are reaped, a portable application will repeatedly call <code>waitpid()</code> with the <code>WNOHANG</code> flag set until it fails to return a reaped child process."}], "tags": [], "owner": {"reputation": 294, "user_id": 9664285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SjXnP.jpg?s=128&g=1", "display_name": "Zack Jorquera", "link": "https://stackoverflow.com/users/9664285/zack-jorquera"}, "is_accepted": false, "score": 0, "last_activity_date": 1555016082, "last_edit_date": 1555016082, "creation_date": 1555010388, "answer_id": 55639730, "question_id": 55615357, "link": "https://stackoverflow.com/questions/55615357/how-do-i-get-the-pid-of-a-set-process-in-the-handler-of-its-own-sigchld/55639730#55639730", "title": "How do I get the PID of a set process in the handler of its own SIGCHLD?", "body": "<p>While it is not a good idea to use wait in a signal handler, you can do the following to accomplish what you are trying to do.</p>\n\n<pre><code>void handler(int sig){\n    int child_pid;\n    int status;\n\n    child_pid = waitpid(-1, &amp;status, WUNTRACED | WNOHANG);\n    if(child_pid &gt; 0)\n    {\n        // your code\n        // make sure to deal with the cases of child_pid &lt; 0 and child_pid == 0\n    }\n\n}\n\n</code></pre>\n\n<p>What you are doing is not technically wrong, however, it would be better to use <code>waitpid</code>. When you use <code>waitpid(-1,...)</code> it works similarly to if you used <code>wait(...)</code> and will not only wait for a specified process but any process that terminates. The main difference is that you can specify <code>WUNTRACED</code> which will suspend execution until a process in the wait set becomes either terminated or stopped. The <code>WNOHANG</code> will tell <code>waitpid</code> to not suspend the execution of the process. You don't want your handler to be suspended.</p>\n\n<p>If multiple signals are sent to the same process i.e. due to multiple children terminating at the same time, then it will seem like only one signal was sent because the signal handler will not be executed again. This is due to how signals are sent; when a signal is created it is put into an exception table for the process to then \"receive\" it; signals do not use queues. To account for this, you will need to iterate over the <code>waitpid(-1,...)</code> call until it returns 0 to make sure you are reaping all of the terminated children.</p>\n\n<p>Additionally, do watch out for where else you are reaping the child (note that if the child has already been reaped then <code>waitpid</code> will return 0 if you use the <code>WNOHANG</code> flag). I would assume that this is what is causing the behavior you are seeing of the status only updating when another background process ends. For example, because you are making a toy shell I assume that you are waiting for the foreground processes somewhere, and if you use the wait function there as well as in your handler you could get 1 of two things to happen. The child gets reaped in the 'wait for foreground process' method and then when the handler is executed there is nothing for it to reap. And 2, the child gets reaped in the handler method, and then the 'wait for foreground process' never exits.</p>\n"}], "owner": {"reputation": 33, "user_id": 9156516, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4KsEB1MP7yQ/AAAAAAAAAAI/AAAAAAAAAZw/AkutbDykRA0/photo.jpg?sz=128", "display_name": "Oscar Nydza", "link": "https://stackoverflow.com/users/9156516/oscar-nydza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555016082, "creation_date": 1554907270, "question_id": 55615357, "link": "https://stackoverflow.com/questions/55615357/how-do-i-get-the-pid-of-a-set-process-in-the-handler-of-its-own-sigchld", "title": "How do I get the PID of a set process in the handler of its own SIGCHLD?", "body": "<p>I'm writting a toy shell for university and I have to update the status of a background process when it ends. So I came up with the idea of making the handler of <code>SIGCHLD</code> do that, since that signal is sent when the process ends. The problem is that in order to implement the command <code>jobs</code>, I have to update the status from \"running\" to \"terminated\" and first I have to find that specific process in the array I have dedicated to it, and one way to do it is by searching by pid, since the array stores the information that is display in <code>jobs</code>. Each entry stores the process pid, the status (which is a string) and the command itself.</p>\n\n<p>Now the question is:\nIs there a way to get the pid of the process that called the signal when it ended?</p>\n\n<p>Right now this is what my handler function looks like:</p>\n\n<pre><code>void handler(int sig){\n    int child_pid;\n    child_pid = wait(NULL);\n    //finds the process with a pid identical \n    //to child_pid in the list and updates its status\n    ...\n}\n</code></pre>\n\n<p>Since <code>wait(NULL)</code> returns the pid of the first process that ends since it's called, the status is only updated when another background process ends and therefore the wrong process status is updated.</p>\n\n<p>We haven't been tought many things from the <code>wait()</code> and <code>waitpid()</code>functions apart from that they waits for a process to end, so any insight may be helpful.</p>\n"}, {"tags": ["c", "curl", "libcurl"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1554911152, "post_id": 55615347, "comment_id": 97926494, "body": "What happens when you do curl from the command line?"}, {"owner": {"reputation": 3, "user_id": 6701922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40351b6b8046241b13b199b4ed531477?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Towkhir", "link": "https://stackoverflow.com/users/6701922/syed-towkhir"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1554921103, "post_id": 55615347, "comment_id": 97931513, "body": "Similar, I can get the complete output once but when I repeat it gets stuck and I will have to kill the session."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1554924301, "post_id": 55615347, "comment_id": 97932947, "body": "Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1554927122, "post_id": 55615347, "comment_id": 97934204, "body": "Sounds like the header is not returning the correct size."}, {"owner": {"reputation": 3, "user_id": 6701922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40351b6b8046241b13b199b4ed531477?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Towkhir", "link": "https://stackoverflow.com/users/6701922/syed-towkhir"}, "edited": false, "score": 0, "creation_date": 1554987807, "post_id": 55615347, "comment_id": 97957429, "body": "Headers are fine. I have updated with the received response and requests"}], "owner": {"reputation": 3, "user_id": 6701922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40351b6b8046241b13b199b4ed531477?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Towkhir", "link": "https://stackoverflow.com/users/6701922/syed-towkhir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554987960, "creation_date": 1554907249, "last_edit_date": 1554987960, "question_id": 55615347, "link": "https://stackoverflow.com/questions/55615347/operation-timed-out-after-10000-milliseconds-with-11584-out-of-1526223-bytes-rec", "title": "Operation timed out after 10000 milliseconds with 11584 out of 1526223 bytes received", "body": "<p>I am trying to get about 1.4 to 2 MB of JSON data from a server using the curl library in C.</p>\n\n<p>I have increased the Buffer size, connection timeout</p>\n\n<pre><code>curl_easy_setopt(conn-&gt;easy, CURLOPT_CONNECTTIMEOUT, 10);\ncurl_easy_setopt(conn-&gt;easy, CURLOPT_BUFFERSIZE, 524288);\n\n\n#ifdef CURL_MAX_WRITE_SIZE\n    #undef CURL_MAX_WRITE_SIZE\n    #define CURL_MAX_WRITE_SIZE 524288\n #endif\n</code></pre>\n\n<p>I did take a capture on the client I am running and the packets are not received completely.</p>\n\n<p>I also tried the url from a browser and the browser is able to get the data and display.</p>\n\n<p>Any help on this is appreciated. </p>\n\n<p>Thanks</p>\n\n<p>So basically my code is based on the example <a href=\"https://curl.haxx.se/libcurl/c/crawler.html\" rel=\"nofollow noreferrer\">https://curl.haxx.se/libcurl/c/crawler.html</a></p>\n\n<p>The difference here is that the timer_cb is called frequently and the easy_handle is released only if there is something to read.</p>\n\n<pre><code>static void timer_cb(int fd, short kind, void * userp)\n{\n    GlobalInfo * g = (GlobalInfo *)userp;\n    CURLMcode rc;\n    (void)fd;\n    (void)kind;\n\n    rc = curl_multi_socket_action(g-&gt;multi,\n                                  CURL_SOCKET_TIMEOUT, 0, &amp;g-&gt;still_running);\n    mcode_or_die(\"timer_cb: curl_multi_socket_action\", rc);\n    check_multi_info(g);\n}\n</code></pre>\n\n<p>I read the response here in this api and new_conn_init will create/malloc a new easy handle and call the curl_multi_add_handle.</p>\n\n<pre><code>static void check_multi_info(GlobalInfo * g)\n{\n    char * eff_url;\n    CURLMsg * msg;\n    int msgs_left;\n    ConnInfo * conn = NULL;\n    CURL * easy;\n.....\n    while ((msg = curl_multi_info_read(g-&gt;multi, &amp;msgs_left)))\n    {\n        if (msg-&gt;msg == CURLMSG_DONE)\n        {\n            easy = msg-&gt;easy_handle;\n            res = msg-&gt;data.result;\n            do\n            {\n                rc = ERROR;\n                conn = NULL;\n                contentType = NULL;\n                iValidContent = 1;\n    ..........\n\n            }\n            while (0);\n\n            u8 ret = 0;\n\n            curl_multi_remove_handle(g-&gt;multi, easy);\n            curl_easy_cleanup(easy);\n\n            if (conn)\n               new_conn_init(&amp;(conn-&gt;reqInfo), g, 1);\n\n    }\n\n    new_conn_init ()\n    {\n    conn-&gt;easy = curl_easy_init();\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_URL, conn-&gt;url);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_BUFFERSIZE, 524288);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_WRITEFUNCTION, write_cb);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_WRITEDATA, &amp;(conn-&gt;respData));\n    //  curl_easy_setopt(conn-&gt;easy, CURLOPT_HEADERDATA, &amp;(conn-&gt;headerData));\n    //  curl_easy_setopt(conn-&gt;easy, CURLOPT_VERBOSE, 1L);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_VERBOSE, (long)shmHttpClientConfig-&gt;debugLibCurl);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_FORBID_REUSE, 1L);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_ERRORBUFFER, conn-&gt;error);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_PRIVATE, conn);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_DNS_CACHE_TIMEOUT, -1);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_NOPROGRESS, 1);\n    curl_easy_setopt(conn-&gt;easy, CURLOPT_CONNECTTIMEOUT, 10);\n    rc = curl_multi_add_handle(g-&gt;multi, conn-&gt;easy);\n}\n</code></pre>\n\n<p>I did some debugging and looks like the connections are getting closed quite late in if you can see the op of the curl debug. I am sending url queries every 20 seconds.</p>\n\n<pre><code>* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#1)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:37:53 GMT\n&lt; \n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#2)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:38:13 GMT\n&lt; \n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#3)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:38:33 GMT\n&lt; \n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#4)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n* Operation timed out after 10000 milliseconds with 160728 out of 1526223 bytes received\n* Closing connection 1\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:38:53 GMT\n&lt; \n* Closing connection 4\n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Operation timed out after 10001 milliseconds with 11584 out of 1526223 bytes received\n* Closing connection 2\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#5)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:39:13 GMT\n&lt; \n* Closing connection 5\n* Operation timed out after 10001 milliseconds with 845632 out of 1526223 bytes received\n* Closing connection 3\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#6)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:43:33 GMT\n&lt; \n* Found bundle for host 12.0.0.25: 0x9f31f0\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#7)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; C\n[root@BENU TEMP/MEG-1] ~# cat /opt/benu-data/admin/benu_libcurl_op.txt | more\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#1)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:37:53 GMT\n&lt; \n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#2)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:38:13 GMT\n&lt; \n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#3)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:38:33 GMT\n&lt; \n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#4)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n\n* Operation timed out after 10000 milliseconds with 160728 out of 1526223 bytes received\n* Closing connection 1\n&lt; HTTP/1.1 200 OK\n&lt; Connection: Keep-Alive\n&lt; Content-Length: 1526223\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Date: Thu, 11 Apr 2019 11:38:53 GMT\n&lt; \n* Closing connection 4\n* Found bundle for host 12.0.0.25: 0x9f8d20\n* Hostname 12.0.0.25 was found in DNS cache\n*   Trying 12.0.0.25...\n* Hostname 12.0.0.29 was found in DNS cache\n* Name '12.0.0.29' family 2 resolved to '12.0.0.29' family 2\n* Local port: 0\n* Operation timed out after 10001 milliseconds with 11584 out of 1526223 bytes received\n* Closing connection 2\n* Connected to 12.0.0.25 (12.0.0.25) port 1234 (#5)\n&gt; GET /xxxx HTTP/1.1\nHost: 12.0.0.25:1234\nAccept: */*\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 5, "creation_date": 1554907434, "post_id": 55615310, "comment_id": 97924281, "body": "<code>weight[n]</code> is not defined"}, {"owner": {"reputation": 909, "user_id": 6949583, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207259784601151/picture?type=large", "display_name": "Federico Galfione", "link": "https://stackoverflow.com/users/6949583/federico-galfione"}, "reply_to_user": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1554907896, "post_id": 55615310, "comment_id": 97924554, "body": "@&#212;rel Oh yeah sure... I need more coffee. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 909, "user_id": 6949583, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207259784601151/picture?type=large", "display_name": "Federico Galfione", "link": "https://stackoverflow.com/users/6949583/federico-galfione"}, "edited": false, "score": 0, "creation_date": 1554908299, "post_id": 55615628, "comment_id": 97924822, "body": "Yeah that was the problem, it was right in front of me, I\u2019m so stupid! @Orel showed me the error in the comment section"}], "tags": [], "owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "is_accepted": true, "score": 2, "last_activity_date": 1554908050, "creation_date": 1554908050, "answer_id": 55615628, "question_id": 55615310, "link": "https://stackoverflow.com/questions/55615310/unexpected-result-from-knapsack-problem-recursive-function/55615628#55615628", "title": "Unexpected result from Knapsack problem recursive function", "body": "<p>It looks like you are indexing the arrays with an number that is too large.\nYou get the size of the array doing</p>\n\n<pre><code>n = (sizeof(weight))/(sizeof(weight[0]));\n</code></pre>\n\n<p>You cannot index weight at <code>n</code> because it only has indices <code>0</code> to <code>n-1</code></p>\n\n<p>Try calling </p>\n\n<pre><code>result = knapsack(prices, weight, n-1, max_weight);\n</code></pre>\n"}], "owner": {"reputation": 909, "user_id": 6949583, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207259784601151/picture?type=large", "display_name": "Federico Galfione", "link": "https://stackoverflow.com/users/6949583/federico-galfione"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 55615628, "answer_count": 1, "score": 0, "last_activity_date": 1554908050, "creation_date": 1554907162, "question_id": 55615310, "link": "https://stackoverflow.com/questions/55615310/unexpected-result-from-knapsack-problem-recursive-function", "title": "Unexpected result from Knapsack problem recursive function", "body": "<p>I have to write a simple program to solve the Knapsack problem.\nI wrote this code for now and I think this is all I need, but I keep having different results everytime I execute it. All I can think is that there is a problem of memory deallocation, but I don't know how to solve it. Any ideas?</p>\n\n<p>P.S. Maybe it's a stupid question but I never worked in C.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint max(int a, int b){\n  if(a &gt; b) {\n    return a;\n  } else {\n    return b;\n  }\n}\n\nint knapsack(int prices[], int weight[], int n, int max_weight){\n  if(n &lt; 0)\n    return 0;\n  if (weight[n] &gt; max_weight)\n    return knapsack(prices, weight, n-1, max_weight);\n  else\n    return max(knapsack(prices, weight, n-1, max_weight), (knapsack(prices, weight, n-1, max_weight - weight[n]) + prices[n]));\n}\n\nint main(int argc, char const *argv[]) {\n  int i, weight[] = {2,3,3,4}, prices[] = {1,5,2,9}, max_weight = 7, n, result;\n  for (i=0; i&lt;argc; i++) {\n    printf(\"%d: \\\"%s\\\"\\n\", i, argv[i]);\n  }\n  n = (sizeof(weight))/(sizeof(weight[0]));\n  result = knapsack(prices, weight, n, max_weight);\n  printf(\"%d\\n\", result);\n  return 0;\n}\n</code></pre>\n\n<p><strong>RESULTS</strong>\n<a href=\"https://i.stack.imgur.com/XSn2Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XSn2Y.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "function", "language-lawyer", "ellipsis"], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1554907790, "post_id": 55615486, "comment_id": 97924483, "body": "<i>This paragraph discusses the case where a function call expression mentions a function for which no prototype has been seen</i> Could you please expand on this? they mentioned that <i><b>If the function is defined with a type that includes a prototype</b>, and either the prototype ends with an ellipsis (, ...)</i>. Can you suggest an example of UB specified at <code>6.5.2.2(p6)</code>?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 2, "creation_date": 1554907930, "post_id": 55615486, "comment_id": 97924579, "body": "It&#39;s defined <i>somewhere</i>, but not where its prototype can be seen by this particular call expression. For example, in a different source file. For historical reasons, C allows calling functions out of the blue, without ever seeing its declaration. So you can write <code>int main() { return f(1, 2); }</code>, and the compiler crosses its figurative fingers and hopes that somewhere maybe there&#39;s a definition of <code>int f(int, int)</code>. If instead you define, in a different source file, <code>int f(double, double)</code> or <code>int f(int, ...)</code>, the behavior of that call is undefined."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1554908161, "post_id": 55615486, "comment_id": 97924730, "body": "So the function is declared without prototype and the declaration is seen (the quote: <i>If  the  expression  that  denotes  the  called  function  has  a  type  that  does  not  include a prototype</i>). But the definition is not in the scope and is provided at link time. Is that what they were trying to say?"}, {"owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1554909053, "post_id": 55615486, "comment_id": 97925296, "body": "@SomeName The historical reasons also allow you to declare a function without prototypes too, e.g. <code>int f();</code> in a header file will match both the expected <code>int f(int, int)</code> and the actual <code>int f(double, double)</code> definitions."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1610062279, "post_id": 55615486, "comment_id": 116021469, "body": "&quot;This paragraph discusses the case where a function call expression mentions a function for which no prototype has been seen&quot; is good, yet the paragraph also applies to the case  where the function is prototyped with a <code>...</code>"}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 5, "last_activity_date": 1554907597, "creation_date": 1554907597, "answer_id": 55615486, "question_id": 55615219, "link": "https://stackoverflow.com/questions/55615219/function-definition-with-an-ellipsis/55615486#55615486", "title": "Function definition with an ellipsis", "body": "<p>This paragraph discusses the case where a function call expression mentions a function for which no prototype has been seen. In this case, the compiler has to guess at the types of its parameters, based on types of arguments of the call.</p>\n\n<p>If that function is defined (possibly in a different translation unit) as variadic, or with parameter types that don't match the compiler's guess, the behavior is undefined.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 55615486, "answer_count": 1, "score": 2, "last_activity_date": 1554907597, "creation_date": 1554906923, "question_id": 55615219, "link": "https://stackoverflow.com/questions/55615219/function-definition-with-an-ellipsis", "title": "Function definition with an ellipsis", "body": "<p>I have misunderstanding about the semantic of functions with variable number of arguments. <code>6.5.2.2(p6)</code>:</p>\n\n<blockquote>\n  <p>If the function is defined with a type that includes a prototype,\n  and either  the  prototype  ends  with  an  ellipsis  (, ...)  or  the \n  types  of  the  arguments  after promotion are not compatible with the\n  types of the parameters, the behavior is undefined.</p>\n</blockquote>\n\n<p>This is not really clear. Does in the function definition below the prototype end with an ellipsis?</p>\n\n<pre><code>void foo(int i, ...){\n    //...\n}\n</code></pre>\n\n<p>At first I thought that it was about the function the parameter list contains the ellipsis only, like</p>\n\n<pre><code>void foo(...){\n    //...\n}\n</code></pre>\n\n<p>but this case is described by <code>6.9.1(p8)</code>:</p>\n\n<blockquote>\n  <p>If a function that accepts a variable number of arguments is defined\n  without a parameter type list that ends with the ellipsis notation, the\n  behavior is undefined</p>\n</blockquote>\n\n<p>So I don't really understand what did they mean by </p>\n\n<blockquote>\n  <p>either the prototype ends with an ellipsis (, ...)</p>\n</blockquote>\n\n<p>at <code>6.5.2.2(p6)</code></p>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 1174, "user_id": 1703619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WOjOF.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1703619/miguel"}, "edited": false, "score": 0, "creation_date": 1554907265, "post_id": 55615186, "comment_id": 97924192, "body": "We aware that exists more than one way to represent a negative number in binary, not only 0xFFFFFFFF  <a href=\"https://en.wikipedia.org/wiki/Signed_number_representations\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Signed_number_representations</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1554911238, "post_id": 55615186, "comment_id": 97926556, "body": "note that XOR doesn&#39;t produce more bits than the operands, so it can never overflow (except probably on systems with trap representation) <a href=\"https://stackoverflow.com/q/28320454/995714\">Can XOR of two integers go out of bounds?</a>. INT_MIT is well within <code>int</code>&#39;s range, therefore it&#39;s not an overflow"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1554934473, "post_id": 55615186, "comment_id": 97937036, "body": "The first <code>a &amp; b</code> is <code>1</code> as you say, but you are in a <code>while</code> loop that updates the values of <code>a</code> and <code>b</code>, the bug comes on a later iteration"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1554956475, "post_id": 55615186, "comment_id": 97941609, "body": "for bit-twiddling one uses <i>unsigned types</i> in C."}], "answers": [{"comments": [{"owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "edited": false, "score": 0, "creation_date": 1554954936, "post_id": 55622000, "comment_id": 97941310, "body": "Thanks a lot! In this case, when a = -1 and b = 1, how shall we handle the left shift? Essentially, the getSum() function is calculating a + b with bit manipulation."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "reply_to_user": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "edited": false, "score": 1, "creation_date": 1555009609, "post_id": 55622000, "comment_id": 97969900, "body": "cast to unsigned."}, {"owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "edited": false, "score": 0, "creation_date": 1555084038, "post_id": 55622000, "comment_id": 97999322, "body": "Thanks, could you please explain a bit more details?"}], "tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": true, "score": 9, "last_activity_date": 1554934226, "creation_date": 1554934226, "answer_id": 55622000, "question_id": 55615186, "link": "https://stackoverflow.com/questions/55615186/c-left-shift-overflow-for-negative-numbers/55622000#55622000", "title": "C++ left shift overflow for negative numbers", "body": "<p>Assuming this is C or C++, your error is because a <a href=\"https://stackoverflow.com/q/3784996/10396\">Left Shifting a negative value is Undefined Behavior</a>, and left shifting a signed value such that it becomes bigger than MAX_INT is also Undefined Behavior.</p>\n\n<p>If you inspect the values of <code>a</code> and <code>b</code> as you run through this sequence, you will get:</p>\n\n<pre><code>-1 1\n-2 2\n-4 4\n...\n-1073741824 1073741824\n</code></pre>\n\n<p>At this point <code>a&amp;b == 1073741824</code>.  But shifting it left by 1 is the same as multiplying by 2, which would give <code>2147483648</code>, which is larger than INT_MAX.</p>\n\n<p>That's Undefined Behavior. The system can choose to do anything. It appears that in your case, it did the bitshift giving <code>0x80000000</code>. In a signed <code>int</code>, this represents INT_MIN.  So the next time through the loop, you are trying to left shift a negative number, which again is Undefined Behavior. Your system chose to treat this as an exception.</p>\n\n<p>In general, if you are doing bit-manipulations, you are best using unsigned types.</p>\n"}], "owner": {"reputation": 709, "user_id": 5405823, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5H9hi.jpg?s=128&g=1", "display_name": "thinkdeep", "link": "https://stackoverflow.com/users/5405823/thinkdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1360, "favorite_count": 3, "accepted_answer_id": 55622000, "answer_count": 1, "score": 3, "last_activity_date": 1560995241, "creation_date": 1554906816, "last_edit_date": 1560995241, "question_id": 55615186, "link": "https://stackoverflow.com/questions/55615186/c-left-shift-overflow-for-negative-numbers", "title": "C++ left shift overflow for negative numbers", "body": "<p>As shown below, the code has a bug. When input a = -1, b = 1, one of the line has runtime error. Could you please help me understand how (a &amp; b) becomes INT_MIN?</p>\n\n<p>In my understanding, -1 is represented as 32-bit binary format 0xFFFFFFFF, and 1 is represented as 32-bit format 0x00000001, thus (-1 &amp; 1) will become 0x00000001. And my python command also shows '0b1' as result. Why does it report the error of INT_MIN?</p>\n\n<pre><code>int getSum(int a, int b) {\n    while (b != 0) {\n        int carry = (a &amp; b) &lt;&lt; 1;//BUG! left shift of negative value -2147483648\n        a = a ^ b;\n        b = carry;\n    }\n\n    return a;\n}\n</code></pre>\n\n<p>Update: Is right shift for negative numbers well-defined? It seems ok to right shift negative numbers as long as it satisfies the requirements as quoted below.</p>\n\n<p>From cppreference.com, </p>\n\n<blockquote>\n  <p>For unsigned a and for signed a with nonnegative values, the value of\n  a >> b is the integer part of a/2b . For negative a, the value of a >>\n  b is implementation-defined (in most implementations, this performs\n  arithmetic right shift, so that the result remains negative).</p>\n  \n  <p>In any case, if the value of the right operand is negative or is\n  greater or equal to the number of bits in the promoted left operand,\n  the behavior is undefined.</p>\n</blockquote>\n"}, {"tags": ["c", "boolean", "conditional"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1554906136, "post_id": 55614911, "comment_id": 97923498, "body": "You&#39;ll have to expand the context, because code in general will only run once unless you do something to make it run again like putting it in a loop."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 7, "creation_date": 1554906209, "post_id": 55614911, "comment_id": 97923530, "body": "Looks perfectly readable and concise to me. In C++ you could do some tricks with functors, but in plain C anything shorter is going to make it cryptic IMO."}, {"owner": {"reputation": 706, "user_id": 6761184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89aba8d550e80edfe0c721440d4c5a98?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Visentin", "link": "https://stackoverflow.com/users/6761184/davide-visentin"}, "edited": false, "score": 0, "creation_date": 1554906259, "post_id": 55614911, "comment_id": 97923559, "body": "<code>if(!bool_var++)</code>. But your version is more readable."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 706, "user_id": 6761184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89aba8d550e80edfe0c721440d4c5a98?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Visentin", "link": "https://stackoverflow.com/users/6761184/davide-visentin"}, "edited": false, "score": 2, "creation_date": 1554906317, "post_id": 55614911, "comment_id": 97923593, "body": "@DavideVisentin - So only don&#39;t enter this block again for 255 iterations?"}, {"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "reply_to_user": {"reputation": 706, "user_id": 6761184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89aba8d550e80edfe0c721440d4c5a98?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Visentin", "link": "https://stackoverflow.com/users/6761184/davide-visentin"}, "edited": false, "score": 1, "creation_date": 1554906330, "post_id": 55614911, "comment_id": 97923598, "body": "@DavideVisentin I&#39;d been thinking along that line, but eventually it will wrap, especially on ATMEGAs with <code>uin8_t</code>s."}, {"owner": {"reputation": 706, "user_id": 6761184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89aba8d550e80edfe0c721440d4c5a98?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Visentin", "link": "https://stackoverflow.com/users/6761184/davide-visentin"}, "edited": false, "score": 0, "creation_date": 1554906417, "post_id": 55614911, "comment_id": 97923638, "body": "Yes I was thinking to it before the question was edited. You are all right."}, {"owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "edited": false, "score": 1, "creation_date": 1554906490, "post_id": 55614911, "comment_id": 97923691, "body": "if you exclude macros for hiding code I think that is the best way. If you have <code>for(int i=0; i&lt;...; ++i)</code> you could remove the boolean variable and replace it with <code>if (i==0)</code> but other than that..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 706, "user_id": 6761184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89aba8d550e80edfe0c721440d4c5a98?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Visentin", "link": "https://stackoverflow.com/users/6761184/davide-visentin"}, "edited": false, "score": 1, "creation_date": 1554906632, "post_id": 55614911, "comment_id": 97923781, "body": "Although... If <code>bool_var</code> was <code>_Bool</code> instead, I think @DavideVisentin&#39;s suggestion would work like a charm, since the result will always be clamped to <code>[0, 1]</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554906792, "post_id": 55614911, "comment_id": 97923873, "body": "You can write something cryptic and ugly like <code>static bool execute_once=true; ... execute_once &amp;&amp; (do_something(), (execute_once=false));</code>. I wouldn&#39;t call that better than your present code though, and the machine code generated is probably about the same."}, {"owner": {"reputation": 706, "user_id": 6761184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89aba8d550e80edfe0c721440d4c5a98?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Visentin", "link": "https://stackoverflow.com/users/6761184/davide-visentin"}, "edited": false, "score": 0, "creation_date": 1554906987, "post_id": 55614911, "comment_id": 97923996, "body": "What about <code>if(!(bool_var &amp;&amp; bool_var|=1))</code>?"}, {"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1554907095, "post_id": 55614911, "comment_id": 97924083, "body": "@StoryTeller I&#39;d forgotten about <code>_Bool</code>.  If you write your comment as an answer, I&#39;ll accept it."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1554907283, "post_id": 55614911, "comment_id": 97924200, "body": "you can do <code>if (!bool_var &amp;&amp; bool_var = 1) {</code> too, but that&#39;s confusing :)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1554907343, "post_id": 55614911, "comment_id": 97924233, "body": "<code>#define once static int done_##__LINE__ = 0; while (!done_##__LINE__ &amp;&amp; ++done_##__LINE__)</code> Usage: <code>once { do_something(); }</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1554908212, "post_id": 55614911, "comment_id": 97924761, "body": "@n.m. Just to be mean: <code>once { do_something(); } once { do_something(); } &#47;&#47; end of line</code>  :)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554908845, "post_id": 55614911, "comment_id": 97925167, "body": "@Lundin Hmm, can that be overcome with the use of the <code>#line</code> preprocessor directive?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554910215, "post_id": 55614911, "comment_id": 97925973, "body": "@Lundin of course you can break it in many different ways."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1554908097, "creation_date": 1554908097, "answer_id": 55615648, "question_id": 55614911, "link": "https://stackoverflow.com/questions/55614911/a-more-consise-way-of-executing-code-once-only-in-c/55615648#55615648", "title": "A more consise way of executing code once only in C?", "body": "<p>Your code is about as readable and simple as it can get for the majority of cases.</p>\n\n<hr>\n\n<p>For very specific purposes however, you could find yourself in a situation where you want to always call a function but sometimes without an effect. Then it could perhaps make sense to use some trick with function pointers:</p>\n\n<pre><code>typedef void func_t (void);\n...\nfunc_t* do_stuff = do_something;\n... \n\nwhile(stuff) // this code can't be changed for whatever reason\n{\n  do_stuff();\n}\n</code></pre>\n\n<p>In such a scenario you can come up with this:</p>\n\n<pre><code>void nop (void) {}\n...\ndo_stuff = nop;\n</code></pre>\n\n<p>Now you can keep calling <code>do_stuff</code> but nothing will happen.</p>\n"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1554908097, "creation_date": 1554906061, "last_edit_date": 1554906230, "question_id": 55614911, "link": "https://stackoverflow.com/questions/55614911/a-more-consise-way-of-executing-code-once-only-in-c", "title": "A more consise way of executing code once only in C?", "body": "<p>I often have code of the form:</p>\n\n<pre><code>uint8_t bool_var = 0;\n\nfor (;;) {\n    ...\n    if (!bool_var) {\n       do_something();\n       bool_var = 1;\n    }\n    ...\n}\n</code></pre>\n\n<p>Is there a more concise, non-macro, way of expressing the if condition and block?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1554905216, "post_id": 55614569, "comment_id": 97922953, "body": "<code>&quot;size of x %x\\n&quot;,&amp;w</code> - Except it&#39;s not printing a size since <code>&amp;w</code> isn&#39;t the size of anything."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1554905248, "post_id": 55614569, "comment_id": 97922973, "body": "This can&#39;t output anything since it <a href=\"http://coliru.stacked-crooked.com/a/8a08280c82e6953d\" rel=\"nofollow noreferrer\">doesn&#39;t compile</a>."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1554905273, "post_id": 55614569, "comment_id": 97922985, "body": "This code does not make any sense at all in relation to the text it prints."}, {"owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "edited": false, "score": 0, "creation_date": 1554905303, "post_id": 55614569, "comment_id": 97923000, "body": "Ya should have edited it, posted the code as it was given"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1554905362, "post_id": 55614569, "comment_id": 97923032, "body": "<code>char w = &quot;5&quot;;</code> will generate a warning and will most likely not do what you think it does."}, {"owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "edited": false, "score": 0, "creation_date": 1554905420, "post_id": 55614569, "comment_id": 97923063, "body": "I am aware that is what should happen (not compile), but as it seems VS at least compile it Now I noticed I put VSCode.. my bad, meant VS not code"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1554905540, "post_id": 55614569, "comment_id": 97923123, "body": "The code you posted compiles as it should. But it does generate a warning."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1554905572, "post_id": 55614569, "comment_id": 97923147, "body": "The output text doesn&#39;t seem to have any relation to the values being printed. For example, the last two <code>printf</code>s in each group obviously print the same number, but have different text."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1554905590, "post_id": 55614569, "comment_id": 97923163, "body": "When a program is nonsense, there&#39;s not much point in trying to make sense of what it does."}, {"owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "edited": false, "score": 0, "creation_date": 1554905615, "post_id": 55614569, "comment_id": 97923172, "body": "Correct correction it indeed gives warning, but not on putting a string into a char, but in the printf"}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 2, "creation_date": 1554905643, "post_id": 55614569, "comment_id": 97923189, "body": "Why would you make your output so convoluted? You print &quot;size of X&quot; to show the value of <code>w</code>. Why are you making it so hard? Who are you trying to confuse?"}, {"owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1554905735, "post_id": 55614569, "comment_id": 97923242, "body": "@ChristianGibbons maybe, but it dose make me wonder, tested it on more then one computers to see and the results seem to stick, I was told on an older compiler it will not compile (VS as well) Also that the retuslt remain the same makes me wonder if its really just random or there is a meaning behind it, even if its useless, its intresting to know"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1554905742, "post_id": 55614569, "comment_id": 97923249, "body": "Anyway, no offence but there is little point in explaining why this code behaves the way it does. You should find a tutorial about strings in C and read it."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1554905769, "post_id": 55614569, "comment_id": 97923274, "body": "<code>char w = &quot;5&quot;;</code> defines a string literal <code>&quot;5&quot;</code> and assigns its address (where the character <code>&#39;5&#39;</code> is located) to variable <code>char w</code>, truncating the pointer value to a <code>char</code>. The output value <code>0x30</code> (hex) or <code>48</code> (decimal) probably means that the lowest byte of the string literal&#39;s address has this value."}, {"owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1554905812, "post_id": 55614569, "comment_id": 97923308, "body": "@JonathanWood Its code sent to me, keepet it to the orignal given code, the names I assume where done for testing reasons on the code without bothering to make changes to the printed info"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1554905836, "post_id": 55614569, "comment_id": 97923321, "body": "@Bodo I&#39;m not sure that it&#39;s even true that the value of the pointer truncates.  If <code>char</code> is a signed type, then it should overflow which, I believe, results in undefined behavior."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554906088, "post_id": 55614569, "comment_id": 97923472, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/52186834/pointer-from-integer-integer-from-pointer-without-a-cast-issues\">\u201cPointer from integer/integer from pointer without a cast\u201d issues</a>."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1554906121, "post_id": 55614569, "comment_id": 97923489, "body": "@ChristianGibbons Undefined behaviour doesn&#39;t mean that it doesn&#39;t truncate. It can do anything at all, including wrap around."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1554906301, "post_id": 55614569, "comment_id": 97923585, "body": "@Arkku It wasn&#39;t my intention that it cannot result in wrapping, but rather that it is not reliable to expect truncation (unless you know you are running on a system where <code>char</code> is unsigned).  As such, trying to make sense of it is nonsensical."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "edited": false, "score": 0, "creation_date": 1554907780, "post_id": 55615214, "comment_id": 97924474, "body": "Thanks for the answer guess its really just truncated then"}], "tags": [], "owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "is_accepted": true, "score": 4, "last_activity_date": 1554906915, "creation_date": 1554906915, "answer_id": 55615214, "question_id": 55614569, "link": "https://stackoverflow.com/questions/55614569/what-happens-in-the-use-of-vs-in-c/55615214#55615214", "title": "What happens in the use of &#39; vs &quot; in C?", "body": "<p>A string is an array of characters ending in a NUL character. The data here:</p>\n\n<pre><code>\"5\"\n</code></pre>\n\n<p>This is the same as:</p>\n\n<pre><code>{'5','\\0'}\n</code></pre>\n\n<p>When you assign the value of an array to something in C you are assigning a pointer to the first element in the array. So when you write:</p>\n\n<pre><code>char w = \"5\"\n</code></pre>\n\n<p>you are creating a character and assigning the value of it to the memory location of the first element in the array of characters, a character is not large enough to store a memory location.</p>\n\n<p>Doing this:</p>\n\n<pre><code>printf(\"size of x %x\\n\",&amp;w);\n</code></pre>\n\n<p>Is printing out the location of w in memory</p>\n\n<p>Doing this:</p>\n\n<pre><code>printf(\"size of X %X\\n\", w);\n</code></pre>\n\n<p>is printing the value of w, in your case was assigned to the address of the string array, and truncated because char cannot fit an address.</p>\n\n<p>If you want to use a string you should do this:</p>\n\n<pre><code>const char * w = \"5\"\n</code></pre>\n\n<p>Then you can print out the string like this:</p>\n\n<pre><code>printf(\"string: %s\\r\\n\", w);\n</code></pre>\n\n<p>you can print out the first character in the array one of these ways</p>\n\n<pre><code>printf(\"char: %c\\r\\n\", *w);\nprintf(\"char: %c\\r\\n\", w[0]);\n</code></pre>\n\n<p>For the second bit when you assign w like this:</p>\n\n<pre><code>char w = '5';\n</code></pre>\n\n<p>printing <code>&amp;w</code> prints the location in memory.</p>\n\n<p>printing <code>w</code> with <code>%x</code> prints the ASCII value of <code>'5'</code> which is 0x35</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "edited": false, "score": 0, "creation_date": 1554907754, "post_id": 55615435, "comment_id": 97924462, "body": "Doing <code>printf(&quot;size of X %hhX\\n&quot;, w);</code> and <code>printf(&quot;size of X %X\\n&quot;, (unsigned int)w);</code> give the same result as before Thanks for the answer"}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 0, "last_activity_date": 1554909003, "last_edit_date": 1554909003, "creation_date": 1554907462, "answer_id": 55615435, "question_id": 55614569, "link": "https://stackoverflow.com/questions/55614569/what-happens-in-the-use-of-vs-in-c/55615435#55615435", "title": "What happens in the use of &#39; vs &quot; in C?", "body": "<p>The initialization</p>\n\n<pre><code>char w = \"5\";\n</code></pre>\n\n<p>does two things:</p>\n\n<ul>\n<li>Define a character literal <code>\"5\"</code> which is some memory area that contains a <code>'5'</code> followed by a <code>NUL</code> (<code>'\\0'</code>).</li>\n<li>Define a variable <code>w</code> of type <code>char</code> and initialize it with the address of the string literal, i.e. the memory address where the <code>'5'</code> is located. The address (pointer) is converted to <code>char</code> which will lose parts of the value because <code>char</code> is normally smaller than a pointer (<code>char*</code>).</li>\n</ul>\n\n<p>With</p>\n\n<pre><code>printf(\"size of X %X\\n\", w);\n</code></pre>\n\n<p>you print the value of <code>char w</code> in hexadecimal form, which probably is the least significant byte of the string literal's address.</p>\n\n<p>You should better use</p>\n\n<pre><code>printf(\"size of X %X\\n\", (unsigned int)w); /* %X = unsigned int */\n</code></pre>\n\n<p>or</p>\n\n<pre><code>printf(\"size of X %hhX\\n\", w); /* %hhX = unsigned char or signed char */\n</code></pre>\n\n<p>to make the format match the argument type.</p>\n\n<p>Even if this does not change the result in your case, this will make sure that the code of <code>printf</code> doesn't access memory which <strong>might be</strong> uninitialized or might contain unrelated data. </p>\n\n<p>When I ran your code, in one case the value of <code>w</code> was <code>0xA8</code> which got printed as <code>FFFFFFA8</code>. In this case <code>%hhX</code> would print only <code>A8</code>.</p>\n\n<p>I'm not sure what exactly will happen when you pass a <code>char</code> value to function <code>printf</code> while the format instructs the function to interpret the data as <code>unsigned int</code>. This may depend on your platform's calling conventions and the compiler implementation. Maybe on your platform all arguments of shorter data types get converted to <code>int</code> or <code>unsigned int</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 5413533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fdd77cb76a78d892c94ad9fbfc58c4?s=128&d=identicon&r=PG", "display_name": "Black Blade", "link": "https://stackoverflow.com/users/5413533/black-blade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 55615214, "answer_count": 2, "score": -2, "last_activity_date": 1554909003, "creation_date": 1554905061, "last_edit_date": 1554905536, "question_id": 55614569, "link": "https://stackoverflow.com/questions/55614569/what-happens-in-the-use-of-vs-in-c", "title": "What happens in the use of &#39; vs &quot; in C?", "body": "<p>Someone raised this code to me, that raised me to wonder what is going on there\nthe code is as follow from VS 2019:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char y = '5';\n    char w = \"5\";\n    printf(\"size of x %x\\n\",&amp;w);\n    printf(\"size of X %X\\n\", w);\n    printf(\"size of X in number: %d \\n\", w);\n    printf(\"size of Y %d\\n\\n\", w);\n\n    w = '5';\n    printf(\"size of y %x\\n\", &amp;w);\n    printf(\"size of Y %X\\n\", w);\n    printf(\"size of X in number: %d \\n\", w);\n    printf(\"size of Y %d\\n\\n\", w);\n\n    return 0;\n}\n</code></pre>\n\n<p>The output is as follow:</p>\n\n<pre><code>size of x 8ff8bb\nsize of X 30\nsize of X in number: 48\nsize of Y 48\n\nsize of y 8ff8bb\nsize of Y 35\nsize of X in number: 53\nsize of Y 53\n</code></pre>\n\n<p>What I wonder is what is really going on there? someone pointed out that ' is a char and \" is a string, but if that is the case why can one put a string into a char here, and why is that the results?</p>\n\n<p>Thanks for the answers\nI do understand this may not be really too relevant to use, but I wonder on what is going on there, I have just recently returned to relearn C</p>\n\n<p>The code is compiled and gives no warnings in VS2019</p>\n\n<p>Google search mostly give me results for how to put chars into an array and the like, was unable to find any info on this behavior</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1554904597, "post_id": 55614341, "comment_id": 97922559, "body": "What&#39;s <code>doubleme</code>? What&#39;s <code>swap</code>? Why are you passing a <code>char</code> to <code>printf</code> for <code>%s</code>? My guess is that the latter is causing the problem, use <code>%c</code> to print a <code>char</code>."}, {"owner": {"reputation": 21, "user_id": 11041378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x-jpEOixNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOhx2IORxH3bHUEC-hM_UH3_If-Ow/mo/photo.jpg?sz=128", "display_name": "Christian Heaven", "link": "https://stackoverflow.com/users/11041378/christian-heaven"}, "edited": false, "score": 0, "creation_date": 1554904743, "post_id": 55614341, "comment_id": 97922654, "body": "doubleme and swap are other functions that had to be used for this assignment they&#39;re working fine I could post them if you&#39;d like to see those as well. So far in class we&#39;ve only been shown how to read in a string using scanf. If there is a better way I&#39;m open to learning. I&#39;m printing the statement because I was testing the same word pancake to see if I can get the desired results. I believe the array is being passed correctly because I get &#39;a&#39; when printing theString[4]."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1554904823, "post_id": 55614341, "comment_id": 97922712, "body": "@ChristianHeaven Don&#39;t assume the problem isn&#39;t at certain places. It&#39;s not uncommon that the problem is in the code that is not posted."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1554904986, "post_id": 55614341, "comment_id": 97922813, "body": "You should always turn on compiler warnings. It should give you some diagnosticts about mismatch of format specifiers ans provided parameters."}, {"owner": {"reputation": 2272, "user_id": 5562045, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/rWILr.png?s=128&g=1", "display_name": "rustyMagnet", "link": "https://stackoverflow.com/users/5562045/rustymagnet"}, "edited": false, "score": 1, "creation_date": 1554905135, "post_id": 55614341, "comment_id": 97922908, "body": "You should definitely be using an IDE with compiler warnings switched ON. That would have stopped your code crashing.  I would have found it useful if you included all the code <code>doubleme()</code>, <code>swap()</code>, so I could run it through a debugger."}, {"owner": {"reputation": 21, "user_id": 11041378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x-jpEOixNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOhx2IORxH3bHUEC-hM_UH3_If-Ow/mo/photo.jpg?sz=128", "display_name": "Christian Heaven", "link": "https://stackoverflow.com/users/11041378/christian-heaven"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1554905362, "post_id": 55614341, "comment_id": 97923033, "body": "Thanks @Blaze that&#39;s what was wrong the entire time. I spent three hours looking at this code and didn&#39;t even think to look at the print statement back in main."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1554905543, "post_id": 55614341, "comment_id": 97923126, "body": "Running your program in a debugger should reveal the location of the crash within seconds. Using a debugger is a step that you should include in your process to solve bugs."}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 4, "last_activity_date": 1554904643, "creation_date": 1554904643, "answer_id": 55614426, "question_id": 55614341, "link": "https://stackoverflow.com/questions/55614341/why-do-i-keep-getting-a-segmentation-dump/55614426#55614426", "title": "Why do I keep getting a segmentation dump?", "body": "<p>You are cheating your compiler.\nYou claim to provide the address of a string but instead you pass a single character for <code>%s</code> format specifier.</p>\n\n<pre><code>  char beginning, ending;\n\n  printf(\"%s is the first character and %s is the last.\\n\", beginning, ending);\n</code></pre>\n\n<p>This will treat the value of that character as an address and try to read from there.\nThis is undefined behaviour</p>\n"}], "owner": {"reputation": 21, "user_id": 11041378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x-jpEOixNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOhx2IORxH3bHUEC-hM_UH3_If-Ow/mo/photo.jpg?sz=128", "display_name": "Christian Heaven", "link": "https://stackoverflow.com/users/11041378/christian-heaven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55614426, "answer_count": 1, "score": 0, "last_activity_date": 1554905065, "creation_date": 1554904370, "last_edit_date": 1554905065, "question_id": 55614341, "link": "https://stackoverflow.com/questions/55614341/why-do-i-keep-getting-a-segmentation-dump", "title": "Why do I keep getting a segmentation dump?", "body": "<p>I have to create a program that sorts one word alphabetically and must be done so using arrays and pointers.</p>\n\n<p>I tried removing the size of the array and allocating memory, but that gave me the same segmentation fault. I don't know if the issue is with passing the array to the function or the bubble sort. I added a print statement in the function so I assume I'm passing the array correctly. When pancake is entered it does print a within the function. I'm leaning more towards the bubble sort causing the issue because I can remove that and it gets rid of the segmentation fault.</p>\n\n<pre><code>void main(void)\n{\n  int num;\n  double swap1 = 18.4 , swap2 = 95.73;\n  char theString[50];\n  char beginning, ending;\n  printf(\"Enter a number:\\n\");\n  scanf(\"%d\", &amp;num);\n  doubleme(&amp;num);\n  printf(\"%d is the value you entered doubled.\\n\", num);\n  printf(\"Before swapping value a is %lf and value b is %lf\\n\", swap1, swap2);\n  swap(&amp;swap1, &amp;swap2);\n  printf(\"After swapping value a is %lf and value b is %lf\\n\", swap1, swap2);\n  printf(\"Enter a word and I will tell you the first and last character of the alphabet within it.\\n\");\n  scanf(\"%s\", theString);\n  firstLast(theString, &amp;beginning, &amp;ending);\n  printf(\"%s is the first character and %s is the last.\\n\", beginning, ending);\n}\n\nvoid doubleme(int *x)\n{\n  *x = 2 * *x;\n}\n\nvoid swap(double *a, double *b)\n{\n  double temp;\n  temp = *a;\n  *a = *b;\n  *b = temp;\n}\n\nvoid firstLast(char theString[], char *first, char *last)\n{\n  int i, j, n;\n  n = strlen(theString);\n  char temp;\n  printf(\"%c\\n\", theString[4]);\n  for(i = 0; i &lt; (n - 1); i++)\n  {\n    for(j = 0; j &lt; (n - 1); j++)\n    {\n      if(theString[j] &gt; theString[(j+1)])\n      {\n        temp = theString[j];\n        theString[j] = theString[(j+1)];\n        theString[(j+1)] = temp;\n      }\n    }\n  }\n  *first = theString[0];\n  *last = theString[(n-1)];\n}\n</code></pre>\n\n<p>I need the function to sort any string entered and return the values to the main using arrays and pointers.</p>\n"}, {"tags": ["c", "menu", "fork", "pid", "ls"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1554904543, "post_id": 55614178, "comment_id": 97922525, "body": "And what is your question for us?"}, {"owner": {"reputation": 1, "user_id": 7263410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d977d710d5e90307de9efa552fafec16?s=128&d=identicon&r=PG&f=1", "display_name": "Sam_H18", "link": "https://stackoverflow.com/users/7263410/sam-h18"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554909722, "post_id": 55614178, "comment_id": 97925704, "body": "How would I go about starting this off?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554910773, "post_id": 55614178, "comment_id": 97926257, "body": "You&#39;ll need to be more specific.  Do you want to know about some kind of misbehavior of the code presented? (Which?)  Do you want to know how to program some specific operation? (What?)"}, {"owner": {"reputation": 1, "user_id": 7263410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d977d710d5e90307de9efa552fafec16?s=128&d=identicon&r=PG&f=1", "display_name": "Sam_H18", "link": "https://stackoverflow.com/users/7263410/sam-h18"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1554912340, "post_id": 55614178, "comment_id": 97927184, "body": "Sorry, I&#39;d like to understand how I&#39;d go about getting the program to run the Linux commands when selected by the user from a menu."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554931475, "post_id": 55614178, "comment_id": 97936038, "body": "Regarding: <code>printf( &quot;Can you read this ?\\n &quot; ) ;</code>  The <code>exec*()</code> commands ONLY return if the <code>exec*()</code> function failed.  In such a failure the statements should be: <code>perror( &quot;execl()</code> failed&quot; );  exit( EXIT_FAILURE );`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554931733, "post_id": 55614178, "comment_id": 97936129, "body": "The <code>fork()</code> function has three(3) kinds of return indications 1) &gt;0 means in the parent process  2) ==0 means in the child process  and 3) &lt;0 means a error occurred.  When the error occurs then execute: <code>perror( &quot;fork failed&quot; );  exit( EXIT_FAILURE );</code>  Note: <code>perror()</code> outputs to stderr, your error message and the text reason the system thinks the error occurred"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554932396, "post_id": 55614178, "comment_id": 97936353, "body": "regarding: <code>execl ( &quot;&#47;bin&#47;ls&quot;,&quot;.&quot;,(char*)0)</code>   Rather than <code>(char*)0</code>  much better to use the predefined value <code>NULL</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1554932256, "creation_date": 1554932256, "answer_id": 55621658, "question_id": 55614178, "link": "https://stackoverflow.com/questions/55614178/a-menu-of-linux-commands-e-g-ls-ipconfig-etc-that-forks-and-uses-execl-to-run/55621658#55621658", "title": "A menu of Linux commands (e.g ls, ipconfig etc) that forks and uses execl to run the commands as a child process", "body": "<p>before calling </p>\n\n<pre><code>fork() \n</code></pre>\n\n<p>the code should display the menu, probably via some calls to printf(), </p>\n\n<p>then input the users selection </p>\n\n<p>then use that selection, probably via a <code>switch()</code> statement, to place the appropriate text into an </p>\n\n<pre><code>char *args[] variable \n</code></pre>\n\n<p>then use that <code>args[]</code> variable when calling <code>execl()</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7263410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d977d710d5e90307de9efa552fafec16?s=128&d=identicon&r=PG&f=1", "display_name": "Sam_H18", "link": "https://stackoverflow.com/users/7263410/sam-h18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554932256, "creation_date": 1554903923, "question_id": 55614178, "link": "https://stackoverflow.com/questions/55614178/a-menu-of-linux-commands-e-g-ls-ipconfig-etc-that-forks-and-uses-execl-to-run", "title": "A menu of Linux commands (e.g ls, ipconfig etc) that forks and uses execl to run the commands as a child process", "body": "<p>I have been given some code and I need to adapt this to show a menu of Linux commands and when a command is selected, the program should fork and use execl to run the commands as a child process and show its PID. I'm new to C so this I've been struggling so far :/</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include \"sys/types.h\"\n#include &lt;sys/wait.h&gt;\nint main(){\n\npid_t pid;\n    int status = 0;\n    int i;\n    pid= fork() ;\n        if(pid!=0) {\n                wait(&amp;status);\n                printf ( \" I am the parent my PID is %d, myPPID is %d, \\n \",getpid(),getppid());\n                printf( \"Mychild process has finished. \\n \");\n        }else {\n        printf ( \" I am the child , my PID is %d , my PPID is %d \\n\",getpid(),getppid());\n        sleep(2);\n        execl ( \"/bin/ls\",\".\",(char*)0);\n        printf( \"Can you read this ?\\n \" ) ;\n        }\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "valgrind"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1554904631, "post_id": 55614036, "comment_id": 97922584, "body": "Causing the program to behave differently when being analyzed would defeat the purpose of performing the analysis."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1554904654, "post_id": 55614036, "comment_id": 97922594, "body": "What is the problem with adding valgrind/memcheck headers?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1554904921, "post_id": 55614036, "comment_id": 97922762, "body": "If you nevertheless do want to modulate the behavior of the program, then using command-line options, configuration files, or interactive input to do so is the right way to do it, because that provides an appropriate separation of concerns.  As a practical matter, that means you can analyze the set of features you choose, instead of being limited to a specific set baked into the program."}], "answers": [{"tags": [], "owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "is_accepted": false, "score": 0, "last_activity_date": 1554905317, "creation_date": 1554905317, "answer_id": 55614661, "question_id": 55614036, "link": "https://stackoverflow.com/questions/55614036/looking-for-a-way-to-detect-valgrind-memcheck-at-runtime-without-including-valgr/55614661#55614661", "title": "Looking for a way to detect valgrind/memcheck at runtime without including valgrind headers", "body": "<p>Not sure it's a good idea to have a different behavior when running under Valgrind since the goal of Valgrind is to assert your software in the <em>expected</em> usage case.</p>\n\n<p>Anyway, Valgrind does not change the stack or symbols since it (kind of) emulates a CPU running your program. The only way to detect if you're being run under Valgrind is to observe for its effects, that is, everything is slow and not multithreaded in Valgrind. </p>\n\n<p>So, for example, run a test that spawn 3 threads consuming a common FIFO (with a mutex/lock) and observe the number of items received. In real CPU, you'd expect the 3 threads to have processed close to the same amount of items in <code>T</code> time, but when run under Valgrind, one thread will have consumed almost all items in <code>&gt;&gt;T</code> time.</p>\n\n<p>Another possibility is to call a some known syscall. Valgrind has some rules for <em>observing</em> syscall. For example, if you are allocating memory, then Valgrind will intercept this block of memory, and fill that memory area with some data. In a good software, you should not read that data and first write to it (so overwriting what Valgrind set). If you try to read that data and observe non zero value, you'll get a Valgrind <code>invalid read of size XXX</code> message, but your code will know it's being instrumented.</p>\n\n<p>Finally, (and I think it much simpler), you should move the code you need to instrument in a library, and have 2 frontends. The \"official\" frontend, and a test frontend where you've disabled all bells and whistles that's supposed to be run under Valgrind.</p>\n"}], "owner": {"reputation": 71, "user_id": 815640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a71927c61dc1844a6de7f29f684a99?s=128&d=identicon&r=PG", "display_name": "Ebrahim Ahmed", "link": "https://stackoverflow.com/users/815640/ebrahim-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1554905317, "creation_date": 1554903512, "last_edit_date": 1554903981, "question_id": 55614036, "link": "https://stackoverflow.com/questions/55614036/looking-for-a-way-to-detect-valgrind-memcheck-at-runtime-without-including-valgr", "title": "Looking for a way to detect valgrind/memcheck at runtime without including valgrind headers", "body": "<p>Valgrind/Memcheck can be intensive and causes runtime performance to drop significantly. I need a way (at runtime) to detect it in order to disable all auxiliary services and features in order to perform checks in under 24 hours. I would prefer not to pass any explicit flags to program, but that would be one way. </p>\n\n<ol>\n<li>I explored searching the symbol table (via abi calls) for valgrind or memcheck symbols, but there were none.</li>\n<li>I explored checking the stack (via boost::stacktrace), but nothing was there either.</li>\n</ol>\n"}, {"tags": ["c", "openssl", "mbedtls", "libtomcrypt"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 5658326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/229145eb2853349188a01dd62def9daf?s=128&d=identicon&r=PG&f=1", "display_name": "jaeckel", "link": "https://stackoverflow.com/users/5658326/jaeckel"}, "is_accepted": true, "score": 2, "last_activity_date": 1554975965, "creation_date": 1554975965, "answer_id": 55629496, "question_id": 55613950, "link": "https://stackoverflow.com/questions/55613950/rsa-signature-verification-failing-with-libtomcrypt/55629496#55629496", "title": "RSA signature verification failing with libtomcrypt", "body": "<p>There's one important part missing, you should not be signing the data, but a hash of the data.</p>\n\n<p>Adding this fixes the issue:</p>\n\n<pre><code>diff --git a/test-rsa-sign-verify-libtomcrypt-openssl.c b/test-rsa-sign-verify-\nlibtomcrypt-openssl.c\nindex 758994a..25e1312 100644\n--- a/test-rsa-sign-verify-libtomcrypt-openssl.c\n+++ b/test-rsa-sign-verify-libtomcrypt-openssl.c\n@@ -9,6 +9,7 @@\n #include \"openssl/err.h\"\n #include \"openssl/rsa.h\"\n\n+#define ERRORe(e) printf(\"%d: \\\"%s\\\"\\n\", __LINE__, error_to_string(e));\n #define ERROR() printf(\"Error at line : %d\\n\", __LINE__);\n\n char *data = \"This is the data which will be hashed and then signed by RSA\";\n@@ -57,10 +58,18 @@ int main(void)\n     printf(\"* Random number generator registered\\n\");\n\n     size_t data_length = strlen(data);\n+\n+    uint8_t hash[32];\n+    unsigned long hash_length = sizeof(hash);\n+    if ((err = hash_memory(hash_idx, data, data_length, hash, &amp;hash_length)) != CRYPT_OK) {\n+       ERRORe(err);\n+       return -1;\n+    }\n+\n     unsigned long signature_length = 256;\n     unsigned char *signature = calloc(signature_length, sizeof(unsigned char));\n\n-    err = rsa_sign_hash((const unsigned char *) data, data_length,\n+    err = rsa_sign_hash((const unsigned char *) hash, hash_length,\n                         signature, &amp;signature_length,\n                         NULL, prng_idx, hash_idx, 12,\n                         &amp;private_key);\n</code></pre>\n"}], "owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 55629496, "answer_count": 1, "score": 0, "last_activity_date": 1554975965, "creation_date": 1554903284, "question_id": 55613950, "link": "https://stackoverflow.com/questions/55613950/rsa-signature-verification-failing-with-libtomcrypt", "title": "RSA signature verification failing with libtomcrypt", "body": "<p>I was using libtomcrypt for a project, in particular hashing and signing with RSA some data. Because of memory requirements I wanted to switch to mbedtls. However I noticed an issue when trying to verify with mbedtls a signature generated by libtomcrypt. There is a padding (PKCS#1 PSS) decoding issue. </p>\n\n<p>Because I didn't know which of these libraries was (maybe) having a bug I used openssl to verify.</p>\n\n<p>I successfully verified a signature generated with mbedtls with openssl and I had a verification failure when verifying one generated form libtomcrypt which makes me think libtomcrypt has a bug. </p>\n\n<p>However because It could be a configuration issue so I created a repo with minimal examples with the hope someone could detect an issue coming from me and not from the library itself.</p>\n\n<p>The test repo is <a href=\"https://github.com/LittleMonsterFr/mbedtls-tomcrypt\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Thanks for any help received !</p>\n"}, {"tags": ["c", "ffmpeg", "h.264", "avcodec"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11340575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bec41c7997d77b7c6e2d58fb8c307d?s=128&d=identicon&r=PG&f=1", "display_name": "HellBlood", "link": "https://stackoverflow.com/users/11340575/hellblood"}, "edited": false, "score": 0, "creation_date": 1555314727, "post_id": 55631067, "comment_id": 98053025, "body": "I realized the call of the decoder with &quot;avcodec_find_encoder&quot; but I do not see how to apply hardware acceleration to this decoded frame ... I have seen that pix_fmt was able to assign material acceleration, for example if pix_fmt = This is exactly as it was in h264. The only question is what function is used to apply this vdpau acceleration ..."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "reply_to_user": {"reputation": 31, "user_id": 11340575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bec41c7997d77b7c6e2d58fb8c307d?s=128&d=identicon&r=PG&f=1", "display_name": "HellBlood", "link": "https://stackoverflow.com/users/11340575/hellblood"}, "edited": false, "score": 0, "creation_date": 1555319089, "post_id": 55631067, "comment_id": 98055108, "body": "As I said in my response - if you open the hw accelerated codec by name, you already have a codec instance with the hardware acceleration enabled. The point of the hw accelerated codecs is that they will always use the hardware acceleration, while the standard ones will not. Thus, all you have to do is properly open it and use it in your pipeline."}, {"owner": {"reputation": 660, "user_id": 3053715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c702589303ed2540518d57162abef0?s=128&d=identicon&r=PG&f=1", "display_name": "tbago", "link": "https://stackoverflow.com/users/3053715/tbago"}, "edited": false, "score": 0, "creation_date": 1578018700, "post_id": 55631067, "comment_id": 105312626, "body": "avcodec_find_decoder_by_name cannot find AVHWAccel. only can find register decoder."}, {"owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "reply_to_user": {"reputation": 660, "user_id": 3053715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c702589303ed2540518d57162abef0?s=128&d=identicon&r=PG&f=1", "display_name": "tbago", "link": "https://stackoverflow.com/users/3053715/tbago"}, "edited": false, "score": 0, "creation_date": 1578298451, "post_id": 55631067, "comment_id": 105380720, "body": "@tbago did you actually verify that or just comment and downvote? I can find <code>h264_videotoolbox</code> just fine, expanded the answer with a simple snippet."}, {"owner": {"reputation": 660, "user_id": 3053715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c702589303ed2540518d57162abef0?s=128&d=identicon&r=PG&f=1", "display_name": "tbago", "link": "https://stackoverflow.com/users/3053715/tbago"}, "edited": false, "score": 0, "creation_date": 1578445415, "post_id": 55631067, "comment_id": 105438555, "body": "<a href=\"https://github.com/FFmpeg/FFmpeg/blob/master/doc/examples/hw_decode.c.You\" rel=\"nofollow noreferrer\">github.com/FFmpeg/FFmpeg/blob/master/doc/examples/&hellip;</a> can see this demo show how to use hardware decoder."}], "tags": [], "owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "is_accepted": false, "score": 0, "last_activity_date": 1578298720, "last_edit_date": 1578298720, "creation_date": 1554980879, "answer_id": 55631067, "question_id": 55613673, "link": "https://stackoverflow.com/questions/55613673/hwaccel-with-avcodec-in-ffmpeg/55631067#55631067", "title": "Hwaccel with AVCodec in FFMPEG?", "body": "<p>See <a href=\"https://lists.ffmpeg.org/pipermail/libav-user/2013-September/005465.html\" rel=\"nofollow noreferrer\">this</a> thread on libav-user. Basically after listing the hw accelerated codecs you can try to lookup the appropriate decoder with <a href=\"https://www.ffmpeg.org/doxygen/2.7/group__lavc__decoding.html#ga776f2359007e8457799503068419e791\" rel=\"nofollow noreferrer\">avcodec_find_decoder_by_name</a> (since the <a href=\"http://ffmpeg.org/doxygen/2.3/structAVHWAccel.html\" rel=\"nofollow noreferrer\">AVHWAccel</a> struct has the name field) and then use that for decoding. But then you need to know the codec upfront. If you use <code>avformat_open_input</code> then you may simply try to find a matching hw accelerated decoder by the codec id from the stream info, then open the hw accelerated codec by name and use that.</p>\n\n<p><strong>Update, since I got downvoted</strong></p>\n\n<p>To provide a working example of this, I have an ffmpeg installation from homebrew, that lists videotoolbox (which is a HW accelerated codec) via <code>ffmpeg -encoders | grep h264</code>:</p>\n\n<p><code>V..... h264_videotoolbox    VideoToolbox H.264 Encoder (codec h264)</code></p>\n\n<p>And the following snippet also finds it:</p>\n\n<pre><code>extern \"C\"\n{\n#include &lt;libavcodec/avcodec.h&gt;\n}\n\nint main(int argc, char** argv)\n{\n    auto *codec = avcodec_find_encoder_by_name(\"h264_videotoolbox\");\n    if (codec)\n    {\n        return 0;\n    }\n    return 1;\n}\n</code></pre>\n\n<p>Moreover, if you check what <code>avcodec_find_encoder_by_name</code>/<code>avcodec_find_encoder_by_name</code> does, it is visible that it basically iterates the whole codec list just by applying a filter to distinguish encoders/decoders:</p>\n\n<pre><code>static AVCodec *find_codec_by_name(const char *name, int (*x)(const AVCodec *))\n{\n    void *i = 0;\n    const AVCodec *p;\n\n    if (!name)\n        return NULL;\n\n    while ((p = av_codec_iterate(&amp;i))) {\n        if (!x(p))\n            continue;\n        if (strcmp(name, p-&gt;name) == 0)\n            return (AVCodec*)p;\n    }\n\n    return NULL;\n}\n\nAVCodec *avcodec_find_encoder_by_name(const char *name)\n{\n    return find_codec_by_name(name, av_codec_is_encoder);\n}\n\nAVCodec *avcodec_find_decoder_by_name(const char *name)\n{\n    return find_codec_by_name(name, av_codec_is_decoder);\n}\n</code></pre>\n\n<p>The <code>av_codec_iterate</code> will iteratre the <code>codec_list</code> variable, which is a pregenerated list of supported codecs (populated by the features enabled when configuring the build). So if any hw accelerated codecs were enable during configuration, they will be there.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11340575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bec41c7997d77b7c6e2d58fb8c307d?s=128&d=identicon&r=PG&f=1", "display_name": "HellBlood", "link": "https://stackoverflow.com/users/11340575/hellblood"}, "is_accepted": false, "score": 0, "last_activity_date": 1555314786, "creation_date": 1555314786, "answer_id": 55684686, "question_id": 55613673, "link": "https://stackoverflow.com/questions/55613673/hwaccel-with-avcodec-in-ffmpeg/55684686#55684686", "title": "Hwaccel with AVCodec in FFMPEG?", "body": "<p>I realized the call of the decoder with \"avcodec_find_encoder\" but I do not see how to apply hardware acceleration to this decoded frame ... I have seen that pix_fmt was able to assign material acceleration, for example if pix_fmt = This is exactly as it was in h264. The only question is what function is used to apply this vdpau acceleration ... </p>\n"}], "owner": {"reputation": 31, "user_id": 11340575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bec41c7997d77b7c6e2d58fb8c307d?s=128&d=identicon&r=PG&f=1", "display_name": "HellBlood", "link": "https://stackoverflow.com/users/11340575/hellblood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1247, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1578298720, "creation_date": 1554902486, "question_id": 55613673, "link": "https://stackoverflow.com/questions/55613673/hwaccel-with-avcodec-in-ffmpeg", "title": "Hwaccel with AVCodec in FFMPEG?", "body": "<p>I am using AVCodec as a video stream decoder and would like to know if it was possible to use hardware acceleration with hwaccel via FFMPEG? or is it already used by default?\nI have already listed codecs available but I do not understand how to implement them in my code.</p>\n\n<pre><code>    AVHWAccel* pHwaccel = NULL;\n    pHwaccel = av_hwaccel_next(NULL);\n\n    while(pHwaccel!=NULL)\n    {\n        TkCore::Logger::info(\"%s\", pHwaccel-&gt;name);\n        pHwaccel = av_hwaccel_next(pHwaccel);\n    }\n</code></pre>\n\n<p>i obtain : h264_qsv, h264_vaapi,h264_vdpaufor h264.\nI saw that the command :\n<code>AVHWAccel * ff_find_hwaccel (codecID enum codec_id, enum PixelFormat pix_fmt)</code>\nbeen obsolete.\nThank you in advance for your help.</p>\n"}, {"tags": ["c", "pointers", "arguments"], "comments": [{"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1554902924, "post_id": 55613360, "comment_id": 97921463, "body": "Little nitpicking: <i>&quot;a function which takes in a const pointer to a const double <b>array</b>&quot;</i> -&gt; <a href=\"https://stackoverflow.com/a/4810668/1753435\">A pointer is not an array</a>!"}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 8845499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545ae3962601e3fca297b900ecb1325?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8845499/matt"}, "edited": false, "score": 0, "creation_date": 1554902776, "post_id": 55613656, "comment_id": 97921356, "body": "Thanks for the clarifications! I have a follow up question: If the pointer is copied by reference, is there a way to pass a pointer by reference and what would the consequences be? Is this done and is it dangerous if it is done?"}, {"owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "reply_to_user": {"reputation": 305, "user_id": 8845499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545ae3962601e3fca297b900ecb1325?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8845499/matt"}, "edited": false, "score": 1, "creation_date": 1554903003, "post_id": 55613656, "comment_id": 97921518, "body": "In C, you can&#39;t pass by reference. In C++, you can, and the consequence is that any change in the function will be &quot;seen&quot; by the caller. It&#39;s done if you want an &quot;(in-)out&quot; parameter, though a return value is, in general, preferred. It&#39;s only dangerous if you make a mess. :)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1554903357, "post_id": 55613656, "comment_id": 97921777, "body": "What should he do to force that the array elements cannot be changed in the function?"}, {"owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "edited": false, "score": 2, "creation_date": 1554904272, "post_id": 55613656, "comment_id": 97922355, "body": "The declaration <code>void my_func(double const* my_array, size_t size);</code> will not allow the function to change the elements of <code>my_array</code> (what <code>my_array</code> points <i>to</i>). Function might change <code>my_array</code> pointer itself, but it has no reason to."}], "tags": [], "owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "is_accepted": false, "score": 5, "last_activity_date": 1554902443, "creation_date": 1554902443, "answer_id": 55613656, "question_id": 55613360, "link": "https://stackoverflow.com/questions/55613360/why-has-passing-a-const-pointer-argument-in-function-declaration-no-effect/55613656#55613656", "title": "Why has passing a const pointer argument in function declaration no effect", "body": "<blockquote>\n  <p>1)\n  Suppose my pointer argument is not const (const double * pointer_arg), if I change pointer_arg inside the function to point to another const double, is will the change be visible outside of my function? </p>\n</blockquote>\n\n<p>No, it is not visible.</p>\n\n<blockquote>\n  <p>That is, after the line I executed my function, where fill pointer_arg point to? </p>\n</blockquote>\n\n<p>Same as before.</p>\n\n<blockquote>\n  <p>If it is not visible, does that mean the pointer is copied in by value? Is this even possible?</p>\n</blockquote>\n\n<p>That's exactly it.</p>\n\n<blockquote>\n  <p>2)\n  What is the reason behind the decision that const in the declaration has no effect? </p>\n</blockquote>\n\n<p>Because it is transferred by value, <code>const</code> has no effect (on the caller).</p>\n\n<blockquote>\n  <p>3)\n  What might be a benefit of having a different function signature in the declaration and definition?</p>\n</blockquote>\n\n<p>None. It actually should not even compile in C++.</p>\n\n<blockquote>\n  <p>4)\n  Should I drop the const in the declaration? What are best practices in this case?</p>\n</blockquote>\n\n<p>Yes, you should drop the <code>const</code>, because it doesn't help much. You're only prohibiting that the function changes its copy of the pointer, which is of no concern to the caller.</p>\n"}, {"tags": [], "owner": {"reputation": 1365, "user_id": 7610883, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d5b2f292c46f7ef87ab8a0adb47154fa?s=128&d=identicon&r=PG&f=1", "display_name": "cmdLP", "link": "https://stackoverflow.com/users/7610883/cmdlp"}, "is_accepted": false, "score": 0, "last_activity_date": 1554902761, "creation_date": 1554902761, "answer_id": 55613756, "question_id": 55613360, "link": "https://stackoverflow.com/questions/55613360/why-has-passing-a-const-pointer-argument-in-function-declaration-no-effect/55613756#55613756", "title": "Why has passing a const pointer argument in function declaration no effect", "body": "<p>The <code>const</code> attribute on the right of the <code>*</code> only affects the pointer itself, not the memory pointed to, the pointer itself is stored as an automatic variable.</p>\n\n<pre><code>void my_func(const double * my_array, size_t size);\n</code></pre>\n\n<p>Is the same as </p>\n\n<pre><code>void my_func(const double * const my_array, size_t size);\n</code></pre>\n\n<p>The const only affects the implementation, where <code>my_array</code> is used. <code>my_array</code> has automatic storage duration and cannot be changed in the implementation, when <code>const</code> is applied to it.</p>\n\n<p>Given prototype:</p>\n\n<pre><code>int add(int a, int b);\n// same as\nint add(int const a, int const b);\n</code></pre>\n\n<p>Useful usage, force to keep the parameters <code>a</code> &amp; <code>b</code> constant inside the function:</p>\n\n<pre><code>int add(int const a, int const b) {\n    // a = a*b; // error\n    return a+b;\n};\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 8845499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545ae3962601e3fca297b900ecb1325?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8845499/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554902761, "creation_date": 1554901597, "question_id": 55613360, "link": "https://stackoverflow.com/questions/55613360/why-has-passing-a-const-pointer-argument-in-function-declaration-no-effect", "title": "Why has passing a const pointer argument in function declaration no effect", "body": "<h1>Problem Description</h1>\n\n<p>I have a function which takes in a const pointer to a const double array on which I loop over using the size as boundary check inside my_func.</p>\n\n<p><strong><em>Declaration in .h</em></strong></p>\n\n<pre><code>void my_func(const double * const my_array, size_t size);\n</code></pre>\n\n<p><strong><em>Implementation in .c</em></strong></p>\n\n<pre><code>void my_func(const double * const my_array, size_t size) {\n  for (size_t idx = 0; idx &lt; size; idx++) {\n    do_something_with(my_array[idx]);\n  }\n}\n</code></pre>\n\n<p>I don't want the pointer to be changed inside the function hence making it <code>* const</code>. I don't want the data it is pointing to to be changed, hence the <code>const double</code>.</p>\n\n<p>Clang-Tidy however wants me to have the function <em>declaration</em> drop the const on the pointer, making it</p>\n\n<pre><code>void my_func(const double * my_array, size_t size);\n</code></pre>\n\n<blockquote>\n  <p>Clang-Tidy: Parameter 'my_array' is const-qualified in the function declaration; const-qualification of parameters only has an effect in function definitions</p>\n</blockquote>\n\n<p>If I follow that advice but want to keep my constraints from above, my function declaration and definition are not the same anymore. </p>\n\n<h1>Questions</h1>\n\n<p><strong>1)</strong><br>\nSuppose my pointer argument is not const (<code>const double * pointer_arg</code>), if I change <code>pointer_arg</code> inside the function to point to another <code>const double</code>, is will the change be visible outside of my function? That is, after the line I executed my function, where fill <code>pointer_arg</code> point to? If it is not visible, does that mean the pointer is copied in by value? Is this even possible?</p>\n\n<p><strong>2)</strong><br>\nWhat is the reason behind the decision that const in the declaration has no effect? </p>\n\n<p><strong>3)</strong><br>\nWhat might be a benefit of having a different function signature in the declaration and definition? For me looking at my header file it is not clear how the implementation works, will it be const inside the function, won't it be? It raises confusion for me or a collaborator on the code.</p>\n\n<p><strong>4)</strong><br>\nShould I drop the const in the declaration? What are <em>best practices</em> in this case?</p>\n"}, {"tags": ["c", "linux", "bash", "path", "directory"], "comments": [{"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1554901583, "post_id": 55613296, "comment_id": 97920559, "body": "There is no standard function for this in C. You need to count number of &quot;../&quot; and number of &quot;text/&quot; and based on those counts, you should find out whether path is outside directory."}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 0, "creation_date": 1554901901, "post_id": 55613296, "comment_id": 97920806, "body": "You may want to look at how <a href=\"https://unix.stackexchange.com/questions/24293/converting-relative-path-to-absolute-path-without-symbolic-link\">readlink implements the <code>-f</code> option</a>."}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 0, "creation_date": 1554902397, "post_id": 55613296, "comment_id": 97921121, "body": "See <a href=\"https://github.com/gagern/gnulib/blob/master/lib/canonicalize.c\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8293, "user_id": 8656552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FPg67.png?s=128&g=1", "display_name": "Paul Hodges", "link": "https://stackoverflow.com/users/8656552/paul-hodges"}, "is_accepted": false, "score": 0, "last_activity_date": 1554903139, "creation_date": 1554903139, "answer_id": 55613900, "question_id": 55613296, "link": "https://stackoverflow.com/questions/55613296/how-to-check-if-a-path-leads-outside-of-a-directory-in-c/55613900#55613900", "title": "How to check if a path leads outside of a directory in c?", "body": "<p>Pseudocode:\n<hr/>\nGet the current full path (<code>pwd</code>)<br>\ncd to the new path<br>\nget the new full path<br>\nif new full path starts with old full path, it's in*  </p>\n\n<ul>\n<li>you might need to scan for the possibility of symlinks &amp;c, but if that's a non-issue this should handle it.</li>\n</ul>\n\n<p>Haven't done <code>C</code> in a while, but here's a quick hack of the same logic in <code>bash</code></p>\n\n<pre><code>$: pwd\n/tmp/sandbox\n$: cur=$(pwd)\n$: cd ./folder/../../\n$: pwd\n/tmp\n$: pwd|grep \"^$cur\" &amp;&amp; echo in || echo out\nout\n\n$: cd -\n/tmp/sandbox\n$: pwd|grep \"^$cur\" &amp;&amp; echo in || echo out\n/tmp/sandbox\nin\n\n$: cd ./folder/\n$: pwd|grep \"^$cur\" &amp;&amp; echo in || echo out\n/tmp/sandbox/folder\nin\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554904062, "post_id": 55614120, "comment_id": 97922226, "body": "Note that <code>realpath()</code>  won&#39;t work should <code>path</code> refer to non-existent path objects."}], "tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": true, "score": 4, "last_activity_date": 1554906685, "last_edit_date": 1554906685, "creation_date": 1554903750, "answer_id": 55614120, "question_id": 55613296, "link": "https://stackoverflow.com/questions/55613296/how-to-check-if-a-path-leads-outside-of-a-directory-in-c/55614120#55614120", "title": "How to check if a path leads outside of a directory in c?", "body": "<p>POSIX.1-2001 defines <a href=\"http://man7.org/linux/man-pages/man3/realpath.3.html\" rel=\"nofollow noreferrer\">realpath(3)</a>:</p>\n\n<blockquote>\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *realpath(const char *path, char *resolved_path);\n</code></pre>\n  \n  <p><code>realpath()</code>  expands  all  symbolic  links and resolves references to <code>/./</code>, <code>/../</code> and extra <code>'/'</code> characters in the null-terminated string named by path to produce a canonicalized absolute pathname.  The resulting pathname is stored as a null-terminated string, up to a maximum of <code>PATH_MAX</code> bytes, in the buffer pointed to by <code>resolved_path</code>.  The resulting path will have no symbolic link,  <code>/./</code>  or  <code>/../</code> components.</p>\n</blockquote>\n\n<p>You could compare the canonicalized path to the current directory and see if the former is a descendant of the latter.</p>\n\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nbool is_inside(const char *parent, const char *child) {\n    char *abs_parent = realpath(parent, NULL);\n    if (!abs_parent) { perror(parent); exit(EXIT_FAILURE); }\n\n    char *abs_child  = realpath(child,  NULL);\n    if (!abs_child)  { perror(child);  exit(EXIT_FAILURE); }\n\n    size_t parent_len = strlen(abs_parent);\n    size_t child_len  = strlen(abs_child);\n\n    bool result = strncmp(abs_parent, abs_child, parent_len) == 0 &amp;&amp;\n        (child_len == parent_len || abs_child[parent_len] == '/');\n\n    free(abs_parent);\n    free(abs_child);\n\n    return result;\n}\n\nint main(int argc, char **argv) {\n    if (argc != 3) {\n        fprintf(stderr, \"usage: %s &lt;parent&gt; &lt;child&gt;\\n\", argv[0]);\n        return 1;\n    }\n\n    printf(\"%s\\n\", is_inside(argv[1], argv[2]) ? \"yes\" : \"no\");\n    return 0;\n}\n</code></pre>\n\n<p>Note that this only works if the paths exist.</p>\n"}, {"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1554905265, "creation_date": 1554905265, "answer_id": 55614636, "question_id": 55613296, "link": "https://stackoverflow.com/questions/55613296/how-to-check-if-a-path-leads-outside-of-a-directory-in-c/55614636#55614636", "title": "How to check if a path leads outside of a directory in c?", "body": "<p>You could count the number of components that matched \"..\", \".\", :</p>\n\n<pre><code>for (p = strtok(path, \"/\"); p; p = strtok(NULL, \"/\")) {\n        if (strcmp(p, \"..\") == 0) {\n                counters[Back]++;\n        } else if (strcmp(p, \".\") == 0) {\n                counters[Self]++;\n        } else if (*p) {  /* ignore /// runs */\n                counters[Forw]++;\n        }\n        escaped |= (counters[Back] &gt; counters[Forw]);\n}\n</code></pre>\n\n<p><em>Escaped</em> captures whether the path attempted to escape from the tree under the current working directory.   It is probably worthwhile special casing a leading \"/\" as an escape.</p>\n\n<p>There are other approaches which decode the absolute pathspace, but may lead to over-reach (imho, a common systems failure mode).  I, in the role of owner, might want your program to accept pathnames which escape your namespace, at least in a limited fashion.  Symlinks work well for this, do not require special adminstrative control, etc...   If your program prevents this sort of configuration, then its utility is diminished.</p>\n"}], "owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 55614120, "answer_count": 3, "score": 1, "last_activity_date": 1554906685, "creation_date": 1554901410, "question_id": 55613296, "link": "https://stackoverflow.com/questions/55613296/how-to-check-if-a-path-leads-outside-of-a-directory-in-c", "title": "How to check if a path leads outside of a directory in c?", "body": "<p>I'm trying to check if a path leads to 'upper' than the current directory.\nExample :</p>\n\n<p>I'm inside <code>\"./\"</code></p>\n\n<p>Let's say the current directory contains a folder named \"folder\"</p>\n\n<p>I want to check if <code>cd \"./folder/../../\"</code> will lead me outside of \"./\".\nIn this case, it would answer me True.</p>\n\n<p>This is to bound my program to its execution folder (i want it to execute ls but never outside).</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 114, "user_id": 4650828, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c3ac75868538d3cb30249fc62145d9a?s=128&d=identicon&r=PG&f=1", "display_name": "aragon", "link": "https://stackoverflow.com/users/4650828/aragon"}, "edited": false, "score": 0, "creation_date": 1554901191, "post_id": 55613141, "comment_id": 97920291, "body": "You need to specify how long will be the string and change to <code>estado.nome[estado.current] = malloc(20 * sizeof(char)</code> for example. And for assignment use <code>strcpy</code>."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "reply_to_user": {"reputation": 114, "user_id": 4650828, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c3ac75868538d3cb30249fc62145d9a?s=128&d=identicon&r=PG&f=1", "display_name": "aragon", "link": "https://stackoverflow.com/users/4650828/aragon"}, "edited": false, "score": 0, "creation_date": 1554908976, "post_id": 55613141, "comment_id": 97925242, "body": "@aragon, `sizeof(char) is by definition always 1 in C."}], "answers": [{"comments": [{"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 0, "creation_date": 1554901512, "post_id": 55613255, "comment_id": 97920502, "body": "I would also suggest moving the increment out of the indexing operator, it doesn&#39;t have much advantages compared to putting it after the copy."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1554901312, "creation_date": 1554901312, "answer_id": 55613255, "question_id": 55613141, "link": "https://stackoverflow.com/questions/55613141/allocing-memory-to-array-of-strings/55613255#55613255", "title": "Allocing memory to array of strings", "body": "<p>There's two problems with the code you show:</p>\n\n<ol>\n<li><p>With</p>\n\n<pre><code>estado.nome[estado.current] = malloc(sizeof(char*));\n</code></pre>\n\n<p>you allocate only space for a <em>pointer</em>, not the whole string. This is like you creating an array of one pointer. You need to allocate space for the string itself, whose length you get from <code>strlen</code>, and also for the null-terminator at the end:</p>\n\n<pre><code>estado.nome[estado.current] = malloc(strlen(nome) + 1);  // +1 for null-terminator\n</code></pre></li>\n<li><p>With</p>\n\n<pre><code>estado.nome[estado.current++] = nome;\n</code></pre>\n\n<p>you <em>overwrite</em> the pointer you created above. This is equivalent to e.g. <code>int a; a = 5; a = 10;</code> and then be surprised that <code>a</code> is no longer equal to <code>5</code>. You need to copy the string, not the pointer:</p>\n\n<pre><code>strcpy(estado.nome[estado.current++], nome);\n</code></pre></li>\n</ol>\n\n<p>Of course, you need to <code>free</code> the memory you allocate later in your code, once you're finished with it.</p>\n\n<p>And of course you should have some bound-checking to make sure you don't go out of bounds of the <code>estado.nome</code> array (i.e. a check for <code>estado.current &lt; 10</code>).</p>\n"}], "owner": {"reputation": 15, "user_id": 11262860, "user_type": "registered", "profile_image": "https://graph.facebook.com/2193231977436979/picture?type=large", "display_name": "Leonardo Maia", "link": "https://stackoverflow.com/users/11262860/leonardo-maia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554901312, "creation_date": 1554900955, "last_edit_date": 1554901116, "question_id": 55613141, "link": "https://stackoverflow.com/questions/55613141/allocing-memory-to-array-of-strings", "title": "Allocing memory to array of strings", "body": "<p>So, i'm tring to allocate memory to insert file names in it. I have my struct Estado defined like this:</p>\n\n<pre><code>typedef struct estado{\n\n    char modo;\n    char jogador;\n    char matriz[8][8];\n    int pretas;\n    int brancas;\n    char *nome[10];\n    int current;\n\n} Estado;\n</code></pre>\n\n<p>I tried doing this:</p>\n\n<pre><code>Estado insereFicheiro(Estado estado , char* nome){\n\n    estado.nome[estado.current] = malloc(sizeof(char*));\n    estado.nome[estado.current++] = nome;\n\n    return estado;\n}\n</code></pre>\n\n<p>What am i doing wrong ?</p>\n"}, {"tags": ["c#", "c"], "comments": [{"owner": {"reputation": 1190, "user_id": 11291455, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DeXw9UBXxKQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVpCjCZyaprKSzlRLY9Dy1QdNo1w/mo/photo.jpg?sz=128", "display_name": "Steve Todd", "link": "https://stackoverflow.com/users/11291455/steve-todd"}, "edited": false, "score": 0, "creation_date": 1554899668, "post_id": 55612602, "comment_id": 97919347, "body": "On the Windows platform? If you can export the function via a DLL then use .NET interop to call the function, but there is an overhead in crossing the managed/unmanaged boundary."}, {"owner": {"reputation": 21, "user_id": 4933843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b279ffa9a46893a5dc7b0b32cfc37375?s=128&d=identicon&r=PG&f=1", "display_name": "Imen Ben Hassen", "link": "https://stackoverflow.com/users/4933843/imen-ben-hassen"}, "reply_to_user": {"reputation": 1190, "user_id": 11291455, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DeXw9UBXxKQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVpCjCZyaprKSzlRLY9Dy1QdNo1w/mo/photo.jpg?sz=128", "display_name": "Steve Todd", "link": "https://stackoverflow.com/users/11291455/steve-todd"}, "edited": false, "score": 0, "creation_date": 1554900476, "post_id": 55612602, "comment_id": 97919839, "body": "Yeah that&#39;s on the winCE platform"}], "owner": {"reputation": 21, "user_id": 4933843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b279ffa9a46893a5dc7b0b32cfc37375?s=128&d=identicon&r=PG&f=1", "display_name": "Imen Ben Hassen", "link": "https://stackoverflow.com/users/4933843/imen-ben-hassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "closed_date": 1554899573, "answer_count": 0, "score": 2, "last_activity_date": 1554899457, "creation_date": 1554899377, "last_edit_date": 1554899457, "question_id": 55612602, "link": "https://stackoverflow.com/questions/55612602/sharing-function-between-c-and-c", "closed_reason": "Duplicate", "title": "Sharing function between c and c#", "body": "<p>I have a c function that it will send me a buffer and i will use this buffer on my C#.</p>\n\n<pre><code>char* checkInsideZones()\n{\n    int i,j;\n\n    Point p = {-17.565728, -149.595908};\n    char *buf = malloc(BUFSIZE+1);\n    int Count_Poly, count_Zone;\n    count_Zone= Count_Zone(FNAME);\n    Zone zone[count_Zone+1];\n    Count_Poly= Count_Polygone(FNAME);\n    BillZones(zone);\n\n    for(i=1; i&lt;=Count_Zone; i++)\n    {\n        if(checkInside(zone[i].CT, zone[i].Num_Polygon, p))\n        {\n            sprintf(buf, zone[i].Name, BUFSIZE);\n            //printf(\"buf =%s\", buf);\n            return buf;\n        }\n    }\n\n}\n</code></pre>\n\n<p>Is-it possible to share a function from C code to c# ? if yes, How i could do it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1679, "user_id": 5536006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-w_ThV1XwSRk/AAAAAAAAAAI/AAAAAAAAADA/UlccMsLP3uY/photo.jpg?sz=128", "display_name": "FranzHuber23", "link": "https://stackoverflow.com/users/5536006/franzhuber23"}, "edited": false, "score": 1, "creation_date": 1554897643, "post_id": 55611951, "comment_id": 97918136, "body": "Do we need the brackets around <code>t++</code> in line 12?: <code>(t++);</code>?"}, {"owner": {"reputation": 114, "user_id": 4650828, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c3ac75868538d3cb30249fc62145d9a?s=128&d=identicon&r=PG&f=1", "display_name": "aragon", "link": "https://stackoverflow.com/users/4650828/aragon"}, "edited": false, "score": 0, "creation_date": 1554897701, "post_id": 55611951, "comment_id": 97918168, "body": "Check <code>strtok</code> function. I think it going to help you."}, {"owner": {"reputation": 941, "user_id": 1849287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14e272de9cfe3615952604a7392ebdc?s=128&d=identicon&r=PG", "display_name": "Nellie Danielyan", "link": "https://stackoverflow.com/users/1849287/nellie-danielyan"}, "edited": false, "score": 1, "creation_date": 1554897852, "post_id": 55611951, "comment_id": 97918273, "body": "<code>strcmp</code> compares the whole strings not characters."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1554898138, "post_id": 55611951, "comment_id": 97918437, "body": "You probably can&#39;t use it, but this assignment is to write a version of the standard <a href=\"https://en.cppreference.com/w/c/string/byte/strpbrk\" rel=\"nofollow noreferrer\">strpbrk()</a> function, fwiw."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1554898141, "post_id": 55611951, "comment_id": 97918444, "body": "@MOehm right sorry"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1554898819, "post_id": 55611951, "comment_id": 97918849, "body": "You can do it in linear time O(input-size) as well using precomputed automaton"}], "answers": [{"comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1554898335, "post_id": 55612102, "comment_id": 97918545, "body": "@EdHeal Yes even little shorter :). But <code>I&#39;ve written some code that I believe is very close to the answer of the problem</code> OP wanted to know his mistake in the current code only."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 7, "last_activity_date": 1554898257, "last_edit_date": 1554898257, "creation_date": 1554897744, "answer_id": 55612102, "question_id": 55611951, "link": "https://stackoverflow.com/questions/55611951/finding-an-array-of-characters-in-a-string/55612102#55612102", "title": "Finding an array of characters in a string", "body": "<p>You were almost close.</p>\n\n<p>With few problems.</p>\n\n<ol>\n<li>When you do <code>(t++)</code>, ultimately you are making <code>t</code> to  point end of its memory and leading UB.</li>\n<li><code>strcmp</code> is not for comparing <code>char</code> as you wanted.</li>\n</ol>\n\n<hr>\n\n<pre><code>char *FindToken(char *s,char *t)\n{\n    while (*s)\n    {\n        int i = 0;\n        //char check = *(char*)s; tried this but it doesn't work\n        while(t[i])\n        {\n            if (*s == t[i])) {\n                printf(\"%s\", s);\n                return s;\n            }\n            i++;\n        }\n        s++;\n    }\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1554908160, "creation_date": 1554897297, "last_edit_date": 1554908160, "question_id": 55611951, "link": "https://stackoverflow.com/questions/55611951/finding-an-array-of-characters-in-a-string", "title": "Finding an array of characters in a string", "body": "<p>I've written some code that I believe is very close to the answer of the problem, but I can't seem to properly compare two characters. I don't know how to properly cast them.</p>\n\n<p>I know how to do this using arrays, but I want to know how to do it using pointers.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char *FindToken(char *s,char *t)\n{\n    while (s)\n    {\n        //char check = *(char*)s; tried this but it doesn't work\n        while(t)\n        {\n            if (strcmp(s,t)){\n                //return s;\n                printf(\"%s\", s);\n            }\n            t++;\n        }\n        s++;\n    }\n    return NULL;\n}\n</code></pre>\n\n<p><strong>This is the original problem:</strong></p>\n\n<blockquote>\n  <p>Write a <code>C function</code> called that accepts <strong>2</strong> parameters: a <code>null</code> terminated character array (string) called <strong>S</strong> in reference to the string to be searched, and a second string parameter called <code>T</code>. The <code>string T</code> is a <code>list of characters</code> (not including the \u2018\\0\u2019) that are tokens, or characters to be searched for in <code>S</code>. Do not modify either <code>S</code> or <code>T</code>. It will <code>return</code> a character pointer to the position of the first character in <code>T</code> that is found in <code>S</code>, if it is found in <code>S,</code> or <code>NULL</code> otherwise.</p>\n</blockquote>\n\n<p>For example:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>printf(\"%s\", *FindToken(\u201care exams over yet?\u201d, \u201czypqt\u201d)); // will display \u201cyet?\u201d\n</code></pre>\n"}, {"tags": ["c", "gcc", "openmp", "windows-subsystem-for-linux", "mingw-w64"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1554897589, "post_id": 55611874, "comment_id": 97918108, "body": "You hit the top two beginner questions for OpenMP, using <code>rand()</code> (<a href=\"https://stackoverflow.com/questions/10624755/openmp-program-is-slower-than-sequential-one\">OpenMP program is slower than sequential one</a> ) and <code>clock</code> (<a href=\"https://stackoverflow.com/a/10874371/620382\">see this Answer</a> )"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 1, "creation_date": 1554907522, "post_id": 55611874, "comment_id": 97924332, "body": "Questionable usage is even more likely to produce unexpected results when comparing different versions of the compilers.  If you would try gcc -v to compare versions, you will probably see that WSL is way out of date.  At one time, it was possible to build and install a current gcc in WSL, which would resolve some of the differences, if you compare with a consistent Windows version.  By the way, saying you have a Windows version of gcc is way too unspecific. if you are able to install a gcc which uses a recent libgomp on WSL, you should get better results, at least under (OMP_PLACES....)"}], "owner": {"reputation": 55, "user_id": 9456807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VmfUND8ueP4/AAAAAAAAAAI/AAAAAAAAAAs/nrFN7FF0-dY/photo.jpg?sz=128", "display_name": "Riton Elion", "link": "https://stackoverflow.com/users/9456807/riton-elion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "closed_date": 1554910973, "answer_count": 0, "score": 0, "last_activity_date": 1554910342, "creation_date": 1554897060, "last_edit_date": 1554910342, "question_id": 55611874, "link": "https://stackoverflow.com/questions/55611874/does-wsl-support-openmp", "closed_reason": "Duplicate", "title": "Does WSL support OpenMP?", "body": "<p>Does WSL support the OpenMP? It seems that there is a big decline on WSL compared to windows when running this program.  Beside,the duration it count does not correspond to the real time.</p>\n\n<p>When I compile it on windows, everything works fine, the time is right and the result shows it do faster while using OpenMP. However, that's not the case when running on WSL.</p>\n\n<pre><code>    s = clock();\n    printf(\"%ld\\n\",s);\n    #pragma  omp parallel for num_threads(THREADS_NUM) private(i,j,m)\n    for (int l = 0; l &lt; THREADS_NUM; ++l)\n    {\n        int id = omp_get_thread_num();\n        printf(\"here is %d\\n\",id);\n        int k =0;\n        for (; k &lt; CIRCLES; ++k)\n        {\n            i = rand()%10;\n            j = rand()%10;\n            m = rand()%10;\n            m = i+j;\n            i = j+m;\n            j = i+m;\n        }\n        printf(\"complete %d %d %d\\n\",l,k,id);\n    }\n    f=clock();\n    printf(\"%ld\\n\",f);\n    printf(\"%f\\n\",(double)(f-s)/CLOCKS_PER_SEC);\n    printf(\"%ld\\n\",CLOCKS_PER_SEC);\n</code></pre>\n\n<p>Here is the result on windows:</p>\n\n<pre><code>1755//start clock\nhere is 1\nhere is 0\nhere is 3\nhere is 2\ncomplete 3 10000000 3\ncomplete 2 10000000 2\ncomplete 0 10000000 0\ncomplete 1 10000000 1\n2378//end clock\n0.623000//this is time\n1000//clock per second\n</code></pre>\n\n<p>Here is the result on wsl:</p>\n\n<pre><code>1218750//start clock\nhere is 0\nhere is 1\nhere is 3\nhere is 2\ncomplete 2 10000000 2\ncomplete 0 10000000 0\ncomplete 3 10000000 3\ncomplete 1 10000000 1\n33328125//end clock\n32.109375//this is time\n1000000//clock per second\n</code></pre>\n\n<p>And it looks like that the duration it count is 4 times the duration it really used.<code>enter code here</code></p>\n"}, {"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1554896904, "post_id": 55611736, "comment_id": 97917683, "body": "@chux Probably the more canonical dupe:  <a href=\"https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string-initialized-with-cha\" title=\"why do i get a segmentation fault when writing to a string initialized with cha\">stackoverflow.com/questions/164194/&hellip;</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1554896998, "post_id": 55611736, "comment_id": 97917736, "body": "<code>*(str1+i)= ...</code> --&gt; Attempting to modify a <i>string literal</i> is UB."}, {"owner": {"reputation": 1, "user_id": 11340045, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xsyhHJSAbFw/AAAAAAAAAAI/AAAAAAAAAAc/jut_0_-9A_k/photo.jpg?sz=128", "display_name": "Benson", "link": "https://stackoverflow.com/users/11340045/benson"}, "edited": false, "score": 0, "creation_date": 1554905955, "post_id": 55611736, "comment_id": 97923400, "body": "thnks, I did not know unnamed strings were written to read only memory. :)"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1554896800, "creation_date": 1554896800, "answer_id": 55611777, "question_id": 55611736, "link": "https://stackoverflow.com/questions/55611736/why-does-passing-right-values-through-pointers-results-in-segfault/55611777#55611777", "title": "Why does passing right values through pointers results in segfault?", "body": "<p>Because those are pointers to a read-only part in you're program's binary. You can't change the content. Try this instead:</p>\n\n<pre><code>char str1[] = \"I like pizza!\";\nchar str2[] = \"love\"; // actually, this one can stay as a pointer as we're only reading\n</code></pre>\n\n<p>Now the strings are copied to the stack and the program works as intended.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1554896813, "creation_date": 1554896813, "answer_id": 55611786, "question_id": 55611736, "link": "https://stackoverflow.com/questions/55611736/why-does-passing-right-values-through-pointers-results-in-segfault/55611786#55611786", "title": "Why does passing right values through pointers results in segfault?", "body": "<p>The strings pointed to by <code>str1</code> and <code>str2</code> are <em>read-only</em>.</p>\n\n<p>The behaviour on attempting to change their contents is <em>undefined</em>.</p>\n\n<p>Use <code>char str1[] = \"I like pizza!\";</code> &amp;c. instead, which copies the <em>read-only</em> string to <code>str1[]</code>, which you are then free to modify.</p>\n"}], "owner": {"reputation": 1, "user_id": 11340045, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xsyhHJSAbFw/AAAAAAAAAAI/AAAAAAAAAAc/jut_0_-9A_k/photo.jpg?sz=128", "display_name": "Benson", "link": "https://stackoverflow.com/users/11340045/benson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1554896866, "answer_count": 2, "score": 0, "last_activity_date": 1554896813, "creation_date": 1554896659, "question_id": 55611736, "link": "https://stackoverflow.com/questions/55611736/why-does-passing-right-values-through-pointers-results-in-segfault", "closed_reason": "Duplicate", "title": "Why does passing right values through pointers results in segfault?", "body": "<p>Im currently teaching myself c, and during exercising pointers use I bumped into this problem-\nI'm trying to replace a substring in a string that is pointed to (meaning,not a char array), with a substring from another pointed string.</p>\n\n<pre><code>char *str1=\"I like pizza!\";\nchar *str2=\"love\";\n\n    printf(\"%s\\n\", str1);\n\nfor (int i=2, j=0; j&lt;4; i++, j++) { \n    *(str1+i)=*(str2+j); \n}\n\n    printf(\"%s\\n\", str1);\n</code></pre>\n\n<p>Result should be- the way I see it- output of \"I like pizza\", followed by output of \"I love pizza\".\nInstead, I get a segfault (error 139).\nI scraped the web for a solution but couldn't find what is the problem.</p>\n\n<p>(I am aware that the for loop is not perfect, to say the least, but that's not the issue here).\nPlease help me out :)</p>\n"}, {"tags": ["c", "montecarlo"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7967633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd11a750c328956ccc0a117cf48526f?s=128&d=identicon&r=PG&f=1", "display_name": "deadlock896", "link": "https://stackoverflow.com/users/7967633/deadlock896"}, "edited": false, "score": 0, "creation_date": 1554911874, "post_id": 55612938, "comment_id": 97926926, "body": "I have solved the original issue now but please could you explain alignment and padding?"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "reply_to_user": {"reputation": 1, "user_id": 7967633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd11a750c328956ccc0a117cf48526f?s=128&d=identicon&r=PG&f=1", "display_name": "deadlock896", "link": "https://stackoverflow.com/users/7967633/deadlock896"}, "edited": false, "score": 0, "creation_date": 1554912543, "post_id": 55612938, "comment_id": 97927293, "body": "Padding won&#39;t be an issue for this because you are using double floating point values but i&#39;ll explain. If you have a structure with say 3 characters in it (24 bits total). There will likely be some padding to align the data to 32-bits depending on the machine. so your 24-bit structure could take up 32 bits in memory, create a 1M array of these and you have lots of wasted memory due to alignment and padding. If you had arrays of characters, there is no need to pad or align. In your case you are using double floating point values each taking up 64-bits (depending on your machine), no padding"}, {"owner": {"reputation": 1, "user_id": 7967633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd11a750c328956ccc0a117cf48526f?s=128&d=identicon&r=PG&f=1", "display_name": "deadlock896", "link": "https://stackoverflow.com/users/7967633/deadlock896"}, "edited": false, "score": 0, "creation_date": 1554913132, "post_id": 55612938, "comment_id": 97927599, "body": "Thank you for explaining. Why is there no need to pad or align arrays of characters?"}, {"owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "reply_to_user": {"reputation": 1, "user_id": 7967633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd11a750c328956ccc0a117cf48526f?s=128&d=identicon&r=PG&f=1", "display_name": "deadlock896", "link": "https://stackoverflow.com/users/7967633/deadlock896"}, "edited": false, "score": 0, "creation_date": 1554914586, "post_id": 55612938, "comment_id": 97928353, "body": "Because the array is a contiguous block of memory representing characters, one unit of memory, it might need some padding at the end of the array to make sure it is aligned properly. In the case of structures each structure is represented by a unit of memory that should be aligned. Does that make sense?"}], "tags": [], "owner": {"reputation": 366, "user_id": 10577318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc93415382d6c6fae2c364de090c6c76?s=128&d=identicon&r=PG&f=1", "display_name": "liamcomp", "link": "https://stackoverflow.com/users/10577318/liamcomp"}, "is_accepted": false, "score": 1, "last_activity_date": 1554901047, "last_edit_date": 1554901047, "creation_date": 1554900366, "answer_id": 55612938, "question_id": 55611492, "link": "https://stackoverflow.com/questions/55611492/monte-carlo-integration-returning-incorrect-values-problem-overwriting-memory/55612938#55612938", "title": "Monte Carlo integration returning incorrect values, problem overwriting memory", "body": "<p>First note, when possible it generally best to reduce the number of heap allocations and leave variables on the stack, less room for error. I'd say if you want <code>1M x 3 x sizeof(double)</code> bytes, arround 24M, it is best to dynamically allocate it on the heap. We can leave the structure that holds these on the stack.</p>\n\n<p>Another thing is when you create a variable, you don't need to create another variable to point to it, just use the original variable.</p>\n\n<p>Last note is commenting, I personally comment every line of code but that may be to much here. I find it helpful to write out what exactly you are trying to do with each line of code to help find bugs.</p>\n\n<p>You don't need to return pointers anywhere here i don't think, perhaps when you were passing pointer to a pointer it would have been better to just return a pointer. An array of structures is another way of doing it, it means only one malloc and one free but alignment could cause extra memory to be used (padding) which could be considerable when using 1M points, there likely won't be any padding here tho because you are using double floating points. I think your arrays are fine.</p>\n\n<p>I made some changes with the way you are using pointers, this likely won't solve your problem but it at least cleans things up a bit.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#define DIM 1000000\n\ntypedef struct Domain_t {\n    double *x;\n    double *y;\n    double *z;\n} Domain;\n\ntypedef struct Volume_t {\n    int R;\n    int r;\n    int lower_x;\n    int upper_x;\n    int lower_y;\n    int upper_y;\n    int lower_z;\n    int upper_z;\n    int V;\n} Volume;\n\n\ndouble random_double() {\n    static const int a = 16807;\n    static const int c = 0;\n    static const long long m = 2147483647;\n    static long long seed = 1;\n    seed = (a * seed + c) % m;\n    return ((double) seed) / m;\n}\n\n\nvoid constructDomain(Domain *p_domain) {\n\n    p_domain-&gt;x = malloc(DIM * sizeof(double));\n    if (p_domain-&gt;x == NULL) {\n        printf(\"ERROR: Memory allocation failed\\n\");\n    }\n\n    p_domain-&gt;y = malloc(DIM * sizeof(double));\n    if (p_domain-&gt;y == NULL) {\n        printf(\"ERROR: Memory allocation failed\\n\");\n    }\n\n    p_domain-&gt;z = malloc(DIM * sizeof(double));\n    if(p_domain-&gt;z == NULL) {\n        printf(\"ERROR: Memory allocation failed\\n\");\n    }\n}\n\nvoid delDomain (Domain *p_domain) {\n    if (p_domain != NULL) {\n        free (p_domain-&gt;z);\n        free (p_domain-&gt;y);\n        free (p_domain-&gt;x);\n    }\n}\n\ndouble radiusFunc(double point_x, double point_y) {\n    return sqrt(pow(point_x,2)+pow(point_y,2));\n}\n\ndouble G(double point_x, double point_y, double point_z, int R) {\n    return pow(point_z,2)+pow(radiusFunc(point_x,point_y)-(double)R,2);\n}\n\n\nvoid setVolume(Volume *p_volume, int R, int r, int x1, int x2, int y1, int y2, int z1, int z2) {\n    p_volume-&gt;R = R;\n    p_volume-&gt;r = r;\n    p_volume-&gt;lower_x = x1;\n    p_volume-&gt;upper_x = x2;\n    p_volume-&gt;lower_y = y1;\n    p_volume-&gt;upper_y = y2;\n    p_volume-&gt;lower_z = z1;\n    p_volume-&gt;upper_z = z2;\n    if(z1 == 0 &amp;&amp; z2 == 0)\n        p_volume-&gt;V = (x2-x1)*(y2-y1);\n    else if(y1 == 0 &amp;&amp; y2 == 0)\n        p_volume-&gt;V = (x2-x1)*(z2-z1);\n    else if(x1 == 0 &amp;&amp; x2 == 0)\n        p_volume-&gt;V = (y2-y1)*(z2-z1);\n    else\n        p_volume-&gt;V = (x2-x1)*(y2-y1)*(z2-z1);\n}\n\nvoid setInitialDomain(Domain *p_domain) {\n    int i;\n    for(i=0;i&lt;DIM;i++) {\n        p_domain-&gt;x[i] = random_double();\n        p_domain-&gt;y[i] = random_double();\n        p_domain-&gt;z[i] = random_double();\n    }\n}\n\nvoid setRandomDomain(Domain *p_domain, Domain *p_new_domain, Volume *p_volume) {\n    int i;\n    for(i=0;i&lt;DIM;i++) {\n        p_new_domain-&gt;x[i] = p_domain-&gt;x[i] * (double) (p_volume-&gt;upper_x - p_volume-&gt;lower_x) + (double) p_volume-&gt;lower_x;\n        p_new_domain-&gt;y[i] = p_domain-&gt;y[i] * (double) (p_volume-&gt;upper_y - p_volume-&gt;lower_y) + (double) p_volume-&gt;lower_y;\n        p_new_domain-&gt;z[i] = p_domain-&gt;z[i] * (double) (p_volume-&gt;upper_z - p_volume-&gt;lower_z) + (double) p_volume-&gt;lower_z;\n    }\n}\n\ndouble setIntegrand(Domain (*p_domain), char c) {\n    double *p_x = p_domain-&gt;x;\n    double *p_y = p_domain-&gt;y;\n    double *p_z = p_domain-&gt;z;\n    if(c=='x')\n        return *p_x;\n    else if(c=='y')\n        return *p_y;\n    else if(c=='z')\n        return *p_z;\n    else\n        return 1.0;\n}\n\ndouble calculateIntegral(Domain *p_domain, Volume *p_volume, char c) {\n    int i;\n    double F = 0.0;\n    for(i=0;i&lt;DIM;i++) {\n        if(G(p_domain-&gt;x[i], p_domain-&gt;y[i], p_domain-&gt;z[i], p_volume-&gt;R)&lt;=(double)p_volume-&gt;r) {\n            F += setIntegrand(p_domain, c);\n        }\n    }\n    return F * (double) p_volume-&gt;V / (double)DIM;\n}\n\nint main() {\n    Domain initial_domain;\n    Domain random_domain;\n    Volume circle;\n    Volume torus;\n\n    /* memory allocation */\n    constructDomain(&amp;initial_domain);\n    constructDomain(&amp;random_domain);\n\n    /* initialization */\n    setInitialDomain(&amp;initial_domain);\n\n    /* volume */\n    setVolume(&amp;circle,0,1,0,1,0,1,0,0);\n    setRandomDomain(&amp;initial_domain, &amp;random_domain, &amp;circle);\n\n    /* integral */\n    printf(\"PI/4 is approximately %f\\n\", calculateIntegral(&amp;random_domain, &amp;circle, 'p'));\n\n\n    setVolume(&amp;torus,3,1,1,4,-3,4,-1,1);\n    setRandomDomain(&amp;initial_domain, &amp;random_domain, &amp;torus);\n\n    double M = calculateIntegral(&amp;random_domain, &amp;torus, 'p');\n    double X = calculateIntegral(&amp;random_domain, &amp;torus, 'x');\n    double Y = calculateIntegral(&amp;random_domain, &amp;torus, 'y');\n    double Z = calculateIntegral(&amp;random_domain, &amp;torus, 'z');\n\n    printf(\"rho integral is approximately %f\\n\", M);\n    printf(\"x integral is approximately %f\\n\", X);\n    printf(\"y integral is approximately %f\\n\", Y);\n    printf(\"z integral is approximately %f\\n\", Z);\n    printf(\"Centre of mass is approximately (%f, %f, %f)\\n\", X/M, Y/M, Z/M);\n\n    delDomain(&amp;initial_domain);\n    delDomain(&amp;random_domain);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 3, "last_activity_date": 1554902093, "creation_date": 1554902093, "answer_id": 55613532, "question_id": 55611492, "link": "https://stackoverflow.com/questions/55611492/monte-carlo-integration-returning-incorrect-values-problem-overwriting-memory/55613532#55613532", "title": "Monte Carlo integration returning incorrect values, problem overwriting memory", "body": "<p>Your problem is that you call <code>setIntegrand</code> in a loop over all points, but you always take the first point:</p>\n\n<pre><code>double *p_x = p_domain-&gt;x;\n\n// ...\nreturn *p_x;\n</code></pre>\n\n<p>This returns the first <code>double</code> in your array. Remember that <code>*x</code> is equivalent to <code>x[0]</code>. Pass the index to the function:</p>\n\n<pre><code>double setIntegrand(Domain (*p_domain), char c, int i)\n{\n    if (c == 'x') return p_domain-&gt;x[i];\n    if (c == 'y') return p_domain-&gt;y[i];\n    if (c == 'z') return p_domain-&gt;z[i];\n    return 1.;\n}\n</code></pre>\n\n<p>and then call it with that index.</p>\n\n<pre><code>for (i = 0; i &lt; DIM; i++) {\n    if (G(...) &lt;= p_volume-&gt;r) {\n        F += setIntegrand(p_domain, c, i);\n    }\n}\n</code></pre>\n\n<p>As to your additional questions: Using an array of structs keeps the things that go together (here, the three coordinates of the points) nearby. You can also easily just pass a point to a function with a single argument.</p>\n\n<p>If you have a constructor, that is a function that creates a new thing by allocating on the heap and initialising the new memory, returning a pointer is a useful idiom. (I find it more idiomatic than passing a point to a pointer, but whoever designed to <code>fopen_s</code> function didn't think so.)</p>\n\n<p>Let's put both changes together:</p>\n\n<pre><code>typedef struct Point Point;\ntypedef struct Domain Domain;\n\nstruct Point {\n    double x;\n    double y;\n    double z;\n};\n\nstruct Domain {\n    size_t length;\n    Point *point;\n};\n\nDomain *constructDomain(size_t length)\n{\n    Domain *dom = malloc(sizeof(*dom));\n\n    if (dom) {\n        dom-&gt;length = length;\n        dom-&gt;point = calloc(length, sizeof(*dom-&gt;point));\n\n        // check success\n    }\n\n    return dom;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7967633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd11a750c328956ccc0a117cf48526f?s=128&d=identicon&r=PG&f=1", "display_name": "deadlock896", "link": "https://stackoverflow.com/users/7967633/deadlock896"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554902093, "creation_date": 1554895887, "question_id": 55611492, "link": "https://stackoverflow.com/questions/55611492/monte-carlo-integration-returning-incorrect-values-problem-overwriting-memory", "title": "Monte Carlo integration returning incorrect values, problem overwriting memory", "body": "<p>I'm having trouble calculating integrals for the centre of mass of a torus, which should return (2.4076, 0.16210, 0.0).</p>\n\n<p>The program works for an estimation of pi/4 however I think there is an issue when I try to overwrite existing points using the setRandomDomain() function.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#define DIM 1000000\n\ndouble random_double() {\n    static const int a = 16807;\n    static const int c = 0;\n    static const long long m = 2147483647;\n    static long long seed = 1;\n    seed = (a * seed + c) % m;\n    return ((double) seed) / m;\n}\n\ntypedef struct Domain_t {\n    double *x;\n    double *y;\n    double *z;\n} Domain;\n\nvoid constructDomain(Domain (**p_domain)) {\n    *p_domain = malloc(sizeof(Domain));\n    if(p_domain == NULL) {\n        printf(\"ERROR: Memory allocation failed\\n\");\n    }\n    (*p_domain)-&gt;x = malloc(DIM * sizeof(double));\n    if ((*p_domain)-&gt;x == NULL) {\n        printf(\"ERROR: Memory allocation failed\\n\");\n    }\n    (*p_domain)-&gt;y = malloc(DIM * sizeof(double));\n    if ((*p_domain)-&gt;y == NULL) {\n        printf(\"ERROR: Memory allocation failed\\n\");\n    }\n    (*p_domain)-&gt;z = malloc(DIM * sizeof(double));\n    if((*p_domain)-&gt;z == NULL) {\n        printf(\"ERROR: Memory allocation failed\\n\");\n    }\n}\n\nvoid delDomain (Domain (**p_domain)) {\n    if (p_domain != NULL) {\n        free ((*p_domain)-&gt;z);\n        free ((*p_domain)-&gt;y);\n        free ((*p_domain)-&gt;x);\n        free (*p_domain);\n    }\n}\n\ndouble radiusFunc(double point_x, double point_y) {\n    return sqrt(pow(point_x,2)+pow(point_y,2));\n}\n\ndouble G(double point_x, double point_y, double point_z, int R) {\n    return pow(point_z,2)+pow(radiusFunc(point_x,point_y)-(double)R,2);\n}\n\ntypedef struct Volume_t {\n    int R;\n    int r;\n    int lower_x;\n    int upper_x;\n    int lower_y;\n    int upper_y;\n    int lower_z;\n    int upper_z;\n    int V;\n} Volume;\n\nvoid setVolume(Volume (*p_volume), int R, int r, int x1, int x2, int y1, int y2, int z1, int z2) {\n    p_volume-&gt;R = R;\n    p_volume-&gt;r = r;\n    p_volume-&gt;lower_x = x1;\n    p_volume-&gt;upper_x = x2;\n    p_volume-&gt;lower_y = y1;\n    p_volume-&gt;upper_y = y2;\n    p_volume-&gt;lower_z = z1;\n    p_volume-&gt;upper_z = z2;\n    if(z1 == 0 &amp;&amp; z2 == 0)\n        p_volume-&gt;V = (x2-x1)*(y2-y1);\n    else if(y1 == 0 &amp;&amp; y2 == 0)\n        p_volume-&gt;V = (x2-x1)*(z2-z1);\n    else if(x1 == 0 &amp;&amp; x2 == 0)\n        p_volume-&gt;V = (y2-y1)*(z2-z1);\n    else\n        p_volume-&gt;V = (x2-x1)*(y2-y1)*(z2-z1);\n}\n\nvoid setInitialDomain(Domain (**p_domain)) {\n    int i;\n    for(i=0;i&lt;DIM;i++) {\n        (*p_domain)-&gt;x[i] = random_double();\n        (*p_domain)-&gt;y[i] = random_double();\n        (*p_domain)-&gt;z[i] = random_double();\n    }\n}\n\nvoid setRandomDomain(Domain (*p_domain), Domain (**p_new_domain), Volume (*p_volume)) { \n    int i;\n    for(i=0;i&lt;DIM;i++) {\n        (*p_new_domain)-&gt;x[i] = p_domain-&gt;x[i]*(double)(p_volume-&gt;upper_x - p_volume-&gt;lower_x) + (double)p_volume-&gt;lower_x;\n        (*p_new_domain)-&gt;y[i] = p_domain-&gt;y[i]*(double)(p_volume-&gt;upper_y - p_volume-&gt;lower_y) + (double)p_volume-&gt;lower_y;\n        (*p_new_domain)-&gt;z[i] = p_domain-&gt;z[i]*(double)(p_volume-&gt;upper_z - p_volume-&gt;lower_z) + (double)p_volume-&gt;lower_z;\n    }\n}\n\ndouble setIntegrand(Domain (*p_domain), char c) {\n    double *p_x = p_domain-&gt;x;\n    double *p_y = p_domain-&gt;y;\n    double *p_z = p_domain-&gt;z;\n    if(c=='x')\n        return *p_x;\n    else if(c=='y')\n        return *p_y;\n    else if(c=='z')\n        return *p_z;\n    else\n        return 1.;\n}\n\ndouble calculateIntegral(Domain (*p_domain), Volume (*p_volume), char c) {\n    int i;\n    double F = 0.;\n    for(i=0;i&lt;DIM;i++) {\n        if(G(p_domain-&gt;x[i], p_domain-&gt;y[i], p_domain-&gt;z[i], p_volume-&gt;R)&lt;=(double)p_volume-&gt;r) {\n            F += setIntegrand(p_domain, c);\n        }\n    }\n    return F*(double)p_volume-&gt;V/(double)DIM;\n}\n\nint main() {\n    Domain *p_initial_domain;\n    Domain *p_random_domain;\n\n    constructDomain(&amp;p_initial_domain);\n    printf(\"Point 1: successful\\n\");\n    constructDomain(&amp;p_random_domain);\n    printf(\"Point 2: successful\\n\");\n\n    setInitialDomain(&amp;p_initial_domain);\n\n    Volume circle, *p_circle;\n    p_circle = &amp;circle;\n    setVolume(p_circle,0,1,0,1,0,1,0,0);\n    setRandomDomain(p_initial_domain, &amp;p_random_domain, p_circle);\n\n    printf(\"PI/4 is approximately %f\\n\", calculateIntegral(p_random_domain, p_circle, 'p'));\n\n    Volume torus, *p_torus;\n    p_torus = &amp;torus;\n    setVolume(p_torus,3,1,1,4,-3,4,-1,1);\n    setRandomDomain(p_initial_domain, &amp;p_random_domain, p_torus);\n\n    double M = calculateIntegral(p_random_domain, p_torus, 'p');\n    double X = calculateIntegral(p_random_domain, p_torus, 'x');\n    double Y = calculateIntegral(p_random_domain, p_torus, 'y');\n    double Z = calculateIntegral(p_random_domain, p_torus, 'z');\n    printf(\"rho integral is approximately %f\\n\", M);\n    printf(\"x integral is approximately %f\\n\", X);\n    printf(\"y integral is approximately %f\\n\", Y);\n    printf(\"z integral is approximately %f\\n\", Z);\n    printf(\"Centre of mass is approximately (%f, %f, %f)\\n\", X/M, Y/M, Z/M);\n\n    delDomain(&amp;p_initial_domain);\n    delDomain(&amp;p_random_domain);\n\n// return pointers??\n// array of structs??\n\n    return 0;\n}\n\n</code></pre>\n\n<p>Currently outputs:</p>\n\n<pre><code>PI/4 is approximately 0.785436\nrho integral is approximately 22.101282\nx integral is approximately 22.101801\ny integral is approximately -45.953770\nz integral is approximately 11.298411\nCentre of mass is approximately (1.000023, -2.079235, 0.511211)\n</code></pre>\n\n<p>Any ideas how to solve this?</p>\n\n<p>Also, please can someone explain how I would use functions returning pointers and why it may be better to create an array of structs instead of a struct of arrays?</p>\n"}, {"tags": ["c", "arrays", "hash", "file-io", "strcmp"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554897578, "post_id": 55611365, "comment_id": 97918100, "body": "I&#39;m not sure I understand the problem. What variables are you trying to compare? Can&#39;t you use <code>sscanf(&quot;%2x&quot;)</code> to parse the hex value, then compare the numbers? Or <code>sprintf(&quot;%02x&quot;)</code> to convert the number to a string and then use <code>strcmp()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1554901534, "last_edit_date": 1554901534, "creation_date": 1554897794, "answer_id": 55612110, "question_id": 55611365, "link": "https://stackoverflow.com/questions/55611365/strcmp-unsigned-char-to-string-within-a-file/55612110#55612110", "title": "strcmp() unsigned char to string within a file", "body": "<p>Convert each pair of characters of the external string to an integer.</p>\n\n<pre><code>const char *external_string = \"2435CD76F...\";\nfor(i = 0; i &lt; SHA512_DIGEST_LENGTH; i++) {\n  //         v------------------------------------------------v Compound literal (C99) \n  if (strtol((char [3]){external_string[0], external_string[1]}, 0, 16) != data[i]) {\n    return Different;\n  }\n  external_string += 2;\n}\nreturn Same;\n</code></pre>\n\n<p>Insure <code>data</code> is  <code>unsigned char</code> or use <code>.... != (unsigned char) data[i]</code></p>\n"}], "owner": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554901534, "creation_date": 1554895477, "question_id": 55611365, "link": "https://stackoverflow.com/questions/55611365/strcmp-unsigned-char-to-string-within-a-file", "title": "strcmp() unsigned char to string within a file", "body": "<p>I need a method by which the output of this hash function can be compared to a string that resides within a separate file, however the output is usually defined as <code>printf(\"%02x\", c[i]);</code> (where the comment is). This format does not work for comparisons sake, and I'm unsure of how to adjust this format essentially. </p>\n\n<pre><code>            FILE *ftest=fopen(hashInBuf, \"rb\");\n            SHA512_Init (&amp;mdContext);\n            while ((bytes = fread (data, 1, 1024, ftest)) != 0)\n                SHA512_Update (&amp;mdContext, data, bytes);\n            SHA512_Final (c,&amp;mdContext);\n            if(access(hashOutBuf, F_OK) != -1){\n               for(i = 0; i &lt; SHA512_DIGEST_LENGTH; i++){\n                 //METHOD TO COMPARE WITH TO EXISTING HASH FILE (stored in seperate folder)\n               }\n            }\n</code></pre>\n\n<p>The string in the file is the output of this hash function (stored by using <code>fprintf(*file, \"%02x\", c[i]);</code>) - this residing where the comment is above. Thank you in advance. </p>\n"}, {"tags": ["c", "buffer"], "comments": [{"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 1, "creation_date": 1554895083, "post_id": 55611222, "comment_id": 97916626, "body": "What is the issue you are facing?"}, {"owner": {"reputation": 11, "user_id": 11108671, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kHCziQuNSbs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBCT2YdQqfksiBuBFWiWgwYo3cqA/mo/photo.jpg?sz=128", "display_name": "elvy", "link": "https://stackoverflow.com/users/11108671/elvy"}, "reply_to_user": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1554895729, "post_id": 55611222, "comment_id": 97917003, "body": "@MayurK As i know i should devide my window into two parts: <code>search_buf</code> and <code>lookahead</code>. Then i need  to <code>fread()</code> some data from a file to the window, i.e to the <code>lookahead</code> and then shit the window and fill <code>search_buf</code> up. I guess i get it wrong, and i need some info to clarify it."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1554900647, "post_id": 55611222, "comment_id": 97919956, "body": "I would suggest first you read about algorithm and get the clarity on the requirement. Otherwise it will be difficult to code. In the code you have shared there is no mention about <code>search_buf</code> or <code>lookahead</code>."}], "owner": {"reputation": 11, "user_id": 11108671, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kHCziQuNSbs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBCT2YdQqfksiBuBFWiWgwYo3cqA/mo/photo.jpg?sz=128", "display_name": "elvy", "link": "https://stackoverflow.com/users/11108671/elvy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554894995, "creation_date": 1554894995, "question_id": 55611222, "link": "https://stackoverflow.com/questions/55611222/how-to-use-sliding-window", "title": "How to use sliding window", "body": "<p>I'm making LZ77 compression algorithm and i can't understand how to implement sliding window, and how to write information to the buffer, and then shift it.\nI have some code </p>\n\n<pre><code>int encode(const char *infile_path, const char *outfile_path, unsigned sb_size, unsigned la_size)\n{\n    FILE *infile = NULL, *outfile = NULL;\n    if (bread_file(&amp;infile, infile_path) || bwrite_file(&amp;outfile, outfile_path)) {\n        return -1;\n    }\n\n    size_t win_size = sb_size + la_size;\n    char *window = malloc(sizeof * window * win_size);\n    if (window == NULL) {\n        fprintf(stderr, \"%s() error: Memory allocation failure!\\n\", __func__);\n        return -1;\n    }\n\n    size_t buf_size;\n    buf_size = fread(window + sb_size, sizeof(char), win_size - sb_size, infile);\n    if (feof(infile)) {\n        printf(\"EOF has been reached!\\n\");\n    }\n    else {\n        fprintf(stderr, \"%s() error: Couldn't read info from the file!\\n\\n\", __func__);\n        return -1;\n    }\n}\n</code></pre>\n\n<p>I'm stuck here. Could you advise any detailed information on this? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 3, "creation_date": 1554894114, "post_id": 55610770, "comment_id": 97916124, "body": "How do you call <code>createStack</code>?"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1554894404, "post_id": 55610770, "comment_id": 97916259, "body": "Try <code>sizeof(struct sNode)</code> instead of <code>sizeof(tNode)</code>. Ps. this is strange style define structure - <code>}TreeNode,*tNode;</code>"}, {"owner": {"reputation": 584, "user_id": 6126607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-M7A95EcwbBI/AAAAAAAAAAI/AAAAAAAABUk/-2I_B7N60vw/photo.jpg?sz=128", "display_name": "gabrielchl", "link": "https://stackoverflow.com/users/6126607/gabrielchl"}, "edited": false, "score": 0, "creation_date": 1554894713, "post_id": 55610770, "comment_id": 97916435, "body": "can you show us the error messages?"}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1554896064, "creation_date": 1554896064, "answer_id": 55611532, "question_id": 55610770, "link": "https://stackoverflow.com/questions/55610770/sequence-stack-and-structure-pointer/55611532#55611532", "title": "Sequence Stack and structure pointer", "body": "<p><code>tnode</code> is a type of a pointer to a structure</p>\n\n<p>So, when you use</p>\n\n<pre><code>S-&gt;data = (tNode*)malloc(sizeof(tNode ) * maxSize);\n</code></pre>\n\n<p>you are typecasting with <code>(tnode*)</code> you are using a pointer to pointer to structure. Also the size of the allocated memory will be the size of the pointer, not the size of the structure. In addition you should not typecast the result of your malloc calls.</p>\n\n<p>The typedef for your <code>Stack</code> is also using a pointer to pointer of structure. I guess this is not what you want for your application.</p>\n\n<p>You should use</p>\n\n<pre><code>typedef struct sNode {\n    TreeNode* data;\n    int top;\n    int maxSize;\n} sNode, *Stack;\n</code></pre>\n\n<p>Then you can allocate memory as</p>\n\n<pre><code>S-&gt;data = malloc(sizeof(TreeNode) * maxsize);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11339556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77587b10d0ef64fd1c3334e0f5c995d5?s=128&d=identicon&r=PG&f=1", "display_name": "tianhan", "link": "https://stackoverflow.com/users/11339556/tianhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554896064, "creation_date": 1554893551, "last_edit_date": 1554894690, "question_id": 55610770, "link": "https://stackoverflow.com/questions/55610770/sequence-stack-and-structure-pointer", "title": "Sequence Stack and structure pointer", "body": "<p>I want to write a binary tree traversal algorithm, to push the structure pointer of the binary tree node in the sequence stack, but when I apply for memory, I have a problem, that is, <code>S-&gt;data = (tNode*)malloc(sizeof(tNode ) * maxSize);</code> This sentence has a problem, every time the debugging is stopped in this block. But I don\\'t know what the correct solution is and ask for answers.</p>\n\n<pre><code>typedef struct TreeNode {\n    char data;\n    struct TreeNode *left;\n    struct TreeNode *right;\n} TreeNode, *tNode;\n\ntypedef struct sNode {\n    tNode* data;\n    int top;\n    int maxSize;\n} sNode, *Stack;\n\nStatus createStack(Stack S,int maxSize) {\n    S-&gt;data = (tNode*) malloc(sizeof(tNode) *maxSize);\n    S-&gt;top = -1;\n    S-&gt;maxSize = maxSize;\n    return OK;\n}\n</code></pre>\n"}, {"tags": ["c", "getopt-long"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554893451, "post_id": 55610476, "comment_id": 97915766, "body": "For the arguments you provided, what is the <i>expected</i> output?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554893770, "post_id": 55610476, "comment_id": 97915940, "body": "Look like you&#39;re invoking your program with arguments like <code>-delete</code> instead of <code>--delete</code> for some reason?"}, {"owner": {"reputation": 610, "user_id": 1273923, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1b228f50ab7d6a792f1ba24ebd11be33?s=128&d=identicon&r=PG", "display_name": "RKum", "link": "https://stackoverflow.com/users/1273923/rkum"}, "edited": false, "score": 0, "creation_date": 1554896337, "post_id": 55610476, "comment_id": 97917342, "body": "Correct Shawn. That was the mistake."}], "answers": [{"comments": [{"owner": {"reputation": 610, "user_id": 1273923, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1b228f50ab7d6a792f1ba24ebd11be33?s=128&d=identicon&r=PG", "display_name": "RKum", "link": "https://stackoverflow.com/users/1273923/rkum"}, "edited": false, "score": 0, "creation_date": 1555003850, "post_id": 55610852, "comment_id": 97967429, "body": "One more problem I am facing. Short option with single - does not work and option index always returns 0. I have to use -- to get the short options working. I mean I have to use --d dell --c ceat Should not short option work with one -?"}], "tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": true, "score": 1, "last_activity_date": 1554893783, "creation_date": 1554893783, "answer_id": 55610852, "question_id": 55610476, "link": "https://stackoverflow.com/questions/55610476/getopt-longs-longindex-always-0/55610852#55610852", "title": "getopt_long()&#39;s longindex always 0", "body": "<p>From your <code>argv[\u2026] = \u2026</code> output it seems like you\u2019re using long options incorrectly. Rather than invoke your program like this</p>\n\n<pre><code>/home/a.out -delete dell -create creat\n</code></pre>\n\n<p>Invoke it like this:</p>\n\n<pre><code>/home/a.out --delete dell --create creat\n</code></pre>\n\n<p>This will cause the index to be set correctly.</p>\n\n<p>Check the <a href=\"https://linux.die.net/man/3/getopt_long\" rel=\"nofollow noreferrer\"><code>getopt_long(3)</code> manpage</a>, section \u201cDescription\u201d, for details on how to use long options.</p>\n"}], "owner": {"reputation": 610, "user_id": 1273923, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1b228f50ab7d6a792f1ba24ebd11be33?s=128&d=identicon&r=PG", "display_name": "RKum", "link": "https://stackoverflow.com/users/1273923/rkum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 55610852, "answer_count": 1, "score": 0, "last_activity_date": 1554894037, "creation_date": 1554892742, "last_edit_date": 1554894037, "question_id": 55610476, "link": "https://stackoverflow.com/questions/55610476/getopt-longs-longindex-always-0", "title": "getopt_long()&#39;s longindex always 0", "body": "<p>In a C program I have to parse command line option for which I am using C function getopt_long() whose syntax is:</p>\n\n<pre><code>int getopt_long(int argc, char * const *argv, const char *optstring, const struct option *longopts, int *longindex);\n</code></pre>\n\n<p>Problem is I always receive the value of last parameter longindex as 0.</p>\n\n<p>Below is the sample code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;getopt.h&gt;\n\nstatic int verbose_flag;\n\nint\nmain (int argc, char **argv)\n{\n  int c;\n\nprintf(\"MAIN\\n\");\n    int i;\n    printf(\"argc = %d\\n\",argc);\n    for(i=0;i&lt;argc;i++)\n    {\n        printf(\"argv[%d] = %s\\n\",i, argv[i]);\n    }\n\n  while (1)\n    {\n      static struct option long_options[] =\n        {\n          {\"delete\",  required_argument, 0, 'd'},\n          {\"create\",  required_argument, 0, 'c'},\n          {\"file\",    required_argument, 0, 'f'},\n          {0, 0, 0, 0}\n        };\n\n      int option_index = 0;    \n      c = getopt_long (argc, argv, \"c:d:f:\",\n                       long_options, &amp;option_index);\n    printf(\"\\nOPT c = %d, option_index = %d START\\n\", c, option_index);\n\n      if (c == -1)\n      {\n          printf(\"BREAKKKKKKKKKKK\\n\");\n        break;\n        }\n\n      printf(\"OPTION FOUND c = %d, option_index = %d, long_options[option_index].name = %s\\n\", c, option_index, long_options[option_index].name);\n      switch (c)\n        {\n        case 0:\n          if (long_options[option_index].flag != 0)\n            break;\n          printf (\"option %s\", long_options[option_index].name);\n          if (optarg)\n            printf (\" with arg %s\", optarg);\n          printf (\"\\n\");\n          break;\n\n        case 'c':\n          printf (\"option -c with value `%s'\\n\", optarg);\n          break;\n\n        case 'd':\n          printf (\"option -d with value `%s'\\n\", optarg);\n          break;\n\n        case 'f':\n          printf (\"option -f with value `%s'\\n\", optarg);\n          break;\n\n        case '?':\n          break;\n\n        default:\n          abort ();\n        }\n    }\n\n  if (verbose_flag)\n    puts (\"verbose flag is set\");\n\n  if (optind &lt; argc)\n    {\n      printf (\"non-option ARGV-elements: \");\n      while (optind &lt; argc)\n        printf (\"%s \", argv[optind++]);\n      putchar ('\\n');\n    }\n\n  return (0);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>MAIN\nargc = 5\nargv[0] = /home/a.out\nargv[1] = -delete\nargv[2] = dell\nargv[3] = -create\nargv[4] = ceat\n\nOPT c = 100, option_index = 0 START\nOPTION FOUND c = 100, option_index = 0, long_options[option_index].name = delete\noption -d with value `elete'\n\nOPT c = 99, option_index = 0 START\nOPTION FOUND c = 99, option_index = 0, long_options[option_index].name = delete\noption -c with value `reate'\n\nOPT c = -1, option_index = 0 START\nBREAKKKKKKKKKKK\nnon-option ARGV-elements: dell ceat \n</code></pre>\n\n<p>Am I missing something?\nWhy do I always the value of last parameter longindex as 0?\nHow to rectify the issue?</p>\n"}, {"tags": ["c", "garbage-collection", "kotlin-native"], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1573258066, "post_id": 56380600, "comment_id": 103836238, "body": "When is garbage collection triggered in K/N? Does the compiler insert calls to <code>garbageCollect</code> when you try to allocate memory or when a stack frame is popped or something like this? Or is a thread created that manages garbage collection?"}, {"owner": {"reputation": 1995, "user_id": 11533773, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7AwO0.png?s=128&g=1", "display_name": "Artyom Degtyarev", "link": "https://stackoverflow.com/users/11533773/artyom-degtyarev"}, "reply_to_user": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1573562545, "post_id": 56380600, "comment_id": 103915255, "body": "Hi @KerrickStaley! As one can see in the code above, <code>garbageCollect()</code> is being called by the runtime in some operations(usually, with conditions check).  Also, maybe <a href=\"https://youtu.be/nw6YTfEyfO0\" rel=\"nofollow noreferrer\">this</a> video would be interesting fur you."}, {"owner": {"reputation": 809, "user_id": 785404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8bf1deae3ae41f560f3c2ce0dc732e?s=128&d=identicon&r=PG", "display_name": "Kerrick Staley", "link": "https://stackoverflow.com/users/785404/kerrick-staley"}, "edited": false, "score": 0, "creation_date": 1573757442, "post_id": 56380600, "comment_id": 103998353, "body": "Thanks! The video, along with a closer read of the Memory.cpp file, was helpful :)"}], "tags": [], "owner": {"reputation": 1995, "user_id": 11533773, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7AwO0.png?s=128&g=1", "display_name": "Artyom Degtyarev", "link": "https://stackoverflow.com/users/11533773/artyom-degtyarev"}, "is_accepted": true, "score": 10, "last_activity_date": 1559227738, "creation_date": 1559227738, "answer_id": 56380600, "question_id": 55610460, "link": "https://stackoverflow.com/questions/55610460/how-kotlin-native-garbage-collector-works-in-c/56380600#56380600", "title": "How Kotlin/Native garbage collector works in C?", "body": "<p>Memory Management in K/N is provided by the runtime. It consists of two main parts: automatic reference counting and cycle collector. This provides one with availability to write the code just as in the Kotlin/JVM. Some details on this topic can be found digging inside this <a href=\"https://github.com/JetBrains/kotlin-native/blob/master/runtime/src/main/cpp/Memory.cpp\" rel=\"noreferrer\">file</a> but all you need to know is that it is automatic by default.</p>\n\n<hr>\n\n<p>About MemScoped etc. When you use interoperability with C, you have to deal with managing such a resource as <em>native memory</em>. Native memory is the memory provided to the application process by the operating system. As it has nothing to do with the Kotlin code, this resource can't be managed by K/N runtime. But all C <code>struct</code> s and variables you are going to use must be allocated there. You can do it straight by calling <code>nativeHeap.alloc()</code> function. When the need of this memory is gone, it can be freed by <code>nativeHeap.free()</code>.\nBut to make your experience more comfortable, K/N also has <code>Arena</code> class, implementing region-based memory management. It simplifies memory management to just a series of <code>alloc()</code> wherever you need, and one deallocation by <code>.clear()</code> for all the region.\nAlso, there is a MemScoped {} blocks, that covers Arena from you, and lets to forget about even the freeing native memory. So in your code that includes some elements from C, you can just write <code>MemScoped { ... }</code>, and then put operations into it. You can see a lot of examples of this approach in the <a href=\"https://github.com/JetBrains/kotlin-native/tree/master/samples\" rel=\"noreferrer\">samples</a> from the K/N repository</p>\n"}], "owner": {"reputation": 1452, "user_id": 7804595, "user_type": "registered", "profile_image": "https://graph.facebook.com/1667139386646497/picture?type=large", "display_name": "Valeriy K.", "link": "https://stackoverflow.com/users/7804595/valeriy-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2231, "favorite_count": 3, "accepted_answer_id": 56380600, "answer_count": 1, "score": 12, "last_activity_date": 1559227738, "creation_date": 1554892693, "last_edit_date": 1554895448, "question_id": 55610460, "link": "https://stackoverflow.com/questions/55610460/how-kotlin-native-garbage-collector-works-in-c", "title": "How Kotlin/Native garbage collector works in C?", "body": "<p>I'm found some explanation of Kotlin/Native memory management model in <a href=\"https://github.com/JetBrains/kotlin-native/blob/master/FAQ.md\" rel=\"noreferrer\">JetBrains FAQ</a>. </p>\n\n<blockquote>\n  <p>A: Kotlin/Native provides an automated memory management scheme,\n  similar to what Java or Swift provides. The current implementation\n  includes an automated reference counter with a cycle collector to\n  collect cyclical garbage.</p>\n</blockquote>\n\n<p>I understand more or less how it works in Java or Kotlin (JVM). Can any describe detailed how memory is managed in Kotlin/Native in projects with C? </p>\n\n<p>Also, if there is the garbage collector, why do we need a Kotlin/Native function memScoped { }? </p>\n\n<p>Also, I found <a href=\"https://medium.com/androidiots/the-magic-of-kotlin-native-part-1-fad2795632b1\" rel=\"noreferrer\">here</a> : </p>\n\n<blockquote>\n  <p>Kotlin/Native is a technology for compiling Kotlin to native binaries that run without any VM.\n  Broadly speaking, Native code is any code whose memory is not managed by the underlying framework but has to be managed by the programmer themselves. i.e. there is no Garbage collection.\n  e.g. C++\u2019 delete and C\u2019s free</p>\n</blockquote>\n\n<p>which in my opinion contradicts what is written in JetBrains FAQ</p>\n"}, {"tags": ["c", "gcc", "llvm"], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1554892563, "post_id": 55610360, "comment_id": 97915256, "body": "Not quite in any order. Every ordering where <code>get_4()</code> happens before <code>get_3()</code> is not allowed."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1554892618, "post_id": 55610360, "comment_id": 97915291, "body": "Thanks @StoryTeller, I think I was editing while you commented"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1554892649, "post_id": 55610360, "comment_id": 97915305, "body": "It is not undefined behavior, it is unspecified behavior."}], "tags": [], "owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "is_accepted": false, "score": 5, "last_activity_date": 1554892988, "last_edit_date": 1554892988, "creation_date": 1554892405, "answer_id": 55610360, "question_id": 55610313, "link": "https://stackoverflow.com/questions/55610313/why-results-of-gcc-and-clang-are-different-with-following-code/55610360#55610360", "title": "Why results of GCC and Clang are different with following code?", "body": "<p>The <code>,</code> between <code>get_3()</code> and <code>get_4()</code> is the only sequence point in <code>printf(\"%d\\n\",get_1() + get_2() - (get_3(), get_4()));</code> the <code>get_x</code> calls can happen in any order defined by the compiler as long as <code>get_3()</code> happens before <code>get_4()</code>. </p>\n\n<p>You're seeing the result of unspecified behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": true, "score": 8, "last_activity_date": 1554893887, "last_edit_date": 1554893887, "creation_date": 1554892472, "answer_id": 55610384, "question_id": 55610313, "link": "https://stackoverflow.com/questions/55610313/why-results-of-gcc-and-clang-are-different-with-following-code/55610384#55610384", "title": "Why results of GCC and Clang are different with following code?", "body": "<p>C does not impose an order in evaluating operands of some operators.  The order of evaluation is imposed in C standard by <em>sequence points</em>.  When you have sequence points present, a sound implementation of the language must finish evaluating everything at the left of the sequence point before it starts evaluating what is present in the right side.  The <code>+</code> and <code>-</code> operators do not contain any sequence point. Here is the very definition from <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"noreferrer\">5.1.2.3 p2</a></p>\n\n<blockquote>\n  <p>At certain specified points in the execution sequence called sequence points,all side effects of  previous  evaluations  shall  be  complete  and  no  side  effects  of  subsequent  evaluations shall have taken place.</p>\n</blockquote>\n\n<p>In your expression </p>\n\n<pre><code>get_1() + get_2() - (get_3(), get_4())\n</code></pre>\n\n<p>you have the <code>+</code>, <code>-</code> and the comma <code>,</code> operator.  Only the comma imposes an order of evaluation, the <code>+</code> and <code>-</code> does not.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1554899318, "last_edit_date": 1592644375, "creation_date": 1554899318, "answer_id": 55612584, "question_id": 55610313, "link": "https://stackoverflow.com/questions/55610313/why-results-of-gcc-and-clang-are-different-with-following-code/55612584#55612584", "title": "Why results of GCC and Clang are different with following code?", "body": "<p>There's two different but related terms at play: <em>operator precedence</em> and <em>order of evaluation</em>.</p>\n<p>Operator precedence dictates parsing order:</p>\n<ul>\n<li><p>In your expression, the parenthesis has highest precedence so what's inside it belongs together.</p>\n</li>\n<li><p>Next we have the function call operators <code>()</code>. Nothing strange there, they are postfix and belong to their operator, the function name.</p>\n</li>\n<li><p>Next up we have binary <code>+</code> and <code>-</code> operators. They belong to the same operator group &quot;additive operators&quot; and have the same precedence. When this happens, <em>operator associativity</em> for operators of that group decides in which order they should be parsed.</p>\n<p>For additive operators, the operator associativity is left-to-right. Meaning that the expression is guaranteed to be parsed as <code>(get_1() + get_2()) - ...</code>.</p>\n</li>\n<li><p>And finally we have the oddball comma operator, with lowest precedence of all.</p>\n</li>\n</ul>\n<p>Once the operator precedence is sorted out as per above, we know which operands that belong to which operators. But this says nothing of in which order the expression will get executed. That is where order of evaluation comes in.</p>\n<p>Generally C says, in dry standard terms:</p>\n<blockquote>\n<p><em>Except as specified later, side effects and value computations of subexpressions are unsequenced.</em></p>\n</blockquote>\n<p>In plain English this means that the order of evaluation of operands is unspecified, for the most part, with some special exceptions.</p>\n<p>For the additive operators <code>+</code> and <code>-</code>, this is true. Given <code>a + b</code> we cannot know if <code>a</code> or <code>b</code> will get executed first. The order of evaluation is unspecified - the compiler may execute it in any order it pleases, need not document how, and need not even behave consistently from case to case.</p>\n<p>This is intentionally left unspecified by the C standard, to allow different compilers to parse expressions differently. Essentially allowing them to keep their expression tree algorithm a compiler trade secret, to allow some compilers to produce more effective code than others on a free market.</p>\n<p>And this is why gcc and clang give different results. You have written code that relies on the order of evaluation. This is no fault of either compiler - we should simply not write programs that relies on poorly-specified behavior. If you have to execute those functions in a certain order, you should split them up over several lines/expressions.</p>\n<p>As for the comma operator, it is one of the rare special cases. It comes with a built-in &quot;sequence point&quot; which guarantees that the left operand is always evaluated (executed) before the right. Other such special cases are <code>&amp;&amp; ||</code> operators and the <code>?:</code> operator.</p>\n"}], "owner": {"reputation": 11, "user_id": 8900028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bcd245b4a679ede725313dabd2ddc88?s=128&d=identicon&r=PG&f=1", "display_name": "Tao Yu", "link": "https://stackoverflow.com/users/8900028/tao-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 55610384, "answer_count": 3, "score": 0, "last_activity_date": 1554901543, "creation_date": 1554892262, "last_edit_date": 1554901543, "question_id": 55610313, "link": "https://stackoverflow.com/questions/55610313/why-results-of-gcc-and-clang-are-different-with-following-code", "title": "Why results of GCC and Clang are different with following code?", "body": "<p>I got different results for the following code with gcc and clang, I believe it is not a serious bug, but I wonder which result is more coherent with the standard? Thanks a lot for your reply.</p>\n\n<p>I use gcc (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0 and clang version 6.0.0-1ubuntu2 (tags/RELEASE_600/final)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\nint get_1(){\n        printf(\"get_1\\n\");\n        return 1;\n}\nint get_2(){\n        printf(\"get_2\\n\");\n        return 2;\n}\nint get_3(){\n        printf(\"get_3\\n\");\n        return 3;\n}\nint get_4(){\n        printf(\"get_4\\n\");\n        return 4;\n}\nint main(int argc, char *argv[])\n{\n        printf(\"%d\\n\",get_1() + get_2() - (get_3(), get_4()));\n        return 0;\n}\n</code></pre>\n\n<p>the result of gcc is</p>\n\n<pre><code>get_3\nget_1\nget_2\nget_4\n-1\n</code></pre>\n\n<p>and the result of clang is</p>\n\n<pre><code>get_1\nget_2\nget_3\nget_4\n-1\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1554891254, "post_id": 55609835, "comment_id": 97914537, "body": "It seems <code>length</code> is undefined in the second child since it\u2019s not set anywhere. Undefined behavior, might be zero if lucky so nothing is ever read from the pipe."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1554891367, "post_id": 55609835, "comment_id": 97914594, "body": "It&#39;s much easier to avoid this sort of problem if you split the parent and child code paths (after <code>fork</code>) into different functions. Having one big function with local variables declared at the top but initialized on only some code paths is always troublesome."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1554891558, "post_id": 55609835, "comment_id": 97914693, "body": "Oh, and if <code>read</code> returns -1, you should really try printing <code>errno</code>."}, {"owner": {"reputation": 43, "user_id": 11061571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GSdJcN7smyk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFURRK4f-d2UfHo6iP2DD8k9Twlw/mo/photo.jpg?sz=128", "display_name": "Max Colorado", "link": "https://stackoverflow.com/users/11061571/max-colorado"}, "edited": false, "score": 0, "creation_date": 1555002903, "post_id": 55609835, "comment_id": 97966993, "body": "Setting <code>length</code> for second child solved undefined behavior. Also I added two calls to <code>wait()</code> in parent process, so that now  program does not hang."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 11339106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb51e15873546048b3e9d6979e46f6e8?s=128&d=identicon&r=PG&f=1", "display_name": "tarekasis", "link": "https://stackoverflow.com/users/11339106/tarekasis"}, "is_accepted": true, "score": 0, "last_activity_date": 1554892324, "creation_date": 1554892324, "answer_id": 55610331, "question_id": 55609835, "link": "https://stackoverflow.com/questions/55609835/read-system-call-returns-1-when-reading-from-pipe-in-child-process/55610331#55610331", "title": "read system call returns -1 when reading from pipe in child process", "body": "<p>There are few things to take into account here. First thing i would like to point is that you do not need to use two fork() calls. In that case you have three processes working in parallel (parent process and two child process, one per each fork() call).</p>\n\n<p>One important point to take into account when you work with processes working in parallel is synchronism. In your code you are creating two processes. Parent process does not wait for any of its child, so it finishes its execution, and if child processes have not finished, they will become child of init process. But appart from that, you have the typical producer consumer problem. One of your child produce something and the other consume it, but how they work in parallel, consumer need to know that the product is ready to be consumed. So, in this case,  i think the easiest way to do this job is to use just one fork(), so child become the producer and the parent process (the consumer) wait until its child finish the job. </p>\n"}], "owner": {"reputation": 43, "user_id": 11061571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GSdJcN7smyk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFURRK4f-d2UfHo6iP2DD8k9Twlw/mo/photo.jpg?sz=128", "display_name": "Max Colorado", "link": "https://stackoverflow.com/users/11061571/max-colorado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 55610331, "answer_count": 1, "score": 2, "last_activity_date": 1554892771, "creation_date": 1554890588, "last_edit_date": 1554892771, "question_id": 55609835, "link": "https://stackoverflow.com/questions/55609835/read-system-call-returns-1-when-reading-from-pipe-in-child-process", "title": "read system call returns -1 when reading from pipe in child process", "body": "<p>To learn how Pipe IPC mechanism works, I wrote a simple program that creates two child processes which share data using a pipe. The first child process has to read data from a file and pass it to the pipe.</p>\n\n<p>Afterwards, the second child process has to read it, convert it to uppercase and write it to another file. The read system call in the second child process returns -1 when reading from the pipe. Also when I execute the program, in some cases <code>printf</code> in the first child does not print anything and in other cases <code>printf</code> in the second child does not print, too. Could you please point the mistakes in the program which are causing the problems?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(int args[], char * argv[]) {\n\n    int fd[2];\n\n    long length;\n    char buff1[250];\n    char buff2[250];\n\n    FILE * fptr1;\n    FILE * fptr2;\n\n    pid_t A, B;\n    pipe(fd);\n\n    A = fork();\n\n    if (A == -1) {\n        printf(\"error in fork of A\\n\");\n        exit(1);\n    }\n    if (A == 0) {\n        fptr1 = fopen(argv[1], \"r\"); // program receives file names as argument\n\n        if (fptr1 == NULL) {\n            printf(\"Erro in file open1\\n\");\n            exit(1);\n        }\n\n        fseek(fptr1, 0 L, SEEK_END);\n        length = ftell(fptr1);\n        fseek(fptr1, 0 L, SEEK_SET);\n\n        close(fd[0]);\n\n        fread(buff1, length, 1, fptr1);\n        buff1[length] = '\\0';\n        printf(\"buff1 = %s\", buff1);\n        write(fd[1], buff1, length);\n\n        fclose(fptr1);\n        exit(0);\n    } else {\n        B = fork();\n        if (B == -1) {\n            printf(\"Error in forking child B\");\n            exit(1);\n        }\n        if (B == 0) {\n            fptr2 = fopen(argv[2], \"w\");\n\n            if (fptr2 == NULL) {\n                printf(\"Error in file open2\\n\");\n                exit(1);\n            }\n\n            close(fd[1]);\n            int n = read(fd[0], buff2, length);\n            printf(\"n = %d\\n\", n);\n            upper_string(buff2); // converts characters to uppecase\n            fwrite(buff2, 1, length, fptr2);\n            fclose(fptr2);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "inline-assembly"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1554888535, "post_id": 55609106, "comment_id": 97912766, "body": "Are you sure your gcc is compiling for x86-64?  That code looks correct (but unnecessary; <a href=\"//stackoverflow.com/q/13772567\">Get CPU cycle count?</a>).  That error message would make sense for <code>gcc -m32</code> where a 64-bit integer couldn&#39;t fit in EAX."}, {"owner": {"reputation": 195, "user_id": 8727518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aCEjckwQYUk/AAAAAAAAAAI/AAAAAAAAAHU/_ibNhrQPhGo/photo.jpg?sz=128", "display_name": "Michael Kro\u010dka", "link": "https://stackoverflow.com/users/8727518/michael-kro%c4%8dka"}, "edited": false, "score": 0, "creation_date": 1554888724, "post_id": 55609106, "comment_id": 97912887, "body": "I want to write a prompt for my custom shell, it should look like &#39;16:34 user17@student#&#39; - 16:34 being time, user17 being username, @student being machine name"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1554890482, "post_id": 55609106, "comment_id": 97914043, "body": "Ok, again why asm?  And why <i>inline</i> asm instead of writing a whole function in a separate asm file?  Anyway, getting the right scale factor to scale TSC ticks to seconds is hard, and getting the right offset to map that to absolute time of day requires interaction with the OS.  It&#39;s vastly easier to ask the OS what time it is with <code>clock_gettime()</code>, which will internally use RDTSC in userspace without the performance hit of a system call.  You also need to decide <i>how</i> you want to get username and machine name, either from env vars or system calls; the CPU doesn&#39;t know about those."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 1, "creation_date": 1554890548, "post_id": 55609106, "comment_id": 97914102, "body": "Why are you complicating things? Why not just write C code and use proper POSIX functions or Linux system calls or whatever else is available?"}, {"owner": {"reputation": 195, "user_id": 8727518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aCEjckwQYUk/AAAAAAAAAAI/AAAAAAAAAHU/_ibNhrQPhGo/photo.jpg?sz=128", "display_name": "Michael Kro\u010dka", "link": "https://stackoverflow.com/users/8727518/michael-kro%c4%8dka"}, "edited": false, "score": 0, "creation_date": 1554890935, "post_id": 55609106, "comment_id": 97914347, "body": "I wanted to use inline assembly because I have found it as a possible solution, but seeing as Linux system calls are a possible solution as well, I will use those."}], "owner": {"reputation": 195, "user_id": 8727518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aCEjckwQYUk/AAAAAAAAAAI/AAAAAAAAAHU/_ibNhrQPhGo/photo.jpg?sz=128", "display_name": "Michael Kro\u010dka", "link": "https://stackoverflow.com/users/8727518/michael-kro%c4%8dka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554888318, "creation_date": 1554888318, "last_edit_date": 1592644375, "question_id": 55609106, "link": "https://stackoverflow.com/questions/55609106/inline-assembly-in-c-to-get-current-time-username-and-machine-name", "title": "Inline assembly in c to get current time, username and machine name", "body": "<p>I want to write a function for my custom shell which prints out the current time, username and machine name as a prompt. I want to do this using inline assembly in c on linux. So far my code is:</p>\n<pre><code>uint64_t msr;\nasm volatile ( &quot;rdtsc\\n\\t&quot;    // Returns the time in EDX:EAX.\n               &quot;shl $32, %%rdx\\n\\t&quot;  // Shift the upper bits left.\n               &quot;or %%rdx, %0&quot;        // 'Or' in the lower bits.\n               : &quot;=a&quot; (msr)\n               :\n               : &quot;rdx&quot;);\n</code></pre>\n<p>I have only gotten this far and not attempted to write code for username and machine name. The problem is this code doesn't want to compile using the gcc compiler, it prints an</p>\n<blockquote>\n<p>error: impossible register constraint in `asm'</p>\n<p>confused by earlier errors, bailing out</p>\n</blockquote>\n<p>I have found this code as an example here:\n<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#AssemblerTemplate\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#AssemblerTemplate</a></p>\n<p>The question is how can I write code in inline assembly to get me current time, username and machine name?</p>\n"}, {"tags": ["c", ".so"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 2, "creation_date": 1554887969, "post_id": 55608984, "comment_id": 97912386, "body": "Saying that you \u201cconvert\u201d .c files to .so files is really quite misleading. It\u2019s not simply a format conversion. They represent fundamentally different things. Otherwise a back-conversion would be trivial."}, {"owner": {"reputation": 2090, "user_id": 390562, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/126acfbb1d40fec651032a9fddcf95dc?s=128&d=identicon&r=PG", "display_name": "Timo", "link": "https://stackoverflow.com/users/390562/timo"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1554888223, "post_id": 55608984, "comment_id": 97912554, "body": "@KonradRudolph You forgot to mention what the &quot;conversion&quot; <i>is</i> called :)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1554888589, "post_id": 55608984, "comment_id": 97912797, "body": "If you don&#39;t want anyone to know what your code does, you can&#39;t give them the binary that actually does it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1554888749, "post_id": 55608984, "comment_id": 97912903, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5933057/how-to-extract-c-source-code-from-so-file\">How to extract C source code from .so file?</a>"}, {"owner": {"reputation": 523, "user_id": 3457384, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/04d45a6eed0465eb01c452865be0697f?s=128&d=identicon&r=PG&f=1", "display_name": "user3457384", "link": "https://stackoverflow.com/users/3457384/user3457384"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554888754, "post_id": 55608984, "comment_id": 97912907, "body": "@AndrewHenle, so what should be the right approach for giving the code, provided we don&#39;t have any other option rather than giving it and we also don&#39;t want the source code to be revealed."}, {"owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1554888867, "post_id": 55608984, "comment_id": 97912971, "body": "You can try to use <a href=\"https://www.hex-rays.com/products/decompiler/index.shtml\" rel=\"nofollow noreferrer\">a decompiler</a>, but because of reverse-translating of binary code to a higher level language has many different interpretations - resulting code is very mangled and can be used only for a initial study / overview of code structure before jumping to assembly."}, {"owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "edited": false, "score": 2, "creation_date": 1554888939, "post_id": 55608984, "comment_id": 97913013, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/193896/whats-a-good-c-decompiler\">What&#39;s a good C decompiler?</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1554893645, "post_id": 55608984, "comment_id": 97915879, "body": "You don&#39;t have to give them your code (barring license issues such as those from the GPL), but if you distribute binaries compiled from that code, whoever gets those binaries <b>WILL</b> be able to tell what your code does if they wish. If you give someone a binary that does something, whoever you give that binary too <b>WILL</b> be able to tell what it does. The <b>ONLY</b> way to keep what your code does a secret is to not distribute binaries compiled from it.  You can make it harder to figure out, but it&#39;s <b>IMPOSSIBLE</b> to keep secret. If your management doesn&#39;t like that, too bad. That&#39;s reality."}], "answers": [{"tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": false, "score": 13, "last_activity_date": 1554888088, "creation_date": 1554888088, "answer_id": 55609031, "question_id": 55608984, "link": "https://stackoverflow.com/questions/55608984/is-there-a-way-to-convert-so-file-into-c-file/55609031#55609031", "title": "Is there a way to convert .so file into .c file?", "body": "<p>You can\u2019t get the original C source file back, because that contains information that are simply not represented in the machine code inside a shared object (<code>.so</code>) file.</p>\n\n<p>However, object code can be <a href=\"https://en.wikipedia.org/wiki/Disassembler\" rel=\"noreferrer\">disassembled</a> into readable machine code, which an expert can understand. So the logic in your C code shouldn\u2019t be considered \u201csecret\u201d.</p>\n\n<p>There are methods of obfuscating code to make it harder to understand disassembled code but these methods have varying degree of effectiveness, and the more effective they are the more side-effects they carry (predominantly by making code execution a lot slower).</p>\n"}], "owner": {"reputation": 523, "user_id": 3457384, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/04d45a6eed0465eb01c452865be0697f?s=128&d=identicon&r=PG&f=1", "display_name": "user3457384", "link": "https://stackoverflow.com/users/3457384/user3457384"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1975, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1554899719, "creation_date": 1554887915, "last_edit_date": 1554888317, "question_id": 55608984, "link": "https://stackoverflow.com/questions/55608984/is-there-a-way-to-convert-so-file-into-c-file", "title": "Is there a way to convert .so file into .c file?", "body": "<p>I am writing a C program and I have converted it from <code>.c</code> to <code>.so</code> file using GCC. I was little curious to know if is there any way to convert back the <code>.so</code> file to <code>.c</code> file. </p>\n\n<p>Assume I am shipping my code to someone and it contains all the <code>.so</code> files. Is there a chance that someone can get access to my source code using any tool, editor, technique etc?</p>\n"}, {"tags": ["c", "tcp", "stm32", "lwip"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554888091, "post_id": 55608715, "comment_id": 97912454, "body": "<a href=\"https://stackoverflow.com\">Stack Overflow</a> is for programming questions, not questions about using or configuring Unix and its utilities. <a href=\"https://unix.stackexchange.com\">Unix & Linux</a> or <a href=\"https://superuser.com\">Super User</a> would be better places for questions like this."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554900548, "post_id": 55608715, "comment_id": 97919887, "body": "@Barmar what makes you think that this question is &quot;about using or configuring Unix and its utilities&quot; ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1554901192, "post_id": 55608715, "comment_id": 97920293, "body": "Maybe I misunderstood, but I thought you were trying to configure network interfaces on a machine."}, {"owner": {"reputation": 101, "user_id": 10155902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e766adb5b7df20c37bbbdcf2d44458ab?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/10155902/jack"}, "edited": false, "score": 0, "creation_date": 1554970276, "post_id": 55608715, "comment_id": 97947041, "body": "Hi Barmar, STM32H7 refers to ST ARM cortex MCU&#39;s. It is about an electronics board contain embedded software in the MCU&#39;s flash.However, I should also have mentioned the MCU is not running FreeRTOS (NOSYS), so I&#39;m using RAW API&#39;s."}], "owner": {"reputation": 101, "user_id": 10155902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e766adb5b7df20c37bbbdcf2d44458ab?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/10155902/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1596552120, "creation_date": 1554887201, "last_edit_date": 1554970316, "question_id": 55608715, "link": "https://stackoverflow.com/questions/55608715/how-to-isolate-trafic-for-two-netifs-in-lwip", "title": "How to isolate trafic for two netifs in LwIP", "body": "<p>I'm setting up an STM32H7 board with two networks interface ports (netifs).\nBoth are using the LwIP stack. The MCU is not running FreeRTOS (NOSYS), so I'm using RAW API's (callbacks) for LwIP.\nThe two ports have different MAC and IP addresses. Now I would like run a TCP server on one port and a TCP client on the other. So I need to separate the traffic for each port.\nIf I want to use them independent do I need two different instances of LwIP? I use Atollic TrueStudio and C as programming language, not C++.\nHow can I best do this?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 4838, "user_id": 956030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1093fec993109b46d2f20963e52718bc?s=128&d=identicon&r=PG", "display_name": "Zang MingJie", "link": "https://stackoverflow.com/users/956030/zang-mingjie"}, "edited": false, "score": 4, "creation_date": 1554886876, "post_id": 55608559, "comment_id": 97911749, "body": "if multiple signals come at the same time (next comes before previous has been handled), only one signal will be triggered. pending signal is a state not a count."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1554887291, "post_id": 55608559, "comment_id": 97912000, "body": "In addition to Zang\u2019s comment, you cannot write to a static <code>int</code> inside a signal handler invoked via <code>kill</code>, it\u2019s undefined behaviour. See <a href=\"https://en.cppreference.com/w/c/program/signal\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/program/signal</a>."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 11339106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb51e15873546048b3e9d6979e46f6e8?s=128&d=identicon&r=PG&f=1", "display_name": "tarekasis", "link": "https://stackoverflow.com/users/11339106/tarekasis"}, "is_accepted": false, "score": 3, "last_activity_date": 1554887957, "creation_date": 1554887957, "answer_id": 55608994, "question_id": 55608559, "link": "https://stackoverflow.com/questions/55608559/lost-signals-from-child-to-parent/55608994#55608994", "title": "Lost signals from child to parent", "body": "<p>The problem here is that a signal acts as a hardware interruption where your handler function would be the ISR (Interrupt Service Routine). Then if multiple signals of the same value happens \"at the same time\" linux kernel treat them as only one signal. Signal are not designed to be used in this manner. A signal should be used to inform of the state of a process to another. To achieve communications between processes you should use IPC (InterProcess Communications) mechanisms such as queue, sockets, or pipes.</p>\n"}, {"comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1554894154, "post_id": 55609928, "comment_id": 97916149, "body": "Is this the same code, just reformatted for no reason?"}], "tags": [], "owner": {"reputation": 1, "user_id": 11288454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJ3La.jpg?s=128&g=1", "display_name": "GOBI", "link": "https://stackoverflow.com/users/11288454/gobi"}, "is_accepted": false, "score": -1, "last_activity_date": 1554890974, "creation_date": 1554890974, "answer_id": 55609928, "question_id": 55608559, "link": "https://stackoverflow.com/questions/55608559/lost-signals-from-child-to-parent/55609928#55609928", "title": "Lost signals from child to parent", "body": "<p>it was working..</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint ended = 0;\n\nvoid handler(int sig)\n{\n    ended++;\n}\n\n    int main(int argc, char **argv)\n    {\n        int i;\n        pid_t pid, ppid;\n\n        if (signal(SIGUSR1, handler) &lt; 0)\n        {\n            fprintf(stderr, \"signal failed.\\n\");\n            exit (-1);\n        }\n\n        ppid = getpid();\n\n        for (i = 0; i &lt; 50; i++)\n        {\n            if ((pid = fork()) &lt; 0)\n            {\n                fprintf(stderr, \"fork failed.\\n\");\n                exit(-1);\n            }\n            if (pid == 0)\n            {\n                kill(ppid, SIGUSR1);\n                exit(0);\n            }\n        }\n\n        while (wait(NULL) &gt; 0);\n\n        printf(\"ended = %d\\n\", ended);\n\n        return 0;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 441, "user_id": 1857487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYGoL.png?s=128&g=1", "display_name": "mjaque", "link": "https://stackoverflow.com/users/1857487/mjaque"}, "is_accepted": false, "score": 1, "last_activity_date": 1555052465, "creation_date": 1555052465, "answer_id": 55646159, "question_id": 55608559, "link": "https://stackoverflow.com/questions/55608559/lost-signals-from-child-to-parent/55646159#55646159", "title": "Lost signals from child to parent", "body": "<p>Thanks,</p>\n\n<p>I found the problem can be solved using Real Time Signals. Just changing SIGUSR1 with SIGRTMIN. Real Time Signals are queued (<a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man7/signal.7.html</a>).</p>\n\n<p>Are there any negative side effects in this solution? </p>\n"}], "owner": {"reputation": 441, "user_id": 1857487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYGoL.png?s=128&g=1", "display_name": "mjaque", "link": "https://stackoverflow.com/users/1857487/mjaque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1555052465, "creation_date": 1554886669, "last_edit_date": 1554888911, "question_id": 55608559, "link": "https://stackoverflow.com/questions/55608559/lost-signals-from-child-to-parent", "title": "Lost signals from child to parent", "body": "<p>I'm creating several child processes which send a signal to their parent process and die. I simply count them. But I never get the right count. Some signals never get caught by the handler.</p>\n\n<p>How should I code this?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt; \n#include &lt;sys/wait.h&gt;\n\nint ended = 0;\n\nvoid handler(int sig){\n    ended++;\n}\n\nint main(int argc, char **argv){\n    int i;\n    pid_t pid, ppid;\n\n    if (signal(SIGUSR1, handler) &lt; 0) {\n        fprintf(stderr, \"signal failed.\\n\");\n        exit (-1);\n    }\n\n    ppid = getpid();\n\n    for (i = 0; i &lt; 50; i++){\n        if ((pid = fork()) &lt; 0){\n            fprintf(stderr, \"fork failed.\\n\");\n            exit(-1);\n        }\n        if (pid == 0){  \n            kill(ppid, SIGUSR1);\n            exit(0);\n        }       \n    }\n\n    while (wait(NULL) &gt; 0);\n\n    printf(\"ended = %d\\n\", ended);\n\n    return 0;\n} \n</code></pre>\n\n<p>The output for this program is sometimes 47, others 39... but never 50</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 8, "creation_date": 1554884314, "post_id": 55607779, "comment_id": 97910309, "body": "You are confusing representation of a value with the value itself. Operators work on values. It does not matter if they are represented as octal, decimal or hexadecimal numbers."}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1554884494, "post_id": 55607779, "comment_id": 97910394, "body": "compile the code on your PC and use a debugger"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1554884498, "post_id": 55607779, "comment_id": 97910397, "body": "I guess <code>PORTC</code> is some hardware register. Are you sure they are readable and writeable? You should check what you read before your <code>if</code> sequence and what value you have in <code>tmpc</code> before you write it."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1554884680, "post_id": 55607779, "comment_id": 97910486, "body": "You might also verify that your <code>setbit</code> function returns correct values. To be on safe side I would add brackets around the expressions left and right of the <code>:</code>"}, {"owner": {"reputation": 105, "user_id": 11103289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cef5d6b74095dc43083e3beb36838dc?s=128&d=identicon&r=PG&f=1", "display_name": "Code4life", "link": "https://stackoverflow.com/users/11103289/code4life"}, "edited": false, "score": 0, "creation_date": 1554885362, "post_id": 55607779, "comment_id": 97910857, "body": "PORTC is a register than you can write to and the setbit function was from the lab instructions. I also used a debugger to determine that PORTC had all zeros."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1554886675, "post_id": 55607779, "comment_id": 97911619, "body": "Your body contains no question, and the answer to the title is clearly &quot;yes&quot; - the answer does not solve your problem.  You are asking the wrong question, an X-Y question; you should really ask why your calls to <code>setBit()</code> do not modify the argument.  Hexadecimal is merely a representation in the source code for human readability, at the machine binary level it is just an integer, the machine knows nothing about hex, decimal or octal."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 11103289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cef5d6b74095dc43083e3beb36838dc?s=128&d=identicon&r=PG&f=1", "display_name": "Code4life", "link": "https://stackoverflow.com/users/11103289/code4life"}, "edited": false, "score": 0, "creation_date": 1554888459, "post_id": 55608336, "comment_id": 97912707, "body": "super basic coding error and it works now, thanks for pointing it out"}], "tags": [], "owner": {"reputation": 31, "user_id": 9262362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b7d1c300209ddc264e501eaac1196e?s=128&d=identicon&r=PG&f=1", "display_name": "Anders Dellien", "link": "https://stackoverflow.com/users/9262362/anders-dellien"}, "is_accepted": false, "score": 3, "last_activity_date": 1554885971, "creation_date": 1554885971, "answer_id": 55608336, "question_id": 55607779, "link": "https://stackoverflow.com/questions/55607779/can-i-use-logical-operators-for-hexadecimal-comparisons/55608336#55608336", "title": "Can I use logical operators for hexadecimal comparisons?", "body": "<p>The problem is that the return value of <code>SetBit</code> is discarded.\nTry changing the calls to this function as follows:</p>\n\n<pre><code>    SetBit(tmpc,0,1); //less than or equal to 15\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    tmpc = SetBit(tmpc,0,1); //less than or equal to 15\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384, "user_id": 11118595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/452a70844d7a8347bfb91edfb2ca4f26?s=128&d=identicon&r=PG&f=1", "display_name": "snus74", "link": "https://stackoverflow.com/users/11118595/snus74"}, "is_accepted": false, "score": 2, "last_activity_date": 1554886655, "creation_date": 1554886655, "answer_id": 55608557, "question_id": 55607779, "link": "https://stackoverflow.com/questions/55607779/can-i-use-logical-operators-for-hexadecimal-comparisons/55608557#55608557", "title": "Can I use logical operators for hexadecimal comparisons?", "body": "<p>You can definetely use logical operators on hexadecimal values. It makes no difference whether the representaton is binary , hex or decimal. For your compiler it is an 8 bit value.</p>\n\n<p>Regarding your example:\ntmpa is 0x0F so only last if condition is verified. At this line tmpc is equal to 0x00 (after initialization). When passing through <code>SetBit(tmpc,0,1))</code> The condition will evaluate to true (b = 1) and the function will return <code>x | (0x01 &lt;&lt; k</code> which in this case is equal to 0x01. \ntmpc is equal to 0x00 at the end (its initial value) because you are not assigning it to the return value of your SetBit function!\nTry this : </p>\n\n<pre><code>if (tmpa &lt;= 0x0F)\n    tmpc = SetBit(tmpc,0,1); //less than or equal to 15\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1554888586, "last_edit_date": 1554888586, "creation_date": 1554887252, "answer_id": 55608733, "question_id": 55607779, "link": "https://stackoverflow.com/questions/55607779/can-i-use-logical-operators-for-hexadecimal-comparisons/55608733#55608733", "title": "Can I use logical operators for hexadecimal comparisons?", "body": "<p>Yes you can use logical operators, but this code is needlessly slow and complicated. You don't need branches or comparisons, all you need is a look-up table with 16 values.</p>\n\n<pre><code>const uint8_t VAL [0x10] =\n{\n  [0x00] = 1u&lt;&lt;5 | 1u&lt;&lt;6,\n  [0x01] = 1u&lt;&lt;5 | 1u&lt;&lt;6,\n  [0x02] = 1u&lt;&lt;5 | 1u&lt;&lt;6,\n  [0x03] = 1u&lt;&lt;4 | 1u&lt;&lt;6,\n  [0x04] = 1u&lt;&lt;4 | 1u&lt;&lt;6,\n  // ... up to 0x0F\n};\n\ntmpc = VAL[tmpa &amp; 0xF];\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11103289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cef5d6b74095dc43083e3beb36838dc?s=128&d=identicon&r=PG&f=1", "display_name": "Code4life", "link": "https://stackoverflow.com/users/11103289/code4life"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1554888586, "creation_date": 1554884064, "question_id": 55607779, "link": "https://stackoverflow.com/questions/55607779/can-i-use-logical-operators-for-hexadecimal-comparisons", "title": "Can I use logical operators for hexadecimal comparisons?", "body": "<p>I need to set PORTC to the temporary variable that is modified through a bunch of if statements, but the bit sequence assigned to PORTC at the very end are all zeroes so I assume that none of the expressions in the if statements were evaluated to true where I test whether the bit sequence is less than or equal to the hexadecimal. </p>\n\n<pre><code>#include &lt;avr/io.h&gt;\n\nunsigned char GetBit(unsigned char x, unsigned char k) {\n    return ((x &amp; (0x01 &lt;&lt; k)) != 0);\n}\n\nunsigned char SetBit(unsigned char x, unsigned char k, unsigned char b) {\n    return (b ? x | (0x01 &lt;&lt; k) : x &amp; ~(0x01 &lt;&lt; k));\n}\n\n\nint main(void)\n{\n    /* Replace with your application code */\n    DDRA = 0x00; PORTA = 0x0F; \n    DDRC = 0xFF; PORTC = 0x00;\n    unsigned char tmpa = 0x00;\n    unsigned char tmpc = 0x00;\n\n    tmpa = tmpa | PORTA;\n    tmpc = tmpc | PORTC;\n\n    while (1)\n    {\n        if (tmpa &lt;= 0x02) //less than or equal to 2\n        {\n            SetBit(tmpc, 5, 1);\n            SetBit(tmpc, 6, 1);\n        }\n        if (tmpa &lt;= 0x04) //less than or equal to 4 \n        {\n            SetBit(tmpc, 4, 1);\n            SetBit(tmpc, 6, 1);\n        }\n        if (tmpa &lt;= 0x06) //less than or equal to 6\n        SetBit(tmpc, 3, 1);\n        if (tmpa &lt;= 0x09) //less than or equal to 9\n        SetBit(tmpc,2,1);\n        if (tmpa &lt;= 0x0C)\n        SetBit(tmpc,1,1); //less than or equal to 12\n        if (tmpa &lt;= 0x0F)\n        SetBit(tmpc,0,1); //less than or equal to 15\n\n        PORTC = PORTC | tmpc; ////////PORTC ends up being all zeros\n        asm(\"break\");\n    }\n}\n\n\n</code></pre>\n"}, {"tags": ["c", "string", "printing", "terminal", "printf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554884079, "post_id": 55607756, "comment_id": 97910185, "body": "What have you tried? How did your attempts work or not work?"}, {"owner": {"reputation": 562, "user_id": 6572223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/552385f28bdeadfcd7cf5c0d493adb5b?s=128&d=identicon&r=PG", "display_name": "\u30ef\u30a4\u304d\u3093\u3050", "link": "https://stackoverflow.com/users/6572223/%e3%83%af%e3%82%a4%e3%81%8d%e3%82%93%e3%81%90"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554884170, "post_id": 55607756, "comment_id": 97910235, "body": "the standard stuff with %g and %f, and reading through the manual page for printf I didn&#39;t see anything regarding this matter."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554885182, "post_id": 55607756, "comment_id": 97910743, "body": "This is really hard, if not impossible, since there&#39;s really no way to tell how many decimals a floating-point value really have."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1554885662, "last_edit_date": 1554885662, "creation_date": 1554885180, "answer_id": 55608111, "question_id": 55607756, "link": "https://stackoverflow.com/questions/55607756/at-least-one-decimal-after-dot-with-printf-in-c/55608111#55608111", "title": "At least one decimal after dot with printf in C", "body": "<p>If I understand your question correctly, You want <code>5.0</code> to print as <code>5.0</code>, <code>5.10</code> to print as <code>5.1</code> and <code>5.15</code> to print as <code>5.15</code>...</p>\n\n<p>There is no simple way to achieve this with <code>printf</code> because the problem is not so simple: <code>5.10</code> is represented in C as a <code>double</code> with a binary encoded fractional part that is an approximation of <code>5.1</code>, not an exact representation. If you print it with enough decimals, you will see that it stops producing trailing zeroes:</p>\n\n<pre><code>    printf(\"%.23f\", 5.10) -&gt; 5.09999999999999999991326\n</code></pre>\n\n<p>So your question should be:</p>\n\n<blockquote>\n  <p>How to print a floating point number with at least <code>n</code> but at most <code>p</code> decimals, eliding trailing zeroes?</p>\n</blockquote>\n\n<p>This can be achieved by passing <code>p</code> as the precision field of <code>%f</code> in <code>sprintf</code> and running a loop to remove the trailing zeroes beyond <code>n</code> and trailing period if <code>n</code> is <code>0</code>.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint print_double(double value, int n, int p) {\n    char buf[400];\n    int dot;\n    int len;\n    len = snprintf(buf, sizeof buf, \"%.*f\", p, value);\n    if (len &gt;= (int)sizeof(buf)) {\n        printf(\"value too large: %g\\n\", value);\n        return -1;\n    }\n    for (dot = 0; dot &lt; len;) {\n        if (buf[dot++] == '.')\n            break;\n    }\n    while (len - dot &gt; n &amp;&amp; buf[len - 1] == '0')\n        len--;\n    if (len &gt; 0 &amp;&amp; buf[len - 1] == '.')\n        len--;\n    buf[len] = '\\0';\n    printf(\"%s\\n\", buf);\n    return len;\n}\n\nint main(int argc, char *argv[]) {\n    print_double(5.0, 1, 2);\n    print_double(5.1, 1, 2);\n    print_double(5.15, 1, 2);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 562, "user_id": 6572223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/552385f28bdeadfcd7cf5c0d493adb5b?s=128&d=identicon&r=PG", "display_name": "\u30ef\u30a4\u304d\u3093\u3050", "link": "https://stackoverflow.com/users/6572223/%e3%83%af%e3%82%a4%e3%81%8d%e3%82%93%e3%81%90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "accepted_answer_id": 55608111, "answer_count": 1, "score": 2, "last_activity_date": 1554885662, "creation_date": 1554883976, "last_edit_date": 1554885168, "question_id": 55607756, "link": "https://stackoverflow.com/questions/55607756/at-least-one-decimal-after-dot-with-printf-in-c", "title": "At least one decimal after dot with printf in C", "body": "<p>I'm looking for a way to print a floating-point number in C, which prints <strong>at least</strong> one decimal after the dot, but still truncates trailing zeroes, e.g.</p>\n\n<pre><code>double x = 5.0;\nprintf(\"&lt;some_format&gt;\", x);\n// should print 5.0, not 5, and not 5.000000\n\ndouble y = 5.10;\nprintf(\"&lt;same_format&gt;\", y);\n// should print 5.1, not 5.10, and not 5.100000\n\ndouble x = 5.1230;\nprintf(\"&lt;same_format&gt;\", z);\n// should print 5.123, not 5.1230\n</code></pre>\n\n<p>Also, defining a maximum or a fixed number of digits/decimals is exactly what I'm trying to avoid.</p>\n\n<p>Someone knows of one format which accomplishes this with <code>printf</code> without needing to resort to writing the number to a char buffer and then manually  editing this buffer?</p>\n"}, {"tags": ["c", "for-loop", "variable-assignment"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1554883688, "post_id": 55607461, "comment_id": 97909968, "body": "Your output is 100% pure text. Please do not paste huge screenshots to show 4 lines of test. Instead you can easily copy&amp;paste the text directly into the question."}, {"owner": {"reputation": 153, "user_id": 10990333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zaQTx.png?s=128&g=1", "display_name": "Terrarium", "link": "https://stackoverflow.com/users/10990333/terrarium"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1554886228, "post_id": 55607461, "comment_id": 97911358, "body": "Okay! I will remember that later on :)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1554886318, "post_id": 55607461, "comment_id": 97911399, "body": "It&#39;s not too late to edit your question. :) Just click on &quot;edit&quot; below your question and replace the images of text with the text itself."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1554888647, "post_id": 55607461, "comment_id": 97912839, "body": "Please note that you should use one of the proper signatures of <code>main</code>, like <code>int main(void)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1554883265, "creation_date": 1554883265, "answer_id": 55607557, "question_id": 55607461, "link": "https://stackoverflow.com/questions/55607461/counter-inside-a-for-loop-does-not-give-expected-output/55607557#55607557", "title": "Counter inside a for loop does not give expected output", "body": "<p>This is because when you enter your <code>n</code>, you're also entering a newline (or a space). This whitespace is left in the buffer, so the first character read in won't be the <code>x</code>, but that whitespace character.</p>\n\n<p>You can fix that by telling <code>scanf</code> to skip the leading whitespace. Change this line</p>\n\n<p>scanf(\"%c\", &amp;ara[i]);</p>\n\n<p>To this:</p>\n\n<p>scanf(\" %c\", &amp;ara[i]);</p>\n\n<p>The space in front of the <code>%c</code> makes it ignore that newline/space and instead take the first <code>x</code> entered, giving you the correct result. This is how a <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\">reference</a> explains it:</p>\n\n<blockquote>\n  <p>Whitespace character: the function will read and ignore any whitespace\n  characters encountered before the next non-whitespace character\n  (whitespace characters include spaces, newline and tab characters --\n  see isspace). A single whitespace in the format string validates any\n  quantity of whitespace characters extracted from the stream (including\n  none).</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": true, "score": 1, "last_activity_date": 1554885913, "last_edit_date": 1554885913, "creation_date": 1554883313, "answer_id": 55607572, "question_id": 55607461, "link": "https://stackoverflow.com/questions/55607461/counter-inside-a-for-loop-does-not-give-expected-output/55607572#55607572", "title": "Counter inside a for loop does not give expected output", "body": "<p>Your ara array contains the newline right after you entered <code>5</code>. To discard this newline (and all newlines and spaces before the first 'x') you should put space after <code>%d</code>:</p>\n\n<pre><code>scanf(\"%d \",&amp;n);\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>You could prepend a space before \"%c\" like in the answer by @Blaze, but then input like the following will be misread:</p>\n\n<pre><code> 5\n x x x x x\n</code></pre>\n\n<p>It will be read as <code>'x', 'x', 'x', 'x', 'x'</code> instead of <code>'x', ' ', 'x', ' ', 'x'</code>.</p>\n\n<p><strong>Addendum</strong>: </p>\n\n<p>If you want to discard just one newline, and not all newlines:</p>\n\n<pre><code>scanf(\"%d\",&amp;n);\nwhile (true) {\n    char ch = getchar();\n    if (ch == EOF || ch == '\\n') break;\n}\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 10990333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zaQTx.png?s=128&g=1", "display_name": "Terrarium", "link": "https://stackoverflow.com/users/10990333/terrarium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55607572, "answer_count": 2, "score": 1, "last_activity_date": 1554889172, "creation_date": 1554882935, "last_edit_date": 1554889172, "question_id": 55607461, "link": "https://stackoverflow.com/questions/55607461/counter-inside-a-for-loop-does-not-give-expected-output", "title": "Counter inside a for loop does not give expected output", "body": "<p>This program scans for some characters, and shows how many <code>'x'</code>'s were given as input.\nI think you'll get a better idea looking at the code instead of me explaining.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nmain()\n{\n    int n,i,t=0;\n    scanf(\"%d\",&amp;n);\n    char ara[n];\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%c\", &amp;ara[i]);\n        if(ara[i]=='x') t++;\n    }\n    printf(\"%d\",t);\n}\n</code></pre>\n\n<p>suppose, <code>n</code> = <code>5</code> and the characters were <code>\"xxxxxx\"</code>. In that case, the value of <code>t</code> should be <code>5</code>. But it displays <code>4</code>.</p>\n\n<p>Another thing is that if you remove the first scanf Statement (line 5) and manually set the value of <code>n</code> = <code>5</code> everywhere else in the Code:</p>\n\n<pre><code>int n,i,t=0;\n//scanf(\"%d\",&amp;n);\nn = 5;\n</code></pre>\n\n<p>then the value of <code>t</code> becomes <code>5</code> resulting in the correct output. Is there any possibility that the outer scanf function is affecting the scanf function inside for loop?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1554882598, "post_id": 55607328, "comment_id": 97909356, "body": "What is <code>data</code>? What is <code>state</code>? Where&#39;s your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? And what is the problem with the code you show? What problem is that <code>memcpy</code> call supposed to solve? Lastly, not forgetting that enumeration values are basically plain compile-time symbolic constants for <i>integer</i> values, why can&#39;t you just do simple assignment (as in <code>data[9] = state + 1</code>)?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1554883841, "post_id": 55607328, "comment_id": 97910041, "body": "<code>cmd_type</code> is an integer type. How should <code>data+1</code> be a suitable argument for a parameter expecting a pointer? Turn on your compiler warnings and take care of them."}, {"owner": {"reputation": 9358, "user_id": 35989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/320239374ee6d1ae0d8c6889b0de89a9?s=128&d=identicon&r=PG", "display_name": "Dipstick", "link": "https://stackoverflow.com/users/35989/dipstick"}, "edited": false, "score": 0, "creation_date": 1554889011, "post_id": 55607328, "comment_id": 97913056, "body": "Turn all compiler warnings on (I recommend at least <code>-Wall -Wextra</code>) and you will find the problem. Hint: <code>memcpy</code> requires two addresses."}], "owner": {"reputation": 11, "user_id": 10984196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0495774f7081901a305bfe11990fffe2?s=128&d=identicon&r=PG&f=1", "display_name": "T.Nirupama", "link": "https://stackoverflow.com/users/10984196/t-nirupama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554887699, "creation_date": 1554882415, "last_edit_date": 1554887699, "question_id": 55607328, "link": "https://stackoverflow.com/questions/55607328/accessing-enum-value-in-memcpy", "title": "Accessing enum value in memcpy", "body": "<p>I am trying to copy the value of enum to some array through memcpy. Before this i will be doing a state change of enum from 0 to 1. Then i am copying this enum value to my array. I observed that there is state change but the value is not copied into array.\nInitial enum value is 0 i.e., INIT_STATE, then i change the value to DISASSOCIATE_STATE.</p>\n\n<p>My array is data[9], where 0-7 bytes is the device_id and 8 is the tag_state.\nState is when BLE communication happens between tag and mobile app, i give 1 in the custom characteristics from nRF connect app, the state should change to DISASSOCIATE. This is happening that i can check in switch case. </p>\n\n<p>So, When that changes, i should update the state in array. For that i'm using memcpy. </p>\n\n<p>memcpy should update the tag state i.e., 8th byte of data[9].</p>\n\n<p>My enum is </p>\n\n<pre><code>typedef enum {\n    INIT_STATE,\n    DISASSOCIATE_STATE,\n    ASSOCIATE_STATE,\n    SET_CONFIG_STATE\n}cmd_type;\n</code></pre>\n\n<p>This is defined in one file. I am accessing it using cmd_type state;\nThis is the memcpy  command I'm using, </p>\n\n<pre><code>memcpy(data[8],state+1, 1);\n</code></pre>\n\n<p>Why the value is not getting copied?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554880300, "post_id": 55606699, "comment_id": 97908080, "body": "C or C++? Which one?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554880334, "post_id": 55606699, "comment_id": 97908094, "body": "In C <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1554880350, "post_id": 55606699, "comment_id": 97908104, "body": "Dereferencing is correct, allocation is wrong. Where does <code>List[1]</code> point to?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554880396, "post_id": 55606699, "comment_id": 97908135, "body": "You have two mallocs that are the same size, why is one <code>ELEMENT *</code> and the other is <code>ELEMENT **</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554880487, "post_id": 55606699, "comment_id": 97908183, "body": "In general, if you use <code>N * sizeof (&lt;type&gt;)</code> in the <code>malloc()</code> argument, then the result is <code>&lt;type&gt; *</code>. It&#39;s always one more <code>*</code> in the pointer type than the argument to <code>sizeof</code>."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1554880567, "creation_date": 1554880567, "answer_id": 55606784, "question_id": 55606699, "link": "https://stackoverflow.com/questions/55606699/how-to-deference-a-pointer-to-a-pointer-on-the-heap/55606784#55606784", "title": "How to deference a pointer to a pointer on the heap?", "body": "<p>If <code>List</code> should be pointing to <code>e</code>, then you should not call <code>malloc()</code> again. You should do:</p>\n\n<pre><code>struct ELEMENT **List = &amp;e;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1554882415, "creation_date": 1554882415, "answer_id": 55607327, "question_id": 55606699, "link": "https://stackoverflow.com/questions/55606699/how-to-deference-a-pointer-to-a-pointer-on-the-heap/55607327#55607327", "title": "How to deference a pointer to a pointer on the heap?", "body": "<p>As others have already noticed you don't want a second <code>malloc</code>. You simply want <code>List</code> to point to <code>e</code> so all you need is to assign the \"address of\"  <code>e</code> to <code>list</code>.</p>\n\n<pre><code>struct ELEMENT **List = &amp;e;\n</code></pre>\n\n<p>Besides that the way you try to access elements using <code>List</code> is wrong. Look at it like this:</p>\n\n<ul>\n<li><p><code>e[n]</code> will access struct ELEMENT at index n</p></li>\n<li><p><code>*List</code> is the same <code>e</code></p></li>\n<li><p>So to access elements in the array you'll need <code>(*List)[n]</code></p></li>\n<li><p>and to access a member you'll need <code>(*List)[n].key</code></p></li>\n</ul>\n\n<p>BTW: None of your <code>... malloc....</code> can compile as you have forgotten <code>struct</code> in the cast but instead of adding <code>struct</code>just remove the cast. Like:</p>\n\n<pre><code>struct ELEMENT *e =  malloc(numOfNodes * sizeof *e);\n                    ^                           ^^\n                no cast                    use dereferenced pointer to calculate size\n</code></pre>\n\n<p>With these changes your complete code will be:</p>\n\n<pre><code>struct ELEMENT{\n    int key;\n    int edge;\n    struct ELEMENT *adjList;\n};\n\nint numOfNodes = 3; \n\nstruct ELEMENT *e = malloc(numOfNodes * sizeof *e);\nstruct ELEMENT **List = &amp;e;\n(*List)[1].key = 5;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 114, "user_id": 4650828, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c3ac75868538d3cb30249fc62145d9a?s=128&d=identicon&r=PG&f=1", "display_name": "aragon", "link": "https://stackoverflow.com/users/4650828/aragon"}, "is_accepted": false, "score": 0, "last_activity_date": 1554884934, "creation_date": 1554884934, "answer_id": 55608023, "question_id": 55606699, "link": "https://stackoverflow.com/questions/55606699/how-to-deference-a-pointer-to-a-pointer-on-the-heap/55608023#55608023", "title": "How to deference a pointer to a pointer on the heap?", "body": "<p>With this line </p>\n\n<pre><code>struct ELEMENT *e = (struct ELEMENT*)malloc(numOfNodes * sizeof(struct ELEMENT));\n</code></pre>\n\n<p>you don't just allocate memory for <code>struct ELEMENT</code> variable but you create an array with size 3 and type <code>struct ELEMENT</code>. </p>\n\n<p>But as i understand by your code you want to create a List and add variable <code>e</code>. This can be done like that</p>\n\n<pre><code>struct ELEMENT **List = malloc(numOfNodes * sizeof(struct ELEMENT*));   //This allocate memory for 3 pointers, List[i] is type struct ELEMENT *\n</code></pre>\n\n<p>After you can allocate memory for each pointer like that    </p>\n\n<pre><code>int i;\nfor(i = 0; i &lt; numOfNodes; i++)\n{\n    List[i] = malloc(sizeof(struct ELEMENT));   //here allocate memory for each pointer, for now each List[i] is type struct ELEMENT\n}\n</code></pre>\n\n<p>So can change the declaration of <code>e</code> to <code>struct ELEMENT *e = malloc(sizeof(struct ELEMENT));</code></p>\n\n<p>and use <code>e</code> as you want for example</p>\n\n<pre><code>e-&gt;adjList = NULL;\ne-&gt;edge = 5;\ne-&gt;key = 15;\n</code></pre>\n\n<p>And add it to <code>List</code></p>\n\n<pre><code>List[i] = e;\n</code></pre>\n\n<p>If you just want a pointer to reference at variable <code>e</code> you can use <code>struct ELEMENT **List = &amp;e;</code> or more simple <code>struct ELEMENT *p_elem = e;</code>. So you can use these pointers to change the value of <code>e</code> members.</p>\n\n<p>Don't forget to <code>free</code> the memory that previous allocated.</p>\n\n<p>Hope this solve you any conclusions.</p>\n"}], "owner": {"reputation": 35, "user_id": 11338606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34aa006b41391e0d5b335cc69ad78bd2?s=128&d=identicon&r=PG&f=1", "display_name": "JokimNoah", "link": "https://stackoverflow.com/users/11338606/jokimnoah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1554918952, "creation_date": 1554880244, "last_edit_date": 1554918952, "question_id": 55606699, "link": "https://stackoverflow.com/questions/55606699/how-to-deference-a-pointer-to-a-pointer-on-the-heap", "title": "How to deference a pointer to a pointer on the heap?", "body": "<p>I'm having some trouble dereferencing a pointer to a pointer.  I have a node <code>e</code> that I put onto the heap and also another node called <code>List</code>.  <code>List</code> is a pointer pointing to <code>e</code>.</p>\n\n<p>For some reason I am having a segmentation fault when I am dereferencing <code>e</code> through <code>List</code>:</p>\n\n<pre><code>struct ELEMENT{\n    int key;\n    int edge;\n    struct ELEMENT *adjList;\n};\n\nint numOfNodes = 3; \n\nstruct ELEMENT *e = (ELEMENT*)malloc(numOfNodes * sizeof(struct ELEMENT));\n// e is now on the heap\n\nstruct ELEMENT **List = (ELEMENT**)malloc(numOfNodes * sizeof(struct ELEMENT));\n// List (pointer to e) is now on the Heap\n\nList[1]-&gt;key = 5;  // segmentation fault occurs here\n</code></pre>\n"}, {"tags": ["c", "windows-10", "getchar"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1554880200, "post_id": 55606641, "comment_id": 97908027, "body": "You mean you want to <i>poll</i> if there&#39;s any input, and if there isn&#39;t then go on with the loop? In other words, you don&#39;t want <code>getchar</code> to block (not return)? Then you can&#39;t use standard C functions, and have to use operating-system functionality."}, {"owner": {"reputation": 11, "user_id": 10482699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac0c07935075a13f4e71f8664d4e599?s=128&d=identicon&r=PG&f=1", "display_name": "Silver Man", "link": "https://stackoverflow.com/users/10482699/silver-man"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554880373, "post_id": 55606641, "comment_id": 97908118, "body": "@Someprogrammerdude I want to create a game,the loop i said wrote for getting order from user to move his character,i want that if user does&#39;t enter anything, skip and do while again"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1554880516, "post_id": 55606641, "comment_id": 97908198, "body": "Then you want to <i>poll</i> for input. And that&#39;s not possible using standard C functions. You need to use operating-system specific functionality, and you don&#39;t tell us what operating system you use (edit your question to include it, as a tag or in the body of the question) so we can&#39;t help you further."}, {"owner": {"reputation": 11, "user_id": 10482699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac0c07935075a13f4e71f8664d4e599?s=128&d=identicon&r=PG&f=1", "display_name": "Silver Man", "link": "https://stackoverflow.com/users/10482699/silver-man"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554880700, "post_id": 55606641, "comment_id": 97908320, "body": "@Someprogrammerdude edited"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554881213, "post_id": 55606641, "comment_id": 97908620, "body": "For windows, you can use the CRT function <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/getch-getwch?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_getch</code></a> (or <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/getche-getwche?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_getche</code></a> to echo the key). Or use <a href=\"https://docs.microsoft.com/en-us/windows/console/console-functions\" rel=\"nofollow noreferrer\">the console functions</a>. Note that these are <b><i>very</i></b> different from the standard C functions."}, {"owner": {"reputation": 11, "user_id": 10482699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac0c07935075a13f4e71f8664d4e599?s=128&d=identicon&r=PG&f=1", "display_name": "Silver Man", "link": "https://stackoverflow.com/users/10482699/silver-man"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554883120, "post_id": 55606641, "comment_id": 97909655, "body": "I solved it by <code>kbhit()</code>.Thanks for help @Someprogrammerdude"}], "owner": {"reputation": 11, "user_id": 10482699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac0c07935075a13f4e71f8664d4e599?s=128&d=identicon&r=PG&f=1", "display_name": "Silver Man", "link": "https://stackoverflow.com/users/10482699/silver-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1554880912, "answer_count": 0, "score": 0, "last_activity_date": 1554880666, "creation_date": 1554880049, "last_edit_date": 1554880666, "question_id": 55606641, "link": "https://stackoverflow.com/questions/55606641/skip-getchar-in-c", "closed_reason": "Duplicate", "title": "Skip getchar() in c", "body": "<p>I want to write a piece of code to get input in a <code>while</code> loop  ,I used <code>getchar()</code>, i want to skip <code>getchar()</code> even if user doesn't input anything.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1554877734, "post_id": 55605991, "comment_id": 97906850, "body": "You have a makefile which links both object files. But you don&#39;t seem to be using it? Or using an old makefile? Because the output you show doesn&#39;t match the makefile you show."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1554877883, "post_id": 55605991, "comment_id": 97906909, "body": "<a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\" title=\"what is an undefined reference unresolved external symbol error and how do i fix\">stackoverflow.com/questions/12573816/&hellip;</a> describes the topic (C++ centered, but probably generally also helpful for C)."}, {"owner": {"reputation": 21, "user_id": 11338414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d258b6fe639bd3f53c676b39ac777944?s=128&d=identicon&r=PG&f=1", "display_name": "Nato_Hendo", "link": "https://stackoverflow.com/users/11338414/nato-hendo"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554878548, "post_id": 55605991, "comment_id": 97907218, "body": "@Someprogrammerdude What part doesn&#39;t match? If you&#39;re referring to the &#39;In function `ctap_tests&#39;:&#39; ctap_tests is there because the macro TESTS{} expands to &#39;void ctap_tests(void)&#39; according to VSCode when I hover over TESTS{} in task5.c."}, {"owner": {"reputation": 21, "user_id": 11338414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d258b6fe639bd3f53c676b39ac777944?s=128&d=identicon&r=PG&f=1", "display_name": "Nato_Hendo", "link": "https://stackoverflow.com/users/11338414/nato-hendo"}, "edited": false, "score": 0, "creation_date": 1554878956, "post_id": 55605991, "comment_id": 97907426, "body": "Ah, I&#39;ve just tried compiling it using &#39;gcc -o linked task5.o reverse.o&#39; instead of make linked and it worked. I&#39;m not sure why it would be using another make file but thanks for getting me to check it out, it&#39;s definitely something wrong with the make file."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554879430, "post_id": 55605991, "comment_id": 97907627, "body": "Try using the <code>ls</code> command to list the files in the current directory. Do you have multiple &quot;makefiles&quot; (and remember that Linux filesystems are case-sensitive)? If there&#39;s only one, if you type it (with the <code>cat</code> command) is it the one you expect?"}, {"owner": {"reputation": 21, "user_id": 11338414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d258b6fe639bd3f53c676b39ac777944?s=128&d=identicon&r=PG&f=1", "display_name": "Nato_Hendo", "link": "https://stackoverflow.com/users/11338414/nato-hendo"}, "edited": false, "score": 0, "creation_date": 1554880665, "post_id": 55605991, "comment_id": 97908301, "body": "The ls command still only shows the one makefile as &#39;makefile.mk&#39;, when i use the cat command it is the exact same makefile as what I see in VSCode so I&#39;m not sure what other makefile would be being referenced and why the output isn&#39;t the same."}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 1, "creation_date": 1554880790, "post_id": 55605991, "comment_id": 97908367, "body": "Try to rename it <code>Makefile</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11338414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d258b6fe639bd3f53c676b39ac777944?s=128&d=identicon&r=PG&f=1", "display_name": "Nato_Hendo", "link": "https://stackoverflow.com/users/11338414/nato-hendo"}, "edited": false, "score": 0, "creation_date": 1554882714, "post_id": 55606897, "comment_id": 97909423, "body": "Thankyou! You were right, it was the way VSCode named the makefile when i saved it, I just rewrote it in notepad++ and saved it as just makefile (VSCode wouldn&#39;t let me) and it worked!"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1554881003, "creation_date": 1554881003, "answer_id": 55606897, "question_id": 55605991, "link": "https://stackoverflow.com/questions/55605991/how-to-fix-undefined-reference-when-compiling-in-c/55606897#55606897", "title": "How to fix &#39;undefined reference&#39; when compiling in C?", "body": "<p>According to <a href=\"https://www.gnu.org/software/make/manual/make.html#Running\" rel=\"nofollow noreferrer\">this GNU <code>make</code> documentation</a>, the GNU make program will try to use <code>GNUMakefile</code>, <code>makefile</code> or <code>Makefile</code>.</p>\n\n<p>The <code>make</code> program will <em>not</em> try <code>makefile.mk</code>, which means that e.g. <code>make linked</code> will use no makefile and only the default rules.</p>\n\n<p>You can solve this by either renaming your makefile as <code>Makefile</code> (the most common) or <code>makefile</code>; Or by using the <code>-f</code> option to specify the makefile</p>\n\n<pre><code>$ make -f makefile.mk linked\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11338414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d258b6fe639bd3f53c676b39ac777944?s=128&d=identicon&r=PG&f=1", "display_name": "Nato_Hendo", "link": "https://stackoverflow.com/users/11338414/nato-hendo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 55606897, "answer_count": 1, "score": 1, "last_activity_date": 1554881348, "creation_date": 1554877511, "last_edit_date": 1554881348, "question_id": 55605991, "link": "https://stackoverflow.com/questions/55605991/how-to-fix-undefined-reference-when-compiling-in-c", "title": "How to fix &#39;undefined reference&#39; when compiling in C?", "body": "<p>I'm trying to compile a C program linking two previously created object files but keep getting an 'undefined reference' error.</p>\n\n<p>I'm using Visual Code to write the code and Ubuntu on Windows to compile using a makefile. The two C files, <strong>task5.c</strong> and <strong>reverse.c</strong> which have been made into object files both contain <code>#include reverse.h</code> statements which contains the prototypes for the functions in <strong>reverse.c</strong>.</p>\n\n<p><strong>task5.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"ctap.h\"\n#include \"reverse.h\"\n\nTESTS {\n    const char *a = \"Family\";\n    char *b = reverse(a);\n\n    //test 1\n    ok(string_length(a) == string_length(b), \"Strings are the same size\");\n\n    //test 2\n    is(\"ylimaF\", b, \"Strings match\");\n}\n</code></pre>\n\n<p><strong>reverse.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"reverse.h\"\n\nchar *reverse(const char *str) {\n    //code\n}\n\nint string_length(const char *str) {\n    //code\n}\n</code></pre>\n\n<p><strong>reverse.h</strong></p>\n\n<pre><code>char *reverse(const char *str);\nint string_length(const char *str);\n</code></pre>\n\n<p><strong>makefile</strong></p>\n\n<pre><code>linked:\n    gcc -o linked task5.o reverse.o\n\ntask5.o\n    gcc -c -o task5.o task5.c\n\nreverse.o\n    gcc -c -o reverse.o reverse.c\n</code></pre>\n\n<p>When I run the command <code>make linked</code> I expect it to be made and return nothing.</p>\n\n<p>But when I run that command I get this error:</p>\n\n<pre><code>cc   task5.o   -o linked\ntask5.o: In function `ctap_tests':\ntask5.c:(.text+0x1abe): undefined reference to `reverse'\ntask5.c:(.text+0x1ace): undefined reference to `string_length'\ntask5.c:(.text+0x1adc): undefined reference to `string_length'\ncollect2: error: ld returned 1 exit status\n&lt;builtin&gt;: recipe for target 'linked' failed\nmake: *** [task5] Error 1\n</code></pre>\n"}, {"tags": ["c++", "c", "arduino"], "answers": [{"tags": [], "owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "is_accepted": false, "score": 0, "last_activity_date": 1554877145, "creation_date": 1554877145, "answer_id": 55605886, "question_id": 55605700, "link": "https://stackoverflow.com/questions/55605700/arduino-how-to-show-serial-print-value-to-any-textbox-or-notepad/55605886#55605886", "title": "Arduino: How to show Serial.print value to any textbox or Notepad", "body": "<p>You can use <a href=\"https://linux.die.net/man/1/stty\" rel=\"nofollow noreferrer\">stty</a>.</p>\n\n<p>Here's a sample : </p>\n\n<pre><code>stty -F /dev/my_serial_port &lt;baud_rate&gt; cs8 cread clocal &gt; filename\n</code></pre>\n\n<p>Here you redirect all the output from the serial port to a file. To print out the contents as they come in you can use </p>\n\n<pre><code>tail -f filename\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 4115868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QiPJP.jpg?s=128&g=1", "display_name": "Manuja Jayawardana", "link": "https://stackoverflow.com/users/4115868/manuja-jayawardana"}, "is_accepted": false, "score": 0, "last_activity_date": 1554879444, "last_edit_date": 1554879444, "creation_date": 1554878896, "answer_id": 55606339, "question_id": 55605700, "link": "https://stackoverflow.com/questions/55605700/arduino-how-to-show-serial-print-value-to-any-textbox-or-notepad/55606339#55606339", "title": "Arduino: How to show Serial.print value to any textbox or Notepad", "body": "<p>There are multiple ways to do this .using a 3rd party tool will be easy to get the serial output. or else you can try following link. I have explained what you need to do.</p>\n\n<p><strong>Try This</strong> </p>\n\n<p><a href=\"https://electronics.stackexchange.com/questions/54/saving-arduino-sensor-data-to-a-text-file\">Follow this link </a></p>\n\n<p>What you need is <strong>PrintWriter</strong>.</p>\n\n<p>Import PrintWriter :    </p>\n\n<pre><code>PrintWriter output;\n</code></pre>\n\n<p>Instantiate output object in the setup() method :</p>\n\n<pre><code>output = createWriter( \"data.txt\" );  \n</code></pre>\n\n<p>Writes the data to text file</p>\n\n<pre><code>output.println( value );\n</code></pre>\n\n<p>This \"value\" data can be retrieved from serial </p>\n\n<pre><code>String value = serial.readString();\n</code></pre>\n\n<p>Finally flush the data and close the file.</p>\n\n<pre><code>output.flush();  // Writes the remaining data to the file\noutput.close();  // Finishes the file    \n</code></pre>\n"}], "owner": {"reputation": 1861, "user_id": 6110018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26d3b0717912abae303c459d53e38a95?s=128&d=identicon&r=PG&f=1", "display_name": "Alexa", "link": "https://stackoverflow.com/users/6110018/alexa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554879444, "creation_date": 1554876216, "question_id": 55605700, "link": "https://stackoverflow.com/questions/55605700/arduino-how-to-show-serial-print-value-to-any-textbox-or-notepad", "title": "Arduino: How to show Serial.print value to any textbox or Notepad", "body": "<p>So I saw an Arduino program that will show an RFID value to the serial monitor, I just want to know how can I also show it to any textbox or Notepad or wherever. For example, I opened a Notepad or Word, when I swiped the RFID keychain, it suppose to show the value there. Here's the code I got:</p>\n\n<pre><code>#include &lt;SPI.h&gt;\n#include &lt;MFRC522.h&gt;\n\n#define RST_PIN         9\n#define SS_PIN          10\nMFRC522 mfrc522(SS_PIN, RST_PIN);\n\nvoid setup()\n{\nSerial.begin(9600);\nSPI.begin();\nmfrc522.PCD_Init();\npinMode(7, OUTPUT);\n}\n\nvoid loop() {\nRfidScan();\n}\n\nvoid dump_byte_array(byte *buffer, byte bufferSize) {\nfor (byte i = 0; i &lt; bufferSize; i++) {\nSerial.print(buffer[i] &lt; 0x10 ? \"0\" : \"\"); // The value I want to show\nSerial.print(buffer[i], HEX);\n}\ndigitalWrite(7, HIGH);\ndelay(100);\ndigitalWrite(7, LOW);\ndelay(1000);\nSerial.print(\"\\n\");\n}\n\nvoid RfidScan()\n{\nif ( ! mfrc522.PICC_IsNewCardPresent())\nreturn;\n\nif ( ! mfrc522.PICC_ReadCardSerial())\nreturn;\ndump_byte_array(mfrc522.uid.uidByte, mfrc522.uid.size);\n}\n</code></pre>\n"}, {"tags": ["c", "cmake", "clion"], "answers": [{"comments": [{"owner": {"reputation": 1627, "user_id": 579698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f69501fa0ff653b5a6e9466b43773d3?s=128&d=identicon&r=PG", "display_name": "Stanley F.", "link": "https://stackoverflow.com/users/579698/stanley-f"}, "edited": false, "score": 1, "creation_date": 1554875612, "post_id": 55605473, "comment_id": 97906057, "body": "A third option would be to have one main function (e.g. in a main.cpp) and from there on, call the other methods. This way one can learn about includes and header vs. c files as well."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1554875095, "creation_date": 1554875095, "answer_id": 55605473, "question_id": 55605401, "link": "https://stackoverflow.com/questions/55605401/clion-help-needed/55605473#55605473", "title": "Clion help needed", "body": "<p>You have two ways to solve that problem:</p>\n\n<ol>\n<li><p>Create two different projects, one for each program.</p></li>\n<li><p>Use a single project, but create two different executable targets.</p></li>\n</ol>\n\n<p>The first way is probably the simplest. The second way requires you to edit the <code>CMakeLists.txt</code> file which could be a little harder, but it will hopefully teach you to not be afraid to do such edits (it's going to be required for more complicated projects) and perhaps also teach you a little of how the underlying system (<a href=\"https://cmake.org\" rel=\"nofollow noreferrer\">CMake</a>) works.</p>\n\n<p>In the short run and just for a quick \"fix\", go the first route. If you're not afraid to learn something new, then go the second route.</p>\n"}], "owner": {"reputation": 27, "user_id": 8141041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b644797754cb365d698ea0ec09919612?s=128&d=identicon&r=PG&f=1", "display_name": "Puspanjali Panda", "link": "https://stackoverflow.com/users/8141041/puspanjali-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 55605473, "answer_count": 1, "score": 0, "last_activity_date": 1554875095, "creation_date": 1554874755, "question_id": 55605401, "link": "https://stackoverflow.com/questions/55605401/clion-help-needed", "title": "Clion help needed", "body": "<p>I have recently started c programming. And I'm having trouble with the following. For example I have two files one for prime numbers and one for perfect numbers. They each have one main function. But clion refuses to have two main functions even if they are in different files.i found some post with similar problem but that didn't help. It was something about cmake. Please help.</p>\n"}, {"tags": ["c", "linux", "pipe", "popen", "dup2"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554871001, "post_id": 55604667, "comment_id": 97904752, "body": "What about <code>fileno()</code> and <code>dup2()</code>?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554871073, "post_id": 55604667, "comment_id": 97904767, "body": "@Shawn I was implying <code>dup</code> and <code>dup2</code> are the same thing. In fact, my implementation used <code>dup2(write_fd, 1)</code> or similar."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1554871684, "post_id": 55604667, "comment_id": 97904932, "body": "You&#39;re overthinking it. Open <code>cat</code> for read. Open <code>grep</code> for write. Read from <code>cat</code>, write to <code>grep</code>. Done."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1554872224, "post_id": 55604667, "comment_id": 97905053, "body": "@user3386109 That looks like an answer."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1554874135, "post_id": 55604667, "comment_id": 97905587, "body": "No idea why <code>system()</code> is in this list."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1554874250, "post_id": 55604667, "comment_id": 97905620, "body": "Are you allowed to use any of the file I/O functions (<code>fread()</code>, <code>fwrite()</code> for example) in the shell?  You normally don&#39;t need an active process in the middle as suggested by @user3386109 \u2014 but you&#39;re normally able to use <code>dup2()</code> and <code>fileno()</code>.  If <code>fread()</code> and <code>fwrite()</code> are permissible, you have a workable solution. There are no standard functions that do the equivalent of <code>dup2()</code> but for file streams instead of file descriptors.  I&#39;m not sure if you&#39;re allowed to create a suitable function that could be called to do the job of <code>dup2()</code> for a file stream; presumably not."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1554875615, "post_id": 55604667, "comment_id": 97906058, "body": "@JonathanLeffler I don&#39;t mind anything other than dup/dup2, I just don&#39;t want to call dup/2 directly in my code."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1554875629, "post_id": 55604667, "comment_id": 97906066, "body": "I suspect what they want you to do is call <code>popen()</code> twice. Once for the left side of the pipe, once for the right side. Then you read from the first pipe and write to the second pipe in a loop."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1554882083, "post_id": 55604667, "comment_id": 97909083, "body": "@alk No idea too, maybe those TAs need to learn more"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1560685669, "post_id": 55604667, "comment_id": 99810494, "body": "It looks like your school employs either evil or incompetent teachers. The requirements make no sense. If you are writing a Unix shell, you do these things with <code>pipe</code> and <code>dup2</code>. No <code>system</code> or <code>popen</code> or any such nonsense. Teaching students otherwise is wasting their time."}], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560680983, "creation_date": 1554869772, "last_edit_date": 1560680983, "question_id": 55604667, "link": "https://stackoverflow.com/questions/55604667/replace-own-stdout-with-a-file-pointer-obtained-from-popen3-without-using-du", "title": "Replace own stdout with a FILE* pointer obtained from popen(3), without using dup(2)", "body": "<p>In a recent course assignment, we're told to implement a basic shell interpreter with support for at most 1 pipe. For example, the result program should behave mostly identical to a POSIX shell given the following input:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cat 1.txt | grep abcd\n</code></pre>\n\n<p>(By <em>at most 1</em>, it means our program doesn't need to handle the case of multiple pipes, such as <code>cat | cat | cat</code>.)</p>\n\n<p>Our teaching assistants listed the following system calls for use:</p>\n\n<pre><code>fork  waitpid  execv  system  popen  pclose\n</code></pre>\n\n<p>Let's ignore the fact that only 2 of them are actually <em>system calls</em>. The problem I'm having is that I have no idea how I can replace stdin of current process with the <code>FILE*</code> pointer returned by popen(3).</p>\n\n<p>There's a special requirement, that I don't want an answer telling me to get the file descriptor with fileno(3) and then dup(2). This is because I have already implemented my own shell (assignment submission) with pipe(2) and dup(2), completely ignoring what our TAs told us. And this is why I want to know how it's possible without fileno(3) then dup(2).</p>\n\n<p>Assuming dup, dup2 and dup3 (GNU) are the same thing (dup searches for the lowest-numbered unused fd, while dup2 closes its second argument when necessary - the primary function is identical - to duplicate a fd).</p>\n"}, {"tags": ["c", "memory", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1554882126, "post_id": 55604512, "comment_id": 97909112, "body": "Please note that <code>size_t</code> and <code>unsigned long</code> are not necessarily compatible types. Thus you should use format specifier <code>%zu</code> for printing the type <code>size_t</code>. But, <code>size_t</code> which is typically used for sizes and/or indexes, so seems like a wrong type for a field called <code>year</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554891363, "post_id": 55604512, "comment_id": 97914592, "body": "You should not do this. Use the normal access to structure members, as with <code>p-&gt;year</code>. Accessing structure members through character pointers should only be done for special purposes, not ordinary access to members."}, {"owner": {"reputation": 43, "user_id": 8604681, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ZXIU.jpg?s=128&g=1", "display_name": "Daniel Maydana", "link": "https://stackoverflow.com/users/8604681/daniel-maydana"}, "edited": false, "score": 0, "creation_date": 1554916796, "post_id": 55604512, "comment_id": 97929430, "body": "Thank you, I&#39;ll take into account both observations. I know it&#39;s not a good practice to access structure members like I did, it was just a little experiment to prove my knowledge about the way struct memory is allocated."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8604681, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ZXIU.jpg?s=128&g=1", "display_name": "Daniel Maydana", "link": "https://stackoverflow.com/users/8604681/daniel-maydana"}, "edited": false, "score": 0, "creation_date": 1554869404, "post_id": 55604587, "comment_id": 97904391, "body": "Thank you for your reply. Your suggestion on how to print worked! But I&#39;ll also look into the offsetof method."}], "tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": true, "score": 4, "last_activity_date": 1554869009, "creation_date": 1554869009, "answer_id": 55604587, "question_id": 55604512, "link": "https://stackoverflow.com/questions/55604512/how-can-i-access-the-attribute-of-an-struct-using-simple-pointer-arithmetic/55604587#55604587", "title": "How can I access the attribute of an struct using simple pointer arithmetic?", "body": "<p>The C standard doesn't really specify how struct members are laid out; there may be padding.</p>\n\n<p>Instead of assuming that <code>year</code> is 64 bytes into the struct, you should be using <code>offsetof(struct Person, year)</code>.</p>\n\n<p>If you need more control over how the struct is laid out in memory, look into packed structs.  It's not standard, but pretty much all compilers support them, though the syntax is different.</p>\n\n<p>That said, that third printf isn't doing what you think.  Try something like</p>\n\n<pre><code>*((size_t*) (((char*) &amp;f) + 64))\n</code></pre>\n\n<p>With your original code you're trying to print the <em>address of</em> <code>year</code> as a <code>size_t</code>, not the value.</p>\n"}], "owner": {"reputation": 43, "user_id": 8604681, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ZXIU.jpg?s=128&g=1", "display_name": "Daniel Maydana", "link": "https://stackoverflow.com/users/8604681/daniel-maydana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55604587, "answer_count": 1, "score": -1, "last_activity_date": 1554869009, "creation_date": 1554868340, "last_edit_date": 1554868676, "question_id": 55604512, "link": "https://stackoverflow.com/questions/55604512/how-can-i-access-the-attribute-of-an-struct-using-simple-pointer-arithmetic", "title": "How can I access the attribute of an struct using simple pointer arithmetic?", "body": "<p>I have this struct along with the method that initializes it:</p>\n\n<pre><code>struct Person \n{\n    char name[32];\n    char lastn[32];\n    size_t year;\n};\n\nvoid init_pers(struct Person* p, const char* n, const char* ln, size_t y)\n{\n    strcpy(p-&gt;name, n);\n    strcpy(p-&gt;lastn, ln);\n    p-&gt;year = y;\n}\n</code></pre>\n\n<p>And this is the way they're called in the main:</p>\n\n<pre><code>struct Person f;\ninit_pers(&amp;f, \"Alan\", \"Wake\", 1995);\n</code></pre>\n\n<p>By simple pointer arithmetic I was able to print the two first attributes:</p>\n\n<pre><code>printf(\"First field: %s\\n\", (const char*)&amp;f); // prints 'Alan'\nprintf(\"Second field: %s\\n\", (const char*)&amp;f + 32); // prints 'Wake'\n</code></pre>\n\n<p>However when I try the same to print the third attribute, which is a size_t, I get a number other than the year:</p>\n\n<pre><code>printf(\"Third field: %lu\\n\", (size_t)&amp;f + 64); // prints '6422317'\n</code></pre>\n\n<p>What's the right way to print the space of memory that holds the year using pointer arithmetic?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1554866431, "post_id": 55604221, "comment_id": 97903730, "body": "Use <code>fgetc</code> instead of <code>fscanf</code>"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1554866827, "post_id": 55604221, "comment_id": 97903813, "body": "You probably want <code>while(userChar != &#39;\\n&#39;)</code> instead of <code>==</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1966, "user_id": 10953328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2f9870ea4a1a14bf72bfe62d6f21ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ignatius", "link": "https://stackoverflow.com/users/10953328/ignatius"}, "is_accepted": false, "score": 1, "last_activity_date": 1554866799, "creation_date": 1554866799, "answer_id": 55604336, "question_id": 55604221, "link": "https://stackoverflow.com/questions/55604221/how-to-read-a-user-input-with-multiple-characters-through-scanf-without-using-st/55604336#55604336", "title": "How to read a user input with multiple characters through scanf without using strings", "body": "<p>There are two problems with your code.</p>\n\n<p>First, <code>scanf(\"%c \", &amp;userChar);</code> will read a single character <strong>and</strong> then skip any number of whitespace characters that follow. (See <a href=\"https://stackoverflow.com/questions/12835360/whitespace-in-the-format-string-scanf\">this answer</a> for more) By <em>whitespace characters</em>, it usually means ' ', '\\t', '\\r', '\\n', '\\v', '\\f'. So your <code>userChar</code> will <strong><em>never</em></strong> hold a newline character in your code.</p>\n\n<p>Second, your do-while condition is incorrect. You make it run \"while userChar equals a newline character\", which is always false, so the loop will never run more than once. The condition you want is <code>userChar != '\\n'</code>.</p>\n\n<p>So, try the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    printf(\"ENTER A LINE OF TEXT: \\n\");\n    do\n    {\n        scanf(\"%c \", &amp;userChar);\n        userChar = toupper(userChar);\n        userCharVal = userChar;\n        histo[userCharVal - 65] = histo[userCharVal - 65] + 1;\n    } while (userChar != '\\n');\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1554869893, "last_edit_date": 1554869893, "creation_date": 1554868834, "answer_id": 55604571, "question_id": 55604221, "link": "https://stackoverflow.com/questions/55604221/how-to-read-a-user-input-with-multiple-characters-through-scanf-without-using-st/55604571#55604571", "title": "How to read a user input with multiple characters through scanf without using strings", "body": "<p>Your problem is</p>\n\n<pre><code>while(userChar == '\\n');\n</code></pre>\n\n<p>When you read <code>'A'</code> in <code>\"Apple\"</code>, <code>userChar</code> does not <code>== '\\n'</code> causing your oop to terminate after the first iteration. What you intended was:</p>\n\n<pre><code>while(userChar != '\\n');\n</code></pre>\n\n<p>(<strong>note</strong> the <code>\"!=\"</code> instead of <code>\"==\"</code>)</p>\n\n<p>With that, your code should work, though it is unnecessary to use a separate <code>userChar</code> and <code>userCharVal</code>.</p>\n\n<p>To clean things up a bit simply use a single <code>int</code> to read the character with <code>getchar()</code>, there is no need for <code>scanf</code> (and it is best avoided). The additional validation needed is that the character is <code>[a-zA-Z]</code> to ensure you are incrementing a valid index with <code>histo[userCharVal - 65]</code>. (and avoid using numbers like <code>65</code> when you can use <code>'A'</code> to clearly indicate what you are doing)</p>\n\n<p>Putting it altogether, you could do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\n#define NCHR   26   /* to cover each character in the alphabet */\n\nint main (void) {\n\n    int frequency[NCHR] = {0},  /* frequency of each char initialized to zero */\n        c;                      /* character returned by getchar() */\n\n    fputs (\"enter a line of text: \", stdout);\n    while ((c = getchar()) != '\\n' &amp;&amp; c != EOF) /* read each char */\n        if (isalpha(c))                         /* validate a-zA-Z */\n            frequency[toupper(c) - 'A']++;      /* increment element */\n\n    puts (\"\\nfrequency of characters:\\n\");\n    for (c = 0; c &lt; NCHR; c++)\n        if (frequency[c])   /* output lowercase per your example */\n            printf (\" %c : %d\\n\", c + 'a', frequency[c]);\n}\n</code></pre>\n\n<p>(<strong>note:</strong> the additional check against <code>EOF</code> is also required. There is no guarantee of a <code>'\\n'</code> The user could generate a manual <code>EOF</code> with <kbd>Ctrl+d</kbd> on Linux, or <kbd>Ctrl+z</kbd> on windows, to signify end of input, or to cancel input entirely for that matter)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/charfreqarray\nenter a line of text: Apple\n\nfrequency of characters:\n\n a : 1\n e : 1\n l : 1\n p : 2\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 13, "user_id": 11337846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eaedf0949c8a1404ce29da44de3f34d?s=128&d=identicon&r=PG&f=1", "display_name": "JDNumero", "link": "https://stackoverflow.com/users/11337846/jdnumero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 55604571, "answer_count": 2, "score": 1, "last_activity_date": 1554869893, "creation_date": 1554865974, "question_id": 55604221, "link": "https://stackoverflow.com/questions/55604221/how-to-read-a-user-input-with-multiple-characters-through-scanf-without-using-st", "title": "How to read a user input with multiple characters through scanf without using strings", "body": "<p>Im working on a program for a course, where the program needs to read a single line of a user input and count how many of each letter is in the line. the amount of each letter is put in an array. For example, if the user inputs \"Apple\" the program should put 1 a, 2 ps, 1 l, and 1 e into the counting array. My problem is that my professor says I cannot use strings in the program.I am unsure of how to store multiple characters so that scanf can read them without using a string. When asking for help, he said to read the input one character at a time.</p>\n\n<p>Ive tried to using scanf within a do-while loop to read each character of the input, but most of my attempts have just ended up with only the first character being read and put into the array which records the number of letters. </p>\n\n<pre><code>printf(\"ENTER A LINE OF TEXT: \\n\");\n  do {\n  scanf(\"%c \", &amp;userChar);      \n  userChar = toupper(userChar);\n  userCharVal = userChar;\n  histo[userCharVal - 65] = histo[userCharVal - 65] + 1;\n  } while(userChar == '\\n');\n</code></pre>\n\n<p>if the user enters \"apple\", the corresponding array histo[] will be updated based on which letter was typed. i. e. if the user entered apple, the program will first add 1 to histo[0] (corresponding to 'a') and then read the next character of the word. It should end reading the user input at a newline. In reality, the program just records the first character and then ends.</p>\n"}, {"tags": ["c", "bison", "flex-lexer"], "comments": [{"owner": {"reputation": 2568, "user_id": 2649626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUyok.jpg?s=128&g=1", "display_name": "Ron Dunn", "link": "https://stackoverflow.com/users/2649626/ron-dunn"}, "edited": false, "score": 1, "creation_date": 1554866282, "post_id": 55604129, "comment_id": 97903700, "body": "Can you show us what you&#39;ve tried? The way the question is written makes it look a lot like homework :)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1554868725, "post_id": 55604129, "comment_id": 97904243, "body": "<code>yyout</code> is a global variable, not a function. And neither <code>bison</code> nor <code>flex</code> requires its use."}, {"owner": {"reputation": 1, "user_id": 11337821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a3575fee013cf55f0aec396f8033c6?s=128&d=identicon&r=PG&f=1", "display_name": "OMGItsBlitz", "link": "https://stackoverflow.com/users/11337821/omgitsblitz"}, "edited": false, "score": 0, "creation_date": 1554886020, "post_id": 55604129, "comment_id": 97911235, "body": "I&#39;ve added my code"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1554937840, "post_id": 55604129, "comment_id": 97937958, "body": "<code>printf</code> prints to stdout. Always. So the value of <code>yyout</code> is irrelevant to all your calls to <code>printf</code>. If you want to print to a different file, use <code>fopen</code> to open the file and then <code>fprintf</code> to print to it. If you want to print to two different files, fopen both of them and select which one to print to in each fprintf. Your use of yyout here seems pointless to me. Also, you almost never need the string value of an operator token, since you know what string it is. Tokens only need to have semantic values if you&#39;re going to use that value in some rule."}], "owner": {"reputation": 1, "user_id": 11337821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a3575fee013cf55f0aec396f8033c6?s=128&d=identicon&r=PG&f=1", "display_name": "OMGItsBlitz", "link": "https://stackoverflow.com/users/11337821/omgitsblitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554886324, "creation_date": 1554865330, "last_edit_date": 1554886324, "question_id": 55604129, "link": "https://stackoverflow.com/questions/55604129/output-to-two-different-files-using-flex-and-bison", "title": "Output to two different files using Flex and Bison", "body": "<p>I would like to print the tokens generated by Flex in file_1 and print the parsed output generated by Bison in file_2. Currently, I am printing them both into a single file so they are mixed up together. How do I separate the printing into two different files?</p>\n\n<p>I've tried printing them separately by calling yylex then yyparse but it did not work.</p>\n\n<p>Below is my Flex and Bison file.</p>\n\n<p><strong>Flex file</strong></p>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include \"Parser.tab.h\"\n%}\n\nNumber [0-9]*[\\.0-9]*\nIdent  [A-Za-z][A-Za-z0-9]*\nTagident  &lt;[A-Za-z]+\nWhitespace  [ \\t\\n]+\nComment  &lt;!--(.*?)--&gt;\nPlus  \\+\nMinus  \\-\nMult  \\*\nDivide  \\/\nModulo  \\%\nExp  [*]{2}\nLparen  \\(\nRparen  \\)\nEquals  \\=\nLthan  \\&lt;\nGthan  \\&gt;\nColon  \\:\nComma  \\,\nScolon \\;\nPeriod \\s+\\.\\s+\nQuote \\'                                                                                                                            \nDquote \\\"                                                                                                                                           \nEndtaghead &lt;[/]                                                                                                             \n\n%%\n\\n  {/* Do nothing */}\n{Comment}   {/* Do nothing */}\n{Whitespace}    {/* Do nothing */}\n{Number} {printf(\"%s%s%s\", \"Number\\t\\t\", yytext,\"\\n\"); yylval.ival= atoi(yytext); return number; }\n{Plus}  {printf(\"%s%s%s\", \"Plus\\t\\t\" ,yytext,\"\\n\"); yylval.sval = strdup(yytext); return plus; }\n{Minus} {printf(\"%s%s%s\", \"Minus \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return minus; }\n{Mult}  {printf(\"%s%s%s\", \"Mult \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return mult; }\n{Divide} {printf(\"%s%s%s\", \"Divide\\t\\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return divide; }\n{Modulo} {printf(\"%s%s%s\", \"Modulo \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return modulo; }\n{Exp} {printf(\"%s%s%s\", \"Exp \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return exp;}\n{Lparen} {printf(\"%s%s%s\", \"Lparen \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return left; }\n{Rparen} {printf(\"%s%s%s\", \"Rparen \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return right; }\n{Equals} {printf(\"%s%s%s\", \"Equals \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return equals; }\n{Lthan} {printf(\"%s%s%s\", \"Lthan\\t\\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return lthan; }\n{Gthan} {printf(\"%s%s%s\", \"Gthan\\t\\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext); return gthan; }\n{Colon} {printf(\"%s%s%s\", \"Colon \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return colon;}\n{Comma} {printf(\"%s%s%s\", \"Comma \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return comma; }\n{Scolon} {printf(\"%s%s%s\", \"Scolon \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return scolon; }\n{Period} {printf(\"%s%s%s\", \"Period \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return period;}\n{Quote} {printf(\"%s%s%s\", \"Quote \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return quote; }\n{Dquote} {printf(\"%s%s%s\", \"Dquote \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return dquote;}\n{Ident} {printf(\"%s%s%s\", \"Ident\\t\\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return ident; }\n{Tagident} {printf(\"%s%s%s\", \"Tagident \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return tagident;}\n{Endtaghead} {printf(\"%s%s%s\", \"Endtaghead \\t\", yytext,\"\\n\"); yylval.sval = strdup(yytext);return endtaghead; }\n. {printf(\"%s%s%s\", \"Invalid character \\t\", yytext,\"\\n\"); }\n\n%%\nint yywrap (void ) \n{\n    return 1;\n}\n\n</code></pre>\n\n<p><strong>Parser file</strong></p>\n\n<pre><code>%{\n  #include &lt;stdio.h&gt;\n  #include &lt;stdlib.h&gt;\n  #include &lt;string.h&gt;\n  extern int yylex();\n  extern int yyparse();\n  extern FILE *yyin;\n  extern FILE *yyout;\n  void yyerror(const char *s);\n%}\n\n%union{\n  int ival;\n  char *sval; \n}\n\n/* Some tokens are unused since program is not yet complete */\n%token &lt;ival&gt; number\n%token &lt;sval&gt; ident\n%token &lt;sval&gt; tagident\n%token &lt;sval&gt; endtaghead\n%token &lt;sval&gt; plus \n%token &lt;sval&gt; minus\n%token &lt;sval&gt; mult\n%token &lt;sval&gt; divide\n%token &lt;sval&gt; modulo\n%token &lt;sval&gt; left\n%token &lt;sval&gt; right \n%token &lt;sval&gt; equals\n%token &lt;sval&gt; lthan\n%token &lt;sval&gt; gthan\n%token &lt;sval&gt; colon\n%token &lt;sval&gt; comma \n%token &lt;sval&gt; scolon\n%token &lt;sval&gt; period\n%token &lt;sval&gt; quote\n%token &lt;sval&gt; dquote\n%token &lt;sval&gt; exp\n\n\n%error-verbose\n\n%start summary\n%%\n\nsummary: opener rows closer\n;\n\nopener: tagident gthan\n;\n\ncloser: endtaghead ident gthan\n;\n\nrows: row | row rows\n;\n\nrow: opener cells closer\n;\n\ncells: cell | cell cells\n;\n\ncell: opener contents closer\n;\n\ncontents: content | content contents\n;\n\ncontent: ident \n{\n  printf(\"%s\",$1);\n}\n;\n\n\ncontent: number\n{\n  printf(\"%d\",$1);\n}\n;\n\n\n%%\nint main(int argc, char *argv[])\n{\n    #ifdef YYDEBUG\n    yydebug = 1;\n    #endif\n    yyin = fopen(argv[1], \"r\");\n    yyout = freopen(argv[2], \"w\",stdout);\n    fprintf(yyout, \"%s%s\",\"TOKEN\\t\\t\",\"LEXEME\\n\");   \n    fprintf(yyout, \"-------------------------------------------------\\n\");\n    if(yyparse() ==0)\n    {\n        fprintf(yyout,\"Parse success\");\n    }\n    fclose(yyin);\n    fclose(yyout);\n}\nvoid yyerror(const char *s) {\n    fprintf(stderr, \"%s\\n\", s);     \n}\n</code></pre>\n"}, {"tags": ["c++", "c", "pointers", "virtual-memory", "size-t"], "comments": [{"owner": {"reputation": 2184, "user_id": 1112010, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2c06679b27da6bbc84a4bf036da82648?s=128&d=identicon&r=PG", "display_name": "Mukul Gupta", "link": "https://stackoverflow.com/users/1112010/mukul-gupta"}, "edited": false, "score": 1, "creation_date": 1554865086, "post_id": 55604029, "comment_id": 97903455, "body": "Indexing an array doesn&#39;t have to do with host machine&#39;s RAM. The reason why <code>size_t</code> is encouraged is because it makes your program portable."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1554865230, "post_id": 55604029, "comment_id": 97903481, "body": "Typically a program should not need to care how much memory is installed in the machine it is running on. But if the program logic dictates that there will be a lower limit on the number of elements then you could use a smaller index type."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1554865258, "post_id": 55604029, "comment_id": 97903489, "body": "<code>size_t</code> is guaranteed to be able to index every byte of anything you throw at it. Handy sometimes."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1554865454, "post_id": 55604029, "comment_id": 97903523, "body": "You can use any integral type that is large enough to hold indices of your array. <code>char</code> is OK for small arrays. It has nothing to do with the amount of total amount of addressable memory, or virtual memory, or whatever. <code>size_t</code> is able to hold any index of any array so it&#39;s useful if you don&#39;t know the size upfront."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1554865889, "post_id": 55604029, "comment_id": 97903616, "body": "@user4581301: The C standard does not offer such a guarantee."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566339657, "post_id": 55604029, "comment_id": 101623711, "body": "@EricPostpischil: it does. Specifically, it can hold the size of the largest possible array, since an array is a type of object. Therfore, if you can index it, the size (in bytes) fits in an size_t. And since array elements are at least one byte, so can every index. The confusion might be because size_t is not guaranteed  to hold the sum of size of multiple objects."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1566341636, "post_id": 55604029, "comment_id": 101624070, "body": "@MSalters: It does not. The C standard specifies (C 2018 7.19 2) that <code>size_t</code> is the unsigned integer type of the result of the <code>sizeof</code> operator. But that just tells us about the type, not about the value. The standard does not guarantee that sizes will not overflow the type, any more than it guarantees that arithmetic operations will not overflow the various <code>int</code> types."}], "answers": [{"tags": [], "owner": {"reputation": 26818, "user_id": 209199, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b64963e747bf4c8fc20fb379105f204?s=128&d=identicon&r=PG", "display_name": "Cory Nelson", "link": "https://stackoverflow.com/users/209199/cory-nelson"}, "is_accepted": true, "score": 13, "last_activity_date": 1554867201, "last_edit_date": 1554867201, "creation_date": 1554866308, "answer_id": 55604267, "question_id": 55604029, "link": "https://stackoverflow.com/questions/55604029/should-i-always-use-size-t-when-indexing-arrays/55604267#55604267", "title": "Should I always use size_t when indexing arrays?", "body": "<p><code>size_t</code> is an unsigned integer that is capable of holding the size of the largest object you can allocate. It is useful for indexing because this means it can index into the largest array you can allocate.</p>\n\n<p>This does not mean it is required or even necessarily recommended for indexing. You can use any integer type that is large enough to index the array. <code>int_fast32_t</code> might be faster, <code>uint_least16_t</code> might be smaller in a structure, and so on. Know your data, and you can make a good choice.</p>\n\n<p>Virtual memory is outside the scope of C or C++. From their point of view, you simply index into memory and it's up to your platform to make it work. In practice your app only uses virtual addresses; your CPU/OS is translating the virtual address to a physical address behind the scenes. It is not something you need to worry about.</p>\n"}, {"tags": [], "owner": {"reputation": 290, "user_id": 6852180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5fae5b35c0c625157d991b31e113de3?s=128&d=identicon&r=PG", "display_name": "atomsymbol", "link": "https://stackoverflow.com/users/6852180/atomsymbol"}, "is_accepted": false, "score": 0, "last_activity_date": 1555071363, "creation_date": 1555071363, "answer_id": 55651433, "question_id": 55604029, "link": "https://stackoverflow.com/questions/55604029/should-i-always-use-size-t-when-indexing-arrays/55651433#55651433", "title": "Should I always use size_t when indexing arrays?", "body": "<p>In order to avoid program failures the programmer should always use an index type that is at least as large as the type returned by the <code>size()</code> method. This ensures that the index never overflows any possible size of the array. The implementation of an array is usually making sure that its runtime size never overflows the type returned by the <code>size()</code> method. This means the index type should be:</p>\n\n<ul>\n<li><code>size_t</code> in case of <code>char[N]</code>, <code>uint8_t[N]</code>, <code>int[N]</code>, etc</li>\n<li><code>size_t</code> in case of <code>std::vector</code> and <code>std::list</code></li>\n<li><code>int</code> in case of <code>QList</code> and <code>QVector</code></li>\n<li>an arbitrary precision integer (aint) in case of bitarrays (if the bitarray's <code>size()</code> method returns an aint)</li>\n<li>aint in case of arrays compressed in memory (if the array's <code>size()</code> method returns an aint)</li>\n<li>aint in case of arrays spanning multiple machines (if the array's <code>size()</code> method returns an aint)</li>\n<li>Other languages than C++:\n\n<ul>\n<li><code>int</code> in case of <code>java.util.Collection</code> and its subclasses</li>\n</ul></li>\n</ul>\n\n<p>In summary: A safe index type is the type returned by the <code>size()</code> method.</p>\n\n<p>Note: If the <code>size()</code> method returns the unsigned <code>size_t</code>, then the signed <code>int</code> and <code>ssize_t</code> aren't safe index types. In case of gcc and clang, the compiler flags <code>-Wsign-compare</code> (enabled by <code>-Wall</code>) and <code>-Wconversion</code> can be used to prevent most of these cases.</p>\n"}], "owner": {"reputation": 506, "user_id": 9727896, "user_type": "registered", "profile_image": "https://graph.facebook.com/870963749742883/picture?type=large", "display_name": "Agust&#237;n Nieto Garc&#237;a", "link": "https://stackoverflow.com/users/9727896/agust%c3%adn-nieto-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1707, "favorite_count": 1, "accepted_answer_id": 55604267, "answer_count": 2, "score": 15, "last_activity_date": 1566339131, "creation_date": 1554864565, "last_edit_date": 1566339131, "question_id": 55604029, "link": "https://stackoverflow.com/questions/55604029/should-i-always-use-size-t-when-indexing-arrays", "title": "Should I always use size_t when indexing arrays?", "body": "<p>Do I need to use <code>size_t</code> always when indexing an array even if the array is not big enough to exceed the size of an int?</p>\n\n<p>It's not a question about when I should use <code>size_t</code>. I just want to know if, for example, a program having 2GB of available memory (all of these fields can be indexed by an int32) but with this memory being (virtual memory) assigned to the \"fields\" 14GB - 16GB of the computer's RAM.</p>\n\n<p>Would it always fail when indexing the memory if I used an <code>int32</code> instead of a <code>size_t</code> (or an <code>unsigned long int</code>) in this case?</p>\n\n<p>Maybe the question is more about virtual memory than about pointers.</p>\n"}, {"tags": ["c", "loops", "microcontroller"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1554865401, "post_id": 55603978, "comment_id": 97903515, "body": "1) Watch your loop variables -- you are reusing them. 2) If row is -1 this line accesses out of bounds: <code>while(morse_array[row][j]!= -1)</code>. 3) You have a bug assigning the wrong value for row when input is a digit."}, {"owner": {"reputation": 25, "user_id": 6063896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8559d5da4faf6246209d6177e9631c91?s=128&d=identicon&r=PG&f=1", "display_name": "Rozay", "link": "https://stackoverflow.com/users/6063896/rozay"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1554928319, "post_id": 55603978, "comment_id": 97934711, "body": "@MFisherKDX 1) I&#39;ve updated my variables in my <code>while</code> loop and it loops through every letter now, but the only problem I&#39;m running into is the program not recognizing the space between words. I&#39;ve tried placing the <code>if (row == -1)</code> statement outside of the while loop (before and after), at the end of the while loop and have also tried to change the statement to <code>if(morse_array[row][j] == -1)</code>.I&#39;ve also tried to create a <code>while (row == - 1)</code> loop outside after the first <code>while</code> loop but that does nothing. My thoughts are to have <code>row==-1</code> outside of the <code>while</code> loop but I don&#39;t know how."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6063896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8559d5da4faf6246209d6177e9631c91?s=128&d=identicon&r=PG&f=1", "display_name": "Rozay", "link": "https://stackoverflow.com/users/6063896/rozay"}, "edited": false, "score": 0, "creation_date": 1554928444, "post_id": 55603997, "comment_id": 97934760, "body": "you were right that I need to change the variable. I added a new global variable <code>unsigned int k = 0</code> and set <code>k=0</code> right before the while loop. This worked to help traverse the array"}], "tags": [], "owner": {"reputation": 23, "user_id": 8869645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wrLb6.png?s=128&g=1", "display_name": "Fishezzz", "link": "https://stackoverflow.com/users/8869645/fishezzz"}, "is_accepted": false, "score": 1, "last_activity_date": 1554864338, "creation_date": 1554864338, "answer_id": 55603997, "question_id": 55603978, "link": "https://stackoverflow.com/questions/55603978/infinite-loop-working-for-one-part-of-the-2d-array/55603997#55603997", "title": "Infinite Loop Working for One Part of the 2D Array", "body": "<p>You have your first for-loop where you use variabele 'i'. In that for-loop, you have 2 for-loops that also use variable 'i'.\nLooking at the j++, you should be using variable 'j' for the first for-loop. </p>\n"}], "owner": {"reputation": 25, "user_id": 6063896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8559d5da4faf6246209d6177e9631c91?s=128&d=identicon&r=PG&f=1", "display_name": "Rozay", "link": "https://stackoverflow.com/users/6063896/rozay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554864338, "creation_date": 1554864113, "question_id": 55603978, "link": "https://stackoverflow.com/questions/55603978/infinite-loop-working-for-one-part-of-the-2d-array", "title": "Infinite Loop Working for One Part of the 2D Array", "body": "<p>The code I have works when I compile it in Xcode and run <code>printf</code> statements for the dash and dots for each letter. But when I put the code in the TI Code Composer Studio the code works but it only flashed a light on my microcontroller for the first letter \"G\" of \"Go Knights\". </p>\n\n<p>I know it has something to do with the \"while\" loop but I'm not sure what it is. I've moved everything around, turned flashes on/off, turned my counter off, changed my variables from global to local variables, checked syntax for anything missing, removed the if statement for <code>==-1</code> and nothing has worked</p>\n\n<pre><code>#include &lt;msp430g2553.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nunsigned int i = 0;\nunsigned int j=0;\nint row = 0;\n\nvoid main(void)`\n{\n\nchar str [] = \"Go Knights\";\nint morse_array [36][6] = { //array for A-Z, 0-9 in morse code\n    {0,1,-1},      //'.' = 0 and '-' = 1 and all else = -1\n    {1,0,0,0,-1},\n    {1,0,1,0,-1},\n    {1,0,0,-1},\n    {0,-1},\n    {0,0,1,0,-1},\n    {1,1,0,-1},\n    {0,0,0,0,-1},\n    {0,0,-1},\n    {0,1,1,1,-1},\n    {1,0,1,-1},\n    {0,1,0,0,-1},\n    {1,1,-1},\n    {1,0,-1},\n    {1,1,1,-1},\n    {0,1,1,0,-1},\n    {1,1,0,1,-1},\n    {0,1,0,-1},\n    {0,0,0,-1},\n    {1,-1},\n    {0,0,1,-1},\n    {0,0,0,1,-1},\n    {0,1,1,-1},\n    {1,0,0,1,-1},\n    {1,0,1,1,-1},\n    {1,1,0,0,-1},\n    {1,1,1,1,1,-1},\n    {0,1,1,1,1,-1},\n    {0,0,1,1,1,-1},\n    {0,0,0,1,1,-1},\n    {0,0,0,0,1,-1},\n    {0,0,0,0,0,-1},\n    {1,0,0,0,0,-1},\n    {1,1,0,0,0,-1},\n    {1,1,1,0,0,-1},\n    {1,1,1,1,0,-1}\n};\n\n\nWDTCTL = WDTPW | WDTHOLD;    // stop watchdog timer\nP1DIR |= 0x41;         //set the direction register for LED1 and LED2\nP1OUT &amp;= 0xBE;         //initialize LED1 and LED2 to off*/\n\nfor(;;){               //empty for loop is an infinite loop\n\n    for (i=0; i&lt;strlen(str); i++) {\n        if(str[i] &gt;= 'a' &amp;&amp; str[i] &lt;= 'z'){\n            row = (str[i]- 'a');\n        }\n        else if(str[i] &gt;= 'A' &amp;&amp; str[i] &lt;= 'Z'){\n            row = (str[i]- 'A');\n        }\n        else if(str[i] &gt;= '0' &amp;&amp; str[i] &lt;= '9'){\n            row = (str[i] - '0');\n        }\n        else{\n            row = -1;\n        }\n\n        j= 0;\n\n        while(morse_array[row][j]!= -1){\n            // DOT\n\n            if(row == -1){\n                for(i=0; i&lt;140000; i++);\n                break;\n            }\n            if(morse_array[row][j] == 0) {\n                P1OUT ^= 0x40;\n                for (i=0; i &lt;25000; i++);\n                P1OUT &amp;= 0x00;\n                for (i=0; i &lt;30000;i++);\n            }\n\n            //Dash\n            else if(morse_array[row][j] == 1) {\n                P1OUT ^= 0x40;\n                for (i=0; i&lt;60000; i++);\n                P1OUT &amp;= 0x00;\n                for (i=0; i&lt;30000; i++);\n            }\n\n            j++;\n        }\n    }\n    P1OUT ^= 0x01;\n    for (i=0; i&lt;30000; i++);\n    P1OUT ^= 0x01;\n</code></pre>\n\n<p>}\n}</p>\n"}, {"tags": ["c", "kernel"], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1554862627, "creation_date": 1554862627, "answer_id": 55603795, "question_id": 55603776, "link": "https://stackoverflow.com/questions/55603776/linux-kernel-define-function-that-inside-calls-jiffies/55603795#55603795", "title": "Linux kernel: define function that inside calls &#39;jiffies&#39;", "body": "<p>A macro (<code>#define</code>) is a text replacement.</p>\n\n<p>Every time you write <code>tcp_time_stamp_jiffies</code> the compiler replaces it with <code>((__u32)(jiffies))</code>. It will read the value of <code>jiffies</code> every time.</p>\n"}], "owner": {"reputation": 1, "user_id": 3116383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba22d30e1c976d02ae1ab5dc1b48ce0?s=128&d=identicon&r=PG&f=1", "display_name": "user3116383", "link": "https://stackoverflow.com/users/3116383/user3116383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554901114, "creation_date": 1554862502, "last_edit_date": 1554901114, "question_id": 55603776, "link": "https://stackoverflow.com/questions/55603776/linux-kernel-define-function-that-inside-calls-jiffies", "title": "Linux kernel: define function that inside calls &#39;jiffies&#39;", "body": "<p>In the Linux kernel, I got definition <code>tcp_time_stamp_jiffies</code> that defined just one time at boot:</p>\n\n<pre><code>#define tcp_time_stamp_jiffies         ((__u32)(jiffies))\n</code></pre>\n\n<p>But every calling <code>tcp_time_stamp_jiffies</code>, in method, loop or event, the values is changing .. , and incremented. Isn't the definition define only 1 with value jiffies which at boot only have 1 value, then that value should be used again and again, not calling jiffies again and again?</p>\n\n<p>trying to add custom module/driver which need value <code>tcp_time_stamp jiffies</code> at first boot</p>\n\n<pre><code>#include &lt;linux/proc_fs.h&gt;\n#include &lt;net/tcp.h&gt;\n\n#define tcp_time_stamp_jiffies          ((__u32)(jiffies))\n\nstatic ssize_t myread(struct file *file, char __user *ubuf,size_t count, loff_t *ppos) \n{\n....\nprintk(KERN_ALERT \"tcp_time_stamp_jiffies value : %u\\n\", tcp_time_stamp_jiffies);\n.....\n}\n</code></pre>\n\n<p>expected every function myread is called, it show <code>tcp_time_stamp_jiffies</code> value at first time/boot. instead it show incremented number every called which always different.</p>\n"}, {"tags": ["c", "awk", "c-preprocessor", "preprocessor"], "comments": [{"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1554871918, "post_id": 55603241, "comment_id": 97904984, "body": "How robust does it need to be? For example will it need to be able to ignore <code>#ELIF</code> statements inside strings and comments? How about nested definitions like <code>#ifdef DEBUG1 ... #ifdef DEBUG2 ... #endif ... #endif</code>?"}, {"owner": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "reply_to_user": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1554872072, "post_id": 55603241, "comment_id": 97905019, "body": "It doesn&#39;t need to be that robust. I know the dataset well. There&#39;s no such occurrences, and even if it&#39;s there, it&#39;d be extremely rare."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1554872193, "post_id": 55603241, "comment_id": 97905046, "body": "OK then <a href=\"https://stackoverflow.com/posts/55603241/edit\">edit</a> your question to include at least 1 example of a concise, testable sample input file and the associated expected output so we have something to test a potential solution against so we can help you."}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1554862455, "last_edit_date": 1554862455, "creation_date": 1554860436, "answer_id": 55603542, "question_id": 55603241, "link": "https://stackoverflow.com/questions/55603241/how-do-i-write-an-awk-program-that-matches-ifdef-else-endif-c-pre-process/55603542#55603542", "title": "How do I write an awk program that matches #ifdef...#else...#endif C pre-processor macros?", "body": "<p>Awk actually <em>has</em> associative arrays so the approach I would take would be:</p>\n\n<ol>\n<li><p>For each <code>#ifdef</code> (or equivalent such as <code>#if 1</code>), increment a variable then use that to store the <code>if</code> line number, setting the <code>else</code> and <code>endif</code> line numbers to -1.</p></li>\n<li><p>For an <code>#else</code> line, use the current variable to set  the <code>else</code> line number.</p></li>\n<li><p>For an <code>#endif</code>, output whatever details you have for the line numbers then decrement the variable.</p></li>\n<li><p>For an <code>#elif</code>, you need to combine <code>#else</code> and <code>#if</code> actions and ensure that the relevant <code>#end</code> closes off <em>all</em> the <code>#if/#elif</code> lines.</p></li>\n</ol>\n\n<p>For example, here's a self-contained <code>bash</code> script showing how it could work:</p>\n\n<pre><code>#!/usr/bin/env bash\n\n# Use this script as input file as well, luckily C preprocessor\n# macros look like bash comments.\n\n#ifdef XYZZY\n    # Some text inside the first ifdef\n    #if 0\n        # This is the inner bit.\n    #endif\n    #if 1\n        # blah blah blah\n    #elif defined TWISTY\n        # yada yada yada\n    #elif defined PASSAGES\n        # run out of phrases\n    #else\n        # still got nothing\n    #endif\n#else\n    #ifdef PLUGH\n        # This is the plugh stuff\n    #else\n        # This is the anti-plugh stuff\n    #endif\n#endif\n\nawk &lt;$0 '\n    $1 == \"#ifdef\" || $1 == \"#if\" {\n        level++\n        line_mac[level] = $0\n        gsub(/^[ \\t]+/, \"\", line_mac[level])\n        line_if[level] = NR\n        line_else[level] = \"X\"\n        line_end[level] = \"X\"\n        typ_elif[level] = 0\n        next\n    }\n    $1 == \"#elif\" {\n        line_else[level] = NR\n        level++\n        line_mac[level] = $0\n        gsub(/^[ \\t]+/, \"\", line_mac[level])\n        line_if[level] = NR\n        line_else[level] = \"X\"\n        line_end[level] = \"X\"\n        typ_elif[level] = 1\n        next\n    }\n    $1 == \"#else\" {\n        line_else[level] = NR\n        next\n    }\n    $1 == \"#endif\" {\n        while (typ_elif[level] == 1) {\n            printf \"if-line %-4s, else-line %-4s, endif-line %-4s, macro '%s'\\n\", line_if[level], line_else[level], NR, line_mac[level]\n            level--\n        }\n        printf \"if-line %-4s, else-line %-4s, endif-line %-4s, macro '%s'\\n\", line_if[level], line_else[level], NR, line_mac[level]\n        level--\n    }\n    '\n</code></pre>\n\n<p>The output of that (with numbered lines from the file for checking) is:</p>\n\n<pre><code> 1: #!/usr/bin/env bash\n 2: \n 3: # Use this script as input file as well, luckily C preprocessor\n 4: # macros look like bash comments.\n 5: \n 6: #ifdef XYZZY\n 7:     # Some text inside the first ifdef\n 8:     #if 0\n 9:         # This is the inner bit.\n10:     #endif\n11:     #if 1\n12:         # blah blah blah\n13:     #elif defined TWISTY\n14:         # yada yada yada\n15:     #elif defined PASSAGES\n16:         # run out of phrases\n17:     #else\n18:         # still got nothing\n19:     #endif\n20: #else\n21:     #ifdef PLUGH\n22:         # This is the plugh stuff\n23:     #else\n24:         # This is the anti-plugh stuff\n25:     #endif\n26: #endif\n\nif-line 8   , else-line X   , endif-line 10  , macro #if 0\nif-line 15  , else-line 17  , endif-line 19  , macro #elif defined PASSAGES\nif-line 13  , else-line 15  , endif-line 19  , macro #elif defined TWISTY\nif-line 11  , else-line 13  , endif-line 19  , macro #if 1\nif-line 21  , else-line 23  , endif-line 25  , macro #ifdef PLUGH\nif-line 6   , else-line 20  , endif-line 26  , macro #ifdef XYZZY\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "is_accepted": false, "score": 1, "last_activity_date": 1554863538, "creation_date": 1554863538, "answer_id": 55603906, "question_id": 55603241, "link": "https://stackoverflow.com/questions/55603241/how-do-i-write-an-awk-program-that-matches-ifdef-else-endif-c-pre-process/55603906#55603906", "title": "How do I write an awk program that matches #ifdef...#else...#endif C pre-processor macros?", "body": "<p>To expand on @paxdiablo's answer. If you have <code>gawk</code> and are using multiple files as input, you could take advantage of the <code>BEGINFILE</code> and <code>ENDFILE</code> rules to print the macros from each file.</p>\n\n<p>Note, unlike the <code>BEGIN/END</code> blocks, which only run once at the beginning and end of all input, these are run at the beginning/end of each file (unsuprisingly).</p>\n\n<p>So, a simplified script, ignoring <code>#else</code> etc., for which you could just add additional rules, an awk script like the following might be useful for multiple input files,</p>\n\n<pre><code>#!/usr/bin/awk -f\n\nBEGIN {\n    printf \"%-10s | %-10s | %-5s | %-5s\\n\", \"FILE\", \"MACRO\", \"IFDEF\", \"ENDIF\";\n    print \"----------------------------------------\"\n}\n\nBEGINFILE {\n    delete macros;\n    delete locs;\n    i = 0;\n}\n\n/^[ \\t]*#ifdef[\\t ]+([^ \\t])+/ {\n    macros[i++] = $2;\n    locs[i][\"start\"] = FNR;\n}\n\n/^[ \\t]*#endif/ {\n    locs[--i][\"end\"] = FNR;\n}\n\nENDFILE {\n    for (i = 0; i &lt; length(macros); i++) {\n        printf \"%-10s - %-10s - %-4d - %-4d\\n\", \n            FILENAME, macros[i], locs[i][\"start\"], locs[i][\"end\"];\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Which should output something like the following,</p>\n\n<pre><code>$ ./defs.awk tst.h tst2.h \n\nFILE       | MACRO      | IFDEF | ENDIF\n----------------------------------------\ntst.h      - DEBUG1     - 0    - 5   \ntst.h      - INNER1     - 1    - 4   \ntst2.h     - DEBUG2     - 0    - 3   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1554889899, "post_id": 55605101, "comment_id": 97913700, "body": "Ed, you can grab the first 26 lines of the script in my answer for testing, that should at least give you a level of confidence that it works."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1554896113, "post_id": 55605101, "comment_id": 97917212, "body": "@paxdiablo thanks but your example is covering cases that I asked about in a comment and <a href=\"https://stackoverflow.com/questions/55603241/how-do-i-write-an-awk-program-that-matches-ifdef-else-endif-c-pre-process/55605101?noredirect=1#comment97905019_55603241\">the OP said don&#39;t exist</a> in her data and so my script won&#39;t handle."}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1554937257, "post_id": 55605101, "comment_id": 97937800, "body": "I was trying your script out to try understand it better (my awk foo is weak), but was getting slightly wrong results. It looked like it was probably something simple like an off-by-1 thing."}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1554937473, "post_id": 55605101, "comment_id": 97937870, "body": "I&#39;m curious, do you generally prefer the weird array indices concatenation over multi-dimensional arrays in awk? Is it much of a performance boost?"}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1554950616, "post_id": 55605101, "comment_id": 97940530, "body": "@jenesaisquoi I don&#39;t consider performance when choosing which array indexing to use, just portability and conciseness. <code>arr[x,y]</code> will work in any awk while <code>arr[x][y]</code> is gawk-only so I use the former unless there&#39;s a reason to use the latter such as it makes the code noticeably more concise."}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1554950985, "post_id": 55605101, "comment_id": 97940593, "body": "thanks, I thought that might be the case but wasn&#39;t sure since you were using other gawk features.  I was just reading through the manual a bit today and was having trouble wrapping my head around that style"}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1554951259, "post_id": 55605101, "comment_id": 97940634, "body": "@jenesaisquoi I&#39;d been using that style for literally about a quarter century before gawk came up with the other style so I&#39;ve had some time to get used to it :-)."}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1554959448, "post_id": 55605101, "comment_id": 97942349, "body": "haha that&#39;s crazy, I guess its been around long enough to have spawned perl and then some"}], "tags": [], "owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "is_accepted": false, "score": 1, "last_activity_date": 1554873056, "creation_date": 1554873056, "answer_id": 55605101, "question_id": 55603241, "link": "https://stackoverflow.com/questions/55603241/how-do-i-write-an-awk-program-that-matches-ifdef-else-endif-c-pre-process/55605101#55605101", "title": "How do I write an awk program that matches #ifdef...#else...#endif C pre-processor macros?", "body": "<p>Given <a href=\"https://stackoverflow.com/questions/55603241/how-do-i-write-an-awk-program-that-matches-ifdef-else-endif-c-pre-process?noredirect=1#comment97905019_55603241\">your comment</a> something like this should be all you need (using GNU awk for ENDFILE and ARGIND):</p>\n\n<pre><code>awk '\n{ hit = 0 }\n$1 == \"#ifdef\" {\n    macroname = $2\n    count[macroname]++\n    hit = 1\n}\n$1 ~ /#(else|endif)$/ { hit = 1 }\nhit { fnr[macroname,count[macroname],$1] = FNR; hit = 0 }\nENDFILE {\n    if (ARGIND == 1) {\n        print \"FILE\", \"MACRO_NAME\", \"IFDEF\", \"ELIF\", \"ENDIF\"\n    }\n    for (macroname in count) {\n        for (i=1; i&lt;=count[macroname]; i++) {\n            print FILENAME, macroname, fnr[macroname,i,\"#ifdef\"]+0, fnr[macroname,i,\"#elif\"]+0, fnr[macroname,i,\"#endif\"]+0\n        }\n    }\n    delete count\n    delete fnr\n}\n' *.c\n</code></pre>\n\n<p>It's untested of course since you didn't provide an example we could test against. Set <code>OFS</code> or use <code>printf</code> or pipe to <code>column</code> to get differently formatted output if you care.</p>\n"}], "owner": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1554873056, "creation_date": 1554857601, "question_id": 55603241, "link": "https://stackoverflow.com/questions/55603241/how-do-i-write-an-awk-program-that-matches-ifdef-else-endif-c-pre-process", "title": "How do I write an awk program that matches #ifdef...#else...#endif C pre-processor macros?", "body": "<p>I have a large corpus of C programs that have the following code blocks.</p>\n\n<pre><code>100. #ifdef DEBUG1\n    .\n    .\n    .\n102. #else    \n    .\n    .\n    .\n105. #endif\n</code></pre>\n\n<p>or,</p>\n\n<pre><code>200. #ifdef DEBUG2\n    .\n    .\n    .\n206. #endif\n</code></pre>\n\n<p>Moreover, a single file may contain multiple <code>#DEBUG</code> macros. I want to extract the line numbers corresponding to the macros. Assuming the numbers in the code snippet are the line numbers in the source file, I want the output to be in the following format:</p>\n\n<pre><code>FILE - MACRO_NAME - IFDEF - ELIF - ENDIF\n----------------------------------------\nprog.c - DEBUG1   -  100  -  102  -  105\nprog.c - DEBUG2   -  200  -   X   -  206\n</code></pre>\n\n<p>How can I write an <code>awk</code> program to achieve the same? If <code>awk</code> is not the appropriate tool, what tool can I use?</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 2, "creation_date": 1554869573, "post_id": 55603144, "comment_id": 97904423, "body": "<code>if (rank == 0)</code> is basically your only option here. Assuming only <code>MATVEC</code> should be called by all the processes, then all the processes must enter the <code>while(norm &gt; EPS)</code> loop and all have the same <code>norm</code> when the condition is evaluated."}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 1, "creation_date": 1554880968, "post_id": 55603144, "comment_id": 97908458, "body": "If there is only the process 0 who free the allocated memory, you will have some memory leak."}], "owner": {"reputation": 41, "user_id": 11321812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8acf3e35e2bf910d2998ef9956acf83?s=128&d=identicon&r=PG&f=1", "display_name": "Valery", "link": "https://stackoverflow.com/users/11321812/valery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554875710, "creation_date": 1554856741, "last_edit_date": 1554875710, "question_id": 55603144, "link": "https://stackoverflow.com/questions/55603144/how-do-i-prevent-other-processes-from-performing-certain-lines-of-code", "title": "How do I prevent other processes from performing certain lines of code?", "body": "<p>I'm using MPI to perform some calculations on a specific function. I only need MPI for that specific function, so my question is, when I initialise MPI in my main function how do I make sure that whatever code I'm writing is only performed by the process with rank 0.</p>\n\n<p>I've tried putting everything under an <code>if (rank == 0)</code> but the code doesn't seem to work.</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n\n    int num_procs, my_id;\n    int *count, *disp;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;my_id);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;num_procs);\n\n    int i, j, N, k;\n    double u, l, h;\n    double *A, *b1, *b2, *x, *xo, x1bound, x2bound, y1bound, y2bound;\n    double norm, sum, dot, tmp;\n\n    l = -10;\n    u = 10;\n    h = 0.5;\n    tmp = (u-l)/h;\n    N = floor(tmp);\n\n    A = (double*)calloc(N*N,sizeof(double));\n    b1 = (double *)calloc(N,sizeof(double));\n    x = (double *)malloc(sizeof(double)*N);\n    xo = (double *)malloc(N*sizeof(double));\n    for (i = 0; i &lt; N; i++)\n     xo[i] = 0.0;\n\n    count = (int*) calloc(num_procs, sizeof(int));\n    disp = (int*) calloc(num_procs, sizeof(int));\n\n    A[0] = -2.0;\n    A[1] = 1.0;\n    for (i = 1; i &lt; N; i++)\n      {\n        A[i*N+i] = -2.0;\n        A[i*N+i+1] = 1.0;\n        A[i*N+i-1] = 1.0;\n      }\n    for (i = 0; i &lt; N; i++)\n      b1[i] = (l + i*h);\n\n    func(&amp;b1, N, h);\n    x1bound = 0;\n    y1bound = 0;\n    x2bound = 1;\n    y2bound = 0;\n\n    i = index_of(x1bound, l, h);\n    A[i*N+i] = 1.0;\n    A[i*N+i+1] = 0.0;\n    A[i*N+i-1] = 0.0;\n    b1[i] = y1bound;\n\n    i = index_of(x2bound, l, h);\n    A[i*N+i] = 1.0;\n    A[i*N+i+1] = 0.0;\n    A[i*N+i-1] = 0.0;\n    b1[i] = y2bound;\n\n    k = 0;\n    norm = INF;\n    while (norm &gt; EPS)\n      {\n        dot = 0.0;\n        MATVEC(N,N,A,xo,&amp;b2,num_procs,my_id,count,disp,MPI_COMM_WORLD);\n        for (i = 0; i &lt; N; i++)\n          {         \n            x[i] = (b1[i] - b2[i])/(A[i*N+i]);\n            dot += (x[i] - xo[i])*(x[i] - xo[i]);\n          }\n        for (i = 0; i &lt; N; i++)\n          xo[i] = x[i];\n        printf(\"from %d dot = %lf\\n\",my_id,dot);\n        norm = sqrt(dot);\n        k++;\n        MPI_Bcast(xo,N,MPI_DOUBLE,0,MPI_COMM_WORLD);\n        MPI_Barrier(MPI_COMM_WORLD);\n      }\n        if(my_id == 0);\n        {\n          printf(\"After %d operations we obtained\\n\", k);\n          for(i = 0; i &lt; N; i++)\n            printf(\"%lf\\n\", x[i]);\n\n        free(x); free(xo);\n        free(b1); free(b2);\n        free(A);\n        }\n\n    MPI_Barrier(MPI_COMM_WORLD);\n    MPI_Finalize();\n}\n</code></pre>\n"}]