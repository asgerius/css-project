[{"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1561594185, "post_id": 56782138, "comment_id": 100119519, "body": "Use for loops instead of those whiles. Easier to read"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1561594318, "post_id": 56782138, "comment_id": 100119539, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> i.e. the entire program required. And does the resulting BMP image open - if so then you should convert the image to PNG and add it to then question."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1561615449, "post_id": 56782138, "comment_id": 100123751, "body": "Please describe the issues. Is the image generated at all? Is it distorted? Wrong size? What information do you get about the image when you open it with another viewer (e.g. IrfanView)? Does the code even compile?"}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1561615932, "post_id": 56782138, "comment_id": 100123925, "body": "Please enable all warnings in the compiler and correct everything reported. Also, it would be nice to provide at least the function declaration with its parameters."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1561636152, "post_id": 56782138, "comment_id": 100134930, "body": "What are the actual values of the biClrUsed and biBitCount field in your file&#39;s BITMAPINFOHEADER?"}], "answers": [{"tags": [], "owner": {"reputation": 4475, "user_id": 5577076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qG4gB.png?s=128&g=1", "display_name": "DinoCoderSaurus", "link": "https://stackoverflow.com/users/5577076/dinocodersaurus"}, "is_accepted": false, "score": 0, "last_activity_date": 1561646513, "creation_date": 1561646513, "answer_id": 56793515, "question_id": 56782138, "link": "https://stackoverflow.com/questions/56782138/i-have-an-issue-with-my-program-not-resizing-the-image-correctly/56793515#56793515", "title": "I have an issue with my program not resizing the image correctly", "body": "<p>The <code>j</code> loop is the culprit. The program will process each scanline <code>width * factor</code> times instead of <code>factor</code> times. It adds an extra <code>width</code> iterations to each scanline. </p>\n"}], "owner": {"reputation": 1, "user_id": 11700279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LsLMZdz7tIY/AAAAAAAAAAI/AAAAAAAAAQc/A7_i2BcVTs0/photo.jpg?sz=128", "display_name": "Nick Harding", "link": "https://stackoverflow.com/users/11700279/nick-harding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1564398268, "creation_date": 1561591885, "last_edit_date": 1564398268, "question_id": 56782138, "link": "https://stackoverflow.com/questions/56782138/i-have-an-issue-with-my-program-not-resizing-the-image-correctly", "title": "I have an issue with my program not resizing the image correctly", "body": "<p>The code is supposed to take 3 arguments and output an image scaled by the specified factor which is between 1 and 100, currently I'm getting an image that doesn't match the expected output.</p>\n\n<p>I'm going to say that the issue is somewhere in the loops, or possibly in the new file sizing.</p>\n\n<p>I get these issues even when the factor is set to 1.</p>\n\n<pre><code>// set new height and width of BMP\nbi_New.biHeight = bi.biHeight * factor;\nbi_New.biWidth = bi.biWidth * factor;\n\n// calculate padding for old file and new file\nint padding = (4 - (bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\nint padding_New = (4 - (bi_New.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n\n// set the file size for the new file\nbf_New.bfSize = 54 + (bi_New.biWidth * sizeof(RGBTRIPLE) + padding_New) * abs(bi_New.biHeight);\nbi_New.biSizeImage = bf_New.bfSize - 54;\n\n\n// write outfile's BITMAPFILEHEADER\nfwrite(&amp;bf_New, sizeof(BITMAPFILEHEADER), 1, outptr);\n\n// write outfile's BITMAPINFOHEADER\nfwrite(&amp;bi_New, sizeof(BITMAPINFOHEADER), 1, outptr);\n\n// iterate over infile's scanlines\nfor (int i = 0, biHeight = abs(bi.biHeight); i &lt; biHeight; i++)\n    {\n    // iterate over pixels in scanline\n    for (int j = 0; j &lt; bi.biWidth; j++)\n        {\n        // intialise counter to print rows by amount of the factor\n        int counter = 0;\n\n        // while loop to keep continuing until factor is less than or equal to counter\n        while (counter &lt; factor)\n            {\n            // iterate over pixels in scanline\n            for(int k = 0; k &lt; bi.biWidth; k++)\n                {\n                // temporary storage\n                RGBTRIPLE triple;\n\n                // declare pixel counter\n                int pixel_counter = 0;\n\n                // read RGB triple from infile\n                fread(&amp;triple, sizeof(RGBTRIPLE), 1, inptr);\n\n                // write RGB triple to outfile and use a while loop to iterate the same pixel by factor times\n                while (pixel_counter &lt; factor)\n                    {\n                    fwrite(&amp;triple, sizeof(RGBTRIPLE), 1, outptr);\n                    pixel_counter++;\n                    }\n                }\n            // add new padding\n            for (int l = 0; l &lt; padding_New; l++)\n                {\n                fputc(0x00, outptr);\n                }\n\n            // seek back to the beginning of row in input file, but not after iteration of printing\n            if (counter &lt; (factor - 1))\n                {\n                fseek(inptr, -(bi.biWidth * sizeof(RGBTRIPLE)), SEEK_CUR);\n                }\n            counter++;\n            }\n        }\n\n    // skip over padding, if any\n    fseek(inptr, padding, SEEK_CUR);\n    }\n\n// close infile\nfclose(inptr);\n\n// close outfile\nfclose(outptr);\n\n// success\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1561591787, "post_id": 56782119, "comment_id": 100119079, "body": "It doesn&#39;t seem to make much sense to just have the same array in reverse order. Why not just iterate in reverse if necessary? In any case, you want an array of <code>points*</code> using pointers."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1561591907, "post_id": 56782119, "comment_id": 100119102, "body": "If you&#39;re going to avoid duplication, your second array would need to be an array of pointers to the values in the first array.  If both arrays must be arrays of structures, then you&#39;re stuck with replicating the data (unless, I suppose, every entry in the structures is a pointer \u2014 then you could make the elements of both the arrays point to the same data).  But this seems to be something of an <a href=\"http://mywiki.wooledge.org/XyProblem\" rel=\"nofollow noreferrer\">XY Problem</a>.  What are you trying to do that you think the reversed array is a good idea but copying the data is not?"}, {"owner": {"reputation": 617, "user_id": 10638652, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4rceG73EzQM/AAAAAAAAAAI/AAAAAAAAAAA/OjqKVhzWcb0/photo.jpg?sz=128", "display_name": "Mario Abbruscato", "link": "https://stackoverflow.com/users/10638652/mario-abbruscato"}, "edited": false, "score": 0, "creation_date": 1561592620, "post_id": 56782119, "comment_id": 100119249, "body": "Yes , using a function to reverse an array  do not have sense but the problem is not the function , but how to use an array of points* .  In reality in would use function to sort structures by x or y or z  without replicating data.  an example on how to use pointer arrays will be appreciated. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1561603053, "post_id": 56783093, "comment_id": 100120890, "body": "A whole new struct just to hold a pointer? That&#39;s not necessary and just adds confusion!"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1561605750, "post_id": 56783093, "comment_id": 100121352, "body": "A <code>struct</code> to hold a pointer generally indicates a design mis-step. This solution solves the problem, but is overly complex."}], "tags": [], "owner": {"reputation": 617, "user_id": 10638652, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4rceG73EzQM/AAAAAAAAAAI/AAAAAAAAAAA/OjqKVhzWcb0/photo.jpg?sz=128", "display_name": "Mario Abbruscato", "link": "https://stackoverflow.com/users/10638652/mario-abbruscato"}, "is_accepted": false, "score": -1, "last_activity_date": 1561602296, "creation_date": 1561602296, "answer_id": 56783093, "question_id": 56782119, "link": "https://stackoverflow.com/questions/56782119/c-pointing-members-of-array-of-struct-into-another-array-no-duplicate-struct/56783093#56783093", "title": "C - pointing members of array of struct into another array ( no duplicate struct data just point to it )", "body": "<p>I added an other struct with one element that is a pointer </p>\n\n<pre><code>typedef struct ptr_point{\n    point * p;\n} ptr_point;\n</code></pre>\n\n<p>I edited the function reversePoints </p>\n\n<pre><code>void reversePoints(point *pts, int len, ptr_point *rev){\n\n    // This function is used only to test pointers \n\n    int i = 0;\n    int j = len;\n\n    while (i &lt; len){\n        j=len-i-1;\n        rev[j].p = &amp;pts[i];\n        i++;\n    }\n}\n</code></pre>\n\n<p>and added another function to print ptr_points </p>\n\n<pre><code>void printPtrPoints(ptr_point *pts,int len){\n    int i = 0;\n    while (i &lt; len){\n        printf(\"id %d x %f y%f z %f\\n\",pts-&gt;p-&gt;id,pts-&gt;p-&gt;x,pts-&gt;p-&gt;y,pts-&gt;p-&gt;z);\n        pts++;\n        i++;\n    }\n}\n</code></pre>\n\n<p>and declaring the second array as ptr_point array </p>\n\n<pre><code>ptr_point rev_points[len];\n</code></pre>\n\n<p>In conclusion :  now data in the second array are not replicated but pointing to element structure of the first array. </p>\n\n<p>The need to not replicate data arise in presence of millions of coordinate points that if replicate more than one time , sorting it for example by x, y, z and so on , occupe much memory  with the difficulty of managing .    </p>\n\n<p>This fix  however forces me to use structures->type in order to change the access mode to read or set values. </p>\n\n<p>I don't know if this is the best solution but it has solved the problem for not duplicate the data. </p>\n\n<p>you can run the source with fixes  here:  <a href=\"https://onlinegdb.com/SknP_i-eS\" rel=\"nofollow noreferrer\">https://onlinegdb.com/SknP_i-eS</a></p>\n\n<p>Thank you all for the advice. </p>\n"}, {"tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1561609977, "last_edit_date": 1561609977, "creation_date": 1561604221, "answer_id": 56783282, "question_id": 56782119, "link": "https://stackoverflow.com/questions/56782119/c-pointing-members-of-array-of-struct-into-another-array-no-duplicate-struct/56783282#56783282", "title": "C - pointing members of array of struct into another array ( no duplicate struct data just point to it )", "body": "<p>One way to look at this is a set of points and two permutations on the set. This sets up a <code>points</code> array, which is used as a set, and <code>forward_points</code> and <code>reverse_points</code> as arrays of pointers to the <code>point</code> array that we are going to use as permutations.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct Point {\n    int id;\n    float x,y,z;\n};\n\n/* Print a point. */\nstatic void printPoint(struct Point *point) {\n    printf(\"id %d x %f y%f z %f\\n\",point-&gt;id,point-&gt;x,point-&gt;y,point-&gt;z);\n}\n\n/* These print out an array of pointers to point. */\nstatic void printPointsRef(struct Point **ref, int len) {\n    struct Point **end = ref + len;\n    while(ref &lt; end) printPoint(*(ref++));\n}\n\n/* This translates all the `pts` up to `len` by `(1,1,1)*t`. */\nstatic void translatePoints(struct Point *pts, int len, float t) {\n    struct Point *end = pts + len;\n    while(pts &lt; end) {\n\n        pts-&gt;x = pts-&gt;x + t;\n        pts-&gt;y = pts-&gt;y + t;\n        pts-&gt;z = pts-&gt;z + t;\n\n        pts++;\n    }\n}\n\n/* Helper function to `main`. */\nstatic void printPoints(struct Point **forward_points,\n    struct Point **reverse_points, int len) {\n    printf(\"print points\\nprint points forward:\\n\");\n    printPointsRef(forward_points,len);\n    printf(\"print points reverse:\\n\");\n    printPointsRef(reverse_points,len);\n    printf(\"\\n\");\n}\n\nint main(void)\n{\n    const int len = 3;\n\n    /* This is the actual points structure. */\n    struct Point points[len];\n\n    /* These are arrays of pointers to points; they are\n     permutations of `points`. */\n    struct Point *forward_points[len], *reverse_points[len];\n\n    int i;\n\n    const int t1=200;\n\n    for(i=0; i&lt;len; i++) {\n\n        /* Initialise element `i` of `points`. */\n        points[i].id=i;\n        points[i].x=10+i;\n        points[i].y=20+i;\n        points[i].z=30+i;\n\n        /* Initialise element `i` of `forward_points`\n         to point to `points[i]`, and `backward_points`\n         to point the other way (it doesn't matter that\n         the backwards points are uninitialised, they\n         will be.) */\n        forward_points[i] = &amp;points[i];\n        reverse_points[i] = &amp;points[len - 1 - i];\n    }\n\n    printPoints(forward_points, reverse_points, len);\n\n    /* Translation is a vector space operation and doesn't\n     care about order; we just do it on the original points. */\n    printf(\"translate points %d...\\n\\n\",t1);\n    translatePoints(points,len,t1);\n\n    printPoints(forward_points, reverse_points, len);\n\n    return 0;\n\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4gVXO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4gVXO.png\" alt=\"Schematic of the code.\"></a></p>\n\n<p>Of course, there is no integrity constraints on the pointers; nothing stopping one from pointing at anything, null, the same elements, or anything else.</p>\n"}], "owner": {"reputation": 617, "user_id": 10638652, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4rceG73EzQM/AAAAAAAAAAI/AAAAAAAAAAA/OjqKVhzWcb0/photo.jpg?sz=128", "display_name": "Mario Abbruscato", "link": "https://stackoverflow.com/users/10638652/mario-abbruscato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1561609977, "creation_date": 1561591695, "last_edit_date": 1561591795, "question_id": 56782119, "link": "https://stackoverflow.com/questions/56782119/c-pointing-members-of-array-of-struct-into-another-array-no-duplicate-struct", "title": "C - pointing members of array of struct into another array ( no duplicate struct data just point to it )", "body": "<p>I have two identical arrays of struct  , one  in reverse order. \nThe problem is that i don't want duplicate the same data  into the two arrays ,  i would a reversed array with elements pointing elements of the first array in a way that i can edit the members of struct of first array or from the reversed array taking effect in both. </p>\n\n<p>you can view the source and run it online here  <a href=\"https://onlinegdb.com/SJbepdWxS\" rel=\"nofollow noreferrer\">https://onlinegdb.com/SJbepdWxS</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct point{\n    int id;\n    float x,y,z;\n} point;\n\nvoid printPoints(point *pts,int len){\n    int i = 0;\n    while (pts !=NULL &amp;&amp; i &lt; len){\n        printf(\"id %d x %f y%f z %f\\n\",pts-&gt;id,pts-&gt;x,pts-&gt;y,pts-&gt;z);\n        pts++;\n        i++;\n    }\n}\nvoid translatePoints(point *pts,int len,float t){\n    int i = 0;\n    while (pts !=NULL &amp;&amp; i &lt; len){\n\n        pts-&gt;x = pts-&gt;x + t;\n        pts-&gt;y = pts-&gt;y + t;\n        pts-&gt;z = pts-&gt;z + t;\n\n        pts++;\n        i++;\n    }\n}\n\nvoid reversePoints(point *pts, int len, point *rev){\n    int i = 0;\n    int j = len;\n    while (i &lt; len){\n        j=len-i-1;\n        rev[j]=pts[i];\n        i++;\n    }\n}\n\nint main()\n{\n\n    int i;\n\n    int t1=200;\n    int t2=300;\n\n    int len=3;\n    point points[len];\n    point rev_points[len];\n\n\n    for(i=0; i&lt;len ; i++){\n        points[i].id=i;\n        points[i].x=10+i;\n        points[i].y=20+i;\n        points[i].z=30+i;\n    }\n\n\n    //point * pts = points;\n    printf(\"\\nprint points \\n\\n\");\n    printPoints(points,len);\n    printf(\"\\ntranslate points %d...\\n\\n\",t1);\n    translatePoints(points,len,t1);\n    printf(\"\\nprint points\\n\\n\");\n\n    printf(\"\\nreverse points to rev_points\\n\");\n    reversePoints(points,len,rev_points);\n\n    printf(\"\\nprint rev_points \\n\\n\");\n    printPoints(rev_points,len);\n\n    printf(\"\\ntranslate rev_points %d...\\n\\n\",t2);\n    translatePoints(rev_points,len,t2);\n\n    printf(\"\\nprint rev_points\\n\\n\");\n    printPoints(rev_points,len);\n\n    printf(\"\\nprint points\\n\\n\");\n    printPoints(points,len);\n\n    return 0;\n\n}\n</code></pre>\n\n<p>I expect that struct values of both arrays change when i change value in one of the two array.</p>\n\n<p>But changing values of struct in the first array ,  the second array not changes and the other way around.</p>\n"}, {"tags": ["c", "pam"], "owner": {"reputation": 131, "user_id": 2494562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73490f476dd68a87f3bb0f1b38f889bf?s=128&d=identicon&r=PG", "display_name": "nununoisy", "link": "https://stackoverflow.com/users/2494562/nununoisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1561589026, "creation_date": 1561589026, "question_id": 56781800, "link": "https://stackoverflow.com/questions/56781800/is-there-any-way-to-get-the-name-of-the-current-pam-module", "title": "Is there any way to get the name of the current PAM module?", "body": "<p>I'm trying to add some functionality to <a href=\"https://github.com/Lixxia/i3lock\" rel=\"nofollow noreferrer\">Lixxia's fork of i3lock</a>. I figured out how to read <code>pam_conv</code> messages and use <code>cairo</code> to display them on-screen.</p>\n\n<p>I thought since my PAM stack is larger than most, it would be nice to show an icon to help identify how to authenticate. A password icon for trying your password, a fingerprint for <code>fprintd</code>, a USB key icon for <code>pam-u2f</code>, etc. </p>\n\n<p>I've already tried <code>pam_get_item(pam_handle, PAM_SERVICE, &amp;service)</code>, but it only returns <code>i3lock</code> since that is the filename of the PAM stack.</p>\n\n<p>Is there any way to get the name of the current module (like <code>pam-fprintd.so</code> or similar)?</p>\n"}, {"tags": ["c", "linked-list", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1561587017, "post_id": 56781541, "comment_id": 100117941, "body": "What debugging have you done? Where have you narrowed the problem down to?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1561587130, "post_id": 56781541, "comment_id": 100117970, "body": "It can be simpler: <code>while(l != NULL) { printf(&quot;%d &quot;,l-&gt;value); l = l-&gt;next; }</code> . Aside, please do not use <code>l</code> as a variable name. It looks too much like <code>1</code>."}, {"owner": {"reputation": 26, "user_id": 11705522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae60b9568725a6ef556d542295ae5d45?s=128&d=identicon&r=PG&f=1", "display_name": "DaveAC", "link": "https://stackoverflow.com/users/11705522/daveac"}, "edited": false, "score": 0, "creation_date": 1561588063, "post_id": 56781541, "comment_id": 100118222, "body": "l wouldn&#39;t have been my choice either, but a portion of the program was written for us, including the area where l is a variable. The only part of the code that is mine/that I need to edit is the struct list* solution(){}"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1561588853, "post_id": 56781541, "comment_id": 100118431, "body": "Welcome to Stack Overflow! <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1561589021, "post_id": 56781541, "comment_id": 100118469, "body": "You&#39;re not allocating a linked list. You&#39;re allocating an array of <code>List</code> objects."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1561589077, "post_id": 56781541, "comment_id": 100118481, "body": "<code>listpointer2[n].next</code> has never been assigned any value, what do you expect <code>listpointer[n].next = listpointer2[n].next;</code> to do?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1561594509, "post_id": 56781541, "comment_id": 100119567, "body": "@barmar sizeof is wrong there too"}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 11705522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae60b9568725a6ef556d542295ae5d45?s=128&d=identicon&r=PG&f=1", "display_name": "DaveAC", "link": "https://stackoverflow.com/users/11705522/daveac"}, "edited": false, "score": 0, "creation_date": 1561594278, "post_id": 56781906, "comment_id": 100119533, "body": "That works. Thank you for the explanation and code."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1561589894, "creation_date": 1561589894, "answer_id": 56781906, "question_id": 56781541, "link": "https://stackoverflow.com/questions/56781541/malloc-linked-list-in-c/56781906#56781906", "title": "Malloc linked-list in c", "body": "<p>You should not be allocating an array. When creating a linked list, you allocate one list node each time through the loop.</p>\n\n<p>You need two variables -- <code>head</code> is a pointer to the first node in the list, the <code>listpointer</code> is pointer to the last element, where we want to append the next node.</p>\n\n<pre><code>struct list* solution()\n{\n    int n = 0, a;\n    List *listpointer = NULL;\n    List *head = NULL;\n    while(1)\n    {\n        scanf(\"%d\", &amp;a);\n        if(a &lt; 0)\n        {\n            break;\n        }\n        List *newNode = malloc(sizeof(List));\n        newNode-&gt;value = a;\n        newNode-&gt;next = NULL;\n        if (listpointer) {\n            listpointer-&gt;next = newNode;\n            listpointer = newNode;\n        } else {\n            listpointer = newNode;\n            head = newNode;\n        }\n    }\n\n    return head;\n}\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 11705522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae60b9568725a6ef556d542295ae5d45?s=128&d=identicon&r=PG&f=1", "display_name": "DaveAC", "link": "https://stackoverflow.com/users/11705522/daveac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 56781906, "answer_count": 1, "score": -1, "last_activity_date": 1561589894, "creation_date": 1561586954, "last_edit_date": 1561588888, "question_id": 56781541, "link": "https://stackoverflow.com/questions/56781541/malloc-linked-list-in-c", "title": "Malloc linked-list in c", "body": "<p>I'm new to C. I need to create a linked-list in c using malloc, I'm supposed to create my solution within struct list* solution(). Given A list of numbers I need them to display until the int -1 is given. After creating linked list, return a pointer to the root node of the linked list.So far I can only get one number to appear after the program has been executed. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\ntypedef struct list{\n    int value;\n    struct list *next;\n} List ;\n\nstruct list* solution()\n{\n    int n = 0, a;\n    List *listpointer;\n    List *listpointer2;\n    listpointer = ( List* ) malloc( 200 * sizeof(List*));\n    listpointer2 = ( List* ) malloc( 200 * sizeof(List*));\n    //for(n = 0; n &lt; 7; n++)\n    do   \n    {\n        scanf(\"%d\", &amp;a);\n        if(a &lt; 0)\n        {\n            listpointer[n].next = NULL;   \n            break;\n        }\n        listpointer[n].value = a;\n        listpointer[n].next = listpointer2[n].next;\n\n        n++;\n        //scanf(\"%d\", &amp;a);\n        //listpointer2[n].value = a;\n        //listpointer2[n].next = listpointer2[n].value;\n    }while( a &gt; 0);\n\n    return listpointer;\n}\n\nint main()\n{\n    struct list *l=NULL,*temp;\n    l = solution();\n    if(l==NULL)\n        printf(\"list is empty\");\n    else\n    {\n        do{\n            printf(\"%d \",l-&gt;value);\n            temp = l;\n            l = l-&gt;next;\n        }while(temp-&gt;next!=NULL);\n    }\n}\n</code></pre>\n\n<p>I expect the output to be 2 6 4 7 8 2 9 but so far Am only able to produce the output of just 2 or just 9.</p>\n"}, {"tags": ["python", "c", "hash", "binary", "bit-manipulation"], "comments": [{"owner": {"reputation": 10059, "user_id": 4819449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Sbkk.png?s=128&g=1", "display_name": "FHTMitchell", "link": "https://stackoverflow.com/users/4819449/fhtmitchell"}, "edited": false, "score": 0, "creation_date": 1561586869, "post_id": 56781505, "comment_id": 100117901, "body": "So what&#39;s the problem exactly? Because that output does not match your python code at all."}, {"owner": {"reputation": 29, "user_id": 9460902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mTB6agn7Qjk/AAAAAAAAAAI/AAAAAAAAAA0/FXgRL-Z2nF8/photo.jpg?sz=128", "display_name": "Gibran Akbaromi", "link": "https://stackoverflow.com/users/9460902/gibran-akbaromi"}, "reply_to_user": {"reputation": 10059, "user_id": 4819449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Sbkk.png?s=128&g=1", "display_name": "FHTMitchell", "link": "https://stackoverflow.com/users/4819449/fhtmitchell"}, "edited": false, "score": 0, "creation_date": 1561590622, "post_id": 56781505, "comment_id": 100118838, "body": "@FHTMitchell i want the output not binary, string that contain hexadecimal would be great"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 0, "last_activity_date": 1561642419, "creation_date": 1561642419, "answer_id": 56792242, "question_id": 56781505, "link": "https://stackoverflow.com/questions/56781505/python-data-type-after-bitwise-operation-from-c-language/56792242#56792242", "title": "python data type after bitwise operation (from c language)", "body": "<p>There's an error in the conversion from C to Python - the C line</p>\n\n<pre><code>    buf ^= (1&amp;x[i])&lt;&lt;(7-(i%8));\n</code></pre>\n\n<p>has been translated to the Python line</p>\n\n<pre><code>    buf ^= (1 &amp; x[i] &lt;&lt; (7 - (i%8)))\n</code></pre>\n\n<p>whereby a parenthesis has been misplaced. The C line should rather have been copied as it was, just removing the <code>;</code>.</p>\n"}], "owner": {"reputation": 29, "user_id": 9460902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mTB6agn7Qjk/AAAAAAAAAAI/AAAAAAAAAA0/FXgRL-Z2nF8/photo.jpg?sz=128", "display_name": "Gibran Akbaromi", "link": "https://stackoverflow.com/users/9460902/gibran-akbaromi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56792242, "answer_count": 1, "score": -1, "last_activity_date": 1561642419, "creation_date": 1561586627, "question_id": 56781505, "link": "https://stackoverflow.com/questions/56781505/python-data-type-after-bitwise-operation-from-c-language", "title": "python data type after bitwise operation (from c language)", "body": "<p>i have been trying to convert one of the method from hashing quark, that originaly from c language, and im trying to change it to python, this method is used for showing the current state of hash, and i found a problem that my output, the pytho one, only give the output with binary, and the output that i was expecting is everything except binary, and how do i convert it? or are there is any other way to manipulate it?</p>\n\n<p>code from python</p>\n\n<pre><code>def showstate(x):\n    i = 0\n    buf = 0\n    width = 17\n    #print (x)\n\n    while i &lt; 8 * width:\n        buf ^= (1 &amp; x[i] &lt;&lt; (7 - (i%8)))\n\n        #my_hex = buf.decode('hex')\n\n        #print (\"%d\"%buf, end = '')\n        if  (((i%8) == 7) and (i)):\n            #print (\" \".join(hex(ord(n)) for n in buf))\n            #a = int(str(buf), 2)\n            #print(a)\n            print(\"%02x\"%buf, end = '')\n            buf = 0\n        i += 1\n\n    #print(x)\n     #print (\"/n\") \n\n</code></pre>\n\n<p>output from python</p>\n\n<pre><code>ENTER PERMUTE\n0000000001000101000100010001010100\nPERMUTE DONE\n0000000001000101010100000100010101\nEXTRACTED ONE BYTE\n\nENTER PERMUTE\n0000000001000101010100000100010101\nPERMUTE DONE\n0000000001000101010100000101000100\nEXTRACTED ONE BYTE\n</code></pre>\n\n<p>code from c</p>\n\n<pre><code>void showstate( u32 * x ) {\n\n  int i;\n  u8 buf=0;\n  for(i=0;i&lt;8*WIDTH;++i) {\n    buf ^= (1&amp;x[i])&lt;&lt;(7-(i%8));\n      /*printf(\"%d\",buf);*/\n    if (((i%8)==7) &amp;&amp; (i)) {\n      printf(\"%02x\",buf); /*panjang nya 2 digit, kalau cuma satu digit diisi 0 */\n      buf=0;\n    }\n  }\n  printf(\"\\n\");\n  printf(\"%d\", buf);\n  printf(\"\\n\");\n\n}\n</code></pre>\n\n<p>output from c is the correct one where the output has fix length of value, and random number</p>\n\n<p>thanks guys</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 1, "creation_date": 1561585097, "post_id": 56781219, "comment_id": 100117411, "body": "p2 is not a pointer."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1561585103, "post_id": 56781219, "comment_id": 100117414, "body": "<code>p2</code> is not a pointer, only <code>&amp;p2</code> will result in one."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1561585103, "post_id": 56781219, "comment_id": 100117415, "body": "I think you need the C primer: the <code>.</code> dot is for a <code>struct</code> member. The <code>-&gt;</code> arrow is for a pointer target."}, {"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "reply_to_user": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 0, "creation_date": 1561585182, "post_id": 56781219, "comment_id": 100117436, "body": "How p2 is not a pointer then what it is? I read that when creating a pointer we use * @brhans"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 3, "creation_date": 1561585213, "post_id": 56781219, "comment_id": 100117443, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10036381/arrow-operator-vs-dot-operator\">Arrow Operator vs. Dot Operator</a>: The &#39;arrow&#39; operator is &quot;syntactic sugar&quot;.  <code>bar-&gt;member</code> is the same as <code>(*bar).member</code>.  The former is just more readable.  So you <i>can</i> use <code>printf(&quot;%d&quot;,(*p3).quantity);</code>, should you wish to ;)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1561585371, "post_id": 56781219, "comment_id": 100117486, "body": "If <code>p</code> is a struct, you access its members using a dot, like this: <code>p.quantity</code>.  If <code>ps</code> is a pointer to a struct, you access its members using <code>-&gt;</code>, like this: <code>ps-&gt;quantity</code>.  But if you don&#39;t have a solid understanding of pointers (and structs, for that matter) this may not make much sense.  But know this: pointers and structs are completely different, orthogonal concepts.  You can (and often do) have one without the other.  You can use ordinary structs all day long with no pointers in sight, and you can have pointers to all sorts of things other than structs."}, {"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1561585484, "post_id": 56781219, "comment_id": 100117519, "body": "@paulsm4 Still I don&#39;t understand. Both p2 and p3 are pointers so..."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 5, "creation_date": 1561585516, "post_id": 56781219, "comment_id": 100117531, "body": "No.  &quot;p2&quot; is <i>NOT</i> a pointer.  Q: &quot;How p2 is not a pointer then what it is?&quot;  A: p3 ;)  A struct is a struct, a pointer to a struct is a pointer ... and never the twain shall meet ;)"}, {"owner": {"reputation": 2335, "user_id": 3453041, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/024667382dfea30a6c96bed77f8b5c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Water", "link": "https://stackoverflow.com/users/3453041/water"}, "edited": false, "score": 0, "creation_date": 1561585628, "post_id": 56781219, "comment_id": 100117559, "body": "@Defender how is p2 a pointer?"}, {"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 0, "creation_date": 1561585722, "post_id": 56781219, "comment_id": 100117585, "body": "<code>p2</code> is a <code>struct product</code>. <code>p3</code> is a pointer to a <code>struct product</code>. <code>&amp;p2</code> is a pointer to the specific <code>struct product</code> instance <code>p2</code> which you can use to assign to <code>p3</code> (if you want to)."}, {"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561585859, "post_id": 56781219, "comment_id": 100117624, "body": "Isn&#39;t that similar to C#? Every class object (struct) have a pointer to it? Isn&#39;t everything have a pointer to it?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1561586473, "post_id": 56781219, "comment_id": 100117799, "body": "@Defender: C doesn&#39;t have classes, nor does it create pointers for everything.  A <code>struct</code> type is simply a collection of data.  <code>p2</code> is an <i>instance</i> of type <code>struct product</code> - it doesn&#39;t point to anything, it <i>is</i> the thing.  If you examine it in memory, you&#39;ll see space for a <code>double</code> followed by an <code>int</code> followed by a <code>char</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561587235, "post_id": 56781219, "comment_id": 100117990, "body": "Maybe you&#39;re confused because array variables decay to pointers. But that&#39;s only true for arrays, not structs or any other type."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561586481, "post_id": 56781406, "comment_id": 100117801, "body": "Here: <a href=\"https://www.tutorialspoint.com/cprogramming/c_operators.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_operators.htm</a> I read that * is Pointer to a variable. while &amp; Returns the address of a variable."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561587251, "post_id": 56781406, "comment_id": 100117994, "body": "Yes, <code>*</code> is used for declaring pointer types. There is no <code>*</code> in the declaration of <code>p2</code>. So it is not a pointer."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 0, "last_activity_date": 1561585979, "creation_date": 1561585979, "answer_id": 56781406, "question_id": 56781219, "link": "https://stackoverflow.com/questions/56781219/why-we-cant-use-dot-for-new-created-pointers-to-structs/56781406#56781406", "title": "Why we can&#39;t use dot for new created pointers to structs", "body": "<p>There is obviously a confusion here regarding what is a pointer and what is not. I will rewrite the code a little to highlight the difference - </p>\n\n<pre><code>struct product{\n    double price;\n    int quantity;\n    char name[1];\n};\n\nstruct product p2;\nstruct product *p3;\n\np3 = &amp;p2;\n</code></pre>\n\n<p>This code is equivalent to what you have. Now notice <code>p3</code> is declared with <code>*</code> (the type is <code>struct product *</code>). This means that <code>p3</code> is a pointer. </p>\n\n<p><code>p2</code> is declared with the type <code>struct product</code> (which is not a pointer). It is a struct. </p>\n\n<p>You already know that we use <code>.</code> when using members from struct and <code>-&gt;</code> when getting members from a pointer. </p>\n\n<p>Coming to <code>&amp;p2</code>. The <code>&amp;</code> operator returns a pointer to and object. So <code>&amp;p2</code> is of a type <code>struct product*</code> (pointer) and hence can be assigned to <code>p3</code> which is also a pointer. </p>\n\n<p>Because of this you can also do <code>(&amp;p2)-&gt;quantity</code> (notice the <code>-&gt;</code>) because <code>(&amp;p2)</code> is a pointer. </p>\n\n<p>Finally, just like the <code>&amp;</code> operator we also have the <code>*</code> which returns the object from a pointer. </p>\n\n<p>So you can use <code>(*p3).quantity</code> (notice the <code>.</code> instead of <code>-&gt;</code>). Here <code>p3</code> is a pointer, but the <code>*</code> operator returns a struct and now you can use <code>.</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1561586175, "post_id": 56781417, "comment_id": 100117723, "body": "Yepp, I realized that just now. So I deleted the comment. Nevermind."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1561586374, "last_edit_date": 1561586374, "creation_date": 1561586050, "answer_id": 56781417, "question_id": 56781219, "link": "https://stackoverflow.com/questions/56781219/why-we-cant-use-dot-for-new-created-pointers-to-structs/56781417#56781417", "title": "Why we can&#39;t use dot for new created pointers to structs", "body": "<blockquote>\n  <p>I am a little bit confused, why this code works:</p>\n\n<pre><code>struct product{\n    double price;\n    int quantity;\n    char name[1];\n}p2;\nprintf(\"%d\",p2.quantity);\n</code></pre>\n  \n  <p>While this doesn't work:</p>\n\n<pre><code>struct product *p3=&amp;p2;\nprintf(\"%d\",p3.quantity);\n</code></pre>\n</blockquote>\n\n<p><code>p2</code> is declared as a <code>struct product</code>.  That's a structure object itself, not a pointer to one.  One uses the <code>.</code> operator to access its members, as with <code>p2.quantity</code> in the first snippet.</p>\n\n<p>On the other hand, <code>p3</code> is declared as a <em>pointer to</em> type <code>struct product</code>, which is to say as a <code>struct product *</code>.  It is initialized to point to the object identified by <code>p2</code> -- that's what <code>&amp;p2</code> is, a pointer value representing the address of <code>p2</code>.  The <code>.</code> is not applicable to pointers, hence your second snippet is wrong, but you may use the <code>-&gt;</code> operator with a pointer to a structure or union to access the members of the pointed-to object.</p>\n\n<blockquote>\n  <p>I mean both p2 and p3 are pointers to the same object</p>\n</blockquote>\n\n<p>They absolutely are not.  The initialization <code>p3 = &amp;p2</code> sets <code>p3</code> to <em>point to</em> <code>p2</code>, not to be equal to <code>p2</code>.  This is the essential difference between <code>p2</code>'s type, <code>struct product</code>, and <code>p3</code>'s type <code>struct product *</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": false, "score": 2, "last_activity_date": 1561586342, "creation_date": 1561586342, "answer_id": 56781459, "question_id": 56781219, "link": "https://stackoverflow.com/questions/56781219/why-we-cant-use-dot-for-new-created-pointers-to-structs/56781459#56781459", "title": "Why we can&#39;t use dot for new created pointers to structs", "body": "<p>To answer your confusion about C \"pointers\":</p>\n\n<ul>\n<li><p>C != C#.  </p></li>\n<li><p>C doesn't have .Net <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/object\" rel=\"nofollow noreferrer\">reference objects</a>.  </p></li>\n<li><p>And although you <em>can</em> take the address of any C object (a char, an int, a struct, etc) to turn it into a pointer, that object <em>isn't</em> necessarily <em>itself</em> a pointer.</p></li>\n</ul>\n\n<p>Look here:</p>\n\n<blockquote>\n  <p><a href=\"https://stackoverflow.com/questions/40441612/difference-between-variable-and-data-object-in-c-language\">Difference between variable and data object in C language?</a></p>\n  \n  <p>In C, an object is anything that takes up storage. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011 online\n  draft</a>.</p>\n  \n  <p>An lvalue is an expression that designates an object such that the\n  contents of that object may be read or modified (basically, any\n  expression that can be the target of an assignment is an lvalue).\n  While the C standard doesn't define the term variable, you can\n  basically think of it as any identifier that designates an object...</p>\n  \n  <p>A pointer is any expression whose value is the location of an object.\n  A pointer variable is an object that stores a pointer value.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1561586811, "last_edit_date": 1561586811, "creation_date": 1561586475, "answer_id": 56781478, "question_id": 56781219, "link": "https://stackoverflow.com/questions/56781219/why-we-cant-use-dot-for-new-created-pointers-to-structs/56781478#56781478", "title": "Why we can&#39;t use dot for new created pointers to structs", "body": "<p>C has value types, including for <code>struct</code> aggregates. An expression that has some <code>struct</code> type isn't a reference to a structure, but that structure itself.</p>\n\n<p>In your program, <code>p2</code> isn't a pointer, but the name of a variable (storage location) which holds the entire structure directly. The value of <code>p2</code> is that structure itself.</p>\n\n<p><code>p3</code> holds a pointer to the structure; <code>p3</code>'s value is a data type which indicates the location of value in memory.</p>\n\n<p>The C language uses different operators for referencing members through a pointer to a <code>struct/union</code> versus directly.</p>\n\n<p>That doesn't have to be the case. The compiler has enough information that <code>p2.quantity</code> and <code>p3.quantity</code> could equally work. However, it is simply not so. Decades ago, Dennis Ritchie designed things so that if <code>p</code> is a pointer to a structure, then accessing a member requires dereferencing <code>p</code> first as <code>*p</code> to obtain the structure value that <code>p</code> points to, and then use member selection on that value: <code>(*p).member</code>.  This requires parentheses because the postfix <code>.</code> operator has a higher precedence than the unary <code>*</code>. Because that is verbose, Ritchie, or maybe someone else, invented a shorthand notation: the <code>-&gt;</code> operator. The operator is syntactic sugar: <code>p-&gt;member</code> means the same thing <code>(*p).member</code>. That person either didn't realize that <code>p.member</code> could just be made to work (dot applied to a <code>struct/union</code> pointer can select the member), or more likely rejected that design (probably due to the ideology that \"pointer dereferencing should be loudly visible in the code\").</p>\n\n<p>Usually when we see <code>z = x.y;</code> in a C program, we don't worry about memory safety, but <code>z = x-&gt;y</code> raises a red flag: is <code>x</code> a valid pointer here? Thus the designer had a point. The <code>-&gt;</code> operator highlights that a pointer is being dereferenced, which is dangerous in a language with manual memory management like C.</p>\n\n<p>Some other languages in this family have explicit dereferencing. In Pascal, if <code>ptr</code> is a pointer to a record, then the syntax for getting a member is <code>ptr^.memb</code>. You cannot just use <code>ptr.memb</code>. However, note how in Pascal the pointer dereference <code>ptr^</code> is a postfix operator, so there is no precedence issue here; no parentheses are required as in <code>(ptr^).memb</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1561588152, "creation_date": 1561588152, "answer_id": 56781707, "question_id": 56781219, "link": "https://stackoverflow.com/questions/56781219/why-we-cant-use-dot-for-new-created-pointers-to-structs/56781707#56781707", "title": "Why we can&#39;t use dot for new created pointers to structs", "body": "<p>The <code>.</code> member selection operator requires that its left operand have a <code>struct</code> or <code>union</code> type.  The expression <code>p2</code> has type <code>struct product</code>, so it's a valid operand for the <code>.</code> operator.  The expression <code>p3</code> has type <code>struct product *</code> (<em>pointer</em> to <code>struct product</code>), so it is <em>not</em> a valid operand for the <code>.</code> operator.  </p>\n\n<p>The <code>-&gt;</code> member selection operator requires that its left operand have a <em>pointer</em> to <code>struct</code> or <code>union</code> type.  The expression <code>p3</code> has type <code>struct product *</code>, so it's a valid operand for the <code>-&gt;</code> operator.  The <code>-&gt;</code> performs an implicit deference of the pointer - <code>a-&gt;b</code> is equivalent to writing <code>(*a).b</code>.  </p>\n\n<p>The expression <code>p2</code> is <em>not</em> a pointer - it does not have pointer type, so it is not a valid operand for the <code>-&gt;</code> operator. <code>p2</code> doesn't point to anything, it <em>is</em> the thing.  </p>\n\n<p>Here's a bit of code I wrote to illustrate the difference between <code>p2</code> and <code>p3</code> - <code>dumper</code> is a little utility I wrote to dump the contents of objects in memory:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"dumper.h\"\n#include &lt;stdint.h&gt;\n\nint main( void )\n{\n  struct product\n  {\n    double price;\n    int quantity;\n    char name[1];\n  };\n\n  struct product p2 = {1.00, 1, .name[0] = 'A'}; \n  struct product *p3 = &amp;p2;\n\n  char *names[] = {\"p2\", \"p3\"};\n  void *addrs[] = {&amp;p2, &amp;p3};\n  size_t sizes[] = { sizeof p2, sizeof p3};\n\n  dumper( names, addrs, sizes, 2, stdout );\n\n  return 0;\n}\n</code></pre>\n\n<p>Here's the output:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n         p2  0x7ffeec515a68   00   00   00   00    ....\n             0x7ffeec515a6c   00   00   f0   3f    ...?\n             0x7ffeec515a70   01   00   00   00    ....\n             0x7ffeec515a74   41   00   00   00    A...\n\n         p3  0x7ffeec515a60   68   5a   51   ec    hZQ.\n             0x7ffeec515a64   fe   7f   00   00    ....\n</code></pre>\n\n<p>The <code>struct</code> object <code>p2</code> lives at address <code>0x7ffeec515a68</code> and contains a <code>double</code> object (<code>0x3ff0000000000000</code>, which is the binary representation of the floating point value <code>1.0</code>, starting at address <code>0x7ffeec515a68</code>), followed by an <code>int</code> object (<code>0x00000001</code>, starting at address <code>0x7ffeec515a70</code>) followed by a single <code>char</code> object (<code>0x41</code>, which is the character code for <code>'A'</code>, starting at address <code>0x7ffeec515a74</code>).  </p>\n\n<p>The pointer object <code>p3</code> lives at address <code>0x7ffeec515a60</code> and contains the address of <code>p2</code> (<code>0x7ffeec515a68</code>).  </p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1561588528, "creation_date": 1561588528, "answer_id": 56781743, "question_id": 56781219, "link": "https://stackoverflow.com/questions/56781219/why-we-cant-use-dot-for-new-created-pointers-to-structs/56781743#56781743", "title": "Why we can&#39;t use dot for new created pointers to structs", "body": "<p>In the language described by the 1974 C Reference Manual, the <code>-&gt;</code> operator would take the <em>value</em> of the left operand as a byte address, add the offset of the field named by the right operand, and treat whatever is at the resulting address as an object of the field's type\", while the \".\" operator would do likewise but with the <em>address</em> of the left operand.  Although C compilers have for decades required that the left operand to <code>.</code> be a struct or union containing the named field, and the left operand of <code>-&gt;</code> be a pointer to a structure or union containing the named field, the 1974 C Reference Manual imposed no such requirements, instead defining the behavior of those operators in ways which didn't depend upon the type of the left operand.  According to that manual, if there existed some structure type S with a field named <code>foo</code> [note that multiple structure types could only have fields with matching names if they were part of a Common Initial Sequence] then <code>1234-&gt;foo</code> would be processed in a way equivalent to <code>((S volatile *)1234)-&gt;foo</code>.</p>\n\n<p>Note that in the 1974 language, it would be possible for both <code>foo.bar</code> and <code>foo-&gt;bar</code> to have different valid meanings.  Outside of contrived situations it would be rare for both to be useful, but if both operations used the same operator it wouldn't always be possible for a compiler to pick the useful one.</p>\n"}], "owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "closed_date": 1561594616, "answer_count": 6, "score": -1, "last_activity_date": 1561588528, "creation_date": 1561584990, "last_edit_date": 1561585446, "question_id": 56781219, "link": "https://stackoverflow.com/questions/56781219/why-we-cant-use-dot-for-new-created-pointers-to-structs", "closed_reason": "Duplicate", "title": "Why we can&#39;t use dot for new created pointers to structs", "body": "<p>I am a little bit confused, why this code works:</p>\n\n<pre><code>struct product{\n    double price;\n    int quantity;\n    char name[1];\n}p2;\nprintf(\"%d\",p2.quantity);\n</code></pre>\n\n<p>While this doesn't work:</p>\n\n<pre><code>struct product *p3=&amp;p2;\nprintf(\"%d\",p3.quantity);\n</code></pre>\n\n<p>I mean both <code>p2</code> and <code>p3</code> are pointers to the same object so why we need to write <code>printf(\"%d\",p3-&gt;quantity);</code> in the second case  to let it work.</p>\n"}, {"tags": ["c", "arduino"], "comments": [{"owner": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 0, "creation_date": 1561586488, "post_id": 56781065, "comment_id": 100117804, "body": "Does your filename contain space(s) ?"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1561586802, "post_id": 56781065, "comment_id": 100117877, "body": "Perhaps you need to specify the path.  You could try <code>#include &lt;IRremote&#47;IRremote.h&gt;</code> or something similar where you give the path to the file.   Also, when you use <code>&lt;</code> and <code>&gt;</code> around the name in the <code>#include</code> command it looks in the system library directories.  If you didn&#39;t put the files there then they won&#39;t be found.  If you want to specify a file relative to the source you should use regular double quotes: <code>#include &quot;IRremote&#47;IRremote.h&quot;</code>  If you tell us the actual path where you put the downloaded folder and the actual path of your source we might figure it out."}, {"owner": {"reputation": 6445, "user_id": 2499019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/HBzAe.png?s=128&g=1", "display_name": "Joe Pigott", "link": "https://stackoverflow.com/users/2499019/joe-pigott"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1561587073, "post_id": 56781065, "comment_id": 100117956, "body": "@JerryJeremiah The path to the file is <code>~&#47;Library&#47;z3t0-Arduino-IRremote-2dc97b2&#47;IRremote.h</code>"}, {"owner": {"reputation": 6445, "user_id": 2499019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/HBzAe.png?s=128&g=1", "display_name": "Joe Pigott", "link": "https://stackoverflow.com/users/2499019/joe-pigott"}, "reply_to_user": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 0, "creation_date": 1561587091, "post_id": 56781065, "comment_id": 100117959, "body": "@fassn it does not"}, {"owner": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 2, "creation_date": 1561587366, "post_id": 56781065, "comment_id": 100118037, "body": "Then if the library folder is in the path (I don&#39;t know if it is on Mac), you should include : <code>&lt;z3t0-Arduino-IRremote-2dc97b2&#47;Irremote.h&gt;</code>"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1561587507, "post_id": 56781065, "comment_id": 100118068, "body": "When the site says &quot;Move the &#39;IRremote&#39; folder that has been extracted to your libraries directory.&quot; and then the next step says &quot;Make sure to delete Arduino_Root/libraries/RobotIRremote Where Arduino_Root refers to the install directory of Arduino&quot; I imagine that they mean &quot;Move the &#39;IRremote&#39; folder that has been extracted to your Arduino_Root/libraries directory Where Arduino_Root refers to the install directory of Arduino&quot; but I could be wrong."}, {"owner": {"reputation": 6445, "user_id": 2499019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/HBzAe.png?s=128&g=1", "display_name": "Joe Pigott", "link": "https://stackoverflow.com/users/2499019/joe-pigott"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1561587999, "post_id": 56781065, "comment_id": 100118206, "body": "@JerryJeremiah I completely missed that it could be the arduino library instead of the system library. I&#39;ll check really quick"}, {"owner": {"reputation": 6445, "user_id": 2499019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/HBzAe.png?s=128&g=1", "display_name": "Joe Pigott", "link": "https://stackoverflow.com/users/2499019/joe-pigott"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1561588152, "post_id": 56781065, "comment_id": 100118250, "body": "@JerryJeremiah Success! If you post an answer below I&#39;ll accept it. Thank you!"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1561600841, "post_id": 56781065, "comment_id": 100120524, "body": "Did you have to change the include line in the end or did it work fine when the library was placed in the correct location?"}, {"owner": {"reputation": 6445, "user_id": 2499019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/HBzAe.png?s=128&g=1", "display_name": "Joe Pigott", "link": "https://stackoverflow.com/users/2499019/joe-pigott"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1561605988, "post_id": 56781065, "comment_id": 100121386, "body": "@JerryJeremiah All I needed to do was change the location."}], "answers": [{"comments": [{"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1561602053, "post_id": 56783020, "comment_id": 100120722, "body": "I have raised an issue on the project to try to get the wording fixed: <a href=\"https://github.com/z3t0/Arduino-IRremote/issues/636\" rel=\"nofollow noreferrer\">github.com/z3t0/Arduino-IRremote/issues/636</a>"}], "tags": [], "owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "is_accepted": true, "score": 1, "last_activity_date": 1561601626, "creation_date": 1561601626, "answer_id": 56783020, "question_id": 56781065, "link": "https://stackoverflow.com/questions/56781065/irremote-h-no-such-file-or-directory/56783020#56783020", "title": "IRremote.h &quot;no such file or directory&quot;", "body": "<p>The instructions at <a href=\"https://github.com/z3t0/Arduino-IRremote\" rel=\"nofollow noreferrer\">https://github.com/z3t0/Arduino-IRremote</a> says (emphasis is mine):</p>\n\n<blockquote>\n  <h1>Installation</h1>\n  \n  <ol>\n  <li>Navigate to the Releases page.</li>\n  <li>Download the latest release.</li>\n  <li>Extract the zip file</li>\n  <li>Move the \"IRremote\" folder that has been extracted to <strong>your libraries directory</strong>.</li>\n  <li>Make sure to delete Arduino_Root/libraries/RobotIRremote. Where Arduino_Root refers to the install directory of Arduino. The library RobotIRremote has similar definitions to IRremote and causes errors.</li>\n  </ol>\n</blockquote>\n\n<p>That bolded bit is completely vague and could refer to many different places.  The description in the line below it does a good job of describing where the \"libraries directory\" actually is but the description is not on the line where it is needed.</p>\n\n<p>I think when they say</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>Move the \"IRremote\" folder that has been extracted to your libraries directory.</li>\n  </ol>\n</blockquote>\n\n<p>they actually mean</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>Move the \"IRremote\" folder that has been extracted to Arduino_Root/libraries/IRremote where Arduino_Root refers to the install directory of Arduino.</li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 6445, "user_id": 2499019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/HBzAe.png?s=128&g=1", "display_name": "Joe Pigott", "link": "https://stackoverflow.com/users/2499019/joe-pigott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4891, "favorite_count": 1, "accepted_answer_id": 56783020, "answer_count": 1, "score": -1, "last_activity_date": 1561601626, "creation_date": 1561584163, "question_id": 56781065, "link": "https://stackoverflow.com/questions/56781065/irremote-h-no-such-file-or-directory", "title": "IRremote.h &quot;no such file or directory&quot;", "body": "<p><strong>I am working on Mac</strong></p>\n\n<p>Coming from JS and almost exclusively web development, I have no idea what's going on here.</p>\n\n<p>I've gotten in to hardware programming as a hobby, and caught on to the basics pretty easily. However, I recently started a project involving an IR receiver, and needed to install the <a href=\"http://z3t0.github.io/Arduino-IRremote/\" rel=\"nofollow noreferrer\">IRremote</a> library.</p>\n\n<p>I have moved the downloaded \"IRremote\" folder into the library directory as the installation said.</p>\n\n<p>When I run the sample test code provided</p>\n\n<pre><code>#include &lt;IRremote.h&gt;\n\nconst int RECV_PIN = 7;\nIRrecv irrecv(RECV_PIN);\ndecode_results results;\n\nvoid setup(){\n  Serial.begin(9600);\n  irrecv.enableIRIn();\n  irrecv.blink13(true);\n}\n</code></pre>\n\n<p>the error <code>No such file or directory</code> shows up every time.</p>\n\n<p>This may be the most blatantly obvious question I've ever asked, but I'm a beginner when it comes to stuff like this. Thank you!</p>\n"}, {"tags": ["c", "linker", "global-variables"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1561583138, "post_id": 56780862, "comment_id": 100116732, "body": "No, it&#39;s not possible. Global variables are part of the process, each process has its own memory."}, {"owner": {"reputation": 60, "user_id": 8588200, "user_type": "registered", "profile_image": "https://graph.facebook.com/1638606706173057/picture?type=large", "display_name": "slangley", "link": "https://stackoverflow.com/users/8588200/slangley"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561583164, "post_id": 56780862, "comment_id": 100116740, "body": "Do you have any recommendations, then, to accomplish this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561583164, "post_id": 56780862, "comment_id": 100116741, "body": "If you want something permanent after the program finishes, put it in a file."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1561583189, "post_id": 56780862, "comment_id": 100116751, "body": "If the programs are running at the same time, use shared memory or some other form of inter-process communication."}, {"owner": {"reputation": 60, "user_id": 8588200, "user_type": "registered", "profile_image": "https://graph.facebook.com/1638606706173057/picture?type=large", "display_name": "slangley", "link": "https://stackoverflow.com/users/8588200/slangley"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561583397, "post_id": 56780862, "comment_id": 100116838, "body": "Do you have any links to APIs that can do shared memory? I&#39;d like to avoid using pipes, if possible"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1561583449, "post_id": 56780862, "comment_id": 100116858, "body": "<a href=\"http://man7.org/linux/man-pages/man7/shm_overview.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/shm_overview.7.html</a>"}, {"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 0, "creation_date": 1561583500, "post_id": 56780862, "comment_id": 100116873, "body": "What you&#39;re trying to do is not called &#39;access &amp; modify a global variable&#39; - it&#39;s &#39;inter-process communication&#39;. Global variables are contained within one process (even if that one process is a program compiled from multiple files)."}], "answers": [{"tags": [], "owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "is_accepted": true, "score": 3, "last_activity_date": 1561587854, "creation_date": 1561587854, "answer_id": 56781662, "question_id": 56780862, "link": "https://stackoverflow.com/questions/56780862/how-can-i-access-and-modify-a-global-variable-across-multiple-files/56781662#56781662", "title": "How can I access and modify a global variable across multiple files?", "body": "<p>In C, global variables are global to the execution unit (process), not global to the execution environment (system).  Standard C does not provide a mechanism to share memory between processes.  However, your platform (Linux, Windows, MacOS, etc.) probably does.  Look up \"shared memory\".</p>\n"}], "owner": {"reputation": 60, "user_id": 8588200, "user_type": "registered", "profile_image": "https://graph.facebook.com/1638606706173057/picture?type=large", "display_name": "slangley", "link": "https://stackoverflow.com/users/8588200/slangley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56781662, "answer_count": 1, "score": 0, "last_activity_date": 1561587854, "creation_date": 1561583028, "last_edit_date": 1561583143, "question_id": 56780862, "link": "https://stackoverflow.com/questions/56780862/how-can-i-access-and-modify-a-global-variable-across-multiple-files", "title": "How can I access and modify a global variable across multiple files?", "body": "<p>Like the title says, I want to create a system where two programs can access and modify the same global variable.</p>\n\n<p>I've created a directory that has the files 1.c, 2.c, foo.c, and foo.h. </p>\n\n<p>1.c:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include \"foo.h\"\n\nint main(){\n    printf(\"foo is %d\\n\", foo);\n    sleep(7);\n    printf(\"now foo is %d\\n\", foo);\n}\n</code></pre>\n\n<p>2.c:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include \"foo.h\"\n\nint main(){\n    increment();\n    printf(\"2.c is incrementing foo. foo is now %d\\n\", foo);\n}\n</code></pre>\n\n<p>foo.h:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#ifndef FOO_H\n#define FOO_H\n\nextern int foo;\nvoid increment(void);\n\n#endif\n</code></pre>\n\n<p>foo.c:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include \"foo.h\"\n\nint foo = 5;\n\nvoid increment(){\n    ++foo;\n}\n</code></pre>\n\n<p>I compile with the following compilation commands:</p>\n\n<pre><code>gcc -c foo.c\ngcc 1.c foo.o -o 1.out\ngcc 2.c foo.o -o 2.out\n</code></pre>\n\n<p>And then I run it with <code>./1.out</code> <code>./2.out</code>, ensuring that 2.out runs before the sleep() finishes in 1.out. The result is the following:</p>\n\n<pre><code>./1.out \nfoo is 5\nnow foo is 5\n</code></pre>\n\n<pre><code>./2.out \n2.c is incrementing foo. foo is now 6\n</code></pre>\n\n<p>My theory is that when 1.c and 2.c are linked with foo.o, they both get their own local copies of foo, and thus when one program modifies foo the other program's version goes unmodified. Is it possible to create one global variable that can be shared and modified across multiple files?</p>\n"}, {"tags": ["c", "mpi", "race-condition"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1561593339, "post_id": 56780336, "comment_id": 100119367, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29019744/output-isnt-ordered-parallel-programing-with-mpi\">Output isn&#39;t ordered, Parallel Programing with MPI</a>"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1561593426, "post_id": 56780336, "comment_id": 100119383, "body": "The standard does <b>not</b> guarantee a global order between different MPI processes."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1561619633, "post_id": 56780336, "comment_id": 100125661, "body": "@GillesGouaillardet while my first reaction was also to CV, but I believe this is actually a different question. This is not about ordering, but about atomicity of output. I can&#39;t help but wonder, since Open MPI provides the <code>--tag-output</code> and <code>--timestamp-output</code> options, does it guarantee atomicity on line-level?"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1561620173, "post_id": 56780336, "comment_id": 100125977, "body": "@Zulan Open MPI does <b>not</b> guarantee atomicity on line-level (anything is prefixed, regardless it ends with a <code>\\n</code> or not)."}, {"owner": {"reputation": 3225, "user_id": 2052436, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0b7ab056e97ed88f05549537c42baa4?s=128&d=identicon&r=PG", "display_name": "user2052436", "link": "https://stackoverflow.com/users/2052436/user2052436"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1561662223, "post_id": 56780336, "comment_id": 100148988, "body": "Yes, it is about atomicity as @Zulan noted"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1561582154, "post_id": 56780611, "comment_id": 100116360, "body": "I don&#39;t think this addresses the question.  <code>flockfile()</code> <i>etc</i>. lock <i><code>FILE</code> objects</i> / streams, not the underlying device or file.  They are scoped to one process, but I take the OP&#39;s question to be about multiple (separate) processes."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561582232, "post_id": 56780611, "comment_id": 100116397, "body": "I&#39;m dealing with the output from multiple threads in a single (multithreaded) MPI process.  I think that&#39;s what is being asked about.   Feel free to present your alternative answer, of course."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561582548, "post_id": 56780611, "comment_id": 100116527, "body": "Well yes, that&#39;s my point.  MPI is not typically used for inter-thread communication within the same process. It is designed and built for parallelization across multiple processes, hence my supposition that that&#39;s the case of interest."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1561591294, "last_edit_date": 1561591294, "creation_date": 1561581836, "answer_id": 56780611, "question_id": 56780336, "link": "https://stackoverflow.com/questions/56780336/atomicity-of-fprintf-from-mpi-processes/56780611#56780611", "title": "Atomicity of fprintf from MPI processes", "body": "<p>Within a single process, POSIX requires it \u2014 so does C11.  The POSIX information is buried in an unlikely spot, in the specification for the function <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/flockfile.html\" rel=\"nofollow noreferrer\"><code>flockfile()</code></a> (and <code>funlockfile()</code> and <code>ftrylockfile()</code>):</p>\n\n<blockquote>\n  <p>All functions that reference (<code>FILE *</code>) objects, except those with names ending in <code>_unlocked</code>, shall behave as if they use <code>flockfile()</code> and <code>funlockfile()</code> internally to obtain ownership of these (<code>FILE *</code>) objects.</p>\n</blockquote>\n\n<p>The general description of the functions says:</p>\n\n<blockquote>\n  <p>These functions shall provide for explicit application-level locking of stdio (<code>FILE *</code>) objects. These functions can be used by a thread to delineate a sequence of I/O statements that are executed as a unit.</p>\n</blockquote>\n\n<p>So, the functions explicitly manipulate locks that functions such as <code>printf()</code> and <code>fprintf()</code> are required to use too \u2014 at least in effect.</p>\n\n<p>An application would use those functions explicitly to group several operations on a single file stream; this is explicitly allowed \u2014 indeed, it is the intended purpose of the functions.  A corollary is that if you want to achieve uninterleaved I/O, either ensure that you use a single <code>fprintf()</code> call or equivalent to print all the information, or you must use the POSIX locking functions to protect against interference.</p>\n\n<p>MPI threads are probably sufficiently like POSIX threads, or use POSIX threads, so the rules apply there, too.</p>\n\n<p>C11 has threading support and requires the behaviour too \u2014 though not the functions <code>flockfile()</code> etc.  C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.2p8\" rel=\"nofollow noreferrer\">\u00a77.21.2 Streams \u00b68</a> says:</p>\n\n<blockquote>\n  <p>All functions that read, write, position, or query the position of a stream lock the stream before accessing it. They release the lock associated with the stream when the access is complete.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561585005, "post_id": 56781126, "comment_id": 100117384, "body": "&quot;...writing to <code>stderr</code>, which is unbuffered by default.&quot; So I deleted my comment about <code>fflush</code> thank you."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1561584538, "creation_date": 1561584538, "answer_id": 56781126, "question_id": 56780336, "link": "https://stackoverflow.com/questions/56780336/atomicity-of-fprintf-from-mpi-processes/56781126#56781126", "title": "Atomicity of fprintf from MPI processes", "body": "<p>I'm supposing that you're asking about multiple MPI processes all writing to the same device, perhaps a terminal.  To the extent that you're interested in the output of multiple threads of individual processes, @JonathanLeffler's answer will be of great interest to you.</p>\n\n<p>The C language does not speak to the question of separate processes' effects on each others' use of the same device.  It is scoped to the behavior of individual runs of individual programs.  For POSIX, and I suspect Windows as well, it depends to some extent on how it comes to pass that the multiple separate MPI processes even have the ability to write to the same device at the same time, if indeed that does come to pass.</p>\n\n<p>If the processes have opened the device separately, then the behavior you can rely upon depends on the device and its driver, possibly on the characteristics of the data being printed, and possibly also on details of how the device was opened by each process.  I would generally expect that for a given machine and device, there would be a characteristic size (larger than 1) such that data of that size or smaller written in one go by one process will not be commingled with data from other processes, but I am not aware of specific documentation promising that in general, or detailing what such characteristic sizes would be.</p>\n\n<p>Under POSIX, if sharing a device arises from inheriting an open file description from a common ancestor (shell, master process, <em>etc</em>.), then in addition to the above considerations, POSIX places some requirements, detailed in <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_05_01\" rel=\"nofollow noreferrer\">section 2.5.1</a>.  Inasmuch as your example involves writing to <code>stderr</code>, which is unbuffered by default, your usage will satisfy those requirements as long as you have not changed its (non-)buffering.  In that event, POSIX promises that</p>\n\n<blockquote>\n  <p>regardless of the sequence of handles used, implementations shall ensure that an application, even one consisting of several processes, shall yield correct results: no data shall be lost or duplicated when writing, and all data shall be written in order, except as requested by seeks. It is implementation-defined whether, and under what conditions, all input is seen exactly once.</p>\n</blockquote>\n\n<p>And that's all, though it's still more than you have in the other case.  \"Written in order\" does not guarantee that data from different writes will be segregated.  In practice, however, each <code>fprintf</code> call will make <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/write.html\" rel=\"nofollow noreferrer\"><code>write()</code></a> requests to the underlying system, transferring the printed data in one or a few chunks, and, again in practice, each chunk will be written contiguously.</p>\n\n<p>So,</p>\n\n<ul>\n<li><p>it is not guaranteed by C or POSIX that multiple processes' writes to the same device will be serialized with respect to each other.  Windows may make stronger guarantees, but I'm not prepared to speak to that.</p></li>\n<li><p>it is nevertheless unsurprising that you see such serialization in practice.</p></li>\n</ul>\n"}], "owner": {"reputation": 3225, "user_id": 2052436, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0b7ab056e97ed88f05549537c42baa4?s=128&d=identicon&r=PG", "display_name": "user2052436", "link": "https://stackoverflow.com/users/2052436/user2052436"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561661978, "creation_date": 1561580547, "last_edit_date": 1561661978, "question_id": 56780336, "link": "https://stackoverflow.com/questions/56780336/atomicity-of-fprintf-from-mpi-processes", "title": "Atomicity of fprintf from MPI processes", "body": "<p>Calling <code>fprintf(stderr,...)</code> from MPI processes never gives interleaved results for me.</p>\n\n<p>Order of messages from different MPI processes is arbitrary of course.\nBut no two <code>fprintf</code>-s get intermingled.</p>\n\n<p>I.e., each single <code>fprintf</code> behaves as if it were atomic.</p>\n\n<p>Is this behavior guaranteed by a standard? On Windows? On Linux (by Posix)?</p>\n\n<p>Does it matter if a <code>FILE</code> is buffered, like <code>stdout</code>?</p>\n"}, {"tags": ["c#", "c"], "comments": [{"owner": {"reputation": 5724, "user_id": 1655674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440c2e508496b3e95684461a6ba6a95?s=128&d=identicon&r=PG", "display_name": "Dave Doknjas", "link": "https://stackoverflow.com/users/1655674/dave-doknjas"}, "edited": false, "score": 0, "creation_date": 1561581395, "post_id": 56780273, "comment_id": 100116058, "body": "Don&#39;t know how you&#39;d do pointer arithmetic in C# without pointers and &#39;unsafe&#39; mode."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 0, "creation_date": 1561595397, "post_id": 56780273, "comment_id": 100119707, "body": "<code>sub[0] == 0</code> is just a way to check that the string is empty (i.e., in this case, to check that we reached the end of the superstring). Instead of increasing a pointer to the beginning of the string, you should just store the starting index and increase it."}, {"owner": {"reputation": 1679, "user_id": 5536006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-w_ThV1XwSRk/AAAAAAAAAAI/AAAAAAAAADA/UlccMsLP3uY/photo.jpg?sz=128", "display_name": "FranzHuber23", "link": "https://stackoverflow.com/users/5536006/franzhuber23"}, "edited": false, "score": 0, "creation_date": 1561625556, "post_id": 56780273, "comment_id": 100128890, "body": "@dyukha That&#39;s what I planned to do. Do you see anything else to change?"}, {"owner": {"reputation": 1679, "user_id": 5536006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-w_ThV1XwSRk/AAAAAAAAAAI/AAAAAAAAADA/UlccMsLP3uY/photo.jpg?sz=128", "display_name": "FranzHuber23", "link": "https://stackoverflow.com/users/5536006/franzhuber23"}, "reply_to_user": {"reputation": 5724, "user_id": 1655674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440c2e508496b3e95684461a6ba6a95?s=128&d=identicon&r=PG", "display_name": "Dave Doknjas", "link": "https://stackoverflow.com/users/1655674/dave-doknjas"}, "edited": false, "score": 0, "creation_date": 1561625666, "post_id": 56780273, "comment_id": 100128974, "body": "@DaveDoknjas: The point is: I don&#39;t want to do pointer arithemtic, I want to replace it."}], "answers": [{"tags": [], "owner": {"reputation": 1679, "user_id": 5536006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-w_ThV1XwSRk/AAAAAAAAAAI/AAAAAAAAADA/UlccMsLP3uY/photo.jpg?sz=128", "display_name": "FranzHuber23", "link": "https://stackoverflow.com/users/5536006/franzhuber23"}, "is_accepted": true, "score": 0, "last_activity_date": 1561659520, "creation_date": 1561659520, "answer_id": 56796709, "question_id": 56780273, "link": "https://stackoverflow.com/questions/56780273/translate-the-mosquitto-topic-matching-function-from-c-to-c/56796709#56796709", "title": "Translate the Mosquitto topic matching function from C to C#", "body": "<p>I have now the following code. It seems to work quite good:</p>\n\n<p><a href=\"https://gist.github.com/SeppPenner/17be9fc44b0605619d4b2eefa7f1f105\" rel=\"nofollow noreferrer\">https://gist.github.com/SeppPenner/17be9fc44b0605619d4b2eefa7f1f105</a></p>\n\n<p>I will discuss further issues of this here: <a href=\"https://github.com/eclipse/mosquitto/issues/1317\" rel=\"nofollow noreferrer\">https://github.com/eclipse/mosquitto/issues/1317</a>.</p>\n\n<p>If you see any bugs, contact me here, please.</p>\n"}], "owner": {"reputation": 1679, "user_id": 5536006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-w_ThV1XwSRk/AAAAAAAAAAI/AAAAAAAAADA/UlccMsLP3uY/photo.jpg?sz=128", "display_name": "FranzHuber23", "link": "https://stackoverflow.com/users/5536006/franzhuber23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 56796709, "answer_count": 1, "score": 0, "last_activity_date": 1561659520, "creation_date": 1561580292, "question_id": 56780273, "link": "https://stackoverflow.com/questions/56780273/translate-the-mosquitto-topic-matching-function-from-c-to-c", "title": "Translate the Mosquitto topic matching function from C to C#", "body": "<p>I want to translate the topic matching function from Mosquitto (<a href=\"https://github.com/eclipse/mosquitto/blob/master/lib/util_topic.c#L138\" rel=\"nofollow noreferrer\">https://github.com/eclipse/mosquitto/blob/master/lib/util_topic.c#L138</a>) from C to C# code.</p>\n\n<p>Right now, I have it like this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static unsafe bool MatchTopic(char *sub, char *topic)\n{\n    if (!sub || !topic || sub[0] == 0 || topic[0] == 0)\n    {\n        return false;\n    }\n\n    if ((sub[0] == '$' &amp;&amp; topic[0] != '$') || (topic[0] == '$' &amp;&amp; sub[0] != '$'))\n    {\n        return true;\n    }\n\n    var spos = 0;\n    while (sub[0] != 0)\n    {\n        if (topic[0] == '+' || topic[0] == '#')\n        {\n            return false;\n        }\n\n        if (sub[0] != topic[0] || topic[0] == 0)\n        {\n            // Check for wildcard matches\n            if (sub[0] == '+')\n            {\n                // Check for bad \"+foo\" or \"a/+foo\" subscription\n                if (spos &gt; 0 &amp;&amp; sub[-1] != '/')\n                {\n                    return false;\n                }\n\n                // Check for bad \"foo+\" or \"foo+/a\" subscription\n                if (sub[1] != 0 &amp;&amp; sub[1] != '/')\n                {\n                    return false;\n                }\n\n                spos++;\n                sub++;\n                while (topic[0] != 0 &amp;&amp; topic[0] != '/')\n                {\n                    topic++;\n                }\n\n                if (topic[0] == 0 &amp;&amp; sub[0] == 0)\n                {\n                    return true;\n                }\n            }\n            else if (sub[0] == '#')\n            {\n                // Check for bad \"foo#\" subscription\n                if (spos &gt; 0 &amp;&amp; sub[-1] != '/')\n                {\n                    return false;\n                }\n\n                // Check for # not the final character of the sub, e.g. \"#foo\"\n                if (sub[1] != 0)\n                {\n                    return false;\n                }\n                else\n                {\n                    return true;\n                }\n            }\n            else\n            {\n                // Check for e.g. foo/bar matching foo/+/#\n                if (topic[0] == 0 &amp;&amp; spos &gt; 0 &amp;&amp; sub[-1] == '+' &amp;&amp; sub[0] == '/' &amp;&amp; sub[1] == '#')\n                {\n                    return true;\n                }\n\n                // There is no match at this point, but is the sub invalid?\n                while (sub[0] != 0)\n                {\n                    if (sub[0] == '#' &amp;&amp; sub[1] != 0)\n                    {\n                        return false;\n                    }\n\n                    spos++;\n                    sub++;\n                }\n\n                // Valid input, but no match\n                return true;\n            }\n        }\n        else\n        {\n            // sub[spos] == topic[tpos]\n            if (topic[1] == 0)\n            {\n                // Check for e.g. foo matching foo/#\n                if (sub[1] == '/' &amp;&amp; sub[2] == '#' &amp;&amp; sub[3] == 0)\n                {\n                    return true;\n                }\n            }\n\n            spos++;\n            sub++;\n            topic++;\n            if (sub[0] == 0 &amp;&amp; topic[0] == 0)\n            {\n                return true;\n            }\n            else if (topic[0] == 0 &amp;&amp; sub[0] == '+' &amp;&amp; sub[1] == 0)\n            {\n                if (spos &gt; 0 &amp;&amp; sub[-1] != '/')\n                {\n                    return false;\n                }\n\n                spos++;\n                sub++;\n                return true;\n            }\n        }\n    }\n\n    if ((topic[0] != 0 || sub[0] != 0))\n    {\n        return false;\n    }\n\n    return true;\n}\n</code></pre>\n\n<p>But, I want to get rid of the <code>char*</code> and use <code>string</code> instead and also want to check properly for a string ending because <code>topic[0] == 0</code> will probably fail with some kind of out of bounds exception.</p>\n\n<p>My idea was to replace e.g. <code>sub[0]</code> with <code>sub[subIndex]</code> and add the <code>++</code> operator on the <code>subIndex</code> (where <code>subIndex</code> is a <code>int</code> variable globally defined in the function), not on <code>sub</code>. Meaning, that <code>sub[1]</code> would be replaced with <code>sub[subIndex + 1]</code> and similar.</p>\n\n<p>Does anyone have some ideas regarding this conversion?</p>\n"}, {"tags": ["c", "gnome"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1561577736, "post_id": 56779875, "comment_id": 100114830, "body": "Go back to Windows types UINT, WORD, BYTE etc. There was no certain standard at that time."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1561578047, "post_id": 56779875, "comment_id": 100114986, "body": "Who says it&#39;s good practice?"}, {"owner": {"reputation": 12418, "user_id": 214296, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/268966bdb84008bef79268f0a45b533e?s=128&d=identicon&r=PG", "display_name": "Jim Fell", "link": "https://stackoverflow.com/users/214296/jim-fell"}, "edited": false, "score": 0, "creation_date": 1561580573, "post_id": 56779875, "comment_id": 100115690, "body": "Although not mandatory, <code>typedef</code> is helpful if you want to make an enumerated type or function pointer type to make your code easier to read/maintain."}], "answers": [{"comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 3, "creation_date": 1561578035, "post_id": 56779892, "comment_id": 100114976, "body": "But it didn&#39;t always."}], "tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": true, "score": 4, "last_activity_date": 1561577675, "creation_date": 1561577675, "answer_id": 56779892, "question_id": 56779875, "link": "https://stackoverflow.com/questions/56779875/why-it-is-good-practice-to-define-custom-datatypes-in-larger-projects/56779892#56779892", "title": "Why it is good practice to define custom datatypes in larger projects", "body": "<p>This is not good practice. It only leads to less compatibility and portability. I don't see any reason that it should be done. <code>stdint.h</code> exists to avoid this.</p>\n"}, {"tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": false, "score": 2, "last_activity_date": 1561578205, "last_edit_date": 1561578205, "creation_date": 1561577759, "answer_id": 56779908, "question_id": 56779875, "link": "https://stackoverflow.com/questions/56779875/why-it-is-good-practice-to-define-custom-datatypes-in-larger-projects/56779908#56779908", "title": "Why it is good practice to define custom datatypes in larger projects", "body": "<p><code>&lt;stdint.h&gt;</code> was standardized in C99. Perhaps the codebase predates <code>&lt;stdint.h&gt;</code>, or it needs to compile on platforms that don't have it. It was an extremely common thing to do in C89 and K&amp;R C when there were no portable fixed size typedefs. Even modern projects may keep around these compatibility shims if they still aim to be compilable on decades-old platforms.</p>\n\n<blockquote>\n  <p>In my current company I found that someone made definitions of types that are equivalent of those that are already defined in <code>&lt;stdint.h&gt;</code>.</p>\n</blockquote>\n\n<p>If your codebase targets C99 or later then there's no need.</p>\n"}], "owner": {"reputation": 478, "user_id": 3277680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a517e9a983ae7ad44a27a2ac22338643?s=128&d=identicon&r=PG&f=1", "display_name": "wiesniak", "link": "https://stackoverflow.com/users/3277680/wiesniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1561577934, "accepted_answer_id": 56779892, "answer_count": 2, "score": 3, "last_activity_date": 1561578205, "creation_date": 1561577603, "last_edit_date": 1561577635, "question_id": 56779875, "link": "https://stackoverflow.com/questions/56779875/why-it-is-good-practice-to-define-custom-datatypes-in-larger-projects", "closed_reason": "Duplicate", "title": "Why it is good practice to define custom datatypes in larger projects", "body": "<p>Please help me understand reason of defining C types in some projects.</p>\n\n<p>In my current company I found that someone made definitions of types that are equivalent of those that are already defined in <code>&lt;stdint.h&gt;</code>.</p>\n\n<p>Such approach makes harder to integrate 3party code into project, and makes programmer work, bit more frustrating.</p>\n\n<p>But I can also see that some projects, like gnome do the same. There is a gchar, gsize, and gint32 for example. </p>\n\n<p>Because I don't see ANY reason for such approach, I kindly ask for explanation.</p>\n\n<p>What is the reason that <code>&lt;stdint.h&gt;</code> isn't sufficient.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1561576247, "post_id": 56779450, "comment_id": 100114269, "body": "<code>alist</code> is an array of pointers in the <code>graph</code> structure. Since it&#39;s the last item in the structure, you can allocate more memory to make room for more pointers. <code>list</code> is an array of <code>int</code>. Since it&#39;s the last item in the <code>successors</code> structure, you can allocate more memory to make room for more <code>int</code>s."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561576407, "post_id": 56779450, "comment_id": 100114310, "body": "... but <i>neither</i> of those makes accessing the additional allocated space valid, although it will probably work because it used to be common enough hack, and because it falls out naturally from simple implementations of the language semantics.  Additionally, they don&#39;t work <i>together</i>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1561576506, "post_id": 56779450, "comment_id": 100114350, "body": "If you want to dynamically allocate or reallocate space then declare a pointer, not an array."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1561576775, "post_id": 56779450, "comment_id": 100114446, "body": "Technically, the flexible array member should be declared without the <code>1</code>, e.g. <code>int list[];</code> instead of <code>int list[1];</code>. That of course affects the size calculations in the <code>malloc</code> and <code>realloc</code> calls."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561576961, "post_id": 56779450, "comment_id": 100114517, "body": "@JohnBollinger In fact, they do work together, since <code>alist</code> is an array of pointers. The structure definition is badly written, but the design is correct (provided the arrays are properly declared as flexible array members)."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1561577837, "post_id": 56779450, "comment_id": 100114880, "body": "The structure design isn\u2019t bad; c89 explicitly forbade empty arrays, only to have a later stab at it re-permit them.   The only way to make a structure compatible with C and std-C{89, 99, ...} is to use [1]."}, {"owner": {"reputation": 333, "user_id": 9987237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29e3310153a9b89ddeaed06c8d1ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Mance Rayder", "link": "https://stackoverflow.com/users/9987237/mance-rayder"}, "edited": false, "score": 0, "creation_date": 1561580172, "post_id": 56779450, "comment_id": 100115527, "body": "You may have a look at the following post: <a href=\"https://stackoverflow.com/questions/246977/is-using-flexible-array-members-in-c-bad-practice\">Is using flexible array members in C a bad practice?</a>. Per my understanding, using <code>[1]</code> is not fully portable and may cause undesired effects. There are a lot of posts about flexible array members here."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 1, "creation_date": 1561595518, "post_id": 56779450, "comment_id": 100119725, "body": "@mevets no it isn&#39;t. The only really compatible way is to use conditional compilation to define a macro that expands to empty string on c99+, 1 on c89"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1561595553, "post_id": 56779450, "comment_id": 100119730, "body": "And hope that the c89 compiler in question does not do bounds checking"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1561642227, "post_id": 56779450, "comment_id": 100138765, "body": "OT: regarding: <code>typedef struct graph *Graph;</code>  It is a very poor programming practice to hide a pointer in a &#39;typedef&#39;."}], "owner": {"reputation": 15, "user_id": 11176586, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z4ZsFpX-x1M/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWizv8l8uaHglNu5V_mRa1W-Z2khw/mo/photo.jpg?sz=128", "display_name": "otan", "link": "https://stackoverflow.com/users/11176586/otan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561576528, "creation_date": 1561575586, "last_edit_date": 1561576528, "question_id": 56779450, "link": "https://stackoverflow.com/questions/56779450/how-does-memory-reallocated-for-an-array-inside-a-struct", "title": "How does memory reallocated for an array inside a struct", "body": "<p>In the code below, when memory is reallocated with </p>\n\n<pre><code>g-&gt;alist[u] = realloc(g-&gt;alist[u], sizeof(struct successors) +\nsizeof(int) * (g-&gt;alist[u]-&gt;len - 1)) \n</code></pre>\n\n<p>how can numbers be added to <code>list[]</code> using </p>\n\n<pre><code>g-&gt;alist[u]-&gt;list[g-&gt;alist[u]-&gt;d++] = v\n</code></pre>\n\n<p>if it was initialized as <code>list[1]</code>? </p>\n\n<pre><code>struct graph {\n    int n;\n    int e;\n        struct successors {\n            int d;\n            int len;\n            char is_sorted;\n            int list[1];        \n         } *alist[1];\n};\ntypedef struct graph *Graph;\n\nGraph graph_create(int n)\n{\n\n    Graph g;\n    int i;\n\n    g = malloc(sizeof(struct graph) + sizeof(struct successors*) * (n - 1));\n    assert(g);\n    g-&gt;v = n;\n    g-&gt;e = 0;\n\n    for (i = 0; i &lt; n; i++)\n    {\n        g-&gt;alist[i] = malloc(sizeof(struct successors));\n        assert(g-&gt;alist[i]);\n\n        g-&gt;alist[i]-&gt;d = 0;\n        g-&gt;alist[i]-&gt;len = 1;\n        g-&gt;alist[i]-&gt;is_sorted = 1;\n    }\n\n    return g;\n}\n\nvoid graph_add_edge(Graph g, int u, int v)\n{\n    assert(u &gt;= 0);\n    assert(u &lt; g-&gt;v);\n    assert(v &gt;= 0);\n    assert(v &lt; g-&gt;v);\n    while(g-&gt;alist[u]-&gt;d &gt;= g-&gt;alist[u]-&gt;len)  \n    {\n        g-&gt;alist[u]-&gt;len *= 2;\n        g-&gt;alist[u] = realloc(g-&gt;alist[u], sizeof(struct successors) + \n        sizeof(int) * (g-&gt;alist[u]-&gt;len - 1));\n    }\n    g-&gt;alist[u]-&gt;list[g-&gt;alist[u]-&gt;d++] = v;\n    g-&gt;alist[u]-&gt;is_sorted = 0;\n    g-&gt;e++;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "casting"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 7, "creation_date": 1561575287, "post_id": 56779365, "comment_id": 100113861, "body": "There is no &quot;C/C++&quot; language: please pick one."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1561575296, "post_id": 56779365, "comment_id": 100113864, "body": "No.............. A function returns the type you stated in the function prototype, e.g. <code>ReturnType foo();</code>"}, {"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 2, "creation_date": 1561575518, "post_id": 56779365, "comment_id": 100113961, "body": "<code>return ... ? static_cast&lt;int&gt;(value) : static_cast&lt;unsigned&gt;(value);</code>. All you need after that is a <code>variant&lt;int, unsigned&gt;</code> for the return type"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1561575544, "post_id": 56779365, "comment_id": 100113971, "body": "What is the type of <code>value</code>?"}, {"owner": {"reputation": 1033, "user_id": 5778803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b5CcU.jpg?s=128&g=1", "display_name": "Eliyahu Machluf", "link": "https://stackoverflow.com/users/5778803/eliyahu-machluf"}, "edited": false, "score": 2, "creation_date": 1561581348, "post_id": 56779365, "comment_id": 100116041, "body": "What do you want to achieve? what is the problem you are trying to solve with variant return type"}, {"owner": {"reputation": 311, "user_id": 11630848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38aff2511098597fa8ce472473a042b2?s=128&d=identicon&r=PG&f=1", "display_name": "amlucas", "link": "https://stackoverflow.com/users/11630848/amlucas"}, "edited": false, "score": 1, "creation_date": 1561582013, "post_id": 56779365, "comment_id": 100116306, "body": "I would return a std::variant&lt;int, unsigned int&gt;"}, {"owner": {"reputation": 573, "user_id": 7851474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/H6UTi.png?s=128&g=1", "display_name": "guigoz", "link": "https://stackoverflow.com/users/7851474/guigoz"}, "reply_to_user": {"reputation": 1033, "user_id": 5778803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b5CcU.jpg?s=128&g=1", "display_name": "Eliyahu Machluf", "link": "https://stackoverflow.com/users/5778803/eliyahu-machluf"}, "edited": false, "score": 0, "creation_date": 1561612635, "post_id": 56779365, "comment_id": 100122844, "body": "@Eliyahu Machluf I&#39;m trying to change the range of a value, eg (unsigned char)144 ==144, but (char)144 ==-112"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1561613363, "post_id": 56779365, "comment_id": 100123073, "body": "@guigoz I think it&#39;s a bit unclear what you are trying to achieve. Perhaps you could edit the code so it shows a complete function and shows how you want to call it. BTW: <code>char</code> isn&#39;t always signed..."}, {"owner": {"reputation": 573, "user_id": 7851474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/H6UTi.png?s=128&g=1", "display_name": "guigoz", "link": "https://stackoverflow.com/users/7851474/guigoz"}, "edited": false, "score": 0, "creation_date": 1561619381, "post_id": 56779365, "comment_id": 100125548, "body": "0b10010000 can be either 144 or -122 when casted, that&#39;s what I want to achieve"}], "answers": [{"comments": [{"owner": {"reputation": 1038, "user_id": 547270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yEM1T.png?s=128&g=1", "display_name": "scrutari", "link": "https://stackoverflow.com/users/547270/scrutari"}, "edited": false, "score": 1, "creation_date": 1561576245, "post_id": 56779513, "comment_id": 100114267, "body": "How about <code>auto</code> return type with C++14?"}, {"owner": {"reputation": 2289, "user_id": 2356414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff4a2241e2dcfc50615e4b7c709bd17?s=128&d=identicon&r=PG", "display_name": "KABoissonneault", "link": "https://stackoverflow.com/users/2356414/kaboissonneault"}, "edited": false, "score": 2, "creation_date": 1561576771, "post_id": 56779513, "comment_id": 100114444, "body": "What about returning a single type that could contain either types? For example, in C++17, you can have <code>std::variant&lt;int, unsigned&gt;</code>"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "reply_to_user": {"reputation": 1038, "user_id": 547270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yEM1T.png?s=128&g=1", "display_name": "scrutari", "link": "https://stackoverflow.com/users/547270/scrutari"}, "edited": false, "score": 4, "creation_date": 1561580698, "post_id": 56779513, "comment_id": 100115762, "body": "@scrutari Return type deduction is done at compile time."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 1038, "user_id": 547270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yEM1T.png?s=128&g=1", "display_name": "scrutari", "link": "https://stackoverflow.com/users/547270/scrutari"}, "edited": false, "score": 0, "creation_date": 1561584791, "post_id": 56779513, "comment_id": 100117311, "body": "@scrutari Based on the argument types it still results into exactly 1 type at compile time. With<code>if constexpr</code> you can change that type, though that is still a compile time feature"}, {"owner": {"reputation": 573, "user_id": 7851474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/H6UTi.png?s=128&g=1", "display_name": "guigoz", "link": "https://stackoverflow.com/users/7851474/guigoz"}, "edited": false, "score": 0, "creation_date": 1561612256, "post_id": 56779513, "comment_id": 100122727, "body": "Actually what is needed is to change the interpretation of value, not to change te return type of the function"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1561575842, "creation_date": 1561575842, "answer_id": 56779513, "question_id": 56779365, "link": "https://stackoverflow.com/questions/56779365/how-to-choose-dynamicly-in-c-c-the-type-to-cast-to/56779513#56779513", "title": "How to choose dynamicly in C/C++ the type to cast to?", "body": "<p>No, in both C and C++ the return type of a function is fixed, i.e. it will always return the same type. Even if you try to cast as part of the <code>return</code> statement, the returned value will implicit be converted to the return type of the function - if possible. If an implicit conversion ain't possible, you'll get a compile error.</p>\n\n<p>So</p>\n\n<pre><code>returntype foo(...) {.... return x;}\n</code></pre>\n\n<p>will always return a value of type <code>returntype</code></p>\n\n<p>In C++ you can use templates to \"change\" return type but once the template definition is solved it's the same story. Cast won't change the real return type.</p>\n"}], "owner": {"reputation": 573, "user_id": 7851474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/H6UTi.png?s=128&g=1", "display_name": "guigoz", "link": "https://stackoverflow.com/users/7851474/guigoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1561612808, "creation_date": 1561575153, "last_edit_date": 1561612808, "question_id": 56779365, "link": "https://stackoverflow.com/questions/56779365/how-to-choose-dynamicly-in-c-c-the-type-to-cast-to", "title": "How to choose dynamicly in C/C++ the type to cast to?", "body": "<p>Is there a way to do</p>\n\n<pre><code>if(...)\n  return (char)value;\n\nreturn (unsigned char)value;\n</code></pre>\n\n<p>by moving the check into the cast to get something like</p>\n\n<pre><code>return (???)value;\n</code></pre>\n\n<p>The goal is to interprete the content of value differently\neg: (unsigned char)144=>144 and (char)144=>-112</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1561574782, "post_id": 56779250, "comment_id": 100113638, "body": "Hexadecimal in negative? nops, of course you can use <code>printf(&quot;-%x -%x -%x -%x&quot;</code> but is quite strange to see an hexadecimal with <code>-</code>. Anyway using <code>%u</code> with a <code>float</code> is undefined behaviour."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1561575001, "post_id": 56779250, "comment_id": 100113730, "body": "According to <a href=\"https://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">cppreference.com</a>, the <code>%x</code> specifier <i>converts an unsigned integer into hexadecimal representation hhhh.</i> So it looks like a type-conversion may be happening."}, {"owner": {"reputation": 37, "user_id": 11451909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p5fqEMfiRK8/AAAAAAAAAAI/AAAAAAAAE9g/sfxbUH2GcMY/photo.jpg?sz=128", "display_name": "delve123", "link": "https://stackoverflow.com/users/11451909/delve123"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1561575101, "post_id": 56779250, "comment_id": 100113778, "body": "@KeineLust I agree it will be very strange. However my question was much on the representation part in hexadecimal. On running the above program I am getting value as &#39;0&#39; but I was expecting something between 0 to F (Naturally ignoring -)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561575243, "post_id": 56779250, "comment_id": 100113840, "body": "@delve123, you have no sound justification for <i>any</i> particular expectation of the output of a program that executes the code presented.  Its behavior is <i>undefined</i>.  That means what it says -- it is not a synonym for &quot;strange&quot; or &quot;faulty&quot;, though strange behavior indeed might be observed."}, {"owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "edited": false, "score": 0, "creation_date": 1561575245, "post_id": 56779250, "comment_id": 100113841, "body": "Zero seems strange, but your union will overlay the floating point representation of -25 on 4 bytes, so the result would be machine dependent. So what processor and OS is this? I get <code>0</code> <code>0</code> <code>ffffffc8</code> <code>ffffffc1</code>"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 0, "creation_date": 1561575259, "post_id": 56779250, "comment_id": 100113848, "body": "This is probably going to be dependent on your specific architecture and operating system. When I run it on Linux, I also get <code>0</code> in the second <code>printf</code>. However, when I run it on MacOS, I get <code>120a8</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1561575677, "post_id": 56779250, "comment_id": 100114034, "body": "Aside: a syntax error: <code>&#47;</code> line continuation should be back slash, but it is not needed anyway."}, {"owner": {"reputation": 37, "user_id": 11451909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p5fqEMfiRK8/AAAAAAAAAAI/AAAAAAAAE9g/sfxbUH2GcMY/photo.jpg?sz=128", "display_name": "delve123", "link": "https://stackoverflow.com/users/11451909/delve123"}, "reply_to_user": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "edited": false, "score": 0, "creation_date": 1561575736, "post_id": 56779250, "comment_id": 100114058, "body": "@Deepstop I7-8gen Windows-10. I am also getting the same output as yours"}, {"owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "edited": false, "score": 0, "creation_date": 1561576195, "post_id": 56779250, "comment_id": 100114242, "body": "@delve123 I&#39;m using CentOS-7-64. With format code %02X I at least get the tidier output of  <code>00 00 C8 C1</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561577872, "post_id": 56779250, "comment_id": 100114896, "body": "For learning, take a look at <a href=\"https://stackoverflow.com/questions/4825824/hexadecimal-floating-constant-in-c\">hexadecimal floating constant in C</a> - there is such an animal. Also, in your case, if you simply want to check each byte in the <code>union</code> and output the value in hex with the appropriate sign in front, you can loop over the bytes, check if the <code>char</code> value would be less than zero, and output a negative sign in front of the absolute value output in hex. Kinda wonky, but I can see experimenting. Also, the format specifier would be <code>&quot;%hhx&quot;</code> for each bytes as hex."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11451909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p5fqEMfiRK8/AAAAAAAAAAI/AAAAAAAAE9g/sfxbUH2GcMY/photo.jpg?sz=128", "display_name": "delve123", "link": "https://stackoverflow.com/users/11451909/delve123"}, "edited": false, "score": 0, "creation_date": 1561576528, "post_id": 56779516, "comment_id": 100114363, "body": "I understand form your explanation as the <b>float</b> is being promoted to <b>double</b> . However it doesn&#39;t stops the <b>printf</b> to represent the contents in hexadecimal. correct ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 37, "user_id": 11451909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p5fqEMfiRK8/AAAAAAAAAAI/AAAAAAAAE9g/sfxbUH2GcMY/photo.jpg?sz=128", "display_name": "delve123", "link": "https://stackoverflow.com/users/11451909/delve123"}, "edited": false, "score": 0, "creation_date": 1561576693, "post_id": 56779516, "comment_id": 100114413, "body": "The decimal value (minus) <code>25</code> only needs a few of the m.s. bits in the significand to represent it, the rest are <code>0</code>. So in the <code>double</code> promotion, there are at least four <code>0</code> bytes compared witht the two for a <code>float</code>. If the values are little-endian, the <code>%x</code> format will be looking at four <code>0</code> bytes, not at the sign, exponent, and m.s bits of the significand."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1561576848, "post_id": 56779516, "comment_id": 100114477, "body": "The mismatch between <code>printf</code> directive and the the type of the corresponding argument produces undefined behavior quite independently of the sizes of any of the types involved."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561576944, "post_id": 56779516, "comment_id": 100114508, "body": "@JohnBollinger yes, as the first sentence of the answer. The rest is by way of explanation as to <i>why</i> <code>0</code> is output, in this particular case. Undefined behaviour does not necessarily mean random."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1561577089, "post_id": 56779516, "comment_id": 100114559, "body": "&gt; <i>&quot;is not guaranteed to be the same size as float&quot;</i>. It has nothing to do with size; the <code>%x</code> conversion specifier requires an <code>unsigned int</code>, which is not the same <b>type</b> as a <code>float</code>. It&#39;s a run-time type mismatch situation that results in undefined behavior."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1561577213, "post_id": 56779516, "comment_id": 100114612, "body": "@Kaz <code>printf</code> does not <i>care</i> what the type is, but the compiler tries to afford some protection. If there are 4 bytes presented to a specifier expecting 4 bytes, then it will interpret those 4 bytes in the way it is told to."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561577331, "post_id": 56779516, "comment_id": 100114665, "body": "@JohnBollinger the first sentence isn&#39;t worded carefully enough, I will edit it thank you."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1561581761, "post_id": 56779516, "comment_id": 100116206, "body": "<code>printf</code> absolutely cares what the type is. Inside <code>printf</code>, the <code>%x</code> argument is extracted from the variable argument list using something similar to <code>va_arg(vl, unsigned)</code>.  If that is matched by a <code>double</code> argument, it&#39;s doing undefined type punning."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1561581987, "post_id": 56779516, "comment_id": 100116293, "body": "@Kaz yes, but the processor is not governed by the C standard. The result may be undefined in the sense that the C standard is written, but the processor carries on regardless. There are few cats painted green, or nasal demons, because most of the useless computers which did that have been thrown into the sea."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561582585, "post_id": 56779516, "comment_id": 100116537, "body": "... suppose my C program has some slightly odd behaviour in one part and occasional crashes which happen in another part. I find a bug and fix it, the crashes stop and so does the seemingly unrelated odd behaviour elsewhere. I want to assure myself that the two were related and explain to myself that I really have dealt with the problem, not simply moved it somewhere else. Saying &quot;oh that is undefined&quot; is not helpful. I want to know <i>exactly</i> what the processor has done. In the same way, this answer attempts to explain why the output was <code>0</code>."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1561583334, "post_id": 56779516, "comment_id": 100116819, "body": "The situation is diagnosable; the program might fail to translate with a diagnostic message. E.g. GCC diagnoses mismatches between conversion specifiers and arguments in <code>printf</code>. The warning can be turned into a fatal error with a command line option."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 4, "last_activity_date": 1561577468, "last_edit_date": 1561577468, "creation_date": 1561575853, "answer_id": 56779516, "question_id": 56779250, "link": "https://stackoverflow.com/questions/56779250/printing-of-negative-value-in-c-via-printf/56779516#56779516", "title": "Printing of negative value in c via printf", "body": "<p>Passing <code>float</code> to a specifier expecting <code>unsigned int</code> is <em>undefined behaviour</em>.</p>\n\n<p>Furthermore, the <code>unsigned int</code> expected by <code>%x</code> is not guaranteed to be the same size as <code>float</code>. So the attempt to trick <code>printf</code> that way may or may not \"work\".</p>\n\n<p>Anyway, for a variadic function such as <code>printf</code> the compiler will promote an argument of type <code>float</code> to <code>double</code>, so that may be the reason why you (and I) get <code>0</code> output.</p>\n\n<p>On my system<br>\n<code>sizeof(double)</code> is <code>8</code>.<br>\n<code>sizeof(unsigned int)</code> is <code>4</code>.</p>\n\n<p>And if you look at the bytes output for that part of the <code>union</code>, the first two are <code>0</code>. So having passed 8 bytes to the function instead of the 4 expected by <code>%x</code>, the data is aligned in a way that <code>%x</code> is getting four <code>0</code> value bytes.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561582610, "post_id": 56780088, "comment_id": 100116548, "body": "For fun you could enter negative PI as the <code>float</code> value, e.g. <code>-3.14159</code> (or just PI) if you wanted to ensure all bytes had value."}, {"owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561894004, "post_id": 56780088, "comment_id": 100201399, "body": "Right. Anything with more than 20 significant binary digits would push bits into the lower 32 bits which would show up the in the result. All the talk about printf and hex representations aside, the original question relates to floating point representations in the processor that the code is being executed on and not much else. It takes me back to my good old days of assembly language programming although most of the processors I worked on back then didn&#39;t have floating point operations."}], "tags": [], "owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "is_accepted": false, "score": 1, "last_activity_date": 1561583610, "last_edit_date": 1561583610, "creation_date": 1561579131, "answer_id": 56780088, "question_id": 56779250, "link": "https://stackoverflow.com/questions/56779250/printing-of-negative-value-in-c-via-printf/56780088#56780088", "title": "Printing of negative value in c via printf", "body": "<p>On my CentOS 7 Intel 64 architecture, sizeof(float) is 4. So little endian result that I see on my test of 00 00 C8 C1 is a negative number. The Intel single precision floating point representation is:</p>\n\n<pre><code>1 bit sign\n8 bit exponent\n23 bit significand (with the first 1 bit implied)\n</code></pre>\n\n<p>As the Intel architecture is little-endian, the floating point value for 00 00 C8 C1 is <code>1100 0001 1100 1000 0000 0000 0000 0000</code>. The first 1 means the number is negative. The next 8 bits, <code>10000011</code> (Decimal 131), are the exponent, and the next 4 bits <code>1001</code>, with the implied 1 bit <code>11001</code>, is the number 25 shifted right 4 bits. The exponent of 131 is offset from 127 by 4, which is the number of bits that <code>1.1001</code> is shifted left to get back to 25.</p>\n\n<p>On a 64 bit representation, the exponent is 11 bits, and the exponent offset is 1023. So you would expect the number to be 1 (negative sign), Decimal 1027 in 11 bits <code>100 0000 0011</code>, then 25 decimal as <code>1001</code> with the implied leading 1 bit (as in the single precision version), then all zeroes which together is <code>C0 39 00 00 , 00 00 00 00</code>. You can see that the last 4 bytes are all zeros. But this is still little-endian, so as a 64 bit number it would look like <code>00 00 00 00 00 00 39 C0</code>. So you are getting all zeros if you print the first 4 bytes.</p>\n\n<p>You would see non-zero values from your program either by (a) Specifying an 8 character array in the declaration and printing all 8 (and you would see two bytes with 39 C0), or (b) using a value other than -25 in your test that requires more binary digits to represent like a large prime number or an irrational number (as suggested by @David C. Rankin).</p>\n\n<p>Checking sizeof(float) would determine what your floating point size (in bytes) and I would expect you to see it as 8, because you are seeing zeroes and not <code>C8 C1</code> like I do.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1561586128, "creation_date": 1561586128, "answer_id": 56781427, "question_id": 56779250, "link": "https://stackoverflow.com/questions/56779250/printing-of-negative-value-in-c-via-printf/56781427#56781427", "title": "Printing of negative value in c via printf", "body": "<p>First of all, this statement is flat-out wrong:</p>\n\n<pre><code>printf(\"\\n Float in hex: %x\",uninObj.flotVal);\n</code></pre>\n\n<p><code>%x</code> expects its corresponding argument to be <code>unsigned int</code>, and passing an argument of a different type (as you do here) results in undefined behavior - the output could literally be anything.  </p>\n\n<p>As of C99, you can use the <code>%a</code> or <code>%A</code> specifiers to print a hexadecimal representation of the floating-point <em>value</em> (<code>[+|-]<em>x</em>.<em>xxxx</em>...</code>, where each <em><code>x</code></em> is a hex digit).  This is not the same thing as the value's binary representation in memory, though.  </p>\n\n<p>For the union, I'd suggest you use <code>unsigned char</code> for <code>chrArray</code> and use <code>%hhx</code> to print out each byte:</p>\n\n<pre><code>union unin\n{\n    unsigned char chrArray[sizeof (float)];\n    float flotVal;\n}uninObj;\n\nprintf(\"%hhx %hhx %hhx %hhx\",uninObj.chrArray[0], uninObj.chrArray[1], \n       uninObj.chrArray[2], uninObj.chrArray[3]);    \n</code></pre>\n\n<p>The <code>hh</code> length modifier in <code>%hhx</code> says that the corresponding argument has type <code>unsigned char</code>, rather than the <code>unsigned int</code> <code>%x</code> usually expects.  </p>\n"}], "owner": {"reputation": 37, "user_id": 11451909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p5fqEMfiRK8/AAAAAAAAAAI/AAAAAAAAE9g/sfxbUH2GcMY/photo.jpg?sz=128", "display_name": "delve123", "link": "https://stackoverflow.com/users/11451909/delve123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1561586128, "creation_date": 1561574623, "question_id": 56779250, "link": "https://stackoverflow.com/questions/56779250/printing-of-negative-value-in-c-via-printf", "title": "Printing of negative value in c via printf", "body": "<p>I am running a test code for learning C. However I am curious regarding representation of negative numbers n hexadecimal, for which I have written a test-code. To my surprise, by running that test-code I am receiving only zero</p>\n\n<pre><code>    union unin\n    {\n        char chrArray[4];\n        float flotVal;\n    }uninObj;\n\n    uninObj.flotVal = -25;\n\n    printf(\"%x %x %x %x\",uninObj.chrArray[0], uninObj.chrArray[1], /\n           uninObj.chrArray[2], uninObj.chrArray[3]);\n    printf(\"\\n Float in hex: %x\",uninObj.flotVal);\n    return 0;\n</code></pre>\n"}, {"tags": ["c", "global", "local", "main"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1561573637, "post_id": 56778891, "comment_id": 100113114, "body": "Not really an appropriate question for SO. Do some research. Search for <a href=\"https://www.google.com/search?q=c+variable+scope+and+lifetime\" rel=\"nofollow noreferrer\">&quot;c variable scope and lifetime&quot;</a>."}, {"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1561573736, "post_id": 56778891, "comment_id": 100113160, "body": "I totally understand that and made a research but I am talking regarding one specific case (In the main function) take a look at my edited post @JohnnyMopp"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1561573764, "post_id": 56778891, "comment_id": 100113173, "body": "@JohnnyMopp: The question is appropriate."}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 3, "creation_date": 1561573779, "post_id": 56778891, "comment_id": 100113177, "body": "In this case, nothing really changes. But it is (almost) always better to declare variables in the smallest scope possible to avoid naming collisions and the like. Unless you have a very specific reason to not pass it to any functions that might need it, just declare it locally."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561574011, "post_id": 56778891, "comment_id": 100113290, "body": "@EricPostpischil Possibly. I didn&#39;t DV or close-vote. I just feel the OP would get a more in-depth explanation elsewhere."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561574156, "post_id": 56778891, "comment_id": 100113356, "body": "If you are going to do not fave any other functions, have all code in the <code>main</code> using a lots of gotos etc etc, the code will be so bad that the scope of the variables will the least important issue"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561574178, "post_id": 56778891, "comment_id": 100113369, "body": "@EricPostpischil: I think that&#39;s debatable; for me it&#39;s not clear what is meant by &quot;any advantage&quot;, @Defender; can you, besides the remarks on the positioning in memory and possible naming collisions say what you are aiming for?"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1593079102, "last_edit_date": 1593079102, "creation_date": 1561574354, "answer_id": 56779183, "question_id": 56778891, "link": "https://stackoverflow.com/questions/56778891/whats-the-difference-between-global-or-local-variables-regarding-the-main-funct/56779183#56779183", "title": "What&#39;s the difference between global or local variables regarding the main function?", "body": "<p>Good practice in software engineerIng is to limit the scope of names to where they are used. If <code>testvar</code> is declared outside of <code>main</code>, then it is visible to code outside <code>main</code>. This exposes it to bugs in which some other code uses <code>testvar</code> when it was intended to use some other object (either another object with a different name that was mistyped or an object with the same name, but a different instance of it was desired). Additionally, because it is declared with <code>int testvar;</code> and not <code>static int testvar;</code>, it will be linked with other objects named <code>testvar</code> in other modules. This is a serious problem\u2014it happens that one author of some routines used some name like <code>AmountOfMemory</code> for their own purposes and another author of other routines used the same name for their own purposes, and both pieces of code work separately, but, when linked into the same program, they break. For this reason, good code avoids global variables.</p>\n<p>If <code>testvar</code> is declared inside <code>main</code>, none of those errors can occur. The probability of writing a good program is increased. Thus, if <code>testvar</code> is not needed (by name) outside of <code>main</code>, declaring it inside <code>main</code> is preferable.</p>\n<p>There is also an issue of lifetime. Similarly to scope (where a name is visible), we prefer to limit lifetime (when an object exists). In the case of an object defined inside <code>main</code>, its lifetime is effectively the same as an object declared outside of any function\u2014it will exist for the duration of program execution. So lifetime is not a great concern here. However, there is a situation in which it is. In <code>C</code>, it is permissible to call <code>main</code> inside the function. This is rarely used. However, if it is used and if <code>testvar</code> is defined outside <code>main</code>, there will be only one instance of it, and all executions of <code>main</code> will share them. If <code>testvar</code> is defined inside <code>main</code>, each execution of <code>main</code> will have its own instance of <code>testvar</code>, separate from the others.</p>\n<p>Another difference between objects defined inside functions and those defined outside functions is that C automatically initializes objects defined outside functions to zero by default. This however would not affect the choice of where to define the object as an explicit initialization can be provided as desired.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561574583, "post_id": 56779222, "comment_id": 100113541, "body": "Objects with automatic storage duration can be accessed anywhere in the program, by passing their addresses. The <b>name</b> of an object is limited to its scope, not its accessibility."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561574634, "post_id": 56779222, "comment_id": 100113562, "body": "@EricPostpischil You can pass the address to other functions but you can&#39;t directly access the variable in other functions. That&#39;s the difference"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561574726, "post_id": 56779222, "comment_id": 100113607, "body": "Per C 2018 3.1 1, \u201caccess\u201d means \u201cto read or modify the value of an object\u201d. When any code reads or modifies the value of an object, even if it does it by means of a pointer, it accesses the object. One can understand the C standard better, more accurately, and more precisely by understanding that a \u201cvariable\u201d is actually an identifier (its name) and an object (a region of storage that can hold a value). The identifier and the object are different things with different characteristics. The object is accessible anywhere (but not anytime). The identifier is limited to its scope."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561574900, "post_id": 56779222, "comment_id": 100113690, "body": "@EricPostpischil Guess you must be in the nitpick mode. Anyway... answer edited"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561574961, "post_id": 56779222, "comment_id": 100113714, "body": "Do you expect a computer to read your code intuitively and \u201cknow\u201d what you mean even if you make a little mistake here and there? Software engineering means designing for a <b>machine</b> that can do nothing but mechanically pick nits. The only way to be a good software engineer is to be thoroughly detail oriented."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1561574839, "last_edit_date": 1561574839, "creation_date": 1561574538, "answer_id": 56779222, "question_id": 56778891, "link": "https://stackoverflow.com/questions/56778891/whats-the-difference-between-global-or-local-variables-regarding-the-main-funct/56779222#56779222", "title": "What&#39;s the difference between global or local variables regarding the main function?", "body": "<blockquote>\n  <p>For example what's the difference here except that we can't use the testvar in the second case in other functions?</p>\n</blockquote>\n\n<p>From a C standard point of view that is actually the main difference (see later for another differance). If you define the variable inside <code>main</code> it has <strong>automatic storage duration</strong> and is only accessible using its variable name inside <code>main</code>. If you define  the variable outside <code>main</code> it has <strong>static storage duration</strong> and can be accessed using its variable name from anywhere in the code.</p>\n\n<p>One difference is that variables with static storage duration are default initialized while variables with automatic storage duration are left uninitialized. So in your first example <code>testvar</code> will be initialized to zero while it is uninitialized in the second example.</p>\n"}, {"tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": false, "score": 1, "last_activity_date": 1561583809, "creation_date": 1561583809, "answer_id": 56781003, "question_id": 56778891, "link": "https://stackoverflow.com/questions/56778891/whats-the-difference-between-global-or-local-variables-regarding-the-main-funct/56781003#56781003", "title": "What&#39;s the difference between global or local variables regarding the main function?", "body": "<p><strong>\"While I know what's the difference between local and global variables I just can't understand if it's important at all\"</strong></p>\n\n<p>For me, when learning C, I felt like I didn't <em>really</em> understand the difference between local and global variables, <em>until</em> I understood why it's important.</p>\n\n<p>Eric Postpischil's answer about scope and lifetime says it all.  It's not a mere difference in how and where you can use the variables; it's the broader implications about what can happen because of that access.</p>\n\n<p>So don't think in terms of <strong>\"if I am going only to use a variable inside main()\"</strong>; think in terms of encapsulation, modularity, interfaces, and shared code.  I would go so far as to suggest <em>never</em> using global variables; any time you are tempted to do so, it will be worth the effort to find another way to accomplish what you are trying to do.  Your future self will thank you for solid programming habits you foster now.</p>\n"}], "owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "closed_date": 1561611729, "answer_count": 3, "score": -1, "last_activity_date": 1593079102, "creation_date": 1561573159, "last_edit_date": 1561573666, "question_id": 56778891, "link": "https://stackoverflow.com/questions/56778891/whats-the-difference-between-global-or-local-variables-regarding-the-main-funct", "closed_reason": "Needs details or clarity", "title": "What&#39;s the difference between global or local variables regarding the main function?", "body": "<p>While I know what's the difference between local and global variables I just can't understand if it's important at all, especially when talking about local variables inside the main function.\nFor example what's the difference here except that we can't use the testvar in the second case in other functions?</p>\n\n<p>First Case:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint testvar;\n</code></pre>\n\n<p>Second Case:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void){\nint testvar;\n}\n</code></pre>\n\n<p><strong>Edit: What I mean is that if I am going only to use a variable inside main then does declaring it as global have any advantage Or that in this specefic case nothing different at all?</strong></p>\n"}, {"tags": ["c", "perl", "printf"], "comments": [{"owner": {"reputation": 938, "user_id": 3894179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c6b1c2c08d1075995cb780ee8a2e36e?s=128&d=identicon&r=PG", "display_name": "Andra", "link": "https://stackoverflow.com/users/3894179/andra"}, "edited": false, "score": 0, "creation_date": 1561573124, "post_id": 56778821, "comment_id": 100112877, "body": "Perl does not has an integer max bound"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1561574155, "post_id": 56778821, "comment_id": 100113354, "body": "<a href=\"https://perldoc.perl.org/functions/sprintf.html\" rel=\"nofollow noreferrer\">Perl documentation for format strings</a> says &quot;<code>%u</code> - unsigned integer, in decimal&quot;. Nothing about 32-bit."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1561574566, "post_id": 56778821, "comment_id": 100113533, "body": "Re &quot;<i>I would have thought that %&quot;u&quot; meant a 32-bit unsigned</i>&quot;, It doesn&#39;t even mean that in C."}, {"owner": {"reputation": 89, "user_id": 7785442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59acd9522d58075e02707358351440f?s=128&d=identicon&r=PG&f=1", "display_name": "jplw", "link": "https://stackoverflow.com/users/7785442/jplw"}, "edited": false, "score": 0, "creation_date": 1561574604, "post_id": 56778821, "comment_id": 100113548, "body": "Yes, but I would have thought that &quot;%u&quot; meant a 32-bit unsigned, but apparently not. So then, the question is, how can I convert the long unsigned to a 32-bit unsigned."}, {"owner": {"reputation": 89, "user_id": 7785442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59acd9522d58075e02707358351440f?s=128&d=identicon&r=PG&f=1", "display_name": "jplw", "link": "https://stackoverflow.com/users/7785442/jplw"}, "edited": false, "score": 0, "creation_date": 1561574674, "post_id": 56778821, "comment_id": 100113580, "body": "But it works fine in C!  I meant &quot;%u&quot; of course."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1561574735, "post_id": 56778821, "comment_id": 100113617, "body": "Only by accident. I&#39;m fairly sure your example has undefined behavior. Casting to <code>(unsigned int)</code> would be fine, of course (but would not necessarily give you a 32-bit result; for that you want <code>uint32_t</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1561574405, "post_id": 56779014, "comment_id": 100113456, "body": "Re &quot;<i>17860374324089702869 become 3336554965 in C</i>&quot;, Not always, even. <code>int</code> has to be at least 16-bit in size, you could get entirely different (smaller, larger) results on different machines/compiler. (And that&#39;s assuming this is defined behaviour.)"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1561574419, "post_id": 56779014, "comment_id": 100113461, "body": "Technically, there&#39;s no overflow of unsigned integers in C."}], "tags": [], "owner": {"reputation": 938, "user_id": 3894179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c6b1c2c08d1075995cb780ee8a2e36e?s=128&d=identicon&r=PG", "display_name": "Andra", "link": "https://stackoverflow.com/users/3894179/andra"}, "is_accepted": false, "score": 1, "last_activity_date": 1561574621, "last_edit_date": 1561574621, "creation_date": 1561573616, "answer_id": 56779014, "question_id": 56778821, "link": "https://stackoverflow.com/questions/56778821/printf-difference-between-c-and-perl/56779014#56779014", "title": "printf difference between c and perl", "body": "<p>There's no such unsigned 32-bit integer in Perl. The 17860374324089702869 become 3336554965 in C is because unsigned 32-bit integer has a range 0 to 4294967295, when there's overflow occur, the integer would came up from the lower bound and vice versa</p>\n\n<p>e.g</p>\n\n<pre><code>unsigned int a = 4294967296 // will be 0 because unsigned integer upper limit is 4294967295\n</code></pre>\n\n<p>So you only have to module it with 4294967296 because there's 4294967296 numbers from 0 to 4294967295</p>\n\n<pre><code>#!/usr/bin/perl\n\nprintf \"%09u\", 17860374324089702869 % 4294967296\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1561574652, "last_edit_date": 1561574652, "creation_date": 1561574282, "answer_id": 56779167, "question_id": 56778821, "link": "https://stackoverflow.com/questions/56778821/printf-difference-between-c-and-perl/56779167#56779167", "title": "printf difference between c and perl", "body": "<p>In C, <code>printf</code> <code>%u</code> takes an <code>unsigned int</code>. Whether that is a 32-bit or 64-bit value or something different entirely depends on your C implementation. The standard only requires that <code>int</code> be at least 16 bits wide. (Since the value you're passing in your example doesn't fit in an <code>unsigned int</code>, I'm pretty sure your code has undefined behavior: You're not passing an <code>unsigned int</code> to <code>%u</code> as it expects you to.)</p>\n\n<p>In Perl, <code>%u</code> converts its argument to an unsigned integer. The width of this integer depends on how Perl was compiled; it is normally either a 32-bit or 64-bit type. You can query the configuration details for your perl by running <code>perl -V:uvsize</code> (the size of Perl's unsigned integer type in bytes) and <code>perl -V:uvtype</code> (the corresponding C type).</p>\n\n<p>If you want to explicitly truncate your value to 32 bits, the easiest way is probably to apply a bit mask:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use constant { UINT32_MAX =&gt; 0xffff_ffff };\nprint 17860374324089702869 &amp; UINT32_MAX, \"\\n\";\n</code></pre>\n\n<p>Then you don't really need <code>printf</code> either.</p>\n"}, {"tags": [], "owner": {"reputation": 2977, "user_id": 2231691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c897cef08f82aba800a8e12442aed40?s=128&d=identicon&r=PG", "display_name": "afenster", "link": "https://stackoverflow.com/users/2231691/afenster"}, "is_accepted": false, "score": 0, "last_activity_date": 1561574291, "creation_date": 1561574291, "answer_id": 56779168, "question_id": 56778821, "link": "https://stackoverflow.com/questions/56778821/printf-difference-between-c-and-perl/56779168#56779168", "title": "printf difference between c and perl", "body": "<p>This is generally not about Perl's <code>printf</code>/<code>sprintf</code>, but about how Perl stores integers and passes integers to functions. As mentioned in other responses, there is no 32-bit integer type in Perl.</p>\n\n<p>Basically, you need to strip the half of your 64-bit integer to make it 32-bit. To do this, just use binary <code>&amp;</code>:</p>\n\n<pre><code>perl -e 'printf(\"%09u\\n\", 17860374324089702869 &amp; 0xffffffff);'\n3336554965\n</code></pre>\n\n<p>Here, the <code>&amp;</code> operation leaves bits of the lower 4 bytes unchanged, but sets bits of the higher 4 bytes to zeros.</p>\n"}, {"tags": [], "owner": {"reputation": 1854, "user_id": 224935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/59h0o.jpg?s=128&g=1", "display_name": "Jay Elston", "link": "https://stackoverflow.com/users/224935/jay-elston"}, "is_accepted": false, "score": 0, "last_activity_date": 1561581313, "creation_date": 1561581313, "answer_id": 56780507, "question_id": 56778821, "link": "https://stackoverflow.com/questions/56778821/printf-difference-between-c-and-perl/56780507#56780507", "title": "printf difference between c and perl", "body": "<p>The C language has a plethora of numeric data types (and sizes). Perl has 3 type of data -- \"<a href=\"https://perldoc.perl.org/perldata.html\" rel=\"nofollow noreferrer\">scalars, arrays of scalars, and associative arrays of scalars</a>\", </p>\n\n<p>In Perl, scalar values are polymorphic, so the value <em>17860374324089702869</em> can be treated as a string or a number, depending on how it is used. When used in a printf statement, it treated as the number 17860374324089702869 and printed as such.</p>\n\n<p>In C, an unsigned integer is treated as an integer number in a range specified by the word size on the architecture you are compiling the program for. You should have received warning when you compiled. When I compiled the above statement with -Wall, here is the warning I got:</p>\n\n<p>warning: format \u2018%u\u2019 expects argument of type \u2018unsigned int\u2019, but argument 2 has type \u2018__int128\u2019 [-Wformat=]</p>\n\n<p><a href=\"https://stackoverflow.com/questions/25081972/maximum-integer-in-perl\">See this post discussing the maximum integer value that can be count to in Perl.</a></p>\n"}], "owner": {"reputation": 89, "user_id": 7785442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59acd9522d58075e02707358351440f?s=128&d=identicon&r=PG&f=1", "display_name": "jplw", "link": "https://stackoverflow.com/users/7785442/jplw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 56779167, "answer_count": 4, "score": 2, "last_activity_date": 1561581313, "creation_date": 1561572845, "last_edit_date": 1561573864, "question_id": 56778821, "link": "https://stackoverflow.com/questions/56778821/printf-difference-between-c-and-perl", "title": "printf difference between c and perl", "body": "<p>In C:</p>\n\n<pre><code>printf (\"%u\", 17860374324089702869);\n</code></pre>\n\n<p>prints \"3336554965\" (this is the answer I want!)</p>\n\n<p>In perl, the same line of code prints \"17860374324089702869\".</p>\n\n<p>How can I get perl to produce \"3336554965\" from \"17860374324089702869\".</p>\n\n<p>My gut says this is 64-bit vs 32-bit issue, but it does not appear that the perl statement is doing anything at all to the number.</p>\n"}, {"tags": ["c", "assembly", "x86-64", "jit"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1561573842, "post_id": 56778792, "comment_id": 100113198, "body": "There is no need for a <code>REX.W</code> as the operand size is fixed. After the opcode a <code>ModRM</code> is expected, its encoding and subsequent bytes (and even other <code>REX</code> prefixes) depends on the addressing mode you need. Which specific form of <code>movsd xmm0, m64</code> are you encoding? BTW <code>nasm</code> and <code>ndisasm</code> are very handy when crafting instructions, the first can be used to quickly create a template, the second to check the results."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1561583026, "post_id": 56778792, "comment_id": 100116689, "body": "In GNU C, you need <a href=\"https://stackoverflow.com/questions/35741814/how-does-builtin-clear-cache-work#comment85964322_35741869\"><code>__builtin___clear_cache</code> after writing a buffer, before you can execute it as a function pointer</a>.  Otherwise the stores to <code>memory[]</code> can be optimized away as dead stores.  (x86 doesn&#39;t actually need any cache flushing, it&#39;s just to tell the optimizer that the store results get used as code and thus aren&#39;t dead after all.)"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1561582852, "post_id": 56779095, "comment_id": 100116630, "body": "Also note that the function is declared to return a <code>double</code>, so you need an 8-byte constant.  IDK why the OP is using a <code>3.1f</code> <code>float</code>; that just makes more work for themselves."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1561739767, "post_id": 56779095, "comment_id": 100175048, "body": "@PeterCordes Indeed!  If desired, it is possible to load a 32 bit float from memory with <code>cvtss2sd</code>."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 3, "last_activity_date": 1561573946, "creation_date": 1561573946, "answer_id": 56779095, "question_id": 56778792, "link": "https://stackoverflow.com/questions/56778792/movsd-from-memory-to-xmm0-in-c-x86-64-jit/56779095#56779095", "title": "movsd from memory to xmm0 in c x86-64 jit", "body": "<p>SSE instructions generally don't support immediates except for some rare instructions with a one-byte immediate to control their operation.  Thus you need to:</p>\n\n<ul>\n<li>store <code>myfloat</code> to some nearby memory area</li>\n<li>generate a memory operand the references this area</li>\n</ul>\n\n<p>Both steps are easy.  For the first step, I'd simply use the beginning of <code>memory</code> and let the code start right afterwards.  Note that in this case, you need to make sure to return a pointer to the beginning of the function, not the beginning of <code>memory</code>.  Other solutions are possible.  Just make sure that <code>myfloat</code> is stored within &pm;2 GiB from the code.</p>\n\n<p>To generate the operand, revisit the Intel manuals.  The addressing mode you want is a 32 bit RIP-relative operand.  This is generated with mod = 0, r/m = 5.  The displacement is a signed 32 bit number that is added to the value of RIP right at the end of the instruction (this is where the +4 comes from as have to factor in the lenth of the displacement).</p>\n\n<p>Thus we have something like:</p>\n\n<pre><code>memory[i++] = 0xf2; /*******************/\nmemory[i++] = 0x0f; /* MOVSD xmm0, m64 */\nmemory[i++] = 0x10; /*******************/\nmemory[i++] = 0005 | xmm(0) &lt;&lt; 3; /* mod = 0, r/m = 5: [rip + disp32] */\n*(int *)(memory + i) = memory + i + 4 - addr_of_myfloat;\ni += 4;\nmemory[i++] = 0xc3; /* RET */\n</code></pre>\n\n<p>Note that the REX prefix is not needed here.</p>\n"}], "owner": {"reputation": 1838, "user_id": 537352, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mb4B5.jpg?s=128&g=1", "display_name": "Shootfast", "link": "https://stackoverflow.com/users/537352/shootfast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 56779095, "answer_count": 1, "score": 0, "last_activity_date": 1561573946, "creation_date": 1561572720, "question_id": 56778792, "link": "https://stackoverflow.com/questions/56778792/movsd-from-memory-to-xmm0-in-c-x86-64-jit", "title": "movsd from memory to xmm0 in c x86-64 jit", "body": "<p>I'm attempting to write a small x86-64 JIT, and I'm a little over my head in a few places.</p>\n\n<p>I'm trying to JIT a simple function that assigns the value of a float into the xmm0 register and then returns it, but I am unsure of how I should go about encoding the arguments to the movsd call.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<pre><code>/* main.c */\n#include &lt;stdio.h&gt;\n#include &lt;sys/mman.h&gt;\n\n#define xmm(n) (n)\n\ntypedef double(*fn)();\n\nfn jit(){\n    char* memory = mmap(NULL,\n                        4096,\n                        PROT_READ|PROT_WRITE|PROT_EXEC,\n                        MAP_PRIVATE|MAP_ANONYMOUS,\n                        -1, 0);\n    int i=0;\n    float myfloat = 3.1f;\n    memory[i++] = 0x48; /* REX.W */\n    memory[i++] = 0xf2; /*******************/\n    memory[i++] = 0x0f; /* MOVSD xmm0, m64 */\n    memory[i++] = 0x10; /*******************/\n\n    memory[i++] = 0x47 | xmm(0) &lt;&lt; 3; /* Not 100% sure this is correct */\n\n    memory[i++] = 0; /* what goes here to load myfloat into xmm0? */\n\n    memory[i++] = 0xc3; /* RET */\n    return (fn) memory;\n}\n\nint main(){\n    fn f = jit();\n    printf(\"result: %f\\n\", (*f)());\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "http", "hash"], "comments": [{"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1561594475, "post_id": 56778618, "comment_id": 100119558, "body": "Your hash function will always go the the full length of the request. <code>(hashval &lt; ULONG_MAX)</code> will <i>always</i> be true unless <code>hashval == ULONG_MAX</code>. The only way it wouldn&#39;t is if you had 4 consecutive <code>0xff</code> bytes in the request string. So in most cases your hash code is just the last 4 characters of the request string."}, {"owner": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1561661705, "post_id": 56778618, "comment_id": 100148780, "body": "Thanks for this. The hash val does represent the last couple of bytes of the string. I should instead hash the request line only."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1561683816, "post_id": 56778618, "comment_id": 100154427, "body": "Regardless of what you hash, you should use a good <a href=\"https://en.wikipedia.org/wiki/Hash_function\" rel=\"nofollow noreferrer\">hash function</a>.. The <a href=\"https://en.wikipedia.org/wiki/Jenkins_hash_function\" rel=\"nofollow noreferrer\">Jenkins hash</a>, for example, is pretty good."}], "answers": [{"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1561572436, "creation_date": 1561572436, "answer_id": 56778739, "question_id": 56778618, "link": "https://stackoverflow.com/questions/56778618/how-do-http-caches-store-cached-requests/56778739#56778739", "title": "How do HTTP caches STORE cached requests?", "body": "<blockquote>\n  <p>Is this because of the <code>(hashval % size)</code> line ?</p>\n</blockquote>\n\n<p>No, of course the modulo division increases the possibility of collisions but even without using it you can get duplicate cases, a perfect hash is quite difficult to achieve, not to say impossible when the samples are random. I suggest you to find a hashmap implementation managing collisions (where every node in the hash table stores a link to the next collisioned key which you have to compare with your string)</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "edited": false, "score": 0, "creation_date": 1561573385, "post_id": 56778766, "comment_id": 100112996, "body": "I might have improperly worded my question. I meant how do they physically store cached requests."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "reply_to_user": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "edited": false, "score": 0, "creation_date": 1561573519, "post_id": 56778766, "comment_id": 100113063, "body": "Still, that depends on the client. Some put it on disk, some only in memory. Some structured, some not. Or do I still misunderstand?"}, {"owner": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "edited": false, "score": 0, "creation_date": 1561574093, "post_id": 56778766, "comment_id": 100113324, "body": "Naturally, the decision of whether or not to cache is affected by the headers in the request message. My question was in the event that you do decide to cache, what would be the most effective way to store the requests ?"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "reply_to_user": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "edited": false, "score": 0, "creation_date": 1561574435, "post_id": 56778766, "comment_id": 100113469, "body": "If you mean servers; than it&#39;s up to the server. That&#39;s often done in various way&#39;s as well; A lot of them use a hash, and a memory storage. But that&#39;s not typical http related; it&#39;s a server implementation. Can be <a href=\"https://redislabs.com/solutions/use-cases/redis-for-caching/\" rel=\"nofollow noreferrer\">reddis</a> for example."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "reply_to_user": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "edited": false, "score": 0, "creation_date": 1561574569, "post_id": 56778766, "comment_id": 100113534, "body": "The hash (server) is usually generated based on either; the calling url, or the domain in which it&#39;s relevant. Can be a custom string, hashed for fast access."}], "tags": [], "owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1561574645, "last_edit_date": 1561574645, "creation_date": 1561572574, "answer_id": 56778766, "question_id": 56778618, "link": "https://stackoverflow.com/questions/56778618/how-do-http-caches-store-cached-requests/56778766#56778766", "title": "How do HTTP caches STORE cached requests?", "body": "<p>To answer your questions:</p>\n\n<blockquote>\n  <p>How do HTTP caches store their requests ?</p>\n</blockquote>\n\n<p>This is totally up to the client. Make sure you honor the cache headers. See this article for more information: <a href=\"https://www.keycdn.com/blog/http-cache-headers\" rel=\"nofollow noreferrer\">https://www.keycdn.com/blog/http-cache-headers</a></p>\n\n<blockquote>\n  <p>Is this because of the (hashval % size) line ? </p>\n</blockquote>\n\n<p>Well, yes, it only gives you <code>size</code> possibilities.</p>\n\n<blockquote>\n  <p>Is the above method a good one in terms of scalability and efficiency ? and if so does the hash function match it properly ? Or is there a more common method for hashing requests ?</p>\n</blockquote>\n\n<p>No, it doesn't seem to work as you state. See this answer for a proper implementation:</p>\n\n<p><a href=\"https://stackoverflow.com/a/7666577/2416958\">https://stackoverflow.com/a/7666577/2416958</a></p>\n\n<p><hr> \nFrom comments:</p>\n\n<p>Serverside: </p>\n\n<p>It's up to the server. That's often done in various way's as well; A lot of them use a hash, and a memory storage. But that's not typical http related; it's a server implementation. Can be <a href=\"https://redislabs.com/solutions/use-cases/redis-for-caching/\" rel=\"nofollow noreferrer\">reddis</a> for example.</p>\n\n<p>The hash (server) is usually generated based on either; the calling url, or the domain in which it's relevant. Can be a custom string, hashed for fast access.</p>\n\n<hr>\n\n<p>As for the \"most effective way\"; it depends. <em>I know, its a boring answer</em>. As for speed; an optimized structure in memory would be the fastest way to stream the data to the client. But it's often takes the largest amount of memory. So there are always a couple of things to consider.</p>\n"}], "owner": {"reputation": 53, "user_id": 6939205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-as2HguB3VU4/AAAAAAAAAAI/AAAAAAAAAQY/_qCe_SRl1Fs/photo.jpg?sz=128", "display_name": "Nelson Mongare", "link": "https://stackoverflow.com/users/6939205/nelson-mongare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56778766, "answer_count": 2, "score": 0, "last_activity_date": 1561574645, "creation_date": 1561571926, "last_edit_date": 1561574357, "question_id": 56778618, "link": "https://stackoverflow.com/questions/56778618/how-do-http-caches-store-cached-requests", "title": "How do HTTP caches STORE cached requests?", "body": "<p>How do HTTP caches store their requests ? Is there a commonly used protocol for caching requests or does each implementation have its own method for caching ?  </p>\n\n<p><strong>EDIT</strong> : By this I mean how do the servers PHYSICALLY store cached requests, once the decision to cache has already been made. </p>\n\n<p>I was looking through the functionality of some HTTP cache implementations such as <a href=\"https://github.com/jech/polipo\" rel=\"nofollow noreferrer\">polipo</a> and found that they store (at least) part of their cache in the local file system but later found that nginx caches files/ file content (meaning there's a more efficient method for accessing cashed requests than storing them in the file system).</p>\n\n<p>I was playing around with possible ideas and I tried to implement this method: </p>\n\n<pre><code>Hash request message -&gt; store in a AVL -&gt; access later using the hash value\n\n</code></pre>\n\n<p>This way it's simpler and reasonably effecient to search through the AVL to see whether the request has been serviced before. The AVL tree node has a pointer to the requests contents, this way they remain in main memory.</p>\n\n<p>And I used this as the hash function: </p>\n\n<pre><code>static int hash( int size, request_t* bst_l) {\n\n    unsigned long int hashval;\n    int i = 0;\n\n    // Convert our string to an integer\n    while( hashval &lt; ULONG_MAX &amp;&amp; i &lt; strlen( bst_l-&gt;MSG ) ) {\n        hashval = hashval &lt;&lt; 8;\n        hashval += bst_l-&gt;MSG[ i ];\n        i++;\n    }\n\n    return hashval % size;\n}\n\n\n</code></pre>\n\n<p>where size is the size of the AVL tree.</p>\n\n<p>From this I expected a unique hash value for every unique message . Though I keep getting similar hash values for different requests. Is this because of the (hashval % size) line ?  </p>\n\n<p>Is the above method a good one in terms of scalability and efficiency ? and if so does the hash function match it properly ? Or is there a more common method for hashing requests ?</p>\n"}, {"tags": ["c", "arrays", "function", "csv", "struct"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1561571607, "post_id": 56778512, "comment_id": 100112224, "body": "Some items have spaces. <code>%s</code> does not expect spaces. Maybe read whole line and use <a href=\"https://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow noreferrer\">strok</a> instead."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561571946, "post_id": 56778512, "comment_id": 100112368, "body": "The commas in <code>fscanf</code> aren&#39;t needed. In fact, they&#39;re probably what&#39;s causing your issue."}, {"owner": {"reputation": 19, "user_id": 11704574, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xLcHEmcwnaQ/AAAAAAAAAAI/AAAAAAAABSk/qEBCotJB6_k/photo.jpg?sz=128", "display_name": "Claudio Rizzi", "link": "https://stackoverflow.com/users/11704574/claudio-rizzi"}, "edited": false, "score": 0, "creation_date": 1561571992, "post_id": 56778512, "comment_id": 100112394, "body": "the .csv is in te format 1;Name;Surname;field4;field5;field6;field7 i&#39;ve posted this version for legibility"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561572317, "post_id": 56778512, "comment_id": 100112516, "body": "you suppose <i>nome</i> and <i>cognome</i> are array of <i>char</i> but they are only <i>char</i>, you write/read out of them, see my answer"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1561573849, "post_id": 56778512, "comment_id": 100113202, "body": "Lisibility is indeed important, but it you fail to give the exact format, we won&#39;t be able to guess it, and will propose ways that will not work :-(."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1561574119, "post_id": 56778512, "comment_id": 100113332, "body": "@SergeBallesta yes the OP missed the comma in the csv file, else not possible to know for instance where a state name finishes and where he college name starts. The problem of <i>char</i> rather than array of <i>char</i> also exist in <i>team</i>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1561574317, "post_id": 56778512, "comment_id": 100113426, "body": "The csv file does not use commas but semicolons which is more common in south european languages like French or Italian."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561574341, "post_id": 56778512, "comment_id": 100113435, "body": "@ClaudioRizzi are you using &#39;;&#39; or &#39;,&#39; in the csv ? Your remark says &#39;;&#39; but the <i>fscanf</i> format says &#39;,&#39;"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561576754, "post_id": 56778512, "comment_id": 100114438, "body": "While not optimal, you can replace your last <code>%s</code> with <code>%[^\\n]</code> to read <i>Field7</i>, including the whitespace, e.g. <code>while (fscanf( f, &quot;%d,%s,%s,%d,%s,%s,%[^\\n]&quot;, ...</code> NONE of the character conversions will work if you declare, e.g. <code>char nome;</code> instead of <code>char nome[64];</code>, etc.. And in that case since <code>nome</code> will already be converted to a pointer on access, you will drop the <code>&#39;&amp;&#39;</code> before the variable, e.g. <code>array[count].college</code> for all array types. See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561579619, "post_id": 56778512, "comment_id": 100115321, "body": "@ClaudioRizzi you have several problems in your code, I edited my answer to explain them and also to add a proposal"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561577361, "post_id": 56778633, "comment_id": 100114681, "body": "Good write up, I would just also mention that if using <code>-std=c99</code> or <code>c11</code>, <code>strdup</code> will likely not be available. In that case they can simply write a trivial replacement."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561577548, "post_id": 56778633, "comment_id": 100114758, "body": "@DavidC.Rankin you are right (I will put a full proposal)"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1561580386, "last_edit_date": 1561580386, "creation_date": 1561571985, "answer_id": 56778633, "question_id": 56778512, "link": "https://stackoverflow.com/questions/56778512/problem-with-a-function-that-insert-the-content-of-a-csv-into-an-array-of-struct/56778633#56778633", "title": "Problem with a function that insert the content of a csv into an array of struct", "body": "<blockquote>\n  <p>The printf don't show me what i swear</p>\n</blockquote>\n\n<p>there are several errors in your code producing that unexpected behavior.</p>\n\n<hr>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>while(fscanf(f, \"%d,%s,%s,%d,%s,%s,%s\\n\", &amp;array[count].id,\n               &amp;array[count].nome, &amp;array[count].cognome,\n               &amp;array[count].eta, &amp;array[count].ruolo,\n               &amp;array[count].team.nome, &amp;array[count].college) == 7)\n</code></pre>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n<pre><code>   printf (\"%s %s\", &amp;array[count].nome, &amp;array[count].cognome);\n</code></pre>\n</blockquote>\n\n<p>you suppose <em>nome</em> and <em>cognome</em> and <em>ruolo</em> and <em>college</em> are array of <em>char</em> but they are only <em>char</em> :</p>\n\n<blockquote>\n<pre><code>char nome;\nchar cognome;\n...\nchar ruolo;\n...\nchar college;\n</code></pre>\n</blockquote>\n\n<p>so you read/write out of these fields, and you very probably have the same problem for <em>nome</em> in <em>team</em>.</p>\n\n<p>The simple way is to use arrays, for instance ( I use arbitrarily a size of 16 for the strings except <em>rualo</em> which seems to use only 2 characters out of the ending null character)  :</p>\n\n<pre><code>typedef struct{\n    int id;\n    char nome[16];\n    char cognome[16];\n    int eta;\n    char ruolo[3];\n    squadra team;\n    char college[16];\n    int td;\n} giocatore;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>while(fscanf(f, \"%d,%15s,%15s,%d,%2s,%s,%15s\\n\", &amp;array[count].id,\n             array[count].nome, array[count].cognome,\n             array[count].eta, array[count].ruolo,\n             array[count].team.nome, array[count].college) == 7)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>printf (\"%s %s\", array[count].nome, array[count].cognome);\n</code></pre>\n\n<p>or more probably</p>\n\n<pre><code>printf (\"%s %s\\n\", array[count].nome, array[count].cognome); /* add \\n */\n</code></pre>\n\n<p>and do the same for <em>nome</em> in <em>team</em> (the definition is hidden).</p>\n\n<p>You can also use pointer to <em>char</em> for <em>nome</em> and <em>cognome</em> and <em>ruolo</em> (and the same for <em>nome</em>  in <em>team</em>) :</p>\n\n<pre><code>typedef struct{\n    int id;\n    char * nome;\n    char * cognome;\n    int eta;\n    char * ruolo;\n    squadra team;\n    char * college;\n    int td;\n} giocatore;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>char nome[16];\nchar cognome[16];\nchar ruolo[3];\nchar college[16];\n\nwhile(fscanf(f, \"%d,%15s,%15s,%d,%2s,%s,%15s\\n\", &amp;array[count].id, nome,\n             cognome, array[count].eta, array[count].ruolo, \n             array[count].team.nome, college) == 7) {\n  array[count].nome = strdup(nome);\n  array[count].cognome = strdup(cognome);\n  array[count].ruolo = strdup(ruolo);\n  array[count].college = strdup(college);\n</code></pre>\n\n<p>Do not forget in that case to <em>free</em> the dynamic allocated arrays of <em>char</em> when you remove entry/entries or <em>array</em> to not create memory leaks.</p>\n\n<hr>\n\n<p>Also having</p>\n\n<blockquote>\n<pre><code>giocatore* lista_giocatori[numero_giocatori];\n</code></pre>\n</blockquote>\n\n<p>the call</p>\n\n<blockquote>\n<pre><code>giocatori_in_array(file_giocatori,*lista_giocatori);\n</code></pre>\n</blockquote>\n\n<p>is invalid because <code>*lista_giocatori</code> is <code>lista_giocatori[0]</code> which is a <em>giocatore</em> but <code>giocatori_in_array</code>  waits for an array of <em>giocatore</em>.</p>\n\n<p>Can be</p>\n\n<pre><code>giocatore lista_giocatori[numero_giocatori];\n...\ngiocatori_in_array(file_giocatori, lista_giocatori);\n</code></pre>\n\n<hr>\n\n<p><code>giocatori_in_array</code> do not receive the size of <em>array</em> so you also have the risk to write out of <em>array</em> in there are more entries in the files than the value of <code>giocatori_in_array</code>.</p>\n\n<p>You also need to know how much entries in the array are set, a way is to return that number rather than to have a <em>void</em> function.</p>\n\n<hr>\n\n<p>Out of these invalid memory accesses you cannot use <em>fscanf</em> to read several words through a single <code>%s</code>, so you need to read the rest of the line after the <em>ruolo</em> to extract the state and the college, and in case the <em>nome</em> and <em>cognore</em> can be on several words too you cannot use at all <em>fscanf</em> and you have to read all the line then to extract the fields for instance using <em>strtok</em> and <em>strtol</em> to get the number values.</p>\n\n<p>Note the comma/semicolon are missing in your example of csv file to separate the fields. Your <em>fscanf</em> format supposes you use comma, not semicolon as you indicate in a remark of your question.</p>\n\n<hr>\n\n<p>A proposal can be :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct {\n  char * nome;\n} squadra;\n\ntypedef struct{\n    int id;\n    char * nome;\n    char * cognome;\n    int eta;\n    char * ruolo;\n    squadra team;\n    char * college;\n    int td; /* unused */\n} giocatore;\n\nsize_t giocatori_in_array(FILE* f, size_t sz, giocatore array_giocatori[]);\n\nint main(int argc, char ** argv)\n{\n  if (argc != 2)\n    printf(\"Usage : %s &lt;csv file&gt;\\n\", *argv);\n  else {\n    FILE* file_giocatori = fopen(argv[1], \"r\");\n\n    if (file_giocatori == NULL)\n      fprintf(stderr, \"cannot open '%s'\\n\", argv[1]);\n    else {\n      const size_t numero_giocatori = 16;\n      giocatore lista_giocatori[numero_giocatori];\n      size_t n = giocatori_in_array(file_giocatori, numero_giocatori, lista_giocatori);\n\n      fclose(file_giocatori);\n\n      /* debug */\n      for (size_t i = 0; i != n; ++i) {\n        printf(\"id:%d nome:'%s' cognome:'%s' eta:%d ruolo:'%s' team:'%s' college:'%s'\\n\",\n               lista_giocatori[i].id,\n               lista_giocatori[i].nome,\n               lista_giocatori[i].cognome,\n               lista_giocatori[i].eta,\n               lista_giocatori[i].ruolo,\n               lista_giocatori[i].team.nome,\n               lista_giocatori[i].college);\n      }\n\n      /* free resources */\n      for (size_t i = 0; i != n; ++i) {\n        free(lista_giocatori[i].nome);\n        free(lista_giocatori[i].cognome);\n        free(lista_giocatori[i].ruolo);\n        free(lista_giocatori[i].team.nome);\n        free(lista_giocatori[i].college);\n      }\n    }\n  }\n\n  return 0;\n}\n\nsize_t giocatori_in_array(FILE* f, size_t sz, giocatore array[])\n{\n  size_t count = 0;\n  char line[256];\n\n  while ((count &lt; sz) &amp;&amp; fgets(line, sizeof(line), f)) {\n    char * s = strtok(line, \",;\");\n\n    if ((s == NULL) || (sscanf(s, \"%d\", &amp;array[count].id) != 1)) {\n      fprintf(stderr, \"invalid id line %zu\\n\", count);\n      break;\n    }\n\n    if ((s = strtok(NULL, \",;\")) == NULL) {\n      fprintf(stderr, \"invalid nome line %zu\\n\", count);\n      break;\n    }\n    array[count].nome = strdup(s);\n\n    if ((s = strtok(NULL, \",;\")) == NULL) {\n      fprintf(stderr, \"invalid cognome line %zu\\n\", count);\n      break;\n    }\n    array[count].cognome = strdup(s);\n\n    if (((s = strtok(NULL, \",;\")) == NULL)  || (sscanf(s, \"%d\", &amp;array[count].eta) != 1)) {\n      fprintf(stderr, \"invalid eta line %zu\\n\", count);\n      break;\n    }\n\n    if ((s = strtok(NULL, \",;\")) == NULL) {\n      fprintf(stderr, \"invalid ruolo line %zu\\n\", count);\n      break;\n    }\n    array[count].ruolo = strdup(s);\n\n    if ((s = strtok(NULL, \",;\")) == NULL) {\n      fprintf(stderr, \"invalid team nome line %zu\\n\", count);\n      break;\n    }\n    array[count].team.nome = strdup(s);\n\n    if ((s = strtok(NULL, \",;\\n\")) == NULL) {\n      fprintf(stderr, \"invalid college line %zu\\n\", count);\n      break;\n    }\n    array[count].college = strdup(s);\n\n    count += 1;\n  }\n\n  return count;\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wall -Wextra c.c\npi@raspberrypi:/tmp $ cat f.csv \n1;Kyler;Murray;22;QB;Arizona Cardinals;Oklahoma\n2;Nick;Bosa;22;DE;San Francisco;Ohio State\n3;Quinnen;Williams;22;DE;New York Jets;Alabama\n4;Clelin;Ferrell;22;DE;Oakland Raiders;Clemson\npi@raspberrypi:/tmp $ ./a.out f.csv \nid:1 nome:'Kyler' cognome:'Murray' eta:22 ruolo:'QB' team:'Arizona Cardinals' college:'Oklahoma'\nid:2 nome:'Nick' cognome:'Bosa' eta:22 ruolo:'DE' team:'San Francisco' college:'Ohio State'\nid:3 nome:'Quinnen' cognome:'Williams' eta:22 ruolo:'DE' team:'New York Jets' college:'Alabama'\nid:4 nome:'Clelin' cognome:'Ferrell' eta:22 ruolo:'DE' team:'Oakland Raiders' college:'Clemson'\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Execution under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out f.csv \n==4207== Memcheck, a memory error detector\n==4207== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==4207== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==4207== Command: ./a.out f.csv\n==4207== \nid:1 nome:'Kyler' cognome:'Murray' eta:22 ruolo:'QB' team:'Arizona Cardinals' college:'Oklahoma'\nid:2 nome:'Nick' cognome:'Bosa' eta:22 ruolo:'DE' team:'San Francisco' college:'Ohio State'\nid:3 nome:'Quinnen' cognome:'Williams' eta:22 ruolo:'DE' team:'New York Jets' college:'Alabama'\nid:4 nome:'Clelin' cognome:'Ferrell' eta:22 ruolo:'DE' team:'Oakland Raiders' college:'Clemson'\n==4207== \n==4207== HEAP SUMMARY:\n==4207==     in use at exit: 0 bytes in 0 blocks\n==4207==   total heap usage: 23 allocs, 23 frees, 5,637 bytes allocated\n==4207== \n==4207== All heap blocks were freed -- no leaks are possible\n==4207== \n==4207== For counts of detected and suppressed errors, rerun with: -v\n==4207== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>The proposal accepts both comma and semicolon to separate the columns in the csv file, but it supposes there are no space(s) around the names (if a name has spaces around it they are not removed, you have to do that if needed).</p>\n\n<p>If you do not have <em>strdup</em> :</p>\n\n<pre><code>char * strdup(char * s)\n{\n    char * r = malloc(strlen(s) + 1);\n\n    strcpy(r, s);\n    return r;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11704574, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xLcHEmcwnaQ/AAAAAAAAAAI/AAAAAAAABSk/qEBCotJB6_k/photo.jpg?sz=128", "display_name": "Claudio Rizzi", "link": "https://stackoverflow.com/users/11704574/claudio-rizzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56778633, "answer_count": 1, "score": -1, "last_activity_date": 1561580386, "creation_date": 1561571391, "last_edit_date": 1561571484, "question_id": 56778512, "link": "https://stackoverflow.com/questions/56778512/problem-with-a-function-that-insert-the-content-of-a-csv-into-an-array-of-struct", "title": "Problem with a function that insert the content of a csv into an array of struct", "body": "<p>Ok i've a struct that is like this</p>\n\n<pre><code>typedef struct{\n    int id;\n    char nome;\n    char cognome;\n    int eta;\n    char ruolo;\n    squadra team;\n    char college;\n    int td;\n} giocatore;\n</code></pre>\n\n<p>and i've a function that insert the content of a .csv file into an array.\nThe problem is that my fscanf don't return nothing and my array is always empty.</p>\n\n<p>My .csv is structured in this way</p>\n\n<pre><code>1   Kyler   Murray  22  QB  Arizona Cardinals   Oklahoma\n2   Nick    Bosa    22  DE  San Francisco   Ohio State\n3   Quinnen Williams    22  DE  New York Jets   Alabama\n4   Clelin  Ferrell 22  DE  Oakland Raiders Clemson\n</code></pre>\n\n<p>-Declaration of the array</p>\n\n<pre><code>FILE* file_giocatori;\ngiocatore* lista_giocatori[numero_giocatori];\n</code></pre>\n\n<p>-Declaration of the function:</p>\n\n<pre><code>void giocatori_in_array(FILE* f, giocatore array_giocatori[]);\n</code></pre>\n\n<p>-How i call the function:</p>\n\n<pre><code>giocatori_in_array(file_giocatori,*lista_giocatori);\n</code></pre>\n\n<p>-Function:</p>\n\n<pre><code>void giocatori_in_array(FILE* f, giocatore array[numero_squadre]){\n    size_t count = 0;\n    while(fscanf(f, \"%d,%s,%s,%d,%s,%s,%s\\n\", &amp;array[count].id, &amp;array[count].nome, &amp;array[count].cognome, &amp;array[count].eta, &amp;array[count].ruolo, &amp;array[count].team.nome, &amp;array[count].college) == 7)\n    {\n        printf (\"%s %s\", &amp;array[count].nome, &amp;array[count].cognome);\n        count++;\n    }\n}\n</code></pre>\n\n<p>The printf don't show me what i swear, seems like my while is blocked at the first cicle</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 4, "creation_date": 1561568829, "post_id": 56777907, "comment_id": 100110971, "body": "please provide link to the old post. And you cannot use preprocessor in the preprocessor."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561568960, "post_id": 56777907, "comment_id": 100111023, "body": "The <code>##</code> operator is specific to the replacement lists of function-like macros.  You cannot use it (directly) in conditional-inclusion directives."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1561568962, "post_id": 56777907, "comment_id": 100111024, "body": "You still can&#39;t do it - why not ask a question about the failing solution, instead?"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 5, "creation_date": 1561568992, "post_id": 56777907, "comment_id": 100111040, "body": "Is this the question you were referring to? <a href=\"https://stackoverflow.com/questions/34109448/c-ifdef-with-concatenation-of-macros-values\" title=\"c ifdef with concatenation of macros values\">stackoverflow.com/questions/34109448/&hellip;</a>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1561569823, "post_id": 56777907, "comment_id": 100111434, "body": "And can you please explain why the solution in the question linked by @templatetypedef does not work for you?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1561571088, "post_id": 56777907, "comment_id": 100112018, "body": "The solution in the question provided by @templatetypedef might work for you. Please try it."}, {"owner": {"reputation": 51, "user_id": 2902760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f14f604c69725e0220ad7481bcc21a3?s=128&d=identicon&r=PG&f=1", "display_name": "EmbedEngineer", "link": "https://stackoverflow.com/users/2902760/embedengineer"}, "edited": false, "score": 0, "creation_date": 1561618873, "post_id": 56777907, "comment_id": 100125283, "body": "The problem with the solution provided is that I cannot set the <code>base_dll</code> define to 1 because it is given from a configuration file which is out of my hands. Otherwise it would work I guess."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 0, "last_activity_date": 1561569888, "creation_date": 1561569888, "answer_id": 56778166, "question_id": 56777907, "link": "https://stackoverflow.com/questions/56777907/using-ifdef-on-token-pasted-macros/56778166#56778166", "title": "Using #ifdef on token-pasted macros?", "body": "<p>This is not possible. Preprocessor macros only expand once, and only when not in another preprocessor statement. Along with that, concatenations can only be used within a <code>#define</code> statement.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 2902760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f14f604c69725e0220ad7481bcc21a3?s=128&d=identicon&r=PG&f=1", "display_name": "EmbedEngineer", "link": "https://stackoverflow.com/users/2902760/embedengineer"}, "edited": false, "score": 0, "creation_date": 1561619359, "post_id": 56778569, "comment_id": 100125538, "body": "Thanks for the suggestion! Unfortunatly I cannot set the <code>ENABLE_MODULE_1</code> as it is given in a configuration file which I do not have access to. I was therefore looking for a general soluation, so that I do not have to check manually for each ENABLE, but apparently this cannot be done. Many thanks for the effort anyway."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 51, "user_id": 2902760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f14f604c69725e0220ad7481bcc21a3?s=128&d=identicon&r=PG&f=1", "display_name": "EmbedEngineer", "link": "https://stackoverflow.com/users/2902760/embedengineer"}, "edited": false, "score": 0, "creation_date": 1561628334, "post_id": 56778569, "comment_id": 100130523, "body": "@EmbedEngineer I&#39;ve added a variant using <code>defined()</code> that might help you."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 0, "last_activity_date": 1561628403, "last_edit_date": 1561628403, "creation_date": 1561571707, "answer_id": 56778569, "question_id": 56777907, "link": "https://stackoverflow.com/questions/56777907/using-ifdef-on-token-pasted-macros/56778569#56778569", "title": "Using #ifdef on token-pasted macros?", "body": "<p>You cannot do precisely what you want because <code>#ifdef</code> operates on an identifier, not a preprocessor expression, and the <code>##</code> operator can only be used in the replacement text of a macro definition.</p>\n\n<p>If you are willing to define <code>ENABLE_MODULE_1</code> (if defined at all) with a non-zero constant as its replacement text, you can achieve something similar to what you want as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define XENABLED(x)         ENABLE_ ## x\n#define ENABLED(x)          XENABLED(x)\n\n#define XSTR(x)             #x\n#define STR(x)              XSTR(x)\n\n#define ENABLE_MODULE_1     1   /* enabled */\n#define ENABLE_MODULE_3     0   /* not enabled */\n\n#define MODULE              MODULE_1\n#define OTHER               MODULE_2\n#define ANOTHER             MODULE_3\n\nint main(void)\n{\n#if ENABLED(MODULE)\n    printf(\"%s enabled\\n\", STR(MODULE));\n#else\n    printf(\"%s not enabled\\n\", STR(MODULE));\n#endif\n#if ENABLED(OTHER)\n    printf(\"%s enabled\\n\", STR(OTHER));\n#else\n    printf(\"%s not enabled\\n\", STR(OTHER));\n#endif\n#if ENABLED(ANOTHER)\n    printf(\"%s enabled\\n\", STR(ANOTHER));\n#else\n    printf(\"%s not enabled\\n\", STR(ANOTHER));\n#endif\n#if ENABLED(UNDEFINED)\n    printf(\"%s enabled\\n\", STR(UNDEFINED));\n#else\n    printf(\"%s not enabled\\n\", STR(UNDEFINED));\n#endif\n    return 0;\n}\n</code></pre>\n\n<p>The above program produces the following output:</p>\n\n<pre><code>MODULE_1 enabled\nMODULE_2 not enabled\nMODULE_3 not enabled\nUNDEFINED not enabled\n</code></pre>\n\n<p><strong>UPDATE 1</strong></p>\n\n<p>Here is another variant using <code>defined()</code> that does not require <code>ENABLE_MODULE_1</code>, <code>ENABLE_MODULE_2</code>, etc. to expand to anything (if they are defined at all). It just checks tests whether they are defined.</p>\n\n<p>The test can be indirect:</p>\n\n<pre><code>#define MODULE MODULE_1\n\n#if ENABLED(MODULE)\n</code></pre>\n\n<p>or direct:</p>\n\n<pre><code>#if ENABLED(MODULE_1)\n</code></pre>\n\n<p>Here is the variant:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define XENABLED(x)         defined(ENABLE_ ## x)\n#define ENABLED(x)          XENABLED(x)\n\n#define XSTR(x)             #x\n#define STR(x)              XSTR(x)\n\n#define ENABLE_MODULE_1\n\n#define MODULE              MODULE_1\n#define OTHER               MODULE_2\n\nint main(void)\n{\n    printf(\"Indirect tests...\\n\");\n#if ENABLED(MODULE)\n    printf(\"%s enabled\\n\", STR(MODULE));\n#else\n    printf(\"%s not enabled\\n\", STR(MODULE));\n#endif\n#if ENABLED(OTHER)\n    printf(\"%s enabled\\n\", STR(OTHER));\n#else\n    printf(\"%s not enabled\\n\", STR(OTHER));\n#endif\n#if ENABLED(UNDEFINED)\n    printf(\"%s enabled\\n\", STR(UNDEFINED));\n#else\n    printf(\"%s not enabled\\n\", STR(UNDEFINED));\n#endif\n    printf(\"Direct tests...\\n\");\n#if ENABLED(MODULE_1)\n    printf(\"%s enabled\\n\", STR(MODULE_1));\n#else\n    printf(\"%s not enabled\\n\", STR(MODULE_1));\n#endif\n#if ENABLED(MODULE_2)\n    printf(\"%s enabled\\n\", STR(MODULE_2));\n#else\n    printf(\"%s not enabled\\n\", STR(MODULE_2));\n#endif\n    return 0;\n}\n</code></pre>\n\n<p>Output from above variant:</p>\n\n<pre><code>Indirect tests...\nMODULE_1 enabled\nMODULE_2 not enabled\nUNDEFINED not enabled\nDirect tests...\nMODULE_1 enabled\nMODULE_2 not enabled\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2902760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f14f604c69725e0220ad7481bcc21a3?s=128&d=identicon&r=PG&f=1", "display_name": "EmbedEngineer", "link": "https://stackoverflow.com/users/2902760/embedengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1561628403, "creation_date": 1561568775, "last_edit_date": 1561619549, "question_id": 56777907, "link": "https://stackoverflow.com/questions/56777907/using-ifdef-on-token-pasted-macros", "title": "Using #ifdef on token-pasted macros?", "body": "<p>I know there is already a similar post to mine (<a href=\"https://stackoverflow.com/questions/34109448/c-ifdef-with-concatenation-of-macros-values\">C++ `ifdef` with concatenation of macros values</a>) but the post is pretty old and the solution provided does not work for me, because I cannot set the define I want to check. So I hope someone can help me.</p>\n\n<p>The problem is that I want to make an ifdef of a concatenation of two a define with a fixed text.</p>\n\n<p>Imagine the following code</p>\n\n<pre><code>#define ENABLE_MODULE_1\n\nenum Modultype\n{\n    MODULE_1,\n    MODULE_2\n};\n\n#define MODULE MODULE_1\n\n\nint main()\n{\n    #ifdef ENABLE_ ## MODULE\n    printf(\"NAME defined\");\n    #else\n    printf(\"NAME not defined\");\n    #endif\n    return 0;\n}\n</code></pre>\n\n<p>So I basically want to check if <code>ENABLE_MODULE_1</code> is defined based on the <code>MODULE</code> define.</p>\n\n<p>I hope someone can help me. Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 8, "creation_date": 1561568570, "post_id": 56777778, "comment_id": 100110859, "body": "<code>yazar_liste[n]-&gt; ;</code> is not valid syntax, the arrow needs something after it. Or the arrow needs to be removed, it doesn&#39;t make sense here. But then I don&#39;t understand what your code is trying to do there at all. Start much smaller, make a simpler bit of code with a lot less data and make that work."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1561568924, "post_id": 56777778, "comment_id": 100111007, "body": "<code>gecici1 = yazar_liste[n]-&gt;;</code> The variable <code>gecici1</code> is a structure, and <code>yazar_liste[n]</code> is a <code>char</code>. The <code>-&gt;</code> after <code>yazar_list[n]</code> is not valid, since <code>yazar_list[n]</code> is not a struct. Beyond that, it&#39;s not clear what you&#39;re trying to do on that line."}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561569244, "post_id": 56777778, "comment_id": 100111152, "body": "I assumed that arrays is a kind of pointer and if I write sth like that \u0131 could reach the &#39;kitap_ozellikleri a&#39; struct. I learned \u0131 couldnt but how can \u0131 access to properties of &#39;a&#39; ."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1561569343, "post_id": 56777778, "comment_id": 100111200, "body": "Aside: the <code>struct</code> initialisation can be simpler with <code>kitap_ozellikleri a = { &#39;a&#39;, 50, 30, 280, &#39;e&#39; };</code> and so on, then the function <code>ozellik_tanimla()</code> can be removed."}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561569544, "post_id": 56777778, "comment_id": 100111290, "body": "@Weather Vane, Thanks \u0131 will consider this."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561569762, "post_id": 56777778, "comment_id": 100111396, "body": "Arrays are <b><i>not</i></b> pointers, though in most contexts they are <i>converted to</i> pointers when evaluated.  But even if they were, the <code>-&gt;</code> is specific to accessing <i>members</i> of structures through pointers <i>to structures</i>.  To get an array element, you can just use the array indexing operator as you already do: <code>yazar_liste[n]</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1561570049, "post_id": 56777778, "comment_id": 100111545, "body": "<code>sayfa</code> translates to &quot;page&quot; in English. Is that the number of pages in a book? Are you trying to find the total number of pages written by each author?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1561570373, "post_id": 56777778, "comment_id": 100111680, "body": "By the way: You should get used to adopt English only identifiers. While in given case, it&#39;s rather matter of syntax and thus not that relevant, you&#39;ll certainly have to share code with other people not aware of your mother tongue in the future, too \u2013 and be it only here on SO. However, not understanding the intention of a variable or function makes it much harder, if not impossible, to help you..."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1561570447, "post_id": 56777778, "comment_id": 100111722, "body": "@Aconcagua Try inputting the codebase into Google Translate. It&#39;s in Turkish."}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561570586, "post_id": 56777778, "comment_id": 100111793, "body": "I know but \u0131 dont know english well"}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561570723, "post_id": 56777778, "comment_id": 100111858, "body": "@ user3386109 yes \u0131 m trying to find total number of pages written by author"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561570844, "post_id": 56777778, "comment_id": 100111908, "body": "@JL2210 And you&#39;d want to do that on every bit of piece of code you receive from some colleague?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1561570952, "post_id": 56777778, "comment_id": 100111955, "body": "@Aconcagua Not really, but for now it works."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1561570960, "post_id": 56777778, "comment_id": 100111963, "body": "@O\u011fuzhanyusufAslanalp Don&#39;t see it as criticism, see it as recommendation. It will help you if you need to cooperate with others, and for writing code, you only need a very basic English level, at least if not considering good commentation..."}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561571074, "post_id": 56777778, "comment_id": 100112010, "body": "I &#39;d want to learn the cause of this error and try to learn the C language."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1561571229, "post_id": 56777778, "comment_id": 100112075, "body": "Well, cause of error is the accessor <code>-&gt;</code>. It is there to access a member of some struct. <code>x-&gt;y</code> actually is just syntactic sugar, short hand for <code>(*x).y</code>. Similarly, the index operator is just syntactic sugar as well, <code>x[y]</code> is short for <code>*(x + y)</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561571358, "post_id": 56777778, "comment_id": 100112112, "body": "The definition <code>kitap_ozellikleri gecici1</code> is local to that <code>if</code> code block, and goes out of scope before you have even used it for anything. Suppose you define <code>kitap_ozellikleri gecici1;</code> further out - at the scope where you want to use what you set its members to, then the error line can be <code>gecici1.ism = yazar_liste[n];</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561569293, "post_id": 56777923, "comment_id": 100111171, "body": "@P__J__ See update. I&#39;m not sure what this does, so I can&#39;t be sure if it works, but it compiles now."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561569522, "post_id": 56777923, "comment_id": 100111281, "body": "@O\u011fuzhanyusufAslanalp What&#39;s &quot;sth&quot;?"}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561569689, "post_id": 56777923, "comment_id": 100111361, "body": "I dont know english well but my teachers always use &#39;sth&#39; instead of something"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561569737, "post_id": 56777923, "comment_id": 100111388, "body": "@O\u011fuzhanyusufAslanalp Oh. Well, see my updated answer. You need to remove those because the <code>yazar_liste</code> is not a pointer to a structure."}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561569880, "post_id": 56777923, "comment_id": 100111456, "body": "My aim is to find the books which has the same writer. &quot;yazar&quot; means writer and \u0131 give letters to writers."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 1, "creation_date": 1561569931, "post_id": 56777923, "comment_id": 100111480, "body": "@O\u011fuzhanyusufAslanalp, for future information, &quot;sth&quot; is not used as an abbreviation for &quot;something&quot; by native English speakers."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561569975, "post_id": 56777923, "comment_id": 100111501, "body": "@JohnBollinger See <a href=\"https://english.stackexchange.com/questions/19841/what-is-meant-by-sth\" title=\"what is meant by sth\">english.stackexchange.com/questions/19841/what-is-meant-by-s&zwnj;&#8203;th</a>. Also see the second comment on the accepted answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1561570138, "post_id": 56777923, "comment_id": 100111588, "body": "Absolutely true, @JL2210, as I can confidently assert as a native and longtime English speaker and prolific reader and writer.  Use <i>in dictionaries</i>, to the extent that it occurs, is not the same as use by native speakers, and especially not the same as use in ordinary writing."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561570351, "post_id": 56777923, "comment_id": 100111671, "body": "This code makes much more sense when I plug it into Google Translate."}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 1, "creation_date": 1561570848, "post_id": 56777923, "comment_id": 100111913, "body": ":) I was proficiency student this year. I learnt a lot about engliah but I realised that \u0131 dont know anything."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1561569696, "last_edit_date": 1561569696, "creation_date": 1561568865, "answer_id": 56777923, "question_id": 56777778, "link": "https://stackoverflow.com/questions/56777778/how-to-fix-expected-identifier-before-token-error/56777923#56777923", "title": "how to fix expected identifier before &#39;;&#39; token error", "body": "<p>These two lines are invalid:</p>\n\n<pre><code>kitap_ozellikleri gecici1 = yazar_liste[n]-&gt; ;\nkitap_ozellikleri gecici2 =  yazar_liste[z]-&gt;;\n</code></pre>\n\n<p>Just remove the <code>-&gt;</code>s. These are invalid because <code>yazar_liste</code> is not a pointer to a structure.</p>\n\n<p>If you want this to compile (it may or may not work), change your <code>main</code> function to be like this:</p>\n\n<pre><code>int main(){\n    ozellik_tanimla();  \n    char liste[6] = {'a','c','y','e','t','k'};\n    char yazar_liste[6] = {'e','g','k','r','o','o'};\n    int n = 0;\n    for(n=0;n&lt;6;n++){\n        int z = 0;\n        for(z=0;z&lt;6;z++){\n            if(yazar_liste[n]==yazar_liste[z]){\n                kitap_ozellikleri gecici1 = { .yazar = yazar_liste[n] };\n                kitap_ozellikleri gecici2 = { .yazar = yazar_liste[z] };\n                gecici1.sayfa += gecici2.sayfa;\n            }\n        }\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561571707, "post_id": 56778545, "comment_id": 100112259, "body": "Nice answer, I suggest initialisation with <code>kitap_ozellikleri gecici1 = { 0 };</code> so that <code>gecici1.sayfa</code> can accumulate the pages."}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561572029, "post_id": 56778545, "comment_id": 100112406, "body": "Yes \u0131 see, you create a list of struct"}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561572274, "post_id": 56778545, "comment_id": 100112497, "body": "@ Weather Vane why do you initialize it?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561573266, "post_id": 56778545, "comment_id": 100112935, "body": "For the same reason that the answer initialises <code>tot = 0;</code> Local variables are not automatically initialised, and I was referring to the first version with <code>gecici1.sayfa += liste[z].sayfa;</code> where <code>gecici1.sayfa</code> was never set to <code>0</code>."}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561573466, "post_id": 56778545, "comment_id": 100113046, "body": "@WeatherVane : agreed, 100%;  I would have added the initialization of <code>gecici1</code>, but I decided to incorporate your other suggestion about printing out the per-author totals along the way, and edited my answer to distinguish <i>print-as-you-go</i> from <i>store-for-later-use</i>;  you provided very useful comments!"}, {"owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561573665, "post_id": 56778545, "comment_id": 100113124, "body": "Thanks everyone for their answers:)"}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561573868, "post_id": 56778545, "comment_id": 100113214, "body": "@O\u011fuzhanyusufAslanalp : our pleasure; we are here to help the global community of developers;  please consider &#39;accepting&#39; one of the answers, to indicate that it solved your problem and/or was particularly helpful to your understanding of the problem; thanks"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "edited": false, "score": 0, "creation_date": 1561573934, "post_id": 56778545, "comment_id": 100113253, "body": "@O\u011fuzhanyusufAslanalp as a welcome new contributor you might benefit by reading the <a href=\"https://stackoverflow.com/tour\">tour</a> and other <a href=\"https://stackoverflow.com/help\">help topics</a>, also the <a href=\"https://stackoverflow.com/questions/tagged/c?sort=frequent&amp;pageSize=15\">Stackoverflow FAQ coding questions</a>."}], "tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": true, "score": 2, "last_activity_date": 1561573569, "last_edit_date": 1561573569, "creation_date": 1561571582, "answer_id": 56778545, "question_id": 56777778, "link": "https://stackoverflow.com/questions/56777778/how-to-fix-expected-identifier-before-token-error/56778545#56778545", "title": "how to fix expected identifier before &#39;;&#39; token error", "body": "<p>Welcome to Stack Overflow.</p>\n\n<p>I think I can discern your intent from the comments on the question and the other answer, and I believe what you want for your core loop is something more like this:</p>\n\n<pre><code>kitap_ozellikleri gecici1;\nkitap_ozellikleri liste[6] = {a, c, y, e, t, k};  // no 'quotes'\nchar yazar_liste[6] = {'e', 'g', 'k', 'r', 'o', 'o'};\nfor(n=0; n&lt;6; n++) {\n    for(z=0; z&lt;6; z++) {\n        if(yazar_liste[n] == liste[z].yazar){\n            gecici1.sayfa += liste[z].sayfa;\n        }\n    }\n}\n</code></pre>\n\n<p>Do you see why I changed <code>liste</code> to a <code>kitap_ozellikleri[]</code> and removed the <code>''</code> quotes around the members of that array?</p>\n\n<p>This compiles (after adding overhead like <code>int n, z;</code>), but as-written, this counts the total number of pages written by all the authors listed in <code>yazar_liste[]</code>.  But, it also double-counts the author \"o\", because that author is listed twice in <code>yazar_liste[]</code>.</p>\n\n<p>Here is a full version, incorporating suggestions from various comments, which <em>prints out</em> counts per author:</p>\n\n<p><strong>code</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct{\n    char isim;\n    int adet;\n    int odunc_alinma_sayisi;\n    int sayfa;\n    char yazar;\n}kitap_ozellikleri;\n\nkitap_ozellikleri a = { 'a', 50, 30,  280, 'e' };\nkitap_ozellikleri c = { 'c', 82, 88,  150, 'g' };\nkitap_ozellikleri y = { 'y', 99, 123, 119, 'k' };\nkitap_ozellikleri e = { 'e', 53, 33,  268, 'r' };\nkitap_ozellikleri t = { 't', 24, 42,  159, 'o' };\nkitap_ozellikleri k = { 'k', 55, 110, 296, 'o' };\n\nint main(){\n    int n, z, tot;\n\n    kitap_ozellikleri liste[6] = {a, c, y, e, t, k};  // no 'quotes'\n    char yazar_liste[6] = {'e', 'g', 'k', 'r', 'o'};\n    for(n=0; n&lt;5; n++) {\n        tot = 0;\n        for(z=0; z&lt;6; z++) {\n            if(yazar_liste[n] == liste[z].yazar){\n                tot += liste[z].sayfa;\n            }\n        }\n        printf(\"total pages for sayfa %c is : %d\\n\", yazar_liste[n], tot);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>output</strong></p>\n\n<pre><code>total pages for sayfa e is : 280\ntotal pages for sayfa g is : 150\ntotal pages for sayfa k is : 119\ntotal pages for sayfa r is : 268\ntotal pages for sayfa o is : 455\n</code></pre>\n\n<p>To instead <em>store</em> per-author counts (e.g., for use later on in the program), you would need to introduce a way of tracking several counters.  I will leave that as an exercise for you; but of course if you have questions after trying it, feel free to post another, separate SO question, detailing what you've tried, your results, and your expected results.</p>\n"}], "owner": {"reputation": 3, "user_id": 11704416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mV03bvQrGj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeD8cqSSCSOfYXFqUgZfOFNWTAHA/photo.jpg?sz=128", "display_name": "O\u011fuzhan yusuf Aslanalp", "link": "https://stackoverflow.com/users/11704416/o%c4%9fuzhan-yusuf-aslanalp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56778545, "answer_count": 2, "score": 0, "last_activity_date": 1561573569, "creation_date": 1561568287, "question_id": 56777778, "link": "https://stackoverflow.com/questions/56777778/how-to-fix-expected-identifier-before-token-error", "title": "how to fix expected identifier before &#39;;&#39; token error", "body": "<p>\u0131 am beginner programmer. I want to create a small database and choose from them for some requirements. It contains lots of definition of something so it looks long but it is not. I think like there are objects and we add thins to it and then compare the properties. Is C suitable for this task.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct{\n    char isim;\n    int adet;\n    int odunc_alinma_sayisi;\n    int sayfa;\n    char yazar;\n}kitap_ozellikleri;\n\nkitap_ozellikleri a;\nkitap_ozellikleri c;\nkitap_ozellikleri y;\nkitap_ozellikleri e;\nkitap_ozellikleri t;\nkitap_ozellikleri k;\n\n/*int range(int maks){\n    if(maks==1) {\n        return 1;\n    }\n    int sayilar[maks];\n    sayilar[maks-1] = maks;\n    sayilar[maks-2] = range(maks-1); \n    return sayilar[];\n}\n*/\n    void ozellik_tanimla(){\n        a.adet = 50;\n        a.isim = 'a';\n        a.odunc_alinma_sayisi = 30;\n        a.sayfa = 280;\n        a.yazar = 'e';\n\n        c.adet = 82;\n        c.isim = 'c';\n        c.odunc_alinma_sayisi = 88;\n        c.sayfa = 150;\n        c.yazar = 'g';\n\n        y.adet = 99;\n        y.isim = 'y';\n        y.odunc_alinma_sayisi = 123;\n        y.sayfa = 119;\n        y.yazar = 'k';\n\n        e.adet = 53;\n        e.isim = 'e';\n        e.odunc_alinma_sayisi = 33;\n        e.sayfa = 268;\n        e.yazar = 'r';\n\n        t.adet = 24;\n        t.isim = 't';\n        t.odunc_alinma_sayisi = 42;\n        t.sayfa = 159;\n        t.yazar = 'o';\n\n        k.adet = 55;\n        k.isim = 'k';\n        k.odunc_alinma_sayisi = 110;\n        k.sayfa = 296;\n        k.yazar = 'o';\n    }\n\n\n    int main(){\n        ozellik_tanimla();  \n        char liste[6] = {'a','c','y','e','t','k'};\n        char yazar_liste[6] = {'e','g','k','r','o','o'};\n        int n = 0;\n        for(n=0;n&lt;6;n++){\n            int z = 0;\n            for(z=0;z&lt;6;z++){\n                if(yazar_liste[n]==yazar_liste[z]){\n                    kitap_ozellikleri gecici1 = yazar_liste[n]-&gt; ;\n                    kitap_ozellikleri gecici2 =  yazar_liste[z]-&gt;;\n                    gecici1.sayfa += gecici2.sayfa;\n                }\n            }\n        }\n\nreturn 0;\n    }\n</code></pre>\n\n<p>I want to learn what is this error and why it occurs?</p>\n"}, {"tags": ["c", "unit-testing", "gcc", "esp32", "xtensa"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561569343, "post_id": 56777733, "comment_id": 100111201, "body": "Esp3e toolchain is gcc based.  So what is the problem?"}, {"owner": {"reputation": 61, "user_id": 9754170, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z0RI_7o-GkQ/AAAAAAAAAAI/AAAAAAAAAO0/FrQS8o5PEgQ/photo.jpg?sz=128", "display_name": "William Walter", "link": "https://stackoverflow.com/users/9754170/william-walter"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561571416, "post_id": 56777733, "comment_id": 100112149, "body": "@P__J__ That might not be the problem, I just want to be able to run the code off the esp32 chip."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561571810, "post_id": 56777733, "comment_id": 100112312, "body": "Esp code cannot be run out the esp chip. Any magic?"}, {"owner": {"reputation": 61, "user_id": 9754170, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z0RI_7o-GkQ/AAAAAAAAAAI/AAAAAAAAAO0/FrQS8o5PEgQ/photo.jpg?sz=128", "display_name": "William Walter", "link": "https://stackoverflow.com/users/9754170/william-walter"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561572492, "post_id": 56777733, "comment_id": 100112590, "body": "Why can it not be run if you&#39;re mocking the esp dependencies? It should be no different from regular C code then, no?"}], "owner": {"reputation": 61, "user_id": 9754170, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z0RI_7o-GkQ/AAAAAAAAAAI/AAAAAAAAAO0/FrQS8o5PEgQ/photo.jpg?sz=128", "display_name": "William Walter", "link": "https://stackoverflow.com/users/9754170/william-walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565772596, "creation_date": 1561568168, "last_edit_date": 1565772596, "question_id": 56777733, "link": "https://stackoverflow.com/questions/56777733/building-esp32-code-using-a-different-toolchain-gcc-rather-than-xtensa", "title": "Building ESP32 code using a different toolchain (GCC rather than Xtensa)", "body": "<p>I would like to build code meant for ESP32 outside of the hardware for unit testing purposes. ESP32 uses Xtensa as its toolchain but I would prefer GCC. I've never done anything with compilers/linkers so I'm new to this. I plan on mocking any esp32 dependencies using fff.</p>\n\n<p>I'm not exactly sure where to start on this so any advice is appreciated. </p>\n\n<p><a href=\"https://github.com/espressif/esp-idf/blob/master/make/project.mk\" rel=\"nofollow noreferrer\">Here's a link</a> to the makefile that the esp-idf uses to build code</p>\n"}, {"tags": ["c", "time", "delay", "stm32"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561566773, "post_id": 56777367, "comment_id": 100110117, "body": "systick interrupt. <code>clock()</code> is a standard library function. Most probably you use <code>gcc</code> with` newlib` with <code>nosys.specs</code> which just implements <code>clock</code> as retunrning -1. Also <code>clock()</code> returns <code>clock_t</code>, which may not be <code>uint32_t</code>, rather what you want."}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561566912, "post_id": 56777367, "comment_id": 100110182, "body": "@Kamil Cuk Is it something related to TIMERS?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561567176, "post_id": 56777367, "comment_id": 100110284, "body": "The <a href=\"https://www.st.com/content/ccc/resource/technical/document/reference_manual/3d/6d/5a/66/b4/99/40/d4/DM00031020.pdf/files/DM00031020.pdf/jcr:content/translations/en.DM00031020.pdf\" rel=\"nofollow noreferrer\">datashett</a> rather specifically mentions &quot;SysTick&quot;, not a timer, it&#39;s a separate interrupt. Usually people use  <a href=\"https://www.st.com/content/ccc/resource/technical/document/user_manual/2f/71/ba/b8/75/54/47/cf/DM00105879.pdf/files/DM00105879.pdf/jcr:content/translations/en.DM00105879.pdf\" rel=\"nofollow noreferrer\">hal functions</a> with the implementation. Are you aiming to touch registers yourself or use some HAL layer?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561567359, "post_id": 56777367, "comment_id": 100110353, "body": "If you happen to use <code>newlib</code> with <code>nosys</code>, then <a href=\"https://github.com/littlekernel/newlib/blob/master/newlib/libc/time/clock.c\" rel=\"nofollow noreferrer\">clock()</a> just calls <a href=\"https://github.com/littlekernel/newlib/blob/master/libgloss/libnosys/times.c\" rel=\"nofollow noreferrer\">_times_r()</a> that just returns -1 and sets errno=ENOSYS. On embedded platforms you have to implement the system yourself (or use some implementation). With <code>newlib</code> you can add <code>machine&#47;_types.h</code> file with your implementation of <code>clock_t</code> and compile with your own implementation of  <code>clock_t clock(void) { return HAL_GetTick(); }</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1561569211, "post_id": 56777367, "comment_id": 100111135, "body": "Peripheral clocks (those driving timers and other peripheral hardware) are very often much slower than CPU clocks. It does not surprise me that you get the same time several times. Be patient, it might only change once a second. Write a loop polling until change and make some kind of output. You might see a 1Hz pattern."}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561571843, "post_id": 56777367, "comment_id": 100112329, "body": "@Kamil Cuk I don&#39;t have to use clock(), what does HAL_GetTick() itself return? Can i use it to achieve what I want? For example, ------ uint32_t start = HAL_GetTick(); while(HAL_GetTick() - start &lt; 100 ) {} ------- How much time does this while loop delay the system? I am not with the board now so i can&#39;t try myself, sorry for that."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561572374, "post_id": 56777367, "comment_id": 100112543, "body": "Usually systick is configured as a 1ms. The counter is incremented in the interrupt. It&#39;s <a href=\"https://github.com/nodtem66/STM32F411RE/blob/master/system/src/stm32f4-hal/stm32f4xx_hal.c#L304\" rel=\"nofollow noreferrer\">plain simple</a>. The <code>HAL_IncTick()</code> is called from <a href=\"https://github.com/fboris/STM32Cube_FW_F4/blob/master/Projects/STM32F4-Discovery/Examples/UART/UART_TwoBoards_ComDMA/Src/stm32f4xx_it.c#L158\" rel=\"nofollow noreferrer\">systick interrupt</a>. If you start your way with embedded programing, start with something that will help you, ex. <a href=\"https://www.st.com/en/development-tools/stm32cubemx.html\" rel=\"nofollow noreferrer\">STM32cubemx</a>"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1561572448, "post_id": 56777367, "comment_id": 100112571, "body": "@muyustan maybe some googling would help.... <a href=\"http://embeddedsystemengineering.blogspot.com/2015/04/stm32f4-discovery-tutorial-4-make-delay.html\" rel=\"nofollow noreferrer\">embeddedsystemengineering.blogspot.com/2015/04/&hellip;</a>"}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561572640, "post_id": 56777367, "comment_id": 100112654, "body": "@Kamil Cuk thanks for all"}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1561572665, "post_id": 56777367, "comment_id": 100112667, "body": "@bigwillydos I actually searched a lot but didn&#39;t see that one, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561613213, "post_id": 56780317, "comment_id": 100123016, "body": "Hey, thanks for your answer. I used <code>HAL_GetTick()</code> and achieved a ms precision time calculation based on the comments above. What I don&#39;t understand clearly with your answer is : What does 1kHz freq interrupt mean exactly? Is it based on time or clock cycles ? <code>1000 increment &#47; 1 seconds</code> or <code>1 increment per 1000 clock cycles</code> ? It looks like it is the former one, right ?"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561614880, "post_id": 56780317, "comment_id": 100123561, "body": "Right. 1 <a href=\"https://en.wikipedia.org/wiki/Hertz\" rel=\"nofollow noreferrer\">kHz</a> means that something happens 1000 times / second. If the system clock is 168 MHz (168 million cycles/sec), then SysTick should be configured to trigger an interrupt in every 168000 cycles."}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561627423, "post_id": 56780317, "comment_id": 100129960, "body": "hey, thanks for the answer. I am near to crying, I am reading documentation of systick hal functions for hours, please tell me one reason why <code>HAL_SetTickFreq(100);</code> does not cause the system to enter <code>SysTick_Handler</code> at each 100 miliseconds instead of each miliseconds ? I am writing <code>HAL_SetTickFreq(100);</code>  before while(1) loop and never set it back to 1 again, I wrote in <code>SysTick_Handler</code> that XOR an LED but I cannot observe the blinking it is just ON. <code>void SysTick_Handler(void) {   HAL_IncTick();   GPIOD-&gt;ODR ^= LED4_Pin ; }</code>"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561639507, "post_id": 56780317, "comment_id": 100136948, "body": "You won&#39;t get anywhere with HAL and its so-called documentation. Forget it <i>now</i>, or it&#39;d become much worse later. If you drop HAL, SysTick becomes easy: <code>SysTick-&gt;LOAD = 16799999;SysTick-&gt;CTRL = SysTick_CTRL_CLKSOURCE_Msk | SysTick_CTRL_TICKINT_Msk | SysTick_CTRL_ENABLE_Msk;</code> and the interrupt comes 10 times / sec (load value = system clock / desired freq - 1). Full documentation of SysTick is in the Programming Manual, other timers are in the Reference Manual, <a href=\"https://www.st.com/en/microcontrollers-microprocessors/stm32f407-417.html#resource\" rel=\"nofollow noreferrer\">both available from ST</a>"}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561641146, "post_id": 56780317, "comment_id": 100138042, "body": "thanks, i will try it now, I also want to learn things from basics but I don&#39;t know actually how to proceed, if you have time later, can you post a comment about how can i proceed ?"}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561642618, "post_id": 56780317, "comment_id": 100139062, "body": "I could not achieve, same again Interrupt does not happen at each 100ms"}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 1, "creation_date": 1561643744, "post_id": 56780317, "comment_id": 100139822, "body": "<code>SysTick-&gt;LOAD = 168000000 &#47; 10 - 1 ;</code> I realized by debugging that after executing this line LOAD value becomes <code>22783</code> instead of what it should be <code>167999999</code>. I checked it is <code>uint32_t</code>, so I could not understand why such a thing happens. Edit : I now am sure that it is something about this overflowish thing because both ways HAL and direct register coding, I cannot get 10Hz freq , while 1kHz and 100Hz are achievable."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561643997, "post_id": 56780317, "comment_id": 100139974, "body": "Oops, it&#39;s just over the 24 bit limit (see the programming manual). So it won&#39;t work direcly winth SysTick. You can set it to 2^24 - 1 just to see if that works, then move on to the real timers in the reference manual."}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561646525, "post_id": 56780317, "comment_id": 100141559, "body": "it is like a huge joke, all it was about that size issue, and 2^24 -1 differed desired frequency from 10 to only 10.0136. It is crazy. Thanks again."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": true, "score": 0, "last_activity_date": 1561580483, "creation_date": 1561580483, "answer_id": 56780317, "question_id": 56777367, "link": "https://stackoverflow.com/questions/56777367/how-to-write-a-time-difference-function-to-stm32f4/56780317#56780317", "title": "How to write a time difference function to STM32F4", "body": "<p>The answer depends on the required precision and intervals.</p>\n\n<p>For shorter intervals with sub-microsecond precision there is a <a href=\"https://stackoverflow.com/questions/42246125/how-to-get-time-intervals-on-stm32/42246704#42246704\">cycle counter</a>. Your suspicion is correct, it would overflow after 2<sup>32</sup>/168*10<sup>6</sup> ~ 25.5 seconds.</p>\n\n<p>For longer intervals there are timers that can be <em>prescaled</em> to support any possible subdivision of the 168 MHz clock. The most commonly used setup is the SysTick timer set to generate an interrupt at 1 kHz frequency, which increments a software counter. Reading this counter would give the number of milliseconds elapsed since startup. As it is usually a 32 bit counter, it would overflow after 49.7 days. The HAL library sets SysTick up this way, the counter can then be queried using the <code>HAL_GetTick()</code> function.</p>\n\n<p>For even longer or more specialized timing requirements you can use the <code>RTC</code> peripheral which keeps calendar time, or the <code>TIM</code> peripherals (basic, general and advanced timers), these have their own prescalers, and they can be arranged in a master-slave setup to give almost arbitrary precision and intervals.</p>\n"}], "owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1325, "favorite_count": 0, "accepted_answer_id": 56780317, "answer_count": 1, "score": 1, "last_activity_date": 1561695235, "creation_date": 1561566637, "last_edit_date": 1561695235, "question_id": 56777367, "link": "https://stackoverflow.com/questions/56777367/how-to-write-a-time-difference-function-to-stm32f4", "title": "How to write a time difference function to STM32F4", "body": "<p>i am working on STM32F4 and pretty new at it. I know basics of C but with more than 1 day research, i still not found a solution of this.</p>\n\n<p>I simply want to make a delay function myself, processor runs at 168MHz ( HCLK ). So my intuition says that it produces 168x10^6 clock cycles at each seconds. So the method should be something like that,</p>\n\n<p>1-Store current clock count to a variable</p>\n\n<p>2-Time diff = (  clock value at any time -  stored starting clock value ) / 168000000</p>\n\n<p>This flow should give me time difference in terms of seconds and then i can use it to convert whatever i want.</p>\n\n<p>But, unfortunately, despite it seems so easy, I just cant implement any methods to MCU. </p>\n\n<p>I tried time.h but it did not work properly. For ex, clock() gave same result over and over, and time( the one returns seconds since 1970 ) gave hexadecimal 0xFFFFFFFF ( -1, I guess means error ) .</p>\n\n<p>Thanks.</p>\n\n<p>Edit : While writing i assumed that some func like clock() will return total clock count since the start of program flow, but now i think after 4Billion/168Million secs it will overflow uint32_t size. I am really confused.</p>\n"}, {"tags": ["c", "linux", "docker", "software-design"], "comments": [{"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 1, "creation_date": 1561566762, "post_id": 56777290, "comment_id": 100110106, "body": "How about the REST API ?"}, {"owner": {"reputation": 9, "user_id": 11703406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1f4dd299c228bb2bd896edfcab0bb3d?s=128&d=identicon&r=PG&f=1", "display_name": "c0der", "link": "https://stackoverflow.com/users/11703406/c0der"}, "edited": false, "score": 0, "creation_date": 1561569474, "post_id": 56777290, "comment_id": 100111261, "body": "Thanks for the insight. I updated the question regarding REST API and elaborated with more details. I did find this <a href=\"https://github.com/danielsuo/libdocker\" rel=\"nofollow noreferrer\">github.com/danielsuo/libdocker</a> , but it doesn&#39;t seem to be actively maintained anymore."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1561569558, "post_id": 56777290, "comment_id": 100111302, "body": "This looks a lot like a &quot;help me find a library&#39; question."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1561570281, "post_id": 56777290, "comment_id": 100111645, "body": "@c0der Make sure if a daemon process in golang is really what you want to maintain over a C self contained process. If Docker API changes because you moved to newer version you will have to maintain both source codes."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1561570356, "post_id": 56777290, "comment_id": 100111673, "body": "Not to mention that setup will be harder and you will need to establish some protocol for communication between processes."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1561570427, "post_id": 56777290, "comment_id": 100111716, "body": "I would go for using libcurl for communication with docker daemon over REST API."}], "owner": {"reputation": 9, "user_id": 11703406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1f4dd299c228bb2bd896edfcab0bb3d?s=128&d=identicon&r=PG&f=1", "display_name": "c0der", "link": "https://stackoverflow.com/users/11703406/c0der"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1561571966, "creation_date": 1561566337, "last_edit_date": 1561571966, "question_id": 56777290, "link": "https://stackoverflow.com/questions/56777290/how-to-interface-with-docker-engine-from-c-program", "title": "How to interface with Docker Engine from C program?", "body": "<p>I need to handle running/managing Docker containers from a daemon written in C. But, SDK provided by Docker is available for Go &amp; Python only.</p>\n\n<p>Currently, i'm handling this by calling docker commands using 'system' function provided by glibc. But this is just a workaround and isn't a clean solution as compared to using APIs. </p>\n\n<p>Are there any opensource C bindings available for Docker SDK (or) are there any C library to format &amp; send REST API requests/ receive &amp; parse REST API responses  to/from Docker engine? </p>\n\n<p>I'm also considering writing a helper program in Golang which will use Docker Go SDK and i'll communicate with this helper from my program over some IPC mechanism(pipes or message queues) to make an API call. In case there are no C bindings for an SDK written in a different programming language, what is the effective way to use the functionalities of APIs of that SDK?</p>\n\n<p>I'm trying to come up with an effective way to start/stop a container, get list of running containers, get stats on a particular container etc. from a C program other than relying on docker command line utility in Linux.</p>\n"}, {"tags": ["c", "linux", "semaphore"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561566182, "post_id": 56776759, "comment_id": 100109816, "body": "&quot;<i>I tried also using simply a global semaphore - in place of - pointer to semaphore.</i>&quot; -- if you want us to address this, then you&#39;ll need to present actual code that demonstrates exactly what you did, preferably in the form of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11659457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jrHiL.jpg?s=128&g=1", "display_name": "reham.abass", "link": "https://stackoverflow.com/users/11659457/reham-abass"}, "edited": false, "score": 0, "creation_date": 1561565845, "post_id": 56776958, "comment_id": 100109662, "body": "Thank u , your explanation is  good ,I think I got your idea ,  I&#39;m aware that I&#39;m using a pointer to  semaphore , we learnt in the class , that we can use pointers to abbreviate the use of &amp;. I tried again your suggestion , but I got more errors. here some  of them :x.c:101:2: warning: passing argument 1 of \u2018sem_init\u2019 from incompatible pointer type [enabled by default]   sem_init(&amp;flag,0,1);"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 17, "user_id": 11659457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jrHiL.jpg?s=128&g=1", "display_name": "reham.abass", "link": "https://stackoverflow.com/users/11659457/reham-abass"}, "edited": false, "score": 0, "creation_date": 1561565957, "post_id": 56776958, "comment_id": 100109712, "body": "Careful - the purpose of pointers is <i>not</i> to abbreviate the use of <code>&amp;</code>. Did you change the definition of <code>flag</code> so that it&#39;s now a <code>sem_t</code>, not a <code>sem_t *</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 17, "user_id": 11659457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jrHiL.jpg?s=128&g=1", "display_name": "reham.abass", "link": "https://stackoverflow.com/users/11659457/reham-abass"}, "edited": false, "score": 1, "creation_date": 1561566066, "post_id": 56776958, "comment_id": 100109760, "body": "@reham.abass, using a variable of pointer type <i>does not</i> &quot;abbreviate&quot; use of <code>&amp;</code>.  It merely gives you a variable that can store the result of an <code>&amp;</code> expression.  The key problem here is that somewhere there needs to be an actual <code>sem_t</code> for the pointer to point <b>to</b>, and the code you present in the question does not provide one."}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 2, "last_activity_date": 1561565014, "creation_date": 1561565014, "answer_id": 56776958, "question_id": 56776759, "link": "https://stackoverflow.com/questions/56776759/segmentation-fault-running-time-on-sem-postflag/56776958#56776958", "title": "Segmentation Fault running time on sem_post(flag)", "body": "<p>I believe that you are using the <code>sem_t *</code> type in a way that is plausible but incorrect. Rather than having your semaphore itself be a <code>sem_t *</code>, which means \"I'm not a <code>sem_t</code>, but I can tell you where one is,\" you'll want that semaphore to have type <code>sem_t</code>.</p>\n\n<p>As a result, when you call <code>sem_init</code>, you'll need to pass in the address of your semaphore, as shown here:</p>\n\n<pre><code>sem_init(&amp;flag, 0, 1);\n</code></pre>\n\n<p>Similarly, to post to the semaphore, you'll want to write</p>\n\n<pre><code>sem_post(&amp;flag);\n</code></pre>\n\n<p>Let's contrast that with what you're doing right now. By making <code>flag</code> a <code>sem_t *</code> that points to <code>NULL</code>, you're saying \"I point to a semaphore, except that I'm not actually pointing at one.\" Calling <code>sem_init</code> and passing in a null pointer is an error - that would mean \"please construct a semaphore at the location pointed at by a null pointer,\" which is semantically incorrect. The crash you're getting occurs because you're similarly saying \"please post to the semaphore pointed at by this null pointer.\" By instead having an honest-to-goodness semaphore object that you then pass into the functions, you're saying \"here's my semaphore - please do nice things with it.\"</p>\n"}], "owner": {"reputation": 17, "user_id": 11659457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jrHiL.jpg?s=128&g=1", "display_name": "reham.abass", "link": "https://stackoverflow.com/users/11659457/reham-abass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1561611694, "answer_count": 1, "score": -1, "last_activity_date": 1561565087, "creation_date": 1561564369, "last_edit_date": 1561565087, "question_id": 56776759, "link": "https://stackoverflow.com/questions/56776759/segmentation-fault-running-time-on-sem-postflag", "closed_reason": "Not suitable for this site", "title": "Segmentation Fault running time on sem_post(flag)", "body": "<p>I'm getting a segmentation fault posting to a semaphore. The actual crash is on this line:</p>\n\n<pre><code>sem_post(flag);\n</code></pre>\n\n<p>Here's the code I'm using:</p>\n\n<pre><code>//global variable for the use of all threads:\nsem_t *flag= NULL;\n\n\n//in main,before creating the threads:\nsem_init(flag,0,1);\n\n\n//in function of the threads :\nsem_post(flag);\n</code></pre>\n\n<p>I tried also using simply a global semaphore - in place of - pointer to semaphore. How do I fix this?</p>\n"}, {"tags": ["c", "debugging", "gcc", "reverse-engineering", "reversing"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1561564600, "post_id": 56776485, "comment_id": 100108992, "body": "debug information does not provide that kind of information.  Perhaps reading about  <i><a href=\"https://en.wikipedia.org/wiki/Interactive_Disassembler\" rel=\"nofollow noreferrer\">dis-assemblers</a></i> will help."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561564683, "post_id": 56776485, "comment_id": 100109048, "body": "What do you mean by reverse-engineering, what do you expect produced by it ? (for instance some UML modeler have a reverse populating the UML model from the <b>sources</b>). The debug infos produced by the option <code>-g</code> are typically used by a debugger to associate an address with a line in a function/operation, to know where the variables are in memory/stack etc, but this is not a reverse-engineering"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1561565058, "post_id": 56776485, "comment_id": 100109260, "body": "All <code>-g</code> should affect is whether symbolic debugging information is generated at compile+link times. It shouldn&#39;t actually affect the <i>code</i> generation. That said, is your <i>real</i> question whether compiling with <code>-g</code> somehow makes <i>your</i> code easier for <i>someone else</i> to reverse-engineer?"}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1561567624, "post_id": 56776485, "comment_id": 100110454, "body": "@WhozCraig Yes, this is exactly what I&#39;m asking.."}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561564898, "post_id": 56776903, "comment_id": 100109164, "body": "the macros definition / usage disappear <i>before</i> the compilation during the preprocessing and cannot be part of the debug infos"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561564955, "post_id": 56776903, "comment_id": 100109200, "body": "The information is included in the binary. Just <code>grep</code> something compiled with <code>-g3</code> for <code>__STDC_VERSION__</code> and you&#39;ll see."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561565185, "post_id": 56776903, "comment_id": 100109321, "body": "do <code>#define AZE 1  int main() {   return AZE; }</code> (on at least 2 lines of course) and compile with <code>-g</code> and you will not see <i>AZE</i> in the binary/executable, you can also compile with the option <code>-E</code> and check <i>AZE</i> does not appears in the result of the preprocessing"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561565265, "post_id": 56776903, "comment_id": 100109367, "body": "@bruno Sorry, that specific debugging information only appears when compiling with <code>-g3</code>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561565419, "post_id": 56776903, "comment_id": 100109442, "body": "ok with <code>-g3</code> you have the definition of <i>AZE</i> (I didn&#39;t know that, thank you for learning me that) but not where it is used in the source, so the interest is very limited (in fact I do not see what it can be ^^)"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1561565513, "post_id": 56776903, "comment_id": 100109491, "body": "@bruno The line number is not included as a string, but as a native-endian integer. A debugger will be more useful when testing for that."}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1561567717, "post_id": 56776903, "comment_id": 100110496, "body": "Maybe I wasn&#39;t clear.. I meant, If I compile my program with -g, -g3 or w/e , does it somehow helps another to do reverse engineering on my program ?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1561567766, "post_id": 56776903, "comment_id": 100110514, "body": "@sagi Somewhat. If possible, just give them the source code."}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1561567883, "post_id": 56776903, "comment_id": 100110572, "body": "I mean I want to prevent reversing on my code. Does compiling like this affect it somehow , or it just doesn\u2019t matter?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1561567942, "post_id": 56776903, "comment_id": 100110596, "body": "@sagi You want to prevent decompiling your code? If so, just run <code>strip</code> on it after you build it."}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1561568025, "post_id": 56776903, "comment_id": 100110630, "body": "You\u2019re missing my point. I\u2019m not asking how to do it, I\u2019m asking if compiling like this compromise it somehow"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561568104, "post_id": 56776903, "comment_id": 100110667, "body": "No. In no way will anyone ever get a working program from decompiling software. Just write a license that prohibits decompilation and disassembly."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": true, "score": 4, "last_activity_date": 1561568378, "last_edit_date": 1561568378, "creation_date": 1561564822, "answer_id": 56776903, "question_id": 56776485, "link": "https://stackoverflow.com/questions/56776485/reverse-engineering-compile-with-debug-info/56776903#56776903", "title": "Reverse engineering - compile with debug info", "body": "<p>It helps by adding line numbers, file names, macro definitions and such to the resulting binary. However, it does not include the full source of the program inside the program itself.</p>\n\n<p>Here's an example of macro definitions being included in the resulting file:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>username@localhost /path/to/source/code $ gcc test.c -Wall -Wextra -gdwarf-4 -g3\nusername@localhost /path/to/source/code $ grep __STDC_VERSION__ a.out \nBinary file a.out matches\n</code></pre>\n\n<p>Debugging information is more useful for decompiling when compiling with <code>-g3</code>, as shown in the above example.</p>\n\n<p>So, the answer to your question is: It gives a little bit of extra information that may be useful in decompiling, but not enough to be able to decompile and recompile the program successfully. If possible, just give the source code to the person.</p>\n\n<p>If you want to prevent decompiling your code, just run <code>strip</code> on it like this after building and debugging your program:</p>\n\n<pre><code>strip program-file\n</code></pre>\n\n<p><code>-g</code> should not affect code generation, it just adds information only useful to a debugger to the resulting program file.</p>\n\n<p>If you want to prohibit someone from disassembling or decompiling your software, just include that in your license.</p>\n"}], "owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 56776903, "answer_count": 1, "score": 1, "last_activity_date": 1561568378, "creation_date": 1561563502, "question_id": 56776485, "link": "https://stackoverflow.com/questions/56776485/reverse-engineering-compile-with-debug-info", "title": "Reverse engineering - compile with debug info", "body": "<p>I am learning about reversing a program and I was wondering .. if I compile with debug info :</p>\n\n<pre><code>gcc -g ....\n</code></pre>\n\n<p>Does this help the reversing process some how? do I give extra information if I do that? I Couldn't find any information about the subject.</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1561566939, "post_id": 56776473, "comment_id": 100110191, "body": "Just an aside: The <code>name</code> looks wrong. It is supposed to be a null-terminated printf-style format string. You should probably create the thread something like this: <code>.task = kthread_run(exist, NULL, &quot;delta%d&quot;, i)</code> (after you have corrected the prototype of the <code>entry</code> function). Also, your posted code is full of syntax errors, e.g. semicolons in the <code>delta_entry de</code> initializer and a missing semicolon after the initializer. There are other horrible mistakes too. Are you sure you are ready for writing kernel code?"}, {"owner": {"reputation": 99, "user_id": 11385838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xoXUtYRTYo0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resbs7bRF5B4D2sgiIbuHM9JxSfYg/mo/photo.jpg?sz=128", "display_name": "Ramsey Alsheikh", "link": "https://stackoverflow.com/users/11385838/ramsey-alsheikh"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1561567278, "post_id": 56776473, "comment_id": 100110322, "body": "Thank you for pointing out the issues with the initializer! I&#39;ve fixed them. Could you tell me about the other mistakes I made? No, I&#39;m not ready for writing kernel code, but I figure the best way to learn is from experience. Thank you for your help!"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1561567873, "post_id": 56776473, "comment_id": 100110567, "body": "Other mistakes. It&#39;s hard to be sure without knowing what your <code>enqueue</code> function actually does, but my suspicion is that it will expect the contents of <code>de</code> to remain valid after it returns."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1561563948, "creation_date": 1561563948, "answer_id": 56776632, "question_id": 56776473, "link": "https://stackoverflow.com/questions/56776473/how-to-use-a-function-pointer-with-kthread-run/56776632#56776632", "title": "How to use a function pointer with kthread_run?", "body": "<p>From looking at the linux source <code>kthread_run</code> is a macro calling <code>kthread_create_on_node</code>, which expects <code>int (*threadfn)(void *data)</code>.</p>\n\n<p><code>int exist()</code> takes an unspecified number of arguments as is therefore compatible with that function signature but <code>int (*exists_ptr)(void)</code> takes none. (<code>int exist()</code> and <code>int exist(void)</code> are synonymous only in C++. In C, <code>()</code> means unspecified promoted arguments and <code>(void)</code> means no arguments.)</p>\n\n<p>Unprototyped function definitions are generally discouraged in modern C.\nYou should make the <code>exist</code> function's signature <code>int exists(void *unused)</code> right from the start.</p>\n"}], "owner": {"reputation": 99, "user_id": 11385838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xoXUtYRTYo0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resbs7bRF5B4D2sgiIbuHM9JxSfYg/mo/photo.jpg?sz=128", "display_name": "Ramsey Alsheikh", "link": "https://stackoverflow.com/users/11385838/ramsey-alsheikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 56776632, "answer_count": 1, "score": 2, "last_activity_date": 1561563948, "creation_date": 1561563463, "question_id": 56776473, "link": "https://stackoverflow.com/questions/56776473/how-to-use-a-function-pointer-with-kthread-run", "title": "How to use a function pointer with kthread_run?", "body": "<p>I am writing a system call in Linux, and for it I want to create several threads using <code>kthread_run</code>. However when I pass the function pointer I get: </p>\n\n<pre><code>error: passing argument 1 of \u2018kthread_create_on_node\u2019 from incompatible pointer type\n</code></pre>\n\n<p>Here is the relevant code:</p>\n\n<pre><code>//method to do nothing for 100 milliseconds\nint exist()\n{\n   mdelay(100);\n   return 0;\n}\n\n//function pointer to exist\nint (*exist_ptr)(void) = &amp;exist;\n\n//create processes and delta queues \nfor (i = PROC_NUM - 1; i &gt;= 0; i--)\n{\n    char name[6] = {'d', 'e', 'l', 't', 'a', i2};\n\n    delta_entry de = {\n        .task = kthread_run(exist_ptr, NULL, name);\n        .list = linked_list;\n        .delta_time =  PROC_NUM * MILSEC_GAP;\n        .position = i2;\n    }\n    enqueue(&amp;linked_list, &amp;de, i2 - 1);\n    i2++;\n}\n</code></pre>\n\n<p>This obviously isn't all the code, becuase I didn't want to make the post too long. Thank you!</p>\n"}, {"tags": ["c", "libpcap", "inet", "inet-ntop"], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1561558991, "creation_date": 1561558991, "answer_id": 56775078, "question_id": 56774985, "link": "https://stackoverflow.com/questions/56774985/c-inet-ntop-return-value-position/56775078#56775078", "title": "C: inet_ntop return value position?", "body": "<p>It's quite clear to me, but perhaps you need to apply some \"good will\" to get it:</p>\n\n<ol>\n<li>It's not a string in C if it isn't terminated, so of course the result is terminated.</li>\n<li><code>dst</code> is an input argument, even if it's a bit weirdly written \"a pointer to <code>dst</code>\" can't be \"a pointer to <code>dst</code> plus something\".</li>\n</ol>\n\n<p>You can of course also <a href=\"https://code.woboq.org/userspace/glibc/resolv/inet_ntop.c.html\" rel=\"nofollow noreferrer\">read an implementation</a> to see what's going on. The last statement for the \"happy path\" (no buffer overflow) for both IPv4 and v6 variants is:</p>\n\n<pre><code>return strcpy(dst, tmp);\n</code></pre>\n\n<p>Which instantly tells you that <code>dst</code> is receiving a terminated string, and that <code>dst</code> is returned.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561560700, "post_id": 56775183, "comment_id": 100106724, "body": "It returns <code>const char *</code>."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 2, "last_activity_date": 1561561637, "last_edit_date": 1561561637, "creation_date": 1561559323, "answer_id": 56775183, "question_id": 56774985, "link": "https://stackoverflow.com/questions/56774985/c-inet-ntop-return-value-position/56775183#56775183", "title": "C: inet_ntop return value position?", "body": "<p>It returns <code>const char *</code> and since the <code>dst</code> parameter is required to be a valid object (you can not pass <code>NULL</code> as <code>dst</code>) there is no need to create an intermediate pointer to return the status of the function.</p>\n"}, {"comments": [{"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1561560932, "post_id": 56775613, "comment_id": 100106874, "body": "You have not dealt with broken C code much, I take it.  Nonetheless, I see this question is going to trigger a stack overflow &quot;hammer session&quot;"}, {"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1561561643, "post_id": 56775613, "comment_id": 100107324, "body": "flagged.  I get it, I promise: a string is a null delimeted char array.  but these are not always null delimited by a human user, or function.  I&#39;m not saying I do it.  But look: we write computer languages in computing language because English is imprecise.  You are in denial over this simple fact, and blasting away on a question with an accepted answer."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1561561775, "post_id": 56775613, "comment_id": 100107408, "body": "Standards are written for implementors, not for users.  Reference documentation like the <code>inet_ntop</code> manpage is written for people who already know all the ins and outs of the language and just need a reminder.  Quoting such documents at someone who does not fully understand C yet, not only fails to answer their question, it teaches them that people who don&#39;t fully understand C are not welcome here.  Kindly do not do this ever again."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 1, "creation_date": 1561561775, "post_id": 56775613, "comment_id": 100107409, "body": "@donlan No, you <b>DON&#39;T</b> get it: <i>a string is a null delimeted char array. but these are not always null delimited.</i>  It&#39;s not a &quot;string&quot; if it&#39;s missing the null character termination.  The English here is not imprecise, you are."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1561562211, "post_id": 56775613, "comment_id": 100107659, "body": "@zwol <i>Standards are written for implementors</i> Writing code <b>is</b> implementing, and the standards are the reference. The POSIX standard is clearer than what I assume to be the Linux man page quoted in the question.  I started with <code>inet_pton()</code> in POSIX, pulled in the POSIX string definition, and got to the point of answering his questions simply and directly from the relevant standards.  It&#39;s a simple, direct answer in a way that demonstrated <b>where</b> it comes from.  Care to explain what&#39;s wrong with that?"}, {"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1561562295, "post_id": 56775613, "comment_id": 100107707, "body": "No, you have just misinterpretation my English: strings <i>are</i> null delimited. However, <i>students</i> may record strings in buffers that automatically get nulled at standard compilation orders, but yield memory faults at order 3 compilation and beyond.  I encounter it all the time when I come in and clean up code.  Thus, I am very wary of all the crazy things that can happen."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1561562385, "post_id": 56775613, "comment_id": 100107757, "body": "@donlan Your question isn&#39;t about student-written code.  It&#39;s about <code>inet_ntop()</code>, a widely-used, standard library function."}, {"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1561562422, "post_id": 56775613, "comment_id": 100107771, "body": "In other words: char arrays that are incompletely filled default to being strings at low compilation orders.  However, I must go in and correct memory leaks and read faults if, say, a string was not technically created, but rather a char array with no null delimitation.  So you may very well not be experienced with broken C code, and my point may very well be astute."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1561562519, "post_id": 56775613, "comment_id": 100107828, "body": "@donlan Then make it clear you&#39;re dealing with such data.  Your question is literally <i>What does inet_ntop return?</i>"}, {"owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "edited": false, "score": 0, "creation_date": 1561562534, "post_id": 56775613, "comment_id": 100107835, "body": "You can\u2019t desperately cry foul because I didn\u2019t provide a memoir of context to the question.  The Stack overflow code is minimal content needed for the question, and answer.  I asked a question, and received an answer.  But it seems you want to use this to get some kind of positive emotional transaction regarding your intellect.  I am sure you are very bright.  But I don\u2019t have time for this."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1561567264, "post_id": 56775613, "comment_id": 100110316, "body": "@AndrewHenle I feel like I&#39;m repeating myself here, but lemme try to put it clearer: Your answer is NOT a simple, direct answer. For anyone who does not already know how to read the style of documentation you are quoting, it is <i>totally incomprehensible</i>. Moreover, anyone who knows how to read this style of documentation <i>necessarily</i> knows C well enough that they wouldn&#39;t have asked the question you&#39;re answering. Therefore your answer is not only useless, it&#39;s <i>hostile</i>. You are implying that no one who can&#39;t already read this documentation deserves to be allowed to ask questions here."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1561560680, "creation_date": 1561560680, "answer_id": 56775613, "question_id": 56774985, "link": "https://stackoverflow.com/questions/56774985/c-inet-ntop-return-value-position/56775613#56775613", "title": "C: inet_ntop return value position?", "body": "<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/inet_pton.html\" rel=\"nofollow noreferrer\"><code>inet_pton()</code> documentation</a>:</p>\n\n<blockquote>\n  <p>...</p>\n  \n  <p><strong>SYNOPSIS</strong></p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n\nconst char *inet_ntop(int af, const void *restrict src,\n       char *restrict dst, socklen_t size);\n</code></pre>\n  \n  <p>...</p>\n  \n  <p><strong>DESCRIPTION</strong></p>\n  \n  <p>The <code>inet_ntop()</code> function shall convert a numeric address into a text\n  string suitable for presentation. The af argument shall specify the\n  family of the address. This can be <code>AF_INET</code> or <code>AF_INET6</code>.  The src\n  argument points to a buffer holding an IPv4 address if the <code>af</code>\n  argument is <code>AF_INET</code>,   or an IPv6 address if the <code>af</code> argument is\n  <code>AF_INET6</code>;  the address must be in network byte order. The <code>dst</code>\n  argument points to a buffer where the function stores the resulting\n  text string; it shall not be <code>NULL</code>. The size argument specifies the\n  size of this buffer, which shall be large enough to hold the text\n  string (<code>INET_ADDRSTRLEN</code> characters for IPv4, <code>INET6_ADDRSTRLEN</code>\n  characters for IPv6).</p>\n  \n  <p>...</p>\n  \n  <p><strong>RETURN VALUE</strong></p>\n  \n  <p>The <code>inet_ntop()</code> function shall return a pointer to the buffer\n  containing the text string if the conversion succeeds, and <code>NULL</code>\n  otherwise, and set <code>errno</code> to indicate the error.</p>\n  \n  <p>...</p>\n  \n  <p><strong>ERRORS</strong></p>\n  \n  <p>The <code>inet_ntop()</code> and <code>inet_pton()</code> functions shall fail if:</p>\n  \n  <p>[<code>EAFNOSUPPORT</code>] The <code>af</code> argument is invalid.</p>\n  \n  <p>[<code>ENOSPC</code>] The size of the <code>inet_ntop()</code> result buffer is inadequate.</p>\n</blockquote>\n\n<p>And <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_92\" rel=\"nofollow noreferrer\">the definition of a \"string\"</a>:</p>\n\n<blockquote>\n  <p><strong>3.92 Character String</strong></p>\n  \n  <p>A contiguous sequence of characters terminated by and including the\n  first null byte.</p>\n</blockquote>\n\n<p>Given that, the answer to</p>\n\n<blockquote>\n  <ol>\n  <li>Null string termination: it is not clear whether I need to add a null string delimiter throughout the memory allocation where inet_ntop is printing when compiling at order 3 or more</li>\n  </ol>\n</blockquote>\n\n<p>should be clear.  A string <strong>by definition</strong> includes the null byte.  <code>inet_pton()</code> returns a pointer to a buffer that contains such a string.  No addition of a null byte is needed.</p>\n\n<p>And the answer to</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>I do not know whether the output of the function returns a pointer to the last written character, or the first written character. </li>\n  </ol>\n</blockquote>\n\n<p>is given by the C standard in <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p7\" rel=\"nofollow noreferrer\"><strong>6.3.2.3 Pointers</strong>, paragraph 7</a>:</p>\n\n<blockquote>\n  <p>... When a pointer to an object is converted to a pointer to a character type, the result points to the lowest addressed byte of the object.</p>\n</blockquote>\n\n<p>So, the \"pointer to the buffer containing the text string if the conversion succeeds\" returned by <code>inet_ntop()</code>  points to the first byte in the string.</p>\n"}], "owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 56775078, "answer_count": 3, "score": -1, "last_activity_date": 1561561637, "creation_date": 1561558671, "question_id": 56774985, "link": "https://stackoverflow.com/questions/56774985/c-inet-ntop-return-value-position", "title": "C: inet_ntop return value position?", "body": "<p>I am reviewing the <code>inet_ntop</code> documentation.   Typically, string builder operations in <code>C</code> return either a pointer to the end of the string, or an integer indicating the length of the string written.  </p>\n\n<p>The documentation of <code>inet_ntop</code> states quite ambiguously:</p>\n\n<pre><code>On success, inet_ntop() returns a non-null pointer to dst.  NULL is \nreturned if there was an error, with the errno set to indicate the \nerror.\n</code></pre>\n\n<p>There are two problems here: </p>\n\n<ol>\n<li><p>Null string termination: it is not clear whether I need to add a null string delimiter throughout the memory allocation where <code>inet_ntop</code> is printing when compiling at order 3 or more</p></li>\n<li><p>I do not know whether the output of the function returns a pointer to the last written character, or the first written character. </p></li>\n</ol>\n\n<hr>\n\n<p>What does <code>inet_ntop</code> return?</p>\n"}, {"tags": ["c", "struct", "bit-fields"], "comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 3, "creation_date": 1561558180, "post_id": 56774773, "comment_id": 100105040, "body": "You probably need <code>#pragma pack</code> or similar (depending on your compiler, or more precisely, compiler&#39;s preprocessor). The <code>year</code> field &quot;lands&quot; on two bytes, so most likely it is padded by the compiler. Subsequently, some of the fields which follow it also &quot;land&quot; on two bytes, so more padding is applied."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561558268, "post_id": 56774773, "comment_id": 100105102, "body": "The problem is this: &quot;...an expected 8&quot;. There is no expected size of a bit-field. They can&#39;t be reliably used for memory-mapping."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1561558734, "post_id": 56774773, "comment_id": 100105436, "body": "In pure C, there&#39;s no guarantee about the memory layout of a struct."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1561560378, "post_id": 56774773, "comment_id": 100106497, "body": "In C, the traditional way to pack bit fields is to pack them inside integers whose size is the same as the declared integer type.  So in your example, they would be packed into 8-bit integers.  If a bit field didn&#39;t fit, it would skip to a new integer.  I believe the packing requirements have been loosened up since then, but it is still a common strategy.  So in your case the packings are (1) 2, 2, 4 (2) 5, 3 (3) 4, 2 (4) 7 (5) 4 (6) 5 (7) 5 (9) 6 (9) 6 (10) 5 (11) 4.  So you&#39;re ending up with 11 8-bit integers.  If you want improved packing, switch to a larger integer type, e.g. <code>uint32_t</code>."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561562854, "post_id": 56775060, "comment_id": 100108019, "body": "the problem with your solution is that it does not preserve the fields order making it useless when the received data fave its own order."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561563052, "post_id": 56775060, "comment_id": 100108126, "body": "@P__J__ I do mention that using <code>unsigned long long</code>/<code>uint_least64_t</code> should fix it without the need to reorder."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561563201, "post_id": 56775060, "comment_id": 100108216, "body": "@P__J__ For IO, I explicit bit manipulation from a <code>uin8_t</code> array should be the most portable approach."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1561562640, "last_edit_date": 1561562640, "creation_date": 1561558922, "answer_id": 56775060, "question_id": 56774773, "link": "https://stackoverflow.com/questions/56774773/structure-with-bit-fields-size/56775060#56775060", "title": "Structure with bit-fields size", "body": "<p>If you run it through the <code>pahole</code> tool, you should get an explanation:</p>\n\n<pre><code>struct frameHeader_t {\n    uint8_t                    encryption:2;         /*     0: 6  1 */\n    uint8_t                    frameVersion:2;       /*     0: 4  1 */\n    uint8_t                    probeType:4;          /*     0: 0  1 */\n    uint8_t                    dataType:5;           /*     1: 3  1 */\n    uint8_t                    measurePeriod:3;      /*     1: 0  1 */\n    uint8_t                    remontePerdiod:4;     /*     2: 4  1 */\n    uint8_t                    nbrMeasure:2;         /*     2: 2  1 */\n\n    /* XXX 2 bits hole, try to pack */\n\n    uint8_t                    year:7;               /*     3: 1  1 */\n\n    /* XXX 1 bit hole, try to pack */\n\n    uint8_t                    month:4;              /*     4: 4  1 */\n\n    /* XXX 4 bits hole, try to pack */\n\n    uint8_t                    day:5;                /*     5: 3  1 */\n\n    /* XXX 3 bits hole, try to pack */\n\n    uint8_t                    hour:5;               /*     6: 3  1 */\n\n    /* XXX 3 bits hole, try to pack */\n\n    uint8_t                    minute:6;             /*     7: 2  1 */\n\n    /* XXX 2 bits hole, try to pack */\n\n    uint8_t                    second:6;             /*     8: 2  1 */\n\n    /* XXX 2 bits hole, try to pack */\n\n    uint8_t                    randomization:5;      /*     9: 3  1 */\n\n    /* XXX 3 bits hole, try to pack */\n\n    uint8_t                    status:4;             /*    10: 4  1 */\n\n    /* size: 11, cachelines: 1, members: 15 */\n    /* bit holes: 8, sum bit holes: 20 bits */\n    /* bit_padding: 4 bits */\n    /* last cacheline: 11 bytes */\n};\n</code></pre>\n\n<p>You're using <code>uint8_t</code> as the base type so the fields are getting padded to groups of 8 bits.</p>\n\n<p>You should be able to completely eliminate the padding, somewhat more portably than with <code>__attribute((packed))</code> by using <code>unsigned long long</code>/<code>uint_least64_t</code> (at least 64 bits large) as the base type of the bitfields, but technically the non-int/non-unsigned-int base types for bitfields aren't guaranteed to be supported, but you could use <code>unsigned</code> (at least 16 bits guaranteed by the C standard) after reorganizing the bitfields a little, for example into:</p>\n\n<pre><code>typedef struct frameHeader_t\n{\n    //16\n    unsigned year             : 7;\n    unsigned randomization    : 5;\n    unsigned month            : 4;\n\n    //16\n    unsigned second           : 6;\n    unsigned minute           : 6;\n    unsigned status           : 4;\n\n    //16\n    unsigned hour             : 5;\n    unsigned dataType         : 5;\n    unsigned probeType        : 4;\n    unsigned encryption       : 2;\n\n    //16\n    unsigned day              : 5;\n    unsigned remontePerdiod   : 4;\n    unsigned measurePeriod    : 3;\n    unsigned nbrMeasure       : 2;\n    unsigned frameVersion     : 2;\n\n}FrameHeader; \n//should be an unpadded 8 bytes as long as `unsigned` is 16,\n//32, or 64 bits wide (I don't know of a platform where it isn't)\n</code></pre>\n\n<p>(The padding or lack thereof isn't guaranteed, but I've never seen an implementation insert it unless it was necessary.)</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1561562751, "creation_date": 1561562751, "answer_id": 56776282, "question_id": 56774773, "link": "https://stackoverflow.com/questions/56774773/structure-with-bit-fields-size/56776282#56776282", "title": "Structure with bit-fields size", "body": "<p>to avoid the packing magic I usually use fixed size unsigned types with the same size </p>\n\n<pre><code>typedef struct frameHeader_t\n    {\n        uint64_t encryption       : 2;\n        uint64_t frameVersion     : 2;\n        uint64_t probeType        : 4;\n        uint64_t dataType         : 5;\n        uint64_t measurePeriod    : 3;\n        uint64_t remontePerdiod   : 4;\n        uint64_t nbrMeasure       : 2;\n        uint64_t year             : 7;\n        uint64_t month            : 4;\n        uint64_t day              : 5;\n        uint64_t hour             : 5;\n        uint64_t minute           : 6;\n        uint64_t second           : 6;\n        uint64_t randomization    : 5;\n        uint64_t status           : 4;\n\n    }FrameHeader;\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/BX2QsC\" rel=\"nofollow noreferrer\">https://godbolt.org/z/BX2QsC</a></p>\n"}], "owner": {"reputation": 889, "user_id": 8080758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ce11073e465a49f65a4a6430e090dae?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/8080758/cl%c3%a9ment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 56775060, "answer_count": 2, "score": 2, "last_activity_date": 1561562751, "creation_date": 1561558007, "question_id": 56774773, "link": "https://stackoverflow.com/questions/56774773/structure-with-bit-fields-size", "title": "Structure with bit-fields size", "body": "<p>I tried to use a structure with different sized bit-fields. The total number of bits used is 64. However, when I check the structure size, I get <strong>11</strong> instead of an expected <strong>8</strong>. By trying to decompose the structure, I saw the difference came from the <em>day</em> field. If I pack every bit to get 8-bits packs, the <em>day</em> field is packed beetween the \"end\" of <em>month</em> and the \"start\" of <em>hour</em>. I don't know if this is a good approach. Can someone explain me that ?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef unsigned char uint8_t;\n\ntypedef struct frameHeader_t\n    {\n        uint8_t encryption       : 2;\n        uint8_t frameVersion     : 2;\n        uint8_t probeType        : 4;\n        uint8_t dataType         : 5;\n        uint8_t measurePeriod    : 3;\n        uint8_t remontePerdiod   : 4;\n        uint8_t nbrMeasure       : 2;\n        uint8_t year             : 7;\n        uint8_t month            : 4;\n        uint8_t day              : 5;\n        uint8_t hour             : 5;\n        uint8_t minute           : 6;\n        uint8_t second           : 6;\n        uint8_t randomization    : 5;\n        uint8_t status           : 4;\n\n    }FrameHeader;\n\nint main()\n{\n\n    FrameHeader my_frameHeader;\n    printf(\"%d\\n\", sizeof(FrameHeader));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "azure", "serial-port", "azure-virtual-machine", "serial-communication"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561561741, "post_id": 56774104, "comment_id": 100107382, "body": "for ease of readability and understanding 1)  follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  2)  do not try to hide the code via some macros"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561561839, "post_id": 56774104, "comment_id": 100107447, "body": "OT: regarding: <code>main()</code>  regardless of what visual studio allows, there are only two valid signatures for <code>main()</code>  They are: <code>int main( void )</code> and <code>int main( int argc, char *argv[] )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561562008, "post_id": 56774104, "comment_id": 100107545, "body": "OT: when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful.  If not successful, call <code>perror( &quot;your error message&quot; );</code> to output both your error message and the text reason the system thinks the error occurred to <code>stderr</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561562214, "post_id": 56774104, "comment_id": 100107660, "body": "regarding: <code>diagnose(fprintf,fserial,&quot;\\n\\nthread %lx:\\n&quot;, GetCurrentThreadId());</code>  Since no thread has been started (perhaps via a call to <code>pthread_create()</code> it is doubtful that <code>GetCurrentThreadId()</code> would return anything useful and normally the returned value would be a <code>pthread_t</code>, Such a returned value is unlikely to be a match for a format specifier of <code>%lx</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4549, "user_id": 105568, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f4da10bd4be2d0ca458f8786c79b9e84?s=128&d=identicon&r=PG", "display_name": "Skrymsli", "link": "https://stackoverflow.com/users/105568/skrymsli"}, "is_accepted": false, "score": 0, "last_activity_date": 1568068585, "creation_date": 1568068585, "answer_id": 57861961, "question_id": 56774104, "link": "https://stackoverflow.com/questions/56774104/how-to-write-to-serial-log-in-boot-diagnostics-in-azure-from-vm/57861961#57861961", "title": "How to write to serial log in boot diagnostics in azure from VM?", "body": "<p>I did this recently. I had to write to COM1, not COM2. Are you sure your VM does not have COM1 defined? Can you add it?</p>\n"}], "owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568068585, "creation_date": 1561555936, "last_edit_date": 1561561079, "question_id": 56774104, "link": "https://stackoverflow.com/questions/56774104/how-to-write-to-serial-log-in-boot-diagnostics-in-azure-from-vm", "title": "How to write to serial log in boot diagnostics in azure from VM?", "body": "<p>I tried writing to COM2 port (which was the only available port in mode) like this:</p>\n\n<pre><code>#define diagnose_general(c,a, ...)(printf(\"%s - \"c\"\\n\", #a, a(__VA_ARGS__)))\n#define diagnose(a, ...)diagnose_general(\"%lx\",a,__VA_ARGS__)\n\n#include &lt;stdio.h&gt;\n#include &lt;Windows.h&gt;\n\n\nmain() {FILE *fserial;\ndiagnose_general(\"%p\",fserial=fopen, \"COM2\", \"w\");\n\ndiagnose(fprintf,fserial,\"\\n\\nthread %lx:\\n\", GetCurrentThreadId());\ndiagnose_general(\"%zx\",fwrite,\"test\",sizeof \"test\",1,fserial);\ndiagnose(fflush,fserial);\ndiagnose(fclose,fserial);}\n</code></pre>\n\n<p>It succeseeds but nothing new is shown in the boot diagnostics Serial log window in the portal. Any ideas?</p>\n"}, {"tags": ["java", "c", "compiler-construction"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1561554764, "post_id": 56773620, "comment_id": 100102764, "body": "Nah, think of the JDK as any other program. You could write it in many different languages. You could even lift the boot by the strap and remake the JDK in Java now."}, {"owner": {"reputation": 9311, "user_id": 214525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7684a686e233476c6713ced10a9cef41?s=128&d=identicon&r=PG", "display_name": "f1sh", "link": "https://stackoverflow.com/users/214525/f1sh"}, "edited": false, "score": 0, "creation_date": 1561554894, "post_id": 56773620, "comment_id": 100102859, "body": "Just because the jdk or jvm is written in C doesn&#39;t mean there is any relationship between java and C. The java spec is the JLS and any java compiler/runtime environment has to implement that specification"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1561554918, "post_id": 56773620, "comment_id": 100102886, "body": "A JDK can be written in any language that&#39;s capable of implementing the JDK specification. C is not a bad choice at all for that."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1561555208, "post_id": 56773620, "comment_id": 100103076, "body": "@Bathsheba - Though a JVM written in C++ would be somewhat ironic"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1561555298, "post_id": 56773620, "comment_id": 100103135, "body": "You create a language specification by writing the language&#39;s syntax and semantics into words (precisely and completely), putting those words into a document and then publishing the document. There might be a committee involved and an approval or even standardization process, but that&#39;s the gist of it."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1561555746, "post_id": 56773620, "comment_id": 100103461, "body": "I don&#39;t understand all the downvotes here. Sure, the question is a bit na&#239;ve, but it&#39;s an interesting question."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1561556306, "post_id": 56773620, "comment_id": 100103817, "body": "you can also ask how is it possible to program the chess game in C as the C language does not know anything about the game rules."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1561562744, "post_id": 56773620, "comment_id": 100107953, "body": "@mathmaniage: Java and C have little to do with each other from a <i>language</i> point of view.  The Java compiler (which translates the Java source text into JVM byte code) and the JVM (which executes the byte code) can be written in almost any language, though C and C++ are probably the most common. For reference, here are the <a href=\"https://docs.oracle.com/javase/specs/jls/se12/jls12.pdf\" rel=\"nofollow noreferrer\">Java Language</a> and <a href=\"https://docs.oracle.com/javase/specs/jvms/se12/jvms12.pdf\" rel=\"nofollow noreferrer\">Java Virtual Machine</a> specifications.  They&#39;re just text documents that describe how the language and JVM should behave."}], "answers": [{"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1561556379, "post_id": 56774027, "comment_id": 100103863, "body": "&quot;So to answer your question: A specification is nothing more than a description of how the java programming language should be compiled into its byte code.&quot; I disagree. The Java language specification specifies how a Java program should behave. It does say that a Java program should be compiled to .class files, but it does not care <i>how</i> this is done or which exact bytecode a given program will compile to. It only cares that the generated bytecode fits the specified behaviour. The JLS does not specify the behaviour in terms of bytecode. It doesn&#39;t even describe what Java bytecode looks like."}, {"owner": {"reputation": 1349, "user_id": 11702000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8b88ecd35b05ea2f7fb273752bc62b?s=128&d=identicon&r=PG&f=1", "display_name": "Software Person", "link": "https://stackoverflow.com/users/11702000/software-person"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1561556502, "post_id": 56774027, "comment_id": 100103930, "body": "@sepp2k That is fair, let me think of a better description and edit my reply"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1561557237, "post_id": 56774027, "comment_id": 100104438, "body": "Suggestion: Change &quot;C/C++&quot; to something like &quot;C++ or some other language&quot;. The term &quot;C/C++&quot; is heavily frowned upon here because there is no such thing. They are completely different languages."}, {"owner": {"reputation": 1349, "user_id": 11702000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8b88ecd35b05ea2f7fb273752bc62b?s=128&d=identicon&r=PG&f=1", "display_name": "Software Person", "link": "https://stackoverflow.com/users/11702000/software-person"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1561557462, "post_id": 56774027, "comment_id": 100104578, "body": "@klutt Okay, done!"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1561557718, "post_id": 56774027, "comment_id": 100104743, "body": "Nice. I don&#39;t know if I&#39;m a bit nitpicking now, but it looks like you&#39;re saying that a JRE is always written in C++. I can edit if you don&#39;t mind?"}, {"owner": {"reputation": 1349, "user_id": 11702000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8b88ecd35b05ea2f7fb273752bc62b?s=128&d=identicon&r=PG&f=1", "display_name": "Software Person", "link": "https://stackoverflow.com/users/11702000/software-person"}, "edited": false, "score": 0, "creation_date": 1561557813, "post_id": 56774027, "comment_id": 100104811, "body": "A bit nitpicky, but I don&#39;t mind. Make your changes on the things you think are unclear and I&#39;ll accept them"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1561559914, "post_id": 56774027, "comment_id": 100106201, "body": "<a href=\"https://en.m.wikipedia.org/wiki/Javac\" rel=\"nofollow noreferrer\">&quot;javac is itself written in java.&quot;</a>. Of course, it doesn&#39;t have to be. But it is interesting that it is."}], "tags": [], "owner": {"reputation": 1349, "user_id": 11702000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8b88ecd35b05ea2f7fb273752bc62b?s=128&d=identicon&r=PG&f=1", "display_name": "Software Person", "link": "https://stackoverflow.com/users/11702000/software-person"}, "is_accepted": true, "score": 3, "last_activity_date": 1561558058, "last_edit_date": 1561558058, "creation_date": 1561555769, "answer_id": 56774027, "question_id": 56773620, "link": "https://stackoverflow.com/questions/56773620/how-is-language-specification-created/56774027#56774027", "title": "How is language specification created", "body": "<p>I think you are misunderstanding a few things, so let's go to the basics first:</p>\n\n<p>A computer program is nothing more than a set of instructions that are read by the processor and then executed. A list of tasks that are executed one by one.</p>\n\n<p>Java uses something that is called the Java Runtime Environment (JRE). The JRE is sort of (not exactly) a virtual processor, with its own instruction set called java byte code. This 'virtual processor' runs inside of your operating system.</p>\n\n<p>The Java Runtime Environment is written in some language. The Sun JRE is written in C. The C code is in turn compiled into the machine code of your real processor (So code your processor understands).</p>\n\n<p>Java is compiled into java byte code.</p>\n\n<p>So to answer your question: A specification is nothing more than a description of how the java programming language should behave and what it looks like. Basically a regular text document you can write in something like word. </p>\n\n<p>With this specification programmers can build a compiler. A compiler is a program that changes java code like this:</p>\n\n<pre><code>for (int i = 2; i &lt; 1000; i++) {\n    for (int j = 2; j &lt; i; j++) {\n        if (i % j == 0)\n            continue outer;\n    }\n    System.out.println (i);\n}\n</code></pre>\n\n<p>into bytecode that looks like this</p>\n\n<pre><code>0:   iconst_2\n1:   istore_1\n2:   iload_1\n3:   sipush  1000\n6:   if_icmpge       44\n9:   iconst_2\n10:  istore_2\n11:  iload_2\n12:  iload_1\n13:  if_icmpge       31\n16:  iload_1\n17:  iload_2\n18:  irem\n19:  ifne    25\n22:  goto    38\n25:  iinc    2, 1\n28:  goto    11\n31:  getstatic       #84; // Field java/lang/System.out:Ljava/io/PrintStream;\n34:  iload_1\n35:  invokevirtual   #85; // Method java/io/PrintStream.println:(I)V\n38:  iinc    1, 1\n41:  goto    2\n44:  return\n</code></pre>\n\n<p>The compiler program that does this can be written in any language, however it is recommended to write it into low level languages like C++ to make the compiling process quicker.</p>\n"}], "owner": {"reputation": 299, "user_id": 6315135, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec6ebc80a755f2f69daec24126238184?s=128&d=identicon&r=PG&f=1", "display_name": "mathmaniage", "link": "https://stackoverflow.com/users/6315135/mathmaniage"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "closed_date": 1561556362, "accepted_answer_id": 56774027, "answer_count": 1, "score": -5, "last_activity_date": 1561558058, "creation_date": 1561554594, "last_edit_date": 1561554644, "question_id": 56773620, "link": "https://stackoverflow.com/questions/56773620/how-is-language-specification-created", "closed_reason": "Needs more focus", "title": "How is language specification created", "body": "<p>I wanted to ask, what is java written in, but I found an answer to this on stackexchange, which said,  <strong>you don't write language with a language, it's a specification, but the JDK is written in C</strong>.</p>\n\n<p><strong>Now, my question is</strong>, if the JDK is written in C, is Java basically a different form of the C language, like an extension or something, with more features added? How is  this specification created, and what's the relationship between these three things:  </p>\n\n<ul>\n<li>The tool that interprets the specification(like the JDK)</li>\n<li>The specification itself</li>\n<li>The language the tool was created in.</li>\n</ul>\n"}, {"tags": ["android", "c", "flutter", "android-ndk", "java-native-interface"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 4767727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q--9yRbZKcw/AAAAAAAAAAI/AAAAAAAAY9Q/wiujMd7Dn94/photo.jpg?sz=128", "display_name": "kimusan", "link": "https://stackoverflow.com/users/4767727/kimusan"}, "edited": false, "score": 0, "creation_date": 1561711878, "post_id": 56774493, "comment_id": 100161780, "body": "You are right. The project was created as package and not plugin. Is there any way top change this (package -&gt; plugin) or do I have to redo the changes I have already done to the project?"}, {"owner": {"reputation": 31410, "user_id": 9597706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1204711a75c490c659741ef0c6dcbffc?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Heap", "link": "https://stackoverflow.com/users/9597706/richard-heap"}, "reply_to_user": {"reputation": 343, "user_id": 4767727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q--9yRbZKcw/AAAAAAAAAAI/AAAAAAAAY9Q/wiujMd7Dn94/photo.jpg?sz=128", "display_name": "kimusan", "link": "https://stackoverflow.com/users/4767727/kimusan"}, "edited": false, "score": 0, "creation_date": 1561717489, "post_id": 56774493, "comment_id": 100164493, "body": "It&#39;s best to start with a new project and copy the implementation over."}], "tags": [], "owner": {"reputation": 31410, "user_id": 9597706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1204711a75c490c659741ef0c6dcbffc?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Heap", "link": "https://stackoverflow.com/users/9597706/richard-heap"}, "is_accepted": true, "score": 3, "last_activity_date": 1561557164, "creation_date": 1561557164, "answer_id": 56774493, "question_id": 56773090, "link": "https://stackoverflow.com/questions/56773090/how-to-use-native-c-library-in-flutter-package/56774493#56774493", "title": "How to use native C library in flutter package", "body": "<p>Are you sure you created a Flutter plugin project (not a package)? A plugin is a type of package with Dart/Kotlin (or Java)/Swift (or Obj-C) code implementing the Flutter-native layer, <em>plus</em> an example app that exercises and demonstrates use of the plugin.</p>\n\n<p>A Flutter plugin has 3 build.gradle files:</p>\n\n<ol>\n<li><code>./android/build.grade</code> where you set the plugin's min SDK, dependencies, etc</li>\n<li><code>./example/android/build.grade</code> which is generally left unchanged</li>\n<li><code>./example/android/app/build.gradle</code> which is where you set things for the example app</li>\n</ol>\n\n<p>Any changes you make to (1) bubble up to the example app (which is just a sample app that uses your plugin). Likewise, when you use the plugin in a different app, that app just picks up (1) from your plugin.</p>\n\n<p>Add your dependencies to (1).</p>\n"}], "owner": {"reputation": 343, "user_id": 4767727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q--9yRbZKcw/AAAAAAAAAAI/AAAAAAAAY9Q/wiujMd7Dn94/photo.jpg?sz=128", "display_name": "kimusan", "link": "https://stackoverflow.com/users/4767727/kimusan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 56774493, "answer_count": 1, "score": 2, "last_activity_date": 1617109260, "creation_date": 1561552869, "last_edit_date": 1561555111, "question_id": 56773090, "link": "https://stackoverflow.com/questions/56773090/how-to-use-native-c-library-in-flutter-package", "title": "How to use native C library in flutter package", "body": "<p>I have a library written in C which I have previously used from a java android app via JNI.</p>\n\n<p>I am now moving to use flutter instead and the plan was to make a flutter package that wraps the C library. </p>\n\n<p>The flutter project for the package has been created and the plan is to use Platform Channels (invokeMethod to call some simple Java methods that invokes the JNI for the library. I think I have most of this implemented. </p>\n\n<p>Problem is, however that I would normally add the info about the existence of the library and JNI to the build.gradle of my android java project. I can however not find these files when I am working in the structure of a flutter package. If I instead build a standard flutter project (an app with UI) i suddenly have the build.gradle files. </p>\n\n<p>How can I add these gradle files or should I add the info about the lib/JNI to some other flutter specific files instead? \nDo the multilayered dart->platformChannel -> java -> jni -> C library aproach sound like the right way of doing it? or is there a better way?</p>\n"}, {"tags": ["c++", "c", "gcc", "g++"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1561552926, "post_id": 56773053, "comment_id": 100101651, "body": "The contents of your <code>.build.sh</code> would be instrumental in forming an answer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561562651, "post_id": 56773053, "comment_id": 100107891, "body": "What you have posted is/are not error messages.  rather they are bits and pieces of what would be output.  Please copy/paste the actual output into your question"}], "owner": {"reputation": 83, "user_id": 8745586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f0ae5bd1dfe81800529736fdd0e10b?s=128&d=identicon&r=PG", "display_name": "Shiva", "link": "https://stackoverflow.com/users/8745586/shiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561552736, "creation_date": 1561552736, "question_id": 56773053, "link": "https://stackoverflow.com/questions/56773053/getting-an-error-while-running-build-sh-file-in-cross-compiler-dir", "title": "getting an error while running .build.sh file in cross compiler dir", "body": "<p>Here is my console log while running .build.sh command in crosscompiler dir.</p>\n\n<p>version of gcc, g++ and clang is here.</p>\n\n<p>bnr@AM-PC-07:~/osxcross$ gcc --version\ngcc (Ubuntu 8.3.0-6ubuntu1~18.04.1) 8.3.0\nCopyright (C) 2018 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n\n<p>bnr@AM-PC-07:~/osxcross$ clang --version\nclang version 6.0.0-1ubuntu2 (tags/RELEASE_600/final)\nTarget: x86_64-pc-linux-gnu\nThread model: posix\nInstalledDir: /usr/bin\nbnr@AM-PC-07:~/osxcross$ g++ --version\ng++ (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n\n<p>Here is my error log</p>\n\n<pre><code>CMake Error at /usr/share/cmake-3.10/Modules/CMakeTestCXXCompiler.cmake:45 (message):\nThe C++ compiler\n\n\"/usr/bin/clang++\"\n\nis not able to compile a simple test program.\n\nIt fails with the following output:\n\nChange Dir: /home/bnr/osxcross/build/apple-libtapi/build/CMakeFiles/CMakeTmp\n\nRun Build Command:\"/usr/bin/make\" \"cmTC_5f536/fast\"\n/usr/bin/make -f CMakeFiles/cmTC_5f536.dir/build.make CMakeFiles/cmTC_5f536.dir/build\n</code></pre>\n"}, {"tags": ["c", "cross-compiling", "gd", "mingw-w64", "lib"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1561551177, "post_id": 56772472, "comment_id": 100100474, "body": "Probably related to wrong library order.  See <a href=\"https://stackoverflow.com/questions/45135/why-does-the-order-in-which-libraries-are-linked-sometimes-cause-errors-in-gcc\" title=\"why does the order in which libraries are linked sometimes cause errors in gcc\">stackoverflow.com/questions/45135/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 5656436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206a1f634801e5add24532eca508e078?s=128&d=identicon&r=PG&f=1", "display_name": "sverx", "link": "https://stackoverflow.com/users/5656436/sverx"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561551420, "post_id": 56772472, "comment_id": 100100632, "body": "@AndrewHenle libgd uses libpng and libz so it should be first I guess. BTW it didn&#39;t work even putting that second or third or last."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 2, "creation_date": 1561551992, "post_id": 56772472, "comment_id": 100101007, "body": "The &quot;right&quot; order shown in that other question has your code at the start of the arguments, dependencies after it. You have the opposite."}, {"owner": {"reputation": 45, "user_id": 5656436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206a1f634801e5add24532eca508e078?s=128&d=identicon&r=PG&f=1", "display_name": "sverx", "link": "https://stackoverflow.com/users/5656436/sverx"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1561552459, "post_id": 56772472, "comment_id": 100101330, "body": "@Mat Oh gosh. I wonder why on MinGW on Windows it worked. Putting libraries at the end seems to fix the linking problem. Thanks!"}], "owner": {"reputation": 45, "user_id": 5656436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206a1f634801e5add24532eca508e078?s=128&d=identicon&r=PG&f=1", "display_name": "sverx", "link": "https://stackoverflow.com/users/5656436/sverx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1561553161, "answer_count": 0, "score": 1, "last_activity_date": 1561551655, "creation_date": 1561550933, "last_edit_date": 1561551655, "question_id": 56772472, "link": "https://stackoverflow.com/questions/56772472/i-cant-cross-compile-a-simple-program-that-uses-libgd-because-of-undefined-refe", "closed_reason": "Duplicate", "title": "I can&#39;t cross-compile a simple program that uses libgd because of undefined references though libgd.a is present", "body": "<p>I'm trying to cross-compile on Linux (i686-w64-mingw32-gcc) a small 32-bit Windows program that requires (libz, libpng and) libgd.\nI have them all installed correctly, as far as I can tell, though the linker keeps on complaining it can't locate the libgd functions I'm using.</p>\n\n<pre><code>$ i686-w64-mingw32-gcc -lgd -lpng -lz -lm -o demo demo.o smssc.o\ndemo.o:demo.c:(.text+0x2d): undefined reference to `_imp__gdImageCreateFromPng@4'\ndemo.o:demo.c:(.text+0x1f7): undefined reference to `_imp__gdImageGetPixel@12'\ndemo.o:demo.c:(.text+0x316): undefined reference to `_imp__gdImageCreate@8'\ndemo.o:demo.c:(.text+0x368): undefined reference to `_imp__gdImagePaletteCopy@8'\ndemo.o:demo.c:(.text+0x3b0): undefined reference to `_imp__gdImageGetPixel@12'\ndemo.o:demo.c:(.text+0x3ec): undefined reference to `_imp__gdImageSetPixel@16'\ndemo.o:demo.c:(.text+0x430): undefined reference to `_imp__gdImageDestroy@4'\ndemo.o:demo.c:(.text+0x465): undefined reference to `_imp__gdImageSetPixel@16'\ndemo.o:demo.c:(.text+0x4a9): undefined reference to `_imp__gdImageSetPixel@16'\ndemo.o:demo.c:(.text+0x4e0): undefined reference to `_imp__gdImageColorAllocate@16'\ndemo.o:demo.c:(.text+0x569): undefined reference to `_imp__gdImageLine@24'\ndemo.o:demo.c:(.text+0x5e9): undefined reference to `_imp__gdImageLine@24'\ndemo.o:demo.c:(.text+0x669): undefined reference to `_imp__gdImageLine@24'\ndemo.o:demo.c:(.text+0x6e3): undefined reference to `_imp__gdImageLine@24'\ndemo.o:demo.c:(.text+0x70f): undefined reference to `_imp__gdImagePng@8'\ndemo.o:demo.c:(.text+0x71f): undefined reference to `_imp__gdImageDestroy@4'\n</code></pre>\n\n<p>this is how I had configured libgd</p>\n\n<pre><code>./configure --host=i686-w64-mingw32 --prefix=/usr/i686-w64-mingw32 CPPFLAGS=\"-I/usr/i686-w64-mingw32/include\" LDFLAGS=\"-L/usr/i686-w64-mingw32/lib\"\n</code></pre>\n\n<p>of course <em>libgd.a</em>, <em>libpng.a</em> and <em>libz.a</em> are found into my <em>/usr/i686-w64-mingw32/lib</em></p>\n\n<p>also, objdump output seems correct:</p>\n\n<pre><code>$ objdump -tT /usr/i686-w64-mingw32/lib/libgd.a\nIn archive /usr/i686-w64-mingw32/lib/libgd.a:\ngd.o:     file format pe-i386\n[snip]\n</code></pre>\n"}, {"tags": ["c", "bluetooth", "arduino"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561550314, "post_id": 56771664, "comment_id": 100099950, "body": "Arduino is C++, not C. Is a slow C++ solution with std::string sufficient or does it have to be done with C strings?"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 10666634, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h2vWsdZoLao/AAAAAAAAAAI/AAAAAAAAA2s/gZT8ukY9Xds/photo.jpg?sz=128", "display_name": "Noor Sabbagh", "link": "https://stackoverflow.com/users/10666634/noor-sabbagh"}, "edited": false, "score": 0, "creation_date": 1561617233, "post_id": 56772243, "comment_id": 100124454, "body": "Thank you. Thats exactly what I had in mind I just didn&#39;t know the functions to use. So thank you for your suggestion."}, {"owner": {"reputation": 47, "user_id": 10666634, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h2vWsdZoLao/AAAAAAAAAAI/AAAAAAAAA2s/gZT8ukY9Xds/photo.jpg?sz=128", "display_name": "Noor Sabbagh", "link": "https://stackoverflow.com/users/10666634/noor-sabbagh"}, "edited": false, "score": 0, "creation_date": 1561620520, "post_id": 56772243, "comment_id": 100126174, "body": "One more question, how would i be able to differentiate between single letter messages and ones like this one? For example, i am currently using &#39;n&#39; to denote the light turn on function and as you saw i am using a multi character string for things like brightness. How can i set up both? Do i simply just check if bluetooth.available is more than 1?"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 3, "last_activity_date": 1561550217, "creation_date": 1561550217, "answer_id": 56772243, "question_id": 56771664, "link": "https://stackoverflow.com/questions/56771664/extracting-values-from-an-incoming-bluetooth-serial-on-an-arduino/56772243#56772243", "title": "Extracting values from an incoming bluetooth serial on an arduino", "body": "<p>You can have <code>string</code> variable which stores all the <code>read</code> values into it and once <code>!</code> is read it will start processing it. </p>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\nSoftwareSerial BlueTooth(5, 6); // (TXD, RXD) of HC-06\n\nchar input; // to store input character received via BT.\nString data;\n\nvoid setup()  \n{\n  pinMode(13, OUTPUT);     // Arduino Board LED Pin\n  BlueTooth.begin(9600);  \n}\n\nvoid loop() \n{\n  if (BlueTooth.available())\n  {\n    input=(BlueTooth.read());\n\n      if (input != '!') {\n          data += input;\n      }\n      else{\n          String message_id = String(data.substring(0,2)); //gets only \"bt\"\n          data.remove(0,3); //data becomes \"50\" since '!' is not added to data\n\n          int message_value = data.toInt();\n\n          if(message_id == \"bt\"){\n               brightness = message_value;\n          }\n      }\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 312, "user_id": 10309494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ec600183f131b43b6d2116b9fbbe9f?s=128&d=identicon&r=PG&f=1", "display_name": "KBlr", "link": "https://stackoverflow.com/users/10309494/kblr"}, "edited": false, "score": 0, "creation_date": 1561561043, "post_id": 56774202, "comment_id": 100106946, "body": "What a sick suggestion! Hope I had multiple downvote option.1. Which compiler allows <code>case &#39;bt&#39;:</code> this? 2. Have littler mercy on readabilty. 3. <code>*((unsigned int *)msg</code> is undefined behavior due to strict aliasing rule  And list goes on."}, {"owner": {"reputation": 312, "user_id": 10309494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ec600183f131b43b6d2116b9fbbe9f?s=128&d=identicon&r=PG&f=1", "display_name": "KBlr", "link": "https://stackoverflow.com/users/10309494/kblr"}, "edited": false, "score": 0, "creation_date": 1561561155, "post_id": 56774202, "comment_id": 100107026, "body": "Don&#39;t misguide the newbie if you don&#39;t know the answer just move on."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 312, "user_id": 10309494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ec600183f131b43b6d2116b9fbbe9f?s=128&d=identicon&r=PG&f=1", "display_name": "KBlr", "link": "https://stackoverflow.com/users/10309494/kblr"}, "edited": false, "score": 0, "creation_date": 1561564643, "post_id": 56774202, "comment_id": 100109021, "body": "@KBlr First of all I suggest you to check what you affirm before to express any pure opinion. 1) Each <b>compliant</b> compiler accept the <code>case &#39;bt&#39;:</code> for the reason that the standard allows it. And the GCC used on Arduino isn&#39;t an exception. Just write it in Arduino IDE and compile. You&#39;ll simply get a warning <b>&quot;warning: multi-character character constant [-Wmultichar] case &#39;bt&#39;:&quot;</b>. 2) this is a simple form of the casting. <b>Experienced programmers</b> have seen even worst in big company codes. And I stop the list."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 312, "user_id": 10309494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ec600183f131b43b6d2116b9fbbe9f?s=128&d=identicon&r=PG&f=1", "display_name": "KBlr", "link": "https://stackoverflow.com/users/10309494/kblr"}, "edited": false, "score": 0, "creation_date": 1561564731, "post_id": 56774202, "comment_id": 100109072, "body": "@KBlr Compilation checked with &quot;ATMEL Studio 7&quot; and ECLIPSE. Here the warning don&#39;t comes out.  In this solution the only arguable point is that it uses an implementation-defined limitation. But this must be compiled for Arduino specific system only .... (using the standard compiler)."}, {"owner": {"reputation": 47, "user_id": 10666634, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h2vWsdZoLao/AAAAAAAAAAI/AAAAAAAAA2s/gZT8ukY9Xds/photo.jpg?sz=128", "display_name": "Noor Sabbagh", "link": "https://stackoverflow.com/users/10666634/noor-sabbagh"}, "edited": false, "score": 0, "creation_date": 1561619727, "post_id": 56774202, "comment_id": 100125714, "body": "@Frankie_C thank you for your suggestion but im afraid its a little too complicated for what i was after."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 47, "user_id": 10666634, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h2vWsdZoLao/AAAAAAAAAAI/AAAAAAAAA2s/gZT8ukY9Xds/photo.jpg?sz=128", "display_name": "Noor Sabbagh", "link": "https://stackoverflow.com/users/10666634/noor-sabbagh"}, "edited": false, "score": 0, "creation_date": 1561625709, "post_id": 56774202, "comment_id": 100129000, "body": "@NoorSabbagh You&#39;re welcome. To make the code more friendly I added 2 more versions that should make easier to give it a try."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561631524, "post_id": 56774202, "comment_id": 100132389, "body": "@Frankie_C Updated one is nice, but you need to consider possible padding and endianness into account."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561632985, "post_id": 56774202, "comment_id": 100133166, "body": "@kiranBiradar Thank-you Kiran. Your comments are correct. Anyway the MCU is an 8bit uP, so the packing attribute on the structure seemed redundant to me, but can be added. The endianess has been one of the point I outlined in the answer, specifying that the character constants must be reversed to respect endianess."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561633833, "post_id": 56774202, "comment_id": 100133662, "body": "@Frankie_C Done from my side."}], "tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1561725100, "last_edit_date": 1561725100, "creation_date": 1561556296, "answer_id": 56774202, "question_id": 56771664, "link": "https://stackoverflow.com/questions/56771664/extracting-values-from-an-incoming-bluetooth-serial-on-an-arduino/56774202#56774202", "title": "Extracting values from an incoming bluetooth serial on an arduino", "body": "<p>You can use a typical trick used in cases as your, encoding multibyte character literals in a single <code>unsigned int</code>, that on Arduino uno and Mega 2560 is 16 bits in little endian format.</p>\n\n<p>With reference to C standard <strong>ISO/IEC 9899:201x</strong> \u00a7 <strong>\"6.4.4.4 Character constants\"</strong>.</p>\n\n<p>The subparagraph 10 explain our case:</p>\n\n<blockquote>\n  <p>An integer character constant has type int. The value of an integer\n  character constant containing a single character that maps to a\n  single-byte execution character is the numerical value of the\n  representation of the mapped character interpreted as an integer. The\n  value of an integer character constant containing more than one\n  character (e.g., 'ab'), or containing a character or escape sequence\n  that does not map to a single-byte execution character, is\n  <strong>implementation-defined</strong>. If an integer character constant contains a\n  single character or escape sequence, its value is the one that results\n  when an object with type char whose value is that of the single\n  character or escape sequence is converted to type int.</p>\n</blockquote>\n\n<p>Where 'implementation-defined' in our case is managed as described below.</p>\n\n<p>In this case the multibyte char constant <code>'bt'</code> can be coded as the 16 bits integer <code>0x6274</code>, where <code>'b'=0x62</code> and <code>'t'=0x74</code>.</p>\n\n<p>The compiler should also be smart enough to convert the multibyte char sequence in the int value.</p>\n\n<p>In the following snippet we consider that the char array <code>msg</code> holds the received message, and we use a simple and functional <code>switch</code> statement (that requires an integer value) casting the <code>msg</code> variable to an unsigned integer.:</p>\n\n<pre><code>char msg[10];\n...\nswitch (*((unsigned int *)msg))\n{\n    case 'tb':     //Note the reverse order of command characters due to endianess\n        int value = atoi(msg+2);    //Convert number to int\n        ....     //do something\n    break;\n\n    ....    //other cases\n}\n</code></pre>\n\n<p>casting the <code>msg</code> pointer variable to a pointer to  unsigned integer the compiler will interpret the first 2 chars as the integer in the way explained above, and act the switch based on their value.</p>\n\n<p>The following sample use your code modified for use of a switch. It assumes that the command has a fixed length equal to <code>MAX_MSG_LEN</code> (2 characters for command, 2 characters for the value and the end of message):</p>\n\n<pre><code>// Bluetooth module used - HC-06\n\n#include &lt;SoftwareSerial.h&gt;\nSoftwareSerial BlueTooth(5, 6); // (TXD, RXD) of HC-06\n\n#define MAX_MSG_LEN 5       //Max message length\n#define OFFSET_TO_VALUE     //Offset in input buffer to value\n\nchar BT_input[10];  // to store input characters received via BT.\n\nvoid setup()\n{\n    pinMode(13, OUTPUT);    // Arduino Board LED Pin\n    BlueTooth.begin(9600);\n}\n\nvoid loop()\n{\n    if (BlueTooth.available())\n    {\n        /*\n         * Read in the message up to the '!'\n         */\n        int i=0;\n        do\n        {\n            BT_input[i] = (BlueTooth.read());\n        } while (i&lt;MAX_MSG_LEN &amp;&amp; BT_input[i++]!='!');\n\n        /*\n         * If message length is exactly what we expect\n         * we can process the message.\n         * Note that because of endianess the command\n         * chare are rversed.\n         */\n        if (i == MAX_MSG_LEN)\n        {\n            switch (*((unsigned int *)BT_input))\n            {\n                case 'tb':  // command 'bt'\n                    process_brigthness(atoi(BT_input + OFFSET_TO_VALUE));\n                    break;\n\n                case 'no':  // command 'on'\n                {\n                    digitalWrite(13, HIGH);\n                    BlueTooth.println(\"Now LED is ON\");\n                    break;\n                }\n\n                case 'fo':  // command 'of' for off\n                {\n                    digitalWrite(13, LOW);\n                    BlueTooth.println(\"Now LED is OFF\");\n                    break;\n                }\n\n                default:    // unknown command\n                {\n                    unknown_command();\n                    break;\n                }\n            }\n        }\n        else\n        {\n            /*\n             * Process communication error\n             */\n            communication_error();\n        }\n    }\n}\n</code></pre>\n\n<p>Or using an union of the input stream and the command structure:</p>\n\n<pre><code>// Bluetooth module used - HC-06\n\n#include &lt;SoftwareSerial.h&gt;\nSoftwareSerial BlueTooth(5, 6); // (TXD, RXD) of HC-06\n\n#define MAX_MSG_LEN 5       //Max message length\n#define OFFSET_TO_VALUE     //Offset in input buffer to value\n\nunion tag_BT_input              // to store input characters received via BT.\n{\n    char   stream[MAX_MSG_LEN];\n    struct\n    {\n        unsigned int cmd;       //Command\n        char         val[2];    //value\n        char         eom;       //End of message marker '!'\n    }msg;\n} BT_input;\n\nvoid setup()\n{\n    pinMode(13, OUTPUT);    // Arduino Board LED Pin\n    BlueTooth.begin(9600);\n}\n\nvoid loop()\n{\n    if (BlueTooth.available())\n    {\n        /*\n         * Read in the message up to the '!'\n         */\n        int i=0;\n        do\n        {\n            BT_input.stream[i] = (BlueTooth.read());\n        } while (i&lt;MAX_MSG_LEN &amp;&amp; BT_input.stream[i++]!='!');\n\n        /*\n         * If message length is exactly what we expect\n         * we can process the message.\n         * Note that because of endianess the command\n         * chare are rversed.\n         */\n        if (i == MAX_MSG_LEN)\n        {\n            switch (BT_input.msg.cmd)\n            {\n                case 'tb':  // command 'bt'\n                    process_brigthness(atoi(BT_input.msg.val));\n                    break;\n\n                case 'no':  // command 'on'\n                {\n                    digitalWrite(13, HIGH);\n                    BlueTooth.println(\"Now LED is ON\");\n                    break;\n                }\n\n                case 'fo':  // command 'of' for off\n                {\n                    digitalWrite(13, LOW);\n                    BlueTooth.println(\"Now LED is OFF\");\n                    break;\n                }\n\n                default:    // unknown command\n                {\n                    unknown_command();\n                    break;\n                }\n            }\n        }\n        else\n        {\n            /*\n             * Process communication error\n             */\n            communication_error();\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10666634, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h2vWsdZoLao/AAAAAAAAAAI/AAAAAAAAA2s/gZT8ukY9Xds/photo.jpg?sz=128", "display_name": "Noor Sabbagh", "link": "https://stackoverflow.com/users/10666634/noor-sabbagh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1561725100, "creation_date": 1561548127, "question_id": 56771664, "link": "https://stackoverflow.com/questions/56771664/extracting-values-from-an-incoming-bluetooth-serial-on-an-arduino", "title": "Extracting values from an incoming bluetooth serial on an arduino", "body": "<p>I am currently working on a project that involves an android app that controls an LED strip through an arduino. This is done via bluetooth module. The problem that I ran into is that the app involves features such as controlling the brightness and hue of the LED strip. So when a change is made to any of these components on the app, a value is sent to the arduino in order for it to update the values. Messages are sent such as this \"bt+50!\" where the first two letters identify which component is changed (bt = brightness), \"+\" indicating the beginning of the actual value and \"!\" indicating the end. </p>\n\n<p>I would like help figuring out how I can split and splice the incoming messages so that I can first identify which component is changed and then be able to extract the integer values, something like:</p>\n\n<pre><code>if(message_id == 'bt'){\n    brightness = message_value;\n}\n</code></pre>\n\n<p>Currently I am just testing out things on a normal single color LED light. And I have only implemented very simple code that functions on single letter messages incoming from the bluetooth serial.</p>\n\n<p>I have tried using the built in C string functions, but since I am new to C language and I am from a python background, it was difficult for me to get things working.</p>\n\n<pre><code>// Bluetooth module used - HC-06\n\n#include &lt;SoftwareSerial.h&gt;\nSoftwareSerial BlueTooth(5, 6); // (TXD, RXD) of HC-06\n\nchar BT_input; // to store input character received via BT.\n\nvoid setup()  \n{\n  pinMode(13, OUTPUT);     // Arduino Board LED Pin\n  BlueTooth.begin(9600);  \n}\n\nvoid loop() \n{\n  if (BlueTooth.available())\n  {\n    BT_input=(BlueTooth.read());\n    if (BT_input=='n')\n    {\n      digitalWrite(13, HIGH);\n      BlueTooth.println(\"Now LED is ON\");\n    }\n    else if (BT_input=='f')\n    {\n      digitalWrite(13, LOW);\n      BlueTooth.println(\"Now LED is OFF\");\n    }\n  }\n}\n</code></pre>\n\n<p>I expect to have the message_id and message_value extracted from the incoming messages so that I can be able to update my LED strip.</p>\n"}, {"tags": ["c", "opencv", "memory-leaks"], "comments": [{"owner": {"reputation": 1090, "user_id": 1983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bba922326537fd12144b9a2587f742f?s=128&d=identicon&r=PG", "display_name": "ssbssa", "link": "https://stackoverflow.com/users/1983398/ssbssa"}, "edited": false, "score": 1, "creation_date": 1561545069, "post_id": 56770116, "comment_id": 100096873, "body": "What is <code>pGrayImg</code> for? It&#39;s not used, and it&#39;s not freed completely (<code>cvReleaseImageHeader</code> instead of <code>cvReleaseImage</code>)."}, {"owner": {"reputation": 14828, "user_id": 1377097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFG0R.png?s=128&g=1", "display_name": "beaker", "link": "https://stackoverflow.com/users/1377097/beaker"}, "edited": false, "score": 1, "creation_date": 1561572274, "post_id": 56770116, "comment_id": 100112496, "body": "Why would you use a C API that&#39;s been deprecated for a decade instead of the supported C++ API?"}], "owner": {"reputation": 15, "user_id": 10474571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oIi_2FnBxto/AAAAAAAAAAI/AAAAAAAAadQ/2Ofs3RAGRBg/photo.jpg?sz=128", "display_name": "id0 SI", "link": "https://stackoverflow.com/users/10474571/id0-si"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1561544541, "creation_date": 1561543351, "last_edit_date": 1561544541, "question_id": 56770116, "link": "https://stackoverflow.com/questions/56770116/opencv-memory-leak-c", "title": "OpenCv memory leak C", "body": "<p>After using the function below I have memory leaks, I tried to use help from other threads but it just helped me to minimize the problem not solving it(using <code>cvDestroyAllWindows</code>).</p>\n\n<pre><code>void play(FrameNode* list)\n{\n    cvNamedWindow(\"Display window\", CV_WINDOW_AUTOSIZE); //create a window\n    FrameNode* head = list;\n    int imgNum = 1, playCount = 0;\n    IplImage* image;\n    while (playCount &lt; GIF_REPEAT)\n    {\n        while (list != 0)\n        {\n            image = cvLoadImage(list-&gt;frame-&gt;path, 1);\n            IplImage* pGrayImg = 0;\n            pGrayImg = cvCreateImage(cvSize(image-&gt;width, image-&gt;height), image-&gt;depth, 1);\n            if (!image) //The image is empty - shouldn't happen since we checked already.\n            {\n                printf(\"Could not open or find image number %d\", imgNum);\n            }\n            else\n            {\n                cvShowImage(\"Display window\", image); //display the image\n                cvWaitKey(list-&gt;frame-&gt;duration); //wait\n                list = list-&gt;next;\n                cvReleaseImage(&amp;image);\n                cvReleaseImageHeader(&amp;pGrayImg);\n\n            }\n            imgNum++;\n        }\n        list = head; // rewind\n        playCount++;\n    }\n    cvDestroyWindow(\"Display window\");\n    cvDestroyAllWindows();\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "dev-c++", "putchar"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1561542654, "post_id": 56769828, "comment_id": 100095376, "body": "<code>putchar(&#39;b&#39;)</code> - this part of the <code>for</code> loop should have a condition which should be false (if you want the loop to break)."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1561543090, "post_id": 56769828, "comment_id": 100095648, "body": "1) have you checked how a <code>for</code> loop works? 2) have you checked what <code>putchar</code>does? If not, do it. If so, what didn&#39;t you understand?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1561544531, "post_id": 56769828, "comment_id": 100096503, "body": "What is your effort so far? Have you tried a dry run yet? What was your result, what is your expected output and how is this different from what you observed?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1561545289, "post_id": 56769828, "comment_id": 100097018, "body": "You might want to read <a href=\"https://www.eskimo.com/~scs/cclass/notes/sx3e.html\" rel=\"nofollow noreferrer\">these class notes</a>."}, {"owner": {"reputation": 41, "user_id": 11390121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0TWS90JPXnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxtszAlSjouG_Z2tLV7fgiXfPfJA/mo/photo.jpg?sz=128", "display_name": "Saumyojit Das", "link": "https://stackoverflow.com/users/11390121/saumyojit-das"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1563962515, "post_id": 56769828, "comment_id": 100871573, "body": "@4386427 PREVIOUSLY I was not unable to understand how this code was working but now i understood ."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 0, "last_activity_date": 1561542909, "creation_date": 1561542909, "answer_id": 56769984, "question_id": 56769828, "link": "https://stackoverflow.com/questions/56769828/how-does-the-putchar-and-whole-of-the-code-gets-executed/56769984#56769984", "title": "How does the putchar and whole of the code gets executed?", "body": "<p><a href=\"http://www.cplusplus.com/reference/cstdio/putchar/\" rel=\"nofollow noreferrer\"><code>putchar</code></a> always returns the char that you put. So for instance, <code>putchar('a')</code> returns <code>'a'</code>. With that in mind, let's have a look at how the <a href=\"https://en.cppreference.com/w/c/language/for\" rel=\"nofollow noreferrer\"><code>for</code></a> loop works:</p>\n\n<blockquote>\n  <p>for ( init_clause ; cond_expression ; iteration_expression )\n  loop_statement</p>\n</blockquote>\n\n<p>The <code>init_clause</code> is <code>putchar('a')</code>. This prints <code>a</code> once, because the <code>init_clause</code> is evaluated once at the beginning of the <code>for</code> loop.</p>\n\n<p>The <code>cond_expression</code> is <code>putchar('b')</code>. This is checked every run through the loop, which is why it always prints <code>b</code>. And as it returns <code>'b'</code> every time, the loop never stops. The loop would only stop if the <code>cond_expression</code> returned <code>0</code> or the loop is exited otherwise, for instance through <code>break</code>.</p>\n\n<p>The <code>iteration_expression</code> is <code>putchar('d')</code>, hence <code>d</code> is printed every time. The <code>loop_statement</code> is <code>putchar('c')</code>, printing <code>c</code>.</p>\n\n<p>The result is printing <code>a</code> once, followed by an infinite amount of <code>bcd</code>. The reason why you get them in this order is because in every run throught the loop, it first checks the <code>cond_expression</code>, executes the <code>loop_statement</code> and then the <code>iteration_expression</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 11390121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0TWS90JPXnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxtszAlSjouG_Z2tLV7fgiXfPfJA/mo/photo.jpg?sz=128", "display_name": "Saumyojit Das", "link": "https://stackoverflow.com/users/11390121/saumyojit-das"}, "edited": false, "score": 0, "creation_date": 1561875043, "post_id": 56770091, "comment_id": 100198246, "body": "How my question is too broad . This question is short ."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1561548195, "last_edit_date": 1592644375, "creation_date": 1561543288, "answer_id": 56770091, "question_id": 56769828, "link": "https://stackoverflow.com/questions/56769828/how-does-the-putchar-and-whole-of-the-code-gets-executed/56770091#56770091", "title": "How does the putchar and whole of the code gets executed?", "body": "<p><a href=\"https://i.stack.imgur.com/cjmj0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cjmj0.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>For your example:</strong></p>\n<blockquote>\n<p><strong>Initial statement :</strong> <code>putchar('a')</code></p>\n<p><strong>Condition expression:</strong> <code>putchar('b')</code></p>\n<p><strong>Repeat step:</strong> <code>putchar('d')</code></p>\n<p><strong>Loop statement :</strong> <code>putchar('c')</code></p>\n</blockquote>\n<p>Now map you <code>code</code> with flow chart above.</p>\n<p>Since <code>putchar</code> returns the character it has printed which is <code>b</code> also satisfies the <code>true</code> condition, thus your for loops run infinite time.</p>\n<hr />\n<blockquote>\n<p>Attribution :\n<a href=\"http://www.equestionanswers.com/c/for-while-do-while-loop-syntax.php\" rel=\"nofollow noreferrer\">http://www.equestionanswers.com/c/for-while-do-while-loop-syntax.php</a></p>\n</blockquote>\n"}], "owner": {"reputation": 41, "user_id": 11390121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0TWS90JPXnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxtszAlSjouG_Z2tLV7fgiXfPfJA/mo/photo.jpg?sz=128", "display_name": "Saumyojit Das", "link": "https://stackoverflow.com/users/11390121/saumyojit-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1561556769, "accepted_answer_id": 56769984, "answer_count": 2, "score": -3, "last_activity_date": 1563962418, "creation_date": 1561542484, "last_edit_date": 1563962418, "question_id": 56769828, "link": "https://stackoverflow.com/questions/56769828/how-does-the-putchar-and-whole-of-the-code-gets-executed", "closed_reason": "Needs more focus", "title": "How does the putchar and whole of the code gets executed?", "body": "<p><strong>I want the dry run of the code for the first 3 iterations to understand</strong>.\nTHe output of the code is  : abcdbcdbcdbcdbc........(infinte times)</p>\n\n<p>I know how for loop works and put char also.I did not dry run as i was not understand will the third argument in the for loop will increment or not.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    for (putchar('a');putchar('b');putchar('d'))\n    putchar('c');\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "union"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1561542085, "post_id": 56769655, "comment_id": 100095038, "body": "An <code>union</code> can&#39;t hold all three of those at the same time. If you want to store all of those things, did you intend to make a <code>struct</code> instead? Change the two <code>union</code> in your code to <code>struct</code> and see if you like that result better."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1561542227, "post_id": 56769655, "comment_id": 100095130, "body": "Me thinks you need to read this, possible duplicate, <a href=\"https://stackoverflow.com/questions/346536/difference-between-a-structure-and-a-union\" title=\"difference between a structure and a union\">stackoverflow.com/questions/346536/&hellip;</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1561543686, "post_id": 56769655, "comment_id": 100095993, "body": "It&#39;s not clear what you&#39;re confused about.  Did you expect <code>val.a</code>, <code>val.b</code>, and <code>val.c</code> to all retain their values?  That&#39;s pretty much the opposite of what a union is for.  If you want  <code>val.a</code>, <code>val.b</code>, and <code>val.c</code> to all retain their values, what you want is a <code>struct</code>.  The whole point of a union is that it&#39;s just big enough to hold <i>one</i> of the values; they all overlap each other in memory.  The only value you can fetch from a union is the last value you stored in it.  Whenever you store a new value in a union, it overwrites all or part of all the others."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561550451, "post_id": 56769655, "comment_id": 100100026, "body": "A union between an <code>int</code> and an <code>int</code> doesn&#39;t make sense."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1561550588, "post_id": 56769833, "comment_id": 100100103, "body": "In order to answer this, you must take endianess in account. You seem to assume big endian, but the OP is using little endian."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561550974, "post_id": 56769833, "comment_id": 100100351, "body": "@Lundin Updated after your suggestion! Thank you."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1561552860, "post_id": 56769833, "comment_id": 100101602, "body": "&quot;which is maximum size of its members.&quot; --&gt;perhaps more. <code>union Values{   double a;   char b[9];  };</code> still may need alignment padding."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1561552994, "post_id": 56769833, "comment_id": 100101703, "body": "@chux I would like to cover that too, but it will be too board for this answer which cover specific doubt of OP."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 2, "last_activity_date": 1561550874, "last_edit_date": 1561550874, "creation_date": 1561542497, "answer_id": 56769833, "question_id": 56769655, "link": "https://stackoverflow.com/questions/56769655/how-union-data-storing-works-getting-confusing-output/56769833#56769833", "title": "How union data storing works. Getting confusing output", "body": "<p><code>Values</code> is union type of size <code>int</code>, which is maximum size of its members.</p>\n\n<p>Considering the size of <code>int</code> is 4 bytes, then.</p>\n\n<pre><code>                   +------------+-------------+-------------+-------------+\nunion Values val = |  1st byte  | 2nd byte    | 3rd byte    |  4th byte   |\n                   +------------+-------------+-------------+-------------+\n</code></pre>\n\n<p>When you store</p>\n\n<pre><code>val.c = 300; //binary 0b100101100\n</code></pre>\n\n<p><code>val</code> will become </p>\n\n<pre><code>        +------------+-------------+-------------+-------------+\n  val = | 0010 1100  | 0000 0001   |             |             |\n        +------------+-------------+-------------+-------------+\n</code></pre>\n\n<p>When you access <code>val.b</code> you will read the only one byte which contains <code>0010 1100</code>.\nAnd decimal equivalent of <code>0010 1100</code> is <code>44</code>.</p>\n"}], "owner": {"reputation": 57, "user_id": 6734694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d79b202ae118034e8b45bb9fb1b23e?s=128&d=identicon&r=PG&f=1", "display_name": "Anis Mulla", "link": "https://stackoverflow.com/users/6734694/anis-mulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1561568599, "accepted_answer_id": 56769833, "answer_count": 1, "score": 1, "last_activity_date": 1561550874, "creation_date": 1561541908, "question_id": 56769655, "link": "https://stackoverflow.com/questions/56769655/how-union-data-storing-works-getting-confusing-output", "closed_reason": "Needs details or clarity", "title": "How union data storing works. Getting confusing output", "body": "<p>I could not understand how Union is printing data.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n union Values{\n  int a;\n  char b;\n  int c;\n };\nunion Values val;\nval.a = 1;\nval.b= 2 ;\nval.c = 300;\nprintf(\"%d,%d,%d\",val.a,val.b,val.c);\nreturn 0;\n}\n</code></pre>\n\n<p>I getting output to 300,44,300</p>\n"}, {"tags": ["c", "abstract-syntax-tree", "yacc", "lex", "context-free-grammar"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1561544142, "post_id": 56769412, "comment_id": 100096240, "body": "Can you explain your &quot;one memory machine&quot;? I don&#39;t see why any of the expressions you&#39;ve shown would require more than one register/memory slot using any machine model that I can imagine (except those where any comparison requires two registers of course). I also don&#39;t see why your transformations would reduce the number of required registers."}, {"owner": {"reputation": 5, "user_id": 3932973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c24f3e39fbd0dfb09904e42bb717090?s=128&d=identicon&r=PG&f=1", "display_name": "Pichner", "link": "https://stackoverflow.com/users/3932973/pichner"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1561545490, "post_id": 56769412, "comment_id": 100097108, "body": "The machine is an old one that simply work&#39;s that way. When you calculate in the linear form I showed above, u only &#39;store&#39; the result of the last exp. But when u calculate exp like x==3 &amp;&amp; (), the machine technically need&#39;s to save the result of x==3 and then start calculate the parenthesis (which will require an additional memory). BUT if u convert it into a linear form back again then problem solved. The thing is, not every expression can be transformed so it will give the same result - ty in advance"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1561546787, "post_id": 56769412, "comment_id": 100097844, "body": "&quot;the machine&quot; or &quot;the code&quot;???"}, {"owner": {"reputation": 5, "user_id": 3932973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c24f3e39fbd0dfb09904e42bb717090?s=128&d=identicon&r=PG&f=1", "display_name": "Pichner", "link": "https://stackoverflow.com/users/3932973/pichner"}, "edited": false, "score": 0, "creation_date": 1561549683, "post_id": 56769412, "comment_id": 100099593, "body": "mmm the code is designed to work on an old machine, that can only compute stuff in a linear form, I am not the original design of this. Basically I&#39;m trying to create a sort of parser to expend the possibilities for future use"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1561552769, "post_id": 56769412, "comment_id": 100101547, "body": "&quot;The machine is an old one that simply work&#39;s that way.&quot; That simply works <i>what</i> way? You need to explain how your machine works and under which circumstances it requires additional memory. Equivalently you could explain into which exact form you need to transform your expression. &quot;exp like x==3 &amp;&amp; ()&quot; So does that mean you need extra memory only for expressions with parentheses? I find it hard to imagine a machine where <code>x==3 || y==3 &amp;&amp; z==5 || x!=4</code> would require no extra memory, but <code>(x==3 || y==4) &amp;&amp; (t==3 || t&gt;4)</code> would. Note that all your expressions can be rewritten without parentheses"}], "owner": {"reputation": 5, "user_id": 3932973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c24f3e39fbd0dfb09904e42bb717090?s=128&d=identicon&r=PG&f=1", "display_name": "Pichner", "link": "https://stackoverflow.com/users/3932973/pichner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561541802, "creation_date": 1561541065, "last_edit_date": 1561541802, "question_id": 56769412, "link": "https://stackoverflow.com/questions/56769412/parsing-a-boolean-expression-into-a-one-memory-machine-using-lex-and-yacc", "title": "Parsing a Boolean expression into a one memory machine using lex and yacc", "body": "<p>I'm trying to write a small app that in a way simplifies a Boolean expression, the app will be using only one memory slot.\nIf needed more then one memory slot I wish to return a message stating that the app can't perform an evaluation of the expression.\nI'm Using an AST I've built from lex and yacc.</p>\n\n<p>The main Idea is to take a Boolean expression and convert it to something like this:<br/></p>\n\n<pre><code>X==3 || y==3 &amp;&amp; z==5 || x!=4\n</code></pre>\n\n<p>so the calculation will be linear from left to right\nIf given an expression like<br/></p>\n\n<pre><code>x==3 || (y==3 &amp;&amp; z==5)\n</code></pre>\n\n<p>Then I want it to be parsed into<br/></p>\n\n<pre><code>y==3 &amp;&amp; z==5 || x==3\n</code></pre>\n\n<p>This has an equivalent match and doesn't need to 'store' the result of x==3 into a register first. Therefor it use's only one memory slot and still return's the right result.<br/>\nexpressions such as: <br/></p>\n\n<pre><code>(x==3 || y==4) &amp;&amp; (t==3 || t&gt;4)\n</code></pre>\n\n<p>are too complex<br/>\nso is<br/></p>\n\n<pre><code>x==3 || x==4 || (x==5 &amp;&amp; x==6)\n</code></pre>\n\n<p>Since u can't parse it into one memory slot from an AST.<br/>\nHowever bare in mind that The expression<br/></p>\n\n<pre><code>x==4 &amp;&amp; (x==3 &amp;&amp; y==5) &amp;&amp; p==5\n</code></pre>\n\n<p>is still viable and can be parsed into<br/></p>\n\n<pre><code>x==3 &amp;&amp; y==5 &amp;&amp; x==4 &amp;&amp; p==5\n</code></pre>\n\n<p>The ast that I have built using yacc has the following rules:<br/>\n<br/></p>\n\n<pre><code>E -&gt; E | E '||' T\nT -&gt; T | T '&amp;&amp;' F\nF -&gt; exp | '(' E ')'\n</code></pre>\n\n<p><br/>\nexp -> create's the expressions like x==3, there's no recursive concepts here, this lead's to the end of the rules.<br/></p>\n\n<p><br/>\nI'm not sure if the tree should be built dif but the problem I'm having is that the 2 Boolean expressions:<br/>\n<br/></p>\n\n<pre><code>1. x==4 &amp;&amp; (x==3 &amp;&amp; y==5) &amp;&amp; p==5\n2. x==3 || x==4 &amp;&amp; (x==5 &amp;&amp; x==6)\n</code></pre>\n\n<p><br/>\ngenerate the same AST, well almost the same, the diff between the 2 are very minor and they mirror one another.<br/>\nI can't seem to find a rule of thumb to tell me which is 'too complicated' and which is not.<br/>\nOf course those 2 expressions can generate much more complex ones, but they need to follow the same rules.<br/>\n<br/>\nYou can assume that the app itself obviously has memory and only parsing the expression and has access to the full power of c.<br/></p>\n\n<p>Thank's a lot in advance</p>\n"}, {"tags": ["c", "segmentation-fault", "malloc", "free"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1561541077, "post_id": 56769283, "comment_id": 100094455, "body": "You are using <code>rest</code> both as save pointer and as string to tokenise. That means that <code>rest</code> will now point to <code>&quot;else&quot;</code>, but your <code>free</code> needs the exact pointer that was allocated, namely the one to <code>&quot;Something_else&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "edited": false, "score": 2, "creation_date": 1561540969, "post_id": 56769357, "comment_id": 100094390, "body": "Now you are writing to an uninitialized pointer with <code>strcpy</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "edited": false, "score": 2, "creation_date": 1561541177, "post_id": 56769357, "comment_id": 100094508, "body": "@rtoijala ... and leaking the memory from <code>char* token= (char*)malloc(128 * sizeof(char)); </code>."}, {"owner": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "edited": false, "score": 0, "creation_date": 1561541182, "post_id": 56769357, "comment_id": 100094511, "body": "the solution is to NOT allocate a pointer? does <code>strtok_r</code> allocate it internally?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "edited": false, "score": 1, "creation_date": 1561541432, "post_id": 56769357, "comment_id": 100094667, "body": "@Leos313: No allocation is happening for either the resulting token or the save pointer: These are just pointers into the original string. The tokens aren&#39;t copies, they are &quot;views&quot; into the string. That&#39;s fast, but comes at the cost that the original string is altered in the process."}, {"owner": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "edited": false, "score": 0, "creation_date": 1561541439, "post_id": 56769357, "comment_id": 100094671, "body": "in the third line of your code, you are coping a string in a not allocated pointer. Is it correct??"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 3, "creation_date": 1561541533, "post_id": 56769357, "comment_id": 100094719, "body": "No, that isn&#39;t correct, as was already pointed out. Look at Matthieu&#39;s answer, which describes a typical and correct use of <code>strtok_r</code>."}], "tags": [], "owner": {"reputation": 3365, "user_id": 2564696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfecfacff3f61943083d01444ade243?s=128&d=identicon&r=PG", "display_name": "dmuir", "link": "https://stackoverflow.com/users/2564696/dmuir"}, "is_accepted": false, "score": 2, "last_activity_date": 1561541555, "last_edit_date": 1561541555, "creation_date": 1561540903, "answer_id": 56769357, "question_id": 56769283, "link": "https://stackoverflow.com/questions/56769283/segmentation-fault-when-free-the-variable-after-using-strt-ok/56769357#56769357", "title": "Segmentation fault when free the variable after using strt_ok", "body": "<p>You should neither allocate nor free the variable 'rest'. strtok_r uses its third argument to store where it got to in the original string. \nSo:</p>\n\n<pre><code>char* rest;\nchar* copy= (char*)malloc(128 * sizeof(char)); \nstrcpy(copy,\"Something_else\");\nchar* token = strtok_r(copy, \"_\", &amp;rest); \n// ...\nfree( copy);  // don't free token or rest\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 5, "last_activity_date": 1561541211, "creation_date": 1561541211, "answer_id": 56769452, "question_id": 56769283, "link": "https://stackoverflow.com/questions/56769283/segmentation-fault-when-free-the-variable-after-using-strt-ok/56769452#56769452", "title": "Segmentation fault when free the variable after using strt_ok", "body": "<p>You only need memory for the sentence, <code>token</code> and <code>rest</code> are just pointers.</p>\n\n<p>And using a <code>while</code> loop, you can see all the tokens:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt; // uint32_t\n\nint main(){\n\n    char* rest , *token;\n    char* setence= malloc(128 * sizeof(char)); \n\n    strcpy(setence, \"Some_thing_else\");\n\n    token = strtok_r(setence, \"_\", &amp;rest);\n\n    while (token) \n    {\n        printf(\"%s\\n\", token);\n        token = strtok_r(NULL, \"_\", &amp;rest);          \n    }\n\n    free(setence);\n\n    return 0;\n}\n</code></pre>\n\n<p>Will give:</p>\n\n<pre><code>Some\nthing\nelse\n</code></pre>\n"}], "owner": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56769452, "answer_count": 2, "score": 2, "last_activity_date": 1561541555, "creation_date": 1561540625, "last_edit_date": 1561541279, "question_id": 56769283, "link": "https://stackoverflow.com/questions/56769283/segmentation-fault-when-free-the-variable-after-using-strt-ok", "title": "Segmentation fault when free the variable after using strt_ok", "body": "<p>I have segmentation fault when executing this simple program (it is just a light version to reproduce the error).</p>\n\n<pre><code>//   gcc main.c -Wall -Wextra -Wpedantic\n//   ./a.out\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt; // uint32_t\n\nint main(){\n\n    char* rest = (char*)malloc(128 * sizeof(char));\n    char* token= (char*)malloc(128 * sizeof(char)); \n    strcpy(rest,\"Something_else\");\n    token = strtok_r(rest, \"_\", &amp;rest);\n    printf(\"%s\\n\", token);\n    free(token);\n    free(rest);\n    return 0;\n}\n</code></pre>\n\n<p>The <code>free</code> of the variable <code>token</code> does not give any error. The <code>free</code> of the variable <code>rest</code> gives me always a segmentation fault every time I use the function <code>strok_r</code>. What is going on? Any suggestion?\nNo warnings are prompt at compilation time.</p>\n\n<p><strong>Question</strong>:</p>\n\n<p>How to re-write this simple code <strong>properly</strong>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 2, "creation_date": 1561539011, "post_id": 56768780, "comment_id": 100093273, "body": "Can you please share the code <i>around</i> the actual return and the call that goes to exit?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1561539106, "post_id": 56768780, "comment_id": 100093341, "body": "The problem is rather the function that <i>exits</i> - <a href=\"https://stackoverflow.com/questions/25408795/tell-gcc-that-a-function-call-will-not-return\">it is the one that should be annotated with <code>noreturn</code></a>!"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1561540519, "post_id": 56768780, "comment_id": 100094152, "body": "How about: <code>if (!temp) {</code> <code>exit_program_with_epic_fail();</code> <code>}</code> <code>&#47;* do some setup work *&#47;</code> <code>return temp;</code>? Or: <code>if (temp) {</code> <code>&#47;* do some setup work *&#47;</code> <code>} else {</code> <code>exit_program_with_epic_fail();</code> <code>}</code> <code>return temp;</code>?"}, {"owner": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1561540805, "post_id": 56768780, "comment_id": 100094305, "body": "@IanAbbott  That is such an obvious answer - guess I didn&#39;t see the wood for the trees!  I&#39;d be keen to see if there is a compiler attribute for this use case, but if not, if you put that as the answer I will accept it :)"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1561743326, "last_edit_date": 1561743326, "creation_date": 1561553605, "answer_id": 56773320, "question_id": 56768780, "link": "https://stackoverflow.com/questions/56768780/is-there-an-attribute-to-tell-the-compiler-to-ignore-a-missing-return-statement/56773320#56773320", "title": "Is there an attribute to tell the compiler to ignore a missing return statement?", "body": "<p>There are 2 ways to get rid of the warning:</p>\n\n<ul>\n<li>tag the <code>exit_program_with_epic_fail()</code> function with the appropriate attribute, <code>_Noreturn</code> in C11, but there is no portable way to do this to pre-C11 compilers. Many compilers support <code>__attribute__((noreturn))</code>, notably <strong>gcc</strong>, <strong>clang</strong> and <strong>tinycc</strong>, but it is an compiler specific extension.</li>\n<li>reorganise the code to let the compiler see the function always return.</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre><code>void *get_memory(void) {\n    void *temp = malloc(100);\n    if (!temp) {\n        exit_program_with_epic_fail();\n    }\n    // do some setup work\n    return temp;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1561555806, "post_id": 56773342, "comment_id": 100103489, "body": "<i>&quot;it is not an allocation function&#39;s job to terminate the application&quot;</i> That&#39;s debatable.  When <code>malloc</code> and family start failing that typically means the system is out of memory, so for most apps there&#39;s not much to do other than <code>exit</code>.  It also centralizes the error handling."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1561557090, "post_id": 56773342, "comment_id": 100104337, "body": "@dbush It&#39;s always best to centralize error handling at the top level. If the program can&#39;t continue executing even the clean-up because there&#39;s no memory, then it probably won&#39;t matter how you write it. But if it can, it is convenient to know where the program failed and why. That is, it failed at the 666th call to <code>get_memory</code>, not just &quot;it failed to allocate memory&quot;."}, {"owner": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "edited": false, "score": 0, "creation_date": 1561565380, "post_id": 56773342, "comment_id": 100109424, "body": "@Lundin In this case though, the allocation function (it isn&#39;t <code>malloc</code> in the actual code), would require custom handling in many different places - all of which would simply terminate the program. At least for my use case, knowing what failed to allocated the memory or which attempt failed isn&#39;t useful - it can&#39;t get memory and it can&#39;t continue, so log and exit quickly so the system can restart it. I&#39;m certainly interested in knowing better ways to handle this particular issue! :)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "edited": false, "score": 0, "creation_date": 1561617901, "post_id": 56773342, "comment_id": 100124822, "body": "@PeterM The call to terminate the program should come from the main application, not by a module/library used by it, period. And the main application is where you should centralize error handling too, at the top layer. Nothing reeks more than de-centralized error handling."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "edited": false, "score": 0, "creation_date": 1561618152, "post_id": 56773342, "comment_id": 100124942, "body": "@PeterM One typical example of crappy libraries are those who localized error handling of things that &quot;will never happen anyway&quot;. Often &quot;unexpected errors&quot; don&#39;t happen because of that theoretical, unexpected thing which will never happen, but because of plain old bugs. It is for example far more likely that your pointer to malloc&#39;d memory gets set to null because of buffer overruns or runaway code, than the computer having no memory left."}, {"owner": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "edited": false, "score": 0, "creation_date": 1561818486, "post_id": 56773342, "comment_id": 100189794, "body": "@Lundin This is not an external library, nor is there any localized error handling. The app has a single function for doing a fast exit simply because given its use case, it is preferable to simply bail and restart the app than it is to try and fix many problems. This greatly simplifies the program design and removes a lot of boilerplate error handling code. Whilst it is true that a null pointer could be caused by an overrun or runaway code, this would also put the app into an undefined state that would not be possible to safely recover from - hence die fast and allow safe recovery."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1561553675, "creation_date": 1561553675, "answer_id": 56773342, "question_id": 56768780, "link": "https://stackoverflow.com/questions/56768780/is-there-an-attribute-to-tell-the-compiler-to-ignore-a-missing-return-statement/56773342#56773342", "title": "Is there an attribute to tell the compiler to ignore a missing return statement?", "body": "<p>This seems to be a pure design problem. </p>\n\n<p>The warning/error \"control reaches end of non-void function\" isn't the problem, it is rather just an indicator telling you where the actual problem is.</p>\n\n<p>You could/should simply rewrite the function as</p>\n\n<pre><code>void *get_memory (void) \n{\n  void *temp = malloc(100);\n  if(temp != NULL)\n  {\n    // do stuff\n  }\n\n  return temp;\n}\n</code></pre>\n\n<p>And leave error handling to the caller. Because it is not an allocation function's job to terminate the application - that's bad design. </p>\n\n<p>Alternative version with detailed error handling:</p>\n\n<pre><code>typedef enum\n{\n  OK,\n  ERR_OUTOFMEMORY,\n  ...\n} err_t;\n\nerr_t get_memory (void** mem) \n{\n  *mem = malloc(100);\n  if(*mem == NULL)\n  {\n    return ERR_OUTOFMEMORY;\n  }\n\n  // do stuff\n\n  return OK;\n}\n</code></pre>\n"}], "owner": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 56773320, "answer_count": 2, "score": 5, "last_activity_date": 1561743326, "creation_date": 1561538882, "last_edit_date": 1561553469, "question_id": 56768780, "link": "https://stackoverflow.com/questions/56768780/is-there-an-attribute-to-tell-the-compiler-to-ignore-a-missing-return-statement", "title": "Is there an attribute to tell the compiler to ignore a missing return statement?", "body": "<p>I don't believe this is a duplicate because the function <em>does</em> return in the happy path. Using the attribute <code>no-return</code> allows the compiler to optimise on the assumption that the function never returns, which is not the case here.</p>\n\n<p>I have come C code that either returns a pointer or calls another function to exit out of the program. This is in an <code>if</code> statement, so either it returns the result or exits. As the function returns a <code>void *</code>, the compiler warns that it's possible the function won't return a value (which is of course true):</p>\n\n<p><code>error: control reaches end of non-void function [-Werror=return-type]</code></p>\n\n<p>I can get around this by just adding <code>return *temp;</code> to the end of the function but I'd like to be clear in my intent by having something like the unused variable attribute:</p>\n\n<p><code>__attribute__((__unused__))</code></p>\n\n<p>That way I can leave <code>-Wall</code> on and not have to add unnecessary or possibly confusing code.</p>\n\n<p>I'd also be up for rewriting the code if there's a better way to express this intent.</p>\n\n<p>The code looks something like:</p>\n\n<pre><code>void *get_memory() {\n    void *temp = malloc(100);\n    if (temp) {\n        // do some setup work\n        return temp;\n    } else {\n        exit_program_with_epic_fail();\n    }\n    // Compiler warns if the following line isn't present\n    return temp;\n}\n</code></pre>\n"}, {"tags": ["c", "arduino", "lcd"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1561546562, "post_id": 56768705, "comment_id": 100097717, "body": "Are the pins <code>SCK</code> and <code>SDA</code> set up as outputs and connected accordingly?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1561595993, "post_id": 56768705, "comment_id": 100119795, "body": "You&#39;d be better off asking on the Arduino stack exchange; include the relevant portion of the schematic."}, {"owner": {"reputation": 389, "user_id": 2644315, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5AWB7.jpg?s=128&g=1", "display_name": "Xerix", "link": "https://stackoverflow.com/users/2644315/xerix"}, "edited": false, "score": 0, "creation_date": 1561596667, "post_id": 56768705, "comment_id": 100119901, "body": "Yes, I moved the question also to there... I leave it here for a case."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1564737142, "post_id": 56768705, "comment_id": 101137092, "body": "@Xerix I think it is better to leave the old question as it was, instead ask a new question about the LWP get problem. In this way, the comments above does not become misplaced."}], "owner": {"reputation": 389, "user_id": 2644315, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5AWB7.jpg?s=128&g=1", "display_name": "Xerix", "link": "https://stackoverflow.com/users/2644315/xerix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564739010, "creation_date": 1561538610, "last_edit_date": 1564739010, "question_id": 56768705, "link": "https://stackoverflow.com/questions/56768705/controlling-uc1638-graphical-lcd-screen-c-with-arduino", "title": "Controlling UC1638 Graphical LCD screen (C, with Arduino)", "body": "<p>I am using Arduino Uno, trying to control LCD screen type UC1638 (240x128 monochrome) I want to fillup the screen in black). Searching up the internet I ended up using this code (written in C):</p>\n\n<pre><code>/* The below source code is from the LCD manufacturer, when he has no\n   idea about Arduino, this is translated from code he gave me for AVR\n   - I assume \"sbit\" is just Arduino GPIO settings, so I changed them\n   here accordingly - but I am not sure if it is the correct settings I\n   shall use for the LCD screen via Arduino\n */\n\n#include \"stdio.h\"\n#include \"stdlib.h\"\n\n//sbit RST = P3^1;\n//sbit CD  = P3^0;  \n//sbit SCK = P1^0; //WRB=WR0\n//sbit SDA = P1^1; //RDB=WR1\n//sbit CS = P3^2;\n\nvoid writei(unsigned char Cbyte)\n{\n    unsigned char i;\n    digitalWrite(11, LOW); //CS=0;\n    digitalWrite(12, LOW); //CD=0;\n    for(i=0;i&lt;8;i++) {\n         digitalWrite(SCK, LOW); // SCK=0;\n         digitalWrite(SDA, Cbyte&amp;0x80?HIGH:LOW); // SDA=Cbyte&amp;0x80?1:0;\n         digitalWrite(SCK, HIGH); // SCK=1;\n         Cbyte=Cbyte&lt;&lt;1;\n    }\n    digitalWrite(11, HIGH); // CS=1;\n}\n\nvoid writed(unsigned char Dbyte) { \n    unsigned char i;\n    digitalWrite(11, LOW); //CS=0;\n    digitalWrite(12, HIGH); //CD=1;    \n    for(i=0;i&lt;8;i++) {\n        digitalWrite(SCK, LOW); // SCK=0;\n        digitalWrite(SDA, Dbyte&amp;0x80?HIGH:LOW); // SDA=Dbyte&amp;0x80?1:0;\n        digitalWrite(SCK, HIGH); // SCK=1;\n\n        Dbyte=Dbyte&lt;&lt;1;    \n    }\n    digitalWrite(11, HIGH);  // CS=1; \n}\n\nvoid DelayMS(unsigned int MS)\n{\n    unsigned char us,usn;\n    while(MS!=0)\n    {\n         usn=2;\n         while(usn!=0) { us=0xf6; while(us!=0){us--;}; usn--; }\n         MS--;\n    }\n}\n\nvoid LCD_INIT(void) {\n\n    //writei(0xe3);//system reset\n    digitalWrite(13, LOW); // RST=0;\n    DelayMS(10); //1ms\n\n    digitalWrite(13, HIGH); // RST=1;\n    DelayMS(500);//Delay more than 150ms.\n\n    writei(0xe1);//system reset\n    writed(0xe2);\n\n    DelayMS(2);\n    writei(0x04);//set column Address\n    writed(0x00);// \n\n    //writei(0x2f);// internal VLCD\n    //writei(0x26);// TC\n    writei(0xEb);//set bias=1/12\n    writei(0x81);//set vop\n    writed(90);//  pm=106 Set VLCD=15V\n\n    writei(0xb8);//\u5c4f\u853dMTP\n    writed(0x00);\n\n    writei(0xC4);//set lcd mapping control\n    //writei(0x00);   //MY  MX 0\n\n    writei(0xA3);//set line rate  20klps\n    writei(0x95);  // PT0   1B P P\n    //writei(90);\n\n    writei(0xf1);   //set com end\n    writed(159);    //set com end   240*128\n\n    writei(0xC2);\n    writei(0x31);   //APC\n    writed(0X91);    // 1/0: sys_LRM_EN disable\n    writei(0xc9);\n    writed(0xad);  //  display \n}\nvoid setWindowsProgame()     //com36--160  seg51--205\n{\n    writei(0x04);   //colum  \n    writed(0x00);\n    writei(0x60);    //page     \n    writei(0x70);   \n    writei(0xf4);\n    writed(0);        //startx  \n    writei(0xf6);\n    writed(239);      //endx   \n    writei(0xf5);  \n    writed(0);        //    \n    writei(0xf7);\n    writed(15);      //endy    PANGE  16\u9875\n    writei(0xf9);  //\u7a97\u53e3\u529f\u80fd\u5f00 \n    writei(0xC4);//set lcd mapping control\n}\nvoid display_black(void)\n{\n    int i,j,k;\n    setWindowsProgame();\n    for(i=0;i&lt;240;i++) {\n        for(j=0;j&lt;18;j++) { writei(0x01); writed(0xff); }\n    }\n}  \nvoid display_wirte ()\n{\n    int i,j,k;\n    setWindowsProgame();\n    for(i=0;i&lt;240;i++) {\n        for(j=0;j&lt;18;j++) { writei(0x01); writed(0x00); }\n    }\n}\nvoid display_pic()\n{      \n    int i,j,K;\n    char d; \n    setWindowsProgame();\n    i=0; \n    K=0;\n    for(i=0;i&lt;240*16;i++)   //240*144\n    {\n        writei(0x01);\n        d=0xff; //d=PIC[K++];\n        writed(d);\n    }\n}\n\nvoid setup() {\n    // IO declaration: (GPIO setup)\n    pinMode(12, OUTPUT); // CD\n    pinMode(13, OUTPUT); // RST (RW)\n    pinMode(11, OUTPUT); // CS\n    pinMode(SCK, OUTPUT);\n    pinMode(SDA, OUTPUT);\n    LCD_INIT();\n}\n\nvoid loop(){\n    display_pic(); // Fill-up the screen in black\n}\n</code></pre>\n\n<p>Notes:</p>\n\n<ol>\n<li>The screen is 240*128 monochrome pixels.</li>\n<li>Chip is UC1638</li>\n<li>I am using Arduino Uno (if it helps regarding the available GPIOs)</li>\n<li>I know about the \"LiquidCrystal\" library, but the examples gaven to me till now are for text screen of 16*2, not graphical screen - I believe that the GPIOs are completely different.</li>\n</ol>\n\n<p>I want to \"paint\" the screen in black: Though the compilation passes OK, the LCD screen seems empty (transparent), but it has power - What I am doing wrong?</p>\n\n<p>Thanks a lot</p>\n\n<p>EDIT:\n* I added SCK+SDA pins mark as output - Though I believe pins connected OK, the result is still the same. If the code is OK, then I will double check my pins...</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1561539253, "post_id": 56768631, "comment_id": 100093426, "body": "Will you please copy/paste the error message? It will help a lot in finding out what the problem is."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1561539449, "post_id": 56768631, "comment_id": 100093563, "body": "Also, please provide us a compilable and executable code, in order to be able to understand what is not OK. We do not need the confidential information in the code, but just what is needed for us to understand."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561539761, "post_id": 56768631, "comment_id": 100093741, "body": "What happens when you step through the program with a debugger?  (And being able to step through a program with a debugger is just <b>another</b> reason why stuffing everything into one line of code like <code>if((*digest = (unsigned char *)OPENSSL_malloc(EVP_MD_size(EVP_sha1()))) == NULL)</code> is a really <b>BAD</b> idea. Given your code, you simply can not tell if a call to <code>EVP_MD_size()</code> or <code>EVP_sha1()</code> ever failed.)"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 11557224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d92aa637ac6a0d12ab257da00f311db2?s=128&d=identicon&r=PG&f=1", "display_name": "Detlef7able", "link": "https://stackoverflow.com/users/11557224/detlef7able"}, "edited": false, "score": 0, "creation_date": 1561539292, "post_id": 56768843, "comment_id": 100093458, "body": "I have a bin file and i want to compare something so hex is helpful. The function digest_message gives dlen the value."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "reply_to_user": {"reputation": 71, "user_id": 11557224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d92aa637ac6a0d12ab257da00f311db2?s=128&d=identicon&r=PG&f=1", "display_name": "Detlef7able", "link": "https://stackoverflow.com/users/11557224/detlef7able"}, "edited": false, "score": 0, "creation_date": 1561546736, "post_id": 56768843, "comment_id": 100097811, "body": "OK, but the buffer is longer than 1 character, I assume. That <code>printf()</code> only prints 1 hex code."}], "tags": [], "owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "is_accepted": false, "score": -1, "last_activity_date": 1561546836, "last_edit_date": 1561546836, "creation_date": 1561539097, "answer_id": 56768843, "question_id": 56768631, "link": "https://stackoverflow.com/questions/56768631/problem-with-memory-access-error-in-c-with-char/56768843#56768843", "title": "Problem with memory access error in C with char*", "body": "<p>I can spot the following (potential) problems.</p>\n\n<hr>\n\n<blockquote>\n  <p>I can run a c programm without problems on my Linux Mint</p>\n</blockquote>\n\n<p>I think that it is just a happy coincidence, that you do not <strong>see</strong> the problems.</p>\n\n<hr>\n\n<pre><code>const unsigned char *message= (const unsigned char*) decryptedtext;\n</code></pre>\n\n<p>If <code>decryptedtext</code> is just a pointer, then accessing it further using <code>message</code> is quite a bad idea. Normally, you should have memory allocated, in order to access it.</p>\n\n<hr>\n\n<pre><code>size_t mlen=x;\n</code></pre>\n\n<p>Ideally, <code>mlen</code> should be related to the length of <code>message</code>. If <code>mlen</code> is bigger then the real length of <code>message</code>, you are in trouble (buffer overflow, memory corruption...).</p>\n\n<hr>\n\n<pre><code>unsigned int dlen;\n</code></pre>\n\n<p>How do you make sure that <code>dlen</code> is not bigger than the number of entries available in <code>digest</code>?</p>\n\n<hr>\n\n<pre><code>printf(\"%x \",digest[i]);\n</code></pre>\n\n<p>Why do you want to <code>printf</code> a string (<code>digest</code>) as a hexadecimal number?</p>\n\n<h2>---------------------</h2>\n\n<pre><code>if(decryptedtext[0]==0x25 &amp;&amp;   //%\n    decryptedtext[1]==0x50 &amp;&amp;  //P\n    decryptedtext[2]==0x44 &amp;&amp;  //D\n    decryptedtext[3]==0x46)    //F\n{ printf(\"%s\",decryptedtext);\n  break;\n}\n</code></pre>\n\n<p>This is ugly. <code>decryptedtext</code> is not a null-terminated string, therefore <code>printf()</code> will not print only 4 characters.</p>\n\n<hr>\n\n<pre><code>int x;\nf = fopen(\"test.pdf\", \"w+b\");\nif(f == NULL) {\nprintf(\"Datei konnte nicht geoeffnet werden.\\n\");\n}else {\n\nwhile(x&lt;decryptedtext_len)  {\n    putc(decryptedtext[x],f);\n    x++;\n}\n</code></pre>\n\n<p><code>x</code> is not initialized before being used.</p>\n\n<hr>\n\n<pre><code>unsigned char hasharrayone[20];\nunsigned char hasharraytwo[20];\nunsigned char hasharraythree[20];\n</code></pre>\n\n<p>You could have used:</p>\n\n<pre><code>unsigned char hasharray[3][20];\n</code></pre>\n\n<hr>\n\n<pre><code>int xc;\nfile = fopen(\"sxxxxx-dest-cipher.bin\", \"w+b\");\nif(file == NULL) {\nprintf(\"Datei konnte nicht geoeffnet werden.\\n\");\n}else {\nwhile(xc&lt;cpl)  {\n    putc(cfbciphertext[xc],file);\n    xc++;\n}\n</code></pre>\n\n<p><code>xc</code> is not initialized.</p>\n"}, {"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1561545832, "post_id": 56770059, "comment_id": 100097289, "body": "Because of default argument promotions that happen to arguments passed to the variable argument list, the  rvalue <code>digetst[i]</code> is implicitly converted from <code>unsigned char</code> to <code>int</code>. Because of this <code>%x</code> should work <a href=\"https://en.cppreference.com/w/c/language/conversion#Default_argument_promotions\" rel=\"nofollow noreferrer\">cppreference</a>"}, {"owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561549431, "post_id": 56770059, "comment_id": 100099456, "body": "@KamilCuk Good point didn&#39;t know about it. Though, <code>digetst[i]</code> refers to a part of the memory so it should not be an rvalue but an lvalue, am I wrong ? Is there any possibility this fact change anything ? I mean... Is it possible to implicitely type convert an lvalue ?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1561549935, "post_id": 56770059, "comment_id": 100099756, "body": "C doesn&#39;t really have any distinction between &quot;lvalue&quot; and &quot;rvalue&quot;. &quot;lvalue&quot; is just an expression that can be assigned to. &quot;rvalue&quot; means just a &quot;value of an expression&quot;. In C++ there happens something called &quot;lvalue to rvalue conversion&quot; and some other magic, in C it&#39;s more or less meaningless. In C &quot;rvalue&quot; is more like a jargon. The <code>digest[i]</code> is an lvalue, for sure, cause the <code>*</code> operator. I meant to say &quot;rvalue&quot; only meaning &quot;the value of the <code>digest[i]</code> expression&quot;. The only place &quot;rvalue&quot; term is ever used in C is only <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note64\" rel=\"nofollow noreferrer\">in a note</a>."}], "tags": [], "owner": {"reputation": 473, "user_id": 11502610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbf986a3bd7cf5ca22ae39a8fbabfe0b?s=128&d=identicon&r=PG&f=1", "display_name": "DrosvarG", "link": "https://stackoverflow.com/users/11502610/drosvarg"}, "is_accepted": false, "score": -1, "last_activity_date": 1561543560, "last_edit_date": 1561543560, "creation_date": 1561543157, "answer_id": 56770059, "question_id": 56768631, "link": "https://stackoverflow.com/questions/56768631/problem-with-memory-access-error-in-c-with-char/56770059#56770059", "title": "Problem with memory access error in C with char*", "body": "<p>You have an undefined behavior using <code>printf(\"%x \", digest[i])</code>.</p>\n\n<p>As mentionned in <a href=\"https://stackoverflow.com/a/16864590/11502610\">this answer</a> using the wrong format specifier results in an undefined behavior. This is probably why the behavior of your program depends on the OS you are running on (it may also depend of your hardware and compiler).</p>\n\n<p>As I don't have the error message, it's hard to know what happens in your case, but as \"%x\" format specifier usually works with <code>unsigned int</code> it should reads 4bytes in memory. As <code>disgest[i]</code> is a <code>unsigned char</code>, it is written on 1byte only and this is probably why you get a memory access error.</p>\n\n<p>Converting your <code>unsigned char</code> variable <code>digest[i]</code> to an <code>unsigned int</code> before using <code>printf</code> should resolve your issue. </p>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/8060170/printing-hexadecimal-characters-in-c\">this topic</a> should help you printing hexadecimal characters</p>\n"}], "owner": {"reputation": 71, "user_id": 11557224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d92aa637ac6a0d12ab257da00f311db2?s=128&d=identicon&r=PG&f=1", "display_name": "Detlef7able", "link": "https://stackoverflow.com/users/11557224/detlef7able"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561546836, "creation_date": 1561538339, "last_edit_date": 1561539079, "question_id": 56768631, "link": "https://stackoverflow.com/questions/56768631/problem-with-memory-access-error-in-c-with-char", "title": "Problem with memory access error in C with char*", "body": "<p>I can run a c programm without problems on my Linux Mint system on a other Linux system I get a memory access error.</p>\n\n<pre><code>void digest_message(const unsigned char *message, size_t message_len, unsigned char **digest, unsigned int *digest_len)\n{\n    EVP_MD_CTX *mdctx;\n\n    if((mdctx = EVP_MD_CTX_create()) == NULL)\n        handleErrors();\n    if(1 != EVP_DigestInit_ex(mdctx, EVP_sha1(), NULL))\n        handleErrors();\n    if(1 != EVP_DigestUpdate(mdctx, message, message_len))\n        handleErrors();\n    if((*digest = (unsigned char *)OPENSSL_malloc(EVP_MD_size(EVP_sha1()))) == NULL)\n        handleErrors();\n    if(1 != EVP_DigestFinal_ex(mdctx, *digest, digest_len))\n        handleErrors();\n\n    EVP_MD_CTX_destroy(mdctx);\n}\n\nvoid main ()\n\n{\n...\n    const unsigned char *message= (const unsigned char*) decryptedtext;\n    size_t mlen=x;\n    unsigned char *digest;\n    unsigned int dlen;\n    digest_message(message,mlen,&amp;digest,&amp;dlen);\n\n    // if i printf in a for loop i get this memmory access error \n    for(int i=0;i&lt;dlen;i++)\n        printf(\"%x \",digest[i]);\n    }\n\n</code></pre>\n\n<p>I tried it with:</p>\n\n<pre><code>printf(\"%x \",digest[0]);\nprintf(\"%x \",digest[1]);\nprintf(\"%x \",digest[2]);\n...\n</code></pre>\n\n<p>and got no error</p>\n\n<p>Why does this happen? How can I change it?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "lua", "config"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 2, "creation_date": 1561537350, "post_id": 56767550, "comment_id": 100092351, "body": "You need an event loop that listens for the file being changed on disk.  On Linux you can use <a href=\"http://man7.org/linux/man-pages/man7/inotify.7.html\" rel=\"nofollow noreferrer\"><code>inotify</code></a>."}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 1, "creation_date": 1561545371, "post_id": 56767550, "comment_id": 100097051, "body": "Please specify your operating system."}, {"owner": {"reputation": 163, "user_id": 703524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b4c1b9fad936821590633abb2f4e816?s=128&d=identicon&r=PG", "display_name": "Wei Huang", "link": "https://stackoverflow.com/users/703524/wei-huang"}, "reply_to_user": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1561547175, "post_id": 56767550, "comment_id": 100098083, "body": "@DirkHorsten It&#39;s Linux. Will different operating systems have different solutions?"}, {"owner": {"reputation": 501, "user_id": 5113346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T0l4z.png?s=128&g=1", "display_name": "Alundaio", "link": "https://stackoverflow.com/users/5113346/alundaio"}, "edited": false, "score": 1, "creation_date": 1561609473, "post_id": 56767550, "comment_id": 100122067, "body": "Just execute the *.lua again in same environment, it will overwite. Config is usually something that persists in memory. When changes are made or application exits it is written to disk. If you want to reload when a file is modified, do you want a lua solution or a C solution? For lua, lfs will work. I suggest luamarshal to serialize a table and write it to disk for persistent storage which works for functions and userdata. Alternatively you can change a print table function to write to disk: <a href=\"https://stackoverflow.com/a/42062321/5113346\">stackoverflow.com/a/42062321/5113346</a> (ie. return { ... })"}, {"owner": {"reputation": 163, "user_id": 703524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b4c1b9fad936821590633abb2f4e816?s=128&d=identicon&r=PG", "display_name": "Wei Huang", "link": "https://stackoverflow.com/users/703524/wei-huang"}, "reply_to_user": {"reputation": 501, "user_id": 5113346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T0l4z.png?s=128&g=1", "display_name": "Alundaio", "link": "https://stackoverflow.com/users/5113346/alundaio"}, "edited": false, "score": 0, "creation_date": 1562034788, "post_id": 56767550, "comment_id": 100240582, "body": "@Alundaio Can your first sentence &quot;Just execute the *.lua again in same environment, it will overwite.&quot; answer the basic question I raised above? The new function definition takes effect as soon as the *.lua is executed again?"}], "owner": {"reputation": 163, "user_id": 703524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b4c1b9fad936821590633abb2f4e816?s=128&d=identicon&r=PG", "display_name": "Wei Huang", "link": "https://stackoverflow.com/users/703524/wei-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1561632333, "creation_date": 1561534449, "last_edit_date": 1561632333, "question_id": 56767550, "link": "https://stackoverflow.com/questions/56767550/can-a-config-file-written-in-lua-be-hot-reloaded-by-my-c-program", "title": "Can a config file written in lua be hot reloaded by my C program?", "body": "<p>I'm trying to embed Lua in my C program to extend the program's debugability. \nLua tutorials describe how to use Lua as a config file. In the config file, Lua variables, or even functions can be defined, so a C program can load the file and use the Lua functions to extend some of its ability.</p>\n\n<p>However, if the config file is modified after it's loaded, the new content won't take effect. My question is how to support hot reload without restarting my C program?</p>\n\n<p>Edit:\nA more basic question: since the Lua functions/variables has been loaded, can they be overwritten? for example, the C program has been calling <code>function f1(x) return x*x end</code> in a loop, then the function is changed to be <code>function f1(x) return x*x*x end</code> in the config file. If we can hot reload it in some way, will the C program use the new definition?</p>\n"}, {"tags": ["c", "colors", "gtk"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11702143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/790d0eca1def341b776ef5e1979ffa46?s=128&d=identicon&r=PG&f=1", "display_name": "penghsl", "link": "https://stackoverflow.com/users/11702143/penghsl"}, "is_accepted": true, "score": 2, "last_activity_date": 1561540873, "creation_date": 1561540873, "answer_id": 56769351, "question_id": 56767206, "link": "https://stackoverflow.com/questions/56767206/how-can-i-change-the-field-background-color-in-gtk2-entry/56769351#56769351", "title": "How can I change the field background color in Gtk2 entry?", "body": "<p>Try gtk_widget_modify_base:</p>\n\n<pre><code>GdkColor color = {0, 255&lt;&lt;8, 220&lt;&lt;8, 220&lt;&lt;8};\ngtk_widget_modify_base(GTK_WIDGET(entry), GTK_STATE_NORMAL, &amp;color);\n</code></pre>\n"}], "owner": {"reputation": 626, "user_id": 5352476, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/9qaA3.jpg?s=128&g=1", "display_name": "Cool Javelin", "link": "https://stackoverflow.com/users/5352476/cool-javelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 1, "accepted_answer_id": 56769351, "answer_count": 1, "score": 0, "last_activity_date": 1561540873, "creation_date": 1561533277, "question_id": 56767206, "link": "https://stackoverflow.com/questions/56767206/how-can-i-change-the-field-background-color-in-gtk2-entry", "title": "How can I change the field background color in Gtk2 entry?", "body": "<p>GTK+ v2 in C using Code::Blocks on Win7.</p>\n\n<p>I am using the \"insert_text\" signal for a callback to an entry widget.</p>\n\n<p>Inside the callback function, how do I change the entry field background color?</p>\n\n<p>I think this is not the same as changing the widget color.</p>\n\n<p>My code:</p>\n\n<p>The Callback...</p>\n\n<pre><code>static void VerifyDOW (GtkEntry    *entry,\n                          const gchar *text,\n                          gint         length,\n                          gint        *position,\n                          gpointer     data)\n{\nGtkEditable *editable = GTK_EDITABLE(entry);\nconst gchar *result = gtk_editable_get_chars (editable, 0, -1); // = g_new (gchar, length);\nint i, count = strlen(result);\n\n    for (i=0; i &lt; count; i++) {\n        if ((! isdigit(result[i])) &amp; (result[i] != ',')) {\n            i = count;\n            g_signal_handlers_block_by_func (G_OBJECT (editable), G_CALLBACK (VerifyDOW), data);\n\n            /* CHANGE FIELD, NOT WIDGET, COLOR HERE */\n\n            g_signal_handlers_unblock_by_func (G_OBJECT (editable), G_CALLBACK (VerifyDOW), data);\n        }\n    }\n    g_signal_stop_emission_by_name (G_OBJECT (editable), \"insert_text\");\n    g_free (result);\n}\n</code></pre>\n\n<p>Now in Main()...</p>\n\n<pre><code>        entry = gtk_entry_new();\n        gtk_widget_set_tooltip_text (entry, \"Valid input, 1..7 and ,\");\n        gtk_entry_set_text(GTK_ENTRY(entry), \"1,3,5\");\n\n        g_signal_connect(G_OBJECT(entry), \"insert_text\", g_CALLBACK(VerifyDOW), NULL);\n\n        gtk_table_attach(GTK_TABLE(table), entry...\n</code></pre>\n\n<p>Thanks, Mark.</p>\n"}, {"tags": ["c", "swift", "callback", "function-pointers"], "comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1561533093, "post_id": 56766928, "comment_id": 100090214, "body": "What are you trying to simplify? The <code>(UnsafeMutablePointer&lt;UInt8&gt;?, UInt8, UnsafeMutablePointer&lt;UInt8&gt;?)-&gt;error_t</code> part of the Swift function declaration? What do you expect the simplified code to look like?"}, {"owner": {"reputation": 284, "user_id": 1149188, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1483c440dda5157cae3337c166bb53d9?s=128&d=identicon&r=PG", "display_name": "LPG", "link": "https://stackoverflow.com/users/1149188/lpg"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1561535225, "post_id": 56766928, "comment_id": 100091309, "body": "I want to declare it C-style. See edited question."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 1, "creation_date": 1561535905, "post_id": 56766928, "comment_id": 100091650, "body": "I don&#39;t think that is possible in pure Swift. But you can add <code>typedef typeof(cFunction) cFunctionType;</code> to the C header file, and then define <code>func callcFunction(_ cFunctionAsParameter: cFunctionType) { ... }</code> in Swift."}, {"owner": {"reputation": 284, "user_id": 1149188, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1483c440dda5157cae3337c166bb53d9?s=128&d=identicon&r=PG", "display_name": "LPG", "link": "https://stackoverflow.com/users/1149188/lpg"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1561618281, "post_id": 56766928, "comment_id": 100125002, "body": "Excellent! That would be an acceptable answer to the original question. However I have one more problem which I did not mention so far: There is more than one C-function, and in addition to the parameters mentioned above, they have one more parameter, whose type varies (float, int, ...). With the explicit code, I can handle that using Swift&#39;s generics &lt;T&gt;. The typedef obviously cannot deal with that."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1561619066, "post_id": 56766928, "comment_id": 100125383, "body": "I suggest to update your question with a concrete example."}, {"owner": {"reputation": 284, "user_id": 1149188, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1483c440dda5157cae3337c166bb53d9?s=128&d=identicon&r=PG", "display_name": "LPG", "link": "https://stackoverflow.com/users/1149188/lpg"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1561626860, "post_id": 56766928, "comment_id": 100129641, "body": "Did so. I suggest you convert your second comment into an answer, so I can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1561627383, "creation_date": 1561627383, "answer_id": 56787910, "question_id": 56766928, "link": "https://stackoverflow.com/questions/56766928/mixing-swift-and-c-how-to-declare-c-function-as-a-parameter-in-swift-function-t/56787910#56787910", "title": "Mixing Swift and C: how to declare C-function as a parameter in Swift function the easiest way", "body": "<p>I am not aware of a pure Swift solution. In the case of a single function you can define a type alias in the C header file</p>\n\n<pre><code>typedef typeof(cFunction) cFunctionType; \n</code></pre>\n\n<p>so that the Swift function declaration simplifies to</p>\n\n<pre><code>func callcFunction(_ cFunctionAsParameter: cFunctionType) { ... }\n</code></pre>\n"}], "owner": {"reputation": 284, "user_id": 1149188, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1483c440dda5157cae3337c166bb53d9?s=128&d=identicon&r=PG", "display_name": "LPG", "link": "https://stackoverflow.com/users/1149188/lpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 56787910, "answer_count": 1, "score": 1, "last_activity_date": 1561627383, "creation_date": 1561532255, "last_edit_date": 1561626808, "question_id": 56766928, "link": "https://stackoverflow.com/questions/56766928/mixing-swift-and-c-how-to-declare-c-function-as-a-parameter-in-swift-function-t", "title": "Mixing Swift and C: how to declare C-function as a parameter in Swift function the easiest way", "body": "<p>Using Swift 5 (and possibly even earlier), I can easily call C functions from Swift without much ado:</p>\n\n<pre><code>// C function:\n    error_t cFunction(uint8_t * const outputBuffer, uint8_t const outputBufferMaxSize, uint8_t * const outputBufferUsedBytes);\n\n// called from Swift:\n        let outputBufferMaxSize: UInt8 = 10\n        var outputBuffer = [UInt8](repeating: 0, count: Int(outputBufferMaxSize))\n        var outputBufferUsedBytes: UInt8 = 0 \n\n        let err = cFunction(&amp;outputBuffer, outputBufferMaxSize, &amp;outputBufferUsedBytes);\n</code></pre>\n\n<p>The bridging works completely automatic.</p>\n\n<p>Now I want to pass the cFunction to another Swift-func (like a function pointer in C). This only seems to work when I manually perform the translation:</p>\n\n<pre><code>// Swift function with C-style function as parameter\n    func callcFunction(_ cFunctionAsParameter:(UnsafeMutablePointer&lt;UInt8&gt;?, UInt8, UnsafeMutablePointer&lt;UInt8&gt;?)-&gt;error_t) {\n                let outputBufferMaxSize: UInt8 = 10\n                var outputBuffer = [UInt8](repeating: 0, count: Int(outputBufferMaxSize))\n                var outputBufferUsedBytes: UInt8 = 0 \n\n                let err = cFunctionAsParameter(&amp;outputBuffer, outputBufferMaxSize, &amp;outputBufferUsedBytes);\n\n        }\n\n    callcFunction(cFunction)\n</code></pre>\n\n<p>This works, but I have to figure out the UnsafeMutablePointer-logic manually. In fact, if you simply put garbage in the callcFunction declaration, the compiler will spit out an error message telling you the exactly right syntax.</p>\n\n<p>So is there a way to avoid manually doing this declaration?\nLike, declaring it using original C style </p>\n\n<pre><code>error_t (* cFunctionAsParameter) (uint8_t * const, uint8_t const, uint8_t * const) \n</code></pre>\n\n<p>(the above should somehow go into the parameter list of the Swift function declaration) and have the compiler figure out the UnsafeMutablePointer stuff itself, like it does in the first example?</p>\n\n<p><strong>Extended question:</strong> </p>\n\n<p>To make matters more complicated, let there be several C functions that differ in the type of an additional single parameter (the first one):</p>\n\n<pre><code>error_t cFunctionFloat(float value, uint8_t * const outputBuffer, uint8_t const outputBufferMaxSize, uint8_t * const outputBufferUsedBytes);\nerror_t cFunctionInt(int value, uint8_t * const outputBuffer, uint8_t const outputBufferMaxSize, uint8_t * const outputBufferUsedBytes);\n</code></pre>\n\n<p>which can be used in Swift with the following single declaration:</p>\n\n<pre><code>func callcFunction&lt;T&gt;(_ cFunctionAsParameter:(T, UnsafeMutablePointer&lt;UInt8&gt;?, UInt8, UnsafeMutablePointer&lt;UInt8&gt;?)-&gt;error_t){ ... }\n</code></pre>\n\n<p>Again, it would be nice to have the compiler infer the \"translation\" automatically.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1561530391, "post_id": 56766433, "comment_id": 100088947, "body": "It&#39;s going to occupy 20. How would it know that you&#39;re not going to use the rest?"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1561530533, "creation_date": 1561530533, "answer_id": 56766494, "question_id": 56766433, "link": "https://stackoverflow.com/questions/56766433/how-much-memory-space-does-an-array-takes-if-the-maximum-size-that-is-declared/56766494#56766494", "title": "&quot;How much memory space does an array takes if the maximum size that is declared is not used?&quot;", "body": "<p>Unless it's a <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">VLA</a>, array size is a compile time constant, so it does not matter how much memory you're actually <em>using</em>, it will take up the amount of memory same as the size of the array given at the time of definition.</p>\n\n<p>In other words, an array defined like</p>\n\n<pre><code> int arr[20] = {0};\n</code></pre>\n\n<p>is going to occupy the memory for size of 20 <code>int</code> elements, i.e., the size of the array would be <code>int [20]</code>.</p>\n\n<p>You can check the size occupied by running</p>\n\n<pre><code> int arr[20] = {0};\n printf (\"size of the array: %zu\", sizeof (arr));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1561542362, "post_id": 56766944, "comment_id": 100095202, "body": "There is at least one common case when it may be less: when the compiler decides it can eliminate the array entirely (when nothing depends on the contents of the array)."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1561552817, "last_edit_date": 1561552817, "creation_date": 1561532300, "answer_id": 56766944, "question_id": 56766433, "link": "https://stackoverflow.com/questions/56766433/how-much-memory-space-does-an-array-takes-if-the-maximum-size-that-is-declared/56766944#56766944", "title": "&quot;How much memory space does an array takes if the maximum size that is declared is not used?&quot;", "body": "<p>As far as you are concerned it's going to be 20.</p>\n\n<p>The <em>as-if</em> rule allows it to be less than 20 or even compiled out altogether, although I don't know of a compiler that would exploit the former even if elements of the array were accessed with only compile-time evaluable indexing.</p>\n\n<p>Note that <code>sizeof array / sizeof element</code> would have to return 20 which further complicates matters.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11346411, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UjTUczF_F1Y/AAAAAAAAAAI/AAAAAAAAAjU/ATtHNugM1yk/photo.jpg?sz=128", "display_name": "Prateek Sharma", "link": "https://stackoverflow.com/users/11346411/prateek-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1561545283, "last_edit_date": 1561545283, "creation_date": 1561533376, "answer_id": 56767236, "question_id": 56766433, "link": "https://stackoverflow.com/questions/56766433/how-much-memory-space-does-an-array-takes-if-the-maximum-size-that-is-declared/56767236#56767236", "title": "&quot;How much memory space does an array takes if the maximum size that is declared is not used?&quot;", "body": "<p>It will occupy 20.</p>\n\n<p>The compiler will allocate the memory size of the array(here 20) at the compile time, and that memory can not be used by other data structures.Regardless of how much memory you actually use(here 9) , all the 20 blocks will be \"reserved\" for the array.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1561533752, "creation_date": 1561533752, "answer_id": 56767344, "question_id": 56766433, "link": "https://stackoverflow.com/questions/56766433/how-much-memory-space-does-an-array-takes-if-the-maximum-size-that-is-declared/56767344#56767344", "title": "&quot;How much memory space does an array takes if the maximum size that is declared is not used?&quot;", "body": "<p>You need to use dynamic memory allocation if you want to have runtime size sortable library. You can use VLAs but it is only limited to the automatic storage variables and it's size cannot be changed before exiting the scope. </p>\n\n<p>You can use malloc family functions allocating memory to the pointers which can be used same way as arrays (but for example you can't use sizeof method to determine the size of it)</p>\n"}], "owner": {"reputation": 21, "user_id": 11701284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T415UeYlWQ/AAAAAAAAAAI/AAAAAAAAFcM/7skQaF5Rfx4/photo.jpg?sz=128", "display_name": "Rishi Prakash", "link": "https://stackoverflow.com/users/11701284/rishi-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1561552817, "creation_date": 1561530281, "last_edit_date": 1561530677, "question_id": 56766433, "link": "https://stackoverflow.com/questions/56766433/how-much-memory-space-does-an-array-takes-if-the-maximum-size-that-is-declared", "title": "&quot;How much memory space does an array takes if the maximum size that is declared is not used?&quot;", "body": "<p>If I declare an array of size 20, and the number of value I will give is 9, so will the array occupy total of 20 size space in the memory or it will only occupy 9?</p>\n"}, {"tags": ["c", "unit-testing", "gnu", "autotools", "dejagnu"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561550060, "post_id": 56766267, "comment_id": 100099835, "body": "I haven&#39;t done this with DejaGnu myself, but my first guess would be that you&#39;re overthinking it.  <a href=\"https://www.gnu.org/software/automake/manual/html_node/Tests.html#Tests\" rel=\"nofollow noreferrer\">The usual Automake way</a> to designate test cases is to name them in the value of the <code>TESTS</code> variable in <code>Makefile.am</code>.  Any that need to be built, first, should also be named in <code>check_PROGRAMS</code>, and if needed, you can specifcy sources, build options, <i>etc</i>. for them in the same way as for any other target."}, {"owner": {"reputation": 4005, "user_id": 255577, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e18fc45b59d3fcdef1f75e41f8edf1e?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/255577/marc"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561554428, "post_id": 56766267, "comment_id": 100102560, "body": "The built-in functionality of Automake (parallel tests) is fine if every C program just contains one test as (without writing further scripts or using TAP) each Automake test in the <code>TESTS</code> variable counts as one test case (and not as a collection of tests)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561554722, "post_id": 56766267, "comment_id": 100102740, "body": "As I understand it, adding <code>dejagnu</code> to <code>AUTOMAKE_OPTIONS</code> causes DejaGnu to be used <i>instead of</i> the parallel test harness.  But I&#39;m only reading the docs here, having normally gone the other direction, myself.  The Automake manual does contain a few specifics about <a href=\"https://www.gnu.org/software/automake/manual/html_node/DejaGnu-Tests.html#DejaGnu-Tests\" rel=\"nofollow noreferrer\">how DejaGnu integration works</a>.  But it looks like you&#39;re right that <code>TESTS</code> is in fact not the right hook."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561555311, "post_id": 56766267, "comment_id": 100103145, "body": "Elements of the question that constitute requests for off-site resources are off-topic here, but it looks like Google turns up some promising resources with just &quot;dejagnu&quot; and &quot;autotools&quot; for search keywords.  Overall, I see no reason to doubt my initial assessment that no, you don&#39;t need to write glue code to connect a DejaGnu test suite to the makefile&#39;s &#39;check&#39; target in an Autotools build system."}, {"owner": {"reputation": 4005, "user_id": 255577, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e18fc45b59d3fcdef1f75e41f8edf1e?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/255577/marc"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561559309, "post_id": 56766267, "comment_id": 100105816, "body": "One can use DejaGnu in parallel to Automake&#39;s parallel test harness. Just create two subdirs, say <code>tests</code> and <code>testsuite</code>, which you reference in the top-level Makefile.am. Then put <code>AUTOMAKE_OPTIONS = dejagnu</code> on in <code>testsuite&#47;Makefile.am</code>. The <code>TESTS</code> variable continues to work normally in <code>tests&#47;Makefile.am</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561559477, "post_id": 56766267, "comment_id": 100105908, "body": "Fine, but I&#39;m saying that that does not appear to be the way that DejaGnu integration is <i>intended</i> to be done."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 466996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e80f2f7fc53295326a8c0c91a4497c?s=128&d=identicon&r=PG", "display_name": "Robert E. Menteer II", "link": "https://stackoverflow.com/users/466996/robert-e-menteer-ii"}, "is_accepted": false, "score": 0, "last_activity_date": 1605633406, "creation_date": 1605633406, "answer_id": 64880098, "question_id": 56766267, "link": "https://stackoverflow.com/questions/56766267/how-to-setup-unit-tests-with-dejagnu/64880098#64880098", "title": "How to setup unit tests with DejaGnu", "body": "<p>Using the pass/fail functions defined in dejagnu.h is only valid for batch tools for unit testing. What you need is a simple xx.exp file like the below:</p>\n<p>load_lib dejagnu.exp</p>\n<p>host_execute $srcdir/unit-code/unittest</p>\n"}], "owner": {"reputation": 4005, "user_id": 255577, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e18fc45b59d3fcdef1f75e41f8edf1e?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/255577/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1605633406, "creation_date": 1561529503, "question_id": 56766267, "link": "https://stackoverflow.com/questions/56766267/how-to-setup-unit-tests-with-dejagnu", "title": "How to setup unit tests with DejaGnu", "body": "<p>I'm trying to learn DejaGnu (<a href=\"https://www.gnu.org/software/dejagnu/\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/dejagnu/</a>) and would like to use it as a framework for unit tests for a C API. My build system is based on the Autotools.</p>\n\n<p>In a subdirectory of <code>./testsuite</code>, I have a number of C files, each of which includes <code>dejagnu.h</code> and uses its procedures to report passes and failures of some tests.</p>\n\n<p>In <code>./testsuite</code>, my <code>Makefile.am</code> has the line <code>AUTOMAKE_OPTIONS=dejagnu</code>, which causes <code>make check</code> to call DejaGnu's <code>runtest</code>.</p>\n\n<p>What I am missing now is some glue code (probably some Expect files) that lets <code>runtest</code> find my C files with the unit tests, executes them and collects the result.</p>\n\n<p>I'm looking for an explanation better than DejaGnu's description in its manual, an example setup or a link to some open source project that actually implements what I have in mind in its build system.</p>\n\n<p>(I am not asking for alternative tools. This is a question especially about DejaGnu.)</p>\n"}, {"tags": ["c", "opengl", "glfw", "opengl-4"], "comments": [{"owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1561531686, "post_id": 56766242, "comment_id": 100089517, "body": "You&#39;re using <a href=\"https://www.khronos.org/opengl/wiki/Legacy_OpenGL\" rel=\"nofollow noreferrer\">Legacy OpenGL</a>  so you&#39;ve to use a compatibility profile <a href=\"https://www.khronos.org/opengl/wiki/OpenGL_Context\" rel=\"nofollow noreferrer\">OpenGL Context</a> . <code>glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_COMPAT_PROFILE)</code>"}, {"owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1561531886, "post_id": 56766242, "comment_id": 100089616, "body": "Do <code>glViewport(0, 0, width, height);</code> <code>glLoadIdentity();</code> <code>glOrtho(0, width, 0, height, -1, 1);</code> once at the end of <code>init_glfw()</code>. Note, <code>glLoadIdentity();</code> should be done in <code>framebuffer_size_callback</code>, too."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1561532181, "post_id": 56766242, "comment_id": 100089749, "body": "Brilliant, thank you so much!!! Ok so that code is written in an older version of OpenGL, EXCELLENT!!! I&#39;ll have to get working on updating it to modern GL. Just out of curiosity: what was the smoking gun when you looked at the code? i.e. how did you know it was legacy?"}, {"owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1561532363, "post_id": 56766242, "comment_id": 100089829, "body": "Drawing by <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glBegin.xml\" rel=\"nofollow noreferrer\"><code>glBegin</code>/<code>glEnd</code></a> and fixed function matrix stack. Read about <a href=\"https://www.khronos.org/opengl/wiki/Vertex_Specification\" rel=\"nofollow noreferrer\">Vertex Specification</a> and <a href=\"https://www.khronos.org/opengl/wiki/Shader\" rel=\"nofollow noreferrer\">Shader</a> for a state of the art way of rendering."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1561534211, "post_id": 56766242, "comment_id": 100090771, "body": "Awesome, yeh I thought it was odd that there weren&#39;t any vertices or shaders in the code. Good to know. Thanks again!"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1561658510, "post_id": 56766242, "comment_id": 100147473, "body": "see my <a href=\"https://stackoverflow.com/a/56197067/2521214\">Can&#39;t find a way to color the Mandelbrot-set the way i&#39;m aiming for</a> ... In case you are a rookie see: <a href=\"https://stackoverflow.com/a/31913542/2521214\">complete GL+GLSL+VAO/VBO C++ example</a> to get started"}], "owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561531509, "creation_date": 1561529366, "last_edit_date": 1561531509, "question_id": 56766242, "link": "https://stackoverflow.com/questions/56766242/mandelbrot-set-in-opengl-c", "title": "Mandelbrot set in OpenGL - C", "body": "<p>I'm new to OpenGL and I am trying to get a mandelbrot set computed with OpenGL and GLFW. </p>\n\n<p>I found the code <a href=\"https://learnopengl.com/Getting-started/Textures\" rel=\"nofollow noreferrer\">here</a> but freeglut is broken on my system and for some reason complains about no callback being set even though it clearly is being set. It does however flash one frame and then crash, in that frame I can see the mandelbrot set so I know the math is correct. </p>\n\n<p>I figured this would be a good opportunity to learn more about OpenGL and GLFW, so I set to work making this happen. </p>\n\n<p>After double checking everything, I can see that it definitely calculates the values then switches the buffers properly.</p>\n\n<p>However, I think I'm missing two things: </p>\n\n<ol>\n<li>A vertex which the texture can actually be applied to </li>\n</ol>\n\n<p>EDIT: (from <a href=\"https://learnopengl.com/Getting-started/Textures\" rel=\"nofollow noreferrer\">learnopengl.com</a>) \"Once glTexImage2D is called, the currently bound texture object now has the texture image attached to it.\", so it can't be #2</p>\n\n<ol start=\"2\">\n<li>not sure what's happening with the calculation but it looks like it's binding a texture named 'texture' but then calculating the values in a struct array which don't seem to be associated in any way. I bind the texture with tex (texture) and then send the struct array to glTexImage2D</li>\n</ol>\n\n<p>If someone could just point me in the right direction or confirm my suspicions that would be awesome. </p>\n\n<p>My code is here:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;math.h&gt;\n\n    #define  GLEW_STATIC\n    #include &lt;GL/glew.h&gt;\n    #include &lt;pthread.h&gt;\n\n    #include &lt;GLFW/glfw3.h&gt;\n\n    #include &lt;GL/gl.h&gt;\n\n    #define VAL 255\n\n    typedef struct {\n      uint8_t r; \n      uint8_t g;\n      uint8_t b;\n    }rgb_t;\n\n    rgb_t **tex_array = 0;\n    rgb_t *image;\n    int gwin;\n    int width = 640;\n    int height = 480;\n    int tex_w, tex_h;\n    double scale = 1./256;\n    double cx = -.6, cy = 0;\n    int color_rotate = 0;\n    int saturation = 1;\n    int invert = 0;\n    int max_iter = 256;\n    int dump = 1;\n    GLFWwindow* window;\n    int global_iterator = 0;\n    int conversion_iterator_x = 0;\n    int conversion_iterator_y = 0;\n\n    GLFWwindow* init_glfw();\n    void set_texture(GLuint tex); \n    void framebuffer_size_callback(GLFWwindow* window, int width, int height);\n    void render(GLuint tex);\n    void screen_dump();\n    void keypress(unsigned char key, int x, int y);\n    void hsv_to_rgb(int hue, int min, int max, rgb_t *p);\n    void calc_mandel(rgb_t* px);\n    void alloc_texture();\n    void set_texture();\n    void mouseclick(int button, int state, int x, int y);\n    void resize(int w, int h);\n    void framebuffer_size_callback(GLFWwindow* window, int width, int height);\n\n\n    int main(int c, char **v)\n    {\n\n      GLFWwindow* win = init_glfw();\n      glfwSetWindowPos(win, 1000, 500);\n\n      GLuint texture;\n      glGenTextures(1, &amp;texture);\n      set_texture(texture);\n\n      /* Loop until the user closes the window */\n           while (!glfwWindowShouldClose(win))\n        {\n\n            render(texture);  \n\n            /* Swap front and back buffers */\n            glfwSwapBuffers(win);\n\n            /* Poll for and process events */\n            glfwPollEvents();\n\n            if(glfwGetKey(win, GLFW_KEY_ESCAPE) == GLFW_PRESS){\n               glfwSetWindowShouldClose(win, GL_TRUE);\n            }\n        }\n\n        return 0;\n    }\n\n\n    void set_texture(GLuint tex)\n    {\n      printf(\"Allocating space\\n\");\n        alloc_texture();\n      printf(\"Calculating mandel... %d\\n\", global_iterator);\n      ++global_iterator;\n        calc_mandel(image);\n      printf(\"mandel calculation complete\\n\");\n\n        glEnable(GL_TEXTURE_2D);\n        glBindTexture(GL_TEXTURE_2D, tex);\n\n        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, tex_w, tex_h,\n            0, GL_RGB, GL_UNSIGNED_BYTE, tex_array[0]);\n\n      glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n\n      printf(\"Rendering to screen...\\n\");\n        render(tex);\n    }\n\n    void alloc_texture()\n    {\n        int i;\n      int ow = tex_w;\n      int oh = tex_h;\n\n        for (tex_w = 1; tex_w &lt; width;  tex_w &lt;&lt;= 1);\n        for (tex_h = 1; tex_h &lt; height; tex_h &lt;&lt;= 1);\n\n        if (tex_h != oh || tex_w != ow){\n            tex_array = realloc(tex_array, tex_h * tex_w * 3 + tex_h * sizeof(rgb_t*));\n      }\n\n        for (tex_array[0] = (rgb_t *)(tex_array + tex_h), i = 1; i &lt; tex_h; i++){\n            tex_array[i] = tex_array[i - 1] + tex_w;\n      }\n    }\n\n\n    void render(GLuint tex)\n    {\n        double  x = (double)width /tex_w,\n            y = (double)height/tex_h;\n\n        glClear(GL_COLOR_BUFFER_BIT);\n        glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);\n\n        glBindTexture(GL_TEXTURE_2D, tex);\n\n        glBegin(GL_QUADS);\n\n        glTexCoord2f(0, 0); glVertex2i(0, 0);\n        glTexCoord2f(x, 0); glVertex2i(width, 0);\n        glTexCoord2f(x, y); glVertex2i(width, height);\n        glTexCoord2f(0, y); glVertex2i(0, height);\n\n        glEnd();\n\n        glFlush();\n        glFinish();\n    }\n\n    GLFWwindow* init_glfw()\n    {\n\n        /* Initialize the library */\n        if (!glfwInit()){\n            return NULL;\n        }\n\n        /*\n         * Configure window options here if you so desire\n         *\n         * i.e.\n         */\n         glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n         glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);\n         glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n         //glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);\n\n         //glfwWindowHint(GLFW_RESIZABLE, GL_FALSE);\n\n\n        //the fourth parameter of glfwCreateWindow should be NULL for windowed mode and \n        //glfGetPrimaryMonitor() for full screen mode\n        /* Create a windowed mode window and its OpenGL context */\n        window = glfwCreateWindow(width, height, \"Mandelbrot\", NULL, NULL);\n        if (!window)\n        {\n            glfwTerminate();\n            return NULL;\n        }\n\n        /* Make the window's context current */\n        glfwMakeContextCurrent(window);\n        glfwSetFramebufferSizeCallback(window, framebuffer_size_callback);\n\n        /*\n         * Initialize glew here\n         */\n\n        glewExperimental = GL_TRUE;\n        glewInit();\n\n\n      return window;\n\n    }\n\n\n    void calc_mandel(rgb_t* px)\n    {\n        int i, j, iter, min, max;\n        double x, y, zx, zy, zx2, zy2;\n\n      min = max_iter; \n      max = 0;\n\n      for (i = 0; i &lt; height; i++) {\n            px = tex_array[i];\n            y = (i - height/2) * scale + cy;\n            for (j = 0; j  &lt; width; j++, px++) {\n                x = (j - width/2) * scale + cx;\n                iter = 0;\n                zx = hypot(x - .25, y);\n\n                if (x &lt; zx - 2 * zx * zx + .25){\n            iter = max_iter;\n          }\n                if ((x + 1)*(x + 1) + y * y &lt; 1/16){\n            iter = max_iter;\n          }\n\n                zx = zy = zx2 = zy2 = 0;\n                for (; iter &lt; max_iter &amp;&amp; zx2 + zy2 &lt; 4; iter++) {\n                    zy = 2 * zx * zy + y;\n                    zx = zx2 - zy2 + x;\n                    zx2 = zx * zx;\n                    zy2 = zy * zy;\n                }\n\n                if (iter &lt; min){\n            min = iter;\n          }\n                if (iter &gt; max){ \n            max = iter;\n          }\n                *(unsigned short *)px = iter;\n            }\n        }\n\n        for (i = 0; i &lt; height; i++){\n            for (j = 0, px = tex_array[i]; j  &lt; width; j++, px++){\n                hsv_to_rgb(*(unsigned short*)px, min, max, px);\n        }\n      }\n\n    }\n\n    void hsv_to_rgb(int hue, int min, int max, rgb_t *p)\n    {\n\n      printf(\"Converting hsv to rbg... \\n\");\n        if (min == max){\n        max = min + 1;\n      }\n        if (invert){\n        hue = max - (hue - min);\n      }\n        if (!saturation) {\n            p-&gt;r = p-&gt;g = p-&gt;b = 255 * (max - hue) / (max - min);\n            printf(\"done! (!saturation)\\n\");\n        return;\n        }\n        double h = fmod(color_rotate + 1e-4 + 4.0 * (hue - min) / (max - min), 6);\n        double c = VAL * saturation;\n        double X = c * (1 - fabs(fmod(h, 2) - 1));\n\n        p-&gt;r = p-&gt;g = p-&gt;b = 0;\n\n        switch((int)h) {\n        case 0: p-&gt;r = c; p-&gt;g = X; break;\n        case 1: p-&gt;r = X; p-&gt;g = c; break;\n        case 2: p-&gt;g = c; p-&gt;b = X; break;\n        case 3: p-&gt;g = X; p-&gt;b = c; break;\n        case 4: p-&gt;r = X; p-&gt;b = c; break;\n        default:p-&gt;r = c; p-&gt;b = X; break;\n        }\n        printf(\"done! (sauration)\\n\");\n    }\n\nvoid framebuffer_size_callback(GLFWwindow* window, int width, int height)\n{\n    // make sure the viewport matches the new window dimensions; note that width and \n    // height will be significantly larger than specified on retina displays.\n    glViewport(0, 0, width, height);\n    glOrtho(0, width, 0, height, -1, 1);\n    //set_texture();\n}\n\n\n\n\n  [1]: https://rosettacode.org/wiki/Mandelbrot_set#PPM_non_interactive\n</code></pre>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1561527544, "post_id": 56765872, "comment_id": 100087855, "body": "Not as you describe it. Describe more abstractly, please. What are you trying to achieve? Have a look here to understand why I am asking: <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>"}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1561527978, "post_id": 56765872, "comment_id": 100087989, "body": "@Yunnosch what i exactly trying yo achieve is, I am working on STM32 MCU, in its library there are 4 LED definitions which have set equal to hexadecimal numbers(RAM adress). f.e, #define LD3_Pin 0x000F  #define LD4_Pin 0x0010  etc;  I wanted to iterate between those LED&#39;s by passing their macros stored in a string array, char * [10] = {&quot;LD3_Pin&quot; , &quot;LD4_Pin&quot; , ... } ;  But i realized that those strings are not identified as macros, instead they pass random integers. I solved my problem with another method, but I got interested whether this kind of implementation possible or not."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1561528099, "post_id": 56765872, "comment_id": 100088028, "body": "Please <a href=\"https://stackoverflow.com/posts/56765872/edit\">edit</a> to add helpful information to your question."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1561528116, "post_id": 56765872, "comment_id": 100088036, "body": "Why not just iterate over the values? <code>unsigned int a[] = { LD3_Pin, LD4_Pin, ... }</code>?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1561528154, "post_id": 56765872, "comment_id": 100088046, "body": "For what purpose do you want to have names of macros in your string array? You can just store the values instead."}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1561528328, "post_id": 56765872, "comment_id": 100088096, "body": "@melpomene , Gerhardh I didn&#39;t think like that, thanks for advice. As i said above i solved problem with passing values itself. I just wondered whether this ( my question ) was possible or not. Thanks."}, {"owner": {"reputation": 10367, "user_id": 380331, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ef911e1dffe26625ae43f8d1cd1ac70e?s=128&d=identicon&r=PG", "display_name": "Agnius Vasiliauskas", "link": "https://stackoverflow.com/users/380331/agnius-vasiliauskas"}, "edited": false, "score": 0, "creation_date": 1561530923, "post_id": 56765872, "comment_id": 100089185, "body": "you can use <a href=\"https://stackoverflow.com/questions/2653214/stringification-of-a-macro-value\">macro stringification</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561642530, "post_id": 56765872, "comment_id": 100138989, "body": "An important detail to remember is that, in c, macros are little more than text substitution  that occurs in the preprocessor"}], "answers": [{"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1561528072, "post_id": 56765925, "comment_id": 100088017, "body": "@melpomene Yes it was. I just copy pasted OP:s code. Corrected now."}, {"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561528434, "post_id": 56765925, "comment_id": 100088131, "body": "I want 900 as integer, not string. But thanks for pointing out what that number is."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 0, "last_activity_date": 1561528035, "last_edit_date": 1561528035, "creation_date": 1561527721, "answer_id": 56765925, "question_id": 56765872, "link": "https://stackoverflow.com/questions/56765872/can-i-use-a-string-as-a-macro-to-pass-the-value-of-that-macro-in-c/56765925#56765925", "title": "Can I use a string as a macro to pass the value of that macro in C?", "body": "<p>Macros are simple copy paste and they are pretty limited. A macro will not expand if it's quoted or commented.</p>\n\n<p>One solution would be:</p>\n\n<pre><code>#define ABC \"900\"\nchar s[] = ABC; \n</code></pre>\n\n<p>But no, macros cannot be used for what you're trying to do. </p>\n\n<blockquote>\n  <p>When i try the above code, instead of my desired output 15 , i get 6487568 which i guess the integer equivalent of that string.</p>\n</blockquote>\n\n<p>It's undefined behavior. Most likely it's the address of the string. If you compile with <code>-Wall</code> you will get a warning for this.</p>\n"}, {"comments": [{"owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 0, "creation_date": 1561529249, "post_id": 56766156, "comment_id": 100088468, "body": "Thanks for explicit example, by the way what is that &quot;foo&quot; thing, is that have a meaning or just a convention, i see it among these kind of examples a lot.  p.s : non-native speaker, i hope foo is not something everybody knows except me"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "edited": false, "score": 1, "creation_date": 1561529312, "post_id": 56766156, "comment_id": 100088487, "body": "@muyustan <a href=\"https://en.wikipedia.org/wiki/Foobar\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Foobar</a>, <a href=\"http://www.catb.org/jargon/html/F/foo.html\" rel=\"nofollow noreferrer\">catb.org/jargon/html/F/foo.html</a>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561533367, "post_id": 56766156, "comment_id": 100090356, "body": "@melpomene saying more precise proprocessor does know anything about the C and only textually replaces the tokens, and C is compiling this source with everything already replaced"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1561533383, "post_id": 56766156, "comment_id": 100090367, "body": "@melpomene saying more precise proprocessor does know anything about the C and only textually replaces the tokens, and C is compiling this source with everything already replaced"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 2, "last_activity_date": 1561528907, "creation_date": 1561528907, "answer_id": 56766156, "question_id": 56765872, "link": "https://stackoverflow.com/questions/56765872/can-i-use-a-string-as-a-macro-to-pass-the-value-of-that-macro-in-c/56766156#56766156", "title": "Can I use a string as a macro to pass the value of that macro in C?", "body": "<p>No, what you're trying to do is double impossible. You can't access variables by name at runtime (string -> variable) because the compiled machine code knows nothing about the names in your C code, and you can't access macros from the compiler because the compiler knows nothing about macros (they're expanded by the preprocessor before the compiler even sees the code).</p>\n\n<p>In other words, compilation / execution happens in multiple stages:</p>\n\n<ol>\n<li>C source code is preprocessed (which gets rid of directives like <code>#include</code> or <code>#define</code> and expands macros).</li>\n<li>The preprocessed token stream is passed to the compiler, which converts it to machine code (a runnable program).</li>\n<li>Finally the program runs.</li>\n</ol>\n\n<p>Simplified example:</p>\n\n<pre><code>// original C code\n#define FOO 42\n...\nint x = y + FOO;\n</code></pre>\n\n<p>After preprocessing:</p>\n\n<pre><code>...\nint x = y + 42;\n</code></pre>\n\n<p>After compilation:</p>\n\n<pre><code>movl %ecx, %eax\naddl $42, %eax\n</code></pre>\n\n<p>There is no trace of <code>FOO</code> in step 2, and the final code knows nothing about <code>x</code> or <code>y</code>.</p>\n\n<p>Variable values such as strings only exist at runtime, in step 3. You can't get back to step 1 from there. If you wanted to access information about macros at runtime, you'd have to keep it explicitly in some sort of data structure, but none of this is automatic.</p>\n"}], "owner": {"reputation": 983, "user_id": 11701071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86363a4bb433b3cfc9dc7d94349ccdcf?s=128&d=identicon&r=PG&f=1", "display_name": "muyustan", "link": "https://stackoverflow.com/users/11701071/muyustan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 56766156, "answer_count": 2, "score": -1, "last_activity_date": 1561539134, "creation_date": 1561527319, "last_edit_date": 1561539134, "question_id": 56765872, "link": "https://stackoverflow.com/questions/56765872/can-i-use-a-string-as-a-macro-to-pass-the-value-of-that-macro-in-c", "title": "Can I use a string as a macro to pass the value of that macro in C?", "body": "<p>I am trying to achieve that C interprets my string as macro.</p>\n\n<p>Hey, let's suppose there is a defined macro as,</p>\n\n<pre><code>#define ABC 900\n</code></pre>\n\n<p>If i define; </p>\n\n<pre><code>char* s[] = \"ABC\" ; \n</code></pre>\n\n<p>then,</p>\n\n<pre><code>printf(\"%d\",s) ; \n</code></pre>\n\n<p>Is there any way the compiler understands that \"ABC\" as macro ABC and passes 900 integer value to printf ? </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define abc 15\n\nint main(void) {\n\n    char a[] = \"abc\" ;\n\n    printf(\"%d\",a); \n\n\n    return 0;\n}\n</code></pre>\n\n<p>When i try the above code, instead of my desired output 15 , i get 6487568 which i guess the integer equivalent of that string.</p>\n\n<p>Edit : those were random values , or address of strings. ( as stated below by others ) </p>\n"}, {"tags": ["c", "string", "csv", "whitespace"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1561521422, "post_id": 56764932, "comment_id": 100086207, "body": "can you explain what you mean by &quot;I&#39;m having to save them originally as string literals.&quot;  ? You can not save string literals, they are set at compile-time and not modifiable. I think you are saying &quot;string literals&quot; when actually you mean something else"}, {"owner": {"reputation": 15, "user_id": 10977590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25eb3e4fea17dd6b6a8efde3776553bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ely", "link": "https://stackoverflow.com/users/10977590/ely"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1561521703, "post_id": 56764932, "comment_id": 100086271, "body": "@M.M I&#39;m still very much a noobie so maybe I have my terms wrong but for example I&#39;m having to declare my tokens like char *firstname_token = NULL. I thought I wouldn&#39;t be allowed to change that after I give it some token value thus meaning I cant simply do something like, strcat(strcat(lastname_token, &quot; &quot;)firstname_token)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1561522104, "post_id": 56764932, "comment_id": 100086361, "body": "the result of <code>strtok</code> points into the buffer called <code>line</code>, so actually you can do that, but you should also check you are not going to exceed the space in the buffer (and also check that your strcat do not have overlapping source and destination). It would be simpler to use <code>snprintf</code> instead of <code>strcat</code> and you should probably make another buffer to work in"}, {"owner": {"reputation": 15, "user_id": 10977590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25eb3e4fea17dd6b6a8efde3776553bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ely", "link": "https://stackoverflow.com/users/10977590/ely"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1561523255, "post_id": 56764932, "comment_id": 100086622, "body": "@M.M I tried that method of strcat(strcat()) but it breaks. I didn&#39;t know snprintf existed but that solved my problem. Thank you!!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1561530281, "post_id": 56764932, "comment_id": 100088889, "body": "The only string literals in the code shown are <code>&quot; &quot;</code> and <code>&quot;,&quot;</code>.  The data you read from the file is not a string literal, though it is formatted with quotes around the payload of the field.  Can you find and use a CSV-reading library?  Assuming not (even though it would probably be easiest), then do you need first name and last name separately, or would &#39;together&#39; be OK?  If you only need them together, you can write your own <code>char *csv_field_end(char *field_start)</code> which can skip a CSV field, noting whether the first character passed is a <code>&#39;&quot;&#39;</code> or not, and processing differently accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1561533593, "creation_date": 1561533593, "answer_id": 56767298, "question_id": 56764932, "link": "https://stackoverflow.com/questions/56764932/using-strcat-to-add-a-whitespace-onto-a-string-literal/56767298#56767298", "title": "Using strcat to add a whitespace onto a string literal?", "body": "<p>If your <code>.csv</code> file already contains the quoted field <code>\"Lastname, Firstname\"</code>, and that is what you need to parse from each line in the file, then there is no reason to split the lines on <code>commas</code> and then try and put the two halfs of the quoted field back together. Instead, simply locate the opening <code>'\"'</code> saving a pointer to the start position within your line (say with <code>char *start;</code>) and then locate the next <code>'\"'</code> in the line saving a pointer to the end position in the line (say with <code>char *end;</code>) and then simply copy from <code>start</code> to <code>end</code> into a new string (remembering to <em>nul-terminate</em> the new string)</p>\n\n<p>This is made quite simple with the function <code>strchr</code> from <code>string.h</code>. Simply read each line into a buffer:</p>\n\n<pre><code>#define MAXC 256\n\nint main (void) {\n\n    char buf[MAXC],     /* buffer holding line */\n        name[MAXC];     /* buffer to hold quoted lastname, firstname */\n\n    while (fgets (buf, MAXC, stdin)) {          /* read each line */\n        char *start, *end;                      /* start/end pointers */\n</code></pre>\n\n<p>Then locate the first double-quote within the line, and if found, save the address to the opening-quote in <code>start</code>:</p>\n\n<pre><code>        if ((start = strchr (buf, '\"')))                /* if start \" found */\n</code></pre>\n\n<p>if found, then find the ending <code>'\"'</code> beginning your search at <code>start + 1</code> and saving the address for the closing-quote in <code>end</code>, e.g.</p>\n\n<pre><code>            if ((end = strchr (start + 1, '\"'))) {      /* if end \" found */\n</code></pre>\n\n<p>finally, copy the entire quoted field to a new string (say <code>name</code>),</p>\n\n<pre><code>                memcpy (name, start, end - start + 1);  /* copy to name */\n                name[end - start + 1] = 0;              /* nul-terminate */\n</code></pre>\n\n<p>Putting together a short example that reads your <code>.csv</code> file as input on <code>stdin</code> (you can add the code to open the filename if you like), you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXC 256\n\nint main (void) {\n\n    char buf[MAXC],     /* buffer holding line */\n        name[MAXC];     /* buffer to hold quoted lastname, firstname */\n\n    while (fgets (buf, MAXC, stdin)) {          /* read each line */\n        char *start, *end;                      /* start/end pointers */\n        if ((start = strchr (buf, '\"')))                /* if start \" found */\n            if ((end = strchr (start + 1, '\"'))) {      /* if end \" found */\n                memcpy (name, start, end - start + 1);  /* copy to name */\n                name[end - start + 1] = 0;              /* nul-terminate */\n                printf (\"%s\\n\", name);          /* print captured name */\n            }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> to ensure a complete line of input fit in <code>buf</code>, you should check the final character read was <code>'\\n'</code>, which is left to you, but note, there is no guarantee that the final line in the file will contain a POSIX line-ending, so the second part of the check would be that <code>strlen(buf) &lt; MAXC - 1</code>. If either condition is satisfied, a complete line of text was read from the file)</p>\n\n<p><strong>Example Input File</strong></p>\n\n<p>Your input file with the addition of <code>1, 2, 3</code> following the names to distinguish the lines within the file:</p>\n\n<pre><code>$ cat dat/quoted.csv\n\"LastName1, Firstname1\",ID\n\"LastName2, Firstname2\",ID\n\"LastName3, Firstname3\",ID\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Compiling and running the code will save and output the quoted fields simply by copying the wanted characters, without having to tokenize or concatenate the pieces together.</p>\n\n<pre><code>$ ./bin/quotedfield &lt; dat/quoted.csv\n\"LastName1, Firstname1\"\n\"LastName2, Firstname2\"\n\"LastName3, Firstname3\"\n</code></pre>\n\n<p>There are a number of ways to do this, including simply working your way down your line buffer with a pointer and locating and counting <code>'\"'</code>s, or using <code>strcspn/strspn</code>, etc.. Any way that can locate the surrounding quotes is fine. Then just copy from the opening-quote to the closing-quote into a new string, nul-terminate and you are done.</p>\n\n<p>Let me know if you were attempting something other than capturing <code>\"LastName, Firstname\"</code> from each line in the file, or if you have further question about this approach instead of your <code>strtok</code> approach and I'm happy to help further.</p>\n"}], "owner": {"reputation": 15, "user_id": 10977590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25eb3e4fea17dd6b6a8efde3776553bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ely", "link": "https://stackoverflow.com/users/10977590/ely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561533593, "creation_date": 1561521248, "last_edit_date": 1561527042, "question_id": 56764932, "link": "https://stackoverflow.com/questions/56764932/using-strcat-to-add-a-whitespace-onto-a-string-literal", "title": "Using strcat to add a whitespace onto a string literal?", "body": "<p>Is there a way I can use <code>strcat</code> to add a trailing whitespace to a string literal? I'm reading stuff from a <code>csv</code> file and breaking it into tokens with <code>strtok()</code> then merging two different tokens with <code>strcat</code> but I want to do something so I create a whitespace between the two. </p>\n\n<p>Here is an example of how my <code>csv</code> file reads:</p>\n\n<pre><code>\"LastName, Firstname\",ID\n\"LastName, Firstname\",ID\n\"LastName, Firstname\",ID\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>char *firstname_token = NULL, *lastname_token = NULL, *ID_token, line[200];\nfor (i = 0; i &lt; 3; i++){\nfgets(line, 200, infile);\nlastname_token = strtok(line,\" \");\nfirstname_token = strtok(NULL, \",\");\nID_token=strtok(NULL,\" \");}\n</code></pre>\n\n<p>Currently <code>firstname_token</code> reads: </p>\n\n<pre><code>\"Lastname,\n</code></pre>\n\n<p>Currently <code>lastname_token</code> reads:</p>\n\n<pre><code>Firstname\"\n</code></pre>\n\n<p>I want to <code>strcat</code> (or something similar) them together in the form:</p>\n\n<pre><code>\"Lastname, Firstname\"\n</code></pre>\n\n<p>but retain that whitespace in between the two but I'm not sure how since I'm having to save them originally as string literals.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 387, "user_id": 8436917, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yUuvQL44b4w/AAAAAAAAAAI/AAAAAAAAARU/wDx-W1CC1vk/photo.jpg?sz=128", "display_name": "Lucas Martins", "link": "https://stackoverflow.com/users/8436917/lucas-martins"}, "edited": false, "score": 0, "creation_date": 1561516804, "post_id": 56764392, "comment_id": 100085413, "body": "Simply assigning the value to the register isn&#39;t enough? xors and shifts may look cool and fast, but they make your code harder to understand."}, {"owner": {"reputation": 355, "user_id": 5802410, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e41a55cbcebb072487923bf5fa994347?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5802410/john-smith"}, "edited": false, "score": 0, "creation_date": 1561516963, "post_id": 56764392, "comment_id": 100085440, "body": "It&#39;s embedded and simply assigning a value doesn&#39;t seem to modify the register, only bitwise operators."}, {"owner": {"reputation": 387, "user_id": 8436917, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yUuvQL44b4w/AAAAAAAAAAI/AAAAAAAAARU/wDx-W1CC1vk/photo.jpg?sz=128", "display_name": "Lucas Martins", "link": "https://stackoverflow.com/users/8436917/lucas-martins"}, "edited": false, "score": 0, "creation_date": 1561517384, "post_id": 56764392, "comment_id": 100085508, "body": "Consider posting an example code, to avoid misinterpretations."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1561517465, "post_id": 56764392, "comment_id": 100085527, "body": "John, that appears to make no sense - if assigning (store) didn&#39;t work, neither would bitwise operations (load, modify, <b><i>store</i></b>)."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1561516508, "creation_date": 1561516508, "answer_id": 56764400, "question_id": 56764392, "link": "https://stackoverflow.com/questions/56764392/most-elegant-way-of-turning-bits-on-and-off/56764400#56764400", "title": "Most elegant way of turning bits on and off", "body": "<p><code>x ^= 3</code> changes 1 to 2 and changes 2 to 1. <code>^</code> performs an exclusive or (XOR) operation.</p>\n"}, {"tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 0, "last_activity_date": 1561525082, "creation_date": 1561525082, "answer_id": 56765452, "question_id": 56764392, "link": "https://stackoverflow.com/questions/56764392/most-elegant-way-of-turning-bits-on-and-off/56765452#56765452", "title": "Most elegant way of turning bits on and off", "body": "<p>The most elegant way is to define a structure that uses bit fields. Sadly this is rarely appropriate when dealing with hardware registers (e.g. order of bits in a bit-field isn't well defined, etc).</p>\n\n<p>Without bitfields; use \"and with compliment\" (e.g. <code>x = x &amp; ~ 2;</code> or <code>x &amp;= ~2;</code>) to clear bits and \"or\" (e.g. <code>x = x | 1;</code> or <code>x |= 1;</code>) to set bits.</p>\n\n<p>If you know the previous value you can optimize further. For example, if you know the previous value is 0x02 then you can just set a new value (e.g. <code>x = 0x01;   // It was 0x02</code> or maybe <code>x = (0x02 &amp; ~2) | 1;</code> so compiler will work out the constant for you but the source code still reflects how the constant was determined).</p>\n\n<p>Note that it's not possible to do it in a single operation unless you do know something about the previous value. For example, if you know that the previous value will have bit 0 clear and bit 1 set but don't know anything about the other bits (and need to preserve the other bits), then you can decrement (<code>x--;   // Clear bit 2, set bit 1</code>) or use exclusive OR.</p>\n"}], "owner": {"reputation": 355, "user_id": 5802410, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e41a55cbcebb072487923bf5fa994347?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5802410/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1561559790, "answer_count": 2, "score": -2, "last_activity_date": 1561525082, "creation_date": 1561516435, "last_edit_date": 1561516778, "question_id": 56764392, "link": "https://stackoverflow.com/questions/56764392/most-elegant-way-of-turning-bits-on-and-off", "closed_reason": "Duplicate", "title": "Most elegant way of turning bits on and off", "body": "<p>I've got a register which can either be 0x02 or 0x01 (0010 or 0001). What is the most elegant way of setting the bits in a single operation? E.g. if the register is currently 0x02, I need to turn off bit 2 and turn on bit 1.</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["c", "arrays", "scanf", "stdin", "eof"], "comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1561519692, "post_id": 56764329, "comment_id": 100085913, "body": "What are you doing exactly? What&#39;s the purpose the <code>for</code> loop? What&#39;s the problem with <code>n = scanf(&quot;%s %s %s %s %s&quot;, ...)</code>?"}, {"owner": {"reputation": 127, "user_id": 11688829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5K5mmC_TWeo/AAAAAAAAAAI/AAAAAAAAACA/f7rhgIJClMI/photo.jpg?sz=128", "display_name": "Pomegranate Society", "link": "https://stackoverflow.com/users/11688829/pomegranate-society"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1561521049, "post_id": 56764329, "comment_id": 100086131, "body": "@NeilEdelman For this program, I rely on user input. The user input dictates how much input I should expect, and if I have less than what is specified, I should exit the program. I feel like setting <code>n</code> in this way may not work?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1561524640, "post_id": 56764329, "comment_id": 100086983, "body": "Your problem is that your <code>numwords</code> was (default-)initialized to zero and you&#39;re never changing its value. What would you expect to happen here!? Or... if it wasn&#39;t, then the for loop always iterates the <code>i</code> from 0 to <code>numwords</code> breaking the loop when it reaches <code>numwords</code>, and hence it is never less."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1561597421, "post_id": 56764329, "comment_id": 100120017, "body": "The user counting how many inputs seems like a problem computers could do easily and more accurately, for example, by reading the file twice, or, if it&#39;s processing on-line, allocate bigger and bigger chunks of capacity and have a count."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 11688829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5K5mmC_TWeo/AAAAAAAAAAI/AAAAAAAAACA/f7rhgIJClMI/photo.jpg?sz=128", "display_name": "Pomegranate Society", "link": "https://stackoverflow.com/users/11688829/pomegranate-society"}, "edited": false, "score": 0, "creation_date": 1561517917, "post_id": 56764484, "comment_id": 100085610, "body": "I had actually tried this earlier too but it failed against a file that had <code>numwords</code> as 6 and 6 words. That&#39;s why I had originally used the for loop. I think with the method you listed, an input with the correct number of words that match <code>numwords</code> might still be failing bc <code>i</code> is incremented from 0 onwards?"}, {"owner": {"reputation": 36, "user_id": 4714666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vbGjAsYQaDA/AAAAAAAAAAI/AAAAAAAAAHo/KBb-cDAUqoY/photo.jpg?sz=128", "display_name": "gdea73", "link": "https://stackoverflow.com/users/4714666/gdea73"}, "reply_to_user": {"reputation": 127, "user_id": 11688829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5K5mmC_TWeo/AAAAAAAAAAI/AAAAAAAAACA/f7rhgIJClMI/photo.jpg?sz=128", "display_name": "Pomegranate Society", "link": "https://stackoverflow.com/users/11688829/pomegranate-society"}, "edited": false, "score": 0, "creation_date": 1561518111, "post_id": 56764484, "comment_id": 100085645, "body": "Is it expected that one word is entered on each line? If so, the test program I posted will exit with a 0 as long as 5 or more words are provided. <code>i</code> is initialized to 0, but it should represent exactly the number of words that were read with <code>scanf</code>."}, {"owner": {"reputation": 127, "user_id": 11688829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5K5mmC_TWeo/AAAAAAAAAAI/AAAAAAAAACA/f7rhgIJClMI/photo.jpg?sz=128", "display_name": "Pomegranate Society", "link": "https://stackoverflow.com/users/11688829/pomegranate-society"}, "edited": false, "score": 0, "creation_date": 1561518492, "post_id": 56764484, "comment_id": 100085702, "body": "I think another important aspect about the files I&#39;m reading (which I definitely forget to mention), is that files that are appropriate also have integers that follow after, that should not be read. Is there any way to impose a condition in which if an integer is read, then the program should stop reading the input?"}, {"owner": {"reputation": 36, "user_id": 4714666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vbGjAsYQaDA/AAAAAAAAAAI/AAAAAAAAAHo/KBb-cDAUqoY/photo.jpg?sz=128", "display_name": "gdea73", "link": "https://stackoverflow.com/users/4714666/gdea73"}, "reply_to_user": {"reputation": 127, "user_id": 11688829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5K5mmC_TWeo/AAAAAAAAAAI/AAAAAAAAACA/f7rhgIJClMI/photo.jpg?sz=128", "display_name": "Pomegranate Society", "link": "https://stackoverflow.com/users/11688829/pomegranate-society"}, "edited": false, "score": 0, "creation_date": 1561518508, "post_id": 56764484, "comment_id": 100085707, "body": "I&#39;ve updated my response to stop once the expected number of words are read, and to print the results. Hopefully that works for your use case. Please let me know if there are any other issues you find with it. Edit (having just seen your latest comment): yes, you could check <code>isdigit()</code> for each character in <code>wptrs[words_read]</code> within your while loop. If you find that the &quot;word&quot; contains only digits this way, then you could break out of the loop."}, {"owner": {"reputation": 127, "user_id": 11688829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5K5mmC_TWeo/AAAAAAAAAAI/AAAAAAAAACA/f7rhgIJClMI/photo.jpg?sz=128", "display_name": "Pomegranate Society", "link": "https://stackoverflow.com/users/11688829/pomegranate-society"}, "edited": false, "score": 1, "creation_date": 1561522401, "post_id": 56764484, "comment_id": 100086416, "body": "Your solution worked absolutely perfect. I cannot thank you enough!"}], "tags": [], "owner": {"reputation": 36, "user_id": 4714666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vbGjAsYQaDA/AAAAAAAAAAI/AAAAAAAAAHo/KBb-cDAUqoY/photo.jpg?sz=128", "display_name": "gdea73", "link": "https://stackoverflow.com/users/4714666/gdea73"}, "is_accepted": true, "score": 1, "last_activity_date": 1561518987, "last_edit_date": 1561518987, "creation_date": 1561517204, "answer_id": 56764484, "question_id": 56764329, "link": "https://stackoverflow.com/questions/56764329/reading-input-from-stdin-into-an-array-of-pointers-until-eof-but-nothing-comes/56764484#56764484", "title": "Reading input from stdin into an array of pointers until EOF, but nothing comes out as output?", "body": "<p>Revised example: breaks out of the <code>while</code> loop if the word quota is met or if EOF is read.</p>\n\n<p>I've arbitrarily chosen 5 for <code>words_expected</code> (rather, <code>numwords</code> in the original code). Once five lines of input are read, the results will be printed. No explicit EOF is required. If EOF is met before 5 words, the error is printed and we exit with return code 1.</p>\n\n<p>Per your comment, I added a check for whether a given line contains only digits. If it does, the program will cease to process the input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MEMSIZE 1024\n#define MAX_WORDS 5\n\n//A huge chunk of memory that stores the null-terminated words contiguously\nchar chunk[MEMSIZE];\n\n//Location of unused memory\nchar *unused = chunk;\n\n//Points to words that reside inside of chunk\nchar *wptrs[MAX_WORDS];\n\n/** Total number of words in the dictionary */\nint words_expected = 5;\n\nint contains_only_digits(char *s)\n{\n    int i = 0;\n    for (i = 0; i &lt; strlen(s); i++) {\n        if (!isdigit(s[i])) {\n            return 0;\n        }\n    }\n\n    return 1;\n}\n\nvoid readwords()\n{\n    int words_read = 0;\n    while (words_read &lt; words_expected &amp;&amp; scanf(\"%s\", unused) != EOF) {\n        // Read in words and store them in chunk array\n        wptrs[words_read] = unused;\n        if (contains_only_digits(wptrs[words_read])) {\n            break;\n        }\n        unused += strlen(wptrs[words_read]) + 1;\n        words_read++;\n    }\n\n    //Check to see if fewer input than specified\n    if (words_read &lt; words_expected) {\n        printf(\"Expected %d words, but %d were provided\\n\", words_expected,\n                words_read);\n        exit(1);\n    }\n}\n\nvoid printwords()\n{\n    int i = 0;\n    for (i = 0; i &lt; words_expected; i++) {\n        printf(\"word %d: %s\\n\", i + 1, wptrs[i]); \n    }\n}\n\nint main(int argc, char **argv)\n{\n    readwords();\n    printwords();\n}\n</code></pre>\n\n<p>The <code>contains_only_digits</code> function is a naive implementation. It may be wise to use <code>strtol</code> and check <code>errno</code> if you are interested in best practices for determining whether a C string is a number.</p>\n"}], "owner": {"reputation": 127, "user_id": 11688829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5K5mmC_TWeo/AAAAAAAAAAI/AAAAAAAAACA/f7rhgIJClMI/photo.jpg?sz=128", "display_name": "Pomegranate Society", "link": "https://stackoverflow.com/users/11688829/pomegranate-society"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1561636326, "accepted_answer_id": 56764484, "answer_count": 1, "score": -1, "last_activity_date": 1561518987, "creation_date": 1561515954, "question_id": 56764329, "link": "https://stackoverflow.com/questions/56764329/reading-input-from-stdin-into-an-array-of-pointers-until-eof-but-nothing-comes", "closed_reason": "Not suitable for this site", "title": "Reading input from stdin into an array of pointers until EOF, but nothing comes out as output?", "body": "<p>I'm attempting to write a program in which there is an integer, called <code>numwords</code>, that specifies the number of words read from a file. However, I am testing it against a file that has fewer words than what the user inputs. For instance, I have the input</p>\n\n<pre><code>this\n\nshould\n\nnot \n\nwork\n</code></pre>\n\n<p>in which <code>numwords</code> is 5 based on user input. I want to terminate the program with an exit code of 1, so I have written the following code to help me: </p>\n\n<p>When I use files that have the appropriate number of words as the user inputs into <code>numwords</code>, not output appears to be printed out (the program has other functions that use <code>wptrs</code> to print values). Output was being printed before I added the while statement to my code. I feel that there is something wrong with my scanf statement in the while loop. Before I added to the while loop, I had used just the for loop and the commented-out <code>scanf(\"%s\", unused)</code>, and my program was working normally - input was being read in, and the appropriate output was used. I am just trying to implement a condition in which the above case with fewer words than <code>numwords</code> would fail, however.</p>\n\n<pre><code>//A huge chunk of memory that stores the null-terminated words contiguously\nchar chunk[MEMSIZE];\n\n//Location of unused memory\nchar *unused = chunk;\n\n//Points to words that reside inside of chunk\nchar *wptrs[MAX_WORDS];\n\n/** Total number of words in the dictionary */\nint numwords;\n\nvoid readwords()\n{\n  int i = 0;\n  while ((scanf(\"%s\", unused)) != EOF) {\n    for (i = 0; i &lt; numwords; i++) {\n      //Read in words and store them in chunk array\n      //scanf(\"%s\", unused);\n      wptrs[i] = unused;\n      unused += mystrlen(wptrs[i]) + 1;\n    }\n  }\n\n  //Check to see if fewer input than specified\n  if (numwords &gt; i) {\n    printf(\"%d\", i);\n    exit(EXIT_NUM_WORDS_BAD);\n  }\n}\n</code></pre>\n\n<p>I want this case to exit the program with an exit code of 1, but I find that it exits with a code of 0, as the main method just has <code>return 0</code>. Is there a way to exit with a code 1, and make my program work appropriately when there is an appropriate number of words that is equivalent to <code>numwords</code>? Thank you in advance.</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1561509609, "post_id": 56763634, "comment_id": 100084194, "body": "When you run the program yourself does it exit?"}, {"owner": {"reputation": 1, "user_id": 11700279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LsLMZdz7tIY/AAAAAAAAAAI/AAAAAAAAAQc/A7_i2BcVTs0/photo.jpg?sz=128", "display_name": "Nick Harding", "link": "https://stackoverflow.com/users/11700279/nick-harding"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1561510615, "post_id": 56763634, "comment_id": 100084362, "body": "it doesnt appear to, almost looks like its locked up, but eventually get this ~/workspace/pset4/resize/ $ ./resize 1 small.bmp new.bmp enFile size limit exceeded"}, {"owner": {"reputation": 839, "user_id": 2174028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2c052f674088f4d81b87181f4d85a4b?s=128&d=identicon&r=PG", "display_name": "Russ J", "link": "https://stackoverflow.com/users/2174028/russ-j"}, "edited": false, "score": 0, "creation_date": 1561513356, "post_id": 56763634, "comment_id": 100084765, "body": "You&#39;ve got an awful lot of nested loops here. That may have something to do with it."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1561514058, "post_id": 56763634, "comment_id": 100084919, "body": "Okay, so you should find out why your program is doing that."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11700279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LsLMZdz7tIY/AAAAAAAAAAI/AAAAAAAAAQc/A7_i2BcVTs0/photo.jpg?sz=128", "display_name": "Nick Harding", "link": "https://stackoverflow.com/users/11700279/nick-harding"}, "edited": false, "score": 0, "creation_date": 1561513354, "post_id": 56763915, "comment_id": 100084764, "body": "that cures the while loop issue and has now made a different issue of the files are bigger than expected"}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 1, "last_activity_date": 1561511927, "creation_date": 1561511927, "answer_id": 56763915, "question_id": 56763634, "link": "https://stackoverflow.com/questions/56763634/program-is-timing-out-while-waiting-to-exit/56763915#56763915", "title": "Program is timing out while waiting to exit", "body": "<p>The <code>while (counter &lt; factor)</code> loop will never exit, because you only increment <code>counter</code> when the condition <code>counter &lt; (factor - 1)</code> is true.</p>\n\n<p>You probably want to increment <code>counter</code> <em>outside</em> the <code>if (counter &lt; factor - 1)</code> condition.</p>\n"}], "owner": {"reputation": 1, "user_id": 11700279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LsLMZdz7tIY/AAAAAAAAAAI/AAAAAAAAAQc/A7_i2BcVTs0/photo.jpg?sz=128", "display_name": "Nick Harding", "link": "https://stackoverflow.com/users/11700279/nick-harding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1377, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564398293, "creation_date": 1561509028, "last_edit_date": 1564398293, "question_id": 56763634, "link": "https://stackoverflow.com/questions/56763634/program-is-timing-out-while-waiting-to-exit", "title": "Program is timing out while waiting to exit", "body": "<p>I'm not sure what is making this code time out and not exit, I suspect its something to do with my while loop near the end of the code</p>\n\n<pre><code>// Copies a BMP file and resizes it\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"bmp.h\"\n\nint main(int argc, char *argv[])\n{\n    // ensure proper usage\n    if (argc != 4)\n    {\n        fprintf(stderr, \"Usage: ./resize factor infile outfile\\n\");\n        return 1;\n    }\n    // Check argument 1 to see if integer within aceptable range\n    int factor = atoi(argv[1]);\n    if (factor &lt;= 0 || factor &gt; 100)\n    {\n        fprintf(stderr, \"Must be a positive integer greater than 0 and eqaul or less than 100\\n\");\n        return 1;\n    }\n\n    // remember filenames\n    char *infile = argv[2];\n    char *outfile = argv[3];\n\n    // open input file\n    FILE *inptr = fopen(infile, \"r\");\n    if (inptr == NULL)\n    {\n        fprintf(stderr, \"Could not open %s.\\n\", infile);\n        return 2;\n    }\n\n    // open output file\n    FILE *outptr = fopen(outfile, \"w\");\n    if (outptr == NULL)\n    {\n        fclose(inptr);\n        fprintf(stderr, \"Could not create %s.\\n\", outfile);\n        return 3;\n    }\n\n    // read infile's BITMAPFILEHEADER\n    BITMAPFILEHEADER bf;\n    BITMAPFILEHEADER bf_New;\n    fread(&amp;bf, sizeof(BITMAPFILEHEADER), 1, inptr);\n    bf_New = bf;\n\n    // read infile's BITMAPINFOHEADER\n    BITMAPINFOHEADER bi;\n    BITMAPINFOHEADER bi_New;\n    fread(&amp;bi, sizeof(BITMAPINFOHEADER), 1, inptr);\n    bi_New = bi;\n\n    // ensure infile is (likely) a 24-bit uncompressed BMP 4.0\n    if (bf.bfType != 0x4d42 || bf.bfOffBits != 54 || bi.biSize != 40 ||\n        bi.biBitCount != 24 || bi.biCompression != 0)\n    {\n        fclose(outptr);\n        fclose(inptr);\n        fprintf(stderr, \"Unsupported file format.\\n\");\n        return 4;\n    }\n\n    // set new height and width of BMP\n    bi_New.biHeight = bi.biHeight * factor;\n    bi_New.biWidth = bi.biWidth * factor;\n\n    // calculate padding for old file and new file\n    int padding = (4 - (bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n    int padding_New = (4 - (bi_New.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n\n    // set the file size for the new file\n    bf_New.bfSize = 54 + (bi_New.biWidth * sizeof(RGBTRIPLE) + padding_New) * abs(bi_New.biHeight);\n    bi_New.biSizeImage = bf_New.bfSize - 54;\n\n\n    // write outfile's BITMAPFILEHEADER\n    fwrite(&amp;bf_New, sizeof(BITMAPFILEHEADER), 1, outptr);\n\n    // write outfile's BITMAPINFOHEADER\n    fwrite(&amp;bi_New, sizeof(BITMAPINFOHEADER), 1, outptr);\n\n    // iterate over infile's scanlines\n    for (int i = 0, biHeight = abs(bi.biHeight); i &lt; biHeight; i++)\n    {\n        // iterate over pixels in scanline\n        for (int j = 0; j &lt; bi.biWidth; j++)\n        {\n            // intialise counter to print rows by amount of the factor\n            int counter = 0;\n\n            // while loop to keep continuing until factor is less than or equal to counter\n            while (counter &lt; factor)\n            {\n                // iterate over pixels in scanline\n                for(int k = 0; k &lt; bi.biWidth; k++)\n                {\n                    // temporary storage\n                    RGBTRIPLE triple;\n\n                    // declare pixel counter\n                    int pixel_counter = 0;\n\n                    // read RGB triple from infile\n                    fread(&amp;triple, sizeof(RGBTRIPLE), 1, inptr);\n\n                    // write RGB triple to outfile and use a while loop to iterate the same pixel by factor times\n                    while (pixel_counter &lt; factor)\n                    {\n                        fwrite(&amp;triple, sizeof(RGBTRIPLE), 1, outptr);\n                        pixel_counter++;\n                    }\n                }\n                // add new padding\n                for (int l = 0; l &lt; padding_New; l++)\n                {\n                    fputc(0x00, outptr);\n                }\n\n                // seek back to the beginning of row in input file, but not after iteration of printing\n                if (counter &lt; (factor - 1))\n                {\n                    fseek(inptr, -(bi.biWidth * sizeof(RGBTRIPLE)), SEEK_CUR);\n                    counter++;\n                }\n            }\n        }\n\n        // skip over padding, if any\n        fseek(inptr, padding, SEEK_CUR);\n    }\n\n    // close infile\n    fclose(inptr);\n\n    // close outfile\n    fclose(outptr);\n\n    // success\n    return 0;\n}\n</code></pre>\n\n<p>**These are the error messages im getting from my course code checker cs50\n:) resize.c and bmp.h exist.</p>\n\n<p>:) resize.c compiles.</p>\n\n<p>:( doesn't resize small.bmp when n is 1\n    timed out while waiting for program to exit</p>\n\n<p>:( resizes small.bmp correctly when n is 2\n    timed out while waiting for program to exit</p>\n\n<p>:( resizes small.bmp correctly when n is 3\n    timed out while waiting for program to exit</p>\n\n<p>and so on...**</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "system-calls", "wireless"], "comments": [{"owner": {"reputation": 2665, "user_id": 4323201, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/QefSh.png?s=128&g=1", "display_name": "RyanNerd", "link": "https://stackoverflow.com/users/4323201/ryannerd"}, "edited": false, "score": 0, "creation_date": 1561508169, "post_id": 56763496, "comment_id": 100083954, "body": "Can you share any relevant code snippets?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1561558427, "post_id": 56763496, "comment_id": 100105208, "body": "&quot;I am assuming because of interrupt, printk is not working properly&quot; - No, <code>printk</code> works correctly even inside interrupt handler. Your problem is somewhere else, but without the code we cannot help you."}, {"owner": {"reputation": 5386, "user_id": 121035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd9eafda960d5054d63ad2c2cf9ecf9?s=128&d=identicon&r=PG", "display_name": "steve", "link": "https://stackoverflow.com/users/121035/steve"}, "edited": false, "score": 0, "creation_date": 1561610144, "post_id": 56763496, "comment_id": 100122213, "body": "a system call seems overkill for this requirement. Have you looked into other ways to configure a driver? Have you looked at the proc/sys filesystem?"}], "owner": {"reputation": 1, "user_id": 11699266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WCcMz8Mtk38/AAAAAAAAAAI/AAAAAAAAAAo/IJ7d4YQp0sc/photo.jpg?sz=128", "display_name": "Madhukar Misra", "link": "https://stackoverflow.com/users/11699266/madhukar-misra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561554909, "creation_date": 1561507550, "last_edit_date": 1561554909, "question_id": 56763496, "link": "https://stackoverflow.com/questions/56763496/adding-a-system-call-for-getting-hardware-tx-rx-queue-length-of-atheros-ath9k-ht", "title": "adding a system call for getting hardware tx rx queue length of atheros ath9k_htc driver", "body": "<p>I'm doing this project which involves getting TX/RX queue length of a USB NIC. Goal is to modify <em>ath9k_htc</em> driver of device (which is also part of Linux kernel tree) and add a queue-length system call in the kernel.</p>\n\n<p>I was able to get the TX queue length. After <code>insmod</code>'ing the driver module I'm able to print any message till the point of USB-bus registration, but flow of the driver is such that it requires interrupt by upper layers to send a packet in ring buffer and then to hardware queue, and because of that (I am assuming because of interrupt, printk is not working properly) I'm not able to print anything using <code>printk</code> or <code>pr_info</code> at this side of code.</p>\n\n<p>So my question is, can we debug <em>ath9k_htc</em> by any other method and is it possible to add a functionality in a driver as a system-call ?</p>\n"}, {"tags": ["c", "visual-studio-2015"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1561505020, "post_id": 56763205, "comment_id": 100083377, "body": "You&#39;re passing the wrong type as it&#39;s second argument. Doesn&#39;t the compiler warn about this? (If not, you might need to increase the warning level, assuming msvc will warn about mismatches between scanf formats and arguments at all like gcc and clang will)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1561505513, "post_id": 56763205, "comment_id": 100083484, "body": "<code>scanf_s(&quot;%d&quot;, &amp;repeat);</code>..."}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561564173, "post_id": 56763205, "comment_id": 100108795, "body": "Thanks Shawn, i tried it and it worked."}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561585942, "post_id": 56763205, "comment_id": 100117649, "body": "qwertyuiopqwertyuioqwertyu"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561585951, "post_id": 56763205, "comment_id": 100117653, "body": "qwertyuiqwertyuqwryuweg"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561585959, "post_id": 56763205, "comment_id": 100117655, "body": "12456782346dfhi"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561585974, "post_id": 56763205, "comment_id": 100117663, "body": "4qrfgyhesdrfvrdsfgyuiyji"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561585982, "post_id": 56763205, "comment_id": 100117667, "body": "aaaaaaaaaaaaaaaaaaaaaa"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561585994, "post_id": 56763205, "comment_id": 100117669, "body": "aasssddssawsdsawddsssddsdd"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561586010, "post_id": 56763205, "comment_id": 100117674, "body": "qwertyuiqwertyuqwetyiwerfgusedtuopwetvdi"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561586027, "post_id": 56763205, "comment_id": 100117678, "body": "wqewewsdssweswsssddsdsed"}, {"owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "edited": false, "score": 0, "creation_date": 1561586034, "post_id": 56763205, "comment_id": 100117681, "body": "ddsfswfcrsfdsagdyxvyjf"}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 2786457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d9ba3710aa1f4b5a6525a60414f692?s=128&d=identicon&r=PG&f=1", "display_name": "v01d", "link": "https://stackoverflow.com/users/2786457/v01d"}, "is_accepted": true, "score": 0, "last_activity_date": 1561505209, "creation_date": 1561505209, "answer_id": 56763241, "question_id": 56763205, "link": "https://stackoverflow.com/questions/56763205/how-to-fix-scanf-s-functions-in-c/56763241#56763241", "title": "How to fix scanf_s functions in c?", "body": "<p>Please read carefully prototypes of these functions, specifically look at how to pass parameters:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l?view=vs-2019\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l?view=vs-2019</a></p>\n\n<p>Hint: You passing 'repeat' wrong way.</p>\n\n<p>Also note: </p>\n\n<blockquote>\n  <p>\"Unhandled exception at 0x5D14B5F2 </p>\n</blockquote>\n\n<p>That's not a warning, more like program crash  / fatal error.</p>\n"}], "owner": {"reputation": 11, "user_id": 11132667, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tinOikfn_MI/AAAAAAAAAAI/AAAAAAAAAzI/ZO-LueLgt4A/photo.jpg?sz=128", "display_name": "Nik Brusilovski", "link": "https://stackoverflow.com/users/11132667/nik-brusilovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "closed_date": 1561505504, "accepted_answer_id": 56763241, "answer_count": 1, "score": -1, "last_activity_date": 1561505631, "creation_date": 1561504810, "question_id": 56763205, "link": "https://stackoverflow.com/questions/56763205/how-to-fix-scanf-s-functions-in-c", "closed_reason": "Duplicate", "title": "How to fix scanf_s functions in c?", "body": "<p>I'm trying to make a \"tik-tak-toe\" program and I tried to make it repeat, so I used a while loop. I ask the user type 1 for yes, and 2 for no. After that I had a scanf_s statement.\nFor some reason visual studios 2015 is giving me a warning right when I type one for yes and press enter : </p>\n\n<blockquote>\n  <p>\"Unhandled exception at 0x5D14B5F2 (ucrtbased.dll) in tick-tack-toe.exe: 0xC0000005: Access violation writing location 0x00000001.\"\n  This warning does not show up when I pressed 2 to for no.</p>\n</blockquote>\n\n<p>I used the debugger to find what was going wrong and I found that it was the scanf_s statement. \nI've tried to make it just a regular scanf statement but when I run the code is says that the code failed and that the error is, </p>\n\n<blockquote>\n  <p>\"'scanf': This function or variable may be unsafe. Consider using scanf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.\"\n  I've went all over the internet and tried everything I found but nothing worked. :(</p>\n</blockquote>\n\n<pre><code>int repeat = 1;\nwhile(repeat == 1){\n    printf(\"do you want to play again \\n 1.yes \\n 2.no \\n\");\n    scanf_s(\"%d\", repeat);\n}\n</code></pre>\n\n<p>I expect my code to go back to the start when I press 1 but instead it bugs up.</p>\n"}, {"tags": ["c", "fread"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1561505714, "post_id": 56763070, "comment_id": 100083510, "body": "No you haven&#39;t. Please read about fseek. And ensure that your fopen uses binary mode"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef86ab3bffce134a3be7e98d8a4ff3f?s=128&d=identicon&r=PG", "display_name": "Pannu", "link": "https://stackoverflow.com/users/8146757/pannu"}, "edited": false, "score": 0, "creation_date": 1561505090, "post_id": 56763103, "comment_id": 100083395, "body": "i can&#39;t read whole file at time. I&#39;ve to read file in chucks and perform operation on those bytes."}, {"owner": {"reputation": 418, "user_id": 10419533, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--F3jw9Ikk28/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUo1qO8RO0j6Z6ZB0BkJSmQhsV6Hw/mo/photo.jpg?sz=128", "display_name": "Aur&#233;lien Foucault", "link": "https://stackoverflow.com/users/10419533/aur%c3%a9lien-foucault"}, "reply_to_user": {"reputation": 19, "user_id": 8146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef86ab3bffce134a3be7e98d8a4ff3f?s=128&d=identicon&r=PG", "display_name": "Pannu", "link": "https://stackoverflow.com/users/8146757/pannu"}, "edited": false, "score": 0, "creation_date": 1561505432, "post_id": 56763103, "comment_id": 100083471, "body": "<code>sizeReadedAllTime - 12 - 16</code> is your end condition of your while"}, {"owner": {"reputation": 19, "user_id": 8146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef86ab3bffce134a3be7e98d8a4ff3f?s=128&d=identicon&r=PG", "display_name": "Pannu", "link": "https://stackoverflow.com/users/8146757/pannu"}, "edited": false, "score": 0, "creation_date": 1561506491, "post_id": 56763103, "comment_id": 100083672, "body": "I&#39;ve to read 1024 bytes at a time. Above condition not gonna always skip 16 bytes"}, {"owner": {"reputation": 418, "user_id": 10419533, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--F3jw9Ikk28/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUo1qO8RO0j6Z6ZB0BkJSmQhsV6Hw/mo/photo.jpg?sz=128", "display_name": "Aur&#233;lien Foucault", "link": "https://stackoverflow.com/users/10419533/aur%c3%a9lien-foucault"}, "reply_to_user": {"reputation": 19, "user_id": 8146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef86ab3bffce134a3be7e98d8a4ff3f?s=128&d=identicon&r=PG", "display_name": "Pannu", "link": "https://stackoverflow.com/users/8146757/pannu"}, "edited": false, "score": 0, "creation_date": 1561506921, "post_id": 56763103, "comment_id": 100083739, "body": "Last time you read of <code>size_left - 16</code> I don&#39;t understand your problem"}, {"owner": {"reputation": 19, "user_id": 8146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef86ab3bffce134a3be7e98d8a4ff3f?s=128&d=identicon&r=PG", "display_name": "Pannu", "link": "https://stackoverflow.com/users/8146757/pannu"}, "edited": false, "score": 0, "creation_date": 1561508361, "post_id": 56763103, "comment_id": 100083984, "body": "Now I got it.Thank you"}], "tags": [], "owner": {"reputation": 418, "user_id": 10419533, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--F3jw9Ikk28/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUo1qO8RO0j6Z6ZB0BkJSmQhsV6Hw/mo/photo.jpg?sz=128", "display_name": "Aur&#233;lien Foucault", "link": "https://stackoverflow.com/users/10419533/aur%c3%a9lien-foucault"}, "is_accepted": true, "score": 2, "last_activity_date": 1561504058, "creation_date": 1561504058, "answer_id": 56763103, "question_id": 56763070, "link": "https://stackoverflow.com/questions/56763070/fread-skip-bytes-at-start-and-at-end-c-c/56763103#56763103", "title": "fread skip bytes at start and at end c/c++", "body": "<p>You have multiple choice:</p>\n\n<ul>\n<li><p>You can read all and get a sub buffer of your buffer.</p></li>\n<li><p>You can see the size of the file using <code>stat()</code> and read <code>size - 12 - 16</code></p></li>\n</ul>\n"}], "owner": {"reputation": 19, "user_id": 8146757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef86ab3bffce134a3be7e98d8a4ff3f?s=128&d=identicon&r=PG", "display_name": "Pannu", "link": "https://stackoverflow.com/users/8146757/pannu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 56763103, "answer_count": 1, "score": -2, "last_activity_date": 1561504058, "creation_date": 1561503800, "question_id": 56763070, "link": "https://stackoverflow.com/questions/56763070/fread-skip-bytes-at-start-and-at-end-c-c", "title": "fread skip bytes at start and at end c/c++", "body": "<p>I'm trying to read binary data from file using fread in c and i want to skip first 12 Bytes and last 16 bytes of a file. I've figured out how to skip first 12 bytes bytes.</p>\n\n<pre><code>fread(iv, 1, 12, file);\n\nwhile (1){  \n        bytesRead = fread(buffer, 1, sizeof(buffer), file);\n\n        //How to skip last 16 byets ???\n        if (bytesRead &lt;= 0) {\n\n\n            break;\n        }\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32", "lwip"], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1561555684, "post_id": 56766883, "comment_id": 100103419, "body": "Thank you for your response. I also thought serial timeout, but nothing of the sort ... I tested it by writing an echo client that responds immediately and it works communicating with the old device and with the new one it works for a while and then stops. I have also tried those .. pymodbus .. libmodbus not yet I&#39;ll get on it and try testing it. I also already tapped on the RS485 bus and I can see all the data flowing correctly ... it&#39;s the ethernet communication that fails"}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1561555729, "post_id": 56766883, "comment_id": 100103453, "body": "And the artificial delay is because this is not a modbus converter it is a transparent converter .. it should be able to receive any protocol up to 256 bytes and pass it forward. I know ... but that&#39;s what the device does .. I tested it with modbus because it&#39;s a simple protocol and there are many tools"}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1561555978, "post_id": 56766883, "comment_id": 100103594, "body": "I also tried laying all my system out here because it may be necessary or someone would like it. But from what I can see, it seems that my entire problem lies in the fact that my device fails to communicate with another device that runs the exact same code .. but works when communicating with other devices, implying that I may be missing something ... but lwip does not detect any errors (doesn&#39;t call the error callback)"}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "reply_to_user": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1561557085, "post_id": 56766883, "comment_id": 100104331, "body": "Maybe a lwip bug? Otherwise I don&#39;t see how it can fail in the very task TCP was intended for... If you have the time you can take a look at pymodbus&#39; forwarder. Are you running on an RT OS or bare metal on the micro?"}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "reply_to_user": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1561558431, "post_id": 56766883, "comment_id": 100105217, "body": "Another thought: could you run all TCP traffic through a third computer and use Wireshark there to see what&#39;s going on?"}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1561643559, "post_id": 56766883, "comment_id": 100139693, "body": "I&#39;m running freertos on my board. What bugs me is that it works connected to old devices but when i connect 2 new ones it fails. Also I have already tried doing that .. I basically wrote an ethernet forwarder for my devices and they work ... all packets flow correctly ... the only difference is that I connect my boards to the PC instead of connecting them to each other via a switch ... I have written a lot of code to see what happens and I can clearly see that the slave stops receiving and the master stops sending .. like the socket was killed ... nut it works in the old configuration"}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1561643600, "post_id": 56766883, "comment_id": 100139721, "body": "I&#39;ll try to change the initialization code for them ... maybe try a few different lwip configurations to see if I get anything differently"}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1562086805, "post_id": 56766883, "comment_id": 100264309, "body": "Hi ... sorry it took me a long time to respond, I just noticed something weird happening. Basically I do a tcp_write followed by a tcpip_callback_with_block, where I have a callback that basically does tcp_output ... it works without any problems with the old equipment but I just noticed that it returns a ERR_MEM when I do tcp_write between new equipments ... apparently it runs out of memory and does not send the response (the slave) .. I&#39;ll edit this condition into the question"}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1562156694, "post_id": 56766883, "comment_id": 100288781, "body": "nnnnot exactly ... the exact same code works when other things connect to it ... what I noticed is that, as I&#39;ve stated before .. I do a tcp_write followed by a tcpip_callback_with_block tha calls tcp_output .... when connected to the old boards everything is fine ... but when I connect to my new boards tcp_write keeps filling up and I&#39;ve checked and tcp_output is simply not flushing the buffer .. it is not sending, like the pcb was actually disconnected ... but I don&#39; get any error callbacks and the connection is always established"}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "reply_to_user": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1562169678, "post_id": 56766883, "comment_id": 100296572, "body": "I see... And do the original devices have <a href=\"https://en.m.wikipedia.org/wiki/Keepalive\" rel=\"nofollow noreferrer\">keepalive</a> implemented? Maybe that&#39;s preventing the connection from dropping."}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "edited": false, "score": 0, "creation_date": 1562243650, "post_id": 56766883, "comment_id": 100323069, "body": "I have tried the exact same code with keep alive and without it .. the original boards I have no idea ... but I tested them with keep alive .. I&#39;ll check this next"}], "tags": [], "owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1561534227, "last_edit_date": 1561534227, "creation_date": 1561532095, "answer_id": 56766883, "question_id": 56762288, "link": "https://stackoverflow.com/questions/56762288/lwip-board-cannot-maintain-connection-to-another-lwip-board/56766883#56766883", "title": "lwip board cannot maintain connection to another lwip board", "body": "<p>If I understood your question the right way, you have a computer with two serial ports, each running a Modbus client and server instance. From each of these ends, you then go to your STM32 boards that receive data on their serial ports and forward to TCP on an Ethernet network connecting them to each other.</p>\n\n<p>Not easy to say but based on the symptoms you describe it certainly looks like you are having one or several <strong>timeout</strong> issues, likely on the serial sides. I think it won't be easy to help you pinpoint what is exactly wrong with your code without testing it and certainly not if you can't show a complete functional piece.</p>\n\n<p>But what you can improve a lot is the way you debug on the end sides. \nYou can try replacing <em>modbustools</em> with something that gives you more details. </p>\n\n<p>The easiest solution to get additional debugging info is to use <a href=\"https://github.com/riptideio/pymodbus\" rel=\"nofollow noreferrer\"><em>pymodbus</em></a>, you just need to install the library with <code>pip</code> and use the client and server provided with the <a href=\"https://github.com/riptideio/pymodbus/tree/master/examples/common\" rel=\"nofollow noreferrer\">examples</a>. The only modification you need is to change them to the serial interface commenting and uncommenting a couple of lines. This will give you very useful details for debugging.</p>\n\n<p>If you have a C development environment on your computer better go for <a href=\"https://github.com/stephane/libmodbus\" rel=\"nofollow noreferrer\"><em>libmodbus</em></a>. This library has a fantastic set of <a href=\"https://github.com/stephane/libmodbus/tree/master/tests\" rel=\"nofollow noreferrer\">unit tests</a>. Again, you just have to edit the code to set the name of your serial ports and run server and client.</p>\n\n<p>Lastly, I don't know to what extent this might be useful for you but you might want to take a look at <a href=\"https://github.com/j123b567/SerialPCAP\" rel=\"nofollow noreferrer\">SerialPCAP</a>. With this tool, you can tap on an RS-485 bus and see all queries and responses running on it. I imagine you have RS-232, which is point-to-point and will not work with three devices on the bus. If so, you can try <a href=\"https://stackoverflow.com/a/56377015/11476836\">port forwarding</a>.</p>\n\n<p><strong>EDIT:</strong> Reading your question more carefully I find this sentence particularly troublesome:</p>\n\n<blockquote>\n  <p>...detect one byte received, start timeout, when timeout ends send whatever was received via a TCP socket that was already connected to the server...</p>\n</blockquote>\n\n<p>Why would you need to introduce this artificial delay? In Modbus, you have very well defined packages that you can identify by the minimum 3.5 frame spacing, is that what you mean by <em>timeout</em>?</p>\n\n<p>Unrelated, but I've also remembered there is a <a href=\"https://pymodbus.readthedocs.io/en/latest/source/example/serial_forwarder.html\" rel=\"nofollow noreferrer\">serial forwarder example</a> inluded with <em>pymodbus</em> that might somehow help you (maybe you can use it to emulate one of your boards?).</p>\n"}], "owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561534227, "creation_date": 1561498296, "last_edit_date": 1561500305, "question_id": 56762288, "link": "https://stackoverflow.com/questions/56762288/lwip-board-cannot-maintain-connection-to-another-lwip-board", "title": "lwip board cannot maintain connection to another lwip board", "body": "<p>I have a strange problem. For some time I've been trying to replace a small protocol converter (basically a two way serial to ethernet ... master and slave) that I've got for something that has more features. </p>\n\n<h2>Backstory</h2>\n\n<p>After a lot of reverse engineering I found out how the device works and I've been trying to replicate it and I've been successful in connecting my board to the device ... I've tried connecting the original as the master and my board as slave and vice versa and everything works perfectly, it's actually better since at higher speeds there are no more packet losses (connecting 2 original ones would cause packet losses). </p>\n\n<p>However when I tried connecting my device as master and another one of my devices as slave .. running the exact same piece of code it works for 2 or 3 exchanges and then it stops ... eventually <strong>SOMETIMES</strong> after some minutes it will try again 2 or 3 more times. </p>\n\n<h1>How the tests were made</h1>\n\n<ul>\n<li>I connected a modbus master and slave (modbustools, two different instances). The master is a serial RTU modbus and the slave is an serial RTU modbus;</li>\n<li>I configure one of my devices as master and connect it to the serial port so that it receives the serial modbus and sends the protocol to a device connected to it;</li>\n<li>I configure my slave so that it connects via the serial port to the slave modbus. Basically it works by creating a socket and connecting to the master's IP, it then waits for a master transmission via ethernet, sends it via serial to the slave modbus (modbustools), receives a response, sends it its master and then it sends it to the modbus master (modbustools);</li>\n</ul>\n\n<p>I's a bit confusing but that's how it works ... my master awaits a socket connection and then the communication between them starts, because that is how the old ones work. </p>\n\n<p>I've written an echo client now to test the connection. Basically now, my code connects to a server (my master), it receives a packet, then it replies back the same packet that it received. When I try connecting this to my 2 boards they don't work. It's more of the same, 2 or 3 exchanges and then it stops, but when I connect it to the original device it keeps running without a hitch. </p>\n\n<h2>Sources</h2>\n\n<p>Here is my TCP master (server actually) initialization:</p>\n\n<pre><code>void initClient() {\n            if(tcp_modbus == NULL) {\n                tcp_modbus = tcp_new();\n                previousPort = port;\n                tcp_bind(tcp_modbus, IP_ADDR_ANY, port);\n                tcp_sent(tcp_modbus, sent);\n                tcp_poll(tcp_modbus, poll, 2);\n                tcp_setprio(tcp_modbus, 128);\n                tcp_err(tcp_modbus, error);\n                tcp_modbus = tcp_listen(tcp_modbus);\n                tcp_modbus-&gt;so_options |= SOF_KEEPALIVE; // enable keep-alive\n                tcp_modbus-&gt;keep_intvl = 1000; // sends keep-alive every second\n                tcp_accept(tcp_modbus, acceptmodbus);\n                isListening = true;\n            }\n}\nstatic err_t acceptmodbus(void *arg, struct tcp_pcb *pcb, err_t err) {\n    tcp_arg(pcb, pcb);\n    /* Set up the various callback functions */\n    tcp_recv(pcb, modbusrcv);\n    tcp_err(pcb, error);\n\n    tcp_accepted(pcb);\n\n    gb_ClientHasConnected = true;\n}\n\n//receives the packet, puts it in an array \"ptransparentmessage-&gt;data\"\n//states which PCB to use in order to reply and the length that was received\nstatic err_t modbusrcv(void *arg, struct tcp_pcb *pcb, struct pbuf *p, err_t err) {\n    if(p == NULL) {\n        return ERR_OK;\n    } else if(err != ERR_OK) {\n        return err;\n    }\n\n    tcp_recved(pcb, p-&gt;len);\n\n    memcpy(ptransparent.data, p-&gt;payload,p-&gt;len);\n    ptransparent-&gt;pcb = pcb;\n    ptransparent-&gt;len = p-&gt;len;\n}\n</code></pre>\n\n<p>The serial reception is basically this:\ndetect one byte received, start timeout, when timeout ends send whatever was received via a TCP socket that was already connected to the server .. it then receives the packet via the acceptmodbus function and sends it via serial port.</p>\n\n<p>This is my client's (slave) code:</p>\n\n<pre><code>void init_slave() {\n    if(tcp_client == NULL) {\n        tcp_client = tcp_new();\n\n        tcp_bind(tcp_client, IP_ADDR_ANY, 0);\n        tcp_arg(tcp_client, NULL);\n        tcp_recv(tcp_client, modbusrcv);\n        tcp_sent(tcp_client, sent);\n        tcp_client-&gt;so_options |= SOF_KEEPALIVE; // enable keep-alive\n        tcp_client-&gt;keep_intvl = 100; // sends keep-alive every 100 mili seconds\n        tcp_err(tcp_client, error);\n\n\n        err_t ret = tcp_connect(tcp_client, &amp;addr, portCnt, connected);\n    }\n}\n</code></pre>\n\n<p>The rest of the code is the identical. The only thing that changes is the flow of operation. </p>\n\n<ol>\n<li>Connect to server</li>\n<li>Wait for packet</li>\n<li>send it via serial</li>\n<li>wait for response timeout (same timeout as the server, it justs starts counting in a different way ... server starts after receiving one byte and client after it sent something via the serial port)</li>\n<li>get response and send it to the server</li>\n</ol>\n\n<hr>\n\n<p><strong>Observation</strong>:</p>\n\n<p>No error is detected in the communication. After some testing it doesn't seem to be the number of exchanges that causes the hang. It happens after some time. In my opinion this sounds like a disconnection problem or timeout error, but no disconnection occurs and no more packets are received. When I stop debugging and check the sockets nothing out of the ordinary is detected. </p>\n"}, {"tags": ["c", "gtk"], "comments": [{"owner": {"reputation": 7561, "user_id": 1627348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0169513b14084f169c7d5126885a6e0?s=128&d=identicon&r=PG", "display_name": "teppic", "link": "https://stackoverflow.com/users/1627348/teppic"}, "edited": false, "score": 0, "creation_date": 1561497904, "post_id": 56762143, "comment_id": 100081645, "body": "GTK2 is pretty old now but there are some old books on the topic you can probably pick up second hand for next to nothing."}], "answers": [{"tags": [], "owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "is_accepted": false, "score": 3, "last_activity_date": 1561625024, "last_edit_date": 1561625024, "creation_date": 1561545917, "answer_id": 56770990, "question_id": 56762143, "link": "https://stackoverflow.com/questions/56762143/c-gtk2-frustrated-with-gnome-documentation/56770990#56770990", "title": "C GTK2 frustrated with gnome documentation", "body": "<p>I've already seen that doc issue. The way the doc is generated has changed and it seems this broke some parts of GTK+ 2 generated doc. Now, you shouldn't be using GTK+ 2 in the first place. GTK+ 3 has been the stable release for years now, and GTK+ 2 should only be used in legacy projects. GTK+ 4 in on its way to be released this year.</p>\n\n<p>To know which signals can be used on which widget, you just have to go to the \"signals\" section of the documentation page of that widget. For example, here are the <a href=\"https://developer.gnome.org/gtk3/stable/GtkEntry.html#GtkEntry.signals\" rel=\"nofollow noreferrer\">signals specific to GtkEntry</a>. Each widget doc page has a top bar with several section shortcuts, with links to the sections you want:</p>\n\n<blockquote>\n  <p>Top  |  Description  |  Object Hierarchy  |  Implemented Interfaces  |  Properties  |  Style Properties  |  Signals</p>\n</blockquote>\n\n<p>You see the last one is about signals.</p>\n\n<p>Now this is only for signals specific to the class. This is object-oriented programming, so you can also use the signals from the parent classes as well. Just click on the \"Object Hierarchy\" link and you'll be sent on the inheritance diagram of the class. From there you may explore the parent classes, and then their signals.</p>\n\n<p>You may also want to install the Devhelp program, which give you a search-as-you-type entry and gathers the docs of lots of other libraries on which GTK+ and the GNOME platform depend (cairo, pango, etc.). Install it with your package manager, and you'll have access to offline help for all the development packages you installed, and at the versions you're really using.</p>\n"}], "owner": {"reputation": 626, "user_id": 5352476, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/9qaA3.jpg?s=128&g=1", "display_name": "Cool Javelin", "link": "https://stackoverflow.com/users/5352476/cool-javelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1592081170, "creation_date": 1561497477, "question_id": 56762143, "link": "https://stackoverflow.com/questions/56762143/c-gtk2-frustrated-with-gnome-documentation", "title": "C GTK2 frustrated with gnome documentation", "body": "<p>I have been attempting to create an app using C in Code::Blocks on Win7.</p>\n\n<p>Can anyone please point me to a better documentation then the gnome site? Or failing that, can someone point me to a place I can see which signals are allowed for which widgets?</p>\n\n<p>I recently wrote an app using Python and found TKinter to be very good, and every time I searched Google for help on TKinter the documentation was easy to read and understandable.</p>\n\n<p>The gnome GTK documentation, however, is really bad. Yes, it does describe each function, but doesn't lead you to the other parts needed to get a full understanding of the function.</p>\n\n<p>They go into great detail in some cases, actually including an entire program as an example (without comments in the code I might add,) totally obscuring the forest trying to describe the tree.</p>\n\n<p>I don't want to get too bogged down in a detail of my problem now, but this is an example of my frustration.</p>\n\n<p>Specifically, I am attaching a signal to an entry widget, and I can find the g_signal_connect declaration that gives the parameters needed, like the instance, the_signal, the handler and such, but nowhere does it say WHICH signals can be used.</p>\n\n<p>I guess it is because each widget may use a different subset of signals for the signal, but, to date. I have not found even a list of signals available let alone which ones can be used on which widgets.</p>\n\n<p>I can find the gtk_entry_new() definition, but again, that description doesn't give a list of allowable signals. Just how to call it.</p>\n\n<p>I saw an example that uses the \"insert_text\" signal, but that isn't really right, another site says there is an \"activate\" signal, but that only works if the user presses enter, not if the user clicks elsewhere in the window.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Mark.</p>\n"}, {"tags": ["php", "html", "c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561497664, "post_id": 56762104, "comment_id": 100081565, "body": "The PHP source code is displayed in the browser?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561497686, "post_id": 56762104, "comment_id": 100081570, "body": "See <a href=\"https://stackoverflow.com/questions/5121495/php-code-is-not-being-executed-instead-code-shows-on-the-page\" title=\"php code is not being executed instead code shows on the page\">stackoverflow.com/questions/5121495/&hellip;</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561497746, "post_id": 56762104, "comment_id": 100081591, "body": "The <code>-o</code> option has to be followed by the filename where the executable will be saved, not the source file name."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561497774, "post_id": 56762104, "comment_id": 100081599, "body": "It should be <code>gcc -o .&#47;c-code &#47;home&#47;birt&#47;c-code.c</code>"}, {"owner": {"reputation": 41497, "user_id": 661872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yqbSi.png?s=128&g=1", "display_name": "Lawrence Cherone", "link": "https://stackoverflow.com/users/661872/lawrence-cherone"}, "edited": false, "score": 0, "creation_date": 1561497846, "post_id": 56762104, "comment_id": 100081625, "body": "Also <code>pringf</code> should be <code>printf</code>.."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561498982, "post_id": 56762104, "comment_id": 100081988, "body": "Please post the actual code, don&#39;t retype it because you make mistakes and we can&#39;t tell what&#39;s wrong with the original code."}], "answers": [{"tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": false, "score": 0, "last_activity_date": 1561499526, "creation_date": 1561499526, "answer_id": 56762520, "question_id": 56762104, "link": "https://stackoverflow.com/questions/56762104/how-do-i-dynamically-update-a-browser-with-data-from-a-c-program/56762520#56762520", "title": "How do I dynamically update a browser with data from a C program", "body": "<p>Welcome to Stack Overflow!</p>\n\n<p>First, I would strongly recommend <em>not</em> having the PHP compile the code; get the C program working how you want it to, then have the PHP simply call the C program.</p>\n\n<p>Second, give careful consideration to whether or not you really need an external C program -- you can do a lot within PHP, and you avoid several pitfalls that can arise out of calling out to an external program.</p>\n\n<p>Third, your fundamental question is really about dynamic web pages.  That's a big topic, and a good answer is out-of-scope for an SO answer.  Read up on HTML5 and the client-server communications that are available with it, which allow for the richer \"no-refresh\" webpage updates you are asking about.  Here's a great place to start:</p>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/HTML5\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/HTML5</a></p>\n\n<p>The World Wide Web is full of articles and references for how to use HTML5.  Start simple and extend your application as you learn more.  Definitely come back here to SO when you run into problems, so that you can ask <em>specific</em> questions about particular problems you are facing.  Be sure to include your code, what you've tried, and what is and isn't working; for help asking good questions, see:</p>\n\n<p><a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">https://stackoverflow.com/help/minimal-reproducible-example</a></p>\n\n<p>HTH, and good luck!</p>\n"}], "owner": {"reputation": 1, "user_id": 11699475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a6b3d09a3b2653e0bb91bc2ba6322d?s=128&d=identicon&r=PG&f=1", "display_name": "Brum", "link": "https://stackoverflow.com/users/11699475/brum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561499526, "creation_date": 1561497317, "question_id": 56762104, "link": "https://stackoverflow.com/questions/56762104/how-do-i-dynamically-update-a-browser-with-data-from-a-c-program", "title": "How do I dynamically update a browser with data from a C program", "body": "<p>I need to access data from a C program, and without refreshing browser have that data displayed. </p>\n\n<p>To start I tried a simple C program displaying text using printf(\"Hello\"); and in the php section of the index.php file tried to run the C program and print its output. However, the real goal would be to maybe have a counter in the C program that counts up to 100, increment by 1 every second and in the browser without refreshing the page the value of that counter would be displayed as it changes.</p>\n\n<p>testcode.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    pringf(\"Display message\");\n    return 0;\n}\n\n</code></pre>\n\n<p>index.php</p>\n\n<pre><code>\n&lt;html&gt;\n &lt;head&gt;\n  &lt;title&gt;PHP Test&lt;/title&gt;\n &lt;/head&gt;\n &lt;body&gt;&lt;h1&gt;html&lt;/h1&gt;\n\n&lt;?php echo '&lt;p&gt;PHP&lt;/p&gt;'; \n   exec(\"gcc -o /home/birt/c-code.c\",$output1,$returnvalue1);\n   exec(\"./c-code\",$output2,$returnvalue2);\n   echo \"&lt;b&gt; output :&lt;/b&gt;\"+$output2;\n  ?&gt;\n\n &lt;/body&gt;\n&lt;/html&gt;\n\n</code></pre>\n\n<p>When I point my browser to the server the HTML and PHP are displayed, however the output from the C program does not</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 7, "creation_date": 1561496526, "post_id": 56761927, "comment_id": 100081207, "body": "classical &quot;I forgot to protect my macro&quot;: <code>sqr(a) a*a</code> =&gt; <code>sqr(a) ((a)*(a))</code>. Probably a duplicate"}, {"owner": {"reputation": 7561, "user_id": 1627348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0169513b14084f169c7d5126885a6e0?s=128&d=identicon&r=PG", "display_name": "teppic", "link": "https://stackoverflow.com/users/1627348/teppic"}, "edited": false, "score": 0, "creation_date": 1561496568, "post_id": 56761927, "comment_id": 100081224, "body": "homework question?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1561496603, "post_id": 56761927, "comment_id": 100081235, "body": "What&#39;s <code>64 &#47; 4 * 4</code> evaluate to in C? <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/operator_precedence</a> might help"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1561496741, "post_id": 56761927, "comment_id": 100081280, "body": "Eg. What is the difference between <code>64&#47;4*4</code> and <code>64&#47;((4)*(4))</code> ? Recall your basic mathematical expression priorities you learned in grammar school. What had <i>highest</i> priority ? What had <i>equal, left to right</i> priority ?"}, {"owner": {"reputation": 95, "user_id": 10082325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6bc9ffde2c54dde589efef35655024?s=128&d=identicon&r=PG&f=1", "display_name": "Mutaealim", "link": "https://stackoverflow.com/users/10082325/mutaealim"}, "edited": false, "score": 0, "creation_date": 1561496759, "post_id": 56761927, "comment_id": 100081287, "body": "No its not a homework question..was just trying or playing with c lang.@teppic"}, {"owner": {"reputation": 95, "user_id": 10082325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6bc9ffde2c54dde589efef35655024?s=128&d=identicon&r=PG&f=1", "display_name": "Mutaealim", "link": "https://stackoverflow.com/users/10082325/mutaealim"}, "edited": false, "score": 0, "creation_date": 1561496800, "post_id": 56761927, "comment_id": 100081305, "body": "Got the answer..thanks everyone"}], "owner": {"reputation": 95, "user_id": 10082325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6bc9ffde2c54dde589efef35655024?s=128&d=identicon&r=PG&f=1", "display_name": "Mutaealim", "link": "https://stackoverflow.com/users/10082325/mutaealim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1561496591, "answer_count": 0, "score": 1, "last_activity_date": 1561496651, "creation_date": 1561496400, "last_edit_date": 1561496651, "question_id": 56761927, "link": "https://stackoverflow.com/questions/56761927/whats-the-logic-behind-the-output", "closed_reason": "Duplicate", "title": "Whats the logic behind the output", "body": "<p>Why does the following code prints 64 for i and 4 for j.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define sqr(a) a*a\nvoid main()\n{\n    int i;\n    i=64/sqr(4);\n    int j=64/16;\n    printf(\"%d\\n\",i);\n    printf(\"%d\",j);\n}\n</code></pre>\n\n<p><strong>Output shown below</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/g9oc7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g9oc7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "sockets", "tcp", "posix"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 4, "creation_date": 1561494076, "post_id": 56761454, "comment_id": 100080319, "body": "<code>recv()</code> returns 0 if the connection has been closed gracefully by the peer (by sending a <code>FIN</code>), otherwise it returns <code>SOCKET_ERROR</code> (-1) on any error, including abnormal disconnects (ie, <code>WSAECONNRESET</code>, <code>WSAECONNABORTED</code>, etc). This is <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winsock/nf-winsock-recv\" rel=\"nofollow noreferrer\">documented on MSDN</a>, read it more carefully."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 2, "creation_date": 1561494331, "post_id": 56761454, "comment_id": 100080444, "body": "<code>*mysock</code> = most probably wrong btw."}, {"owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "edited": false, "score": 0, "creation_date": 1561494886, "post_id": 56761454, "comment_id": 100080652, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/155243/why-is-it-impossible-without-attempting-i-o-to-detect-that-tcp-socket-was-grac\">Why is it impossible, without attempting I/O, to detect that TCP socket was gracefully closed by peer?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "is_accepted": false, "score": 1, "last_activity_date": 1561495497, "creation_date": 1561495497, "answer_id": 56761762, "question_id": 56761454, "link": "https://stackoverflow.com/questions/56761454/how-to-know-end-of-tcp-session/56761762#56761762", "title": "How to know end of tcp session?", "body": "<p>(I'm assuming you're referring to TCP as the FIN is used only in that context).</p>\n\n<p>A call to <code>recv()</code> will tell you what you're looking for: it will return <code>0</code> when a FIN was received (i.e. the remote socket output was <code>shutdown</code>) (already stated by @RemyLebeau, and <code>-1</code> in case of error).</p>\n\n<p>I'm using this answer as an opportunity to warn you about <em>not</em> comparing its return value with the number of bytes expected to read, as TCP does not guarantee a single <code>send()</code> can be read with a single <code>read()</code>. So do <em>not</em> test <code>if (partresult &lt; RcvBytes) ...</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11699709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05c0fbc043982fd67cc11c5ccedfd28?s=128&d=identicon&r=PG&f=1", "display_name": "Tesla69", "link": "https://stackoverflow.com/users/11699709/tesla69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1561526237, "creation_date": 1561493961, "last_edit_date": 1561526237, "question_id": 56761454, "link": "https://stackoverflow.com/questions/56761454/how-to-know-end-of-tcp-session", "title": "How to know end of tcp session?", "body": "<p>everyone, i want to know when my tcp connection will be finished.\nI mean the next: my prog is a client and it sends any messages to server, but it doesn't know when the server will close connection (send FIN flag). \nIts look like handshake, prog send first msg, then receive and send next msg on the same socket, then serv send FIN - flag, thats mean end of tcp session or end of handshake as you like.\nMy target is to know when server say FIN, im using stream socket.</p>\n\n<p>I tryed to use var flags from  msdn doc <code>int recv(SOCKET s ... int flags);</code>. But now i think it isnt what im looking for...</p>\n\n<pre><code>int partresult = recv(*my_sock, RcvBytes, Size, 0);\n</code></pre>\n"}, {"tags": ["c", "gtk", "cairo"], "comments": [{"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561551458, "post_id": 56760950, "comment_id": 100100654, "body": "Why do you want to redraw only part of a widget? In general, your code should always be able to redraw the full widget. Also, by the time the drawing code runs, the background was most likely already drawn, so the old content is gone. Your example code seems to try to copy the old content...?"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561580027, "post_id": 56760950, "comment_id": 100115474, "body": "@UliSchlachter Yes it does. Assume I have the widget drawn in cairo_t at some point. I want to later draw it on top of the widget so that it seems like it restored previous state. My code tries to change the surface of the cairo_t passed in draw signal handler."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561724177, "post_id": 56760950, "comment_id": 100167487, "body": "Well... what your code does is to create two new, empty surfaces (one explicitly, one implicitly as a group). One is set as the source for drawing to the other. Then it does nothing (filling and stroking and empty path). Finally, it draws the group (which is still an empty surface, so most likely fully transparent) to the actual drawing target. I do not really know what you mean with &quot;tries to change the surface&quot;. Where should the content for drawing come from?"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561758716, "post_id": 56760950, "comment_id": 100181167, "body": "@UliSchlachter How are both empty? <code>cr</code> as passed from the draw signal handler should contain widget area to be redrawn."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561758867, "post_id": 56760950, "comment_id": 100181205, "body": "I changed the code to do what I want to achieve in another way and I have a cairo_t containing a snapshot of the widget obtained with <code>gtk_widget_draw</code> and I would want to draw that on the widget when it is supposed to re-draw itself in the draw signal handler, but I have no idea how to do it. I tried setting <code>cr</code>&#39;s source as it is in the code here above, but nothing happens."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561796125, "post_id": 56760950, "comment_id": 100185606, "body": "Empty in the sense: All pixels are transparent. Not empty in the sense of &quot;empty area&quot;."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561796184, "post_id": 56760950, "comment_id": 100185617, "body": "A cr (well, <code>cairo_t</code>) does not contain any images. A cairo surface does. So, if I understand you correctly: You want to create a separate cairo surface (e.g. via <code>cairo_image_surface_create</code>) and draw your content to that. Now you can just copy that surface to other surfaces via <code>cairo_set_source_surface</code> and <code>cairo_paint</code>. Right? (Or: What do you mean with &quot;a snapshot of the widget&quot;? Since you are drawing the widget yourself, you already should have the widget&#39;s content, shouldn&#39;t you?)"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561894212, "post_id": 56760950, "comment_id": 100201443, "body": "@UliSchlachter Yes you understand correctly for the first. But no I don&#39;t draw the widget myself! I connect a draw signal handler on a GtkTextView (a GtkSourceView actually). At some point I call gtk_widget_draw() to save how the widget looked at this point and the function returns a cairo_t. Later on I want to draw that cairo_t (its surface as you mentioned) on the GtkTextView so that it looks as it is in its old state."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561894388, "post_id": 56760950, "comment_id": 100201483, "body": "That way I can make GtkTextView display earlier states of good text alongside new text, even if the textbuffer is empty or contains different data."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1561984688, "post_id": 56760950, "comment_id": 100223923, "body": "<code>At some point I call gtk_widget_draw() to save how the widget looked at this point and the function returns a cairo_t. </code> I do not see <code>gtk_widget_draw()</code> returning a <code>cairo_t*</code>. According to the API docs, you give a <code>cairo_t*</code> to this function when you call it, and the widget is then drawn to that cairo context. So, if you want to get a screenshot of a widget, you have to create a new cairo surface (e.g. <code>cairo_image_surface_create()</code>), create a cairo context for this (<code>cairo_create()</code>) and call <code>gtk_widget_draw</code>. Now, the widget is drawn to your surface."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1562052752, "post_id": 56760950, "comment_id": 100245587, "body": "@UliSchlachter Yep, I already do that. I know it works, because I&#39;ve exported it to png. I created the cairo_t and the surface with the dimensions of the allocated width/height of the widget."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1562066458, "post_id": 56760950, "comment_id": 100252701, "body": "Sorry, but then I still fail to understand the question. If you have a <code>cairo_surface_t</code>, you can draw it to the widget via <code>cairo_set_source_surface</code> and <code>cairo_paint</code>."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1562081787, "post_id": 56760950, "comment_id": 100261925, "body": "@UliSchlachter Correct. At least I tried so, but nothing happens. The widget is not updated. Nothing happens."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1562254882, "post_id": 56760950, "comment_id": 100328998, "body": "Try <code>cairo_set_source_rgb(cr, 1, 0, 0); cairo_paint(cr);</code>. If the widget does not become completely red, then the problem is somewhere around your &quot;intercept the drawing of the widget&quot;-code. You could open a new question related to that (but I would kind of expect people to tell you that you should not mess with the drawing of widgets like that)."}], "owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561968635, "creation_date": 1561491537, "last_edit_date": 1561968635, "question_id": 56760950, "link": "https://stackoverflow.com/questions/56760950/how-do-i-redraw-only-portion-of-a-gtkwidget", "title": "How do I redraw only portion of a GtkWidget", "body": "<p>I want to redraw only part of a GtkTextView widget. In the draw signal handler I tried many things for example:</p>\n\n<pre><code>GdkRectangle rect;\n\ngdk_cairo_get_clip_rectangle(cr, &amp;rect);\n\ncairo_surface_t* surface = cairo_get_target(cr);\ncairo_surface_t* newsurf = cairo_surface_create_similar(surface, cairo_surface_get_content(surface), rect.width - 50, rect.height);\n\ncairo_push_group(cr);\ncairo_set_source_surface(cr, newsurf, rect.x + 10, rect.y + 40);\ncairo_fill_preserve(cr);\ncairo_stroke(cr);\ncairo_pop_group_to_source(cr);\ncairo_paint(cr);\n</code></pre>\n\n<p>except that nothing really happens. How do I re-draw only a rect of the dirty clip region in <code>cr</code> or how (as I am trying) to modify <code>cr</code> so that the surface area has different dimensions?</p>\n\n<hr>\n\n<p>To clarify further - I don't draw my own things. I want to set my own surface in the cairo_t passed in the draw callback of the GtkTextView for greater control of how the widget is rendered naturally. This new surface may be the same as the source surface in <code>cr</code>, but cropped or an earlier \"snapshot\" of the widget obtained with <code>gtk_widget_draw()</code></p>\n"}, {"tags": ["c", "function", "main"], "comments": [{"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 3, "creation_date": 1561491556, "post_id": 56760942, "comment_id": 100079330, "body": "OS asks main.. did anything wrong happen? It returns error code 0.. meaning nothing wrong.. Also, who can use the returned value? A parent process can.. For example if you create a child process and it returns -1 or something, the parent can know that it failed to do its duty."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1561491630, "post_id": 56760942, "comment_id": 100079363, "body": "Did your program fail? No, it didn&#39;t... so it returned zero (aka false)"}, {"owner": {"reputation": 6701, "user_id": 3591273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e9f02f036080c8be4e2abfcf753be75?s=128&d=identicon&r=PG", "display_name": "Nikos M.", "link": "https://stackoverflow.com/users/3591273/nikos-m"}, "edited": false, "score": 0, "creation_date": 1561491704, "post_id": 56760942, "comment_id": 100079397, "body": "Essentially main returns an integer error code if error happens else zero (=NO ERROR ALL FINE). C still interprest 1 as true and 0 as false if used as such in boolean expressions"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1561492725, "post_id": 56760942, "comment_id": 100079799, "body": "It is not a common convention for C functions to return true/false for success. It is much more common to return 0 on success or an error code on failure."}], "answers": [{"comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1561492005, "post_id": 56761009, "comment_id": 100079521, "body": "Never thought of 0 as &quot;error value is false&quot;.  That&#39;s a nice way to think about it."}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1561492526, "post_id": 56761009, "comment_id": 100079707, "body": "Not just positive values. But negative values too. I&#39;ve seen programs return -9 when killed or -1, etc. :) but anyway, +1 from me."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 1, "creation_date": 1561492718, "post_id": 56761009, "comment_id": 100079792, "body": "@Brandon Not on Unix."}, {"owner": {"reputation": 7561, "user_id": 1627348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0169513b14084f169c7d5126885a6e0?s=128&d=identicon&r=PG", "display_name": "teppic", "link": "https://stackoverflow.com/users/1627348/teppic"}, "edited": false, "score": 0, "creation_date": 1561497126, "post_id": 56761009, "comment_id": 100081389, "body": "Worth mentioning too that this is the only function where it will return 0 if you don&#39;t specify a return and it falls off the end of the block."}], "tags": [], "owner": {"reputation": 2531, "user_id": 6084317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4295c9b1ada748080d7a123f7263ae69?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Minnix", "link": "https://stackoverflow.com/users/6084317/edward-minnix"}, "is_accepted": true, "score": 7, "last_activity_date": 1561491815, "creation_date": 1561491815, "answer_id": 56761009, "question_id": 56760942, "link": "https://stackoverflow.com/questions/56760942/wrong-returned-value-in-main-function/56761009#56761009", "title": "Wrong returned value in main function?", "body": "<p>It's essentially what @Brandon already said in the comments. </p>\n\n<p><code>main</code> is supposed to return the <a href=\"https://en.wikipedia.org/wiki/Exit_status\" rel=\"noreferrer\">exit/error code</a> of the program. In the Unix convention, <code>0</code> is used to indicate <em>no error</em> (the error value is \"false\"). And then positive values are used for indicating that there is an error and what error it was.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1561491957, "creation_date": 1561491957, "answer_id": 56761044, "question_id": 56760942, "link": "https://stackoverflow.com/questions/56760942/wrong-returned-value-in-main-function/56761044#56761044", "title": "Wrong returned value in main function?", "body": "<p>It's really just about the kind of question you ask a program when it finish.</p>\n\n<p>Case 1:</p>\n\n<blockquote>\n  <p>Did you fail?</p>\n</blockquote>\n\n<p>Case 2:</p>\n\n<blockquote>\n  <p>Did you pass?</p>\n</blockquote>\n\n<p>In the first case a \"good program\" will return false (aka zero)</p>\n\n<p>In the second case a \"good program\" will return true (aka non-zero).</p>\n\n<p>Consensus is to use Case 1, i.e. \"Did you fail?\". Therefore a non-failing program returns zero to say \"I did not fail\".</p>\n\n<p>The benefit of this approach is that non-zero values can be used to expressed different kind of failures while zero is alway \"no failure\"</p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 8, "last_activity_date": 1561493118, "last_edit_date": 1561493118, "creation_date": 1561492686, "answer_id": 56761193, "question_id": 56760942, "link": "https://stackoverflow.com/questions/56760942/wrong-returned-value-in-main-function/56761193#56761193", "title": "Wrong returned value in main function?", "body": "<p>Your logic would make sense if the return value of <code>main</code> were interpreted as a Boolean value, but it isn't. Returning from the initial call to <code>main</code> is like calling the <code>exit</code> function: It reports a termination status to the system you're running on.</p>\n\n<p>Standard C specifies 3 portable exit statuses:</p>\n\n<ul>\n<li><code>0</code>, indicating success</li>\n<li><code>EXIT_SUCCESS</code>, also indicating success</li>\n<li><code>EXIT_FAILURE</code>, indicating failure</li>\n</ul>\n\n<p>(The last two are macros defined in <code>&lt;stdlib.h&gt;</code>.)</p>\n\n<p>On Unix, any 8-bit value (0 .. 255) is allowed. All non-zero values are interpreted as error codes. There is no universal convention for what any given number means, just that <code>0</code> represents success and anything else some kind of failure.</p>\n\n<p>As for who can use the return value: On Unix, a parent process can use <code>wait</code> or <code>waitpid</code> to get the exit status of a terminated child.</p>\n\n<hr>\n\n<p>In the C standard library, functions that perform an action generally don't return a true/false status. (Tests such as <code>islower</code> or <code>isdigit</code> do, but they don't have any other effects.) For example, <code>remove</code> (which deletes a file) returns <code>0</code> on success and <code>-1</code> on error. This is also a common pattern with Unix system calls. For exmple, <code>open</code> returns a file descriptor (a non-negative integer) on success and <code>-1</code> on error.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1561498779, "creation_date": 1561498779, "answer_id": 56762371, "question_id": 56760942, "link": "https://stackoverflow.com/questions/56760942/wrong-returned-value-in-main-function/56762371#56762371", "title": "Wrong returned value in main function?", "body": "<p>There's a difference between what the C <em>language</em> considers <code>true</code> (non-zero) or <code>false</code> (zero) and what value(s) the <em>operating system</em> uses to indicate a normal program termination.</p>\n\n<p>To be strictly correct, C programs should exit with a code of either <code>EXIT_SUCCESS</code> for normal program termination or <code>EXIT_FAILURE</code> for abnormal termination.  <code>EXIT_SUCCESS</code> will map to whatever code the underlying platform uses to indicate success, which may or may not be <code>0</code>.  </p>\n"}], "owner": {"reputation": 232, "user_id": 10816437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9343c28d70ad2b3c2caeede956652e1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/10816437/ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 56761009, "answer_count": 4, "score": 2, "last_activity_date": 1561498779, "creation_date": 1561491496, "question_id": 56760942, "link": "https://stackoverflow.com/questions/56760942/wrong-returned-value-in-main-function", "title": "Wrong returned value in main function?", "body": "<p>I previously read that 0 in C-Language refers to false while 1 is true.\nAnd have noticed that the main function returns 0 but why is that? in case all of my code ran successfully it should return true (1).\nAnother related question, I still can't understand who can use the returnable value? since no other function called the main function inside my program so nothing can know if my program ran well or not.\nI am a little bit confused.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1561491454, "post_id": 56760892, "comment_id": 100079292, "body": "Only static variables get initialized to zero. Since your code is not complete, it&#39;s impossible to tell, but your <code>mrr</code> variable might be &quot;auto&quot;, in which case it is not initialized."}, {"owner": {"reputation": 11660, "user_id": 2055998, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/2Vx3A.jpg?s=128&g=1", "display_name": "PM 77-1", "link": "https://stackoverflow.com/users/2055998/pm-77-1"}, "edited": false, "score": 0, "creation_date": 1561491457, "post_id": 56760892, "comment_id": 100079297, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3602827/what-is-the-behavior-of-integer-division\">What is the behavior of integer division?</a>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1561491930, "post_id": 56760892, "comment_id": 100079496, "body": "Find where you read that arrays are initialized to zero.  See if it includes conditions on the claim.  If the claim is indeed a blanket statement that arrays are always initialized to zero, then note the author and ignore everything they say about C.  (Or, at least be extremely wary of any information they provide.)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 11660, "user_id": 2055998, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/2Vx3A.jpg?s=128&g=1", "display_name": "PM 77-1", "link": "https://stackoverflow.com/users/2055998/pm-77-1"}, "edited": false, "score": 1, "creation_date": 1561492752, "post_id": 56760892, "comment_id": 100079811, "body": "@PM77-1: Where do you see an integer division?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561493092, "post_id": 56760892, "comment_id": 100079935, "body": "<i>Second, the following code returns a totally unexpected value (The Average) of 431374336.000000</i>  Please post <b>all</b> of your code required to duplicate that behavior.  It&#39;s not apparent what could cause that from the code you posted.  (Also - don&#39;t ask two questions in one.)"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1561491711, "creation_date": 1561491711, "answer_id": 56760985, "question_id": 56760892, "link": "https://stackoverflow.com/questions/56760892/wrong-values-inside-of-array/56760985#56760985", "title": "Wrong values inside of array", "body": "<p>Objects defined inside functions without <code>static</code> or <code>_Thread_local</code> are not automatically initialized and have indeterminate values. To ensure the array <code>mrr</code> is initialized, define it with <code>int mrr[2][3] = { 0 };</code>, which will initialize it to all zeros.</p>\n\n<p>The code in the second question is incomplete, but, presumably, the array is defined in the calling function and is not initialized, so its values are indeterminate.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561492055, "post_id": 56760999, "comment_id": 100079538, "body": "Objects defined (not merely declared) inside functions that are not static or thread local have <i>indeterminate</i> values; they are not <i>undefined</i>. These are technical terms defined by the C standard and should be used correctly."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561492072, "post_id": 56760999, "comment_id": 100079550, "body": "When an object has an indeterminate value, that does not mean it has whatever value was last written to the memory it happens to occupy. When a value is <i>indeterminate</i>, that does not just mean that its initial value is undetermined but that each use of it is independently indeterminate\u2014a C implementation might use a value from memory at one moment and a value from a register at another."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561493458, "post_id": 56760999, "comment_id": 100080080, "body": "Every definition is a declaration, but not every declaration is a definition. As the page you link to notes, <code>extern int a;</code> declares but does not define <code>a</code>."}, {"owner": {"reputation": 96, "user_id": 7649168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UksQ2C7AUiI/AAAAAAAAAAI/AAAAAAAAB9Q/8fSseNqVX2I/photo.jpg?sz=128", "display_name": "b-frid", "link": "https://stackoverflow.com/users/7649168/b-frid"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561493789, "post_id": 56760999, "comment_id": 100080222, "body": "(Comment Deleted/Reposted, as I botched the last edit and ran out of time). Duly noted, and answer edited. However, concerning your first point... in the C language a variable [as opposed to a function] &#39;declared&#39; is the same in effect as a variable &#39;defined&#39;, at least where the &#39;extern&#39; keyword is not used, according to this source: <a href=\"https://www.geeksforgeeks.org/difference-between-definition-and-declaration/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 7561, "user_id": 1627348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0169513b14084f169c7d5126885a6e0?s=128&d=identicon&r=PG", "display_name": "teppic", "link": "https://stackoverflow.com/users/1627348/teppic"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561494585, "post_id": 56760999, "comment_id": 100080525, "body": "@EricPostpischil have things changed in the standard since C99? I always thought trying to read an uninitialised variable before it is set was undefined."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 7561, "user_id": 1627348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0169513b14084f169c7d5126885a6e0?s=128&d=identicon&r=PG", "display_name": "teppic", "link": "https://stackoverflow.com/users/1627348/teppic"}, "edited": false, "score": 0, "creation_date": 1561497614, "post_id": 56760999, "comment_id": 100081553, "body": "@teppic: It is complicated. The value is indeterminate. So it could be a trap value, so reading it can result in undefined behavior. But some implementations do not have trap values for some types, so reading them cannot cause undefined behavior due to a trap. And character types are special. But there is also a special rule that reading the value of an uninitialized object that \u201ccould have been\u201d declared <code>register</code> has undefined behavior. I do not recall which C standard that first appeared in. Arrays cannot be <code>register</code>, so it does not apply to them."}, {"owner": {"reputation": 7561, "user_id": 1627348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d0169513b14084f169c7d5126885a6e0?s=128&d=identicon&r=PG", "display_name": "teppic", "link": "https://stackoverflow.com/users/1627348/teppic"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561497810, "post_id": 56760999, "comment_id": 100081613, "body": "@EricPostpischil Thanks for the response. After asking I had a look in the most reliable book I know on C (C Programming: A Modern Approach) and the author&#39;s unusually vague on it, just saying the results are unpredictable and may cause a crash."}, {"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561501949, "post_id": 56760999, "comment_id": 100082744, "body": "@EricPostpischil I can&#39;t understand why this behaviour occurs in c language while it doesn&#39;t happen in c# or any other language? what&#39;s the difference if it was declared inside a function or not?"}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561505226, "post_id": 56760999, "comment_id": 100083423, "body": "@Defender : &quot;why this behaviour occurs in c language while it doesn&#39;t happen in c# or any other language&quot; : because those are other languages;  the designers of other languages made different choices about how such things should be interpreted by a compiler ... perhaps purposefully compensating for this aspect of C, since it can lead to this kind of pitfall for new developers"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561516435, "post_id": 56760999, "comment_id": 100085337, "body": "@Defender: One of the goals of C was to be a lightweight language. Objects defined outside functions have static storage duration, a consequence of which is that they can be initialized largely as part of loading the program. In contrast, objects defined inside functions (that are not static or thread local) have automatic storage duration, a consequence of which is they would have to be initialized each time execution enters their block. That is a run-time burden that can be discarded by not automatically initializing them."}, {"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561571923, "post_id": 56760999, "comment_id": 100112356, "body": "@b-frid But my array is not defined inside a function, it&#39;s inside the main"}, {"owner": {"reputation": 96, "user_id": 7649168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UksQ2C7AUiI/AAAAAAAAAAI/AAAAAAAAB9Q/8fSseNqVX2I/photo.jpg?sz=128", "display_name": "b-frid", "link": "https://stackoverflow.com/users/7649168/b-frid"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561573613, "post_id": 56760999, "comment_id": 100113104, "body": "@Defender main is also a function (albeit a special one, in the sense that it&#39;s the program&#39;s &quot;launch point&quot;, so to speak)."}], "tags": [], "owner": {"reputation": 96, "user_id": 7649168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UksQ2C7AUiI/AAAAAAAAAAI/AAAAAAAAB9Q/8fSseNqVX2I/photo.jpg?sz=128", "display_name": "b-frid", "link": "https://stackoverflow.com/users/7649168/b-frid"}, "is_accepted": false, "score": 0, "last_activity_date": 1561492886, "last_edit_date": 1561492886, "creation_date": 1561491791, "answer_id": 56760999, "question_id": 56760892, "link": "https://stackoverflow.com/questions/56760892/wrong-values-inside-of-array/56760999#56760999", "title": "Wrong values inside of array", "body": "<p>By default, [the values of] an array defined inside a function (i.e. a local array) is indeterminate. Global (i.e. static) variables, on the other hand, are initialized to 0 by default. See this related post: <a href=\"https://stackoverflow.com/questions/1414215/initial-value-of-int-array-in-c\">initial value of int array in C</a></p>\n\n<p>To address your issue, simply initialize your array manually, with something like </p>\n\n<pre><code>for (int r=0;r&lt;2;r++)\n{\n    for (int c=0; c&lt;3; c++) {\n        mrr[r][c] = 0;\n        printf(\"[%d],[%d]:%d\\n\",r,c,mrr[r][c]);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561506162, "post_id": 56762720, "comment_id": 100083605, "body": "Thanks, But still I have some questions left. If it&#39;s expecting an array of type int and i sent double why this would change the result in 360 degrees. I still didn&#39;t get an answer to that. BTW, I am using GCC with eclipse on windows, it just showed small-yellow alert nothing more."}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561508695, "post_id": 56762720, "comment_id": 100084034, "body": "@Defender : I&#39;ll be happy to clarify; I&#39;m going to post a second answer so that I can show you some code that illustrates what&#39;s going on with the type disparity; I&#39;ll post that supplemental answer shortly"}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561510630, "post_id": 56762720, "comment_id": 100084365, "body": "@Defender : in addition to posting my supplemental answer just now, I encourage you to pay careful attention to those small yellow alerts -- they are warnings about something that is not prohibited by C syntax, but will likely lead to unexpected and/or unintended results"}], "tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": false, "score": 0, "last_activity_date": 1561504860, "last_edit_date": 1561504860, "creation_date": 1561500941, "answer_id": 56762720, "question_id": 56760892, "link": "https://stackoverflow.com/questions/56760892/wrong-values-inside-of-array/56762720#56762720", "title": "Wrong values inside of array", "body": "<p>Your question about uninitialized variables is well-covered by the comments and other answers; this answer is for your second question, about the unexpected output from <code>getAverage()</code>.</p>\n\n<p>You define <code>balance</code> as an array of <code>double</code>, but <code>getAverage()</code> is expecting an array of <code>int</code>.  When I change:</p>\n\n<pre><code>double getAverage(int arr[], int size) { ... }\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>double getAverage(double arr[], int size) { ... }\n</code></pre>\n\n<p>I get the expected result: 215.2.  The implicit type-conversion [1] in your original code is causing the unexpected behavior.</p>\n\n<p>Also, I don't know what compiler you are using, but when I compiled your original code [2], <code>gcc</code> threw this warning:</p>\n\n<pre><code>warning: incompatible pointer types passing 'double [5]' to parameter of type 'int *'\n</code></pre>\n\n<p>... which is a dead give-away that trouble is brewing.  If your compiler doesn't generate this warning, or if you have warnings suppressed, or if they are logged to a file or something that you aren't looking at, I recommend making them visible again; paying attention to compiler warnings has saved me untold hours of grief.</p>\n\n<p>[1] \"type conversion\" isn't maybe the best term here; type conversion is generally benign, even though there are some gotchas; what's happening here is that the bytes that make up the <code>double</code> value are being read as an <code>int</code>, and the byte structure of those two data types is very different; that's why the output of your original code makes it seem like it's dealing with such crazy-large numbers : e.g., the bytes used to represent \"17\" as a double when read as an <code>int</code> become a very, very different number.  Worse, stepping through the bytes that make up an array of <code>double</code> values as if it were an array of <code>int</code> values, it probably isn't even looking at the array elements at the proper element boundaries.  In short, the type disparity is causing havoc.</p>\n\n<p>[2] By \"original code\" I mean your code with enough overhead code to make it compile, like <code>include</code> pragmas and a <code>main()</code> body; I agree in general with the other comments about providing a complete, minimal example.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561639452, "post_id": 56763785, "comment_id": 100136916, "body": "Thanks for this perfect explanation, just a small question as some mentioned I need to give default values for my array manually but should I do the same for variables like int and char? I mean would they get default values inside of functions or not?"}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561640981, "post_id": 56763785, "comment_id": 100137943, "body": "@Defender : it makes for explicit, readable code to initialize variables with a default value, regardless of a language&#39;s rules on the matter; explicit, readable code is easier to work with -- both for yourself and also on a team -- and eliminates the ambiguity;  it&#39;s not ambiguous to a true expert in a given language, but until you are an expert it will help you, and you won&#39;t always be working with true experts; and, like me, you might end up working in several languages, where the rules about this vary;  make a habit of initializing variables -- it mitigates many types of problems"}, {"owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561642364, "post_id": 56763785, "comment_id": 100138856, "body": "Sure I will take this advice, but this didn&#39;t answer my question will this behavior only affect int arrays or chars and any other variable deceleration inside a function as well?"}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "edited": false, "score": 0, "creation_date": 1561642895, "post_id": 56763785, "comment_id": 100139253, "body": "@Defender : I answered the way I did because in my experience a language&#39;s rules on this are less important than creating readable code; but the direct answer is that there is no difference between arrays and non-arrays when it comes to C&#39;s automatic initialization rules; the advice from others about arrays applies to non-arrays, too; notice, e.g., that Eric Postpischil&#39;s answer is about &quot;objects&quot; -- not just array objects"}], "tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": true, "score": 0, "last_activity_date": 1561511509, "last_edit_date": 1561511509, "creation_date": 1561510507, "answer_id": 56763785, "question_id": 56760892, "link": "https://stackoverflow.com/questions/56760892/wrong-values-inside-of-array/56763785#56763785", "title": "Wrong values inside of array", "body": "<p>This supplemental answer is in response to the OP's comment on my earlier answer.  Defender asks:</p>\n\n<p>\"I have some questions left. If it's expecting an array of type int and i sent double why this would change the result in 360 degrees. I still didn't get an answer to that.\"</p>\n\n<p>It'll be easier to illustrate this with a type clash between <code>short int</code> and <code>int</code>, but the same idea applies to <code>int</code> vs. <code>double</code>.</p>\n\n<p>Take a look at this code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid functionA(short int[], int size);\n\nint main(void) {\n\n    printf(\"sizeof short int : %lu\\n\", sizeof(short int));\n    printf(\"sizeof int       : %lu\\n\", sizeof(int));\n    printf(\"\\n\\n\");\n\n    printf(\"====  sending short int to functionA() ====\\n\");\n    short int shortdata[4] = {10, 20, 50, 100};\n    functionA(shortdata, 4);\n\n    printf(\"====  sending int to functionA() ====\\n\");\n    int intdata[4] = {10, 20, 50, 100};\n    functionA(intdata, 4);\n}\n\nvoid functionA(short int arr[], int size) {\n\n   int i;\n\n   char* ptr;\n\n   for (i = 0; i &lt; size; ++i) {\n      ptr = &amp;arr[i];\n      printf(\"bytes of 'arr[%d]' : %x %x\\n\", i, *ptr, *(ptr+1));\n\n      printf(\"value of 'arr[%d]' : %d\\n\", i, arr[i]);\n\n      printf(\"\\n\");\n   }\n}\n</code></pre>\n\n<p>which produces this output:</p>\n\n<pre><code>sizeof short int : 2\nsizeof int       : 4\n\n\n====  sending short int to functionA() ====\nbytes of 'arr[0]' : a 0\nvalue of 'arr[0]' : 10\n\nbytes of 'arr[1]' : 14 0\nvalue of 'arr[1]' : 20\n\nbytes of 'arr[2]' : 32 0\nvalue of 'arr[2]' : 50\n\nbytes of 'arr[3]' : 64 0\nvalue of 'arr[3]' : 100\n\n====  sending int to functionA() ====\nbytes of 'arr[0]' : a 0\nvalue of 'arr[0]' : 10\n\nbytes of 'arr[1]' : 0 0\nvalue of 'arr[1]' : 0\n\nbytes of 'arr[2]' : 14 0\nvalue of 'arr[2]' : 20\n\nbytes of 'arr[3]' : 0 0\nvalue of 'arr[3]' : 0\n</code></pre>\n\n<p>The first two lines of output show that on my machine, <code>short int</code> takes 2 bytes of memory and <code>int</code> takes 4 bytes.</p>\n\n<p><code>functionA()</code> is expecting a <code>short int</code> array, and when I send it a <code>short int[]</code>, we see the expected output.  The bytes that make up the first element of the array are <code>0x0a 0x00</code>, which in decimal is \"10\"; the bytes that make up the second element of the array are <code>0x14 0x00</code>, which in decimal is \"20\"; and so on.</p>\n\n<p>But when I send <code>functionA()</code> an <code>int[]</code>, I'm sending 4 bytes per element, so when it iterates through the array, it doesn't see the elements correctly.  It does okay with the first element, but only because it's a small number; when it looks for the second element, it is actually looking at the last two bytes of the first element, so it sees <code>0x00 0x00</code>, or \"0\"; when it looks for the third element it is looking at the first two bytes of the second element, and sees <code>0x14 0x00</code>, or \"20\"; and so on.</p>\n\n<p>Another way to show it is that the bytes of <code>shortdata</code> are this:</p>\n\n<pre><code>0a 00 14 00 32 00 64 00\n</code></pre>\n\n<p>and the bytes of <code>intdata</code> are this:</p>\n\n<pre><code>0a 00 00 00 14 00 00 00 32 00 00 00 64 00 00 00\n</code></pre>\n\n<p>Because <code>functionA()</code> is expecting a <code>short int[]</code>, it treats <code>intdata</code> that way -- two bytes per element -- and sees as its elements:</p>\n\n<pre><code>arr[0] : 0a 00\narr[1] : 00 00\narr[2] : 14 00\narr[3] : 00 00\n</code></pre>\n\n<p>It's a similar story with your code.  Your <code>getAverage()</code> is expecting a <code>int[]</code>, so when you send it a <code>double[]</code>, it is not seeing the bytes the way you intend.</p>\n\n<p>(The clash between <code>int</code> and <code>double</code> is even more drastic than between <code>short int</code> and <code>int</code>; this is because in addition to being different sizes (on most modern machines, <code>int</code> is 4 bytes and <code>double</code> is 8 bytes), floating-point numbers are stored as an exponent and a mantissa -- so the byte values have an entirely different meaning.)</p>\n\n<p>I hope this explanation helps, and I encourage you to experiment with the code above, and read about the internals of C memory as it pertains to allocating and handling variables.  As a new C programmer, you will gain insight in to fundamentals that will help you for as long as you continue programming in C.</p>\n"}], "owner": {"reputation": 19, "user_id": 11699594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6526d396abd795c46b7a6d803d326adf?s=128&d=identicon&r=PG&f=1", "display_name": "Defender", "link": "https://stackoverflow.com/users/11699594/defender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 56763785, "answer_count": 4, "score": 0, "last_activity_date": 1561511509, "creation_date": 1561491239, "question_id": 56760892, "link": "https://stackoverflow.com/questions/56760892/wrong-values-inside-of-array", "title": "Wrong values inside of array", "body": "<p>I am a new C-Language learner and faced 2 problems. (Written in the same page because I think it's the same root cause for both)</p>\n\n<pre><code>int mrr [2][3];\n\nfor (int r=0;r&lt;2;r++)\n{\n    for (int c=0; c&lt;3; c++)\n        printf(\"[%d],[%d]:%d\\n\",r,c,mrr[r][c]);\n}\n</code></pre>\n\n<p>I read that in case we don't provide a value to a newly created array it gets a default value of 0 inside all of its cells. But when I print the result it showed:</p>\n\n<pre><code>[0],[0]:0\n[0],[1]:4201072\n[0],[2]:6422224\n[1],[0]:6422280\n[1],[1]:6422476\n[1],[2]:1977208000\n</code></pre>\n\n<p>Second, the following code returns a totally unexpected value (The Average) of 431374336.000000 </p>\n\n<pre><code>double getAverage(int arr[], int size) {\n\n   int i;\n   double avg;\n   double sum = 0;\n\n   for (i = 0; i &lt; size; ++i) {\n      sum += arr[i];\n   }\n   avg = sum / size;\n\n   return avg;\n}\n\ndouble balance[5] = {1000, 2, 7, 17, 50};\ndouble avg = getAverage(balance, 5 );\nprintf( \"Average value is: %f \", avg );\n</code></pre>\n"}, {"tags": ["javascript", "c", "transfer"], "comments": [{"owner": {"reputation": 20114, "user_id": 691711, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bf26891a2ec4eca6dd1962a6804f5a40?s=128&d=identicon&r=PG", "display_name": "zero298", "link": "https://stackoverflow.com/users/691711/zero298"}, "edited": false, "score": 0, "creation_date": 1561491427, "post_id": 56760862, "comment_id": 100079281, "body": "I mean, I&#39;d probably spawn the node process as a child process of the C program in a separate thread and then communicate over stdin/out/err pipes.  The core piece here is the inter-process communication (IPC).  I think your question may be too broad without an attempt at the actual IPC in question."}, {"owner": {"reputation": 1179, "user_id": 3760802, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vJXTe.jpg?s=128&g=1", "display_name": "JacksonHaenchen", "link": "https://stackoverflow.com/users/3760802/jacksonhaenchen"}, "edited": false, "score": 0, "creation_date": 1561493051, "post_id": 56760862, "comment_id": 100079917, "body": "Check out using a local MQ server like RabbitMQ to communicate messages in a queue based manner."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1561493257, "post_id": 56760862, "comment_id": 100080003, "body": "Sockets can be used in either blocking or non-blocking mode. What is that infinite loop actually doing? Is it CPU bound (doing calculations) or IO bound (waiting for input/output from other systems) most of the time?"}, {"owner": {"reputation": 41, "user_id": 10112185, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mGX_V3jNYG4/AAAAAAAAAAI/AAAAAAAABbM/S7Y-DR2y6JI/photo.jpg?sz=128", "display_name": "Eryl Kenner", "link": "https://stackoverflow.com/users/10112185/eryl-kenner"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1561493430, "post_id": 56760862, "comment_id": 100080066, "body": "@melpomene It&#39;s doing a bunch of math (using the most recent sensor data). When it gets new sensor data I want it to use those values instead, and also send out its most recent calculation back to the node.js process."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1561493534, "post_id": 56760862, "comment_id": 100080110, "body": "Sounds like you could use two threads, one for calculations and one for (possibly even blocking) I/O."}], "owner": {"reputation": 41, "user_id": 10112185, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mGX_V3jNYG4/AAAAAAAAAAI/AAAAAAAABbM/S7Y-DR2y6JI/photo.jpg?sz=128", "display_name": "Eryl Kenner", "link": "https://stackoverflow.com/users/10112185/eryl-kenner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561491131, "creation_date": 1561491131, "question_id": 56760862, "link": "https://stackoverflow.com/questions/56760862/non-blocking-data-transfer-between-separate-c-and-javascript-processes", "title": "Non-blocking data transfer between separate C and Javascript processes", "body": "<h2>The Goal</h2>\n\n<p>I have two processes running:</p>\n\n<ol>\n<li>Node.js server which handles external communication (to other computers)</li>\n<li>C code which runs in an infinite loop doing real-time processing</li>\n</ol>\n\n<p>The node.js server will receive data from an external computer, send it to the C code (which is already running), wait for a reply, and send that reply back to an external computer.</p>\n\n<p>HOWEVER, the C code cannot wait for input from the node.js server. It needs to be continuously running using the most recent data from the js code (updating those recent values each time new data is received). In other words, the C code needs non-blocking input from the node.js server. The node.js server should get an event (bound to a callback) each time the C code periodically sends it information back.</p>\n\n<h2>What I have done</h2>\n\n<ul>\n<li>The node.js code already handles external IO correctly (it's fairly complete)</li>\n<li>The C code in isolation does the task I want, just without getting data from the node.js code</li>\n</ul>\n\n<p>I am now trying to combine them so that the C code gets its sensor data from the node.js code (as I described above).</p>\n\n<h2>How I think I can do it</h2>\n\n<p>My current best guess of how to do this is using sockets (I think they're non-blocking?). I've never done this before, though, so before I spend a bunch of time learning about how sockets work, and writing a bunch of code, I want to make sure that this is a method which might actually work. So, I want to see if anyone has any suggestions on the easiest way to achieve what I described. If it does turn out to be sockets than at least I know I'm not wasting my time. Thanks for any suggestions!</p>\n"}, {"tags": ["c", "math", "opengl", "shader"], "comments": [{"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 1, "creation_date": 1561563860, "post_id": 56760509, "comment_id": 100108621, "body": "It might help if you specify what exactly you are trying to achieve. You seem to have some circular regions. And then you want to color it differently if a point is in any of the regions? Why the nested loop?"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 5116074, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pWHjZveN-BU/AAAAAAAAAAI/AAAAAAAAADk/1DmYWdfRrwY/photo.jpg?sz=128", "display_name": "Jugbot", "link": "https://stackoverflow.com/users/5116074/jugbot"}, "is_accepted": false, "score": 0, "last_activity_date": 1561669217, "creation_date": 1561669217, "answer_id": 56798411, "question_id": 56760509, "link": "https://stackoverflow.com/questions/56760509/draw-the-midpoint-lines-between-points/56798411#56798411", "title": "Draw the midpoint lines between points", "body": "<pre class=\"lang-c prettyprint-override\"><code>uniform int objects = 0;\nuniform vec2 positions[50];\nuniform float radii[50];\nuniform float meter = 64;\nvarying vec2 texPos;\nuniform vec2 cameraPosition;\nuniform float k1 = sqrt(2*50*50); //smoothness of cells\nuniform float k2 = sqrt(2*50*50)/4; //smoothness of cell walls\nuniform float lineWidth = 6;\n\n#ifdef VERTEX\nvec4 position(mat4 transform_projection, vec4 vertex_position)\n{\n    texPos = (cameraPosition + vertex_position.xy);\n    return transform_projection * vertex_position;\n}\n#endif\n\n#ifdef PIXEL\nfloat smin( float a, float b, float k )\n{\n    float h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n    return mix( b, a, h ) - k*h*(1.0-h);\n}\n\nvec4 effect( vec4 color, Image tex, vec2 texture_coords, vec2 screen_coords ) {\n  float finalmin = 0;\n  float bordermin = 99999;\n  int closestobj = -1;\n\n\n  float mindist = 99999;\n  for (int i = 0; i &lt; objects; i++) {\n    float dist = distance(positions[i], texPos) - radii[i];\n    if (closestobj == -1 || dist &lt; mindist) {\n      mindist = dist;\n      closestobj = i;\n    }\n  }\n\n  for (int i = 0; i &lt; objects; i++) {\n    for (int j = 0; j &lt; i; j++) {\n      float di = distance(positions[i], texPos) - radii[i];\n      float dj = distance(positions[j], texPos) - radii[j];\n      float sm = smin(di, dj, k1);\n      float m = min(di, dj);\n      if (sm &lt; finalmin) {\n        finalmin = sm;\n        if (closestobj == i || closestobj == j) {\n          bordermin = min(abs(di-dj), bordermin);\n        }\n      }\n    }\n  }\n  if (finalmin &lt; 0) {\n    if (smin(bordermin, abs(finalmin), k2) &lt; lineWidth) {\n    // if (bordermin &lt; lineWidth) {\n      color.a = 1;\n    }\n\n    return color;\n  }\n  return vec4(0);\n}\n#endif\n</code></pre>\n\n<p>Basically what I did was only render the midpoint line between two points if one of those two points was the closest point to the fragment.</p>\n"}], "owner": {"reputation": 82, "user_id": 5116074, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pWHjZveN-BU/AAAAAAAAAAI/AAAAAAAAADk/1DmYWdfRrwY/photo.jpg?sz=128", "display_name": "Jugbot", "link": "https://stackoverflow.com/users/5116074/jugbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1561669217, "creation_date": 1561489315, "last_edit_date": 1561668603, "question_id": 56760509, "link": "https://stackoverflow.com/questions/56760509/draw-the-midpoint-lines-between-points", "title": "Draw the midpoint lines between points", "body": "<p>I am making generated shapes in a fragment shader and part of it involves drawing the border between objects ie the dividing line between them.</p>\n\n<p>Currently I have:<br>\n<img src=\"https://i.imgur.com/4UUUDsj.png\" alt=\"img\">  </p>\n\n<p>And the desired effect is:<br>\n<img src=\"https://vinsol.com/wp-content/uploads/2014/12/vor1.png\" alt=\"img\">  </p>\n\n<p>(Note the shape that the lines are drawn in is not relevant)</p>\n\n<p>But the problem is there is a little bit sticking out in the center.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>uniform int objects = 0;\nuniform vec2 positions[50];\nuniform float radii[50];\nuniform float meter = 64;\nvarying vec2 texPos;\nuniform vec2 cameraPosition;\nuniform float k1 = sqrt(2*50*50); //smoothness of cells\nuniform float k2 = sqrt(2*50*50)/2; //smoothness of cell walls\nuniform float lineWidth = 6;\n\n#ifdef VERTEX\nvec4 position(mat4 transform_projection, vec4 vertex_position)\n{\n    texPos = (cameraPosition + vertex_position.xy);\n    return transform_projection * vertex_position;\n}\n#endif\n\n#ifdef PIXEL\nfloat smin( float a, float b, float k )\n{\n    float h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n    return mix( b, a, h ) - k*h*(1.0-h);\n}\n\nvec4 effect( vec4 color, Image tex, vec2 texture_coords, vec2 screen_coords ) {\n  float finalmin = 0;\n  float bordermin = 99999;\n  for (int i = 0; i &lt; objects; i++) {\n    for (int j = 0; j &lt; i; j++) {\n      float di = distance(positions[i], texPos) - radii[i];\n      float dj = distance(positions[j], texPos) - radii[j];\n      float sm = smin(di, dj, k1);\n\n      if (sm &lt; finalmin) {\n        finalmin = sm;\n        bordermin = min(abs(di-dj),bordermin);\n      }\n    }\n  }\n  if (finalmin &lt; 0) {\n    // if (smin(borderdist, abs(finalmin), k2) &lt; lineWidth) {\n      if (bordermin &lt; lineWidth) {\n      color.a = 1;\n    }\n\n    return color;\n  }\n  return vec4(0.1,0,0,1);\n}\n#endif\n</code></pre>\n\n<p>note this is love2d glsl which is why it is a little different</p>\n\n<p>EDIT: I solved my own problem</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 5, "creation_date": 1561488906, "post_id": 56760306, "comment_id": 100078236, "body": "<code>char buffer[bufferSize &#47; sizeof(char)];</code> - how much stack space do you think you have?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1561488968, "post_id": 56760306, "comment_id": 100078261, "body": "On a side note, I am not sure why people are saying this questions lacks MCVE. In my view, it does have correct MCVE."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1561488982, "post_id": 56760306, "comment_id": 100078267, "body": "You should wait till <code>read()</code> returns 0 before assuming you&#39;re at the end of the file."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1561489047, "post_id": 56760306, "comment_id": 100078301, "body": "Are you exceeding your stack size limit?"}, {"owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "edited": false, "score": 0, "creation_date": 1561489106, "post_id": 56760306, "comment_id": 100078331, "body": "Is there a way for me to check how much stack space i have? i have 16GM of ram."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1561489244, "post_id": 56760306, "comment_id": 100078384, "body": "I would use <code>malloc</code> instead of a VLA."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1561489250, "post_id": 56760306, "comment_id": 100078389, "body": "Stack space is generally very short. On a typical desktop PC you should expect only 1 MB to 10 MB of stack no matter how much RAM your system has. In other words, take @JohnnyMopp &#39;s advice about using <code>malloc</code>"}, {"owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "edited": false, "score": 0, "creation_date": 1561489325, "post_id": 56760306, "comment_id": 100078414, "body": "Is there a way for me to increase my stack space? So i can check if the problem really is that the file is too large?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1561489350, "post_id": 56760306, "comment_id": 100078423, "body": "<code>bufferSize &#47; sizeof(char)</code>... <code>sizeof(char)</code> is by definition 1, so that division is pointless. And, yes, unless <code>bufferSize</code> is always going to be a fairly small value, you&#39;ll probably want to use <code>malloc()</code> instead of a VLA."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1561489447, "post_id": 56760306, "comment_id": 100078460, "body": "It is not the file that is too large, it is <code>bufferSize</code> that is most likely too big."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1561489456, "post_id": 56760306, "comment_id": 100078462, "body": "@Regicide <code>ulimit -a</code> will tell you how much stack space a program can use. You can try increasing it too."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1561489457, "post_id": 56760306, "comment_id": 100078464, "body": "Setting the stack size is an implementation detail. It changes from compiler to compiler. Heck, C++ doesn&#39;t even require the system to have a stack. The language is specified such that if you can find a way to do it, you can use hamster wheels."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1561489563, "post_id": 56760306, "comment_id": 100078504, "body": "Assuming a gcc compiler because of Ububntu, so <a href=\"https://stackoverflow.com/questions/2275550/change-stack-size-for-a-c-application-in-linux-during-compilation-with-gnu-com\">Change stack size for a C++ application in Linux during compilation with GNU compiler</a> probably applies. Since you don&#39;t know how much stack you need when compiling, <code>malloc</code> is still the better option."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1561489724, "post_id": 56760306, "comment_id": 100078586, "body": "As a matter of fact, if you are going to allocate as much memory as the file size, you will end up in trouble sooner or later. You need to allocate fixed buffer size, and than reuse this buffer for multiple reads."}, {"owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1561489730, "post_id": 56760306, "comment_id": 100078590, "body": "Im currently working to see if its a stack related problem. @user4581301 how would i solve this correctly with malloc? i tried a few things using it but i got the same errors all the time"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1561489847, "post_id": 56760306, "comment_id": 100078632, "body": "When you used <code>malloc</code> did you remember to <code>free</code> your buffer when you were done with it?"}, {"owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "edited": false, "score": 0, "creation_date": 1561489879, "post_id": 56760306, "comment_id": 100078644, "body": "Yes i did free the buffer. Also: Currently it is a stack-problem. When i give a extremely high max stack size, i tried 10GB, the programm works. Obviously thats not an ideal solution then."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1561490348, "post_id": 56760306, "comment_id": 100078840, "body": "All you are doing is reading file X and writing the contents to file y, yes? You can read and write smaller chunks. There should be no reason you can&#39;t do this reading the file, say, 4kb at a time, writing the same 4 kb and then looping back around to get another 4k. You don&#39;t even need to know the file size with this approach, when you can&#39;t read any more data from the source file, you&#39;re done."}, {"owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "edited": false, "score": 0, "creation_date": 1561490533, "post_id": 56760306, "comment_id": 100078916, "body": "i am limited by the fact that the user is supposed to be able to enter the buffersize. Thats the reason it is a variable at all. So if i enter that the buffer should be 10MB big, it has to be 10MB big. So what i wouldwant to  be able to do is create, with malloc, an array, thats as big as the variable &quot;bufferSize&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1561490998, "post_id": 56760767, "comment_id": 100079115, "body": "Question is tagged <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>"}, {"owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "edited": false, "score": 0, "creation_date": 1561491043, "post_id": 56760767, "comment_id": 100079133, "body": "Option 1 is not possible, as it is a requirement for bufferSize to be a variable. Option 2 is not possible, as vectors arent in c. Thank you anyway :)"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1561493218, "post_id": 56760767, "comment_id": 100079985, "body": "Now it is tagged C. I found it the same way R Sahu did: It WAS tagged C++. If you&#39;re monitoring SO for new C++ questions, it shows up. If you didn&#39;t notice the tag was removed... Well, you probably give a C++ answer."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": -1, "last_activity_date": 1561493439, "last_edit_date": 1561493439, "creation_date": 1561490665, "answer_id": 56760767, "question_id": 56760306, "link": "https://stackoverflow.com/questions/56760306/copy-program-works-for-small-files-gives-segmentation-fault-on-lager-files/56760767#56760767", "title": "Copy-Program works for small files, gives segmentation fault on lager files", "body": "<blockquote>\n  <p>If someone has a better solution, e.g. something with malloc, it would also be a big help.</p>\n</blockquote>\n\n<p><strike></p>\n\n<h3>Option 1:</h3>\n\n<p>Don't make <code>bufferSize</code> an input to the function. Use a hard-coded size that you know will\nnot cause buffer overflow, such as <a href=\"https://en.cppreference.com/w/cpp/header/limits\" rel=\"nofollow noreferrer\"><code>std::numeric_limits&lt;unsigned short&gt;::max()</code></a>.</p>\n\n<h3>Option 2:</h3>\n\n<p>Use <code>std::vector</code> insteady of an array.</p>\n\n<pre><code>// char buffer[bufferSize / sizeof(char)];\nstd::vector&lt;char&gt; buffer(bufferSize);\n</code></pre>\n\n<p>Then use <code>buffer.data()</code> when you need to access the data of the object.</p>\n\n<p></strike></p>\n\n<h3>Update (since C++ tag was removed)</h3>\n\n<p>Don't make <code>bufferSize</code> an input to the function. Use a hard-coded size that you know willnot cause buffer overflow, such as <code>USHORT_MAX</code>.</p>\n\n<pre><code>void copyUsingBuffer(char from[], char to[])\n{\n    int bufferSize = USHORT_MAX\n    char buffer[USHORT_MAX];\n\n    struct stat statBuffer;\n    int sourceFD, destFD;\n\n    ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1561493672, "post_id": 56761298, "comment_id": 100080166, "body": "If you do that, make sure you use <code>free(buffer);</code> before the function returns. Otherwise, your program will have a memory leak every time the function is called."}], "tags": [], "owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "is_accepted": true, "score": 0, "last_activity_date": 1561493256, "creation_date": 1561493256, "answer_id": 56761298, "question_id": 56760306, "link": "https://stackoverflow.com/questions/56760306/copy-program-works-for-small-files-gives-segmentation-fault-on-lager-files/56761298#56761298", "title": "Copy-Program works for small files, gives segmentation fault on lager files", "body": "<p>Found the solution, after trying a few things.\nI replace</p>\n\n<pre><code>char buffer[bufferSize / sizeof(char)];\n</code></pre>\n\n<p>with </p>\n\n<pre><code>char* buffer = malloc(bufferSize);\n</code></pre>\n\n<p>Using malloc was already suggested. MY mistake was that i didnt replace</p>\n\n<pre><code>int geleseneBytes = read(sourceFD, buffer, sizeof(buffer));\n</code></pre>\n\n<p>Making those changes my program works for all file-sizes.\nThanks for the help everybody!</p>\n\n<pre><code>int geleseneBytes = read(sourceFD, buffer, bufferSize);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "edited": false, "score": 0, "creation_date": 1561493706, "post_id": 56761336, "comment_id": 100080181, "body": "I already edited this in my answer, i just hit Enter too fast. Thanks nonetheless. Well, i guess we all did cringe-inducing errors at some point. The important thing is to not repeat them i guess. :)"}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1561493474, "creation_date": 1561493474, "answer_id": 56761336, "question_id": 56760306, "link": "https://stackoverflow.com/questions/56760306/copy-program-works-for-small-files-gives-segmentation-fault-on-lager-files/56761336#56761336", "title": "Copy-Program works for small files, gives segmentation fault on lager files", "body": "<p>You need to also change the line:</p>\n\n<pre><code>int geleseneBytes = read(sourceFD, buffer, sizeof(buffer));\n\nTo:\n    int geleseneBytes = read(sourceFD, buffer, bufferSize);\n</code></pre>\n\n<p>Because the sizeof(buffer) is the size of a pointer, not the size of what it points to.   Since you are malloc()ing it, you need to provide this.</p>\n\n<p>ps:</p>\n\n<p>char  buffer[bufferSize/sizeof(char)];</p>\n\n<p>is a bit cring inducing.   Sizeof(char) is 1.</p>\n"}], "owner": {"reputation": 63, "user_id": 7986587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402edb9fb3a7d7d1cd118d4661aa3046?s=128&d=identicon&r=PG&f=1", "display_name": "Regicide", "link": "https://stackoverflow.com/users/7986587/regicide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 56761298, "answer_count": 3, "score": 1, "last_activity_date": 1561493474, "creation_date": 1561488446, "last_edit_date": 1561491488, "question_id": 56760306, "link": "https://stackoverflow.com/questions/56760306/copy-program-works-for-small-files-gives-segmentation-fault-on-lager-files", "title": "Copy-Program works for small files, gives segmentation fault on lager files", "body": "<p>To learn some low level C magic, I tried to implement different methods to copy the content of one file to another.</p>\n\n<p>The following method uses a buffer, where I save chunks of data, e.g. 512 bytes. Then I write FROM this buffer into my destination file. Allegedly this is more efficient than copying the whole file directly.</p>\n\n<p>When I use a small buffer, e.g. 512 Bytes, this works fine. \nIf I use a big buffer, e.g. 10000000 Bytes, roughly 10MB, I get a segmentation fault.</p>\n\n<p>I am running on Ubuntu.\nI tried stuff with <code>malloc</code>, but nothing really seams to work for me. I guess the fix will be easy, once I know it.</p>\n\n<p>According to my debbuger the error is in this line:</p>\n\n<pre><code>if (stat(to, &amp;statBuffer) == -1)\n</code></pre>\n\n<p>I left in a lot of the error checking I am doing.\nHere is the code I run:</p>\n\n<pre><code>void copyUsingBuffer(char from[], char to[], long unsigned int bufferSize)\n{\n    struct stat statBuffer;\n    int sourceFD, destFD;\n    char buffer[bufferSize / sizeof(char)];\n    int EndOfFileErreicht = 0;\n\n    // Dateien pruefen\n    if (stat(to, &amp;statBuffer) == -1)\n    {\n        if (errno != ENOENT)\n        {\n            perror(\"Fehler beim Pruefen der Zieldatei\");\n            exit(EXIT_FAILURE);\n        }\n    }\n    else\n    {\n        if (!(S_ISREG(statBuffer.st_mode)))\n        {\n            printf(\"Die Zieldatei ist keine regulaere Datei\\n\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    // Dateien oeffnen\n    sourceFD = open(from, O_RDONLY);\n    if (sourceFD == -1)\n    {\n        perror(\"Fehler beim Oeffnen der Quelldatei\");\n        exit(EXIT_FAILURE);\n    }\n    if (fstat(sourceFD, &amp;statBuffer) == -1)\n    {\n        perror(\"Fehler beim Pruefen der Quelldatei\");\n        exit(EXIT_FAILURE);\n    }\n    if (!(S_ISREG(statBuffer.st_mode)))\n    {\n        printf(\"Die Quelldatei ist keine regulaere Datei\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    destFD = open(to, O_WRONLY | O_CREAT | O_TRUNC, statBuffer.st_mode);\n    if (destFD == -1)\n    {\n        perror(\"Fehler beim Oeffnen der Zieldatei\");\n        exit(EXIT_FAILURE);\n    }\n\n    while (EndOfFileErreicht == 0)\n    {\n        int geleseneBytes = read(sourceFD, buffer, sizeof(buffer));\n        if (geleseneBytes == -1)\n        {\n            perror(\"Fehler beim Lesen aus der Quelldatei\");\n            exit(EXIT_FAILURE);\n        }\n        if (geleseneBytes &lt; bufferSize)\n        {\n            // EOF wurde erreicht, also Flag setzen\n            EndOfFileErreicht = 1;\n        }\n\n\n        if (write(destFD, buffer, geleseneBytes) == -1)\n        {\n            perror(\"Fehler beim Schreiben in die Zieldatei\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    close(sourceFD);\n    close(destFD);\n}\n</code></pre>\n\n<p>I would expect that if I enter a 500MB text file, that my program copies this file to its destination.</p>\n\n<p>I realise that there are different ways to implement file copying. I already implemented some of those. In this case I am restricted to using write, read, and the buffer. Also bufferSize NEEDS to be a variable.\nThe naive way i have using malloc would be: </p>\n\n<pre><code> char* buffer = malloc(bufferSize);\n</code></pre>\n\n<p>But when i use this the file will be corrupted.</p>\n"}, {"tags": ["c", "linux", "assembly", "x86", "att"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1561491872, "post_id": 56760086, "comment_id": 100079467, "body": "Relevant <a href=\"https://www.technovelty.org/linux/function-pointers-and-addresses-of-functions.html\" rel=\"nofollow noreferrer\">technovelty.org/linux/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 7870784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b620ec2fb060d76bc73b291c4459439b?s=128&d=identicon&r=PG&f=1", "display_name": "roy cabouly", "link": "https://stackoverflow.com/users/7870784/roy-cabouly"}, "edited": false, "score": 0, "creation_date": 1561493374, "post_id": 56760661, "comment_id": 100080039, "body": "The whole purpose of the indirection added in the PLT was to do the relocation of a shared library function in a lazy fashion. I expected x to point to the address of the PLT entry of printf but instead it point to other address and there is a dynamic relocation on that address. So in that case it doesn&#39;t use the lazy feature, and that whats weird to me"}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 2, "last_activity_date": 1561490123, "creation_date": 1561490123, "answer_id": 56760661, "question_id": 56760086, "link": "https://stackoverflow.com/questions/56760086/unexpected-value-of-a-function-pointer-local-variable/56760661#56760661", "title": "Unexpected value of a function pointer local variable", "body": "<p>The fourth and fifth lines of your disassembly correspond to the <code>func x=printf;</code> statement in your code.  The address of <code>printf</code> is stored in memory at address <code>0x200fd8</code>, which is accessed using a <code>rip</code>-relative address (<code>0x20098f(%rip)</code>).  This is then stored in the local variable (relative to <code>ebp</code>, at address <code>-0x8(%rbp)</code>).</p>\n\n<p>Any adjustments required at run time will be made to the value stored at <code>0x200fd8</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1561564891, "post_id": 56760855, "comment_id": 100109160, "body": "When you take a pointer to printf, the compiler takes the final address from the GOT so calls through that function pointer don&#39;t have to go through the PLT stub.  Note the <code>mov  rbp, QWORD PTR printf@GOTPCREL[rip]</code> in GCC&#39;s output for this, if you look at asm instead of disassembly.  <a href=\"https://godbolt.org/z/w1upNr\" rel=\"nofollow noreferrer\">godbolt.org/z/w1upNr</a>"}], "tags": [], "owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1561496551, "last_edit_date": 1561496551, "creation_date": 1561491117, "answer_id": 56760855, "question_id": 56760086, "link": "https://stackoverflow.com/questions/56760086/unexpected-value-of-a-function-pointer-local-variable/56760855#56760855", "title": "Unexpected value of a function pointer local variable", "body": "<p>A function has one address thought the entire program, but there is a PLT for each shared library which would result in different pointers to <code>printf</code> having different values.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566709674, "post_id": 57643391, "comment_id": 101738008, "body": "(I had this answer half-written back in June, but got side-tracked by the <code>-fpie</code> vs. <code>-fno-pie</code> behaviour difference.  Finally finished writing it. :P)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1566866837, "last_edit_date": 1566866837, "creation_date": 1566709622, "answer_id": 57643391, "question_id": 56760086, "link": "https://stackoverflow.com/questions/56760086/unexpected-value-of-a-function-pointer-local-variable/57643391#57643391", "title": "Unexpected value of a function pointer local variable", "body": "<blockquote>\n  <p>(as you can see in line 4 of the assembly that the value stored in local variable x is not the address of the plt entry)</p>\n</blockquote>\n\n<p>Huh?  The <em>value</em> isn't visible in the disassembly, only the location it's loaded from.  (In practice it's not loading a pointer to the PLT entry, but line 4 of the assembly doesn't tell you that<sup>1</sup>.)  Use <code>objdump -dR</code> to see dynamic relocations.</p>\n\n<p>That's a load from memory using a RIP-relative addressing mode.  In this case it's loading a pointer to the real <code>printf</code> address in libc.  That pointer is stored in the Global Offset Table (GOT).</p>\n\n<p>To make this work, the <code>printf</code> symbol gets \"early binding\" instead of lazy dynamic linking, avoiding PLT overhead for later uses of that function pointer.</p>\n\n<p>Footenote 1: Although maybe you were basing that reasoning on the fact that it's a load instead of a RIP-relative LEA.  That pretty much does tell you it's not the PLT entry; part of the point of the PLT is to have an address that's a link-time constant for <code>call rel32</code>, which also enables LEA with a RIP+rel32 addressing mode.  The compiler would have used that if it wanted the PLT address in a register.</p>\n\n<hr>\n\n<p>BTW, the PLT stub itself also uses the GOT entry for its memory-indirect jump; for symbols that are only used as function call targets, the GOT entry holds a pointer back to the PLT stub, to the <code>push</code> / <code>jmp</code> instructions that invoke the lazy dynamic linker to resolve that PLT entry.  i.e. to update the GOT entry.</p>\n\n<hr>\n\n<blockquote>\n  <p>Don't all the calls to functions undefined in the executable go first through the plt for better performance</p>\n</blockquote>\n\n<p>No, the PLT <em>costs</em> runtime performance by adding an extra level of indirection to every call.  <code>gcc -fno-plt</code> uses early binding instead waiting for the first call, so it can inline the indirect <code>call</code> through the GOT right into each call site.</p>\n\n<p>The PLT exists to avoid runtime fixups of <code>call rel32</code> offsets during dynamic linking.  And on 64-bit systems, to allow reaching addresses that are more than 2GB away.  And also to support <strong>symbol interposition</strong>.  See <a href=\"https://www.macieira.org/blog/2012/01/sorry-state-of-dynamic-libraries-on-linux/\" rel=\"nofollow noreferrer\">https://www.macieira.org/blog/2012/01/sorry-state-of-dynamic-libraries-on-linux/</a> (written before <code>-fno-plt</code> existed; it's basically like one of the ideas he was suggesting).</p>\n\n<p>The PLT's lazy binding can improve startup performance vs. early binding, but on modern systems where cache hits are <em>very</em> important, doing all the symbol-scanning stuff at once during startup is nice.</p>\n\n<blockquote>\n  <p>and for pic code?</p>\n</blockquote>\n\n<p>Your code <em>is</em> PIC, or actually PIE (position-independent executable), which most distros configure GCC to do by default.</p>\n\n<blockquote>\n  <p>I expected <code>x</code> to point to the address of the PLT entry of <code>printf</code></p>\n</blockquote>\n\n<p><strong>If you use <code>-fno-pie</code></strong>, then the address of the PLT entry is a link-time constant, and at compile time the compiler doesn't know whether you're going to link libc statically or dynamically.  So it uses <code>mov $printf, %eax</code> to get the address of a function-pointer into a register, and at link time that can only convert to <code>mov $printf@plt, %eax</code>.  </p>\n\n<p><strong><a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include%3Cstdio.h%3E%0Atypedef+int+(*func)(const+char*,...)%3B%0A%0Aint+main()%0A%7B%0A++++++++func+x%3Dprintf%3B%0A++++++++printf(%22%25p%5Cn%22,+x)%3B%0A++++++++x(%22%25p%5Cn%22,+x)%3B%0A++++++++return+0%3B%0A%7D%0A%0A+__attribute((visibility(%22hidden%22)))%0Aint+foo(const+char*,+...)%3B%0A%0Aint+main2()%0A%7B%0A++++++++func+x%3Dfoo%3B%0A++++++++printf(%22%25p%5Cn%22,+x)%3B%0A++++++++x(%22%25p%5Cn%22,+x)%3B%0A++++++++return+0%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:30.70997561079809,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g92,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!((name:eigen,ver:trunk)),options:&#39;-O3+-Wall+-fno-pie&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+9.2+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:35.95669105586858,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g92,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!((name:eigen,ver:trunk)),options:&#39;-O3+-Wall+-fpie&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+9.2+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),k:33.33333333333333,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">See it on Godbolt</a>.</strong>  (The Godbolt default is <code>-fno-pie</code>, unlike on most current Linux distros.)</p>\n\n<pre><code># gcc9.2 -O3 -fpie    for your first block\n        movq    printf@GOTPCREL(%rip), %rbp\n        leaq    .LC0(%rip), %rdi\n        xorl    %eax, %eax\n        movq    %rbp, %rsi        # saved for later in rbp\n        call    printf@PLT\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code># gcc9.2 -O3 -fno-pie\n        movl    $printf, %esi          # linker converts this symbol reference to printf@plt\n        movl    $.LC0, %edi\n        xorl    %eax, %eax\n        call    printf                 # will convert at link-time to printf@plt\n      # next use also just uses mov-immediate to rematerialize, instead of saving a load result in a register.\n</code></pre>\n\n<p>So a PIE executable actually has <em>better</em> efficiency for repeated-use of function pointers to functions in standard libraries: the pointer is the final address, not just the PLT entry.</p>\n\n<p><code>-fno-plt -fno-pie</code> works more like PIE mode for taking function pointers.  Except it can still use <code>$foo</code> 32-bit immediates for the addresses of symbols in the same file, instead of a RIP-relative LEA.</p>\n\n<pre><code># gcc9.2 -O3 -fno-plt -fno-pie\n        movq    printf@GOTPCREL(%rip), %rbp    # saved for later in RBP\n        movl    $.LC0, %edi\n        xorl    %eax, %eax\n        movq    %rbp, %rsi\n        call    *printf@GOTPCREL(%rip)\n  # pointers to static functions can use  mov $foo, %esi\n</code></pre>\n\n<p>It seems you need <code>int foo(const char*,...) __attribute__((visibility(\"hidden\")));</code> to tell the compiler it definitely doesn't need to go through the GOT for this symbol, with <code>pie</code> or <code>-fno-plt</code>.</p>\n\n<p>Leaving it until link-time for the linker to convert <code>symbol</code> to <code>symbol@plt</code> if necessary allows the compiler to always use efficient 32-bit absolute immediates or RIP-relative addressing and only end up with PLT indirection for functions that turn out to be in a shared library.  But then you end up with pointers to PLT entries, instead of pointers to the final address.</p>\n\n<hr>\n\n<p>If you were using Intel syntax, it would be <code>mov rbp, QWORD PTR printf@GOTPCREL[rip]</code> in GCC's output for this, if you look at asm instead of disassembly.</p>\n\n<p>Looking at compiler output gives you significantly more information that just numeric offsets from RIP in plain <code>objdump</code> output.  <code>-r</code> to show relocation symbols helps some, but compiler output is generally better.  (Except you don't see that <code>printf</code> gets rewritten to <code>printf@plt</code>)</p>\n"}], "owner": {"reputation": 407, "user_id": 7870784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b620ec2fb060d76bc73b291c4459439b?s=128&d=identicon&r=PG&f=1", "display_name": "roy cabouly", "link": "https://stackoverflow.com/users/7870784/roy-cabouly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 57643391, "answer_count": 3, "score": 4, "last_activity_date": 1566866837, "creation_date": 1561487424, "last_edit_date": 1561489762, "question_id": 56760086, "link": "https://stackoverflow.com/questions/56760086/unexpected-value-of-a-function-pointer-local-variable", "title": "Unexpected value of a function pointer local variable", "body": "<p>I have done some experiments in which I created a local variable of type pointer to function that points to <code>printf</code>. Then I called <code>printf</code> regularly and using that variable as following:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\ntypedef int (*func)(const char*,...);\n\nint main()\n{\n        func x=printf;\n        printf(\"%p\\n\", x);\n        x(\"%p\\n\", x);\n        return 0;\n}\n</code></pre>\n\n<p>I have compiled it and looked at the disassembly of main using gdb and got that:</p>\n\n<pre><code>   0x000000000000063a &lt;+0&gt;:     push   %rbp\n   0x000000000000063b &lt;+1&gt;:     mov    %rsp,%rbp\n   0x000000000000063e &lt;+4&gt;:     sub    $0x10,%rsp\n   0x0000000000000642 &lt;+8&gt;:     mov    0x20098f(%rip),%rax        # 0x200fd8\n   0x0000000000000649 &lt;+15&gt;:    mov    %rax,-0x8(%rbp)\n   0x000000000000064d &lt;+19&gt;:    mov    -0x8(%rbp),%rax\n   0x0000000000000651 &lt;+23&gt;:    mov    %rax,%rsi\n   0x0000000000000654 &lt;+26&gt;:    lea    0xb9(%rip),%rdi        # 0x714\n   0x000000000000065b &lt;+33&gt;:    mov    $0x0,%eax\n   0x0000000000000660 &lt;+38&gt;:    callq  0x520 &lt;printf@plt&gt;\n   0x0000000000000665 &lt;+43&gt;:    mov    -0x8(%rbp),%rax\n   0x0000000000000669 &lt;+47&gt;:    mov    -0x8(%rbp),%rdx\n   0x000000000000066d &lt;+51&gt;:    mov    %rax,%rsi\n   0x0000000000000670 &lt;+54&gt;:    lea    0x9d(%rip),%rdi        # 0x714\n   0x0000000000000677 &lt;+61&gt;:    mov    $0x0,%eax\n   0x000000000000067c &lt;+66&gt;:    callq  *%rdx\n   0x000000000000067e &lt;+68&gt;:    mov    $0x0,%eax\n   0x0000000000000683 &lt;+73&gt;:    leaveq\n   0x0000000000000684 &lt;+74&gt;:    retq\n</code></pre>\n\n<p>What is weird to me is that calling to <code>printf</code> directly uses the plt (as expected) <strong>but</strong> calling it using the local variable uses a whole different address (as you can see in line 4 of the assembly that the value stored in local variable x is not the address of the plt entry).</p>\n\n<p>How can that be? Don't all the calls to functions undefined in the executable go first through the plt for better performance and for pic code?</p>\n"}, {"tags": ["c", "linux", "file", "file-descriptor"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1561487832, "post_id": 56760028, "comment_id": 100077791, "body": "@Someprogrammerdude I agree. A lot of these questions are asked because people don&#39;t do the proper research beforehand."}, {"owner": {"reputation": 21, "user_id": 11699301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MHW7xgP7zKc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relVSJBWrj694-rombd8FdwvFd7Eg/photo.jpg?sz=128", "display_name": "Gustavo Guedes", "link": "https://stackoverflow.com/users/11699301/gustavo-guedes"}, "edited": false, "score": 1, "creation_date": 1561488086, "post_id": 56760028, "comment_id": 100077896, "body": "If people completely understood everything they read, stackoverflow would not exist."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1561488532, "post_id": 56760028, "comment_id": 100078092, "body": "Then please try to write what&#39;s bothering you about what you have read in your question. What specifically are you wondering about? What are your doubts? Your thoughts? And please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1561541577, "post_id": 56760075, "comment_id": 100094741, "body": "<i>there&#39;s no longer need/purpose in asking the state if the closed file descriptor.</i>  There&#39;s not only no need to ask the state, calling <code>select()</code> on a closed file descriptor is also is wrong as the file descriptor could be reused by another thread for a completely unrelated file."}], "tags": [], "owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "is_accepted": true, "score": 2, "last_activity_date": 1561487391, "creation_date": 1561487391, "answer_id": 56760075, "question_id": 56760028, "link": "https://stackoverflow.com/questions/56760028/what-is-the-difference-between-closing-close3-and-clearing-fd-clr3-a-fil/56760075#56760075", "title": "What is the difference between closing [close(3)] and clearing [fd_clr(3)] a file descriptor?", "body": "<p><code>FD_CLR()</code> only changes a local <code>fd_set</code>, which is a C data structure to store info about a list of file descriptors.</p>\n\n<p><code>close()</code> is a system call that closes the file descriptor.</p>\n\n<p>The <code>fd_set</code> is used in the <code>select()</code> system call. With <code>select()</code> you get information about the state of the list of file descriptors that are stored in your <code>fd_set</code> struct.</p>\n\n<p>The reason why you see the <code>FD_CLR()</code> just below the <code>close()</code>, is that there's no longer need/purpose in asking the state if the closed file descriptor.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 11699301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MHW7xgP7zKc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relVSJBWrj694-rombd8FdwvFd7Eg/photo.jpg?sz=128", "display_name": "Gustavo Guedes", "link": "https://stackoverflow.com/users/11699301/gustavo-guedes"}, "edited": false, "score": 0, "creation_date": 1561488271, "post_id": 56760134, "comment_id": 100077989, "body": "I&#39;ll check if close gets called for the same file in other code. Thank you!"}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 1, "last_activity_date": 1561487649, "creation_date": 1561487649, "answer_id": 56760134, "question_id": 56760028, "link": "https://stackoverflow.com/questions/56760028/what-is-the-difference-between-closing-close3-and-clearing-fd-clr3-a-fil/56760134#56760134", "title": "What is the difference between closing [close(3)] and clearing [fd_clr(3)] a file descriptor?", "body": "<p>So, FD_ISSET and FD_CLR are part of the pselect API, read more in the man page here <a href=\"http://man7.org/linux/man-pages/man3/FD_CLR.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/FD_CLR.3.html</a></p>\n\n<p>It is basically managing a list of all the file numbers you want to wait on, in your next call to pselect, so clearing a file that you have closed makes sense.</p>\n\n<p>Your code is asking, for all the files I was listening for, close the file and remove from the set.</p>\n\n<p>close() actually closes the file. You should not call close multiple times on the same file, or you will see this error. Perhaps some other code is also closing the file?</p>\n"}, {"tags": [], "owner": {"reputation": 102109, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "is_accepted": false, "score": 1, "last_activity_date": 1561487948, "creation_date": 1561487948, "answer_id": 56760209, "question_id": 56760028, "link": "https://stackoverflow.com/questions/56760028/what-is-the-difference-between-closing-close3-and-clearing-fd-clr3-a-fil/56760209#56760209", "title": "What is the difference between closing [close(3)] and clearing [fd_clr(3)] a file descriptor?", "body": "<p>If the software is really flagging such use of <code>FD_CLR</code>, the automated software is broken. You are <strong>removing</strong> the closed file descriptor from the watched set, and <code>FD_CLR</code> is precisely the way to do that.</p>\n\n<p>As a work-around, you could transpose the <code>close()</code> and <code>FD_CLR</code> which won't change the meaning of the code, but will appease the buggy analysis tool.</p>\n"}], "owner": {"reputation": 21, "user_id": 11699301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MHW7xgP7zKc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relVSJBWrj694-rombd8FdwvFd7Eg/photo.jpg?sz=128", "display_name": "Gustavo Guedes", "link": "https://stackoverflow.com/users/11699301/gustavo-guedes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 56760075, "answer_count": 3, "score": 0, "last_activity_date": 1561487948, "creation_date": 1561487198, "question_id": 56760028, "link": "https://stackoverflow.com/questions/56760028/what-is-the-difference-between-closing-close3-and-clearing-fd-clr3-a-fil", "title": "What is the difference between closing [close(3)] and clearing [fd_clr(3)] a file descriptor?", "body": "<p>I am having problems with an automated software testing, which is blaming use of freed resource when I use fd_clr(3) after using close(3) in a fd. Is there something wrong with doing this?</p>\n\n<pre><code>for(i = 0; i &lt; nfds; ++i) {\n    if (FD_ISSET(i, &amp;myFdSet)) {\n        close(i);\n        FD_CLR(i, &amp;myFdSet);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "printf", "c-strings", "string-literals"], "comments": [{"owner": {"reputation": 863, "user_id": 8786138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1af71491abb17b899e003a31f710415?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Sharma", "link": "https://stackoverflow.com/users/8786138/vaibhav-sharma"}, "edited": false, "score": 1, "creation_date": 1561485486, "post_id": 56759637, "comment_id": 100076720, "body": "What were you expecting it to print?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1561485563, "post_id": 56759637, "comment_id": 100076763, "body": "You don&#39;t leave room for a null terminator"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 1, "creation_date": 1561485566, "post_id": 56759637, "comment_id": 100076765, "body": "Try <code>char ss[][4]</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561485567, "post_id": 56759637, "comment_id": 100076766, "body": "You do know there is no string terminator at the end of <code>&quot;rty&quot;</code> because the array spec means there isn&#39;t room for it? Try <code>char *ss[] = { &quot;rty&quot; };</code>"}, {"owner": {"reputation": 14180, "user_id": 1636522, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SH1Jr.png?s=128&g=1", "display_name": "leaf", "link": "https://stackoverflow.com/users/1636522/leaf"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1561485666, "post_id": 56759637, "comment_id": 100076822, "body": "@ChristianGibbons Of course ^^&#39; Thank you !"}], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 1869704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rAZad.jpg?s=128&g=1", "display_name": "TomE", "link": "https://stackoverflow.com/users/1869704/tome"}, "is_accepted": true, "score": 4, "last_activity_date": 1561485626, "creation_date": 1561485626, "answer_id": 56759673, "question_id": 56759637, "link": "https://stackoverflow.com/questions/56759637/why-printf-prints-a-variable-not-passed-as-argument/56759673#56759673", "title": "Why printf prints a variable not passed as argument?", "body": "<p>By making your string at the first element of ss have 3 characters you are eliminating the null terminator.</p>\n\n<p>So printf continues until it finds a null terminator. By chance, your other string must have been placed in memory right after your first one.</p>\n\n<p>If you change the 3 in ss[][3] to a 4 you should get expected behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1561488565, "last_edit_date": 1561488565, "creation_date": 1561485668, "answer_id": 56759683, "question_id": 56759637, "link": "https://stackoverflow.com/questions/56759637/why-printf-prints-a-variable-not-passed-as-argument/56759683#56759683", "title": "Why printf prints a variable not passed as argument?", "body": "<p>Your array declaration doesn't leave room for the terminating null character, so there's no null character at the end of <code>\"rty\"</code>. Since <code>%s</code> format requires a null-terminated string as the argument, you're causing undefined behavior.</p>\n\n<p>In this case, the memory for <code>s</code> happened to be right after the memory for <code>ss</code>, so <code>printf()</code> printed it when it searched for the null terminator.</p>\n\n<p>Change your declaration to:</p>\n\n<pre><code>char ss[][4] = { \"rty\" };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1561485708, "creation_date": 1561485708, "answer_id": 56759688, "question_id": 56759637, "link": "https://stackoverflow.com/questions/56759637/why-printf-prints-a-variable-not-passed-as-argument/56759688#56759688", "title": "Why printf prints a variable not passed as argument?", "body": "<p>A string in C consists of a sequence of characters terminated by a null byte.  The elements of <code>ss</code> don\u2019t have enough room to store the given string which occupies 4 bytes including the null terminator.  When you then attempt to print <code>ss[0]</code> you read past the end of the array.  This invokes undefined behavior.</p>\n\n<p>Change the size of the second array dimension to 4 to leave enough space.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1561485930, "creation_date": 1561485930, "answer_id": 56759745, "question_id": 56759637, "link": "https://stackoverflow.com/questions/56759637/why-printf-prints-a-variable-not-passed-as-argument/56759745#56759745", "title": "Why printf prints a variable not passed as argument?", "body": "<p><code>char ss[][3] = { \"rty\" };</code> defines an array of arrays of 3 <code>char</code>. Since the number of arrays is not specified (nothing is inside <code>[]</code>), it is determined by counting the initializers. There is just one initializer, the string literal <code>\"rty\"</code>. Thus, the result is an array of 1 array of 3 <code>char</code>, which contains r, t, and y. Although the string literal <code>\"rty\"</code> implicitly contains a null character, the array is defined to explicitly contain just three characters, so the null character does not become part of the array.</p>\n\n<p><code>printf(\"%s\\n\", ss[0]);</code> passes the address of the first character of <code>ss[0]</code> to <code>printf</code>. The resulting behavior is undefined because <code>printf</code> should be passed the first character of a <em>string</em>, which means a sequence of characters terminated by a null character, but <code>ss[0]</code> does not contain a null character.</p>\n\n<p>On some occasions when you do this, the other object, defined by <code>char s[] = \"aze\";</code> may happen to follow <code>ss</code> in memory, and <code>printf</code>, while it is attempting to print the string, may continue beyond r, t, and y to print a, z, and e, after which it finds the null terminator.</p>\n\n<p>On other occasions when you do this, the other object, <code>s</code>, might not follow <code>ss</code> in memory. The compiler might have removed <code>s</code> during optimization, since it is not used and hence is not needed in the program. Or the compiler might have put it in a different location. On such occasions, <code>printf</code> might continue on to other memory and print different characters, or it might continue on to inaccessible memory and cause a segment violation or other program termination.</p>\n\n<p>On yet other occasions when you do this, the compiler might recognize that the <code>printf</code> call is undefined due to the lack of a terminating null character, and it might remove the <code>printf</code> call from the program entirely, because the C standard allows a C implementation to substitute any behavior it wants for undefined behavior.</p>\n\n<p>Ultimately, the behavior is not defined by the C standard.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1561486779, "last_edit_date": 1561486779, "creation_date": 1561486095, "answer_id": 56759775, "question_id": 56759637, "link": "https://stackoverflow.com/questions/56759637/why-printf-prints-a-variable-not-passed-as-argument/56759775#56759775", "title": "Why printf prints a variable not passed as argument?", "body": "<p>The format specifier <code>%s</code> is used to output strings that is sequences of characters terminated with zero characters.</p>\n\n<p>You declared the array the single (first) element of which does not contain a string.</p>\n\n<pre><code>char ss[][3] = { \"rty\" };\n</code></pre>\n\n<p>In fact the array is declared the following equivalent way</p>\n\n<pre><code>char ss[][3] = { { 'r', 't', 'y' } };\n</code></pre>\n\n<p>that is the terminating zero of the string literal was excluded from the list of initializers because the size of the internal array is equal to only 3.</p>\n\n<p>To output the array you could write</p>\n\n<pre><code>printf(\"%3.3s\\n\", ss[0]);\n</code></pre>\n\n<p>explicitly specifying the number of characters you are going to output.</p>\n\n<p>If you want to output it as a string you should enlarge it like</p>\n\n<pre><code>char ss[][4] = { \"rty\" };\n</code></pre>\n\n<p>that to include the terminating zero of the string literal <code>\"rty\"</code>.</p>\n\n<p>In case of the original program it seems that the compiler placed in the stack the arrays in the following order <code>ss</code> and then <code>s</code>. That is the memory allocated to the arrays looks the following way.</p>\n\n<pre><code>{ 'r', 't', 'y', 'a', 'z', 'e', '\\0' }\n  |___________|  |_________________|\n      ss                  s\n</code></pre>\n\n<p>Pay attention to that this declaration</p>\n\n<pre><code>char s[] = \"aze\";\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>char s[] = { 'a', 'z', 'e', '\\0' };\n</code></pre>\n\n<p>that is the string literal includes the terminating zero and consequently the array <code>s</code> will contain a string.</p>\n\n<p>Also you should know that such a declaration</p>\n\n<pre><code>char ss[][3] = { \"rty\" };\n</code></pre>\n\n<p>is not allowed in C++.  In C++ you have to write at least like</p>\n\n<pre><code>char ss[][4] = { \"rty\" };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561487252, "post_id": 56759933, "comment_id": 100077527, "body": "What compilers did you use?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561487580, "post_id": 56759933, "comment_id": 100077673, "body": "We saw a question recently where the stack layout appeared to depend on whether an object was a variable-length array or not. We can expect compilers may arrange objects based on alignment and other considerations as well. Simple experiments are not greatly informative. Additionally, this answer does not answer the question."}], "tags": [], "owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "is_accepted": false, "score": 0, "last_activity_date": 1565284591, "last_edit_date": 1565284591, "creation_date": 1561486772, "answer_id": 56759933, "question_id": 56759637, "link": "https://stackoverflow.com/questions/56759637/why-printf-prints-a-variable-not-passed-as-argument/56759933#56759933", "title": "Why printf prints a variable not passed as argument?", "body": "<p>The reason your program \"prints a variable not passed as an argument\" is that your \"rty\" is not null terminated. This causes <code>printf</code> to continue printing characters until if finds a null terminator.</p>\n\n<p>I ran this experiment:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char end[] = \"\\0\";\n    char layout[7] = \" layout\";\n    char stack[6] = \" stack\";\n    char the[4] = \" the\";\n    char is[3] = \" is\";\n    char this[4] = \"This\";\n\n    printf(\"%s\\n\", this);\n    return 0;\n}\n</code></pre>\n\n<p><strong>macOS Output (LLVM)</strong></p>\n\n<pre><code>This is the stack layout\n</code></pre>\n\n<p><strong>Linux Output (gcc)</strong></p>\n\n<pre><code>This stack layout\n</code></pre>\n\n<p>Messing around with GDB on Linux showed that the variables were declared on the stack in a different order than in the code. Specifically</p>\n\n<pre><code>(gdb) print &amp;this[0]\n$8 = 0x7fffffffe287 \"This stack layout\"\n(gdb) print &amp;is[0]\n$9 = 0x7fffffffe280 \" is theThis stack layout\"\n</code></pre>\n\n<p>I wrote this example program because sometimes a practical example makes it easier to visualize this kind of behavior.</p>\n"}], "owner": {"reputation": 14180, "user_id": 1636522, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SH1Jr.png?s=128&g=1", "display_name": "leaf", "link": "https://stackoverflow.com/users/1636522/leaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 56759673, "answer_count": 6, "score": -3, "last_activity_date": 1565284591, "creation_date": 1561485427, "last_edit_date": 1561486946, "question_id": 56759637, "link": "https://stackoverflow.com/questions/56759637/why-printf-prints-a-variable-not-passed-as-argument", "title": "Why printf prints a variable not passed as argument?", "body": "<p>I didn't write C code for a long time, I'm rusty. Anybody knows why the following code prints \"rtyaze\" to stdout ? I was expecting \"rty\".</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n  char s[] = \"aze\";\n  char ss[][3] = { \"rty\" };\n  printf(\"%s\\n\", ss[0]);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "struct", "structure"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1561485527, "post_id": 56759542, "comment_id": 100076748, "body": "The formal parameter <code>Patient *matches[]</code> will never be compliant an argument from <code>Patient matches[5]</code> in any way whatsoever. Either the argument, or the formal parameter has to change somehow. Regardless, as we have no idea what this code is even supposed to be doing, we can&#39;t honestly assist further than pointing out that non-trivial fact. I <i>suspect</i> you&#39;re confusing a &quot;pointer to an array of structures&quot; with an &quot;array of pointers to structures&quot;, but the fog is pretty thick to make that wild assumption."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1561485597, "creation_date": 1561485597, "answer_id": 56759667, "question_id": 56759542, "link": "https://stackoverflow.com/questions/56759542/how-to-pass-and-return-a-pointer-to-an-array-of-structures/56759667#56759667", "title": "How to pass and return a pointer to an array of structures?", "body": "<p>Arrays are implicitly (with rare exceptions) converted to pointers to their first elements in expressions.</p>\n\n<p>So if in the function <code>search_patient</code> you declared an array like this</p>\n\n<pre><code>Patient *search_patient(Patient patientregister[], int num_of_patients)\n{\n    Patient matches[5];\n    //...\n}\n</code></pre>\n\n<p>then to pass it to the function <code>search_by_personaNumber</code> you can the following way</p>\n\n<pre><code>Patient *search_patient(Patient patientregister[], int num_of_patients)\n{\n    Patient matches[5];\n    //...\n\n    search_by_personaNumber( matches, 5 );\n    //...\n}\n</code></pre>\n\n<p>In fact there is no need in the function <code>search_patient</code> to use the return value of the function <code>search_by_personaNumber</code>. But if you indeed need to use it then you can write</p>\n\n<pre><code>Patient *search_patient(Patient patientregister[], int num_of_patients)\n{\n    Patient matches[5];\n    //...\n\n    Patient *p = search_by_personaNumber( matches, 5 );\n    //...\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5384602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b96d3f6bb30deaf92e391e243aeccba?s=128&d=identicon&r=PG&f=1", "display_name": "SaifSa", "link": "https://stackoverflow.com/users/5384602/saifsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56759667, "answer_count": 1, "score": 0, "last_activity_date": 1561727282, "creation_date": 1561485018, "last_edit_date": 1561727282, "question_id": 56759542, "link": "https://stackoverflow.com/questions/56759542/how-to-pass-and-return-a-pointer-to-an-array-of-structures", "title": "How to pass and return a pointer to an array of structures?", "body": "<p>I have an array of structures and the structure looks as below:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct patient {\n    int pictures[2];\n    int personal_number;\n    char patient_name[FILE_PATIENT_NAMES + 1];\n    int num_of_matches;\n};\n\ntypedef struct patient Patient;\n\nPatient patientregister[5];\n\n</code></pre>\n\n<p>I have two functions as down below:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/********* function declaration *********/\n\nPatient *search_patient(Patient patientregister[], int num_of_patients);\nPatient *search_by_personaNumber(Patient *matches[],\n                                 Patient patientregister[], int num_of_patients);\n</code></pre>\n\n<p>The code starts from <code>*search_patient</code> and then goes to <code>*search_by_personalNumber</code>. <code>*search_patient</code> has another array of structures declared inside it: <code>Patient matches[5];</code> and the idea is to send a pointer of <code>Patient matches[5];</code> to <code>*search_by_personalNumber</code>. and then get it back to <code>*search_patient</code> with the matches the user is searching for. My question is how to send a pointer of an array of structures to another function, use the pointer to fill in the array of structures and send the pointer back to the original function, in my case <code>*search_patient</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1561484674, "post_id": 56759412, "comment_id": 100076326, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Obligatory</a>..."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 3, "creation_date": 1561484677, "post_id": 56759412, "comment_id": 100076327, "body": "@Allan Nothing will happen.:) In C this statement new1 = (struct node*)malloc(sizeof(struct node)); is equivalent to new1 = malloc(sizeof(struct node));"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 1, "creation_date": 1561484723, "post_id": 56759412, "comment_id": 100076354, "body": "Not really sure what&#39;s being asked here."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1561484731, "post_id": 56759412, "comment_id": 100076355, "body": "Nothing in the buffer changes, you are just pointing new1 to whatever garbage happens to be in it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1561484742, "post_id": 56759412, "comment_id": 100076362, "body": "In C casting of pointers is always performed at compile-time. All it does is telling the compiler &quot;I know this thing is of type A, but I want it to be type B. Don&#39;t interfere, <b><i>I know what I&#39;m doing!</i></b>&quot; That last emphasized part is really important to keep in mind for all casting."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1561484773, "post_id": 56759412, "comment_id": 100076378, "body": "@Someprogrammerdude Not always. Casting between integer and floating types performs data conversion."}, {"owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "edited": false, "score": 0, "creation_date": 1561484797, "post_id": 56759412, "comment_id": 100076395, "body": "oh.... so new 1 is pointing a garbage"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1561484800, "post_id": 56759412, "comment_id": 100076396, "body": "@Someprogrammerdude not strictly true. <code>float</code> to <code>int</code> casts involve stuff happening at run time."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1561484800, "post_id": 56759412, "comment_id": 100076397, "body": "But pointer type casts work as you describe, it just describes the intent."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561484825, "post_id": 56759412, "comment_id": 100076404, "body": "@Barmar not if you are just assigning a pointer to the address of it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1561484897, "post_id": 56759412, "comment_id": 100076436, "body": "@DaveS LIke I said, pointer casts don&#39;t change anything."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1561484946, "post_id": 56759412, "comment_id": 100076459, "body": "@Barmar Rephrased."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "reply_to_user": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1561485013, "post_id": 56759412, "comment_id": 100076491, "body": "Sorry, I meant to reply to @CoffeeTableEspresso who described <code>int a = (int) float b</code> rather than <code>int* a = (int*) &amp; float b</code>"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1561485475, "post_id": 56759412, "comment_id": 100076713, "body": "@DaveS I meant the following will involve instructions at runtime: <code>int b = \u2026; float a = (float) b;</code>. <code>float *</code> to <code>int *</code> doesn&#39;t need instructions at runtime."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1561485586, "post_id": 56759412, "comment_id": 100076777, "body": "I guess I should mention that pointer casts <i>could</i> also involve a cast at runtime according to the standard. If you&#39;re on a word addressable machine with smaller <code>int *</code>s than <code>char *</code>s, casting an <code>int *</code> to a <code>char *</code> will involve &quot;padding out&quot; the <code>int *</code> to be the same size as a<code>char *</code>. This isn&#39;t likely to be an issue in practice though."}], "answers": [{"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "edited": false, "score": 1, "creation_date": 1561484972, "post_id": 56759481, "comment_id": 100076468, "body": "Right. It&#39;s a matter of preference. Personally, I prefer it because it makes it easier to port the code to C++ and it makes it easier to catch a mismatch between the number of bytes allocated and the use of the pointer. But I&#39;m in the minority."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1561488196, "post_id": 56759481, "comment_id": 100077953, "body": "@DavidSchwartz \u201cit makes it easier \u2026\u201d \u2014 There\u2019s an objectively better way to avoid this mismatch, which I\u2019m sure you\u2019re aware of, so why not mention it? <code>struct node *new1 = malloc(sizeof *new1);</code>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1561488857, "post_id": 56759481, "comment_id": 100078215, "body": "@KonradRudolph It&#39;s personal preference. I find that much less readable. When I look at the parameter to <code>sizeof</code>, what I want to know is the type, and I find it highly annoying and distracting when I&#39;m directed elsewhere to figure it out. It&#39;s not always in the same line, and even when it is, being forced to rescan is unpleasant. This mismatch is now easier to detect but at the cost of the code being less readable."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1561489766, "post_id": 56759481, "comment_id": 100078602, "body": "@DavidSchwartz It\u2019s less (= not at all) preference and more habit. To be clear, the difference is that \u201cpreference\u201d is routinely used to pretend that something is subjective when it\u2019s really not. You may not be <i>used</i> to this idiom but there\u2019s no doubt that it encapsulates the required information more concisely, clearer, and with less irrelevant distraction. It\u2019s ridiculous that highly intelligent programmers argue this such points. Case in point, you\u2019re not forced to \u201crescan\u201d anything; that\u2019s pure post-hoc rationalisation."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1561484799, "creation_date": 1561484799, "answer_id": 56759481, "question_id": 56759412, "link": "https://stackoverflow.com/questions/56759412/what-really-happens-when-a-dynamic-memory-allocation-is-explicitly-converted-to/56759481#56759481", "title": "What really happens when a dynamic memory allocation is explicitly converted to struct type?", "body": "<pre><code>struct node *new1;\n</code></pre>\n\n<p>This allocates a local variable, probably on the stack, of type \"pointer to struct node\".</p>\n\n<pre><code>new1 = (struct node*)malloc(sizeof(struct node));\n</code></pre>\n\n<p>This allocates a suitably-aligned chunk of memory large enough to hold a <code>struct node</code>, probably from the heap, and sets <code>new1</code> to point to that newly-allocated chunk. The chunk will remain allocated until the process terminates or the block is freed. The cast is not necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1561484840, "creation_date": 1561484840, "answer_id": 56759496, "question_id": 56759412, "link": "https://stackoverflow.com/questions/56759412/what-really-happens-when-a-dynamic-memory-allocation-is-explicitly-converted-to/56759496#56759496", "title": "What really happens when a dynamic memory allocation is explicitly converted to struct type?", "body": "<p>Memory returned by <code>malloc</code> initially has no type.  When a pointer is then used to write to that memory, the memory (up to the size of the given type) becomes an object whose type is the type of the dereferenced pointer.</p>\n"}], "owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1561484840, "creation_date": 1561484518, "question_id": 56759412, "link": "https://stackoverflow.com/questions/56759412/what-really-happens-when-a-dynamic-memory-allocation-is-explicitly-converted-to", "title": "What really happens when a dynamic memory allocation is explicitly converted to struct type?", "body": "<p>I've started learning the linked list concept. I've came across some code. It would be very helpful if somebody explain what happens with the code below. I've tried searching but couldn't find a proper answer.</p>\n\n<pre><code> struct node *new1;\n new1 = (struct node*)malloc(sizeof(struct node));\n</code></pre>\n"}, {"tags": ["c", "data-structures", "menu", "submenu"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1561482902, "post_id": 56758957, "comment_id": 100075601, "body": "OT: regarding: <code>printf(&quot;1. Create school\\n&quot;);     printf(&quot;2. Add room\\n&quot;);     printf(&quot;3. Add student to room\\n&quot;);     printf(&quot;4. Find student\\n&quot;);     printf(&quot;5. Show students in room\\n&quot;);      printf(&quot;\\n&quot;);     printf(&quot;6. Exit&quot;);</code>  the function: <code>printf()</code> is very expensive in CPU cycles.  Suggest: <code>puts( &quot;1. Create school\\n&quot;          &quot;2. Add room\\n&quot;          &quot;3. Add student to room\\n&quot;          &quot;4. Find student\\n&quot;          &quot;5. Show students in room\\n&quot;          &quot;\\n&quot;          &quot;6. Exit&quot;);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1561482969, "post_id": 56758957, "comment_id": 100075634, "body": "I thinks it&#39;s time to review how <code>scanf</code> works. You have to pass the <i>address</i> of <code>input</code>, so <code>scanf(&quot;%d&quot;, &amp;input)</code>, and the second call passed no addresses at all. Then, the <code>while</code> loop. Check out what is returned by function <code>scanf</code>, in that case it should return <code>1</code> to be of use to you. Also, <code>if(input == 6);</code> won&#39;t need that <code>;</code> semicolon. Also <code>school *school;</code> goes out of scope. And so on, the code is riddled with errors."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1561483139, "post_id": 56758957, "comment_id": 100075704, "body": "regarding: <code>while( scanf(&quot;%d&quot;, input) )</code>  The <code>scanf()</code> family of functions can also return EOF, so this statement can &#39;succeed&#39; when EOF is encountered.  Suggest: <code>while( scanf(&quot;%d&quot;, input)  == 1 )</code>"}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "edited": false, "score": 0, "creation_date": 1561483358, "post_id": 56758957, "comment_id": 100075781, "body": "Sorry! this was mistake on my part. <code>input</code> was a <code>char</code>  array and I just switched it to <code>int</code> without modifying the rest of the code, thanks for the heads up!"}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1561483761, "post_id": 56758957, "comment_id": 100075958, "body": "@WeatherVane What do you mean by <code>school* school;</code> going out of scope?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561483766, "post_id": 56758957, "comment_id": 100075961, "body": "regarding: <code>school *school;             school = createSchool();</code>   this hints that <code>school</code> is a &#39;typedef&#39; for some struct.  It is a very poor programing practice to name a local variable the same as a typedef name."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1561483915, "post_id": 56758957, "comment_id": 100076009, "body": "regarding: <code>again: ;             printf(&quot;Enter room Nr. and Class:&quot;);             int ok = scanf(&quot;%d %d&quot;);             if(ok != 2)             {                 printf(&quot;Error parsing info, please try again!&quot;);                 goto again;</code>  1) write a <code>do ... while();</code> loop and eliminate that label and goto()`  2) the call to <code>scanf()</code> is missing the addresses of the variables to receive the data input"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561484055, "post_id": 56758957, "comment_id": 100076056, "body": "Suggest, rather than the many code blocks, beginning with statements like: <code>if(input == 6);</code> it would avoid the retesting of the variable &#39;input&#39; over and over, to use a <code>switch( input ) { case 1: ..,, break; ... default: ... break; }</code> code block"}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561484076, "post_id": 56758957, "comment_id": 100076064, "body": "@user3629249 about the <code>typedefs</code>.. I see, thanks! this how we did it in all of our assignments and in class works.  Sorry about the mistakes in the code, I hastily asked this question without making sure everything else is in order. and in the <code>do ..while()</code> I write some kind of exit value? this way I will return to the outside loop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1561484109, "post_id": 56758957, "comment_id": 100076077, "body": "I mean that <code>school *school;</code> goes out of scope - meaning no longer accessible - outside of the conditional code block <code>if(input == 1) {...}</code>."}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "edited": false, "score": 0, "creation_date": 1561484331, "post_id": 56758957, "comment_id": 100076180, "body": "I see, so I should declare it outside  the <code>if()</code>  block?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561484394, "post_id": 56758957, "comment_id": 100076201, "body": "regarding: <code>printf(&quot;Error parsing info, please try again!&quot;);</code>  error messages should be output to <code>stderr</code>, not <code>stdout</code>.  (note: the <code>scanf()</code> family does not set <code>errno</code> when some input format conversion specifier fails)  Suggest: <code>fprintf( stderr, &quot;scanf to read ??? and ??? failed&quot; );</code>  which probably should be followed by cleanup and a call to <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561484511, "post_id": 56758957, "comment_id": 100076250, "body": "regarding: <code>do ..while()</code>  inside the parens should be the condition as to why the code should stay in the loop"}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "edited": false, "score": 0, "creation_date": 1561484538, "post_id": 56758957, "comment_id": 100076264, "body": "the type of error I&#39;m avoiding here is if a user inputted 3 integers separated by spaces, when my <code>scanf()</code> is only supposed to accept 2."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561484762, "post_id": 56758957, "comment_id": 100076373, "body": "the third integer will still be in <code>stdin</code>  So the third integer will be read at the call to <code>scanf()</code> for the menu input.  What happens next will depend on the value of that third integer.  Suggest before calling <code>scanf()</code> to empty <code>stdin</code> via something like: <code>int ch;  while( ( ch = getchar() ) != &#39;\\n&#39; &amp;&amp; ch != EOF ){;}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "is_accepted": false, "score": 0, "last_activity_date": 1569756345, "last_edit_date": 1569756345, "creation_date": 1562985525, "answer_id": 57015737, "question_id": 56758957, "link": "https://stackoverflow.com/questions/56758957/how-to-properly-make-a-dynamic-command-line-menu/57015737#57015737", "title": "How to properly make a dynamic command-line menu?", "body": "<p>Here is a working example.\nThe solution for this problem was simply making a \"menu within a menu\" kind of, I did use some <code>goto</code>s but as far as commandline menu goes, this may be all. </p>\n\n<pre><code>#define clrscr() printf(\"\\e[1;1H\\e[2J\")\n\nvoid periods(char* message)\n{   \n    const int trigger = 500; // ms\n    const int numDots = 3;\n\n    while (1) \n    {\n        // Return and clear with spaces, then return and print prompt.\n        printf(\"\\r%*s\\r%s\", sizeof(message) - 1 + numDots, \"\", message);\n        fflush(stdout);\n\n        // Print numDots number of dots, one every trigger milliseconds.\n        for (int i = 0; i &lt; numDots; i++) \n        {\n            usleep(trigger * 1000);\n            fputc('.', stdout);\n            fflush(stdout);\n        }\n        break;\n    }\n}\n\nvoid showmenu()\n{\n    clrscr();\n    puts(\"1. New Game\\n\"\n         \"2. Load Game\\n\"\n         \"3. Credits\\n\\n\"\n         \"4. Exit\\n\" );\n\n}\n\nint checkString(char *str)\n{\n    int status = 0;\n    int ln = strlen(str);\n\n    for(int i = 0; i &lt; ln; i++)\n    {\n        if(isdigit( str[i] ) )\n        status = 1; \n        break;\n    }\n\n    return status; \n}\n\nint main(){\n\n    char choice; \n\n    clrscr();\n    int status, isNum = -101;\n    char *name, *buffer, YN;\n\n    showmenu();\n    while(1)\n    {\n        scanf(\" %c\", &amp;choice);\n       if( isdigit(choice) )\n       {\n           break;     \n       }\n       else\n       {\n           fflush(stdin);\n           printf(\"Please only enter numbers!\\n\");\n           sleep(1);\n           showmenu();\n        }\n     }\n\n    do{ \n\n\n        switch(choice)\n        {\n            case '1':\n            {\n                createG:;\n                clrscr();\n\n                printf(\"Enter name or press 0 to return\\n\");\n                scanf(\"%s\", buffer);\n                status = checkString(buffer);\n                if(status == 1)\n                {\n                    clrscr();\n                    break;\n                }\n                clrscr();       \n                name = (char*)malloc(strlen(buffer)+1);\n                strcpy(name, buffer);\n                printf(\"New game created, welocome %s!\\n\");\n                for(int i = 0; i &lt; 5; i++)\n                {\n                    sleep(1);\n                    printf(\"%d\\n\", i);\n                }\n                break;\n            }\n\n            case '2': \n            {\n                int what;\n                caseL:;\n                clrscr();\n                printf(\"No saves!\\n Create new game? [Y/N] \\n to return press 0\\n\");\n                scanf(\" %c\", &amp;YN);\n\n                if(YN == 'N') what = 0;\n                if(YN == '0') what = -1;\n                if(YN == 'Y') what = 1;\n                switch(YN)\n                {\n                    case 'N':\n                    {\n                        goto caseL;\n                    }\n\n                    case '0':\n                    {\n                        break;\n                    }\n\n                    case 'Y':\n                    {\n                        choice = 1;\n                        goto createG;\n                        break;\n                    }\n\n                }\n\n                break;\n            }\n\n            case '3':\n            {\n                periods(\"Hello World\");\n                break;\n            }\n\n            case '4': \n            {\n                clrscr();\n                periods(\"Goodbye\");\n                clrscr();\n                exit(1);\n            }\n\n            default:\n            {\n                printf(\"Wrong input\\n Try again\");\n                sleep(1);\n                break; \n            }\n        }\n\n    }while(choice != -2);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>This may still need a lot of error checking and handling for \"unexpected\" inputs but it answers the problem.</p>\n"}], "owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1569756345, "creation_date": 1561482579, "last_edit_date": 1563296286, "question_id": 56758957, "link": "https://stackoverflow.com/questions/56758957/how-to-properly-make-a-dynamic-command-line-menu", "title": "How to properly make a dynamic command-line menu?", "body": "<p>More precisely.. How do I add a \"go back to main menu\" function as all other softwares and games have? </p>\n\n<pre><code>void showMenu()\n{\n    puts( \"1. Create school\\n\" \n           \"2. Add room\\n\" \n           \"3.Add student to room\\n\"\n           \"4.Find student\\n\"\n           \"5. Show students in room\\n\"\n           \"\\n\" \"6. Exit\");\n}\n\n\nint main()\n{\n    clrscr();\n\n    studentList *foundStudent;\n\n    int input;\n    showMenu();\n\n    while( scanf(\"%d\", &amp;input) )\n    {   \n\n        if(input == 6)\n        {\n            periods(\"Exiting\");\n            break;\n        }\n\n        if(input == 1)\n        {\n            school *school;\n            school = createSchool();\n        }\n\n        if(input == 2)\n        {\n            int room, roomNr;\n            printf(\"Enter room Nr. and Class:\");\n            scanf(\"%d %d\", &amp;room, &amp;roomNr);\n\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Anything I attempted didn't work and just created more redundancy, never expected how <code>goto</code> can be so confusing. </p>\n\n<p>Although <code>switch</code> makes more sense, I don't believe it fixes my problem.</p>\n"}, {"tags": ["c", "gdb", "valgrind", "segmentation-fault", "sigbus"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1561483245, "post_id": 56758924, "comment_id": 100075743, "body": "This is going to be a very platform-specific answer, and you don&#39;t specify your platform. For example, on some platforms, an unaligned read or write can cause SIGBUS."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1561483395, "post_id": 56758924, "comment_id": 100075801, "body": "<code>int *iptr = (int *) ++cptr;</code> is undefined behaviour due to strict aliasing rule."}, {"owner": {"reputation": 113, "user_id": 5230930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b8ef7bf42a570234b44bb51d7766f92?s=128&d=identicon&r=PG&f=1", "display_name": "CodeWarrior101", "link": "https://stackoverflow.com/users/5230930/codewarrior101"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1561484223, "post_id": 56758924, "comment_id": 100076129, "body": "@DavidSchwartz. Platform for the above sample code is x86_64. I understand that unaligned access can cause SIGBUS but my doubt it can Invalid read/Write cause it?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561484368, "post_id": 56758924, "comment_id": 100076191, "body": "@kiranBiradar Yup.  Undefined behavior.  And given <code>malloc</code> returns a pointer to memory with the strictest alignment, incrementing by one byte is a sure way to guarantee you&#39;ll get unaligned access if the compiler attempts to do what the code is asking it to do."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561487368, "post_id": 56758924, "comment_id": 100077582, "body": "@CodeWarrior101 No, on x86_64, invalid reads and writes cause SIGSEGV. Hence undefined behavior."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1561492187, "post_id": 56758924, "comment_id": 100079595, "body": "@JL2210 Invalid reads and writes can also generate <code>SIGBUS</code>.  As in this case.  A <code>SIGSEGV</code> is a <b>SEG</b>mentation <b>V</b>iolation - your process tried to access memory it was not permitted to access.  See <a href=\"https://en.wikipedia.org/wiki/Segmentation_fault\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Segmentation_fault</a>  A <code>SIGBUS</code>, or a memory <b>BUS</b> error, on the other hand, means your process tried to access memory in a way that the underlying hardware could not accomplish - your process was allowed to read/write the memory, but tried to do it in an unsupported-by-hardware way.  See <a href=\"https://en.wikipedia.org/wiki/Bus_error\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bus_error</a>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561554837, "post_id": 56758924, "comment_id": 100102816, "body": "@AndrewHenle Right. Since <code>fun2()</code> was called, the error would be SIGBUS. Thank you for catching that."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561558493, "post_id": 56758924, "comment_id": 100105261, "body": "@CodeWarrior101 Valgrind is not useful for SIGBUS errors. Invalid read/writes on x86_64 may cause SIGBUS, but may also cause SIGSEGV."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5230930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b8ef7bf42a570234b44bb51d7766f92?s=128&d=identicon&r=PG&f=1", "display_name": "CodeWarrior101", "link": "https://stackoverflow.com/users/5230930/codewarrior101"}, "edited": false, "score": 0, "creation_date": 1561490213, "post_id": 56759629, "comment_id": 100078785, "body": "This is intentional to cause bus error. I have modified my original question for better understanding."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 2, "last_activity_date": 1561492717, "last_edit_date": 1561492717, "creation_date": 1561485405, "answer_id": 56759629, "question_id": 56758924, "link": "https://stackoverflow.com/questions/56758924/can-invalid-read-write-cause-sigbus-error/56759629#56759629", "title": "Can invalid Read/Write cause SIGBUS Error?", "body": "<pre><code>int *iptr = (int *) ++cptr; \n*iptr = 42; //SIGBUS\n</code></pre>\n\n<p>violates multiple parts of the C standard.</p>\n\n<p>You're running afoul of <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p7\" rel=\"nofollow noreferrer\"><strong>6.3.2.3 Pointers</strong>, paragraph 7</a>:</p>\n\n<blockquote>\n  <p>A pointer to an object type may be converted to a pointer to a different object type. If the resulting pointer is not correctly aligned for the referenced type, the behavior is undefined.</p>\n</blockquote>\n\n<p>as well as violating the strict-aliasing rule of <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5p7\" rel=\"nofollow noreferrer\"><strong>6.5 Expressions</strong>, paragraph 7</a>:</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an lvalue expression that has one of the following types:</p>\n  \n  <ul>\n  <li>a type compatible with the effective type of the object,</li>\n  <li>a qualified version of a type compatible with the effective type of the object,</li>\n  <li>a type that is the signed or unsigned type corresponding to the effective type of the object,</li>\n  <li>a type that is the signed or unsigned type corresponding to a qualified version of the effective type of the object,</li>\n  <li>an aggregate or union type that includes one of the aforementioned types among its members (including, recursively, a member of a subaggregate or contained union), or</li>\n  <li>a character type. </li>\n  </ul>\n</blockquote>\n\n<p>Per <a href=\"http://valgrind.org/docs/manual/mc-manual.html\" rel=\"nofollow noreferrer\">the Valgrind documentation for Memcheck</a>:</p>\n\n<blockquote>\n  <p><strong>4.1. Overview</strong></p>\n  \n  <p>Memcheck is a memory error detector. It can detect the following\n  problems that are common in C and C++ programs.</p>\n  \n  <ul>\n  <li><p>Accessing memory you shouldn't, e.g. overrunning and underrunning heap blocks, overrunning the top of the stack, and accessing memory\n  after it has been freed.</p></li>\n  <li><p>Using undefined values, i.e. values that have not been initialised, or that have been derived from other undefined values.</p></li>\n  <li><p>Incorrect freeing of heap memory, such as double-freeing heap blocks, or mismatched use of malloc/new/new[] versus\n  free/delete/delete[]</p></li>\n  <li><p>Overlapping src and dst pointers in memcpy and related functions.</p></li>\n  <li><p>Passing a fishy (presumably negative) value to the size parameter of a memory allocation function.</p></li>\n  <li><p>Memory leaks.</p></li>\n  </ul>\n</blockquote>\n\n<p>Note that your code</p>\n\n<pre><code>int *iptr = (int *) ++cptr; \n*iptr = 42; //SIGBUS\n</code></pre>\n\n<p>does none of the things Valgrind claims to detect.  You're not accessing memory you don't have permission to access, nor are you accessing memory outside the bounds of the region you created with <code>malloc()</code>.  You haven't <code>free()</code>'d the memory yet.  You have no uninitialized variables, you're not double-<code>free()</code>ing memory, nor are you using <code>memcpy()</code> improperly with overlapping source and destination regions.  And you're not passing negative/\"fishy\" sizes to allocation functions. And you're not leaking any memory.</p>\n\n<p>So, no, Valgrind doesn't even claim to be able to detect code that will cause a <code>SIGBUS</code>.</p>\n"}], "owner": {"reputation": 113, "user_id": 5230930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b8ef7bf42a570234b44bb51d7766f92?s=128&d=identicon&r=PG&f=1", "display_name": "CodeWarrior101", "link": "https://stackoverflow.com/users/5230930/codewarrior101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 1, "accepted_answer_id": 56759629, "answer_count": 1, "score": 1, "last_activity_date": 1561492717, "creation_date": 1561482419, "last_edit_date": 1561490097, "question_id": 56758924, "link": "https://stackoverflow.com/questions/56758924/can-invalid-read-write-cause-sigbus-error", "title": "Can invalid Read/Write cause SIGBUS Error?", "body": "<p><strong>EDIT 1</strong>: Platform is x86_64 for the sample program.</p>\n\n<p><strong>EDIT 2:</strong> I am editing this for better understanding. Below are two different questions. First question is can invalid read/write cause SIGBUS? and second question is Will Valgrind be useful for SIGBUS Analysis?. Sample code is for the second question to support my opinion that is Valgrind will not be useful at all in case of SIGBUS error. I might be wrong here.</p>\n\n<p><strong>Actual Scenario:</strong> We have a screen reader app which is crashing after 2 days of continuous testing (once crash due to SIGBUS). I have a coredump file but i don't have the right binary and debug packages. So essentially i have to test this in a different binary and coredump is not working properly in gdb due to mismatch in debug packages. I can see some invalid read/write in screen-reader module during Valgrind analysis. My teammate suggested that by fixing these invalid read/write will resolve this problem but i think it will not fix it. Below is my understanding of both the signals.</p>\n\n<p><strong>SIGSEGV:</strong> Address is valid but read/write permissions are not there.</p>\n\n<p><strong>SIGBUS:</strong> Address itself is invalid(CPU not able to find address due to mis aligment etc.) </p>\n\n<p>I have a question related to SIGBUS signal. I have searched similar questions on stack overflow but didn't find any clear answer to this question.</p>\n\n<p><strong>Can Invalid read/write cause bus error(SIGBUS)?</strong>.</p>\n\n<p>My understanding is that Invalid Read/Write will always cause Segmentation Fault (SIGSEGV) and best way to fix bus error is by running gdb on application. Valgrind analysis in case of bus error will not be helpful at all. Below code explains that in more detail.</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n\ntypedef struct {\nchar *name;\nint val;\n}data;\n\nvoid fun1()\n{\n    data *ptr = malloc(sizeof(data));\n    ptr-&gt;val = 100;\n    ptr-&gt;name = \"name in structure\";\n\n    printf(\"val:%d name:%s\\n\",ptr-&gt;val,ptr-&gt;name);\n    free(ptr);\n    ptr = NULL;\n    printf(\"val:%d name:%s\\n\",ptr-&gt;val,ptr-&gt;name); //SIGSEGV\n    return;\n}\n\nint fun2()\n{\n    #if defined(__GNUC__) \n    # if defined(__i386__) \n    /* Enable Alignment Checking on x86 */\n    __asm__(\"pushf\\norl $0x40000,(%esp)\\npopf\"); \n    # elif defined(__x86_64__)  \n    /* Enable Alignment Checking on x86_64 */\n    __asm__(\"pushf\\norl $0x40000,(%rsp)\\npopf\"); \n    # endif \n    #endif \n\n    char *cptr = malloc(sizeof(int) + 1);\n    char *optr = cptr;\n    int *iptr = (int *) ++cptr; \n    *iptr = 42; //SIGBUS\n    free(optr);\n\n    return 0; \n}\n\nvoid fun()\n{\n    fun2();\n    //fun1();\n}\n\nint main()\n{\n    fun();\n    return 0;\n}\n</code></pre>\n\n<p>In case of Segmentation fault, Valgrind report will have the details about the code which is causing crash but in case of SIGBUS crash, I didn't find any such details in Valgrind report.</p>\n\n<p>Valgrind report for SIGSEGV:</p>\n\n<pre><code>==28128== Memcheck, a memory error detector\n==28128== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==28128== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==28128== Command: ./a.out\n==28128== Parent PID: 27953\n==28128== \n==28128== Invalid read of size 8\n==28128==    at 0x400619: fun1 (tmp.c:18)\n==28128==    by 0x400695: fun (tmp.c:46)\n==28128==    by 0x4006A6: main (tmp.c:51)\n==28128==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==28128== \n==28128== \n==28128== Process terminating with default action of signal 11 (SIGSEGV)\n==28128==  Access not within mapped region at address 0x0\n==28128==    at 0x400619: fun1 (tmp.c:18)\n==28128==    by 0x400695: fun (tmp.c:46)\n==28128==    by 0x4006A6: main (tmp.c:51)\n==28128==  If you believe this happened as a result of a stack\n==28128==  overflow in your program's main thread (unlikely but\n==28128==  possible), you can try to increase the size of the\n==28128==  main thread stack using the --main-stacksize= flag.\n==28128==  The main thread stack size used in this run was 8388608.\n==28128== \n==28128== HEAP SUMMARY:\n==28128==     in use at exit: 0 bytes in 0 blocks\n==28128==   total heap usage: 2 allocs, 2 frees, 1,040 bytes allocated\n==28128== \n==28128== All heap blocks were freed -- no leaks are possible\n==28128== \n==28128== For counts of detected and suppressed errors, rerun with: -v\n==28128== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Valgrind report for SIGBUS:</p>\n\n<pre><code>==28176== Memcheck, a memory error detector\n==28176== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==28176== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==28176== Command: ./a.out\n==28176== Parent PID: 27953\n==28176== \n==28176== \n==28176== HEAP SUMMARY:\n==28176==     in use at exit: 0 bytes in 0 blocks\n==28176==   total heap usage: 1 allocs, 1 frees, 5 bytes allocated\n==28176== \n==28176== All heap blocks were freed -- no leaks are possible\n==28176== \n==28176== For counts of detected and suppressed errors, rerun with: -v\n==28176== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "operators"], "comments": [{"owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "edited": false, "score": 0, "creation_date": 1561483102, "post_id": 56758903, "comment_id": 100075686, "body": "Would u like to answer why the output is coming like this ? The link which u send went over my head."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 2, "creation_date": 1561483418, "post_id": 56758903, "comment_id": 100075814, "body": "Pazival Because the compiler is allowed to evaluate the arguments in any order"}, {"owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "edited": false, "score": 0, "creation_date": 1561483514, "post_id": 56758903, "comment_id": 100075862, "body": "So my output is also correct?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1561484979, "post_id": 56758903, "comment_id": 100076471, "body": "suggest reading: <a href=\"https://www.tutorialspoint.com/cprogramming/c_operators_precedence.htm\" rel=\"nofollow noreferrer\">operator precedence in C</a>  which includes the info on the order of evaluation of the operators"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1561485210, "post_id": 56758903, "comment_id": 100076593, "body": "regarding <i>According to me the output is : iel iemlo</i>  there are 3 single character outputs in the statement; <code>printf(&quot;%c %c %c &quot;,++*p,*++p,*p++);</code>  so the output can never be <code>iel iemlo*</code>"}, {"owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "edited": false, "score": 0, "creation_date": 1561485292, "post_id": 56758903, "comment_id": 100076633, "body": "I know about operator precedence I am unable to understand the above program output."}, {"owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "edited": false, "score": 0, "creation_date": 1561485483, "post_id": 56758903, "comment_id": 100076716, "body": "ielmo is the output of puts(c)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561485806, "post_id": 56758903, "comment_id": 100076878, "body": "Suggest reading about <a href=\"https://stackoverflow.com/questions/3575350/sequence-points-in-c\">sequence points</a>  and in the C standard document"}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 0, "creation_date": 1561487003, "post_id": 56758903, "comment_id": 100077410, "body": "@DevParzival It could even print &quot;99 bottles&quot; and it would be &quot;correct&quot;. When you invoke undefined behaviour there are no incorrect results as the program is allowed to do literally anything. &quot;<i>behavior, [...] for which this International Standard imposes no requirements</i>&quot; semi-oficcialy in can give you the famous <a href=\"http://catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">nasal demons</a>. In that sense  your question doesn&#39;t make one, unless you are asking what does CPU exactly do in your case i.e. what&#39;s the reason behind that particular manifestation."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561520370, "post_id": 56758903, "comment_id": 100086025, "body": "@user3629249 it&#39;s undefined behaviour so anything can happen, including outputting <code>iel iemlo*</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 1, "last_activity_date": 1561506821, "last_edit_date": 1561506821, "creation_date": 1561485650, "answer_id": 56759678, "question_id": 56758903, "link": "https://stackoverflow.com/questions/56758903/unable-to-understand-output-of-the-below-code/56759678#56759678", "title": "Unable to understand output of the below code", "body": "<p>running the OPs posted code results in:</p>\n\n<pre><code>m l h hemlo\n</code></pre>\n\n<p>However, the compiler output was:</p>\n\n<pre><code>gcc    -ggdb -Wall -o \"untitled\" \"untitled.c\"  -lncurses -lrt -lpthread -lm -lgmp \nuntitled.c: In function \u2018main\u2019:\nuntitled.c:11:32: warning: operation on \u2018p\u2019 may be undefined [-Wsequence-point]\nprintf(\"%c %c %c \",++*p,*++p,*p++);\n                              ~^~\nuntitled.c:11:32: warning: operation on \u2018p\u2019 may be undefined [-Wsequence-point]\nCompilation finished successfully.\n</code></pre>\n\n<p>due to the undefined problems, the actual output could be anything</p>\n"}], "owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "closed_date": 1561485787, "accepted_answer_id": 56759678, "answer_count": 1, "score": 0, "last_activity_date": 1561506821, "creation_date": 1561482352, "last_edit_date": 1561491208, "question_id": 56758903, "link": "https://stackoverflow.com/questions/56758903/unable-to-understand-output-of-the-below-code", "closed_reason": "Duplicate", "title": "Unable to understand output of the below code", "body": "<p>The code which is given below was asked by my teacher.\nIt is just to test who can figure out the output with out running the code.\nFor compiling Turbo C++ was used.</p>\n\n<p>I am unable to understand how incrementing and decrementing happens in a function call and weather values are passed from left to right or right to left in the below code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\nint main(){\n    char c[]=\"hello\";\n    char *p;\n    clrscr();\n    p=&amp;c[0];\n    printf(\"%c %c %c \",++*p,*++p,*p++);\n    puts(c);\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>According to me the output is :\niel\niemlo</p>\n\n<p>but when it compiled and run I got :\nm l h\nhemlo\nWhy is this happening is the values are passed from right to left or some thing else ?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "for-loop", "if-statement"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1561481794, "post_id": 56758750, "comment_id": 100075073, "body": "I suggest you remove all that <code>else</code> code block in its entirety. Anyway, you are indexing by <code>k</code> whose value depends on the input data. Suppose one array element value is 10000000? What will <code>arrnum[k]</code> access then?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561481917, "post_id": 56758750, "comment_id": 100075153, "body": "You should say <code>if(x &gt; 30) x = 30;</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1561482598, "post_id": 56758750, "comment_id": 100075457, "body": "What&#39;s the \\n doing there in scanf? It makes you input n+1 numbers but you did not notice?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1561483144, "post_id": 56758750, "comment_id": 100075708, "body": "@iooshine Where is the variable  ptr_int declared and what is its meaning?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1561483200, "post_id": 56758750, "comment_id": 100075730, "body": "@iooshine And you should split the function in several other functions. For example one function enters an array. Other function sorts an array. And another function outputs an array."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11636661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72cedd6352af38d5b90125c8c97742fd?s=128&d=identicon&r=PG&f=1", "display_name": "liooshine", "link": "https://stackoverflow.com/users/11636661/liooshine"}, "edited": false, "score": 0, "creation_date": 1561483407, "post_id": 56758930, "comment_id": 100075806, "body": "thank you! I understand what you all said about the else-if not being necessary. Also I saw the mistake I did in the &quot;if&quot; statement in the most inner for-loop and the problem I had with scanf_s inside the loop, doing one extra iteration because of the &quot;\\n&quot;.. it really helpd!  I know there is a built in function for sorting, but I wanted to try it &quot;the hard way&quot; myself for practice :)"}, {"owner": {"reputation": 517, "user_id": 11666730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3aedeb707d14d1073d715fa1b944d27?s=128&d=identicon&r=PG&f=1", "display_name": "plum 0", "link": "https://stackoverflow.com/users/11666730/plum-0"}, "reply_to_user": {"reputation": 13, "user_id": 11636661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72cedd6352af38d5b90125c8c97742fd?s=128&d=identicon&r=PG&f=1", "display_name": "liooshine", "link": "https://stackoverflow.com/users/11636661/liooshine"}, "edited": false, "score": 0, "creation_date": 1561484276, "post_id": 56758930, "comment_id": 100076154, "body": "@liooshine No problem! Do you understand why you can start j from the point of i in my example? If not I can try to explain it.  Also kudos to you for doing it the hard way, best way to learn!"}, {"owner": {"reputation": 13, "user_id": 11636661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72cedd6352af38d5b90125c8c97742fd?s=128&d=identicon&r=PG&f=1", "display_name": "liooshine", "link": "https://stackoverflow.com/users/11636661/liooshine"}, "edited": false, "score": 0, "creation_date": 1561552224, "post_id": 56758930, "comment_id": 100101169, "body": "Yes I understood! it&#39;s working now! :D  Thank you very much for your help!!"}], "tags": [], "owner": {"reputation": 517, "user_id": 11666730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3aedeb707d14d1073d715fa1b944d27?s=128&d=identicon&r=PG&f=1", "display_name": "plum 0", "link": "https://stackoverflow.com/users/11666730/plum-0"}, "is_accepted": true, "score": 0, "last_activity_date": 1561482452, "creation_date": 1561482452, "answer_id": 56758930, "question_id": 56758750, "link": "https://stackoverflow.com/questions/56758750/condition-in-a-nested-for-loop-in-c-wont-work/56758930#56758930", "title": "condition in a nested for loop in C won&#39;t work", "body": "<p>I am not certain about your elseif statement in your sorting algorithm. The code can also potentially reduce runtime by not reiterating through sorted elements and only swapping the smallest element into the location of i. Also consider the use of the qsort built-in function for sorting arrays! I have a suspicion that your sorting algorithm is doing something weird to the array, which is why the loop to print the sorted array is not working. Also you are never using ptr_int, or pointers (well arrays are kind of pointers I suppose).</p>\n\n<p>`</p>\n\n<pre><code>for(int i = 0; i&lt;x; i++)\n{\n    for(int j = i; j&lt;x; j++)\n    {\n        if(arr[j] &lt; arr[i])\n        {\n            int temp = arr[i];\n            arr[i] = arr[j];\n            arr[j] = temp;\n        }\n    }\n }\n</code></pre>\n\n<p>`</p>\n"}], "owner": {"reputation": 13, "user_id": 11636661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72cedd6352af38d5b90125c8c97742fd?s=128&d=identicon&r=PG&f=1", "display_name": "liooshine", "link": "https://stackoverflow.com/users/11636661/liooshine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 56758930, "answer_count": 1, "score": 0, "last_activity_date": 1561482452, "creation_date": 1561481656, "question_id": 56758750, "link": "https://stackoverflow.com/questions/56758750/condition-in-a-nested-for-loop-in-c-wont-work", "title": "condition in a nested for loop in C won&#39;t work", "body": "<p>I am new to C and I'm practicing for-loops and pointers.\nIn this exercise I try to write a function that sorts array elements. the first part of the code (where I input the elements) is working, but everything below gives me a hard time. I don't understand if the problem is in the if/else statements or anywhere else in the loop structure. also the last loop doesn't work (I just want it to iterate over the sorted array and print the elements, like I did before with it unsorted.</p>\n\n<p>Hope I can get some help, and  also if you see anything more that I should pay attention to...</p>\n\n<p>Thanks a bunch.</p>\n\n<p>I tried checking if the way I defined the loop was accurate, that I put all the right values and that the basic \"idea\" that I had for sorthing the array was ok.</p>\n\n<pre><code>void sort_array_elements()\n{\nint x, i, j, k, temp;\nprintf(\"\\n input the number of elements to store in the array: \");\nscanf_s(\"%d\", &amp;x);\n\nint arrnum[30];\nptr_int = &amp;x;\nprintf(\"input %d elements in the array: \\n\", x);\nfor (i = 0; i &lt; x; i++)\n{\n    scanf_s(\"%d\\n\", &amp;arrnum[i]);\n}\n\nprintf(\"the elements in the array before sorting: \\n\");\nfor (i = 0; i &lt; x; i++)\n{\n    printf(\"element %d: %d\\n\", i, arrnum[i]);\n}\n\n\nfor (i = 0; i &lt; x; i++)\n{\n    for (j = 1; j &lt; x; j++)\n    {\n        if (arrnum[i] &gt; arrnum[j])\n        {\n            temp = arrnum[i];\n            arrnum[i] = arrnum[j];\n            arrnum[j] = temp;\n\n\n        }\n        else if (arrnum[i] == arrnum[j])\n        {\n            for (k = arrnum[i + 1]; k &lt; x; k++)\n            {\n                if (arrnum[k] != arrnum[j])\n                {\n                    temp = arrnum[k];\n                    arrnum[k] = arrnum[j];\n                    arrnum[j] = temp;\n                    break;\n                }\n            }\n        }\n\n\n    }\n\n}\n\nprintf(\"the elements in the array after sorting: \\n\");\n\nfor (i = 0; i &lt; x; i++)\n{\n    printf(\"element %d: %d\\n\", i, arrnum[i]);\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1561481046, "post_id": 56758525, "comment_id": 100074750, "body": "Missing <code>#include &lt;pthread.h&gt;</code>."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1561481911, "post_id": 56758525, "comment_id": 100075147, "body": "each time you use the queue, you shoul dhold the lock, this is not the case, thus you have <b>many</b> races"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1561482687, "post_id": 56758525, "comment_id": 100075500, "body": "you should probably use condition_variable"}, {"owner": {"reputation": 47, "user_id": 11516009, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1kCjMDOsypU/AAAAAAAAAAI/AAAAAAAAAbE/nsZruMzKB9Y/photo.jpg?sz=128", "display_name": "ibtissam latachi", "link": "https://stackoverflow.com/users/11516009/ibtissam-latachi"}, "edited": false, "score": 0, "creation_date": 1561484174, "post_id": 56758525, "comment_id": 100076111, "body": "Dear kiran Biradar, by using a mutex when inserting to the queue, the writer threads are sequenced, hence avoiding to overwrite the same slot"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11516009, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1kCjMDOsypU/AAAAAAAAAAI/AAAAAAAAAbE/nsZruMzKB9Y/photo.jpg?sz=128", "display_name": "ibtissam latachi", "link": "https://stackoverflow.com/users/11516009/ibtissam-latachi"}, "edited": false, "score": 0, "creation_date": 1561485204, "post_id": 56759291, "comment_id": 100076589, "body": "Thank you for your feedback. I tried your solution, and still getting the same thing. I don&#39;t want to use conditional variable, because they aren t supported in freeRtos 9.1, so it will be difficult when porting the code :("}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "reply_to_user": {"reputation": 47, "user_id": 11516009, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1kCjMDOsypU/AAAAAAAAAAI/AAAAAAAAAbE/nsZruMzKB9Y/photo.jpg?sz=128", "display_name": "ibtissam latachi", "link": "https://stackoverflow.com/users/11516009/ibtissam-latachi"}, "edited": false, "score": 0, "creation_date": 1561487956, "post_id": 56759291, "comment_id": 100077842, "body": "maybe the downvoter can explain his position an propose something constructive?"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "reply_to_user": {"reputation": 47, "user_id": 11516009, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1kCjMDOsypU/AAAAAAAAAAI/AAAAAAAAAbE/nsZruMzKB9Y/photo.jpg?sz=128", "display_name": "ibtissam latachi", "link": "https://stackoverflow.com/users/11516009/ibtissam-latachi"}, "edited": false, "score": 0, "creation_date": 1561489065, "post_id": 56759291, "comment_id": 100078312, "body": "@ibtissamlatachi can you explain why it does not solve you problem? actually can you spot a test that would make it clear?"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1561489330, "post_id": 56759291, "comment_id": 100078416, "body": "sorry but the question is not that clear to me... &quot;sometimes the consumer skips some of the inserted items&quot; does look like a many wake up problem... but maybe I&#39;m wrong, let&#39;s wait for clarifications..."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1561489979, "post_id": 56759291, "comment_id": 100078688, "body": "sorry for the downvoter again, but sem_post() just wakes up <b>one</b> thread, thus there are no limitation here... see <a href=\"https://stackoverflow.com/questions/16163932/multiple-threads-can-wait-on-a-semaphore-at-same-time\" title=\"multiple threads can wait on a semaphore at same time\">stackoverflow.com/questions/16163932/&hellip;</a>"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561491503, "post_id": 56759291, "comment_id": 100079308, "body": "@OznOg sorry for the confusion so far. It&#39;s late here in India I will surely check this in the morning."}], "tags": [], "owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "is_accepted": true, "score": 2, "last_activity_date": 1561526705, "last_edit_date": 1561526705, "creation_date": 1561483982, "answer_id": 56759291, "question_id": 56758525, "link": "https://stackoverflow.com/questions/56758525/producer-consumer-synck-using-only-mutexes-and-semaphores-no-pthread-cond/56759291#56759291", "title": "Producer Consumer synck using only mutexes and semaphores (no pthread_cond)", "body": "<p>I would suggest to modify your functions like:</p>\n\n<pre><code>void *producer (void *q)\n{   \n    queue *fifo;\n    int i,insert,sleep_time;\n    fifo = (queue *)q;\n\n    for (i = 0; i &lt; LOOP; i++) {\n        pthread_mutex_lock (fifo-&gt;mut); /* take lock */\n        while (fifo-&gt;full) {  /* check for fullness */\n            pthread_mutex_unlock (fifo-&gt;mut); /* if full wait for things to be removed */\n            sem_wait (fifo-&gt;sem_notFull); /* never sleep with lock */\n            pthread_mutex_lock (fifo-&gt;mut); /* take lock an recheck the condition to handle spurious wakeups */\n        }\n        /* here lock is held */\n        insert = rando(); /* safely manipulate the queue */\n        queueAdd (fifo, insert);\n\n        pthread_mutex_unlock (fifo-&gt;mut); /* safely release the queue */\n        sem_post (fifo-&gt;sem_notEmpty);  /* wake up potential waiters */\n        sleep_time=poissonfunction(i);\n        usleep (sleep_time);\n    }\n\n    return (NULL);\n}\n\nvoid *consumer (void *q)\n{\n    queue *fifo;\n    int i, d;\n\n    fifo = (queue *)q;\n\n    for (i = 0; i &lt; LOOP; i++) { /* careful you don't produce 'enough' */\n        pthread_mutex_lock (fifo-&gt;mut); /* take lock before using fifo */\n        while (fifo-&gt;empty) { /* check is something to read */\n            pthread_mutex_unlock (fifo-&gt;mut); /* release lock before sleep */\n            sem_wait (fifo-&gt;sem_notEmpty); /* wait a sometihing to be pused in queue */\n            pthread_mutex_lock (fifo-&gt;mut); /* take back lock before checking for spurious wakeup */\n        }\n        /* from here lock is held, queue can be safely maniplated */\n        queueDel (fifo, &amp;d); \n        pthread_mutex_unlock (fifo-&gt;mut); /* finished -&gt; release lock */\n        sem_post (fifo-&gt;sem_notFull); /* wake up eventual waiters*/\n\n        usleep(2000);\n    }\n\n    return (NULL);\n}\n</code></pre>\n\n<p>You need to check spurious wake ups as the semaphore is always notified even if the queue is not empty/full, thus being woke up does not mean the queue is in the correct state, thus a test is needed.</p>\n\n<p>You may use conditional_variable to handle the full and empty event, this would remove the semaphores here.</p>\n"}], "owner": {"reputation": 47, "user_id": 11516009, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1kCjMDOsypU/AAAAAAAAAAI/AAAAAAAAAbE/nsZruMzKB9Y/photo.jpg?sz=128", "display_name": "ibtissam latachi", "link": "https://stackoverflow.com/users/11516009/ibtissam-latachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "accepted_answer_id": 56759291, "answer_count": 1, "score": 2, "last_activity_date": 1561526705, "creation_date": 1561480654, "last_edit_date": 1561496587, "question_id": 56758525, "link": "https://stackoverflow.com/questions/56758525/producer-consumer-synck-using-only-mutexes-and-semaphores-no-pthread-cond", "title": "Producer Consumer synck using only mutexes and semaphores (no pthread_cond)", "body": "<p>I'm currently learning how to use mutexes and Semaphores for multithreading in linux using pthreads, and I've been working on an Implementation of mutlti-producer/one-Consumer problem using only two binary semaphores and a mutex to synck access to bounded buffer, but the program doesn't work as planned</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;semaphore.h&gt;\n\n#define QUEUESIZE 20\n#define LOOP 15\n#define MAX_THREADS 10\n\nvoid *producer (void *args);\nvoid *consumer (void *args);\n\nint lambda;\nint queuesi;\ntypedef struct {\n        int buf[QUEUESIZE];\n        long head, tail;\n        int full, empty;\n        pthread_mutex_t *mut; \n    sem_t *sem_notFull, *sem_notEmpty;\n} queue;\n\nqueue *queueInit (void);\nvoid queueDelete (queue *q);\nvoid queueAdd (queue *q, int in);\nvoid queueDel (queue *q, int *out);\nint factorial( int i);           \nint poissonfunction(int i);\nint rando();\n\nint main (int argc, char *argv[])\n{\n        int max_pro,max_con,j,i;\n        queue *fifo;\n        pthread_t prod[MAX_THREADS],cons[MAX_THREADS];\n\n        max_con=1;\n        max_pro=4;\n        lambda=6;\n        queuesi=4;  \n\n        fifo = queueInit ();\n\n        if (fifo ==  NULL) {\n                fprintf (stderr, \"main: Queue Init failed.\\n\");\n                exit (1);\n        }\n\n\n        for(i=0; i&lt;max_pro;i++)  \n        pthread_create (&amp;prod[i], NULL, producer,fifo);\n\n        for(j=0;j&lt;max_con;j++)\n        pthread_create (&amp;cons[j], NULL, consumer, fifo);\n\n        for(i=0; i&lt;max_pro;i++)\n        pthread_join (prod[i], NULL);\n\n        for(j=0;j&lt;max_con;j++)\n        pthread_join (cons[j], NULL);     \n\n        queueDelete (fifo);\n\n        return 0;\n}\n\n void *producer (void *q)\n{\n        queue *fifo;\n        int i,insert,sleep_time;     \n        fifo = (queue *)q;\n\n        for (i = 0; i &lt; LOOP; i++) {\n            //pthread_mutex_lock (fifo-&gt;mut);\n            while (fifo-&gt;full)\n               {\n                    printf (\"producer: queue FULL.\\n\");\n                    sem_wait (fifo-&gt;sem_notFull);\n                }\n\n             pthread_mutex_lock (fifo-&gt;mut);\n             insert=rando();     \n             queueAdd (fifo, insert);  \n             printf(\"producer item  number%d item produced  %d\\n\",i,insert);\n             pthread_mutex_unlock (fifo-&gt;mut);\n\n             sem_post (fifo-&gt;sem_notEmpty);\n             sleep_time=poissonfunction(i);\n             usleep (sleep_time);\n        }\n\n        return (NULL);\n}                           \n\n void *consumer (void *q)\n{\n        queue *fifo;\n        int i, d;\n\n        fifo = (queue *)q;\n\n        for (i = 0; i &lt; LOOP; i++) \n        {\n            //pthread_mutex_lock (fifo-&gt;mut);\n            while (fifo-&gt;empty) \n            {      \n               printf (\"consumer: queue empty\\n\");\n               sem_wait (fifo-&gt;sem_notEmpty);\n            }\n            pthread_mutex_lock (fifo-&gt;mut);\n            queueDel (fifo, &amp;d);\n            pthread_mutex_unlock (fifo-&gt;mut);\n\n            sem_post (fifo-&gt;sem_notFull);\n            printf (\"consumer: recieved %d.\\n\", d);\n            usleep(2000);\n        }                 \n\n  return (NULL);\n}\n\nqueue *queueInit (void)\n{\n        queue *q;\n\n        q = (queue *)malloc (sizeof (queue));\n        if (q == NULL) return (NULL);       \n        q-&gt;empty = 1;\n        q-&gt;full = 0;\n        q-&gt;head = 0;\n        q-&gt;tail = 0;\n        q-&gt;mut = (pthread_mutex_t *) malloc (sizeof (pthread_mutex_t));\n        pthread_mutex_init (q-&gt;mut, NULL);\n    q-&gt;sem_notFull = (sem_t *) malloc (sizeof (sem_t));\n        sem_init (q-&gt;sem_notFull, 0, 1);\n        q-&gt;sem_notEmpty = (sem_t *) malloc (sizeof (sem_t));\n        sem_init (q-&gt;sem_notEmpty,  0, 1); \n\n        return (q);\n}\n\nvoid queueDelete (queue *q)\n{\n        pthread_mutex_destroy (q-&gt;mut);\n        free (q-&gt;mut);\n        sem_destroy (q-&gt;sem_notFull);\n        free (q-&gt;sem_notFull);   \n\n        sem_destroy (q-&gt;sem_notEmpty);\n        free (q-&gt;sem_notEmpty);\n\n        free (q);\n}\n\nvoid queueAdd (queue *q, int in)\n{\n        q-&gt;buf[q-&gt;tail] = in;\n        q-&gt;tail++;\n        if (q-&gt;tail == queuesi)                     \n        q-&gt;tail = 0;\n\n        if (q-&gt;tail == q-&gt;head)\n                q-&gt;full = 1;\n        q-&gt;empty = 0;\n\n        return;\n}\n\nvoid queueDel (queue *q, int *out)\n{                                       \n*out = q-&gt;buf[q-&gt;head];\n\n        q-&gt;head++;\n        if (q-&gt;head == queuesi)\n                q-&gt;head = 0;\n        if (q-&gt;head == q-&gt;tail)\n                q-&gt;empty = 1;\n        q-&gt;full = 0;\n\n        return;                    \n}\n\nint factorial(int i){\n if(i==0)\n  return i=1;\n else\n  i=i*factorial(i-1);\nreturn (i);\n}               \n\nint poissonfunction (int i){\n    int time,c,t;\n    double p;\n    t = 1000;\n    c = lambda*t;\n    p = (pow(c,i)*exp(-c))/factorial(i);\n    time =(int) p*t;\n    return (time);\n}\n\nint rando(){\n    int value;\n    value=(int) random()/1000;\n    return (value);\n}\n</code></pre>\n"}, {"tags": ["c", "random", "parallel-processing", "openmp", "random-seed"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 2, "creation_date": 1561479066, "post_id": 56758053, "comment_id": 100073790, "body": "Your <code>ran2</code> function is not thread safe."}, {"owner": {"reputation": 3, "user_id": 7326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafd78a2e8f3a2e73d585408bbc9edb1?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay Ju", "link": "https://stackoverflow.com/users/7326457/ajay-ju"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1561480235, "post_id": 56758053, "comment_id": 100074346, "body": "@1201ProgramAlarm is that the reason for segmentation fault?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1561480351, "post_id": 56758053, "comment_id": 100074388, "body": "Probably.  You&#39;re using <code>iy</code> to compute index <code>j</code>, but it looks like <code>iy</code> can be negative and if another thread set it that way bad stuff can happen."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1561650923, "post_id": 56758053, "comment_id": 100144152, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56697829/random-number-generator-of-lecuyer-with-bays-durham\">Random number generator of L&#39;Ecuyer with Bays-Durham</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafd78a2e8f3a2e73d585408bbc9edb1?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay Ju", "link": "https://stackoverflow.com/users/7326457/ajay-ju"}, "edited": false, "score": 0, "creation_date": 1561483519, "post_id": 56758471, "comment_id": 100075865, "body": "@rtoikala thanks, most of the problem got solved, but there is a concern, as the number of threads changes the value varies a little, is that correct? if so I want to know why?"}, {"owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "reply_to_user": {"reputation": 3, "user_id": 7326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafd78a2e8f3a2e73d585408bbc9edb1?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay Ju", "link": "https://stackoverflow.com/users/7326457/ajay-ju"}, "edited": false, "score": 0, "creation_date": 1561485484, "post_id": 56758471, "comment_id": 100076718, "body": "I suspect it is because different random numbers are being generated with different numbers of threads, which would not be a  problem."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1561651081, "post_id": 56758471, "comment_id": 100144224, "body": "Rather than shifting seed in the loop, consider it making private. Just an OpenMP way of saying, this variable is private to each thread! Essentially the similar way @rtoijala mentions but more close to OpenMP"}], "tags": [], "owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "is_accepted": true, "score": 0, "last_activity_date": 1561480403, "creation_date": 1561480403, "answer_id": 56758471, "question_id": 56758053, "link": "https://stackoverflow.com/questions/56758053/need-help-parallelising-the-ran2-and-main-program-causing-segmentation-fault-ope/56758471#56758471", "title": "Need help parallelising the ran2 and main program causing segmentation fault openmp", "body": "<p>Your code has several problems.</p>\n\n<p>First of all, you are passing the uninitialized values of <code>x</code>, <code>y</code>, and <code>z</code> to each OpenMP thread with <code>firstprivate</code>, which the compiler warns about. This is easy to work around by moving the declarations inside to <code>for</code> loop and removing the <code>firstprivate</code>. For the same reason, <code>i</code> should be <code>private</code>.</p>\n\n<p><code>seed</code> is supposed to stay the same during each iteration, but since it is a shared variable, the threads are competing to get their value written to it. This is also fixed by moving the declaration of <code>seed</code> into the loop.</p>\n\n<p>The third problem is that the threads are also racing when writing to <code>count</code>. Since you want to sum up the values from the different threads, you should be using the <code>reduction(+:count)</code> directive.</p>\n\n<p>Fourth, the <code>ran2</code> function is not thread-safe. It has static state in the form of <code>idum2</code>, <code>iy</code>, and <code>iv</code>, where again the threads race. The best way to fix this is to get rid of the global state by moving it into a <code>struct ran_state</code> (see below) which is passed as a parameter. Then replace each place referring to <code>idum2</code> with <code>state-&gt;idum2</code>, <code>iy</code> with <code>iy</code> and <code>state-&gt;iv</code> with <code>state-&gt;iv</code>. Finally, create and initialize this state before the <code>for</code> loop, and mark it as <code>firstprivate</code> so each thread gets its own initialized state.</p>\n\n<p>This then looks as below (in one file for convenience):</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n// Insert the #defines for ran2 here ...\n\nstruct ran_state {\n    long idum2;\n    long iy;\n    long iv[NTAB];\n};\n\n// Insert ran2 here, replacing iv with state-&gt;iv, and so on ...\n\nint main(int argc, char **argv){\n    int niter, i;\n    double count;\n    double pi;\n    niter=10000;\n    count=0;\n    struct ran_state state = { 123456789, 0, {0} };\n\n#pragma omp parallel for reduction(+:count) firstprivate(state) private(i) num_threads(4)\n    for(i=1;i&lt;=niter;i++){\n        double x, y, z;\n        long seed;\n        seed=i;\n        x=ran2(&amp;seed, &amp;state);\n        y=ran2(&amp;seed, &amp;state);\n        z=x*x+y*y;\n        if(z&lt;1){\n            count+=1;\n        }\n    }\n    pi=count*4.0/niter;\n    printf(\"The value of pi is %8.14f\\n\",pi);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafd78a2e8f3a2e73d585408bbc9edb1?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay Ju", "link": "https://stackoverflow.com/users/7326457/ajay-ju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 56758471, "answer_count": 1, "score": 0, "last_activity_date": 1590323786, "creation_date": 1561478625, "last_edit_date": 1590323786, "question_id": 56758053, "link": "https://stackoverflow.com/questions/56758053/need-help-parallelising-the-ran2-and-main-program-causing-segmentation-fault-ope", "title": "Need help parallelising the ran2 and main program causing segmentation fault openmp", "body": "<p>I tried to parallelize the loop but increasing the thread count leave me with 'Segmentation fault(core dumped)'</p>\n\n<p>I have parallelized the loop in the main.c, the loop internally refers to the ran2.c file function, which somewhere leads me to the segmentation fault, I need help parallelizing the program.</p>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\nint main(int argc, char **argv) {\n    int niter, i, j;\n    long seed;\n    double count;\n    double x,y,z,pi;\n    extern float ran2();\n    niter=10000;\n    count=0;\n\n    #pragma omp parallel firstprivate(x, y, z, i) shared(count) num_threads(4)\n    for(i=1; i&lt;=niter; i++) {\n        seed=i;\n        x=ran2(&amp;seed);\n        y=ran2(&amp;seed);\n        z=x*x+y*y;\n        if(z&lt;1) {\n            count+=1;\n        }\n    }\n    pi=count*4.0/niter;\n    printf(\"The value of pi is %8.14f\\n\",pi);\n    return 0;\n}\n\n</code></pre>\n\n<p>ran2.c</p>\n\n<pre><code>\n#define IM2 2147483399\n#define IM1 2147483563\n#define AM (1.0/IM1)\n#define IMM1 (IM1-1)\n#define IA1 40014\n#define IA2 40692\n#define IQ1 53668\n#define IQ2 52774\n#define IR1 12211\n#define IR2 3791\n#define NTAB 32\n#define NDIV (1+IMM1/NTAB)\n#define EPS 1.2e-7\n#define RNMX (1.0-EPS)\n\nfloat ran2(long *idum) {\n    int j;\n    long k;\n    static long idum2=123456789;\n    static long iy=0;\n    static long iv[NTAB];\n    float temp;\n    if (*idum &lt;= 0) {\n        if (-(*idum) &lt; 1)\n            *idum=1;\n        else *idum = -(*idum);\n        idum2=(*idum);\n        for (j=NTAB+7; j&gt;=0; j--) {\n            k=(*idum)/IQ1;\n            *idum=IA1*(*idum-k*IQ1)-k*IR1;\n            if (*idum &lt; 0)\n                *idum += IM1;\n            if (j &lt; NTAB)\n                iv[j] = *idum;\n        }\n        iy=iv[0];\n    }\n    k=(*idum)/IQ1;\n    *idum=IA1*(*idum-k*IQ1)-k*IR1;\n    if (*idum &lt; 0)\n        *idum += IM1;\n    k=idum2/IQ2;\n    idum2=IA2*(idum2-k*IQ2)-k*IR2;\n    if (idum2 &lt; 0)\n        idum2 += IM2;\n    j=iy/NDIV;\n    iy=iv[j]-idum2;\n    iv[j] = *idum;\n    if (iy &lt; 1)\n        iy += IMM1;\n    if ((temp=AM*iy) &gt; RNMX)\n        return RNMX;\n    else\n        return temp;\n}\n\n\n</code></pre>\n\n<p>I need to parallelize the program.</p>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1561478054, "post_id": 56757679, "comment_id": 100073319, "body": "What about the first bit?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1561478118, "post_id": 56757679, "comment_id": 100073350, "body": "In the number <code>64752031</code> is the <code>6</code> for least significant or the most significant bit? How to interpret the mapping?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "edited": false, "score": 0, "creation_date": 1561479824, "post_id": 56757679, "comment_id": 100074138, "body": "The 0th bit would would now be the 6th bit in the binary for the Char &#39;H&#39;. So it would be the 6th bit would be now the first bit"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1561480863, "post_id": 56757679, "comment_id": 100074655, "body": "@gooddayjay One more is zero bit less significant bit of the character? In other words are you counting bits from left to right or from right to left?"}], "answers": [{"comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1561479302, "post_id": 56757783, "comment_id": 100073901, "body": "OP is not trying to swap bits."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561479620, "post_id": 56757783, "comment_id": 100074042, "body": "I have two versions, which should I use?"}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1561479602, "last_edit_date": 1561479602, "creation_date": 1561477673, "answer_id": 56757783, "question_id": 56757679, "link": "https://stackoverflow.com/questions/56757679/re-indexing-bits-within-a-char/56757783#56757783", "title": "Re-Indexing Bits Within a Char", "body": "<p>Use bitwise operators.</p>\n\n<p>Here's an example of how to move the second bit to the seventh bit:</p>\n\n<pre><code>x |= (x &amp; 1&lt;&lt;1) &lt;&lt; 6;\nx &amp;= ~(1&lt;&lt;1);\n</code></pre>\n\n<p>If my bit numbering bothers anybody, I'm sorry. This is just how I read binary numbers.</p>\n\n<p>You can also put this into an inline function:</p>\n\n<pre><code>inline int bit_mode(int *x, int bit1, int bit2)\n{\n    *x |= *x &amp; (1&lt;&lt;(bit1-1)) &lt;&lt; (bit2-1);\n    *x &amp;= ~(1&lt;&lt;(bit1-1));\n    return *x;\n}\n\nint a;\nbit_mode(&amp;a, 2, 7);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561479705, "post_id": 56758280, "comment_id": 100074087, "body": "Whoa. Don&#39;t you think you should give some hints instead of just giving the complete answer?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561480083, "post_id": 56758280, "comment_id": 100074257, "body": "Well, there is even some <a href=\"https://meta.stackexchange.com/questions/211842/hint-only-mostly-hint-answers-desirable-or-not\">meta</a> on it. I think, it would be definitely nice to encourage others including OP to find a solution by themselves by giving hints. I just though of it as a fun challenge and proceeded to solve it. But I think I agree with &quot;A hint is by definition intentionally not providing an answer to the question&quot;. To the question &quot;Is there a way...?&quot; - I answer: yes and to prove it, here is example way of doing it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "edited": false, "score": 0, "creation_date": 1561480174, "post_id": 56758280, "comment_id": 100074304, "body": "Do you think you could explain why you have the const int bit0 through bit7 modded by 10 for each of the bit?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "edited": false, "score": 1, "creation_date": 1561480206, "post_id": 56758280, "comment_id": 100074325, "body": "JL2210, it&#39;s from a practice book I&#39;m reading for over the summer"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561480322, "post_id": 56758280, "comment_id": 100074381, "body": "@gooddayjay I love those, especially when they provide a bit of difficulty."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1561480582, "post_id": 56758280, "comment_id": 100074517, "body": "@gooddayjay I need to convert <code>64752031</code> into <code>bit0=6; bit1=4; bit2=7; bit3=5; ...</code> (this could be an array ;) ), ie. extract numbers at decimals positions. Because I chose for the input to be just an integer number (you didn&#39;t specify the input format. a string? an array of numbers?) I assumed the <code>64752031</code> is an <code>unsigned long</code> variable. So I need to extract the numbers from the <code>64752031</code> integer, that&#39;s why for example for <code>7</code> I need to divide by <code>1000000</code> , I get <code>647</code>, then I do mod by <code>10</code> and I get <code>7</code>."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1561479611, "creation_date": 1561479611, "answer_id": 56758280, "question_id": 56757679, "link": "https://stackoverflow.com/questions/56757679/re-indexing-bits-within-a-char/56758280#56758280", "title": "Re-Indexing Bits Within a Char", "body": "<p>Just shift the bits to proper positions. After some fun, I think I've got this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdint.h&gt;\n\n/**\n * A little helper function\n * get the bit number 'as' from the byte 'in'\n * and put that bit as the number 'num' in the output\n */\nstatic inline\nuint8_t map_get_bit_as(uint8_t in, \n  uint8_t num, uint8_t as)\n{\n  return (!!(in &amp; (1 &lt;&lt; as))) &lt;&lt; num;\n}\n\nuint8_t map(unsigned long mapping, uint8_t in) \n{\n  // static_assert(CHAR_BIT == 8, \"are you insane?\");\n\n  const int bit0 = mapping / 10000000 % 10;\n  const int bit1 = mapping / 1000000 % 10;\n  const int bit2 = mapping / 100000 % 10;\n  const int bit3 = mapping / 10000 % 10;\n  const int bit4 = mapping / 1000 % 10;\n  const int bit5 = mapping / 100 % 10;\n  const int bit6 = mapping / 10 % 10;\n  const int bit7 = mapping / 1 % 10;\n\n  return\n    map_get_bit_as(in, 0, bit0) |\n    map_get_bit_as(in, 1, bit1) |\n    map_get_bit_as(in, 2, bit2) |\n    map_get_bit_as(in, 3, bit3) |\n    map_get_bit_as(in, 4, bit4) |\n    map_get_bit_as(in, 5, bit5) |\n    map_get_bit_as(in, 6, bit6) |\n    map_get_bit_as(in, 7, bit7);\n}\n\nint main() {\n  printf(\"%#02x %#02x\\n\\n\", 'H', map(64752031, 'H'));\n}\n</code></pre>\n\n<p>will output:</p>\n\n<pre><code>0x48 0x41\n</code></pre>\n\n<p>tested on <a href=\"https://repl.it/@kamilcukrowski/ScratchyLargeNumericalanalysis\" rel=\"nofollow noreferrer\">repl</a>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "edited": false, "score": 1, "creation_date": 1561480667, "post_id": 56758405, "comment_id": 100074563, "body": "Great approach. Something I never thought really."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "edited": false, "score": 0, "creation_date": 1561498429, "post_id": 56758405, "comment_id": 100081807, "body": "Is there any possible way to input a larger string then just &#39;H&#39;? Like what If I wanted to input a sentences, how could this be done?"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1561500539, "post_id": 56758405, "comment_id": 100082424, "body": "Just loop over the chars in your string and convert every char encountered. Assume you want to transform string &quot;before&quot; to &quot;after&quot;. You just have to do <code>int i; for (i=0; before[i]; i++)  { after[i]=perm[before[i]];  }</code> The loop will stop when <code>before[i]==&#39;\\0&#39;</code>  (null terminated string) and every char of &#39;after&#39; will get a permuted version of the corresponding char in &#39;before&#39; thanks to the look up table &#39;perm&#39;. Do not forget to add a terminating &#39;\\0&#39; at the end of &#39;after&#39; (<code>after[i]=&#39;\\0&#39;;</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "edited": false, "score": 0, "creation_date": 1561500903, "post_id": 56758405, "comment_id": 100082507, "body": "I understand that, however, when on line 23, you do printf(&quot;%.2x =&gt; %.2x\\n&quot;, &#39;H&#39;, perm[&#39;H&#39;]); which prints out a permed &#39;H&#39;. How would you print the statement with larger strings?"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1561501269, "post_id": 56758405, "comment_id": 100082589, "body": "Include the printf() in a loop, and replace both &#39;H&#39; in the printf by <code>before[i]</code> if <code>before</code> is the string to convert and <code>i</code> the loop index."}], "tags": [], "owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "is_accepted": false, "score": 3, "last_activity_date": 1561480954, "last_edit_date": 1561480954, "creation_date": 1561480117, "answer_id": 56758405, "question_id": 56757679, "link": "https://stackoverflow.com/questions/56757679/re-indexing-bits-within-a-char/56758405#56758405", "title": "Re-Indexing Bits Within a Char", "body": "<p>If you need to process large strings, it is probably better to use a look-up table that will precompute the translation.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned char perm[256];  // permutation table\nunsigned mapping[8]={6,4,7,5,2,0,3,1};\n// assumes    7 6 5 4 3 2 1 0\n//       =&gt;   6 4 7 5 2 0 3 1\n\nvoid mkperm(unsigned char perm[256]) {\n  for (int i=0; i&lt;256; i++)\n    perm[i]=0;\n\n  for (int i=0;i&lt;256;i++) {\n    for (int j=7; j&gt;=0; j--) {\n      int pos=mapping[7-j]; // at mapping[0] is the new position of bit 7\n      if (i &amp; (1&lt;&lt;j))       // only considers set bits, the table is previously cleared\n        perm[i] |= (1&lt;&lt;pos) ;\n    }\n  }\n}\n\nint main() {\n  mkperm(perm);\n  printf(\"%.2x =&gt; %.2x\\n\",'H',perm['H']);\n}\n</code></pre>\n\n<p><code>mkperm()</code> computes the permutation table by scanning the successive bits of every char. If a bit is set in char i, we set at position i in the translation table a bit at one at a logical weight given by the mapping. Setting this one is done by oring the content of cell i with a 1 properly shifted.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "edited": false, "score": 0, "creation_date": 1561521679, "post_id": 56759029, "comment_id": 100086262, "body": "Is there a way to reverse this encoding? Like what would be the decoded version?"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1561482856, "creation_date": 1561482856, "answer_id": 56759029, "question_id": 56757679, "link": "https://stackoverflow.com/questions/56757679/re-indexing-bits-within-a-char/56759029#56759029", "title": "Re-Indexing Bits Within a Char", "body": "<p>If I have correctly understood the order of bits as you are counting them then the corresponding function can look the following way as it is shown in the demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdint.h&gt;\n\nchar encode( char c, uint32_t mask )\n{\n    unsigned char result = '\\0';\n\n    for ( size_t i = 0; i &lt; 2 * sizeof( mask ) ; i++ )\n    {\n        uint32_t bit =  ( ( ( uint32_t )1 &lt;&lt; ( CHAR_BIT - 1 - ( mask &amp; 0xf ) ) ) &amp; c ) != 0;\n        result |= bit &lt;&lt; i;\n        mask &gt;&gt;= 4;\n    }\n\n    return ( char )result;\n}\n\nint main( void )\n{\n    uint32_t mask = 0x64752031;\n    char c = 'H';\n\n    printf( \"c = %hhx\\n\", c );\n\n    c = encode( c, mask );\n\n    printf( \"c = %hhx\\n\", c );\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>c = 48\nc = 41\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11402812"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1561482856, "creation_date": 1561477327, "question_id": 56757679, "link": "https://stackoverflow.com/questions/56757679/re-indexing-bits-within-a-char", "title": "Re-Indexing Bits Within a Char", "body": "<p>I have an exercise where I have to encode and decode strings at the bit level that are given in by the command line.</p>\n\n<p>The caveat for this is that I have to use a permutation mapping to re-order the bits.</p>\n\n<p>Here's an Example:</p>\n\n<p>The User Inputs The Character To Encode</p>\n\n<pre><code> H\n</code></pre>\n\n<p>The Binary for H is </p>\n\n<pre><code> 01001000 \n</code></pre>\n\n<p>However, that is the regular mapping of the 8 bits, through 0-7.</p>\n\n<p>My program will have to permute the bits to whatever Mapping Patter I use.</p>\n\n<p>For Example, If I use Mapping 64752031</p>\n\n<p>The Bits for the Char 'H' </p>\n\n<pre><code>01001000 \n</code></pre>\n\n<p>Turn To</p>\n\n<pre><code>01000001\n</code></pre>\n\n<p>When encoding the char, the 0th bit turns to the 6th bit, the 2nd bit turns to the 4th bit, the 3rd bit turns to the 7th bit, and so on. Whatever is based on for that mapping.</p>\n\n<p>Is there a way that I can manipulate and change the order of bits based on the permutation map given? </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "macos", "mmap"], "comments": [{"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1561479775, "post_id": 56757651, "comment_id": 100074114, "body": "I guess that writing to either is invalidating the caching of the other. I don&#39;t know a solution other than to keep them separate - but maybe someone else does."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 11698879, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eES-kbAC4co/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rel_7y6mnJovc06lOsKHE-JCU4UTQ/photo.jpg?sz=128", "display_name": "John Muth", "link": "https://stackoverflow.com/users/11698879/john-muth"}, "is_accepted": false, "score": -1, "last_activity_date": 1561485710, "last_edit_date": 1561485710, "creation_date": 1561480844, "answer_id": 56758563, "question_id": 56757651, "link": "https://stackoverflow.com/questions/56757651/question-regarding-optimising-reading-and-writing-to-a-file-through-mmap2/56758563#56758563", "title": "Question regarding optimising reading and writing to a file through mmap(2)?", "body": "<p>In order to get the same sorts of I/O patterns with a single file as you got with two files, make sure that the 2nd part of the file starts at a page boundary (4K). You may have to pad the 1st part out to make that happen.</p>\n"}, {"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 0, "last_activity_date": 1561481404, "creation_date": 1561481404, "answer_id": 56758688, "question_id": 56757651, "link": "https://stackoverflow.com/questions/56757651/question-regarding-optimising-reading-and-writing-to-a-file-through-mmap2/56758688#56758688", "title": "Question regarding optimising reading and writing to a file through mmap(2)?", "body": "<p>You can use two pointers from the same mapping:</p>\n\n<pre><code>int len = 1300,\n    off = 600,\n    prot = PROT_READ | PROT_WRITE,\n    flags = MAP_SHARED,\n    fd = open(\"file\", O_RDWR);\nchar *map = mmap(NULL, len, prot, flags, fd, 0),\n     *map2 = map + off;\n\n*map = 'a';\n*map2 = 'b';\n</code></pre>\n\n<p>Don't use the <code>offset</code> argument unless it's a multiple of the page size (usually 4096).</p>\n"}], "owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565448913, "creation_date": 1561477261, "last_edit_date": 1565448913, "question_id": 56757651, "link": "https://stackoverflow.com/questions/56757651/question-regarding-optimising-reading-and-writing-to-a-file-through-mmap2", "title": "Question regarding optimising reading and writing to a file through mmap(2)?", "body": "<p>I am having some issues with optimisations in my code. I would try my best to explain the scenario I am in. If not clear please ask.</p>\n\n<p>The problem is straight. Previously I had 2 separate files that I was opening in the same process and calling <code>mmap(2)</code> on both separately. The first mapping is more frequently accessed compared to second mapping.(both for reading and writing)\nI thought to optimise the code more, instead of using 2 separate files I could simply place the contents of first file(whose size really small compared to second file) in the beginning of the second file and shift root of the second file ahead by the required offset.\nThis would avoid usage of 2 files, hence avoiding calls to <code>open(2)</code> and <code>mmap(2)</code>. As this setup code (that calls <code>open(2)</code> and <code>mmap(2)</code>) will get called at least 100,000+ times, removing these 2 calls should have mattered. But I don\u2019t know why the accesses to the portion that I shifted to the beginning of the 2nd file became much slower. On google I read somewhere that it maybe the case of some page caching but I am not sure if it is the case because writing operation got almost 10-20 times slower. Please suggest me how can I improve this?</p>\n\n<p>UPDATE:</p>\n\n<p>As per the tests I conducted in past, it didn't make much difference using two files or one file. I presume this question would require some deep study on how mmap deals with pages.</p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1561476930, "post_id": 56757456, "comment_id": 100072743, "body": "Unless you&#39;re dealing with a low-level simple situation where you are linking in your own C runtime, the order likely shouldn&#39;t matter."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1561477219, "post_id": 56757456, "comment_id": 100072908, "body": "What kind of files? What are the files for? Will you call the program with different files all the time?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 4, "creation_date": 1561477416, "post_id": 56757456, "comment_id": 100073007, "body": "There&#39;s no really &quot;best practice&quot; of passing many arguments to a program. There are not many options. One - you can pass it all using command line arguments. Two - you can create a config file with some syntax and pass that config file. The end. <code>Is this good practice?</code> - passing 1000 options to postfix is nicer with configuration files. Passing 7 arguments to <code>openssl</code> is  nothing special."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1561477551, "post_id": 56757456, "comment_id": 100073059, "body": "Seems like this depends a lot on the specifics, e.g., are the input files always related (i.e., the same 7 files always together, effectively being one input that just happens to be split into different files) \u2013 if so, perhaps you could consider using a naming pattern for them and infer the other names from the first."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1561477727, "post_id": 56757456, "comment_id": 100073156, "body": "On the other hand if it just happens to be that it needs 7 different files but they are not always tied together, perhaps you can specify the type of each file as an additional command-line argument instead of relying on the order of arguments (e.g., <code>program -a file.A -b file.B \u2026</code>)."}, {"owner": {"reputation": 380, "user_id": 4847383, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23e4fb61452c6a648d6af1a505265a3d?s=128&d=identicon&r=PG&f=1", "display_name": "daragh", "link": "https://stackoverflow.com/users/4847383/daragh"}, "edited": false, "score": 0, "creation_date": 1561477834, "post_id": 56757456, "comment_id": 100073203, "body": "Each file has approx. 45 million records with an associated value. Essentially I am reading the values from the input files into a hash map and then I will calculate a weighted average and write this to an output file. The 7 input files are created weekly and are timestamped so the name changes every time they are recreated."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1561479703, "post_id": 56757456, "comment_id": 100074086, "body": "@daragh You should specify that in the question. Also show exactly how the files are named."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1561487977, "post_id": 56757456, "comment_id": 100077849, "body": "One way to make it clearer is to use named arguments: <code>convert --in_data mydata.txt --index myindex.txt --output newdata.txt</code> is somewhat clearer than  `convert mydata.txt myindex.txt newdata.txt&#39;"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1561540950, "post_id": 56757456, "comment_id": 100094382, "body": "re. name changing due to timestamp, it doesn&#39;t prevent using a naming pattern, i.e., a predictable difference. For example, if you have &quot;foo_20190626.aaa&quot;, the other files can be &quot;foo_20190626.bbb&quot;, &quot;foo_20190626.ccc&quot;, etc. Then giving one of the names as an argument allows you to construct the other names. (Again, this is assuming the set of files always goes together. If you mix from multiple sets, then see the named arguments.)"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1561487626, "last_edit_date": 1561487626, "creation_date": 1561485875, "answer_id": 56759726, "question_id": 56757456, "link": "https://stackoverflow.com/questions/56757456/best-practice-for-c-program-with-large-number-of-input-files/56759726#56759726", "title": "Best practice for C program with large number of input files", "body": "<p>There is a variety of mechanisms in common use for designating input files to programs, prominent among them (in no particular order):</p>\n\n<ul>\n<li>separate command-line arguments, possibly with built-in default values (more on this below)</li>\n<li>a common filename stem passed as an argument, with different extensions for the different individual files; the specific filenames are computed by the program from the one stem</li>\n<li>a standard or user-specified file containing the names of the files to operate upon</li>\n</ul>\n\n<p>Combinations of those are possible, and there are other alternatives.  There is no single best practice, and which method or method(s) to choose is to some extent a matter of opinion and personal preference, likely with a dose of the specific practicalities of the particular program.</p>\n\n<blockquote>\n  <p>I could pass these to my program as command line argument but it is not exactly succinct and could lead to errors with the order they are provided.</p>\n</blockquote>\n\n<p>I agree.</p>\n\n<blockquote>\n  <p>I had thought of creating 1 input file containing the 7 required file names and just passing this to my program. Is this good practice?</p>\n</blockquote>\n\n<p>That is one of the common methods.  Note, however, that although it makes the command line more succinct, it doesn't by itself do much for the ordering issue.</p>\n\n<p>Personally, I wouldn't be too keen on a program that has seven <em>required</em> arguments, yet I also wouldn't like being forced to write an auxiliary file just to convey filenames to the program.  To the extent that you do use command-line arguments, I urge you to define them as <em>options</em>, in the <code>getopt()</code> sense of the term, because mixing up argument order will otherwise be a significant practical problem for your users.  Similarly, if you provide a control file as a way to convey the working file names, then I suggest going to just a bit more effort to use an order-insensitive key / value format.  To the extent that you can provide sensible defaults, that would improve ease-of-use, too.</p>\n"}], "owner": {"reputation": 380, "user_id": 4847383, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23e4fb61452c6a648d6af1a505265a3d?s=128&d=identicon&r=PG&f=1", "display_name": "daragh", "link": "https://stackoverflow.com/users/4847383/daragh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1561541020, "accepted_answer_id": 56759726, "answer_count": 1, "score": -1, "last_activity_date": 1561561095, "creation_date": 1561476451, "last_edit_date": 1561561095, "question_id": 56757456, "link": "https://stackoverflow.com/questions/56757456/best-practice-for-c-program-with-large-number-of-input-files", "closed_reason": "Opinion-based", "title": "Best practice for C program with large number of input files", "body": "<p>I am writing a C program that takes 7 input files. I could pass these to my program as command line arguments but it is not exactly succinct and could lead to errors with the order they are provided. </p>\n\n<p>I had thought of creating 1 input file containing the 7 required file names and just passing this to my program. </p>\n\n<p>What is best practice for providing a large number of input files to a C program?</p>\n"}, {"tags": ["c", "arduino", "thread-sleep", "esp32", "sleep-mode"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1561475147, "post_id": 56756589, "comment_id": 100071701, "body": "&quot;They said...&quot; Who, do you have a documentation link? If so, update your question."}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1561828957, "post_id": 56756589, "comment_id": 100191998, "body": "@Quang: Does John Romkey&#39;s answer below address your issue? If so, you should mark it as the accepted answer. At the very least, you could give him some feedback."}], "answers": [{"tags": [], "owner": {"reputation": 3224, "user_id": 2670348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4b635f01c3129b3b3222a2930783f3?s=128&d=identicon&r=PG", "display_name": "romkey", "link": "https://stackoverflow.com/users/2670348/romkey"}, "is_accepted": true, "score": 6, "last_activity_date": 1561477786, "creation_date": 1561477786, "answer_id": 56757807, "question_id": 56756589, "link": "https://stackoverflow.com/questions/56756589/is-void-setup-code-wiped-out-when-deep-sleep-is-used-in-esp32/56757807#56757807", "title": "Is void setup() code wiped out when deep sleep is used in esp32", "body": "<p>When the ESP32 enters deep sleep, it turns off the processor that's running your code. The contents of memory and the current state of the processor are lost. It costs power to maintain the contents of its memory and the CPU state, and the point of deep sleep is to save as much power as possible, so it stops powering these things.</p>\n\n<p>So when it restarts out of deep sleep it's as if it just powered up. Your <code>setup()</code> function will run again and will need to do any initialization again.</p>\n\n<p>There are a couple of ways to preserve state across sleep cycles.</p>\n\n<p>Obviously you can store data in flash memory using <code>EEPROM</code> or <code>SPIFFS</code>. Writing to flash is slow and costs a lot of power, so this isn't great if you're running off a battery.</p>\n\n<p>You can also store data in the static RAM that's part of the real-time-clock (RTC). This RAM is built into the ESP32 and is maintained during deep sleep. Its contents will be lost or cleared when the ESP32 loses power or is flashed.</p>\n\n<p>You can declare a variable to live in the RTC RAM using <code>RTC_DATA_ATTR</code>. For instance:</p>\n\n<pre><code>RTC_DATA_ATTR unsigned wakeups;\n\nvoid setup() {\n  wakeups++;\n\n  Serial.begin(115200);\n  Serial.printf(\"%u wakeups\\n\", wakeups);\n\n  // do other stuff and enter deep sleep\n}\n</code></pre>\n\n<p>There's only 8KB of static RAM so you can't store huge amounts of data there.</p>\n\n<p>You also need to be careful using it. Storing complex C++ objects in it will almost certainly not work correctly across deep sleep restarts. Storing pointers to data (like a <code>char*</code> pointing to a C string) will not work because the data the pointer pointed to will be lost after restarting from deep sleep.</p>\n\n<p>How deep sleep affects any electronics connected to the ESP32 is difficult to predict. The ESP32 will stop powering its GPIO lines during deep sleep. Whether the devices remain powered and how they react to the GPIO lines floating depends on the device. If they remain powered they may retain their state from the previous cycle. It really depends on the device and the circuitry.</p>\n\n<p><a href=\"https://randomnerdtutorials.com/esp32-deep-sleep-arduino-ide-wake-up-sources/\" rel=\"noreferrer\">This article</a> is a good tutorial on deep sleep and has more information.</p>\n"}], "owner": {"reputation": 109, "user_id": 11211982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zQFTJdkfrnw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddpFHqO-iQU38KPOcaiumRCW-k8g/mo/photo.jpg?sz=128", "display_name": "Quang Minh L&#234;", "link": "https://stackoverflow.com/users/11211982/quang-minh-l%c3%aa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 1, "accepted_answer_id": 56757807, "answer_count": 1, "score": 2, "last_activity_date": 1561535371, "creation_date": 1561473678, "last_edit_date": 1561535371, "question_id": 56756589, "link": "https://stackoverflow.com/questions/56756589/is-void-setup-code-wiped-out-when-deep-sleep-is-used-in-esp32", "title": "Is void setup() code wiped out when deep sleep is used in esp32", "body": "<p>I'm doing wireless sensor node using esp32 (slave) and rf24l01 module. My next step is to put my slave in sleep mode (maybe deep sleep). Can I use deep sleep for my project?  </p>\n\n<p>They said </p>\n\n<blockquote>\n  <p>everything stored in that memory is wiped out and cannot be accessed.</p>\n</blockquote>\n\n<p>So is all my <code>void setup()</code> code wiped out? Or just my pack0.temp, humid, soil is wiped out?</p>\n\n<p>My code is attached below</p>\n\n<pre><code>struct package0\n{\n  float temperature = 0;\n  float humidity = 0;\n  int soil = 0;\n};\ntypedef struct package0 Package0;\nPackage0 pack0;\n/**********************************/\n/**************RF24****************/\n  RF24 radio(25,26);\n  RF24Network network(radio);\n  const uint16_t this_node = 01;\n  const uint16_t master00 = 00;\n  const unsigned long interval = 3000;\n\n/**********************************/\nvoid setup() {\n  dht.begin();\n  radio.begin();\n  network.begin(90, this_node);\n  radio.setPALevel(RF24_PA_MIN);\n  radio.setDataRate(RF24_250KBPS);\n}\n\nvoid loop() {\n  // put your main code here, to run repeatedly:\n  network.update();\n  unsigned long now = millis();\n  if (now - last_sent &gt;= interval)\n  {\n    last_sent = now;\n    send();\n  }\n}\nvoid send()\n{\n  pack0.humidity = dht.readHumidity();\n  pack0.temperature = dht.readTemperature();\n  pack0.soil = map(analogRead(SOILPIN), 0, 4096, 100, 0);//convert to percentage\n  if (isnan(pack0.humidity) || isnan(pack0.temperature))\n  {\n    Serial.println(F(\"Failed to read from DHT sensor!\"));\n    return;\n  }\n  RF24NetworkHeader header(master00);\n  bool ok = network.write(header, &amp;pack0, sizeof(pack0));\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1561472211, "post_id": 56755480, "comment_id": 100069919, "body": "If the user types control-D (or control-Z on Windows), your program will read that as an EOF, but if you want to keep reading, you usually have to call <code>clearerr</code> on stdin."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561472375, "post_id": 56755480, "comment_id": 100070024, "body": "<code>clearerr()</code> is indeed rarely used, for pretty much the reasons you describe.  I suspect that uses for it were more common in the past, with I/O devices that were subject to issues that could be resolved by manual operator intervention.  But even so, there are still some use cases today."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1561472000, "post_id": 56755806, "comment_id": 100069790, "body": "<code>FILE</code>&#39;s error and end-of-file indicators are logically separate.  However, <code>clearerr()</code> does clear both."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 2, "last_activity_date": 1561473549, "last_edit_date": 1561473549, "creation_date": 1561471123, "answer_id": 56755806, "question_id": 56755480, "link": "https://stackoverflow.com/questions/56755480/what-is-clearerr-used-for/56755806#56755806", "title": "What is clearerr used for?", "body": "<p><code>clearerr()</code> clears the error and EOF flags from a stream.</p>\n\n<p>Say <code>FILE</code> were like this:</p>\n\n<pre><code>typedef struct {\n    int fd;\n    char *buf;\n    int error;\n    int eof;\n} FILE;\nFILE *file;\n</code></pre>\n\n<p>This would set <code>file-&gt;error</code> and <code>file-&gt;eof</code> to <code>0</code>.</p>\n\n<p>Some reasons for doing this include file I/O, such as when a file gives EOF, but then another program (or another thread, etc.) appends to it. If you clear the error after doing this, you can have your program act as sort of a <code>tail -f</code>-substitute.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 11697189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cb8c7451cb3d6a30dd0c6b036e5dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/11697189/kelvin"}, "edited": false, "score": 0, "creation_date": 1561472650, "post_id": 56755955, "comment_id": 100070217, "body": "Does this require an feof() test to distinuish EOF case from ferror() case? If the NULL return is from an error and not from EOF I would not know what to do."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1561475669, "post_id": 56755955, "comment_id": 100071996, "body": "@TobySpeight: Oops I had forgotten the <code>-f</code>. Thanks for noticing! Post edited"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 8, "last_activity_date": 1561475605, "last_edit_date": 1561475605, "creation_date": 1561471625, "answer_id": 56755955, "question_id": 56755480, "link": "https://stackoverflow.com/questions/56755480/what-is-clearerr-used-for/56755955#56755955", "title": "What is clearerr used for?", "body": "<p>There is at least one real world use case for <code>clearerr</code>: when you want to mimic <code>tail -f</code> on a file that is not opened in exclusive mode. That means that another (or many other) process(es) write at the end of a file, and one process repeatedly reads <em>even after having reached the end of file</em> in order to look whether new data has arrived. In that case, could would look like:</p>\n\n<pre><code>for (;;) {\n    if (NULL == fgets(line, sizeof(line), fd)) {\n        sleep(n);\n        clearerr(fd);     // reset EOF condition\n    }\n    else {\n        fputs(line, fdout);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1561471870, "post_id": 56755982, "comment_id": 100069716, "body": "Important clarification: <code>clearerr()</code> clears the error flag <b><i>and</i></b> the end-of-file flag.  The latter part is rather more likely to be useful than the former."}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 3, "last_activity_date": 1563284208, "last_edit_date": 1563284208, "creation_date": 1561471711, "answer_id": 56755982, "question_id": 56755480, "link": "https://stackoverflow.com/questions/56755480/what-is-clearerr-used-for/56755982#56755982", "title": "What is clearerr used for?", "body": "<p>Functions that set the error status of a <code>FILE</code> (as reported by <code>ferror</code>) do not clear it even if later called successfully. Likewise if you encounter the end of file while reading, it will not be cleared automatically even if the file later has more data available.</p>\n\n<p>Basically this means that <em>if</em> you are using <code>ferror</code> to check for an error state and you have some way of recovering from it, the <code>ferror</code> will keep indicating an error until you use <code>clearerr</code>.</p>\n\n<p>In your example, if you just use the return value of <code>fread</code> as the condition for terminating the read (i.e., EOF and any type of error are considered final), there is no need to <code>clearerr</code>: just fall through to <code>fclose</code> (and perhaps use <code>ferror</code> to determine whether to print an error message).</p>\n\n<p>On the other hand, if the <code>FILE</code> is in fact a stream on which read can later succeed, and you detect (or assume) that specific condition and retry, you should <code>clearerr</code> before retrying or you will keep seeing the old error condition on future attempts.</p>\n\n<p>Likewise, as pointed out in comments, <code>clearerr</code> also clears the end of file state, so this also applies when using <code>feof</code> to check for the end of file. (Note, however, that you generally <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">shouldn't use <code>!feof(file)</code> as the loop condition</a> when reading.)</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1561520831, "last_edit_date": 1561520831, "creation_date": 1561517189, "answer_id": 56764481, "question_id": 56755480, "link": "https://stackoverflow.com/questions/56755480/what-is-clearerr-used-for/56764481#56764481", "title": "What is clearerr used for?", "body": "<p><code>clearerr()</code> clears both the error and end-of-file flags.</p>\n\n<p>A pedantic use of <code>clearerr()</code>:</p>\n\n<pre><code>// Return -1 on end-of-file\n// Return -2 on rare file error\n// Else return the unsigned char value\nint my_get_quandry() {\n  // At this point, the file end-of-file flag may be set.\n  // At this point, the file file error flag may be set.\n  // They may both be set.\n\n  // Attempt to read another\n  int ch = fgetc();\n  if (ch != EOF) {\n    return ch;\n  }\n  // Now was the EOF due to a end-of file or error?\n  // feof() is true if end-of-file just occurred OR if end-of-file was set earlier\n  // ferror() is true if error just occurred OR if error was set earlier\n  // If only one feof() or ferror() is true, we know  why EOF just occurred,\n  // Yet if both set, we do not know.\n  ...?\n}\n</code></pre>\n\n<p>Use <code>clearerr()</code></p>\n\n<pre><code>// Return -1 on end-of-file\n// Return -2 on rare file error\n// Else return the unsigned char value\nint my_get_crystal() {\n  clearerr(stdin);\n\n  // Attempt to read another\n  int ch = fgetc();\n  if (ch != EOF) {\n    return ch;\n  }\n  // Now EOF due to at most one reason\n  if (feof(stdin)) return -1;\n  if (ferror(stdin)) return -2;\n\n  // if code reaches this point, it is due to the odd-ball platform of `char` having the\n  // same range as `int`.  But let us leave that platform for another day.\n  return ch;\n}\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 11697189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cb8c7451cb3d6a30dd0c6b036e5dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/11697189/kelvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 56755955, "answer_count": 4, "score": 7, "last_activity_date": 1563284208, "creation_date": 1561470121, "last_edit_date": 1561473499, "question_id": 56755480, "link": "https://stackoverflow.com/questions/56755480/what-is-clearerr-used-for", "title": "What is clearerr used for?", "body": "<p>I'm trying to understand when the stdio function <code>clearerr()</code> should be used.</p>\n\n<p>For example, if I <code>fread()</code> or <code>fwrite()</code> on a valid <code>FILE*</code> and get a short count and <code>ferror</code> is true, what can I do?</p>\n\n<p>From what I've read so far, <code>fread()</code> and <code>fwrite()</code> are robust and will block and/or retry (if there are locks and/or interrupts which could happen in lower level functions) so there never seems any point in using <code>clearerr()</code> because <code>fread</code> or <code>fwrite</code> errors will be so catastrophic there is no point in trying to recover.</p>\n\n<p>Additionally, <code>ferror()</code> only tells me that there is an error, not what the error is.</p>\n\n<pre><code>   #define SZ 1024\n   FILE* fp = fopen( \"foo\", \"r\" );\n   if ( fp ) {\n      char b[SZ];\n      int ch_count = fread( b, sizeof(char), SZ, fp );\n      if ( ch_count != SZ &amp;&amp; ferror( fp ) ) {\n          // how would clearerr() be used. I don't know? \n          // ....\n          // should I drop through here to fclose? (when I've got an ferror)\n      }\n      fclose( fp );\n   }\n</code></pre>\n"}, {"tags": ["c", "linux", "header", "kernel", "fork"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 3, "creation_date": 1561473676, "post_id": 56755327, "comment_id": 100070816, "body": "Would you mind telling us your <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">X problem</a>? Because I struggle to think what kind of problem forking a user process from the kernel would solve. Or why you&#39;re working in kernel space in the first place. ;-)"}, {"owner": {"reputation": 321, "user_id": 5652013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7607d79904d91ae307df0b276bcbd1d7?s=128&d=identicon&r=PG&f=1", "display_name": "NathanAck", "link": "https://stackoverflow.com/users/5652013/nathanack"}, "edited": false, "score": 0, "creation_date": 1561474142, "post_id": 56755327, "comment_id": 100071082, "body": "Yeah, please give more information. Generally do_fork is used by the kernel to handle the creation of a process in response to a syscall. If you are in kernel space, you can look at kthread_create."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1561627658, "post_id": 56755327, "comment_id": 100130096, "body": "I doubt you need to simulate this into kernel there is a lot of possibilities in user space... Create client/server model server managing the delta queue and clients using an API (date_sleep()), pipes and signals can help you very easily."}], "owner": {"reputation": 99, "user_id": 11385838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xoXUtYRTYo0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resbs7bRF5B4D2sgiIbuHM9JxSfYg/mo/photo.jpg?sz=128", "display_name": "Ramsey Alsheikh", "link": "https://stackoverflow.com/users/11385838/ramsey-alsheikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561477363, "creation_date": 1561469670, "last_edit_date": 1561477363, "question_id": 56755327, "link": "https://stackoverflow.com/questions/56755327/how-to-fork-a-process-from-kernel-space-in-linux", "title": "How to fork a process from kernel space in Linux?", "body": "<p>I asked this question at Unix&amp;Linux, and they told me to ask it here.</p>\n\n<p>I need to use a function with the same functionality as the<code>fork</code> system call.\nIt's my understanding that forking a process from kernel space would involve calling <code>do_fork</code>, but I can't figure out how I would do that. It's defined in <code>fork.c</code>, and since it's not a header file, I can't include it, can I? Please help!</p>\n\n<p>Edit: The reason I need to <code>fork</code> from the kernel is for an experiment to test the reasource use of a <a href=\"https://wiki.osdev.org/Blocking_Process\" rel=\"nofollow noreferrer\">delta queue</a>, a type of queue for sleeping processes that sleep for a known amount of time (ex. 5 milliseconds). The reason I want to simulate it and not code an actual delta queue is because I don't have the experience/knowledge to do it. For my simulation I made a system call that runs like a delta queue would, but to test it I need processes to put to sleep. Using <code>fork</code> would be the easiest way for me to make a lot of processes for the test (easier than using <code>kthreads</code>), but since I plan to run this experiment in kernel space I can't just run the system call. I could run it in user space, but then that adds an extra layer of abstraction that real delta queue wouldn't have, as it would be run by the kernel. That would minimize the relevancy of my experiement.</p>\n"}, {"tags": ["c", "overflow", "detection", "strtol"], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 1961494, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e05afd7506c9ed77e2b4bcc8b90547b8?s=128&d=identicon&r=PG&f=1", "display_name": "ajlittoz", "link": "https://stackoverflow.com/users/1961494/ajlittoz"}, "edited": false, "score": 0, "creation_date": 1561534629, "post_id": 56764033, "comment_id": 100090972, "body": "Biting my fingers! My misconception was to assume long == 32 bits with implicit equivalence of int == long int. I should have printed sizeof(long) to see my mistake. When you&#39;re tired, you don&#39;t see the obvious. <i>man limits.h</i> was not very helpful because it says <i>Long_MAX</i> acceptable value is 2^32-1 and I disregarded word <b>minimum</b> in the comments."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1586221660, "post_id": 56764033, "comment_id": 108043582, "body": "In C++ there&#39;s already the standard <code>std::stoi</code>. A small wrapper can be made for C if necessary"}], "tags": [], "owner": {"reputation": 4680, "user_id": 1334967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6319a586f055b709158acaedb8c76add?s=128&d=identicon&r=PG", "display_name": "ottomeister", "link": "https://stackoverflow.com/users/1334967/ottomeister"}, "is_accepted": true, "score": 1, "last_activity_date": 1561513152, "creation_date": 1561513152, "answer_id": 56764033, "question_id": 56755323, "link": "https://stackoverflow.com/questions/56755323/cant-get-strtol-to-detect-overflow/56764033#56764033", "title": "Can&#39;t get strtol() to detect overflow", "body": "<p><code>strtol()</code> derives a <code>long</code> (i.e. a <code>signed long</code>) value from the given string.  It only cares about overflows or underflows of the 64-bit <code>long</code> value that it constructs internally, and that it will eventually return to its caller if no problems are encountered.  It does not care at all about overflows or underflows of 32-bit values.</p>\n\n<p>This is why <code>strtol()</code> only returns an error in the examples you show where the <code>long</code> value would have overflowed into a negative 64-bit number.  (And as you noted, <code>strtoul()</code> does not complain in that case because there is no overflow of an <code>unsigned long</code> value in that case.  You would need to feed <code>strtoul()</code> a 17-digit string to overflow an <code>unsigned long</code>.)</p>\n\n<p><code>strtol()</code> also does not know or care that your program will take its 64-bit <code>long</code> result and immediately discard its upper 4 bytes by assigning the value to a 32-bit variable.  This truncation is why you were led to think that \"<em>the returned value is -1, not <code>LONG_MAX</code></em>\".  In fact the result from <code>strtol()</code> <strong>was</strong> <code>LONG_MAX</code>, but your program has discarded the top 4 bytes of <code>LONG_MAX</code> and is left with only the low 4 bytes, whose value is <code>0xffffffff</code> or <code>-1</code> when treated as a 32-bit <code>int</code>.</p>\n\n<p>If you want to use <code>strtol()</code> to generate and vet 32-bit values then you'll have to do additional range checking yourself.  After first collecting the <code>strtol()</code> result into a <code>long</code> variable and checking whether that result indicates a 64-bit overflow or underflow during the execution of <code>strtol()</code>, you can then compare that <code>long</code> result against <code>INT_MAX</code> and <code>INT_MIN</code> to see whether its value would overflow or underflow a 32-bit variable.</p>\n\n<p>Obviously you can wrap this up in a little function, which could (if you do the appropriate tinkering with <code>errno</code>) behave just like <code>strtol()</code> except that it applies to <code>int</code> values rather than <code>long</code>.  However, you should resist the urge to give your function the name <code>strtoi</code> because names that begin with <code>str[a-z]</code> are reserved by POSIX for future use in the standard library.  Some systems might already have a <code>strtoi</code> and Linux might get one someday.</p>\n"}], "owner": {"reputation": 384, "user_id": 1961494, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e05afd7506c9ed77e2b4bcc8b90547b8?s=128&d=identicon&r=PG&f=1", "display_name": "ajlittoz", "link": "https://stackoverflow.com/users/1961494/ajlittoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 56764033, "answer_count": 1, "score": 0, "last_activity_date": 1586221438, "creation_date": 1561469650, "last_edit_date": 1586221438, "question_id": 56755323, "link": "https://stackoverflow.com/questions/56755323/cant-get-strtol-to-detect-overflow", "title": "Can&#39;t get strtol() to detect overflow", "body": "<p>This program uses a lexical scanner to classify tokens as symbol, string, decimal number, hex number,\u2026 When a \"number\" is detected, it is handed over to <code>strtol()</code> to convert it to the internal 32-bit binary value. However I can't get <code>strtol()</code> to reliably return error on overflow.</p>\n\n<p>Part of conversion code is:</p>\n\n<pre><code>    errno = 0;      // erase any previous error in errno\n    switch (constType) {\n\u2026\ncase lxHex:         // hexadecimal number X'1234567890ABCDEF' (X-string)\nfprintf(stderr,\"** FindConstantFromString - converting %s\\n\",constBuffer);\n        newDictEntry-&gt;dcValue = strtol(constBuffer+2, NULL, 16);\nint myerr = errno;\nfprintf(stderr,\"     value %x errno %d\\n\",newDictEntry-&gt;dcValue, myerr);\n        newDictEntry-&gt;dcType = syNumber;\n        newDictEntry-&gt;dcSubType = 4;    // hexadecimal\n        if  (   EINVAL == errno\n            ||  ERANGE == errno\n            ) {\n            ErrDict = newDictEntry;\n            AnaError (ConstMsg+2);\n            newDictEntry-&gt;dcType = sySLit;\n        };\n        result.cstClass = newDictEntry-&gt;dcType;\n        return result;\n\u2026\n</code></pre>\n\n<p>When this code is tested with wrong input, it detects overflow only if the first hex digit is >= 8 (potentially giving negative value), as remonstrated by:</p>\n\n<pre><code>    29            | declare v;\n    30            | v = x'fedcba9876543210'\n** FindConstantFromString - meeting x'fedcba9876543210' as 11\n** FindConstantFromString - converting x'fedcba9876543210'\n     value ffffffff errno 34\n*Error 32: Candidate number x'fedcba9876543210' too large or could not be converted\n*Error 20: Unrecognisable lexical unit x'fedcba9876543210' at 30.5\n    31            |     + x'123456789abcdef'\n** FindConstantFromString - meeting x'123456789abcdef' as 11\n** FindConstantFromString - converting x'123456789abcdef'\n     value 89abcdef errno 0\n    32            |     + 9876543210\n** FindConstantFromString - meeting x'fedcba9876543210' as 8\n                            symbol already known\n** FindConstantFromString - converting x'fedcba9876543210'\n     value 0 errno 0\n*Error 32: Candidate number x'fedcba9876543210' too large or could not be converted\n** FindConstantFromString - meeting 9876543210 as 8\n** FindConstantFromString - converting 9876543210\n     value 4cb016ea errno 0\n    33            |     + '12345a'\n** FindConstantFromString - meeting 12345a as 3\n    34            |     + '';\n** FindConstantFromString - meeting 12345a as 8\n                            symbol already known\n** FindConstantFromString - converting 12345a\n     value 3039 errno 0\n*Error 32: Candidate number 12345a too large or could not be converted\n** FindConstantFromString - meeting  as 3\n** FindConstantFromString - meeting  as 8\n                            symbol already known\n*Error 33: Empty string cannot be converted to number\n</code></pre>\n\n<p>At line 30, the lexical scanner recognized a hex number and requested conversion from this hex form (11 = lxHex). <code>strtol()</code> correctly sets <code>errno</code> to <code>ERANGE</code> and error message is issued. Overflowed hex number is then kept in the dictionary as a string.</p>\n\n<p><em>Note that the returned value is -1, not <code>LONG_MAX</code>.</em></p>\n\n<p>At line 31, we again have another overflowing hex number, but it does not start with 8-9a-f. It is again detected as an hex number. Conversion is attempted but errno is not set at all. The value correspond to the lower 32 bits of the number. Since this considered success, the truncated value is kept as the result.</p>\n\n<p>When <code>+</code> is applied to \"x'fed\u2026'\" and 89abcdef, another conversion is attempted on the <strong>string</strong> \"x'fed\u2026'\" supposed to be a decimal number (denoted by the 8-request) and conversion fails because \"x\" cannot begin a decimal number.</p>\n\n<p>At line 32, we have an overflowing decimal 987654321. Once again, overflow is not detected (code not shown but similar to the one for hex numbers with the addition of a test on \"endptr\" since the strings may not be filtered by the lexical scanner and contain illegal characters). The returned value contains the least 32 bits of the number.</p>\n\n<p>If I change <code>strtol()</code> to <code>strtoul()</code>, the first <code>ERANGE</code> error disappears and I get the least 32 bits of the number.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>System: Fedora Linux 29\nglibc: 2.27</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1561473116, "post_id": 56755269, "comment_id": 100070506, "body": "If the compiler could determine whether a program <b>never</b> used a class without initializing it, then somebody could write a program Z that first used the same software as the compiler to determine whether Z never used a class without initializing it and second used the class without initializing it if and only if the determination indicated Z never used the class without initializing it. This would be a contradiction, and therefore such software cannot exist."}], "answers": [{"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 3, "last_activity_date": 1561470895, "last_edit_date": 1561470895, "creation_date": 1561470121, "answer_id": 56755479, "question_id": 56755269, "link": "https://stackoverflow.com/questions/56755269/c-drop-compiler-error-if-init-function-wasnt-called/56755479#56755479", "title": "C Drop compiler error if init function wasn&#39;t called", "body": "<p>In the general case it's not doable at compile time, since there is no way to convey such requirements, and even if there were, it might not be possible for the compiler to prove in every case that all code paths leading to <code>get_something</code> have first called <code>init</code>.</p>\n\n<p>In some special cases you might be able to get a compile-time warning through some questionable hacks, e.g., have your <code>something.h</code> contain <code>static void init(void) { real_init(); }</code> \u2013 then some compilers with enough warnings enabled will warn of an unused <code>static</code> function <code>init</code> unless you call it (from anywhere \u2013 there might still be code paths that don't call it).</p>\n\n<p>At runtime, you could keep track of whether <code>init</code> has been called and <code>assert</code> that it has been called in everything that depends on it. (The <code>assert</code> macro can then be compiled to nothingness in production code, see documentation.)</p>\n"}, {"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1561470709, "post_id": 56755612, "comment_id": 100068961, "body": "Not sure how this would work in practice if <code>init</code> and <code>get_something</code> are in a different compilation unit than <code>main</code>. Also, putting the <code>static_assert</code> in their code would be the responsibility of the user of the <code>something</code> library, so they might as well be instructed to put <code>init()</code> instead\u2026 =)"}, {"owner": {"reputation": 5, "user_id": 11697899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DZZNiXDcvNg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcq649KoWjhOx9Jeymt21NkTERAOA/photo.jpg?sz=128", "display_name": "RandomCounter", "link": "https://stackoverflow.com/users/11697899/randomcounter"}, "edited": false, "score": 0, "creation_date": 1561472740, "post_id": 56755612, "comment_id": 100070271, "body": "As I see it&#39;s a bad idea in practice. Maybe it&#39;s better if I make sure if the <code>init()</code> will run. Do you think that&#39;s a good methodology if I use <code>__attribute__((constructor))</code> for <code>init()</code>?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1561473042, "post_id": 56755612, "comment_id": 100070459, "body": "@Arkku, RandomCounter, of course it is a very bad idea, I will not check those kind of things at compile time (neither with the <code>constructor</code> attribute)"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 5, "user_id": 11697899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DZZNiXDcvNg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcq649KoWjhOx9Jeymt21NkTERAOA/photo.jpg?sz=128", "display_name": "RandomCounter", "link": "https://stackoverflow.com/users/11697899/randomcounter"}, "edited": false, "score": 0, "creation_date": 1561473362, "post_id": 56755612, "comment_id": 100070653, "body": "@RandomCounter The <code>constructor</code> attribute is a non-standard compiler extension, and AFAIK it also makes the constructor be called automatically when the library is loaded (don&#39;t trust me on this, though, I have never used it). Forcing the <code>init</code> to be called may indeed be a valid strategy, but then it&#39;s a different question\u2026 (A standard approach could be to return the rest of the functions as pointers inside a <code>struct</code> that you can only populate with <code>init</code>, but of course the function pointers change the syntax and may carry a performance penalty, etc.)"}, {"owner": {"reputation": 5, "user_id": 11697899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DZZNiXDcvNg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcq649KoWjhOx9Jeymt21NkTERAOA/photo.jpg?sz=128", "display_name": "RandomCounter", "link": "https://stackoverflow.com/users/11697899/randomcounter"}, "edited": false, "score": 0, "creation_date": 1561473403, "post_id": 56755612, "comment_id": 100070676, "body": "Then I will make a standard runtime error check like: <code>get_something() {if (init_private_variable == 0) return -1; else ...}</code> Thank you for the help"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 5, "user_id": 11697899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DZZNiXDcvNg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcq649KoWjhOx9Jeymt21NkTERAOA/photo.jpg?sz=128", "display_name": "RandomCounter", "link": "https://stackoverflow.com/users/11697899/randomcounter"}, "edited": false, "score": 0, "creation_date": 1561473577, "post_id": 56755612, "comment_id": 100070767, "body": "@RandomCounter If you are putting that check in there for good, perhaps you could actually call <code>init</code> if it hasn&#39;t been called. If you don&#39;t want that to be guaranteed (i.e., you want to catch the errors and force them to be fixed), then I would suggest <code>assert(init_private_variable != 0)</code> instead."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1561474004, "post_id": 56755612, "comment_id": 100070992, "body": "@Arkku yes, that&#39;s a good advice, force the call to <code>init()</code> if some flag is not set can do the trick"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1561470570, "creation_date": 1561470570, "answer_id": 56755612, "question_id": 56755269, "link": "https://stackoverflow.com/questions/56755269/c-drop-compiler-error-if-init-function-wasnt-called/56755612#56755612", "title": "C Drop compiler error if init function wasn&#39;t called", "body": "<p>AFAIK there is no way to do that, a very very ugly trick if you can use static asserts (C11) and the <code>__COUNTER__</code> predefined macro is check if <code>init()</code> is called at some point in the program, something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n\n#define init() do {__COUNTER__; init();} while(0);\n\nvoid (init)(void) // parenthesis prevents the expansion and allows you \n                  // to call a macro with the same name\n{\n    /* ... */\n}\n\nint get_something(void)\n{\n    /* ... */\n    return 0;\n}\n\nint main(void)\n{\n    static_assert(__COUNTER__ == 1, \"init() is never used\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11697899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DZZNiXDcvNg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcq649KoWjhOx9Jeymt21NkTERAOA/photo.jpg?sz=128", "display_name": "RandomCounter", "link": "https://stackoverflow.com/users/11697899/randomcounter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 56755479, "answer_count": 2, "score": 0, "last_activity_date": 1561470895, "creation_date": 1561469475, "last_edit_date": 1561470299, "question_id": 56755269, "link": "https://stackoverflow.com/questions/56755269/c-drop-compiler-error-if-init-function-wasnt-called", "title": "C Drop compiler error if init function wasn&#39;t called", "body": "<p>I would like to make something like a class in C and to notify the developer if the \"class\" wasn't initialized before using it's functions. It's easy to do while the code is running but it would be better during compile time.</p>\n\n<p>If I call the get_something() before init() I would like to drop an error during compile. Is it possible? </p>\n\n<pre><code>//something.c\nvoid init() {...}\n\nint get_something() {...}\n\n//main.c\nint main()\n{\n#include something.h\n\nget_something(); //pls drop compile error because wasn't initialized\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["linux", "c"], "comments": [{"owner": {"reputation": 12533, "user_id": 931027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lWhaB.jpg?s=128&g=1", "display_name": "Kusalananda", "link": "https://stackoverflow.com/users/931027/kusalananda"}, "edited": false, "score": 7, "creation_date": 1561469191, "post_id": 56772427, "comment_id": 100100233, "body": "Use <code>fork()</code> and then <code>exec()</code> in the child process. See e.g. &quot;<a href=\"//unix.stackexchange.com/q/179604\">How do fork and exec work?</a>&quot; as well as <a href=\"https://duckduckgo.com/?q=site%3Aunix.stackexchange.com+fork+exec&amp;atb=v142-1&amp;ia=web\" rel=\"nofollow noreferrer\">a few other questions here</a>"}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 1, "creation_date": 1561469952, "post_id": 56772427, "comment_id": 100100234, "body": "You do it as in shell. Add a <code>&amp;</code> at the end of the command: <code>system(&quot;&#47;system&#47;bin&#47;executable &amp;&quot;);</code>. Of course, you won&#39;t able to retrieve the status of your executable in that case."}, {"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "reply_to_user": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 2, "creation_date": 1561472339, "post_id": 56772427, "comment_id": 100100235, "body": "@mosvy with <code>fork</code> and <code>exec</code> you can retrieve the status with <code>wait</code>."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "reply_to_user": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 1, "creation_date": 1561472555, "post_id": 56772427, "comment_id": 100100236, "body": "@ctrl-alt-delor and if you don&#39;t wait, you create zombies. Seriously, <code>system(3)</code> is already doing a fork + exec + wait, it just takes most of the complications off the user&#39;s back."}, {"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "reply_to_user": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 2, "creation_date": 1561472991, "post_id": 56772427, "comment_id": 100100237, "body": "@mosvy I agree, if what you want to do is within what it dose (running in background and collecting status is not). I have not done C for a while, but I assume there are other libraries that abstract <code>fork</code> and <code>exec</code>, but are more powerful that <code>system</code>."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 2, "creation_date": 1561473153, "post_id": 56772427, "comment_id": 100100238, "body": "Yeah, <code>popen(3)</code>. <code>FILE *p = popen(&quot;command &gt;&#47;dev&#47;null&quot;, &quot;r&quot;); ... do other stuff ...; exit_status = pclose(p);</code> ;-)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561551445, "post_id": 56772427, "comment_id": 100100646, "body": "Likely a duplicate of <a href=\"https://stackoverflow.com/questions/1002513/non-blocking-version-of-system\" title=\"non blocking version of system\">stackoverflow.com/questions/1002513/&hellip;</a>  I&#39;m not voting to close as a dupe just yet, as that would close it immediately."}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 3918591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68dc1ca3c957987a52b8e0bada4e922f?s=128&d=identicon&r=PG&f=1", "display_name": "Archemar", "link": "https://stackoverflow.com/users/3918591/archemar"}, "edited": false, "score": 0, "creation_date": 1561553815, "post_id": 56772428, "comment_id": 100102196, "body": "you should collect <code>fork()</code>ed pid, in case you intend to wait for it latter on."}, {"owner": {"reputation": 124, "user_id": 10678532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ee3c2d0fd240f25196fdcdf469c08f?s=128&d=identicon&r=PG&f=1", "display_name": "pizdelect", "link": "https://stackoverflow.com/users/10678532/pizdelect"}, "edited": false, "score": 0, "creation_date": 1561608411, "post_id": 56772428, "comment_id": 100121855, "body": "consider what happens after the execve() failed and you printed that error message. You&#39;ll also have to install an <code>SIGCHLD</code> handler and wait for the child, in order to not turn it into a zombie."}, {"owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "reply_to_user": {"reputation": 491, "user_id": 3918591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68dc1ca3c957987a52b8e0bada4e922f?s=128&d=identicon&r=PG&f=1", "display_name": "Archemar", "link": "https://stackoverflow.com/users/3918591/archemar"}, "edited": false, "score": 0, "creation_date": 1561612868, "post_id": 56772428, "comment_id": 100122916, "body": "@Archemar my <code>executable</code> is an independent program and wait is not required by the parent process."}, {"owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "reply_to_user": {"reputation": 491, "user_id": 3918591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68dc1ca3c957987a52b8e0bada4e922f?s=128&d=identicon&r=PG&f=1", "display_name": "Archemar", "link": "https://stackoverflow.com/users/3918591/archemar"}, "edited": false, "score": 0, "creation_date": 1561612971, "post_id": 56772428, "comment_id": 100122950, "body": "@Archemar I think appending the <code>&amp;</code> suffix is fine in my case. As it will handle the zombie process for me. Thanks to @Simon for its explanation."}], "tags": [], "owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "is_accepted": false, "score": 1, "last_activity_date": 1561540876, "creation_date": 1561540876, "answer_id": 56772428, "question_id": 56772427, "link": "https://stackoverflow.com/questions/56772427/how-to-make-system-function-unblocking/56772428#56772428", "title": "How to make system() function unblocking?", "body": "<p>I am able to achieve non-blocking with following code:</p>\n\n<pre><code>if (fork() == 0)\n        {\n            char *args[] = {..., NULL};\n            char *env[] = {..., NULL};\n            if (execve(\"/system/bin/executable\", args, env) == -1)\n                print(\"Error: [%d]\", errno);\n        }\n</code></pre>\n\n<p>There are few importants thing here:</p>\n\n<ul>\n<li><code>fork()</code> will create a new process. So from line <code>if(fork() == 0)</code>, there will be 2 process running in the same space of main program.</li>\n<li>Both processes continue executing from the point where the fork( ) calls returns execution to the main program..</li>\n<li><code>fork() == 0</code> will let only child process in the if condition.</li>\n<li><code>execve(..)</code> will replace child process program(which is its parent program from which it copied by fork command) with <code>/system/bin/executable</code>. </li>\n<li><code>execve(..)</code> will not return if it get success in runing the executable else return -1.</li>\n<li>In case of <code>execve(..)</code> failure the <code>errno</code> will be filled with the actual error.</li>\n</ul>\n\n<p>Please correct me if I am wrong. I hope it will help someone.</p>\n"}, {"comments": [{"owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "edited": false, "score": 0, "creation_date": 1561613053, "post_id": 56772429, "comment_id": 100122974, "body": "Thanks, I will use the <code>&amp;</code> suffix because the parent process doesn&#39;t need to take care of child process."}], "tags": [], "owner": {"reputation": 26010, "user_id": 613064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3e1ee346c5ef622fa76114bdbb26c728?s=128&d=identicon&r=PG", "display_name": "Simon Richter", "link": "https://stackoverflow.com/users/613064/simon-richter"}, "is_accepted": true, "score": 5, "last_activity_date": 1561550095, "creation_date": 1561550095, "answer_id": 56772429, "question_id": 56772427, "link": "https://stackoverflow.com/questions/56772427/how-to-make-system-function-unblocking/56772429#56772429", "title": "How to make system() function unblocking?", "body": "<p>The <code>system()</code> function, without error handling, looks like this:</p>\n\n<pre><code>int system(char const *cmdline)\n{\n    pid_t pid = fork();\n    if(pid == 0)\n    {\n        char const *argv[] = { \"sh\", \"-c\", cmdline, NULL };\n        execve(\"/bin/sh\", argv, NULL);\n        _exit(1);\n    }\n    else\n    {\n        int status;\n        waitpid(pid, &amp;status, 0);\n        return status;\n    }\n}\n</code></pre>\n\n<p>The command itself is parsed by the shell, so you can use the normal <code>&amp;</code> suffix to send the command into the background. The shell then terminates immediately, the background program is reparented to PID 1 (so your program isn't responsible for collecting the zombie), and <code>system()</code> returns.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1561550786, "question_id": 526833}, "owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56772429, "answer_count": 2, "score": 1, "last_activity_date": 1561550786, "creation_date": 1561469016, "question_id": 56772427, "link": "https://stackoverflow.com/questions/56772427/how-to-make-system-function-unblocking", "title": "How to make system() function unblocking?", "body": "<p>I am calling an executable from another executable in android Linux. Following is the relevant code:</p>\n\n<pre><code>...\nint status = system(\"/system/bin/executable\");\n...\n</code></pre>\n\n<p>My requirement is not to wait for the <code>executable</code> to complete its execution. Means I want to run <code>executable</code> independent of the executable that calls it.</p>\n\n<p>I have searched over the internet and didn't find how to make this system call non-blocking. Please help me to resolve it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1561468761, "post_id": 56754913, "comment_id": 100067659, "body": "I would say &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or it didn&#39;t happen&quot;."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1561468777, "post_id": 56754913, "comment_id": 100067667, "body": "The elements in a union share space.  Writing to any one of them will, in general, overwrite all of the others.  The two unions are independent of each other and should not affect each other.  Storage is only shared <i>within</i> a union."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "edited": false, "score": 0, "creation_date": 1561468863, "post_id": 56754913, "comment_id": 100067728, "body": "No I was expecting it to behave separately : an f for stillingDia and another f for stillinghei\u2026"}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561468892, "post_id": 56754913, "comment_id": 100067751, "body": "@TomKarzes, the OP has multiple unions in one struct and supposedly writing in one of the unions overwrites another."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561468960, "post_id": 56754913, "comment_id": 100067804, "body": "<i>Within</i> a union, storage is shared.  Between <i>different</i> unions, it is not (unless they are contained in a parent union, which is not your case).  Assigning to dia does <i>not</i> affect hei, and vice versa."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 1, "creation_date": 1561469052, "post_id": 56754913, "comment_id": 100067873, "body": "Yes, @r3musn0x, that&#39;s what the OP <i>says</i>.  And I find that highly doubtful.  I&#39;m with molbdnilo here: show me the MRE that proves it."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 1, "creation_date": 1561469227, "post_id": 56754913, "comment_id": 100068010, "body": "@r3musn0x If that&#39;s really what OP believes, then OP is jumping to an invalid conclusion.  But I don&#39;t see anything in the posted code that would distinguish the two cases, so I don&#39;t see how OP can make that claim."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561469261, "post_id": 56754913, "comment_id": 100068036, "body": "@TomKarzes How should i do to make different union? Because i thought i was the way.  I made that claim from the debug perspective in eclipse showing me all my union in my struct changing at the same line."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 4, "creation_date": 1561469341, "post_id": 56754913, "comment_id": 100068087, "body": "@Arnaud The code you posted works.  You are mistaken in thinking that writing to dia affects hei and vice versa.  You are claiming to see a problem that your posted code doesn&#39;t demonstrate."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561469457, "post_id": 56754913, "comment_id": 100068150, "body": "... and if you maintain otherwise, then again, MRE.  You have updated the code to a complete program, but not one that demonstrates your claim in any observable way."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561469510, "post_id": 56754913, "comment_id": 100068172, "body": "@TomKarzes Is it really ? I really sure all unions change value to 100 at the line SS-&gt;stillingDia.f (the code you see is only a part, there is more union in fact)"}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561469575, "post_id": 56754913, "comment_id": 100068211, "body": "@JohnBollinger Yes i understand that, but i can&#39;t take you a screenshot of my screen to upload it on stack am I wrong ?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1561469580, "post_id": 56754913, "comment_id": 100068216, "body": "Start with the code you posted.  Right before <code>main</code> returns, print <code>f</code> from both unions.  You will see <code>100.0</code> and <code>0.5</code>.  It works.  If there is a bug, it&#39;s in the code that you <i>didn&#39;t</i> post."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561469834, "post_id": 56754913, "comment_id": 100068378, "body": "@TomKarzes Right before ? my variable aren&#39;t declared this soon no ?  I&#39;ve tried <i>printf</i> just after <i>sensorSpecificInit</i>, it prints 100.000 and 100.000"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561469854, "post_id": 56754913, "comment_id": 100068390, "body": "You have two different pieces of code:  (1) the code you didn&#39;t post, which you claim doesn&#39;t work, and (2) the code you posted, which does work."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561469962, "post_id": 56754913, "comment_id": 100068472, "body": "After the call to <code>sensorSpecificInit</code> and before the <code>return</code>.  So yes, <code>SS</code> will be defined at that point.  <code>sensorSpecificInit</code> defines the <code>f</code> field of both unions.  And you should not see <code>100.0</code> twice, you should see <code>100.0</code> and <code>0.5</code>."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1561470026, "post_id": 56754913, "comment_id": 100068514, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/195518/discussion-between-arnaud-and-tom-karzes\">continue this discussion in chat</a>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561470036, "post_id": 56754913, "comment_id": 100068523, "body": "@Arnaud, I took your code and modified it along the lines Tom describes.  I gave SS an initializer in <code>main()</code>, and printed out both <code>f</code> values before the call to <code>sensorSpecificInit()</code>, inside that function between the two assignments, and after the function returns.  The output showed exactly what I expected: writing to one union affected only that union."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1561470270, "post_id": 56754913, "comment_id": 100068656, "body": "@JohnBollinger I really don&#39;t know what to say, it just don&#39;t happen this way on my computer\u2026"}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "edited": false, "score": 0, "creation_date": 1561470370, "post_id": 56754913, "comment_id": 100068721, "body": "I don&#39;t know how to read I wrote to time the same variable in my main, now it works, but clearly there must be a bug in eclipse the variable show the same value\u2026."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1561470488, "post_id": 56754913, "comment_id": 100068817, "body": "I could believe that Eclipse misled you, but I think we&#39;ve just established that indeed, your question is based on a faulty premise.  The program behavior you claimed does not, in fact, occur."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1561470608, "post_id": 56754913, "comment_id": 100068889, "body": "@Arnaud It is not a bug in Eclipse. You&#39;re printing out the same variable both times and calling it something else."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "edited": false, "score": 0, "creation_date": 1561470821, "post_id": 56754913, "comment_id": 100069049, "body": "Look at this link, there is a picture oh what have been mistaken me : <a href=\"https://drive.google.com/open?id=1GDWjVYWexWMlj3A3XSnkdZWklLFpyAcY\" rel=\"nofollow noreferrer\">link</a> The double printf with the same value was a mistake but not the one i was looking for, what let me think all my values changes at the same time was the Eclipse debugging perspective (the right windows on my screen capture showing the variables)"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1561470853, "post_id": 56754913, "comment_id": 100069070, "body": "@Arnaud That&#39;s a bug in Eclipse. Go email them or something, or ask a new question about Eclipse."}, {"owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "edited": false, "score": 0, "creation_date": 1561470967, "post_id": 56754913, "comment_id": 100069136, "body": "Okay, what should I open a ticket or just email ? (Don&#39;t really know what to do)"}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1563390343, "last_edit_date": 1563390343, "creation_date": 1561470038, "answer_id": 56755442, "question_id": 56754913, "link": "https://stackoverflow.com/questions/56754913/c-multiples-different-union-in-a-struct/56755442#56755442", "title": "C Multiples different union in a struct", "body": "<p>You're printing the same variable for each call of <code>printf</code>.</p>\n\n<p>This:</p>\n\n<pre><code>printf(\"hei : %f\\n\",SS.stillingDia.f); // prints 100.000000\n</code></pre>\n\n<p>should be this:</p>\n\n<pre><code>printf(\"hei : %f\\n\",SS.stillingHei.f); // doesn't print 100.000000\n</code></pre>\n\n<p>The fact that Eclipse says otherwise, well... what do you expect?</p>\n"}], "owner": {"reputation": 171, "user_id": 11669560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qEIbbXH3wXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbRdRV5shWAqUL8cr_Cl_9Arm7Zg/mo/photo.jpg?sz=128", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/11669560/arnaud"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "closed_date": 1561470431, "answer_count": 1, "score": -3, "last_activity_date": 1563390343, "creation_date": 1561468308, "last_edit_date": 1561470398, "question_id": 56754913, "link": "https://stackoverflow.com/questions/56754913/c-multiples-different-union-in-a-struct", "closed_reason": "Not suitable for this site", "title": "C Multiples different union in a struct", "body": "<p>I have to access and write variable in different format, hex and float. To solve this problem I used unions allowing me to write the variable like a float or with Hex.</p>\n\n<p>I used this in \"big\" struct because i had this problem multiples times.\nNow running the program line by line i see it is writing in all unions at the same time. (on Eclipse C/C++ ) I definitely don't want that, is there a workaround to keep the unions but force them to be differents variables ?</p>\n\n<p>I tried to invert the union name : stillingDia (before and after { uint32_t...})</p>\n\n<pre><code>// In Header file\ntypedef struct sensorParametersSensorSpecific{\n    union {uint32_t i; float f;}stillingDia ;\n    union {uint32_t i; float f;}stillingHei ;\n}sensorParametersSensorSpecific_t;\n\n//In another source file\nvoid sensorSpecificInit(sensorParametersSensorSpecific_t* SS){\n    SS-&gt;stillingDia.f   =100; // This write in the two union...\n    SS-&gt;stillingHei.f   =0.5;\n}\n\n// in my main code\nint main(){\n    struct sensorParametersSensorSpecific SS;\n    sensorSpecificInit(&amp;SS);\n    printf(\"Dia : %f\\n\",SS.stillingDia.f); // prints 100.000000\n    printf(\"hei : %f\\n\",SS.stillingHei.f); // prints 0.5 (problem solved ?)\nreturn 0;\n}\n</code></pre>\n\n<p>I would like it to write in each union behaving like separate variables\u2026\nMaybe there is a smarter way, I'm open for every hint.</p>\n"}, {"tags": ["c++", "c", "pointers", "memory"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1561467410, "post_id": 56754607, "comment_id": 100066746, "body": "This is undefined behavior."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1561467460, "post_id": 56754607, "comment_id": 100066770, "body": "When you do <code>printf(&quot;%d&quot;, *res);</code>, where is the <code>int</code> that you&#39;re trying to print? On which line was it made?"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1561467470, "post_id": 56754607, "comment_id": 100066779, "body": "Memory being deallocated is not the same as setting a pointer to it to <code>null</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1561472695, "post_id": 56754607, "comment_id": 100070242, "body": "There are several different mechanisms for memory allocation/deallocation.  Furthermore, even when memory is deallocated (that is, when you call <code>free</code> on memory that you&#39;ve dynamically allocated with <code>malloc</code>, or when you return from a function so that its local memory or &quot;stack frame&quot; is deallocated), the key is that <i>the deallocated memory is typically not immediately destroyed or even made unavailable</i>. It&#39;s still there, at the same address, so if you have a pointer to it you can still see it -- but it might change at any time if some other part of your code allocates and starts using it.."}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 11657755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6493dbe2e43e90907f66ce6b8b8a11c?s=128&d=identicon&r=PG&f=1", "display_name": "SirNobbyNobbs", "link": "https://stackoverflow.com/users/11657755/sirnobbynobbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1561467998, "creation_date": 1561467998, "answer_id": 56754823, "question_id": 56754607, "link": "https://stackoverflow.com/questions/56754607/if-after-closing-fun-all-the-memory-gets-deallocated-then-how-is-the-output-pr/56754823#56754823", "title": "If after closing fun() all the memory gets deallocated then how is the output printed", "body": "<p>You are returning a pointer to an address on the stack. A reasonable compiler will give you a warning like this:</p>\n\n<blockquote>\n  <p>\"warning C4172: returning address of local variable or temporary: q\"</p>\n</blockquote>\n\n<p>But basically the behavior is undefined and also depends on your level of optimization.</p>\n"}], "owner": {"reputation": 1, "user_id": 11697719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f692f984a97fa019a5cbf124aed794?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/11697719/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "closed_date": 1561467464, "answer_count": 1, "score": 0, "last_activity_date": 1561467998, "creation_date": 1561467331, "last_edit_date": 1561467359, "question_id": 56754607, "link": "https://stackoverflow.com/questions/56754607/if-after-closing-fun-all-the-memory-gets-deallocated-then-how-is-the-output-pr", "closed_reason": "Duplicate", "title": "If after closing fun() all the memory gets deallocated then how is the output printed", "body": "<p>What is the output of following C program And how is the output printed when all variables of fun() after closing got their memory de-allocated.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint * fun()\n{\n    int q = 10;\n    int *p;\n    p = &amp;q;\n    return p;\n}    \nint main()\n{\n    int *res;\n    res= fun();\n    printf(\"%d\", *res);\n    return 0;\n}\n\n</code></pre>\n\n<p>I expected the pointer res to point to null</p>\n"}, {"tags": ["c", "linux", "embedded", "usb", "embedded-linux"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11697429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d0447beb36792db889eae81c3fc590?s=128&d=identicon&r=PG&f=1", "display_name": "Mowlwurf", "link": "https://stackoverflow.com/users/11697429/mowlwurf"}, "is_accepted": true, "score": 3, "last_activity_date": 1562051762, "creation_date": 1562051762, "answer_id": 56847195, "question_id": 56754470, "link": "https://stackoverflow.com/questions/56754470/linux-usb-gadget-with-functionfs-reading-endpoint-1-not-successful/56847195#56847195", "title": "Linux USB gadget with functionfs: reading endpoint 1 not successful", "body": "<p>I found an answer by myself:</p>\n\n<p>It seems that only endpoint 0 (ep0) supports the poll function.</p>\n\n<p>When you look at the supported operations of ep0 (<a href=\"https://elixir.bootlin.com/linux/v4.2/source/drivers/usb/gadget/function/f_fs.c#L627\" rel=\"nofollow noreferrer\">link</a>) you can find that 'poll' has a handler. In contrast the other endpoints (epX) don't have a similar function (<a href=\"https://elixir.bootlin.com/linux/v4.2/source/drivers/usb/gadget/function/f_fs.c#L1061\" rel=\"nofollow noreferrer\">link</a>).</p>\n\n<p>Therefore poll() for epX set the flag POLLIN and returns immediately (<a href=\"https://elixir.bootlin.com/linux/v4.2/source/fs/select.c#L750\" rel=\"nofollow noreferrer\">link</a>).</p>\n"}], "owner": {"reputation": 31, "user_id": 11697429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d0447beb36792db889eae81c3fc590?s=128&d=identicon&r=PG&f=1", "display_name": "Mowlwurf", "link": "https://stackoverflow.com/users/11697429/mowlwurf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 56847195, "answer_count": 1, "score": 0, "last_activity_date": 1562051762, "creation_date": 1561466924, "question_id": 56754470, "link": "https://stackoverflow.com/questions/56754470/linux-usb-gadget-with-functionfs-reading-endpoint-1-not-successful", "title": "Linux USB gadget with functionfs: reading endpoint 1 not successful", "body": "<p>I want to use a iMX7-SOM as a vendor specific device (gadget) on a Windows10-PC with WINUSB driver. I'm using a Angstrom-based, Yocto-made image with Kernel v4.9.166.</p>\n\n<p>I configured the gadget with libusbgx, mounted the functionfs at /ffs and wrote the decriptors to /ffs/ep0. The device is enumerated as expected and I get the commands on endpoint 0 (like \"BIND\", \"ENABLE\", \"DISABLE\" etc.).</p>\n\n<p>So long so good...</p>\n\n<p>On receiving \"ENABLE\" at endpoint 0 I want to open /ffs/ep1 and use poll() to read incoming data. But poll() is returning immediately and read() never returns (only when I plug out the device). On host side no application is running.</p>\n\n<p>I used select() instead but the result was exactly the same.</p>\n\n<p>When I use ioctl(fd_of_ep_1, FUNCTIONFS_FIFO_STATUS) I get the error message \"Operation not supported\".</p>\n\n<pre><code>int fd = open(\"/ffs/ep1\", O_RDWR);\n\nfd_set read_set;\nFD_ZERO(&amp;read_set);\nFD_SET(fd, &amp;read_set);\n\nint ret = select(fd + 1, &amp;read_set, NULL, NULL, NULL);\nif (ret &lt; 0)\n{\n    perror(\"select\");\n}\nelse if (FD_ISSET(fd, &amp;read_set))\n{\n    int foo = ioctl(fd, FUNCTIONFS_FIFO_STATUS);\n    if (foo &lt; 0)    perror(\"ioctl\");\n    else            fprintf(stdout, \"%i\\n\", foo);\n\n    char buffer[1024];\n    if (read(fd, buffer, sizeof(buffer)) &lt; 0)\n    {\n        perror(\"ep read\");\n    }\n}\n</code></pre>\n\n<p>I expected that the select/poll functions will return when I open my application and the endpoint will be written by the host.</p>\n"}, {"tags": ["c", "stm32", "can-bus"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1561464429, "post_id": 56753545, "comment_id": 100064819, "body": "Decode it into what? Why a fifo and not an array or string? FIFOs seem like a lot of data structure for a holding area where you don&#39;t need any actual FIFO functionality."}, {"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1561464604, "post_id": 56753545, "comment_id": 100064928, "body": "You&#39;re correct, so I would use an Array or string. But how would I combine those 64 bytes PDU messages into one message. Those 8 messages contains a hashed string which is length of 64 bytes, so I need to combine those 8 messages together to reconstruct the hash value"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1561465082, "post_id": 56753545, "comment_id": 100065184, "body": "You know how long you need, and computers are pretty good at math: store each message into the allocated space at the appropriate offset. It&#39;s not really clear to me what the problem is."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561465134, "post_id": 56753545, "comment_id": 100065220, "body": "@andreahmed Can you show the <code>PDU</code> layout? Basically how many signals and length of the each signals."}, {"owner": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "edited": false, "score": 0, "creation_date": 1561471913, "post_id": 56753545, "comment_id": 100069750, "body": "Considering your edit (the description of what you are trying to decode) I think your question is too broad : do you want us to give you some code that can retreive the payload accordingly to your protocol or do you want us to give you some code to rebuild the ASCII chain that you are receiving? In both case, we cannot see what you already tried and it looks like to me (considering your others recent posts this time) that you are trying to get some code without even trying to write some."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561466017, "post_id": 56753992, "comment_id": 100065798, "body": "I added the image of the CAN bus message, please take a look at it"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561466282, "post_id": 56753992, "comment_id": 100065988, "body": "@andreahmed You are good to go with above suggestion unless if you ant interpret <code>VIN</code> as string Also you can ignore <code>1st byte</code> as it is header."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1561467224, "post_id": 56753992, "comment_id": 100066612, "body": "Bad idea because of endianess."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561467589, "post_id": 56753992, "comment_id": 100066882, "body": "@Lundin Endianess can be handled by properly indexing the <code>incomingBytes</code> before to that he should know what endianess he has on his platform."}, {"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561467846, "post_id": 56753992, "comment_id": 100067047, "body": "@Lundin You always come to rescue, do you know a solution with ignoring endianess and agnostic to it"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561468083, "post_id": 56753992, "comment_id": 100067219, "body": "@kiranBiradar The problem is that <code>incomingBytes</code> will have protocol endianess and the CPU will have a different endianess. If you store everything as a raw array of bytes instead, you will have it in the order demanded by the protocol, without the need to serialize/de-serialize. And as a bonus, the code will be portable to cores with another endianess too."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561468219, "post_id": 56753992, "comment_id": 100067307, "body": "@Lundin I agree with you, but only pain is accessing the stored raw bytes. My point is if message comprises of multiple signals varying with size 1bit to 64bits, it is really pain to access individual signals out of raw bytes. If I store it as <code>uint64_t</code> you can mask it according to message layout to extract certain signals as needed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561468659, "post_id": 56753992, "comment_id": 100067585, "body": "@kiranBiradar It wouldn&#39;t be very sensible of the person designing the CAN protocol to place things like that. For example CANopen uses 16 bit analog channels, even though you are most often not likely to use 16 bit resolution - they could have made it 12 bits and that would have covered most applications. However, 16 bits make it easier to write programs decoding/encoding the frames."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561468733, "post_id": 56753992, "comment_id": 100067635, "body": "But endianess on the other hand, is a very common and painful problem when working with CAN specifically. You can have a CPU with little endian, an external CAN controller with big endian, the actual CAN frame with big endian identifiers and big endian CRC, then the payload which could for example be CANopen, which always uses little endian. To deal with such a mess, the only sensible approach is an array of bytes."}, {"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561532017, "post_id": 56753992, "comment_id": 100089680, "body": "@kiranBiradar Thanks for your answers. Actually there is 3 Messages that has one stdid, so how would I combine those three messages of the same stdid ? they have the same header too"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1561466695, "last_edit_date": 1561466695, "creation_date": 1561465409, "answer_id": 56753992, "question_id": 56753545, "link": "https://stackoverflow.com/questions/56753545/decoding-multiple-message-of-can-bus-method/56753992#56753992", "title": "Decoding multiple message of CAN bus method", "body": "<p>Considering the standard CAN message is of size 8bytes length, you can declare message as <code>uin64_t</code> and combine the respective signals into message using <code>|</code>.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>uint64_t message = 0;\nuint8_t incomingBytes[8] = {0};\n\nfor(int i=0; i&lt;8; i++)\n{\n    message = message &lt;&lt;8;\n    message |= incomingBytes[i];\n}\n</code></pre>\n\n<hr>\n\n<p>If you want to interpret <code>VIN</code> data as <code>string</code> then,</p>\n\n<pre><code> char vindata [9];\n memcpy(vindata, incomingBytes, 8);\n vindata[8] = '\\0';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561468209, "post_id": 56754810, "comment_id": 100067300, "body": "Thanks, but it&#39;s only one message id as shown in the excel, why did you separate it in multiple messages ?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561468548, "post_id": 56754810, "comment_id": 100067517, "body": "@andreahmed No one defines <code>CAN</code> network to handle only one message, This is the usual way of decoding the <code>CAN</code> data. i:e decode the data as per message ID(PUD ID)."}, {"owner": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561468839, "post_id": 56754810, "comment_id": 100067712, "body": "@kiranBiradar He could be implementing something like CAN-TP, which allows to transmit a payload of more than 8 bytes using a single ID. Then the proposed solution doesn&#39;t really fit (in the current state)"}, {"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561468870, "post_id": 56754810, "comment_id": 100067734, "body": "@kiranBiradar There is only one message ID, why there are many CANID_FOO,.. CANID_Bar ther e?"}, {"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "reply_to_user": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "edited": false, "score": 0, "creation_date": 1561468899, "post_id": 56754810, "comment_id": 100067763, "body": "@Beno&#238;t That&#39;s really true"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561469091, "post_id": 56754810, "comment_id": 100067909, "body": "@andreahmed I have no idea what your actual protocol looks like, I only answered the question &quot;decoding multiple message of CAN bus&quot;. This is how you&#39;d typically do it when decoding fragmented messages with data scattered over several frames. They don&#39;t necessarily need to have different CAN identifiers, they could have some high-level label to separate them, or different DLC etc etc. It won&#39;t make much of a difference to the algorithm that puzzles everything back together."}, {"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561531975, "post_id": 56754810, "comment_id": 100089650, "body": "@Lundin Hello, Thanks for your answers. Actually there is 3 Messages that has one stdid, so how would I combine those three messages of the same stdid ? they have the same header too"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1561546483, "post_id": 56754810, "comment_id": 100097664, "body": "@andreahmed That would entirely depend on what part of the application layer rotocol that&#39;s used to indicate a difference between message types. I don&#39;t know anything about whatever application layer you are using."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 0, "last_activity_date": 1561467957, "creation_date": 1561467957, "answer_id": 56754810, "question_id": 56753545, "link": "https://stackoverflow.com/questions/56753545/decoding-multiple-message-of-can-bus-method/56754810#56754810", "title": "Decoding multiple message of CAN bus method", "body": "<p>Using the answer to your previous question from <a href=\"https://stackoverflow.com/a/56670337/584518\">here</a>, you can use that bitfield in combination with a plain <code>uint8_t [64]</code>. For example</p>\n\n<pre><code>typedef struct\n{\n  uint8_t data[64];\n  can_received_t received;\n} msg_t;\n</code></pre>\n\n<p>Fill up with data as you receive it, writing it to the corresponding data bytes, then set the bit to indicate that the message has been partially received. The struct isn't regarded as complete until you have received all parts.</p>\n\n<p>A queue/FIFO only fills one purpose, and that is to delay execution of something until later, when there's more time. There's no reason to do that here. Your CAN message decoding could look something like:</p>\n\n<pre><code>msg_t msg;\n\nswitch(received_can_id)\n{\n  ...\n  case CANID_FOO:  \n    memcpy(&amp;msg.data[FOO_INDEX], rec_data, FOO_SIZE);\n    msg.received |= RECEIVED_FOO;\n    break;\n\n  case CANID_BAR:\n    memcpy(&amp;msg.data[BAR_INDEX], rec_data, BAR_SIZE);\n    msg.received |= RECEIVED_BAR;\n    break;\n  ...\n}\n\nif(msg.received == RECEIVED_ALL)\n{\n  use(&amp;msg); // do something\n  memset(&amp;msg, 0, sizeof msg); // reset everything\n}\n</code></pre>\n\n<p>This is fairly quick code, no need to queue anything.</p>\n"}], "owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 1, "accepted_answer_id": 56754810, "answer_count": 2, "score": 1, "last_activity_date": 1561470634, "creation_date": 1561463914, "last_edit_date": 1561466005, "question_id": 56753545, "link": "https://stackoverflow.com/questions/56753545/decoding-multiple-message-of-can-bus-method", "title": "Decoding multiple message of CAN bus method", "body": "<p>I  have a CAN bus message that is composed from 3 parts. \nWhat is the best way to decode it ?</p>\n\n<p>My thinking is to use 3 FIFOs when the first part is decompsed, I store it in the FIFO, and the same for the other 2 parts. </p>\n\n<p>Then I combine those 3 Fifos togethers into one message.</p>\n\n<p>The total message length is 64bytes PDU Lenght</p>\n\n<p>I'm using the following function to get can bus data</p>\n\n<p>HAL_CAN_GetRxMessage</p>\n\n<p><a href=\"https://i.stack.imgur.com/3WH71.png\" rel=\"nofollow noreferrer\">can bus</a></p>\n"}, {"tags": ["c", "linux", "ubuntu", "makefile", "linux-kernel"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1561463811, "post_id": 56753470, "comment_id": 100064466, "body": "Could you post your makefile entirely? And how do you launch the build?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11528353"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1561463914, "post_id": 56753470, "comment_id": 100064517, "body": "I simply run that command from the ubuntu terminal..  And what do you mean how do I launch the build? @Mathieu"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1561464075, "post_id": 56753470, "comment_id": 100064618, "body": "See my answer, the line <code>obj-m:...</code> is a <code>make</code> directive..."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1561465240, "post_id": 56753470, "comment_id": 100065264, "body": "<i>please install libelf-dev, libelf-devel or elfutils-libelf-devel</i>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11528353"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1561466033, "post_id": 56753470, "comment_id": 100065812, "body": "@CacahueteFrito I did, but now it says it can&#39;t find Makefile file .."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11528353"}, "edited": false, "score": 0, "creation_date": 1561464928, "post_id": 56753575, "comment_id": 100065107, "body": "Thank you, I now get another error.. can you look at the edit I&#39;ve made?"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 3, "creation_date": 1561465137, "post_id": 56753575, "comment_id": 100065222, "body": "@Galco Did you read the error message? It\u2019d fairly explicit and descriptive in what you need to do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11528353"}, "edited": false, "score": 0, "creation_date": 1561465903, "post_id": 56753575, "comment_id": 100065710, "body": "Sorry, I&#39;ve downloaded the libelf-dev but now it says that it can&#39;t find the Makefile file.."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1561466226, "post_id": 56753575, "comment_id": 100065940, "body": "@Galco Did you save the above as <code>&#47;home&#47;galco&#47;Makefile</code>?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 2, "creation_date": 1561466238, "post_id": 56753575, "comment_id": 100065948, "body": "@Galco your file must be name <code>Makefile</code> not <code>makefile</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11528353"}, "edited": false, "score": 0, "creation_date": 1561466282, "post_id": 56753575, "comment_id": 100065989, "body": "Thanks , beginner mistakes :)"}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 1, "last_activity_date": 1561464039, "creation_date": 1561464039, "answer_id": 56753575, "question_id": 56753470, "link": "https://stackoverflow.com/questions/56753470/ubuntu-compiling-kernel-module-first-time/56753575#56753575", "title": "Ubuntu compiling kernel module first time", "body": "<p>The line <code>obj-m += hello-1.o</code> must be put in a file named <code>Makefile</code></p>\n\n<p>So it will looks like:</p>\n\n<pre><code>obj-m += hello-1.o\n\nall:\n        make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules\n\nclean:  \n        make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean\n</code></pre>\n\n<p>To launch the build process, just execute <code>make</code> from your command line.</p>\n\n<p>More resource: <a href=\"https://qnaplus.com/how-to-compile-linux-kernel-module/\" rel=\"nofollow noreferrer\">https://qnaplus.com/how-to-compile-linux-kernel-module/</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11528353"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 56753575, "answer_count": 1, "score": 1, "last_activity_date": 1561478252, "creation_date": 1561463629, "last_edit_date": 1561478252, "question_id": 56753470, "link": "https://stackoverflow.com/questions/56753470/ubuntu-compiling-kernel-module-first-time", "title": "Ubuntu compiling kernel module first time", "body": "<p>I'm trying to compile a simple kernel module for the first time:</p>\n\n<pre><code>#include &lt;linux/module.h&gt;    \n#include &lt;linux/kernel.h&gt;\n\nint init_nodule(void)\n{\n        printk(KERN_INFO \"Hello world1.\\n\");\n        return 0;\n}\nvoid cleanup_module(void)\n{\n        printk(KERN_INFO \"Goodbye\\n\");\n}\n</code></pre>\n\n<p>I've used <code>obj-m += hello-1.o</code> (that's the name of the module) but i'm getting an error:</p>\n\n<blockquote>\n  <p>obj\u2212m: command not found</p>\n</blockquote>\n\n<p>Why is this happening? I tried looking online for a solution, but nothing I found helped..</p>\n\n<p><strong>EDIT:</strong> After modifying based on @Mathieu answer , I get the following error :</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>&gt; make -C /lib/modules/4.18.0-15-generic/build M=/home/galco modules\nmake[1]: Entering directory '/usr/src/linux-headers-4.18.0-15-generic'\nMakefile:970: \"Cannot use CONFIG_STACK_VALIDATION=y, please install libelf-dev, libelf-devel or elfutils-libelf-devel\"\nscripts/Makefile.build:45: /home/galco/Makefile: No such file or directory\nmake[2]: *** No rule to make target '/home/galco/Makefile'.  Stop.\nMakefile:1534: recipe for target '_module_/home/galco' failed\nmake[1]: *** [_module_/home/galco] Error 2\nmake[1]: Leaving directory '/usr/src/linux-headers-4.18.0-15-generic'\nmakefile:4: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1561463947, "post_id": 56753405, "comment_id": 100064537, "body": "<code>SOCK_STREAM</code> or <code>SOCK_DGRAM</code>?"}, {"owner": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1561464380, "post_id": 56753405, "comment_id": 100064787, "body": "It is SOCK_STREAM."}, {"owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "edited": false, "score": 0, "creation_date": 1561471268, "post_id": 56753405, "comment_id": 100069345, "body": "Are <code>command_name</code>, <code>object_name</code> and <code>object_len</code> space-separated? Is <code>object_len</code> given as an ASCII number?"}, {"owner": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "edited": false, "score": 0, "creation_date": 1561471756, "post_id": 56753405, "comment_id": 100069645, "body": "yes they are space separated, and object_len is an ASCII number. A realistic example of query of type 1) is :     STORE objectNumberOne 10 \\n helloWorld"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561479849, "post_id": 56753405, "comment_id": 100074151, "body": "OT: regarding statements like: <code>if(buf)free(buf);</code>  The function: <code>free()</code> properly handles a parameter than contains NULL, so no need to check for NULL in your code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561480044, "post_id": 56753405, "comment_id": 100074236, "body": "OT: regarding: <code>buf=realloc(buf,len+1);</code>   the function: <code>realloc()</code> can fail.  When it fails, this code will result in the original pointer to allocated memory being overwritten, This results in an unrecoverable memory leak.   When calling <code>realloc()</code>, always assign the returned value to a &#39;temp&#39; variable, then check (!=NULL) the &#39;temp&#39; variable and if not NULL, then assign to the target variable."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561480262, "post_id": 56753405, "comment_id": 100074358, "body": "regarding; <code>byte_read=read(fd,(void *)tmp,CHUNK);</code>  1) the code fails to check for <code>byte_read</code> being 0.  2) the number of bytes read can be less than <code>CHUNK</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561480418, "post_id": 56753405, "comment_id": 100074425, "body": "regarding: <code>char * readLine(int fd){     char * buf=NULL; &#47;&#47;here i store the content      char * tmp=calloc(CHUNK,sizeof(char));     if(!tmp)         return NULL;     if(!buf)         return NULL;</code>  the <code>if(!buf)</code> will always be &#39;true&#39;, so the function will always perform the <code>return NULL;</code> statement.   Suggest removing the <code>if(!buf) return NULL;</code> code block"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561481277, "post_id": 56753405, "comment_id": 100074838, "body": "in function: <code>readLine()</code> about the seventh statement is; <code>buf[0]=&#39;\\0&#39;;</code>  However, &#39;buf&#39; still contains NULL,, so this will try to write &#39;\\0&#39; to address 0.   This &#39;should&#39; result in a &#39;seg fault event&#39;  AND since &#39;buf&#39; does not point to any memory owned by the application, the result is undefined behavior.   Of course, you might not see that problem because the prior <code>if()</code> code block has already exited the function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561481495, "post_id": 56753405, "comment_id": 100074935, "body": "in function: <code>readLine()</code>, this statement: <code>buf=strncat(buf,tmp,byte_read);</code> will not work as expected because the first byte in <code>buf[]</code>, on the first loop iteration, has not been set to &#39;\\0&#39;."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561481825, "post_id": 56753405, "comment_id": 100075084, "body": "OT: regarding: <code>char * tmp=calloc(CHUNK,sizeof(char));     if(!tmp)         return NULL;</code>   this fails to notify the user that a failure occurred.  Suggest <code>char * tmp=calloc(CHUNK,sizeof(char));     if(!tmp) { perror( &quot;calloc failed&quot; ); return NULL; }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561482035, "post_id": 56753405, "comment_id": 100075209, "body": "OT:  regarding: <code>byte_read=read(fd,(void *)tmp,CHUNK);</code>  there is no need to cast the pointer to <code>tmp</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561482296, "post_id": 56753405, "comment_id": 100075337, "body": "regarding; <code>if(byte_read&gt;0 &amp;&amp; buf[byte_read-1]==&#39;\\n&#39;)</code>   the contents of &#39;buf[]&#39; (after the first iteration, will contain more bytes than &#39;byte_read&#39;.  so a &#39;\\n&#39; will not be seen.  Suggest using: <code>if( byte_read&gt;0 &amp;&amp;  strcspn( buf, &quot;\\n&quot; ) )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561482499, "post_id": 56753405, "comment_id": 100075421, "body": "in function: readLine(), regarding: <code>if(byte_read==0)         &#47;&#47;read error SIGPIPE</code>   this does NOT mean a read error occurred nor that a <code>SIGPIPE</code> signal was sent.  What it does mean is the sender closed the connection"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "edited": false, "score": 0, "creation_date": 1561534573, "post_id": 56757877, "comment_id": 100090944, "body": "Thanks for comment, that&#39;s probably works.  I have just a question : How could i do that without read one byte at time before the first occurence of \\n ?"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "reply_to_user": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "edited": false, "score": 0, "creation_date": 1561535326, "post_id": 56757877, "comment_id": 100091362, "body": "You can peek into socket&#39;s buffer by using SO_PEEK_OFF flag without actually removing the data from the buffer. See <a href=\"http://man7.org/linux/man-pages//man7/socket.7.html\" rel=\"nofollow noreferrer\">socket manual</a> for more details. (Search for SO_PEEK_OFF)"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "reply_to_user": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "edited": false, "score": 0, "creation_date": 1561535636, "post_id": 56757877, "comment_id": 100091501, "body": "Then you could peek into beginning of an internal buffer and e.g. read 512 bytes, check if there is a newline and only after that use <code>read</code> to fetch as many bytes as required (till the \\&#39;n&#39; occurence)."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "reply_to_user": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "edited": false, "score": 0, "creation_date": 1561536004, "post_id": 56757877, "comment_id": 100091694, "body": "If you want to use options for each call then it will be easier to use <code>recv</code> instead of <code>read</code>."}, {"owner": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "edited": false, "score": 0, "creation_date": 1561538358, "post_id": 56757877, "comment_id": 100092898, "body": "the use of this flag with the use of MSG_PEEK in the recv function is what i was searching for."}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": true, "score": 0, "last_activity_date": 1561478051, "creation_date": 1561478051, "answer_id": 56757877, "question_id": 56753405, "link": "https://stackoverflow.com/questions/56753405/manage-comunication-protocol-local-socket-c/56757877#56757877", "title": "Manage comunication protocol local socket c", "body": "<p>I suggest a different approach. First read a line, then determine what kind of message it is and only after that decide whether this is the end or you need to read up more bytes. </p>\n\n<p>So lets start from reading a line:</p>\n\n<pre><code>int socket_readline(int fd, char *buf, size_t *inout_size)\n{   \n    char c = 0;\n    size_t capacity = *inout_size;\n    *inout_size = 0;\n\n    while(c != '\\n') {\n        int rc = read(fd, &amp;c, 1);\n\n        if (rc != 1) return -1;\n\n        buf[*inout_size] = c;\n        *inout_size += 1;\n\n        if (capacity - *inout_size == 0) return -1;\n    }\n\n    buf[*inout_size] = '\\0';\n\n    return 0;\n}\n</code></pre>\n\n<p>This routine returns <code>0</code> on success and <code>-1</code> otherwise. </p>\n\n<p>In a successful case the buffer is <code>NUL</code>-terminated and <code>inout_size</code> will be the length of the string in the buffer (excluding <code>NUL</code>-terminating byte). In case of error you should check <code>inout_size</code> value. in case of an overflow (line too long) it will be equal to the size of the buffer given (input buffer will not be <code>NUL</code>-terminated!), and for the read error it will contain how many bytes were read before an error occured. </p>\n\n<p>Now once we have a read lining routine we can use it to parse incoming lines:</p>\n\n<pre><code>int rc;\nsize_t size;\nchar buf[MAX_INPUT_LENGTH];\n\nint object_len;\nchar command_name[MAX_INPUT_LENGTH], object_name[MAX_INPUT_LENGTH];\n\ndo {\n    size = sizeof(buf);\n    rc = socket_readline(fd, buf, &amp;size);\n    if (rc == 0) {\n        int tokens_matched = sscanf(buf, \"%s %s %d \\n\", command_name, object_name, &amp;object_len);\n\n        switch(tokens_matched) {\n            case 1:\n                printf(\"This is a command: %s\\n\", command_name);\n                break;\n            case 2:\n                printf(\"This is a command: %s with object name: %s\\n\", command_name, object_name);\n                break;\n            case 3:\n                printf(\"This is a command: %s with object name: %s of length %d\\n\", command_name, object_name, object_len);\n                printf(\"TODO read up remaining: %d bytes\\n\", object_len);\n                break;\n            default:\n                printf(\"Error unable to match command format\\n\");\n                break;\n        }\n\n    } else if (size == sizeof(buf)) {\n        printf(\"Overflow! Bytes read: %lu. \\n\", size);\n        // TODO How to handle overflows?\n    } else {\n        printf(\"Read error must have occured. Read %lu bytes.\\n\", size);\n    }\n\n} while (rc == 0 || size == sizeof(buf));\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11515006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73390c3e789666daa06d294cae2b6df?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anicetti", "link": "https://stackoverflow.com/users/11515006/f-anicetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56757877, "answer_count": 1, "score": 0, "last_activity_date": 1561478051, "creation_date": 1561463393, "question_id": 56753405, "link": "https://stackoverflow.com/questions/56753405/manage-comunication-protocol-local-socket-c", "title": "Manage comunication protocol local socket c", "body": "<p>I'm trying to implement my first client-server application with an AF_UNIX socket in C.</p>\n\n<p>I have to respect a specific protocol of communication for the queries sent from client. Three types of queries are available:</p>\n\n<pre><code>1) &lt;command_name&gt; &lt;object_name&gt; &lt;obj_len&gt; \\n &lt;obj_data&gt;\n\n2) &lt;command_name&gt; &lt;object_name&gt; \\n\n\n3) &lt;command_name&gt; \\n\n</code></pre>\n\n<p>Note that each query except the first terminate with a \\n special character, and the length of each message is unknown .</p>\n\n<p>I have no problem to read 2) and 3) because i know the message will ends with a \\n so i just have to check if the last byte read in the buffer is \\n, if not, i will continue to read from socket and append the subsequent calls to buffer.</p>\n\n<p>Instead for the first operation the above method doesn't work, because the \\n character is not at the end of the message but it is in an arbitrary point of the buffer.\nWhat i would do is to read (in that case) until i reach the \\n , then parse the <em>obj_len</em> token from buffer and do the last read of <em>obj_len</em> bytes from socket containing the whole content of <em>obj_data</em>.</p>\n\n<p>Here's the code of my readLine function that works just with 1) and 2) types of messages :</p>\n\n<pre><code>char * readLine(int fd){\n    char * buf=NULL; //here i store the content \n    char * tmp=calloc(CHUNK,sizeof(char));\n    if(!tmp)\n        return NULL;\n    if(!buf)\n        return NULL;\n    buf[0]='\\0';\n    size_t byte_read=-1; \n    int len=0;\n    do{ \n        bzero(tmp,CHUNK); //reset tmp for read\n        byte_read=read(fd,(void *)tmp,CHUNK);\n        if(byte_read==-1){\n            perror(\"read\");\n            if(tmp)free(tmp);\n            if(buf)free(buf);\n            return NULL;\n        }\n        len=len+byte_read; //update the len of message\n        buf=realloc(buf,len+1);\n        if(!buf){\n            perror(\"realloc\");\n            if(tmp)free(tmp);\n            return NULL;\n        }\n        buf=strncat(buf,tmp,byte_read);//append each call of read\n        if(byte_read&gt;0 &amp;&amp; buf[byte_read-1]=='\\n')\n        //the last byte read is  the special character\n            break;\n    }   \n    while(byte_read!=0);\n    if(byte_read==0)\n        //read error SIGPIPE\n    if(tmp)free(tmp);\n    return buf;\n    }\n</code></pre>\n\n<p>What should i do in your opinion for implement the function that read messages formatted like 2),3) and 1) from socket ?</p>\n"}, {"tags": ["c", "opengl", "raspberry-pi3", "freeglut", "opengl-compat"], "comments": [{"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1561469238, "post_id": 56753201, "comment_id": 100068018, "body": "you are not setting any texture coords for texture unit 1"}, {"owner": {"reputation": 33, "user_id": 10793084, "user_type": "registered", "profile_image": "https://graph.facebook.com/2231770910369105/picture?type=large", "display_name": "Yannik Nelson", "link": "https://stackoverflow.com/users/10793084/yannik-nelson"}, "reply_to_user": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1561471739, "post_id": 56753201, "comment_id": 100069635, "body": "I feel both stupid, and like I couldn&#39;t have known based on all of the documentation, thank you very much you fixed it"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10793084, "user_type": "registered", "profile_image": "https://graph.facebook.com/2231770910369105/picture?type=large", "display_name": "Yannik Nelson", "link": "https://stackoverflow.com/users/10793084/yannik-nelson"}, "is_accepted": false, "score": 0, "last_activity_date": 1563546565, "creation_date": 1563546565, "answer_id": 57114573, "question_id": 56753201, "link": "https://stackoverflow.com/questions/56753201/how-to-use-texture-units-they-dont-appear-to-be-working/57114573#57114573", "title": "How to use Texture Units (they don&#39;t appear to be working)", "body": "<p>The issue was that i didn't have texture co-ords for texture unit 1, as pointed out by derhass.</p>\n"}], "owner": {"reputation": 33, "user_id": 10793084, "user_type": "registered", "profile_image": "https://graph.facebook.com/2231770910369105/picture?type=large", "display_name": "Yannik Nelson", "link": "https://stackoverflow.com/users/10793084/yannik-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563546565, "creation_date": 1561462647, "last_edit_date": 1561469164, "question_id": 56753201, "link": "https://stackoverflow.com/questions/56753201/how-to-use-texture-units-they-dont-appear-to-be-working", "title": "How to use Texture Units (they don&#39;t appear to be working)", "body": "<p>I'm trying to combine two textures using the colour of one and the alpha of another, to do this I'm using the glTexEnvf() to combine the two aspects of the textures after storing them in different texture units. But it's not working and I believe it to be caused by GL_TEXTURE1 not working as expected, </p>\n\n<p>I know as a fact that the issue doesn't lie in the textures themselves as I've tested that to death and they display fine normally.\nThis currently displays the non-alpha part of GL_TEXTURE0 as black as there appears to be no colour data being pulled from GL_TEXTURE1 (I have also tried GL_TEXTURE0+1 and the ARB version of all of this though the ARB refused to display anything)</p>\n\n<p>I also know for certain that they're the exact same size, in case that might have been the issue.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void mask(){\nglActiveTexture(GL_TEXTURE0);\n  glEnable(GL_TEXTURE_2D);\n  glBindTexture(GL_TEXTURE_2D, images[0].textures[images[0].active_frame]);\n\n  glActiveTexture(GL_TEXTURE1);\n  glEnable(GL_TEXTURE_2D);\n  glBindTexture(GL_TEXTURE_2D, images[1].textures[images[1].active_frame]);\n\n  printf(\"%d\\n\", images[0].active_frame);\n  glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_COMBINE);\n  glTexEnvf(GL_TEXTURE_ENV, GL_SOURCE0_RGB, GL_TEXTURE1);\n  glTexEnvf(GL_TEXTURE_ENV, GL_COMBINE_RGB, GL_REPLACE);\n\n  glTexEnvf(GL_TEXTURE_ENV, GL_SOURCE0_ALPHA, GL_TEXTURE0);\n  glTexEnvf(GL_TEXTURE_ENV, GL_OPERAND0_ALPHA, GL_SRC_ALPHA);\n  glTexEnvf(GL_TEXTURE_ENV, GL_COMBINE_ALPHA, GL_REPLACE);\n  glBegin(GL_QUADS);\n  glTexCoord2f(1.0,1.0);\n  glVertex2f((images[0].center.x)+(images[0].width),(images[0].center.y)+(images[0].height));\n  glTexCoord2f(1.0,0.0);\n  glVertex2f((images[0].center.x)+(images[0].width),(images[0].center.y)-(images[0].height));\n  glTexCoord2f(0.0,0.0);\n  glVertex2f((images[0].center.x)-(images[0].width),(images[0].center.y)-(images[0].height));\n  glTexCoord2f(0.0,1.0);\n  glVertex2f((images[0].center.x)-(images[0].width),(images[0].center.y)+(images[0].height));\n  glEnd();\n}\n</code></pre>\n\n<p>Here is my initialisation code (with unrelated things such as the devIL initalisation for getting the images for the textures, removed):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>  glutInit(&amp;argc, argv); \n  //finish initialising openGL\n  glutInitDisplayMode(GLUT_RGBA);\n  //create the window (game mode makes it full screen, there is a fullscreen function\n  // but for some reason this was not working)\n  glutEnterGameMode();\n  //set the background colour\n  glClearColor(55/360.0f, 171/360.0f, 200/306.0f, 0.0f);\n  //enable textures and transparency for the QUADS\n  glEnable(GL_TEXTURE_2D);\n  glEnable(GL_ALPHA_TEST);\n  glAlphaFunc(GL_GREATER, 0.0f);\n  glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n</code></pre>\n\n<p>For context I have a struct that stores info about the textures as I have animations (i simply run through textures):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct image {\n  int num_of_frames;\n  int active_frame;\n  int anim_called;\n  int* textures;\n  cntr center;\n  //the width and height are scaled for the screen\n  float width;\n  float height;\n\n} image;\n</code></pre>\n\n<p>it should display GL_TEXTURE1 only where GL_TEXTURE0 doesn't have alpha. At the moment it displays black where GL_TEXTURE0 doesn't have alpha</p>\n\n<p>I have just discovered that other textures (on GL_TEXTURE0) now also have no colour, (GL_TEXTURE1 still simply doesn't display at all) here is the code i use to normally display images:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void drawimage(image* img){\n  //set the blending mode to allow the transparency of the image to effect the QUAD\n  glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);\n  //Binds the current frame of the current image (must be done before glBegin)\n  glBindTexture( GL_TEXTURE_2D, img-&gt;textures[img-&gt;active_frame] );\n  //draws the textured QUAD\n  glBegin(GL_QUADS);\n  glColor4f(1.0f, 1.0f, 10.f, 1.0f);\n  glTexCoord2f(1.0,1.0);\n  glVertex2f((img-&gt;center.x)+(img-&gt;width),(img-&gt;center.y)+(img-&gt;height));\n  glTexCoord2f(1.0,0.0);\n  glVertex2f((img-&gt;center.x)+(img-&gt;width),(img-&gt;center.y)-(img-&gt;height));\n  glTexCoord2f(0.0,0.0);\n  glVertex2f((img-&gt;center.x)-(img-&gt;width),(img-&gt;center.y)-(img-&gt;height));\n  glTexCoord2f(0.0,1.0);\n  glVertex2f((img-&gt;center.x)-(img-&gt;width),(img-&gt;center.y)+(img-&gt;height));\n  glEnd();\n}\n</code></pre>\n\n<p>I have a feeling to fix this I will need to 'reset' the glTexEnvf, but I don't know how.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 3, "creation_date": 1561462512, "post_id": 56753146, "comment_id": 100063775, "body": "What&#39;s <code>x</code>? Please post the whole code."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 13, "creation_date": 1561462785, "post_id": 56753146, "comment_id": 100063920, "body": "<code>&quot;%d&quot;</code> is used to print an <code>int</code>, <code>p</code> is not an <code>int</code> but a pointer to <code>int</code>  thus you are using a wrong format specifier, if you want to show the value of where the pointer points to, you need to dereference: <code>printf(&quot;%d&quot;, *p);</code>, if you want to show the value of the pointer itself you need to switch to a proper format specifier: <code>printf(&quot;%p&quot;, (void *)p);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 2, "last_activity_date": 1561524722, "last_edit_date": 1561524722, "creation_date": 1561464925, "answer_id": 56753836, "question_id": 56753146, "link": "https://stackoverflow.com/questions/56753146/pointer-de-referencing-balagurusamy/56753836#56753836", "title": "pointer de-referencing balagurusamy", "body": "<p>Fixing a few things in code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int *p, m = 100, x = 10;\n    p = &amp;x; // In words, making 'p' to point to the address of 'x'\n    printf(\"Address %p contains a value %d..\", (void *)p,   *p);\n    //              ^^                         ^^^^^^^^^    ^\n    //              Using the correct          Typecasting  Dereferencing\n    //              format specifier           the pointer  the pointer\n    //              \n    // Some code\n    return 0;\n}\n</code></pre>\n\n<p>Generated output:</p>\n\n<pre><code>Address 0x7ffdf396c128 contains a value 10..\n</code></pre>\n\n<p>You are ought to get different result if you try the same code as the addresses are very unlikely to be same.</p>\n\n<p>Explanation:</p>\n\n<ul>\n<li><code>x</code> was undefined in the snippet you provided</li>\n<li>When a pointer is used to point to a compatible data type, you can print the value by dereferencing the pointer.</li>\n<li>If you want to print the value of the pointer itself, you need to first cast it to <code>void</code> and then use a <code>%p</code> format specifier rather than using <code>%d</code>.</li>\n<li><a href=\"https://codeforwin.org/2015/05/list-of-all-format-specifiers-in-c-programming.html\" rel=\"nofollow noreferrer\">List of common format specifier in C programming</a></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8476023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uUDrUdVjNME/AAAAAAAAAAI/AAAAAAAAAKY/BdX--8cgvcA/photo.jpg?sz=128", "display_name": "Pankaj Dhamane", "link": "https://stackoverflow.com/users/8476023/pankaj-dhamane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561524722, "creation_date": 1561462459, "question_id": 56753146, "link": "https://stackoverflow.com/questions/56753146/pointer-de-referencing-balagurusamy", "title": "pointer de-referencing balagurusamy", "body": "<p>What is the trouble with pointer dereferencing when , not dereferencing a pointer when required. Code given below.\nwhat is the error here, not able to understand.\nGiven in balagurusamy book of ansi c.</p>\n\n<pre><code>int *p,m=100 ;\np = &amp;x ;\nprintf(\"%d\",p) ;/*error*/\n</code></pre>\n"}, {"tags": ["c++", "c", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561459785, "post_id": 56752290, "comment_id": 100062196, "body": "<code>Uint8 a= alpha*255;</code> won&#39;t it overflow <code>Uint8</code> with <code>alpha&gt;1</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8821501"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1561460093, "post_id": 56752290, "comment_id": 100062394, "body": "<code>0&lt;=alpha&lt;=1</code> but the values are correct in <code>a</code> ,I have checked them ,we have varied values of <code>a</code> but i can&#39;t show them, the problem i think is between <code>surface and texture</code>"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1561466351, "post_id": 56752290, "comment_id": 100066042, "body": "How do you create your <code>tempSurface</code>, texture, and how do you draw? Patching alpha doesn&#39;t look right at all, but to know correct way one have to see your pixel format. It is also unclear how it could be correct without alpha if you fill surface with constant colour - wouldn&#39;t it be just a solid rectangle?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8821501"}, "is_accepted": true, "score": 0, "last_activity_date": 1561469695, "creation_date": 1561469695, "answer_id": 56755341, "question_id": 56752290, "link": "https://stackoverflow.com/questions/56752290/drawing-with-varies-alpha-values-in-sdl/56755341#56755341", "title": "drawing with varies alpha values in sdl", "body": "<p>now i have found the problem </p>\n\n<p>just i have forgot to shift the alpha value to it's right place</p>\n\n<pre><code>pixel&amp;=~amask;\npixel |= a &lt;&lt; ashift;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8821501"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 56755341, "answer_count": 1, "score": 0, "last_activity_date": 1561469695, "creation_date": 1561459570, "question_id": 56752290, "link": "https://stackoverflow.com/questions/56752290/drawing-with-varies-alpha-values-in-sdl", "title": "drawing with varies alpha values in sdl", "body": "<p>I'm trying to draw Xiaolin Wu's line algorithm in SDL2, due to alpha channel problem i get nothing , i am drawing it in surface ,then creating texture from surface</p>\n\n<p>i have tried \n<code>int SDL_SetTextureBlendMode(SDL_Texture*  texture, SDL_BlendMode blendMode)</code>\n with all possible blending modes</p>\n\n<p>getting color:(there's no error here i think)</p>\n\n<pre><code>void LINE_PlotPoint(SDL_Surface * surface,int x,int y, double alpha)\n{\n    Uint32 *pixels = (Uint32 *)surface-&gt;pixels;\n    Uint32 pixel=SYS_GetForegroundColor();\n\n    Uint8 a= alpha*255;\n\n    pixel&amp;=~amask;\n    pixel |= a;\n\n    pixels[ ( y * surface-&gt;w ) + x ] =pixel;\n}\n</code></pre>\n\n<p>the main loop for this task is:</p>\n\n<pre><code>if(event.type==SDL_MOUSEMOTION)\n{\n    SDL_GetMouseState(&amp;i,&amp;j);\n    i-=grect.x;\n    j-=grect.y;\n    TOOL_DrawLine(tempSurface,x,y,i,j,1);//Xiaolin Wu's line algorithm\n\n    if(tempTexture)\n    {\n        SDL_DestroyTexture(tempTexture);\n    }\n\n    tempTexture=TOOL_CreateLineTexture(tempSurface,&amp;srect,&amp;drect);//create texture from surface and calculating rect(src &amp; dest)\n    if(tempTexture==NULL)\n    {\n        puts(\"error\");\n    }\n    SDL_SetTextureBlendMode(tempTexture,SDL_BLENDMODE_BLEND);\n\n\n    SDL_FillRect(tempSurface,NULL,NULL);//delete pixel from surface (no need for it)\n\n    }\n</code></pre>\n\n<p>i have tried it before with alpha channel =255 and it's work normally,but with varies alpha values no thing apear</p>\n"}, {"tags": ["c", "arrays", "hexdump", "unsigned-char"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1561458528, "post_id": 56751696, "comment_id": 100061483, "body": "oh this is c... that explains something ;) I overlooked the c tag. Please dont tag unrelated languages. C and C++ have similarities, but they are two different languages"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561458819, "post_id": 56751696, "comment_id": 100061633, "body": "If you aren&#39;t using <code>argv[0]</code> then maybe you can store the result there? Otherwise, you have to change the format of the function."}, {"owner": {"reputation": 183, "user_id": 2803597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9bca2287435824e04670caecc9c3c75c?s=128&d=identicon&r=PG&f=1", "display_name": "TJCLK", "link": "https://stackoverflow.com/users/2803597/tjclk"}, "edited": false, "score": 0, "creation_date": 1561458890, "post_id": 56751696, "comment_id": 100061665, "body": "I try revise the question description clear."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561459016, "post_id": 56751696, "comment_id": 100061753, "body": "@Lundin surely not a great idea, if output is supposed to be 16 characters, and <code>argv[0]</code> might be something like <code>.&#47;a.out</code>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1561459090, "post_id": 56751696, "comment_id": 100061799, "body": "@eerorika You don&#39;t need to use the actual argv from <code>main</code>, you can use your own <code>char*</code> array and malloc/realloc away."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561459237, "post_id": 56751696, "comment_id": 100061883, "body": "@Lundin oh, right. Makes sense."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561459705, "post_id": 56751696, "comment_id": 100062154, "body": "@Lundin that&#39;s actually not so good idea... it changes the <a href=\"https://stackoverflow.com/a/17120029/918959\">program name shown in <code>ps</code></a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1561459907, "post_id": 56751696, "comment_id": 100062291, "body": "well... changing the argument area would change it... doesn&#39;t seem to matter if you change the area where <code>argv[0]</code> points to."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1561458768, "last_edit_date": 1561458768, "creation_date": 1561458462, "answer_id": 56751943, "question_id": 56751696, "link": "https://stackoverflow.com/questions/56751696/return-unsigned-char-array-to-main-function/56751943#56751943", "title": "Return unsigned char array to main function", "body": "<blockquote>\n  <ol>\n  <li>How to present the hex dump value of $(echo \"this_is_input\"|xxd -p)** in the main()?</li>\n  </ol>\n</blockquote>\n\n<p>You can represent it as an array of characters, or for example an array of arrays of characters - tokenised by whitespace. Latter is the representation that the command line arguments are already in <code>argv</code>.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>How to modify run() and main() in order to return unsigned char array to main()?</li>\n  </ol>\n</blockquote>\n\n<p>You must declare the return type of the function. It is not possible to return an array directly in C, and it is undesirable to copy arrays around. A typical solution is to let the caller (main) create the array, and let the called function modify the content of the array:</p>\n\n<pre><code>void run(int argc, char *argv[], unsigned char output[16])\n</code></pre>\n\n<p><code>main</code> has a problem. It attempts to assign an array. Arrays are not assignable. Given that arrays cannot be returned from functions either, this makes little sense.</p>\n\n<p>This is how to call run that I've suggested:</p>\n\n<pre><code>unsigned char output[16] = {0x00};\nrun(argc, argv, output);\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 2803597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9bca2287435824e04670caecc9c3c75c?s=128&d=identicon&r=PG&f=1", "display_name": "TJCLK", "link": "https://stackoverflow.com/users/2803597/tjclk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 56751943, "answer_count": 1, "score": -1, "last_activity_date": 1561459004, "creation_date": 1561457684, "last_edit_date": 1561459004, "question_id": 56751696, "link": "https://stackoverflow.com/questions/56751696/return-unsigned-char-array-to-main-function", "title": "Return unsigned char array to main function", "body": "<p>Background: My original main() is:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    unsigned char output[16] = {0x00};  // copied from code\n\n    // .... (some steps to calculate output[i])\n\n    for (i = 0; i &lt; 16; i++)\n    {\n        printf(\"%02X \", output[i]); // output[i] is an array of 16-byte hex values\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The original program (e.g., calculate.c) is run by command line:</p>\n\n<pre><code>./calculate $(echo \"this_is_input\"|xxd -p)\n</code></pre>\n\n<p>Now I want to modify main() as a call function only, e.g., named run(). And write a new main() to call run() function.</p>\n\n<p>The input (<strong>equivalent to above command line</strong>) is hardcoded in new main(). main() will pass the input value to run() function (instead of using above command line).</p>\n\n<pre><code>run(int argc, char *argv[])\n{\n    ....\n    return output[i];\n}\n</code></pre>\n\n<p>then run() returns the same output[i] to main()</p>\n\n<pre><code>int main()\n{\n    input_char = **equivalent to $(echo \"this_is_input\"|xxd -p)** // how to define?\n\n    unsigned char returned_output[16] = {0x00};\n\n    returned_output = run(X, input_char);\n\n    print(returned_output);\n}\n</code></pre>\n\n<p>Question:</p>\n\n<ol>\n<li><p>How to present the hex dump value of $(echo \"this_is_input\"|xxd -p)** in the main()?</p></li>\n<li><p>How to modify run() and main() in order to return unsigned char array to main()?</p></li>\n</ol>\n"}, {"tags": ["c", "file", "linked-list"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1561454959, "post_id": 56750699, "comment_id": 100059484, "body": "You can not store those addresses because they will point to garbage in the next session, you should find a way to serialize your frames (maybe using indexes?)"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4092110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d03f078ef5db85089bc93b1dc005f1?s=128&d=identicon&r=PG&f=1", "display_name": "Pektraan", "link": "https://stackoverflow.com/users/4092110/pektraan"}, "is_accepted": false, "score": 0, "last_activity_date": 1561461789, "creation_date": 1561461789, "answer_id": 56752957, "question_id": 56750699, "link": "https://stackoverflow.com/questions/56750699/linked-list-in-file-read-write/56752957#56752957", "title": "Linked list in file read\\write", "body": "<p>Saving will require you to write to a file. You can step through your linked list and at each node write to a file something of the form <code>(name,duration,path)</code> and then to open you would just read from the file. See <a href=\"https://www.tutorialspoint.com/cprogramming/c_file_io.htm\" rel=\"nofollow noreferrer\">this tutorial page</a> for info on how to read and write from a file.</p>\n"}, {"tags": [], "owner": {"reputation": 168, "user_id": 11345020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d3d43d49cd02d98fc22e7036e9c977?s=128&d=identicon&r=PG&f=1", "display_name": "ooj-001", "link": "https://stackoverflow.com/users/11345020/ooj-001"}, "is_accepted": false, "score": 0, "last_activity_date": 1561463580, "creation_date": 1561463580, "answer_id": 56753457, "question_id": 56750699, "link": "https://stackoverflow.com/questions/56750699/linked-list-in-file-read-write/56753457#56753457", "title": "Linked list in file read\\write", "body": "<p>You can create a <code>save</code> and a <code>load</code> function:</p>\n\n<pre><code>void save(Frame frame){\n    FILE *file = fopen(\"/path/to/save.txt\", \"w\");\n    if(file != NULL){\n        fwrite(&amp;frame, sizeof(Frame), 1, file);\n        fclose(file);   \n    }\n    else\n        printf(\"Error %d\\n\", errno);\n}\n\nFrame load(void){\n    Frame frame;\n    FILE *file = fopen(\"path/to/save.txt\", \"r\");\n    if(file != NULL){\n        fread(&amp;frame, sizeof(Frame), 1, file);\n        fclose(file);\n    }\n    else\n        printf(\"Error %d\\n\", errno);\n    return frame;\n}\n</code></pre>\n\n<p>And then in your <code>main</code> function:</p>\n\n<pre><code>int main(void){ \n    Frame f = {\n        .name = \"my_frame\", \n        .duration = 60, \n        .path = \"/path/to/frame\"\n    };\n    save(f);\n    Frame g = load(); // It will load f to g\n    printf(\"%s %d %s\\n\", g.name, g.duration, g.path);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11388135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57e155a33918e9cd8dd6845765e199a?s=128&d=identicon&r=PG&f=1", "display_name": "d.z", "link": "https://stackoverflow.com/users/11388135/d-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1561463580, "creation_date": 1561454449, "question_id": 56750699, "link": "https://stackoverflow.com/questions/56750699/linked-list-in-file-read-write", "title": "Linked list in file read\\write", "body": "<p>I have a project in c to do a movie maker and i put frames and i need to do option to save the project and open it again and enter again frames how i do that?</p>\n\n<p>this is the structs  </p>\n\n<pre><code>typedef struct Frame\n{\nchar*       name;\nunsigned int    duration;\nchar*       path;  \n} Frame;\n\n\n// Link (node) struct\ntypedef struct FrameNode\n{\n    Frame* frame;\n    struct FrameNode* next;\n} FrameNode;\n</code></pre>\n\n<p>this is the option i need to do i did all except the save and open option</p>\n\n<p>open path\nAdd new frame\nRemove a frame\nChange frame index \nChange frame duration\nChange duration of all frames\nList frames\nPlay movie!\nSave project</p>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 2, "creation_date": 1561459408, "post_id": 56750622, "comment_id": 100061981, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56573657/is-it-possible-to-make-thread-join-to-parallel-for-region-after-its-job\">Is it possible to make thread join to &#39;parallel for&#39; region after its job?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "is_accepted": false, "score": 1, "last_activity_date": 1561457556, "creation_date": 1561457556, "answer_id": 56751667, "question_id": 56750622, "link": "https://stackoverflow.com/questions/56750622/is-it-possible-to-run-omp-for-without-thread-0/56751667#56751667", "title": "Is it possible to run omp for without thread 0?", "body": "<p>You can do that with a <code>single</code> (or <code>master</code> if you really want thread 0) pragma. The <code>nowait</code> directive will allow other threads to continue running.</p>\n\n<p>You should use a dynamic scheduling in your for loop as it deals better with a variable number of threads. And if  thread 0 has finished its work, it will join the pool.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;omp.h&gt;\n\n#define end 2000\n\nvoid fct1(){\n  printf(\"Hey I am thread %d\\n\", omp_get_thread_num());\n};\n\nvoid fct2(){\n  int p;\n# pragma omp for schedule(dynamic,128) // adapt chunk size to your problem\n  for (p=0; p &lt; end; p++) {\n    printf(\"%d (%d)\\t\",p,omp_get_thread_num());\n  } // all, including thread 0, will be synchronized here\n};\n\nint main(){\n# pragma omp parallel \n  {\n#   pragma omp single nowait\n    fct1();\n\n    fct2();\n  }\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10857734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75ef696e4955671bcc2c3e237581086b?s=128&d=identicon&r=PG&f=1", "display_name": "Mabrouk", "link": "https://stackoverflow.com/users/10857734/mabrouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561457556, "creation_date": 1561454197, "question_id": 56750622, "link": "https://stackoverflow.com/questions/56750622/is-it-possible-to-run-omp-for-without-thread-0", "title": "Is it possible to run omp for without thread 0?", "body": "<p>I have a use case where I want to run two functions in parallel: the first one contains work that I want to execute in thread 0, and the other contains a \"for\" loop that I want to share among the remaining 3 threads. \nmy code is like:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void fct1(){\n    //do some work1\n};\n\nvoid fct2(){\n    int p;\n    #pragma omp for schedule(static)\n    for (p=start; p &lt; end; p++) {\n        //do some work2\n    }\n};\n\nint main(){\n    #pragma omp parallel \n    {\n        int tid = omp_get_thread_num();\n        if (tid==0)\n            fct1();\n\n        if(tid!=0)\n            fct2();\n    }\nreturn 0;\n}\n\n</code></pre>\n\n<p>the problem is that the \"omp for\" in fct2 hangs because it also waits for thread 0 to execute its part.</p>\n\n<p>Do you have any suggestions?\nThank you.</p>\n"}]