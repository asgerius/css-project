[{"tags": ["c", "arrays", "string", "character"], "comments": [{"owner": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1513815260, "post_id": 47916024, "comment_id": 82800321, "body": "Try changing this line: <code>char a[5]=&quot;\\0&quot;;</code> to <code>char a[5] = {0};</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2470, "user_id": 4262157, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DIi0C.jpg?s=128&g=1", "display_name": "Erik W", "link": "https://stackoverflow.com/users/4262157/erik-w"}, "edited": false, "score": 0, "creation_date": 1513818389, "post_id": 47916024, "comment_id": 82801053, "body": "@ErikW Those initialize the same."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513818585, "post_id": 47916024, "comment_id": 82801109, "body": "Replace the various <code>printf(&quot;%s\\n&quot;, a);</code> with unique output to help clarify output seen.  <code>printf(&quot;1 &lt;%s&gt;\\n&quot;, a);</code>  <code>printf(&quot;2 &lt;%s&gt;\\n&quot;, a);</code> ..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513818696, "post_id": 47916024, "comment_id": 82801131, "body": "Posting <code>crypt()</code> would help."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513838569, "post_id": 47917230, "comment_id": 82806176, "body": "thanks @MultiSkill, I get that in the result their may be left-overs from the inner loop but for the first time when the outer loop executes it must print the same as in case of a single loop simply as a  b  c  .... and then after a complete execution when the outer loop switches the value of i to &#39;b&#39; then the it should give azzz  bzzz  czzz .... I am still a little bit confused Can you please clarify me on that ?"}, {"owner": {"reputation": 346, "user_id": 9118285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7160a1a06c23a8718fdd016fe6ed5433?s=128&d=identicon&r=PG&f=1", "display_name": "MultiSkill", "link": "https://stackoverflow.com/users/9118285/multiskill"}, "reply_to_user": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513839995, "post_id": 47917230, "comment_id": 82806781, "body": "@user8590061 this is the output I get when running your code sans the crypt function:"}, {"owner": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513840324, "post_id": 47917230, "comment_id": 82806939, "body": "Can you please give the output ?"}, {"owner": {"reputation": 346, "user_id": 9118285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7160a1a06c23a8718fdd016fe6ed5433?s=128&d=identicon&r=PG&f=1", "display_name": "MultiSkill", "link": "https://stackoverflow.com/users/9118285/multiskill"}, "reply_to_user": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513840435, "post_id": 47917230, "comment_id": 82806996, "body": "@user8590061 this is the output I get when running your code sans the crypt function: a bzzz czzz dzzz ... zzzz So just as mentioned the leftover characters are there. Not sure where you got the azzz from, though. Like some commenters did mention: try adding a tag to know which printf the line is coming from. I have tested my solution as well, it results in: a b c d ... z aa ba ca .. za ab bb cb db ... zzzz"}], "tags": [], "owner": {"reputation": 346, "user_id": 9118285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7160a1a06c23a8718fdd016fe6ed5433?s=128&d=identicon&r=PG&f=1", "display_name": "MultiSkill", "link": "https://stackoverflow.com/users/9118285/multiskill"}, "is_accepted": false, "score": 1, "last_activity_date": 1513841245, "last_edit_date": 1513841245, "creation_date": 1513824595, "answer_id": 47917230, "question_id": 47916024, "link": "https://stackoverflow.com/questions/47916024/error-in-generating-a-four-letter-character-array/47917230#47917230", "title": "Error in generating a four letter character array", "body": "<p>Most likely you are getting leftovers from the inner loops. So when the outer loop gets to b, a[1]..a[3] still have the 'z' character in them. Simple solution would be to do something like:</p>\n\n<pre><code>a[0]=i;\na[1]=0;\n</code></pre>\n\n<p>But I would simplify the loops altogether and do it that way:</p>\n\n<pre><code>const char END[]=\"zzzz\"; // any word, e.g. END[]=\"end\";\nchar a[sizeof(END)/sizeof(*END)]=\"\"; // 4 chars + 1 '\\0'\ndo{\n    // increment a\n    for(int i=0;i&lt;(sizeof(a)/sizeof(*a)-1);i++){\n        if(a[i]=='z'){a[i]='a';}\n        else {\n            if(a[i]) a[i]+=1;\n            else     a[i]='a';\n            break;\n        }\n    }\n\n    if(strcmp(crypt(a, \"50\"), argv[1])==0){\n        printf(\"%s\\n\", a);\n        break;\n    }\n} while(strcmp(a, END)); // finish on a == END\n</code></pre>\n\n<p>Not the most elegant solution, but should work. I'll leave you to fill out the rest.</p>\n\n<p>Good luck.</p>\n\n<p><strong>Bonus edit:</strong> made the code easier to configure by adding the const up top.</p>\n"}], "owner": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513841245, "creation_date": 1513814325, "last_edit_date": 1513814419, "question_id": 47916024, "link": "https://stackoverflow.com/questions/47916024/error-in-generating-a-four-letter-character-array", "title": "Error in generating a four letter character array", "body": "<pre><code>char i,j,k,l;\nif(argc==2)\n{\n\n    char a[5]=\"\\0\";\n    for(i='a';i&lt;='z';i++)\n    {\n        a[0]=i;\n        printf(\"%s\\n\",a);\n        if(strcmp(crypt(a,\"50\"),argv[1])==0)\n        {\n         printf(\"%s\\n\", a);\n         break;\n\n        }\n        else{\n                for(j='a';j&lt;='z';j++)\n                {\n                    a[1]=j;\n\n                    if(strcmp(crypt(a,\"50\"), argv[1])==0)\n                    {\n                        printf(\"%s\\n\", a);\n                        break;\n\n                    }\n                    else\n                    {\n                        for(k='a';k&lt;='z';k++)\n                        {\n                            a[2]=k;\n                            if(strcmp(crypt(a,\"50\"), argv[1])==0)\n                            {\n                                printf(\"%s\\n\", a);\n                                break;\n\n                            }\n                            else\n                            {\n                                for(l='a';l&lt;='z';l++)\n                                {\n                                    a[3]=l;\n\n\n                                    if(strcmp(crypt(a,\"50\"), argv[1])==0)\n                                    {\n                                        printf(\"%s\\n\", a);\n                                         break;\n\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n</code></pre>\n\n<p>The major portion of the code is to create a set of single, double, triple and four letter strings and then check their crypted hashes across the hashed code which is passed as input\nThe hashing is done by the crypt function provided with c</p>\n\n<p>And to check the error in my original program I used that printf line</p>\n\n<pre><code>printf(\"%s\\n\", a);\n</code></pre>\n\n<p>And the output which I expected was </p>\n\n<pre><code>a  \nb  \nc  \nd  \ne \n(...)\n</code></pre>\n\n<p>But the output was:</p>\n\n<pre><code>azzz  \nbzzz  \nczzz  \ndzzz  \n(...) \n</code></pre>\n\n<p>Many of the people told me to use the printf line in the inner most loop but then too it would not change the original error that my program will not be able to produce the set of single, double an triple characters. It will only be able to create a four character string.</p>\n"}, {"tags": ["c", "pointers", "indexing", "stack"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513814721, "post_id": 47915914, "comment_id": 82800165, "body": "You should step through the <code>strReplace()</code> function in the debugger, and examine the variables after each step."}, {"owner": {"reputation": 23, "user_id": 6117852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmzOP.png?s=128&g=1", "display_name": "L. Messing", "link": "https://stackoverflow.com/users/6117852/l-messing"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513814833, "post_id": 47915914, "comment_id": 82800194, "body": "@Barmar already did that following every variable. Had no luck with that. Maybe i&#39;m doing something wrong there"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513815028, "post_id": 47915914, "comment_id": 82800251, "body": "I don&#39;t think it should cause a problem, but <code>sizeBuffer</code> should be <code>sizeBuffer-(p-source)</code> in the <code>sprintf_s()</code> call."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513815172, "post_id": 47915914, "comment_id": 82800298, "body": "Many implementations of string replacement can be found <a href=\"https://stackoverflow.com/questions/779875/what-is-the-function-to-replace-string-in-c\">here</a>"}, {"owner": {"reputation": 23, "user_id": 6117852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmzOP.png?s=128&g=1", "display_name": "L. Messing", "link": "https://stackoverflow.com/users/6117852/l-messing"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513815247, "post_id": 47915914, "comment_id": 82800315, "body": "@Barmar no that&#39;s okay. It is supposed to append the buffer."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513815455, "post_id": 47915914, "comment_id": 82800366, "body": "It&#39;s not OK because you&#39;re starting from <code>buffer + (p-source)</code>, so you have to substract that from the available space."}, {"owner": {"reputation": 23, "user_id": 6117852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmzOP.png?s=128&g=1", "display_name": "L. Messing", "link": "https://stackoverflow.com/users/6117852/l-messing"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513815815, "post_id": 47915914, "comment_id": 82800465, "body": "@Barmar Sorry i misread that comment. This solved it! If you provide a quick answer i will upvote it. Thanks!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1513849675, "post_id": 47915914, "comment_id": 82811793, "body": "When you have a function with 8 parameters and like 10 LOC, or when you have something like <code>const footype x</code> all over your function declarations, you should be concerned about the overall program design. Bad design gives bad code, and bad code gives bugs."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1513815967, "creation_date": 1513815967, "answer_id": 47916206, "question_id": 47915914, "link": "https://stackoverflow.com/questions/47915914/stack-around-variable-was-corrupted-c/47916206#47916206", "title": "Stack around variable was corrupted - C", "body": "<p>WHen you call <code>sprintf_s()</code>, you're starting from the middle of <code>buffer</code>. So you need to reduce the available space by that index. It should be:</p>\n\n<pre><code>    sprintf_s(buffer + (p - source), sizeBuffer - (p - source), \"%s%s\", replace, p + strlen(substring));\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6117852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmzOP.png?s=128&g=1", "display_name": "L. Messing", "link": "https://stackoverflow.com/users/6117852/l-messing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 47916206, "answer_count": 1, "score": -1, "last_activity_date": 1513815967, "creation_date": 1513813511, "question_id": 47915914, "link": "https://stackoverflow.com/questions/47915914/stack-around-variable-was-corrupted-c", "title": "Stack around variable was corrupted - C", "body": "<p>i searched alot with google and spend about 2 hours fixing this error.\nI get the following Error: <br> \"<strong>Run-Time Check Failure #2 - Stack around the variable 'buffer' was corrupted.</strong>\"</p>\n\n<p>I know it has to do something with my pointers, my sprintf_s functions or similar. This simple program is supposed to just replace <code>','</code> with <code>'-'</code>.</p>\n\n<p>I hope someone can give me a hint to solve this. I know a lot of those questions exist but none of them helped me fix this error.</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;stdio.h&gt;\n\nint strReplace(char *buffer, const rsize_t sizeBuffer,\n    char *source, const rsize_t sizeSource,\n    const char *substring, const rsize_t sizeSubstring,\n    const char *replace, const rsize_t sizeReplace)\n{\n    if (sizeBuffer &lt; sizeSource || sizeBuffer &lt; sizeReplace || sizeSource &lt; sizeSubstring)\n        return -1;\n\n    char *p;\n\n    p = strstr(source, substring);\n    while (p != NULL)\n    {\n        strncpy_s(buffer, sizeBuffer, source, p - source);\n\n        buffer[p - source] = '\\0';\n\n        sprintf_s(buffer + (p - source), sizeBuffer, \"%s%s\", replace, p + strlen(substring));\n\n        strncpy_s(source, sizeSource, buffer, sizeBuffer);\n        p = strstr(source, substring);\n    }\n\n    return 0;\n}\n\nint myFunc(char *source, const rsize_t sizeSource)\n{\n    char *substring = \",\";\n    char *replace = \"-\";\n    char buffer[100];\n\n    strReplace(&amp;buffer, 100, source, sizeSource,\n        substring, 2, replace, 2);\n\n    return 0;\n}\n\nint main()\n{\n    char input[25] = \"1,2,3,4,5,6,7,8,9,0\";\n\n    printf(\"input: %s\\n\", input);\n    myFunc(&amp;input, 25);\n\n    _getch();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9124833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff9cd9c7bd13e09516aa1153967e4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Illyes", "link": "https://stackoverflow.com/users/9124833/richard-illyes"}, "edited": false, "score": 0, "creation_date": 1513823612, "post_id": 47915979, "comment_id": 82802219, "body": "thanks. that is what I was missing"}], "tags": [], "owner": {"reputation": 23, "user_id": 6117852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmzOP.png?s=128&g=1", "display_name": "L. Messing", "link": "https://stackoverflow.com/users/6117852/l-messing"}, "is_accepted": false, "score": 1, "last_activity_date": 1513813994, "creation_date": 1513813994, "answer_id": 47915979, "question_id": 47915910, "link": "https://stackoverflow.com/questions/47915910/or-notation-and-bit-shift-why-sign-why-1/47915979#47915979", "title": "OR notation and bit shift why = sign why 1", "body": "<p><code>TCCR2A</code> is a register. Something like <code>00100001</code>.\n<code>WGM21</code> is a number. For example 3.</p>\n\n<p><code>(1 &lt;&lt; WGM21)</code> this shifts a 1 for 3(<code>WGM21</code>) positions left.\nSo this results is <code>00000100</code>.</p>\n\n<p>So now we have: <code>TCCR2A |= 00000100;</code>\nwhich results in: <code>TCCR2A = TCCR2A | 00000100;</code></p>\n\n<p>if the actual state of <code>TCCR2A</code> is <code>00100001</code> <br> \nit looks like this: <code>TCCR2A = 00100001 | 00000100;</code></p>\n\n<p>Now the answer is <code>TCCR2A = 00100101;</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9124833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff9cd9c7bd13e09516aa1153967e4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Illyes", "link": "https://stackoverflow.com/users/9124833/richard-illyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1513818840, "answer_count": 1, "score": -2, "last_activity_date": 1513813994, "creation_date": 1513813490, "question_id": 47915910, "link": "https://stackoverflow.com/questions/47915910/or-notation-and-bit-shift-why-sign-why-1", "closed_reason": "Duplicate", "title": "OR notation and bit shift why = sign why 1", "body": "<p>I am new to C.  Can someone tell me what is happening with these instructions which are from sample code setting up timer interrupts in an Atmel in an Arduino</p>\n\n<pre><code>  TCCR2A |= (1 &lt;&lt; WGM21);\n  // Set CS21 bit for 8 prescaler\n  TCCR2B |= (1 &lt;&lt; CS21);   \n  // enable timer compare interrupt\n  TIMSK2 |= (1 &lt;&lt; OCIE2A);\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "heroku", "ld"], "answers": [{"tags": [], "owner": {"reputation": 1840, "user_id": 471293, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/6101792a3fbbd3642fbdded323b62255?s=128&d=identicon&r=PG", "display_name": "ekaqu", "link": "https://stackoverflow.com/users/471293/ekaqu"}, "is_accepted": false, "score": 0, "last_activity_date": 1513826014, "creation_date": 1513826014, "answer_id": 47917388, "question_id": 47915828, "link": "https://stackoverflow.com/questions/47915828/linker-always-picking-system-libsasldb-so-rather-than-one-provided-by-ld-library/47917388#47917388", "title": "linker always picking system libsasldb.so rather than one provided by LD_LIBRARY_PATH", "body": "<p>In the above example, turns out that cyrus-sasl uses a compile time flag to define plugin directories and will load from that path.  I recompiled the project to change the plugin directory to be the heroku location and see the following syscalls</p>\n\n<pre><code>openat(AT_FDCWD, \"/app/.apt/usr/lib/sasl2\", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 5\nopen(\"/app/.apt/usr/lib/sasl2/libcrammd5.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libcrammd5.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libdigestmd5.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libdigestmd5.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libscram.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libscram.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/liblogin.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/liblogin.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libcrammd5.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libldapdb.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libanonymous.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libanonymous.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libplain.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libplain.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libntlm.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libntlm.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libntlm.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libotp.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libldapdb.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libldapdb.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libanonymous.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/liblogin.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libscram.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libotp.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libotp.so.2\", O_RDONLY|O_CLOEXEC) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libdigestmd5.la\", O_RDONLY) = 6\nopen(\"/app/.apt/usr/lib/sasl2/libplain.la\", O_RDONLY) = 6\n</code></pre>\n\n<p>In short, it controls the linking itself which is why the linker never searches for additional libs.</p>\n"}], "owner": {"reputation": 1840, "user_id": 471293, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/6101792a3fbbd3642fbdded323b62255?s=128&d=identicon&r=PG", "display_name": "ekaqu", "link": "https://stackoverflow.com/users/471293/ekaqu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513826014, "creation_date": 1513812802, "question_id": 47915828, "link": "https://stackoverflow.com/questions/47915828/linker-always-picking-system-libsasldb-so-rather-than-one-provided-by-ld-library", "title": "linker always picking system libsasldb.so rather than one provided by LD_LIBRARY_PATH", "body": "<p>I am running in a heroku based environment, so installing packages in system space is not allowed.  To work around this they are installed into <code>/app/.apt</code> and <code>LD_LIBRARY_PATH</code> is updated to reflect this.</p>\n\n<p>I am trying to use cyrus-sasl2 so install it there and see it is installed, but when I try to use this library I see that it isn't able to pick up gssapiv2 which is also installed in the same location.</p>\n\n<p>Running the code with <code>LD_DEBUG=all</code> I see something interesting</p>\n\n<pre><code>file=/usr/lib/x86_64-linux-gnu/sasl2/libsasldb.so [0];  dynamically loaded by /app/.apt/usr/lib/x86_64-linux-gnu/libsasl2.so.2 [0]\n</code></pre>\n\n<p>Normally I see libraries do a search, but this is always picking up system and not performing the search.  I was expecting something as follows</p>\n\n<pre><code>  1673:\n  1673:     file=libsasl2.so.2 [0];  needed by /app/.heroku/python/lib/python2.7/site-packages/sasl/saslwrapper.so [0]\n  1673:     find library=libsasl2.so.2 [0]; searching\n  1673:      search path=/app/.heroku/vendor/lib:/app/.heroku/python/lib:/app/.apt/usr/lib/x86_64-linux-gnu:/app/.apt/usr/lib:tls/x86_64:tls:x86_64:                (LD_LIBRARY_PATH)\n  1673:       trying file=/app/.heroku/vendor/lib/libsasl2.so.2\n  1673:       trying file=/app/.heroku/python/lib/libsasl2.so.2\n  1673:       trying file=/app/.apt/usr/lib/x86_64-linux-gnu/libsasl2.so.2\n</code></pre>\n\n<p>but I don't see that in the case of <code>libsasldb.so</code>.</p>\n\n<p>My question is, why would the linker not search but instead always use the system version?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 4, "creation_date": 1513810330, "post_id": 47915474, "comment_id": 82799025, "body": "This thing doesn&#39;t make any sense. There&#39;s some serious confusion about what a value and its representations are."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 4, "creation_date": 1513810336, "post_id": 47915474, "comment_id": 82799028, "body": "<code>0x0c</code> and <code>0x12</code> are 2 different values. <code>0x0c</code> is 12 in base 10, <code>0x12</code> is 18 in base 10. There&#39;s only 1 value no matter how it&#39;s printed out. The format specifier of <code>printf</code> is how you pick how the value is displayed (when using <code>printf</code> to display it)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1513810417, "post_id": 47915474, "comment_id": 82799047, "body": "Values are stored in binary. It is their representation for humans, that varies."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1513810680, "post_id": 47915474, "comment_id": 82799122, "body": "You can add 6 <code>0x0C + 0x06 = 0x12</code>"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1513810755, "post_id": 47915474, "comment_id": 82799154, "body": "What (unsatisfactory) results do you get with what code and what input?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1513811313, "post_id": 47915474, "comment_id": 82799305, "body": "Just leave off <code>0x</code>. <code>unsigned char decValue = 12; &#47;&#47; 0x0C</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3623, "user_id": 701302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0209e45e0162da89877cf2981ff127?s=128&d=identicon&r=PG", "display_name": "slevy1", "link": "https://stackoverflow.com/users/701302/slevy1"}, "is_accepted": true, "score": 3, "last_activity_date": 1513812958, "last_edit_date": 1513812958, "creation_date": 1513812635, "answer_id": 47915813, "question_id": 47915474, "link": "https://stackoverflow.com/questions/47915474/convert-char-hex-to-char-dec-in-c/47915813#47915813", "title": "Convert char hex to char dec in C", "body": "<p>Sometimes it can get confusing understanding the difference between value and representation.  So, consider this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    unsigned char hexVal = 0x0C;\n    unsigned char dec = hexVal;\n    printf(\"\\nValue expressed in decimal: %d and in hexadecimal: %x\", dec,dec);\n    return 0;\n}\n</code></pre>\n\n<p>See <a href=\"https://ideone.com/0zBpZ2\" rel=\"nofollow noreferrer\">live code</a></p>\n\n<p>It expresses the notion of ten as a hexadecimal in the first assignment statement.   When hexVal is assigned to variable dec what is assigned is the value ten which is stored in a binary format.  Since dec is already a variable, no need for sprintf() here.  You may then use the format specifier to express the value of ten as a decimal or in another base.  In this case. The value is a expressed as a decimal. </p>\n"}], "owner": {"reputation": 483, "user_id": 7903454, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d4e413a1ee54a14559917559af99d48b?s=128&d=identicon&r=PG&f=1", "display_name": "Noe Cano", "link": "https://stackoverflow.com/users/7903454/noe-cano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "closed_date": 1513811713, "accepted_answer_id": 47915813, "answer_count": 1, "score": 0, "last_activity_date": 1513812958, "creation_date": 1513810214, "last_edit_date": 1513810615, "question_id": 47915474, "link": "https://stackoverflow.com/questions/47915474/convert-char-hex-to-char-dec-in-c", "closed_reason": "Needs details or clarity", "title": "Convert char hex to char dec in C", "body": "<p>I want to convert a value stored in a variable type <code>unsigned char</code> as a decimal in this way:</p>\n\n<pre><code>unsigned char hexValue = 0x0C;\n</code></pre>\n\n<p>And I want to convert <code>hexValue</code> into a new <code>unsigned char</code> in \"dec\" format like this:</p>\n\n<pre><code>unsigned char decValue = 0x12; //Ox0C\n</code></pre>\n\n<p>I tried <code>sprintf()</code> and <code>strtol()</code> but without good results.</p>\n"}, {"tags": ["c#", "c"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1513808831, "post_id": 47915225, "comment_id": 82798562, "body": "You&#39;ll be wanting <code>System.BitConverter.ToUInt16</code>  The BitConverter class will be helpful in conversion of any code containing a pointer cast."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1513809115, "post_id": 47915225, "comment_id": 82798653, "body": "Don&#39;t think about it at the level of pointers. <b>Say at a high level what the program fragment does</b>.  &quot;I have an array of 4 uints and an array of 16 bytes; I wish to write four uints to the array such that...&quot;"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1513809139, "post_id": 47915225, "comment_id": 82798656, "body": "Now you&#39;ve written a specification.  Implement that specification in C# using the idioms of C#."}, {"owner": {"reputation": 21, "user_id": 9108055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59000b27c446ae6dd9503645a1bb1c54?s=128&d=identicon&r=PG&f=1", "display_name": "Varreza", "link": "https://stackoverflow.com/users/9108055/varreza"}, "edited": false, "score": 0, "creation_date": 1513809265, "post_id": 47915225, "comment_id": 82798682, "body": "The full original c code can be found on <a href=\"https://haxx.in/upc_keys.c\" rel=\"nofollow noreferrer\">haxx.in/upc_keys.c</a>"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1513809304, "post_id": 47915225, "comment_id": 82798695, "body": "@EricLippert: I wonder how many people would dare give this a try if the loop body were the equivalent <code>i[hv] = i[(uint16_t*)h1];</code>"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1513809404, "post_id": 47915225, "comment_id": 82798727, "body": "@BenVoigt: Yeah, people just shouldn&#39;t do that. :-)"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1513809595, "post_id": 47915225, "comment_id": 82798782, "body": "@EricLippert: But rumor has it that C# coders understand subscripting better than dereferencing and pointer arithmetic  ;)   Do you happen to know if Coverity checkers (for C and C++) flag subscript operand reversal?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1513810051, "post_id": 47915225, "comment_id": 82798938, "body": "@BenVoigt: I don&#39;t recall having seen that one, but the number of C checkers is <i>huge</i>. I would be surprised if it was not there, but I have no specific knowledge of it."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1513810177, "post_id": 47915225, "comment_id": 82798985, "body": "The notion that this is &quot;valid&quot; C code is suspect; it depends for example on the byte array being in a particular endianness."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1513810331, "post_id": 47915225, "comment_id": 82799026, "body": "this is the type of code that looks <i>so sweet</i> when converted to <code>Span&lt;T&gt;</code> :)"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1513810577, "post_id": 47915225, "comment_id": 82799096, "body": "@MarcGravell: For some reason they&#39;re pulling 4 ushorts out of an array of 16 bytes.  Who can say why?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1513810597, "post_id": 47915225, "comment_id": 82799100, "body": "@MarcGravell: The type coming out is <code>uint16_t</code> and the stride is <code>sizeof (uint16_t)</code>. Seems ok. It&#39;s being stored to a new array which has a wider type than needed."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1513810654, "post_id": 47915225, "comment_id": 82799112, "body": "@EricLippert: The code shows another loop five lines below this one, that pulls out the other half: <code>hv[i] = *(uint16_t *)(h1 + 8 + i*2);</code>"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1513810809, "post_id": 47915225, "comment_id": 82799165, "body": "@BenVoigt: Well that explains it.  Though it never ceases to amaze me how awful this sort of C code is. The original author could have written <code>uint16_t * ps = (uint16_t*)h1; for (i = 0; i &lt; 4; i++) hv[i] = ps[i];</code> which is far easier to understand and less prone to error."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1513811057, "post_id": 47915225, "comment_id": 82799249, "body": "@EricLippert: Interesting thing is that the code in the original source is not &quot;valid C code&quot; as the question claims.  In fact it violates the strict aliasing rule and has potential alignment problems."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1513811113, "post_id": 47915225, "comment_id": 82799263, "body": "@BenVoigt: I learned a long time ago that what people mean when they say &quot;valid C code&quot; is &quot;works on my machine&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 1, "creation_date": 1513810891, "post_id": 47915533, "comment_id": 82799194, "body": "&quot;Don&#39;t try to translate pointer manipulation code to C#&quot; - agreed, but in the future: the new <code>Span&lt;T&gt;</code> stuff allows direct coercion of spans between different <code>T</code>, which makes this kind of stuff <i>so cute</i>, without needing any <code>unsafe</code>"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 1, "creation_date": 1513811028, "post_id": 47915533, "comment_id": 82799236, "body": "@MarcGravell: Indeed, I agree. My intention here was to describe how to solve the general problem from first principles, rather than to solve the specific problem using cool new stuff that&#39;s not fully baked yet."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 6, "creation_date": 1513811097, "post_id": 47915533, "comment_id": 82799258, "body": "and it always impresses me how well you express that key aim - &quot;write/ask what you&#39;re trying to do, not how you&#39;re trying to do it&quot; - once you&#39;ve done that: most things fade away into implementation minutae"}], "tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 6, "last_activity_date": 1513810959, "last_edit_date": 1513810959, "creation_date": 1513810531, "answer_id": 47915533, "question_id": 47915225, "link": "https://stackoverflow.com/questions/47915225/porting-c-code-to-c-dereferencing-a-pointer/47915533#47915533", "title": "Porting C Code to C# / dereferencing a pointer", "body": "<p>Break it down.  What are we doing?  <strong>Work from the semantic level, not from the level of pointers</strong>.</p>\n\n<ul>\n<li>We have a byte array with some number of bytes.</li>\n<li>We take two bytes at a time and alias them as 16-bit unsigned integers</li>\n<li>We extract the 16-bit unsigned integer, convert it to a 32-bit unsigned integer, and assign that to an array element.</li>\n</ul>\n\n<p>Now we have a specification. <strong>Write a method for each interesting operation.</strong> The only interesting operation is turning two bytes into one ushort; everything else is done for you by the compiler.</p>\n\n<pre><code>static ushort BytesToUshort(byte b1, byte b2)\n{\n   // You can implement this method\n}\n</code></pre>\n\n<p>Great. Now we have a tool we can use.  What bytes do we want? The bytes at <code>i*2</code> and <code>i*2+1</code>.  So: </p>\n\n<pre><code>for (i = 0; i &lt; 4; i++) {\n    hv[i] = BytesToUshort(h1[i*2], h1[i*2+1]);\n}\n</code></pre>\n\n<p>And we're done.</p>\n\n<p>Don't try to translate pointer manipulation code to C#; you can do it but it will not be good C# code. Write code that has the same effect but uses the conventions of C#.</p>\n\n<p>A technique that might help is to rewrite the code so that it is less awful C code; this is terrible.  If you rewrote the original code into C like this first:</p>\n\n<pre><code>uint16_t *ps = (uint16_t*)h1;\nfor (i = 0; i &lt; 4; i++)\n  hv[i] = ps[i];\n</code></pre>\n\n<p>I daresay that it would have been a lot easier to understand conceptually what was going on here.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9108055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59000b27c446ae6dd9503645a1bb1c54?s=128&d=identicon&r=PG&f=1", "display_name": "Varreza", "link": "https://stackoverflow.com/users/9108055/varreza"}, "edited": false, "score": 0, "creation_date": 1513880588, "post_id": 47915548, "comment_id": 82829936, "body": "After some twinkling around, i got this almost finished, how would you port hv[i] = *(uint16_t *)(h1 + 8 + i*2); to C#?"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 21, "user_id": 9108055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59000b27c446ae6dd9503645a1bb1c54?s=128&d=identicon&r=PG&f=1", "display_name": "Varreza", "link": "https://stackoverflow.com/users/9108055/varreza"}, "edited": false, "score": 0, "creation_date": 1513886837, "post_id": 47915548, "comment_id": 82833071, "body": "@Varreza the <code>*(uint16_t *)</code> is the <code>BitConverter.ToUInt16</code>, where <code>h1</code> is the vector (array) and <code>8 + i*2</code> is the offset. So literally the only thing that changes is the second parameter to <code>ToUInt16</code>"}, {"owner": {"reputation": 21, "user_id": 9108055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59000b27c446ae6dd9503645a1bb1c54?s=128&d=identicon&r=PG&f=1", "display_name": "Varreza", "link": "https://stackoverflow.com/users/9108055/varreza"}, "edited": false, "score": 0, "creation_date": 1513940793, "post_id": 47915548, "comment_id": 82850048, "body": "Perfect! Thank you!"}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": true, "score": 1, "last_activity_date": 1513811406, "last_edit_date": 1513811406, "creation_date": 1513810659, "answer_id": 47915548, "question_id": 47915225, "link": "https://stackoverflow.com/questions/47915225/porting-c-code-to-c-dereferencing-a-pointer/47915548#47915548", "title": "Porting C Code to C# / dereferencing a pointer", "body": "<p>Essentially:</p>\n\n<pre><code>        ushort[] hv = new ushort[4];\n        byte[] h1 = new byte[16];\n\n        for (int i = 0; i &lt; 4; i++)\n        {\n            // note: this call is CPU-endian; if your data is not CPU-endian,\n            // you will need to write a known-endian op - aka \"shift\" and \"or\"\n            hv[i] = BitConverter.ToUInt16(h1, i * 2);\n        }\n</code></pre>\n\n<p>Although I wonder if a blit might be more appropriate.</p>\n\n<p>Note that you can also use <code>unsafe</code> C# code to have <em>essentially the same code as the C code</em> (via <code>fixed</code>), and in the upcoming bits: this would be a good fit for <code>Span&lt;T&gt;</code> which allows for simple thunks between different <code>T</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 9108055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59000b27c446ae6dd9503645a1bb1c54?s=128&d=identicon&r=PG&f=1", "display_name": "Varreza", "link": "https://stackoverflow.com/users/9108055/varreza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 47915548, "answer_count": 2, "score": 0, "last_activity_date": 1513811406, "creation_date": 1513808625, "last_edit_date": 1513808986, "question_id": 47915225, "link": "https://stackoverflow.com/questions/47915225/porting-c-code-to-c-dereferencing-a-pointer", "title": "Porting C Code to C# / dereferencing a pointer", "body": "<p>How would I port this piece of C Code to C#? It is a UPC Key Recovery Tool. </p>\n\n<p><code>hv</code> is a <code>uint32_t</code> array with 4 elements. <code>h1</code> is a <code>uint8_t</code> array with 16 elements</p>\n\n<pre><code>uint32_t hv[4] = ...\nuint8_t h1[16] = ...\n\nfor (i = 0; i &lt; 4; i++) {\n    hv[i] = *(uint16_t *)(h1 + i*2);\n}\n</code></pre>\n\n<p>While this is valid C code I cannot seem to port this to C# without it giving me errors. Does anybody have an idea what I could do?</p>\n\n<p>I've tried declaring <code>hv</code> as a uint array and <code>h1</code> as a byte array.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1513808798, "post_id": 47915182, "comment_id": 82798542, "body": "This will go out of bounds for c if FIELD_TIME_LENGTH &gt; 5.  &quot;hure&quot; + \\0 = a 5-character string."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1513808821, "post_id": 47915182, "comment_id": 82798554, "body": "How is <code>field_time</code> declared? Your code reads string <code>c</code> at positions up to <code>length</code>. You pass 6, but the string you pass has length 4 (or 5, with zero terminator). How is this supposed to work?"}, {"owner": {"reputation": 1, "user_id": 9124636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8102e0ff09732dbc715bd0ac02e3fca7?s=128&d=identicon&r=PG&f=1", "display_name": "P. Ribback", "link": "https://stackoverflow.com/users/9124636/p-ribback"}, "edited": false, "score": 0, "creation_date": 1513809797, "post_id": 47915182, "comment_id": 82798849, "body": "#define FIELD_TIME_LENGTH 6 char field_time[FIELD_TIME_LENGTH] But i think thats not the point, the problem is before reaching switch case still at first line of function and the handed parameters should be independent of following code, shouldnt?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1513810085, "post_id": 47915182, "comment_id": 82798953, "body": "@P. Ribback: Should be, yes. But parameters are typically stored in the stack next to local variables. If you damage stack memory by writing of ouf bounds on some local array, you can dectroy the value of a parameter as well."}, {"owner": {"reputation": 1, "user_id": 9124636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8102e0ff09732dbc715bd0ac02e3fca7?s=128&d=identicon&r=PG&f=1", "display_name": "P. Ribback", "link": "https://stackoverflow.com/users/9124636/p-ribback"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1513810492, "post_id": 47915182, "comment_id": 82799070, "body": "@AnT But i have still the same problem if don&#39;t write in loop."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1513812079, "post_id": 47915182, "comment_id": 82799504, "body": "Where are you setting the breakpoint?  The stack might already have been trashed"}, {"owner": {"reputation": 920, "user_id": 8108125, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d73c63113cdabd2357f32a9808bd0559?s=128&d=identicon&r=PG&f=1", "display_name": "Cpp plus 1", "link": "https://stackoverflow.com/users/8108125/cpp-plus-1"}, "edited": false, "score": 0, "creation_date": 1513819698, "post_id": 47915182, "comment_id": 82801349, "body": "The value you are seeing is equivalent to 2^32 and therefore, overflows to 0, so maybe the variable has not been assigned yet."}, {"owner": {"reputation": 4909, "user_id": 911550, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WHa6T.jpg?s=128&g=1", "display_name": "parvus", "link": "https://stackoverflow.com/users/911550/parvus"}, "edited": false, "score": 0, "creation_date": 1513934175, "post_id": 47915182, "comment_id": 82846638, "body": "If you think this is a general problem, you should also post compiler details and the C flavor you&#39;re using."}], "owner": {"reputation": 1, "user_id": 9124636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8102e0ff09732dbc715bd0ac02e3fca7?s=128&d=identicon&r=PG&f=1", "display_name": "P. Ribback", "link": "https://stackoverflow.com/users/9124636/p-ribback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513819489, "creation_date": 1513808345, "last_edit_date": 1513819489, "question_id": 47915182, "link": "https://stackoverflow.com/questions/47915182/c-wrong-parameter-in-called-function", "title": "C: Wrong parameter in called function", "body": "<p>General question:</p>\n\n<p>In main I call function dd_draw_string() with parameters as seen below.\nThe problem is that the parameter length isn't handed over the right way.\nSo  when I call the function with length = 6 and look up the handed over with breakpoint in called function and now the parameter has the value  length = 4294967296 (0xffff ffff).</p>\n\n<p>It's not the full code, but it should be enough to show my issue.</p>\n\n<p>font.h:</p>\n\n<pre><code>/*\n * font.h\n */\n\n#ifndef FONT_H\n#define FONT_H\n\n#include \"stdint.h\"\n\nvoid dd_draw_string(Color* color, uint32_t x, uint32_t y,  char* c, uint32_t length);\n\n#endif /* FONT_H */\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>#include \"font.h\"\nint main() {\n\n    init();\n\n    while (1)\n    {\n        Color zero = BLUE;\n        char bla[] = \"hure\";\n        uint32_t laenge = 6;\n        dd_draw_string(&amp;zero, POSITION_NEXTTO_GRAPH_X, POSITION_CURSORX1_TEXT_Y, bla, laenge); //Cursor X1\n     }\n}\n</code></pre>\n\n<p>font.c</p>\n\n<pre><code>void dd_draw_string(Color* color, uint32_t x, uint32_t y, char* c, uint32_t length)\n{\n\n    uint8_t current_index;\n\n    /*\n     * switch over handed y position\n     */\n    switch(y)\n    {\n    case POSITION_BELOW_GRAPH_Y:\n                if(x == POSITION_NEXTTO_GRAPH_X &amp;&amp; length == FIELD_TIME_LENGTH)\n                {\n                    for(current_index = 0; current_index &lt; FIELD_TIME_LENGTH; current_index++)\n                    {\n                        /*\n                         * delete old char at current_index -&gt; write = false\n                         */\n                        dd_draw_char(color, POSITION_TIME_TEXT_X + current_index * FONT_COLUMNS,\n                                     POSITION_TIME_TEXT_Y, field_time[current_index], false);\n                        /*\n                         * update old char to current char in field\n                         */\n                        field_time[current_index] = c[current_index];\n                        /*\n                         * draw current char at display\n                         */\n                        dd_draw_char(color, POSITION_TIME_TEXT_X + current_index * FONT_COLUMNS,\n                                     POSITION_TIME_TEXT_Y, field_time[current_index], true);\n                        }\n                }\n                break;\n</code></pre>\n\n<p>By the way, I'm programming with TM4C1294NCPDT, but I think it's a general C issue.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13073, "user_id": 3858806, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R0DRu.png?s=128&g=1", "display_name": "Junius L.", "link": "https://stackoverflow.com/users/3858806/junius-l"}, "edited": false, "score": 0, "creation_date": 1513808110, "post_id": 47915078, "comment_id": 82798304, "body": "see this post <a href=\"https://stackoverflow.com/questions/30873206/header-file-included-only-once-in-entire-program\" title=\"header file included only once in entire program\">stackoverflow.com/questions/30873206/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1513808151, "post_id": 47915078, "comment_id": 82798323, "body": "Always include the immediate dependencies."}, {"owner": {"reputation": 2741, "user_id": 2036161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ba65c6994b3945d68ea848b7d8a27253?s=128&d=identicon&r=PG", "display_name": "ventsyv", "link": "https://stackoverflow.com/users/2036161/ventsyv"}, "edited": false, "score": 0, "creation_date": 1513808238, "post_id": 47915078, "comment_id": 82798362, "body": "I think it would be better to include hello.h in both foo and bar. That way if someone is reading that one file, they can easily see that a given function comes from hello.h."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1513808348, "post_id": 47915078, "comment_id": 82798409, "body": "A header file includes another header file if it needs macros or data types defined there. There is very rarely a need for a header file to access function declarations."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1513808782, "post_id": 47915078, "comment_id": 82798536, "body": "Each header file should be self-contained -- usable without needing any other headers included prior to it.  That&#39;s the way the standard C headers work; yours should too.  (These days, that applies to POSIX too; there&#39;s no longer any need to include <code>&lt;sys&#47;types.h&gt;</code> separately.)  Each header should also be idempotent; there shouldn&#39;t be any problem if the header is included multiple times.  Compilers are pretty good about handling this. Use include guards."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1513809515, "post_id": 47915078, "comment_id": 82798759, "body": "To emphasize what AlexP wrote: what do you mean by &quot;use functions declared in hello.h&quot;?  Your header file should not be defining functions, so in what way are you using functions declared in other headers?"}, {"owner": {"reputation": 1, "user_id": 7988643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b955bd0feae30bd3cc58dee03e3868?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Park", "link": "https://stackoverflow.com/users/7988643/jonathan-park"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513809620, "post_id": 47915078, "comment_id": 82798800, "body": "I clarified: I meant macros, though it&#39;s not impossible to use function declarations inside a header file. @JonathanLeffler Not sure if your comment applies here...? I&#39;m asking from a readability perspective."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513810167, "post_id": 47915078, "comment_id": 82798980, "body": "Look up IWYU \u2014 Include What You Use. It&#39;s a Google project. What I said covers most of what you need to know. If code that uses <code>foo.h</code> must have <code>bar.h</code> available (that is, <code>foo.h</code> itself uses information from <code>bar.h</code>, whether types or macros \u2014 it probably isn&#39;t functions that are used), then <code>foo.h</code> should include <code>bar.h</code>. If the application code uses functions (types, macros) declared in <code>bar.h</code>, it should include it; if it uses functions etc from <code>foo.h</code>, it should include that, separately, even though it also includes <code>bar.h</code> (but not if it doesn&#39;t directly use functions from <code>bar.h</code>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513810521, "post_id": 47915078, "comment_id": 82799078, "body": "You can find a lot of my views on this general topic in my answer to <a href=\"https://stackoverflow.com/questions/1804486/should-i-use-include-in-headers/1804719#1804719\">Should I use <code>#include</code> in headers?</a>.  You might find some useful discussion (and useful x-refs) in <a href=\"https://stackoverflow.com/questions/34496418/is-define-banned-in-industry-standards/34496517#34496517\">Is <code>#define</code> banned in industry standards?</a>, though that&#39;s primarily about <code>#define</code> rather than <code>#include</code> per se."}, {"owner": {"reputation": 1, "user_id": 7988643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b955bd0feae30bd3cc58dee03e3868?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Park", "link": "https://stackoverflow.com/users/7988643/jonathan-park"}, "edited": false, "score": 0, "creation_date": 1513810707, "post_id": 47915078, "comment_id": 82799133, "body": "Helpful as your information is, I already know how the preprocessor works and it&#39;s not answering the question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513810975, "post_id": 47915078, "comment_id": 82799219, "body": "I&#39;m sorry it&#39;s not helpful to tell you what you need to know.  You need to make headers minimal, self-contained, idempotent.  If you make them so, you will know what you need to do.  Maybe <a href=\"https://stackoverflow.com/questions/15622409/how-to-link-multiple-implementation-files-in-c/15622496#15622496\">How to link multiple implementation files in C</a> will help (it covers aspects of header file design); maybe <a href=\"https://stackoverflow.com/questions/276386/how-to-structure-includes-in-c/276588#276588\">How to structure <code>#include</code> in C?</a> will help.  Maybe you don&#39;t need help since you already know."}, {"owner": {"reputation": 1, "user_id": 7988643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b955bd0feae30bd3cc58dee03e3868?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Park", "link": "https://stackoverflow.com/users/7988643/jonathan-park"}, "edited": false, "score": 0, "creation_date": 1513811385, "post_id": 47915078, "comment_id": 82799320, "body": "When you say &quot;minimal&quot; is that a yes or no to my question? Please read my question again. I&#39;m not asking how to deal with dependency issues--I&#39;m asking if knowingly putting an unnecessary include would be useful down the road for readability."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1513811679, "post_id": 47915078, "comment_id": 82799390, "body": "How would including an &quot;unneccessary&quot; include help readability?  <code>#include &lt;notneeded.h&gt;</code> seemingly does nothing to help understand later code."}, {"owner": {"reputation": 1, "user_id": 7988643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b955bd0feae30bd3cc58dee03e3868?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Park", "link": "https://stackoverflow.com/users/7988643/jonathan-park"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1513811875, "post_id": 47915078, "comment_id": 82799446, "body": "It&#39;s unnecessary in the sense that I know that since foo.h includes bar.h, and bar.h includes hello.h, I don&#39;t need to include hello.h in foo.h. However, hello.h is an immediate dependency. Thank you @EugeneSh., and that does make the most sense. Seems that&#39;s the consensus."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1513810710, "post_id": 47915502, "comment_id": 82799136, "body": "Note that you should never invent a name that starts with an underscore and either a capital letter or another underscore.  Such names are reserved for &quot;the implementation&quot; (meaning the C compiler and the writers of the standard C libraries) to use.  By using such names, you are treading on their name space and run the risk of being interfered with.  Use a name such as <code>MYHEADER_H_INCLUDED</code> (or <code>MYHEADER_H</code>) rather than risk messing with the implementation.  See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.1.3\" rel=\"nofollow noreferrer\">&#167;7.1.3 Reserved Identifiers</a> for more information."}], "tags": [], "owner": {"reputation": 8001, "user_id": 307297, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/e28FD.png?s=128&g=1", "display_name": "chris01", "link": "https://stackoverflow.com/users/307297/chris01"}, "is_accepted": false, "score": 0, "last_activity_date": 1513810382, "creation_date": 1513810382, "answer_id": 47915502, "question_id": 47915078, "link": "https://stackoverflow.com/questions/47915078/should-i-include-a-header-file-multiple-times-in-different-files/47915502#47915502", "title": "Should I include a header file multiple times in different files?", "body": "<p>You can wrap the header into preprocessor-ifs. So the compiler will handle it if you include them to often.</p>\n\n<pre><code>#ifndef _MYHEADER_\n#define _MYHEADER_\n\n// whatever\n\n#endif\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7988643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b955bd0feae30bd3cc58dee03e3868?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Park", "link": "https://stackoverflow.com/users/7988643/jonathan-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 821, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513810490, "creation_date": 1513807801, "last_edit_date": 1513810490, "question_id": 47915078, "link": "https://stackoverflow.com/questions/47915078/should-i-include-a-header-file-multiple-times-in-different-files", "title": "Should I include a header file multiple times in different files?", "body": "<p>Say, for example, that I have header files foo.h and bar.h, which both want to include hello.h, and use macros declared in hello.h. foo.h also already includes bar.h. </p>\n\n<p>Should I include hello.h in both foo.h and bar.h, or just in bar.h? I know it doesn't matter functionally, but I'm not sure what the \"standard\" is for readability.</p>\n\n<p>Edit: I know how header guards work. I'm not asking from a dependency perspective; I'm asking from a readability perspective. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1513807743, "post_id": 47915030, "comment_id": 82798153, "body": "What is the problem? How will <i>you</i> do this? I mean systematically with pen and paper."}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1513807803, "post_id": 47915030, "comment_id": 82798180, "body": "Is this homework or a programmer test?"}, {"owner": {"reputation": 15836, "user_id": 1675492, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HsMph.jpg?s=128&g=1", "display_name": "Ingo B&#252;rk", "link": "https://stackoverflow.com/users/1675492/ingo-b%c3%bcrk"}, "edited": false, "score": 0, "creation_date": 1513807838, "post_id": 47915030, "comment_id": 82798201, "body": "And the number growing exponentially with n is not a problem for you? For a set of k elements and a given n, there are k^n combinations."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1513807983, "post_id": 47915030, "comment_id": 82798257, "body": "There are many fun ways to implement it. Iterative - the least fun. Recursive - more fun. And using base-4."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1513808582, "post_id": 47915030, "comment_id": 82798475, "body": "Just for your info, those are called &quot;strings of length <i>n</i> over the alphabet {A, B, C, D}&quot;. You may want to think of them as numbers from 0 to 4\u207f \u2212 1 represented in base 4 using the digits A for 0, B for 1, C for 2 and D for 3."}, {"owner": {"reputation": 523, "user_id": 6935886, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9b452099c2feb414656f4143e3033a3c?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph K.", "link": "https://stackoverflow.com/users/6935886/joseph-k"}, "edited": false, "score": 0, "creation_date": 1513808986, "post_id": 47915030, "comment_id": 82798603, "body": "I think your first step is to figure out if this is a permutation or combination, and what tuples are."}], "answers": [{"tags": [], "owner": {"reputation": 559, "user_id": 2778503, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/66d37fb90bd7663e717b54903f35fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "ayyoob imani", "link": "https://stackoverflow.com/users/2778503/ayyoob-imani"}, "is_accepted": false, "score": 0, "last_activity_date": 1513809512, "creation_date": 1513809512, "answer_id": 47915368, "question_id": 47915030, "link": "https://stackoverflow.com/questions/47915030/how-to-find-all-options-with-repetition/47915368#47915368", "title": "How to find all options with repetition?", "body": "<p>You can not do it using nested loops because you need n for loops and n is not determined at first (and it is ridiculous to use n nested for loops). One approach to solving the problem is to use recursive functions. The recursive function should return the basic list consisting of 4 letters for n=1 and for n>1 it should call itself with parameter (n-1) and then append each one of the four letters to each returned string from the recursive call. I suggest you to try to implement it yourself before reading the following pseudo code!</p>\n\n<pre><code>list func(int n){\n  if ( n == 1 ) {return list('A', 'B', 'C', 'D'); }\n  else {\n    result = list();\n    permutations = func(n-1);\n    for (each item in permutations) {\n      result.append(item+'A');\n      result.append(item+'B');\n      result.append(item+'C');\n      result.append(item+'D');\n      return result;\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9124693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90fd4c5a9a16caae7a8618cd93a8c4a?s=128&d=identicon&r=PG&f=1", "display_name": "lafila", "link": "https://stackoverflow.com/users/9124693/lafila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1513809512, "creation_date": 1513807572, "question_id": 47915030, "link": "https://stackoverflow.com/questions/47915030/how-to-find-all-options-with-repetition", "title": "How to find all options with repetition?", "body": "<p>I'm looking at a problem I can't really still figure out.</p>\n\n<p>I need all (now what's the right math term) permutations? tuples? combinations? with repetition made out of 4 given elements.</p>\n\n<p>I've got the elements <strong>A, B, C, D</strong>. There is four of them, the amount is fixed. For a given <em>n</em>, I need to be able to get all possible options from these four elements. For example:</p>\n\n<p><em>n = 1</em>;\nPossible options:\n<strong>A\nB\nC\nD</strong></p>\n\n<p><em>n = 2</em>;\nPossible options:\n<strong>AA\nAB\nAC\nAD\nBA\nBB\nBC\nBD\n...\nDC\nDD</strong></p>\n\n<p><em>n = 4</em>; Possible options: <strong>AAAA\nAAAB\nAAAC\n...\nDDDC\nDDDD</strong></p>\n\n<p>Would anyone be able to kind of direct me somewhere? There are some following conditions, but I should be able to filter them on the go. Of course I tried searching for the answer, but no topics seem to be the same issue I'm trying to solve.</p>\n\n<p>Big thanks to anyone who would at least try to pinch me in the right direction a bit.</p>\n"}, {"tags": ["c", "sse", "pixels", "intrinsics", "avx"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1513804429, "post_id": 47914385, "comment_id": 82796771, "body": "If you only want the low half of the result, multiplication is the same binary operation for signed or unsigned.  So you can use <a href=\"https://github.com/HJLebbink/asm-dude/wiki/PMULLW\" rel=\"nofollow noreferrer\">github.com/HJLebbink/asm-dude/wiki/PMULLW</a> on either.  There are separate high-half multiply instructions for signed and unsigned short."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 3, "creation_date": 1513804570, "post_id": 47914385, "comment_id": 82796827, "body": "Of the operations listed here only division and modulo are affected by the signedness, the rest are equivalent in two&#39;s complement and unsigned representations. Also, I don&#39;t believe that there are any integer division/modulo instructions defined. What is the specific issue with the algorithm which you are attempting to implement?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513805413, "post_id": 47914385, "comment_id": 82797214, "body": "@doynax &quot;only division and modulo are affected by the signedness&quot;.  Is not  <code>*</code> also affected?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1513805414, "post_id": 47914385, "comment_id": 82797217, "body": "If you are using intrinsics for performance, first check what kind of assembly normal C code produces at -O3. It might be compiler is smart enough to already do what you are trying to."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1513805497, "post_id": 47914385, "comment_id": 82797266, "body": "@chux: Not in 16-bits, only the upper half of the full 32-bit result is affected."}, {"owner": {"reputation": 187, "user_id": 8204704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dfa102dc7018ec1ccb28ebd5b3e88000?s=128&d=identicon&r=PG&f=1", "display_name": "A.nechi", "link": "https://stackoverflow.com/users/8204704/a-nechi"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1513805607, "post_id": 47914385, "comment_id": 82797310, "body": "@hyde : I do not want to leave that to the compiler."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513805689, "post_id": 47914385, "comment_id": 82797344, "body": "@A.nechi: Do you need to perform the swizzling for random pixel indices or are you iterating over a section of the image in a predictable order?"}, {"owner": {"reputation": 187, "user_id": 8204704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dfa102dc7018ec1ccb28ebd5b3e88000?s=128&d=identicon&r=PG&f=1", "display_name": "A.nechi", "link": "https://stackoverflow.com/users/8204704/a-nechi"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513805973, "post_id": 47914385, "comment_id": 82797453, "body": "@doynax I am going in order from the first pixel to the last and calculating to which index of the array should that pixel be stored"}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 2, "creation_date": 1513806324, "post_id": 47914385, "comment_id": 82797582, "body": "@A.nechi: If so then I would suggest iterating through the coordinate axes of the source pixel directly instead of reversing the coordinates from a flat index. The a step along each axis should then correspond to a fixed pitch addition, plus a bit of a special case handling for the clamping."}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1513805562, "creation_date": 1513805562, "answer_id": 47914657, "question_id": 47914385, "link": "https://stackoverflow.com/questions/47914385/unsigned-short-int-operation-with-intel-intrinsics/47914657#47914657", "title": "Unsigned short int operation with Intel Intrinsics", "body": "<p>If you only want the low half of the result, multiplication is the same binary operation for signed or unsigned.  So you can use <a href=\"https://github.com/HJLebbink/asm-dude/wiki/PMULLW\" rel=\"nofollow noreferrer\"><code>pmullw</code></a> on either.  There are separate high-half multiply instructions for signed and unsigned short, though: <code>_mm_mulhi_epu16</code> (<a href=\"https://github.com/HJLebbink/asm-dude/wiki/PMULHUW\" rel=\"nofollow noreferrer\"><code>pmulhuw</code></a>) vs. <code>_mm_mulhi_epi16</code> (<a href=\"http://%60pmulhuw%60\" rel=\"nofollow noreferrer\"><code>pmuluw</code></a>)</p>\n\n<p>Similarly, you don't need an <code>_mm_set_epu16</code> because it's the same operation: on x86 casting to signed doesn't change the bit-pattern, so Intel only bothered to provide <code>_mm_set_epi16</code>, but you can use it with args like <code>0xFFFFu</code> instead of <code>-1</code> with no problems.  (Using Intel intrinsics automatically means your code only has to be portable to x86 32 and 64 bit.)</p>\n\n<p>Load / store intrinsics don't change the data at all.</p>\n\n<hr>\n\n<p><strong>SSE/AVX doesn't have integer division or mod instructions</strong>.  If you have compile-time-constant divisors, do it yourself with a multiply/shift.  You can look at compiler output to get the magic constant and shift counts (<a href=\"https://stackoverflow.com/questions/41183935/why-does-gcc-use-multiplication-by-a-strange-number-in-implementing-integer-divi\">Why does GCC use multiplication by a strange number in implementing integer division?</a>), or even let gcc auto-vectorize something for you.  Or even use GNU C native vector syntax to divide:</p>\n\n<pre><code>#include &lt;immintrin.h&gt;\n\n__m128i div13_epu16(__m128i a) \n{\n    typedef unsigned short __attribute__((vector_size(16))) v8uw;\n    v8uw tmp = (v8uw)a;\n    v8uw divisor = (v8uw)_mm_set1_epi16(13);\n    v8uw result = tmp/divisor;\n    return (__m128i)result;\n\n    // clang allows \"lax\" vector type conversions without casts\n    // gcc allows vector / scalar, e.g. tmp / 13.  Clang requires set1\n\n    // to work with both, we need to jump through all the syntax hoops\n}\n</code></pre>\n\n<p>compiles to this asm with gcc and clang (<a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,source:&#39;%23include+%3Cimmintrin.h%3E%0A%0A__m128i+div13_epu16(__m128i+a)+%0A%7B%0A++++typedef+unsigned+short+__attribute__((vector_size(16)))+v8uw%3B%0A++++v8uw+tmp+%3D+(v8uw)a%3B%0A++++v8uw+divisor+%3D+(v8uw)_mm_set1_epi16(13)%3B%0A++++v8uw+result+%3D+tmp/divisor%3B%0A++++return+(__m128i)result%3B%0A%0A++++//+clang+allows+%22lax%22+vector+type+conversions+without+casts%0A++++//+gcc+allows+vector+/+scalar,+e.g.+tmp+/+13.++Clang+requires+set1%0A+++%0A++++//+to+work+with+both,+we+need+to+jump+through+all+the+syntax+hoops%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;),(h:codeEditor,i:(j:2,source:&#39;%23include+%3Cvector%3E%0A%23include+%3Cmemory%3E%0A//int+globb+%3D+1,+globc+%3D+2%3B%0A%0Astruct+A%7B%0A++++virtual+void+Update()+%3D+0%3B+//+A+is+so+pure+*%C2%AC*%0A%7D%3B%0A%0Astruct+B+//:+public+A%0A%7B%0A++++int+m_b+%3D+0%3B%0A++++void+Update()+//override+final%0A++++%7B%0A++++++++//globb%2B%2B%3B%0A++++//++++m_b%2B%2B%3B%0A++++%7D%0A%7D%3B%0Aint+SB+%3D+sizeof(B)%3B++//+only+4+bytes+per+object+with+no+vtable+pointer%0A%0Astruct+C+:+public+A%0A%7B%0A++++int+m_c+%3D+0%3B%0A++++void+Update()+override+final%0A++++%7B%0A+++++++++m_c%2B%2B%3B%0A++++++++//globc%2B%2B%3B%0A++++%7D%0A%7D%3B%0Aint+SC+%3D+sizeof(std::unique_ptr%3CC%3E)%3B++//+16+bytes+because+of+the+vtable+pointer%0A%0Avoid+separate_containers(std::vector%3CB%3E+%26vecB,+std::vector%3CC%3E+%26vecC)%0A%7B%0A++++//for(auto+%26b:+vecB)++++++++b.Update()%3B%0A++++for(auto+%26c:+vecC)++++++++c.Update()%3B+++%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%232&#39;,t:&#39;0&#39;),(h:compiler,i:(compiler:clang500,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),libs:!(),options:&#39;-std%3Dgnu%2B%2B17+-Wextra+-Wall+-O3+-fverbose-asm+-march%3Dskylake-avx512&#39;,source:2),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+5.0.0+(Editor+%232,+Compiler+%231)&#39;,t:&#39;0&#39;)),k:41.11357131111317,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:g72,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),libs:!(),options:&#39;-xc+-Wall+-O3+-fverbose-asm&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.2+(Editor+%231,+Compiler+%233)&#39;,t:&#39;0&#39;)),k:30.36709010370096,l:&#39;4&#39;,m:60.497835497835496,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:output,i:(compiler:3,editor:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%233+with+x86-64+gcc+7.2&#39;,t:&#39;0&#39;)),header:(),l:&#39;4&#39;,m:39.502164502164504,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:28.940164451121262,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:clang401,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),libs:!(),options:&#39;-xc+-Wall+-O3+-fverbose-asm&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+4.0.1+(Editor+%231,+Compiler+%232)&#39;,t:&#39;0&#39;)),k:22.222222222222218,l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:output,i:(compiler:2,editor:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%232+with+x86-64+clang+4.0.1&#39;,t:&#39;0&#39;)),header:(),l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:29.94626423776556,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">Godbolt compiler explorer</a>):</p>\n\n<pre><code>div13_epu16:\n    pmulhuw xmm0, XMMWORD PTR .LC0[rip]       # tmp93,\n    psrlw   xmm0, 2       # tmp95,\n    ret\n\n.section .rodata\n.LC0:\n    .value  20165\n    # repeats 8 times\n</code></pre>\n\n<hr>\n\n<p>If you have runtime-variable divisors, it's going to be slower, but you can use <a href=\"http://libdivide.com/\" rel=\"nofollow noreferrer\">http://libdivide.com/</a>.  It's not too bad if you reuse the same divisor repeatedly, so you only have to calculate a fixed-point inverse for it once, but code to use an arbitrary inverse needs a variable shift count which is less efficient with SSE (well also for integer), and potentially more instructions because some divisors require a more complicated sequence than others.</p>\n"}], "owner": {"reputation": 187, "user_id": 8204704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dfa102dc7018ec1ccb28ebd5b3e88000?s=128&d=identicon&r=PG&f=1", "display_name": "A.nechi", "link": "https://stackoverflow.com/users/8204704/a-nechi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513807697, "creation_date": 1513804180, "last_edit_date": 1513807697, "question_id": 47914385, "link": "https://stackoverflow.com/questions/47914385/unsigned-short-int-operation-with-intel-intrinsics", "title": "Unsigned short int operation with Intel Intrinsics", "body": "<p>I want to do some operation using the Intel intrinsics (vector of unsigned int of 16 bit) and the operations are the following :</p>\n\n<p><strong>load</strong> or <strong>set</strong> from an array of unsigned short int.</p>\n\n<p><strong>Div</strong> and <strong>Mod</strong> operations with unsigned short int.</p>\n\n<p><strong>Multiplication</strong> operation with unsigned short int.</p>\n\n<p><strong>Store</strong> operation of unsigned short int into an array.</p>\n\n<p>I looked into the Intrinsics guide but it looks like there are only intrinsics for short integers and not the unsigned ones. Could someone have any trick that could help me with this ?</p>\n\n<p>In fact I'm trying to store an image of a specific raster format in an array with a specific ordering. So I have to calculate the index where each pixel value is going to be stored:</p>\n\n<pre><code>unsigned int Index(unsigned int interleaving_depth, unsigned int x_size, unsigned int y_size, unsigned int z_size, unsigned int Pixel_number)\n{\n   unsigned int x = 0, y = 0, z = 0, reminder = 0, i = 0;\n\n   y = Pixel_number/(x_size*z_size);\n   reminder = Pixel_number % (x_size*z_size);\n\n   i = reminder/(x_size*interleaving_depth);\n   reminder = reminder % (x_size*interleaving_depth);\n\n   if(i == z_size/interleaving_depth){\n       x = reminder/(z_size - i*interleaving_depth);\n       reminder = reminder % (z_size - i*interleaving_depth);\n    }\n    else\n    {\n       x = reminder/interleaving_depth;\n       reminder = reminder % interleaving_depth;        \n    }\n\n    z = interleaving_depth*i + reminder;\n    if(z &gt;= z_size)\n       z = z_size - 1;\n\n    return x + y*x_size + *x_size*y_size;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads", "producer-consumer"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1513803794, "post_id": 47914211, "comment_id": 82796512, "body": "It would appear you at least need some inner while loops for your predicate checks. Just because a condition variable fired doesn&#39;t mean the predicate it is wrapping is necessarily true upon returning from <code>pthread_cond_wait</code>. At the risk of souinding grossly self-serving, <a href=\"https://stackoverflow.com/questions/14924469/does-pthread-cond-waitcond-t-mutex-unlock-and-then-lock-the-mutex/14925150#14925150\">see this answer</a> for some advice, caveats, and potential pitfalls of pthreads with mutex+cvar usage."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513804471, "post_id": 47914211, "comment_id": 82796786, "body": "Yeah, never <code>if (!cond) { pthread_cond_wait }</code>. Always <code>while (!cond) { pthread_cond_wait }</code>."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513804877, "post_id": 47914211, "comment_id": 82796964, "body": "Instead of doing <code>i%N</code> all over the place, you can replace <code>i++;</code> and <code>i%N</code> with with  i = (i+1) % N;` and <code>i</code>."}, {"owner": {"reputation": 85, "user_id": 5625763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82055f0807215d1f4072730689ebab56?s=128&d=identicon&r=PG&f=1", "display_name": "Dogukan Altay", "link": "https://stackoverflow.com/users/5625763/dogukan-altay"}, "edited": false, "score": 0, "creation_date": 1513805695, "post_id": 47914211, "comment_id": 82797346, "body": "changing to while does not helped at all. Somehow i observed that even though producer thread exists it does not signal the consumer so the consumer waits infinitely."}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1513808009, "post_id": 47914211, "comment_id": 82798268, "body": "Could you please delete all line that don&#39;t matter so that we can have a easier look."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1513808663, "post_id": 47914211, "comment_id": 82798500, "body": "Please review <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Where is conditionValid set?"}, {"owner": {"reputation": 85, "user_id": 5625763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82055f0807215d1f4072730689ebab56?s=128&d=identicon&r=PG&f=1", "display_name": "Dogukan Altay", "link": "https://stackoverflow.com/users/5625763/dogukan-altay"}, "edited": false, "score": 0, "creation_date": 1513808686, "post_id": 47914211, "comment_id": 82798507, "body": "deleted irrelevant lines"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1513809023, "post_id": 47914211, "comment_id": 82798617, "body": "What is N?  I don&#39;t understand why the modulo calculation?"}, {"owner": {"reputation": 85, "user_id": 5625763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82055f0807215d1f4072730689ebab56?s=128&d=identicon&r=PG&f=1", "display_name": "Dogukan Altay", "link": "https://stackoverflow.com/users/5625763/dogukan-altay"}, "edited": false, "score": 0, "creation_date": 1513809171, "post_id": 47914211, "comment_id": 82798665, "body": "N is number of producers and conditionValid is just an indicator, actual code irrelevant you can assume a when the specified condition satisfied add items to the buffer"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1513874622, "post_id": 47914211, "comment_id": 82827070, "body": "Undefined behavior for unsynchronized, non-readonly access to non-atomic objects from multiple threads."}], "answers": [{"tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": true, "score": 1, "last_activity_date": 1513869963, "creation_date": 1513869963, "answer_id": 47928017, "question_id": 47914211, "link": "https://stackoverflow.com/questions/47914211/consumer-producer-having-racing-condition-with-pthreads/47928017#47928017", "title": "Consumer-Producer having racing condition with pthreads", "body": "<p>The deadlock is because producer finishes reading with just one flag set:</p>\n\n<pre><code>buffer-&gt;isDone = true;\n</code></pre>\n\n<p>So, if at that time consumer is waiting for producer 1 condition:</p>\n\n<pre><code>    // say i == 1\n    if (buffer_array[i%N].len == 0)\n    {\n        pthread_cond_wait(&amp;buffer_array[i%N].can_consume, \n                          &amp;buffer_array[i%N].mutex);\n    }\n</code></pre>\n\n<p>The condition will never fire. The consumer has no progress, so everything is just stalls.</p>\n\n<p>The solution might be to fire the <code>can_consume</code> after isDone is set.</p>\n"}], "owner": {"reputation": 85, "user_id": 5625763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82055f0807215d1f4072730689ebab56?s=128&d=identicon&r=PG&f=1", "display_name": "Dogukan Altay", "link": "https://stackoverflow.com/users/5625763/dogukan-altay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 47928017, "answer_count": 1, "score": 2, "last_activity_date": 1513869963, "creation_date": 1513803217, "last_edit_date": 1513808738, "question_id": 47914211, "link": "https://stackoverflow.com/questions/47914211/consumer-producer-having-racing-condition-with-pthreads", "title": "Consumer-Producer having racing condition with pthreads", "body": "<p>I am implementing a consumer-producer problem with using pthreads in ubuntu 16.04 on a virtual machine with 2 processers. We have n number of producers and a single consumer that reads data from each producer through buffers. Each producer has its own buffer. The problem is that at some point my code deadlocks and could not find out why. May be i am messing up with the condition variables and mutex locks.</p>\n\n<pre><code>typedef struct\n{\n    Student*        buf;         // the buffer\n    int             producer_id;\n    size_t          len;         // number of items in the buffer\n    pthread_mutex_t mutex;       // needed to add/remove data from the buffer\n    pthread_cond_t  can_produce; // signaled when items are removed\n    pthread_cond_t  can_consume; // signaled when items are added\n    bool            isDone;\n} buffer_t;\n</code></pre>\n\n<p>This the buffer struct for the data transfer between consumer and producers.</p>\n\n<pre><code>void* producer(void *param)\n{\n    buffer_t* buffer = (buffer_t*)param;\n    char*     line   = NULL;\n    size_t    len    = 0;\n    ssize_t   read;\n    FILE*     inFileReader;\n\n    inFileReader = fopen(inFile, \"r\");\n    while ((read = getline(&amp;line, &amp;len, inFileReader)) != -1)\n    {\n        pthread_mutex_lock(&amp;buffer-&gt;mutex);\n        if (buffer-&gt;len == BUFFER_SIZE)\n        {// buffer full wait\n            pthread_cond_wait(&amp;buffer-&gt;can_produce, &amp;buffer-&gt;mutex);\n        }\n\n        //buffer filled up with the read data from the file.\n        if (conditionValid)\n        {\n            //add item to buffer\n            ++buffer-&gt;len;\n        }\n\n        pthread_cond_signal(&amp;buffer-&gt;can_consume);\n        pthread_mutex_unlock(&amp;buffer-&gt;mutex);\n    }\n\n    fclose(inFileReader);\n    buffer-&gt;isDone = true;\n    pthread_exit(NULL);\n\n    return NULL;\n}\n</code></pre>\n\n<p>This is the producer, reads data from a file given and fills up the buffer and when the file ends the producer thread will exit.</p>\n\n<pre><code>void* consumer(void *param)\n{\n    buffer_t* buffer_array = (buffer_t*)param;\n    sleep(rand() % 3);\n    int i =0;\n\n    while (!buffer_array[i%N].isDone || buffer_array[i%N].len != 0)\n    {\n        pthread_mutex_lock(&amp;buffer_array[i%N].mutex);\n\n        if (buffer_array[i%N].len == 0)\n        {\n            pthread_cond_wait(&amp;buffer_array[i%N].can_consume, \n                              &amp;buffer_array[i%N].mutex);\n        }\n\n        while (buffer_array[i%N].len != 0)\n        {\n            buffer_array[i%N].len--;\n            //read from buffer\n        }\n\n        pthread_cond_signal(&amp;buffer_array[i%N].can_produce);\n        pthread_mutex_unlock(&amp;buffer_array[i%N].mutex);\n        i++;\n    }\n\n    fclose(outFileWriter);\n    pthread_exit(NULL);\n\n    return NULL;\n} \n</code></pre>\n\n<p>The consumer reads buffers from each producer and when all done consumer exit the loop and terminates the thread.</p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["c", "arrays", "character"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1513803141, "post_id": 47914168, "comment_id": 82796215, "body": "Zero-based indexing vs one-based, and a whole lot of undefined behavior on the first call (non-terminated string, indeterminate content in <code>a[0]</code>, etc). It would seem you need to flip to the part of your reference describing how nullchar-terminated strings, and the various standard library functions that use them, work"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1513803525, "post_id": 47914168, "comment_id": 82796384, "body": "If you change the code in the question, you should also re-run it and change the output."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1513803588, "post_id": 47914168, "comment_id": 82796418, "body": "Please, please do not change the question. Rolled back."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513803522, "post_id": 47914231, "comment_id": 82796382, "body": "Sorry I meant the same, in the original code I did write a[0]=&#39;z&#39;;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1513803546, "post_id": 47914231, "comment_id": 82796394, "body": "Or (before the question was changed) <code>char a[4] = &quot;z&quot;;</code>"}, {"owner": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513803816, "post_id": 47914231, "comment_id": 82796520, "body": "what if I want to add a character variable to a preferred address of the array ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513803921, "post_id": 47914231, "comment_id": 82796564, "body": "@user8590061 You mean if you want to set a particular element of the array?  Then you set that element as you did.  But you have to start with a valid string, i.e. an <b>null terminated</b> array of characters."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "edited": false, "score": 0, "creation_date": 1513803944, "post_id": 47914231, "comment_id": 82796574, "body": "@user8590061 then please ask another question showing what you tried. You are treating this site as a change-by-change question-and-answer site, but that is not how we work. You asked one question, you got a good answer."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1513803314, "creation_date": 1513803314, "answer_id": 47914231, "question_id": 47914168, "link": "https://stackoverflow.com/questions/47914168/how-to-use-character-arrays-in-strcmp-functions/47914231#47914231", "title": "how to use character arrays in strcmp() functions", "body": "<p>In the first piece of code, you only set one element of the array.  The other three elements are uninitialized.  So when you call <code>printf</code> and pass in <code>a</code> it reads those uninitialized bytes.  Doing so invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, which in this case manifests as nothing being printed.</p>\n\n<p>What probably happened in this particular case is that the first element of the array, i.e. the one with index 0, was probably 0.  This value is used to terminate strings, so <code>a</code> was viewed as an empty string.</p>\n\n<p>Also:</p>\n\n<blockquote>\n  <p>The first character of the array is z</p>\n</blockquote>\n\n<p>No it is not.  Arrays in C start with index 0, not index 1.</p>\n\n<p>If you want to copy a string into an array, use <code>strcpy</code>:</p>\n\n<pre><code>strcpy(a, \"z\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1513804204, "creation_date": 1513804204, "answer_id": 47914394, "question_id": 47914168, "link": "https://stackoverflow.com/questions/47914168/how-to-use-character-arrays-in-strcmp-functions/47914394#47914394", "title": "how to use character arrays in strcmp() functions", "body": "<p>In this code snippet</p>\n\n<pre><code>char a[4];\na[0]='z';\na[1]='y';\nprintf(\"The character array is %s\\n\", a);\n</code></pre>\n\n<p>the array does not contain a string (a sequence of characters terminated with a zero character). However you are trying to output it as a string using the conversion specifier <code>%s</code>.</p>\n\n<p>Instead you should write</p>\n\n<pre><code>printf(\"The character array is %*.*s\\n\", 2, 2, a);\n</code></pre>\n\n<p>In this code snippet</p>\n\n<pre><code>char a[4];\na[0]='z';\na[1]='y';\nprintf(\"The first character of the array is %c\\n\", a[0]);\nprintf(\"The second character of the array is %c\\n\", a[1]);\n</code></pre>\n\n<p>again the array does not contain a string. However you are outputting separate characters. So there is no problem.</p>\n\n<p>If you want to store a string in the array you should append it with zero character. For example</p>\n\n<pre><code>char a[4];\na[0]='z';\na[1]='y';\na[2] = '\\0';\nprintf(\"The character array is %s\\n\", a);\n</code></pre>\n\n<p>The standard C string function <code>strcmp</code> deals with strings. So arrays that you are going to use with this function shall contain strings.</p>\n\n<p>Otherewise you can use another standard function <code>memcmp</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 8590061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27032dd4cbd51ae7f2e05f2763fe1d7e?s=128&d=identicon&r=PG", "display_name": "user8590061", "link": "https://stackoverflow.com/users/8590061/user8590061"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513804204, "creation_date": 1513803026, "last_edit_date": 1513803747, "question_id": 47914168, "link": "https://stackoverflow.com/questions/47914168/how-to-use-character-arrays-in-strcmp-functions", "title": "how to use character arrays in strcmp() functions", "body": "<p>I initialized a character array with a size of four\nWhen I input any character to the character array as </p>\n\n<pre><code>char a[4];\na[1]='z';\nprintf(\"The character array is %s\\n\", a);\n</code></pre>\n\n<p>The output shows me</p>\n\n<p>The character array is </p>\n\n<p>But then I change a little bit</p>\n\n<pre><code>char a[4];\na[1]='z';\nprintf(\"The first character of the array is %s\\n\", a[1]);\n</code></pre>\n\n<p>The output shows me</p>\n\n<p>The first character of the array is z</p>\n\n<p>Why is that ? How can I use my character arrays such as if I want them to be compared using strcmp() functions.\nPlease help me....</p>\n"}, {"tags": ["c", "console"], "comments": [{"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 1, "creation_date": 1513802128, "post_id": 47913954, "comment_id": 82795728, "body": "On what platform?"}, {"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 2, "creation_date": 1513802323, "post_id": 47913954, "comment_id": 82795831, "body": "Technically you can browse <a href=\"http://git.savannah.nongnu.org/cgit/man-db.git/tree/src\" rel=\"nofollow noreferrer\">man sources</a> and look for clues."}, {"owner": {"reputation": 23, "user_id": 8202498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QrPdP.jpg?s=128&g=1", "display_name": "Mr. Openk", "link": "https://stackoverflow.com/users/8202498/mr-openk"}, "reply_to_user": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 0, "creation_date": 1513803025, "post_id": 47913954, "comment_id": 82796164, "body": "Linux and windows. I will try it."}, {"owner": {"reputation": 23, "user_id": 8202498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QrPdP.jpg?s=128&g=1", "display_name": "Mr. Openk", "link": "https://stackoverflow.com/users/8202498/mr-openk"}, "reply_to_user": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 0, "creation_date": 1513803331, "post_id": 47913954, "comment_id": 82796286, "body": "man-db source code is too complicated for noob like me :D"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8202498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QrPdP.jpg?s=128&g=1", "display_name": "Mr. Openk", "link": "https://stackoverflow.com/users/8202498/mr-openk"}, "edited": false, "score": 0, "creation_date": 1513803245, "post_id": 47914002, "comment_id": 82796255, "body": "Maybe I will try by using ncurses. Thanks for this suggestion."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1513803557, "last_edit_date": 1513803557, "creation_date": 1513802134, "answer_id": 47914002, "question_id": 47913954, "link": "https://stackoverflow.com/questions/47913954/displaying-text-like-a-man-page/47914002#47914002", "title": "Displaying text like a man page", "body": "<p>A terminal is (on Linux and other POSIX systems) quite a complex thing. Read the <a href=\"http://www.linusakesson.net/programming/tty/\" rel=\"nofollow noreferrer\">tty demystified</a> and <a href=\"http://man7.org/linux/man-pages/man3/termios.3.html\" rel=\"nofollow noreferrer\">termios(3)</a> and <a href=\"http://man7.org/linux/man-pages/man4/tty.4.html\" rel=\"nofollow noreferrer\">tty(4)</a>. BTW, terminals are unknown to the C11 standard (you should simply consider POSIX; on Windows, things could be even more complex).</p>\n\n<p>You probably should consider using some library like <a href=\"https://www.gnu.org/software/ncurses/\" rel=\"nofollow noreferrer\">ncurses</a>.</p>\n\n<p>BTW,  <code>man</code> is often from <a href=\"http://man-db.nongnu.org/\" rel=\"nofollow noreferrer\">man-db</a> and that is a <a href=\"https://en.wikipedia.org/wiki/Free_software\" rel=\"nofollow noreferrer\">free software</a> whose source code you can study.</p>\n\n<p>Or you could just run -perhaps using <a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\">system(3)</a> or <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\">popen(3)</a>- some pager, e.g. <a href=\"http://man7.org/linux/man-pages/man1/less.1.html\" rel=\"nofollow noreferrer\">less(1)</a></p>\n"}], "owner": {"reputation": 23, "user_id": 8202498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QrPdP.jpg?s=128&g=1", "display_name": "Mr. Openk", "link": "https://stackoverflow.com/users/8202498/mr-openk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513803557, "creation_date": 1513801929, "question_id": 47913954, "link": "https://stackoverflow.com/questions/47913954/displaying-text-like-a-man-page", "title": "Displaying text like a man page", "body": "<p>I want to display text from a file named list.txt, and I want it to look like a man page display in Linux using pure c. Text can be scroll up and down, at the bottom there is a line that stays there when the text in the scroll. I do not know what it is called.</p>\n\n<p>What methods can I use to create this with C?</p>\n"}, {"tags": ["c", "quoting", "mplab"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1513800462, "post_id": 47913627, "comment_id": 82794934, "body": "A <code>char</code> is specifically a single character, you can&#39;t have multiple characters inside one <code>char</code>, that&#39;s what <code>char[]</code> is for. If you just need to <b>print</b> <code>&#39;h&#39;</code>, then you can do <code>printf(&quot;&#39;%c&#39;\\n&quot;,Mychar[0]);</code>, note the single quotes inside the double quotes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1513801429, "post_id": 47913627, "comment_id": 82795372, "body": "Code <b>cannot</b> add <code>&#39;</code> to a <code>char</code>.  Code <b>can</b> add <code>&#39;</code> to a <i>string</i> or to a <code>printf()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1513802441, "post_id": 47913627, "comment_id": 82795891, "body": "Are you looking for something like<code>char *Mychar = &quot;hello&quot;;   char quote_string[4] = {&#39;\\&#39;&#39;, *Mychar, &#39;\\&#39;&#39;, &#39;\\0&#39;};   printf(&quot;%s\\n&quot;,quote_string);</code> which prints <code>&#39;h&#39;\\n</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 8978978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55effd9a5c130177e1a99be7ed6bf095?s=128&d=identicon&r=PG&f=1", "display_name": "user8978978", "link": "https://stackoverflow.com/users/8978978/user8978978"}, "edited": false, "score": 0, "creation_date": 1513800824, "post_id": 47913657, "comment_id": 82795104, "body": "Thank sir. Is it possible to add it before printf? char *Mychar = &quot;hello&quot;;  char test=&#39;\\n,Mychar[1],&#39;\\n;?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 101, "user_id": 8978978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55effd9a5c130177e1a99be7ed6bf095?s=128&d=identicon&r=PG&f=1", "display_name": "user8978978", "link": "https://stackoverflow.com/users/8978978/user8978978"}, "edited": false, "score": 0, "creation_date": 1513801077, "post_id": 47913657, "comment_id": 82795212, "body": "@user8978978: You could use <code>const char *Mychar = &quot;&#39;hello&#39;&quot;;</code> or <code>const char *Mychar = &quot;\\&quot;hello\\&quot;&quot;;</code>.  (The <code>const</code> is semi-optional; you can&#39;t modify a string literal reliably -- it will crash your program on many systems -- so the <code>const</code> is appropriate to let the compiler know you know.)"}, {"owner": {"reputation": 101, "user_id": 8978978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55effd9a5c130177e1a99be7ed6bf095?s=128&d=identicon&r=PG&f=1", "display_name": "user8978978", "link": "https://stackoverflow.com/users/8978978/user8978978"}, "edited": false, "score": 0, "creation_date": 1513801201, "post_id": 47913657, "comment_id": 82795264, "body": "I need to get &#39;h&#39;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 101, "user_id": 8978978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55effd9a5c130177e1a99be7ed6bf095?s=128&d=identicon&r=PG&f=1", "display_name": "user8978978", "link": "https://stackoverflow.com/users/8978978/user8978978"}, "edited": false, "score": 0, "creation_date": 1513801733, "post_id": 47913657, "comment_id": 82795528, "body": "@user8978978 <code>%c</code> can only format a single character. <code>&#39;h&#39;</code> is 3 characters, it needs to be a string."}, {"owner": {"reputation": 101, "user_id": 8978978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55effd9a5c130177e1a99be7ed6bf095?s=128&d=identicon&r=PG&f=1", "display_name": "user8978978", "link": "https://stackoverflow.com/users/8978978/user8978978"}, "edited": false, "score": 0, "creation_date": 1513802450, "post_id": 47913657, "comment_id": 82795896, "body": "i need to separate each char of a string with single quote in front and in end.Examle string hello i need to take &#39;h&#39; , &#39;e&#39;, &#39;l&#39;, &#39;l&#39; ,&#39;o&#39; in a string"}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 3, "last_activity_date": 1513800507, "creation_date": 1513800507, "answer_id": 47913657, "question_id": 47913627, "link": "https://stackoverflow.com/questions/47913627/how-can-i-add-quotes-to-a-char/47913657#47913657", "title": "How can I add quotes to a char?", "body": "<p>Just add them in the format string. For single quotes, you can just put them in there:</p>\n\n<pre><code>printf(\"'%c'\\n\",Mychar[0]);\n</code></pre>\n\n<p>For double quotes, you'll have to escape them:</p>\n\n<pre><code>printf(\"\\\"%c\\\"\\n\",Mychar[0]);\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8978978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55effd9a5c130177e1a99be7ed6bf095?s=128&d=identicon&r=PG&f=1", "display_name": "user8978978", "link": "https://stackoverflow.com/users/8978978/user8978978"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 47913657, "answer_count": 1, "score": 2, "last_activity_date": 1513800580, "creation_date": 1513800388, "last_edit_date": 1513800580, "question_id": 47913627, "link": "https://stackoverflow.com/questions/47913627/how-can-i-add-quotes-to-a-char", "title": "How can I add quotes to a char?", "body": "<p>I need to add quotes in begging and ending of a char.</p>\n\n<pre><code>char *Mychar = \"hello\"; \nprintf(\"%c\\n\",Mychar[0]);\n</code></pre>\n\n<p>My result is <code>h</code> and my desired result is <code>'h'</code>.</p>\n"}, {"tags": ["c", "linux", "raspberry-pi"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1513800353, "post_id": 47913591, "comment_id": 82794883, "body": "How do you check the size? And why do you call <code>open</code> with the <code>O_LARGEFILE</code> flag?"}, {"owner": {"reputation": 9, "user_id": 9124323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa47dd8b9571c7a2cca9e91e20157e39?s=128&d=identicon&r=PG&f=1", "display_name": "b-612", "link": "https://stackoverflow.com/users/9124323/b-612"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513800455, "post_id": 47913591, "comment_id": 82794928, "body": "I checked the size with dolphin, nautilus and ls -l, all these return the same."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1513800553, "post_id": 47913591, "comment_id": 82794966, "body": "Did you compile with all warnings and debug info (<code>gcc -Wall -Wextra -g</code>)? Did you use the <code>gdb</code> debugger and <code>strace</code> on your Raspberry Pi? And why do you need <code>O_LARGEFILE</code>? You practically don&#39;t have enough space on your SD card for that to be useful!"}, {"owner": {"reputation": 9, "user_id": 9124323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa47dd8b9571c7a2cca9e91e20157e39?s=128&d=identicon&r=PG&f=1", "display_name": "b-612", "link": "https://stackoverflow.com/users/9124323/b-612"}, "edited": false, "score": 0, "creation_date": 1513800605, "post_id": 47913591, "comment_id": 82794994, "body": "The O_LARGEFILE flag was me in my despair trying different options, but without this flag I get the same result"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513800719, "post_id": 47913591, "comment_id": 82795051, "body": "Oh and you have checked the returns from all the function you call? To make sure that none of them fails?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 1, "creation_date": 1513800795, "post_id": 47913591, "comment_id": 82795088, "body": "@b-612 But you do pass <code>&amp;imp</code> instead of <code>imp</code> to the <code>write</code> function, right?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1513801058, "post_id": 47913591, "comment_id": 82795205, "body": "Also, <code>write</code> returns the number of bytes written as another opportunity to check, which you didn&#39;t use."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1513801096, "post_id": 47913591, "comment_id": 82795225, "body": "@b-612: You forgot to show us the <code>lseek()</code> commands your actual code contains."}, {"owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "edited": false, "score": 0, "creation_date": 1513801159, "post_id": 47913591, "comment_id": 82795249, "body": "@b-612, <a href=\"https://stackoverflow.com/posts/47913591/edit\">edit</a> your question to post a complete and compilable program that exhibits the behaviour. Remove anything irrelevant from it, leave just the smallest code that still has the issue. That way it&#39;s easier to see what the problem is or might be."}, {"owner": {"reputation": 9, "user_id": 9124323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa47dd8b9571c7a2cca9e91e20157e39?s=128&d=identicon&r=PG&f=1", "display_name": "b-612", "link": "https://stackoverflow.com/users/9124323/b-612"}, "edited": false, "score": 0, "creation_date": 1513801418, "post_id": 47913591, "comment_id": 82795367, "body": "you&#39;re right Ivan, I pass &amp;imp instead of imp, I corrected that in the question."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 4, "creation_date": 1513801603, "post_id": 47913591, "comment_id": 82795452, "body": "4294967304 = 0x100000008 = 8 + 2**32. It is almost certain that the OP has omitted commands that seek the file position to the 4 GiB mark prior to the <code>write()</code> command. (An alternative is that they are using <code>pwrite()</code> or <code>pwritev()</code> instead, either with a 4 GiB offset, or omitting the parameter altogether so the 4 GiB offset is just a happenstance due to a severe programming bug.)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1513803072, "post_id": 47913591, "comment_id": 82796190, "body": "I compiled using MSVC (without the <code>O_LARGEFILE</code> which it doesn&#39;t know, and including <code>io.h</code> instead of <code>stdlib.h</code>) and it creates a file sized 8 bytes, content <code>59 00 00 00 00 00 00 00</code> (hex). If the file exists, <code>open</code> returns <code>-1</code> and then crashes if that result is not trapped. I also compiled it with MS&#39;s <code>_underscore</code> versions which has the same behaviour."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1513804254, "post_id": 47913591, "comment_id": 82796701, "body": "If you do not actually intend to write 4GB files, consider using the Standard C file functions (<code>fopen</code>, <code>fwrite</code>)"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1513864252, "post_id": 47913591, "comment_id": 82820527, "body": "\u20131 for fake code. This is not the program exhibiting the issue."}], "answers": [{"comments": [{"owner": {"reputation": 36401, "user_id": 142454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b0e3f6ae64ff27a7a01a0f49f8ee469?s=128&d=identicon&r=PG", "display_name": "Warren Young", "link": "https://stackoverflow.com/users/142454/warren-young"}, "edited": false, "score": 0, "creation_date": 1513823641, "post_id": 47914137, "comment_id": 82802236, "body": "You might also address his use of a nonportable data type in a binary file used cross-platform. His long long int happens to be 8 bytes on both today, but not always. He should be using <code>uint64_t</code> or similar."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1513837566, "post_id": 47914137, "comment_id": 82805809, "body": "Are you sure this is OP&#39;s problem? Types are such that a call without prototype should be valid."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1513840390, "post_id": 47914137, "comment_id": 82806973, "body": "@R..: The arm-linux-gnueabihf ABI used supports both 32 and 64-bit word sizes; the exact definitions and promotion rules followed here (including the fact that GCC passes parameters in registers) are complicated. I do believe that <i>if</i> the code shown in the question does exhibit the behaviour described, then not including <code>&lt;unistd.h&gt;</code> either causes a type mismatch for the <code>size_t</code> type, or causes a completely different syscall wrapper to be called instead (likely <code>writev()</code>)."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1513840641, "post_id": 47914137, "comment_id": 82807084, "body": "@R..: However, the most likely case here is, in my own opinion (which is admittedly often wrong), is that OP for some strange reason is unwilling to show the actual code and commands that generated the odd results. They perhaps found a bug of their own making, and rather than help others avoid that same pitfall, they decided that their self-perceived <a href=\"https://en.wikipedia.org/wiki/Face_%28sociological_concept%29\" rel=\"nofollow noreferrer\"><i>&quot;face&quot;</i></a> is more important than anything else, and are willfully leaving others to work out a problem that does not exist in the form described."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1513840774, "post_id": 47914137, "comment_id": 82807151, "body": "(make that <code>pwrite()</code>, not <code>writev()</code>.)"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1513864409, "post_id": 47914137, "comment_id": 82820644, "body": "ABI isn&#39;t relevant. Aside from a call with no declaration at all being invalid C, calls without a prototype are well-defined as long as the actual expressions passed as args have the right types after default promotions. As far as I can tell, they do in OP&#39;s code."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1513864456, "post_id": 47914137, "comment_id": 82820665, "body": "Also ARM is a 32-bit arch. There is no EABI variant with 64-bit sizes."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1513882863, "post_id": 47914137, "comment_id": 82831096, "body": "@R..: Bullshit. See <a href=\"https://en.wikipedia.org/wiki/ARM_architecture#ARMv8-A\" rel=\"nofollow noreferrer\">here</a> for the details on the 64/32-bit ARMv8-A hardware architecture that applies here. It supports two different instruction sets, A32 and A64, A32 being the ARMv7 32-bit instruction set. The Linux kernel in Raspbian supports both for userspace code; and that is at the core here: <a href=\"http://infocenter.arm.com/help/topic/com.arm.doc.den0024a/ch08s02.html\" rel=\"nofollow noreferrer\"><code>size_t</code> is 64-bit</a> even for A32 (Raspbian follows AAPCS64-LP64)."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1513884811, "post_id": 47914137, "comment_id": 82832083, "body": "@NominalAnimal: That&#39;s <code>aarch64</code> which is a completely different architecture as far as the compiler is concerned. <code>arm-linux-gnueabihf</code> is 32-bit ARM not aarch64; the latter is <code>aarch64-linux-gnu</code>. In any case it&#39;s not relevant to this not being OP&#39;s problem."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 7, "last_activity_date": 1513802860, "creation_date": 1513802860, "answer_id": 47914137, "question_id": 47913591, "link": "https://stackoverflow.com/questions/47913591/my-c-program-creates-files-of-4gb-on-a-raspberri-pi-when-they-should-have-a-size/47914137#47914137", "title": "My C program creates files of 4Gb on a raspberri pi when they should have a size of 8 bytes", "body": "<p>The cause of the strange error is the lack of correct headers, specifically <code>&lt;unistd.h&gt;</code>. This causes the parameters to <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"noreferrer\"><code>write()</code></a> to be of incorrect types, especially the <code>count</code> parameter.</p>\n\n<p>Try this corrected version of your program:</p>\n\n<pre><code>#define _POSIX_C_SOURCE 200809L\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nint main(int argc, char *argv[])\n{\n    long long int value = 89;\n    ssize_t n;\n    int descriptor;\n\n    if (argc != 2) {\n        fprintf(stderr, \"\\nUsage: %s FILENAME\\n\\n\", argv[0]);\n        return EXIT_FAILURE;\n    }\n\n    descriptor = open(argv[1], O_RDWR | O_CREAT, 0666);\n    if (descriptor == -1) {\n        fprintf(stderr, \"%s: %s.\\n\", argv[1], strerror(errno));\n        return EXIT_FAILURE;\n    }\n\n    n = write(descriptor, &amp;value, sizeof value);\n    if (n != sizeof value) {\n        if (n == -1)\n            fprintf(stderr, \"%s: %s.\\n\", argv[1], strerror(errno));\n        else\n            fprintf(stderr, \"%s: Partial write (%zd bytes).\\n\", argv[1], n);\n        close(descriptor);\n        return EXIT_FAILURE;\n    }\n\n    if (close(descriptor)) {\n        fprintf(stderr, \"%s: Error closing file.\\n\", argv[1]);\n        return EXIT_FAILURE;\n    }\n\n    printf(\"%zd bytes written successfully to '%s'.\\n\", n, argv[1]);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Always, <strong>always</strong> enable warnings when compiling code. With GCC, I use <code>gcc -Wall -O2</code> (for both warnings and compiler-optimized results). I warmly recommend you do the same. If you save the above as <code>fixed.c</code>, then compile it using</p>\n\n<pre><code>gcc -Wall -O2 fixed.c -o fixed-example\n</code></pre>\n\n<p>and run it using</p>\n\n<pre><code>./fixed-example output-file\n</code></pre>\n\n<p>If you need to compile against e.g. the math library, include the options just before the <code>-o</code> flag; i.e. <code>gcc -Wall -O2 fixed.c -lm -o fixed-example</code> for the above program. The order of options do matter for GCC.</p>\n"}], "owner": {"reputation": 9, "user_id": 9124323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa47dd8b9571c7a2cca9e91e20157e39?s=128&d=identicon&r=PG&f=1", "display_name": "b-612", "link": "https://stackoverflow.com/users/9124323/b-612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513804134, "creation_date": 1513800238, "last_edit_date": 1513804134, "question_id": 47913591, "link": "https://stackoverflow.com/questions/47913591/my-c-program-creates-files-of-4gb-on-a-raspberri-pi-when-they-should-have-a-size", "title": "My C program creates files of 4Gb on a raspberri pi when they should have a size of 8 bytes", "body": "<p>I have a C code compiled with GCC in Ubuntu 14.04 that among other things, creates a file, write 8 bytes, and then closes it. The code works fine in my i7 64 bits pc. The problem is that when I compile and execute my code on a 32 bits architecture (raspberry pi 2 with raspbian) this operation creates a file of size 4294967304 bytes. I don't know what's wrong. The strange thing is that my program creates 3 files in the same way that should be empty but their size is 4 Gb each, and my available memory is only 8 Gb. This leads me to believe that I'm breaking the file system (ext4) but I don't know why. The code is this one:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int outImpFile = open(argv[1], O_RDWR | O_LARGEFILE | O_CREAT, 0);\n    long long int imp = 89;\n    write(outImpFile, &amp;imp, sizeof(long long int));\n    close(outImpFile);\n}\n</code></pre>\n\n<p>When I open the created file with ghex I only see 8 bytes, but when I use hexdiff there are many empty bytes at the beginning and my written 8 bytes at the end.   </p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513800390, "post_id": 47913555, "comment_id": 82794899, "body": "At least this statement temp=node-&gt;next; does not make sense and can result in undefined behavior."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513800436, "post_id": 47913555, "comment_id": 82794919, "body": "And show the full function if it is a code snippet from a function."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513800736, "post_id": 47913555, "comment_id": 82795059, "body": "This statement node-&gt;next = temp-&gt;next; in the while loop also does not make sense."}, {"owner": {"reputation": 37, "user_id": 9091498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34547d6bbe468f30431177bd5e75365b?s=128&d=identicon&r=PG&f=1", "display_name": "user9091498", "link": "https://stackoverflow.com/users/9091498/user9091498"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513800813, "post_id": 47913555, "comment_id": 82795099, "body": "i am not sure if is allowed to post the full function, but i get the record as a parameter. Why this statement cannot work?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1513800939, "post_id": 47913555, "comment_id": 82795147, "body": "@user9091498.: You are trying to deleted the record having number <code>record</code> ? (starting From <code>0</code>)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1513800985, "post_id": 47913555, "comment_id": 82795167, "body": "@user9091498  Who does not allow you to show your ingenious function?"}, {"owner": {"reputation": 37, "user_id": 9091498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34547d6bbe468f30431177bd5e75365b?s=128&d=identicon&r=PG&f=1", "display_name": "user9091498", "link": "https://stackoverflow.com/users/9091498/user9091498"}, "edited": false, "score": 0, "creation_date": 1513801001, "post_id": 47913555, "comment_id": 82795169, "body": "record can start from 1"}, {"owner": {"reputation": 37, "user_id": 9091498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34547d6bbe468f30431177bd5e75365b?s=128&d=identicon&r=PG&f=1", "display_name": "user9091498", "link": "https://stackoverflow.com/users/9091498/user9091498"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513801127, "post_id": 47913555, "comment_id": 82795236, "body": "not sure why i cant post the function.. there is a characters limit or something.. i would prefer to avoid bad comments @VladfromMoscow :)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513801350, "post_id": 47913555, "comment_id": 82795323, "body": "@user9091498 Why does the function use global variables?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1513803112, "post_id": 47913555, "comment_id": 82796198, "body": "@user9091498 I think your question should be closed because it is unclear how the function is declared and defined. For example it is unclear whether the variable head is a global variable or a function parameter and so on."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 0, "last_activity_date": 1513804729, "last_edit_date": 1513804729, "creation_date": 1513801482, "answer_id": 47913866, "question_id": 47913555, "link": "https://stackoverflow.com/questions/47913555/deleting-node-from-linked-list-doesnt-work-properly/47913866#47913866", "title": "Deleting node from linked list doesn&#39;t work properly", "body": "<p>Well there are places in your code which may lead to accessing NULL value leading in to invoking Undefined Behavior.</p>\n\n<pre><code>node = head;\ntemp = head;\nif( head == NULL){\n    fprintf(stderr,\"List is empty\");\n    exit(1);\n}\nif(record == 1){\n\n    head=head-&gt;next;\n    printf(\"\\nInside if count %d node %s head %s\",count, node-&gt;name, head-&gt;name);\n    free(node);\n}\nelse if (record &gt; 1){\n    for(size_t i = 1; i &lt; record &amp;&amp; temp != NULL; i++){\n       node = temp;\n       temp = temp -&gt; next;\n    }\n    if( temp )\n        node-&gt;next = temp-&gt;next;\n    free( temp );\n}\n</code></pre>\n\n<p>For writing methods like this, try to use the pointers. Here global variables are not required. Earlier your code had some redundant assignment statements which was not doing anything meaningful.</p>\n\n<p>A full example would be something like</p>\n\n<pre><code>struct Node* deleteNth (struct Node *head, int N){\n    struct Node *t ;\n    if(head == NULL){\n        fprintf(stderr, \"%s\\n\", \"List is empty\");\n        exit(1);\n    }\n    if( N &lt;= 0){\n        fprintf(stderr, \"%s\\n\", \"Position given wrong\");\n        exit(1);\n    }\n    if( N == 1){\n        t = head;\n        head = head-&gt;next;\n        free(t);\n        return head;\n    }\n\n    struct Node *p = t;\n    int i;\n\n    for(i = 1; i &lt; N &amp;&amp; t!=NULL; i++){\n        p = t;\n        t = t-&gt;next;\n    }\n    if( t == NULL ){\n        fprintf(stderr,\"%s\\n\",\"Insuffiecient Number of elements\" );\n        exit(1);\n    }\n    if( t!= NULL ){\n        p-&gt;next = t-&gt;next;\n    }\n    free(t);\n    return head;\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9091498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34547d6bbe468f30431177bd5e75365b?s=128&d=identicon&r=PG&f=1", "display_name": "user9091498", "link": "https://stackoverflow.com/users/9091498/user9091498"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 47913866, "answer_count": 1, "score": -1, "last_activity_date": 1513804729, "creation_date": 1513800068, "last_edit_date": 1513800513, "question_id": 47913555, "link": "https://stackoverflow.com/questions/47913555/deleting-node-from-linked-list-doesnt-work-properly", "title": "Deleting node from linked list doesn&#39;t work properly", "body": "<p>I have one problem while trying to delete a node from a linked list in C.\nI totally have no idea where i am missing this, but somehow, wrong nodes are deleted than the expected ones, also the last one is gone and when i do free() it is actually not working, it still keeps and prints some data. \nCan anyone please help me?\nHere is my code:</p>\n\n<pre><code>node=head;\ntemp=node-&gt;next;\n\nif(record == 1){\n    head=head-&gt;next;\n    printf(\"\\nInside if count %d node %s head %s\",count, node-&gt;name, head-&gt;name);\n    free(node);\n}\nelse if (record &gt; 1){\n    while(count &lt; record-1 &amp;&amp; count &lt; list_size){\n        printf(\"\\nInside while count %d node %s head %s\",count, node-&gt;name, head-&gt;name);\n        node = temp;\n        temp = temp-&gt;next;\n        node-&gt;next = temp-&gt;next;\n        count++;\n    }\n    printf(\"\\nOutside while temp %s node %s head %s\",temp-&gt;name,node-&gt;name,head-&gt;name);\n    free(temp);\n}\n</code></pre>\n"}, {"tags": ["c", "compiler-errors", "arm", "visual-studio-2017", "intrinsics"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1513800560, "post_id": 47913488, "comment_id": 82794969, "body": "Maybe post some of the error messages?"}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1513801395, "post_id": 47913488, "comment_id": 82795355, "body": "Sure. I hope it will help."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513802943, "post_id": 47913488, "comment_id": 82796128, "body": "&quot;...by Visual C++ compiler&quot; Why the C tag and not a C++ tag?"}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513803352, "post_id": 47913488, "comment_id": 82796298, "body": "It&#39;s in fact C code. I tried to add C++ tag too but there is a limit of 5 tags only..."}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513803616, "post_id": 47913488, "comment_id": 82796430, "body": "Changing the extension of source file from .cpp to .c there errors are different."}], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513834983, "post_id": 47914367, "comment_id": 82804960, "body": "Well, in RealView Run-Time Library &#39;s RTL.h is this declaration: extern void     *_alloc_box (void *box_mem) __swi (1); and the ARM compiler is able to recognize it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513838113, "post_id": 47914367, "comment_id": 82806001, "body": "@Flaviu: Does Visual Studio for ARM compile that?  It certainly looks like the two compilers have different language extensions that are not compatible, but both happen to use the same <code>__swi</code> name."}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513839518, "post_id": 47914367, "comment_id": 82806577, "body": "Sorry, it&#39;s about ARM compiler of ARM company."}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513839597, "post_id": 47914367, "comment_id": 82806612, "body": "Well, in RealView Run-Time Library &#39;s RTL.h is this declaration: extern void *_alloc_box (void *box_mem) __swi (1); and the ARM compiler of ARM company is able to recognize it."}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513840070, "post_id": 47914367, "comment_id": 82806820, "body": "It looks like it&#39;s &quot;you have to buy &amp; use only our tool&quot; due language extensions :)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513866559, "post_id": 47914367, "comment_id": 82822062, "body": "Those language extensions are not essential.  You could write stuff in asm directly, or at least wrapper functions to dispatch to system calls.  IIRC, the GNU compiler might have an <code>__attribute__</code> to let you write an interrupt-handler, so you could still write interrupt handlers in pure C.  You&#39;d have to set up the interrupt table yourself, though."}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513958675, "post_id": 47914367, "comment_id": 82858191, "body": "I just want to edit and compile using VS 2017 existing code that is successfully compiled by Keil ARM compiler."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513958847, "post_id": 47914367, "comment_id": 82858256, "body": "@Flaviu: Well from the docs you linked, they both have <code>__swi</code>, but it has a very different meaning in the two language extensions.  So it doesn&#39;t appear to be possible to do what you want, unless you can set up VS2017 to use ARM&#39;s compiler instead of the MS compiler that comes with that IDE.  This is the price of using language extensions that are only provided by a single compiler, especially a non-free compiler, assuming that&#39;s really the case."}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513959002, "post_id": 47914367, "comment_id": 82858317, "body": "I think this is the answer."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513959058, "post_id": 47914367, "comment_id": 82858340, "body": "@Flaviu: That&#39;s pretty much what the answer I posted already says: <code>__swi()</code> in MSVC doesn&#39;t work the way your source uses it.  Or did you mean using ARM&#39;s compiler as a back-end for VS&#39;s front end?"}, {"owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513959555, "post_id": 47914367, "comment_id": 82858552, "body": "For posterity I would like a clean answer (isn&#39;t possible to create a new answer?). I expected that ARM compiler of VS is be able to compile code compiled by ARM compiler of Keil. Using ARM compiler of Keil is a possible workaround."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "edited": false, "score": 0, "creation_date": 1513960490, "post_id": 47914367, "comment_id": 82858927, "body": "@Flaviu: That&#39;s fair, when I wrote the answer I&#39;d only looked at the MS doc, so I didn&#39;t make a very definite statement about the big picture.  Updated the answer."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1513960431, "last_edit_date": 1513960431, "creation_date": 1513804108, "answer_id": 47914367, "question_id": 47913488, "link": "https://stackoverflow.com/questions/47913488/recognizing-arm-software-interrupt-swi-functions-by-visual-c-compiler/47914367#47914367", "title": "Recognizing ARM Software Interrupt (SWI) functions by Visual C++ compiler", "body": "<p>From the docs you linked, both compilers have an <code>__swi</code> keyword or intrinsic, but it has a very different meaning in the two language extensions.  So it doesn't appear to be possible to do what you want, unless you can set up VS2017 to use ARM's compiler instead of the MS compiler that comes with that IDE.</p>\n\n<p>This is the price of using language extensions that are only provided by a single compiler, especially a non-free compiler, assuming that's really the case.</p>\n\n<hr>\n\n<p><strong>The details</strong>:</p>\n\n<p>According to the MS doc you linked, <code>__swi()</code> is an intrinsic for the SVC instruction, for generating software interrupts, not for writing handlers for them.</p>\n\n<p><code>__swi</code> not an attribute you can use as part of declaring another function, it's a function of its own, with prototype <code>unsigned int __swi(unsigned int, ...)</code>.  You can use it from inside another function to make a system call like this:</p>\n\n<pre><code>int swi1(int a) {\n    return __swi(1, a);    // I didn't check any system-call lists to find out what args actually make sense\n}\n</code></pre>\n\n<hr>\n\n<p><code>void __swi(1) test1();</code> is the same kind of syntax error as<br>\n<code>void sqrt(2.0) test1();</code>.  Similarly <code>__swi_2</code> is just another unrecognized identifier.</p>\n\n<p>Whatever you were trying to do, <code>__swi()</code> is not the right way in Visual Studio.</p>\n\n<hr>\n\n<p>In ARM's compiler, <code>__swi(8)</code> is a function attribute meaning that callers should invoke it with <code>swi 8</code> instead of <code>BL function_name</code> (the normal call instruction).  It apparently also sets up the interrupt table to point to the functions defined with that attribute.</p>\n\n<p>This is a totally different meaning and language-syntax usage from how MSVC defines it.</p>\n"}], "owner": {"reputation": 679, "user_id": 1586617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tohl3.jpg?s=128&g=1", "display_name": "Flaviu", "link": "https://stackoverflow.com/users/1586617/flaviu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 47914367, "answer_count": 1, "score": 3, "last_activity_date": 1513960431, "creation_date": 1513799777, "last_edit_date": 1513801354, "question_id": 47913488, "link": "https://stackoverflow.com/questions/47913488/recognizing-arm-software-interrupt-swi-functions-by-visual-c-compiler", "title": "Recognizing ARM Software Interrupt (SWI) functions by Visual C++ compiler", "body": "<p>Because I prefer Visual Studio editor instead of Keil and IAR editors, I tried to compile ARM based projects using VS 2017. A project includes RTL.h header of RealView Run-Time Library which declares <a href=\"http://www.keil.com/support/man/docs/rlarm/rlarm_ar_swi_func.htm\" rel=\"nofollow noreferrer\">Software Interrupt (SWI) functions</a>. As I understand <a href=\"https://docs.microsoft.com/en-us/cpp/intrinsics/arm-intrinsics\" rel=\"nofollow noreferrer\">Visual C++ compiler supports SWI intrinsic function</a> but I'm getting compile errors.</p>\n\n<p>Also I tried this in a main-only application compiling using default compiler and Clang compiler too - both of Visual Studio:</p>\n\n<pre><code>1: void __swi(1) test1();\n2: void __swi_2 test2();\n3: \n4: void test3() __swi(3);\n5: void test4() __swi_4;\n6:\n7: __swi(5) test5();\n8: __swi_6 void test6();\n</code></pre>\n\n<p>The errors generated by default Visual C++ compiler are:</p>\n\n<ul>\n<li><p>Line 1</p>\n\n<ul>\n<li>Error    C2182   '__swi': illegal use of type 'void'</li>\n<li>Error    C2146   syntax error: missing ';' before identifier 'test1'</li>\n<li>Error    C4430   missing type specifier - int assumed. Note: C++ does not support default-int</li>\n</ul></li>\n<li><p>Line 2</p>\n\n<ul>\n<li>Error    C2182   '__swi_2': illegal use of type 'void'</li>\n<li>Error    C2146   syntax error: missing ';' before identifier 'test2'</li>\n<li>Error    C4430   missing type specifier - int assumed. Note: C++ does not support default-int</li>\n</ul></li>\n<li><p>Line 4</p>\n\n<ul>\n<li>Error    C3646   '__swi': unknown override specifier</li>\n<li>Error    C2059   syntax error: '('</li>\n</ul></li>\n<li><p>Line 5</p>\n\n<ul>\n<li>Error    C3646   '__swi_4': unknown override specifier</li>\n</ul></li>\n<li><p>Line 7</p>\n\n<ul>\n<li>Error    C4430   missing type specifier - int assumed. Note: C++ does not support default-int</li>\n<li>Error    C2374   '__swi': redefinition; multiple initialization</li>\n<li>Error    C2146   syntax error: missing ';' before identifier 'test5'</li>\n</ul></li>\n<li><p>Line 8</p>\n\n<ul>\n<li>Error    C2144   syntax error: 'void' should be preceded by ';'</li>\n<li>Error    C4430   missing type specifier - int assumed. Note: C++ does not support default-int</li>\n</ul></li>\n</ul>\n\n<p>Is Visual C++ compiler capable to recognize these declarations? If yes, what should be changed?</p>\n"}, {"tags": ["c", "debugging", "segmentation-fault"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513799893, "post_id": 47913455, "comment_id": 82794668, "body": "If you step through the code line by line with a debugger your problem should become obvious. Hint: What is the value of <code>i</code> in the very first call to <code>realloc</code>? And what is then the result of <code>i+1</code>?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513800030, "post_id": 47913455, "comment_id": 82794734, "body": "@GCGSAUCE  What printf statement do you mean?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1513800041, "post_id": 47913455, "comment_id": 82794741, "body": "Furthermore, if you expect to treat the memory you allocate as a <b><i>null-terminated</b> byte string</i>, then you&#39;re forgetting one very important thing."}, {"owner": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513800882, "post_id": 47913455, "comment_id": 82795130, "body": "@VladfromMoscow there are only 2 printf statements in the code, its in reference to that."}, {"owner": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513801062, "post_id": 47913455, "comment_id": 82795208, "body": "@Someprogrammerdude Im really not sure if i am treating it as null-terminated, could u give me a bigger clue as to what you mean?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1513801647, "post_id": 47913455, "comment_id": 82795477, "body": "Consider giving some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. In its current form, your code is not one, we don&#39;t know what <code>TB</code> is, and we should not even try to guess."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513802271, "post_id": 47913455, "comment_id": 82795798, "body": "The pointer that you return, will you pass it to <code>strlen</code>? Will you do e.g. <code>printf(&quot;%s&quot;, returned_pointer)</code>? Will you treat it as a <i>string</i>? Then it needs to be <i>terminated</i> by a zero (the &quot;null&quot;). <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">Any good beginners book</a> should have told you that!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "edited": false, "score": 0, "creation_date": 1513801375, "post_id": 47913740, "comment_id": 82795343, "body": "I know it&#39;s ugly but I didn&#39;t want to have to free any unused bytes so I thought this might be simpler since it&#39;s dynamic. I edited my question to include revised code, is this what you guys mean by fixing the undefined behavior?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "edited": false, "score": 1, "creation_date": 1513801405, "post_id": 47913740, "comment_id": 82795362, "body": "It is not simpler, and it is inefficient. And your code is wrong."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "edited": false, "score": 0, "creation_date": 1513801757, "post_id": 47913740, "comment_id": 82795535, "body": "Also, UB has a well defined meaning (follow the links I gave in my answer above)."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1513810830, "post_id": 47913740, "comment_id": 82799174, "body": "Yes, the constant reallocing is a habit you should break out of quickly before it becomes too ingrained."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1513801490, "last_edit_date": 1513801490, "creation_date": 1513800920, "answer_id": 47913740, "question_id": 47913455, "link": "https://stackoverflow.com/questions/47913455/strange-seg-fault-likely-with-realloc/47913740#47913740", "title": "strange seg fault, likely with realloc", "body": "<p>You probably want <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">getline(3)</a>, so <a href=\"https://stackoverflow.com/a/9171511/841108\">use</a> it if you have it. As explained by <a href=\"https://stackoverflow.com/a/47913637/841108\">AnT's answer</a>, you have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> (UB) because of a <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\" rel=\"nofollow noreferrer\">buffer overflow</a>. Fix that as soon as possible. Be very <a href=\"https://stackoverflow.com/a/25636788/841108\">scared</a> of UB and take more time to read about it (it is tricky).</p>\n\n<p>Also, remember that both <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">malloc(3)</a> and <a href=\"http://man7.org/linux/man-pages/man3/realloc.3.html\" rel=\"nofollow noreferrer\">realloc(3)</a> are somehow expensive calls (for some suitable notion of expensive; actually, they are quite fast - often less than a microsecond on a desktop for reasonable use), and they could fail (by giving <code>NULL</code>) and you should <a href=\"https://stackoverflow.com/a/32716494/841108\">check</a> that.</p>\n\n<p>In practice, you'll better use <code>realloc</code> less often. As a rule of thumb, you want to keep both the used length and the allocated size somewhere (e.g. in additional local variables), and you might use some geometrical progression (e.g.  <code>newsize = 4*oldsize/3 + 10</code>....) to avoid too frequent <code>realloc</code>-s. Doing a <code>realloc</code> for each additional byte is ugly. </p>\n\n<p>Compile your code with all warnings and debug info, e.g. <code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>. Improve the code to get no warnings. <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">Use the debugger</a> <code>gdb</code>  and <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a> to hunt <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow noreferrer\">memory leaks</a> and other trouble.</p>\n"}], "owner": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 47913740, "answer_count": 1, "score": -2, "last_activity_date": 1513801490, "creation_date": 1513799637, "last_edit_date": 1513801169, "question_id": 47913455, "link": "https://stackoverflow.com/questions/47913455/strange-seg-fault-likely-with-realloc", "title": "strange seg fault, likely with realloc", "body": "<pre><code>char *dumpTB (TB tb){\n\n    char* text = malloc(sizeof(char));\n\n    int i = 0; // \n    int x = 0; //string index\n\n    tNode* curr = tb-&gt;head;\n\n    while(curr != NULL){\n\n        while(curr-&gt;line[x] != '\\n'){\n            printf(\"%d\", i);\n            text[i] = curr-&gt;line[x];\n            printf(\"%c\\n\", text[i]);\n\n            text = realloc(text, i+1);\n\n            i++;\n            x++;\n        }\n        text[i] = '\\n';\n        printf(\"%c\", text[i]);\n        text = realloc(text, i+1); \n        i++;\n\n        x = 0; \n        curr = curr-&gt;next; \n    }\n\n    return text;\n}\n</code></pre>\n\n<p>So I manage to print out the first 12 letters of my string using the print statements but for some reason it gives me a seg fault shortly after printing the 12th letter 'l', and based on the print statements it seems to occur around the realloc...can anyone tell me what I did wrong?</p>\n\n<pre><code>int i = 1; // \n    int x = 0; //string index\n\n    tNode* curr = tb-&gt;head;\n\n    while(curr != NULL){\n\n        while(curr-&gt;line[x] != '\\n'){\n            printf(\"%d\", i-1);\n            text[i-1] = curr-&gt;line[x];\n            printf(\"%c\\n\", text[i-1]);\n\n            text = realloc(text, i+1);\n            i++;\n            x++;\n        }\n        printf(\"%d\\n\", i-1);\n        text[i-1] = '\\n';\n        printf(\"%c\", text[i-1]);\n        text = realloc(text, i+1); \n        i++;\n\n        x = 0; \n        curr = curr-&gt;next; \n        //printf(\"%c\\n\", curr-&gt;line[0]);\n    }\n</code></pre>\n\n<p>I tried fixed the index errors, a really long looking sysmalloc assertion thing which aborts the program.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1513798767, "post_id": 47913169, "comment_id": 82794184, "body": "Just use <code>data.data9bit = 1</code> or similar - take a look at <a href=\"https://www.tutorialspoint.com/cprogramming/c_unions.htm\" rel=\"nofollow noreferrer\">a tutorial like this</a>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1513798842, "post_id": 47913169, "comment_id": 82794219, "body": "The code <i>calling</i> <code>SendData</code> that you have thus far is relevant to this question, and appears to be its foundation. But that&#39;s just a guess, as your question isn&#39;t entirely clear. Assuming you have some variable <code>d</code> of type <code>EXAMPLE_DATA</code> being sent to <code>SendData(d)</code>, then <code>d.data9bit = 257u;</code>, for example, would set the proper member."}, {"owner": {"reputation": 47, "user_id": 7162999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394b293bcb903c6c6d2d620544845edd?s=128&d=identicon&r=PG&f=1", "display_name": "svemiracBago", "link": "https://stackoverflow.com/users/7162999/svemiracbago"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1513798986, "post_id": 47913169, "comment_id": 82794284, "body": "@WhozCraig That was what I was looking for! I really went head over heels about this one and it looks that I should have known that. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1513798682, "creation_date": 1513798682, "answer_id": 47913243, "question_id": 47913169, "link": "https://stackoverflow.com/questions/47913169/trouble-understanding-structs-in-unions/47913243#47913243", "title": "Trouble understanding structs in unions", "body": "<p>The type <code>EXAMPLE_TYPE</code> will always be 2 bytes (i.e. 16 bits) in size because only complete bytes can be stored and addressed.</p>\n\n<p>You're free to <em>interpret</em> the value as a 9-bit value, but the size will always be a whole number of bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 4, "last_activity_date": 1513799800, "creation_date": 1513799800, "answer_id": 47913492, "question_id": 47913169, "link": "https://stackoverflow.com/questions/47913169/trouble-understanding-structs-in-unions/47913492#47913492", "title": "Trouble understanding structs in unions", "body": "<p>This is complicated by the fact that two of your union's members are <em>anonymous</em> structures, but the fact remains that, in principle, an object of type <code>EXAMPLE_DATA</code> contains a value for only one member -- the last one written to -- at any given time.  That member is perforce either <code>__data</code> or one of the two anonymous structures.</p>\n\n<p>The structures serve merely as containers for bitfields, one each, and because they are anonymous, their members can be accessed inside the union via the syntax for accessing a member of type <code>EXAMPLE_DATA</code> itself.  Thus, if you want the member that an <code>EXAMPLE_DATA</code> currently contains to be the <code>data9bit</code> of the corresponding structure, then you might do this:</p>\n\n<pre><code>EXAMPLE_DATA data;\n\ndata.data9bit = 256;\n</code></pre>\n\n<p>Do note that,</p>\n\n<ul>\n<li>the anonymous structures may have representations larger than 16 bits</li>\n<li>the location of the relevant bits of each bitfield within the representation of their structures is largely at the discretion of the implementation, and in particular, it is not necessarily within the first 16 bits (where they would overlap the representation of <code>__data</code>)</li>\n<li>your union provides no built-in mechanism by which one can determine which member currently contains a value, so users need either to assume or to have such information conveyed to them separately.</li>\n</ul>\n"}], "owner": {"reputation": 47, "user_id": 7162999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394b293bcb903c6c6d2d620544845edd?s=128&d=identicon&r=PG&f=1", "display_name": "svemiracBago", "link": "https://stackoverflow.com/users/7162999/svemiracbago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 47913492, "answer_count": 2, "score": 2, "last_activity_date": 1513799800, "creation_date": 1513798372, "last_edit_date": 1513799070, "question_id": 47913169, "link": "https://stackoverflow.com/questions/47913169/trouble-understanding-structs-in-unions", "title": "Trouble understanding structs in unions", "body": "<p>I'm not a novice C player, nor am I an expert in that matter. So here's my problem.\nI have a union declared as this:</p>\n\n<pre><code>typedef union\n{\n    // 8-bit data\n    struct\n    {\n        UINT16 data8bit : 8;\n    };\n\n    // 9-bit data\n    struct\n    {\n        UINT16 data9bit : 9;\n    };\n\n    UINT16 __data;\n} EXAMPLE_DATA;\n</code></pre>\n\n<p>And there is a function that goes like this:</p>\n\n<pre><code>SendData(EXAMPLE_DATA data)\n{  \n    //.....\n}\n</code></pre>\n\n<p>Now here's my quesiton.\nI would like to make an object of <code>EXAMPLE_DATA</code> so that when it is passed to the <code>SendData</code> function, that my data would be of <code>data9bit</code> type.</p>\n\n<p>I'm really confused and I honestly don't know the answer.\nThanks.</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1513797225, "post_id": 47912874, "comment_id": 82793469, "body": "you&#39;ll have to be more specific.  &quot;it&#39;s not working&quot; is not very helpful for debugging."}, {"owner": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1513797723, "post_id": 47912874, "comment_id": 82793697, "body": "When I wort that it doesn&#39;t work i mean that the printf doesn&#39;t print, i know that i can use flush but I want to understand why it&#39;s not printing."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1513797911, "post_id": 47912874, "comment_id": 82793785, "body": "It doesn&#39;t print because stdout is buffered."}, {"owner": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1513798217, "post_id": 47912874, "comment_id": 82793947, "body": "I know that the buffer it what makes the function not to work but way?? why it&#39;s not printing garbage or wrong data, why its not printing at all"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1513798306, "post_id": 47912874, "comment_id": 82793996, "body": "You would have been exposed the same problem had you eliminated code, including the threads, the functions, and used a single endless loop with a one-shot <code>printf</code> like what you have, with no trailing newline. as has been stated once here, and once in Basile&#39;s answers, Your code works, just not as you expected."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1513798357, "post_id": 47912874, "comment_id": 82794020, "body": "Output appears when you print a newline, or when the internal buffer is full. You don&#39;t print any newlines at all; you&#39;ve no idea when the data will appear.  Each call to <code>printf()</code> is thread-safe -- the function must behave as if it locks <code>stdout</code> with <code>flockfile()</code> on entry and unlocks it with <code>funlockfile()</code> on exit. While it has the file locked, no other thread can use <code>stdout</code>. However, the operations of the two threads can be interleaved arbitrarily. Also, since <code>i</code> and <code>j</code> are not unsigned variables, you have undefined behaviour on overflow. On your system, it probably continues, but..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1513798562, "post_id": 47912874, "comment_id": 82794099, "body": "Also, any output that remains in the buffer at normal program termination would appear then, but this program never terminates."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513798890, "post_id": 47912874, "comment_id": 82794243, "body": "Your threads only print once per 4 billion increments (loop iterations), roughly.  Assuming 1 nanosecond per loop, that means that roughly once every 4 seconds.  Your buffer size might be 4 KiB or 8 KiB (or bigger), and each output is 7 bytes, so it might take 500+ cycles before the buffer is full enough to be flushed, or 2000 seconds, or more than half an hour.  Were you just too impatient?  (You can see how fast the counters appear by adding a newline to the output.  Was I about right, or wildly optimistic?)"}, {"owner": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513799224, "post_id": 47912874, "comment_id": 82794392, "body": "thx @JonathanLeffler it&#39;s not that I impatient but its a question that I been asked why this cond well not print the buffer."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513799392, "post_id": 47912874, "comment_id": 82794469, "body": "OTOH, when I try an optimized, unthreaded version of the code (GCC 7.2.0), the compiler simply iterates on the <code>printf()</code> call, eliminating the increment of <code>i</code>.  At least, with an <code>unsigned</code> variable for the counter (avoiding UB).  Beware modern optimizers; they&#39;re very good."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1513799567, "post_id": 47912874, "comment_id": 82794541, "body": "@yaodav: You&#39;ve been told by multiple people why the output doesn&#39;t appear when you think it should; the output is buffered -- probably line buffered, but since you don&#39;t print any newlines, that&#39;s moot.  If you print newlines, the output appears.  You said that.  That shows &#39;line buffering&#39; at work.  Newlines trigger a flush.  There&#39;s nothing anybody can usefully say more.  I suppose you could use <code>setvbuf()</code> to make standard output unbuffered.  That&#39;d be your decision to make.  By default, it will be (at least) line buffered, and that&#39;s what you&#39;re seeing."}], "answers": [{"comments": [{"owner": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "edited": false, "score": 0, "creation_date": 1513797963, "post_id": 47912936, "comment_id": 82793811, "body": "tnx, but I know how to make it work but I want to know why the code that I wrote doesn&#39;t work."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "edited": false, "score": 1, "creation_date": 1513798002, "post_id": 47912936, "comment_id": 82793834, "body": "Your code &quot;works&quot; but not as you expected. And the reason is the buffering."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 3, "last_activity_date": 1513800312, "last_edit_date": 1513800312, "creation_date": 1513797273, "answer_id": 47912936, "question_id": 47912874, "link": "https://stackoverflow.com/questions/47912874/printf-function-on-multi-thread-program/47912936#47912936", "title": "printf function on multi thread program", "body": "<p><a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">printf</a> is somehow thread safe<sup>*</sup> (see discussion in <a href=\"http://man7.org/linux/man-pages/man3/unlocked_stdio.3.html\" rel=\"nofollow noreferrer\">unlocked_stdio(3)</a>..., and consider <a href=\"http://man7.org/linux/man-pages/man3/flockfile.3.html\" rel=\"nofollow noreferrer\">flockfile(3)</a>) but stdio is buffered, and you should call <a href=\"http://man7.org/linux/man-pages/man3/fflush.3.html\" rel=\"nofollow noreferrer\">fflush(3)</a> in your routines.</p>\n\n<p><sup>(<code>printf</code> is perhaps thread safe because two concurrent <code>printf</code> might not intermix their output, but nothing is told about flushing buffers)</sup></p>\n\n<p>So code instead</p>\n\n<pre><code>    if(i==1000) {\n        printf(\"i: %d\",i);\n        fflush(stdout);\n    }\n</code></pre>\n\n<p><sup>(then you'll see some output)</sup></p>\n\n<p>BTW, I recommend ending most of your <code>printf</code> format control strings with a newline <code>\\n</code>.... You could also add some delay by doing some <a href=\"http://man7.org/linux/man-pages/man2/nanosleep.2.html\" rel=\"nofollow noreferrer\">nanosleep(2)</a> or <a href=\"http://man7.org/linux/man-pages/man3/usleep.3.html\" rel=\"nofollow noreferrer\">usleep(3)</a> in your <code>runi</code> &amp; <code>runj</code> routines.</p>\n\n<p>It is the <a href=\"https://en.wikipedia.org/wiki/Data_buffer\" rel=\"nofollow noreferrer\">buffering</a> which explains that you are disappointed. And <code>stdout</code> should be buffered for efficiency reasons (see <a href=\"http://man7.org/linux/man-pages/man3/setvbuf.3.html\" rel=\"nofollow noreferrer\">setvbuf(3)</a>...). Be aware that system calls (listed in <a href=\"http://man7.org/linux/man-pages/man2/syscalls.2.html\" rel=\"nofollow noreferrer\">syscalls(2)</a> for Linux) such as <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\">write(2)</a> are quite expensive operations. On Linux use <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">strace(1)</a> to understand what system calls are done.</p>\n\n<p>If you want to understand the implementation of <code>printf</code> on Linux, study the source code of your C standard library - which is <a href=\"https://en.wikipedia.org/wiki/Free_software\" rel=\"nofollow noreferrer\">free software</a>. It probably is GNU <a href=\"https://www.gnu.org/software/libc/\" rel=\"nofollow noreferrer\">glibc</a>, but could be something else like <a href=\"http://musl-libc.org/\" rel=\"nofollow noreferrer\">musl-libc</a>, etc.</p>\n\n<p>BTW, your threads are never ending (since <code>runi</code>  and <code>runj</code> never return), and you <code>pthread_join</code> them. That call is blocking indefinitely. Use <a href=\"http://man7.org/linux/man-pages/man1/ltrace.1.html\" rel=\"nofollow noreferrer\">ltrace(1)</a> to observe that.</p>\n\n<p>You could also consider adding some <code>sleep(2); fflush(stdout);</code> in your <code>main</code>  before the first <code>pthread_join</code>; you'll then observe some output.</p>\n\n<p>At last, for such experiments,  I recommend some periodic printing. Replace the <code>i==1000</code> condition by <code>i%10000 == 0</code> ....</p>\n\n<p>You never explicitly flush your <code>stdout</code>  so its gets flushed when its buffer (perhaps 8Kbytes) is full, or at end of your <code>main</code> (which is <em>not</em> reached in your case). <a href=\"https://stackoverflow.com/users/15168/jonathan-leffler\">Jonathan Leffler</a> cleverly commented that you might need to wait an hour for that (buffer full condition) to happen.</p>\n\n<p>Beware of <a href=\"https://en.wikipedia.org/wiki/Race_condition\" rel=\"nofollow noreferrer\">race conditions</a> and of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n"}], "owner": {"reputation": 932, "user_id": 6345323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6dbbb0c750be6073b0d251899c74a47?s=128&d=identicon&r=PG&f=1", "display_name": "yaodav", "link": "https://stackoverflow.com/users/6345323/yaodav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1530, "favorite_count": 0, "accepted_answer_id": 47912936, "answer_count": 1, "score": -2, "last_activity_date": 1513800312, "creation_date": 1513797027, "question_id": 47912874, "link": "https://stackoverflow.com/questions/47912874/printf-function-on-multi-thread-program", "title": "printf function on multi thread program", "body": "<p>hi I'm writing a simple program in c, the program has two threads and two global's var, but the printf function not working, I know that printf is not thread safe and also if I well add \\n in the print it will work, but I wont to understand why it's not working without that? \nI'm adding the code,</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\nint i;\nint j;\n\nvoid* runi(void* _temp)\n{\n    while(1)\n    {\n        i++;\n        if(i==1000)\n        {\n            printf(\"i: %d\",i);\n        }\n    }\n    return NULL;\n}\n\nvoid* runj(void* _temp)\n{\n    while(1)\n    {\n        j++;\n        if(j==1000)\n        {\n            printf(\"j: %d\",j);\n        }\n    }\n    return NULL;\n}\nmain ()\n{\n    pthread_t threadI,threadJ;\n    pthread_create(&amp;threadI,NULL,runi,NULL);\n    pthread_create(&amp;threadJ,NULL,runj,NULL);\n    pthread_join(threadI,NULL);\n    pthread_join(threadJ,NULL);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1513797071, "post_id": 47912855, "comment_id": 82793386, "body": "Note that <code>*d++ = *s2++</code> is very different from <code>*d++ == *s2++</code>. Here, you&#39;re overwriting the values in <code>*d</code> with values from <code>*s2</code>, until you reach the null terminator in <code>s2</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1513797164, "post_id": 47912855, "comment_id": 82793432, "body": "The condition here is that the <code>*s2</code> is other than zero (string null-terminator)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 1, "creation_date": 1513797229, "post_id": 47912855, "comment_id": 82793472, "body": "See <a href=\"https://stackoverflow.com/a/20957532/2201041\">this answer</a> for a breakdown of a similar thing."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8400459, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbd652547bdaf0c29f3e9064e70d08c1?s=128&d=identicon&r=PG&f=1", "display_name": "hello world", "link": "https://stackoverflow.com/users/8400459/hello-world"}, "edited": false, "score": 0, "creation_date": 1513805751, "post_id": 47913104, "comment_id": 82797364, "body": "Thank you!! Is changing <code>*d</code> changing <code>s1</code> so that when you return <code>s1</code>, you have copied s2 to s1?"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "reply_to_user": {"reputation": 75, "user_id": 8400459, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbd652547bdaf0c29f3e9064e70d08c1?s=128&d=identicon&r=PG&f=1", "display_name": "hello world", "link": "https://stackoverflow.com/users/8400459/hello-world"}, "edited": false, "score": 0, "creation_date": 1513807939, "post_id": 47913104, "comment_id": 82798234, "body": "@helloworld: You have copied the character string to which <code>s2</code> points into the buffer to which <code>s1</code> points."}], "tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": true, "score": 2, "last_activity_date": 1513798066, "creation_date": 1513798066, "answer_id": 47913104, "question_id": 47912855, "link": "https://stackoverflow.com/questions/47912855/c-trouble-understanding-pointers-in-the-while-loop-of-this-code/47913104#47913104", "title": "C: Trouble understanding pointers in the while loop of this code", "body": "<p>This is a rather typical didactic implementation of <code>strcpy()</code>. It works like this:</p>\n\n<ul>\n<li><p><code>my_strcpy()</code> takes two arguments. The first argument is a pointer to the first element of a destination character array. The second argument is a pointer to the first element of a source character string, that is, a character array terminated by a <code>NUL</code> (aka <code>\\0</code>) character. The function copies the characters from the source string to the destination buffer, including the <code>NUL</code> terminator, and returns a pointer to the first element of the destination buffer.</p>\n\n<pre><code>char *my_strcpy(char *s1, const char *s2) {\n</code></pre></li>\n<li><p>First things first, make a copy of the first argument, because we need to return it after the copying is done.</p>\n\n<pre><code>char *d = s1;\n</code></pre></li>\n<li><p>Then, copy the characters; this is done in a tight loop, working like this:</p>\n\n<ul>\n<li>Copy the current character <code>* s2</code> to the place pointed to by <code>d</code>, as if executing <code>* d = * s2</code>; then</li>\n<li>Increment <code>d</code> to point to the next place in the destination buffer as if executing <code>d++</code> and increment <code>s2</code> to point to the next character to be copied as if executing <code>s2++</code>; and</li>\n<li>Exit the loop if the last character which was copied was <code>NUL</code>.</li>\n</ul>\n\n<p>This is written in a very concise manner:</p>\n\n<pre><code>while (* d++ = * s2++);\n</code></pre>\n\n<p><code>* s2++</code> means \"take the character pointed to by <code>s2</code> then increment <code>s2</code>\". Similarily, <code>* d++</code> as a left-hand value means \"use the variable pointed to by <code>d</code> then increment <code>d</code>\". The order of precedence of operators helps dispense with parentheses because <code>++</code> has higher priority than <code>*</code> which has higher priority than <code>=</code>. The value of the assignment is the assigned value, so the loop ends when the assigned character has the value 0.</p></li>\n<li><p>Finally, return <code>s1</code>, which was not changed by the function.</p>\n\n<pre><code>return s1;\n}\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 75, "user_id": 8400459, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbd652547bdaf0c29f3e9064e70d08c1?s=128&d=identicon&r=PG&f=1", "display_name": "hello world", "link": "https://stackoverflow.com/users/8400459/hello-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 47913104, "answer_count": 1, "score": 3, "last_activity_date": 1513798066, "creation_date": 1513796947, "question_id": 47912855, "link": "https://stackoverflow.com/questions/47912855/c-trouble-understanding-pointers-in-the-while-loop-of-this-code", "title": "C: Trouble understanding pointers in the while loop of this code", "body": "<p>I'm using a debugger to read through this code, and I'm a little confused by <code>while ((*d++ = *s2++));</code> - in the debugger variables, d seems to shorten after each loop (goes from <code>'Hello hello'</code> to <code>'ello hello'</code> while <code>s1</code> changes to <code>'cello hello'</code>). What is the while loop looping through (shouldn't it be <code>while(condition); do(something))</code>? </p>\n\n<p>Why aren't the variable values of d and s1 the same (isn't d is a pointer to s1)? And when they return to the main function, is <code>curdst</code> = the pointer of <code>dst</code>? </p>\n\n<pre><code>/*    \n  Input: char pointers for source (s2) and destination (s1)\n\n  Output: returns the pointer to the destination (s1)\n*/\n\nchar *my_strcpy(char * , const char * );\n\nint main()\n{\n\n  char src[] = \"cs23!\";\n  char dst[]=\"Hello hello\";\n  char *curdst;\n  int len=0;\n\n  while(src[len++]);\n\n  // do the copy\n\n  curdst= my_strcpy(dst, src);\n\n  // check to see if the NULL char is copied too.\n\n  printf(\"dst array %s and last element %d\\n\", dst, atoi(&amp;dst[len]));\n\n  return 0;\n\n}\n\nchar *my_strcpy(char *s1, const char *s2) {\n\n  register char *d = s1;\n\n  // print the pointer variables address and their contents, and first char\n\n  printf(\"s2 address %p, its contents is a pointer %p to first char %c \\n\", (void *)&amp;s2, (void *)s2, *s2);\n  printf(\"s1 address %p, its contents is a pointer %p to first char %c \\n\", (void *)&amp;s1, (void *)s1, *s1);\n\n  while ((*d++ = *s2++));\n  return(s1);\n\n}\n</code></pre>\n"}, {"tags": ["c", "bitwise-operators"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1513796554, "post_id": 47912738, "comment_id": 82793139, "body": "Because <code>%X</code> is for <code>unsigned int</code>. And no, <code>uint8_t</code> is not a 2-byte variable."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 2, "creation_date": 1513796804, "post_id": 47912738, "comment_id": 82793264, "body": "Look up &quot;integer promotions in C&quot; to learn what is going on."}], "answers": [{"comments": [{"owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "edited": false, "score": 0, "creation_date": 1513797011, "post_id": 47912811, "comment_id": 82793361, "body": "hhX prints <code>00 -&gt; FFFF; FF -&gt; FF00</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "edited": false, "score": 0, "creation_date": 1513797216, "post_id": 47912811, "comment_id": 82793464, "body": "Are you sure you&#39;re using <code>hhX</code> and not <code>hX</code>?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513797608, "post_id": 47912811, "comment_id": 82793648, "body": "@chux It actually might not help in this case.  My implementation defined <code>PRIx8</code> as <code>&quot;x&quot;</code>."}, {"owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "edited": false, "score": 0, "creation_date": 1513798142, "post_id": 47912811, "comment_id": 82793909, "body": "@dbush, you&#39;re right, apparently hhX on my system yields a <code>too many arguments for format [-Wformat-extra-args]</code> warning"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513798452, "post_id": 47912811, "comment_id": 82794053, "body": "<code>PRIx8</code> as <code>&quot;x&quot;</code> is OK for the implementation.   That is no problem when it prints a <code>uint8_t</code>.  This answer is trying to do something different with <code>printf(&quot;%02hhX\\n&quot;, some_int_with_negative_value);</code>  which is UB - I think  Hmmmm."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1513799683, "post_id": 47912811, "comment_id": 82794593, "body": "Your code causes undefined behaviour. <code>%hhX</code> must be matched with an argument of type <code>signed char</code> or <code>unsigned char</code>"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1513798499, "last_edit_date": 1513798499, "creation_date": 1513796787, "answer_id": 47912811, "question_id": 47912738, "link": "https://stackoverflow.com/questions/47912738/why-bitwise-complement-of-a-1-byte-variable-returns-a-4-byte-value/47912811#47912811", "title": "Why bitwise complement of a 1-byte variable returns a 4-byte value?", "body": "<p>When you apply the <code>~</code> operator to <code>x1</code> and <code>x2</code>, the values are first subject to integer promotions because <code>uint8_t</code> is smaller than an <code>int</code>.  The operator is then applied to the promoted value.</p>\n\n<p>So <code>~x1</code> is really <code>~0x00000000</code> (i.e. <code>0xFFFFFFFF</code>) and <code>~x2</code> is really <code>~0x000000FF</code> (i.e. <code>FFFFFF00</code>).  That's why you get the values you're getting.</p>\n\n<p>Also, the <code>%x</code> format specifier expects an <code>unsigned int</code> which it prints as such.</p>\n\n<p>You need to use <code>%hhx</code> for the format specifier.  That signifies an <code>unsigned char</code> argument.</p>\n\n<pre><code>printf(\"%02hhX -&gt; %02hhX; %02hhX -&gt; %02hhX\\n\", x1, ~x1, x2, ~x2);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1513812268, "post_id": 47912922, "comment_id": 82799557, "body": "Even modern processors are not able to work on words of arbitrary sizes. Afaik ARM has 16-bit multiplication (that is impossible to use from C), but has no 8 bit multiplication. Same for 16 and 8-bit addition, subtraction and others. Everything has to be promoted to 32-bit values. Intel is the only architecture that deals with different sizes of values. So this is not a legacy, it how processors are usually built."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1513797581, "last_edit_date": 1513797581, "creation_date": 1513797221, "answer_id": 47912922, "question_id": 47912738, "link": "https://stackoverflow.com/questions/47912738/why-bitwise-complement-of-a-1-byte-variable-returns-a-4-byte-value/47912922#47912922", "title": "Why bitwise complement of a 1-byte variable returns a 4-byte value?", "body": "<p>Many computer processors have a \u201cword\u201d size for most of their operations. E.g., on a 32-bit machine, there may be an instruction that loads 32 bits, an instruction that stores 32 bits, an instruction that adds one 32-bit number to another, and so on.</p>\n\n<p>On these processors, it may be a nuisance to work with other sizes. There may be no instruction for multiplying a 16-bit number by another 16-bit number. C grew up on these machines. It was designed so that <code>int</code> (or <code>unsigned int</code>) was \u201cwhatever size is good for the machine you are running on\u201d and <code>char</code> or <code>short</code> were fine for storing things in memory, but, once they were loaded from memory into processor registers, C worked with them like they were <code>int</code>.</p>\n\n<p>This simplified the development of early C compilers. The compiler did not have to implement your complement by doing a 32-bit complement instruction followed by an AND instruction to remove the unwanted high bits. It only did a plain 32-bit complement.</p>\n\n<p>We could develop languages differently today, but C is burdened with this legacy.</p>\n"}], "owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 47912922, "answer_count": 2, "score": 3, "last_activity_date": 1513798499, "creation_date": 1513796453, "last_edit_date": 1513796764, "question_id": 47912738, "link": "https://stackoverflow.com/questions/47912738/why-bitwise-complement-of-a-1-byte-variable-returns-a-4-byte-value", "title": "Why bitwise complement of a 1-byte variable returns a 4-byte value?", "body": "<p>Let's take for example the following two 1-byte variables:</p>\n\n<pre><code>uint8_t x1 = 0x00;\nuint8_t x2 = 0xFF;\n</code></pre>\n\n<p>When printing the bitwise complement, the result is a 4-byte variable:</p>\n\n<pre><code>printf(\"%02X -&gt; %02X; %02X -&gt; %02X\\n\", x1, ~x1, x2, ~x2);\n00 -&gt; FFFFFFFF; FF -&gt; FFFFFF00\n</code></pre>\n\n<p>I know this can be \"solved\" using casting or masking:</p>\n\n<pre><code>printf(\"%02X -&gt; %02X; %02X -&gt; %02X\\n\", x1, (uint8_t) ~x1, x2, (uint8_t) ~x2);\n00 -&gt; FF; FF -&gt; 00\nprintf(\"%02X -&gt; %02X; %02X -&gt; %02X\\n\", x1, ~x1&amp;0xFF, x2, ~x2&amp;0xFF);\n00 -&gt; FF; FF -&gt; 00\n</code></pre>\n\n<p>But why the non-intuitive behavior in the first place?</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1513796148, "post_id": 47912626, "comment_id": 82792922, "body": "Ever learn about the <code>do-while</code> loop?"}, {"owner": {"reputation": 68467, "user_id": 1081110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fp4Pm.jpg?s=128&g=1", "display_name": "Dawood ibn Kareem", "link": "https://stackoverflow.com/users/1081110/dawood-ibn-kareem"}, "edited": false, "score": 1, "creation_date": 1513796230, "post_id": 47912626, "comment_id": 82792962, "body": "I&#39;d never omit the <code>{ }</code> characters after an <code>if</code> or <code>else</code>.  Other than that, your second snippet seems just fine to me.  But that&#39;s my opinion only.  This is definitely an &quot;opinion based&quot; question, so I&#39;ve voted to close it.  Also, I don&#39;t know why you tagged it with Java - this code is C."}, {"owner": {"reputation": 68467, "user_id": 1081110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fp4Pm.jpg?s=128&g=1", "display_name": "Dawood ibn Kareem", "link": "https://stackoverflow.com/users/1081110/dawood-ibn-kareem"}, "edited": false, "score": 1, "creation_date": 1513796462, "post_id": 47912626, "comment_id": 82793084, "body": "And of course, you mustn&#39;t get into the habit of using <code>float</code> variables to store amounts of money.  There are very few cases in which this is a good idea.  If your book advises you to do this, then I would throw it away and buy a different book."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 3, "creation_date": 1513796527, "post_id": 47912626, "comment_id": 82793120, "body": "Sometimes, you need something between the start of the loop and loop condition check. This is one of those cases. That&#39;s perfectly fine. I call it a middle-tested loop."}, {"owner": {"reputation": 157, "user_id": 7445062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yYOZX.jpg?s=128&g=1", "display_name": "Said", "link": "https://stackoverflow.com/users/7445062/said"}, "reply_to_user": {"reputation": 68467, "user_id": 1081110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fp4Pm.jpg?s=128&g=1", "display_name": "Dawood ibn Kareem", "link": "https://stackoverflow.com/users/1081110/dawood-ibn-kareem"}, "edited": false, "score": 0, "creation_date": 1513796769, "post_id": 47912626, "comment_id": 82793247, "body": "@DawoodibnKareem Omitting the curly braces is based on the same reason as using the infinite for loop, for the sake of readability, which is I&#39;m just trying to learn to do properly and the book does not encourage to use <code>float</code> all the time. It happens on occasion. Thank you for your opinions, by the way."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513797045, "post_id": 47912626, "comment_id": 82793375, "body": "Regarding the comment you got about the do-while loop. I&#39;ve once seen a colleague use a a construct considered harmful to force the code into a do-while loop, except the first iteration which he made &quot;shorter&quot;. Compared to that, your conditional break is not at all bad."}, {"owner": {"reputation": 68467, "user_id": 1081110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fp4Pm.jpg?s=128&g=1", "display_name": "Dawood ibn Kareem", "link": "https://stackoverflow.com/users/1081110/dawood-ibn-kareem"}, "edited": false, "score": 0, "creation_date": 1513797579, "post_id": 47912626, "comment_id": 82793636, "body": "Definitely.  A do-while would be considerably worse than the original while.  My opinion is that the &quot;forever&quot; loop with the conditional break is by far the best of the three, and it&#39;s really the only way to avoid repetition.  Some people prefer <code>while(1)</code> over <code>for(;;)</code> as a way of writing &quot;forever&quot;.  Indeed, I have been downvoted in an answer to a Java question, for writing <code>for(;;)</code>.  But it&#39;s really a matter of preference."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1513799006, "post_id": 47912626, "comment_id": 82794293, "body": "Side issues:  1) Better code would check the return value of <code>scanf(&quot;%f&quot;, &amp;value);</code> 2) Why <code>f</code> with <code>30.00f</code>, yet not <code>0.017</code>?"}, {"owner": {"reputation": 157, "user_id": 7445062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yYOZX.jpg?s=128&g=1", "display_name": "Said", "link": "https://stackoverflow.com/users/7445062/said"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513799258, "post_id": 47912626, "comment_id": 82794407, "body": "@chux What do you mean by the return value of <code>scanf(&quot;%f&quot;, &amp;value);</code>. I&#39;m a beginner, explain it to me please :) and I&#39;ve no idea about the appendix of <code>f</code>. I don&#39;t know how to use it properly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513799402, "post_id": 47912626, "comment_id": 82794476, "body": "<code>scanf();</code> return the number of fields successfully scanned.  which would be 1: a <code>float</code> was read, 0: only non-numeric input encountered like <code>&quot;abc&quot;</code>. Or <code>EOF</code> to indicate <code>stdin</code> is closed."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 7445062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yYOZX.jpg?s=128&g=1", "display_name": "Said", "link": "https://stackoverflow.com/users/7445062/said"}, "edited": false, "score": 0, "creation_date": 1513798438, "post_id": 47912836, "comment_id": 82794050, "body": "Yeah, your answer makes the logic of loops very clean. Although I cannot agree with you on this specific problem, thank you for your meaningful explanation."}], "tags": [], "owner": {"reputation": 123, "user_id": 4863717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93035f0ccd44d5ea050d3a2e4e67a3de?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4863717/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1513796875, "creation_date": 1513796875, "answer_id": 47912836, "question_id": 47912626, "link": "https://stackoverflow.com/questions/47912626/avoiding-repeating-lines-by-using-infinite-loop-is-it-good-or-bad/47912836#47912836", "title": "Avoiding repeating lines by using infinite loop, is it good or bad?", "body": "<p>Using an infinite loop to accomplish this task technically works. However, the suggested code is cleaner, as the condition to break out of the loop is inherent in the loop type. The <a href=\"https://www.cprogramming.com/tutorial/c/lesson3.html\" rel=\"nofollow noreferrer\">different loop types</a> allow you to accomplish different tasks more efficiently. The \"for\" loop can increase or decrease the value of a variable without needing to write the code for this within the loop.  A while loop simply runs a check, which is what you're doing. </p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 7445062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yYOZX.jpg?s=128&g=1", "display_name": "Said", "link": "https://stackoverflow.com/users/7445062/said"}, "edited": false, "score": 0, "creation_date": 1513798143, "post_id": 47912856, "comment_id": 82793910, "body": "Thank you! Your approach shows the importance of making the code clearer since it does not just increases the readability, but also helps in editing and fixing it sometime later."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 3, "last_activity_date": 1513796948, "creation_date": 1513796948, "answer_id": 47912856, "question_id": 47912626, "link": "https://stackoverflow.com/questions/47912626/avoiding-repeating-lines-by-using-infinite-loop-is-it-good-or-bad/47912856#47912856", "title": "Avoiding repeating lines by using infinite loop, is it good or bad?", "body": "<p>One rule is <em>Don't Repeat Yourself</em>. As with any rule, there can be exceptions, but you should pay attention to it if you have no strong reason to go another way.</p>\n\n<p>The rationale behind it is not really typing lazyness, but more that if you have to change code, you will have to take care of not forgetting one single occurence of repeated code.</p>\n\n<p>For that reason, and even if in your example it is not far from a matter of taste, I definitely prefere the second version where code is not duplicated. A specific reason here is that you <em>really should</em> test the return value of <code>scanf</code> (what if the user erroneously types an alpha of symbol?). If the second version you have to fix the problem only once. In the first version, if you do that long time after writing it first, or even worse if someone else has to fix it, there is a risk forgetting one instance.</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 7445062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yYOZX.jpg?s=128&g=1", "display_name": "Said", "link": "https://stackoverflow.com/users/7445062/said"}, "edited": false, "score": 0, "creation_date": 1513799080, "post_id": 47913096, "comment_id": 82794323, "body": "This one is different than what I&#39;ve encountered so far. I was stuck on <code>scanf</code>. It is meaningful and seems does not repeat the <code>scanf</code> and <code>printf </code> lines. By the way, the <code>float</code> chocie was not up to me. It was writer&#39;s decision, so I just followed it on this particular problem but thank you for your warning!"}], "tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": false, "score": 1, "last_activity_date": 1513798043, "creation_date": 1513798043, "answer_id": 47913096, "question_id": 47912626, "link": "https://stackoverflow.com/questions/47912626/avoiding-repeating-lines-by-using-infinite-loop-is-it-good-or-bad/47913096#47913096", "title": "Avoiding repeating lines by using infinite loop, is it good or bad?", "body": "<p>You should heed the advice of the other responders about not using float for money. That said, here's a way to avoid using an infinite loop (still uses your float nomenclature, but you should change it as appropriate):</p>\n\n<pre><code>float value = 1.0;\nwhile ( value != 0.0f ) {\n   // prompt for input\n\n   // get input\n\n   if ( value &gt; 0.0f ) {\n      // handle the input and output resultshere\n   }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513873367, "post_id": 47913714, "comment_id": 82826338, "body": "Tip: Coding often involves using a set of data, like OP&#39;s commission data.  I highly recommend to <b>not</b> code that data in-line as code, but maintain as a separate data structure.  A successful program needs to be correctly and easily updated to reflect a new commission schedule."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1513871049, "last_edit_date": 1513871049, "creation_date": 1513800811, "answer_id": 47913714, "question_id": 47912626, "link": "https://stackoverflow.com/questions/47912626/avoiding-repeating-lines-by-using-infinite-loop-is-it-good-or-bad/47913714#47913714", "title": "Avoiding repeating lines by using infinite loop, is it good or bad?", "body": "<p>Don't repeat yourself.  <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself#DRY_vs_WET_solutions\" rel=\"nofollow noreferrer\">DRY vs. WET</a>.</p>\n\n<p>Consider that the code needs re-work</p>\n\n<pre><code>// weak\nprintf(\"Enter value of trade: \");  \nscanf(\"%f\", &amp;value);\n\n// better\nprintf(\"Enter value of trade: \");  \nfflush(stdout);   // Insure text is printed before scanning\nif (scanf(\"%f\", &amp;value) != 1) Handle_Error();\n</code></pre>\n\n<p>Would a maintainer of the code like to update this in 1 or 2 places?</p>\n\n<p>User I/O often benefits with a helper function and makes for a clear non-repetitive coded loop condition.</p>\n\n<pre><code>int read_double(const char *prompt, double *y, ) {\n  printf(\"%s\", prompt);  \n  fflush(stdout);\n  int count = scanf(\"%f\", y);\n  return count; \n}\n\nwhile (read_double(\"Enter value of trade: \", &amp;value) == 1) {\n  if (value == 0)\n  ...\n  printf(\"Commission: %.2f\\n\", commission);\n}\n</code></pre>\n\n<hr>\n\n<p>The whole <code>if()</code>, <code>else if()</code>, ... could use re-work too.  Perhaps <code>struct</code> is too new for OP, yet the point is that code evolves and coding for ease of maintenance is a very worthy goal.</p>\n\n<pre><code>  const struct {\n    double value;\n    double commission_base;\n    double commission_rate;\n  } tier[] = { \n    { 2500.00, 30.00, 0.017 }, \n    { 6250.00, 56.00, 0.0066 },\n    { 20000.00, 76.00, 0.0034 }, \n    { 50000.00, 100.00, 0.0022 },\n    { 500000.00, 155.00, 0.0011 }, \n    { DBL_MAX, 255.00, 0.0009 } };\n  int n = sizeof tier / sizeof tier[0];\n  double commission = 0.0;\n  for (int i = 0; i &lt; n; i++) {\n    if (value &lt; tier[i].value) {\n      commission = tier[i].commission_base + tier[i].commission_rate * value;\n      break;\n    }\n  }\n  #define COMMISSION_MIN 39.00\n  if (commission &lt; COMMISSION_MIN) {\n    commission = COMMISSION_MIN;\n  }\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 7445062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yYOZX.jpg?s=128&g=1", "display_name": "Said", "link": "https://stackoverflow.com/users/7445062/said"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1513871049, "creation_date": 1513795995, "last_edit_date": 1513796833, "question_id": 47912626, "link": "https://stackoverflow.com/questions/47912626/avoiding-repeating-lines-by-using-infinite-loop-is-it-good-or-bad", "title": "Avoiding repeating lines by using infinite loop, is it good or bad?", "body": "<p>I'm studying C with K.N. King's C: A Modern Approach and there is a problem (Ch.06 - Prog. Project #4) which asks the reader to write a program that calculates broker's commission according to a trade until the amount of trade is 0.</p>\n\n<p>Here is the writer's implementation:</p>\n\n<pre><code>float commission, value;\n\n  printf(\"Enter value of trade: \");\n  scanf(\"%f\", &amp;value);\n\n  while (value != 0.0f) {\n    if (value &lt; 2500.00f)\n      commission = 30.00f + .017f * value;\n    else if (value &lt; 6250.00f)\n      commission = 56.00f + .0066f * value;\n    else if (value &lt; 20000.00f)\n      commission = 76.00f + .0034f * value;\n    else if (value &lt; 50000.00f)\n      commission = 100.00f + .0022f * value;\n    else if (value &lt; 500000.00f)\n      commission = 155.00f + .0011f * value;\n    else\n      commission = 255.00f + .0009f * value;\n\n    if (commission &lt; 39.00f)\n      commission = 39.00f;\n\n    printf(\"Commission: $%.2f\\n\\n\", commission);\n\n    printf(\"Enter value of trade: \");\n    scanf(\"%f\", &amp;value);\n  }\n</code></pre>\n\n<p>But I thought rather than writing the printf and scanf lines twice, it'd be better to use an infinite <code>for</code> loop, like this:</p>\n\n<pre><code>float value, commission;\n\nfor (;;) {\n    printf(\"Enter value of trade: \");\n    scanf(\"%f\", &amp;value);\n    if (value == 0)\n        break;\n\n    if (value &lt; 2500)\n        commission = 30.00f + 0.017 * value;\n    else if (value &lt; 6250)\n        commission = 56.00f + 0.0066 * value;\n    else if (value &lt; 20000)\n        commission = 76.00f + 0.0034 * value;\n    else if (value &lt; 50000)\n        commission = 100.00f + 0.0022 * value;\n    else if (value &lt; 500000)\n        commission = 155.00f + 0.0011 * value;\n    else\n        commission = 255.00f + 0.0009 * value;\n\n    if (commission &lt; 39.00f)\n        commission = 39.00f;\n\n    printf(\"Commission: %.2f\\n\", commission);\n}\n</code></pre>\n\n<p>My question is, is taking account the number of lines and avoiding the repetition a good and necessary habit or is this a bad way in means of algorithm design?</p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["c", "linux", "pty"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 3, "creation_date": 1513797188, "post_id": 47912604, "comment_id": 82793444, "body": "Do not use a pseudoterminal; a pipe suffices here. Alternatively, pipe the output of tar through e.g. cat, as in <code>tar -cpzf - files-or-directories | cat</code>."}, {"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1513797219, "post_id": 47912604, "comment_id": 82793465, "body": "and why not use the available tools? <code>tar cpz file | myConsumingCprog</code> ? (My <code>tar</code> doesn&#39;t like leading <code>-</code> option specs (YRMV)). Good luck."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 2, "creation_date": 1513798386, "post_id": 47912604, "comment_id": 82794029, "body": "<code>isatty()</code> literally means <b>is</b> (this file descriptor) <b>a</b> <b>tty</b>. If the file descriptor actually <i>is</i> a tty (pseudo or otherwise), the function <i>shall</i> return 1. It would be a severe bug if you could somehow make it return 0 when the file descriptor was a tty. The curious thing is what do you mean by controlling <code>tar</code> via a pty? Poor old <code>tar</code> is the archetypal command line utility, it makes no use whatsoever of any terminal-specific functionality."}, {"owner": {"reputation": 11, "user_id": 3408325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ib34E.gif?s=128&g=1", "display_name": "CodeSlave", "link": "https://stackoverflow.com/users/3408325/codeslave"}, "edited": false, "score": 0, "creation_date": 1513801638, "post_id": 47912604, "comment_id": 82795467, "body": "I already tried the pipe to cat, but I did this from a script. I do not think I can open a pipe directly when I spawn a child process? I think I had some problems with cat. I am sending the output from tar over the network, using my C program, from an embedded device. The device cannot store data thus your second suggestion will not work for me."}], "owner": {"reputation": 11, "user_id": 3408325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ib34E.gif?s=128&g=1", "display_name": "CodeSlave", "link": "https://stackoverflow.com/users/3408325/codeslave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513795920, "creation_date": 1513795920, "question_id": 47912604, "link": "https://stackoverflow.com/questions/47912604/linux-pseudo-terminal-function-isatty-returns-true-in-child", "title": "Linux Pseudo Terminal: function isatty returns true in child", "body": "<p>I am trying to control tar via a pseudo terminal in a C program I have designed. The tar command I am using is: tar -cpzf -</p>\n\n<p>What I am trying to do is to create a pseudo terminal, run tar with output directed to stdout. My plan was to read the data stream produced by tar in my C program.</p>\n\n<p>The problem I am experiencing is that tar prints an error code and exits. </p>\n\n<p>tar: \"Refusing to write archive contents to terminal\"</p>\n\n<p>I looked in the latest tar source code and I see that it includes a terminal type check. Tar bails out if isatty returns true.</p>\n\n<p>What control flag(s) must I set on the pseudo terminal to make function isatty return false in the child process?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "edited": false, "score": 0, "creation_date": 1513795929, "post_id": 47912551, "comment_id": 82792819, "body": "I assume that you want to evaluate in its mathematical sence: b is between a and c. This does not work, because independently of the execution order, the result of the first subexpression is 0 or 1, depending on what is correct. The second comparision is than compared against this result."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1513800356, "post_id": 47912551, "comment_id": 82794888, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6961643/usage-of-greater-than-less-than-operators\">Usage of greater than, less than operators</a>"}, {"owner": {"reputation": 57, "user_id": 7488828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/354d72d615046659cb7a5d8f5fb07204?s=128&d=identicon&r=PG&f=1", "display_name": "Optimus Prime", "link": "https://stackoverflow.com/users/7488828/optimus-prime"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1513917052, "post_id": 47912551, "comment_id": 82841043, "body": "@BoPersson can you answer the same as i have mentioned what I&#39;m actually seeking no one mentioned the same in the answer."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1513920114, "post_id": 47912551, "comment_id": 82841759, "body": "<code>&lt;stdbool.h&gt;</code> just contains things like <code>#define true 1</code> and doesn&#39;t affect the result at all."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7488828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/354d72d615046659cb7a5d8f5fb07204?s=128&d=identicon&r=PG&f=1", "display_name": "Optimus Prime", "link": "https://stackoverflow.com/users/7488828/optimus-prime"}, "edited": false, "score": 0, "creation_date": 1513796017, "post_id": 47912605, "comment_id": 82792858, "body": "so what is <code>1&lt;c</code> basically? or it is <code>true&lt;c</code>?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 57, "user_id": 7488828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/354d72d615046659cb7a5d8f5fb07204?s=128&d=identicon&r=PG&f=1", "display_name": "Optimus Prime", "link": "https://stackoverflow.com/users/7488828/optimus-prime"}, "edited": false, "score": 0, "creation_date": 1513796054, "post_id": 47912605, "comment_id": 82792879, "body": "@OptimusPrime.: No it&#39;s comparing integer 1 with value of <code>c</code>."}, {"owner": {"reputation": 57, "user_id": 7488828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/354d72d615046659cb7a5d8f5fb07204?s=128&d=identicon&r=PG&f=1", "display_name": "Optimus Prime", "link": "https://stackoverflow.com/users/7488828/optimus-prime"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513796180, "post_id": 47912605, "comment_id": 82792940, "body": "@ikegami C99 supports bool which is defined in stdbool.h for your info"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 7, "last_activity_date": 1513795920, "creation_date": 1513795920, "answer_id": 47912605, "question_id": 47912551, "link": "https://stackoverflow.com/questions/47912551/how-abc-or-abc-are-evaluated-in-c/47912605#47912605", "title": "How &quot;a&lt;b&lt;c&quot; or &quot;a&gt;b&gt;c&quot; are evaluated in C", "body": "<p>From standard <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.8\" rel=\"noreferrer\">itself</a> (Relational operators footnotes)</p>\n\n<blockquote>\n  <p>The expression <code>a&lt;b&lt;c</code> is not interpreted as in ordinary mathematics.\n  As the syntax indicates, it means <code>(a&lt;b)&lt;c</code>; in other words, if <code>a</code>\n  is less than <code>b</code>, compare <code>1</code> to <code>c</code>; otherwise, compare <code>0</code> to <code>c</code>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 0, "last_activity_date": 1513796110, "creation_date": 1513796110, "answer_id": 47912650, "question_id": 47912551, "link": "https://stackoverflow.com/questions/47912551/how-abc-or-abc-are-evaluated-in-c/47912650#47912650", "title": "How &quot;a&lt;b&lt;c&quot; or &quot;a&gt;b&gt;c&quot; are evaluated in C", "body": "<p>Operator associativity dictates that <code>a&lt;b&lt;c</code> is equivalent to <code>(a&lt;b)&lt;c</code> (as opposed to <code>a&lt;(b&lt;c)</code>).</p>\n\n<p>If <code>a</code> is less than <code>b</code>, <code>a&lt;b</code> evaluates to <code>1</code>. Otherwise, <code>0</code>.</p>\n\n<p>If the value returned by <code>a&lt;b</code> (<code>1</code> or <code>0</code>) is less than <code>c</code>, the whole evaluates to <code>1</code>. Otherwise, <code>0</code>.</p>\n\n<hr>\n\n<p>From the <a href=\"http://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">spec</a></p>\n\n<blockquote>\n  <p>Each of the operators <code>&lt;</code> (less than), <code>&gt;</code> (greater than), <code>&lt;=</code> (less than or equal to), and <code>&gt;=</code> (greater than or equal to) shall yield 1 if the specified relation is true and 0 if it is false.) The result has type int.</p>\n</blockquote>\n"}], "owner": {"reputation": 57, "user_id": 7488828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/354d72d615046659cb7a5d8f5fb07204?s=128&d=identicon&r=PG&f=1", "display_name": "Optimus Prime", "link": "https://stackoverflow.com/users/7488828/optimus-prime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 47912605, "answer_count": 2, "score": -2, "last_activity_date": 1513916946, "creation_date": 1513795748, "last_edit_date": 1513916946, "question_id": 47912551, "link": "https://stackoverflow.com/questions/47912551/how-abc-or-abc-are-evaluated-in-c", "title": "How &quot;a&lt;b&lt;c&quot; or &quot;a&gt;b&gt;c&quot; are evaluated in C", "body": "<p>I found this question in many interviews and my teacher asked me the same the main doubt was that if I include <code>&lt;stdbool.h&gt;</code> in C99 standard will that evaluate this as <code>(true)&lt;c</code>  or <code>(false)&gt;c</code>. Need a more clear answer than the linked post --> <a href=\"https://stackoverflow.com/questions/6961643/usage-of-greater-than-less-than-operators]\">Usage of greater than, less than operators</a> .</p>\n\n<p>How <code>a&lt;b&lt;c</code>  or <code>a&gt;b&gt;c</code> are evaluated in C<br>\nfor example in the following code.</p>\n\n<pre><code># include&lt;stdbool.h&gt; \nint main(void){\n    int a = 1,b=2,c=3;\n    if(a&lt;b&lt;c)\n        printf(\"a great b great c\");\n    }\n</code></pre>\n\n<p>thank you in advance.</p>\n"}, {"tags": ["c", "macos", "fopen"], "answers": [{"comments": [{"owner": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "edited": false, "score": 0, "creation_date": 1513796743, "post_id": 47912640, "comment_id": 82793236, "body": "Thanks Rob. BTW, it&#39;s not me that has put this file in the Preferences folder - its a 3rd party and I&#39;m trying to write something that works with what they have done."}, {"owner": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "edited": false, "score": 0, "creation_date": 1513796856, "post_id": 47912640, "comment_id": 82793282, "body": "So, does this mean there is no way to access the file with the path &quot;/Library/Preferences/tbupdd.ini&quot; from the Xcode app? Or is there some sort of virtual mapping going on?"}, {"owner": {"reputation": 370144, "user_id": 1271826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/duhm9.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1271826/rob"}, "reply_to_user": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "edited": false, "score": 2, "creation_date": 1513797067, "post_id": 47912640, "comment_id": 82793383, "body": "You can present the user a <code>NSOpenPanel</code> where they can select that <code>ini</code> file (which is a really ugly UX) or turn off sandboxing in your target settings &quot;Capabilities&quot; tab (which, AFAIK, limits your ability to distribute the app on the App Store and smart end-users will be reluctant to install because of the security problems un-sandboxed apps potentially introduce). Maybe someone else knows other ways around this, but I don&#39;t."}, {"owner": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "edited": false, "score": 0, "creation_date": 1513797139, "post_id": 47912640, "comment_id": 82793422, "body": "This will be an internal app available to very few users so (mercifully) App Store hurdles are not an issue."}, {"owner": {"reputation": 370144, "user_id": 1271826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/duhm9.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1271826/rob"}, "reply_to_user": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "edited": false, "score": 0, "creation_date": 1513797287, "post_id": 47912640, "comment_id": 82793489, "body": "Then try turning off &quot;sandboxing&quot; on the &quot;Capabilities&quot; tab. And I&#39;d suggest creating a ticket with the third-party provider to create a sandbox-compatible &quot;settings&quot; approach (though I recognize that you might not have much success there if they&#39;re still living in a non-sandboxed world; lol)."}, {"owner": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "edited": false, "score": 0, "creation_date": 1513797397, "post_id": 47912640, "comment_id": 82793554, "body": "I&#39;m using Xcode 9.2 . Where would I find the Capabilities tab?"}, {"owner": {"reputation": 370144, "user_id": 1271826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/duhm9.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1271826/rob"}, "reply_to_user": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "edited": false, "score": 0, "creation_date": 1513797486, "post_id": 47912640, "comment_id": 82793587, "body": "It&#39;s in your &quot;target&quot; settings: Go to the &quot;navigation&quot; panel on the left &#187; click on the app name at the top of that file navigation tree &#187; select your main app &quot;target&quot; &#187; click on &quot;Capabilities&quot; tab &#187; &quot;App Sandbox&quot; is the first item listed under those capabilities."}], "tags": [], "owner": {"reputation": 370144, "user_id": 1271826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/duhm9.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1271826/rob"}, "is_accepted": true, "score": 2, "last_activity_date": 1513796059, "creation_date": 1513796059, "answer_id": 47912640, "question_id": 47912123, "link": "https://stackoverflow.com/questions/47912123/macos-app-cannot-open-file-that-exists/47912640#47912640", "title": "macOS app cannot open file that exists", "body": "<p>Modern macOS apps employ sandboxing, that only allow updates to files in the sandbox. See <a href=\"https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html#//apple_ref/doc/uid/TP40010672-CH2-SW1\" rel=\"nofollow noreferrer\">File System Programming Guide: The Library Directory Stores App-Specific Files</a>. Also see <a href=\"https://developer.apple.com/library/content/documentation/Security/Conceptual/AppSandboxDesignGuide/AboutAppSandbox/AboutAppSandbox.html#//apple_ref/doc/uid/TP40011183\" rel=\"nofollow noreferrer\">About App Sandbox</a>.</p>\n\n<p>I would not suggest using a hard coded path like that. I'd suggest getting the library folder from the <code>NSFileManager</code></p>\n\n<pre><code>NSURL *fileURL = [[NSFileManager defaultManager] URLForDirectory:NSLibraryDirectory inDomain:NSUserDomainMask appropriateForURL:nil create:true error:&amp;error];\nNSAssert(!error, @\"Unable to get library directory: %@\", [error localizedDescription]);\nNSLog(@\"%s\", fileURL.path.UTF8String);\n</code></pre>\n\n<p>That returns:</p>\n\n<blockquote>\n  <p>/Users/{username}/Library/Containers/{com.domain.app}/Data/Library</p>\n</blockquote>\n\n<p>You can then pass that to your C function.</p>\n\n<hr>\n\n<p>BTW, Apple explicitly advises that we should not create files in <code>Preferences</code> subfolder. They <a href=\"https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html#//apple_ref/doc/uid/TP40010672-CH2-SW1\" rel=\"nofollow noreferrer\">warn us</a>:</p>\n\n<blockquote>\n  <p>This directory contains app-specific preference files. You should not create files in this directory yourself. Instead, use the <a href=\"https://developer.apple.com/documentation/foundation/nsuserdefaults\" rel=\"nofollow noreferrer\"><code>NSUserDefaults</code></a> class or <code>CFPreferences</code> API to get and set preference values for your app. </p>\n</blockquote>\n"}], "owner": {"reputation": 3327, "user_id": 1367722, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b014b75ed07af8e1b223bc9d2da94c2f?s=128&d=identicon&r=PG", "display_name": "TenG", "link": "https://stackoverflow.com/users/1367722/teng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "accepted_answer_id": 47912640, "answer_count": 1, "score": 1, "last_activity_date": 1513816202, "creation_date": 1513793905, "last_edit_date": 1513816202, "question_id": 47912123, "link": "https://stackoverflow.com/questions/47912123/macos-app-cannot-open-file-that-exists", "title": "macOS app cannot open file that exists", "body": "<p>I have a C module in a Xcode app (macOS) that opens a file.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>char fname1 [1028] = \"/Library/Preferences/tbupdd.ini\";\nFILE * fp;\n\nfp = fopen(fname1, \"r\");\n\nif (fp == NULL)\n{\n    perror(\"error opening updd.ini\");\n    printf(\"File %s not found, use another method for getting version\\n\", fname1);\n    exit(1);\n}\n</code></pre>\n\n<p>The file exists and I can read it in Terminal. But running this app in Xcode is giving </p>\n\n<pre><code>error opening updd.ini: Operation not permitted\n</code></pre>\n\n<p>The file has the following permissions:</p>\n\n<pre><code>$ ls -l /Library/Preferences/tbupdd.ini\n-rw-r--r--  1 root  wheel  25584 20 Dec 15:05 /Library/Preferences/tbupdd.ini\n</code></pre>\n\n<p>I understand that Xcode has a working directory but would that affect the above absolute path?</p>\n"}, {"tags": ["c", "opengl-es", "opengl-es-2.0"], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 3106531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a4a089a86f815752131f0a469d37c5?s=128&d=identicon&r=PG&f=1", "display_name": "fernan", "link": "https://stackoverflow.com/users/3106531/fernan"}, "is_accepted": false, "score": 0, "last_activity_date": 1513804722, "creation_date": 1513804722, "answer_id": 47914494, "question_id": 47912080, "link": "https://stackoverflow.com/questions/47912080/gldrawarrays-throws-gl-invalid-value-on-glesv2/47914494#47914494", "title": "glDrawArrays throws GL_INVALID_VALUE on GLESv2", "body": "<p>I figured it out. I was calling eglBindAPI() after eglCreateContext() so I think I was actually creating a GLES1 context.</p>\n"}], "owner": {"reputation": 329, "user_id": 3106531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a4a089a86f815752131f0a469d37c5?s=128&d=identicon&r=PG&f=1", "display_name": "fernan", "link": "https://stackoverflow.com/users/3106531/fernan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513804722, "creation_date": 1513793708, "last_edit_date": 1513798431, "question_id": 47912080, "link": "https://stackoverflow.com/questions/47912080/gldrawarrays-throws-gl-invalid-value-on-glesv2", "title": "glDrawArrays throws GL_INVALID_VALUE on GLESv2", "body": "<p>I'm trying to port an OpenGL program to GLESv2. The program uses the following code a texture to the default framebuffer (it also fails if I render it to an fbo which also works on OpenGL).</p>\n\n<pre><code>    glBindFramebuffer(GL_FRAMEBUFFER, 0); \n    glVertexAttribPointer(bgra_texcoords, 2, GL_FLOAT, GL_FALSE, 0, display_texcoords);\n    glEnableVertexAttribArray(bgra_texcoords);\n    DEBUG_ERROR_CHECK();\n\n    glBindBuffer(GL_ARRAY_BUFFER, vertex_buffer);\n    glUseProgram(bgra_program);\n    glBindTexture(GL_TEXTURE_2D, inst-&gt;texture);\n    glUniform1i(bgra_texture, 0); \n    glViewport(inst-&gt;x, root_surface-&gt;h - (inst-&gt;y + inst-&gt;h), inst-&gt;w, inst-&gt;h);\n    DEBUG_ERROR_CHECK();\n\n    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4); \n    DEBUG_ERROR_CHECK();\n    glBindBuffer(GL_ARRAY_BUFFER, 0); \n    glFlush();\n</code></pre>\n\n<p>This works fine with OpenGL but it fails on glDrawArrays() under GLESv2. I read this question: <a href=\"https://stackoverflow.com/questions/24702349/gldrawelements-throw-gl-invalid-value-error\">glDrawElements throw GL_INVALID_VALUE\u200b error</a> which is very similar to my problem but I can't figure out how to apply the solution to my code since I'm not using VertexArray and I'm very new to GL.</p>\n\n<p>inst->texture is a texture uploaded with glTexImage2D(). I created the vertex_buffer right after initializing EGL and compiling the shaders:</p>\n\n<pre><code>    glGenBuffers(1, &amp;vertex_buffer);\n    glBindBuffer(GL_ARRAY_BUFFER, vertex_buffer);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), \n            vertices, GL_STATIC_DRAW);\n    glBindBuffer(GL_ARRAY_BUFFER, vertex_buffer);\n    glVertexAttribPointer(bgra_pos, 2, GL_FLOAT, GL_FALSE, 0, 0); \n    glEnableVertexAttribArray(bgra_pos);\n    DEBUG_ERROR_CHECK();\n</code></pre>\n\n<p>Edit: You can look at the whole source file here: <a href=\"https://github.com/fernando-rodriguez/mediabox/blob/bc4135d9568b2c5b4e8f39ac63ded2cb66023bcd/src/lib/ui/video-opengl.c\" rel=\"nofollow noreferrer\">https://github.com/fernando-rodriguez/mediabox/blob/bc4135d9568b2c5b4e8f39ac63ded2cb66023bcd/src/lib/ui/video-opengl.c</a>. The file is a video \"driver\" for a compositor, all it does is creates 2D surfaces and render them to the screen. If there is anything wrong with the question or am missing something please post a comment so I can fix it. Thanks.</p>\n"}, {"tags": ["c", "arrays", "swift"], "comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1515147309, "post_id": 47911577, "comment_id": 83198421, "body": "Any feedback on the answer? Please let me know if you need more information."}, {"owner": {"reputation": 6296, "user_id": 677987, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/iOB4J.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/677987/jan"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1515147937, "post_id": 47911577, "comment_id": 83198791, "body": "yes sorry, I forgot to accept your answer"}], "answers": [{"tags": [], "owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1513795946, "last_edit_date": 1513795946, "creation_date": 1513794174, "answer_id": 47912185, "question_id": 47911577, "link": "https://stackoverflow.com/questions/47911577/convert-swift-string-array-to-c-char/47912185#47912185", "title": "Convert Swift String array to c char**", "body": "<p><code>getDREFSs</code> expects a pointer to an array of <em>optional</em> <code>Int8</code> pointers.\nAlso the second argument must be converted to <code>UInt8</code>.</p>\n\n<p>So this would compile:</p>\n\n<pre><code>public func get(drefs: [String]) -&gt; Int {\n    var cDrefs = [UnsafePointer&lt;Int8&gt;?]()\n    for dref in drefs {\n        cDrefs.append(dref.cString(using: .utf8))\n    }\n    let result = getDREFs(&amp;cDrefs, UInt8(drefs.count))\n    return Int(result)\n}\n</code></pre>\n\n<p>But a quick test shows that is does not work if called with\nmultiple strings. The reason is that the arrays\nreturned by  <code>dref.cString(using: .utf8)</code>\ncan already be deallocated (and the pointer invalid)\nwhen the C function is called. </p>\n\n<p>Here is a working version, a slight modification of\n<a href=\"https://stackoverflow.com/questions/38275377/convert-a-swift-array-of-string-to-a-to-a-c-string-array-pointer/38275792#38275792\">Convert a Swift Array of String to a to a C string array pointer</a> for\nthis particular case:</p>\n\n<pre><code>public func get(drefs: [String]) -&gt; Int {\n    var cargs = drefs.map { UnsafePointer&lt;Int8&gt;(strdup($0)) }\n    let result = getDREFs(&amp;cargs, UInt8(drefs.count))\n    for ptr in cargs { free(UnsafeMutablePointer(mutating: ptr)) }\n    return Int(result)\n}\n</code></pre>\n"}], "owner": {"reputation": 6296, "user_id": 677987, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/iOB4J.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/677987/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "accepted_answer_id": 47912185, "answer_count": 1, "score": 1, "last_activity_date": 1513795946, "creation_date": 1513791575, "question_id": 47911577, "link": "https://stackoverflow.com/questions/47911577/convert-swift-string-array-to-c-char", "title": "Convert Swift String array to c char**", "body": "<p>I'm calling a C library from Swift 4 and I have troubles converting a <code>[String]</code> to <code>const char *[]</code>.</p>\n\n<p>The C API defines this method:</p>\n\n<pre><code>int getDREFs(const char* drefs[], unsigned char count);\n</code></pre>\n\n<p>which is exposed in Swift as</p>\n\n<pre><code>public func getDREFs(_ drefs: UnsafeMutablePointer&lt;UnsafePointer&lt;Int8&gt;?&gt;!, _ count: UInt8) -&gt; Int32\n</code></pre>\n\n<p>The Swift wrapper I'm trying to write is the following</p>\n\n<pre><code>public func get(drefs: [String]) throws {\n\n    var cDrefs = [UnsafePointer&lt;Int8&gt;]()\n    for dref in drefs {\n        cDrefs.append(dref.cString(using: .utf8)!)\n    }\n    let pDrefs = UnsafeMutablePointer&lt;UnsafePointer&lt;Int8&gt;&gt;(&amp;cDrefs)\n    getDREFFs(pDrefs, drefs.count)\n\n}\n</code></pre>\n\n<p>but the error I get is </p>\n\n<p><code>Cannot convert value of type 'UnsafeMutablePointer&lt;UnsafePointer&lt;Int8&gt;&gt;' to expected argument type 'UnsafeMutablePointer&lt;UnsafePointer&lt;Int8&gt;?&gt;!'</code></p>\n\n<p>what am I missing?</p>\n"}, {"tags": ["c", "gcc", "makefile"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 3, "creation_date": 1513791700, "post_id": 47911555, "comment_id": 82790766, "body": "You&#39;ve left out the most vital and crucial part of your question - how does the Makefile not work? Give details!"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513791921, "post_id": 47911555, "comment_id": 82790884, "body": "This line - <code>cc=gcc</code> - does nothing by the way. You maybe meant <code>CC=gcc</code> but then you&#39;d have also used <code>$(CC)</code> rather than <code>cc</code> elsewhere"}, {"owner": {"reputation": 1108, "user_id": 504286, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c89e451f0090eb23b2ba9307b1dfcb45?s=128&d=identicon&r=PG", "display_name": "Nonyme", "link": "https://stackoverflow.com/users/504286/nonyme"}, "edited": false, "score": 2, "creation_date": 1513792162, "post_id": 47911555, "comment_id": 82791016, "body": "It looks like you are missing the extension to all your &#39;-o&#39; options: <code>cc -c -o .&#47;shared&#47;sem .&#47;shared&#47;sem.c</code> should be <code>cc -c -o .&#47;shared&#47;sem.o .&#47;shared&#47;sem.c</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9039337"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513793383, "post_id": 47911555, "comment_id": 82791654, "body": "@ChrisTurner cc: error: ../shared/funzioni. No such file or Directory cc: error: ../shared/gF. No such file or Directory cc: error: ../shared/sem. No such file or Directory"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9039337"}, "reply_to_user": {"reputation": 1108, "user_id": 504286, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c89e451f0090eb23b2ba9307b1dfcb45?s=128&d=identicon&r=PG", "display_name": "Nonyme", "link": "https://stackoverflow.com/users/504286/nonyme"}, "edited": false, "score": 0, "creation_date": 1513793580, "post_id": 47911555, "comment_id": 82791742, "body": "@Nonyme I&#39;m pretty sure that the -o is not necessary because if I do the command manually it works."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1513796549, "post_id": 47911555, "comment_id": 82793135, "body": "When you say works, it likely does not generate an error message, but also does not generate the <code>.o</code> file..."}, {"owner": {"reputation": 1589, "user_id": 1221106, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/446a06be40a16b516e0b9dc03cecd984?s=128&d=identicon&r=PG", "display_name": "igagis", "link": "https://stackoverflow.com/users/1221106/igagis"}, "edited": false, "score": 1, "creation_date": 1513796834, "post_id": 47911555, "comment_id": 82793272, "body": "Also, your <code>cc</code> command is run from project&#39;s root directory, so there should be no <code>..&#47;</code> prefix in file paths"}, {"owner": {"reputation": 1589, "user_id": 1221106, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/446a06be40a16b516e0b9dc03cecd984?s=128&d=identicon&r=PG", "display_name": "igagis", "link": "https://stackoverflow.com/users/1221106/igagis"}, "edited": false, "score": 0, "creation_date": 1513796938, "post_id": 47911555, "comment_id": 82793326, "body": "Offtopic note: your makefile writing approach is totally unmaintainable. Consider using template rules, and build shared or static library for stuff in <code>shared</code> directory"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9039337"}, "edited": false, "score": 0, "creation_date": 1513798125, "post_id": 47912740, "comment_id": 82793897, "body": "I edited the question, now it gives me the error: *** Missing Separators."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1513798690, "post_id": 47912740, "comment_id": 82794152, "body": "I believe that&#39;s the error Make outputs when you put spaces in front of a recipe instead of tabs."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1513798816, "post_id": 47912740, "comment_id": 82794213, "body": "See <a href=\"https://www.gnu.org/software/make/manual/html_node/Error-Messages.html\" rel=\"nofollow noreferrer\">gnu.org/software/make/manual/html_node/Error-Messages.html</a> for more info on this error"}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1513798930, "post_id": 47912740, "comment_id": 82794259, "body": "Also, the first target/recipe you have seems very odd -- you have a rule to build <code>.&#47;gestore&#47;gestore</code>, and it&#39;s only recipe is to call <code>.&#47;gestore&#47;gestore</code> (which is either out of date, or doesn&#39;t exist)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9039337"}, "edited": false, "score": 0, "creation_date": 1513799090, "post_id": 47912740, "comment_id": 82794332, "body": "In the first rule I would like to execute the file &quot;gestore&quot; into the directory called &quot;gestore&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9039337"}, "edited": false, "score": 0, "creation_date": 1513800810, "post_id": 47912740, "comment_id": 82795097, "body": "The first rule is the only one which doesn&#39;t works. All the files are compiled (I edited the question with the solution) but the file &quot;gestore&quot; is not executed."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1513871230, "post_id": 47912740, "comment_id": 82825125, "body": "Your first rule should likely be: <code>all: .&#47;gestore&#47;gestore; .&#47;gestore&#47;gestore</code> and then have the <code>.&#47;gestore&#47;gestore</code> rule just build the file."}], "tags": [], "owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "is_accepted": true, "score": 0, "last_activity_date": 1513796837, "last_edit_date": 1513796837, "creation_date": 1513796464, "answer_id": 47912740, "question_id": 47911555, "link": "https://stackoverflow.com/questions/47911555/create-makefile-which-iterate-through-directory/47912740#47912740", "title": "Create makefile which iterate through directory", "body": "<p>The following line would give you those errors:</p>\n\n<pre><code>./tipoA/tipoA.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    cc -o ./tipoA/tipoA ./tipoA/tipoA.c ./shared/funzioni ./shared/sem ./shared/gestioneFile \n</code></pre>\n\n<p>First, you are outputting to <code>./tipoA/tipoA</code> instead of <code>./tipoA/tipoA.o</code> as @Nonyme pointed out.  This would not cause your compile failure though.</p>\n\n<p>What would cause a failure is that it is trying to use <code>./shared/funzioni</code> as an input -- that file does not exist.   (notice the makefile target depends on <code>./shared/funzioni.o</code>, which must be built before this recipe is invoked, but it does not generate <code>shared/funzioni</code> (without the <code>.o</code>) </p>\n\n<p>You need to add the <code>.o</code>'s to the target and sources of your cc commands.   </p>\n\n<p>I would also suggest using <code>$(CC)</code>, and lookup <a href=\"https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html\" rel=\"nofollow noreferrer\">automatic variables</a> -- specifically <code>$@</code> and <code>$^</code> for your recipes.  Much neater and less error prone that way.</p>\n\n<pre><code>./tipoA/tipoA.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    $(CC) -o $@ $^\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9039337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 47912740, "answer_count": 1, "score": 2, "last_activity_date": 1513800720, "creation_date": 1513791504, "last_edit_date": 1513800720, "question_id": 47911555, "link": "https://stackoverflow.com/questions/47911555/create-makefile-which-iterate-through-directory", "title": "Create makefile which iterate through directory", "body": "<pre><code>                         $project\n                            |\n     +------------+----------------+----------------+\n     |            |                |                |\n   gestore/     tipoA/           tipoB/            shared/\n     |            |                |                 |\n     +            +                +                 +\n     |            |                |        +--------|------------------+\n  gestore.c     tipoA.c          tipoB.c/   funzioni.c/.h sem.c/.h gF.c./ \n</code></pre>\n\n<p>Hello, I would like to create a makefile for this project, which does these commands:</p>\n\n<p>Step 1 in SHARED FOLDER: </p>\n\n<pre><code>gcc -c -o gestioneFile gestioneFile.c\ngcc -c -o sem sem.c\ngcc -c -o funzioni funzioni.c\n</code></pre>\n\n<p>Step 2 in  tipoA FOLDER:</p>\n\n<pre><code>gcc -o tipoA tipoA.c ../shared/funzioni ../shared/sem ../shared/gestioneFile\n</code></pre>\n\n<p>Step 3 in  tipoB FOLDER:</p>\n\n<pre><code>gcc -o tipoB tipoB.c ../shared/funzioni ../shared/sem ../shared/gestioneFile\n</code></pre>\n\n<p>Step 4 in gestore FOLDER:</p>\n\n<pre><code>gcc -o gestore gestore.c ../shared/funzioni ../shared/sem ../shared/gestioneFile\n\n./gestore\n</code></pre>\n\n<p>This is my makefile but it doesn't works:</p>\n\n<pre><code>#Makefile\n\ncc=gcc\n\n./gestore/gestore: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o ./tipoA/tipoA.o ./tipoB/tipoB.o ./gestore/gestore.o\n    ./gestore/gestore\n\n./shared/gestioneFile.o: \n    cc -c -o ./shared/gestioneFile ./shared/gestioneFile.c\n\n./shared/sem.o:\n    cc -c -o ./shared/sem ./shared/sem.c\n\n./shared/functions.o: \n    cc -c -o ./shared/funzioni ./shared/funzioni.c\n\n./tipoA/tipoA.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    cc -o ./tipoA/tipoA ./tipoA/tipoA.c ./shared/funzioni ./shared/sem ./shared/gestioneFile \n\n./tipoB/tipoB.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    cc -o ./tipoB/tipoB ./tipoB/tipoB.c ../shared/funzioni ../shared/sem ../shared/gestioneFile\n\n./gestore/gestore.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    cc -o ./gestore/gestore ./gestore/gestore.c ./shared/funzioni ./shared/sem ./shared/gestioneFile\n</code></pre>\n\n<p>EDIT:\n@HardcoreHenry This is my makefile now, but it gives the error: ***** Missing separator.**</p>\n\n<pre><code>#Makefile\n\ncc=gcc\n\n./gestore/gestore:  ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o ./tipoA/tipoA.o ./tipoB/tipoB.o ./gestore/gestore.o\n    ./gestore/gestore\n\n./shared/gestioneFile.o: \n    cc -c -o ./shared/gestioneFile.o ./shared/gestioneFile.c\n\n./shared/sem.o:\n    cc -c -o ./shared/sem.o ./shared/sem.c\n\n./shared/funzioni.o: \n    cc -c -o ./shared/funzioni.o ./shared/funzioni.c\n\n./tipoA/tipoA.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    cc -o ./tipoA/tipoA.o ./tipoA/tipoA.c ./shared/funzioni.o ./shared/sem.o ./shared/gestioneFile.o\n\n./tipoB/tipoB.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    cc -o ./tipoB/tipoB.o ./tipoB/tipoB.c ../shared/funzioni.o ../shared/sem.o ../shared/gestioneFile.o\n\n./gestore/gestore.o: ./shared/gestioneFile.o ./shared/sem.o ./shared/funzioni.o \n    cc -o ./gestore/gestore.o ./gestore/gestore.c ./shared/funzioni.o ./shared/sem.o ./shared/gestioneFile.o\n</code></pre>\n\n<p>SOLVED (even if the first rule does not execute the file):</p>\n\n<pre><code>./gestore/gestore: ./shared/gestioneFile.o  ./shared/sem.o  ./shared/funzioni.o ./tipoA/tipoA   ./tipoB/tipoB   ./gestore/gestore\n    ./gestore/gestore\n\n./shared/gestioneFile.o:\n    gcc -c -o ./shared/gestioneFile ./shared/gestioneFile.c\n\n./shared/sem.o:\n    gcc -c -o ./shared/sem ./shared/sem.c\n\n./shared/funzioni.o: \n    gcc -c -o ./shared/funzioni ./shared/funzioni.c\n\n./tipoA/tipoA:  ./shared/gestioneFile.o ./shared/sem.o  ./shared/funzioni.o \n    gcc -o ./tipoA/tipoA ./tipoA/tipoA.c ./shared/gestioneFile ./shared/sem ./shared/funzioni \n\n./tipoB/tipoB: ./shared/gestioneFile.o  ./shared/sem.o  ./shared/funzioni.o \n    gcc -o ./tipoB/tipoB ./tipoB/tipoB.c ./shared/gestioneFile ./shared/sem ./shared/funzioni\n\n./gestore/gestore: ./shared/gestioneFile.o  ./shared/sem.o  ./shared/funzioni.o \n    gcc -o ./gestore/gestore ./gestore/gestore.c ./shared/gestioneFile ./shared/sem ./shared/funzioni\n</code></pre>\n"}, {"tags": ["c", "libxml2"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1513791540, "post_id": 47911528, "comment_id": 82790690, "body": "Does not look like you compile or link parser.c."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1513791710, "post_id": 47911528, "comment_id": 82790772, "body": "The <code>-I</code> option simply adds that path to the list of paths to search for header files. As mentioned you still need to build and link in parser.c"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1513792095, "post_id": 47911528, "comment_id": 82790980, "body": "this looks pretty similar to what you&#39;re trying to do:  <a href=\"http://www.cs.colby.edu/maxwell/courses/tutorials/maketutor/\" rel=\"nofollow noreferrer\">cs.colby.edu/maxwell/courses/tutorials/maketutor</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1513792832, "post_id": 47911528, "comment_id": 82791382, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 1984, "user_id": 953279, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/htDmh.jpg?s=128&g=1", "display_name": "Makan Tayebi", "link": "https://stackoverflow.com/users/953279/makan-tayebi"}, "edited": false, "score": 0, "creation_date": 1513994701, "post_id": 47911528, "comment_id": 82868229, "body": "So I just built the libxml. How do I link it here?"}, {"owner": {"reputation": 1984, "user_id": 953279, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/htDmh.jpg?s=128&g=1", "display_name": "Makan Tayebi", "link": "https://stackoverflow.com/users/953279/makan-tayebi"}, "edited": false, "score": 1, "creation_date": 1513995087, "post_id": 47911528, "comment_id": 82868270, "body": "I just tried -L. and -lm as I saw online, to refer to the libraries folder.. but the problem persists"}], "owner": {"reputation": 1984, "user_id": 953279, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/htDmh.jpg?s=128&g=1", "display_name": "Makan Tayebi", "link": "https://stackoverflow.com/users/953279/makan-tayebi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513791399, "creation_date": 1513791399, "question_id": 47911528, "link": "https://stackoverflow.com/questions/47911528/undefined-reference-to-function-but-the-header-is-included", "title": "Undefined Reference to function - But the header is included", "body": "<p>Ok Peeps. I'm struggling with the basics here.</p>\n\n<p>the file structure is:</p>\n\n<pre><code>./Makefile\n./main.c\n./libxml2-2.0.0/parser.c\n./libxml2-2.0.0/parser.h\n</code></pre>\n\n<p>./libxml2-2.0.0/parser.h:</p>\n\n<pre><code>...\nxmlDocPtr   xmlParseDoc     (xmlChar *cur);\n...\n</code></pre>\n\n<p>./libxml2-2.0.0/parser.c:</p>\n\n<pre><code>...\nxmlDocPtr\nxmlParseDoc(xmlChar *cur) {\n    return(xmlSAXParseDoc(NULL, cur, 0));\n}\n...\n</code></pre>\n\n<p>part of my code is:</p>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;curl/curl.h&gt;\n#include &lt;parser.h&gt;\n#include &lt;tree.h&gt;\n\nstruct string {\n  char *ptr;\n  size_t len;\n};\nvoid extractXML(struct string *s)\n{\n    xmlDocPtr doc;\n    doc = xmlParseDoc( (xmlChar *) s-&gt;ptr);\n}\nint main(void){..}\n</code></pre>\n\n<p>Makefile:</p>\n\n<pre><code>CC=gcc\nLIBS = -lcurl\nMyProgram: main.c\n    $(CC) $?  $(LIBS) -Ilibxml2-2.0.0 -o $@\n</code></pre>\n\n<p>ERROR:</p>\n\n<pre><code>In function `extractXML':\nmain.c:(.text+0xbf): undefined reference to `xmlParseDoc'\n</code></pre>\n\n<p>So the library is included, other libxml and parser.h elements are being used fine, but <code>xmlParseDoc</code> I can't use. How to solve it?</p>\n"}, {"tags": ["c", "double", "nan", "literals", "ieee-754"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1513851920, "post_id": 47911365, "comment_id": 82813260, "body": "I guess you can use <a href=\"https://stackoverflow.com/q/2148989/995714\">union</a> for this purpose"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1589925730, "post_id": 47911365, "comment_id": 109486214, "body": "&quot;memcpy is nice as it avoids aliasing but requires a function call&quot; --&gt; No.  A compiler can optimize the function call out."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 582298, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/OBkU2.png?s=128&g=1", "display_name": "coderforlife", "link": "https://stackoverflow.com/users/582298/coderforlife"}, "edited": false, "score": 0, "creation_date": 1513798182, "post_id": 47912122, "comment_id": 82793922, "body": "This is right, and the extra variables would likely be optimized away. However, for for my specific usage the other solutions are slightly better."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1513793903, "creation_date": 1513793903, "answer_id": 47912122, "question_id": 47911365, "link": "https://stackoverflow.com/questions/47911365/c-double-literal-nan-with-payload/47912122#47912122", "title": "C Double Literal NaN with Payload", "body": "<ul>\n<li><p><code>memcpy</code> does not need to be implemented with a function call. A good compiler will inline it and otherwise optimize it.</p></li>\n<li><p>Constant union objects with static storage duration can be initialized.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1108, "user_id": 582298, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/OBkU2.png?s=128&g=1", "display_name": "coderforlife", "link": "https://stackoverflow.com/users/582298/coderforlife"}, "edited": false, "score": 0, "creation_date": 1513797137, "post_id": 47912136, "comment_id": 82793421, "body": "I am getting errors now wherever this is used stating &quot;<code>taking address of temporary array</code>&quot;. I tried with and without the <code>&amp;</code>. Is this because the code is being compiled as C++ instead of C? Seems like that is what is happening according to <a href=\"https://stackoverflow.com/questions/32941846/c-error-taking-address-of-temporary-array\" title=\"c error taking address of temporary array\">stackoverflow.com/questions/32941846/&hellip;</a>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1108, "user_id": 582298, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/OBkU2.png?s=128&g=1", "display_name": "coderforlife", "link": "https://stackoverflow.com/users/582298/coderforlife"}, "edited": false, "score": 0, "creation_date": 1513797294, "post_id": 47912136, "comment_id": 82793494, "body": "@coderforlife Most likely. C and C++ are two different languages, and this is one of those places where they differ.  If you&#39;re writing C code, then compile as C."}, {"owner": {"reputation": 1108, "user_id": 582298, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/OBkU2.png?s=128&g=1", "display_name": "coderforlife", "link": "https://stackoverflow.com/users/582298/coderforlife"}, "edited": false, "score": 0, "creation_date": 1513797562, "post_id": 47912136, "comment_id": 82793625, "body": "Sadly, this is actually running through something else that forces the compile-time options to treat it as C++ (I wish it didn&#39;t...). I will see if I can do something about it, but otherwise this does seem to work in my testing code."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1513851686, "post_id": 47912136, "comment_id": 82813118, "body": "also be careful with the alignment of the array in compound literal"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1513852378, "post_id": 47912136, "comment_id": 82813578, "body": "Those cast and dereference pairs are strict aliasing violations, and undefined behaviour."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1513862054, "post_id": 47912136, "comment_id": 82819233, "body": "@user694733 Good point.  Modified to use a union for proper alignment and to prevent aliasing issues."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1589925903, "post_id": 47912136, "comment_id": 109486278, "body": "The endian of an integer is often the same as the endidan of the FP types - although not required to be so.  The  <code>__BYTE_ORDER == __BIG_ENDIAN</code> is not an integer  big/little issue as much as a <code>FP_ENDIAN</code> one."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1513862320, "last_edit_date": 1513862320, "creation_date": 1513793960, "answer_id": 47912136, "question_id": 47911365, "link": "https://stackoverflow.com/questions/47911365/c-double-literal-nan-with-payload/47912136#47912136", "title": "C Double Literal NaN with Payload", "body": "<p>You can do this with a <strong>compound literal</strong>, which you can then take the address of and cast:</p>\n\n<pre><code>double d = ((union {unsigned char c[8]; double d; }){ .c={1,0,0,0,0,0,0xf0,0x7f} }).d;\nprintf(\"d=%f\\n\", d);\n\nint i;\nprintf(\"d=0x\");\nfor (i=0; i&lt;sizeof(double); i++) {\n    unsigned char c = ((unsigned char *)&amp;d)[sizeof(double)-1-i];\n    printf(\"%02x\", c);\n}\nprintf(\"\\n\");\n</code></pre>\n\n<p>Here, we have a anonymous literal union containing an array of <code>unsigned char</code> of size 8 and a <code>double</code>.  We initialize the array field of the literal and read the <code>double</code> part to initialize the variable.</p>\n\n<p>Output:</p>\n\n<pre><code>d=nan\nd=7ff0000000000001\n</code></pre>\n\n<p>We can clean this up a bit with a macro, and also take care of the endianness:</p>\n\n<pre><code>static_assert(sizeof(double)==8, \"unexpected double size\");\n\n#if __BYTE_ORDER == __BIG_ENDIAN\n#  define DOUBLE_LIT(c1,c2,c3,c4,c5,c6,c7,c8) ((union {unsigned char c[8]; double d; }){ .c={c1,c2,c3,c4,c5,c6,c7,c8} }).d\n#elif __BYTE_ORDER == __LITTLE_ENDIAN\n#  define DOUBLE_LIT(c1,c2,c3,c4,c5,c6,c7,c8) ((union {unsigned char c[8]; double d; }){ .c={c8,c7,c6,c5,c4,c3,c2,c1} }).d\n#else\n#  error unknown endianness\n#fi\n</code></pre>\n\n<p>Then we can use it like this:</p>\n\n<pre><code>double d = DOUBLE_LIT(0x7f,0xf0,0,0,0,0,0,1);\n</code></pre>\n\n<p>Note that the endianness check is system dependent.  The above is how it is typically implemented on Linux.</p>\n"}, {"comments": [{"owner": {"reputation": 1108, "user_id": 582298, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/OBkU2.png?s=128&g=1", "display_name": "coderforlife", "link": "https://stackoverflow.com/users/582298/coderforlife"}, "edited": false, "score": 0, "creation_date": 1513798035, "post_id": 47912249, "comment_id": 82793847, "body": "This is a great solution as it has built-in handling of all the strange things like where the quiet bit goes (or if it is actually a signal bit), endianness, and what-not. Additionally, reading the doc led me to the C99 function nan() which works similarly (but not compile-time) which I am using as a fallback for non-GCC compilers."}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": false, "score": 2, "last_activity_date": 1513850075, "last_edit_date": 1513850075, "creation_date": 1513794416, "answer_id": 47912249, "question_id": 47911365, "link": "https://stackoverflow.com/questions/47911365/c-double-literal-nan-with-payload/47912249#47912249", "title": "C Double Literal NaN with Payload", "body": "<p>One possibility is GCC's (non-portable) <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html#index-_005f_005fbuiltin_005fnan\" rel=\"nofollow noreferrer\"><code>__builtin_nan</code></a> extension, which can be used to produce compile-time NaN constant with the payload.</p>\n\n<p>Referring to its documentation:</p>\n\n<blockquote>\n  <p>This function, if given a string literal all of which would have been\n  consumed by strtol, is evaluated early enough that it is considered a\n  compile-time constant.</p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAKE_QNAN_WITH_PAYLOAD(sign, payload) \\\n    sign __builtin_nan(#payload)\n\ndouble d = MAKE_QNAN_WITH_PAYLOAD(-, 0x55550001);\n\nint main(void)\n{\n    // assume little-endian byte ordering\n    for (int i = sizeof(double)-1; i &gt;= 0; i--)\n    {\n        printf(\"%.2x\", ((unsigned char *)&amp;d)[i]);\n    }\n    putchar('\\n');\n\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>fff8000055550001\n</code></pre>\n"}], "owner": {"reputation": 1108, "user_id": 582298, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/OBkU2.png?s=128&g=1", "display_name": "coderforlife", "link": "https://stackoverflow.com/users/582298/coderforlife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1513862320, "creation_date": 1513790664, "last_edit_date": 1513791273, "question_id": 47911365, "link": "https://stackoverflow.com/questions/47911365/c-double-literal-nan-with-payload", "title": "C Double Literal NaN with Payload", "body": "<p>I am using NaNs with payloads (so that the mantissa contains important information but is still treated as a NaN). For example one such value may be represented using IEEE-754-1985 in hex as <code>FFF8000055550001</code> which has a sign bit of 1, the exponent of <code>7FF</code> for a NaN/infinity, the quiet NaN bit set (at least on most architectures), and a payload of <code>0x55550001</code>.</p>\n\n<p>However this has a few problems. First, this cannot be created easily as a literal in C/C++ since the common methods all cannot be used to initialize literals:</p>\n\n<ul>\n<li>hex-literal notation for doubles (the best option, see <a href=\"https://stackoverflow.com/questions/3947159/define-double-constant-as-hexadecimal/3947725#3947725\">here</a>) but only seems to support <s>finite values and not infinities or NaNs</s> non-NaN values (I can get <code>inf</code>s by using <code>p1024</code> and <code>p-1024</code> but the mantissa is ignored in this case)</li>\n<li><code>memcpy</code> is nice as it avoids aliasing but requires a function call</li>\n<li><code>reinterpret_cast</code> is C++ only (which is okay) but requires the operand to be a variable or pointer and not a literal</li>\n<li>union-type-punning but I don't think this can be used to initialize a static-time constant</li>\n</ul>\n\n<p>Is there any method to setup the static constant for a NaN with a payload? It may be assumed that the system is IEEE-754-1985 compliant and that <code>long</code>s and <code>double</code>s have the same endian-ness. </p>\n"}, {"tags": ["c", "arrays", "linux"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513790947, "post_id": 47911260, "comment_id": 82790388, "body": "&quot;<i>B-type process needs to contact an A with the highest score.</i>&quot; So if an A and B died, an A that had rejected earlier could now be an A with the highest score. I don&#39;t see you do that."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513791138, "post_id": 47911260, "comment_id": 82790483, "body": "So I sugest: <code>if(accepted) { clearContacted(highestPid); exit;}</code> to clear the list and remove A, which now no longer exists."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513791386, "post_id": 47911260, "comment_id": 82790613, "body": "A better way would be to sort the array (if the A&#39;s have exclusive access), then work from the top. Remove contacted As by moving the array down and adjusting a variable <code>n_inuse</code> or alike that tracks the number of elements in use of the array. If it reaches zero, the array is empty."}, {"owner": {"reputation": 190, "user_id": 5644388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbc604c5e9c0f97eb7e3241738c34ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sepfins", "link": "https://stackoverflow.com/users/5644388/sepfins"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513792281, "post_id": 47911260, "comment_id": 82791090, "body": "@PaulOgilvie, I simplified the problem, in reality it&#39;s not the highest score, but the highest GCD between B&#39;s &quot;score&quot; and score of A. So I can&#39;t sort array in shared memory, because every B has its own order. Also A deletes its entry from shared array before exit. Sorry for not being clear enough, and thank you very much for answering."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513792855, "post_id": 47911260, "comment_id": 82791395, "body": "What are the criteria for A to accept or reject?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513793148, "post_id": 47911260, "comment_id": 82791533, "body": "&quot;what could be a better solution&quot; cannot be answered from the information in your question because it is incomplete. Also, in no way does your code match the revised specification. The &quot;right&quot; combination of data structure and algorithm can only be found/designed when all information is available. In your GCD addition you can create an NxN matrix with the GCDs of each combination (and set members used to zero)."}, {"owner": {"reputation": 190, "user_id": 5644388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbc604c5e9c0f97eb7e3241738c34ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sepfins", "link": "https://stackoverflow.com/users/5644388/sepfins"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513793300, "post_id": 47911260, "comment_id": 82791612, "body": "@PaulOgilvie B sends GCD to A, if GCD is one of n highest possible for A (A has an array with all its factors), then A accepts. If A rejects 10 times, n is incremented by 1."}, {"owner": {"reputation": 190, "user_id": 5644388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbc604c5e9c0f97eb7e3241738c34ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sepfins", "link": "https://stackoverflow.com/users/5644388/sepfins"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1513794259, "post_id": 47911260, "comment_id": 82792057, "body": "@PaulOgilvie by &quot;better solution&quot; I meant to ask for a way to iterate an shared array, which is constantly updated, picking always the best possible match (highest GCD with A that did not previously reject B). Again, sorry if I&#39;m not being clear, but the complete code is too long to include/explain."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1513800945, "post_id": 47911260, "comment_id": 82795149, "body": "@Sepfins: Are the properties of A processes static (except when completely removed following an accept, of course), or do they dynamically change?"}, {"owner": {"reputation": 190, "user_id": 5644388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbc604c5e9c0f97eb7e3241738c34ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sepfins", "link": "https://stackoverflow.com/users/5644388/sepfins"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1513810964, "post_id": 47911260, "comment_id": 82799215, "body": "@NominalAnimal they are static"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1513820719, "post_id": 47911260, "comment_id": 82801601, "body": "No, this approach makes no sense to me. The solution obtained this way is not guaranteed to be <i>&quot;best&quot;</i> in any sense of the word. In fact, it is reminescent of the traveling salesman problem (with an additional constraint that there are many salesmen and more important cities need to be serviced first), except that you haven&#39;t even specified how the pool A processes are ordered amongst themselves. In short, this problem is woefully underspecified, and any implementation/solution will be basically random: not useful in any way I can perceive."}, {"owner": {"reputation": 190, "user_id": 5644388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbc604c5e9c0f97eb7e3241738c34ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sepfins", "link": "https://stackoverflow.com/users/5644388/sepfins"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1513874597, "post_id": 47911260, "comment_id": 82827058, "body": "@NominalAnimal, I just described my problem in a very bad way, I guess. I&#39;ll try to do an example just for clarity and close the question. After all this method works, and I&#39;ll stick with it. So, example:  Shared A&#39;s score array (in complete code it&#39;s a struct with a score variable): [ 78, 20, 65]; B1&#39;s score: 10; B2&#39;s score: 13; B1 should communicate As in this order: [A[1], A[2], A[0]] (&#39;cause highest GCD of 10 is with 20, second highest with 65...); B2&#39;s order should be: [A[0], A[2], A[1]]."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1513876037, "post_id": 47911260, "comment_id": 82827778, "body": "As you have a running code, you could ask for a full review at <a href=\"https://codereview.stackexchange.com/\">Code Review</a>. Read their help center first because their rules are not exactly the same as SO ones. The good point is that longer code would be acceptable there."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1513883224, "post_id": 47911260, "comment_id": 82831277, "body": "@Sepfins: Let&#39;s say A[1] and A[0] reject the bids in the same real time, and B1 and B2 bid A[2] at the same time. <b>What should happen?</b> You say you require the <i>&quot;best&quot;</i> solution, but no rules as to how to solve these races. Or, what if B2 is faster than B1, and gets rejected by A[0], A[2], and A[1]: what happens then? It has been completely rejected. These are not just details, these are the rules that need to be defined, when you wish to find the optimum solution (across all processes, over both pools)."}, {"owner": {"reputation": 190, "user_id": 5644388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbc604c5e9c0f97eb7e3241738c34ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sepfins", "link": "https://stackoverflow.com/users/5644388/sepfins"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1513883594, "post_id": 47911260, "comment_id": 82831502, "body": "@NominalAnimal as written in the note, there are semaphores that control the races. Only one B can read shared structure/bid/receive reply at a time, another B will be able to do that only when first B got its reply."}], "owner": {"reputation": 190, "user_id": 5644388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbc604c5e9c0f97eb7e3241738c34ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sepfins", "link": "https://stackoverflow.com/users/5644388/sepfins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513873660, "creation_date": 1513790283, "last_edit_date": 1513873660, "question_id": 47911260, "link": "https://stackoverflow.com/questions/47911260/taking-elements-in-decreasing-order-from-an-array-in-shared-memory", "title": "Taking elements in decreasing order from an array in shared memory", "body": "<p>I have a program with two types of processes: A and B. All B processes need to read an array in shared memory containing information about every A. Then, B-type process needs to contact an A with the highest score. A can accept or reject the message, if it accepts, both processes die. If A rejects, then B should find the second highest and try again, and so on. I can only think about this solution :</p>\n\n<pre><code>while(running) {\n\n    pList* iterator = sharedStructure;\n\n    int highestPid;\n    int highestScore = -1;\n\n    while(iterator-&gt;pid) {  // If entry exists\n        if(!inContacted(iterator-&gt;pid)) { // If A process was not contacted before\n            if(iterator-&gt;score &gt; highestScore) {\n                highestScore = iterator-&gt;score;\n                highestPid = iterator-&gt;pid;\n            }\n        }\n        iterator++;\n    }\n\n    // Contact highestPid \n\n    if(accepted) {\n        // exit\n    } else {\n        addToContacted(highestPid);\n    }\n} \n</code></pre>\n\n<p>Also, contacted array needs to be emptied after a B tried to contact everyone, so it can start over. This solution seems bad to me, what could be a better one?</p>\n\n<p>Note: In complete code there are semaphores that control access to shared memory.</p>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1513789002, "post_id": 47910824, "comment_id": 82789383, "body": "Show a normal MCVE. These chunks cut out of nowhere do not show anything."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1513789031, "post_id": 47910824, "comment_id": 82789395, "body": "IRQ0 has precedence over IRQ1 using the default PIC1 configuration. Google for EOI if this doesn&#39;t ring any bells. Otherwise, it can be the type of interrupt descriptor used."}], "answers": [{"comments": [{"owner": {"reputation": 12703, "user_id": 584597, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d519ba6b69a89cc8ec99001eea2059b?s=128&d=identicon&r=PG", "display_name": "payne", "link": "https://stackoverflow.com/users/584597/payne"}, "edited": false, "score": 1, "creation_date": 1513790088, "post_id": 47911071, "comment_id": 82789946, "body": "The sti instruction does not necessarily enable &quot;all interrupts&quot;, because prioritization may be happening in the PIC/APIC controller before the interrupt is even presented to the CPU.  See:  &quot;PIC end of interrupt&quot; command (EOI) <a href=\"https://en.wikipedia.org/wiki/End_of_interrupt\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/End_of_interrupt</a>"}, {"owner": {"reputation": 13, "user_id": 9123598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d055e78b78ca85e735a94c2f012f83?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/9123598/kevin"}, "edited": false, "score": 0, "creation_date": 1513790633, "post_id": 47911071, "comment_id": 82790228, "body": "Thanks for your reply. I will try that when I&#39;m free. First of all, I&#39;m in protected mode and I think I&#39;ve set the right GDT  and IDT. Could it be this, I used the step debug mode in Bochs, and I set break points on each handler before boot, but when using my so called nested interrupts, I just can&#39;t see the any break points work. And when I use print-stack, I can see the stack didn&#39;t  grow,  it remained unchanged. Could it be that the CPU is so faster that I cannot see when  the stack is overflow?"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 12703, "user_id": 584597, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d519ba6b69a89cc8ec99001eea2059b?s=128&d=identicon&r=PG", "display_name": "payne", "link": "https://stackoverflow.com/users/584597/payne"}, "edited": false, "score": 0, "creation_date": 1513790704, "post_id": 47911071, "comment_id": 82790260, "body": "@payne thanks for the comment and good answer, indeed this is important bit of information for OP, as he has sort of two problems in one, the particular detail of x86 timer interrupt handling, requiring the EOI code in handler, and the general one with understanding re-entrancy of interrupts and consequences of slow handlers."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 13, "user_id": 9123598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d055e78b78ca85e735a94c2f012f83?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/9123598/kevin"}, "edited": false, "score": 0, "creation_date": 1513790880, "post_id": 47911071, "comment_id": 82790352, "body": "@kevin in protected mode the user app stack and interrupt handling stack is often different. I never studied details, how to set it up and where to check this configuration, but that&#39;s how it looks from user land, my app code stack is never modified by ongoing kernel land interrupts, they have their own stack. As I not OS dev, can&#39;t disclose more details. Why your breakpoints don&#39;t work on handlers... well, breakpoint is interrupt too, so maybe you have to put them after enabling of interrupts, to make them work. Never debugged <b>live</b> x86 interrupt code, so I&#39;m not sure how to proceed."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 13, "user_id": 9123598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d055e78b78ca85e735a94c2f012f83?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/9123598/kevin"}, "edited": false, "score": 0, "creation_date": 1513791039, "post_id": 47911071, "comment_id": 82790437, "body": "@kevin I always first debugged the code separately in debugger, before setting it up as live interrupt handler, and breakpointing inside handler sounds like you need re-entrancy, and basically opening can of worms and recursive complications. Unless you are absolutely needing this, I would suggest to avoid it, rather debug the handler code in non-live fashion, calling it from main, simulating IRQ conditions, skipping over technical details like cli/sti/eoi, adding those when you know the core of handler works and installing it for live."}, {"owner": {"reputation": 13, "user_id": 9123598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d055e78b78ca85e735a94c2f012f83?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/9123598/kevin"}, "edited": false, "score": 0, "creation_date": 1513791053, "post_id": 47911071, "comment_id": 82790449, "body": "@Ped7g yes, I think you are right. I&#39;m a beginner and there are a lot things need to learn and probably it it &quot;how to learn&quot;. But sometimes I truly don&#39;t know where to find the right information I need."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1513791272, "post_id": 47911071, "comment_id": 82790547, "body": "Np, interrupts are quite tricky, it&#39;s not uncommon some bugs creep into even official OS versions. Debugging the common core cases is not that difficult, you can usually simulate those conditions easily, what is truly tricky about handlers is to think about all the possible corner cases (like when they modify some queue, which is being processed in main thread, you need correct access locks and atomicity, so both main thread and interrupt operate on correct data, and not some partially modified garbage and they don&#39;t end in some dead-lock waiting for each other, etc) and simulate/test those."}], "tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": true, "score": 1, "last_activity_date": 1513790282, "last_edit_date": 1513790282, "creation_date": 1513789536, "answer_id": 47911071, "question_id": 47910824, "link": "https://stackoverflow.com/questions/47910824/x86-interrupt-handler-gets-blocked-when-using-infinite-loop/47911071#47911071", "title": "x86 interrupt handler gets blocked when using infinite loop", "body": "<p>By enabling interrupts inside interrupt handler you don't enable only \"others\" interrupts, but all interrupts. Including the timer interrupt.\n(this is too general, payne points out in comment, on x86 there may be different sources of IRQ signals, and particular PIC/APIC chips can be configured to prioritize one over other ... doesn't change anything about the <em>principle</em> of re-entrant IRQ handling, but you can fine-tune which IRQs have priority, which may mean you don't need re-entry lock at all in the end, if your configuration prevents it)</p>\n\n<p>Your code doesn't look like re-entrant-aware handler, so if that is how your handler code is done, then your timer keeps firing up new timer interrupts as configured, and because you have <code>sti</code> there, they keep re-entering the handler code, filling up slowly stack space until it will overflow (or wrap around, I'm not sure if you are in real or protected mode, and how your stack is set up). Only the last one is of course running, rest is dormant (forever, if the last one doesn't return).</p>\n\n<p>A long-duration interrupt handlers are usually sign of bad code architecture (aim for shortest + fastest possible interrupt handlers, often just filling up some queue with data, which is processed in async way outside of interrupt handler). But if you really need one, and you can't leave other interrupts disabled, you must write the handler as re-entrant one.</p>\n\n<pre><code>Re-entrant timer interrupt handler\n{\n    if (locked) return;   // already handling previous IRQ\n        // which means the new IRQ is **IGNORED**! (price for slow handler)\n    locked = true;        // lock to prevent further re-entry\n    sti();                //set IF to 1 to enable interrupts\n\n    // do the slow stuff here (but not infinite loop of course!)\n\n    // \"print();\" is not an excellent idea either, for interrupt handler\n    // while(1); // this would never ever end at all, so NO.\n\n    // slow stuff finished, ready for next request\n\n    locked = false;       // allow next timer IRQ to process the slow stuff again\n    return;\n}\n</code></pre>\n\n<hr>\n\n<p>addendum: one more remark, probably \"obvious\" one, but just to make sure it's clear. Single CPU core can run at the same moment only single \"thread\" of instructions, i.e. it is either executing your infinite loop inside <code>main</code>, or it is executing one of the interrupt handlers. When new IRQ signal comes to CPU and interrupts are enabled, the current CPU state is stored in stack (whether it was in main, or timer or keyboard, doesn't matter), and CPU will switch to the desired interrupt handler. So if you emit IRQs faster than your handlers do finish and return to previous code, you will slowly choke the stack memory with the stored CPU states, and it will never return to the original thread at bottom (the infinite loop inside <code>main</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 12703, "user_id": 584597, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d519ba6b69a89cc8ec99001eea2059b?s=128&d=identicon&r=PG", "display_name": "payne", "link": "https://stackoverflow.com/users/584597/payne"}, "is_accepted": false, "score": 2, "last_activity_date": 1513789912, "creation_date": 1513789912, "answer_id": 47911159, "question_id": 47910824, "link": "https://stackoverflow.com/questions/47910824/x86-interrupt-handler-gets-blocked-when-using-infinite-loop/47911159#47911159", "title": "x86 interrupt handler gets blocked when using infinite loop", "body": "<p>Timer interrupts (IRQ0) have priority over keyboard interrupts (IRQ1).</p>\n\n<p>So even though you're enabling interrupts generally (with an sti instruction) in your timer interrupt handler, the primary interrupt controller (PIC) is only going to enable higher priority interrupts until your timer/IRQ0 service routine is complete.</p>\n\n<p>For some additional explanation, see:  <a href=\"https://groups.google.com/forum/#!topic/comp.lang.asm.x86/7coo0px-BU4\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/comp.lang.asm.x86/7coo0px-BU4</a></p>\n\n<blockquote>\n  <p>Right, that is what happens.  The interrupt controller (the primary\n  one, in this case) which signalled the timer interrupt to the CPU will\n  not allow any equal or lower priority interrupts through until the CPU\n  has told it that the timer interrupt has finished, through the EOI\n  instruction (<code>outportb(0x20, 0x20)</code> for the primary interrupt\n  controller).</p>\n</blockquote>\n\n<p>You <em>could</em> technically issue an EOI instruction to the PIC to tell it that handling of IRQ0 is done, but you will potentially set yourself up for some very messy scenarios and race conditions.</p>\n\n<p>It would be much cleaner to let the interrupt handlers just handle their specific interrupts and save associated state.  Then, have your main program watch for the sequence you need (e.g. timer, then keyboard)</p>\n"}], "owner": {"reputation": 13, "user_id": 9123598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d055e78b78ca85e735a94c2f012f83?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/9123598/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 47911071, "answer_count": 2, "score": 0, "last_activity_date": 1513790282, "creation_date": 1513788593, "last_edit_date": 1513789098, "question_id": 47910824, "link": "https://stackoverflow.com/questions/47910824/x86-interrupt-handler-gets-blocked-when-using-infinite-loop", "title": "x86 interrupt handler gets blocked when using infinite loop", "body": "<p>I'm trying to learn x86 assembly and c language. And now I've finished a simple timer and keyboard interrupts. The firs one can print a line every several ticks and the second can print what you've pressed on keyboard.The code is just like:</p>\n\n<p><strong>Timer.c:</strong></p>\n\n<pre><code>print();\nreturn;\n</code></pre>\n\n<p><strong>keyboard.c:</strong></p>\n\n<pre><code>print();\nreturn;\n</code></pre>\n\n<p><strong>main.c:</strong></p>\n\n<pre><code>while(1);\n</code></pre>\n\n<p>these two handlers are in the IDT.  So when an interrupt occurs, the IF flag is cleared. The CPU will ignore other interrupts. \nAfter initialized  all the configurations in my main function, I finished it with a infinite loop, which is like : <code>while(1)</code>.\nOk, this is good, I can see on the screen that those two handlers work.<br>\nHowever, when I want to make it a nested interrupt, I did the following thing:</p>\n\n<p><strong>Timer.c:</strong></p>\n\n<pre><code>sti();      //set IF to 1 to enable interrupt \nprint();\nwhile(1); // wait here to test if the keyboard interrupt can  occur\nreturn;\n</code></pre>\n\n<p><strong>keyboard.c:</strong></p>\n\n<pre><code>print();\nreturn;\n</code></pre>\n\n<p><strong>main.c:</strong></p>\n\n<pre><code>while(1);\n</code></pre>\n\n<p>what happened next really consused me: using Bochs, I can see that my program just do the while loop in timer.c. At this moment, I checked the flags, it showed that IF flag had been set, but when I try to type something to test the other interrut, it failed. It just seemed that all the interrupts were blocked or ignored. </p>\n\n<p>The question is, what's the difference between those two loops, one is just in an interrupt handler, also, I dont konw how to solve this problem. I double checked my code in my vmware and virtualbox, but the result was same.</p>\n\n<p>I know this problem must have happened before I met it, however, I can't find anything related to this problem.</p>\n"}, {"tags": ["c", "macos", "assembly", "virtualization", "xnu"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1513788657, "post_id": 47910789, "comment_id": 82789207, "body": "<code>sidt</code> returns a physical address as opposed to a virtual address.  Did you make sure to translate the virtual address to a virtual address before trying to understand its contents?"}, {"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1513788984, "post_id": 47910789, "comment_id": 82789371, "body": "I&#39;m trying to access the idt from kernel module so yes, and when running the same code from older version of macOS, and it works perfectly."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1513789100, "post_id": 47910789, "comment_id": 82789429, "body": "Even in a kernel module addresses are virtual.  There is really no way around converting the address to a virtual one."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1513789633, "post_id": 47910789, "comment_id": 82789698, "body": "@fuz also it is not <b>physical</b>, the descriptor table bases are <b>linear</b> not <b>physical addresses</b>. In 64-bit mode with segmenting mostly gone, they <i>are</i> the virtual addresses."}, {"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1513789955, "post_id": 47910789, "comment_id": 82789862, "body": "@anttihaapala, perhaps you can add the idt descriptor struct to your answer and some code example for how to assemble the address of callback function to interrupt 80. thanks !"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1513790213, "post_id": 47910789, "comment_id": 82790008, "body": "@AnttiHaapala Indeed! Sorry for this mistake."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 3, "creation_date": 1513790232, "post_id": 47910789, "comment_id": 82790019, "body": "It&#39;s possible SIDT isn&#39;t being emulated properly. If your CPU doesn&#39;t support hardware virtualization or you&#39;re not using it then some VMs fall back on just running kernel code in ring 3 and handling the exceptions that are generated when the code tries execute privileged instructions. The problem is that SIDT isn&#39;t privileged so you get the real IDT virtual address of the VM host rather than emulated one of the VM guest. Generally though this isn&#39;t a problem because operating systems don&#39;t actually use the SIDT instruction."}, {"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1513790607, "post_id": 47910789, "comment_id": 82790212, "body": "@rossridge, my host machine is 10.12 and the guest VM is 10.13, but somehow I get different idt addresses in both guest and host (host is 0xffffff8000000000 and guest is 0xfffffd0000007000) .. what can lead for this difference if the idt is not emulated ?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1513791529, "post_id": 47910789, "comment_id": 82790681, "body": "@Zohar81 Each logical CPU gets allocated its own IDT so you need to find out the linear addresses of all the host&#39;s IDTs to compare."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1513796652, "post_id": 47910789, "comment_id": 82793186, "body": "@Zohar81: For 64-bit code the default operand size for most instructions is still 32-bit, and I suspect that you&#39;re doing a 32-bit &quot;SIDT&quot; that only sets the lowest 32-bits of <code>idt_address</code>. To test this theory, try <code>unsigned char idt_out[10] = 0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC;</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1513797143, "post_id": 47910789, "comment_id": 82793425, "body": "@fuz: re discussion in comments on Antti&#39;s deleted answer: It can be a problem to create misaligned pointers in C, even when targeting x86.  Gcc doesn&#39;t explicitly support it, it just happens to work most of the time with normal x86 code-gen.  It <a href=\"https://stackoverflow.com/questions/47510783/why-does-unaligned-access-to-mmaped-memory-sometimes-segfault-on-amd64\">will break if gcc decides to auto-vectorize</a> and assumes that some number of scalar iterations will reach an alignment boundary."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1513798119, "post_id": 47910789, "comment_id": 82793893, "body": "@Brendan: <a href=\"https://github.com/HJLebbink/asm-dude/wiki/SIDT\" rel=\"nofollow noreferrer\">Intel&#39;s ISA reference manual entry for <code>sidt</code></a> says the operand size is fixed at 8+2 bytes.  Checking with poison values is probably worth trying in case something weird is happening, though."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1513798670, "post_id": 47910789, "comment_id": 82794144, "body": "@Zohar81: Are you running this code from a kernel module?  Is that how you&#39;re able to read the memory at the address you get from <code>SIDT</code>?  I expect it would fault in a normal user-space process.  Anyway, are the pointer addresses even close to what you expect?  Do they have the right <i>relative</i> offset from each other?  If so, maybe there&#39;s ASLR for the kernel in 10.13 and the &quot;expected&quot; addresses you&#39;re generating are the non-ASLRer values.  Can you find another pointer to <code>idt64_unix_scall</code> inside the kernel?  Or simply make one yourself in your module so you can print the relocated value."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1513799172, "post_id": 47910789, "comment_id": 82794364, "body": "@AnttiHaapala That is interesting! I consider this to be a compiler bug."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1513805862, "post_id": 47910789, "comment_id": 82797412, "body": "@fuz: were you replying to my comment?  See my linked answer and discussion in comments about whether this is a gcc bug or not.  Conclusion: no, a <code>uint16_t*</code> with less than <code>alignof(uint16_t)</code> is UB, so gcc is allowed to make that assumption.  If the source had used <code>memcpy</code> for the unaligned load / store, there would be no UB, and it would compile to a scalar load just fine, but auto-vectorization would then have to account for the possibility that aligned SIMD loads wouldn&#39;t line up with element boundaries.  <a href=\"https://godbolt.org/g/AscgSu\" rel=\"nofollow noreferrer\">godbolt.org/g/AscgSu</a>"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1513807002, "post_id": 47910789, "comment_id": 82797848, "body": "@Zohar81 Also it just occurred to me that a VM doing what I suggested would probably allocate its own IDTs separate from the host&#39;s IDTs, so it can catch all the exceptions generated while executing client code."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1516112665, "post_id": 48281182, "comment_id": 83550651, "body": "Are you sure it&#39;s part of the Meltdown fix and not Spectre workarounds?  A kernel can fully protect itself from Meltdown by never leaving kernel memory mapped (depending on the U/S bit set for protection) when running user-space code.  I don&#39;t see how the IDT has anything to do with it.  Or is this something to do with the VM, rather than OS X kernel patches?"}, {"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1516170687, "post_id": 48281182, "comment_id": 83574414, "body": "Hi, from what I know as a fact (without reversing so far), is that the patch in 10.13.2 obviously shows new IDT behavior.. I can assume from the timing of 10.13.2 release that this changes come to improve the memory separation between kernel and user apps since this opcode doesn&#39;t require any special permission. it just seems reasonable. I wish I could understand exactly how the IDT is working now. if it&#39;s managed by the kernel (and not the hardware) so I guess they somehow changed the accessing to the interrupt callbacks so that it wouldn&#39;t be exposed in anyway from user-space."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1516172801, "post_id": 48281182, "comment_id": 83575309, "body": "Maybe it is for Meltdown.  I think the IDT has to be mapped for interrupts to work (including when user-space code is executing), so user-space could read it with Meltdown.  This could expose pointers into the kernel, defeating kernel ASLR.  So maybe they do some trickery.  Like maybe an extra level of indirection.  In your question you say the structure is &quot;corrupt&quot;, but surely it must point somewhere that has pointers to handlers.  (Unless there&#39;s some extra level of VM trickery happening and it doesn&#39;t actually emulate <code>sidt</code> inside the VM, like Ross suggested.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1516172857, "post_id": 48281182, "comment_id": 83575331, "body": "Oh, or maybe when you try to dereference those pointers, the page tables are different from when interrupts can be taken.  So Meltdown mitigation might be affecting your code&#39;s mappings from virtual-&gt;physical, and you&#39;re reading the wrong memory?"}], "tags": [], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "is_accepted": false, "score": 0, "last_activity_date": 1516105294, "creation_date": 1516105294, "answer_id": 48281182, "question_id": 47910789, "link": "https://stackoverflow.com/questions/47910789/sidt-opcode-return-address-to-malformed-idt-structure/48281182#48281182", "title": "SIDT opcode return address to malformed IDT structure", "body": "<p>Apparently, the reason for the <code>sidt</code> stopped working is intentional and part of the Meltdown fix. </p>\n\n<p>That's all I managed to find out so far, if anybody got more clues about the reasoning, please enlighten us.</p>\n"}], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 310, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1516105294, "creation_date": 1513788444, "last_edit_date": 1513805223, "question_id": 47910789, "link": "https://stackoverflow.com/questions/47910789/sidt-opcode-return-address-to-malformed-idt-structure", "title": "SIDT opcode return address to malformed IDT structure", "body": "<p>My goal is to access the IDT from a MacOS kernel module. </p>\n\n<p>I'm running macOS 10.13.2 under VMFusion 10.0.1, and it seems like the <code>sidt</code> assembly command points to corrupted table structure. </p>\n\n<p>This opcode should return the address to \"Interrupt Descriptor Table\" which holds the descriptors for each interrupt. </p>\n\n<p>Each interrupt contain pointer for callback function that should be called when a specific interrupt is called. </p>\n\n<p>For example, here are 2 interrupt descriptor that points to valid callbacks from kernel __TEXT section in previous older versions.</p>\n\n<ul>\n<li>int3 points to idt64_int3 </li>\n<li>int80 points to idt64_unix_scall</li>\n</ul>\n\n<p>etc...</p>\n\n<p>For some reason, starting from high Sierra 10.13.2, the <code>sidt</code> return memory range that doesn't contain valid pointers (all are outside the boundary of the kernel <code>__TEXT</code> section). perhaps there's another way of getting the table pointer ? </p>\n\n<p>here's my source code for finding the idt pointer: </p>\n\n<pre><code>unsigned char idt_out[10];\n__asm__ volatile (\"sidt %0\": \"=m\" (idt_out));\n\n// skip the first 2 bytes as they are not part of the address\nuint64_t idt_address = *((unsigned long long *)(idt_out+2));\nprintf(\"idt address is %llx \\n\",  idt_address);\n\nint80_desc = (struct descriptor_idt*)(idt_address + sizeof(struct idt_desc)*0x80);\nint80_address = (mach_vm_address_t)(((unsigned long)int80_desc-&gt;offset_high &lt;&lt; 32) + ((unsigned int)int80_desc-&gt;offset_middle &lt;&lt; 16) + int80_descriptor-&gt;offset_low); // this should point to idt64_unix_scall\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-device-driver", "dma"], "comments": [{"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513788756, "post_id": 47910615, "comment_id": 82789254, "body": "<code>buf</code> is a <i>pointer</i>, not an array type. The <code>mmap</code> returns you an <i>address</i> to a buffer intended to be used for I/O, or NULL on failure. Reseating the pointer by assigning a string literal merely updates the pointer variable without touching the buffer memory previously pointed to. As for memory changes you will need to use appropriate synchronization primitives after issuing DMA operations updating the buffer, or after any other form of asynchronously writes. These are low-level operations with many subtle pitfalls. Frankly I would recommend gaining more familiarity with the language first."}, {"owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513792570, "post_id": 47910615, "comment_id": 82791244, "body": "<b>As for memory changes you will need to use appropriate synchronization primitives after issuing DMA operations updating the buffer, or after any other form of asynchronously writes</b>. What do you mean by this? IOCtl calls?"}, {"owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513793377, "post_id": 47910615, "comment_id": 82791648, "body": "And I understand memory management in C. I assumed the location of the mapped memory to the driver kernel memory would remap to the location of the literal when I changed it. It&#39;s more of a lack of familiarity with the GNU API. You are saying once you run that mmap command and point it to that buffer, it won&#39;t change unless explicitly demanded, meaning you must write characters directly to the memory locations of the buffer, being careful not to reassign the pointer."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513793530, "post_id": 47910615, "comment_id": 82791721, "body": "In general the device which the DMA channel communicates with may read from or write to the buffer at any time, including while your application is half-way through accessing the buffer. Furthermore caches may hold stale or dirty data not yet written to memory. This requires synchronization to insure that neither side sees incorrect data. Alas will vary greatly though and you need to review the device implementation and system architecture manuals closely to determine the appropriate mechanism, some simple cases coherency protocols may even make this work transparently for you."}, {"owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513793963, "post_id": 47910615, "comment_id": 82791923, "body": "An architecture that might make more sense is to have the chip look at one dma buffer for input and let the output flow to another location that also has a dma buffer so the application can perform processing of the response. IE two DMA channels, one for read and one for write. That would avoid the concurrency issues you are mentioning, correct, assuming the GNU function gives some indication of when it is finished writing to the buffer?"}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513794223, "post_id": 47910615, "comment_id": 82792032, "body": "<code>mmap</code> returns a pointer to a <i>specific</i> memory block with particular properties. Changing <code>buf</code> changes what the pointer points to, setting the address to that of a string constant stored within your program instead while forgetting the original address given to you by <code>mmap</code>. This is the computer equivalent of typing in a new address for your friend in your address book and expecting the friend to move as a result."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 2, "creation_date": 1513795072, "post_id": 47910615, "comment_id": 82792446, "body": "Not exactly, it depends on the memory architecture and the protocol implemented by the device. Host-initiated DMA transfers and coherency requirements depend on the interface used, and in this case for a user-level interface will be mediated by a kernel driver and its guarantees. Of course of the device autonomously initiates operations then the synchronization mechanism will be inherently device-specific. It is difficult to make any general statements, direct memory accesses are non-portable mechanisms on which dirty tricks are sometimes played to increase performance."}, {"owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1513795793, "post_id": 47910615, "comment_id": 82792766, "body": "do you have any documentation about what specifics will need to be addressed for a given device and what programming methods, especially related to Linux environment, there are for addressing them?"}], "owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 680, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513791381, "creation_date": 1513787800, "question_id": 47910615, "link": "https://stackoverflow.com/questions/47910615/reading-and-writing-using-dma-character-device-driver", "title": "Reading and Writing Using DMA Character Device Driver", "body": "<p>I am using this character device driver <a href=\"https://github.com/ikwzm/udmabuf\" rel=\"nofollow noreferrer\">https://github.com/ikwzm/udmabuf</a> to do DMA. In the documentation, the author says to access the driver you can open the device file like this </p>\n\n<pre><code>  if ((fd  = open(\"/dev/udmabuf0\", O_RDWR)) != -1) {\n        buf = mmap(NULL, buf_size, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);\n        /* Do some read/write access to buf */\n        close(fd);\n    }\n</code></pre>\n\n<p>I have two questions. The first is the type of buf, which I am assuming is char* rather than char[N], but I just want to be sure.</p>\n\n<p>The second question is how to actually perform the reading and writing. Could I write by simply changing the characters to which buf is pointing, assuming it is a pointer?</p>\n\n<pre><code>buf = mmap(NULL, buf_size, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);    \nbuf = \"I am doing some writing to dma\";\n</code></pre>\n\n<p>If that is the case, will buf continue to change as the memory buf is mapped to is changing?</p>\n\n<pre><code>buf = mmap(NULL, buf_size, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);\nprintf(buf) //\"abcd\"\nsleep(10);\nprintf(buf) //\"efgh\"\n</code></pre>\n"}, {"tags": ["c", "algorithm", "hash", "segmentation-fault"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513787216, "post_id": 47910348, "comment_id": 82788400, "body": "you should print out pointers using %p not %d"}, {"owner": {"reputation": 5883, "user_id": 5411888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vLbdS.jpg?s=128&g=1", "display_name": "Amit Upadhyay", "link": "https://stackoverflow.com/users/5411888/amit-upadhyay"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513787366, "post_id": 47910348, "comment_id": 82788483, "body": "@ChrisTurner yes, I should (I just wanted to see the memory in decimal not in hexadecimal so I used %d), but that&#39;s ok for now, as I just used printf() for debug purpose."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1513787594, "post_id": 47910348, "comment_id": 82788617, "body": "<code>printf(&quot;\\nTEMP = %d&quot;, temp);</code> you are trying to print a struct here with <code>%d</code>, why?"}, {"owner": {"reputation": 5883, "user_id": 5411888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vLbdS.jpg?s=128&g=1", "display_name": "Amit Upadhyay", "link": "https://stackoverflow.com/users/5411888/amit-upadhyay"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1513787809, "post_id": 47910348, "comment_id": 82788739, "body": "@Michi I just printed temp to see what&#39;s actually there in temp (if it would be null then it should give SIGSEGV there itself, but it&#39;s not giving SIGSEGV there, SIGSEGV is coming after accessing <code>data</code> field). Even if I remove <code>printf(&quot;\\nTEMP = %d&quot;, temp);</code> problem persists"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1513788049, "post_id": 47910348, "comment_id": 82788858, "body": "Check the <a href=\"https://pastebin.com/raw/ZW6mg3Gp\" rel=\"nofollow noreferrer\">Output of Valgrind</a>."}, {"owner": {"reputation": 5883, "user_id": 5411888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vLbdS.jpg?s=128&g=1", "display_name": "Amit Upadhyay", "link": "https://stackoverflow.com/users/5411888/amit-upadhyay"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513788901, "post_id": 47910348, "comment_id": 82789328, "body": "Michi yes, I got it.  @ChrisTurner and ZeroUltimax pointed out the mistake in the main function. Memory wasn&#39;t allocated in the hashtable. Thank you, everyone."}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 1, "last_activity_date": 1513787969, "creation_date": 1513787969, "answer_id": 47910667, "question_id": 47910348, "link": "https://stackoverflow.com/questions/47910348/segmentation-fault-while-implementing-chaining-in-hash-table-after-collisions-oc/47910667#47910667", "title": "Segmentation fault while implementing chaining in hash table after collisions occur", "body": "<p>The problem with your code in many places, is that you don't ensure that when indexing into <code>hashTable</code> that you remain within the bounds that you allocate initially.</p>\n\n<p>In your example, the number 565 would generate a <code>hashedValue</code> of 5. You've only allocated 5 elements in <code>hashTable</code> which covers you for the range of 0 to 4 though. Inserting into <code>hashTable[5]</code> enters the realm of undefined behaviour and your code crashes. You don't get the same problem when you enter in 7 numbers because all 7 numbers generate <code>hashedValue</code>s that are within the range 0 to 6.</p>\n\n<p>Since your <code>hashFunction</code> will only return numbers between 0 and 9, you could either declare a new variable that tracks the size of <code>hashTable</code> and expands it as numbers are entered or alternatively pre-allocate it for the maximum size.</p>\n\n<pre><code>struct LinkedListNode** hashTable = malloc(10*sizeof(struct LinkedListNode*)); // I\nint i;\nfor (i = 0; i &lt; 10; ++i)\n{\n    hashTable[i] = NULL;\n}\n</code></pre>\n\n<p>In the long term the other option would make more sense as it will adapt if you ever change <code>hashFunction</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 256, "user_id": 2206013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cade7ed9cb6146f56ee74b2dea405c?s=128&d=identicon&r=PG", "display_name": "ZeroUltimax", "link": "https://stackoverflow.com/users/2206013/zeroultimax"}, "is_accepted": false, "score": 1, "last_activity_date": 1513787986, "creation_date": 1513787986, "answer_id": 47910674, "question_id": 47910348, "link": "https://stackoverflow.com/questions/47910348/segmentation-fault-while-implementing-chaining-in-hash-table-after-collisions-oc/47910674#47910674", "title": "Segmentation fault while implementing chaining in hash table after collisions occur", "body": "<p>You problem is here: you do not correctly initialize the hash table. You wrote:</p>\n\n<pre><code>int i;\nfor (i = 0; i &lt; n; ++i)\n{\n    hashTable[i] = NULL;\n}\n</code></pre>\n\n<p>Since your hashtable has 10 buckets, it should be i &lt; 10.</p>\n\n<p>When n == 5, hashTable[5] is not initialzed and has garbage. When 545 gets hashed, it gets that garbage as it's next pointer, not NULL.</p>\n"}], "owner": {"reputation": 5883, "user_id": 5411888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vLbdS.jpg?s=128&g=1", "display_name": "Amit Upadhyay", "link": "https://stackoverflow.com/users/5411888/amit-upadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 47910667, "answer_count": 2, "score": 1, "last_activity_date": 1513787986, "creation_date": 1513786771, "last_edit_date": 1513787206, "question_id": 47910348, "link": "https://stackoverflow.com/questions/47910348/segmentation-fault-while-implementing-chaining-in-hash-table-after-collisions-oc", "title": "Segmentation fault while implementing chaining in hash table after collisions occur", "body": "<p>I am trying to implement chaining (collision resolution technique in hash table). My program works fine for most of the test cases.</p>\n\n<p>Here is my program (it's quite big, but I know where it is failing. So you can skip this part if you want.):</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct LinkedListNode\n{\n    int data;\n    struct LinkedListNode *next;\n};\n\nstruct LinkedListNode* getNewNode()\n{\n    // I don't need to cast the malloc in c\n    return malloc(sizeof(struct LinkedListNode));\n}\n\nstruct LinkedListNode* insertAtBeginning(struct LinkedListNode** hashTable, int index, int data)\n{\n    struct LinkedListNode* newNode = getNewNode(); // the new node\n    newNode-&gt;data = data;\n    newNode-&gt;next = NULL; // for now I can put the next to be null\n\n    // check if the block is containing null or not\n    if (hashTable[index] == NULL)\n    {\n        // now just insert the new element at beginning\n        hashTable[index] = newNode;\n        return hashTable[index]; // returning the new address of the block\n    }\n\n    // if collisions occur\n    struct LinkedListNode* blockListAddress = hashTable[index]; // the address pointing to first node of linked list\n    newNode-&gt;next = blockListAddress; // storing the address of block in the next of the new linkedlist\n    hashTable[index] = newNode; // changing the block address to the address of new node (as we have to insert in beginning)\n    return hashTable[index];\n}\n\nstruct LinkedListNode* searchMe(struct LinkedListNode** hashTable, int index, int key)\n{\n    struct LinkedListNode* res = NULL;\n    struct LinkedListNode* temp = hashTable[index];\n\n    if (temp == NULL)\n        return NULL;\n\n    // if we just have one element in the block then the while loop below won't get executed\n    // because here condition is temp-&gt;next which will be null, thus here I have written if condition\n    if (hashTable[index] != NULL &amp;&amp; hashTable[index]-&gt;data == key)\n    {\n        return hashTable[index];\n    }\n\n    // if not null then traverse through linked list\n    while (temp != NULL)\n    {\n        printf(\"\\nTEMP = %d\", temp);\n        if (key == temp-&gt;data)\n            res = temp;\n        printf(\"\\ntemp-&gt;data=%d\\n\", temp-&gt;data);\n        temp = temp-&gt;next;\n    }\n    return res;\n}\n\nint hashFunction(int num)\n{\n    return num%10;\n}\n\nint main()\n{\n    int n;\n    printf(\"\\nEnter elements to be stored\\n\");\n    scanf(\"%d\", &amp;n);\n\n    // declaring the hashTable of size n (i.e. size of input elements), its gonna have pointers to LinkedListNode\n    struct LinkedListNode** hashTable = malloc(n*sizeof(struct LinkedListNode*)); // I have given memory to the table, now I even need to give memory to the elements in the table\n    int i;\n    for (i = 0; i &lt; n; ++i)\n    {\n        hashTable[i] = NULL;\n    }\n\n    int d;\n    printf(\"\\nEnter the elements in array\\n\");\n    for (i = 0; i &lt; n; ++i)\n    {\n        scanf(\"%d\", &amp;d);\n        int hashedValue = hashFunction(d);\n        hashTable[hashedValue] = insertAtBeginning(hashTable, hashedValue, d);\n    }\n\n    int key;\n    printf(\"\\nEnter the element you want to search for\\n\");\n    scanf(\"%d\", &amp;key);\n    int ind = hashFunction(key);\n    struct LinkedListNode* res = searchMe(hashTable, ind, key);\n\n    if (res == NULL)\n    {\n        printf(\"\\nNot found\\n\");\n    }\n    else\n    {\n        printf(\"\\n%d is found\\n\", res-&gt;data);\n    }\n}\n\n\n// time complexity in worst case for searching = O(n),\n// average case t.c = O(1+alpha), where alpha = n/m\n// n &lt;- number of elements in hashtable\n// m &lt;- size of hashtable\n// so alpha is 1 in this case\n// thus average t.c = theta(1)\n</code></pre>\n\n<p>The program gives <code>SIGSEGV</code> for this test case:</p>\n\n<blockquote>\n  <p>Enter elements to be stored</p>\n  \n  <p>5</p>\n  \n  <p>Enter the elements in array</p>\n  \n  <p>21 32 565 784 445</p>\n  \n  <p>Enter the element you want to search for</p>\n  \n  <p>565</p>\n  \n  <p>TEMP = 35383520</p>\n  \n  <p>temp->data=445</p>\n  \n  <p>TEMP = 35383456</p>\n  \n  <p>temp->data=565</p>\n  \n  <p>Segmentation fault (core dumped)</p>\n</blockquote>\n\n<p>After debugging I found that it's throwing seg fault at line number 56, i.e.:</p>\n\n<pre><code>if (key == temp-&gt;data)\n</code></pre>\n\n<p>This line is written in this code snippet:</p>\n\n<pre><code>while (temp != NULL)\n{\n    printf(\"\\nTEMP = %d\", temp);\n    if (key == temp-&gt;data)\n        res = temp;\n    printf(\"\\ntemp-&gt;data=%d\\n\", temp-&gt;data);\n    temp = temp-&gt;next;\n}\n</code></pre>\n\n<p>As you can see in the failing test above that, the while loop is executing 3 times (it was supposed to be executed only twice, because the temp should point to null for the third time). And while it is executing 3rd time, it's throwing segfault at the line <code>if (key == temp-&gt;data)</code>.</p>\n\n<p>It means that temp is not <code>NULL</code>, and it even doesn't has <code>data</code> field. So there might be the problem in the insertion (i.e. while inserting the next field of the newNode might not be made <code>NULL</code>, but I am properly taking care of that thing.) If there would be the problem in insertion then my code should fail of other test cases too. But the code is just failing for the specified test case above.</p>\n\n<p>For example, the code passes this test case:</p>\n\n<blockquote>\n  <p>[aupadhyay@localhost c]$ ./a.out </p>\n  \n  <p>Enter elements to be stored</p>\n  \n  <p>7</p>\n  \n  <p>Enter the elements in array</p>\n  \n  <p>21 32 565 784 445 655 84</p>\n  \n  <p>Enter the element you want to search for</p>\n  \n  <p>565</p>\n  \n  <p>TEMP = 8063248</p>\n  \n  <p>temp->data=655</p>\n  \n  <p>TEMP = 8063216</p>\n  \n  <p>temp->data=445</p>\n  \n  <p>TEMP = 8063152</p>\n  \n  <p>temp->data=565</p>\n  \n  <p>565 is found</p>\n</blockquote>\n\n<p>I am just unable to figure it out, why does it fail the mentioned test case.</p>\n"}, {"tags": ["c", "memory", "linked-list", "free"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1513786246, "post_id": 47910169, "comment_id": 82787845, "body": "<code>while (curr-&gt;next != NULL) {         curr = curr-&gt;next;     }</code> - did you mean <code>while (curr != NULL)</code> ?"}, {"owner": {"reputation": 638, "user_id": 3369309, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/de889e45a8aaa3b3e46fd739db3e774b?s=128&d=identicon&r=PG&f=1", "display_name": "Tam211", "link": "https://stackoverflow.com/users/3369309/tam211"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1513786384, "post_id": 47910169, "comment_id": 82787922, "body": "@EugeneSh. This is in the add function, I did this way so I can get the last element in the list in <code>curr</code> and then add the new element to <code>curr-&gt;next</code>. The problem is in <code>freeList</code> function."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1513786669, "post_id": 47910169, "comment_id": 82788073, "body": "You have your <code>tmp</code> as <code>curr-&gt;next</code>, but then you move it once further again <code>curr = tmp;         curr=curr-&gt;next;</code>. You don&#39;t need the last line. It is skipping one element."}, {"owner": {"reputation": 638, "user_id": 3369309, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/de889e45a8aaa3b3e46fd739db3e774b?s=128&d=identicon&r=PG&f=1", "display_name": "Tam211", "link": "https://stackoverflow.com/users/3369309/tam211"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1513787622, "post_id": 47910169, "comment_id": 82788635, "body": "@EugeneSh. I removed the last line and I still get the same error."}], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 5280051, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204940000838446/picture?type=large", "display_name": "Erich M&#246;nch", "link": "https://stackoverflow.com/users/5280051/erich-m%c3%b6nch"}, "is_accepted": false, "score": 0, "last_activity_date": 1513791135, "creation_date": 1513791135, "answer_id": 47911472, "question_id": 47910169, "link": "https://stackoverflow.com/questions/47910169/c-how-to-free-a-linked-list-that-has-a-linked-list-in-its-nodes/47911472#47911472", "title": "C - how to free a linked list that has a linked list in its nodes?", "body": "<p>If you declare the tmp var outside the loop-while? <code>struct node *curr, *tmp;</code> for example.</p>\n"}], "owner": {"reputation": 638, "user_id": 3369309, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/de889e45a8aaa3b3e46fd739db3e774b?s=128&d=identicon&r=PG&f=1", "display_name": "Tam211", "link": "https://stackoverflow.com/users/3369309/tam211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513791135, "creation_date": 1513786110, "last_edit_date": 1513787643, "question_id": 47910169, "link": "https://stackoverflow.com/questions/47910169/c-how-to-free-a-linked-list-that-has-a-linked-list-in-its-nodes", "title": "C - how to free a linked list that has a linked list in its nodes?", "body": "<p>As part of a program that I'm writing in kernel space, I have created a linked list that has another linked list in its nodes. \nThe nodes can be two types, either channel which only has an int value and a char* value, or a device file which has an int value and a linked list of channels. but I'm getting NULL pointer reference in my freeList function.</p>\n\n<p>The error that I get is: unable to handle kernel NULL pointer dereference</p>\n\n<p>Any idea how to fix this?</p>\n\n<pre><code>struct node {\n    int val;\n    char* msg;\n    struct node* headOfIdList;\n    struct node* next;\n};\n\nstatic void addChannel(struct node* head, int id, char* msg) {\n    printk(KERN_INFO \"creating channel\\n\");\n    struct node *curr ;\n    curr=head;\n    while (curr-&gt;next != NULL) {\n        curr = curr-&gt;next;\n    }\n    curr-&gt;next = kmalloc(sizeof(struct node), GFP_KERNEL);\n    curr-&gt;next-&gt;val = id;\n    curr-&gt;next-&gt;msg = msg;\n    curr-&gt;next-&gt;headOfIdList = NULL;\n    curr-&gt;next-&gt;next = NULL;\n    printk(KERN_INFO \"channel created\\n\");\n}\n\nstatic void addFile(struct node* head, int minor) {\n    printk(KERN_INFO \"creating file\\n\");\n    struct node *curr ;\n    curr=head;\n    while (curr-&gt;next != NULL) {\n        curr = curr-&gt;next;\n    }\n    curr-&gt;next = kmalloc(sizeof(struct node), GFP_KERNEL);\n    curr-&gt;next-&gt;val = minor;\n    curr-&gt;next-&gt;msg = NULL;\n    curr-&gt;next-&gt;headOfIdList = NULL;\n    curr-&gt;next-&gt;next = NULL;\n    printk(KERN_INFO \"file created\\n\");\n}\n\nstatic struct node* find(struct node* head, int val) {\n    printk(KERN_INFO \"looking for node\\n\");\n    struct node *curr ;\n    curr=head;\n    while (curr != NULL) {\n        if (curr-&gt;val == val) {\n            return curr;\n        }\n        curr = curr-&gt;next;\n    }\n    return NULL;\n}\n\nstatic void freeList(struct node* head) {\n    printk(KERN_INFO \"freeing list\\n\");\n    struct node *curr ;\n    curr=head;\n    while (curr != NULL) {\n        struct node *tmp = curr-&gt;next;\n        if (curr-&gt;headOfIdList != NULL) {\n            freeList(curr-&gt;headOfIdList);\n        }\n        kfree(curr);\n        curr = tmp;\n        //curr=curr-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "affinity"], "comments": [{"owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 1, "creation_date": 1513784977, "post_id": 47909809, "comment_id": 82787024, "body": "Can you format your code clearly please."}, {"owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "reply_to_user": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 0, "creation_date": 1513785023, "post_id": 47909809, "comment_id": 82787055, "body": "sorry .. i&#39;ll edit that ..thanx"}, {"owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513785702, "post_id": 47909809, "comment_id": 82787514, "body": "I reformatted it ... thanks"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513791387, "post_id": 47910380, "comment_id": 82790614, "body": "If i can skip current time slice after setting the affinity..ill garantee next time slice will be on the designated cpu ..even by coincidece initially it was running on the designated cpu...that case skip will be a wast of time but it will garantee next function call will be executed on the designated cpu..its a compromise between the skipped slice time and garantee that my rest of process code will run on the designated cpu..thats the point"}], "tags": [], "owner": {"reputation": 500, "user_id": 8728691, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214078186251130/picture?type=large", "display_name": "Joe Hickey", "link": "https://stackoverflow.com/users/8728691/joe-hickey"}, "is_accepted": false, "score": 1, "last_activity_date": 1513786914, "creation_date": 1513786914, "answer_id": 47910380, "question_id": 47909809, "link": "https://stackoverflow.com/questions/47909809/how-to-ensure-code-immediatly-after-a-call-to-sched-setaffinity-run-on-the-spe/47910380#47910380", "title": "How to ensure Code immediatly after a call to sched_setaffinity() run on the specified thread before waiting for next turn at the cpu queue?", "body": "<p>In short -- you can't, because whatever core you've asked for might already be busy doing something else.  All that setting affinity does is tell the OS you only want the process scheduled on that particular CPU.  As a result it is actually more likely to get your task delayed where the default affinity (any CPU) would schedule it on the first available.</p>\n\n<p>You could raise the process priority (i.e. realtime scheduling), which would cause the process to preempt anything already running on the CPU, which might be more in line with what you were looking to do.  </p>\n\n<p>That being said, you risk locking up your system entirely, if the \"while\" loops never end they will be stuck in a tight loop and nothing else will get scheduled (not even your shell) so you won't be able to stop them.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513788302, "post_id": 47910405, "comment_id": 82789007, "body": "Thanks for you answer .. the main purpose of making separate process run on different cpu was not avoiding communication problems that may appear...the second question was a side affect i feared its happening ... but now  consider my question .... is there a call to some function that after executed it gets the process skip its remaining time slice so that next time even after delay it executes on correct processor...i&#39;l remove the while loops at that time...thnx"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513788691, "post_id": 47910405, "comment_id": 82789223, "body": "I repeat: <i>how would you tell</i> whether the behavior is as you hope?  The parent process sets the CPU affinity for a child process, and certainly the child&#39;s subsequent time slices are scheduled one the designated CPUs.  But how does either process know whether the child was executing on a different CPU at the time the call was handled?  You seem to be worrying about something that you cannot measure and that doesn&#39;t even matter."}, {"owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513789560, "post_id": 47910405, "comment_id": 82789661, "body": "Even if the child was executing on the designated cpu by coincidence ... getting it one time ( even it was redundant ) but garantee it execute on next slice on the designated cpu...it will be fine .. i donot like to do check .. say getting it out of cpu3 queue and executing it next time  slice on the same cpu3 which by coincidence is also cpu3 will not cause any problem... its a matter of comprimise between time and my target.. to place that function it can be in the branch after checking pid ... not common part executed by all process till reaching the ifelse ladder..that was my point"}, {"owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513790233, "post_id": 47910405, "comment_id": 82790020, "body": "May the post title be modified to reflect that :   how do we get the process out of the cpu queue ..specifying which process is a matter of where in the code we write such function..in the begaining of the ifelsr ladder for each branch..also please note i made a a mask array not a single mask.. and note that which process gets which mask is an if condition inside while loop in the common part after fork.. icould do such block before forking so i had to stop processing by a shm till the parent set its mask in the sched ..when done i cant garantee opening shm will leave it on its cpu"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513791633, "post_id": 47910405, "comment_id": 82790741, "body": "I repeat once more: <i>how would you tell?</i>  I&#39;m not saying that you should try to check, but rather suggesting that there is no way you could do so.  It is pointless to be concerned about such behavior details if indeed they have no measurable effect."}, {"owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "edited": false, "score": 0, "creation_date": 1513792740, "post_id": 47910405, "comment_id": 82791334, "body": "Thanks ... for your advice.. i was really misunderstanding  what u was trying to say... i thought u wanted me to check first ....thnx"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1513788406, "last_edit_date": 1513788406, "creation_date": 1513787006, "answer_id": 47910405, "question_id": 47909809, "link": "https://stackoverflow.com/questions/47909809/how-to-ensure-code-immediatly-after-a-call-to-sched-setaffinity-run-on-the-spe/47910405#47910405", "title": "How to ensure Code immediatly after a call to sched_setaffinity() run on the specified thread before waiting for next turn at the cpu queue?", "body": "<blockquote>\n  <p>my problem how could I ensure that after a call to sched_setaffinity() the process will continue running on the specified processor and will not wait till it's next turn in the specified cpu's queue ?</p>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/sched_setaffinity.2.html\" rel=\"nofollow noreferrer\">The docs</a> do say, in part:</p>\n\n<blockquote>\n  <p>If  the  process specified by pid is not currently running on one of\n  the CPUs specified in mask, then\n         that process is migrated to one of the CPUs specified in mask.</p>\n</blockquote>\n\n<p>That does not promise that such a migration will happen before that process's current time slice (if it has one) expires, nor that it will immediately start running on one of the specified CPUs, but that's moot, because how would you be able to tell?</p>\n\n<blockquote>\n  <p>what happens if a child say child a wants to communicate-during it's session- to parent-when it's still in it's cpu queue not currently running like the childA ... is that the role of the OS to make all eight process feel as if each one is currently having the cpu alone ?</p>\n</blockquote>\n\n<p>Obviously, a process cannot do anything at all while it is not currently scheduled on a CPU.  In fact, it cannot even conceive (metaphorically) a want to do anything.  But overall, yes, it is the OS's role to mediate time sharing and IPC.</p>\n\n<p>This hasn't anything in particular to do with CPU affinity or the number of physical execution units in the system.  All of it works fine on a single-core machine (though setting CPU affinity is pointless on such a machine).</p>\n"}], "owner": {"reputation": 5, "user_id": 8216089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f9577fba603cb30b315f2785ca4dee?s=128&d=identicon&r=PG&f=1", "display_name": "AbdAllah Talaat", "link": "https://stackoverflow.com/users/8216089/abdallah-talaat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 47910405, "answer_count": 2, "score": -2, "last_activity_date": 1513788406, "creation_date": 1513784854, "last_edit_date": 1513785662, "question_id": 47909809, "link": "https://stackoverflow.com/questions/47909809/how-to-ensure-code-immediatly-after-a-call-to-sched-setaffinity-run-on-the-spe", "title": "How to ensure Code immediatly after a call to sched_setaffinity() run on the specified thread before waiting for next turn at the cpu queue?", "body": "<p>I have written a code to make 7 process in addition to the parent, so the sum is 8 ... I managed to make each process tied to a different thread .. ie I have intel core-i7 ..which have 4 cores X 2 threads/core = 8 threads ... now my problem how could I ensure that after a call to sched_setaffinity() the process will continue running on the specified processor and will not wait till it's next turn in the specified cpu's queue ?? could we have some thing like</p>\n\n<p>get_me_out_of_the_current_queue_ so_that_the_sched_puts_me_in_the_ specified_queue_next_time()</p>\n\n<p>my code is :</p>\n\n<pre><code>       #define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sched.h&gt;\n#include &lt;sys/shm.h&gt;\n\nint main()\n{\n   //code here in parent only , before any child start ///\n\n\n   /////Declaration section////////\n   pid_t ProcessIDs[8];\n   cpu_set_t ThreadArray[8];\n   int i ;\n   int j ;\n   int k ;\n   int InternalPID;\n   ////////////////////////////////\n\n\n   /////Initialization section/////\n   i=1;\n   j=0;\n   k=0;\n   InternalPID = 0;\n\n   for (j=0;j&lt;8;j++)\n   {\n   ProcessIDs[j] = 0;\n   }\n\n   for (j=0;j&lt;8;j++)\n   {\n   CPU_ZERO(&amp;ThreadArray[j]);\n   }\n\n   for (j=0;j&lt;8;j++)\n   {\n   CPU_SET(j+1,&amp;ThreadArray[j]);\n   }\n   /////////////////////////////////\n\n\n\n///////// shm ///////////////////////////////\nint  shmid ;\nint err;\nchar *shm;\nshmid = shmget(IPC_PRIVATE,8 ,IPC_CREAT | IPC_EXCL | 0666 );\nshm=shmat(shmid,0, IPC_CREAT | IPC_EXCL | 0666  );\nif (shmid &gt; -1)\n{\nprintf(\"shared memory created succefully\\n\");\n}\nint m =0;\nfor(m=0 ;m&lt;8;m++)\n{\n    shm[m]='N';\n}\n//////////////////////////////////////////////\n\n\n\n   /////// Parent only - children don't exist//////\n\n\n   ProcessIDs[0] = getpid();\n   while( (getpid() == ProcessIDs[0] ) &amp; (i &lt; 8) )\n   {\n   ProcessIDs[i] = fork();\n   i++;\n   }\n\n    ////////////////////////////////////////////////\n\n    ////////parent only - children exist////////////\n    if(getpid() == ProcessIDs[0])\n    {\n    for(k=0;k&lt;8;k++)\n    {\n    sched_setaffinity(ProcessIDs[k],sizeof(cpu_set_t),&amp;ThreadArray[k]);\n    shm[k] = 'Y';\n    sleep(2);\n    }\n    }\n    ////////////////////////////////////////////////\n\n\n   ///////////////////parent and children////\n   for(k=1;k&lt;8;k++)\n   {\n    if(ProcessIDs[k] == 0){\n    InternalPID = k;\n    break;\n    }\n   }\n   //////////////////////////////////////////////\n\n   //////////Process Specific code //////////////\n\n   if (InternalPID == 0)\n   {\n   ////// Parent only Rest of Code ////////\n   while(shm[0] != 'Y');\n   printf(\"hello for parent %i.. \\n\",InternalPID);\n   return 0 ;\n   ////////////////////////////////////////\n   }\n   else if (InternalPID == 1)\n   {\n   ////////////// child 1 /////////////////\n   while(shm[1] != 'Y');\n   printf(\"hello for child  %i.. \\n\", InternalPID);\n   return 0 ;\n   ////////////////////////////////////////\n   }\n   else if (InternalPID == 2)\n   {\n   ////////////// child 2 /////////////////\n   while(shm[2] != 'Y');\n   printf(\"hello for child  %i.. \\n\", InternalPID);\n   return 0 ;\n   ////////////////////////////////////////\n   }\n   else if (InternalPID == 3)\n   {\n   ////////////// child 3 /////////////////\n   while(shm[3] != 'Y');\n   printf(\"hello for child  %i.. \\n\", InternalPID);\n   return 0 ;\n   ////////////////////////////////////////\n   }\n   else if (InternalPID == 4)\n   {\n   ////////////// child 4 /////////////////\n   while(shm[4] != 'Y');\n   printf(\"hello for child  %i.. \\n\", InternalPID);\n   return 0 ;\n   ////////////////////////////////////////\n   }\n   else if (InternalPID == 5)\n   {\n   ////////////// child 5 /////////////////\n   while(shm[5] != 'Y');\n   printf(\"hello for child  %i.. \\n\", InternalPID);\n   return 0 ;\n   ////////////////////////////////////////\n   }\n   else if (InternalPID == 6)\n   {\n   ////////////// child 6 /////////////////\n   while(shm[6] != 'Y');\n   printf(\"hello for child  %i.. \\n\", InternalPID);\n   ////////////////////////////////////////\n   }\n   else if (InternalPID == 7)\n   {\n   ////////////// child 7 /////////////////\n   while(shm[7] != 'Y');\n   printf(\"hello for child  %i.. \\n\", InternalPID);\n   return 0 ;\n   ////////////////////////////////////////\n   }\n   /////////////////////////////////////////////////\n\n\n\n\n   ///////////////////////////////////////////////////////\n}\n</code></pre>\n\n<p>I know that the while() loops at the beginning of each process specific code \n(inside if branch) may guarantee that, but i guess that is due to the delay of time , which is not a robust solution ... please tell me what's the correct way to solve that ...</p>\n\n<p>second point I'd like to ask about :</p>\n\n<p>each process of the 8 processes will run on different core , but during interprocess communication like when i continue and create pipes so that the processes communicate through the parent like the middle point \"like a star topology\" <strong>what happens if a child say child a wants to communicate-during it's session- to parent-when it's still in it's cpu queue not currently running like the childA ... is that the role of the OS to make all eight process feel as if each one is currently having the cpu alone ?</strong></p>\n"}, {"tags": ["c", "cuda"], "answers": [{"tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 2, "last_activity_date": 1513786275, "last_edit_date": 1513786275, "creation_date": 1513785905, "answer_id": 47910113, "question_id": 47909694, "link": "https://stackoverflow.com/questions/47909694/some-elements-were-not-calculated-in-a-vector-addition-on-cuda/47910113#47910113", "title": "Some elements were not calculated in a vector addition on cuda", "body": "<p>The only problem is with your <code>tid</code> calculation as you have already surmised.</p>\n\n<p>There are many ways to perform the mapping and also to create the arithmetic.  For general purpose 2D grids, I find it convenient (i.e. an easy-to-remember methodology) to create 2D indices in x and y, and then use the grid width (in x) multiplied by the y index, plus the x index, to create a thread-unique 1-D index:</p>\n\n<pre><code>int idy = threadIdx.y+blockDim.y*blockIdx.y;  // y-index\nint idx = threadIdx.x+blockDim.x*blockIdx.x;  // x-index\nint tid = gridDim.x*blockDim.x*idy + idx;     // thread-unique 1D index\n</code></pre>\n\n<p><code>gridDim.x*blockDim.x</code> is the grid width in x, expressed in units of threads.</p>\n\n<p>When we use this general-purpose 2D indexing scheme in your code, it seems to work correctly for me:</p>\n\n<pre><code>$ cat t10.cu\n#include &lt;stdio.h&gt;\n\n#define N 36\n\n__global__ void add(int *a, int *b, int *c) {\n    int idy = threadIdx.y+blockDim.y*blockIdx.y;\n    int idx = threadIdx.x+blockDim.x*blockIdx.x;\n    int tid = gridDim.x*blockDim.x*idy + idx;\n    if(tid &lt; N) {\n        c[tid] = a[tid] + b[tid];\n    }\n}\n\nint main() {\n    int a[N], b[N], c[N];\n    int *dev_a, *dev_b, *dev_c;\n    cudaMalloc( (void**) &amp;dev_a, N * sizeof(int));\n    cudaMalloc( (void**) &amp;dev_b, N * sizeof(int));\n    cudaMalloc( (void**) &amp;dev_c, N * sizeof(int));\n    for (int i = 0; i &lt; N; i++) {\n        a[i] = -1;\n        b[i] = i * i;\n    }\n\n    cudaMemcpy(\n                dev_a,\n                a,\n                N * sizeof(int),\n                cudaMemcpyHostToDevice\n                   );\n    cudaMemcpy(\n                dev_b,\n                b,\n                N * sizeof(int),\n                cudaMemcpyHostToDevice\n                   );\n    dim3 grid_dim(3, 2);\n    dim3 block_dim(3, 2);\n    add&lt;&lt;&lt;grid_dim, block_dim&gt;&gt;&gt;(dev_a, dev_b, dev_c);\n    cudaMemcpy(\n                c,\n                dev_c,\n                N * sizeof(int),\n                cudaMemcpyDeviceToHost\n                   );\n    for (int i = 0; i &lt; N; i++) {\n        printf(\"%d + %d = %d\\n\", a[i], b[i], c[i]);\n    }\n    cudaFree(dev_a);\n    cudaFree(dev_b);\n    cudaFree(dev_c);\n}\n$ nvcc -arch=sm_35 -o t10 t10.cu\n$ cuda-memcheck ./t10\n========= CUDA-MEMCHECK\n-1 + 0 = -1\n-1 + 1 = 0\n-1 + 4 = 3\n-1 + 9 = 8\n-1 + 16 = 15\n-1 + 25 = 24\n-1 + 36 = 35\n-1 + 49 = 48\n-1 + 64 = 63\n-1 + 81 = 80\n-1 + 100 = 99\n-1 + 121 = 120\n-1 + 144 = 143\n-1 + 169 = 168\n-1 + 196 = 195\n-1 + 225 = 224\n-1 + 256 = 255\n-1 + 289 = 288\n-1 + 324 = 323\n-1 + 361 = 360\n-1 + 400 = 399\n-1 + 441 = 440\n-1 + 484 = 483\n-1 + 529 = 528\n-1 + 576 = 575\n-1 + 625 = 624\n-1 + 676 = 675\n-1 + 729 = 728\n-1 + 784 = 783\n-1 + 841 = 840\n-1 + 900 = 899\n-1 + 961 = 960\n-1 + 1024 = 1023\n-1 + 1089 = 1088\n-1 + 1156 = 1155\n-1 + 1225 = 1224\n========= ERROR SUMMARY: 0 errors\n$\n</code></pre>\n\n<p>The above should provide the correct result.  With respect to performance, this may not be the most efficient mapping for this toy problem. This problem has threadblock sizes that are not multiples of 32, which is generally not recommended for efficient CUDA programming.  Rather than try and come up with the optimal mapping (in terms of performance/efficiency) for this case, my suggestion would be to reorganize your threadblocks to provide at least a multiple of 32 threads per block, and I would also recommend considering at least 16 or 32 threads in the x-dimension of the block, to making indexing easy to understand as well as yielding approximately optimal memory access performance.</p>\n"}], "owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 47910113, "answer_count": 1, "score": 2, "last_activity_date": 1513786275, "creation_date": 1513784486, "question_id": 47909694, "link": "https://stackoverflow.com/questions/47909694/some-elements-were-not-calculated-in-a-vector-addition-on-cuda", "title": "Some elements were not calculated in a vector addition on cuda", "body": "<p>Here is the code:</p>\n\n<pre><code>#include \"common/book.h\"\n\n#define N 36 \n\n__global__ void add(int *a, int *b, int *c) {\n    int tid = blockIdx.x * gridDim.y * blockDim.x * blockDim.y + threadIdx.y * blockDim.x + threadIdx.x; \n    if(tid &lt; N) {\n        c[tid] = a[tid] + b[tid];\n    }\n}\n\nint main() {\n    int a[N], b[N], c[N]; \n    int *dev_a, *dev_b, *dev_c; \n    cudaMalloc( (void**) &amp;dev_a, N * sizeof(int));\n    cudaMalloc( (void**) &amp;dev_b, N * sizeof(int));\n    cudaMalloc( (void**) &amp;dev_c, N * sizeof(int));\n    for (int i = 0; i &lt; N; i++) {\n        a[i] = -1; \n        b[i] = i * i;\n    }\n\n    cudaMemcpy(\n                dev_a, \n                a, \n                N * sizeof(int),\n                cudaMemcpyHostToDevice\n                   );\n    cudaMemcpy(\n                dev_b, \n                b, \n                N * sizeof(int),\n                cudaMemcpyHostToDevice\n                   );\n    dim3 grid_dim(3, 2);\n    dim3 block_dim(3, 2);\n    add&lt;&lt;&lt;grid_dim, block_dim&gt;&gt;&gt;(dev_a, dev_b, dev_c);\n    cudaMemcpy(\n                c, \n                dev_c, \n                N * sizeof(int),\n                cudaMemcpyDeviceToHost\n                   );\n    for (int i = 0; i &lt; N; i++) {\n        printf(\"%d + %d = %d\\n\", a[i], b[i], c[i]);\n    }\n    cudaFree(dev_a);\n    cudaFree(dev_b);\n    cudaFree(dev_c);\n}\n</code></pre>\n\n<p>Basically, I was trying to add two vectors element-wise, on a grid with 3x2 layout, each block in the grid having a 3x2 layout of threads. </p>\n\n<p>Here is the result when I run the compiled binary:</p>\n\n<pre><code>-1 + 0 = -1\n-1 + 1 = 0\n-1 + 4 = 3\n-1 + 9 = 8\n-1 + 16 = 15\n-1 + 25 = 24\n-1 + 36 = 0\n-1 + 49 = 0\n-1 + 64 = 0\n-1 + 81 = 0\n-1 + 100 = 0\n-1 + 121 = 0\n-1 + 144 = 143\n-1 + 169 = 168\n-1 + 196 = 195\n-1 + 225 = 224\n-1 + 256 = 255\n-1 + 289 = 288\n-1 + 324 = 0\n-1 + 361 = 0\n-1 + 400 = 0\n-1 + 441 = 0\n-1 + 484 = 0\n-1 + 529 = 0\n-1 + 576 = 575\n-1 + 625 = 624\n-1 + 676 = 675\n-1 + 729 = 728\n-1 + 784 = 783\n-1 + 841 = 840\n-1 + 900 = 0\n-1 + 961 = 0\n-1 + 1024 = 0\n-1 + 1089 = 0\n-1 + 1156 = 0\n-1 + 1225 = 0\n</code></pre>\n\n<p>Apparently some blocks are just ignored. I've also tried to play around with how the <code>tid</code> is calculated in the kernel function <code>add</code>, but there are always some blocks missing. </p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c", "gcc", "cygwin"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513784849, "post_id": 47909685, "comment_id": 82786934, "body": "I&#39;m confused.  You say you want to <i>port</i> C code to C#, but it sounds like you&#39;re just trying to build a Windows version of a C library (which maybe you hope to call from C#).  These are entirely different things."}, {"owner": {"reputation": 1813, "user_id": 2397707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MGJnu.jpg?s=128&g=1", "display_name": "Jinish", "link": "https://stackoverflow.com/users/2397707/jinish"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513785002, "post_id": 47909685, "comment_id": 82787038, "body": "My apologies..you are correct. I am trying to build a windows version of a c library. What I will eventually do once I get a dll is to build a C# wrapper"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1513785105, "post_id": 47909685, "comment_id": 82787117, "body": "Well which header files is it looking for?"}, {"owner": {"reputation": 1813, "user_id": 2397707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MGJnu.jpg?s=128&g=1", "display_name": "Jinish", "link": "https://stackoverflow.com/users/2397707/jinish"}, "edited": false, "score": 0, "creation_date": 1513785253, "post_id": 47909685, "comment_id": 82787225, "body": "Hi Mark. Its complaining about config.h, which i am sure is because its the first one referenced. I tried providing the directory path for GCC to search using the switch gcc -B &quot;directory path&quot;, but the header files are in different directories, if I am making any sense"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1513785270, "post_id": 47909685, "comment_id": 82787239, "body": "The libidn2 docs say that <a href=\"https://gitlab.com/libidn/libidn2#dependencies\" rel=\"nofollow noreferrer\">it depends on GNU Unistring and GNU iconv</a>, which you did not mention.  If the compiler cannot find needed headers, then my first guess would be that it is headers for those separate libraries that it is looking for."}, {"owner": {"reputation": 1813, "user_id": 2397707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MGJnu.jpg?s=128&g=1", "display_name": "Jinish", "link": "https://stackoverflow.com/users/2397707/jinish"}, "edited": false, "score": 0, "creation_date": 1513785506, "post_id": 47909685, "comment_id": 82787398, "body": "Hi John. In the source directory I do have those header files under different folders. Should not gcc be able to link the header files if a source path is provided?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513785799, "post_id": 47909685, "comment_id": 82787579, "body": "You should not try to run <code>gcc</code> directly to build an Autotools project, nor generally any project that relies on <code>make</code>.  You might make it work, but the whole point of a <code>Makefile</code> is to record all the needed build details -- not just dependencies, but also compilation flags and many other things."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513785961, "post_id": 47909685, "comment_id": 82787684, "body": "GCC will find the third-party headers if they are installed in its search path (unclear whether this is the case) or if you specify their location(s) via an <code>-I</code> option (not shown in your <code>gcc</code> command).  But these are some of the things that <code>configure</code> + <code>make</code> should help you with, and some of the reasons not to run <code>gcc</code> directly to build a project such as this."}, {"owner": {"reputation": 1813, "user_id": 2397707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MGJnu.jpg?s=128&g=1", "display_name": "Jinish", "link": "https://stackoverflow.com/users/2397707/jinish"}, "edited": false, "score": 0, "creation_date": 1513786092, "post_id": 47909685, "comment_id": 82787754, "body": "I see. Pardon my ignorance on this topic. I have been able to get an .exe using the &quot;make&quot; command after running ./Configure on source. Is there a switch or a flag I can set to produce a dll?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1513787540, "post_id": 47909685, "comment_id": 82788577, "body": "If the makefile doesn&#39;t have an .so target, then you&#39;ll have to create one. Sounds like the dependencies are not very simple, though. If this is an Autotools makefile, you&#39;re more likely to break it by editing it manually. If it does have an .so target, try specifying that target when you call <code>make</code>."}, {"owner": {"reputation": 1813, "user_id": 2397707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MGJnu.jpg?s=128&g=1", "display_name": "Jinish", "link": "https://stackoverflow.com/users/2397707/jinish"}, "edited": false, "score": 0, "creation_date": 1513876632, "post_id": 47909685, "comment_id": 82828064, "body": "Thanks Mark. Managed to get a dll by using the following command <code>.&#47;configure --host=x86_64-w64-mingw32 --target=x86_64-w64-mingw32</code>. However, the dll seems to not be a valid image. it doesnt have a manifest. Is there some setting I can toggle in the MakeFile that will produce a manifest file as well?"}], "owner": {"reputation": 1813, "user_id": 2397707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MGJnu.jpg?s=128&g=1", "display_name": "Jinish", "link": "https://stackoverflow.com/users/2397707/jinish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513785047, "creation_date": 1513784470, "last_edit_date": 1513785047, "question_id": 47909685, "link": "https://stackoverflow.com/questions/47909685/export-c-library-to-windows-dll", "title": "Export C library to Windows dll", "body": "<p>So I have source code written in C for the LibIdn2 library. I am looking to port it into C# but running in to some issues along the way and would appreciate some help.</p>\n\n<ul>\n<li>Installed Cygwin along with Make and GCC G++ packages</li>\n<li>Successfully able to run the./configure command on the source directory</li>\n<li>After this, running the \"make\" command produces an .exe file.</li>\n</ul>\n\n<p>I have been trying to get a .dll file created but cannot seem to do so using gcc compiler. The command I am running is:</p>\n\n<pre><code>gcc -shared -o idn2.dll src/idn2.c\n</code></pre>\n\n<p>but it complains that it cant find the header files referenced in the idn2.c source file. </p>\n\n<p>I have checked that in the idn2.h file, dll_Export is defined.</p>\n\n<p>Any ideas how should I proceed? I need to get a dll.</p>\n"}, {"tags": ["c", "logic"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1513784489, "post_id": 47909646, "comment_id": 82786706, "body": "<code>~</code> is bitwise not."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1513784536, "creation_date": 1513784536, "answer_id": 47909713, "question_id": 47909646, "link": "https://stackoverflow.com/questions/47909646/boolean-algebra-not-and-dwords-suggest-a-fix/47909713#47909713", "title": "BOOLEAN algebra NOT and DWORDs - suggest a fix", "body": "<p>The <code>!</code> operator is a logical NOT.  The result of this operator is either 0 or 1.  What you want is the bitwise NOT operator <code>~</code>:</p>\n\n<pre><code>DWORD backToPrev = newVal &amp; ~flags;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 9115825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP6Dg.gif?s=128&g=1", "display_name": "PspSetProcessPpmPolicy", "link": "https://stackoverflow.com/users/9115825/pspsetprocessppmpolicy"}, "is_accepted": false, "score": 0, "last_activity_date": 1513785315, "creation_date": 1513785315, "answer_id": 47909933, "question_id": 47909646, "link": "https://stackoverflow.com/questions/47909646/boolean-algebra-not-and-dwords-suggest-a-fix/47909933#47909933", "title": "BOOLEAN algebra NOT and DWORDs - suggest a fix", "body": "<p>You can use | when specifying flags, |= to add flags and ~ to remove them.</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nDWORD UpdateFlags(\n    DWORD CurrentFlags,\n    DWORD RemoveFlag\n)\n{\n    return CurrentFlags &amp; ~RemoveFlag;\n}\n\nint main()\n{\n    DWORD MyFlags = PROCESS_VM_OPERATION | PROCESS_VM_READ;\n\n    MyFlags = UpdateFlags(MyFlags,\n        PROCESS_VM_READ);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>If you do this, you can easily update the flags without having to keep using &amp; ~. Much simpler for readability. In the above example, MyFlags is assigned PROCESS_VM_OPERATION and PROCESS_VM_READ flags (so 24 total value for me), after updating the flags to remove PROCESS_VM_READ, it became 8 for the value because we removed PROCESS_VM_READ and are left only with PROCESS_VM_OPERATION. </p>\n\n<p>To check for presence of flags:</p>\n\n<pre><code>BOOL IsFlagPresent(\n    DWORD CurrentFlags,\n    DWORD TargetFlag\n)\n{\n    return ((CurrentFlags &amp; TargetFlag) == TargetFlag) ?\n        TRUE : FALSE;\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6594077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd91eee93b06a18078fca5d464022a9?s=128&d=identicon&r=PG&f=1", "display_name": "craker", "link": "https://stackoverflow.com/users/6594077/craker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1513788095, "answer_count": 2, "score": -1, "last_activity_date": 1513788136, "creation_date": 1513784330, "last_edit_date": 1513784421, "question_id": 47909646, "link": "https://stackoverflow.com/questions/47909646/boolean-algebra-not-and-dwords-suggest-a-fix", "closed_reason": "Duplicate", "title": "BOOLEAN algebra NOT and DWORDs - suggest a fix", "body": "<p>I've found some legacy code that goes wrong, setting file attributes. It looks something like this - </p>\n\n<pre><code>flag1 = 0x0001;\nflag2 = 0x0002;\n\nDWORD flags = flag1 | flag2;\n\n//great - flags is 3\n\nDWORD prevValue  = 0x0010; //say\n\n//add our new flags to prevValue\nDWORD newVal = prevValue | flags;\n\n//newVal is 19\n\n//but now I want to remove those flags from newVal\n\nDWORD backToPrev = newVal &amp; !flags;\n\n//but according to my compiler (vs2012)\n//!flags is 0, it can't do the logical NOT on the DWORD\n\nASSERT (backToPrev); // it's 0, should be 16\n</code></pre>\n\n<p>Any suggestions for a fix?</p>\n"}, {"tags": ["c", "string", "string-literals", "sigbus"], "comments": [{"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513784821, "post_id": 47909618, "comment_id": 82786918, "body": "If you want to write K&amp;R style C, I think you need <code>clang -std=c89</code>"}, {"owner": {"reputation": 1, "user_id": 9120663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c052617a913e7a9f492b068acc2b12?s=128&d=identicon&r=PG&f=1", "display_name": "satou", "link": "https://stackoverflow.com/users/9120663/satou"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513785214, "post_id": 47909618, "comment_id": 82787201, "body": "You&#39;re right, thank you @MarkSetchell"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9120663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c052617a913e7a9f492b068acc2b12?s=128&d=identicon&r=PG&f=1", "display_name": "satou", "link": "https://stackoverflow.com/users/9120663/satou"}, "edited": false, "score": 0, "creation_date": 1513784839, "post_id": 47909682, "comment_id": 82786930, "body": "Oh jesus christ, of course! Thanks."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1513784826, "last_edit_date": 1513784826, "creation_date": 1513784464, "answer_id": 47909682, "question_id": 47909618, "link": "https://stackoverflow.com/questions/47909618/kr-2-4-bus-error-when-assigning-mac-os/47909682#47909682", "title": "K+R 2.4: bus error when assigning (Mac OS)", "body": "<p>You may not change a string literal. Any attempt to change a string literal results in undefined behavior.</p>\n\n<p>From the C Standard (6.4.5 String literals)</p>\n\n<blockquote>\n  <p>7 It is unspecified whether these arrays are distinct provided their\n  elements have the appropriate values. <strong>If the program attempts to\n  modify such an array, the behavior is undefined.</strong></p>\n</blockquote>\n\n<p>Instead of the array of pointers to string literals</p>\n\n<pre><code>char *tests[] = {\"hello\", \"world\", \"these\", \"are\", \"some\", \"tests\"};\n</code></pre>\n\n<p>you should declare a two dimensional character array. For example</p>\n\n<pre><code>char tests[][6] = {\"hello\", \"world\", \"these\", \"are\", \"some\", \"tests\"};\n</code></pre>\n\n<p>Also you have to reserve enough space for each element of the array if you are going to append new characters to it.</p>\n"}], "owner": {"reputation": 1, "user_id": 9120663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c052617a913e7a9f492b068acc2b12?s=128&d=identicon&r=PG&f=1", "display_name": "satou", "link": "https://stackoverflow.com/users/9120663/satou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1513784846, "answer_count": 1, "score": -2, "last_activity_date": 1513785091, "creation_date": 1513784246, "last_edit_date": 1513785091, "question_id": 47909618, "link": "https://stackoverflow.com/questions/47909618/kr-2-4-bus-error-when-assigning-mac-os", "closed_reason": "Duplicate", "title": "K+R 2.4: bus error when assigning (Mac OS)", "body": "<p>I'm currently trying to solve exercise 2.4 of the K+R book and came across an odd error I can't really reproduce elsewhere. I'm using:</p>\n\n<pre><code>Apple LLVM version 8.0.0 (clang-800.0.42.1)\nTarget: x86_64-apple-darwin16.4.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n</code></pre>\n\n<p>The code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/*\n * Write an alternate version of `squeeze(s1, s2)' that deletes each \ncharacter\n * in s1 that matches any character in the string s2.\n */\n\nvoid squeeze(char *s1, const char *s2);\n\nint main(int argc, char **argv) {\n  char *tests[] = {\"hello\", \"world\", \"these\", \"are\", \"some\", \"tests\"};\n  for (unsigned int i = 0; i &lt; sizeof(tests) / sizeof(tests[0]); i++) {\n    printf(\"'%s' = \", tests[i]);\n    squeeze(tests[i], \"aeiou\");\n    printf(\"'%s'\\n\", tests[i]);\n  }\n  return 0;\n}\n\nvoid squeeze(char *s1, const char *s2) {\n  const size_t s2len = strlen(s2);\n  s1[0] = s1[0];\n  unsigned int j = 0;\n  for (unsigned int i = 0; s1[i] != '\\0'; i++) {\n    unsigned int k;\n    for (k = 0; k &lt; s2len; k++)\n      if (s1[i] == s2[k]) break;\n    if (k == s2len)  // we checked every character once, didn't find a bad char\n      s1[j++] = s1[i];\n  }\n  s1[j] = '\\0';\n}\n</code></pre>\n\n<p>GDB says:</p>\n\n<pre><code>Thread 2 received signal SIGBUS, Bus error.\n0x0000000100000e57 in squeeze (s1=0x100000f78 \"hello\", s2=0x100000fa1 \n\"aeiou\")\nat exercise2-4.c:23\n23    s1[0] = s1[0];\n</code></pre>\n\n<p>The error originally occurred at <code>s1[j++] = s1[i]</code>, but I inserted <code>s1[0] = s1[0]</code> to test it independent of the variables and it occurred there as well. Obviously, I'm missing something here.</p>\n\n<p>I'm compiling with <code>clang -O0 -g -Weverything exercise2-4.c -o exercise2-4</code> if that's of any relevance.</p>\n\n<p>Thank you very much for your time and sorry if this question's been answered before, I haven't found any question where the error occurs at such an odd place.</p>\n"}, {"tags": ["c++", "c", "python-3.x"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1513782887, "post_id": 47909072, "comment_id": 82785640, "body": "Which are you interested in?  C or C++?  These are different languages."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1513783223, "post_id": 47909072, "comment_id": 82785858, "body": "In C you have to read command output manually. Look for <code>popen()</code>"}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1513791880, "post_id": 47909072, "comment_id": 82790858, "body": "In C++ I would recommend looking at Boost::Process which has ways of doing this sort of thing."}], "answers": [{"tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": true, "score": 0, "last_activity_date": 1513784211, "last_edit_date": 1513784211, "creation_date": 1513783892, "answer_id": 47909499, "question_id": 47909072, "link": "https://stackoverflow.com/questions/47909072/is-there-any-function-or-method-like-subprocess-getoutput-in-c-or-c/47909499#47909499", "title": "Is there any function or method like subprocess.getoutput() in c or c++?", "body": "<p>A function <code>getsystemoutput()</code> could look like follows: </p>\n\n<pre><code>char *getsystemoutput( char *cmd )\n{\n    static char output[1024];\n\n    FILE *fp;\n\n    if( (fp = popen( cmd, \"r\" )) == NULL )\n        return \"\";\n\n    if( fgets( outout, sizeof output, fp ) == NULL )\n        strcpy( output, \"\" );\n\n    pclose( fp );\n    return output;\n}\n</code></pre>\n\n<p>This version returns an empty string in case of error and uses a static buffer for output, which makes it easy to use in a <code>printf()</code> but for general purpose I would suggest to return NULL on errors and pass <code>output</code> + it's size as arguments. You might also want to check for the result of <code>pclose()</code> to determine the exit status of the command called. And be aware that without a loop, it will only return the first line of output. </p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1513784390, "creation_date": 1513784390, "answer_id": 47909655, "question_id": 47909072, "link": "https://stackoverflow.com/questions/47909072/is-there-any-function-or-method-like-subprocess-getoutput-in-c-or-c/47909655#47909655", "title": "Is there any function or method like subprocess.getoutput() in c or c++?", "body": "<p>Standard C has no function to run an external process, collect its standard output and standard error, and return that as a string.  In fact, as a matter of policy, standard C does not provide functions that return dynamically-allocated memory, which such a function would need to do, other than its functions than have allocating memory as their express purpose.</p>\n\n<p>In a POSIX environment, you can rely on <code>popen()</code> to provide a <code>FILE *</code> by which you can read the standard output of a shell command:</p>\n\n<pre><code>FILE *file = popen(\"ip link | grep 'state UP' | cut -d : -f 2 | cut -d ' ' -f2\",\n                   \"r\"));\n\nif (file == NULL) {\n    // handle error\n}\n</code></pre>\n\n<p>You'll then have to handle reading the output yourself; perhaps via <code>fgets()</code>:</p>\n\n<pre><code>char buffer[LARGE_ENOUGH];\n\n// Read one line from the input (or part of one, if the buffer is too small)\nif (fgets(buffer, sizeof(buffer), file) == NULL) {\n    // handle error\n}\n// If a newline was read then it will be included\nbuffer[strcspn(buffer, \"\\n\")] = '\\0';\n</code></pre>\n\n<p>You can print the result:</p>\n\n<pre><code>printf(\"Active Device:%s\", buffer);\n</code></pre>\n\n<p>Remember that a file opened with <code>popen()</code> must be closed with <code>pclose()</code>:</p>\n\n<pre><code>if (pclose(file) != 0) {\n    // handle error\n}\n</code></pre>\n\n<p>Note, by the way, that if you want to capture the stderr as well as the standard output, as your Python version does, then your best bet is to accommodate that via I/O redirection in the command, such as:</p>\n\n<pre><code>FILE *file = popen(\n        \"{ ip link | grep 'state UP' | cut -d : -f 2 | cut -d ' ' -f2; } 2&gt;&amp;1\",\n        \"r\"));\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9123082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c741be6074cce563d08dd9bb07a8770?s=128&d=identicon&r=PG", "display_name": "Mubashshir", "link": "https://stackoverflow.com/users/9123082/mubashshir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 47909499, "answer_count": 2, "score": 2, "last_activity_date": 1513784390, "creation_date": 1513782611, "question_id": 47909072, "link": "https://stackoverflow.com/questions/47909072/is-there-any-function-or-method-like-subprocess-getoutput-in-c-or-c", "title": "Is there any function or method like subprocess.getoutput() in c or c++?", "body": "<p>Python:</p>\n\n<pre><code>print(\"Active Device:\"+subprocess.getoutput(\"ip link|grep \\\"state UP\\\"|cut -d : -f 2|cut -d \\' \\' -f2\"))\n</code></pre>\n\n<p>Can I get output like That\u2b06 in c by doing this?:\nC:</p>\n\n<pre><code>printf(\"Active Device:%s\",getsystemoutput(\"ip link|grep \\\"state UP\\\"|cut -d : -f 2|cut -d \\' \\' -f2\"));\n</code></pre>\n"}, {"tags": ["c", "undefined", "trigonometry", "angle", "atan2"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 5, "creation_date": 1513782697, "post_id": 47909048, "comment_id": 82785497, "body": "The C standard says that <code>atan2(0, 0)</code> is a <i>domain error</i>, which leads to an implementation-defined return value."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513783113, "post_id": 47909048, "comment_id": 82785793, "body": "Strictly, the standard says &quot;A domain error may occur if both arguments are zero.&quot;  The net result is much the same.  The standard also details what is supposed to happen in section &#167;7.12.1 Treatment of Error Conditions."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1513783575, "post_id": 47909048, "comment_id": 82786090, "body": "Are you asking what kind of behaviour to expect when the behaviour is undefined..?"}], "answers": [{"comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 2, "creation_date": 1513783271, "post_id": 47909231, "comment_id": 82785888, "body": "Note also that the standard <i>mandates</i> this value if IEC-60559 compatible (see Annex F)."}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "edited": false, "score": 0, "creation_date": 1513784843, "post_id": 47909231, "comment_id": 82786932, "body": "Can u please explain in some simple way , I cant properly get what you said \ud83d\ude2b"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "edited": false, "score": 0, "creation_date": 1513785252, "post_id": 47909231, "comment_id": 82787223, "body": "@user9121710 Shorten answers appended."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 9, "last_activity_date": 1579533634, "last_edit_date": 1592644375, "creation_date": 1513783110, "answer_id": 47909231, "question_id": 47909048, "link": "https://stackoverflow.com/questions/47909048/what-will-be-atan2-output-for-both-x-and-y-as-0/47909231#47909231", "title": "what will be atan2 output for both x and y as 0", "body": "<blockquote>\n<p>what will be atan2 output for both x and y as 0</p>\n</blockquote>\n<p>C has 2 relevant specifications. <a href=\"https://stackoverflow.com/questions/47909048/what-will-be-atan2-output-for-both-x-and-y-as-0/47909231#comment82785497_47909048\">@Oliver Charlesworth</a> <a href=\"https://stackoverflow.com/questions/47909048/what-will-be-atan2-output-for-both-x-and-y-as-0/47909231#comment82785793_47909048\">@Jonathan Leffler</a></p>\n<blockquote>\n<p><strong>The atan2 functions</strong> ... A domain error may occur if both arguments are zero. C11dr \u00a77.12.4.4 2</p>\n<p><strong>Treatment of error conditions</strong>   ...For all functions, a domain error occurs if an input argument is outside the domain over which the mathematical function is defined. ...; On a\ndomain error, the function returns an implementation-defined value;...  \u00a77.12.1 3</p>\n</blockquote>\n<p><code>atan2(0,0)</code> may lead to <code>0.0, 1.0, INF, NAN</code>, etc.  It is not specified other than something is returned.</p>\n<p><code>0</code> is certainly a reasonable choice yet there is no clear mathematically correct result - it is not defined.</p>\n<hr />\n<p>For compatibility with IEC-60559 (which is not required by C although many implementation strive to adhere),  the following results are mandated.  Note the differences due to  \u00b10.</p>\n<pre><code>atan2(\u00b10, \u22120) returns \u00b1\u03c0\natan2(\u00b10, +0) returns \u00b10.\n</code></pre>\n<p>A note on <a href=\"https://en.wikipedia.org/wiki/Pi\" rel=\"nofollow noreferrer\">\u03c0</a>.  \u03c0 being an irrational number and all finite <code>double</code> are rational,  a return value of <em>machine pi</em> (the closest representable <code>double</code> to \u03c0) is expected with <code>atan2(+0, -0)</code>.</p>\n<hr />\n<p><strong>Shorter version</strong></p>\n<blockquote>\n<p>&quot;what will be atan2 output for both x and y as 0&quot;</p>\n</blockquote>\n<p>Zero.</p>\n<blockquote>\n<p>&quot;how its output can be 0, even wikipedia says that it should be undefined&quot;</p>\n</blockquote>\n<p>Wikipedia  does not define C nor various math library specifications - it is a reference - not a specification.</p>\n<blockquote>\n<p>&quot;why compiler gives 0&quot;</p>\n</blockquote>\n<p>That is the specified response from the floating point standard IEC-60559/<a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"nofollow noreferrer\">IEEE 754</a> often used by various C implementations.</p>\n"}], "owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4965, "favorite_count": 1, "accepted_answer_id": 47909231, "answer_count": 1, "score": 3, "last_activity_date": 1579533634, "creation_date": 1513782538, "question_id": 47909048, "link": "https://stackoverflow.com/questions/47909048/what-will-be-atan2-output-for-both-x-and-y-as-0", "title": "what will be atan2 output for both x and y as 0", "body": "<pre><code>theta=atan2(0,0);\n</code></pre>\n\n<p>The output of this statement is 0, but it is a 0/0 form , so how its output can be 0, even wikipedia says that it should be undefined , please explain why compiler gives 0 as output for this statement.</p>\n"}, {"tags": ["c++", "c", "random", "segmentation-fault", "pi"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513782664, "post_id": 47909019, "comment_id": 82785472, "body": "My guess? Your recursion doesn&#39;t stop when you think it does. Have you tried using a debugger to catch the crash and see when and where it happens? Perhaps you should take some time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>?"}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1513782753, "post_id": 47909019, "comment_id": 82785543, "body": "your gdc function is causing a stack overflow. which implies you are missing an exit condition"}, {"owner": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 0, "creation_date": 1513782848, "post_id": 47909019, "comment_id": 82785607, "body": "I get &quot;3.000000&quot; every time when running your code"}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "edited": false, "score": 0, "creation_date": 1513782937, "post_id": 47909019, "comment_id": 82785663, "body": "replace double pi = 599994/coprime; by double pi = 599994.0/static_cast&lt;double&gt;(coprime); You may be losing some digits from integer division."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "edited": false, "score": 1, "creation_date": 1513783012, "post_id": 47909019, "comment_id": 82785715, "body": "@falopsy The cast should not be needed, as long as one of the operands is a <code>double</code>."}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513783254, "post_id": 47909019, "comment_id": 82785875, "body": "@Someprogrammerdude, no you will need the cast. it will do the integer division before casting. What do you think double p=94/10; will give you? 9.4 or 9.0? Anyway, it is always good to cast to show intent."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "edited": false, "score": 0, "creation_date": 1513783920, "post_id": 47909019, "comment_id": 82786305, "body": "@falopsy What do <i>you</i> think <code>double p = 94.0 &#47; 10;</code> will give?"}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "reply_to_user": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1513784058, "post_id": 47909019, "comment_id": 82786382, "body": "@OldProgrammer, I agree but I think the stack overflow is because the recursion of the gcd function is too deep. What you need to do is limit the value of the random number generated (currently the limit you are using is RAND_MAX = 32767 on my computer). Maybe look at &lt;random&gt;, contains classes that let you generate random numbers within a limit. You can limit to like 1000."}, {"owner": {"reputation": 391, "user_id": 970909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26b0aa8b98ecdbaa6c2e8b923f003b0e?s=128&d=identicon&r=PG", "display_name": "falopsy", "link": "https://stackoverflow.com/users/970909/falopsy"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1513784143, "post_id": 47909019, "comment_id": 82786443, "body": "@Bob__, how is that relevant? In the op&#39;s code, both arguments on the RHS are integer."}, {"owner": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "edited": false, "score": 0, "creation_date": 1513784456, "post_id": 47909019, "comment_id": 82786675, "body": "Thanks everyone. I&#39;m gonna try to do it without recursion."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1513790158, "post_id": 47909019, "comment_id": 82789985, "body": "You may consider the use of a couple of constants, like <code>const &#47;* long long *&#47; int N = 99999;</code> and <code>const double K = 6.0 * N;</code> to use in <code>double pi = K &#47; coprime;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "edited": false, "score": 0, "creation_date": 1513788738, "post_id": 47909740, "comment_id": 82789243, "body": "FWIW, a high-ish recursion depth of  39 was noted with <code>gcdu(774542945, 2027634402)</code>.  With OP&#39;s original code, the depth could be 1000&#39;s millions <code>gcd(1000000000,1)</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "edited": false, "score": 0, "creation_date": 1513797949, "post_id": 47909740, "comment_id": 82793806, "body": "<code>gcdu(1276900689, 2066068658)</code> recursed 41 times.  Hmmm, wonder what is the limit?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1513784676, "creation_date": 1513784676, "answer_id": 47909740, "question_id": 47909019, "link": "https://stackoverflow.com/questions/47909019/pi-calculator-program-gives-different-output-each-time-its-run/47909740#47909740", "title": "Pi-calculator program gives different output each time it&#39;s run", "body": "<p>OP's <code>gcd()</code> recurses too deep and causes a <em>stack overflow</em>. <a href=\"https://stackoverflow.com/questions/47909019/pi-calculator-program-gives-different-output-each-time-its-run/47909740#comment82785543_47909019\">@OldProgrammer</a></p>\n\n<p>Consider a replacement recursive function that is more efficient</p>\n\n<p>Use FP math when doing the division</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\nunsigned gcdu(unsigned a, unsigned b) {\n  return (b == 0) ? a : gcdu(b, a % b);\n}\n\nint main(void) {\n  srand(time(0));\n\n  int numberOne = rand();\n  int numberTwo = rand();\n  int coprime = 0;\n\n  for (int i = 0; i &lt; 99999; i++) {\n    numberOne = rand();\n    numberTwo = rand();\n    if (gcdu(numberOne, numberTwo) == 1) {\n      coprime++;\n    }\n  }\n\n  // double pi = 599994 / coprime;\n  double pi = 1.0*599994 / coprime;  //Insure FP division\n  pi = sqrt(pi);\n  printf(\"%f\\n\", pi);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>3.142940\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6801676, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-VQ9O-JXOY2A/AAAAAAAAAAI/AAAAAAAAADI/gk-JBYIYr70/photo.jpg?sz=128", "display_name": "Kumar Chetan", "link": "https://stackoverflow.com/users/6801676/kumar-chetan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 47909740, "answer_count": 1, "score": 1, "last_activity_date": 1513784676, "creation_date": 1513782454, "question_id": 47909019, "link": "https://stackoverflow.com/questions/47909019/pi-calculator-program-gives-different-output-each-time-its-run", "title": "Pi-calculator program gives different output each time it&#39;s run", "body": "<p>This is a program to calculate the value of Pi using the fact that \"The probability of any two integers being co-prime is 6/&pi;<SUP>2</SUP>.\" This program compiled successfully but when I try to run it, it gives the error:</p>\n\n<pre><code>Segmentation fault (core dumped)\n</code></pre>\n\n<p>I tried to change the condition statement in for-loop to <em>i &lt; 9999</em>. By doing this, the program gives an output which varies(when run each time) between 3.000000, 3.162278 and Segmentation fault (core dumped).</p>\n\n<p>I want to calculate the value of &pi; only by using the property mentioned above. Please help.</p>\n\n<p>Also, help me choose a better function that generates random numbers and suggest me some code improvements. Thank you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\nint gcd(int a, int b)\n{\n    // Everything divides 0 \n    if (a == 0 || b == 0)\n       return 0;\n\n    // base case\n    if (a == b)\n        return a;\n\n    // a is greater\n    if (a &gt; b)\n        return gcd(a-b, b);\n    return gcd(a, b-a);\n}\n\nint main()\n{\n    srand(time(0));\n\n    int numberOne = rand();\n    int numberTwo = rand();\n    int coprime = 0;\n\n    for(int i = 0; i &lt; 99999; i++)\n    {\n        numberOne = rand();\n        numberTwo = rand();\n\n        if(gcd(numberOne, numberTwo) == 1)\n        {\n            coprime++;\n        }\n\n    }\n\n    // co-prime/99999 = 6 / pi^2\n    double pi = 599994/coprime;\n    pi = sqrt(pi);\n\n    printf(\"%f\\n\", pi);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "quotation-marks", "strchr"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1513782220, "post_id": 47908806, "comment_id": 82785168, "body": "<code>(unsigned char)c;</code> on a line by itself doesn&#39;t change the type of <code>c</code>, it is still an <code>int</code>."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1513782852, "post_id": 47908806, "comment_id": 82785610, "body": "You are passing in several characters <code>&#39;  up&#39;</code>  , but treating it as a single character when you do the comparison- this is going to give you issues if you actually intend to search for more than 1 character. You also have to figure out how your compiler treats a character literal containing more than one character <code>&#39;  up</code>  as that is implementation defined - perhaps your compiler only keeps the last <code>p</code> or the first space in your multi character literal."}, {"owner": {"reputation": 121, "user_id": 8710999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c41cc8d87f29ba8362c7bf9bc6c2e73?s=128&d=identicon&r=PG&f=1", "display_name": "ivoriik", "link": "https://stackoverflow.com/users/8710999/ivoriik"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1513783617, "post_id": 47908806, "comment_id": 82786121, "body": "@nos thanks, I understand that, it was just a test case. The problem was incorrect casting (it should be in expression)."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1513782471, "creation_date": 1513782471, "answer_id": 47909027, "question_id": 47908806, "link": "https://stackoverflow.com/questions/47908806/why-strchr-returns-not-a-null-when-the-second-argument-is-a-string-into-a-single/47909027#47909027", "title": "why strchr returns not a NULL when the second argument is a string into a single quotation marks (&#39;text&#39;)", "body": "<p>In this expression:</p>\n\n<pre><code>*s == c\n</code></pre>\n\n<p>The term <code>*s</code>, which is of type <code>char</code>, has a range of either -128 to 127 or 0 to 255, depending on whether or not <code>char</code> is signed or unsigned.  The value 538998128 of <code>c</code> is outside of this range, so the comparison will never be true.</p>\n\n<p>At the start of the function, you have this line:</p>\n\n<pre><code>(unsigned char)c;\n</code></pre>\n\n<p>But this does nothing.  It casts the value of <code>c</code> to an <code>unsigned char</code> and does nothing with the resulting value.  It does not change the value of <code>c</code>.</p>\n\n<p>The other implementation you show casts <code>c</code> to <code>unsigned char</code> and <em>then</em> compares that casted value with <code>*s</code>.  That's why the other implementation gives the expected result.</p>\n"}], "owner": {"reputation": 121, "user_id": 8710999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c41cc8d87f29ba8362c7bf9bc6c2e73?s=128&d=identicon&r=PG&f=1", "display_name": "ivoriik", "link": "https://stackoverflow.com/users/8710999/ivoriik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 47909027, "answer_count": 1, "score": 1, "last_activity_date": 1513782471, "creation_date": 1513781839, "question_id": 47908806, "link": "https://stackoverflow.com/questions/47908806/why-strchr-returns-not-a-null-when-the-second-argument-is-a-string-into-a-single", "title": "why strchr returns not a NULL when the second argument is a string into a single quotation marks (&#39;text&#39;)", "body": "<p>I tried to write implementation of the <code>strchr()</code>. </p>\n\n<pre><code>char    *ft_strchr(const char *s, int c)\n{\n(unsigned char)c;\n    while (*s)\n    {\n        if (*s == c)\n            return ((char *)s);\n        s++;\n    }\n    if (c == '\\0')\n        return ((char *)s);\n    return (NULL);\n}\n</code></pre>\n\n<p>It works similar in most of cases except this one:</p>\n\n<pre><code>printf(\"%s\\n\", strchr(\"Whats up with you, men\", '  up'));\n</code></pre>\n\n<p><code>strchr</code> returns </p>\n\n<pre><code> p with you, men\n</code></pre>\n\n<p>while me version <code>ft_strchr</code> returns <code>NULL</code></p>\n\n<p>I'm curious why <code>strchr</code> behaves which way. <code>' up'</code> converted to <code>unsigned char</code> is 'p' (as <code>int</code> 538998128).</p>\n\n<p>Also I found here different implementation and it behave as strchr even with this data.</p>\n\n<pre><code>char    *ft_strchr(const char *s, int c) {\n    while (*s != (unsigned char) c) {\n        if (!*s)\n            return NULL;\n        s++;}\n    return (char *)s;\n}\n</code></pre>\n\n<p>Also my version is different I guess they should work similar but they don't. I really interested why?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "pointers", "gtk3", "segmentation-fault"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1513781199, "post_id": 47908499, "comment_id": 82784440, "body": "Post the missing Glade file that connects the signal causing the segfault."}], "answers": [{"tags": [], "owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "is_accepted": true, "score": 0, "last_activity_date": 1513796786, "creation_date": 1513796786, "answer_id": 47912810, "question_id": 47908499, "link": "https://stackoverflow.com/questions/47908499/gtk-c-segv-adding-new-signal-causes-segv/47912810#47912810", "title": "GTK C segv: Adding new signal causes segv", "body": "<p>The problem resides in this two lines:</p>\n\n<pre><code>gtk_builder_connect_signals (builder, toggle);\ngtk_builder_connect_signals (builder, test);\n</code></pre>\n\n<p>When you use this function the user_data passed to connect the signal will be applied to all signal handlers.</p>\n\n<p>If you choose this path then your user data should contain all the relevant data and handlers must address it accordingly.</p>\n\n<p>Problem is that your signal handlers expect different things but you give them the same data.</p>\n\n<p>From the <a href=\"https://developer.gnome.org/gtk3/stable/GtkBuilder.html#gtk-builder-connect-signals\" rel=\"nofollow noreferrer\"><code>gtk_builder_connect_signals</code></a>:</p>\n\n<blockquote>\n  <h3>user_data</h3>\n  \n  <p>user data to pass back with all signals</p>\n</blockquote>\n\n<p>So what can you do?</p>\n\n<p>If you want to keep the same approach, then, e.g., let's create a structure that contains all the relevant data which will then be passed to the callback/signal handlers:</p>\n\n<pre><code>typedef struct {\n   interface *toggle;\n   test_parameters *test;\n} app_user_data;\n</code></pre>\n\n<p>Then initialize the contents:</p>\n\n<pre><code>app_user_data *user_data = g_slice_new (app_user_data);\nuser_data-&gt;toggle = toggle;\nuser_data-&gt;test = test;\n</code></pre>\n\n<p>Remove the redundant <code>gtk_builder_connect_signals</code> and replace one with our new structure:</p>\n\n<pre><code>gtk_builder_connect_signals (builder, user_data);\n</code></pre>\n\n<p>Now, all of the callbacks can use the data they need:</p>\n\n<pre><code>G_MODULE_EXPORT gboolean on_eventbox_image_wired_button_press_event (GtkWidget *widget, GdkEvent *event, gpointer toggle) {\n\n   app_user_data *user_data = (app_user_data *) toggle;\n\n    if (((interface *) user_data-&gt;toggle)-&gt;eth0 == NULL) {\n        printf(\"%s\\n\", \"WIRED: eth0 IS NULL - REMOVE ME\");\n    }\n    ...\n\nG_MODULE_EXPORT gboolean on_eventbox_image_wifi_button_press_event (GtkWidget *widget, GdkEvent *event, gpointer toggle) {\n   app_user_data *user_data = (app_user_data *) toggle;\n\n    /* Check to see if we have IP address so we can change the colour otherwise leave it red */\n    if (((interface *) user_data-&gt;toggle)-&gt;wlan0-&gt;ip_enabled) {\n    ...\n\nG_MODULE_EXPORT gboolean on_switch_test_on_state_set (GtkSwitch *widget, gboolean state, gpointer test) {\n   app_user_data *user_data = (app_user_data *) test;\n\n   (((test_parameters *) user_data-&gt;test)-&gt;active) = state;\n   ...\n</code></pre>\n\n<p>Your code with the suggested changes should be something like this:</p>\n\n<pre><code>/*\n *  * STRIPPED DOWN VERSION\n *   */\n#include &lt;arpa/inet.h&gt;\n#include &lt;gtk/gtk.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/ip.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\n\n#define IPV4_ENABLED                1\n#define IPV4_DISABLED               0\n#define SELECTED                    1\n\ntypedef struct {\n    int ip_enabled;\n} net;\n\ntypedef struct {\n    net *eth0;\n    net *wlan0;\n    int type;\n} interface;\n\ntypedef enum {\n    IT_ETH0,\n    IT_WLAN0,\n    IT_UNASSIGNED = 999,\n} interface_type;\n\ntypedef struct {\n    int active;\n    interface *port;\n    int debug;\n} test_parameters;\n\ntypedef struct {\n   interface *toggle;\n   test_parameters *test;\n} app_user_data;\n\nvoid wired (net *eth0);\n\nvoid wifi (net *wlan0);\n\nint main (int argc, char *argv[]) {\n\n    GtkBuilder *builder;\n    GtkWidget *window;\n    GError *gtk_error = NULL;\n\n    net *eth0 = g_slice_new (net);\n    net *wlan0 = g_slice_new (net);\n    interface *toggle = g_slice_new (interface);\n\n    test_parameters *test = g_slice_new (test_parameters);\n\n    test-&gt;port-&gt;type == IT_UNASSIGNED;\n\n        /*Add interfaces to struct \"interface\" */\n    toggle-&gt;eth0 = eth0;\n    toggle-&gt;wlan0 = wlan0;\n\n    toggle-&gt;eth0-&gt;ip_enabled = 0;\n    toggle-&gt;wlan0-&gt;ip_enabled = 0;\n\n   app_user_data *user_data = g_slice_new (app_user_data);\n   user_data-&gt;toggle = toggle;\n   user_data-&gt;test = test;\n\n    if (NULL == toggle-&gt;eth0)\n        fprintf (stdout, \"%s\\n\", \"eth0 is null \");\n\n    if (NULL == toggle-&gt;wlan0)\n        fprintf (stdout, \"%s\\n\", \"wlan0 is null \");\n\n\n    gtk_init (&amp;argc, &amp;argv);\n\n    builder = gtk_builder_new ();\n    if (!gtk_builder_add_from_file (builder, \"glade/window_main.glade\", NULL)) {\n        fprintf (stdout, \"%s%s\\n\", \"Error loading file with the reason: \", gtk_error-&gt;message);\n        g_free (gtk_error);\n        exit (EXIT_FAILURE);\n    }\n\n    window = GTK_WIDGET (gtk_builder_get_object (builder, \"window_main\"));\n\n    gtk_builder_connect_signals (builder, user_data);\n\n    g_object_unref (builder);\n\n    wired (eth0);\n    wifi (wlan0);\n    gtk_widget_show (window);\n\n    gtk_main ();\n\n    g_slice_free (net, eth0);\n    g_slice_free (net, wlan0);\n    g_slice_free (interface, toggle);\n\n    return 0;\n\n}\n\nvoid wifi (net *wlan0) {\n\n    if (1) {\n        wlan0-&gt;ip_enabled = IPV4_ENABLED;\n    }\n\n}\n\nvoid wired (net *eth0) {\n\n    if (1) {\n        eth0-&gt;ip_enabled = IPV4_ENABLED;\n    }\n\n}\n\nG_MODULE_EXPORT gboolean on_eventbox_image_wired_button_press_event (GtkWidget *widget, GdkEvent *event, gpointer toggle) {\n\n   app_user_data *user_data = (app_user_data *) toggle;\n\n    if (((interface *) user_data-&gt;toggle)-&gt;eth0 == NULL) {\n        printf(\"%s\\n\", \"WIRED: eth0 IS NULL - REMOVE ME\");\n    }\n\n    if (((interface *) user_data-&gt;toggle) == NULL) {\n        printf(\"%s\\n\", \"WIRED: toggle IS NULL - REMOVE ME\");\n    }\n\n    if (((interface *) user_data-&gt;toggle)-&gt;eth0-&gt;ip_enabled) {\n        printf(\"%s\\n\", \"WIRED: eth0 is ip enabled - REMOVE ME\");\n        ((interface *) toggle)-&gt;type = IT_ETH0;\n        if (((interface *) user_data-&gt;toggle)-&gt;wlan0-&gt;ip_enabled) {\n            printf(\"%s\\n\", \"WIRED: wlan0 is ip enabled, adjust - REMOVE ME\");\n        }\n    }\n    return 0;\n}\n\nG_MODULE_EXPORT gboolean on_eventbox_image_wifi_button_press_event (GtkWidget *widget, GdkEvent *event, gpointer toggle) {\n   app_user_data *user_data = (app_user_data *) toggle;\n\n    /* Check to see if we have IP address so we can change the colour otherwise leave it red */\n    if (((interface *) user_data-&gt;toggle)-&gt;wlan0-&gt;ip_enabled) {\n        printf(\"%s\\n\", \"WLAN has IP enabled\");\n        ((interface *) user_data-&gt;toggle)-&gt;type = IT_ETH0;\n        if (((interface *) user_data-&gt;toggle)-&gt;eth0-&gt;ip_enabled) {\n            printf(\"%s\\n\", \"WLAN: eth0 is ip enabled, adjust - REMOVE ME\");\n        }\n    }\n\n    return 0;       \n}\n\nG_MODULE_EXPORT gboolean on_switch_test_on_state_set (GtkSwitch *widget, gboolean state, gpointer test) {\n   app_user_data *user_data = (app_user_data *) test;\n\n    (((test_parameters *) user_data-&gt;test)-&gt;active) = state;\n\n    fprintf (stdout, \"%s%i\\n\", \"Signal fired and the state is \", state);\n\n    return 0;\n\n}\n\nvoid on_window_main_destroy () {\n\n    gtk_main_quit ();\n}\n</code></pre>\n\n<p>It should compile and not segfault like before!</p>\n"}], "owner": {"reputation": 33, "user_id": 5560672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/983a5d7be42b22b80593a24640fb4fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jase", "link": "https://stackoverflow.com/users/5560672/jase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 47912810, "answer_count": 1, "score": 2, "last_activity_date": 1513796786, "creation_date": 1513780924, "last_edit_date": 1513781943, "question_id": 47908499, "link": "https://stackoverflow.com/questions/47908499/gtk-c-segv-adding-new-signal-causes-segv", "title": "GTK C segv: Adding new signal causes segv", "body": "<p>I am getting a sigsegv fault with the introduction of a new switch signal into an existing test gui.</p>\n\n<p>The UI has 3 possible sources of events, two event boxes and one switch. When the event boxes are clicked, they behave normally, however if the switch is toggled, then clicking on one of the event boxes results in a segv (behaviour 1). </p>\n\n<p>In addition, if run from new, toggling the switch first and then clicking on the event box also results in a segv (behaviour 2). The segv for both occurs always at the same place (if using one of the event boxes as an example) as follows:</p>\n\n<pre><code>if (((interface *) toggle)-&gt;eth0-&gt;ip_enabled) {\n</code></pre>\n\n<p>The simplest manifestation I could come up with in terms of code is as follows (excuse the includes):</p>\n\n<pre><code>/*\n * STRIPPED DOWN VERSION\n */\n#include &lt;arpa/inet.h&gt;\n#include &lt;gtk/gtk.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/ip.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\n\n#define IPV4_ENABLED                1\n#define IPV4_DISABLED               0\n#define SELECTED                    1\n\ntypedef struct {\n    int ip_enabled;\n} net;\n\ntypedef struct {\n    net *eth0;\n    net *wlan0;\n    int type;\n} interface;\n\ntypedef enum {\n    IT_ETH0,\n    IT_WLAN0,\n    IT_UNASSIGNED = 999,\n} interface_type;\n\ntypedef struct {\n    int active;\n    interface *port;\n    int debug;\n} test_parameters;\n\nvoid wired (net *eth0);\n\nvoid wifi (net *wlan0);\n\nint main (int argc, char *argv[]) {\n\n    GtkBuilder *builder;\n    GtkWidget *window;\n    GError *gtk_error = NULL;\n\n    net *eth0 = g_slice_new (net);\n    net *wlan0 = g_slice_new (net);\n    interface *toggle = g_slice_new (interface);\n\n    test_parameters *test = g_slice_new (test_parameters);\n\n    test-&gt;port-&gt;type == IT_UNASSIGNED;\n\n        /*Add interfaces to struct \"interface\" */\n    toggle-&gt;eth0 = eth0;\n    toggle-&gt;wlan0 = wlan0;\n\n    toggle-&gt;eth0-&gt;ip_enabled = 0;\n    toggle-&gt;wlan0-&gt;ip_enabled = 0;\n\n    if (NULL == toggle-&gt;eth0)\n        fprintf (stdout, \"%s\\n\", \"eth0 is null \");\n\n    if (NULL == toggle-&gt;wlan0)\n        fprintf (stdout, \"%s\\n\", \"wlan0 is null \");\n\n\n    gtk_init (&amp;argc, &amp;argv);\n\n    builder = gtk_builder_new ();\n    if (!gtk_builder_add_from_file (builder, \"glade/window_main.glade\", NULL)) {\n        fprintf (stdout, \"%s%s\\n\", \"Error loading file with the reason: \", gtk_error-&gt;message);\n        g_free (gtk_error);\n        exit (EXIT_FAILURE);\n    }\n\n    window = GTK_WIDGET (gtk_builder_get_object (builder, \"window_main\"));\n\n    gtk_builder_connect_signals (builder, toggle);\n    gtk_builder_connect_signals (builder, test);\n\n    g_object_unref (builder);\n\n    wired (eth0);\n    wifi (wlan0);\n    gtk_widget_show (window);\n\n    gtk_main ();\n\n    g_slice_free (net, eth0);\n    g_slice_free (net, wlan0);\n    g_slice_free (interface, toggle);\n\n    return 0;\n\n}\n\nvoid wifi (net *wlan0) {\n\n    if (1) {\n        wlan0-&gt;ip_enabled = IPV4_ENABLED;\n    }\n\n}\n\nvoid wired (net *eth0) {\n\n    if (1) {\n        eth0-&gt;ip_enabled = IPV4_ENABLED;\n    }\n\n}\n\nG_MODULE_EXPORT gboolean on_eventbox_image_wired_button_press_event (GtkWidget *widget,\n    GdkEvent *event, gpointer toggle) {\n\n    if (((interface *) toggle)-&gt;eth0 == NULL) {\n        printf(\"%s\\n\", \"WIRED: eth0 IS NULL - REMOVE ME\");\n    }\n\n    if (((interface *) toggle) == NULL) {\n        printf(\"%s\\n\", \"WIRED: toggle IS NULL - REMOVE ME\");\n    }\n\n    if (((interface *) toggle)-&gt;eth0-&gt;ip_enabled) {\n        printf(\"%s\\n\", \"WIRED: eth0 is ip enabled - REMOVE ME\");\n        ((interface *) toggle)-&gt;type = IT_ETH0;\n        if (((interface *) toggle)-&gt;wlan0-&gt;ip_enabled) {\n            printf(\"%s\\n\", \"WIRED: wlan0 is ip enabled, adjust - REMOVE ME\");\n        }\n\n    }\n    return 0;\n}\n\nG_MODULE_EXPORT gboolean on_eventbox_image_wifi_button_press_event (GtkWidget *widget,\n    GdkEvent *event, gpointer toggle) {\n\n    /* Check to see if we have IP address so we can change the colour otherwise leave it red */\n    if (((interface *) toggle)-&gt;wlan0-&gt;ip_enabled) {\n        printf(\"%s\\n\", \"WLAN has IP enabled\");\n        ((interface *) toggle)-&gt;type = IT_ETH0;\n        if (((interface *) toggle)-&gt;eth0-&gt;ip_enabled) {\n            printf(\"%s\\n\", \"WLAN: eth0 is ip enabled, adjust - REMOVE ME\");\n        }\n\n    }\n\n    return 0;       \n}\n\nG_MODULE_EXPORT gboolean on_switch_test_on_state_set (GtkSwitch *widget,\n    gboolean state, gpointer test) {\n\n    (((test_parameters *) test)-&gt;active) = state;\n\n    fprintf (stdout, \"%s%i\\n\", \"Signal fired and the state is \", state);\n\n    return 0;\n\n}\n\nvoid on_window_main_destroy () {\n\n    gtk_main_quit ();\n}\n</code></pre>\n\n<p>And the gdb bt is:</p>\n\n<pre><code>(gdb) run\nStarting program: /home/j2/simplified_example/simplified_example \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0x7fffed0c4700 (LWP 6979)]\n[New Thread 0x7fffec8c3700 (LWP 6980)]\nWIRED: eth0 is ip enabled - REMOVE ME\nWIRED: wlan0 is ip enabled, adjust - REMOVE ME\nSignal fired and the state is 1\n\nThread 1 \"simplified_exam\" received signal SIGSEGV, Segmentation fault.\n0x0000000000401110 in on_eventbox_image_wired_button_press_event (widget=0x6a7260 [GtkEventBox], event=0x994cb0, toggle=0x624800)\n    at src/simplified_example1.c:134\n134     if (((interface *) toggle)-&gt;eth0-&gt;ip_enabled) {\n(gdb) bt\n#0  0x0000000000401110 in on_eventbox_image_wired_button_press_event (widget=0x6a7260 [GtkEventBox], event=0x994cb0, toggle=0x624800)\n    at src/simplified_example1.c:134\n#5  0x00007ffff728008f in &lt;emit signal ??? on instance 0x6a7260 [GtkEventBox]&gt; (instance=instance@entry=0x6a7260, signal_id=&lt;optimised out&gt;, detail=detail@entry=0) at /build/glib2.0-prJhLS/glib2.0-2.48.2/./gobject/gsignal.c:3441\n    #1  0x00007ffff76bafac in _gtk_marshal_BOOLEAN__BOXED (closure=0x6ffe50, return_value=0x7fffffffd940, n_param_values=&lt;optimised out&gt;, param_values=0x7fffffffd9a0, invocation_hint=&lt;optimised out&gt;, marshal_data=&lt;optimised out&gt;) at /build/gtk+3.0-2Ut_nl/gtk+3.0-3.18.9/./gtk/gtkmarshalers.c:86\n    #2  0x00007ffff7264fa5 in g_closure_invoke (closure=0x6ffe50, return_value=return_value@entry=0x7fffffffd940, n_param_values=2, param_values=param_values@entry=0x7fffffffd9a0, invocation_hint=invocation_hint@entry=0x7fffffffd920) at /build/glib2.0-prJhLS/glib2.0-2.48.2/./gobject/gclosure.c:804\n    #3  0x00007ffff7276fc1 in signal_emit_unlocked_R (node=node@entry=0x653b40, detail=detail@entry=0, instance=instance@entry=0x6a7260, emission_return=emission_return@entry=0x7fffffffdab0, instance_and_params=instance_and_params@entry=0x7fffffffd9a0)\n    at /build/glib2.0-prJhLS/glib2.0-2.48.2/./gobject/gsignal.c:3629\n    #4  0x00007ffff727f7f9 in g_signal_emit_valist (instance=&lt;optimised out&gt;, signal_id=&lt;optimised out&gt;, detail=&lt;optimised out&gt;, var_args=var_args@entry=0x7fffffffdb60) at /build/glib2.0-prJhLS/glib2.0-2.48.2/./gobject/gsignal.c:3395\n#6  0x00007ffff77f8c3c in gtk_widget_event_internal (widget=0x6a7260 [GtkEventBox], event=0x994cb0)\n    at /build/gtk+3.0-2Ut_nl/gtk+3.0-3.18.9/./gtk/gtkwidget.c:7692\n#7  0x00007ffff76b83be in propagate_event (topmost=&lt;optimised out&gt;, event=&lt;optimised out&gt;, widget=0x6a7260 [GtkEventBox])\n    at /build/gtk+3.0-2Ut_nl/gtk+3.0-3.18.9/./gtk/gtkmain.c:2527\n#8  0x00007ffff76b83be in propagate_event (widget=&lt;optimised out&gt;, event=0x994cb0, captured=&lt;optimised out&gt;, topmost=0x0)\n    at /build/gtk+3.0-2Ut_nl/gtk+3.0-3.18.9/./gtk/gtkmain.c:2629\n#9  0x00007ffff76ba1bc in gtk_main_do_event (event=0x994cb0) at /build/gtk+3.0-2Ut_nl/gtk+3.0-3.18.9/./gtk/gtkmain.c:1850\n#10 0x00007ffff66dcd92 in gdk_event_source_dispatch (source=&lt;optimised out&gt;, callback=&lt;optimised out&gt;, user_data=&lt;optimised out&gt;)\n    at /build/gtk+3.0-2Ut_nl/gtk+3.0-3.18.9/./gdk/x11/gdkeventsource.c:369\n#11 0x00007ffff6f8e197 in g_main_context_dispatch (context=0x640980) at /build/glib2.0-prJhLS/glib2.0-2.48.2/./glib/gmain.c:3154\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#12 0x00007ffff6f8e197 in g_main_context_dispatch (context=context@entry=0x640980) at /build/glib2.0-prJhLS/glib2.0-2.48.2/./glib/gmain.c:3769\n#13 0x00007ffff6f8e3f0 in g_main_context_iterate (context=0x640980, block=block@entry=1, dispatch=dispatch@entry=1, self=&lt;optimised out&gt;)\n    at /build/glib2.0-prJhLS/glib2.0-2.48.2/./glib/gmain.c:3840\n#14 0x00007ffff6f8e712 in g_main_loop_run (loop=0x8d14b0) at /build/glib2.0-prJhLS/glib2.0-2.48.2/./glib/gmain.c:4034\n#15 0x00007ffff76b9395 in gtk_main () at /build/gtk+3.0-2Ut_nl/gtk+3.0-3.18.9/./gtk/gtkmain.c:1241\n#16 0x0000000000401065 in main (argc=1, argv=0x7fffffffdfd8) at src/simplified_example1.c:97\n(gdb) \n(gdb) \n(gdb) \n</code></pre>\n\n<p>Please and thank you in advance for any assistance on this.</p>\n\n<p>Edit: Added the glade file as requested - it is simplified for testing purposes:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- Generated with glade 3.18.3 --&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"3.12\"/&gt;\n  &lt;object class=\"GtkWindow\" id=\"window_main\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;property name=\"title\" translatable=\"yes\"&gt;Main Window&lt;/property&gt;\n    &lt;property name=\"default_width\"&gt;640&lt;/property&gt;\n    &lt;property name=\"default_height\"&gt;480&lt;/property&gt;\n    &lt;property name=\"decorated\"&gt;False&lt;/property&gt;\n    &lt;signal name=\"destroy\" handler=\"on_window_main_destroy\" swapped=\"no\"/&gt;\n    &lt;child&gt;\n      &lt;object class=\"GtkFixed\" id=\"fixed_background\"&gt;\n        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkImage\" id=\"image_background\"&gt;\n            &lt;property name=\"name\"&gt;4&lt;/property&gt;\n            &lt;property name=\"width_request\"&gt;640&lt;/property&gt;\n            &lt;property name=\"height_request\"&gt;480&lt;/property&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"stock\"&gt;gtk-missing-image&lt;/property&gt;\n          &lt;/object&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkEventBox\" id=\"eventbox_image_wired\"&gt;\n            &lt;property name=\"width_request\"&gt;100&lt;/property&gt;\n            &lt;property name=\"height_request\"&gt;80&lt;/property&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"visible_window\"&gt;False&lt;/property&gt;\n            &lt;property name=\"above_child\"&gt;True&lt;/property&gt;\n            &lt;signal name=\"button-press-event\" handler=\"on_eventbox_image_wired_button_press_event\" swapped=\"no\"/&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkImage\" id=\"image_wired\"&gt;\n                &lt;property name=\"width_request\"&gt;100&lt;/property&gt;\n                &lt;property name=\"height_request\"&gt;80&lt;/property&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"xalign\"&gt;0&lt;/property&gt;\n                &lt;property name=\"yalign\"&gt;0&lt;/property&gt;\n                &lt;property name=\"icon_name\"&gt;applications-graphics&lt;/property&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"x\"&gt;35&lt;/property&gt;\n            &lt;property name=\"y\"&gt;20&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkEventBox\" id=\"eventbox_image_wifi\"&gt;\n            &lt;property name=\"width_request\"&gt;100&lt;/property&gt;\n            &lt;property name=\"height_request\"&gt;80&lt;/property&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"visible_window\"&gt;False&lt;/property&gt;\n            &lt;property name=\"above_child\"&gt;True&lt;/property&gt;\n            &lt;signal name=\"button-press-event\" handler=\"on_eventbox_image_wifi_button_press_event\" swapped=\"no\"/&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkImage\" id=\"image_wifi\"&gt;\n                &lt;property name=\"width_request\"&gt;101&lt;/property&gt;\n                &lt;property name=\"height_request\"&gt;71&lt;/property&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"xalign\"&gt;0&lt;/property&gt;\n                &lt;property name=\"yalign\"&gt;0&lt;/property&gt;\n                &lt;property name=\"icon_name\"&gt;accessories-text-editor&lt;/property&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"x\"&gt;200&lt;/property&gt;\n            &lt;property name=\"y\"&gt;20&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkGrid\" id=\"grid_test_parameter\"&gt;\n            &lt;property name=\"width_request\"&gt;582&lt;/property&gt;\n            &lt;property name=\"height_request\"&gt;116&lt;/property&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"row_spacing\"&gt;10&lt;/property&gt;\n            &lt;property name=\"column_spacing\"&gt;4&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkSwitch\" id=\"switch_test_on\"&gt;\n                &lt;property name=\"use_action_appearance\"&gt;True&lt;/property&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                &lt;signal name=\"state-set\" handler=\"on_switch_test_on_state_set\" swapped=\"no\"/&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"left_attach\"&gt;0&lt;/property&gt;\n                &lt;property name=\"top_attach\"&gt;0&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"x\"&gt;15&lt;/property&gt;\n            &lt;property name=\"y\"&gt;245&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 5, "creation_date": 1513779770, "post_id": 47908066, "comment_id": 82783440, "body": "You want the variable outside the <code>__cplusplus</code> block, otherwise it only exists in C++."}, {"owner": {"reputation": 97, "user_id": 8571457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd920007b555d28f165d3c292d904659?s=128&d=identicon&r=PG&f=1", "display_name": "kenik", "link": "https://stackoverflow.com/users/8571457/kenik"}, "edited": false, "score": 0, "creation_date": 1513779822, "post_id": 47908066, "comment_id": 82783475, "body": "then i have the same error + &quot;expected : &quot;=&quot;, &quot;,&quot; etc &quot;"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1513779903, "post_id": 47908066, "comment_id": 82783530, "body": "@kenik Please copy and paste your error messages in the question instead of vague approximations of them. Also post the code that they refer to."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513780031, "post_id": 47908066, "comment_id": 82783619, "body": "You may also want to change the variable to an <code>extern volatile tU32 ticks;</code> And define it in <b>one</b> translation unit."}, {"owner": {"reputation": 97, "user_id": 8571457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd920007b555d28f165d3c292d904659?s=128&d=identicon&r=PG&f=1", "display_name": "kenik", "link": "https://stackoverflow.com/users/8571457/kenik"}, "edited": false, "score": 0, "creation_date": 1513780587, "post_id": 47908066, "comment_id": 82783987, "body": "In file included from interrupt.c:2: interrupt.h:15: error: expected <code>=&#39;, </code>,&#39;, <code>;&#39;, </code>asm&#39; or <code>__attribute__&#39; before </code> ticks&#39; interrupt.c: In function <code>interrupt2&#39;: interrupt.c:5: error: </code>ticks&#39; undeclared (first use in this function) interrupt.c:5: error: (Each undeclared identifier is reported only once interrupt.c:5: error: for each function it appears in.) make: *** [interrupt.o] Error 1"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1513780692, "post_id": 47908066, "comment_id": 82784059, "body": "The second error is presumably because the compiler does not recognize <code>tU32</code> as a type.  You may need this header to include another that provides the definition of that type."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 8571457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd920007b555d28f165d3c292d904659?s=128&d=identicon&r=PG&f=1", "display_name": "kenik", "link": "https://stackoverflow.com/users/8571457/kenik"}, "edited": false, "score": 0, "creation_date": 1513783241, "post_id": 47908931, "comment_id": 82785870, "body": "What should i do if i want to have access to ticks from main ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 97, "user_id": 8571457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd920007b555d28f165d3c292d904659?s=128&d=identicon&r=PG&f=1", "display_name": "kenik", "link": "https://stackoverflow.com/users/8571457/kenik"}, "edited": false, "score": 1, "creation_date": 1513783447, "post_id": 47908931, "comment_id": 82786000, "body": "@kenik: Include the <code>interrupt.h</code> header in the code that defines <code>main()</code>."}, {"owner": {"reputation": 97, "user_id": 8571457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd920007b555d28f165d3c292d904659?s=128&d=identicon&r=PG&f=1", "display_name": "kenik", "link": "https://stackoverflow.com/users/8571457/kenik"}, "edited": false, "score": 0, "creation_date": 1513783523, "post_id": 47908931, "comment_id": 82786053, "body": "i put that and just got &quot;Error 1 &quot; :("}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 2, "last_activity_date": 1513782883, "last_edit_date": 1513782883, "creation_date": 1513782239, "answer_id": 47908931, "question_id": 47908066, "link": "https://stackoverflow.com/questions/47908066/undeclared-variable-issue-with-headers/47908931#47908931", "title": "undeclared variable. [ issue with headers ]", "body": "<p>Note: in the following code example, I stripped all the unrelated statements</p>\n\n<p>1) do not declare variables in a header file.  if necessary, use the 'extern' modifier in the header file.   </p>\n\n<p>2) Declare the variable in a source file, like <code>main.c</code></p>\n\n<p>3)  any symbol name beginning with underscore+capital letter  Or two underscores are 'reserved' for the system.  Therefore strongly suggest replacing all instances of <code>__IRQ_HANDLER__</code>  with the (typical) <code>INTERRUPT_H</code></p>\n\n<p>an example code:</p>\n\n<p>file: interrupt.h</p>\n\n<pre><code>#ifndef INTERRUPT_H\n#define INTERRUPT_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nextern volatile unsigned int ticks;\nvoid interrupt2(void);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif // INTERRUPT_H\n</code></pre>\n\n<p>file: interruptHandler.c</p>\n\n<pre><code>#include \"interrupt.h\"\n\nvolatile unsigned int ticks = 0;\n\nvoid interrupt2(void)\n{\n    ticks++;\n}\n</code></pre>\n\n<p>There needs to be a third file that declares the variable: <code>ticks</code></p>\n\n<p>and if declared in the file global space,\nit will automatically be initialized to 0</p>\n\n<p>It is necessary to also treat the code in the third file that accesses the <code>ticks</code> variable as a 'critical section.  Probably by:</p>\n\n<ol>\n<li>disable the interrupts</li>\n<li>copying <code>ticks</code> to a local variable</li>\n<li>enable the interrupts</li>\n</ol>\n"}], "owner": {"reputation": 97, "user_id": 8571457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd920007b555d28f165d3c292d904659?s=128&d=identicon&r=PG&f=1", "display_name": "kenik", "link": "https://stackoverflow.com/users/8571457/kenik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 47908931, "answer_count": 1, "score": -1, "last_activity_date": 1526859310, "creation_date": 1513779543, "last_edit_date": 1526859310, "question_id": 47908066, "link": "https://stackoverflow.com/questions/47908066/undeclared-variable-issue-with-headers", "title": "undeclared variable. [ issue with headers ]", "body": "<p>I have headers in my microcontroller program</p>\n\n<pre><code> #ifndef __IRQ_HANDLER__\n #define __IRQ_HANDLER__\n#ifdef __cplusplus  \nvolatile tU32 ticks = 0; // &lt;- with that variable i have problem\n\nextern \"C\" {\n#endif\nvoid interrupt2(void);\n#ifdef __cplusplus\n}\n#endif\n\n\n#endif //__IRQ_HANDLER__\n</code></pre>\n\n<p>Then file.c</p>\n\n<pre><code>#include &lt;lpc2xxx.h&gt;\n#include \"interrupt.h\"\n\nvoid interrupt2(void) {\n    ticks++;\n    T1IR = 0xff;\n    VICVectAddr = 0x00;\n}\n</code></pre>\n\n<p>Every time when i'm trying to use variable ticks. I got an error : \n'ticks' undeclared ( first use in this function ).</p>\n\n<p>Have you any clue what might be wrong ?</p>\n\n<p>Greetings ! </p>\n"}, {"tags": ["android", "c", "debugging", "armv7"], "answers": [{"tags": [], "owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "is_accepted": true, "score": 1, "last_activity_date": 1513781819, "creation_date": 1513781819, "answer_id": 47908800, "question_id": 47907998, "link": "https://stackoverflow.com/questions/47907998/how-can-i-view-the-stack-traces-of-a-native-compiled-c-program-in-android/47908800#47908800", "title": "How can I view the stack traces of a native compiled C program in android?", "body": "<p>Try to use gdb in remote mode: <a href=\"https://source.android.com/devices/tech/debug/gdb\" rel=\"nofollow noreferrer\">https://source.android.com/devices/tech/debug/gdb</a>\nprobably it works already (had problems with it in past).</p>\n\n<p>Also you can try to use Google Breakpad: <a href=\"https://github.com/google/breakpad/blob/master/README.ANDROID\" rel=\"nofollow noreferrer\">https://github.com/google/breakpad/blob/master/README.ANDROID</a> it works sometimes :)</p>\n"}], "owner": {"reputation": 1681, "user_id": 4161385, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100007456651829/picture?type=large", "display_name": "PSN", "link": "https://stackoverflow.com/users/4161385/psn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "accepted_answer_id": 47908800, "answer_count": 1, "score": 1, "last_activity_date": 1513781819, "creation_date": 1513779326, "question_id": 47907998, "link": "https://stackoverflow.com/questions/47907998/how-can-i-view-the-stack-traces-of-a-native-compiled-c-program-in-android", "title": "How can I view the stack traces of a native compiled C program in android?", "body": "<p>I have compiled a c program for arm v7 using <code>arm-linux-gnueabi-gcc -static -fno-stack-protector -fno-pie -march=armv7-a hello.c -o hello</code> and pushed the binary to /data/local/hello inside the root of android device. I'm able to run the program using adb shell. But my question is how can I debug the program i.e., how can I see the Program Counter and such info?</p>\n"}, {"tags": ["c", "pointers", "storage-duration"], "comments": [{"owner": {"reputation": 566, "user_id": 2164975, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c24c5abd664fc20954b2434ec63bbdb2?s=128&d=identicon&r=PG", "display_name": "betaros", "link": "https://stackoverflow.com/users/2164975/betaros"}, "edited": false, "score": 1, "creation_date": 1513777592, "post_id": 47907472, "comment_id": 82781996, "body": "We need the code to be able to help you"}, {"owner": {"reputation": 808, "user_id": 6532640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-8Uw3zcKUw5c/AAAAAAAAAAI/AAAAAAAAACE/yaXF1QrLkjM/photo.jpg?sz=128", "display_name": "NatNgs", "link": "https://stackoverflow.com/users/6532640/natngs"}, "edited": false, "score": 1, "creation_date": 1513777613, "post_id": 47907472, "comment_id": 82782010, "body": "Hello, Can you please provide your code (or a relevant part of your code) and your error so that we can understand the error and help you ? Each error is different so without information we have no clue to help you !"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1513777692, "post_id": 47907472, "comment_id": 82782066, "body": "The array <code>A</code> is a <i>local variable</i> which will go out of scope and disappear immediately when the function returns."}, {"owner": {"reputation": 400, "user_id": 5533643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9MWx.png?s=128&g=1", "display_name": "Angen", "link": "https://stackoverflow.com/users/5533643/angen"}, "edited": false, "score": 0, "creation_date": 1513777752, "post_id": 47907472, "comment_id": 82782110, "body": "please, do not put the code as image or link, put it as text using code style"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1513778060, "post_id": 47907472, "comment_id": 82782317, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42473184/returning-pointer-to-array-doesnt-give-expected-output-in-c\">Returning pointer to array doesn&#39;t give expected output in c</a>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513779712, "post_id": 47907472, "comment_id": 82783407, "body": "@Someprogrammerdude is almost right, and it&#39;s probably best to think of it as he says.  Unfortunately, what happens is implementation specific, and rather than the variable &quot;immediately disappearing&quot;, you will get odd behavior that sometimes works as expected and other times does not."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1513780594, "post_id": 47907472, "comment_id": 82783992, "body": "@WilliamPursell -- attempts to access the object referenced by <code>A</code> within the function after control has returned to <code>main()</code> are not implementation-specific, but lead to undefined behavior."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1513781388, "post_id": 47907472, "comment_id": 82784588, "body": "@DavidBowling You are correct.  Perhaps I should say &quot;depend on the implementation&quot;, since I am trying to avoid getting bogged down in technical language.  &quot;Implementation specific&quot; and &quot;undefined behavior&quot;  have technical meanings which I don&#39;t think matter terribly much to the OP.  Either should be avoided."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1513783125, "post_id": 47907472, "comment_id": 82785803, "body": "@WilliamPursell -- agree that it would be easy to get bogged down with technical details here, and the take-away for OP should be &quot;don&#39;t do this.&quot; I just wanted to refine your point a bit: the array referenced by <code>A</code> may or may not disappear immediately (implementation-dependent), but the later access attempt is UB regardless."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1513778715, "last_edit_date": 1513778715, "creation_date": 1513778374, "answer_id": 47907709, "question_id": 47907472, "link": "https://stackoverflow.com/questions/47907472/error-outputpointer/47907709#47907709", "title": "Error Output(Pointer)", "body": "<p>Within the function <code>pointer</code> the array <code>A</code> is a local object of the function that will not be alive after exiting the function. The memory occupied by this array can be overwritten by other objects created in the program.</p>\n\n<p>So returning pointer to a local object with the automatic storage duration of a function results in undefined behavior.</p>\n\n<p>You could make the program valid the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint * pointer( int a[] )\n{\n    a[0] = 1;\n    a[1] = 2;\n\n    return a;\n}\n\n#define N   10\n\nint main(void) \n{\n    int a[N];\n\n    int *p = pointer( a );\n\n    printf( \"%d\\n\", *p );\n    printf( \"%d\\n\", *( p + 1 ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>1\n2\n</code></pre>\n\n<p>Another approach is to declare a local array within the function but with the static storage duration.</p>\n\n<p>For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define N   10\n\nint * pointer( void )\n{\n    static int a[N];\n\n    a[0] = 1;\n    a[1] = 2;\n\n    return a;\n}\n\nint main(void) \n{\n    int *p = pointer();\n\n    printf( \"%d\\n\", *p );\n    printf( \"%d\\n\", *( p + 1 ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>In this case the array will be alive even after exiting the function.</p>\n\n<p>Take into account that according to the C Standard the function <code>main</code> without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n          ^^^^\n</code></pre>\n\n<p>also the function <code>pointer</code> without parameters shall be also declared (when it is defined) like</p>\n\n<pre><code>int * pointer( void )\n               ^^^^\n{\n    //...\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8702665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c228bd4c5f1269c5b3fe318668f8b?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Narayanan", "link": "https://stackoverflow.com/users/8702665/varun-narayanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513780157, "creation_date": 1513777516, "last_edit_date": 1513780157, "question_id": 47907472, "link": "https://stackoverflow.com/questions/47907472/error-outputpointer", "title": "Error Output(Pointer)", "body": "<p>I am a basic level programmer. I wrote a function in a c program returning an array (through a pointer,link of program attached) but there is some error.\nThe output should be 12 but the output is 10.</p>\n\n<p>Can someone help me identify the mistake(if there is a concept error)</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint *pointer()\n{\n    int A[10];\n    A[0] = 1;\n    A[1] = 2;\n    return A;\n}\n\nint main()\n{\n    int *p;\n    p = pointer();\n    printf(\"%d\", *p);\n    printf(\"%d\", *(p+1))\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "process", "parent-child", "status"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513777661, "post_id": 47907380, "comment_id": 82782040, "body": "@Someprogrammerdude, <code>waitpid()</code> is documented to fail with <code>ECHILD</code> if the specified pid identifies a process that is not a child of the calling process.  I guess there&#39;s an off chance that the OP&#39;s implementation is buggy in that regard, but if it were then I certainly would not recommend relying on such a bug."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1513779064, "post_id": 47907380, "comment_id": 82782963, "body": "If a child&#39;s parent process dies, the orphaned child will be re-homed to <code>init</code>. This could be used to detect in the child the parent is no longer there. At this point in time, any information about the former parent process is long gone, however."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513783559, "post_id": 47907785, "comment_id": 82786082, "body": "Note that the functions registered with <code>atexit()</code> will only be called if the program stops under control and not by calling one of the fast exit functions."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513784643, "post_id": 47907785, "comment_id": 82786807, "body": "That is a good observation, @JonathanLeffler, which I somewhat pushed under the rug.  I did stipulate that the approach described supposes that the parent process terminates by calling <code>exit()</code> or returning from <code>main()</code>; if it terminates in some other way then it would need to explicitly run the child-notifying machinery before doing so for the children to hear about it.  That cannot be relied upon to happen in all cases -- in particular, it will not happen if the parent dies as a result of receiving a <code>SIGKILL</code>."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1513778599, "creation_date": 1513778599, "answer_id": 47907785, "question_id": 47907380, "link": "https://stackoverflow.com/questions/47907380/get-parent-process-status-in-linux/47907785#47907785", "title": "Get parent process status in Linux", "body": "<p>There is no standard function by which a process can wait for its parent to terminate or obtain its parent's exit status.  The process tree just doesn't work that way -- children notify their parents when they exit, not the other way around.</p>\n\n<p>Therefore, if you want child processes to learn of their parents' demise, you must arrange for the parent to actively notify them.  This seems like a job for signaling.  If you need only to inform children that the parent exited cleanly (i.e. by returning from <code>main()</code> or calling <code>exit()</code>) then that's probably enough by itself.  Choose a signal -- maybe <code>SIGUSR1</code> or <code>SIGUSR2</code> -- and have the parent register an <code>atexit()</code> handler that sends that signal to the children.  That might or might not require the parent to keep track of its children.</p>\n\n<p>Inasmuch as you mention getting the parent's exit status, however, you probably want a bit more.  You can get coarse-grained information to the children by choosing which of two (or more) signals to send to them, but for more detailed information you need an IPC mechanism.  You might write an exit status to shared memory or to a pipe (or to several of them), send a message to a socket or message queue, write a status to an ordinary file, or perhaps something else I haven't thought of.</p>\n\n<p>You should also consider that the existing model works pretty well, and has done for 40-ish years.  It may indeed not meet your needs, but I urge you to think about whether the design you have in mind could be improved to fit more cleanly into the Unix model.</p>\n"}], "owner": {"reputation": 561, "user_id": 6515166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yxxFp.jpg?s=128&g=1", "display_name": "Mssm", "link": "https://stackoverflow.com/users/6515166/mssm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 47907785, "answer_count": 1, "score": 0, "last_activity_date": 1513778599, "creation_date": 1513777221, "question_id": 47907380, "link": "https://stackoverflow.com/questions/47907380/get-parent-process-status-in-linux", "title": "Get parent process status in Linux", "body": "<p>Trying to get the process status of a given process P from one of its childs P'.</p>\n\n<p>I know about the function waitpid(), but in the doc, it said that it's used to check the status of a child process.</p>\n\n<p>So is there any other way to ?</p>\n"}, {"tags": ["c", "go", "glib"], "answers": [{"tags": [], "owner": {"reputation": 545, "user_id": 576138, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9fd87ec778a973d194c0fabd92c67830?s=128&d=identicon&r=PG", "display_name": "okelet", "link": "https://stackoverflow.com/users/576138/okelet"}, "is_accepted": true, "score": 0, "last_activity_date": 1514319253, "creation_date": 1514319253, "answer_id": 47983313, "question_id": 47907238, "link": "https://stackoverflow.com/questions/47907238/convert-glib-c-method-with-string-array-as-parameter-to-go/47983313#47983313", "title": "Convert glib C method with string array as parameter to Go", "body": "<p>This code works and does what is supposed to:</p>\n\n<pre><code>// SetStrv is a wrapper around g_settings_set_strv().\nfunc (v *Settings) SetStrv(name string, values []string) bool {\n    cstr1 := (*C.gchar)(C.CString(name))\n    defer C.free(unsafe.Pointer(cstr1))\n\n    // cvalues := C.make_strings(C.int(len(values) + 1))\n    cvalues := make([]*C.gchar, len(values))\n\n    for i, accel := range values {\n        cvalues[i] = (*C.gchar)(C.CString(accel))\n        defer C.free(unsafe.Pointer(cvalues[i]))\n    }\n    cvalues = append(cvalues, nil)\n\n    // C.set_string(cvalues, C.int(len(values)), nil)\n    return gobool(C.g_settings_set_strv(v.native(), cstr1, &amp;cvalues[0]))\n}\n</code></pre>\n\n<p>Thanks to <a href=\"https://github.com/tommyshem\" rel=\"nofollow noreferrer\">tommyshem from github</a> for his help (<a href=\"https://github.com/gotk3/gotk3/pull/225#issuecomment-353794102\" rel=\"nofollow noreferrer\">commit fix</a>).</p>\n"}], "owner": {"reputation": 545, "user_id": 576138, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9fd87ec778a973d194c0fabd92c67830?s=128&d=identicon&r=PG", "display_name": "okelet", "link": "https://stackoverflow.com/users/576138/okelet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 47983313, "answer_count": 1, "score": 1, "last_activity_date": 1514319253, "creation_date": 1513776762, "last_edit_date": 1513815801, "question_id": 47907238, "link": "https://stackoverflow.com/questions/47907238/convert-glib-c-method-with-string-array-as-parameter-to-go", "title": "Convert glib C method with string array as parameter to Go", "body": "<p>I am trying to add some methods to the <a href=\"https://github.com/gotk3/gotk3/tree/master/glib\" rel=\"nofollow noreferrer\">gotk3/glib</a> Go repository, but I am having troubles converting the method <a href=\"https://developer.gnome.org/gio/stable/GSettings.html#g-settings-set-strv\" rel=\"nofollow noreferrer\"><code>g_settings_set_strv</code></a> to Go; the C signature is this:</p>\n\n<pre><code>gboolean\ng_settings_set_strv (GSettings *settings,\n                     const gchar *key,\n                     const gchar *const *value);\n</code></pre>\n\n<p>And this is what I have in Go (adapted copy paste, I am not a C guy, only Java, Python, etc.):</p>\n\n<pre><code>// SetStrv is a wrapper around g_settings_set_strv().\nfunc (v *Settings) SetStrv(name string, values []string) bool {\n    cstr1 := (*C.gchar)(C.CString(name))\n    defer C.free(unsafe.Pointer(cstr1))\n\n    cvalues := C.make_strings(C.int(len(values) + 1))\n    defer C.destroy_strings(cvalues)\n\n    for i, accel := range values {\n        cstr := C.CString(accel)\n        defer C.free(unsafe.Pointer(cstr))\n        C.set_string(cvalues, C.int(i), (*C.gchar)(cstr))\n    }\n    C.set_string(cvalues, C.int(len(values)), nil)\n    return gobool(C.g_settings_set_strv(v.native(), cstr1, cvalues))\n}\n</code></pre>\n\n<p>But build fails with this message:</p>\n\n<pre><code>./settings.go:246: cannot use (*C.gchar)(cstr) (type *C.gchar) as type *C.char in argument to func literal\n./settings.go:249: cannot use cvalues (type **C.char) as type **C.gchar in argument to func literal\n</code></pre>\n\n<p>I am stuck in this...</p>\n"}, {"tags": ["c", "embedded", "cortex-m"], "comments": [{"owner": {"reputation": 42740, "user_id": 189134, "user_type": "moderator", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jFsyb.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/189134/andy"}, "edited": false, "score": 0, "creation_date": 1513863956, "post_id": 47906401, "comment_id": 82820364, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/161730/discussion-on-question-by-peter123-generate-sine-signal-in-c-without-using-the-s\">moved to chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 18, "last_activity_date": 1541098614, "last_edit_date": 1541098614, "creation_date": 1513776081, "answer_id": 47907017, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47907017#47907017", "title": "Generate sine signal in C without using the standard function", "body": "<p><em>...a better idea to implement a sine generator in C?</em> </p>\n\n<p>Edit: Suggest first reading <em><a href=\"https://www.embedded.com/design/configurable-systems/4007682/What-s-your-sine-Finding-the-right-algorithm-for-digital-frequency-synthesis-on-a-DSP\" rel=\"nofollow noreferrer\">this article</a></em> to gain an appreciation of what OP is asking. </p>\n\n<p>From the context provided in your question, I am assuming the word <strong><em>better</em></strong> might have to do with size and speed of compiled code, as might be required to run on a small micro-processor. </p>\n\n<p>The CORDIC ( <em>COordinate Rotation DIgital Computer</em> ) algorithm is very suitable for use on smaller uP, and FPGA implementations that have limited mathematical computation capabilities as it <em>computes the sine and cosine of a value using only basic arithmetic (addition, subtraction and shifts)</em>.  More about CORDIC, and how to use it to produce sine/cosine of an angle <em><a href=\"https://en.wikipedia.org/wiki/CORDIC\" rel=\"nofollow noreferrer\"> are provided here</a></em>.</p>\n\n<p>There are also several sites that provide algorithm implementation examples.  <em><a href=\"http://www.dcs.gla.ac.uk/~jhw/cordic/index.html\" rel=\"nofollow noreferrer\">Simple CORDIC</a></em> is one that includes detailed explanations on how to generate a table that can then be pre-compiled for use on your target device, as well as code to test the output of  the following function (which uses fixed point math):</p>\n\n<p>(See documentation of following, and other functions in link)  </p>\n\n<pre><code>#define cordic_1K 0x26DD3B6A\n#define half_pi 0x6487ED51\n#define MUL 1073741824.000000\n#define CORDIC_NTAB 32\nint cordic_ctab [] = {0x3243F6A8, 0x1DAC6705, 0x0FADBAFC, 0x07F56EA6, 0x03FEAB76, 0x01FFD55B, \n0x00FFFAAA, 0x007FFF55, 0x003FFFEA, 0x001FFFFD, 0x000FFFFF, 0x0007FFFF, 0x0003FFFF, \n0x0001FFFF, 0x0000FFFF, 0x00007FFF, 0x00003FFF, 0x00001FFF, 0x00000FFF, 0x000007FF, \n0x000003FF, 0x000001FF, 0x000000FF, 0x0000007F, 0x0000003F, 0x0000001F, 0x0000000F, \n0x00000008, 0x00000004, 0x00000002, 0x00000001, 0x00000000 };\n\nvoid cordic(int theta, int *s, int *c, int n)\n{\n  int k, d, tx, ty, tz;\n  int x=cordic_1K,y=0,z=theta;\n  n = (n&gt;CORDIC_NTAB) ? CORDIC_NTAB : n;\n  for (k=0; k&lt;n; ++k)\n  {\n    d = z&gt;&gt;31;\n    //get sign. for other architectures, you might want to use the more portable version\n    //d = z&gt;=0 ? 0 : -1;\n    tx = x - (((y&gt;&gt;k) ^ d) - d);\n    ty = y + (((x&gt;&gt;k) ^ d) - d);\n    tz = z - ((cordic_ctab[k] ^ d) - d);\n    x = tx; y = ty; z = tz;\n  }  \n *c = x; *s = y;\n}\n</code></pre>\n\n<p><strong><em>Edit:</em></strong><br>\nI found the documentation for using the examples at the <em><a href=\"http://www.dcs.gla.ac.uk/~jhw/cordic/index.html\" rel=\"nofollow noreferrer\">Simple CORDIC</a></em> site very easy to follow.  However, one small thing I ran into was when compiling the file <code>cordic-test.c</code> the error: <em>use of undeclared identifier 'M_PI'</em> occurred. It appears that when executing the compiled <code>gentable.c</code> file (which generates the <code>cordic-test.c</code> file) the line:</p>\n\n<pre><code>#define M_PI 3.1415926535897932384626\n</code></pre>\n\n<p>although included in its own declarations, was not included in the printf statements used to produce the file <code>cordic-test.c</code>. Once this was remedied, everything worked as advertised.  </p>\n\n<p>As documented, the range of data produced generates 1/4 of a complete sine cycle (-\u03c0/2 - \u03c0/2 ).  The following illustration contains a representation of the actual data produced between the light blue dots.  The remainder of the sine signal is fabricated via mirroring and transposing the original data section.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/aYzY2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aYzY2.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 21, "last_activity_date": 1533130708, "last_edit_date": 1533130708, "creation_date": 1513776776, "answer_id": 47907243, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47907243#47907243", "title": "Generate sine signal in C without using the standard function", "body": "<p>OP's main problem is in generating the index for the table look-up.</p>\n\n<p>OP's code attempts to access outside array <code>sine_table[40]</code> leading to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.  Fix that at least.</p>\n\n<pre><code>const int sine_table[40] = {0, 5125, 10125, ...\n    ...\n    x1 = (int) phase % 41;                     // -40 &lt;= x1 &lt;= 40\n    x2 = x1 + 1;                               // -39 &lt;= x2 &lt;= 41  \n    y = (sine_table[x2] - sine_table[x1])*...  // bad code, consider x1 = 40 or x2 = 40,41\n</code></pre>\n\n<p>Suggested change</p>\n\n<pre><code>    x1 = (int) phase % 40;   // mod 40, not 41\n    if (x1 &lt; 0) x1 += 40;    // Handle negative values\n    x2 = (x1 + 1) % 40;      // Handle wrap-around \n    y = (sine_table[x2] - sine_table[x1])*...  \n</code></pre>\n\n<p>There exist much better approaches, yet to focus on OP's method see below.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\nconst int sine_table[40] = { 0, 5125, 10125, 14876, 19260, 23170, 26509, 29196,\n31163, 32364, 32767, 32364, 31163, 29196, 26509, 23170, 19260, 14876, 10125,\n5125, 0, -5126, -10126, -14877, -19261, -23171, -26510, -29197, -31164, -32365,\n-32768, -32365, -31164, -29197, -26510, -23171, -19261, -14877, -10126, -5126 };\n\nint i = 0;\nint x1 = 0;\nint x2 = 0;\nfloat y = 0;\n\nfloat sin1(float phase) {\n  x1 = (int) phase % 40;\n  if (x1 &lt; 0) x1 += 40;\n  x2 = (x1 + 1) % 40;\n  y = (sine_table[x2] - sine_table[x1])\n      * ((float) ((int) (40 * 0.001 * i * 100) % 4100) / 100 - x1)\n      + sine_table[x1];\n  return y;\n}\n\nint main(void) {\n  double pi = 3.1415926535897932384626433832795;\n  for (int j = 0; j &lt; 1000; j++) {\n    float x = 40 * 0.001 * i;\n    float radians = x * 2 * pi / 40;\n    printf(\"%f %f %f\\n\", x, sin1(x) / 32768, sin(radians));\n    i = i + 1;\n  }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>         OP's     Reference sin()\n0.000000 0.000000 0.000000\n0.040000 0.006256 0.006283\n0.080000 0.012512 0.012566\n...\n1.960000 0.301361 0.303035\n2.000000 0.308990 0.309017\n2.040000 0.314790 0.314987\n...\n39.880001 -0.020336 -0.018848\n39.919998 -0.014079 -0.012567\n39.959999 -0.006257 -0.006283\n</code></pre>\n\n<hr>\n\n<p>Better code would not pass the values <code>i, x1, x2, y</code> as global variables, but as function parameters or function variables.  Perhaps that is an artifact of OP's debugging.</p>\n\n<hr>\n\n<blockquote>\n  <p>Does anybody have a better idea to implement a sine generator in C?</p>\n</blockquote>\n\n<p>This is quite broad.  Better as in speed, precision, code space, portability, or maintainability?  <code>sine()</code> functions are easy to make. High-quality ones take more effort.</p>\n\n<p>Although fuzzy, OP's use of a small look-up table is a good beginning - although I see it can be done without any floating point math.  I recommend for OP to construct a tested and working solution and post it in <a href=\"https://codereview.stackexchange.com\">Code Review</a> for improvement ideas.</p>\n"}, {"comments": [{"owner": {"reputation": 103366, "user_id": 903061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMWGQ.jpg?s=128&g=1", "display_name": "Gregor Thomas", "link": "https://stackoverflow.com/users/903061/gregor-thomas"}, "edited": false, "score": 4, "creation_date": 1513790450, "post_id": 47908170, "comment_id": 82790124, "body": "A Taylor series would be work nicely. <code>f(x) = x - x^3 &#47; 3! + x^5 &#47; 5! - x^7 &#47; 7! + ...</code>. You can extend the series as far as you want for additional precision."}, {"owner": {"reputation": 103366, "user_id": 903061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMWGQ.jpg?s=128&g=1", "display_name": "Gregor Thomas", "link": "https://stackoverflow.com/users/903061/gregor-thomas"}, "edited": false, "score": 2, "creation_date": 1513791142, "post_id": 47908170, "comment_id": 82790489, "body": "With just 5 terms, the largest error is 0.007 on the interval (-pi, pi)."}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "reply_to_user": {"reputation": 103366, "user_id": 903061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMWGQ.jpg?s=128&g=1", "display_name": "Gregor Thomas", "link": "https://stackoverflow.com/users/903061/gregor-thomas"}, "edited": false, "score": 3, "creation_date": 1513799239, "post_id": 47908170, "comment_id": 82794401, "body": "@Gregor you can achieve the same precision with only 3 terms if you expand in Chebyshev polynomials up to degree 3: <code>f(x) = 0.98402080986412*x-0.15330167221686*x^3+0.00545232213057963*&zwnj;&#8203;x^5</code>."}, {"owner": {"reputation": 3292, "user_id": 2709093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042262218/picture?type=large", "display_name": "James K", "link": "https://stackoverflow.com/users/2709093/james-k"}, "edited": false, "score": 0, "creation_date": 1513806815, "post_id": 47908170, "comment_id": 82797774, "body": "@sparky Have you seen this forum post on a <a href=\"http://forum.devmaster.net/t/fast-and-accurate-sine-cosine/9648\" rel=\"nofollow noreferrer\">fast and accurate sine</a> It uses the same parabola that you suggest as a rough approximation, and the weighted average of that parabola and its square for extra precision. You could add the &quot;square and average&quot; trick  to your answer."}, {"owner": {"reputation": 103366, "user_id": 903061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMWGQ.jpg?s=128&g=1", "display_name": "Gregor Thomas", "link": "https://stackoverflow.com/users/903061/gregor-thomas"}, "reply_to_user": {"reputation": 3292, "user_id": 2709093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042262218/picture?type=large", "display_name": "James K", "link": "https://stackoverflow.com/users/2709093/james-k"}, "edited": false, "score": 0, "creation_date": 1513807080, "post_id": 47908170, "comment_id": 82797879, "body": "@JamesK but what about it? Relative error is a poor metric for for a variable that fluctuates around 0. I think absolute error is fine."}, {"owner": {"reputation": 11749, "user_id": 251020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a89f6db9d42d492626a41bb76455b4c?s=128&d=identicon&r=PG", "display_name": "Sparky", "link": "https://stackoverflow.com/users/251020/sparky"}, "reply_to_user": {"reputation": 3292, "user_id": 2709093, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042262218/picture?type=large", "display_name": "James K", "link": "https://stackoverflow.com/users/2709093/james-k"}, "edited": false, "score": 0, "creation_date": 1513811692, "post_id": 47908170, "comment_id": 82799395, "body": "@JamesK - I got the parabola idea from a similar article (perhaps even that one) several years ago.  I recall that the original article mentioned some extra steps for better accuracy, but all that stuck with me over the years was the parabola idea."}], "tags": [], "owner": {"reputation": 11749, "user_id": 251020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a89f6db9d42d492626a41bb76455b4c?s=128&d=identicon&r=PG", "display_name": "Sparky", "link": "https://stackoverflow.com/users/251020/sparky"}, "is_accepted": false, "score": 6, "last_activity_date": 1513779909, "creation_date": 1513779909, "answer_id": 47908170, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47908170#47908170", "title": "Generate sine signal in C without using the standard function", "body": "<p>Have you considered modelling the portion of the sine curve from [0..PI] as a parabola?  If the brightness of the LED is only intended to be observed by a human eye, the shapes of the curves ought to be similar enough so that little difference would be detected.</p>\n\n<p>You would just need to figure out the appropriate equation to describe it.</p>\n\n<p>Hmmm, ...</p>\n\n<p>Vertex at (PI/2, 1)</p>\n\n<p>X-axis intersections at (0, 0) and (PI, 0)</p>\n\n<pre><code>f(x) = 1 - K * (x - PI/2) * (x - PI/2)\n</code></pre>\n\n<p>Where K would be ...</p>\n\n<pre><code>K = 4 / (PI * PI)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 7, "last_activity_date": 1513781799, "creation_date": 1513781799, "answer_id": 47908792, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47908792#47908792", "title": "Generate sine signal in C without using the standard function", "body": "<p>The classic hack to draw a circle (and hence generate a sine wave too) is <a href=\"http://w3.pppl.gov/~hammett/work/2009/AIM-239-ocr.pdf\" rel=\"noreferrer\">Hakmem #149 by Marvin Minsky</a>. E.g.,:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    float x = 1, y = 0;\n\n    const float e = .04;\n\n    for (int i = 0; i &lt; 100; ++i)\n    {\n        x -= e*y;\n        y += e*x;\n        printf(\"%g\\n\", y);\n    }\n}\n</code></pre>\n\n<p>It will be slightly eccentric, not a perfect circle, and you may get some values slightly over 1, but you could adjust by dividing by the maximum or rounding. Also, integer arithmetic can be used, and you can eliminate multiplication/division by using a negative power of two for <code>e</code>, so shift can be used instead.</p>\n"}, {"tags": [], "owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "is_accepted": false, "score": 6, "last_activity_date": 1513786807, "last_edit_date": 1513786807, "creation_date": 1513786109, "answer_id": 47910168, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47910168#47910168", "title": "Generate sine signal in C without using the standard function", "body": "<p>For a LED, you could probably just do with 16 or so steps without even interpolating. That said, I can see at least two odd things in your <code>sin1()</code> function:</p>\n\n<p>1) You have 40 data points in <code>sine_table</code>, but you're taking the index <code>x1</code> modulo 41 of the input. That doesn't seem the right way to handle the periodicity, and lets <code>x1</code> point past the last index of the array.<br>\n2) You're then adding +1, so <code>x2</code> can be even more over the limits of the array.<br>\n3) You're using <code>i</code> in the function, but it's only set in the main program. I can't tell what it's supposed to do, but using a global like that in a simple calculation function seems dirty at minimum. Maybe it's supposed to provide the fractional part for the interpolation, but shouldn't you use <code>phase</code> for that.</p>\n\n<p>Here's a simple interpolator, which seems to work. Adjust to taste.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n\nint A[4] = {100, 200, 400, 800};    \nint interpolate(float x)\n{\n    if (x == 3.00) {\n        return A[3];\n    }\n    if (x &gt; 3) {\n        return interpolate(6 - x);\n    }\n    assert(x &gt;= 0 &amp;&amp; x &lt; 3);\n    int i = x;\n    float frac = x - i;\n    return A[i] + frac * (A[i+1] - A[i]);\n}\n</code></pre>\n\n<p>Some arbitrary sample outputs:</p>\n\n<pre><code>interpolate(0.000000) = 100\ninterpolate(0.250000) = 125\ninterpolate(0.500000) = 150\ninterpolate(1.000000) = 200\ninterpolate(1.500000) = 300\ninterpolate(2.250000) = 500\ninterpolate(2.999900) = 799\ninterpolate(3.000000) = 800\ninterpolate(3.750000) = 500\n</code></pre>\n\n<p><sub>(I'll leave it to the interested reader to replace all occurrences of <code>3</code> with a properly defined symbolic constant, to generalize the function further, and to implement calculating the negative phase too.)</sub></p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 15, "last_activity_date": 1513843818, "last_edit_date": 1513843818, "creation_date": 1513796506, "answer_id": 47912749, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47912749#47912749", "title": "Generate sine signal in C without using the standard function", "body": "<p>Generating an accurate sine function requires an amount of resource (CPU cycles and memory) that is unwarranted in this application.  Your aim to generate a \"smooth\" sine curve is failing to consider the requirements of the application.</p>\n\n<ul>\n<li><p>While when you draw the curve you may observe imperfections, when you\napply that curve to an LED PWM drive, the human eye will not perceive\nthose imperfections at all. </p></li>\n<li><p>Neither is the human eye likely to perceive the difference in brightness between adjacent values in even a 40-step curve, so interpolation is not necessary.</p></li>\n<li><p>It will be more efficient in general if you generate a sine function that generates the appropriate PWM drive values directly without floating point.  In fact rather than a sine function a <em>scaled raised cosine</em> would be more appropriate, so that an input of zero results in an output of zero, and an input of half the number of values in the cycle results in the maximum value for your PWM drive.</p></li>\n</ul>\n\n<p>The following function generates a raised cosine curve for an 8-bit FSD PWM from a 16 value (and 16 bytes) lookup generating a 59-step cycle.  So it is both memory and performance efficient compared to your 40 step floating point implementation.</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\n#define LOOKUP_SIZE 16\n#define PWM_THETA_MAX (LOOKUP_SIZE * 4 - 4)\n\nuint8_t RaisedCosine8bit( unsigned n )\n{\n    static const uint8_t lookup[LOOKUP_SIZE] = { 0, 1, 5, 9,\n                                                 14, 21, 28, 36,\n                                                 46, 56, 67, 78,\n                                                 90, 102, 114, 127} ;\n    uint8_t s = 0 ;\n    n = n % PWM_THETA_MAX ;\n\n    if( n &lt; LOOKUP_SIZE )\n    {\n        s = lookup[n] ;\n    }\n    else if( n &lt; LOOKUP_SIZE * 2 - 1 )\n    {\n        s = 255 - lookup[LOOKUP_SIZE * 2 - n - 2] ;\n    }\n    else if( n &lt; LOOKUP_SIZE * 3 - 2 )\n    {\n        s = 255 - lookup[n - LOOKUP_SIZE * 2 + 2] ;\n    }\n    else\n    {\n        s = lookup[LOOKUP_SIZE * 4 - n - 4] ;\n    }\n\n    return s ;\n}\n</code></pre>\n\n<p>For an input of <code>0 &lt;= theta &lt; PWM_THETA_MAX</code> the curve looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jjEax.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jjEax.png\" alt=\"enter image description here\"></a></p>\n\n<p>Which is I suggest plenty smooth enough for illumination.</p>\n\n<p>In practice you might use it thus:</p>\n\n<pre><code>for(;;)\n{\n    for( unsigned i = 0; i &lt; PWM_THETA_MAX; i++ )\n    {\n        LedPwmDrive( RaisedCosine8bit( i ) ) ;\n        Delay( LED_UPDATE_DLEAY ) ;\n    }\n}\n</code></pre>\n\n<p>If your PWM range is not 0 to 255, simply scale the output of the function; 8-bit resolution is more than enough for the task.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "is_accepted": false, "score": 6, "last_activity_date": 1513804382, "last_edit_date": 1513804382, "creation_date": 1513802255, "answer_id": 47914025, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47914025#47914025", "title": "Generate sine signal in C without using the standard function", "body": "<p>I would go with Bhaskara I's approximation of a sine function.  Using degrees, from 0 to 180, you can approximate the value like so</p>\n\n<pre><code>float Sine0to180(float phase)\n{\n    return (4.0f * phase) * (180.0f - phase) / (40500.0f - phase * (180.0f - phase));\n}\n</code></pre>\n\n<p>if you want to account for any angle, you'd add</p>\n\n<pre><code>float sine(float phase)\n{\n    float FactorFor180to360 = -1 * (((int) phase / 180) % 2 );\n    float AbsoluteSineValue = Sine0to180(phase - (float)(180 * (int)(phase/180)));\n    return AbsoluteSineValue * FactorFor180to360;\n}\n</code></pre>\n\n<p>If you want to do it in radians, you'd add</p>\n\n<pre><code>float SineRads(float phase)\n{\n    return Sine(phase * 180.0f / 3.1416);\n}\n</code></pre>\n\n<p>Here is a graph showing the points calculated with this approximation and also points calculated with the sine function. You can barely see the approximation points peeking out from under the actual sine points.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rX3tb.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/rX3tb.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1513842577, "post_id": 47916669, "comment_id": 82807971, "body": "More comment than an answer."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 3, "creation_date": 1513898249, "post_id": 47916669, "comment_id": 82837257, "body": "Remarkable work.  Unnecessarily precise and compute intensive for the stated &quot;LED throb&quot; task perhaps, but nonetheless precisely what was asked for."}, {"owner": {"reputation": 176, "user_id": 3470860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6fb4dcc5d2ee47183df09bdc4ba72e?s=128&d=identicon&r=PG&f=1", "display_name": "bill", "link": "https://stackoverflow.com/users/3470860/bill"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1514503322, "post_id": 47916669, "comment_id": 83000438, "body": "Clifford -- I agree entirely."}, {"owner": {"reputation": 176, "user_id": 3470860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6fb4dcc5d2ee47183df09bdc4ba72e?s=128&d=identicon&r=PG&f=1", "display_name": "bill", "link": "https://stackoverflow.com/users/3470860/bill"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1530123777, "post_id": 47916669, "comment_id": 89128241, "body": "There&#39;s a way to cheat using just math and no table, but the implementation is a bit vague in my memory.  It involves the identity function:  sin(a+b) = sin(a)cos(b) + cos(a)sin(b).    I&#39;m sure this can be implemented with integer math, but you have to be careful to correct for drift in the math as you cycle through the sines.  Also, you may need to derive the cosine as well, since you&#39;re going to be using it to calculate the sine."}], "tags": [], "owner": {"reputation": 176, "user_id": 3470860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6fb4dcc5d2ee47183df09bdc4ba72e?s=128&d=identicon&r=PG&f=1", "display_name": "bill", "link": "https://stackoverflow.com/users/3470860/bill"}, "is_accepted": false, "score": 6, "last_activity_date": 1513896273, "last_edit_date": 1513896273, "creation_date": 1513819847, "answer_id": 47916669, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47916669#47916669", "title": "Generate sine signal in C without using the standard function", "body": "<p>Unless your application calls for real precision, don't kill yourself coming up with an algorithm for a 40 point sine or cosine wave.  Also, the values in your table should match the range of your LED's pwm input.  </p>\n\n<p>That said, I took a look at your code and it's output and figured you weren't interpolating between points.  With a little modification, I fixed it, and the error between a excel's sign function and yours is off by a max of about 0.0032 or thereabouts.  The change is pretty easy to implement and has been tested using tcc, my personal go-to for C algorithm testing.</p>\n\n<p>First off, I added one more point to your sine array.  The last point is set to the same value as the first element in the sine array.  This fixes the math in your sine function, in particular when you set x1 to (int)phase%40, and x2 to x1+1.  Adding the extra point isn't necessary, as you could set x2 to (x1+1)%40, but I chose the first approach.  I'm just pointing out different ways you could accomplish this.  I also added the calculation of a remainder (Basically phase - (int)phase).  I'm using the remainder for the interpolation.  I also added a temporary sine value holder and a delta variable.</p>\n\n<pre><code>const int sine_table[41] = \n{0, 5125, 10125, 14876, 19260, 23170, 26509, 29196,\n31163, 32364, 32767,  32364, 31163, 29196, 26509, 23170, \n19260, 14876, 10125, 5125, 0, -5126, -10126,-14877,\n-19261, -23171, -26510, -29197, -31164, -32365, -32768, -32365,\n-31164, -29197, -26510, -23171, -19261, -14877, -10126, -5126, 0};\n\nint i = 0;\nint x1 = 0;\nint x2 = 0;\nfloat y = 0;\n\nfloat sin1(float phase)\n{\n    int tsv,delta;\n    float rem;\n\n    rem = phase - (int)phase;\n    x1 = (int) phase % 40;\n    x2 = (x1 + 1);\n\n    tsv=sine_table[x1];\n    delta=sine_table[x2]-tsv;\n\n    y = tsv + (int)(rem*delta);\n    return y;\n}\n\nint main()\n{\n    int i;  \n    for(i=0;i&lt;420;i++)\n    {\n       printf(\"%.2f, %f\\n\",0.1*i,sin1(0.1*i)/32768);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The results look pretty good.  Comparing the linear approximation vs the system's floating point sine function gave me the error plot shown below.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/hyi6K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hyi6K.png\" alt=\"Error Plot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/PJYLh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PJYLh.png\" alt=\"Combined Error vs Sine graph\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 2791671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b67b58fd6bd0758d414441bd822828a9?s=128&d=identicon&r=PG", "display_name": "Teh JoE", "link": "https://stackoverflow.com/users/2791671/teh-joe"}, "is_accepted": false, "score": 2, "last_activity_date": 1513895051, "creation_date": 1513895051, "answer_id": 47933520, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47933520#47933520", "title": "Generate sine signal in C without using the standard function", "body": "<p>You could use the first few terms of the <a href=\"https://en.wikipedia.org/wiki/Taylor_series#Trigonometric_functions\" rel=\"nofollow noreferrer\">Taylor series expansion</a> of <code>sin</code>. You can use as few terms as needed to reach your intended level of precision - a few more terms than the below example should start to bump up against the limits of a 32-bit float.</p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// Please use the built-in floor function if you can. \nfloat my_floor(float f) {\n    return (float) (int) f;\n}\n\n// Please use the built-in fmod function if you can.\nfloat my_fmod(float f, float n) {\n    return f - n * my_floor(f / n);\n}\n\n// t should be in given in radians.\nfloat sin_t(float t) {\n    const float PI = 3.14159265359f;\n\n    // First we clamp t to the interval [0, 2*pi) \n    // because this approximation loses precision for \n    // values of t not close to 0. We do this by \n    // taking fmod(t, 2*pi) because sin is a periodic\n    // function with period 2*pi.\n    t = my_fmod(t, 2.0f * PI);\n\n    // Next we clamp to [-pi, pi] to get our t as\n    // close to 0 as possible. We \"reflect\" any values \n    // greater than pi by subtracting them from pi. This \n    // works because sin is an odd function and so \n    // sin(-t) = -sin(t), and the particular shape of sin\n    // combined with the choice of pi as the endpoint\n    // takes care of the negative.\n    if (t &gt;= PI) {\n        t = PI - t;\n    }\n\n    // You can precompute these if you want, but\n    // the compiler will probably optimize them out.\n    // These are the reciprocals of odd factorials.\n    // (1/n! for odd n)\n    const float c0 = 1.0f;\n    const float c1 = c0 / (2.0f * 3.0f);\n    const float c2 = c1 / (4.0f * 5.0f);\n    const float c3 = c2 / (6.0f * 7.0f);\n    const float c4 = c3 / (8.0f * 9.0f);\n    const float c5 = c4 / (10.0f * 11.0f);\n    const float c6 = c5 / (12.0f * 13.0f);\n    const float c7 = c6 / (14.0f * 15.0f);\n    const float c8 = c7 / (16.0f * 17.0f);\n\n    // Increasing odd powers of t.\n    const float t3  = t * t * t;\n    const float t5  = t3 * t * t;\n    const float t7  = t5 * t * t;\n    const float t9  = t7 * t * t;\n    const float t11 = t9 * t * t;\n    const float t13 = t9 * t * t;\n    const float t15 = t9 * t * t;\n    const float t17 = t9 * t * t;\n\n    return c0 * t - c1 * t3 + c2 * t5 - c3 * t7 + c4 * t9 - c5 * t11 + c6 * t13 - c7 * t15 + c8 * t17;\n}\n\n// Test the output\nint main() {\n    const float PI = 3.14159265359f;\n    float t;\n\n    for (t = 0.0f; t &lt; 12.0f * PI; t += (PI * 0.25f)) {\n        printf(\"sin(%f) = %f\\n\", t, sin_t(t));\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Example output:</p>\n\n<pre><code>sin(0.000000) = 0.000000\nsin(0.785398) = 0.707107\nsin(1.570796) = 1.000000\nsin(2.356194) = 0.707098\nsin(3.141593) = 0.000000\nsin(3.926991) = -0.707107\nsin(4.712389) = -1.000000\nsin(5.497787) = -0.707098\nsin(6.283185) = 0.000398\n...\nsin(31.415936) = 0.000008\nsin(32.201332) = 0.707111\nsin(32.986729) = 1.000000\nsin(33.772125) = 0.707096\nsin(34.557522) = -0.000001\nsin(35.342918) = -0.707106\nsin(36.128315) = -1.000000\nsin(36.913712) = -0.707100\nsin(37.699108) = 0.000393\n</code></pre>\n\n<p>As you can see there is still some room for improvement in precision. I am not a genius with floating point arithmetic so probably some of it has to do with the <code>floor</code>/<code>fmod</code> implementations or the specific order the mathematical operations are performed in.</p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 8187801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e95e68b9e3743b5e07bee059d1dcc538?s=128&d=identicon&r=PG", "display_name": "alkaya", "link": "https://stackoverflow.com/users/8187801/alkaya"}, "is_accepted": false, "score": 2, "last_activity_date": 1513957534, "last_edit_date": 1513957534, "creation_date": 1513956175, "answer_id": 47943771, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47943771#47943771", "title": "Generate sine signal in C without using the standard function", "body": "<p>Since you try to generate a signal, i think use a differential equation should not be a bad idea ! it give something like that </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define DT (0.01f) //1/s\n#define W0 (3)     //rad/s\n\nint main(void) {\n    float a = 0.0f;\n    float b = DT * W0;\n    float tmp;\n\n    for (int i = 0; i &lt; 400; i++) {\n        tmp = (1 / (1 + (DT * DT * W0 * W0))) * (2 * a - b);\n        b = a;\n        a = tmp;\n\n        printf(\"%f\\n\", tmp);\n    }\n}\n</code></pre>\n\n<p>Still set the amplitude and frequency of the signal is a pain in the neck :/</p>\n"}, {"tags": [], "owner": {"reputation": 2261, "user_id": 8544123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f32b871be77d8c71efc294359b300367?s=128&d=identicon&r=PG&f=1", "display_name": "Acccumulation", "link": "https://stackoverflow.com/users/8544123/acccumulation"}, "is_accepted": false, "score": 1, "last_activity_date": 1513970835, "creation_date": 1513970835, "answer_id": 47946451, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function/47946451#47946451", "title": "Generate sine signal in C without using the standard function", "body": "<p>It would help if you explain why you don't want the built-in function, but as others have said, the Taylor series is one way to estimate the value. However, the other answers seem to actually be using the Maclaurin series, not Taylor. You should have a lookup table of both sine and cosine. Then find x<sub>0</sub>, the closest x value in your lookup table to the x you want, and find d = x-x<sub>0</sub>. Then</p>\n\n<p>sin(x) =sin(x<sub>0</sub>)+cos(x<sub>0</sub>)*d-sin(x<sub>0</sub>)*d<sup>2</sup>/2-cos(x<sub>0</sub>)*d<sup>3</sup>/6 + ...</p>\n\n<p>If your lookup table is such that d&lt;.01, then you'll be getting more than two digits of precision per term.</p>\n\n<p>Another method is to use the fact that if x = x<sub>0</sub>+d, then </p>\n\n<p>sin(x) = sin(x<sub>0</sub>)*cos(d)+cos(x<sub>0</sub>)*sin(d)</p>\n\n<p>You can use a lookup table to get sin(x<sub>0</sub>) and cos(x<sub>0</sub>), and then use Maclaurin series to get cos(d) and sin(d).</p>\n"}], "owner": {"reputation": 547, "user_id": 7816874, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2e8bf5f2776c69a174b07db86dcba337?s=128&d=identicon&r=PG&f=1", "display_name": "Peter123", "link": "https://stackoverflow.com/users/7816874/peter123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10106, "favorite_count": 8, "answer_count": 11, "score": 28, "last_activity_date": 1541098614, "creation_date": 1513773950, "last_edit_date": 1513775318, "question_id": 47906401, "link": "https://stackoverflow.com/questions/47906401/generate-sine-signal-in-c-without-using-the-standard-function", "title": "Generate sine signal in C without using the standard function", "body": "<p>I want to generate a sine signal in C without using the standard function sin() in order to trigger sine shaped changes in the brightness of a LED. My basic idea was to use a lookup table with 40 points and interpolation.</p>\n\n<p>Here's my first approach:</p>\n\n<pre><code>const int sine_table[40] = {0, 5125, 10125, 14876, 19260, 23170, 26509, 29196,\n31163, 32364, 32767,  32364, 31163, 29196, 26509, 23170, 19260, 14876, 10125,\n5125, 0, -5126, -10126,-14877, -19261, -23171, -26510, -29197, -31164, -32365,\n-32768, -32365, -31164, -29197, -26510, -23171, -19261, -14877, -10126, -5126};\n\nint i = 0;\nint x1 = 0;\nint x2 = 0;\nfloat y = 0;\n\nfloat sin1(float phase)\n{\n    x1 = (int) phase % 41;\n    x2 = x1 + 1;\n    y = (sine_table[x2] - sine_table[x1])*((float) ((int) (40*0.001*i*100) % 4100)/100 - x1) + sine_table[x1];\n    return y;\n}\n\nint main()\n{\n    while(1)\n    {\n    printf(\"%f      \", sin1(40*0.001*i)/32768);\n    i = i + 1;\n    }\n}\n</code></pre>\n\n<p>Unfortunately, this function sometimes returns values far bigger than 1. Furthermore, the interpolation doesn't seem to be good (I used this to create sine shaped brightness changes of a LED, but these are very unsmoooth).</p>\n\n<p>Does anybody have a better idea to implement a sine generator in C?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1513772584, "post_id": 47905955, "comment_id": 82778670, "body": "This is an <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\"><i>operator precedence</i></a> problem. The array-index operator <code>[]</code> have higher precedence than the dereference operator <code>*</code>. Something a <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">good beginners book</a> should have told you (IMO)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1513772669, "post_id": 47905955, "comment_id": 82778732, "body": "Also &quot;pretty much the same thing&quot; is <i>not</i> &quot;<i>exactly</i> the same thing&quot;. In fact, the two expressions you think are &quot;pretty much the same thing&quot; are <i>not</i>. (See my previous comment for why)."}, {"owner": {"reputation": 65, "user_id": 6809829, "user_type": "registered", "profile_image": "https://graph.facebook.com/246832352360857/picture?type=large", "display_name": "Abdessalem Boukil", "link": "https://stackoverflow.com/users/6809829/abdessalem-boukil"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1513772941, "post_id": 47905955, "comment_id": 82778909, "body": "So to fix this can I do <code>(*test)[i]</code> ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513773233, "post_id": 47905955, "comment_id": 82779112, "body": "Yes that will do it."}, {"owner": {"reputation": 65, "user_id": 6809829, "user_type": "registered", "profile_image": "https://graph.facebook.com/246832352360857/picture?type=large", "display_name": "Abdessalem Boukil", "link": "https://stackoverflow.com/users/6809829/abdessalem-boukil"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513773555, "post_id": 47905955, "comment_id": 82779331, "body": "Thanks for the help :)"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513774251, "post_id": 47905955, "comment_id": 82779772, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3552844/order-of-operations-for-dereference-and-bracket-ref-in-c\">Order of operations for dereference and bracket-ref in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": true, "score": 4, "last_activity_date": 1513783096, "last_edit_date": 1513783096, "creation_date": 1513773180, "answer_id": 47906175, "question_id": 47905955, "link": "https://stackoverflow.com/questions/47905955/c-printing-same-array-produces-different-results-using-two-methods/47906175#47906175", "title": "C Printing same array produces different results using two methods", "body": "<p><code>test</code> is a <code>char**</code>. As <em>Some programmer dude</em> commented, the <code>[]</code> takes precedence over the <code>*</code> so your for loop is executed like this:</p>\n\n<ol>\n<li><code>*test[0] == *(test[0]) == 'a'</code></li>\n<li><code>*test[1]</code> == <code>*(test[1])</code> == *(<em>some other address that is saved in memory after <code>&amp;test</code></em>) => UB</li>\n</ol>\n\n<p>Either use one indirection in the whole program (i.e. *, not ** and <code>&amp;test</code>), or use <code>(*test)[i]</code></p>\n"}], "owner": {"reputation": 65, "user_id": 6809829, "user_type": "registered", "profile_image": "https://graph.facebook.com/246832352360857/picture?type=large", "display_name": "Abdessalem Boukil", "link": "https://stackoverflow.com/users/6809829/abdessalem-boukil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 47906175, "answer_count": 1, "score": 2, "last_activity_date": 1513783096, "creation_date": 1513772427, "question_id": 47905955, "link": "https://stackoverflow.com/questions/47905955/c-printing-same-array-produces-different-results-using-two-methods", "title": "C Printing same array produces different results using two methods", "body": "<p>I'm experimenting with C void functions and strings. I've tried this program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid print(char** test);\nint main(){\n    char* test = \"abcdef\";\n    print(&amp;test);\n    return 0;\n}\nvoid print(char** test){\n    for(int i=0;i&lt;strlen(*test);i++)\n        printf(\"%c\\n\",*test[i]);\n}\n</code></pre>\n\n<p>It prints for me the first <code>a A \ufffd</code> then segmentation fault. But after changing <code>*test[i]</code> to <code>*(*test+i)</code> which is pretty much the same thing it works for me as expected.</p>\n\n<p>Is there any subtle difference <code>*test[i]</code> and <code>*(*test+i)</code> if not, why my code works in second examples meanwhile it doesn't in the first ?</p>\n"}, {"tags": ["c", "arrays", "char", "int", "signed"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1513771534, "post_id": 47905608, "comment_id": 82778003, "body": "<code>sizeof(int) &#47; sizeof(char)</code>? <code>sizeof (char)</code> is always 1...."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513771745, "post_id": 47905608, "comment_id": 82778141, "body": "Rather than <code>unsigned long int iter = sizeof(int) &#47; sizeof(char);</code>, I&#39;d expect <code>unsigned long int iter = sizeof iter;</code> or perhaps <code>unsigned long int iter = sizeof iter&#47;sizeof *cp;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "is_accepted": true, "score": 1, "last_activity_date": 1513772127, "last_edit_date": 1513772127, "creation_date": 1513771757, "answer_id": 47905768, "question_id": 47905608, "link": "https://stackoverflow.com/questions/47905608/changing-value-of-an-int-array-with-a-signed-char-pointer/47905768#47905768", "title": "Changing value of an int array with a signed char pointer", "body": "<p>The problem is that you're not <a href=\"https://en.wikipedia.org/wiki/Sign_extension\" rel=\"nofollow noreferrer\"><em>sign extending</em></a> the value.</p>\n\n<pre><code>int x = 0;\n*((signed char *)&amp;x) = (signed char)-1;\n\nprintf(\"%08x\\n\", -1);       // FFFFFFFF\nprintf(\"%08x\\n\", 255);      // 000000FF\nprintf(\"%08x\\n\", x);        // 000000FF\n</code></pre>\n\n<p><sup><a href=\"https://ideone.com/ZMmgkE\" rel=\"nofollow noreferrer\">Live demo.</a></sup></p>\n\n<p>In other words, setting the value of an <code>int</code> to <code>-1</code> requires modifying <em>all</em> of its bytes.</p>\n\n<p>But note that to do so you'd be relying on two implementation-defined behaviours, making this code non-portable:</p>\n\n<ul>\n<li>The platform <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\"><em>endianness</em></a>.</li>\n<li>The <a href=\"https://en.wikipedia.org/wiki/Signed_number_representations\" rel=\"nofollow noreferrer\">representation of negative values</a>.</li>\n</ul>\n"}], "owner": {"reputation": 128, "user_id": 7605157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7wDkt1F-PyI/AAAAAAAAAAI/AAAAAAAAAGA/t-yrF1iyzz8/photo.jpg?sz=128", "display_name": "Bruno Mondelo", "link": "https://stackoverflow.com/users/7605157/bruno-mondelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 47905768, "answer_count": 1, "score": 0, "last_activity_date": 1513772127, "creation_date": 1513771253, "question_id": 47905608, "link": "https://stackoverflow.com/questions/47905608/changing-value-of-an-int-array-with-a-signed-char-pointer", "title": "Changing value of an int array with a signed char pointer", "body": "<p>I want to create a function to change the value of a void array index to the specified value.</p>\n\n<p>I'm testing with a simple function that changes the value of the certain index using a <strong>char copy</strong> from the array (char is 1 byte). I use char because I can add one to the <strong>copy</strong> to point to the next index and alter the value.</p>\n\n<p>The function is:</p>\n\n<pre><code>void\nchange_value(int ** ptrs, int pos, int val) {\n  char * cp = *ptrs;\n  /* Assign a copy of the array */\n  unsigned long int iter = sizeof(int) / sizeof(char);\n  /* Store the size for every index of the array */\n\n  for (int i = 0; i &lt; pos; i++)\n    for (unsigned long int e = 0; e &lt; iter; e++)\n      cp++;\n  /* Advance to the position */\n\n  *cp = (signed char)val;\n  /* Assign the value */\n}\n</code></pre>\n\n<p>The problem comes when I try to change the value to a <em>-1</em>. I think the problem is because when assigning <em>char</em> to <em>int</em> the -1 is converted to a 255, so I added to the assignment the conversion to a <strong>signed char</strong>. But still with no results.</p>\n\n<p>The main function is:</p>\n\n<pre><code>  arr[0] = 1;\n  arr[1] = 2;\n  arr[2] = 3;\n  arr[3] = 4;\n  arr[4] = 5;\n  /* Create an array for values */\n\n  change_value(&amp;arr, 1, 0);\n  /* Change value */\n  for (int i = 0; i &lt; 5; i++)\n    printf(\"arr[%d] : %d\\n\", i, arr[i]);\n  /* Show the array */\n\n  printf(\"\\n\");\n\n  change_value(&amp;arr, 2, -1);\n  /* Change value */\n  for (int i = 0; i &lt; 5; i++)\n    printf(\"arr[%d] : %d\\n\", i, arr[i]);\n  /* Show the array */\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>arr[0] : 1\narr[1] : 0\narr[2] : 3\narr[3] : 4\narr[4] : 5\n\narr[0] : 1\narr[1] : 0\narr[2] : 255\narr[3] : 4\narr[4] : 5\n</code></pre>\n"}, {"tags": ["c", "linux", "segmentation-fault", "shared-memory"], "comments": [{"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "edited": false, "score": 0, "creation_date": 1513772783, "post_id": 47905554, "comment_id": 82778803, "body": "@Jean-Fran&#231;ois Fabre I&#39;m not going to close or unlink shared memory. I just need to detach from it. Do I really necessary to make NULL to  memory-&gt;array after munmap?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1513772810, "post_id": 47905554, "comment_id": 82778819, "body": "forget it, just saying."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513779304, "post_id": 47905554, "comment_id": 82783126, "body": "there&#39;s way too much code to wade through - you should create a more succinct <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> if you want an answer"}, {"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513795149, "post_id": 47905554, "comment_id": 82792470, "body": "@Chris Turner I&#39;ve minimised my code to one source .c file and Makefile to makes it build."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1513795207, "post_id": 47905554, "comment_id": 82792496, "body": "Try running both the statically- and dynamically-linked executables <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">under <code>strace</code></a> and see what the difference is."}, {"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1513796095, "post_id": 47905554, "comment_id": 82792896, "body": "@AndrewHenle  Unfortunately strace has not showed any important information. I&#39;ve added strace output to my basic issue"}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "edited": false, "score": 0, "creation_date": 1513847241, "post_id": 47914897, "comment_id": 82810342, "body": "Excellent solution! Now It really works without Segmentation fault. Thank you very much."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 4, "last_activity_date": 1513806897, "creation_date": 1513806897, "answer_id": 47914897, "question_id": 47905554, "link": "https://stackoverflow.com/questions/47905554/segmentation-fault-appears-when-i-use-shared-memory-only-from-statically-build-p/47914897#47914897", "title": "Segmentation fault appears when I use shared memory only from statically build program", "body": "<p>You've uncovered a bug in how the static <code>librt.a</code> and <code>libpthread.a</code> interact. (<code>librt.a:shm_open()</code> calls it, and it is defined in <code>libpthread.a</code>. Their dynamic versions link it just fine.)</p>\n\n<p>Specifically, <code>libpthread.a</code> does implement <code>const char *__shm_directory(size_t *len);</code>, but for whatever reason, it gets mislinked somehow, causing a segfault. I suspect some kind of weak symbol shadowing, but haven't investigated it much further.</p>\n\n<p>The fix is to implement the function yourself. It is a simple function, that returns the path to the directory, including a final slash, where the shared memory files are to be created in. On Linux systems, this should always be a <code>tmpfs</code> mount at <code>/dev/shm/</code>.</p>\n\n<p>I would suggest creating a new C source file, maybe <strong>shm_open_fix.c</strong>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/* This avoids a segfault when code using shm_open()\n   is compiled statically. (For some reason, compiling\n   the code statically causes the __shm_directory()\n   function calls in librt.a to not reach the implementation\n   in libpthread.a. Implementing the function ourselves\n   fixes this issue.)\n*/\n\n#ifndef  SHM_MOUNT\n#define  SHM_MOUNT \"/dev/shm/\"\n#endif\nstatic const char  shm_mount[] = SHM_MOUNT;\n\nconst char *__shm_directory(size_t *len)\n{\n    if (len)\n        *len = strlen(shm_mount);\n    return shm_mount;\n}\n</code></pre>\n\n<p>and compile and link it into your final binary. This should take care of the segfault. Also, the resulting binary no longer depends on <code>libpthread.a</code> at all, unless you use the pthread functions elsewhere in your code.</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 3797867, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2VOqu.jpg?s=128&g=1", "display_name": "I. Martin", "link": "https://stackoverflow.com/users/3797867/i-martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1523876181, "last_edit_date": 1523876181, "creation_date": 1523548763, "answer_id": 49801104, "question_id": 47905554, "link": "https://stackoverflow.com/questions/47905554/segmentation-fault-appears-when-i-use-shared-memory-only-from-statically-build-p/49801104#49801104", "title": "Segmentation fault appears when I use shared memory only from statically build program", "body": "<p>I have the same problem with Ubuntu 16.04 and GCC 5.4</p>\n\n<p>I statically link an executable and segfaults at the same exact point, inside __shm_directory.</p>\n\n<p>I've looked into it, and it seems that the function __pthread_once, defined as a weak symbol, is missing from the linked executable. Thus, a call to address 0x0 is made.</p>\n\n<p>A colleage has compiled it with Ubuntu 14.04, with GCC 4.8.4 and it works well.</p>\n\n<p>This looks certainly like a bug in either GCC or Glibc</p>\n\n<p>EDIT:</p>\n\n<p>Adding <code>-Wl,--whole-archive -lpthread -Wl,--no-whole-archive</code> to the compiler comand line does the trick. It forces the linker to include all the symbols from libpthread. Otherwise, the linker leaves the weak reference, which is the expected behaviour for dynamic linking (where symbols are resolved at runtime), but its invalid for static libraries. In any case, despite the workaround, I still consider this behaviour a bug.</p>\n"}], "owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "accepted_answer_id": 47914897, "answer_count": 2, "score": 3, "last_activity_date": 1523876181, "creation_date": 1513771074, "last_edit_date": 1513796440, "question_id": 47905554, "link": "https://stackoverflow.com/questions/47905554/segmentation-fault-appears-when-i-use-shared-memory-only-from-statically-build-p", "title": "Segmentation fault appears when I use shared memory only from statically build program", "body": "<p>When I built a program with --static option and it calls shm_open() function I get Segmentation fault. Without -static option all works like a charm.</p>\n\n<p>Does anybody know why?</p>\n\n<p>Below I have cited a debug info and a part of truncated source code from a big project.</p>\n\n<p>You can comment/uncomment</p>\n\n<pre><code>#STATIC = -static\n</code></pre>\n\n<p>string from Makefile to reproduce the bug.</p>\n\n<p>$ gdb --args ./debug/example sample017</p>\n\n<pre><code>GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1\nReading symbols from ./debug/example...done.\n(gdb) run\nStarting program: ./example sample017\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000000000 in ?? ()\n(gdb) backtrace\n#0  0x0000000000000000 in ?? ()\n#1  0x000000000049a2e3 in __shm_directory (len=0x7fffffffdca8) at ../sysdeps/unix/sysv/linux/shm-directory.c:124\n#2  0x0000000000499ff3 in shm_open ()\n#3  0x0000000000499d55 in read_shm (memory=0x6d1be0, share_name=0x6d1d20 \"sample017\") at main.c:51\n#4  0x0000000000499efe in read_memory (memory=0x6d1be0, argc=0x7fffffffde0c, argv=0x7fffffffdf68) at main.c:98\n#5  0x0000000000499f70 in main (argc=2, argv=0x7fffffffdf68) at main.c:112\n</code></pre>\n\n<h1>Strace for statically linked</h1>\n\n<p>$strace ./debug/example sample017</p>\n\n<pre><code>execve(\"./debug/example\", [\"./debug/example\", \"sample017\"], [/* 64 vars */]) = 0\nuname({sysname=\"Linux\", nodename=\"Lubuntu\", ...}) = 0\nbrk(NULL)                               = 0xc5e000\nbrk(0xc5f1c0)                           = 0xc5f1c0\narch_prctl(ARCH_SET_FS, 0xc5e880)       = 0\nreadlink(\"/proc/self/exe\", \"/home/52034/111/debug/example\", 4096) = 29\nbrk(0xc801c0)                           = 0xc801c0\nbrk(0xc81000)                           = 0xc81000\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\n--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0} ---\n+++ killed by SIGSEGV +++\nSegmentation fault\n</code></pre>\n\n<h1>Strace for dynamically linked:</h1>\n\n<p>$ strace ./debug/example sample017</p>\n\n<pre><code>execve(\"./debug/example\", [\"./debug/example\", \"sample017\"], [/* 64 vars */]) = 0\nbrk(NULL)                               = 0x740000\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nmmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f78fa50e000\naccess(\"/etc/ld.so.preload\", R_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=135773, ...}) = 0\nmmap(NULL, 135773, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f78fa4ec000\nclose(3)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/libc.so.6\", O_RDONLY|O_CLOEXEC) = 3\nread(3, \"\\177ELF\\2\\1\\1\\3\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0P\\t\\2\\0\\0\\0\\0\\0\"..., 832) = 832\nfstat(3, {st_mode=S_IFREG|0755, st_size=1868984, ...}) = 0\nmmap(NULL, 3971488, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f78f9f21000\nmprotect(0x7f78fa0e1000, 2097152, PROT_NONE) = 0\nmmap(0x7f78fa2e1000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1c0000) = 0x7f78fa2e1000\nmmap(0x7f78fa2e7000, 14752, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f78fa2e7000\nclose(3)                                = 0\naccess(\"/etc/ld.so.nohwcap\", F_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/lib/x86_64-linux-gnu/librt.so.1\", O_RDONLY|O_CLOEXEC) = 3\nread(3, \"\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\0!\\0\\0\\0\\0\\0\\0\"..., 832) = 832\nfstat(3, {st_mode=S_IFREG|0644, st_size=31712, ...}) = 0\nmmap(NULL, 2128832, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f78f9d19000\nmprotect(0x7f78f9d20000, 2093056, PROT_NONE) = 0\nmmap(0x7f78f9f1f000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) = 0x7f78f9f1f000\nclose(3)                                = 0\n... end etc...\n</code></pre>\n\n<p>Compiler:</p>\n\n<pre><code>$ gcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 5.4.0-6ubuntu1~16.04.5' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.5) \n</code></pre>\n\n<p>Linux:</p>\n\n<pre><code>$ cat /etc/issue\nUbuntu 16.04.3 LTS \\n \\l\n</code></pre>\n\n<p>$cat main.c</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n\n// String library\n#include &lt;string.h&gt;\n\n// Shared memory\n#include &lt;sys/mman.h&gt;\n#include &lt;sys/stat.h&gt; /* For mode constants */\n#include &lt;fcntl.h&gt;    /* For O_* constants */\n\ntypedef struct {\n    size_t length;\n\n    int fd;\n\n    float *array;\n\n    #define MAX_NAME_LENGTH 255\n    char name[MAX_NAME_LENGTH];\n\n} Memory;\n\nstatic Memory *new_memory(void)\n{\n    Memory *structure = (Memory*)malloc(sizeof(Memory));\n    if(structure == NULL){\n        exit(EXIT_FAILURE);\n    }\n    memset(structure, 0, sizeof(Memory));\n\n    return structure;\n}\n\nstatic void detach_memory(Memory *memory)\n{\n    munmap(memory-&gt;array,(memory-&gt;length)*sizeof(float));\n    free(memory);\n}\n\nstatic bool read_shm(\n    Memory *memory,\n    char *share_name\n)\n{\n    if ((memory-&gt;fd = shm_open(share_name, O_RDONLY|O_EXCL, 0400)) == -1){\n        return(false);\n    }\n\n    memcpy(memory-&gt;name,share_name,strlen(share_name)+1);\n\n    struct stat info;\n\n    if (fstat(memory-&gt;fd, &amp;info) == -1 || errno == EBADF){\n        return(false);\n    }\n\n    memory-&gt;length = (size_t)info.st_size / sizeof(float);\n\n    float *array = mmap(0, (size_t)info.st_size, PROT_READ, MAP_SHARED,memory-&gt;fd, 0);\n    if (array == (float*)-1){\n        exit(EXIT_FAILURE);\n    }\n\n    if (memory-&gt;length &lt; 2){\n        exit(EXIT_FAILURE);\n    }\n\n    memory-&gt;array = array;\n\n    return(true);\n}\n\nvoid read_memory(\n    Memory *memory,\n    int *argc,\n    char **argv\n)\n{\n    if (*argc == 1){\n        exit(EXIT_FAILURE);\n    }\n\n    char *path = strdup(argv[1]);\n    const char * const file = basename(path);\n\n    char *share_name = strdup(file);\n    char *ext = strchr(share_name, '.');\n    if(ext){\n        *ext = '\\0';\n    }\n\n    if(!(read_shm(memory,share_name))){\n        free(path);\n        free(share_name);\n        exit(EXIT_FAILURE);\n    }\n\n    free(path);\n    free(share_name);\n}\n\nint main(int argc, char **argv)\n{\n    Memory *memory = new_memory();\n\n    read_memory(memory,&amp;argc,argv);\n\n    for(size_t i = 0; i &lt; memory-&gt;length;i++){\n        printf(\"memory: %.5f\\n\",memory-&gt;array[i]);\n    }\n\n    detach_memory(memory);\n\n    return(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>$cat Makefile </p>\n\n<pre><code>CC ?= cc\n\nCFLAGS += -pipe -std=c11\nCFLAGS += -fbuiltin\nLDFLAGS += -lm -lrt -lpthread\nEXE = example\nARGUMENTS ?=\n#STATIC = -static\nSTRIP = -s\nWFLAGS += -Wall -Wextra -Wpedantic -Wshadow\nWFLAGS += -Wconversion -Wsign-conversion -Winit-self -Wunreachable-code -Wformat-y2k\nWFLAGS += -Wformat-nonliteral -Wformat-security -Wmissing-include-dirs\nWFLAGS += -Wswitch-default -Wtrigraphs -Wstrict-overflow=5\nWFLAGS += -Wfloat-equal -Wundef -Wshadow\nWFLAGS += -Wbad-function-cast -Wcast-qual -Wcast-align\nWFLAGS += -Wwrite-strings\nWFLAGS += -Winline\nifneq ($(CC), clang)\nWFLAGS += -Wlogical-op\nCFLAGS += -finline-functions\nCFLAGS += -flto\nendif\n\nMAKEFLAGS += --no-print-directory\nCONFIG += ordered\n\n#\n# Project files\n#\nSRCS = $(wildcard *.c)\n# Exclude a file\nOBJS = $(SRCS:.c=.o)\n\n#\n# Debug build settings\n#\nDBGDIR = debug\nDBGEXE = $(DBGDIR)/$(EXE)\nDBGOBJS = $(addprefix $(DBGDIR)/, $(OBJS))\nDBGLIBPATH = ../../logger/lib/release\nDBGCFLAGS += -g -ggdb -ggdb1 -ggdb2 -ggdb3 -O0 -DDEBUG\nDBGLDFLAGS += -lm -lc\n\n.PHONY: all clean debug prep release remake clang openmp one liblogger\n\n# Default build\nall: debug\n\n#\n# Debug rules\n#\ndebug: liblogger $(DBGEXE)\n\n$(DBGEXE): $(DBGOBJS)\n    $(CC) $(CFLAGS) $(DBGCFLAGS) -L$(DBGLIBPATH) $(WFLAGS) $(STATIC) $(DBGLDFLAGS) -o $(DBGEXE) $^ $(LDFLAGS)\n    @echo \"$(DBGEXE) linked.\"\n\n-include $(DBGDEP)\n\n$(DBGDIR)/%.o: %.c\n    @mkdir -p $(DBGDIR)\n    @$(CC) -MM $(CFLAGS) $(DBGCFLAGS) $(WFLAGS) $&lt; | sed '1s/^/$$\\(DBGDIR\\)\\//' &gt; $(@D)/$(*F).d\n    $(CC) -c $(CFLAGS) $(DBGCFLAGS) $(WFLAGS) -o $@ $&lt;\n    @echo $&lt;\" compiled.\"\n\nclean:\n    @rm -rf *.out.* doc $(DBGDEP) $(DBGEXE) $(DBGOBJS) $(DBGDIR)/*.d\n    @test -d $(DBGDIR) &amp;&amp; rm -d $(DBGDIR) || true\n</code></pre>\n\n<p>By the way, is is works well on the older platform:</p>\n\n<p>Linux:</p>\n\n<pre><code>$cat /etc/issue\nUbuntu 13.10 \\n \\l\n</code></pre>\n\n<p>Compiler:</p>\n\n<pre><code>$gcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.8.1-10ubuntu9' --with-bugurl=file:///usr/share/doc/gcc-4.8/README.Bugs --enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.8 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.8 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.8-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 4.8.1 (Ubuntu/Linaro 4.8.1-10ubuntu9) \n</code></pre>\n"}, {"tags": ["c", "wdm", "filter-driver"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513777141, "post_id": 47904980, "comment_id": 82781703, "body": "What driver? What language? Is this actually a programming question?"}, {"owner": {"reputation": 3, "user_id": 6032886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3fcb2a8bd5142526f7369d31164be8?s=128&d=identicon&r=PG&f=1", "display_name": "smm123", "link": "https://stackoverflow.com/users/6032886/smm123"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513777567, "post_id": 47904980, "comment_id": 82781985, "body": "it&#39;s a filter driver (WDM driver) in C programming language and i use WDK in visual studio 2015"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513777902, "post_id": 47904980, "comment_id": 82782216, "body": "So <a href=\"https://stackoverflow.com/posts/47904980/edit\">edit</a> your post to add such relevant tags, and ideally show some of the code you&#39;re already using with an explanation of where you want to add the new code to retrieve the privilege info."}], "answers": [{"tags": [], "owner": {"reputation": 961, "user_id": 1340606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/77RGE.jpg?s=128&g=1", "display_name": "Gabriel Bercea", "link": "https://stackoverflow.com/users/1340606/gabriel-bercea"}, "is_accepted": true, "score": 0, "last_activity_date": 1517730712, "creation_date": 1517730712, "answer_id": 48605922, "question_id": 47904980, "link": "https://stackoverflow.com/questions/47904980/how-retrive-process-privilege-windows-drivers/48605922#48605922", "title": "How retrive Process Privilege (windows drivers)?", "body": "<p>This information is stored in the process token.<br>\nYou can get that using <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntifs/nf-ntifs-psreferenceprimarytoken\" rel=\"nofollow noreferrer\">PsReferencePrimaryToken</a>\nIf the process is impersonating you can use PsReferenceImpersonationToken instead.\nAfter that you simply query the token for the <em>TokenUser</em> using <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntifs/nf-ntifs-ntqueryinformationtoken\" rel=\"nofollow noreferrer\">ZwQueryInformationToken</a>.</p>\n\n<p>Good luck,<br>\nGabriel</p>\n"}], "owner": {"reputation": 3, "user_id": 6032886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3fcb2a8bd5142526f7369d31164be8?s=128&d=identicon&r=PG&f=1", "display_name": "smm123", "link": "https://stackoverflow.com/users/6032886/smm123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 48605922, "answer_count": 1, "score": 0, "last_activity_date": 1554373939, "creation_date": 1513769263, "last_edit_date": 1554373939, "question_id": 47904980, "link": "https://stackoverflow.com/questions/47904980/how-retrive-process-privilege-windows-drivers", "title": "How retrive Process Privilege (windows drivers)?", "body": "<p>I have  an object of IRP and EPROCESS in my driver \ni want to know how can i retrieve process privilege (like <strong>normal</strong> or <strong>Administrator</strong> or <strong>SYSTEM</strong>) from these structures ?</p>\n\n<pre><code> KPROCESSOR_MODE ProcessRequestorMode = pIrp-&gt;RequestorMode;\n        UNICODE_STRING PRM;\n        if (ProcessRequestorMode == KernelMode)\n            status = RtlInitUnicodeStringEx(&amp;PRM, L\"Kernel-Mode\");\n        else\n        {\n            status = RtlInitUnicodeStringEx(&amp;PRM, L\"User-Mode\");\n            //////////////////////////TODO////////////////////\n            //retrieving process previlage\n            //////////////////////////////////////////////////\n        }\n        DBGMSG1(\"Processor Mode : %wZ   \", PRM);\n        if (!NT_SUCCESS(status))\n        {\n            DBGMSG0(\"Can not convert RequestorMode to UNICODE_STRING\\n\");\n            ASSERT(FALSE);\n            return status;\n        }\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1513768305, "post_id": 47904671, "comment_id": 82776025, "body": "<a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Have a read</a>."}, {"owner": {"reputation": 343, "user_id": 3638319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AXmLy.jpg?s=128&g=1", "display_name": "NSKBpro", "link": "https://stackoverflow.com/users/3638319/nskbpro"}, "edited": false, "score": 0, "creation_date": 1513768551, "post_id": 47904671, "comment_id": 82776155, "body": "Did you declare arr as follows:  int **arr"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1513768563, "post_id": 47904671, "comment_id": 82776157, "body": "Yet another answer: <a href=\"https://stackoverflow.com/a/47593733/7478597\">SO: Variadic C function printing multiple 2-D char arrays</a>. Aside from dealing with var. args, it covers passing a 2D array to a function which still can be used as 2D array."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513769215, "post_id": 47904671, "comment_id": 82776545, "body": "You should post all the code needed to understand the question, such as the declarations of all variables you&#39;re passing at the call site. But this has been asked and answered many times anyway. Seriously, just search Google for <i>stackoverflow c pass 2d array</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1513772090, "post_id": 47904671, "comment_id": 82778359, "body": "&quot;<code>arr</code> is the two dimensional array,&quot; --&gt; Not quite <code>arr</code> is a <a href=\"https://cdecl.org/?q=int+%2A%2Aarr\" rel=\"nofollow noreferrer\">pointer to pointer to int</a>.  Arrays are not pointers and pointers are not arrays even though their usage appears similar."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1513770178, "post_id": 47904768, "comment_id": 82777148, "body": "Why suggest <code>typedef</code>ing a pointer, which is generally a bad idea? And this seems confusing, since OP can&#39;t declare <code>Array arr;</code> and expect this to work. Why not simply <code>rotate(int arr[][20], int row, int col, int fl);</code> or <code>rotate(int (*arr)[20], int row, int col, int fl);</code>? OP has not provided enough code to clarify what is expected of the return value <code>int **</code>."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1513770242, "post_id": 47904768, "comment_id": 82777193, "body": "@DavidBowling Please suggest me a way to use this in the function&#39;s return value."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1513770283, "post_id": 47904768, "comment_id": 82777212, "body": "I don&#39;t follow... to use what in the function&#39;s return value?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1513770314, "post_id": 47904768, "comment_id": 82777223, "body": "@DavidBowling OP&#39;s function prototype is <code>int** rotate(...)</code>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1513770533, "post_id": 47904768, "comment_id": 82777382, "body": "yes, that is OP&#39;s function prototype, which seems likely to be a mistake also. I suspect that <code>arr</code> is declared as a 2d array like <code>int arr[20][20]</code>, and that the return value is used to access the rotated array; but how? I imagine that there are further errors here which a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> from OP would clarify."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 3, "last_activity_date": 1513772299, "last_edit_date": 1513772299, "creation_date": 1513768581, "answer_id": 47904768, "question_id": 47904671, "link": "https://stackoverflow.com/questions/47904671/how-to-pass-a-two-dimensional-array-to-a-function-in-c/47904768#47904768", "title": "How to pass a two-dimensional array to a function in C?", "body": "<p>A pointer to a pointer is different from a pointer to an array. Array-to-pointer decaying can only happen on the left-most side (e.g. <code>int [3][20]</code> to <code>int (*)[20]</code>).</p>\n\n<p>Change your function declaration to</p>\n\n<pre><code>int** rotate(int (*arr)[20], int row, int col, int fl);\n</code></pre>\n\n<p>or more obviously,</p>\n\n<pre><code>int** rotate(int arr[][20], int row, int col, int fl);\n</code></pre>\n\n<p>Note you have to fix the size at compile-time.</p>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1513770258, "creation_date": 1513770258, "answer_id": 47905302, "question_id": 47904671, "link": "https://stackoverflow.com/questions/47904671/how-to-pass-a-two-dimensional-array-to-a-function-in-c/47905302#47905302", "title": "How to pass a two-dimensional array to a function in C?", "body": "<p>From the example, I assume that you are using a static definition of <code>arr</code>.</p>\n\n<p>The Pointer to pointer is not the same as a 2D array. </p>\n\n<p>Change </p>\n\n<pre><code>int** rotate(int **arr, int row, int col, int fl);\n</code></pre>\n\n<p>to </p>\n\n<pre><code>int** rotate(int arr[][20], int row, int col, int fl);\n</code></pre>\n\n<p>Note that the no of columns will have to be defined before compilation.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1513773120, "last_edit_date": 1513773120, "creation_date": 1513770840, "answer_id": 47905475, "question_id": 47904671, "link": "https://stackoverflow.com/questions/47904671/how-to-pass-a-two-dimensional-array-to-a-function-in-c/47905475#47905475", "title": "How to pass a two-dimensional array to a function in C?", "body": "<p>If your compiler supports variable length arrays then the function declaration can look the following way</p>\n\n<pre><code>void rotate( size_t row, size_t col, int arr[][col], int fl);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>void rotate( size_t row, size_t col, int arr[][col], _Bool fl);\n</code></pre>\n\n<p>In this case you can use arrays with different sizes.</p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid rotate( size_t row, size_t col, int a[][col], _Bool fl )\n{\n    for ( size_t i = 0; i &lt; ( fl ? row : col ); i++ )\n    {\n        for ( size_t j = 0; j &lt; ( fl ? col : row ); j++ )\n        {\n            printf( \"%d \", a[fl ? i : j][fl ? j : i] );\n        }\n        putchar( '\\n' );\n    }\n}\n\n#define N1  3\n\nint main(void) \n{\n    int a[][3] =\n    {\n        { 1, 2, 3 },\n        { 4, 5, 6 }\n    };\n\n    rotate( sizeof( a ) / sizeof( *a ), N1, a, 0 );\n    putchar( '\\n' );\n\n    rotate( sizeof( a ) / sizeof( *a ), N1, a, 1 );\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>1 4 \n2 5 \n3 6 \n\n1 2 3 \n4 5 6 \n</code></pre>\n\n<p>Otherwise if within the function you are going to create new arrays then the function can look as it is shown in the following demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint ** rotate( size_t, size_t, int a[][*], _Bool fl );\n\nint ** rotate( size_t row, size_t col, int a[][col], _Bool fl )\n{\n    int **p = malloc( col * sizeof( int * ) );\n    for ( size_t i = 0; i &lt; col; i++ )\n    {\n        p[i] = ( int * )malloc( row * sizeof( int ) );\n    }\n\n    if ( fl )\n    {\n        for ( size_t i = 0; i &lt; row; i++ )\n        {\n            for ( size_t j = 0; j &lt; col; j++ )\n            {\n                p[col - j - 1][i] = a[i][j];\n            }\n        }\n    }\n    else\n    {\n        for ( size_t i = 0; i &lt; row; i++ )\n        {\n            for ( size_t j = 0; j &lt; col; j++ )\n            {\n                p[j][i] = a[row - i - 1][j];\n            }\n        }\n    }\n\n    return p;\n}\n\n#define M   2\n#define N   3\n\nint main(void) \n{\n    int a[M][N] =\n    {\n        { 1, 2, 3 },\n        { 4, 5, 6 }\n    };\n\n    int **p = rotate( M, N, a, 0 );\n\n    for ( size_t i = 0; i &lt; N; i++ )\n    {\n        for ( size_t j = 0; j &lt; M; j++ )\n        {\n            printf( \"%d \", p[i][j] );\n        }\n        putchar( '\\n' );\n    }\n    putchar( '\\n' );\n\n    for ( size_t i = 0; i &lt; N; i++ )\n    {\n        free( p[i] );\n    }\n    free( p );\n\n    p = rotate( M, N, a, 1 );\n\n    for ( size_t i = 0; i &lt; N; i++ )\n    {\n        for ( size_t j = 0; j &lt; M; j++ )\n        {\n            printf( \"%d \", p[i][j] );\n        }\n        putchar( '\\n' );\n    }\n    putchar( '\\n' );\n\n    for ( size_t i = 0; i &lt; N; i++ )\n    {\n        free( p[i] );\n    }\n    free( p );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>4 1 \n5 2 \n6 3 \n\n3 6 \n2 5 \n1 4 \n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9122308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9adbd1da58b929187bfaded137673098?s=128&d=identicon&r=PG&f=1", "display_name": "SB56", "link": "https://stackoverflow.com/users/9122308/sb56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1513794570, "creation_date": 1513768246, "last_edit_date": 1513794570, "question_id": 47904671, "link": "https://stackoverflow.com/questions/47904671/how-to-pass-a-two-dimensional-array-to-a-function-in-c", "title": "How to pass a two-dimensional array to a function in C?", "body": "<p>My function prototype is</p>\n\n<pre><code>int** rotate(int **arr, int row, int col, int fl);\n</code></pre>\n\n<p>where <code>arr</code> is the two dimensional array, <code>row</code> and <code>col</code> is the number of row and columns of the 2D array respectively, <code>fl</code> is a flag variable. If the value of <code>fl</code> is <code>0</code> then the array will be rotated right, if fl is <code>1</code> then the array will be rotated left.</p>\n\n<p>I have called the function as follows:</p>\n\n<pre><code>int **res= rotate(arr, row, col, fl);\n</code></pre>\n\n<p>But I got one warning and one note</p>\n\n<pre><code>[Warning] passing argument 1 of 'rotate' from incompatible pointer type.\n\n[Note] expected 'int **' but argument is of type 'int (*)[20]' \n</code></pre>\n"}, {"tags": ["c", "system-verilog", "uvm", "questasim", "system-verilog-dpi"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1513779635, "post_id": 47903609, "comment_id": 82783356, "body": "you are passing a dynamic array with undefined second dimension. Not sure if this could be mapped into an open array handle. Try a normal array."}, {"owner": {"reputation": 803, "user_id": 1699003, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f04cce69add362c6f25602998465ba30?s=128&d=identicon&r=PG", "display_name": "noobuntu", "link": "https://stackoverflow.com/users/1699003/noobuntu"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1513966931, "post_id": 47903609, "comment_id": 82861265, "body": "@Serge the second dimension is defined by the <code>pack_bytes</code> function of uvm_object. It allocated a byte array of size required to pack bytes of the objects."}], "answers": [{"comments": [{"owner": {"reputation": 803, "user_id": 1699003, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f04cce69add362c6f25602998465ba30?s=128&d=identicon&r=PG", "display_name": "noobuntu", "link": "https://stackoverflow.com/users/1699003/noobuntu"}, "edited": false, "score": 0, "creation_date": 1513971596, "post_id": 47908623, "comment_id": 82863075, "body": "this makes sense, yet I get sub_array size = -1 for all the subarrays. I assume this is a simulator bug? I use Questasim 10.4B, maybe @dave_59 can respond to this..."}], "tags": [], "owner": {"reputation": 6855, "user_id": 1334062, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/52fbc94ef21aeb260ec0ff47b07ab64d?s=128&d=identicon&r=PG", "display_name": "Tudor Timi", "link": "https://stackoverflow.com/users/1334062/tudor-timi"}, "is_accepted": false, "score": 1, "last_activity_date": 1513781345, "creation_date": 1513781345, "answer_id": 47908623, "question_id": 47903609, "link": "https://stackoverflow.com/questions/47903609/unable-to-access-dimensions-of-svopenarrayhandle/47908623#47908623", "title": "Unable to access dimensions of svOpenArrayHandle", "body": "<p>Your 2-dimensional array is built of arrays of (potentially) different lengths. If you want to get the second dimension, you have to do it element-wise. Something like:</p>\n\n<pre><code>for (int i = 0; i &lt; svSize(data, 1); i++) {\n\n  // Each array element is itself an array\n  svOpenArrayHandle* sub_array = (svOpenArrayHandle*) svGetArrElemPtr(data, i);\n\n  printf( \"sub_array size = %0d\\n\", svSize(sub_array, 1));\n}\n</code></pre>\n\n<p>I've used <code>0</code> for an initial value of <code>i</code> instead of <code>svLeft(data, 1)</code>, because dynamic arrays always start at <code>0</code> and containt <code>size</code> elements.</p>\n\n<p>The code doesn't seem to work for me, because <code>sub_array</code> is always <code>NULL</code>. It looks just like an example from the LRM and I don't see anything wrong with it, so it could be due to a tool bug. Maybe it can get you started and you'll have better luck.</p>\n"}], "owner": {"reputation": 803, "user_id": 1699003, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f04cce69add362c6f25602998465ba30?s=128&d=identicon&r=PG", "display_name": "noobuntu", "link": "https://stackoverflow.com/users/1699003/noobuntu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545885310, "creation_date": 1513764958, "last_edit_date": 1545885310, "question_id": 47903609, "link": "https://stackoverflow.com/questions/47903609/unable-to-access-dimensions-of-svopenarrayhandle", "title": "Unable to access dimensions of svOpenArrayHandle", "body": "<p>I have a multidimensional dynamic unpacked array in my SystemVerilog testbench and am passing this into C code as an argument using DPI-C. I am using Questasim 10.4b. Following the flow of Questa, I ran -dpiheader to generate the header file and included it in my C code.</p>\n\n<p>SystemVerilog:</p>\n\n<pre><code>// C function declaration\nimport \"DPI-C\" function void modulate_my_frame (input byte data[][]);\n\n// multidimensional array\nbyte unsigned frame_packed[][];\n\n// assume this is randomized in my testbench\nint num_frames = 5;\n\n// init 1st dimension\nframe_packed = new[num_frames];\n\n// iterate through num_frames\nfor (int num_frame = 0; num_frame &lt; num_frames; num_frame++) begin\n\n  // item\n  noob_frame fr = noob_frame::type_id::create(\"noob_frame\");\n\n  // randomize\n  if (!noob_frame.randomize()) `uvm_error(get_name(), \"Cannot randomize noob_frame\");\n\n  // pack noob_frame\n  // I am casting this to void to simplify this example\n  // This can return a variable sized array for frame_packed[num_frame]\n  void'(fr.pack_bytes(frame_packed[num_frame]);\n\nend\n\n// fr[][] now contains all 5 noob_frames packed into byte arrays\n\n// call DPI-C function\nmodulate_my_frame( frame_packed );\n</code></pre>\n\n<p>This is my C code:</p>\n\n<pre><code>void modulate_my_frame (const svOpenArrayHandle data)\n{\n  printf( \"svLeft1       = %0d\\n\", svLeft      ( data, 1));\n  printf( \"svRight1      = %0d\\n\", svRight     ( data, 1));\n  printf( \"svLow1        = %0d\\n\", svLow       ( data, 1));\n  printf( \"svHigh1       = %0d\\n\", svHigh      ( data, 1));\n  printf( \"svIncrement1  = %0d\\n\", svIncrement ( data, 1));\n  printf( \"svSize1       = %0d\\n\", svSize      ( data, 1));\n\n  printf( \"svLeft2       = %0d\\n\", svLeft      ( data, 2));\n  printf( \"svRight2      = %0d\\n\", svRight     ( data, 2));\n  printf( \"svLow2        = %0d\\n\", svLow       ( data, 2));\n  printf( \"svHigh2       = %0d\\n\", svHigh      ( data, 2));\n  printf( \"svIncrement2  = %0d\\n\", svIncrement ( data, 2));\n  printf( \"svSize2       = %0d\\n\", svSize      ( data, 2));\n\n  printf( \"svDimensions  = %0d\\n\", svDimensions( data   ));\n}\n</code></pre>\n\n<p>The printout that I get:</p>\n\n<pre><code># svLeft1  = 0\n# svRight1 = 2\n# svLow1   = 0\n# svHigh1  = 2\n# svIncrement1 = -1\n# svSize1 = 3\n# svLeft2  = -1\n# svRight2 = -1\n# svLow2   = -1\n# svHigh2  = -1\n# svIncrement2 = 0\n# svSize2 = -2\n# svDimensions = 2\n</code></pre>\n\n<p>I don't understand how to possibly get the dimensions of my subarrays? </p>\n\n<p>The strange part is, I can use <code>svGetArrElemPtr2</code> to access elements of my entire array. I just dont know what the dimensions are. At this point, my workaround is to pass another int array into the C code that contains the dimensions of the subarray.</p>\n"}, {"tags": ["c", "argv", "strcmp"], "comments": [{"owner": {"reputation": 1985, "user_id": 7255359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ap90j.jpg?s=128&g=1", "display_name": "Sudheesh Singanamalla", "link": "https://stackoverflow.com/users/7255359/sudheesh-singanamalla"}, "edited": false, "score": 1, "creation_date": 1513764774, "post_id": 47903529, "comment_id": 82773734, "body": "What are the possible arguments you&#39;re trying to check, are these numbers? Then you need to convert string to an integer. One possible choice is to use <code>atoi()</code>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1513764776, "post_id": 47903529, "comment_id": 82773737, "body": "don&#39;t use <code>atoi</code> if you want reliability"}, {"owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "edited": false, "score": 0, "creation_date": 1513765026, "post_id": 47903529, "comment_id": 82773893, "body": "Yep, these are 2 numbers."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1513765088, "post_id": 47903529, "comment_id": 82773942, "body": "The <code>argv[x]</code> arguments are ALWAYS (as the param declaration indicates) C strings (memory buffer 0 terminated). You cannot compare C strings  as it were numbers. You have to use strcmp or convert the strings in numbers using one of the opportune conversion functions (atoi, strtol, strtod ... and so on)."}, {"owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "edited": false, "score": 0, "creation_date": 1513765489, "post_id": 47903529, "comment_id": 82774239, "body": "Ok. Can you please give me an example about using atoi with argv? I&#39;ve seen some but with only a value."}], "owner": {"reputation": 141, "user_id": 5737076, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/309841178a8b3f5759300d6fb83b262c?s=128&d=identicon&r=PG&f=1", "display_name": "Asez", "link": "https://stackoverflow.com/users/5737076/asez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "closed_date": 1513764932, "answer_count": 0, "score": 0, "last_activity_date": 1513764826, "creation_date": 1513764696, "question_id": 47903529, "link": "https://stackoverflow.com/questions/47903529/verify-if-argv1-is-bigger-than-argv2", "closed_reason": "Duplicate", "title": "Verify if argv[1] is bigger than argv[2]", "body": "<p>I'm trying to verify if argv[1] it's bigger than argv[2]. I noticed I can't directly do it since argv is a char. But no ideea about how I could transform it into a int. There you have my code. Thanks in advance!</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    if(argv[1] &gt; argv[2])\n        printf(\"it's superior\");\n    return (0);\n}\n</code></pre>\n"}, {"tags": ["c", "input", "output", "scanf", "whitespace"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1513764973, "post_id": 47903523, "comment_id": 82773857, "body": "Do you mean the whitespace after the second <code>%d</code> or before the first one? Do you want to ignore the first or the third value?"}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1513765150, "post_id": 47903523, "comment_id": 82773983, "body": "i am asking for both , before first %d and after second %d , i just want to know that why the compiler asks for three inputs when i use a white space in scanf like in my code"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1513765521, "post_id": 47903523, "comment_id": 82774263, "body": "The readable version of ignoring an input is to use <code>%*d</code>."}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "edited": false, "score": 0, "creation_date": 1513765624, "post_id": 47903523, "comment_id": 82774322, "body": "what should i do if i want to enter only two integers rather than three , for the same code with white space as mentioned in the question ????"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1513765680, "post_id": 47903523, "comment_id": 82774364, "body": "<code>scanf(&quot;%d%d&quot;, &amp;a, &amp;b);</code> will read 2 integers and nothing more."}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "edited": false, "score": 0, "creation_date": 1513765770, "post_id": 47903523, "comment_id": 82774422, "body": "will scanf(&quot;  %d%d    &quot;,&amp;a,&amp;b); always read 3 integers ???"}, {"owner": {"reputation": 1111, "user_id": 1167772, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/MjYDb.jpg?s=128&g=1", "display_name": "Prabhat Kasera", "link": "https://stackoverflow.com/users/1167772/prabhat-kasera"}, "edited": false, "score": 0, "creation_date": 1513766144, "post_id": 47903523, "comment_id": 82774647, "body": "#include&lt;stdio.h&gt; int main() {     int a,b;     printf(&quot;Enter values of a and b\\n&quot;);     scanf(&quot;%d\\n%d&quot;,&amp;a,&amp;b);     printf(&quot;a=%d b=%d&quot;, a, b);          return 0 ; }"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1513767233, "post_id": 47903523, "comment_id": 82775349, "body": "Note that the leading whitespace in the format string is not needed since the <code>%d</code> directive <i>automatically</i> ignores initial whitespace characters, and the trailing whitespace in the format string is a mistake which causes problems for interactive input."}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1513767827, "post_id": 47903523, "comment_id": 82775740, "body": "@user3121023  can u please explain it more clearly"}], "answers": [{"comments": [{"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "edited": false, "score": 0, "creation_date": 1513765340, "post_id": 47903667, "comment_id": 82774120, "body": "i am not asking about space between the two %d&#39;s , i am asking about the white space before and after my first and second %d in the scanf statement, how do they modify my program ?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1513765382, "post_id": 47903667, "comment_id": 82774163, "body": "A space between the <code>%d</code>s does not change anything. A whitespace means &quot;ignore all whitespaces&quot;, but a <code>%d</code> also ignores all whitespaces."}], "tags": [], "owner": {"reputation": 3265, "user_id": 5601726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92fedec5da7b57154550e632df00f2df?s=128&d=identicon&r=PG", "display_name": "Gal Silberman", "link": "https://stackoverflow.com/users/5601726/gal-silberman"}, "is_accepted": false, "score": 0, "last_activity_date": 1513765115, "creation_date": 1513765115, "answer_id": 47903667, "question_id": 47903523, "link": "https://stackoverflow.com/questions/47903523/white-space-in-format-string-of-scanf/47903667#47903667", "title": "white space in format string of scanf()", "body": "<p>Take a look at <a href=\"https://stackoverflow.com/questions/10425953/how-to-read-numbers-separated-by-space-using-scanf\">this</a>.</p>\n\n<p>You can use a space between the <code>%d</code>'s.\nThat will require from the user to input something like: <code>12 32</code> (with the spaces).</p>\n\n<p>If you don't want that, you should use a loop with the scanf.</p>\n\n<p>Good luck.</p>\n"}, {"tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 0, "last_activity_date": 1513766141, "last_edit_date": 1513766141, "creation_date": 1513765809, "answer_id": 47903910, "question_id": 47903523, "link": "https://stackoverflow.com/questions/47903523/white-space-in-format-string-of-scanf/47903910#47903910", "title": "white space in format string of scanf()", "body": "<p>If you give a space after your numbers, <code>scanf</code> must determine the end of the whitespaces to be matched:</p>\n\n<pre><code>scanf(\"%d \", &amp;a);\n</code></pre>\n\n<p>Here the space means <strong>read and discard <em>all</em> whitespaces</strong>. A non-whitespace character (or EOF) must appear for <code>scanf</code> to make it clear what <strong><em>all</em></strong> is so they can be properly read and discarded.</p>\n\n<p>Consider this input stream (dots are character indicators):</p>\n\n<pre><code>   1   2\n........\n</code></pre>\n\n<p>If you call <code>scanf(\"%d\")</code>, then after calling, the leftover stream is</p>\n\n<pre><code>   2\n....\n</code></pre>\n\n<p>... where the whitespaces will be discarded <strong>at next read</strong>. Note the leading spaces are automatically discarded when reading the number.</p>\n\n<p>If you call <code>scanf(\"%d \")</code> instead, the leftover stream is</p>\n\n<pre><code>2\n.\n</code></pre>\n\n<p>You see the whitespaces are gone immediately.</p>\n"}], "owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "closed_date": 1513774315, "accepted_answer_id": 47903910, "answer_count": 2, "score": 1, "last_activity_date": 1513766141, "creation_date": 1513764689, "last_edit_date": 1513765062, "question_id": 47903523, "link": "https://stackoverflow.com/questions/47903523/white-space-in-format-string-of-scanf", "closed_reason": "Duplicate", "title": "white space in format string of scanf()", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main() {\n    int a,b;\n    printf(\"Enter values of a and b\\n\");\n    scanf(\" %d%d \",&amp;a,&amp;b);\n    printf(\"a=%d b=%d\", a, b);\n    return 0 ;\n}\n</code></pre>\n\n<p>Here if I use scanf(), as in my code then the compiler expects the user to enter three values, I am unable to understand this , when i use scanf() without any white space then it asks for only two inputs as expected , so i am confused whats the difference between these two , plz explain ...</p>\n"}, {"tags": ["c", "pointers", "variable-assignment"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 4, "creation_date": 1513764049, "post_id": 47903238, "comment_id": 82773232, "body": "You need to add a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> because there really isn&#39;t enough code shown so far to have any idea what you&#39;re doing. Although at a guess, it looks like you should research variable argument lists."}, {"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1513764378, "post_id": 47903238, "comment_id": 82773454, "body": "You are trying to case a pointer to a normal value!"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1513764456, "post_id": 47903238, "comment_id": 82773517, "body": "<code>(int)var</code> will not work as expected either, it will  get you the integer representation of the address pointed by <code>var</code>, not the integer value stored at that location. <b>You simply cannot cast between pointer types and value types.</b> What you can do is cast a <code>void*</code> to a <code>int*</code>, and then dereference it: <code>int x = *(int*)var;</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1513764601, "post_id": 47903238, "comment_id": 82773612, "body": "&quot;one of these function is called&quot; show the call."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1513764697, "post_id": 47903238, "comment_id": 82773688, "body": "By the way a printf-like function can <b>never</b> get a float, ever. Only a double. Note in the standard library printf, <code>%f</code> expects a double argument. There is no output format specification for floats, have you ever wondered why?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1513764768, "post_id": 47903238, "comment_id": 82773730, "body": "Indeed. Check out <i>the default argument promotions</i> of a va function&#39;s parameters."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1513765315, "post_id": 47903238, "comment_id": 82774094, "body": "Trying again. How <code>fct[i]</code> are called? Show the code."}, {"owner": {"reputation": 1, "user_id": 8801980, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779182215708496/picture?type=large", "display_name": "Ayfaise Ayfaise", "link": "https://stackoverflow.com/users/8801980/ayfaise-ayfaise"}, "edited": false, "score": 0, "creation_date": 1513765573, "post_id": 47903238, "comment_id": 82774291, "body": "Groo it still works anyway. I can do a (int)var and it perfectly works, i&#39;ve tested it. I understand why it shouldn&#39;t but it still works so i&#39;ll continue to use it. I&#39;ve tried to use it to solve my problem float nbr = <i>(float</i>)var; but i just get nbr = 0.0 and it does the same with a double type. Though, i don&#39;t get any error nor warnings"}, {"owner": {"reputation": 1, "user_id": 8801980, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779182215708496/picture?type=large", "display_name": "Ayfaise Ayfaise", "link": "https://stackoverflow.com/users/8801980/ayfaise-ayfaise"}, "edited": false, "score": 0, "creation_date": 1513765653, "post_id": 47903238, "comment_id": 82774342, "body": "it&#39;s too long to write it in comment so i&#39;ll just tell you how it works. I scan the string &quot;%f&quot; to find a &#39;%&#39; character. If i do, i&#39;ll check the character next to it. I&#39;ll then scan another string flag[] = &quot;scidlxXobSupfeE&quot; with all flags i&#39;ve coded. The number of the corresponding box matches the function pointer (&#39;f&#39; would call printff() or &#39;d&#39; would call printfd() ) so we call it."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1513765867, "post_id": 47903238, "comment_id": 82774476, "body": "I&#39;m voting to close this question as off-topic because  you just do not know the language - you even do not understand the difference between the pointer to the object and the object itself. You need a good C beginners book first."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513766101, "post_id": 47903238, "comment_id": 82774621, "body": "don&#39;t try pasting your code in a comment - edit your question!"}, {"owner": {"reputation": 1, "user_id": 8801980, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779182215708496/picture?type=large", "display_name": "Ayfaise Ayfaise", "link": "https://stackoverflow.com/users/8801980/ayfaise-ayfaise"}, "edited": false, "score": 0, "creation_date": 1513766146, "post_id": 47903238, "comment_id": 82774649, "body": "PeterJ_01 or you could calm down and ask questions cause i&#39;ve given the strict minimum info since it&#39;s a project i&#39;ve made in 2 or 3 weeks (so too long to explain everything) and cause you might not understand everything and believe it&#39;s off topic... If i ask a question this particular, you should rather try to answer it rather than closing it"}, {"owner": {"reputation": 1, "user_id": 8801980, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779182215708496/picture?type=large", "display_name": "Ayfaise Ayfaise", "link": "https://stackoverflow.com/users/8801980/ayfaise-ayfaise"}, "edited": false, "score": 0, "creation_date": 1513766480, "post_id": 47903238, "comment_id": 82774865, "body": "Chris, it&#39;s long, complex, i&#39;m using stdarg lib so the 50 lines of programs i use to call a function would be too long and too complex to write down in comment or in the question itself. It&#39;s doesn&#39;t really matter how i call it ( just know that it is this way fct[j](va_arg(args, void*)); ) since i gave you all you needed to answer the problem. It would get off topic if you tried to understand how i call it, since the problem isn&#39;t here. I get a void* which was a float (works with int, char ect...) that&#39;s it"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1513766715, "post_id": 47903238, "comment_id": 82774995, "body": "<i>&quot;I understand why it shouldn&#39;t but it still works so i&#39;ll continue to use it&quot;</i> - yeah, that&#39;s a rather problematic approach to pretty much anything, not just programming. Just add <code>#define float int</code> somewhere and your work is done."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1513766914, "post_id": 47903238, "comment_id": 82775117, "body": "Here is a snippet from your program which &quot;perfectly works&quot;, which you&#39;ve &quot;tested&quot; and will &quot;continue to use&quot;: <a href=\"https://ideone.com/3Z2gJG\" rel=\"nofollow noreferrer\">ideone.com/3Z2gJG</a>. Check the <code>stdout</code> at the bottom and tell me why the number isn&#39;t 5."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1513768542, "post_id": 47903238, "comment_id": 82776147, "body": "Your use of va_arg is incorrect and leads to undefined behaviour. You have to redesign your entire approach. The fact that it appears to work for a single <code>int</code> argument on your computer is a pure accident, and an unfortunate one because it caused you to wasre so much time on a dead end approach."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8801980, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779182215708496/picture?type=large", "display_name": "Ayfaise Ayfaise", "link": "https://stackoverflow.com/users/8801980/ayfaise-ayfaise"}, "edited": false, "score": 0, "creation_date": 1513764530, "post_id": 47903341, "comment_id": 82773565, "body": "i&#39;d love to do that but i&#39;m not the one using the function, really. We have a computer which test our programs so the way my_printf() is called must match the way we usually call printf(). That means i must write my_printf(&quot;%d&quot;, nbr); and not my_printf(&quot;%d&quot;, (int)nbr);"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1513764849, "post_id": 47903341, "comment_id": 82773780, "body": "This answer would benefit from mentioning that variadic <code>float</code> arguments get promoted to <code>double</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1513765203, "post_id": 47903341, "comment_id": 82774015, "body": "@KlasLindb&#228;ck If you think it&#39;s useful, let me add, it does no harm, after all. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1513771580, "last_edit_date": 1513771580, "creation_date": 1513764091, "answer_id": 47903341, "question_id": 47903238, "link": "https://stackoverflow.com/questions/47903238/get-a-float-number-from-a-void/47903341#47903341", "title": "get a float number from a void*", "body": "<p>If I understood your problem correctly, when you are entirely sure of the caller part, in the called function, considering you receive the argument in <code>var</code>, you can do</p>\n\n<ul>\n<li><p>For <code>int</code></p>\n\n<pre><code>printf(\"%d\", *(int *)var);\n</code></pre></li>\n<li><p>For <code>float</code>/ <code>double</code></p>\n\n<pre><code>printf(\"%f\", *(double *)var);\n</code></pre></li>\n</ul>\n\n<p>and so on.</p>\n\n<p>Please note, there exist no <code>float</code> type for variadic functions, because, for those functions, due to default argument promotion, <code>float</code> types get promoted to <code>double</code>.</p>\n\n<p>To elaborate, you do not cast / assign the incoming pointer to the required type (that is both invalid [type mismatch] and unwanted). Rather, you cast the <code>void *</code> parameter to the appropriate caller argument type, (based on flag, you mentioned) and then, dereference that to obtain the value.</p>\n\n<p>This analogy is based on the property mentioned in <code>C11</code>, chapter \u00a76.3.2.3</p>\n\n<blockquote>\n  <p>A pointer to <code>void</code> may be converted to or from a pointer to any object type. A pointer to\n  any object type may be converted to a pointer to <code>void</code> and back again; the result shall\n  compare equal to the original pointer. </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1513765517, "creation_date": 1513765517, "answer_id": 47903805, "question_id": 47903238, "link": "https://stackoverflow.com/questions/47903238/get-a-float-number-from-a-void/47903805#47903805", "title": "get a float number from a void*", "body": "<p>It is called punning. Pointer punning is the UB. The safest way is to memcpy the data from the void pointer to the float variable. </p>\n\n<p><code>float x;\nmemcpy (&amp;x, voidptr, sizeof(float));</code></p>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1513767454, "creation_date": 1513767454, "answer_id": 47904445, "question_id": 47903238, "link": "https://stackoverflow.com/questions/47903238/get-a-float-number-from-a-void/47904445#47904445", "title": "get a float number from a void*", "body": "<p>You're not calling <code>va_args</code> correctly. The second parameter has to be the data type you're expecting to read from the variable parameters because <code>va_args</code> needs the correct size to know where to get the next parameter from.</p>\n\n<p>Whilst your use of an array to store all the possibly functions might appear to be clever, you're actually making things harder for yourself when there is an easier and much more readable way to do it. It's probably also a lot more expandable too.</p>\n\n<pre><code>switch(format_char)\n  {\ncase 'd':\n  print_an_int(va_args(args,int));\nbreak;\ncase 'f':\n  print_an_float(va_args(args,float));\nbreak;\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 84, "user_id": 9122108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90887a50841caf6dd9e5c40ffa6062a7?s=128&d=identicon&r=PG&f=1", "display_name": "jibin_raj24", "link": "https://stackoverflow.com/users/9122108/jibin-raj24"}, "is_accepted": false, "score": 0, "last_activity_date": 1513772609, "last_edit_date": 1513772609, "creation_date": 1513772029, "answer_id": 47905847, "question_id": 47903238, "link": "https://stackoverflow.com/questions/47903238/get-a-float-number-from-a-void/47905847#47905847", "title": "get a float number from a void*", "body": "<p>Try using </p>\n\n<pre><code>int nbr = *((int *)var); \nfloat nbr = *((float *)var);\n</code></pre>\n\n<blockquote>\n  <p>converts void pointer var to an integer/float pointer and then fetches the value stored in that memory address and stores the value in to the variables</p>\n</blockquote>\n\n<p>instead of</p>\n\n<p>int nbr = (int)var;</p>\n\n<p>float nbr = (float)var;</p>\n\n<blockquote>\n  <p>converts the address stored in var to int/float. Here you are just converting the address and not the value stored in that address.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1513774894, "creation_date": 1513774894, "answer_id": 47906686, "question_id": 47903238, "link": "https://stackoverflow.com/questions/47903238/get-a-float-number-from-a-void/47906686#47906686", "title": "get a float number from a void*", "body": "<p>Instead of trying to extract arguments from <code>args</code> and passing the result to <code>fct[i]</code>, pass <code>args</code> to <code>fct[i]</code> directly and let them do the extraction. The only caveat is that you must not pass by value.</p>\n\n<pre><code>    fct[i](&amp;args);\n</code></pre>\n\n<p>In each of the printf* helper functions do something like:</p>\n\n<pre><code>void printf_double (va_list *args) {      \n   double val = va_arg(*args, double);\n   // print it\n}\n</code></pre>\n\n<p>Note <code>float</code> is not a valid type for <code>printf</code> because <code>float</code> gets promoted to <code>double</code> in varargs calls.</p>\n"}], "owner": {"reputation": 1, "user_id": 8801980, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779182215708496/picture?type=large", "display_name": "Ayfaise Ayfaise", "link": "https://stackoverflow.com/users/8801980/ayfaise-ayfaise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "closed_date": 1513775486, "answer_count": 5, "score": 0, "last_activity_date": 1513774894, "creation_date": 1513763827, "last_edit_date": 1513771766, "question_id": 47903238, "link": "https://stackoverflow.com/questions/47903238/get-a-float-number-from-a-void", "closed_reason": "Not suitable for this site", "title": "get a float number from a void*", "body": "<p>I'm trying to re-program the printf function (college project) but the %f is causing me problems.\nI use function pointers like so :</p>\n\n<pre><code>void (*fct[15])(void*) =\n            {printfs, printfc, printfd, printfd, printfl, printfx, printfX,\n             printfo, printfb, printfS, printfu, printfp, printff};\n</code></pre>\n\n<p>when the right flag is used, one of these function is called.\nA typical printfd will recieves a void* variable as parameter and will do so :</p>\n\n<pre><code>int nbr = (int)var;     //var is a void* type variable\nmy_put_nbr(var);        //handmade function wich displays numbers\n</code></pre>\n\n<p>The thing is, for some odd reason, when i did the same for printff, it didn't work</p>\n\n<pre><code>float nbr = (float)var;\n</code></pre>\n\n<p>I get the message </p>\n\n<blockquote>\n  <p>error: pointer value used where a floating point value was expected\n  float nbr = (float)var</p>\n</blockquote>\n\n<p>I also tried to to something like this. If i have</p>\n\n<pre><code>my_printf(\"%f\", var);     //with var = 12.34\n</code></pre>\n\n<p>Then i call the function printff() which should do :</p>\n\n<pre><code>int nbr1 = (int)(var / 1);\nint nbr2 = (int)(var % 1);\n</code></pre>\n\n<p>So i'd have normally nbr1 = 12 and nbr2 = 34 i would then display both with in between a '.' But it still doesn't work and i get the message :  </p>\n\n<blockquote>\n  <p>error: invalid operands to binary * (have \u2018void *\u2019 and \u2018int\u2019) int nbr1\n  = (int)(var*1)</p>\n</blockquote>\n\n<p>I'm out of ideer so if you have any clue, tell me.\nAlso, i cannot use commands like printf() or something, that's the rule of this exercise so don't tell me the solution hides here.</p>\n"}, {"tags": ["c", "gtk", "glade"], "comments": [{"owner": {"reputation": 2749, "user_id": 1923725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27e32827b69458f6be59b6d851d03ee6?s=128&d=identicon&r=PG", "display_name": "Sergo Pasoevi", "link": "https://stackoverflow.com/users/1923725/sergo-pasoevi"}, "edited": false, "score": 0, "creation_date": 1513763884, "post_id": 47902934, "comment_id": 82773138, "body": "Try runnging with <code>gdb</code> and find where you get segfault please."}, {"owner": {"reputation": 103, "user_id": 9121810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719966cc29b67aafee23bd4a3289c63a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafi&#39;s Revenge", "link": "https://stackoverflow.com/users/9121810/rafis-revenge"}, "reply_to_user": {"reputation": 2749, "user_id": 1923725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27e32827b69458f6be59b6d851d03ee6?s=128&d=identicon&r=PG", "display_name": "Sergo Pasoevi", "link": "https://stackoverflow.com/users/1923725/sergo-pasoevi"}, "edited": false, "score": 0, "creation_date": 1513765111, "post_id": 47902934, "comment_id": 82773955, "body": "It says it occurs at this line: <code>GtkListStore *store = GTK_LIST_STORE(gtk_tree_view_get_model(GTK_TREE_VIEW(app_wid&zwnj;&#8203;-&gt;treeview)));</code>"}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1513773365, "post_id": 47902934, "comment_id": 82779210, "body": "Please build your code with <code>-Wall</code> enabled, your code spits lots of warnings at build time."}, {"owner": {"reputation": 103, "user_id": 9121810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719966cc29b67aafee23bd4a3289c63a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafi&#39;s Revenge", "link": "https://stackoverflow.com/users/9121810/rafis-revenge"}, "edited": false, "score": 0, "creation_date": 1513793097, "post_id": 47902934, "comment_id": 82791515, "body": "Ok. I&#39;ve fixed 3 warnings out of 4 adding a <code>*</code> in <code>gchar value[3];</code> which is now <code>gchar *value[3];</code>. The one that stays says in the <code>if</code> condition, i should pass a GtkTreeModel and i&#39;m passing a GtkListStore."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9121810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719966cc29b67aafee23bd4a3289c63a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafi&#39;s Revenge", "link": "https://stackoverflow.com/users/9121810/rafis-revenge"}, "edited": false, "score": 0, "creation_date": 1513814009, "post_id": 47913340, "comment_id": 82800000, "body": "Thank you !! I&#39;m still not familiar with Treeview/Listview and was worried to be completely in the wrong direction.."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "reply_to_user": {"reputation": 103, "user_id": 9121810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719966cc29b67aafee23bd4a3289c63a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafi&#39;s Revenge", "link": "https://stackoverflow.com/users/9121810/rafis-revenge"}, "edited": false, "score": 0, "creation_date": 1513849109, "post_id": 47913340, "comment_id": 82811444, "body": "@Rafi&#39;sRevenge: Another thing: <code>g_slice_new</code> is really useful if you want to create/destroy lots of objects of the same type. If that&#39;s not the case, just use <code>g_new0</code>."}], "tags": [], "owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "is_accepted": true, "score": 1, "last_activity_date": 1513814340, "last_edit_date": 1513814340, "creation_date": 1513799106, "answer_id": 47913340, "question_id": 47902934, "link": "https://stackoverflow.com/questions/47902934/gtk-glade-c-pass-variables-to-function-including-treeview/47913340#47913340", "title": "GTK Glade C - pass variables to function including treeview", "body": "<p>First thing, you cannot use <code>gtk_builder_connect_signals(builder, NULL);</code> and then expect the callback handlers to receive user data.</p>\n\n<p>You should have passed the <code>widgets</code> structure:</p>\n\n<pre><code>gtk_builder_connect_signals(builder, widgets);\n</code></pre>\n\n<p>Second thing, you over complicated the selection callback. The GtkTreeSelection instance will give you the model when you call <code>gtk_tree_selection_get_selected</code>. Then you must understand that this last function will <a href=\"https://developer.gnome.org/gtk3/stable/GtkTreeSelection.html#gtk-tree-selection-get-selected\" rel=\"nofollow noreferrer\">\"not work if you use selection GTK_SELECTION_MULTIPLE\"</a>.</p>\n\n<p>Also notice that <code>gtk_tree_model_get</code> should take pointers to char/gchar which will then point to newly allocated copies of the model content (means they must be freed afterwards).</p>\n\n<p>So, your code should be something like this:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\ntypedef struct {\n    GtkWidget *ent_date;\n    GtkWidget *ent_lib;\n    GtkWidget *ent_mont;\n    GtkTreeView *treeview;\n\n} app_widgets;\n\nenum\n{\n    DATE_COLUMN,\n    LIBELLE_COLUMN,\n    MONTANT_COLUMN,\n    N_COLUMN\n};\n\n\nvoid on_window_main_destroy()\n{\n    gtk_main_quit();\n}\n\n\nvoid on_treeview_selection1_changed (GtkTreeSelection *treeselection, app_widgets *app_wid) {\n\n    gchar *a,*b,*c;\n    GtkTreeIter iter;\n    GtkTreeModel *model;\n\n    if (gtk_tree_selection_get_selected(treeselection, &amp;model, &amp;iter))\n    {\n        gtk_tree_model_get(model, &amp;iter, DATE_COLUMN, &amp;a, LIBELLE_COLUMN, &amp;b,MONTANT_COLUMN, &amp;c, -1);\n    }\n\n    gtk_entry_set_text(GTK_ENTRY(app_wid-&gt;ent_date), a);\n    gtk_entry_set_text(GTK_ENTRY(app_wid-&gt;ent_lib), b);\n    gtk_entry_set_text(GTK_ENTRY(app_wid-&gt;ent_mont), c);\n\n    g_free(a);\n    g_free(b);\n    g_free(c);\n}\n\n\nint main(int argc, char *argv[])\n{\n    GtkBuilder *builder;\n\n    app_widgets *widgets = g_slice_new(app_widgets);\n\n\n    gtk_init(&amp;argc, &amp;argv);\n\n    builder = gtk_builder_new();\n    gtk_builder_add_from_file (builder, \"test.glade\", NULL);\n\n    widgets-&gt;ent_date  = GTK_WIDGET(gtk_builder_get_object(builder, \"entry_date\"));\n    widgets-&gt;ent_lib = GTK_WIDGET(gtk_builder_get_object(builder, \"entry_lib\"));\n    widgets-&gt;ent_mont = GTK_WIDGET(gtk_builder_get_object(builder, \"entry_mont\"));\n    widgets-&gt;treeview = GTK_TREE_VIEW(gtk_builder_get_object(builder, \"treeview1\"));\n\n    gtk_builder_connect_signals(builder, widgets);\n\n    gtk_widget_show(GTK_WIDGET(gtk_builder_get_object(builder, \"window1\")));\n\n    g_object_unref(builder);\n\n    gtk_main();\n\n    g_slice_free(app_widgets, widgets);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 9121810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719966cc29b67aafee23bd4a3289c63a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafi&#39;s Revenge", "link": "https://stackoverflow.com/users/9121810/rafis-revenge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 47913340, "answer_count": 1, "score": 2, "last_activity_date": 1513814340, "creation_date": 1513762807, "question_id": 47902934, "link": "https://stackoverflow.com/questions/47902934/gtk-glade-c-pass-variables-to-function-including-treeview", "title": "GTK Glade C - pass variables to function including treeview", "body": "<p>It's only possible to pass one variable in a callback function. So we have to built structures. I'm okay with this but how to do with Treeview and Treemodel/Liststore ?</p>\n\n<p>I want to avoid global variables. This test program should get the content of the selected row displayed in the EntryBoxes. I don't know if i'm wrong making the struct including the Treeview or if there's something wrong inside the function. I get segfault.</p>\n\n<p>What would be the correct way to deal with that ?</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\ntypedef struct {\n    GtkWidget *ent_date;\n    GtkWidget *ent_lib;\n    GtkWidget *ent_mont;\n    GtkTreeView *treeview;\n\n} app_widgets;\n\nenum\n{\n    DATE_COLUMN,\n    LIBELLE_COLUMN,\n    MONTANT_COLUMN,\n    N_COLUMN\n};\n\n\nvoid on_window_main_destroy()\n{\n    gtk_main_quit();\n}\n\n\nvoid on_treeview_selection1_changed (GtkTreeSelection *treeselection, app_widgets *app_wid) {\n\n    gchar value[3];\n    GtkTreeIter iter;\n    GtkTreePath *path;\n    //GtkTreeView *treeview = (GtkTreeView *)app_wid-&gt;treeview;\n    GtkListStore *store = GTK_LIST_STORE(gtk_tree_view_get_model(GTK_TREE_VIEW(app_wid-&gt;treeview)));\n\n    gtk_tree_view_get_cursor (app_wid-&gt;treeview, &amp;path, NULL);\n    gtk_tree_model_get_iter (GTK_TREE_MODEL(store), &amp;iter, path);\n    gtk_tree_path_free (path);\n\n    if (gtk_tree_selection_get_selected(treeselection, &amp;store, &amp;iter))\n    {\n        gtk_tree_model_get(GTK_TREE_MODEL(store), &amp;iter, DATE_COLUMN, &amp;value[0], LIBELLE_COLUMN, &amp;value[1],MONTANT_COLUMN, &amp;value[2], -1);\n\n    }\n\n    gtk_entry_set_text(GTK_ENTRY(app_wid-&gt;ent_date), value[0]);\n    gtk_entry_set_text(GTK_ENTRY(app_wid-&gt;ent_lib), value[1]);\n    gtk_entry_set_text(GTK_ENTRY(app_wid-&gt;ent_mont), value[2]);\n\n    g_free(value);\n\n}\n\n\nint main(int argc, char *argv[])\n{\n    GtkBuilder *builder;\n\n    app_widgets *widgets = g_slice_new(app_widgets);\n\n\n    gtk_init(&amp;argc, &amp;argv);\n\n    builder = gtk_builder_new();\n    gtk_builder_add_from_file (builder, \"test.glade\", NULL);\n\n    widgets-&gt;ent_date  = GTK_WIDGET(gtk_builder_get_object(builder, \"entry_date\"));\n    widgets-&gt;ent_lib = GTK_WIDGET(gtk_builder_get_object(builder, \"entry_lib\"));\n    widgets-&gt;ent_mont = GTK_WIDGET(gtk_builder_get_object(builder, \"entry_mont\"));\n    widgets-&gt;treeview = GTK_TREE_VIEW(gtk_builder_get_object(builder, \"treeview1\"));\n\n    gtk_builder_connect_signals(builder, NULL);\n\n    gtk_widget_show(GTK_WIDGET(gtk_builder_get_object(builder, \"window1\")));\n\n    g_object_unref(builder);\n\n    gtk_main();\n\n    g_slice_free(app_widgets, widgets);\n    return 0;\n}\n</code></pre>\n\n<p>Here's the glade file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- Generated with glade 3.18.3 --&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"3.12\"/&gt;\n  &lt;object class=\"GtkListStore\" id=\"liststore1\"&gt;\n    &lt;columns&gt;\n      &lt;!-- column-name Date --&gt;\n      &lt;column type=\"gchararray\"/&gt;\n      &lt;!-- column-name Libell\u00e9 --&gt;\n      &lt;column type=\"gchararray\"/&gt;\n      &lt;!-- column-name Montant --&gt;\n      &lt;column type=\"gchararray\"/&gt;\n    &lt;/columns&gt;\n    &lt;data&gt;\n      &lt;row&gt;\n        &lt;col id=\"0\" translatable=\"yes\"&gt;20.05.2017&lt;/col&gt;\n        &lt;col id=\"1\" translatable=\"yes\"&gt;Something - here&lt;/col&gt;\n        &lt;col id=\"2\" translatable=\"yes\"&gt;30.20&lt;/col&gt;\n      &lt;/row&gt;\n      &lt;row&gt;\n        &lt;col id=\"0\" translatable=\"yes\"&gt;25.06.2017&lt;/col&gt;\n        &lt;col id=\"1\" translatable=\"yes\"&gt;Something else - overthere&lt;/col&gt;\n        &lt;col id=\"2\" translatable=\"yes\"&gt;24.90&lt;/col&gt;\n      &lt;/row&gt;\n      &lt;row&gt;\n        &lt;col id=\"0\" translatable=\"yes\"&gt;11.08.2017&lt;/col&gt;\n        &lt;col id=\"1\" translatable=\"yes\"&gt;Third thing - lala&lt;/col&gt;\n        &lt;col id=\"2\" translatable=\"yes\"&gt;5.15&lt;/col&gt;\n      &lt;/row&gt;\n    &lt;/data&gt;\n  &lt;/object&gt;\n  &lt;object class=\"GtkWindow\" id=\"window1\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;property name=\"margin_left\"&gt;5&lt;/property&gt;\n    &lt;property name=\"margin_right\"&gt;5&lt;/property&gt;\n    &lt;property name=\"margin_top\"&gt;5&lt;/property&gt;\n    &lt;property name=\"margin_bottom\"&gt;5&lt;/property&gt;\n    &lt;property name=\"window_position\"&gt;center&lt;/property&gt;\n    &lt;child&gt;\n      &lt;object class=\"GtkBox\" id=\"box1\"&gt;\n        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n        &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkScrolledWindow\" id=\"scrolledwindow1\"&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n            &lt;property name=\"shadow_type\"&gt;in&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkTreeView\" id=\"treeview1\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                &lt;property name=\"model\"&gt;liststore1&lt;/property&gt;\n                &lt;child internal-child=\"selection\"&gt;\n                  &lt;object class=\"GtkTreeSelection\" id=\"treeview-selection1\"&gt;\n                    &lt;signal name=\"changed\" handler=\"on_treeview_selection1_changed\" swapped=\"no\"/&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkTreeViewColumn\" id=\"treeviewcolumn1\"&gt;\n                    &lt;property name=\"resizable\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"fixed_width\"&gt;70&lt;/property&gt;\n                    &lt;property name=\"title\" translatable=\"yes\"&gt;Date&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkCellRendererText\" id=\"cellrenderertext1\"/&gt;\n                      &lt;attributes&gt;\n                        &lt;attribute name=\"text\"&gt;0&lt;/attribute&gt;\n                      &lt;/attributes&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkTreeViewColumn\" id=\"treeviewcolumn2\"&gt;\n                    &lt;property name=\"resizable\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"title\" translatable=\"yes\"&gt;Libell\u00e9&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkCellRendererText\" id=\"cellrenderertext2\"/&gt;\n                      &lt;attributes&gt;\n                        &lt;attribute name=\"text\"&gt;1&lt;/attribute&gt;\n                      &lt;/attributes&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkTreeViewColumn\" id=\"treeviewcolumn3\"&gt;\n                    &lt;property name=\"resizable\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"title\" translatable=\"yes\"&gt;Montant&lt;/property&gt;\n                    &lt;child&gt;\n                      &lt;object class=\"GtkCellRendererText\" id=\"cellrenderertext3\"/&gt;\n                      &lt;attributes&gt;\n                        &lt;attribute name=\"text\"&gt;2&lt;/attribute&gt;\n                      &lt;/attributes&gt;\n                    &lt;/child&gt;\n                  &lt;/object&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n            &lt;property name=\"position\"&gt;1&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkBox\" id=\"box2\"&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkBox\" id=\"box_date\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkLabel\" id=\"label1\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"label\" translatable=\"yes\"&gt;Date&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"position\"&gt;0&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkEntry\" id=\"entry_date\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"position\"&gt;1&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                &lt;property name=\"position\"&gt;0&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkBox\" id=\"box_lib\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkLabel\" id=\"label2\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"label\" translatable=\"yes\"&gt;Lib&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"position\"&gt;0&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkEntry\" id=\"entry_lib\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"position\"&gt;1&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                &lt;property name=\"position\"&gt;1&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkBox\" id=\"box_mont\"&gt;\n                &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                &lt;property name=\"orientation\"&gt;vertical&lt;/property&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkLabel\" id=\"label3\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"label\" translatable=\"yes\"&gt;Montant&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"position\"&gt;0&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n                &lt;child&gt;\n                  &lt;object class=\"GtkEntry\" id=\"entry_mont\"&gt;\n                    &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n                  &lt;/object&gt;\n                  &lt;packing&gt;\n                    &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                    &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                    &lt;property name=\"position\"&gt;1&lt;/property&gt;\n                  &lt;/packing&gt;\n                &lt;/child&gt;\n              &lt;/object&gt;\n              &lt;packing&gt;\n                &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n                &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n                &lt;property name=\"position\"&gt;2&lt;/property&gt;\n              &lt;/packing&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n          &lt;packing&gt;\n            &lt;property name=\"expand\"&gt;False&lt;/property&gt;\n            &lt;property name=\"fill\"&gt;True&lt;/property&gt;\n            &lt;property name=\"position\"&gt;2&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n"}, {"tags": ["c++", "c", "ssl", "openssl", "heartbeat"], "comments": [{"owner": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1513772532, "post_id": 47902283, "comment_id": 82778629, "body": "Maybe your openssl library was built without the TLS heartbeat functionality ?"}, {"owner": {"reputation": 533, "user_id": 466842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06899df67f31361d385de93cf24dfeb?s=128&d=identicon&r=PG", "display_name": "Keshava ", "link": "https://stackoverflow.com/users/466842/keshava"}, "reply_to_user": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1513772870, "post_id": 47902283, "comment_id": 82778849, "body": "oh, could be, how do I know that for sure? I see in code that there are ifdef statements to contrl this. I am using OpenSSL 1.0.2g, did not see comething on official documentation."}, {"owner": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1513773179, "post_id": 47902283, "comment_id": 82779064, "body": "Who/what built the openssl library ? You should check with the library source. If you built it, check again your build parameters..."}, {"owner": {"reputation": 533, "user_id": 466842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06899df67f31361d385de93cf24dfeb?s=128&d=identicon&r=PG", "display_name": "Keshava ", "link": "https://stackoverflow.com/users/466842/keshava"}, "reply_to_user": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1513773427, "post_id": 47902283, "comment_id": 82779247, "body": "Its in my OS, so it is got from ubuntu repository. I am not a C/C++ person but I checked out code for the same version and grepped though it,  What i found was OPENSSL_NO_HEARTBEATS, but I guess the value of it is given at runtime when you build binaries, you know way to figure this out? Maybe I should contact openssl dev mailing list."}, {"owner": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1513773618, "post_id": 47902283, "comment_id": 82779362, "body": "I do not think you can ask them a specific build just for you ! But you can build openssl locally with heartbeat option enabled, without installing it in the system. You can conduct your tests this way easier..."}, {"owner": {"reputation": 533, "user_id": 466842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06899df67f31361d385de93cf24dfeb?s=128&d=identicon&r=PG", "display_name": "Keshava ", "link": "https://stackoverflow.com/users/466842/keshava"}, "reply_to_user": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1513773979, "post_id": 47902283, "comment_id": 82779596, "body": "ok, I was not asking for a build for myself :) but I should be able to know if hearbeats are eanbled or not in a given build , that is 1.0.2g. But I also take your suggestion on building it myself."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1513922508, "post_id": 47902283, "comment_id": 82842418, "body": "Does <code>openssl version -a</code> show <code>OPENSSL_NO_HEARTBEATS</code>? I think you can check it at compile by including <code>&lt;openssl&#47;opensslconf.h&gt;</code>."}, {"owner": {"reputation": 533, "user_id": 466842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06899df67f31361d385de93cf24dfeb?s=128&d=identicon&r=PG", "display_name": "Keshava ", "link": "https://stackoverflow.com/users/466842/keshava"}, "edited": false, "score": 0, "creation_date": 1513923943, "post_id": 47902283, "comment_id": 82842811, "body": "Ah, nice! that shows how it was compiled, but it does not show OPENSSL_NO_HEARTBEATS,  so I guess its not disabled in that version. So I am back at a dead end, what do i need to do to make the server respond to HB requests :("}, {"owner": {"reputation": 1248, "user_id": 2275956, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/D9FPt.jpg?s=128&g=1", "display_name": "Zhani Baramidze", "link": "https://stackoverflow.com/users/2275956/zhani-baramidze"}, "edited": false, "score": 0, "creation_date": 1528732274, "post_id": 47902283, "comment_id": 88609228, "body": "Hi! little late but do you have the solution? :D"}, {"owner": {"reputation": 533, "user_id": 466842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06899df67f31361d385de93cf24dfeb?s=128&d=identicon&r=PG", "display_name": "Keshava ", "link": "https://stackoverflow.com/users/466842/keshava"}, "edited": false, "score": 0, "creation_date": 1529051884, "post_id": 47902283, "comment_id": 88745374, "body": "No, gave we up finally"}], "owner": {"reputation": 533, "user_id": 466842, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06899df67f31361d385de93cf24dfeb?s=128&d=identicon&r=PG", "display_name": "Keshava ", "link": "https://stackoverflow.com/users/466842/keshava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1513767085, "creation_date": 1513760774, "last_edit_date": 1513767085, "question_id": 47902283, "link": "https://stackoverflow.com/questions/47902283/how-to-respond-to-tls-heartbeat-in-openssl", "title": "How to respond to TLS heartbeat in openssl", "body": "<p>I am writing a TLS server that responds to a incoming TLS heartbeat request. \nI am using <strong>OpenSSL 1.0.2g</strong> . </p>\n\n<h2>Following is my server code (modifed from openssl/demos/ssl)</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;memory.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n\n#include &lt;openssl/rsa.h&gt;       /* SSLeay stuff */\n#include &lt;openssl/crypto.h&gt;\n#include &lt;openssl/x509.h&gt;\n#include &lt;openssl/pem.h&gt;\n#include &lt;openssl/ssl.h&gt;\n#include &lt;openssl/err.h&gt;\n\n\n/* define HOME to be dir for key and cert files... */\n#define HOME \"/home/kbhatk/CLionProjects/tlsHeartbeat/\"\n/* Make these what you want for cert &amp; key files */\n#define CERTF  HOME \"foo-cert.pem\"\n#define KEYF  HOME  \"foo-key.pem\"\n\n\n#define CHK_NULL(x) if ((x)==NULL) exit (1)\n#define CHK_ERR(err,s) if ((err)==-1) { perror(s); exit(1); }\n#define CHK_SSL(err) if ((err)==-1) { ERR_print_errors_fp(stderr); exit(2); }\n\nint main ()\n{\n    int err;\n    int listen_sd;\n    int sd;\n    struct sockaddr_in sa_serv;\n    struct sockaddr_in sa_cli;\n    socklen_t client_len;\n    SSL_CTX* ctx;\n    SSL*     ssl;\n    X509*    client_cert;\n    char*    str;\n    char     buf [4096];\n    const SSL_METHOD *meth;\n\n    /* SSL preliminaries. We keep the certificate and key with the context. */\n\n    SSL_load_error_strings();\n    SSLeay_add_ssl_algorithms();\n    meth = SSLv23_server_method();\n    ctx = SSL_CTX_new (meth);\n    if (!ctx) {\n        ERR_print_errors_fp(stderr);\n        exit(2);\n    }\n\n    if (SSL_CTX_use_certificate_file(ctx, CERTF, SSL_FILETYPE_PEM) &lt;= 0) {\n        ERR_print_errors_fp(stderr);\n        exit(3);\n    }\n    if (SSL_CTX_use_PrivateKey_file(ctx, KEYF, SSL_FILETYPE_PEM) &lt;= 0) {\n        ERR_print_errors_fp(stderr);\n        exit(4);\n    }\n\n    if (!SSL_CTX_check_private_key(ctx)) {\n        fprintf(stderr,\"Private key does not match the certificate public key\\n\");\n        exit(5);\n    }\n\n    /* ----------------------------------------------- */\n    /* Prepare TCP socket for receiving connections */\n\n    listen_sd = socket (AF_INET, SOCK_STREAM, 0);   CHK_ERR(listen_sd, \"socket\");\n\n    memset (&amp;sa_serv, '\\0', sizeof(sa_serv));\n    sa_serv.sin_family      = AF_INET;\n    sa_serv.sin_addr.s_addr = INADDR_ANY;\n    sa_serv.sin_port        = htons (9393);          /* Server Port number */\n\n    err = bind(listen_sd, (struct sockaddr*) &amp;sa_serv,\n               sizeof (sa_serv));                   CHK_ERR(err, \"bind\");\n\n    /* Receive a TCP connection. */\n\n    err = listen (listen_sd, 5);                    CHK_ERR(err, \"listen\");\n\n    client_len = sizeof(sa_cli);\n    sd = accept (listen_sd, (struct sockaddr*) &amp;sa_cli, &amp;client_len);\n    CHK_ERR(sd, \"accept\");\n    close (listen_sd);\n\n    printf (\"Connection from %lx, port %x\\n\",\n            sa_cli.sin_addr.s_addr, sa_cli.sin_port);\n\n    /* ----------------------------------------------- */\n    /* TCP connection is ready. Do server side SSL. */\n\n    ssl = SSL_new (ctx);                           CHK_NULL(ssl);\n    SSL_set_fd (ssl, sd);\n    err = SSL_accept (ssl);                        CHK_SSL(err);\n\n    /* Get the cipher - opt */\n\n    printf (\"SSL connection using %s\\n\", SSL_get_cipher (ssl));\n\n    /* Get client's certificate (note: beware of dynamic allocation) - opt */\n\n    client_cert = SSL_get_peer_certificate (ssl);\n    if (client_cert != NULL) {\n        printf (\"Client certificate:\\n\");\n\n        str = X509_NAME_oneline (X509_get_subject_name (client_cert), 0, 0);\n        CHK_NULL(str);\n        printf (\"\\t subject: %s\\n\", str);\n        OPENSSL_free (str);\n\n        str = X509_NAME_oneline (X509_get_issuer_name  (client_cert), 0, 0);\n        CHK_NULL(str);\n        printf (\"\\t issuer: %s\\n\", str);\n        OPENSSL_free (str);\n\n        /* We could do all sorts of certificate verification stuff here before\n           deallocating the certificate. */\n\n        X509_free (client_cert);\n    } else\n        printf (\"Client does not have certificate.\\n\");\n\n    /* DATA EXCHANGE - Receive message and send reply. */\n\n    err = SSL_read (ssl, buf, sizeof(buf) - 1);                   CHK_SSL(err);\n    buf[err] = '\\0';\n    printf (\"Got %d chars:'%s'\\n\", err, buf);\n\n    err = SSL_write (ssl, \"I hear you.\", strlen(\"I hear you.\"));  CHK_SSL(err);\n\n    /* Clean up. */\n\n    for(;;)\n        ;\n    close (sd);\n    SSL_free (ssl);\n    SSL_CTX_free (ctx);\n}\n/* EOF - serv.cpp */\n</code></pre>\n\n<h2>My client code</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;memory.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n\n#include &lt;openssl/crypto.h&gt;\n#include &lt;openssl/x509.h&gt;\n#include &lt;openssl/pem.h&gt;\n#include &lt;openssl/ssl.h&gt;\n#include &lt;openssl/err.h&gt;\n\n\n#define CHK_NULL(x) if ((x)==NULL) exit (1)\n#define CHK_ERR(err,s) if ((err)==-1) { perror(s); exit(1); }\n#define CHK_SSL(err) if ((err)==-1) { ERR_print_errors_fp(stderr); exit(2); }\n\nint main ()\n{\n    int err;\n    int sd;\n    struct sockaddr_in sa;\n    SSL_CTX* ctx;\n    SSL*     ssl;\n    X509*    server_cert;\n    char*    str;\n    char     buf [4096];\n    const SSL_METHOD *meth;\n\n    SSLeay_add_ssl_algorithms();\n    meth = SSLv23_client_method();\n    SSL_load_error_strings();\n    ctx = SSL_CTX_new (meth);                        CHK_NULL(ctx);\n\n    CHK_SSL(err);\n\n    /* ----------------------------------------------- */\n    /* Create a socket and connect to server using normal socket calls. */\n\n    sd = socket (AF_INET, SOCK_STREAM, 0);       CHK_ERR(sd, \"socket\");\n\n    memset (&amp;sa, '\\0', sizeof(sa));\n    sa.sin_family      = AF_INET;\n    sa.sin_addr.s_addr = inet_addr (\"127.0.0.1\");   /* Server IP */\n    sa.sin_port        = htons     (9393);          /* Server Port number */\n\n    err = connect(sd, (struct sockaddr*) &amp;sa,\n                  sizeof(sa));                   CHK_ERR(err, \"connect\");\n\n    /* ----------------------------------------------- */\n    /* Now we have TCP conncetion. Start SSL negotiation. */\n\n    ssl = SSL_new (ctx);                         CHK_NULL(ssl);\n    SSL_set_fd (ssl, sd);\n    err = SSL_connect (ssl);                     CHK_SSL(err);\n\n    /* Following two steps are optional and not required for\n       data exchange to be successful. */\n\n    /* Get the cipher - opt */\n\n    printf (\"SSL connection using %s\\n\", SSL_get_cipher (ssl));\n\n    /* Get server's certificate (note: beware of dynamic allocation) - opt */\n\n    server_cert = SSL_get_peer_certificate (ssl);       CHK_NULL(server_cert);\n    printf (\"Server certificate:\\n\");\n\n    str = X509_NAME_oneline (X509_get_subject_name (server_cert),0,0);\n    CHK_NULL(str);\n    printf (\"\\t subject: %s\\n\", str);\n    OPENSSL_free (str);\n\n    str = X509_NAME_oneline (X509_get_issuer_name  (server_cert),0,0);\n    CHK_NULL(str);\n    printf (\"\\t issuer: %s\\n\", str);\n    OPENSSL_free (str);\n\n    /* We could do all sorts of certificate verification stuff here before\n       deallocating the certificate. */\n\n    X509_free (server_cert);\n\n    /* --------------------------------------------------- */\n    /* DATA EXCHANGE - Send a message and receive a reply. */\n\n    err = SSL_write (ssl, \"Hello World!\", strlen(\"Hello World!\"));  CHK_SSL(err);\n    SSL_heartbeat(ssl);\n    err = SSL_read (ssl, buf, sizeof(buf) - 1);                     CHK_SSL(err);\n    buf[err] = '\\0';\n    printf (\"Got %d chars:'%s'\\n\", err, buf);\n    //wait\n    for(;;) ;\n\n    SSL_shutdown (ssl);  /* send SSL/TLS close_notify */\n\n    /* Clean up. */\n\n    close(sd);\n    SSL_free (ssl);\n    SSL_CTX_free (ctx);\n}\n</code></pre>\n\n<p>I see that my client is sending the TLS hearbeat but the server is not reponding to it via the wireshark capture.\n<a href=\"https://i.stack.imgur.com/JdKzr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JdKzr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I could not see examples on how to respond to a TLS heartbeat (I was naively  hoping that this is autoatically done by openssl, from a light code reading here t1_lib.c tls1_process_heartbeat,  it even seesm so).</p>\n\n<p>So can anyone please help me understand what should the server do to respond to a TLS hearbeat ?</p>\n\n<p><em>PS:Yes, I know that using TLS heartbeats is probably not a good idea (it is even removed in the later versions of OpesSSL), TCP keep alive could be a better option, but I do not have a choice in the matter at the moment.</em></p>\n\n<p>Thanks,\nKeshava.</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513760906, "post_id": 47902273, "comment_id": 82771272, "body": "Without <i>synchronization</i> between the threads you can not stop the &quot;overlap&quot;. I suggest you rethink your design so you have all output <i>and</i> input in a single thread. Otherwise console input/output will be very hard to handle."}, {"owner": {"reputation": 1, "user_id": 9121813, "user_type": "registered", "profile_image": "https://graph.facebook.com/1971467386202494/picture?type=large", "display_name": "Mohamed Abdelhakem", "link": "https://stackoverflow.com/users/9121813/mohamed-abdelhakem"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513762012, "post_id": 47902273, "comment_id": 82771948, "body": "If i want even the input to be entered on other console is that possible?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9121813, "user_type": "registered", "profile_image": "https://graph.facebook.com/1971467386202494/picture?type=large", "display_name": "Mohamed Abdelhakem", "link": "https://stackoverflow.com/users/9121813/mohamed-abdelhakem"}, "edited": false, "score": 0, "creation_date": 1513871088, "post_id": 47920448, "comment_id": 82825040, "body": "I am using  windows not linux .ide codeblocks how can i avoid multithreaing printing and scanfing overlaping each other"}, {"owner": {"reputation": 1374, "user_id": 6385870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WcPaBJ4dA7E/AAAAAAAAAAI/AAAAAAAAACU/GqGqqqVbT9E/photo.jpg?sz=128", "display_name": "the kamilz", "link": "https://stackoverflow.com/users/6385870/the-kamilz"}, "reply_to_user": {"reputation": 1, "user_id": 9121813, "user_type": "registered", "profile_image": "https://graph.facebook.com/1971467386202494/picture?type=large", "display_name": "Mohamed Abdelhakem", "link": "https://stackoverflow.com/users/9121813/mohamed-abdelhakem"}, "edited": false, "score": 0, "creation_date": 1513934356, "post_id": 47920448, "comment_id": 82846718, "body": "Usually windows steals or already stole fron xUNIX many functions, look for similar function equivalent to flockfile() then."}], "tags": [], "owner": {"reputation": 1374, "user_id": 6385870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WcPaBJ4dA7E/AAAAAAAAAAI/AAAAAAAAACU/GqGqqqVbT9E/photo.jpg?sz=128", "display_name": "the kamilz", "link": "https://stackoverflow.com/users/6385870/the-kamilz"}, "is_accepted": false, "score": 0, "last_activity_date": 1513843315, "creation_date": 1513843315, "answer_id": 47920448, "question_id": 47902273, "link": "https://stackoverflow.com/questions/47902273/multi-threading-scanf-from-thread-while-pther-thread-printf-in-c-programming/47920448#47920448", "title": "multi threading scanf from thread while pther thread printf in c programming", "body": "<p>What you need is something like this, which is in my notes taken from Linux System Programming book:</p>\n\n<p><code>Manual File Locking</code></p>\n\n<p>The function flockfile() waits until stream is no longer locked, bumps the lock count,\nand then acquires the lock, becoming the owning thread of the stream, and returns:</p>\n\n<p><code>#include &lt;stdio.h&gt;\nvoid flockfile (FILE *stream);</code></p>\n\n<p>The function funlockfile() decrements the lock count associated with stream:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid funlockfile (FILE *stream)\n\nflockfile (stream);\n\nfputs (\"List of treasure:\\n\", stream);\nfputs (\" (1) 500 gold coins\\n\", stream);\nfputs (\" (2) Wonderfully ornate dishware\\n\", stream);\n\nfunlockfile (stream);\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 9121813, "user_type": "registered", "profile_image": "https://graph.facebook.com/1971467386202494/picture?type=large", "display_name": "Mohamed Abdelhakem", "link": "https://stackoverflow.com/users/9121813/mohamed-abdelhakem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513843315, "creation_date": 1513760746, "last_edit_date": 1513760850, "question_id": 47902273, "link": "https://stackoverflow.com/questions/47902273/multi-threading-scanf-from-thread-while-pther-thread-printf-in-c-programming", "title": "multi threading scanf from thread while pther thread printf in c programming", "body": "<p>For my game project dots , i use multi threading for displaying time passed for the user but while user input\nThe cursor overlap the user input before he finish his input\nSo i want to fix a thread to the console with out affecting user input  </p>\n"}, {"tags": ["c", "file", "character", "lines", "words"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1513760465, "post_id": 47902157, "comment_id": 82771042, "body": "<code>if(ch==&#39; &#39; || ch==&#39;\\n&#39; || ch==&#39;\\t&#39;)</code> why don&#39;t you use <code>isspace(ch)</code>, too?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1513760551, "post_id": 47902157, "comment_id": 82771085, "body": "You have not initialized prevch - you should initialize it to contain a space, otherwise you have a bad count if the first character in the file <i>is</i> a space..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1513760671, "post_id": 47902157, "comment_id": 82771137, "body": "I&#39;d prefer to check <code>if(!isspace(ch))</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1513760769, "post_id": 47902157, "comment_id": 82771191, "body": "Remember: <code>fgetc()</code> returns an <code>int</code>, not a <code>char</code>.  You cannot reliably detect EOF if you use a <code>char</code>, though the nature of the problem depends on whether plain <code>char</code> is signed or unsigned and the code set in use."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1513760890, "post_id": 47902157, "comment_id": 82771263, "body": "&quot;My program shows sample file contains 65 characters, when <code>wc</code> shows 68&quot;: are you working on Windows, and does your file have just three lines?  If so, the problem is that Windows maps CRLF line endings to newlines, so 3 CRLF pairs are mapped to 3 NL-only (LF-only) endings, accounting for the discrepancy.  Open the file in binary mode."}, {"owner": {"reputation": 41, "user_id": 9039113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab796f32def21da7dc23560983215b24?s=128&d=identicon&r=PG&f=1", "display_name": "Coolerini", "link": "https://stackoverflow.com/users/9039113/coolerini"}, "edited": false, "score": 0, "creation_date": 1513761239, "post_id": 47902157, "comment_id": 82771478, "body": "Thank you all for your feedback! I&#39;ve changed the condition for isspace, so the code is better right now. You were right Jonathan - the problem was about the system I&#39;ve used! I would never think about it this way, thank you!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1513761796, "post_id": 47902157, "comment_id": 82771811, "body": "@Coolerini the CRLF line endings on WIndows vs LF line endings on Linux/Unix etc. are a very common issue."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513790365, "post_id": 47902157, "comment_id": 82790088, "body": "<code>fopen(filename, &quot;r&quot;);</code> --&gt; <code>fopen(filename, &quot;rb&quot;);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1513761754, "creation_date": 1513761754, "answer_id": 47902569, "question_id": 47902157, "link": "https://stackoverflow.com/questions/47902157/c-counting-words-characters-and-lines-in-file-character-count/47902569#47902569", "title": "C - Counting words, characters and lines in file. Character count", "body": "<blockquote>\n  <p>\"My program shows sample file contains 65 characters, when wc shows 68\"</p>\n</blockquote>\n\n<p>Are you working on Windows, and does your file have just three lines? If so, the problem is that Windows maps CRLF line endings to newlines, so 3 CRLF pairs are mapped to 3 newlines (LF-only) endings, accounting for the discrepancy. To fix this problem, open the file in binary mode.</p>\n\n<p>Without having run your code, I think your code for counting words is OK.  You could instead use an 'in-word' flag initially set to 0 (false) and switch to true and count a new word when you detect something that's not white space while you're not in a word.  Both work; they're slightly different.</p>\n\n<p>Also, remember that <code>fgetc()</code> and relatives return an <code>int</code>, not a <code>char</code>. You cannot reliably detect EOF if you save the return value in a <code>char</code>, though the nature of the problem depends on whether plain <code>char</code> is signed or unsigned and the code set in use.</p>\n\n<p>If plain <code>char</code> is an unsigned type, you can never detect EOF (because EOF is mapped to 0xFF, and when that is converted to <code>int</code> for comparison with EOF, it is positive).  If plain <code>char</code> is signed, if the input contains code 0xFF (in ISO 8859-1 and related code sets, that's \u00ff \u2014 LATIN SMALL LETTER Y WITH DIAERESIS in Unicode terminology), you detect EOF early.  However, valid UTF-8 can never contain a byte 0xFF (nor 0xC0, 0xC1, nor 0xF5..0xFF), so you shouldn't run into that misinterpretation problem \u2014 but then your code is byte counting and not character counting too.</p>\n"}, {"tags": [], "owner": {"reputation": 728, "user_id": 4628444, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S_tKKQ1s_PY/AAAAAAAAAAI/AAAAAAAAHU8/ph4sOcIgi0w/photo.jpg?sz=128", "display_name": "JoshKisb", "link": "https://stackoverflow.com/users/4628444/joshkisb"}, "is_accepted": false, "score": 1, "last_activity_date": 1513789267, "creation_date": 1513789267, "answer_id": 47911004, "question_id": 47902157, "link": "https://stackoverflow.com/questions/47902157/c-counting-words-characters-and-lines-in-file-character-count/47911004#47911004", "title": "C - Counting words, characters and lines in file. Character count", "body": "<p>You could do it like this </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\n    FILE *file;\n    char filename[256];\n    char ch;\n    char prevch = '\\0';\n\n    int lines = 0;\n    int words = 0;\n    int characters = 0;\n\n    printf(\"Enter your filename (don't forget about extension!):\\n\");\n    scanf(\"%s\", filename);\n\n    file = fopen(filename, \"r\");\n    if(file == NULL)\n    {\n        fprintf(stderr, \"Cannot open file %s \\n\", filename);\n        exit(-1);\n    }\n\n    while((ch = fgetc(file)) != EOF)\n    {\n        if(isspace(ch))\n        {\n            if (ch == '\\n')\n                lines++;\n        }else {\n            if (prevch == '\\0' || isspace(prevch)) \n                words++;\n        }\n\n        characters++;\n        prevch = ch;  \n    }\n\n    fclose(file);\n\n    printf(\"Number of characters: %d\\n\", characters);\n    printf(\"Number of words: %d\\n\", words);\n    printf(\"Number of lines: %d\\n\", lines);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9039113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab796f32def21da7dc23560983215b24?s=128&d=identicon&r=PG&f=1", "display_name": "Coolerini", "link": "https://stackoverflow.com/users/9039113/coolerini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2918, "favorite_count": 0, "accepted_answer_id": 47902569, "answer_count": 2, "score": 2, "last_activity_date": 1513789267, "creation_date": 1513760347, "last_edit_date": 1513760578, "question_id": 47902157, "link": "https://stackoverflow.com/questions/47902157/c-counting-words-characters-and-lines-in-file-character-count", "title": "C - Counting words, characters and lines in file. Character count", "body": "<p>I have to write a code in C, which outputs the number of characters, lines and words in a given file. The task seems to be simple, but I'm really not sure what went wrong at this point.</p>\n\n<p>So, here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\n    FILE *file;\n    char filename[256];\n    char ch;\n    char prevch;\n\n    int lines=0;\n    int words=0;\n    int characters=0;\n\n    printf(\"Enter your filename (don't forget about extension!):\\n\");\n    scanf(\"%s\", filename);\n\n    file=fopen(filename, \"r\");\n    if(file == NULL)\n    {\n        printf(\"Cannot open file %s \\n\", filename);\n        exit(0);\n    }\n    else\n    {\n\n        while((ch=fgetc(file))!=EOF)\n        {\n            if(ch==' ' || ch=='\\n' || ch=='\\t')\n            {\n                if(isspace(prevch)==0)\n                {\n                    words++;\n                }\n            }\n            if(ch=='\\n')\n            {\n                lines++;\n            }\n\n            prevch=ch;\n            characters++;\n        }\n    }\n\n    fclose(file);\n\n    if(isspace(prevch)==0)\n    {\n        words++;\n    } \n\n    printf(\"Number of characters: %d\\n\", characters);\n    printf(\"Number of words: %d\\n\", words);\n    printf(\"Number of lines: %d\\n\", lines);\n\n    return 0;\n}\n</code></pre>\n\n<p>The idea of the task is that the output should be the same, as the output of command wc in Linux. But I've got absolutely no idea, why my loop is skipping some of the characters. The way I've written the code should be proper to count EVERY SINGLE character, even those whitespace. Why then my program shows sample file contains 65 characters, when wc shows 68? I've thought that maybe there are some characters, which are skipped by fgetc, but it's impossible as I've used the function before when I was writing a program to copy content of one text file to another and everything worked properly.</p>\n\n<p>By the way, is my solution for word count correct? The condition after loop should make sure that last word before EOF is counted. I've used isspace to make sure that there aren't just some blank spaces in the ending.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "layout", "gtk"], "comments": [{"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1513772695, "post_id": 47902029, "comment_id": 82778754, "body": "Could you please explain what you are trying to achieve? I fail to see what kind of interface you are building and how achieving this would be useful. Could you please also explicit the version of GTK+ you are using?"}, {"owner": {"reputation": 3049, "user_id": 6150775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f16a0c1701c5debb928d96fa22ba0582?s=128&d=identicon&r=PG&f=1", "display_name": "theGtknerd", "link": "https://stackoverflow.com/users/6150775/thegtknerd"}, "edited": false, "score": 0, "creation_date": 1513774615, "post_id": 47902029, "comment_id": 82780037, "body": "I wouldn&#39;t look twice at a program that does something like this."}, {"owner": {"reputation": 99, "user_id": 9059380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c19710bf2f6da97bf39183e3ea4029?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeS", "link": "https://stackoverflow.com/users/9059380/georges"}, "edited": false, "score": 0, "creation_date": 1513775379, "post_id": 47902029, "comment_id": 82780545, "body": "The program I write will display the result of first picture, and I want to find the command to achieve the result of second picture. thanks for your comments."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 9059380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c19710bf2f6da97bf39183e3ea4029?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeS", "link": "https://stackoverflow.com/users/9059380/georges"}, "edited": false, "score": 1, "creation_date": 1513816448, "post_id": 47912986, "comment_id": 82800617, "body": "Thanks for your answer. You gave me a really important hint. I found I can simply resolve this problem by removing the widget form container, and then adding that back.       gtk_widget_ref(GTK_WIDGET(button1));     gtk_container_remove( GTK_CONTAINER(fixed), button1);     gtk_fixed_put( (GtkFixed*)fixed,button1,50,50 );"}], "tags": [], "owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "is_accepted": true, "score": 1, "last_activity_date": 1513814152, "last_edit_date": 1513814152, "creation_date": 1513797545, "answer_id": 47912986, "question_id": 47902029, "link": "https://stackoverflow.com/questions/47902029/how-to-send-gtkwidgets-to-the-back-or-front/47912986#47912986", "title": "How to send GtkWidgets to the back or front?", "body": "<p>No, there aren't \"functions\" like those in a GtkFixed.</p>\n\n<p>From the <a href=\"https://developer.gnome.org/gtk2/stable/GtkFixed.html\" rel=\"nofollow noreferrer\">Gtk 2 documentation</a>:</p>\n\n<blockquote>\n  <h2>Description</h2>\n  \n  <p>The GtkFixed widget is a container which can place child widgets at\n  fixed positions and with fixed sizes, given in pixels. GtkFixed\n  performs no automatic layout management.</p>\n  \n  <p>For most applications, you should not use this container! It keeps you\n  from having to learn about the other GTK+ containers, but it results\n  in broken applications. With GtkFixed, the following things will\n  result in truncated text, overlapping widgets, and other display bugs:</p>\n  \n  <ul>\n  <li><p>Themes, which may change widget sizes.</p></li>\n  <li><p>Fonts other than the one you used to write the app will of course change the size of widgets containing text; keep in mind that users\n  may use a larger font because of difficulty reading the default, or\n  they may be using Windows or the framebuffer port of GTK+, where\n  different fonts are available.</p></li>\n  <li><p>Translation of text into other languages changes its size. Also, display of non-English text will use a different font in many cases.</p></li>\n  </ul>\n  \n  <p>In addition, the fixed widget can't properly be mirrored in\n  right-to-left languages such as Hebrew and Arabic. i.e. normally GTK+\n  will flip the interface to put labels to the right of the thing they\n  label, but it can't do that with GtkFixed. So your application will\n  not be usable in right-to-left languages.</p>\n  \n  <p>Finally, fixed positioning makes it kind of annoying to add/remove GUI\n  elements, since you have to reposition all the other elements. This is\n  a long-term maintenance problem for your application.</p>\n  \n  <p><strong>If you know none of these things are an issue for your application,\n  and prefer the simplicity of GtkFixed, by all means use the widget.\n  But you should be aware of the tradeoffs</strong>.</p>\n</blockquote>\n\n<p>The order by which they are added is the order they will keep in the virtual Z axis. You can control this by removing and readding them or other similar approaches.</p>\n"}], "owner": {"reputation": 99, "user_id": 9059380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c19710bf2f6da97bf39183e3ea4029?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeS", "link": "https://stackoverflow.com/users/9059380/georges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 47912986, "answer_count": 1, "score": 1, "last_activity_date": 1513814152, "creation_date": 1513759900, "last_edit_date": 1513777121, "question_id": 47902029, "link": "https://stackoverflow.com/questions/47902029/how-to-send-gtkwidgets-to-the-back-or-front", "title": "How to send GtkWidgets to the back or front?", "body": "<p>I wonder if there is a way to \"Send to back\" or \"Bring to front\" a GtkWidget dynamically. ( I know, it can be done by changing the creating order of GtkWidget )</p>\n\n<p>example : (GTK+ 2.0, Cent OS 7.0, C)</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\nint main( int argc, char *argv[] )    \n{\nGtkWidget *window, *button1, *button2, *fixed;\n\ngtk_init (&amp;argc, &amp;argv);\nwindow = gtk_window_new (GTK_WINDOW_TOPLEVEL); \nbutton1 = gtk_button_new_with_label(\"A button\");\nbutton2 = gtk_button_new_with_label(\"B button\");\n\nfixed = gtk_fixed_new();\n\ngtk_fixed_put( (GtkFixed*)fixed,button2, 30, 30 );\ngtk_fixed_put( (GtkFixed*)fixed,button1, 50, 50 );\ngtk_container_add(GTK_CONTAINER(window), fixed);\n\ngtk_widget_show_all (window);\ngtk_main ();\nreturn 0;\n} \n\nthis program will display : (the first picture)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fbbdO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fbbdO.jpg\" alt=\"A Button is over B Button\"></a>\nAre there some commands that can make the \"B Button\" be in front of \"A Button\". ( look likes this following picture --> the second picture )</p>\n\n<p><a href=\"https://i.stack.imgur.com/BzKti.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BzKti.jpg\" alt=\"B Button is over A Button\"></a>  </p>\n"}, {"tags": ["c", "winapi", "reverse-engineering", "portable-executable", "trampolines"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1513760444, "post_id": 47901846, "comment_id": 82771026, "body": "Probably not possible 100%, but checking whether the memory is executable or not should be close."}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1513795203, "post_id": 47901846, "comment_id": 82792491, "body": "@DavidHeffernan: Thanks. That was my thought too. I was hoping though that there was something in the PE header itself that could tell them apart, that I overlooked."}, {"owner": {"reputation": 1075, "user_id": 5377688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpeXm.png?s=128&g=1", "display_name": "byteptr", "link": "https://stackoverflow.com/users/5377688/byteptr"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1515079314, "post_id": 47901846, "comment_id": 83171616, "body": "It should be fairly reliable to map the memory sections of each target DLL and range check your pointers against these ranges.  Global variables will likely reside in the &quot;.data&quot; section or equivalent.  Also as @DavidHeffernan pointed out, you can test these section characteristics (flags such as read/write/execute) rather than hardcoding section names.  I can&#39;t imagine compiler generated code placing exported global variables in any code section.  Quickly looking at the MSVC 10&#39;s CRT DLL, I happened to have found that _acmdln is indeed in the &quot;.data&quot; section range."}], "answers": [{"tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": false, "score": 0, "last_activity_date": 1587236056, "creation_date": 1587236056, "answer_id": 61294555, "question_id": 47901846, "link": "https://stackoverflow.com/questions/47901846/how-to-tell-apart-imported-function-vs-imported-global-variable-in-a-dlls-pe-he/61294555#61294555", "title": "How to tell apart imported function vs imported global variable in a DLL&#39;s PE header?", "body": "<p>Global variables will be in the .data section not the .text section, in addition the section will not have execute permissions if it's not a function.  Therefore you can use both of these characteristics to filter.</p>\n"}], "owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1587236056, "creation_date": 1513759165, "last_edit_date": 1513759508, "question_id": 47901846, "link": "https://stackoverflow.com/questions/47901846/how-to-tell-apart-imported-function-vs-imported-global-variable-in-a-dlls-pe-he", "title": "How to tell apart imported function vs imported global variable in a DLL&#39;s PE header?", "body": "<p>I'm writing a small tool that should be able to inspect an arbitrary process of interest and check if any of its statically linked functions were <em><a href=\"https://stackoverflow.com/questions/8089887/hot-patching-a-function\">trampolined</a></em>. (An <a href=\"https://blogs.msdn.microsoft.com/jannemattila/2009/12/03/modifying-application-behavior-with-detours-for-application-compatibility-reasons/\" rel=\"nofollow noreferrer\">example of a trampoline</a> could be what <a href=\"https://www.codeproject.com/Articles/30140/API-Hooking-with-MS-Detours\" rel=\"nofollow noreferrer\">Microsoft Detours</a> does to a process.)</p>\n\n<p>For that I parse the <a href=\"https://msdn.microsoft.com/en-us/library/ms809762.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">PE header</a> of the target process and retrieve all of its imported DLLs with all imported functions in them. Then I can compare the following between DLLs on disk and the DLLs loaded in the target process memory:</p>\n\n<p>A. Entries in the <a href=\"https://msdn.microsoft.com/en-us/library/ms809762.aspx?f=255&amp;MSPPError=-2147217396#code-snippet-15\" rel=\"nofollow noreferrer\"><code>Import Address Table</code></a> for each imported function.</p>\n\n<p>B. First N bytes of each function's machine code. </p>\n\n<p>And if any of the above do not match, this will most certainly mean that a <code>trampoline</code> was applied to a particular function (or WinAPI.)</p>\n\n<p>This works well, except of one situation when a target process can import a global variable instead of a function. For example <a href=\"https://msdn.microsoft.com/en-us/library/ff770586.aspx\" rel=\"nofollow noreferrer\"><code>_acmdln</code></a> is such global variable. You can still find it in <code>msvcrt.dll</code> and use it as such:</p>\n\n<pre><code>//I'm not sure why you'd want to do it this way,\n//but it will give you the current command line.\n//So just to prove the concept ...\nHMODULE hMod = ::GetModuleHandle(L\"msvcrt.dll\");\nchar* pVar = (char*)::GetProcAddress(hMod, \"_acmdln\");\nchar* pCmdLine = pVar ? *(char**)pVar : NULL;\n</code></pre>\n\n<p>So, what this means for my trampoline checking tool is that I need to differentiate between an imported function (WinAPI) and a global variable. Any idea how?</p>\n\n<p>PS. If I don't do that, my algorithm that I described above will compare a global variable's \"code bytes\" as if it was a function, which is just a pointer to a command line that will most certainly be different, and then flag it as a trampolined function.</p>\n\n<p>PS2. Not exactly my code, but a similar way to parse PE header can be <a href=\"http://www.ok-soft-gmbh.com/ForStackOverflow/PEInfo.c\" rel=\"nofollow noreferrer\">found here</a>. (Search for <code>DumpImports</code> function for extracting DLL imports.)</p>\n"}, {"tags": ["c", "malloc", "language-lawyer", "bounds", "dynamic-allocation"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513753515, "post_id": 47900466, "comment_id": 82767415, "body": "Good question. It&#39;s made more interesting by the fact that the memory doesn&#39;t have an effective type before you write to it."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1513753548, "post_id": 47900466, "comment_id": 82767429, "body": "@StoryTeller This is interesting because in C++ when you use <code>new</code> then it&#39;s perfectly fine."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1513753600, "post_id": 47900466, "comment_id": 82767458, "body": "Well, you tagged C. And C++&#39;s <code>new</code> is a different beast. It&#39;s more than mere memory allocation. Plus, C++ language lawyers would say that just writing to the memory returned by malloc doesn&#39;t create an object there, let alone make the memory have an effective type."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 10, "creation_date": 1513753816, "post_id": 47900466, "comment_id": 82767569, "body": "You can actually have a pointer to <i>anywhere</i>, as long as you don&#39;t dereference it. You can even use it for comparison with other pointers, even though it might make no sense."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1513753892, "post_id": 47900466, "comment_id": 82767612, "body": "@Someprogrammerdude That&#39;s too wild. Isn&#39;t that UB?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1513753901, "post_id": 47900466, "comment_id": 82767617, "body": "@Someprogrammerdude - But I don&#39;t think you can obtain that pointer to anywhere in every way. For instance, you can&#39;t do pointer arithmetic like <b>iBug</b> pointed out. That&#39;s UB by itself. You may cast an integral constant to a pointer, but there&#39;s no guarantee it would be the same address as <code>a + 6</code> for instance."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1513754289, "post_id": 47900466, "comment_id": 82767817, "body": "To late to update my comment, but it should be added that you can&#39;t dereference it <i>or use it for pointer arithmetic</i>. Doing e.g. <code>int *some_variable = (int *) 0x1234</code> is perfectly valid, and often used on small embedded system for memory mapped registers. Having a pointer to anywhere is not a problem as long as you don&#39;t attempt to do anything with it. It&#39;s <i>using</i> the pointer that can lead to UB, if it doesn&#39;t point anywhere valid."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513754418, "post_id": 47900466, "comment_id": 82767888, "body": "And to answer the question, &quot;Is it well-defined to point to one-past-malloc?&quot;, then <i>yes</i> it is valid and works just the same as for one-past an array."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513754460, "post_id": 47900466, "comment_id": 82767908, "body": "Guess that&#39;s not what I meant. Now I explicitly ask for pointer arithmetic."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1513756749, "post_id": 47900466, "comment_id": 82769046, "body": "ISO/IEC 9899:2011 &#167;7.22.3 <b>Memory management functions</b> &#182;1 <i>The order and contiguity of storage allocated by successive calls to the <code>aligned_alloc</code>, <code>calloc</code>, <code>malloc</code>, and <code>realloc</code> functions is unspecified. The pointer returned if the allocation succeeds is suitably aligned so that it may be assigned to a pointer to any type of object with a fundamental alignment requirement and then used to access such an object or an array of such objects in the space allocated (until the space is explicitly deallocated).</i> It says &quot;an array of such objects&quot;\u2014it&#39;s OK for arrays; therefore it&#39;s OK here."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513756925, "post_id": 47900466, "comment_id": 82769144, "body": "@JonathanLeffler Sounds like a valid answer. What about posting it as an answer?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513758387, "post_id": 47900466, "comment_id": 82769888, "body": "I&#39;m hoping one of the answers quoting the relevant parts of the language definition (&#167;6.x.y) will pick up on it, maybe including links to <a href=\"http://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">N1570</a> which is an online copy of a late draft of the C11 standard.  I&#39;m mildly puzzled by the reference to N4296 in one answer; the latest mailing of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/PreAlbuquerque2017.htm\" rel=\"nofollow noreferrer\">WG14 (C standard committee)</a> references document numbers in the n21xx range."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1513759167, "post_id": 47900466, "comment_id": 82770312, "body": "The only thing that makes <code>malloc</code> a special case is that the allocated data has no <i>effective type</i>. The type of the allocated data is determined upon access, as specified in 6.5/6. When writing <code>int* ptr = malloc(n*sizeof *ptr); ...ptr[0] = x;</code> you actually never get an array type, but each chunk of data accessed gets the effective type <code>int</code>. Not an array of int, but a whole bunch of individual <code>int</code>. The C standard doesn&#39;t make much sense here."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1513759329, "post_id": 47900466, "comment_id": 82770401, "body": "One more thing to note: <code>int diff</code> might be too small for the difference between the first and last element of <i>an</i> array. And <code>ptrdiff_t</code> <i>as well</i> - if that happens, behaviour is undefined."}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513766630, "post_id": 47900466, "comment_id": 82774943, "body": "@JonathanLeffler: N4296 is probably a mixup of filenames, N4296 is post-C++ 14, but the section numbers appear to be from some C draft."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1513774775, "post_id": 47900466, "comment_id": 82780163, "body": "Note that pointer subtraction like <code>p-a</code> returns a type <code>intptr_t</code> whose range can exceed <code>int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513754895, "post_id": 47900690, "comment_id": 82768111, "body": "If I write <code>p = a+6</code> then I can&#39;t expect <code>p - a == 6</code> according to the standard, right?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 3, "creation_date": 1513755201, "post_id": 47900690, "comment_id": 82768263, "body": "@iBug Yes, you cannot expect it to work. <i>&quot; If both the pointer operand and the result point to elements of the same array object, or one past the last element of the array object, the evaluation shall not produce an overflow; <b>otherwise, the behavior is undefined</b>&quot;</i>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513755702, "post_id": 47900690, "comment_id": 82768501, "body": "@iBug the standard mandated defined behaviour only up to <i>one paste the last element of the array object</i>. If you go further (2 past last element), nothing is specified by the standard which is enough to be Undefined Behaviour."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513802849, "post_id": 47900690, "comment_id": 82796084, "body": "@iBug A particular concern that your example raises is that overflows in pointer arithmetic are undefined behavior in C++.  Thus the rules basically state that malloc will never allocate the last byte of memory <i>unless</i> that compiler also simultaneously defines overflow in a way that makes these overflow issues invisible."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1513819902, "post_id": 47900690, "comment_id": 82801387, "body": "The published WG14 paper with the highest N-number is currently N2184. Where did you get N4296 from?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1514801673, "post_id": 47900690, "comment_id": 83069115, "body": "@T.C. N4296 sounds like a early draft for C++17."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 26, "last_activity_date": 1513754729, "last_edit_date": 1513754729, "creation_date": 1513754294, "answer_id": 47900690, "question_id": 47900466, "link": "https://stackoverflow.com/questions/47900466/is-it-well-defined-to-use-a-pointer-pointing-to-one-past-malloc/47900690#47900690", "title": "Is it well-defined to use a pointer pointing to one-past-malloc?", "body": "<p>The draft n4296 for C11 is explicit that pointing one past an array is perfecly defined: 6.5.6 Language / Expressions / Additive operators:</p>\n\n<blockquote>\n  <p>\u00a7 8 When an expression that has integer type is added to or subtracted from a pointer, the\n  result has the type of the pointer operand. ... Moreover, if the expression P points to the last\n  element of an array object, the expression (P)+1 points one past the last element of the\n  array object, and if the expression Q points one past the last element of an array object,\n  the expression (Q)-1 points to the last element of the array object... If the result points one past the last element of the array object, it\n  shall not be used as the operand of a unary * operator that is evaluated.</p>\n</blockquote>\n\n<p>As the type of the memory is never precised in the sub clause, it applies to any type of memory including allocated one.</p>\n\n<p>That clearly means that after:</p>\n\n<pre><code>int *a = malloc(5 * sizeof(*a));\nassert(a != NULL, \"Memory allocation failed\");\n</code></pre>\n\n<p>both </p>\n\n<pre><code>int *p = a+5;\nint diff = p-a;\n</code></pre>\n\n<p>are perfectly defined and as the usual pointer arithmetic rules apply, <code>diff</code> shall receive the value <code>5</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1513759449, "post_id": 47901374, "comment_id": 82770475, "body": "Formally, how does the data pointed at by <code>d</code> end up as an array? According to the C standard, the effective type of the malloc:ed data is that used for lvalue access. Which is <code>int</code>, not <code>int[5]</code>."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1513759759, "post_id": 47901374, "comment_id": 82770655, "body": "@Lundin; No, it doesn&#39;t. <code>d</code> is a pointer that points to the first block of the memory chunk allocated by <code>malloc</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1513762146, "post_id": 47901374, "comment_id": 82772035, "body": "The cited text only shows that allocated storage <i>can be used</i> to store arrays, not how the data <i>becomes</i> an array. Suppose I do <code>int(*ptr)[5] = malloc_chunk; memcpy(something, ptr, 5*sizeof(int);</code> Then I make the effective type an array type. But without such code, the &quot;chunk&quot; is not formally an array type. I don&#39;t think there is any text in the standard that makes sense to cite here, the rules about effective type (and strict aliasing) are simply poor."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513766428, "post_id": 47901374, "comment_id": 82774836, "body": "The word &quot;until&quot; is ambiguous (or even wrong) here: <i>It is well defined <b>until</b> the pointer pointing to one past the allocated memory.</i> According to your answer it is still true when the pointer points to one past, but &quot;until&quot; means &quot;when it happens it&#39;s no longer true&quot;, so you&#39;d better find a better wording."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513791845, "post_id": 47901374, "comment_id": 82790836, "body": "@iBug: What use of &quot;until&quot; is ambiguous or wrong?  In the Standard, it applies to the clause &quot;the space is explicitly deallocated&quot;.  Once the space is freed, pointers to it cease to be valid."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1513792868, "post_id": 47901374, "comment_id": 82791403, "body": "@Lundin: Under C89&#39;s concept of &quot;object&quot;, one could regard the result from <code>malloc</code> as returning a pointer to a union containing all possible combinations of types that could fit in the indicated storage.  There would be no need for that storage to ever &quot;become&quot; anything else.  C99&#39;s Effective Type rule is an abomination that requires completely changing the notion of what an &quot;object&quot; is in ways that can&#39;t be consistent with usages of the term elsewhere in the Standard, and invents an unnecessary new concept of runtime state.  A simpler and better rule would have simply said..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1513793489, "post_id": 47901374, "comment_id": 82791700, "body": "...that a compiler may regard two uses of an lvalue will be unsequenced relative to anything between them absent certain evidence of outside access, and that a compiler may hoist or defer accesses to the beginning/end of a function or loop if there is no evidence of outside access in the code it&#39;s moved across.  Given <code>void test(int *ip, float *fp, int mode) { *ip=1; *fp=2; if (mode) *ip=1;};</code> if <code>ip</code> and <code>fp</code> alias, the Effective Type rule would require that the Effective Type of the storage be left as either <code>int</code> or <code>float</code>, depending upon <code>mode</code>, but there&#39;s no evidence that should matter."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513814282, "post_id": 47901374, "comment_id": 82800067, "body": "@haccks Good correction. My note on the word &quot;until&quot; is somewhat a concern about English, not the C standard. It looks certainly better now."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 23, "last_activity_date": 1513900933, "last_edit_date": 1513900933, "creation_date": 1513757138, "answer_id": 47901374, "question_id": 47900466, "link": "https://stackoverflow.com/questions/47900466/is-it-well-defined-to-use-a-pointer-pointing-to-one-past-malloc/47901374#47901374", "title": "Is it well-defined to use a pointer pointing to one-past-malloc?", "body": "<blockquote>\n  <p>Is it well-defined to use a pointer pointing to one-past-malloc?</p>\n</blockquote>\n\n<p>It is well defined if <code>p</code> is pointing to one past the allocated memory and it is not dereferenced.  </p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.6p8\" rel=\"noreferrer\">n1570</a> - \u00a76.5.6 (p8):</p>\n\n<blockquote>\n  <p>[...] If the result points one past the last element of the array object, it shall not be used as the operand of a unary <code>*</code> operator that is evaluated.  </p>\n</blockquote>\n\n<p>Subtracting two pointers are valid only when they point to elements of the same array object or one past the last element of the array object, otherwise it will result in undefined behavior. </p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.6p9\" rel=\"noreferrer\">(p9)</a>:  </p>\n\n<blockquote>\n  <p>When two pointers are subtracted, both shall point to elements of the same array object, or one past the last element of the array object [...]   </p>\n</blockquote>\n\n<p>The above quotes are well applicable for both dynamically and statically allocated memory.   </p>\n\n<pre><code>int a[5];\nptrdiff_t diff = &amp;a[5] - &amp;a[0]; // Well-defined\n\nint *d = malloc(5 * sizeof(*d));\nassert(d != NULL, \"Memory allocation failed\");\ndiff = &amp;d[5] - &amp;d[0];        // Well-defined\n</code></pre>\n\n<p>Another reason that this is valid for dynamically allocated memory, as pointed by <a href=\"https://stackoverflow.com/users/15168/jonathan-leffler\">Jonathan Leffler</a> in a <a href=\"https://stackoverflow.com/questions/47900466/is-it-well-defined-to-use-a-pointer-pointing-to-one-past-malloc/47901374#comment82769888_47900466\">comment</a> is:  </p>\n\n<p>\u00a77.22.3 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.22.3p1\" rel=\"noreferrer\">(p1)</a>: </p>\n\n<blockquote>\n  <p>The order and contiguity of storage allocated by successive calls to the <code>aligned_alloc</code>, <code>calloc</code>, <code>malloc</code>, and <code>realloc</code> functions is unspecified. The pointer returned if the allocation succeeds is suitably aligned so that it may be assigned to a pointer to any type of object with a fundamental alignment requirement and then used to access such an object or <strong>an array of such objects</strong> in the space allocated (until the space is explicitly deallocated). </p>\n</blockquote>\n\n<p>The pointer returned by <code>malloc</code> in the above snippet is assigned to <code>d</code> and the memory allocated is an array of 5 <code>int</code> objects.</p>\n"}, {"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1513757767, "post_id": 47901444, "comment_id": 82769575, "body": "In <code>int* p = &amp;a[5];</code> <code>a[5]</code> is not dereferenced. It is equivalent to <code>int p = a + 5;</code> or might be I am getting that para wrong."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 4, "creation_date": 1513757828, "post_id": 47901444, "comment_id": 82769602, "body": "I&#39;m trying to say that there is no UB with the expression &amp;a[5] since the compiler must treat it as a + 5. Does it not read well? I have a cold following a weekend of implementing this: <a href=\"https://meta.stackexchange.com/questions/303920/winter-bash-2017-counting-down-page-whats-with-the-fence/303921#303921\" title=\"winter bash 2017 counting down page whats with the fence\">meta.stackexchange.com/questions/303920/&hellip;</a>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 7, "last_activity_date": 1513757975, "last_edit_date": 1513757975, "creation_date": 1513757449, "answer_id": 47901444, "question_id": 47900466, "link": "https://stackoverflow.com/questions/47900466/is-it-well-defined-to-use-a-pointer-pointing-to-one-past-malloc/47901444#47901444", "title": "Is it well-defined to use a pointer pointing to one-past-malloc?", "body": "<p>Yes, the same rules apply to variables with dynamic and automatic storage duration. It even applies to a <code>malloc</code> request for a single element (a scalar is equivalent to a one-element array in this respect).</p>\n\n<p>Pointer arithmetic is only valid within arrays, including one past the end of an array. </p>\n\n<p>On dereferencing, it's important to note one consideration: with respect to the initialisation <code>int a[5] = {0};</code>, the compiler must not attempt to <em>dereference</em> <code>a[5]</code> in the expression <code>int* p = &amp;a[5]</code>; it must compile this as <code>int* p = a + 5;</code> Again, the same thing applies to dynamic storage.</p>\n"}, {"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1513780461, "post_id": 47907001, "comment_id": 82783899, "body": "I really wonder why the standard does not necessitate the return of NULL pointer in case <code>0</code> was passed to <code>malloc()</code>. Why the standard goes through the trouble of stating: &quot;either a null pointer is returned, or the behavior is as if the size were some nonzero value&quot;.?"}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1513780883, "post_id": 47907001, "comment_id": 82784211, "body": "@machine_1 - I&#39;d guess that two alternative implementations already existed by the time the (first) standard was written."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 7, "last_activity_date": 1513776026, "creation_date": 1513776026, "answer_id": 47907001, "question_id": 47900466, "link": "https://stackoverflow.com/questions/47900466/is-it-well-defined-to-use-a-pointer-pointing-to-one-past-malloc/47907001#47907001", "title": "Is it well-defined to use a pointer pointing to one-past-malloc?", "body": "<blockquote>\n  <p>Is it well-defined to use a pointer pointing to one-past-malloc?</p>\n</blockquote>\n\n<p>Yes, yet a corner case exists where this is <strong>not</strong> well defined:</p>\n\n<pre><code>void foo(size_t n) {\n  int *a = malloc(n * sizeof *a);\n  assert(a != NULL || n == 0, \"Memory allocation failed\");\n  int *p = a+n;\n  intptr_t diff = p-a;\n  ...\n}\n</code></pre>\n\n<blockquote>\n  <p><strong>Memory management functions</strong> ... If the size of the space requested is zero, the behavior is implementation-defined: either a null pointer is returned, or the behavior is as if the size were some nonzero value, except that the returned pointer shall not be used to access an object.  C11dr \u00a77.22.3 1</p>\n</blockquote>\n\n<p><code>foo(0)</code> --> <code>malloc(0)</code> may return a <code>NULL</code> or <code>non-NULL</code>.  In the first implementation a return of <code>NULL</code> is not an \"Memory allocation failure\".\nThis means code is attempting <code>int *p = NULL + 0;</code> with <code>int *p = a+n;</code> which fails the guarantees about pointer math - or at least brings such code into question.</p>\n\n<p>Portable code benefits by avoiding 0  size allocations.</p>\n\n<pre><code>void bar(size_t n) {\n  intptr_t diff;\n  int *a;\n  int *p;\n  if (n &gt; 0) {\n    a = malloc(n * sizeof *a);\n    assert(a != NULL, \"Memory allocation failed\");\n    p = a+n;\n    diff = p-a;\n  } else {\n    a = p = NULL;\n    diff = 0;\n  }\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3766, "favorite_count": 7, "accepted_answer_id": 47901374, "answer_count": 4, "score": 47, "last_activity_date": 1514010842, "creation_date": 1513753408, "last_edit_date": 1513762455, "question_id": 47900466, "link": "https://stackoverflow.com/questions/47900466/is-it-well-defined-to-use-a-pointer-pointing-to-one-past-malloc", "title": "Is it well-defined to use a pointer pointing to one-past-malloc?", "body": "<p>In C, it is perfectly well to make a pointer that points to one past the last element of an array and use it in pointer arithmetics, as long as you don't dereference it:</p>\n\n<pre><code>int a[5], *p = a+5, diff = p-a; // Well-defined\n</code></pre>\n\n<p>However, these are UBs:</p>\n\n<pre><code>p = a+6;\nint b = *(a+5), diff = p-a; // Dereferencing and pointer arithmetic\n</code></pre>\n\n<p>Now I have a question: Does this apply to dynamically allocated memory? Assume I'm only using a pointer pointing to one-past-the-last in pointer arithmetics, without dereferencing it, and <code>malloc()</code> succeeds.</p>\n\n<pre><code>int *a = malloc(5 * sizeof(*a));\nassert(a != NULL, \"Memory allocation failed\");\n// Question:\nint *p = a+5;\nint diff = p-a; // Use in pointer arithmetic?\n</code></pre>\n"}, {"tags": ["c", "c11"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1513753084, "post_id": 47900290, "comment_id": 82767218, "body": "Unrelated to your problem, but please try to avoid making up your own type-aliases for standard types (like <code>size_t</code>). No one else but you will know about such aliases unless explicitly told about it, and if you forget then reading the code will make no sense."}], "owner": {"reputation": 883, "user_id": 3069220, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0444e7d970bd23a1a53c50c5c38c3341?s=128&d=identicon&r=PG&f=1", "display_name": "strNOcat", "link": "https://stackoverflow.com/users/3069220/strnocat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1513752997, "answer_count": 0, "score": 2, "last_activity_date": 1513752594, "creation_date": 1513752594, "question_id": 47900290, "link": "https://stackoverflow.com/questions/47900290/using-c11s-generic-to-emulate-default-value-of-argument", "closed_reason": "Duplicate", "title": "Using C11&#39;s _Generic to emulate default value of argument", "body": "<p>I have two functions with following signatures:</p>\n\n<pre><code>Memory memInitDebug (Size size, Size base);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Memory memInitRelease (Size size);\n</code></pre>\n\n<p><em>(<code>Size</code> is a typedef for <code>size_t</code>)</em></p>\n\n<p>In implementation, <code>memInitRelease</code> simply calls <code>memInitDebug</code> with the value of <code>base</code> as 0.</p>\n\n<p>Is there any way to use <code>_Generic</code> to emulate default value of arguments so that I can have a single function/macro <code>memInit</code> that selects the appropriate function based on the number of arguments?</p>\n\n<p>(Currently, I am using Clang's <code>overloadable</code> attribute to achieve this but I'd rather not use compiler extensions).</p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513752815, "post_id": 47900273, "comment_id": 82767097, "body": "Unrelated to your problem, but in the <code>List_int_add</code> function the variable <code>head</code> is of type <code>Node_int *</code>, which is the same type that the function is declared to return. That means you don&#39;t need to cast <code>head</code>, as you cast it to the type it already is. As much as possible, avoid casts. And if the compiler complains then examine the code first to see if you have made a mistake, and if you&#39;re 100% sure you haven&#39;t then you cast."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1513752956, "post_id": 47900273, "comment_id": 82767157, "body": "As for your problem, you pass the pointer <i>by value</i>. To <i>emulate</i> pass-by-reference you need to pass a pointer to the variable, which in your case is a pointer to the pointer, of type <code>Node_int **</code>. And use the address-of operator <code>&amp;</code> when passing the variable."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1513753997, "post_id": 47900273, "comment_id": 82767666, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1513757268, "post_id": 47900273, "comment_id": 82769323, "body": "If you call this function <code>void foo(int bar) {bar = 42;}</code> like this <code>int x = 0; foo(x);</code> what will be the value of <code>x</code> after the call to <code>foo</code>?"}, {"owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1514130921, "post_id": 47900273, "comment_id": 82893278, "body": "@L\u01b0uV\u0129nhPh&#250;c Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 9115965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80234c632db996adf0ffe2364ad57c1?s=128&d=identicon&r=PG&f=1", "display_name": "glamorous_noob", "link": "https://stackoverflow.com/users/9115965/glamorous-noob"}, "is_accepted": false, "score": 0, "last_activity_date": 1513760178, "creation_date": 1513760178, "answer_id": 47902103, "question_id": 47900273, "link": "https://stackoverflow.com/questions/47900273/why-didnt-the-value-of-pointer-variable-passed-to-pointer-argument-change-after/47902103#47902103", "title": "Why didn&#39;t the value of pointer variable passed to pointer argument change after exiting this function?", "body": "<p>To make sure nothing is misunderstood I'm going to state a few things that I think you already know, but it's just for the sake of the clarity of the answer.</p>\n\n<ol>\n<li>Everything in C is pass-by-value. This means that whenever an argument is given to a function, what is really given is a copy of this argument (an automatic variable having the value of the argument).</li>\n<li>To be able to modify the value of a variable <code>x</code> using a function without affecting the return value to <code>x</code> <em>(eg. <code>x=modify_x_please(x)</code>)</em>, we would pass the reference of x. This way, the function receives a copy of the address of <code>x</code>, which enables it to modify<code>x</code>directly by dereferencing it.</li>\n</ol>\n\n<p>For example :</p>\n\n<pre><code>void increment_int(int *x){\n   (*x)++;\n}\n</code></pre>\n\n<p>which will be used this way:</p>\n\n<pre><code>int x=3;\nincrement_int(&amp;x);\n/*here x is equal to 4*/\n</code></pre>\n\n<p>So all of the above you already know but let's imagine one last example:</p>\n\n<pre><code>void set_pointer_to_null(void **p){\n(*p)=NULL;\n}\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code>int * p;\np=&amp;x;\nset_pointer_to_null(&amp;p);\n/*p is NULL here*/\n</code></pre>\n\n<p>And here, it's becoming more related to your question: <strong>if you want to modify a pointer, you pass a reference to the pointer</strong>.</p>\n\n<p>This means changing your functions signature to <code>Node_int * List_int_add(Node_int ** head, int val)</code>, and using <code>(*head)</code> instead of <code>head</code> etc...</p>\n\n<p>You can even have a <code>typedef Node_int * Linked_List_int_t</code>, so the idea becomes clearer. This way you can think: <strong>If I want to modify a list, I pass the address of this list</strong>. The fact that the list is just an address to a node is a completely different matter. But I know that there are arguments against \"overusing\" typedef too, so I think you should think about the downsides of using the typedef I proposed if it interests you.</p>\n\n<p>One last thing, if the add and remove functions get the good references and modify them well, you probably won't even need to have a return. You could just make their return type void. </p>\n"}, {"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 0, "last_activity_date": 1513762403, "last_edit_date": 1513762403, "creation_date": 1513762071, "answer_id": 47902662, "question_id": 47900273, "link": "https://stackoverflow.com/questions/47900273/why-didnt-the-value-of-pointer-variable-passed-to-pointer-argument-change-after/47902662#47902662", "title": "Why didn&#39;t the value of pointer variable passed to pointer argument change after exiting this function?", "body": "<p>Your notes are not wrong, but they do not apply the linked list implementation you have shown.<br>\nAt the end of this answer (after discussion) you find a slightly changed one, for which your notes do apply.</p>\n\n<p>You observe that the output of the shown code starts with 100.  </p>\n\n<pre><code>&gt; 100\n&gt; 150\n&gt; 200\n&gt; 250\n&gt; 300\n&gt; 350\n</code></pre>\n\n<p>This is because of the <code>List_int_remove(linklist,50);</code>.<br>\nFor a discussion of why the 50 is not visible, focussing on the use of pointers as arguments, note that the starts at 50 if that line is deleted.</p>\n\n<pre><code>//linklist = List_int_remove(linklist,50);  \n\n&gt; 50\n&gt; 100\n&gt; 150\n&gt; 200\n&gt; 250\n&gt; 300\n&gt; 350\n</code></pre>\n\n<p>Deleting all but the first <code>linklist =</code> still starts at 50. </p>\n\n<pre><code>linklist = List_int_add(linklist, 50);\n/* linklist = */ List_int_add(linklist, 100);\n/* linklist = */ List_int_add(linklist, 150);\n/* linklist = */ List_int_add(linklist, 200);\n/* linklist = */ List_int_add(linklist, 250);\n/* linklist = */ List_int_add(linklist, 300);\n/* linklist = */ List_int_add(linklist, 350);\n\n\n&gt; 50\n&gt; 100\n&gt; 150\n&gt; 200\n&gt; 250\n&gt; 300\n&gt; 350\n</code></pre>\n\n<p>The first is needed because of <code>Node_int * linklist = NULL;</code> and the fact that the list does not use an unprinted dummy element as anchor. That method of implementing a linked list is what your notes apply to, see below.</p>\n\n<p>If that first one is also removed the output is empty.  </p>\n\n<p>It is possible to use a linked list according to your notes, i.e. consistently only use </p>\n\n<pre><code>List_int_add(linklist, 50)\n</code></pre>\n\n<p>without <code>linklist =</code>, if you change it to using an anchor.</p>\n\n<p>With the slightly different implementation below (changes labeled \"// Note this change!\").</p>\n\n<p>Note that I kept the return values, they are actually not needed, except for Node_int_construct(...). If the return values are strictly ignored, the use of NULL as a linklist parameter is an error condition, which I handledd simply by returning directly after an error message.<br>\nI put everything into one file, as a convenient MCVE.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#ifndef LINKEDLIST_H\n#define LINKEDLIST_H\n\ntypedef struct _node_int {\n    struct _node_int * next;\n    struct _node_int * prev;\n    int value;\n} Node_int;\n\n/* List_int_add: add Node_int at the end of list. */\nNode_int * List_int_add(Node_int * head, int val);\n\n/* List_int_remove: remove first item that matches val.\n    Returns head if successful, returns NULL if failure */\nNode_int * List_int_remove(Node_int * head, int val);\n\n/* List_int_destroy: Delete entire list. */\nvoid List_int_destroy(Node_int * head);\n\n/* List_int_search: Returns pointer to node of the first matching item in list,\n    NULL if node is not found. */\nNode_int * List_int_search(const Node_int * const head, int val);\n\n/* List_int_print: print int list. */\nvoid List_int_print(const Node_int * const head);\n\n// Note this change!\n/* Node_int_construct: create a Node_int */\n Node_int * Node_int_construct(int val);\n#endif\n\nint main(int argc, char ** argv){\n    Node_int * linklist = Node_int_construct(42); // this very first dummy gets ignored\n    /* linklist = */ List_int_add(linklist, 50);\n    /* linklist = */ List_int_add(linklist, 100);\n    /* linklist = */ List_int_add(linklist, 150);\n    /* linklist = */ List_int_add(linklist, 200);\n    /* linklist = */ List_int_add(linklist, 250);\n    /* linklist = */ List_int_add(linklist, 300);\n    /* linklist = */ List_int_add(linklist, 350);\n\n    //linklist = List_int_remove(linklist,50);\n    List_int_print(linklist);\n    List_int_destroy(linklist);\n    if (linklist == NULL)\n        List_int_print(linklist);\n    return EXIT_SUCCESS;\n}\n\n\n/* Node_int_construct: create a Node_int   */\nstatic Node_int * Node_int_construct(int val){\n    Node_int * nd = (Node_int *) malloc(sizeof(Node_int));\n    nd-&gt;next = NULL;\n    nd-&gt;prev = NULL;\n    nd-&gt;value = val;\n    return nd;\n}\n\nNode_int * List_int_add(Node_int * head, int val){\n    Node_int * nd = Node_int_construct(val);\n    // insert at the end\n    Node_int * ptr = (Node_int *) head;\n    if (ptr == NULL){\n        printf(\"Sorry, anchor implementation requires use of head = Node_int_construct(/* dummy */ 42);\\n\");\n        return (Node_int *) head;\n    }\n    while (ptr-&gt;next != NULL){\n        ptr = ptr-&gt;next;\n    }\n    nd-&gt;prev = ptr;\n    ptr-&gt;next = nd;\n    return (Node_int *) head;\n}\n\nNode_int * List_int_remove(Node_int * head, int val){\n    Node_int * target = List_int_search((const Node_int * const) head, val);\n    if (target == NULL){\n        return target;\n    }\n    if (target == head){\n        head = head-&gt;next;\n        head-&gt;prev = NULL;\n        free(target);\n    }\n    else if (target-&gt;next == NULL){\n        Node_int * ptr = target-&gt;prev;\n        ptr-&gt;next = NULL;\n        free(target);\n    }\n    else {\n        Node_int * prev = target-&gt;prev;\n        Node_int * next = target-&gt;next;\n        prev-&gt;next = next;\n        next-&gt;prev = prev;\n        free(target);\n    }\n    return head;\n}\n\nvoid List_int_destroy(Node_int * head){\n    Node_int * ptr = head; // No change, destroy inclusing anchor.\n    Node_int * temp;\n    while (ptr != NULL){\n        temp = ptr;\n        ptr = ptr-&gt;next;\n        free(temp);\n        }\n}\n\n\nNode_int * List_int_search(const Node_int * const head, int val){\n    Node_int * ptr = (Node_int *) head-&gt;next; // Note this change!\n    while (ptr != NULL){\n        if (ptr-&gt;value == val){\n            return ptr;\n        }\n        ptr = ptr-&gt;next;\n    }\n    return ptr;\n}\n\nvoid List_int_print(const Node_int * const head){\n    Node_int * ptr = (Node_int*) head-&gt;next; // Note this change!\n    while (ptr != NULL){\n        printf(\"&gt; %d \\n\", ptr-&gt;value);\n        ptr = ptr-&gt;next;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 2693271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000374315475/picture?type=large", "display_name": "Sunny Hill", "link": "https://stackoverflow.com/users/2693271/sunny-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513762403, "creation_date": 1513752515, "last_edit_date": 1513759120, "question_id": 47900273, "link": "https://stackoverflow.com/questions/47900273/why-didnt-the-value-of-pointer-variable-passed-to-pointer-argument-change-after", "title": "Why didn&#39;t the value of pointer variable passed to pointer argument change after exiting this function?", "body": "<p>According to my current knowledge of how C works, if I use the function <code>List_int_add(linklist, 50)</code> in this way without having to assign <code>linklist = List_int_add(linklist, 50)</code>, the value of linklist would've been updated to the return value of <code>List_int_add(linklist, 50)</code>, since in place of <code>linklist</code> is the argument <code>Node_int * head</code>, and the function returns <code>head</code>. Since the argument is a pointer, shouldn't <code>List_int_add(linklist, 50)</code> be sufficient to update <code>linklist</code>? </p>\n\n<p>When using <code>List_int_add(linklist, 50)</code>, the output of <code>List_int_print(linklist)</code> would start at 100, and not 50. But it works fine if I assign to <code>linklist=List_int_add(linklist, 50)</code>.</p>\n\n<p>(please ignore the typecasting at return, it is due to how I write the code previously, and I am in the midst of editing the code, I know it's not necessary)</p>\n\n<p>Thanks in advance.</p>\n\n<p>In main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"LinkedList/linkedlist.h\"\nint main(int argc, char ** argv){\n    Node_int * linklist = NULL;\n    linklist = List_int_add(linklist, 50);\n    linklist = List_int_add(linklist, 100);\n    linklist = List_int_add(linklist, 150);\n    linklist = List_int_add(linklist, 200);\n    linklist = List_int_add(linklist, 250);\n    linklist = List_int_add(linklist, 300);\n    linklist = List_int_add(linklist, 350);\n\n    linklist = List_int_remove(linklist,50);\n    List_int_print(linklist);\n    List_int_destroy(linklist);\n    if (linklist == NULL)\n        List_int_print(linklist);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>In linkedlist.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdarg.h&gt; \n#include &lt;stdlib.h&gt;\n#include \"linkedlist.h\"\n\n/* Node_int_construct: create a Node_int */ \nstatic Node_int * Node_int_construct(int val); \n\n/* Node_int_construct: create a Node_int   */ \nstatic Node_int * Node_int_construct(int val){\n    Node_int * nd = (Node_int *) malloc(sizeof(Node_int));\n    nd-&gt;next = NULL; \n    nd-&gt;prev = NULL;\n    nd-&gt;value = val; \n    return nd;\n}\n\nNode_int * List_int_add(Node_int * head, int val){\n    Node_int * nd = Node_int_construct(val);\n    // insert at the end\n    Node_int * ptr = (Node_int *) head;\n    if (ptr == NULL){\n        head = nd; \n        head -&gt; next = NULL;\n        head -&gt; prev = NULL; \n        return (Node_int *) head; \n    }\n    while (ptr-&gt;next != NULL){\n        ptr = ptr-&gt;next; \n    }\n    nd-&gt;prev = ptr; \n    ptr-&gt;next = nd;\n    return (Node_int *) head;  \n}\n\nNode_int * List_int_remove(Node_int * head, int val){\n    Node_int * target = List_int_search((const Node_int * const) head, val);\n    if (target == NULL){\n        return target; \n    }\n    if (target == head){\n        head = head-&gt;next; \n        head-&gt;prev = NULL; \n        free(target);\n    } \n    else if (target-&gt;next == NULL){\n        Node_int * ptr = target-&gt;prev; \n        ptr-&gt;next = NULL;\n        free(target); \n    }\n    else {\n        Node_int * prev = target-&gt;prev;\n        Node_int * next = target-&gt;next;\n        prev-&gt;next = next; \n        next-&gt;prev = prev; \n        free(target);\n    }\n    return head; \n}\n\nvoid List_int_destroy(Node_int * head){\n    Node_int * ptr = head;\n    Node_int * temp; \n    while (ptr != NULL){\n        temp = ptr; \n        ptr = ptr-&gt;next;\n        free(temp); \n        }\n}\n\n\nNode_int * List_int_search(const Node_int * const head, int val){\n    Node_int * ptr = (Node_int *) head;\n    while (ptr != NULL){\n        if (ptr-&gt;value == val){\n            return ptr; \n        }\n        ptr = ptr-&gt;next;\n    }\n    return ptr; \n}\n\nvoid List_int_print(const Node_int * const head){\n    Node_int * ptr = (Node_int*) head;\n    while (ptr != NULL){\n        printf(\"&gt; %d \\n\", ptr-&gt;value); \n        ptr = ptr-&gt;next;\n    } \n}\n</code></pre>\n\n<p>in linkedlist.h:</p>\n\n<pre><code>#ifndef LINKEDLIST_H\n#define LINKEDLIST_H\n\ntypedef struct _node_int {\n    struct _node_int * next;\n    struct _node_int * prev;\n    int value;  \n} Node_int; \n\n/* List_int_add: add Node_int at the end of list. */ \nNode_int * List_int_add(Node_int * head, int val);\n\n/* List_int_remove: remove first item that matches val.\n    Returns head if successful, returns NULL if failure */\nNode_int * List_int_remove(Node_int * head, int val); \n\n/* List_int_destroy: Delete entire list. */\nvoid List_int_destroy(Node_int * head);\n\n/* List_int_search: Returns pointer to node of the first matching item in list,\n    NULL if node is not found. */ \nNode_int * List_int_search(const Node_int * const head, int val);\n\n/* List_int_print: print int list. */\nvoid List_int_print(const Node_int * const head);\n#endif\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 2, "creation_date": 1513752367, "post_id": 47900153, "comment_id": 82766922, "body": "Except different environments may have a different idea of what constitutes a floating point number. Case in point, c++ compilers are perfectly happy with the following: <code>const float myVal = 3.f;</code> Is there anything wrong with using <code>sscanf</code>?"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1513752376, "post_id": 47900153, "comment_id": 82766926, "body": "<a href=\"https://stackoverflow.com/questions/5250733/what-are-the-advantages-and-disadvantages-of-recursion\">recursive function</a> calls more keen to stack overflow."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 3, "creation_date": 1513753478, "post_id": 47900153, "comment_id": 82767395, "body": "<code>0x2a.bcp4</code>, <code>-2.21l</code>, <code>3.0e4L</code>, <code>3e-4</code> are also examples of valid floating-point literals in C"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 1, "creation_date": 1513754172, "post_id": 47900153, "comment_id": 82767748, "body": "@enhzflep: <code>sscanf</code> (really, any C library function that parses numbers) is locale-aware and locale is process-wide and not thread-safe (so you cannot just switch to C for a moment and then switch it back), so the only way to parse data in a locale-independent way (e.g. to parse JSON) is to do the job yourself. This is IMO one of the saddest design mistakes of the C standard library, since unlike many others there&#39;s no trivial workaround."}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1513754635, "post_id": 47900153, "comment_id": 82767995, "body": "@MatteoItalia - magic! Thank-you for such an articulate and helpful reply. I so rarely step back into C these days, and when I do it&#39;s for personal micro-controller projects."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513762690, "post_id": 47900153, "comment_id": 82772358, "body": "You could use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strtod.html\" rel=\"nofollow noreferrer\"><code>strtod()</code></a> to do the conversion.  It tells you where it stopped converting, so you could decide whether the trailing debris after a number is acceptable.  OTOH, it skips leading white space; if you don&#39;t want to accept that, you have to detect it before calling <code>strtod()</code> \u2014 which isn&#39;t hard but simply needs to be considered as an issue, if it is an issue."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1513766898, "post_id": 47900153, "comment_id": 82775110, "body": "I have never seen a more complicated way of checking for a valid float. Unless you are entering an obfuscated C contest, this is a fail!"}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1513753841, "post_id": 47900397, "comment_id": 82767581, "body": "Worth noting that OP solution is actually tail recursive. While it&#39;s true that it&#39;s not strictly guaranteed, I expect that any compiler worth using will transform the call into a jump."}, {"owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1513754645, "post_id": 47900397, "comment_id": 82767998, "body": "@MatteoItalia true (not doing something with the result), but it looks almost as not being tail recursive, and uncertain compiler behaviour should at least ring an alarm bell for a stack overflow. However I would love to see an answer from someone with the generated code, LLVM maybe. (Not pressing you - I have no time too.)"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1513754963, "post_id": 47900397, "comment_id": 82768141, "body": "Of course, in facts it was mostly a technicality; also, the most obvious counterargument against OP&#39;s solution is what you said in your answer - the iterative solution in this case is way easier to read. For the code, I tried to provide it using the great gcc.godbolt.org, but unfortunately pasting code there from mobile is seriously broken. I&#39;ll add it in 15 minutes, just the time to get to a real computer."}, {"owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1513755491, "post_id": 47900397, "comment_id": 82768399, "body": "@MatteoItalia Thanks a lot. As recursion is such a nice thing, I would not see it condemned unecessarily."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1513756463, "post_id": 47900397, "comment_id": 82768911, "body": "... and here it is - <a href=\"https://godbolt.org/g/MHxEDZ\" rel=\"nofollow noreferrer\">godbolt.org/g/MHxEDZ</a> . There&#39;s no <code>call</code>, only straight <code>jmp</code>s to the start of the function."}, {"owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1513765375, "post_id": 47900397, "comment_id": 82774158, "body": "@MatteoItalia much appreciated."}, {"owner": {"reputation": 65, "user_id": 6139935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61806403677bcccdfc538b1f7bf315e9?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Nguyen", "link": "https://stackoverflow.com/users/6139935/anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1514056475, "post_id": 47900397, "comment_id": 82879901, "body": "Thank you guys. Indeed it was the readability that concerned me a lot too, as I hate unreadable code and assumed no one would actually try to read mine, and after learning the idea of recursion I don&#39;t see the simplest solutions sometimes. I learned quite a bit from this answer and the comments on it, thank you. Also instead of int I could just use bool I guess."}], "tags": [], "owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "is_accepted": true, "score": 4, "last_activity_date": 1513765751, "last_edit_date": 1513765751, "creation_date": 1513753117, "answer_id": 47900397, "question_id": 47900153, "link": "https://stackoverflow.com/questions/47900153/is-this-a-bad-way-to-check-if-a-string-represents-a-floating-point-number/47900397#47900397", "title": "Is this a bad way to check if a string represents a floating point number?", "body": "<p>For 999 digits and one point, there are 1000 recursive calls with each return address, and three parameters on the stack. I would find that okay. However a non-recursive iterative solution does away with the state parameters, and is easier to read (in this case only).</p>\n\n<pre><code>bool isFloatString(char *s)\n{\n    int pointCounter = 0;\n    bool digitAfterPoint = false;\n    while (*s != '\\0')\n    {\n        if (isdigit(*s))\n            digitAfterPoint = pointCounter == 1;\n        }\n        else if (*s == '.' &amp;&amp; pointCounter == 0)\n        {\n            ++pointCounter;\n        }\n        else\n        {\n            return false;\n        }\n        ++s;\n    }\n    return digitAfterPoint;\n}\n</code></pre>\n\n<p>Mind: the recursive solution is subject to a malicious stack overflow.</p>\n\n<hr>\n\n<p>@MatteoItalia rightly indicated that there is only tail recursion (nothing is done with the result), so any mature C/C++ compiler would transform the recursion to jumps (iteration). Here his disassembly (see link in comment too).</p>\n\n<pre><code>isFloatString(char*, int, bool):\n  movsx ecx, BYTE PTR [rdi]\n  mov r9d, edx\n  mov r8d, ecx\n  sub ecx, 48\n  cmp ecx, 9\n  jbe .L23\n  cmp r8b, 46\n  je .L24\n  test r8b, r8b\n  sete al\n  and eax, edx\n  ret\n.L24:\n  xor eax, eax\n  test esi, esi\n  je .L25\n.L1:\n  rep ret\n.L23:\n  movsx eax, BYTE PTR [rdi+1]\n  mov ecx, eax\n  sub eax, 48\n  cmp esi, 1\n  je .L26\n  cmp eax, 9\n  movzx edx, dl\n  jbe .L10\n  cmp cl, 46\n  je .L27\n.L8:\n  test cl, cl\n  sete al\n  and eax, r9d\n  ret\n.L26:\n  cmp eax, 9\n  jbe .L28\n  xor eax, eax\n  cmp cl, 46\n  mov r9d, 1\n  jne .L8\n  jmp .L1\n.L28:\n  mov edx, 1\n.L10:\n  add rdi, 2\n  jmp isFloatString(char*, int, bool)\n.L25:\n  movzx edx, dl\n  add rdi, 1\n  mov esi, 1\n  jmp isFloatString(char*, int, bool)\n.L27:\n  xor eax, eax\n  test esi, esi\n  jne .L1\n  add rdi, 2\n  mov esi, 1\n  jmp isFloatString(char*, int, bool)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1513793259, "post_id": 47911626, "comment_id": 82791585, "body": "This is all fine until QApplication (or anybody else, really) did a <code>setlocale(&quot;&quot;, LC_ALL)</code> and that now <code>strtod</code> expects <code>, </code> as decimal separator. Now you can no longer use this code to parse e.g. JSON."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1513793967, "post_id": 47911626, "comment_id": 82791928, "body": "@MatteoItalia Perhaps.  OP&#39;s <code>*s == &#39;.&#39;</code> implies a required <code>&#39;,&#39;</code>, in which case the locale should be insured for a matching <code>&#39;.&#39;</code>.  OP&#39;s may be interested in a locale adjusting code, in which case, the <code>strtof()</code> meets that.  The is much left unspecified in OP&#39;s top level goal.     BTW I think you meant <code>setlocale(LC_ALL, &quot;&quot;)</code>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1513791745, "creation_date": 1513791745, "answer_id": 47911626, "question_id": 47900153, "link": "https://stackoverflow.com/questions/47900153/is-this-a-bad-way-to-check-if-a-string-represents-a-floating-point-number/47911626#47911626", "title": "Is this a bad way to check if a string represents a floating point number?", "body": "<blockquote>\n  <p>check if a string represents a floating point number?</p>\n</blockquote>\n\n<p>The C standard library provides a simple robust solution using <code>strtof()</code>, <code>strtod()</code>, or <code>strtold()</code></p>\n\n<pre><code>// leading whitespace OK, trailing text OK, over/underflow OK\nbool isFloatString_Simple(const char *s) {\n  char *endptr;\n  strtof(s, &amp;endptr);\n  return endptr &gt; s;\n}\n</code></pre>\n\n<p>Are leading spaces are OK?<br>\nIs trailing junk after the numeric text OK?<br>\nIf overflow a concern?<br>\nIf underflow a concern?</p>\n\n<p>Then more code is needed.  Adjust as needed.</p>\n\n<pre><code>bool isFloatString_Picky(const char *s) {\n  char *endptr;\n  errno = 0;\n  float f = strtof(s, &amp;endptr);\n  if (s == endptr) return false; // no conversion\n\n  if (isspace((unsigned char) *s)) return false; // reject leading white-space\n  if (*endptr) return false; // reject junk after numeric text\n\n  if (errno) {\n    if (fabsf(f) &gt; 1.0f) return false; // reject on overflow\n    // yet pass on underflow.\n  }\n  return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6139935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61806403677bcccdfc538b1f7bf315e9?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Nguyen", "link": "https://stackoverflow.com/users/6139935/anh-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 47900397, "answer_count": 2, "score": 5, "last_activity_date": 1513791745, "creation_date": 1513752005, "question_id": 47900153, "link": "https://stackoverflow.com/questions/47900153/is-this-a-bad-way-to-check-if-a-string-represents-a-floating-point-number", "title": "Is this a bad way to check if a string represents a floating point number?", "body": "<p>Looking around online I didn't find a solution that satisfied me, so I tried it myself. But now in a lecture it was also said that calling functions and waiting for returns might cause the stack to overflow, so is this a bad idea? I use this function to check whether argv[1] is a float or not. Would a loop be better? or is there something way more intuitive? there must be exactly one point and it has to be followed by atleast one digit right?</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;ctype.h&gt;\n\n /**\n * checks if string is floating point number\n * please call function with pointCounter=0 and digitAfterPoint=false\n */\nbool isFloatString(char *s, int pointCounter, bool digitAfterPoint) \n{                                                                   \n\n    if (isdigit(*s))\n    {\n        if(pointCounter==1)\n        {\n            digitAfterPoint=true;\n        }\n        return  isFloatString(s+1, pointCounter, digitAfterPoint);\n    }\n\n    else if (*s == '.' &amp;&amp; pointCounter==0)\n    {\n        return isFloatString(s+1, pointCounter+1,digitAfterPoint);\n    }\n    else if (*s == '\\0' &amp;&amp; digitAfterPoint)\n    {\n        return true;\n    }\n    else\n    {\n        return false;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["objective-c", "c", "cocoa", "selector"], "comments": [{"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1513751990, "post_id": 47899877, "comment_id": 82766751, "body": "correct me if i understood wrong. You want to pass pure C function ?? in your code snippet no C function shown. can you modify you query little more code ??"}], "answers": [{"comments": [{"owner": {"reputation": 160387, "user_id": 25646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb7953f53aa7715c72054c3d54e7b48?s=128&d=identicon&r=PG", "display_name": "bbum", "link": "https://stackoverflow.com/users/25646/bbum"}, "edited": false, "score": 1, "creation_date": 1513786715, "post_id": 47903242, "comment_id": 82788095, "body": "You can also use imp_implementationWithBlock().  It makes it easy to wrap a c function in a block that can be plugged in as a method in the runtime."}, {"owner": {"reputation": 50374, "user_id": 568283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120ceee2dc40d539b9983265a2e0a2f8?s=128&d=identicon&r=PG", "display_name": "CRD", "link": "https://stackoverflow.com/users/568283/crd"}, "reply_to_user": {"reputation": 160387, "user_id": 25646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb7953f53aa7715c72054c3d54e7b48?s=128&d=identicon&r=PG", "display_name": "bbum", "link": "https://stackoverflow.com/users/25646/bbum"}, "edited": false, "score": 2, "creation_date": 1513795513, "post_id": 47903242, "comment_id": 82792636, "body": "@bbum - Duh, forgot that one. Edited the answer to include it as an option. Thanks."}, {"owner": {"reputation": 409, "user_id": 5548305, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1e93b750e3c2713746447a1780d1c821?s=128&d=identicon&r=PG&f=1", "display_name": "JLegendre", "link": "https://stackoverflow.com/users/5548305/jlegendre"}, "edited": false, "score": 0, "creation_date": 1513807319, "post_id": 47903242, "comment_id": 82797973, "body": "This is great! Thank you for the resources!"}], "tags": [], "owner": {"reputation": 50374, "user_id": 568283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120ceee2dc40d539b9983265a2e0a2f8?s=128&d=identicon&r=PG", "display_name": "CRD", "link": "https://stackoverflow.com/users/568283/crd"}, "is_accepted": true, "score": 2, "last_activity_date": 1513795458, "last_edit_date": 1513795458, "creation_date": 1513763829, "answer_id": 47903242, "question_id": 47899877, "link": "https://stackoverflow.com/questions/47899877/assign-selector-to-c-function-in-objective-c-without-callback/47903242#47903242", "title": "Assign selector to C function in Objective-C without callback", "body": "<p>You can't swizzle a C function <em>per se</em>; swizzling is based on method lookup which goes through method descriptions (which are represented by the <code>Method</code> type by the runtime functions) and C functions do not have a method description.</p>\n\n<p>However the implementation of a method is just a C function. Such a C function must take a minimum of two arguments, being the object the method is invoked on (the Objective-C implicit parameter <code>self</code>) and the selector (the Objective-C implicit parameter <code>_cmd</code>). When you swizzle a method the replacement implementation, a C function, must have exactly the same type as the original \u2013 complete with the two implicit arguments \u2013 so your <code>strRet()</code> would not be suitable as is, you would need to change it to:</p>\n\n<pre><code>CFStringRef strRet(NSObject *self, CMD sel, void)\n{\n   return CFSTR(\"retString\");\n}\n</code></pre>\n\n<p>So you have three main choices:</p>\n\n<ol>\n<li><p>The easiest way is to define a method whose body is your \"pure\" C function, then swizzle the recommended way (taking care to handle inheritance correctly, see <a href=\"https://stackoverflow.com/questions/34502215/proper-way-of-method-swizzling-in-objective-c/34503380#34503380\">this answer</a>).</p></li>\n<li><p>If you really want to write a C function and that C function <strong>does not</strong> need to call the original implementation of the method then:</p>\n\n<p>(a) You need to convert your C function into one which can be used as a method implementation. You can:</p>\n\n<ul>\n<li>If you are writing/have the source of the C function you simply define it to take the two implicit arguments as above. Take the address of this function and cast it to <code>IMP</code>, which is just a <code>typedef</code> for a C function pointer of the appropriate type, for use below.</li>\n<li>If you are using a C function whose definition you cannot change then you can do one of:\n\n<ul>\n<li>Write a C wrapper function which takes the extra arguments, ignores them and calls your target C function. Take the address of this wrapper function and cast it to <code>IMP</code> for use below.</li>\n<li>Wrap the call to your C function in a <em>block</em> and use <a href=\"https://developer.apple.com/documentation/objectivec/objective_c_runtime\" rel=\"nofollow noreferrer\"><code>imp_implementationWithBlock()</code></a> to produce an <code>IMP</code> value from it. You can read <a href=\"http://www.friday.com/bbum/2011/03/17/ios-4-3-imp_implementationwithblock/\" rel=\"nofollow noreferrer\">this article</a> for a description of using <code>imp_implementationWithBlock()</code>.</li>\n</ul></li>\n</ul>\n\n<p>(b) use <code>method_setImplementation()</code> to set the implementation to the <code>IMP</code> value you produced in (a).</p></li>\n<li><p>If you really want to write a C function and that C function <strong>does</strong> need to call the original implementation of the method then you will need to add a method to your class whose implementation is your C function \u2013\u00a0modified/wrapped as in (2), then swizzle your added method with your original method as under (1) so that the original implementation is still available as a method. To add a method you use <code>class_addMethod()</code></p></li>\n</ol>\n\n<p>HTH</p>\n"}, {"tags": [], "owner": {"reputation": 1194, "user_id": 542244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yjUTk.png?s=128&g=1", "display_name": "jjrscott", "link": "https://stackoverflow.com/users/542244/jjrscott"}, "is_accepted": false, "score": 2, "last_activity_date": 1513819689, "creation_date": 1513819689, "answer_id": 47916652, "question_id": 47899877, "link": "https://stackoverflow.com/questions/47899877/assign-selector-to-c-function-in-objective-c-without-callback/47916652#47916652", "title": "Assign selector to C function in Objective-C without callback", "body": "<p>The key here is finding a mechanism that maps between the function pointer and your context. The simplest way to do that is by generating a new function pointer. You can use imp_implementationWithBlock(), <a href=\"https://github.com/mikeash/MABlockClosure\" rel=\"nofollow noreferrer\">MABlockClosure</a>, or roll your own.</p>\n\n<p>The simplest mechanism to create a new function pointer I've found is to remap the entire function to a new address space. The new resulting address can be used as a key to the required data.</p>\n\n<pre><code>#import &lt;mach/mach_init.h&gt;\n#import &lt;mach/vm_map.h&gt;\n\nvoid *remap_address(void* address, int page_count)\n{\n    vm_address_t source_address = (vm_address_t) address;\n    vm_address_t source_page = source_address &amp; ~PAGE_MASK;\n\n    vm_address_t destination_page = 0;\n    vm_prot_t cur_prot;\n    vm_prot_t max_prot;\n    kern_return_t status = vm_remap(mach_task_self(),\n                                &amp;destination_page,\n                                PAGE_SIZE*(page_count ? page_count : 4),\n                                0,\n                                VM_FLAGS_ANYWHERE,\n                                mach_task_self(),\n                                source_page,\n                                FALSE,\n                                &amp;cur_prot,\n                                &amp;max_prot,\n                                VM_INHERIT_NONE);\n\n    if (status != KERN_SUCCESS)\n    {\n        return NULL;\n    }\n\n    vm_address_t destination_address = destination_page | (source_address &amp; PAGE_MASK);\n\n    return (void*) destination_address;\n}\n</code></pre>\n\n<p>Note that <code>page_count</code> should be large enough to contain all of your original function. Also, remember to handle pages that aren't required anymore and note that it takes a lot more memory per invocation than <a href=\"https://github.com/mikeash/MABlockClosure\" rel=\"nofollow noreferrer\">MABlockClosure</a>.</p>\n\n<p>(Tested on iOS)</p>\n"}], "owner": {"reputation": 409, "user_id": 5548305, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1e93b750e3c2713746447a1780d1c821?s=128&d=identicon&r=PG&f=1", "display_name": "JLegendre", "link": "https://stackoverflow.com/users/5548305/jlegendre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 47903242, "answer_count": 2, "score": 1, "last_activity_date": 1513819689, "creation_date": 1513750790, "question_id": 47899877, "link": "https://stackoverflow.com/questions/47899877/assign-selector-to-c-function-in-objective-c-without-callback", "title": "Assign selector to C function in Objective-C without callback", "body": "<p>I am attempting a method swizzle in Obj-C but I would like to pass it a pure C function.  This means I need to somehow assign a selector and/or manually build an <code>objc_method</code> struct. Maybe somehow leverage <code>NSInvocation</code>?</p>\n\n<p>My understanding is that due to the fact that Obj-C is a strict superset of C and therefor fully compatible. </p>\n\n<p>What I have going now:</p>\n\n<p>main.m : </p>\n\n<pre><code>#include....\n\nCFStringRef strRet(void) {\n    return CFSTR(\"retString\");\n}\n\nint main(int argc, const char * argv[]) {\n    @autoreleasepool {\n        SEL _strRet = sel_registerName(\"strRet\");\n        //I also tried: SEL _strRet = NSSelectorFromString(@\"strRet\");\n\n        Class bundle = objc_getClass(\"NSBundle\");\n\n        method_exchangeImplementations(\n            class_getInstanceMethod(bundle, sel_registerName(\"anySelector\")), \n            class_getInstanceMethod(bundle, sel_registerName(\"_strRet\")\n        );\n</code></pre>\n\n<p>I have tried putting the C function inside <code>@implementation</code> (which I would like to avoid) and even then it did not work.  </p>\n"}, {"tags": ["python", "c++", "c", "perforce"], "comments": [{"owner": {"reputation": 5818, "user_id": 978558, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d023acf70b927cb813b48631195e346e?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/978558/fredrik"}, "edited": false, "score": 0, "creation_date": 1513749817, "post_id": 47899386, "comment_id": 82765922, "body": "Afaik perforce can&#39;t do that for you. Fetch both versions and diff them should work though."}, {"owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1513754476, "post_id": 47899386, "comment_id": 82767922, "body": "You may have to actually &quot;parse&quot; (I use the term relatively loosely) the source file to do that. Get the whole source file, scan backwards from the diff-point until you find the function declaration. Coding style will probably help you here, so you may be able to identify a function from &quot;it&#39;s starting at column 1 and has parenthesis&quot;, for example."}, {"owner": {"reputation": 90, "user_id": 1517237, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0241be599ab10fc752552ec28ebaf049?s=128&d=identicon&r=PG", "display_name": "Abhishek Bajaj", "link": "https://stackoverflow.com/users/1517237/abhishek-bajaj"}, "reply_to_user": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1516355144, "post_id": 47899386, "comment_id": 83661379, "body": "@Mats Petersson, Thank you. By the above way I am able to parse and extract Function changed."}], "answers": [{"tags": [], "owner": {"reputation": 31669, "user_id": 3799759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5820aa24337a2f622b78e92c39e3e3d6?s=128&d=identicon&r=PG", "display_name": "Samwise", "link": "https://stackoverflow.com/users/3799759/samwise"}, "is_accepted": false, "score": 0, "last_activity_date": 1513759532, "creation_date": 1513759532, "answer_id": 47901936, "question_id": 47899386, "link": "https://stackoverflow.com/questions/47899386/how-to-get-c-c-function-name-from-perforce-diff-between-two-version/47901936#47901936", "title": "How to get C/C++ function name from Perforce diff between two version", "body": "<p>Do <code>p4 diff2</code> and grep with a regex that matches function names:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/476173/regex-to-pull-out-c-function-prototype-declarations\">Regex to pull out C function prototype declarations?</a></p>\n"}], "owner": {"reputation": 90, "user_id": 1517237, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0241be599ab10fc752552ec28ebaf049?s=128&d=identicon&r=PG", "display_name": "Abhishek Bajaj", "link": "https://stackoverflow.com/users/1517237/abhishek-bajaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513759532, "creation_date": 1513747987, "last_edit_date": 1513749179, "question_id": 47899386, "link": "https://stackoverflow.com/questions/47899386/how-to-get-c-c-function-name-from-perforce-diff-between-two-version", "title": "How to get C/C++ function name from Perforce diff between two version", "body": "<p>I am trying to extract diff between to perforce revision files. But my requirement is to extract function names which got modified. Is there a way to find changed functions.</p>\n"}, {"tags": ["c", "debugging"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "edited": false, "score": 0, "creation_date": 1513751973, "post_id": 47899435, "comment_id": 82766742, "body": "thanks yes i saw that but im still getting this error:  expected &#39;=&#39;, &#39;,&#39;, &#39;;&#39;,&#39;asm&#39; or &#39;attribute&#39; before token &#39;*&#39; in the line where I declare my static function newTN.  also i edited the double pointer out shortly after posting."}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "edited": false, "score": 0, "creation_date": 1513752842, "post_id": 47899435, "comment_id": 82767112, "body": "@GCGSAUCE Definition of <code>struct textbuffer</code> is not terminating with <code>;</code>. I have updated the answer for the same."}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": true, "score": 0, "last_activity_date": 1513752803, "last_edit_date": 1513752803, "creation_date": 1513748306, "answer_id": 47899435, "question_id": 47899371, "link": "https://stackoverflow.com/questions/47899371/incompatible-pointer-type-errors-when-adding-to-user-defined-type/47899435#47899435", "title": "incompatible pointer type errors when adding * to user defined type", "body": "<p>In definition of <code>typedef struct textNode</code> you have declared <code>struct textNode** next</code> i.e. <code>next</code> is <code>pointer-to-pointes</code> or <code>double pointer</code>. But in function <code>static tNode* newTN(char* string, int sLength, tNode* next);</code> you have declared <code>next</code> as <code>single-pointer</code>.</p>\n\n<p>So, in line <code>t-&gt;next = next;</code> of function <code>static tNode* newTN(char* string, int sLength, tNode* next);</code> you can not assign <code>single-pointer</code> to <code>double pointer</code>. </p>\n\n<p>To solve this issue, declared <code>struct textNode** next</code> in <code>typedef struct textNode</code> as <code>struct textNode* next</code> i.e. as <code>single-pointer</code>.</p>\n\n<p><strong>Updated:</strong><br>\nDefinition of <code>struct textbuffer</code> is not terminating with <code>;</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 8107789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dff76b4d2f7be9cd22c5425653b280ec?s=128&d=identicon&r=PG&f=1", "display_name": "GCGSAUCE", "link": "https://stackoverflow.com/users/8107789/gcgsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 47899435, "answer_count": 1, "score": -1, "last_activity_date": 1513756309, "creation_date": 1513747884, "last_edit_date": 1513756309, "question_id": 47899371, "link": "https://stackoverflow.com/questions/47899371/incompatible-pointer-type-errors-when-adding-to-user-defined-type", "title": "incompatible pointer type errors when adding * to user defined type", "body": "<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n#include \"textbuffer.h\"\n\ntypedef struct textNode{ //basically contains a line + link\n    char* line;\n    int sLength; //length of string\n    struct textNode* next; \n} tNode; \n\nstruct textbuffer{\n    int size; //number of lines in the text buffer\n    tNode* head; \n    tNode* tail;\n}\n\nstatic tNode* newTN(char* string, int sLength, tNode* next);\n\nstatic tNode* newTN(char* string, int sLength, tNode* next){\n    tNode* t = malloc(sizeof(struct textNode));\n    t-&gt;line = malloc(sizeof(char)*sLength);\n\n    if(string != NULL){\n        strcpy(t-&gt;line, string);\n    } \n    t-&gt;next = next; \n    return t;\n}\n\nstatic void printBuffer(TB tb){\n    tNode* curr = tb-&gt;head;\n    int i = 0;\n    while(curr != NULL){\n\n        while(curr-&gt;line[i] != '\\n'){\n            printf(\"%c\", curr-&gt;line[i]);\n            i++;\n        }\n        printf(\"\\n\");\n        i = 0;\n        curr = curr-&gt;next;\n    }\n}\n\n/* Allocate a new textbuffer whose contents is initialised with the text given\n * in the array.\n */\nTB newTB (char text[]){\n\n    assert(text != NULL); \n\n    int i = 0; \n    char c;\n\n    TB tBuffer = malloc(sizeof(struct textbuffer)); \n    tBuffer-&gt;size = 0; \n\n    //tNode* currLine = malloc(sizeof (struct textNode*));\n    tNode* currLine = newTN(NULL, 1, NULL);\n    tNode* currtNode; \n\n    //currLine-&gt;line = malloc(sizeof(char));\n</code></pre>\n\n<p>I keep getting errors when assigning things like \"curr = curr->next\", and the first error I get is:</p>\n\n<p>expected '=', ',', ';','asm' or '<strong>attribute</strong>' before token '*' in the line where I declare my static function newTN. Please tell me what the problem is...thanks...so confused</p>\n"}, {"tags": ["python", "c", "python-cffi"], "owner": {"reputation": 49, "user_id": 8178628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uLg28.jpg?s=128&g=1", "display_name": "Traphix", "link": "https://stackoverflow.com/users/8178628/traphix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513757406, "creation_date": 1513746269, "last_edit_date": 1513757406, "question_id": 47899113, "link": "https://stackoverflow.com/questions/47899113/how-to-declare-the-predefined-struct-client-in-rpc-clnt-h-when-using-python-cf", "title": "How to declare the predefined struct CLIENT in &lt;rpc/clnt.h&gt; when using python cffi?", "body": "<p>Struct CLIENT is defined in rpc/clnt.h, but how can instantiate it when using python cffi?</p>\n\n<p>For example,I have a c header file like this:</p>\n\n<pre><code>#include &lt;rpc/rpc.h&gt;\nCLIENT* my_init(char* server_ip);\n</code></pre>\n\n<p>And I have the *.so file for the header file.</p>\n\n<p>Function my_init returns a CLIENT, how can I get its return value in python using cffi?</p>\n\n<p>I tried this, but it came out an error:</p>\n\n<pre><code>import cffi\n\nffi = cffi.FFI()\npmlib = ffi.dlopen(\"my.so\")\nffi.cdef(\"\"\"\n    CLIENT* my_init(char* server_ip);\n\"\"\")\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>cffi.error.CDefError: cannot parse \"CLIENT* my_init(char* server_ip);\"\n&lt;cdef source string&gt;:2:11: before: *\n</code></pre>\n"}, {"tags": ["c", "pointers", "heap-memory"], "comments": [{"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1513745792, "post_id": 47898934, "comment_id": 82764646, "body": "Do you have reason to suspect that <code>malloc</code> will return the same address twice?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1513746001, "post_id": 47898934, "comment_id": 82764707, "body": "You can&#39;t assume anything about the behavior of malloc other than you ask for a pointer to a block of a certain size, and assuming no error, you get a pointer to a block of at least the size you asked for."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1513746471, "post_id": 47898934, "comment_id": 82764859, "body": "what is UAF error?"}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1513746629, "post_id": 47898934, "comment_id": 82764902, "body": "@coderredoc Use After Free.This is new to me."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1513749034, "post_id": 47898934, "comment_id": 82765667, "body": "Yes, it&#39;s a UAF error. No it doesn&#39;t matter if <code>malloc</code> returns the same address again (which it&#39;s allowed to do), you still use a pointer you shouldn&#39;t."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1513752976, "post_id": 47898934, "comment_id": 82767164, "body": "&quot;//trying to use aliasA here&quot; How will you use it? If you dereference it (<code>*aliasA</code>), it is undefined behavior - see for instance <a href=\"http://man7.org/linux/man-pages/man3/free.3p.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/free.3p.html</a> where it is stated very clear. However, you can of cause use the pointer for other thing but a direct dereferencing... no. It makes absolutely no difference whether or not the two malloc returns the same value."}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513751895, "post_id": 47900044, "comment_id": 82766698, "body": "<b><i>dereference</i></b> and <b><i>assignment</i></b> are two different things :)"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513753010, "post_id": 47900044, "comment_id": 82767181, "body": "Comment is not a good place to add information. You should <a href=\"https://stackoverflow.com/posts/47900044/edit\">edit</a> it into your answer :)"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1513755378, "post_id": 47900044, "comment_id": 82768339, "body": "I don&#39;t understand why it&#39;s negative vote even after correction ?? Is not going to help someone ?? is that seriously negative ??"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513793482, "post_id": 47900044, "comment_id": 82791696, "body": "NMDV, yet<code>A * aliasA = ptrA;</code> occurs before the <code>free(ptrA)</code> so &quot;The <code>aliasA</code> is UAF error&quot; is unclear.  Even worse <code>A * aliasA = ptrA; free(ptrA); free(aliasA);</code> is a UAF error."}, {"owner": {"reputation": 93, "user_id": 7785748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8160b9915563aa14d80f086ab73e4dee?s=128&d=identicon&r=PG&f=1", "display_name": "Xy Luo", "link": "https://stackoverflow.com/users/7785748/xy-luo"}, "edited": false, "score": 0, "creation_date": 1513831584, "post_id": 47900044, "comment_id": 82804036, "body": "Thanks for your suggestion, basically,  I make this code on purpose because I expected that an error message should be emitted.."}], "tags": [], "owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "is_accepted": false, "score": 0, "last_activity_date": 1513752658, "last_edit_date": 1513752658, "creation_date": 1513751502, "answer_id": 47900044, "question_id": 47898934, "link": "https://stackoverflow.com/questions/47898934/new-pointer-by-malloc-is-same-as-one-of-the-freed-old-pointers/47900044#47900044", "title": "New pointer (by malloc) is same as one of the freed/old pointers", "body": "<p>The <code>aliasA</code> is UAF error, it may hold the same value as <code>ptrA</code> but it's not guaranteed and it's recommended to re-assign the freed pointer (both aliasA and ptrA) to <code>NULL</code> to avoid <a href=\"https://en.wikipedia.org/wiki/Dangling_pointer\" rel=\"nofollow noreferrer\">dangling pointer</a>.</p>\n\n<p>In your case, it's better to assign <code>NULL</code> after you <code>free</code>:</p>\n\n<pre><code>free(ptrA);\nfree(aliasA);\nptrA = NULL;\naliasA = NULL;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1513759735, "post_id": 47900194, "comment_id": 82770634, "body": "This is not strictly correct. Pointer <b>equality</b> is defined anywhere - otherwise the comparison against i.e. NULL would not be right. This is UB simply because the previous pointer refers to an object whose lifetime has ended, and its value is indeterminate."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 1, "last_activity_date": 1513752171, "creation_date": 1513752171, "answer_id": 47900194, "question_id": 47898934, "link": "https://stackoverflow.com/questions/47898934/new-pointer-by-malloc-is-same-as-one-of-the-freed-old-pointers/47900194#47900194", "title": "New pointer (by malloc) is same as one of the freed/old pointers", "body": "<p>This <strong><em>is</em></strong> a UAF error.</p>\n\n<p>In practice, it is <em>very</em> unlikely that the second <code>malloc()</code> call returns the same address as <code>aliasA</code>, as the behavior is not guaranteed. You should not rely on it.</p>\n\n<p>You may ask: <em>Can I compare them to make sure they have the same address?</em> Well, no. Comparing may make some sense to you, but it is undefined behavior, because pointer equality comparison is valid only if the two pointers point to different elements in the same array. In this case the two allocated blocks surely aren't the same array, so comparison between those pointers isn't well-defined.</p>\n\n<p>At last, you shouldn't rely on the address returned by <code>malloc()</code>. All you can do is use it within the amount of memory requested when calling.</p>\n\n<p>In practice, <a href=\"https://stackoverflow.com/a/47900044/5958455\"><em>Thiru Shetty</em>'s answer</a> is a good way to pursue.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 3, "last_activity_date": 1515566690, "last_edit_date": 1515566690, "creation_date": 1513760627, "answer_id": 47902236, "question_id": 47898934, "link": "https://stackoverflow.com/questions/47898934/new-pointer-by-malloc-is-same-as-one-of-the-freed-old-pointers/47902236#47902236", "title": "New pointer (by malloc) is same as one of the freed/old pointers", "body": "<p>If you don't <em>dereference</em> the pointer <code>aliasA</code>, it depends on the definition of \"use after free\" whether this constitutes \"use after free\". For example <a href=\"https://cwe.mitre.org/data/definitions/416.html\" rel=\"nofollow noreferrer\">CWE-416</a> doesn't talk about just <em>using</em> the pointer value, but about dereferencing it, i.e. using the <em>object</em> that was freed.</p>\n\n<p>However, the C standard says that even <strong>using</strong> the pointer value has undefined behaviour <a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.2\" rel=\"nofollow noreferrer\">(Appendix J.2)</a>:</p>\n\n<blockquote>\n  <ol>\n  <li><p>The behavior is undefined in the following circumstances: </p>\n  \n  <p>[...]</p>\n  \n  <ul>\n  <li>The value of a pointer that refers to space deallocated by a call to the free or realloc function is used (7.22.3).</li>\n  </ul></li>\n  </ol>\n</blockquote>\n\n<p>This is because the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.4p2\" rel=\"nofollow noreferrer\">value of the pointer becomes <em>indeterminate</em></a>:</p>\n\n<blockquote>\n  <p>The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime. </p>\n</blockquote>\n\n<p>Therefore the following code has undefined behaviour:</p>\n\n<pre><code>A *ptrA = malloc(sizeof(A));\nA *aliasA = ptrA;\nfree(ptrA);\nA *ptrB = malloc(sizeof(A));\n\nif (aliasA == ptrB) { // undefined behaviour, as it might be a trap\n    printf(\"We were given the same pointer\");\n}\n</code></pre>\n\n<p>The comparison there is meaningless and the compiler is given the freedom to do whatever it pleases with its optimization, as <code>aliasA</code> doesn't need to contain a <em>valid</em> value any more. It is totally OK for a compiler to even to set a trap into <code>aliasA</code> which would cause your program to abort at the <code>if</code> statement with a diagnostics message. Or it can be that these could seem to point to the same address even though they were given distinct addresses of memory, or vice versa.</p>\n"}], "owner": {"reputation": 93, "user_id": 7785748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8160b9915563aa14d80f086ab73e4dee?s=128&d=identicon&r=PG&f=1", "display_name": "Xy Luo", "link": "https://stackoverflow.com/users/7785748/xy-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 47902236, "answer_count": 3, "score": 5, "last_activity_date": 1515566690, "creation_date": 1513745170, "last_edit_date": 1513814898, "question_id": 47898934, "link": "https://stackoverflow.com/questions/47898934/new-pointer-by-malloc-is-same-as-one-of-the-freed-old-pointers", "title": "New pointer (by malloc) is same as one of the freed/old pointers", "body": "<p>I am trying to track use-after-free errors in C.\nAnd my question is that, if I have the code like this:  </p>\n\n<pre><code>A * ptrA = malloc(sizeof(A));\nA * aliasA = ptrA;\n// do something ' \nfree(ptrA) \n// some other code\nB * ptrB = malloc(sizeof(B)); // assume this return same pointer as ptrA\n//trying to use aliasA here\n</code></pre>\n\n<p>Just wondering if the use of aliasA is a UAF error?\nIf it is, what is going wrong here?</p>\n\n<p>To clear the question, I think it is better to add a small example:  </p>\n\n<pre><code>int main(){\n    int *ptr = (int *)malloc(4);\n    *ptr = 5;\n    int *ptr2 = ptr;\n    printf(\"%d\\n\", *ptr);\n    free(ptr);\n\n    int *new_ptr = malloc(4);\n    *new_ptr = 66;\n    printf(\"%d\\n\", *ptr2);\n\n    return 0;\n}  \n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>5\n66\n</code></pre>\n\n<p>(I checked <code>ptr</code> and <code>new_ptr</code> in S2E: <a href=\"http://s2e.systems/\" rel=\"nofollow noreferrer\">http://s2e.systems/</a> and these two pointers actually point to the same address. After freeing ptr, the same address is allocated to new_ptr.)  </p>\n\n<p>From the output above, it seems like the use of <code>ptr2</code> gives the same output as <code>new_ptr</code>.  </p>\n\n<p>When I wrote my solution to detect UAF error, I record the information of pointers. The pointers' values are stored as <code>uint64_t</code> and a boolean type <code>flag</code> is to declare whether the pointer is alive.</p>\n\n<p>Therefore, I guess a problem occurs when the <code>new_ptr</code> and <code>ptr</code> point to same address because once <code>malloc()</code> is called the <code>flag</code> for <code>new_ptr</code> will turn <code>true</code>. After that, when I use <code>ptr</code>, I can not detect this UAF error because this address is marked alive.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "winapi", "singly-linked-list"], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1513733541, "creation_date": 1513733541, "answer_id": 47897599, "question_id": 47897537, "link": "https://stackoverflow.com/questions/47897537/singly-linked-list-how-to-properly-remove-free-an-entity/47897599#47897599", "title": "Singly Linked-List (How to properly remove/free an entity?)", "body": "<p>Removing an element from a linked list simply involves updating the surrounding element pointers to the element being removed, and then freeing the element.  You don't need to allocate or copy anything.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>VOID FD_Remove(FDescs List, PVOID FileDesc) {\n    FDescs Previous = NULL;\n    while (List) {\n        if (List-&gt;FDesc == FileDesc) {\n            if (Previous)\n                Previous-&gt;Next = List-&gt;Next;\n            LocalFree(List);\n            return;\n        }\n        Previous = List;\n        List = List-&gt;Next;\n    }\n}\n\nFD_Remove(FDescList, (PVOID)0x00000005);\n</code></pre>\n\n<p>But, watch out if the element being removed is the <code>head</code> of your linked list.  If so, you need to update that pointer too, which the above function can't do directly.  You would have to do something more like this instead:</p>\n\n<pre><code>VOID FD_Remove(FDescs *List, PVOID FileDesc) {\n    if (!List) return;\n    FDescs Element = *List, Previous = NULL;\n    while (Element) {\n        if (Element-&gt;FDesc == FileDesc) {\n            if (*List == Element)\n                *List = Element-&gt;Next;\n            if (Previous)\n                Previous-&gt;Next = Element-&gt;Next;\n            LocalFree(Element);\n            return;\n        }\n        Previous = Element;\n        Element = Element-&gt;Next;\n    }\n}\n\nFD_Remove(&amp;FDescList, (PVOID)0x00000005);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8840643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 47897599, "answer_count": 1, "score": 1, "last_activity_date": 1513733541, "creation_date": 1513732927, "question_id": 47897537, "link": "https://stackoverflow.com/questions/47897537/singly-linked-list-how-to-properly-remove-free-an-entity", "title": "Singly Linked-List (How to properly remove/free an entity?)", "body": "<p><strong>Background</strong></p>\n\n<p>I have the following code</p>\n\n<pre><code>VOID FD_Remove(FDescs List, PVOID FileDesc) {\n    while (List) {\n        if (List-&gt;Sock == FileDesc) {\n            List-&gt;Next = (FDescs) LocalAlloc(sizeof(Network::FDesc));\n            if (List-&gt;Next != ERROR) {\n                FDescs Element = List-&gt;Next;\n\n                List-&gt;Sock = List-&gt;Next-&gt;Sock;\n                List-&gt;Host = List-&gt;Next-&gt;Host;\n                List-&gt;Path = List-&gt;Next-&gt;Path;\n\n                List-&gt;Next = Element-&gt;Next;\n                LocalFree(Element);\n            }\n        } List = List-&gt;Next;\n    }\n}\n</code></pre>\n\n<p><strong>Notes</strong></p>\n\n<p>Basically, when I am creating a new entry in the linked list. I will allocate a new memory block of the given structure size and set it to the end of the list, finding a block the same way as I do in this <code>_Remove</code> function.</p>\n\n<p>However, when I am trying to remove an entity. I free the entity from the list as seen above, and set the current entity to the next entry in the list. The problem is, it appears that the <code>LocalFree</code> call doesn't actual set the allocated memory back to an unallocated block of memory. When I look at the linked-list the current entity simply has all of its entries set to <code>NULL (0)</code>.</p>\n\n<p>Assume the <code>FileDesc</code> that I am passing to <code>FD_Remove</code> is the last entry of the list.</p>\n\n<p><code>FD_Remove(FDescList, 0x00000005);</code></p>\n\n<p>So we can assume that the memory that has the <code>0x00000005</code> entity is now freed.</p>\n\n<p>Now I call <code>FD_Add(FDescList, FileDesc, 'whatever');</code></p>\n\n<p>I would only assume that these values would appear in the previously freed entity in the Linked-list.</p>\n\n<p><strong>Problem</strong></p>\n\n<p>The problem is that entity is set to <code>NULL</code> instead of freed memory, and the function adds the <code>FileDesc</code> and 'whatever' data to the entity after the <code>NULL</code> memory block instead of inside of it.</p>\n\n<p><strong>Question</strong></p>\n\n<p>What am I doing wrong in my <code>FD_Remove</code> function that is causing this, and how can I improve my function to fix this problem?</p>\n"}, {"tags": ["c", "types"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1513766284, "post_id": 47897312, "comment_id": 82774743, "body": "The reason is implicit integer promotion. There are many similar questions all over SO. Study the linked duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1513735250, "post_id": 47897356, "comment_id": 82762441, "body": "I think the subtlety here is that while <code>uint8_t</code> is an unsigned type, when used as the left operand of a shift operation, it gets promoted to <code>int</code>, not <code>unsigned int</code>.  The result of the last signed left shift results in a negative <code>int</code> value (and technically, I believe the sign change qualifies as overflow), which remains negative when converted to <code>float</code>."}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 0, "last_activity_date": 1513731286, "creation_date": 1513731286, "answer_id": 47897356, "question_id": 47897312, "link": "https://stackoverflow.com/questions/47897312/please-explain-the-c-language-data-structure/47897356#47897356", "title": "Please explain the C language data structure", "body": "<p>In the first case, the type of the expression on the right-hand side is <code>int</code>, and the value is -121. In the second case, the type is <code>uint32_t</code>, and the value is <code>uint32_t(-121) == 4294967175</code>. The latter cannot be precisely represented in a <code>float</code>, so it gets rounded.</p>\n"}], "owner": {"reputation": 11, "user_id": 9120439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f232b723d83f9ba63aed753329bf6f5?s=128&d=identicon&r=PG&f=1", "display_name": "hyunoh lee", "link": "https://stackoverflow.com/users/9120439/hyunoh-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1513766242, "accepted_answer_id": 47897356, "answer_count": 1, "score": -4, "last_activity_date": 1545873962, "creation_date": 1513730855, "last_edit_date": 1545873962, "question_id": 47897312, "link": "https://stackoverflow.com/questions/47897312/please-explain-the-c-language-data-structure", "closed_reason": "Duplicate", "title": "Please explain the C language data structure", "body": "<p>The result of the values \u200bof A and B is as follows.</p>\n"}, {"tags": ["c", "yacc"], "comments": [{"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 1, "creation_date": 1513730911, "post_id": 47897150, "comment_id": 82761395, "body": "This line looks problematic: <code>fct: nf &#39;(&#39;L &#39;)&#39; {if ($1==1) {</code>. The braces aren&#39;t matched."}], "answers": [{"comments": [{"owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1513750876, "post_id": 47897303, "comment_id": 82766296, "body": "Doing that Now the number of warnings reduced to : Compiling... mo.y C:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(42) : warning Y4003: &#39;$1&#39; : attribute is untyped C:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(43) : warning Y4003: &#39;$1&#39; : attribute is untyped C:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(45) : warning Y4003: &#39;$1&#39; : attribute is untyped C:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(46) : warning Y4003: &#39;$$&#39; : attribute is untyped C:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(50) : warning Y4003: &#39;$$&#39; : attribute is untyped"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1513760770, "post_id": 47897303, "comment_id": 82771193, "body": "If you seriously think that is legible I am sorry but you have rocks in your head. Edit it into your question. And tell us which are the line numbers involved. But in general, <code>$$: attribute is untyped</code> means exactly what it says, and the solution is to make sure that it <i>is</i> typed."}, {"owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1518650936, "post_id": 47897303, "comment_id": 84598431, "body": "well to be honest i did not understand for my first experiance that the error mean that i have to type that mean that every token should be declared under token and for rules put them under type. So not understanding that lead me to every time think that is a new error.Whatever u think me so stupid but it was just a misunderstood from me and confusion that lead me to this error"}, {"owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1518650966, "post_id": 47897303, "comment_id": 84598438, "body": "anyway after working harder later i could do something like this"}, {"owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1518650986, "post_id": 47897303, "comment_id": 84598444, "body": "<a href=\"https://github.com/ZinaTaklit/CompileEvaluateAndInetermediateCodeForArithmetiqueOperation\" rel=\"nofollow noreferrer\">github.com/ZinaTaklit/&hellip;</a>"}, {"owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1518651098, "post_id": 47897303, "comment_id": 84598482, "body": "so u are not a wiser teacher &quot;EJP&quot;  and u should not tell me that. but i have learned from my mistake and u can see what i have reached to do"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1530059171, "post_id": 47897303, "comment_id": 89096985, "body": "Wise enough to give you the right answer, mate, and to try to raise your standards of legilibility. Shooting the messenger doens&#39;t accomplish anything."}, {"owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "edited": false, "score": 0, "creation_date": 1530059286, "post_id": 47897303, "comment_id": 89097009, "body": "i do agree with u"}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 4, "last_activity_date": 1513749794, "last_edit_date": 1513749794, "creation_date": 1513730754, "answer_id": 47897303, "question_id": 47897150, "link": "https://stackoverflow.com/questions/47897150/how-to-fix-yacc-warning-attribute-is-untyped-with-fatal-error-unexpected-end-of/47897303#47897303", "title": "How to fix yacc warning attribute is untyped with fatal error unexpected end of file", "body": "<p>You need</p>\n\n<pre><code>%type &lt;value&gt; E T F\n</code></pre>\n\n<p>to fix the type errors. </p>\n\n<p>As noted by @JeffMercado, the premature EOF is caused by the excess first brace on</p>\n\n<pre><code>fct: nf '('L ')' {if ($1==1) {\n</code></pre>\n\n<p>And</p>\n\n<pre><code>%left '+','-' \n%left '*','/'\n</code></pre>\n\n<p>This is not right. The commas should be spaces.</p>\n"}], "owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 47897303, "answer_count": 1, "score": 0, "last_activity_date": 1513749794, "creation_date": 1513729608, "last_edit_date": 1513730834, "question_id": 47897150, "link": "https://stackoverflow.com/questions/47897150/how-to-fix-yacc-warning-attribute-is-untyped-with-fatal-error-unexpected-end-of", "title": "How to fix yacc warning attribute is untyped with fatal error unexpected end of file", "body": "<p>I want to code the calculate of moy in Yacc so I do this code</p>\n\n<pre><code>%{\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n// Fonction qui permet de claculer la moyenne\ndouble moy(int*ls,int size )\n{\nint som=0;\n for(int j=0; j&lt;size;j++)\n      som+=ls[j];\n  return (som/size);\n}\n\n/* La structure de la table*/\n%}\n\n%union {\n  int value;\n  struct s{int *ls; int size;} str;\n}\n%token nb\n%type &lt;value&gt; E\n%type &lt;str&gt; L\n%left '+','-'\n%left '*','/'\n//%right '^'\n//%right moins_unaire\n%%\nLigne  :   E '\\n'       {printf(\"%d \\n\",$1);}\n;\n\nE    :   E '-' T    {$$=$1-$3;}\n     |   E '+' T    {$$=$1+$3;}\n     |   T          {$$=$1;}\n     ;\nT    :   T '*' F\n     |   T '/' F\n     |   F\n     ;\nF    :   '(' E ')' {$$=$2;}\n     |   nb  {$$=$1;}\n     |   fct  {$$=$1;}\n     ;\nfct: nf '('L ')' {if ($1==1) {\n         $$=  moy($3.ls,$3.size);\n     }\n     ;\nnf   : 'moy' {$$=1;}\n     ;\nL    :   L ',' E {$$.ls=$1; $$.ls[$$.size++]=$3;}\n     | E {$$.size=1; $$.ls=malloc(50); $$.ls[0]=$1;}\n     ;\n%%\nmain ()\n{\n    yyparse();\n}\n</code></pre>\n\n<p>but once i compiled it i have gotten those warnings:</p>\n\n<p>Compiling...\nmo.y</p>\n\n<pre><code>C:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(35) : warning Y4003: '$3' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(36) : warning Y4003: '$3' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(37) : warning Y4003: '$1' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(43) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(44) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(44) : warning Y4003: '$1' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(45) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(45) : warning Y4003: '$1' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(47) : warning Y4003: '$1' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(48) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(51) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(53) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(53) : warning Y4003: '$1' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(53) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(53) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(54) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(54) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(54) : warning Y4003: '$$' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(54) : warning Y4003: '$1' : attribute is untyped\nC:\\Users\\LE\\Desktop\\exos\\moy\\mo.y(62) : fatal error Y1015: unexpected end of file found in action\n\ng - 1 error(s), 19 warning(s)\n</code></pre>\n\n<p>I noticed that once I delete this two lines:</p>\n\n<pre><code>%type &lt;value&gt; E\n%type &lt;str&gt; L\n</code></pre>\n\n<p>Untyped error disappear. I searched a lot but i did not reach to fix the problem.</p>\n\n<p><strong>What should I do ?</strong></p>\n"}, {"tags": ["c", "sockets", "udp", "recvfrom"], "comments": [{"owner": {"reputation": 381, "user_id": 6160020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YKm7XmRRzWk/AAAAAAAAAAI/AAAAAAAABMA/0SMhweWTkPY/photo.jpg?sz=128", "display_name": "aneesh jose", "link": "https://stackoverflow.com/users/6160020/aneesh-jose"}, "edited": false, "score": 1, "creation_date": 1513731577, "post_id": 47897115, "comment_id": 82761567, "body": "flush the stdout after your print statement <code>printf(&quot;loop2\\n&quot;);</code> using <code>fflush(stdout);</code>"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 381, "user_id": 6160020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YKm7XmRRzWk/AAAAAAAAAAI/AAAAAAAABMA/0SMhweWTkPY/photo.jpg?sz=128", "display_name": "aneesh jose", "link": "https://stackoverflow.com/users/6160020/aneesh-jose"}, "edited": false, "score": 0, "creation_date": 1513732336, "post_id": 47897115, "comment_id": 82761738, "body": "@aneeshjose, if that&#39;s going to a terminal device, it should be flushed automagically due to the newline. Only if it cannot be detected as an interactive device will it be fully buffered."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1513736289, "post_id": 47897115, "comment_id": 82762655, "body": "How do you know there\u2019s data to be read?  You need to provide an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).   And you likely need to provide sender and receiver."}, {"owner": {"reputation": 1285, "user_id": 8955448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cDG4Z.jpg?s=128&g=1", "display_name": "Galen", "link": "https://stackoverflow.com/users/8955448/galen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513741333, "post_id": 47897115, "comment_id": 82763664, "body": "Does <code>pollarr</code> actually point to the beginning of an array of two poll file descriptors? Please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> as @JonathanLeffler requested."}], "owner": {"reputation": 11, "user_id": 8196928, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34413643574dc2328ba08c7c71eb8a42?s=128&d=identicon&r=PG&f=1", "display_name": "mmaron", "link": "https://stackoverflow.com/users/8196928/mmaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513731027, "creation_date": 1513729297, "last_edit_date": 1513731027, "question_id": 47897115, "link": "https://stackoverflow.com/questions/47897115/c-udp-read-and-recv-are-breaking-my-code", "title": "C UDP read and recv are breaking my code", "body": "<p>So I'm working with UDP sockets and poll(), trying to be able to wait for connections and read input at the same time, but I'm coming up with the weirdest error and I have no idea how to handle it. Here's the part of my code that's causing issues.</p>\n\n<pre><code>int n=1;   //set n =1 so that it can enter first loop\n\nwhile (1) {\n  for(int j = 0; j &lt; 2; j++){\n    printf(\"loop1\\n\");\n    if(n&gt;0){\n      printf(\"loop2\\n\");\n      mlen = read(sd, buf, BSIZE);      \n      //I would like to use read here, but I've tried both read and recvfrom\n      //and both have the same issue \\/ that's the other code I was trying\n      //mlen = recvfrom(sd,buf,BSIZE,0,(struct sockaddr *)&amp;cad, &amp;fromlen);\n      if(mlen&lt;0){\n        perror(\"recvfrom\");\n        exit(1);\n      }\n\n      /* more code here that does stuff with buffer info */\n    }\n    else {\n      perror(\"poll\");\n      exit(1);}\n    }\n  }\n  n = poll(pollarr,2,-1);\n  printf(\"now n is %d\\n\", n);\n}\n</code></pre>\n\n<p>So here's where it gets strange. When I run this code, it prints out loop1, but does not print loop2, even though I explicitly set n=1 at the beginning. I changed the loop1 print statement to \"printf(\"now n is %d\\n\", n);\" to see what was going on, and then it didn't print anything at all. </p>\n\n<p>To add to this mystery, this happens regardless of if I use read or recv, but when I comment out both of those my code enters both loops just fine.</p>\n\n<p>So, somehow both read and recv are preventing my program from running the way it should, before those lines are even reached. I have no clue what could be going on, and my best guess would be that it's some obscure C thing that I just don't know about. Does anyone know what's going wrong?</p>\n\n<p>If it matters, I think I'm using Linux. </p>\n"}, {"tags": ["c", "unix", "process", "operating-system"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513735464, "post_id": 47897110, "comment_id": 82762482, "body": "Your parent process isn\u2019t waiting for the children.  But if that was an issue, I\u2019d expect the PPID to be 1, not 3221.  Have you identified process 3221?   Is there one?  What happens on the third and fourth (and \u2026) runs?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1513735988, "post_id": 47897110, "comment_id": 82762587, "body": "Does making the parent wait for its children change things?  Which Unix variant are you on?  What version? Anything unusual about your setup?"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1513757951, "creation_date": 1513757951, "answer_id": 47901568, "question_id": 47897110, "link": "https://stackoverflow.com/questions/47897110/inconsistency-in-the-parent-process-id-after-fork-call/47901568#47901568", "title": "Inconsistency in the parent process id after fork call?", "body": "<p>I took your code and only replaced <code>int main(int argc, char **argv)</code> with <code>int main(void)</code> (since my default compiling options complain about unused variables and stop code compiling), and it then compiled cleanly (well done; I usually have to do more work than that to get code to compile cleanly for me).  And, when I ran it (it was called <code>pgid37</code>), I got the result:</p>\n\n<pre><code>$ ./pgid37\nProcess A: pid: 27489 ppid: 742 gid: 27489 sid: 740 \nProcess B: pid: 27490 ppid: 27489 gid: 27489 sid: 740 \nProcess C: pid: 27491 ppid: 1 gid: 27491 sid: 740 \n$\n</code></pre>\n\n<p>Note that the parent PID (PPID) of C is 1, not 27489.  Since the A process doesn't wait for either B or C to exit, this is not surprising to me.</p>\n\n<ul>\n<li>I don't have a good (or even a bad) explanation for the PPID of 3321 that you saw on one occasion.</li>\n</ul>\n\n<p>Here's a modified version of your code where the parent waits for the children \u2014 the source was in <code>pgid11.c</code> and the program was called <code>pgid11</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nstatic void report_ids(const char *tag)\n{\n    printf(\"Process %s: pid: %ld ppid: %ld gid: %ld sid: %ld \\n\",\n           tag, (long)getpid(), (long)getppid(), (long)getpgrp(), (long)getsid(0));\n}\n\nint main(void)\n{\n    /* Currently process A */\n    report_ids(\"A\");\n\n    /* Create process B */\n    pid_t process_id_B = fork();\n    if (process_id_B == 0)\n    {\n        report_ids(\"B\");\n        return EXIT_SUCCESS;\n    }\n\n    pid_t process_id_C = fork();\n    if (process_id_C == 0)\n    {\n        /* Change process group id */\n        if (setpgid(0, 0) == -1)\n        {\n            perror(\"setpgid() error\");\n            return EXIT_FAILURE;\n        }\n        report_ids(\"C\");\n        return EXIT_SUCCESS;\n    }\n\n    int corpse;\n    int status;\n    while ((corpse = wait(&amp;status)) &gt; 0)\n    {\n        printf(\"%d: PID %d exited with status 0x%.4X\\n\",\n               (int)getpid(), corpse, status);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>One sample run gave me:</p>\n\n<pre><code>$ ./pgid11\nProcess A: pid: 27527 ppid: 742 gid: 27527 sid: 740 \nProcess B: pid: 27528 ppid: 27527 gid: 27527 sid: 740 \n27527: PID 27528 exited with status 0x0000\nProcess C: pid: 27529 ppid: 27527 gid: 27529 sid: 740 \n27527: PID 27529 exited with status 0x0000\n$\n</code></pre>\n\n<p>This time, both children report PPID equal to the first process, 27527, which is very much what would be expected.</p>\n"}], "owner": {"reputation": 3361, "user_id": 4281711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/L82n0.jpg?s=128&g=1", "display_name": "Prateek Joshi", "link": "https://stackoverflow.com/users/4281711/prateek-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 47901568, "answer_count": 1, "score": 1, "last_activity_date": 1513757951, "creation_date": 1513729262, "last_edit_date": 1513746310, "question_id": 47897110, "link": "https://stackoverflow.com/questions/47897110/inconsistency-in-the-parent-process-id-after-fork-call", "title": "Inconsistency in the parent process id after fork call?", "body": "<p>I am creating a small process tree and printing process id, parent process id,\nprocess group id and process session id</p>\n\n<pre><code>            A(g1,s1) \n\n           / \\\n\n  (g1,s1)B     C (g2,s1)\n</code></pre>\n\n<p>(g,s) : (process group id, process session id)</p>\n\n<p><strong>Problem</strong>: In <code>process C</code>, the <code>output of parent process id</code> changes, it should display ppid as pid of process A but its not. Also <code>something it prints the correct output.</code> Why this <code>inconsistency in the output</code> ? </p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n\nint main(int argc, char **argv) {\n    int err= EXIT_SUCCESS;\n    pid_t process_id_A;\n    pid_t process_id_B;\n    pid_t process_id_C;\n\n    /* Currently process A */\n    process_id_A = getpid();\n    printf(\"Process A: pid: %ld ppid: %ld gid: %ld sid: %ld \\n\",(long)getpid(),(long)getppid(),(long)getpgrp(),(long)getsid(0));\n\n    /* Create process B */\n    process_id_B= fork();\n    switch(process_id_B)\n    {\n    case 0:\n        /* Inside process B */\n        //do nothing , ie same process group id and session id as process A\n        printf(\"Process B: pid: %ld ppid: %ld gid: %ld sid: %ld \\n\",(long)getpid(),(long)getppid(),(long)getpgrp(),(long)getsid(0));\n        break;\n    default:\n        break;\n    }\n\n    /* Create process C */\n    //check if process is A , then create process C as child of A\n    if(getpid() == process_id_A)\n    {\n        process_id_C = fork();\n        switch(process_id_C)\n        {\n        case 0:\n            /* Inside process C */\n\n            /* Change process group id */\n            err = setpgid(0,0);\n            if(err == -1)\n            {\n                perror(\"setpgid() error\");\n                goto exit;\n            }\n            printf(\"Process C: pid: %ld ppid: %ld gid: %ld sid: %ld \\n\",(long)getpid(),(long)getppid(),(long)getpgrp(),(long)getsid(0));\n            break;\n        default:\n            break;\n        }\n    }\n\n    exit:\n        return err;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>$ ./setpgid_demo.o  (1st run: correct output)\nProcess A: pid: 14224 ppid: 13562 gid: 14224 sid: 13562\nProcess B: pid: 14225 ppid: 14224 gid: 14224 sid: 13562 \nProcess C: pid: 14226 ppid: 14224 gid: 14226 sid: 13562 \n\n$ ./setpgid_demo.o  (2nd run : Incorrect output)\nProcess A: pid: 14227 ppid: 13562 gid: 14227 sid: 13562 \nProcess B: pid: 14228 ppid: 14227 gid: 14227 sid: 13562 \nProcess C: pid: 14229 ppid: 3221 gid: 14229 sid: 13562\n</code></pre>\n"}, {"tags": ["c", "arrays", "reference", "typedef"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1513726042, "post_id": 47896695, "comment_id": 82760182, "body": "<code>a.byte</code> --&gt; <code>a-&gt;byte</code>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1513726180, "post_id": 47896695, "comment_id": 82760224, "body": "<code>simpleInit</code> expected a <code>complex *</code> for its first argument.  <code>myNumber</code> has type <code>complex</code>, not <code>complex *</code>.  You need to pass <code>&amp;myNumber</code> to <code>simpleInit</code>.  It has nothing to do with <code>typedef</code>.  This is true for any basic C data type."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1513730059, "post_id": 47896695, "comment_id": 82761173, "body": "You need to learn the language"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513726376, "post_id": 47896712, "comment_id": 82760279, "body": "Or use <code>sizeof(a-&gt;byte)</code>, though the loop index then needs to be an unsigned type (e.g. <code>size_t</code>) to avoid signed-unsigned comparison warnings, if they&#39;re enabled."}, {"owner": {"reputation": 74, "user_id": 847199, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7c909db5e3e1f662568db5be0edb9f8?s=128&d=identicon&r=PG", "display_name": "Tristan Ridley", "link": "https://stackoverflow.com/users/847199/tristan-ridley"}, "edited": false, "score": 1, "creation_date": 1513727101, "post_id": 47896712, "comment_id": 82760479, "body": "My actual code does use #define, and it&#39;s not 10 either.  This was just a massively scaled down version of something I&#39;m making to handle numbers larger than 64 bits (like a homemade mini-gmp). I will get much use from the memset function too, thanks. I also was failing to pass a reference with &amp;, as Tom Karzes pointed out in his comment."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1513727198, "post_id": 47896712, "comment_id": 82760503, "body": "<code>memset</code> will be a life-saver if you&#39;re initializing much larger arrays, then. It&#39;s way more efficient than setting byte by byte."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1513726120, "creation_date": 1513726120, "answer_id": 47896712, "question_id": 47896695, "link": "https://stackoverflow.com/questions/47896695/cant-pass-typedef-struct-to-function-by-reference/47896712#47896712", "title": "Can&#39;t pass typedef struct to function by reference", "body": "<p><code>a</code> is a pointer type, so you need to de-reference it to use it. Typically that's done with the arrow operator:</p>\n\n<pre><code>a-&gt;byte[i] = 0;\n</code></pre>\n\n<p>Since this is just an array of bytes you can also quickly \"zero\" it:</p>\n\n<pre><code>memset(a, 0, 10);\n</code></pre>\n\n<p>Though given how important <code>10</code> is in your code you should codify that in a constant or a <code>#define</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 74, "user_id": 847199, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7c909db5e3e1f662568db5be0edb9f8?s=128&d=identicon&r=PG", "display_name": "Tristan Ridley", "link": "https://stackoverflow.com/users/847199/tristan-ridley"}, "edited": false, "score": 0, "creation_date": 1513727242, "post_id": 47896826, "comment_id": 82760517, "body": "Thank you this is perfect.  I already accepted the other perfect answer, but yours is exactly identical to my corrected code. :) I spent hours trying to figure this out!"}], "tags": [], "owner": {"reputation": 829, "user_id": 2762722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4Yyl.jpg?s=128&g=1", "display_name": "Ernest Collection", "link": "https://stackoverflow.com/users/2762722/ernest-collection"}, "is_accepted": false, "score": 1, "last_activity_date": 1513726931, "creation_date": 1513726931, "answer_id": 47896826, "question_id": 47896695, "link": "https://stackoverflow.com/questions/47896695/cant-pass-typedef-struct-to-function-by-reference/47896826#47896826", "title": "Can&#39;t pass typedef struct to function by reference", "body": "<p>When you pass a value by reference you need to use asterisk to access al fields of the structure, for example:</p>\n\n<pre><code>(*a).byte[0] = value;\n</code></pre>\n\n<p>Happily you have -> as a shortcut, so this will be:</p>\n\n<pre><code>a-&gt;byte[0] = value;\n</code></pre>\n\n<p>Also do not forget to call the &amp; (address of) operator when you call <code>simpleInit</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ntypedef struct structure \n{\n    char byte[10];\n    char mod;\n} complex;\n\nvoid simpleInit (complex *a, char value) \n{\n    char i;\n\n    a-&gt;byte[0] = value;\n\n    for (i = 1; i &lt; 10; ++i) {\n        a-&gt;byte[i] = 0;\n    }\n\n    a-&gt;mod = 1;\n}\n\nint main() \n{ \n    complex myNumber;\n    char value = 6;\n    simpleInit (&amp;myNumber, value);\n}\n</code></pre>\n"}], "owner": {"reputation": 74, "user_id": 847199, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7c909db5e3e1f662568db5be0edb9f8?s=128&d=identicon&r=PG", "display_name": "Tristan Ridley", "link": "https://stackoverflow.com/users/847199/tristan-ridley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 0, "accepted_answer_id": 47896712, "answer_count": 2, "score": -1, "last_activity_date": 1513726931, "creation_date": 1513725983, "last_edit_date": 1592644375, "question_id": 47896695, "link": "https://stackoverflow.com/questions/47896695/cant-pass-typedef-struct-to-function-by-reference", "title": "Can&#39;t pass typedef struct to function by reference", "body": "<p>I'm trying to pass a custom type object to a function by reference, and I can't figure out what I could be doing wrong.  I read <a href=\"https://stackoverflow.com/questions/16159712/how-do-you-pass-a-typedef-struct-to-a-function\">How do you pass a typedef struct to a function?</a> as well as other references and could swear I'm already doing exactly that.  I cleared out everything else I'm doing and even this spartan code throws 5 errors.  Help me, Stackexchange; You're my only hope!</p>\n<p>The goal is simply to be able to alter the values in the array in the object.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\ntypedef struct structure {\n    char byte[10];\n    char mod;\n} complex;\nvoid simpleInit (complex *a, char value) {//put the value in the first byte and zero the rest\n    a.byte[0] = value;\n    char i;\n    for (i = 1; i &lt; 10; ++i) {\n        a.byte[i] = 0;\n    }\n    a.mod = 1;\n}\nvoid main () {\n    complex myNumber;\n    char value = 6;\n    simpleInit (myNumber, value);\n}\n</code></pre>\n<p>When I attempt to run this I get this error and 4 similar:</p>\n<blockquote>\n<p>test2.c:10:3: error: request for member \u2018byte\u2019 in something not a structure or union</p>\n<p>a.byte[0] = value;</p>\n</blockquote>\n"}, {"tags": ["c", "z3", "solver", "smt"], "comments": [{"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 0, "creation_date": 1513762114, "post_id": 47896607, "comment_id": 82772013, "body": "You first need to ask <code>z3</code> to check the <i>satisfiability</i> of the problem (something like <code>Z3_solver_check(ctx, s)</code> I guess), double-check that the search result is <code>Z3_L_TRUE</code>, and only then you can retrieve a model by calling <code>Z3_solver_get_model(ctx, s)</code>."}], "owner": {"reputation": 31, "user_id": 9114456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87285e7b1b9d6e25c51ca460e6409c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Sang Hun Lee", "link": "https://stackoverflow.com/users/9114456/sang-hun-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513725508, "creation_date": 1513725508, "question_id": 47896607, "link": "https://stackoverflow.com/questions/47896607/z3-solving-ite-example-using-c-api", "title": "Z3: solving ite example using C API", "body": "<p>I am a newcomer in Z3 solver, and using Windows 10, VS2013 command prompt.</p>\n\n<p>I am trying to use C and I have tried to solve the below simple problem using Z3 solver.</p>\n\n<p>problem set: what is the possible value of a that satisfies (b = 1) condition for below if-then-else statement,</p>\n\n<p>(Here, we are looking for the solution of (a = 1))</p>\n\n<pre><code>if (a = 1)\n  b = 1\nelse\n  b = 0\n</code></pre>\n\n<p>So I made below C code, based on the C code example of Z3,</p>\n\n<p>(but the code is not working because it does not make sense at all using Z3, and I sincerely apologize for that)</p>\n\n<pre><code>void ite_example()\n{\n    Z3_context ctx = mk_context();\n    Z3_solver  s = mk_solver(ctx);\n    Z3_model m = 0;\n    Z3_ast a, b, one, zero, ite, ite_true;\n    Z3_ast a_eq_one, b_eq_one, b_eq_zero;\n    Z3_ast c1;\n\n    printf(\"\\nite_example\\n\");\n\n    one = mk_int(ctx, 1);\n    zero = mk_int(ctx, 0);\n    a = mk_int_var(ctx, \"a\");\n    b = mk_int_var(ctx, \"b\");\n\n    a_eq_one = Z3_mk_eq(ctx, b, one);\n    b_eq_one = Z3_mk_eq(ctx, a, one);\n    b_eq_zero = Z3_mk_eq(ctx, a, zero);\n\n    ite = Z3_mk_ite(ctx, a_eq_one, b_eq_one, b_eq_zero); // if(a = 1) then(b = 1) else(b = 0)\n    Z3_solver_assert(ctx, s, ite);\n\n    // we want to find the integer variable (a) that makes (b = 1)\n    c1 = Z3_mk_eq(ctx, b, one);\n    Z3_solver_assert(ctx, s, c1);\n\n    m = Z3_solver_get_model(ctx, s);\n    printf(\"%s\\n\", Z3_model_to_string(ctx, m));\n\n    /* delete logical context */\n    Z3_del_context(ctx);\n}\n\nint main() {\n    #ifdef LOG_Z3_CALLS\n        Z3_open_log(\"z3.log\");\n    #endif\n        ite_example();\n        return 0;\n}\n</code></pre>\n\n<p>But it seems that the code is not working (generating error code as below)</p>\n\n<pre><code>D:\\z3-master\\z3-master\\build&gt;make examples\ncl /nologo /c /Zi /W3 /WX- /O2 /Oy- /D _EXTERNAL_RELEASE /D WIN32 /D NDEBUG /D _CONSOLE /D _WINDOWS /D ASYNC_COMMANDS /Gm- /EHsc /GS /fp:precise /Zc:wchar_t /Zc:forScope /Gd /analyze- /arch:SSE2  /openmp /MD /D _WINDOWS  /Fotest_capi2.obj /nologo /MD -I..\\src\\api ..\\examples\\c\\test_capi2.c\ntest_capi2.c\ncl /Fec_example.exe /nologo /MD test_capi2.obj  libz3.lib /link /DEBUG /MACHINE:X86 /SUBSYSTEM:CONSOLE /INCREMENTAL:NO /STACK:8388608 /OPT:REF /OPT:ICF /TLBID:1 /DYNAMICBASE /NXCOMPAT\nZ3 examples were successfully built.\n\nD:\\z3-master\\z3-master\\build&gt;c_example.exe\n\nite_example\nError code: 10\nBUG: incorrect use of Z3.\n</code></pre>\n\n<p>I am so sorry for asking you so much elementary problem.</p>\n\n<p>Any idea on how to solve this problem will be very appreciated.</p>\n\n<p>(the revised ite_example code will be very much appreciated!)</p>\n\n<p>Thank you very much.</p>\n\n<p>Sincerely,\nLee.</p>\n"}, {"tags": ["c++", "c", "gcc", "linker", "musl"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1513723289, "post_id": 47896204, "comment_id": 82759340, "body": "related: <a href=\"https://stackoverflow.com/questions/1867745/cmake-use-a-custom-linker\" title=\"cmake use a custom linker\">stackoverflow.com/questions/1867745/cmake-use-a-custom-linke&zwnj;&#8203;r</a>"}, {"owner": {"reputation": 3501, "user_id": 3124409, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/5922e9a9b3b7aef6002860ed4515b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Goodies", "link": "https://stackoverflow.com/users/3124409/goodies"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1513723342, "post_id": 47896204, "comment_id": 82759356, "body": "That might be all I need."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513723606, "post_id": 47896204, "comment_id": 82759440, "body": "&quot;The linker does NOT point to the custom built one, nor would I expect it to&quot; -- why would you not expect that?  I account your toolchain broken if the gcc driver does not know how to find and run the appropriate component parts."}, {"owner": {"reputation": 3501, "user_id": 3124409, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/5922e9a9b3b7aef6002860ed4515b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Goodies", "link": "https://stackoverflow.com/users/3124409/goodies"}, "edited": false, "score": 0, "creation_date": 1513723808, "post_id": 47896204, "comment_id": 82759508, "body": "Well, it simply says &quot;cannot find &#39;ld&#39;&quot; but when I perform <code>which ld</code>, it doesn&#39;t show the path to the custom linker. I wouldn&#39;t expect it to because, well, it&#39;s not called <code>ld</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513725545, "post_id": 47896204, "comment_id": 82760058, "body": "But the point is, why would you not expect your cross-compiling compiler driver to know the correct name and location of your cross-compiling linker?  Perhaps that indeed <i>is</i> what you should expect, but I would have thought that these are among the things that you can configure at build time.  Clearly the expected location, at least, is among those things, since the compiler does not pick up the (wrong) linker from your path."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513726020, "post_id": 47896204, "comment_id": 82760172, "body": "@JohnBollinger when I read  1 <code>I followed this &#39;tutorial&#39;</code> I know that is much too early for this person to do such an advanced things."}, {"owner": {"reputation": 3501, "user_id": 3124409, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/5922e9a9b3b7aef6002860ed4515b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Goodies", "link": "https://stackoverflow.com/users/3124409/goodies"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1513730895, "post_id": 47896204, "comment_id": 82761391, "body": "Well, not necessarily @PeterJ_01. Unnecessary condescension aside, I&#39;m capable of understanding at least most of what&#39;s going on here. The script he provided is incredibly intuitive and, while I don&#39;t have a lot of experience with cross compilation, I&#39;m still vaguely familiar with the compilation/linking processes."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1513731090, "post_id": 47896204, "comment_id": 82761444, "body": "@Goodies I afraid I am right. The correct way is know how everything works and then doing something like this. There is nothing wrong in using tutorials but always IMO knowledge is the must."}, {"owner": {"reputation": 3501, "user_id": 3124409, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/5922e9a9b3b7aef6002860ed4515b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Goodies", "link": "https://stackoverflow.com/users/3124409/goodies"}, "edited": false, "score": 0, "creation_date": 1513731398, "post_id": 47896204, "comment_id": 82761520, "body": "I understand that. I&#39;ve built GCC from source before and have not had these issues. But again, I&#39;ve little experience with cross-compilation, hence my question on SO."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1513777152, "post_id": 47896204, "comment_id": 82781711, "body": "@PeterJ_01, tutorial aside, the reason I raise the issue at all is to prompt the OP to look for an appropriate configuration setting among GCC&#39;s build options.  I don&#39;t know whether there actually is one, but I see reason to hope.  If the OP were not competent to look for such a thing himself, then that would be a different issue, but I see reason for hope on that front as well."}], "owner": {"reputation": 3501, "user_id": 3124409, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/5922e9a9b3b7aef6002860ed4515b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Goodies", "link": "https://stackoverflow.com/users/3124409/goodies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1058, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1513722968, "creation_date": 1513722968, "question_id": 47896204, "link": "https://stackoverflow.com/questions/47896204/custom-musl-build-of-gcc-cannot-find-ld", "title": "Custom (musl) Build of GCC Cannot Find LD", "body": "<p>I followed <a href=\"https://jstrapko.github.io/musl-gcc/\" rel=\"nofollow noreferrer\">this 'tutorial'</a> to create a static GCC, libc, and libstdc++ built against MUSL.</p>\n\n<p>Build directory: <code>/home/user/musl_gcc/</code></p>\n\n<p>When I attempt to create a simple test C program, and compile it with no arguments, I get the following error:</p>\n\n<pre><code>[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$ cat test.c\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    puts(\"Test\");\n    _exit(0); // return 0 leads to a segfault (unsure why)\n}\n\n[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$ ./amd64-linux-musl-gcc test.c\ncollect2: fatal error: cannot find 'ld'\ncompilation terminated.\n[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$ which ld\n/usr/bin/ld\n[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$ `!!` -v\n`which ld` -v\nGNU ld (GNU Binutils) 2.29.1\n</code></pre>\n\n<p>The linker does NOT point to the custom built one, nor would I expect it to.</p>\n\n<p>This can be rather easily circumvented by compiling and linking in separate steps:</p>\n\n<pre><code>[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$ ./amd64-linux-musl-gcc test.c -c\n[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$ ./amd64-linux-musl-ld test.o -L../lib/ -lc -o test\n./amd64-linux-musl-ld: warning: cannot find entry symbol _start; defaulting to 00000000004000e8\n[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$ ./test\nTest\n[user@Arch]: ~/musl_gcc/amd64-linux-musl/bin&gt;$\n</code></pre>\n\n<p>However. this is of little use to me. I'd eventually like to get it to work with C++ applications that use CMake as a build environment, but this has been a tedious cat-and-mouse game of \"find the library.\" How do I specify the linker to use? I thought it was though the <code>LD</code> environment variable, but that proved fruitless.</p>\n"}, {"tags": ["c", "syntax", "microcontroller", "keil", "stepper"], "comments": [{"owner": {"reputation": 1006, "user_id": 3888756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPnk1.jpg?s=128&g=1", "display_name": "DigitalNinja", "link": "https://stackoverflow.com/users/3888756/digitalninja"}, "edited": false, "score": 0, "creation_date": 1513720684, "post_id": 47895681, "comment_id": 82758368, "body": "Can you post the code that shows how you are using these stepper functions (e.g. where <code>Stepper_Seek</code> gets called, etc.)?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1513721546, "post_id": 47895681, "comment_id": 82758685, "body": "add output/debug statements where you are updating <code>Pos</code> and compare it to <code>desired</code>.  Note too that you have a comment <code>CW steps is 0 to 199</code> and the next line compares <code>CWsteps</code> to 100.  Just a red flag......"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1513722504, "post_id": 47895681, "comment_id": 82759056, "body": "The rollover logic is backwards.  Pos-- needs to be matched to a check for it reaching 0, Pos++ needs to be checked for reaching 199."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1513722521, "creation_date": 1513722521, "answer_id": 47896125, "question_id": 47895681, "link": "https://stackoverflow.com/questions/47895681/stepper-motor-wont-stop-rotating/47896125#47896125", "title": "Stepper Motor won&#39;t stop rotating", "body": "<p>Your wrap-around logic is backward in both <code>Stepper_CW()</code> and <code>Stepper_CCW()</code>.  Take the former as the example.  Suppose you're trying to reach 198, and <code>Pos</code> is initially 1:</p>\n\n<ol>\n<li>On the first call, <code>Pos</code> is decremented to 0.  This is unequal to 198, so the function is called again.</li>\n<li>On the second call, <code>Pos</code> is decremented to 199.  This is unequal to 198, so the function is called again.</li>\n<li>On the third call, the wrap-around case is triggered, and <code>Pos</code> is set to 0.  This is unequal to 198 ....</li>\n</ol>\n\n<p>The state after step (3) is the same as the state after step (1) -- infinite loop.</p>\n"}], "owner": {"reputation": 103, "user_id": 6023454, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/513cce5ea18809749f32fd936747da03?s=128&d=identicon&r=PG&f=1", "display_name": "Walby", "link": "https://stackoverflow.com/users/6023454/walby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513722664, "creation_date": 1513720108, "last_edit_date": 1513722664, "question_id": 47895681, "link": "https://stackoverflow.com/questions/47895681/stepper-motor-wont-stop-rotating", "title": "Stepper Motor won&#39;t stop rotating", "body": "<p>I'm trying to get my 28BYJ-48 Stepper Motor to rotate one quarter of a revolution and then stop, but I'm having trouble implementing that in code. What I find is no matter how small I make the numbers in my code or even alter it in ways that make me think it'd work properly, I can't get it to stop rotating. Below is the helpful part of the code.</p>\n\n<pre><code>#define STEPPER  (*((volatile uint32_t *)0x4000703C))\n\n// Move 1.8 degrees clockwise, delay is the time to wait after each step\nvoid Stepper_CW(uint32_t delay) {\n  Pt = Pt-&gt;Next[clockwise];     // circular\n  STEPPER = Pt-&gt;Out; // step motor\n\n  if(Pos==199) {      // shaft angle\n    Pos = 0;         // reset\n  }\n  else {\n    Pos--; // CW\n  }\n SysTick_Wait(delay);\n}\n\n// Move 1.8 degrees counterclockwise, delay is wait after each step\nvoid Stepper_CCW(uint32_t delay) {\n  Pt = Pt-&gt;Next[counterclockwise]; // circular\n  STEPPER = Pt-&gt;Out; // step motor\n  if(Pos==0) {        // shaft angle\n    Pos = 199;         // reset\n  }\n  else {\n    Pos++; // CCW\n  }\n SysTick_Wait(delay); // blind-cycle wait\n}\n\n// Initialize Stepper interface\nvoid Stepper_Init(void) {\n  SYSCTL_RCGCGPIO_R |= 0x08; // 1) activate port D\n  SysTick_Init();\n  Pos = 0;                   \n  Pt = &amp;fsm[0]; \n                                // 2) no need to unlock PD3-0\n  GPIO_PORTD_AMSEL_R &amp;= ~0x0F;      // 3) disable analog functionality on PD3-0\n  GPIO_PORTD_PCTL_R &amp;= ~0x0000FFFF; // 4) GPIO configure PD3-0 as GPIO\n  GPIO_PORTD_DIR_R |= 0x0F;             // 5) make PD3-0 out\n  GPIO_PORTD_AFSEL_R &amp;= ~0x0F;          // 6) disable alt funct on PD3-0\n  GPIO_PORTD_DR8R_R |= 0x0F;            // enable 8 mA drive\n  GPIO_PORTD_DEN_R |= 0x0F;         // 7) enable digital I/O on PD3-0 \n}\n\n// Turn stepper motor to desired position\n// (0 &lt;= desired &lt;= 199)\n// time is the number of bus cycles to wait after each step\nvoid Stepper_Seek(uint8_t desired, uint32_t time) {\n short CWsteps;\n  if((CWsteps = (desired-Pos))&lt;0) {\n   CWsteps+=200;\n  } \n\n// CW steps is &gt; 100\n if(CWsteps &gt; 100) {\n   while(desired != Pos) {\n     Stepper_CCW(time);\n   }\n }\n else {\n   while(desired != Pos) {\n    Stepper_CW(time);\n   } \n }\n}\n</code></pre>\n\n<p>Stepper_Seek gets called here...</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include \"stepper.h\"\n#define T1ms 16000    // assumes using 16 MHz PIOSC (default setting for clock source)\nint main(void) {\n  Stepper_Init();\n  Stepper_CW(T1ms);   // Pos=1; GPIO_PORTD_DATA_R=9\n  Stepper_CW(T1ms);   // Pos=2; GPIO_PORTD_DATA_R=5\n  Stepper_CW(T1ms);   // Pos=3; GPIO_PORTD_DATA_R=6\n  Stepper_CW(T1ms);   // Pos=4; GPIO_PORTD_DATA_R=10\n  Stepper_CW(T1ms);   // Pos=5; GPIO_PORTD_DATA_R=9\n  Stepper_CW(T1ms);   // Pos=6; GPIO_PORTD_DATA_R=5\n  Stepper_CW(T1ms);   // Pos=7; GPIO_PORTD_DATA_R=6\n  Stepper_CW(T1ms);   // Pos=8; GPIO_PORTD_DATA_R=10\n  Stepper_CW(T1ms);   // Pos=9; GPIO_PORTD_DATA_R=9\n  Stepper_CCW(T1ms);  // Pos=8; GPIO_PORTD_DATA_R=10\n  Stepper_CCW(T1ms);  // Pos=7; GPIO_PORTD_DATA_R=6\n  Stepper_CCW(T1ms);  // Pos=6; GPIO_PORTD_DATA_R=5\n  Stepper_CCW(T1ms);  // Pos=5; GPIO_PORTD_DATA_R=9\n  Stepper_CCW(T1ms);  // Pos=4; GPIO_PORTD_DATA_R=10\n  Stepper_Seek(8,T1ms);// Pos=8; GPIO_PORTD_DATA_R=10\n  Stepper_Seek(0,T1ms);// Pos=0; GPIO_PORTD_DATA_R=10\n  while(1) {\n    Stepper_CW(10*T1ms);   // output every 10ms\n  }\n}\n</code></pre>\n\n<p>I thought it could have been that it kept resetting its position and starting again after it reset but even after commenting out the line it wouldn't fix.</p>\n\n<p>Thank you everyone in advance!</p>\n"}, {"tags": ["c", "linux", "filesystems", "fuse"], "answers": [{"tags": [], "owner": {"reputation": 1603, "user_id": 2231059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16055d451b2f7cdcd760d1ed9203a50?s=128&d=identicon&r=PG&f=1", "display_name": "marbu", "link": "https://stackoverflow.com/users/2231059/marbu"}, "is_accepted": false, "score": 3, "last_activity_date": 1518299107, "creation_date": 1518299107, "answer_id": 48725889, "question_id": 47895420, "link": "https://stackoverflow.com/questions/47895420/fuse-lib-passthrough-c-example-where-is-it-mirrors-my-exactly/48725889#48725889", "title": "FUSE lib passthrough.c example. Where is it mirrors my / exactly?", "body": "<p>Try to read implementation of any fuse operation in the example and you will see it. There is no single place where this particular detail about mirroring of a root filesystem is hidden.</p>\n\n<p>For example, let's check <a href=\"https://libfuse.github.io/doxygen/structfuse__operations.html#a60144dbd1a893008d9112e949300eb77\" rel=\"nofollow noreferrer\"><code>getattr</code> fuse operation</a>, which is similar to <a href=\"https://linux.die.net/man/2/stat\" rel=\"nofollow noreferrer\"><code>stat(2)</code></a> system call, and is expected to return (via pointer) a stat structure of given file.</p>\n\n<p>When some file is accessed in a fuse filesystem, a function implementing gettattr operation is called first, which makes implementation of this operation mandatory.</p>\n\n<p>Looking at <a href=\"https://github.com/libfuse/libfuse/blob/03515bbb3092da9b3c2c6a267de90f9f0dcbdb29/example/passthrough.c#L70\" rel=\"nofollow noreferrer\">the implementation in the example</a>:</p>\n\n<pre><code>static int xmp_getattr(const char *path, struct stat *stbuf,\n           struct fuse_file_info *fi)\n{\n    (void) fi;\n    int res;\n\n    res = lstat(path, stbuf);\n    if (res == -1)\n        return -errno;\n\n    return 0;\n}\n</code></pre>\n\n<p>we see that all this code does is that it just calls <code>lstat(2)</code> with the same arguments.</p>\n\n<p>So when you mount this example filesystem like this:</p>\n\n<pre><code>$ ./passthrough /tmp/example\n</code></pre>\n\n<p>and then try to list files there:</p>\n\n<pre><code>$ ls /tmp/example/\n</code></pre>\n\n<p>fuselib will call <code>xmp_getattr()</code> with path <code>\"/\"</code> because you are accessing the root of the fuse filesystem. Then the code in <code>xmp_getattr()</code> will just call ordinary syscall for the similar thing so that the root filesystem looks mirrored in <code>/tmp/example</code> mountpoint.</p>\n"}, {"tags": [], "owner": {"reputation": 1706, "user_id": 780859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4d4e1f5e27893eb6593bc7335460c23?s=128&d=identicon&r=PG", "display_name": "n224576", "link": "https://stackoverflow.com/users/780859/n224576"}, "is_accepted": false, "score": 1, "last_activity_date": 1542116233, "creation_date": 1542116233, "answer_id": 53282253, "question_id": 47895420, "link": "https://stackoverflow.com/questions/47895420/fuse-lib-passthrough-c-example-where-is-it-mirrors-my-exactly/53282253#53282253", "title": "FUSE lib passthrough.c example. Where is it mirrors my / exactly?", "body": "<p>marbu's answer is correct. I will only clarify that the path argument passed to <code>xmp_getattr()</code> et.al. is relative to the mount point, thus <code>/tmp/example/</code> is turned  into <code>/</code>. You can compile <code>passthrough</code> with the <code>-g</code> flag and attach <code>gdb</code> on it after you've mounted it to inspect the arguments if you so wish.</p>\n"}], "owner": {"reputation": 86, "user_id": 7283951, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/3sY0n.png?s=128&g=1", "display_name": "Sophour", "link": "https://stackoverflow.com/users/7283951/sophour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1194, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1594078631, "creation_date": 1513718754, "last_edit_date": 1594078631, "question_id": 47895420, "link": "https://stackoverflow.com/questions/47895420/fuse-lib-passthrough-c-example-where-is-it-mirrors-my-exactly", "title": "FUSE lib passthrough.c example. Where is it mirrors my / exactly?", "body": "<p>I'm new to FUSE and c and FSs and I'm messing with <a href=\"https://github.com/libfuse/libfuse/blob/master/example/passthrough.c\" rel=\"nofollow noreferrer\">passthrough FS</a> example which is given in the libfuse package. Can anyone give a hint where in the code it is commanded that FUSE mirror my root dir, please? Cause I found the two base functions - *xmp_init() and main() - pretty laconic.</p>\n<p>Here they are:</p>\n<pre><code>static void *xmp_init(struct fuse_conn_info *conn,\n              struct fuse_config *cfg)\n{\n    (void) conn;\n    cfg-&gt;use_ino = 1;\n    cfg-&gt;entry_timeout = 0;\n    cfg-&gt;attr_timeout = 0;\n    cfg-&gt;negative_timeout = 0;\n\n    return NULL;\n}\n\nint main(int argc, char *argv[])\n{\n    umask(0);\n    return fuse_main(argc, argv, &amp;xmp_oper, NULL);\n}\n</code></pre>\n<p>And other functions are just, like, implementations of libfuse interface...stuff. I need to make my own crippled FS, I need to modify passthrough.c so that mounted FS would be a white sheet and I could make use of implemented functions and manage files and stuff.</p>\n"}, {"tags": ["c", "list", "memory", "dynamic"], "comments": [{"owner": {"reputation": 942, "user_id": 2012809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IF0o7.png?s=128&g=1", "display_name": "Omni", "link": "https://stackoverflow.com/users/2012809/omni"}, "edited": false, "score": 0, "creation_date": 1513719073, "post_id": 47895331, "comment_id": 82757670, "body": "Incomplete strings could result from a bug in the input-parsing code as well. So I advise you to decouple that from the linked list implementation first: Write a test program which does not create a linked list but reads in the entries from the file and simply outputs them. Using this program, you can verify first that your io code is correct. If the problem then persists, you are certain it has something to do with your linked list implementation!"}], "answers": [{"comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 25, "user_id": 9119991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac57aeaabdd1d53741010841ba1f83a?s=128&d=identicon&r=PG&f=1", "display_name": "Penhzull", "link": "https://stackoverflow.com/users/9119991/penhzull"}, "edited": false, "score": 0, "creation_date": 1514778353, "post_id": 47898100, "comment_id": 83065583, "body": "Please click the check mark if this answers your question"}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 0, "last_activity_date": 1513738172, "creation_date": 1513738172, "answer_id": 47898100, "question_id": 47895331, "link": "https://stackoverflow.com/questions/47895331/reading-from-file-into-linked-list-in-c/47898100#47898100", "title": "Reading from file into linked list in C", "body": "<p><code>strtok(line, \"&lt;SEP&gt;\");</code> will look for character delimiters which include <code>&lt;</code>, <code>S</code>, <code>E</code>, <code>P</code>, <code>&gt;</code></p>\n\n<p>Use <code>strstr</code> if you need to search for <code>\"&lt;SEP&gt;\"</code> string</p>\n\n<p>Otherwise change the delimiter to <code>;</code> and define the data as follows:</p>\n\n<pre><code>TRMMMYQ128F932D901;SOQMMHC12AB0180CB8;Faster Pussy cat;Silent Night\n</code></pre>\n\n<p>Your linked list is repeating the same code. You can simplify as follows and add error handling:</p>\n\n<pre><code>char *sep = \";\";\nwhile(fgets(line, sizeof(line), fp)) \n{\n    current = malloc(sizeof(song));\n    current-&gt;nextSong = NULL;\n\n    item = strtok(line, sep);\n    if(!item) break;\n    current-&gt;id = strdup(item);\n    item = strtok(NULL, sep);\n    if(!item) break;\n    current-&gt;songId = strdup(item);\n    item = strtok(NULL, sep);\n    if(!item) break;\n    current-&gt;artist = strdup(item);\n    item = strtok(NULL, sep);\n    if(!item) break;\n    current-&gt;title = strdup(item);\n\n    if(root)\n        current-&gt;nextSong = root;\n    root = current;\n}\nfclose(fp);\n</code></pre>\n\n<p>In addition, when printing the code walk through the list and print every valid element as follows:</p>\n\n<pre><code>if(root) \n{\n    current = root;\n    while(current != NULL)\n    {\n        printf(\"%s %s %s %s\\n\", \n          current-&gt;id, current-&gt;songId, current-&gt;artist, current-&gt;title);\n        current = current-&gt;nextSong;\n    }\n}\n</code></pre>\n\n<p>This code does not free any of the memory allocated. You can do that for the next step.</p>\n"}], "owner": {"reputation": 25, "user_id": 9119991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac57aeaabdd1d53741010841ba1f83a?s=128&d=identicon&r=PG&f=1", "display_name": "Penhzull", "link": "https://stackoverflow.com/users/9119991/penhzull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1403, "favorite_count": 0, "accepted_answer_id": 47898100, "answer_count": 1, "score": 1, "last_activity_date": 1513738172, "creation_date": 1513718339, "last_edit_date": 1513718476, "question_id": 47895331, "link": "https://stackoverflow.com/questions/47895331/reading-from-file-into-linked-list-in-c", "title": "Reading from file into linked list in C", "body": "<p>I have to read from a text file which has a format : </p>\n\n<pre><code>TRMMMYQ128F932D901-SEP-SOQMMHC12AB0180CB8&lt;SEP&gt;Faster Pussy cat-SEP-Silent Night\n</code></pre>\n\n<p>This is my code for writing into linked list and then printing it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#pragma warning(disable:4996)\n\ntypedef struct song {\nchar *id;\nchar *songId;\nchar *artist;\nchar *title;\nstruct song *nextSong;\n} song;\n\nchar *strdup(const char *c)\n{\nchar *dup = malloc(strlen(c) + 1);\n\nif (dup != NULL)\n    strcpy(dup, c);\n\nreturn dup;\n}\n\nint main()\n{\nFILE *fp;\nchar line[400];\nchar *item;\n\nsong *root = NULL;\nsong *current = NULL;\n\nint i = 0;\n\nfp = fopen(\"C:\\\\Users\\\\DelicAnte\\\\Desktop\\\\unique_tracks.txt\", \"r\");\n\nif (!fp) {\n    fprintf(stderr, \"Cannot be opened\");\n}\nprintf(\"starting\");\nwhile (fgets(line, sizeof(line), fp)) {\n\n    if (root == NULL) {\n\n        root = malloc(sizeof(song));\n        /*root-&gt;id = strtok(line, \"&lt;SEP&gt;\");\n        root-&gt;songId = strtok(NULL, \"&lt;SEP&gt;\");\n        root-&gt;artist = strtok(NULL, \"&lt;SEP&gt;\");\n        root-&gt;title = strtok(NULL, \"&lt;SEP&gt;\");*/\n\n        item = strtok(line, \"&lt;SEP&gt;\");\n        root-&gt;id = strdup(item);\n\n        item = strtok(NULL, \"&lt;SEP&gt;\");\n        root-&gt;songId = strdup(item);\n\n        item = strtok(NULL, \"&lt;SEP&gt;\");\n        root-&gt;artist = strdup(item);\n\n        item = strtok(NULL, \"\\n\");\n        root-&gt;title = strdup(item);\n\n        root-&gt;nextSong = NULL;\n\n    }\n    else {\n\n        current = root;\n        if (current != NULL) {\n            while (current-&gt;nextSong != NULL) {\n                current = current-&gt;nextSong;\n            }\n        }\n        /*current = malloc(sizeof(song));\n        current-&gt;id = strtok(line, \"&lt;SEP&gt;\");\n        current-&gt;songId = strtok(NULL, \"&lt;SEP&gt;\");\n        current-&gt;artist = strtok(NULL, \"&lt;SEP&gt;\");\n        current-&gt;title = strtok(NULL, \"&lt;SEP&gt;\");*/\n\n\n        current-&gt;nextSong = malloc(sizeof(song));\n        current = current-&gt;nextSong;\n\n        item = strtok(line, \"&lt;SEP&gt;\");\n        current-&gt;id = strdup(item);\n        //current-&gt;id = malloc(strlen(item) + 1);\n        //strcpy(current-&gt;id, item);\n\n        item = strtok(NULL, \"&lt;SEP&gt;\");\n        current-&gt;songId = strdup(item);\n        //current-&gt;songId = malloc(strlen(item) + 1);\n        //strcpy(current-&gt;songId, item);\n\n        item = strtok(NULL, \"&lt;SEP&gt;\");\n        current-&gt;artist = strdup(item);\n        //current-&gt;artist = malloc(strlen(item) + 1);\n        //strcpy(current-&gt;artist, item);\n\n        item = strtok(NULL, \"\\n\");\n        current-&gt;title = strdup(item);\n        //current-&gt;title = malloc(strlen(item) + 1);\n        //strcpy(current-&gt;title, item);\n\n        current-&gt;nextSong = NULL;\n\n        printf(\"%d\\n\", i);\n        i++;\n\n    }\n\n}\n\nfclose(fp);\n\ncurrent = root;\n\nif (current != NULL) {\n    while (current-&gt;nextSong != NULL) {\n        printf(\"%s %s\\n\", current-&gt;artist, current-&gt;title);\n        current = current-&gt;nextSong;\n    }\n    printf(\"%s %s %s %s\\n\", current-&gt;id, current-&gt;songId, current-&gt;artist, current-&gt;title);\n}\nelse {\n    printf(\"NULA JE\");\n}\n\n\nsystem(\"pause\");\nreturn 0;\n}\n</code></pre>\n\n<p>But I get really wierd output of incomplete strings. </p>\n"}, {"tags": ["c", "compiler-errors", "visual-studio-2017"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1513716686, "post_id": 47894961, "comment_id": 82756674, "body": "<code>char encrypted[strlen(baseStr)];</code> is one too small. Even for &quot;Linux and gcc&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1513716837, "post_id": 47894961, "comment_id": 82756739, "body": "Perhaps <i>Visual Studio 2017</i>, even when code compiled in C does not support VLAs.  With C11, VLA support is optional.  With C99, when it was introduced, VLA is required."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1513716885, "post_id": 47894961, "comment_id": 82756758, "body": "This isn&#39;t C++, it&#39;s C, which has VLAs, but Microsoft is notorious for being many years behind the standard. There might be a flag you have to set somewhere to tell the compiler to use C99, or it might just not support it. I you want to program in C, use a real compiler like GCC."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1513717850, "post_id": 47894961, "comment_id": 82757172, "body": "In fact, I&#39;m inclined to suspect that Microsoft was influential in the committee&#39;s decision to take the compatibility-breaking step of making VLA support optional in C2011.  MS has always been more fond of *ahem* <i>persuading</i> people to adopt MS convention and practice than of complying or supporting with 3rd-party standards."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1513718725, "post_id": 47894961, "comment_id": 82757509, "body": "No, Microsoft doesn&#39;t support VLAs in MSVC and never will."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1513719510, "post_id": 47894961, "comment_id": 82757868, "body": "Note that the <i>output</i> window in Visual Studio provides a plain text representation of the compiler output that you can copy &amp; paste rather posting a <i>picture</i> of text."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1513719812, "post_id": 47894961, "comment_id": 82758003, "body": "It would be fairly trivial to slightly refactor this code to work with Visual Studio 2017."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513719993, "post_id": 47894961, "comment_id": 82758087, "body": "@JohnBollinger not as much as you&#39;d think, the bigger issue was that VLAs caused more problems for the C compiler than they were worth. The feature had a lot of limitations that weren&#39;t worth the time to try and fix when actually implemented. For example most C programs have much smaller stack sizes than C++ etc. So a VLA could easily cause a Seg Fault/Stack Overflow by just being too large."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513720202, "post_id": 47894961, "comment_id": 82758174, "body": "@JohnBollinger : I doubt that Microsoft had any interest whatsoever; they declare support only for ISO C90/ANSI C89 in their C compiler.  They made C++ the preferred language for Windows development many years ago, and essentially froze their C compiler - it supports only the C99 or later features that are also valid C++.  When C++ was still largely a superset of C that made a lot of sense.  Besides VLAs are just a really bad idea and a recipe for unsafe stack-blowing code.  Moreover in this specific example entirely unnecessary."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1513720674, "post_id": 47894961, "comment_id": 82758363, "body": "Note that <code>strlen()</code> has to iterate the string to find the end, then you iterate the string to perform the en/decrypt.  It would be far more efficient to have the iteration simply terminate when the end of the input (nut terminator) is encountered."}], "answers": [{"comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1513757378, "post_id": 47895547, "comment_id": 82769374, "body": "I am not invalidating your answer. I just mentioned <code>malloc</code>, I don&#39;t think it needs a separate answer."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1513758920, "post_id": 47895547, "comment_id": 82770179, "body": "Fine, I deleted my comment from your answer and added comment to the question."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1513774800, "post_id": 47895547, "comment_id": 82780178, "body": "@BarmakShemirani : Appreciated, but consider <a href=\"https://stackoverflow.com/help/privileges/comment\">stackoverflow.com/help/privileges/comment</a> - specifically <i>&quot;Comments are not recommended for any of the following: [...]Answering a question or providing an alternate solution to an existing answer; instead, post an actual answer (or edit to expand an existing one);&quot;</i>. - It really deserves an answer.  Comments are not indexed for search, so are of less value to the community, and SO is not a discussion forum.  As a generic solution to avoiding the need for VLAs yours is useful - even if not necessary in this very narrow example."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 3, "last_activity_date": 1513754804, "last_edit_date": 1513754804, "creation_date": 1513719401, "answer_id": 47895547, "question_id": 47894961, "link": "https://stackoverflow.com/questions/47894961/initializing-strings-in-c-in-visual-studio/47895547#47895547", "title": "Initializing strings in C in Visual Studio", "body": "<p>Microsoft's compiler does not support C99 VLAs (see the note <a href=\"https://msdn.microsoft.com/en-us/library/zb1574zs.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">here</a>).  Array sizes must be a constant expression.  The code is also broken because it fails accommodate and place a nul terminator in the output. </p>\n\n<p>In this case, <code>decrypted</code> and <code>encrypted</code> might be declared thus: </p>\n\n<pre><code>char encrypted[sizeof(baseStr)] ;\n...\nchar decrypted[sizeof(baseStr)] ;\n</code></pre>\n\n<p>And <code>encryptDecrypt()</code> modified thus:</p>\n\n<pre><code>void encryptDecrypt(char *input, char *output) {\n\n...\n\n    output[i] = 0 ;\n}\n</code></pre>\n\n<p>Finally the signed mismatch warning may be cleaned up by declaring <code>i</code> as type <code>size_t</code>.</p>\n\n<p>On Windows of course you could always use MinGW/GCC if you want more modern C support. Or you could use C++ and <code>std::string</code> or <code>std::vector</code> containers if you want to stick with Microsoft's compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 1, "last_activity_date": 1513788442, "last_edit_date": 1513788442, "creation_date": 1513788104, "answer_id": 47910705, "question_id": 47894961, "link": "https://stackoverflow.com/questions/47894961/initializing-strings-in-c-in-visual-studio/47910705#47910705", "title": "Initializing strings in C in Visual Studio", "body": "<p>Use <code>malloc</code> for dynamic memory allocation. Requires <code>#include &lt;stdlib.h&gt;</code></p>\n\n<pre><code>char baseStr[] = \"123\";\nchar *encrypted = malloc(strlen(baseStr) + 1);\n...\nfree(encrypted);\n</code></pre>\n\n<p>As mentioned before, you have to add 1 for the null-terminated character at the end.</p>\n\n<p>The <code>char*</code> pointer is one piece of information, it shows where the string begins. But where does it end? <code>strlen</code> and other C functions have no idea where the string ends, so they go through all the characters until a <code>'\\0'</code> character is encountered. </p>\n\n<p>For efficiency, take <code>strlen(input)</code> out of the loop and calculate it only once:</p>\n\n<pre><code>void encryptDecrypt(char *input, char *output) \n{\n    char key[] = { 'K', 'C', 'Q' };\n    int keysize = sizeof(key);\n    size_t i;\n    size_t len = strlen(input);\n    for(i = 0; i &lt; len; i++) \n        output[i] = input[i] ^ key[i % keysize];\n    output[len] = 0; //will be same as output[i] = 0; \n}\n</code></pre>\n\n<p>The function <code>int main</code> should return zero. Note that this method cannot be described as \"encryption\" by modern standards. You can call it \"obfuscation\".</p>\n"}], "owner": {"reputation": 324, "user_id": 3367983, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be5c5325ae21e9fe182562cf4801b79e?s=128&d=identicon&r=PG&f=1", "display_name": "Dandry", "link": "https://stackoverflow.com/users/3367983/dandry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 47895547, "answer_count": 2, "score": 0, "last_activity_date": 1513788442, "creation_date": 1513716549, "question_id": 47894961, "link": "https://stackoverflow.com/questions/47894961/initializing-strings-in-c-in-visual-studio", "title": "Initializing strings in C in Visual Studio", "body": "<p>I try to learn the XOR algorithm using C. I have found a great example on <a href=\"https://github.com/KyleBanks/XOREncryption/blob/master/C/main.c\" rel=\"nofollow noreferrer\">KyleBank's GitHub</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid encryptDecrypt(char *input, char *output) {\n    char key[] = {'K', 'C', 'Q'}; //Can be any chars, and any size array\n\n    int i;\n    for(i = 0; i &lt; strlen(input); i++) {\n        output[i] = input[i] ^ key[i % (sizeof(key)/sizeof(char))];\n    }\n}\n\nint main (int argc, char *argv[]) {\n    char baseStr[] = \"kylewbanks.com\";\n\n    char encrypted[strlen(baseStr)];\n    encryptDecrypt(baseStr, encrypted);\n    printf(\"Encrypted:%s\\n\", encrypted);\n\n    char decrypted[strlen(baseStr)];\n    encryptDecrypt(encrypted, decrypted);\n    printf(\"Decrypted:%s\\n\", decrypted);\n}\n</code></pre>\n\n<p>The above works well under Linux and gcc.\nHowever, it does not compile in Visual Studio under Windows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xq70j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xq70j.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am using build tools included in Visual Studio 2017.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "linux", "pipe"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1513714719, "post_id": 47894535, "comment_id": 82755783, "body": "To begin with, <code>n=read(...)&gt;0</code> will not work as you apparently expect, as it is equal to <code>n = (read(...) &gt; 0)</code>. I.e. it assign the result of the <i>comparison</i> to <code>n</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1513714785, "post_id": 47894535, "comment_id": 82755818, "body": "As for breaking the loop when <code>read</code> blocks, that&#39;s kind of impossible since you&#39;re stuck in the <code>read</code> call. You can however poll descriptors to see if calling <code>read</code> will block.  One such way is to use the <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\"><code>select</code></a> call."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513715053, "post_id": 47894535, "comment_id": 82755941, "body": "<code>while(n=read(0, &amp;i, sizeof(i))&gt;0)</code> --&gt; <code>while((n=read(0, &amp;i, sizeof i )) &gt; 0)</code>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1513715494, "post_id": 47894535, "comment_id": 82756150, "body": "When all writers to a pipe are closed, then the first attempt to <code>read</code> will return 0 for EOF. Any future <code>read</code>s cause SIGPIPE, which defaults to killing the process; failing that, <code>read</code> returns and sets <code>errno</code> to <code>EPIPE</code>. If <code>read</code> is blocking, that implies that some writer is still open. See <a href=\"http://man7.org/linux/man-pages/man7/pipe.7.html\" rel=\"nofollow noreferrer\">pipe(7)</a> for more info."}, {"owner": {"reputation": 39, "user_id": 5066325, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wu2msNP56bA/AAAAAAAAAAI/AAAAAAAAFWs/hdi8joxSq6Y/photo.jpg?sz=128", "display_name": "Eric31", "link": "https://stackoverflow.com/users/5066325/eric31"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1513759478, "post_id": 47894535, "comment_id": 82770489, "body": "Indeed @DanielH it does seem that the problem was that some descriptors were still open and no 0 was ever returned. I also re-wrote the condition according to your advice, chux, thanks!"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1513774081, "post_id": 47894535, "comment_id": 82779650, "body": "A read will never cause a SIGPIPE.  Subsequent reads will immediately return 0 (or -1).  Only writes can generate a SIGPIPE."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1513783602, "post_id": 47894535, "comment_id": 82786109, "body": "@WilliamPursell You are correct; I got confused, and you can&#39;t edit old comments."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1513860290, "post_id": 47894535, "comment_id": 82818106, "body": "Suggest using <code>select()</code> with a timeout."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1513715292, "post_id": 47894577, "comment_id": 82756064, "body": "&quot;exec never returns.&quot; --&gt; &quot;... normally don\u2019t return, ... A value of -1 is returned in the event of a failure.&quot;"}], "tags": [], "owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "is_accepted": true, "score": 4, "last_activity_date": 1513724740, "last_edit_date": 1513724740, "creation_date": 1513714701, "answer_id": 47894577, "question_id": 47894535, "link": "https://stackoverflow.com/questions/47894535/how-to-exit-while-loop-when-read-blocks/47894577#47894577", "title": "How to exit while loop when read() blocks", "body": "<p>Except in case of error, exec never returns.  So when you write: </p>\n\n<pre><code>    execvp(args1[0],args1);\n    if(close(fd1[0])&lt;0){ //close used pipe\n        error();\n    }\n</code></pre>\n\n<p>you are wrong to expect the file descriptor to be closed.  Close them before you exec.  They are getting left open.  Although in your particular case the problem is that the parent never closes fd 1.  The parent has two file descriptors that are writing into the pipe ( <code>fd[1]</code> and <code>1</code>), and you need to close them both before the child reading the pipe will finish.</p>\n"}], "owner": {"reputation": 39, "user_id": 5066325, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wu2msNP56bA/AAAAAAAAAAI/AAAAAAAAFWs/hdi8joxSq6Y/photo.jpg?sz=128", "display_name": "Eric31", "link": "https://stackoverflow.com/users/5066325/eric31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 47894577, "answer_count": 1, "score": 1, "last_activity_date": 1513724740, "creation_date": 1513714469, "question_id": 47894535, "link": "https://stackoverflow.com/questions/47894535/how-to-exit-while-loop-when-read-blocks", "title": "How to exit while loop when read() blocks", "body": "<p>In a problem given by university we have to <code>pipe</code> from a parent process(P1) to its child P2, and afterwards P2 must pipe to another child of P1, the other child is P3. Both P2 and P3 are to be written in c and made into executable files. They will then by <code>exec</code>ed by child processes in P1.</p>\n\n<p>P1 writes the numbers 1 to 10000 to <code>stdout</code>, P2 reads them through its <code>stdin</code>, removes the numbers divisible by 2, and writes the result to its <code>stdout</code>. P3 reads those numbers through its <code>stdin</code>, filters out the results that are divisible by 3, and writes everything to a file.</p>\n\n<p>I have managed to implement absolutely everything, but my child processes do not end. The reason for this, I believe, is that I have used the following method to read the input in each child:</p>\n\n<pre><code>while(n=read(0, &amp;i, sizeof(i))&gt;0)\n</code></pre>\n\n<p>The problem here, as I understand it, is that <code>read</code> blocks when it doesn't get any bytes. As P1 writes the 10000 numbers using:</p>\n\n<pre><code>for(i=1; i&lt;=10000; i++){\n        write(1, &amp;i, sizeof(i));\n    }\n</code></pre>\n\n<p>Neither child process ever has any reason to believe that no more data is coming its way. Therefore, each <code>read</code> simply blocks waiting for a byte that will never come. </p>\n\n<p>Can anyone suggest a way to overcome this roadblock?</p>\n\n<p>The code of each process is as follows:</p>\n\n<p>Parent:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;string.h&gt;\n#include&lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n\n\nint main()\n{\n        // pipe to send input string from parent\n        // Child prints to file \n        int fd1[2];  // Used to store two ends of first pipe\n        int fd2[2];  // Used to store two ends of second pipe\n\n    //variables\n    int n, i, status1, status2;\n    char *args1[]={\"./Div2\",NULL};\n    char *args2[]={\"./Div3\",NULL};\n\n\n    //child process ids\n        pid_t pid1, pid2;\n\n    //open pipe 1\n        if (pipe(fd1)==-1)\n        {\n            fprintf(stderr, \"Pipe 1 Failed\" );\n            return 1;\n        }\n    //open pipe 2\n    if (pipe(fd2)==-1)\n        {\n            fprintf(stderr, \"Pipe 2 Failed\" );\n            return 1;\n        }\n\n    //create child 1    \n    pid1 = fork();  \n    if(pid1&lt;0){\n        printf(\"Error creating child1\\n\");\n        return(1);\n    }\n    if(pid1==0){ //child1\n        if(close(fd1[1])&lt;0){ //child does not write to pipe 1\n            error();\n        }\n        if(close(fd2[0])&lt;0){ //child does not read from pipe 2\n            error();\n        }\n        dup2(fd1[0], 0); //redirect stdin\n        dup2(fd2[1], 1); //redirect stdout\n            execvp(args1[0],args1);\n        if(close(fd1[0])&lt;0){ //close used pipe\n            error();\n        }\n        if(close(fd2[0])&lt;0){ //close used pipe\n            error();\n        }\n        exit(0);\n    }\n\n    pid2=fork();\n    if(pid2&lt;0){\n        printf(\"Error creating child2\\n\");\n        return(1);\n    }\n    if(pid2==0){ //child2\n        if(close(fd1[0])&lt;0){ //child does not use pipe 1\n            error();\n        }\n        if(close(fd1[1])&lt;0){ \n            error();\n        }\n        if(close(fd2[1])&lt;0){ //child does not write to pipe 2\n            error();\n        }\n        dup2(fd2[0], 0); //redirect stdin\n        execvp(args2[0], args2);\n        if(close(fd2[0])&lt;0){ //close pipe after use\n            error();\n        }\n        exit(0);\n    }\n\n\n    //parent\n    //parent doesn't read from the pipe\n    if(close(fd1[0])&lt;0){\n    error();\n    }\n    if(close(fd2[0])&lt;0){\n    error();\n    }\n    if(close(fd2[1])&lt;0){\n    error();\n    }\n    dup2(fd1[1], 1); //redirect stdout\n    for(i=1; i&lt;=10000; i++){\n        write(1, &amp;i, sizeof(i));\n    }\n    if(close(fd1[1])&lt;0){\n    error();\n    }\n    int returnedPID1=waitpid(pid1, &amp;status1, 0);\n    if(returnedPID1==pid1){\n    printf(\"Parent waited for child as predicted\\n\");\n    }\n    int returnedPID2=waitpid(pid2, &amp;status2, 0);\n    if(returnedPID2==pid2){\n    printf(\"Parent waited for child as predicted\\n\");\n    }\n    _exit(0);\n\n}\n</code></pre>\n\n<p>P2 (includes excluded)</p>\n\n<pre><code>int main()\n{\n    int n;\n    int i;\n    while((n=read(0, &amp;i, 4))&gt;0){\n        if((i%2)!=0){\n            write(1, &amp;i, sizeof(i));\n        }   \n    }\n    return;\n}\n</code></pre>\n\n<p>P3</p>\n\n<pre><code>int main()\n{\n    int n;\n    int i;\n    char tmp[12] = {0x0};\n    char *arg[]= {\"/home/eric/Documents/pr3/test.txt\"};\n    int fp = open(arg[0], O_WRONLY|O_CREAT|O_TRUNC, 0666);\n        if(fp&lt;0){\n            printf(\"Error opening file\\n\");\n            _exit(1);\n        }\n\n    while((n=read(0, &amp;i, 4))&gt;0){\n        if((i%3)!=0){\n            sprintf(tmp,\"%11d\", i);\n            write(fp, tmp, strlen(tmp));\n        }   \n    }\n    return;\n}\n</code></pre>\n\n<p>Thanks guys.</p>\n"}, {"tags": ["c", "macos", "gcc"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1513713488, "post_id": 47894308, "comment_id": 82755273, "body": "Type <code>gcc --version</code>.The error <code>clang: error: no input files</code> shows that GCC is already installed on your system."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1513713718, "post_id": 47894308, "comment_id": 82755368, "body": "I&#39;ve edited my question with the output of the this command, the confusion is, is it gcc or clang compiling my c program? I&#39;d like to work directly with gcc."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1513713988, "post_id": 47894308, "comment_id": 82755472, "body": "The compiler that comes with XCode is Clang, but it should be compatible with gcc&#39;s command line.  That&#39;s one reason why gcc is an alias to clang.  Just curious, but why does it matter?"}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513714788, "post_id": 47894308, "comment_id": 82755819, "body": "they say gcc is better, <a href=\"https://stackoverflow.com/questions/8205858/clang-vs-gcc-for-my-linux-development-project\" title=\"clang vs gcc for my linux development project\">stackoverflow.com/questions/8205858/&hellip;</a>"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1513715313, "post_id": 47894308, "comment_id": 82756073, "body": "@Developer The answers on that question are 6 years old. They&#39;re no longer accurate."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513721868, "post_id": 47894308, "comment_id": 82758817, "body": "ok, so is Clang good for compiling very small binary from pure vanilla C code? I just don&#39;t want anything that has to do with C++, i want pure machine code coming out of C code without any overheads or any of bells and whistles of C++ etc. in either my static/dynamic libraries or application."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513722018, "post_id": 47894308, "comment_id": 82758883, "body": "In fact if by mistake I use any of c++ language constructs or c++ libraries, the compiler should throw errors and do not compile the code, i want to enforce C only code. Whereas I assume Clang will compile both. Please advise."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513726769, "post_id": 47894308, "comment_id": 82760378, "body": "I still do my development on Mac running macOS High Sierra using GCC 7.2.0 compiled from source, using basically the recipe from the cross-referenced question (the versions of GCC and its support libraries have changed; I install to a version-named directory under <code>&#47;opt&#47;gcc</code> rather than <code>$HOME</code>, but that&#39;s very malleable (there might even be a case for building it to install under <code>&#47;usr&#47;local</code>).  For my purposes, it is useful to have multiple versions of GCC available (I have versions as far back as 4.8.1 on one machine; whether they all work is more negotiable)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513727010, "post_id": 47894308, "comment_id": 82760451, "body": "The only gotcha I&#39;ve run into recently is that the <code>&#47;usr&#47;include&#47;sys&#47;syslog.h</code> file runs foul of <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=82200\" rel=\"nofollow noreferrer\">GCC bug 82200</a>.  Temporarily, I&#39;ve worked around it by making a local copy of the header and using that instead of the standard one.  That isn&#39;t entirely satisfactory.  Using Brew or similar is arguably simpler.  I&#39;m a stubborn old dinosaur and still like to compile my own versions of GCC."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513727081, "post_id": 47894308, "comment_id": 82760469, "body": "@JonathanLeffler Ok, What&#39;s your opinion about the binaries produced from GCC and CLang, which one you think produces more efficient and lightweight, standalone/independent binaries."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513727305, "post_id": 47894308, "comment_id": 82760538, "body": "I understand your point, old is gold. Similarly I&#39;m old fashioned to use vanilla c code only without all the bells of whistles of C++ and any it&#39;s compilers, want to get pure simple machine code in binary outputs. Compiling from source is big undertaking for me and I don&#39;t have that much experience with tools but perhaps later down the road. Shall I favor GCC over Clang? My objective is to build a static library in plain vanilla C along with unit tests that will be used across Unix, Mac and Windows. @JonathanLeffler would you like to get into chat session?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513727383, "post_id": 47894308, "comment_id": 82760560, "body": "I don&#39;t have a view on that. In some ways, Clang is even more modern than GCC. I sometimes compile with both; I don&#39;t recall noticing a difference in file sizes big enough to worry about, but I&#39;ve not looked hard. If I were building for distribution to other people&#39;s systems, I&#39;d probably use Clang. In particular with C++, there are support libraries that would have to be installed for true GCC where there wouldn&#39;t be a problem with Clang. I do check compilations with both compilers (in 32-bit and 64-bit modes), with lots of warnings enabled. It&#39;s one way of checking that the code is portable."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513727550, "post_id": 47894308, "comment_id": 82760603, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/161558/discussion-between-developer-and-jonathan-leffler\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513721611, "post_id": 47894800, "comment_id": 82758714, "body": "Thanks for the enlightenment. I&#39;ve some questions since I&#39;m coming back to C after a long time but except language constructs have very basic knowledge of the tools and the architecture. Why I shouldn&#39;t work with GCC on macOS, curious."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513721714, "post_id": 47894800, "comment_id": 82758748, "body": "secondly when you say gcc cannot be used to build native macOS applications what does it mean? I won&#39;t be able to run a hello world app? confused here. Please also define native apps."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 1, "creation_date": 1513722166, "post_id": 47894800, "comment_id": 82758930, "body": "My good reason is that I want to build pure vanilla C libraries and apps, the compiler should throw errors if I use any of C++ language constructs or libraries."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513722535, "post_id": 47894800, "comment_id": 82759065, "body": "By &quot;native&quot;, I mean a macOS GUI application (i.e, displays windows, has an icon in the Dock -- as opposed to a command-line application which runs in the terminal). And if you really want to avoid C++, you&#39;ll have a tough time of that: <a href=\"https://github.com/opensource-apple/dyld\" rel=\"nofollow noreferrer\">the macOS dynamic linker</a> -- which is required to launch any program -- is written in C++, as is the XNU kernel."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513722798, "post_id": 47894800, "comment_id": 82759138, "body": "Ok, my scope is limited to command line apps, static libraries (.a files) with some networking. If i understand correctly dynamic linker is just for launching the app, it&#39;s not adding anything related to C++ to my static library or app, right?"}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513723991, "post_id": 47894800, "comment_id": 82759582, "body": "also can you help me choose between Make or CMake build tools considering the reservation I&#39;ve against C++."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513726764, "post_id": 47894800, "comment_id": 82760376, "body": "also is there a unit testing framework based on Clang, LLVM stack, any recommendations to stay within C only."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1513727296, "post_id": 47894800, "comment_id": 82760535, "body": "1) You&#39;re posing extra questions in these comments which don&#39;t relate to what you initially asked about. Ask a separate question if you have more questions, but keep in mind that software recommendations are off-topic here. 2) Clang is literally just a C/C++ compiler. It doesn&#39;t have its own unit testing framework."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2052717"}, "edited": false, "score": 0, "creation_date": 1538919566, "post_id": 47894800, "comment_id": 92305057, "body": "nvcc fatal   : The version (&#39;10.0&#39;) of the host compiler (&#39;Apple clang&#39;) is not supported make: *** [clock.o] Error 1 -- This good enough for you..?"}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 2, "last_activity_date": 1513715744, "creation_date": 1513715744, "answer_id": 47894800, "question_id": 47894308, "link": "https://stackoverflow.com/questions/47894308/install-gcc-on-mac-os-high-sierra/47894800#47894800", "title": "Install GCC on Mac OS high sierra", "body": "<blockquote>\n  <p>Any idea on how can I install <a href=\"https://gcc.gnu.org/\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/</a> standalone on my system?</p>\n</blockquote>\n\n<p>Generally speaking: Don't. That isn't a standard configuration; Clang is the recommended compiler for current macOS systems.</p>\n\n<p>If you have a <em>very</em> good reason, you can use <a href=\"https://brew.sh/\" rel=\"nofollow noreferrer\">Homebrew</a> to install GCC (<code>brew install gcc</code>). Keep in mind that it cannot be used to build native macOS applications.</p>\n"}], "owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18186, "favorite_count": 1, "accepted_answer_id": 47894800, "answer_count": 1, "score": 3, "last_activity_date": 1526138032, "creation_date": 1513713433, "last_edit_date": 1513713703, "question_id": 47894308, "link": "https://stackoverflow.com/questions/47894308/install-gcc-on-mac-os-high-sierra", "title": "Install GCC on Mac OS high sierra", "body": "<p>I've already visited the following answer but my question is different.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21173518/install-gnu-gcc-on-mac\">Install GNU GCC on mac</a></p>\n\n<p>Mac OS ships with Clang and somehow <code>/usr/bin/gcc</code> is linked to Clang tool I assume because of this line.</p>\n\n<pre><code>gcc\n</code></pre>\n\n<blockquote>\n  <p>clang: error: no input files</p>\n</blockquote>\n\n<p>Any idea on how can I install <a href=\"https://gcc.gnu.org/\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/</a> standalone on my system?</p>\n\n<pre><code>gcc --version\n</code></pre>\n\n<blockquote>\n  <p>Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/c++/4.2.1</p>\n  \n  <p>Apple LLVM version 9.0.0 (clang-900.0.38)</p>\n  \n  <p>Target: x86_64-apple-darwin17.2.0</p>\n  \n  <p>Thread model: posix</p>\n  \n  <p>InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</p>\n</blockquote>\n"}, {"tags": ["c++", "c", "objdump", "dumpbin"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1513710458, "post_id": 47893559, "comment_id": 82753785, "body": "I don&#39;t know whether you have any reason to <i>ever</i> have a <code>.bss</code> segment in a Windows binary.  That format is completely different from ELF.  In an ELF executable, however, the <code>.bss</code> segment is where you would find global data that is implicitly or explicitly initialized to all zeroes.  Your sample program has no such data."}, {"owner": {"reputation": 39, "user_id": 9119575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbeb8006ad558018842440c926425591?s=128&d=identicon&r=PG&f=1", "display_name": "Tracy", "link": "https://stackoverflow.com/users/9119575/tracy"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1513710527, "post_id": 47893559, "comment_id": 82753816, "body": "@JohnBollinger i tried to add those fields in the program but the output doesn&#39;t change."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1513717260, "post_id": 47893559, "comment_id": 82756916, "body": "See <a href=\"https://reverseengineering.stackexchange.com/questions/4230/why-i-can-not-directly-get-the-content-of-bss-section\">Why I can not directly get the content of <code>.bss</code> section?</a>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1513728576, "post_id": 47893559, "comment_id": 82760813, "body": "add option <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/map-generate-mapfile\" rel=\"nofollow noreferrer\">/MAP</a> to linker and look what symbols actualy in .bss segment. and anyway map fie here more useful for understand, compare <code>link -dump</code> command"}], "owner": {"reputation": 39, "user_id": 9119575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbeb8006ad558018842440c926425591?s=128&d=identicon&r=PG&f=1", "display_name": "Tracy", "link": "https://stackoverflow.com/users/9119575/tracy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513710940, "creation_date": 1513710087, "last_edit_date": 1513710486, "question_id": 47893559, "link": "https://stackoverflow.com/questions/47893559/why-there-is-no-bss-segment-in-coff-object-file", "title": "Why there is no .bss segment in COFF object file?", "body": "<p>A simple hello world program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"Hello, world!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>After <em>dumpbin</em> it with <strong><em>/HEADERS</em></strong> flag, i get those segments:</p>\n\n<pre><code>  8 .bss\n  A0 .debug$S\n  62 .drectve\n  F .rdata\n  8B .text$mn\n</code></pre>\n\n<p>If compile the program with <strong>/TC</strong>, so that it's a C program, i get those segments after the same use of a dumpbin:</p>\n\n<pre><code>2000 .data\n1000 .gfids\n7000 .rdata\n1000 .reloc\n10000 .text\n</code></pre>\n\n<p>point is:</p>\n\n<p>How do i get this similar kind of output:</p>\n\n<pre><code># objdump -hrt hello.o\nhello.o:     file format elf32-i386\n\nSections:\nIdx Name          Size     VMA       LMA       File off  Algn\n  0 .text         00000011 00000000  00000000  00000034  2**2\n                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE\n  1 .data         00000000 00000000  00000000  00000048  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n  2 .bss          00000000 00000000  00000000  00000048  2**2\n                  ALLOC\n  3 .rodata.str1.1 0000000d  00000000  00000000  00000048 2**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .comment      00000033  00000000 00000000  00000055  2**0\n                  CONTENTS, READONLY\n\nSYMBOL TABLE:\n00000000 l    df *ABS*  00000000 hello.c\n00000000 l    d  .text  00000000\n00000000 l    d  .data  00000000\n00000000 l    d  .bss   00000000\n00000000 l    d  .rodata.str1.1 00000000\n00000000 l    d  .comment       00000000\n00000000 g    F  .text  00000011 main\n00000000         *UND*  00000000 puts\n</code></pre>\n"}, {"tags": ["c", "compiler-construction", "rust", "llvm", "debug-symbols"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1530905355, "post_id": 47893551, "comment_id": 89414394, "body": "I would ask that on some <code>llvm</code> mailing list, perhaps <a href=\"http://lists.llvm.org/mailman/listinfo/llvm-dev\" rel=\"nofollow noreferrer\">llvm-dev</a>"}, {"owner": {"reputation": 1340, "user_id": 752911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17d2678d8ac40cec4ca8dfd968350d3?s=128&d=identicon&r=PG", "display_name": "Jason Enochs", "link": "https://stackoverflow.com/users/752911/jason-enochs"}, "edited": false, "score": 0, "creation_date": 1530908113, "post_id": 47893551, "comment_id": 89415341, "body": "I use vim as my IDE with a plugin called YouCompleteMe.  That plugin provides debug information using LLVM but is not written in Rust.  Maybe looking at that code will help?  The plugin&#39;s author is also very responsive and his code is on github."}, {"owner": {"reputation": 861, "user_id": 4085230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9e0208894241fb67b47aafc4e316ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Rousskov", "link": "https://stackoverflow.com/users/4085230/mark-rousskov"}, "edited": false, "score": 2, "creation_date": 1530975328, "post_id": 47893551, "comment_id": 89428904, "body": "You can also try looking at the Rust compiler&#39;s debuginfo generation; I&#39;m not sure if we use the C bindings or not though: <a href=\"https://github.com/rust-lang/rust/blob/master/src/librustc_codegen_llvm/debuginfo/mod.rs\" rel=\"nofollow noreferrer\">github.com/rust-lang/rust/blob/master/src/librustc_codegen_l&zwnj;&#8203;lvm/&hellip;</a>."}, {"owner": {"reputation": 199, "user_id": 9608876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Carson Harmon", "link": "https://stackoverflow.com/users/9608876/carson-harmon"}, "edited": false, "score": 1, "creation_date": 1537903657, "post_id": 47893551, "comment_id": 91951383, "body": "Please share the answer if you manage to find it!"}], "answers": [{"tags": [], "owner": {"reputation": 6964, "user_id": 189270, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4br0S.jpg?s=128&g=1", "display_name": "Peeter Joot", "link": "https://stackoverflow.com/users/189270/peeter-joot"}, "is_accepted": false, "score": 3, "last_activity_date": 1572185958, "creation_date": 1572185958, "answer_id": 58580206, "question_id": 47893551, "link": "https://stackoverflow.com/questions/47893551/how-to-emit-debug-information-through-llvms-c-bindings/58580206#58580206", "title": "How to emit debug information through LLVMs C bindings?", "body": "<p>See <a href=\"https://llvm.org/doxygen/c_2DebugInfo_8h.html\" rel=\"nofollow noreferrer\">DebugInfo.h</a> for the mappings from the C++ LLVM debug info APIs to the C bindings.  Examples that you'll need are:</p>\n\n<ul>\n<li>new DIBuilder -> LLVMCreateDIBuilder()</li>\n<li>DIBuilder::createFile() -> LLVMDIBuilderCreateFile()</li>\n<li>DIBuilder::createCompileUnit() -> LLVMDIBuilderCreateCompileUnit()</li>\n<li>DIBuilder::createBasicType() -> LLVMDIBuilderCreateBasicType()</li>\n</ul>\n\n<p>(use those functions to setup the dwarf context for your compiler)</p>\n\n<p>The LLVMSetCurrentDebugLocation() function you mentioned is the equivalent of IRBuilder&lt;>::SetCurrentDebugLocation()</p>\n\n<p>For each debug expression, you want a debug location, and DWARF metadata for the expression.  That's done like the following (C++ fragment):</p>\n\n<pre><code>auto loc_glc = DebugLoc::get( line, column, dwFunc );\nm_dwBuilder-&gt;insertDeclare( r, dwVar_gr, m_dwBuilder-&gt;createExpression(), loc_glc, fooBB );\nm_builder.SetCurrentDebugLocation( loc_glc );\n</code></pre>\n\n<p>you'll want to associate the debug location with the DWARF expression, and then \"anchor\" that to your IRBuilder using LLVMSetCurrentDebugLocation().</p>\n"}], "owner": {"reputation": 265, "user_id": 3441086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18efadc546701b09779e21154f71f9b?s=128&d=identicon&r=PG&f=1", "display_name": "dotjpg3141", "link": "https://stackoverflow.com/users/3441086/dotjpg3141"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 3, "answer_count": 1, "score": 16, "last_activity_date": 1572185958, "creation_date": 1513710066, "last_edit_date": 1513952500, "question_id": 47893551, "link": "https://stackoverflow.com/questions/47893551/how-to-emit-debug-information-through-llvms-c-bindings", "title": "How to emit debug information through LLVMs C bindings?", "body": "<p>I'm currently toying around with a simple LLVM frontend written in Rust. I'm now trying to emit debug information. </p>\n\n<p>How can I emit this debug information (source locations and variables) through the C bindings? Is it even possible? Do I need to write a C++ wrapper? </p>\n\n<p>There seems to be a function for inserting source locations (LLVMSetCurrentDebugLocation; <a href=\"https://llvm.org/doxygen/group__LLVMCCoreInstructionBuilder.html#ga89d4d2e2d416f97ea0fc3f7fd7807452\" rel=\"noreferrer\">LLVM</a>; <a href=\"http://rustdoc.taricorp.net/llvm-sys/llvm_sys/core/fn.LLVMSetCurrentDebugLocation.html\" rel=\"noreferrer\">Rust</a>), but I don't know how to construct a proper <code>LLVMValue</code> containing this information. I guess it needs some kind of metadata.</p>\n"}, {"tags": ["c", "arrays", "file"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1513709615, "post_id": 47893438, "comment_id": 82753419, "body": "99% of the time this is a failure to properly NULL terminate a string and you walked off the end of your buffer. Why is <code>directory_name</code> a comically tiny ten character buffer? Try using something like <code>PATH_MAX</code> if it&#39;s defined for you, or 255 otherwise."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1513709755, "post_id": 47893438, "comment_id": 82753475, "body": "<code>char directory_name[10];</code> 10 characters (9 if you include the <code>\\0</code>) is very short for a directory name. This buffer might be overflowing, hence the nonsense data. I would bump it up to at least 250 characters. Also, there is no warning when the condition with 2 <code>strcmp</code> calls fail; this means that some of the pointers in <code>fileList</code> might be invalid."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 4, "creation_date": 1513709763, "post_id": 47893438, "comment_id": 82753483, "body": "You are off by one: you allocated <code>char *filesList[n]</code>, but iterate 0..n, inclusive: <code>for(i=0; i&lt;=n; i++)</code>. Use <code>i &lt; n</code> to fix this. Don&#39;t forget to delete the question, otherwise someone would provide a useless answer."}], "answers": [{"comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1513712178, "post_id": 47893510, "comment_id": 82754642, "body": "btw, instead of strlen, you could have used <code>directory-&gt;d_reclen</code>. Or <code>d_reclen + 1</code> in case of <code>strncpy</code>."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1513709867, "creation_date": 1513709867, "answer_id": 47893510, "question_id": 47893438, "link": "https://stackoverflow.com/questions/47893438/c-programming-writing-directory-file-names-into-an-array-strange-symbols-appea/47893510#47893510", "title": "C programming: writing directory file names into an array, strange symbols appear", "body": "<p>The line</p>\n\n<pre><code>strncpy (filesList[i],directory-&gt;d_name, strlen(directory-&gt;d_name) );\\\n</code></pre>\n\n<p>will copy the name WITHOUT the terminating NUL, so when you later print it, you'll see extra garbage on the end of the string.  Use <code>strcpy</code> instead.  Better yet, use <code>strdup</code> to allocate and copy the string in one step.</p>\n"}, {"tags": [], "owner": {"reputation": 974, "user_id": 7277468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6tMUS.jpg?s=128&g=1", "display_name": "Sandeep_black", "link": "https://stackoverflow.com/users/7277468/sandeep-black"}, "is_accepted": false, "score": 0, "last_activity_date": 1513717119, "creation_date": 1513717119, "answer_id": 47895096, "question_id": 47893438, "link": "https://stackoverflow.com/questions/47893438/c-programming-writing-directory-file-names-into-an-array-strange-symbols-appea/47895096#47895096", "title": "C programming: writing directory file names into an array, strange symbols appear", "body": "<p>Append a terminating null character at the end. You can use strdup() to avoid this.</p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1513722920, "last_edit_date": 1513722920, "creation_date": 1513720310, "answer_id": 47895707, "question_id": 47893438, "link": "https://stackoverflow.com/questions/47893438/c-programming-writing-directory-file-names-into-an-array-strange-symbols-appea/47895707#47895707", "title": "C programming: writing directory file names into an array, strange symbols appear", "body": "<p>After declare <code>char *filesList[n];</code> init last pointer to <code>NULL</code> <code>filesList[n] = NULL;</code> then change your loop to this </p>\n\n<pre><code>for(i=0; filesList[i]; i++) {\n   printf(\"%s\\n\", filesList[i]);\n}\n</code></pre>\n\n<p>You have that garbage because you try to access pointer that point to some part of memory that you not initialize.\nFor example you have directory Music/ with four files in it, file1, file2, file3, file4. So your initialization would be similar to this:</p>\n\n<pre><code>filesList[0] file4 copy\nfilesList[1] file2 copy\nfilesList[2] file1 copy\nfilesList[3] file3 copy\nfilesList[4] -&gt; point to some uninit part of memory\n</code></pre>\n\n<p>Then you in loop print filesList[4] and it show garbage.</p>\n\n<p>Also in statements like this  it would be better to use <code>continue</code> not empty body:</p>\n\n<pre><code>if (!strcmp(directory-&gt;d_name, \".\") || !strcmp(directory-&gt;d_name, \"..\"))\n{\n    continue;\n}\n</code></pre>\n\n<p>And also you can replace <code>strncpy()</code> with <code>snprintf()</code> It also always includes the null terminator <code>'\\0'</code>, unless the buffer size is 0 but you can check it or just add <code>'\\0'</code> manually</p>\n\n<pre><code>filesList[i][strlen(directory-&gt;d_name)] = '\\0';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513729586, "last_edit_date": 1513729586, "creation_date": 1513728373, "answer_id": 47897009, "question_id": 47893438, "link": "https://stackoverflow.com/questions/47893438/c-programming-writing-directory-file-names-into-an-array-strange-symbols-appea/47897009#47897009", "title": "C programming: writing directory file names into an array, strange symbols appear", "body": "<p>Don't use <em>magic numbers</em> in your code:</p>\n\n<pre><code>char directory_name[10];\n</code></pre>\n\n<p>If you need a constant, define one, or if an appropriate constant is already provided for the specific application, use that instead, e.g.</p>\n\n<pre><code>#ifndef PATH_MAX        /* declare constants as required */\n#define PATH_MAX 4096\n#endif\n\n#define NFILE 128\n...\nchar directory_name[PATH_MAX] = \"\",\n    ...\n</code></pre>\n\n<p>You can't be absolutely sure where the origin of any of your problems are because you fail to <em>VALIDATE</em> any of the required returns. All functions except <code>void</code> provide a return that can be used to indicate success or failure -- use them, e.g.</p>\n\n<pre><code>    /* open and VALIDATE directory with opendir */\n    ptr = opendir (directory_name);\n    if (!ptr) {\n        fprintf (stderr, \"error: directory open failed '%s'.\\n\", \n                directory_name);\n        return 1;\n    }\n    printf (\"\\nDirectory open '%s'\\n\", directory_name);\n</code></pre>\n\n<p>This is an <strong>absolute must</strong> for <em>User Input</em>.</p>\n\n<p>Your filled array indexes are between <code>0</code> and <code>n-1</code>, so your indexing of <code>for (i = 0; i &lt;= n; i++)</code> invokes <em>Undefined Behavior</em> by reading beyond the bounds of your VLA. Use <code>for (i = 0; i &lt; n; i++)</code></p>\n\n<p>Instead of making two passes over your directory, (the first to count the number of files, rewind, and the second to read the filenames), just allocate some reasonable number of pointers to char initially, keep track of the number you fill, and <code>realloc</code> when you reach the current limit. The following code does just that (as well as cleaning up your user input -- which should be simplified and made more robust by using <code>fgets</code> instead of <code>scanf</code>), e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;limits.h&gt;\n\n#ifndef PATH_MAX        /* declare constants as required */\n#define PATH_MAX 4096\n#endif\n\n#define NFILE 128\n\n/* simple function to empty stdin.\n * mandatory when taking user input with scanf\n */\nvoid empty_stdin()\n{\n    int c = getchar();\n\n    while (c != '\\n' &amp;&amp; c != EOF)\n        c = getchar();\n}\n\nint main (void) {\n\n    DIR *ptr = NULL;\n    struct dirent *directory = NULL;\n    char directory_name[PATH_MAX] = \"\",\n        **files = NULL;     /* using pointer to pointer to char */\n    size_t i, n = 0, nptr = NFILE;\n\n    /* prompt for and VALIDATE input of directory_name */\n    for (;;) {     /* loop until valid input received or user cancels */\n        int rtn;\n        printf (\"Enter Directory Name: \");\n        rtn = scanf (\"%s\", directory_name);\n        if (rtn == 1) {     /* good input, proceed */\n            empty_stdin();\n            break;\n        }\n        else if (rtn == EOF) {  /* user canceled input */\n            fprintf (stderr, \"user canceled input.\\n\");\n            return 1;\n        }   /* handle other error */\n        fprintf (stderr, \"error: invalid input.\\n\");\n        empty_stdin();\n    }\n\n    /* open and VALIDATE directory with opendir */\n    ptr = opendir (directory_name);\n    if (!ptr) {\n        fprintf (stderr, \"error: directory open failed '%s'.\\n\", \n                directory_name);\n        return 1;\n    }\n    printf (\"\\nDirectory open '%s'\\n\", directory_name);\n\n    /* allocate and VALIDATE nptr pointer for filenames */\n    files = calloc (nptr, sizeof *files);\n    if (!files) {\n        perror (\"pointer allocation failed\");\n        return 1;\n    }\n\n    /* read each filename, allocate/VALIDATE storage, copy to files[n],\n     * check total pointer allocation, realloc as required.\n     */\n    while ((directory = readdir (ptr)) != NULL) {\n        if (!strcmp (directory-&gt;d_name, \".\")    /* skip dot files */\n            || !strcmp (directory-&gt;d_name, \"..\"))\n            continue;\n        /* allocate VALIDATE storage for filename */\n        files[n] = malloc (strlen (directory-&gt;d_name) + 1);\n        if (!files[n]) {\n            perror (\"memory exhausted - filesList\");\n            return 1;\n        }\n        strcpy (files[n++], directory-&gt;d_name); /* copy filename */\n        /* check if ptr limit reached, if so realloc 2x pointers */\n        if (n == nptr) {\n            void *tmp = realloc (files, nptr * 2 * sizeof *files);\n            if (!tmp) {\n                perror (\"realloc failed - files\");\n                break;  /* files still points to original block */\n            }\n            files = tmp;\n            /* optional - zero all newly added memory */\n            memset (files + nptr, 0, nptr * sizeof *files);\n            nptr *= 2;  /* increment number currently allocated */\n        }\n    }\n\n    for (i = 0; i &lt; n; i++) {   /* indexes are 0 -&gt; n-1 */\n        printf (\"%s\\n\", files[i]);\n        free (files[i]);        /* don't forget to free memory */\n    }\n    free (files);   /* free pointers */\n\n    closedir (ptr);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/readdir_alloc\nEnter Directory Name: dat\nDirectory open 'dat'\nlastchgcol.txt\narrinpt.txt\n...\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/readdir_alloc\n==10547== Memcheck, a memory error detector\n==10547== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==10547== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==10547== Command: ./bin/readdir_alloc\n==10547==\nEnter Directory Name: dat\nDirectory open 'dat'\nlastchgcol.txt\narrinpt.txt\n...\n==10547==\n==10547== HEAP SUMMARY:\n==10547==     in use at exit: 0 bytes in 0 blocks\n==10547==   total heap usage: 248 allocs, 248 frees, 38,729 bytes allocated\n==10547==\n==10547== All heap blocks were freed -- no leaks are possible\n==10547==\n==10547== For counts of detected and suppressed errors, rerun with: -v\n==10547== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Using <code>fgets</code> is the recommended way to take user input. <code>scanf</code> if full of pitfall that trap new C programmers. <code>fgets</code> requires no more than you check the return and then overwrite the trailing <code>'\\n'</code> included in the buffer with a <em>nul-terminating</em> character. You could remove the entire <code>for</code> loop that loops until valid input is received using <code>scanf</code> with the following simplified code using <code>fgets</code>:</p>\n\n<pre><code>    size_t len;\n    printf (\"Enter Directory Name: \");\n    if (!fgets (directory_name, PATH_MAX, stdin)) {\n        fprintf (stderr, \"error: failed to read directory_name.\\n\");\n        return 1;\n    }\n    len = strlen (directory_name);\n    if (len &amp;&amp; directory_name[len - 1] == '\\n')\n        directory_name[--len] = 0;\n    else if (len + 1 == PATH_MAX) {\n        fprintf (stderr, \"error: directory_name too long.\\n\");\n        return 1;\n    }\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 9, "user_id": 9119494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50c28fecea40bfaf021492b04fd8952?s=128&d=identicon&r=PG&f=1", "display_name": "magictaser", "link": "https://stackoverflow.com/users/9119494/magictaser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1513729586, "creation_date": 1513709534, "last_edit_date": 1513723916, "question_id": 47893438, "link": "https://stackoverflow.com/questions/47893438/c-programming-writing-directory-file-names-into-an-array-strange-symbols-appea", "title": "C programming: writing directory file names into an array, strange symbols appear", "body": "<p>I'm trying to put the names of each of the files in a directory into an array. The code seems to work well up until I print the array itself.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;dirent.h&gt;\n\nint main ()\n{\n    char directory_name[10];\n    DIR *ptr;\n    int n, i;\n\n    n = 0;\n    i = 0;\n\n    //Ask user for directory name\n    struct dirent *directory;\n    printf (\"Enter Directory Name:\\t\");\n    scanf (\"%s\", directory_name);\n    ptr = opendir (directory_name);\n    printf (\"\\nDirectory %s\\n\", directory_name);\n\n    while ((directory = readdir (ptr)) != NULL) {\n        if (!strcmp (directory-&gt;d_name, \".\")\n            || !strcmp (directory-&gt;d_name, \"..\")) {\n\n        } else {\n            n++;\n        }\n    }\n\n    rewinddir (ptr);\n\n    char *filesList[n];\n\n    //Put file names into the array\n    while ((directory = readdir (ptr)) != NULL) {\n        if (!strcmp (directory-&gt;d_name, \".\")\n            || !strcmp (directory-&gt;d_name, \"..\")) {\n        } else {\n            filesList[i] = (char *) malloc (strlen (directory-&gt;d_name) + 1);\n            strncpy (filesList[i], directory-&gt;d_name,\n                    strlen (directory-&gt;d_name));\n            i++;\n        }\n    }\n    rewinddir (ptr);\n\n    for (i = 0; i &lt;= n; i++) {\n        printf (\"%s\\n\", filesList[i]);\n    }\n\n    closedir (ptr);\n    return 0;\n}\n</code></pre>\n\n<p>The filesList prints, but at the end of the print out, it adds another line with these symbols:  </p>\n\n<p>)\u2500\u00ecD$\u00e2\u2514\u2534\u03a6\u2534\u03b1\u00ebE\u2568\u0398\u00ef </p>\n\n<p>I would like to remove these symbols from the array. However, since I don't know what they are or where they are coming from, I have no idea where to even start. I am very new to C, so I apologize if this is a beginner question. </p>\n\n<p>I would like to clarify that the program is recognizing these symbols as a file name, even though there is no file by that name in the directory. The index is increased as if it were a file. </p>\n"}, {"tags": ["c", "string", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1513709109, "post_id": 47893315, "comment_id": 82753207, "body": "Why are you printing character by character instead of putting this into a NULL-terminated string buffer and just feeding that to <code>printf</code> directly? While <code>free(a)</code> is understandable, setting <code>a</code> to <code>NULL</code> is really pointless."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1513709178, "post_id": 47893315, "comment_id": 82753232, "body": "Normally you&#39;d tackle this problem by allocating an optimistically large buffer and if the user exceeds that size, reallocate with double the size. This avoids relentless reallocation."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1513709193, "post_id": 47893315, "comment_id": 82753240, "body": "Welcome to Stack Overflow! <a href=\"https://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of malloc() and family in C..</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1513709611, "post_id": 47893315, "comment_id": 82753417, "body": "<code>scanf(&quot;%[^0]c&quot;,&amp;a[i])</code> is not a valid format. I suggest you use <code>fgets</code> and reallocate in steps of say 100 bytes, and repeat until the <code>&#39;\\n&#39;</code> newline is detected at the end of the input string. Note that <code>&#39;\\0&#39;</code> does not terminate input strings, but only C strings."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1513710133, "post_id": 47893315, "comment_id": 82753661, "body": "Please don&#39;t edit your question from errors pointed out. Rolled back."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1513712778, "post_id": 47893315, "comment_id": 82754967, "body": "@WeatherVane <code>scanf(&quot;%[^0]c&quot;,&amp;a[i])</code> is a valid format, yet certainly not what OP wants."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513716505, "post_id": 47893315, "comment_id": 82756602, "body": "@chux yes, I phrased it poorly."}], "answers": [{"comments": [{"owner": {"reputation": 583, "user_id": 9090981, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8edd1343a0d8e8997f6f62599b02e83?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Dogra", "link": "https://stackoverflow.com/users/9090981/ashish-dogra"}, "edited": false, "score": 0, "creation_date": 1513709420, "post_id": 47893365, "comment_id": 82753339, "body": "but malloc() is also not solving the problem"}, {"owner": {"reputation": 583, "user_id": 9090981, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8edd1343a0d8e8997f6f62599b02e83?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Dogra", "link": "https://stackoverflow.com/users/9090981/ashish-dogra"}, "edited": false, "score": 0, "creation_date": 1513709639, "post_id": 47893365, "comment_id": 82753429, "body": "for strings of small length, it&#39;s working correctly but as the length grows it&#39;s stops working"}, {"owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "reply_to_user": {"reputation": 583, "user_id": 9090981, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8edd1343a0d8e8997f6f62599b02e83?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Dogra", "link": "https://stackoverflow.com/users/9090981/ashish-dogra"}, "edited": false, "score": 0, "creation_date": 1513709822, "post_id": 47893365, "comment_id": 82753512, "body": "That&#39;s a separate problem.  I explained why you weren&#39;t entering the loops.  If you need more help please edit and update your question."}], "tags": [], "owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "is_accepted": true, "score": 1, "last_activity_date": 1513709260, "creation_date": 1513709260, "answer_id": 47893365, "question_id": 47893315, "link": "https://stackoverflow.com/questions/47893315/i-have-written-this-code-and-but-its-not-working-properly/47893365#47893365", "title": "i have written this code and but it&#39;s not working properly", "body": "<p>You are not entering the loop because you allocated <code>a</code> with <code>calloc</code>, so <code>a[0]</code> is 0.  It will fail the initial <code>a[i]!=0</code> test of both of your <code>for</code> loops.</p>\n"}], "owner": {"reputation": 583, "user_id": 9090981, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8edd1343a0d8e8997f6f62599b02e83?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Dogra", "link": "https://stackoverflow.com/users/9090981/ashish-dogra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 47893365, "answer_count": 1, "score": -4, "last_activity_date": 1513710139, "creation_date": 1513709040, "last_edit_date": 1513710139, "question_id": 47893315, "link": "https://stackoverflow.com/questions/47893315/i-have-written-this-code-and-but-its-not-working-properly", "title": "i have written this code and but it&#39;s not working properly", "body": "<p>I am writing a code that accepts a string of length as much a user want and displays it.so this is what I have written</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nvoid main()\n{\n  char *a;\n  int i,n;\n  a=(char*)calloc(1,sizeof(char));\n  printf(\"enter the string\\t\");\n  for(i=0;a[i]!=0;i++)\n  {\n        scanf(\"%[^0]c\",&amp;a[i]);\n        n=2+i;\n        a=(char*)realloc(a,(n)*sizeof(char));\n  }\n  for(i=0;a[i]!=0;i++)\n  {\n        printf(\"%c\",a[i]);\n  }\n  free(a);\n  a=NULL;\n}\n</code></pre>\n\n<p>but it's not entering into the loop and accepts any input. can you tell me what's going wrong? THANKS</p>\n"}, {"tags": ["c", "string", "algorithm"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1513708191, "post_id": 47893113, "comment_id": 82752803, "body": "Evidently you are trying to access index -3 of your array at some point.  You should do some debugging."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1513708389, "post_id": 47893113, "comment_id": 82752892, "body": "<code>char</code> is a signed type, so character 0xFC is being interpreted as -3. Try <code>uint8_t *h = (uint8_t *)s;</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513708549, "post_id": 47893113, "comment_id": 82752954, "body": "@Saurabh dubey  The type char cab behave either as signed char or unsigned char. So you have explicitly to cast the expression h[j] to the type unsigned char. For example A[( unsigned char )h[j]] = 1;"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1513720417, "post_id": 47893113, "comment_id": 82758269, "body": "@VladfromMoscow: Agreed, but to be precise, <code>char</code> may be either signed or unsigned, and has the same representation as either <code>signed char</code> or <code>unsigned char</code>, but it&#39;s always a distinct type."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9072261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4771aa62e4c99959033c9165f0c56f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh dubey", "link": "https://stackoverflow.com/users/9072261/saurabh-dubey"}, "edited": false, "score": 0, "creation_date": 1513780394, "post_id": 47894164, "comment_id": 82783857, "body": "Thanks Vlad for explaining it. It was helpful."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1513713476, "last_edit_date": 1513713476, "creation_date": 1513712724, "answer_id": 47894164, "question_id": 47893113, "link": "https://stackoverflow.com/questions/47893113/runtime-error-message-line-17-index-3-out-of-bounds-for-type-int-256/47894164#47894164", "title": "Runtime Error Message: Line 17: index -3 out of bounds for type &#39;int [256]&#39;", "body": "<p>It seems you are trying to write a function that finds the length of the longest substring of unique characters.</p>\n\n<p>For starters the function should be declared like</p>\n\n<pre><code>size_t lengthOfLongestSubstring( const char *s );\n^^^^^^                           ^^^^^\n</code></pre>\n\n<p>These declarations in the outer scope of the function</p>\n\n<pre><code>int A[256] = {0};\n//... \nint temp = 0;\n</code></pre>\n\n<p>are redundant. The variables are not used in the function.</p>\n\n<p>The type <code>char</code> can behave either as the type <code>signed char</code> or the type <code>unsigned char</code>.  So in expressions like this <code>A[h[j]]</code> you have to cast explicitly the character used as index to the type <code>unsigned char</code> as for example</p>\n\n<pre><code>A[( unsigned char )h[j]]\n</code></pre>\n\n<p>The inner loop</p>\n\n<pre><code>for(int j=i;j&lt;len-1;j++){\n</code></pre>\n\n<p>will not execute for strings that contain only one character. So it does not make sense as it is written.</p>\n\n<p>This if statement</p>\n\n<pre><code>       if (max &lt; length) {\n                max = length ;\n            }\n</code></pre>\n\n<p>needs to be placed outside the inner loop.</p>\n\n<p>The algorithm used by you can be implemented the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nsize_t lengthOfLongestSubstring(const char *s)\n{\n    size_t longest = 0;\n\n    for (; *s; ++s )\n    {\n        size_t n = 0;\n        unsigned char letters[UCHAR_MAX] = { 0 };\n\n        for ( const char *p = s; *p &amp;&amp; !letters[(unsigned char)*p - 1]++; ++p) ++n;\n\n        if (longest &lt; n) longest = n;\n    }\n\n    return longest;\n}\n\nint main( void )\n{\n    char *s = \"123145\";\n\n    printf(\"The longest substring has %zu characters.\\n\",\n        lengthOfLongestSubstring(s));\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>The longest substring has 5 characters.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9072261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4771aa62e4c99959033c9165f0c56f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh dubey", "link": "https://stackoverflow.com/users/9072261/saurabh-dubey"}, "edited": false, "score": 0, "creation_date": 1513780325, "post_id": 47894391, "comment_id": 82783797, "body": "Got it.. it helped. Thanks :)"}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": false, "score": 0, "last_activity_date": 1513713799, "creation_date": 1513713799, "answer_id": 47894391, "question_id": 47893113, "link": "https://stackoverflow.com/questions/47893113/runtime-error-message-line-17-index-3-out-of-bounds-for-type-int-256/47894391#47894391", "title": "Runtime Error Message: Line 17: index -3 out of bounds for type &#39;int [256]&#39;", "body": "<p>Your code crashed because you read data out of range, suppose your input string is <em>amqpcsrumjjufpu</em> its length is 15, in outer loop for <code>i = 13</code> you do assigment </p>\n\n<pre><code>h = s + i; // h was updated to indicate to 13th element of s\n</code></pre>\n\n<p>and in inner loop for first iteration, you read this element (j == i == 13) </p>\n\n<pre><code>A[h[j]]\n</code></pre>\n\n<p>so, you try to read this element <code>A[*(h+j)]</code>, but <code>h</code> indicates to 13th element of s, and now you try to add 13 to this value, you want to read 26th position of <code>s</code>, you are out of range of <code>s</code> string. </p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9072261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4771aa62e4c99959033c9165f0c56f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh dubey", "link": "https://stackoverflow.com/users/9072261/saurabh-dubey"}, "is_accepted": false, "score": 0, "last_activity_date": 1513780908, "creation_date": 1513780908, "answer_id": 47908495, "question_id": 47893113, "link": "https://stackoverflow.com/questions/47893113/runtime-error-message-line-17-index-3-out-of-bounds-for-type-int-256/47908495#47908495", "title": "Runtime Error Message: Line 17: index -3 out of bounds for type &#39;int [256]&#39;", "body": "<p>Thanks Everyone for responses. While Vlad's code worked for all the test cases, here is my code that also passed all the test cases after changes suggested by Vlad and rafix. </p>\n\n<pre><code>int lengthOfLongestSubstring(char* s) {\n    char *h = s;\n    int max = 0;\n\n    int len = strlen(s); \n    if (len == 1) {\n        return 1;\n    }\n\n    for(int i = 0; i &lt; len;i ++){\n        int A[256] = {0};\n        int length = 0;\n        for(int j = i; j &lt; len; j++){\n\n            if (A[(unsigned char)h[j]] == 1) {\n                break;\n            } else {\n                A[(unsigned char) h[j]] = 1;\n                length +=1;\n            }\n\n        }\n        if (max &lt; length) {\n                max = length;\n            }\n    }\n\n    return max;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9072261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4771aa62e4c99959033c9165f0c56f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh dubey", "link": "https://stackoverflow.com/users/9072261/saurabh-dubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6276, "favorite_count": 1, "accepted_answer_id": 47894164, "answer_count": 3, "score": 0, "last_activity_date": 1513780908, "creation_date": 1513708095, "last_edit_date": 1513719178, "question_id": 47893113, "link": "https://stackoverflow.com/questions/47893113/runtime-error-message-line-17-index-3-out-of-bounds-for-type-int-256", "title": "Runtime Error Message: Line 17: index -3 out of bounds for type &#39;int [256]&#39;", "body": "<p>I need help to understand an issue with my C code. I am trying to find longest substring within a given string without character repetition. When run on the leetcode platform, the code below gives me an error for the String <code>\"amqpcsrumjjufpu\"</code>:</p>\n\n<blockquote>\n  <p>Runtime Error Message: Line 17: index -3 out of bounds for type 'int [256]' </p>\n</blockquote>\n\n<p>However, the same code works fine when I run it from my computer or any online editor. Please help me to understand this behaviour difference. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint lengthOfLongestSubstring(char* s) {\n    char *h = s;\n    int A[256] = {0};\n    int length = 0;\n    int temp = 0;\n    int max = 0;\n\n    int len = strlen(s);\n\n    for(int i = 0; i &lt; len;i ++){\n        int A[256] = {0};\n        length = 0;\n        h = s + i;\n        for(int j = i; j &lt; len-1; j++){\n\n            if (A[h[j]] == 1) {\n                break;\n            } else {\n                A[h[j]] = 1;\n                length +=1;\n            }\n\n            if (max &lt; length) {\n                max = length;\n            }                \n        }\n    }\n\n    return max;\n}\n\n\nint main() {        \n    char *s = \"amqpcsrumjjufpu\";\n    int ret = lengthOfLongestSubstring(s);\n    printf(\"SAURABH: %d\",ret);\n}\n</code></pre>\n"}, {"tags": ["c", "breakpoints", "stdio", "fclose"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1513707804, "post_id": 47893005, "comment_id": 82752620, "body": "I imagine you have a breakpoint set somewhere, perhaps inside the standard library code.  Is there a way in VS17 to view/list all breakpoints?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513708115, "post_id": 47893005, "comment_id": 82752774, "body": "<code>objectStr[j] != NULL</code> looks like code is comparing a <code>char</code> to a pointer.  Recommend <code>objectStr[j] != &#39;\\0&#39;</code> instead."}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1513708128, "post_id": 47893005, "comment_id": 82752779, "body": "@OliverCharlesworth Tried. Only lists the breakpoints in my project, not in the outside files. If there are any, I wasn&#39;t the one who put them there. And no, it doesn&#39;t work if I get rid of all my breakpoints."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1513708208, "post_id": 47893005, "comment_id": 82752809, "body": "I wonder if there&#39;s a write out of bounds corrupting <code>input</code>, maybe in <code>copyInputStr</code>?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1513708244, "post_id": 47893005, "comment_id": 82752828, "body": "Your memory allocations make no sense. You seem to be allocating an array of structures, but you only give them one byte each. Then you assign a current pointer, which you then overwrite with a new useless allocation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1513708276, "post_id": 47893005, "comment_id": 82752841, "body": "Code should check the return value of <code>fgets(objectStr, 38, input);</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1513708323, "post_id": 47893005, "comment_id": 82752856, "body": "Whatever warning level you&#39;re using, it isn&#39;t high enough. <a href=\"https://pastebin.com/CVQYXAqe\" rel=\"nofollow noreferrer\">A sample of warnings from clang here</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1513708342, "post_id": 47893005, "comment_id": 82752866, "body": "Post your sample input.  <code>fgets(objectQttStr, 4, input);</code> looks quite small for an integer."}, {"owner": {"reputation": 1096, "user_id": 541437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813c60c9048854d3588fa0a65268da0?s=128&d=identicon&r=PG", "display_name": "Erik Johnson", "link": "https://stackoverflow.com/users/541437/erik-johnson"}, "edited": false, "score": 1, "creation_date": 1513708383, "post_id": 47893005, "comment_id": 82752888, "body": "I think you&#39;re hitting an assert or a VS error, not a breakpoint.  I don&#39;t use VS, so I can&#39;t look further, but I suspect that you&#39;ve corrupted your input pointer somehow and fclose is complaining."}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1513708941, "post_id": 47893005, "comment_id": 82753125, "body": "@LeeDanielCrocker How do I assign them one byte? I thought I assign them just enough to contain objectQttStr number of objectType structures. And VS seems to agree, judging by the control values window."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1513709103, "post_id": 47893005, "comment_id": 82753205, "body": "I&#39;m assuming objQttStr means something like &quot;object quantity&quot;? It&#39;s passed to malloc directly. malloc&#39;s argument is a number of bytes, not a number of objects. Perhaps you meant to use calloc?"}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1513709500, "post_id": 47893005, "comment_id": 82753366, "body": "@LeeDanielCrocker objQttStr is passed wrapped in atoi(). So the value is passed. Honestly, I&#39;m not quite sure how malloc works, but the way I see it, it allocates (type *) malloc (amount), which means it allocates exactly type times amount memory. At least it&#39;s true for any other type. Maybe using a structure is the problem."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1513710114, "post_id": 47893005, "comment_id": 82753647, "body": "Nope. Malloc allocates bytes, period. You need to do that multiplication yourself, or else you&#39;ll be shitting all over unallocated memory and causing faults...hey..."}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1513710358, "post_id": 47893005, "comment_id": 82753749, "body": "@LeeDanielCrocker Interesting. So the things taught to us in our university are lies. I&#39;ll try to avoid allocating weird things and see if it works. Also, c can burn in hell."}], "answers": [{"comments": [{"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "edited": false, "score": 0, "creation_date": 1513711958, "post_id": 47893735, "comment_id": 82754511, "body": "You, sir, are amazing. You didn&#39;t only answer my question in the most possible depth, you also solved a few problems I&#39;ve been at myself (even though I&#39;ve figured them out meanwhile). You deserve infinite praise."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1513710810, "creation_date": 1513710810, "answer_id": 47893735, "question_id": 47893005, "link": "https://stackoverflow.com/questions/47893005/c-fclose-triggers-a-breakpoint/47893735#47893735", "title": "C - fclose() triggers a breakpoint", "body": "<p>First problem:</p>\n\n<pre><code>objectType *objectList = (objectType *)malloc(atoi(objectQttStr)), *currentObject = objectList;\ncurrentObject = (objectType *)malloc(atoi(objectQttStr));\n</code></pre>\n\n<p>The <code>malloc</code> function allocates a given number of bytes.  So if you have 5 objects, you only allocate 5 bytes.  That's not enough for your structs.  This results in you writing past the end of allocated memory which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>If you want it to allocate space for a specific number of objects, you need to multiply by the object size:</p>\n\n<pre><code>objectType *objectList = malloc(sizeof(*objectList)*atoi(objectQttStr));\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don't cast the return value of <code>malloc</code></a>.</p>\n\n<p>You also assign <code>currentObject</code> to the same value as <code>objectList</code> but then overwrite it with a separate memory allocation.  So get rid of the second <code>malloc</code>.</p>\n\n<p>Second problem:</p>\n\n<pre><code>        memset(&amp;strBuf, 0, sizeof(strBuf));\n\n        copyInputStr(&amp;strBuf, &amp;j, &amp;objectStr[j], inputType);\n\n        writeObject(&amp;strBuf, currentObject, inputType);\n</code></pre>\n\n<p>Your <code>copyInputStr</code> and <code>writeObject</code> function expect a <code>char *</code>, but you pass in the address of the <code>strBuf</code> array which has type <code>char (*)[30]</code>.  Get rid of the address-of operator here:</p>\n\n<pre><code>        memset(strBuf, 0, sizeof(strBuf));\n\n        copyInputStr(strBuf, &amp;j, &amp;objectStr[j], inputType);\n\n        writeObject(strBuf, currentObject, inputType);\n</code></pre>\n\n<p>Third problem:</p>\n\n<pre><code>void copyInputStr(char *strMod, int *strPos, char *strBlueprint, IOType writeType) {\n    for (*strPos; *strBlueprint != ' ' &amp;&amp; *strBlueprint != '\\n' &amp;&amp; *strBlueprint != NULL; *strPos = *strPos + 1) {\n        *strMod = *strBlueprint;\n        if (writeType == Country) toupper(*strMod);\n        strBlueprint++; strMod++;\n    }\n}\n</code></pre>\n\n<p>When you copy the characters in <code>strMod</code>, you're not adding a null byte at the end.  A string in C is a null-terminated array of characters, so what you end up with is not a string but just an array of characters.  When you later call <code>strcpy</code> on this array, the function doesn't find a null byte so it keeps reading until it does.  This causes the function to read uninitialized bytes and/or read past the end of the array, which again invokes undefined behavior.</p>\n\n<p>Add the null terminating byte after the loop.  Also, the result of the <code>toupper</code> function isn't assigned to anything, so it does nothing.  You need to assign it back to <code>*strMod</code>:</p>\n\n<pre><code>void copyInputStr(char *strMod, int *strPos, char *strBlueprint, IOType writeType) {\n    for (*strPos; *strBlueprint != ' ' &amp;&amp; *strBlueprint != '\\n' &amp;&amp; *strBlueprint != NULL; *strPos = *strPos + 1) {\n        *strMod = *strBlueprint;\n        if (writeType == Country) *strMod = toupper(*strMod);\n        strBlueprint++; strMod++;\n    }\n    *strMod = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 47893735, "answer_count": 1, "score": 1, "last_activity_date": 1513711132, "creation_date": 1513707610, "last_edit_date": 1513711132, "question_id": 47893005, "link": "https://stackoverflow.com/questions/47893005/c-fclose-triggers-a-breakpoint", "title": "C - fclose() triggers a breakpoint", "body": "<p>I'm writing a function (<code>*rwObjects()</code>) that will read a formatted file and save it's strings, one object at a time. Unfortunately, it's for my studies which have a restriction - stdio.h, stdlib.h and string.h is practically all I can use.</p>\n\n<p>Here's the problem: whenever I run the code, when it gets to the <code>fclose(input)</code>, VS17 says my project's triggered a breakpoint, and then opens a tab that says \"wntdll.pdb not loaded\" or something.</p>\n\n<p>The question is: how do I not trigger the breakpoint and close the file properly? Or, if the problem isn't in the file, where is it?</p>\n\n<p>Code (C):</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#define cnCOUNTRY_LENGTH 3\n#define cnOBJECT_NAME_LENGTH 30\n#define cnOBJECT_MAX 1000\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n//--\u041f\u043e\u043b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 objectType--\n//Country (0)       - \u0441\u0442\u0440\u043e\u043a\u0430 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u044b\n//ObjectName (1)    - \u0441\u0442\u0440\u043e\u043a\u0430 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430\n//Square (2)        - \u043f\u043b\u043e\u0449\u0430\u0434\u044c \u043e\u0431\u044a\u0435\u043a\u0442\u0430\n//Error (3)         - \u043e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0438 \u0441\u0442\u0440\u043e\u043a\u0438\ntypedef enum IOOptions {Country, ObjectName, Square, Error} IOType;\n\n//--\u0422\u0438\u043f \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u043c\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432--\n//char Country      - \u0441\u0442\u0440\u043e\u043a\u0430 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u044b\n//char ObjectName   - \u0441\u0442\u0440\u043e\u043a\u0430 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430\n//int Square        - \u043f\u043b\u043e\u0449\u0430\u0434\u044c \u043e\u0431\u044a\u0435\u043a\u0442\u0430\ntypedef struct object {\n    char Country[cnCOUNTRY_LENGTH];\n    char ObjectName[cnOBJECT_NAME_LENGTH];\n    int Square;\n} objectType;\n\n//--\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0441\u0442\u0440\u043e\u043a\u0438 objects.txt--\n//strMod            - \u0421\u0442\u0440\u043e\u043a\u0430, \u0432 \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0438\u0434\u0451\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\n//strPos            - \u041f\u043e\u0437\u0438\u0446\u0438\u044f \u0432 \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u043c\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0435\n//strBlueprint      - \u0421\u0442\u0440\u043e\u043a\u0430, \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0438\u0434\u0451\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\n//writeType         - \u041f\u043e\u043b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 objectType. \u041f\u0440\u0438 \"Country\" - \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0438\u0442 \u0432\u0432\u043e\u0434\u0438\u043c\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b \u0432 \u0432\u0435\u0440\u0445\u043d\u0438\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440 ('a' -&gt; 'A' \u0438 \u0442.\u0434.)\nvoid copyInputStr(char *strMod, int *strPos, char *strBlueprint, IOType writeType) {\n    for (*strPos; *strBlueprint != ' ' &amp;&amp; *strBlueprint != '\\n' &amp;&amp; *strBlueprint != NULL; *strPos = *strPos + 1) {\n        *strMod = *strBlueprint;\n        if (writeType == Country) toupper(*strMod);\n        strBlueprint++; strMod++;\n    }\n}\n\n//--\u0417\u0430\u043f\u0438\u0441\u044c \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0441\u0442\u0440\u043e\u043a\u0438 objects.txt \u0432 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043e\u0431\u044a\u0435\u043a\u0442--\n//strInput          - \u0421\u0442\u0440\u043e\u043a\u0430, \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0438\u0434\u0451\u0442 \u0437\u0430\u043f\u0438\u0441\u044c\n//objectOutput      - \u041e\u0431\u044a\u0435\u043a\u0442, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0438\u0434\u0451\u0442 \u0437\u0430\u043f\u0438\u0441\u044c\n//writeType         - \u041f\u043e\u043b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0438\u0434\u0451\u0442 \u0437\u0430\u043f\u0438\u0441\u044c\nvoid writeObject(char *strInput, objectType *objectOutput, IOType writeType) {\n    if (writeType == Country)\n        strcpy(objectOutput-&gt;Country, strInput);\n    else if (writeType == ObjectName)\n        strcpy(objectOutput-&gt;ObjectName, strInput);\n    else if (writeType == Square)\n        objectOutput-&gt;Square = atoi(strInput);\n    else printf(\"Error 1. Invalid parameters\");\n}\n\n//--\u0427\u0442\u0435\u043d\u0438\u0435 objects.txt \u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 objectType--\n//\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c \u043d\u0430 \u043f\u0435\u0440\u0432\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432\nobjectType *rwObjects() {\n    FILE *input = fopen(\"objects.txt\", \"r\");\n    char objectQttStr[4], objectStr[38];\n    fgets(objectQttStr, 4, input);\n    objectType *objectList = (objectType *)malloc(atoi(objectQttStr)), *currentObject = objectList;\n    currentObject = (objectType *)malloc(atoi(objectQttStr));\n    for (int i = 0; i &lt; atoi(objectQttStr); i++) {\n        fgets(objectStr, 38, input);\n        IOType inputType = Country;\n        for (int j = 0; objectStr[j] != NULL &amp;&amp; objectStr[j] != '\\n'; j++) {\n            char strBuf[cnOBJECT_NAME_LENGTH];\n            memset(&amp;strBuf, 0, sizeof(strBuf));\n\n            copyInputStr(&amp;strBuf, &amp;j, &amp;objectStr[j], inputType);\n\n            writeObject(&amp;strBuf, currentObject, inputType);\n\n            inputType++; \n        }\n        currentObject++;\n    }\n    fclose(input);         //this is where it happens\n    return objectList;\n}\n\nvoid main() {\n    objectType *objectList = rwObjects();\n    printf(\"\");\n}\n</code></pre>\n\n<p>This is one confusing program, but I've found no other way to conform the bloody rules, so let's put the coding style aside, shall we?</p>\n\n<p>Also, I know that should it run successfully, nothing would happen - that is by design. It's not finished yet.</p>\n\n<p>EDIT: Don't worry about validity of input data. All the input data formatting is explicitly stated in the task, ergo no checks are reqired. Still, for the curious, here it is:</p>\n\n<p>objects.txt:</p>\n\n<pre><code>3\nUSA WelfareArrangement 120\nRus PoiskZemli 30\nusa asdfEstate 1\n</code></pre>\n\n<p>EDIT 2: The moment I stopped using malloc, everything was fine. The question is - why exactly was it such a problem, and how would I create an array of the exact size I need, instead of creating max size evey time, if not with malloc?</p>\n"}, {"tags": ["c", "windows", "portable-executable"], "comments": [{"owner": {"reputation": 18433, "user_id": 826983, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8fc679891e6c3cf3aec3b353f3fb9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Falk", "link": "https://stackoverflow.com/users/826983/stefan-falk"}, "edited": false, "score": 1, "creation_date": 1513706641, "post_id": 47892726, "comment_id": 82752031, "body": "Couldn&#39;t you just read the <code>.exe</code> file from within that very program?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1513706644, "post_id": 47892726, "comment_id": 82752032, "body": "Yes. You should begin by studying the PE format."}], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 2073973, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6438d29162d2c10f0afc2b50ce7dc2fb?s=128&d=identicon&r=PG", "display_name": "user2073973", "link": "https://stackoverflow.com/users/2073973/user2073973"}, "edited": false, "score": 0, "creation_date": 1513777919, "post_id": 47898643, "comment_id": 82782229, "body": "It would be more efficient &amp; easier to just read the sections from it&#39;s own memory instead of reading it from disk"}, {"owner": {"reputation": 121, "user_id": 9105976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYLeB.jpg?s=128&g=1", "display_name": "Nishikant Mokashi", "link": "https://stackoverflow.com/users/9105976/nishikant-mokashi"}, "edited": false, "score": 0, "creation_date": 1514371719, "post_id": 47898643, "comment_id": 82949842, "body": "If you want virtual address refer this function                                            <a href=\"https://msdn.microsoft.com/en-us/library/ms680218(VS.85).aspx\" rel=\"nofollow noreferrer\">ImageRvaToVa</a>"}, {"owner": {"reputation": 543, "user_id": 2073973, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6438d29162d2c10f0afc2b50ce7dc2fb?s=128&d=identicon&r=PG", "display_name": "user2073973", "link": "https://stackoverflow.com/users/2073973/user2073973"}, "reply_to_user": {"reputation": 1, "user_id": 8177668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6505a0ebaa97185058c2ba5ba44ce1?s=128&d=identicon&r=PG&f=1", "display_name": "9090", "link": "https://stackoverflow.com/users/8177668/9090"}, "edited": false, "score": 0, "creation_date": 1514890333, "post_id": 47898643, "comment_id": 83091460, "body": "@9090 since you&#39;re trying to read your own process&#39;s sections, you can get the image base address using GetModuleHandle(NULL). You can directly cast that address to PIMAGE_DOS_HEADERS. Read everything from there. PS: Tag me next time, otherwise I don&#39;t get a notification."}], "tags": [], "owner": {"reputation": 121, "user_id": 9105976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYLeB.jpg?s=128&g=1", "display_name": "Nishikant Mokashi", "link": "https://stackoverflow.com/users/9105976/nishikant-mokashi"}, "is_accepted": false, "score": 2, "last_activity_date": 1513742850, "creation_date": 1513742850, "answer_id": 47898643, "question_id": 47892726, "link": "https://stackoverflow.com/questions/47892726/how-to-get-the-starting-address-of-each-pe-section-in-c/47898643#47898643", "title": "How to get the starting address of each PE section in C?", "body": "<p>Did you mean you want to access each section of exe ?\nIf yes, then find below way to do so:</p>\n\n<pre><code>#include&lt;windows.h&gt;\n#include&lt;stdio.h&gt;\n\nint main()\n{\n    LPCSTR fileName=\"inputFile.exe\";\n    HANDLE hFile;\n    HANDLE hFileMapping;\n    LPVOID lpFileBase;\n    PIMAGE_DOS_HEADER dosHeader;\n    PIMAGE_NT_HEADERS peHeader;\n    PIMAGE_SECTION_HEADER sectionHeader;\n\n    hFile = CreateFileA(fileName,GENERIC_READ,FILE_SHARE_READ,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,0);\n\n    if(hFile==INVALID_HANDLE_VALUE)\n    {\n        printf(\"\\n CreateFile failed \\n\");\n        return 1;\n    }\n\n    hFileMapping = CreateFileMapping(hFile,NULL,PAGE_READONLY,0,0,NULL);\n\n    if(hFileMapping==0)\n    {\n        printf(\"\\n CreateFileMapping failed \\n\");\n        CloseHandle(hFile);\n        return 1;\n    }\n\n    lpFileBase = MapViewOfFile(hFileMapping,FILE_MAP_READ,0,0,0);\n\n    if(lpFileBase==0)\n    {\n        printf(\"\\n MapViewOfFile failed \\n\");\n        CloseHandle(hFileMapping);\n        CloseHandle(hFile);\n        return 1;\n    }\n\n    dosHeader = (PIMAGE_DOS_HEADER) lpFileBase;\n    if(dosHeader-&gt;e_magic==IMAGE_DOS_SIGNATURE)\n    {\n        printf(\"\\n DOS Signature (MZ) Matched \\n\");\n\n        peHeader = (PIMAGE_NT_HEADERS) ((u_char*)dosHeader+dosHeader-&gt;e_lfanew);\n        if(peHeader-&gt;Signature==IMAGE_NT_SIGNATURE)\n        {\n            printf(\"\\n PE Signature (PE) Matched \\n\");\n            //once found valid exe or dll\n\n            //go to first section\n            sectionHeader = IMAGE_FIRST_SECTION(peHeader);\n            UINT nSectionCount = peHeader-&gt;FileHeader.NumberOfSections;\n\n            //No of sections\n            printf(\"\\n No of sections : %d \\n\",nSectionCount);\n\n            //sectionHeader contains address of first section\n            //traverse each section by below way\n            for( UINT i=0; i&lt;nSectionCount; ++i, ++sectionHeader )\n            {\n                //section information\n            }\n        }\n        else\n        {\n            return 1;\n        }\n    }\n    else\n    {\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8177668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6505a0ebaa97185058c2ba5ba44ce1?s=128&d=identicon&r=PG&f=1", "display_name": "9090", "link": "https://stackoverflow.com/users/8177668/9090"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513742850, "creation_date": 1513706431, "last_edit_date": 1513706986, "question_id": 47892726, "link": "https://stackoverflow.com/questions/47892726/how-to-get-the-starting-address-of-each-pe-section-in-c", "title": "How to get the starting address of each PE section in C?", "body": "<p>Is it possible to write a C code that retrieve its PE sections addresses after compiling it to <code>.exe</code> ?</p>\n"}, {"tags": ["c", "arrays", "struct", "compiler-errors"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1513703944, "post_id": 47892106, "comment_id": 82750686, "body": "Your <code>current</code> is of type <code>link</code>. <code>link</code> is a struct which does not have a member named <code>nd</code>. Seems pretty clear to me. Your <code>nd</code> is an array of <code>node</code> completely separate from <code>current</code>. What relationship do you want between them? It&#39;s not expressed in your code."}, {"owner": {"reputation": 19, "user_id": 8104471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KULraSTJQbc/AAAAAAAAAAI/AAAAAAAAANo/eP7R52RS2vA/photo.jpg?sz=128", "display_name": "joe jordishon", "link": "https://stackoverflow.com/users/8104471/joe-jordishon"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1513704218, "post_id": 47892106, "comment_id": 82750848, "body": "sorry typo, edited"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1513704292, "post_id": 47892106, "comment_id": 82750890, "body": "@joejordishon Your edition is wrong and does not make sense"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1513704366, "post_id": 47892106, "comment_id": 82750933, "body": "That edit doesn&#39;t help. You have now just created a type called <code>nd</code> (which is of type <code>struct Node</code>). <code>current</code> is still of type <code>link</code>, and that structure still does not have a member called <code>nd</code>."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1513705002, "post_id": 47892106, "comment_id": 82751253, "body": "C is a case-sensitive language. As such, <code>node</code> in your code is undefined."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1513705426, "post_id": 47892106, "comment_id": 82751431, "body": "Not directly related, but you should avoid hiding pointer types behind typedefs such as <code>typedef struct Node *link;</code>. This only adds confusion."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1513706216, "post_id": 47892106, "comment_id": 82751814, "body": "@machine_1 I thought so too, but this defines both <code>Node</code> and <code>node</code>. Convention would have it be <code>node_t</code> and <code>node</code> to avoid rampant confusion."}], "answers": [{"tags": [], "owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "is_accepted": false, "score": 0, "last_activity_date": 1513704207, "creation_date": 1513704207, "answer_id": 47892198, "question_id": 47892106, "link": "https://stackoverflow.com/questions/47892106/array-of-struct-error/47892198#47892198", "title": "Array of struct Error", "body": "<p>Change this:</p>\n\n<pre><code>current = current-&gt;nd[0].right;\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>current = nd[0].right;\n</code></pre>\n\n<p>Or, if you've already assigned something to current, then do this:</p>\n\n<pre><code>current = current-&gt;right;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1513704208, "creation_date": 1513704208, "answer_id": 47892199, "question_id": 47892106, "link": "https://stackoverflow.com/questions/47892106/array-of-struct-error/47892199#47892199", "title": "Array of struct Error", "body": "<p>It seems you mean the following.</p>\n\n<pre><code>typedef struct Node *link;\ntypedef struct Node\n{           \n    char data;\n    int count;    \n    link right;\n    link left;\n    link next; \n}node;\n\n\nnode nd[100];\nlink current;\n\n//...\n\ncurrent = nd;\ncurrent = current[0].right;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8104471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KULraSTJQbc/AAAAAAAAAAI/AAAAAAAAANo/eP7R52RS2vA/photo.jpg?sz=128", "display_name": "joe jordishon", "link": "https://stackoverflow.com/users/8104471/joe-jordishon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1513704208, "creation_date": 1513703869, "last_edit_date": 1513704113, "question_id": 47892106, "link": "https://stackoverflow.com/questions/47892106/array-of-struct-error", "title": "Array of struct Error", "body": "<p>Here is my code:</p>\n\n<pre><code>typedef struct Node *link;\ntypedef struct Node\n{           \n    char data;\n    int count;    \n    link right;\n    link left;\n    link next; \n}nd;\nnode nd[100];\nlink current;\n</code></pre>\n\n<p>When I tried to do this in the main</p>\n\n<pre><code>current = current-&gt;nd[0].right;\n</code></pre>\n\n<p>It showed me:<br>\n  [Error] 'struct Node' has no member named 'nd'<br>\nHow I can fix it?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1513703865, "post_id": 47892007, "comment_id": 82750645, "body": "<code>&lt;iostream.h&gt;</code> was pre-standard header for C++. Today it&#39;s not commonly provided by compilers. And it has nothing whatsover to do in C code."}], "owner": {"reputation": 21, "user_id": 8339335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jh0BZ.jpg?s=128&g=1", "display_name": "Biplap Bhattarai", "link": "https://stackoverflow.com/users/8339335/biplap-bhattarai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1513704338, "answer_count": 0, "score": 1, "last_activity_date": 1513705492, "creation_date": 1513703538, "last_edit_date": 1513705492, "question_id": 47892007, "link": "https://stackoverflow.com/questions/47892007/how-do-i-take-and-view-complex-type-input-in-c-on-this-program", "closed_reason": "Duplicate", "title": "How do i take and view complex type input in c on this program?", "body": "<p>In this code complex datatype is taken in c++ and while converting on c i dont know to take input and give output of complex data type. Can someone help me convert it from c++ to c. Will someone help me to take input and view complex data type in c on this program.</p>\n\n<p>//c++ program original</p>\n\n<pre><code>/***************** Newton horner's method ******************/\n#include&lt;iostream.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;complex.h&gt;\n#include&lt;math.h&gt;\nint main()\n{\n    complex a[20],b[20],c[20];\n    complex x;\n    int n,i;\n    clrscr();\n\n    cout&lt;&lt;\"Enter the degree of equations : \";cin&gt;&gt;n;\n    cout&lt;&lt;\"Enter all coefficients \\n\";\n    for(i=0;i&lt;=n;i++)\n        cin&gt;&gt;a[i];\n    cout&lt;&lt;\"enter initial guess:\";cin&gt;&gt;x;\n\n    while(n&gt;0)\n    {\n        c[0]=b[0]=a[0];\n        for(i=1;i&lt;=n;i++)\n            b[i]=a[i]+b[i-1]*x;\n        for(i=1;i&lt;n;i++)\n            c[i]=b[i]+c[i-1]*x;\n        if(abs(c[n-1])==0.0)   // for complex \"abs\" instead of \"fabs\"\n        {\n            cout&lt;&lt;\"Divide by Zero : ERROR !! \";\n            break;\n        }\n        x-=b[n]/c[n-1];\n        if(abs(b[n]/c[n-1])&lt;0.00001)\n        {\n            cout&lt;&lt;\"\\nRoot is: \"&lt;&lt;x&lt;&lt;\"f(x) \"&lt;&lt;b[n];\n            for(i=1;i&lt;n;i++)\n                a[i]=b[i];\n            n--;\n        }\n    }\ngetch();\nreturn 0;\n}\n</code></pre>\n\n<p>My try to convert c++ to c although it doesn't work.\n\"and i know that %f and %d is for float and integer but i was trying on this code.\"</p>\n\n<pre><code>/****************** Newton horner's method ******************/\n#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;complex.h&gt;\n#include&lt;math.h&gt;\nint main()\n{\n    float a[20],b[20],c[20];\n    float x;\n    int n,i;\n\n    printf(\"Enter the degree of equations : \");\n    scanf(\"%d\",&amp;n);\n    printf(\"Enter all coefficients \\n\");\n    for(i=0;i&lt;=n;i++)\n        scanf(\"%f\",&amp;a[i]);enter code here\n    printf(\"enter initial guess:\");\n    scanf(\"%f\",&amp;x);\n\n    while(n&gt;0)\n    {\n        c[0]=b[0]=a[0];\n        for(i=1;i&lt;=n;i++)\n            b[i]=a[i]+b[i-1]*x;\n        for(i=1;i&lt;n;i++)\n            c[i]=b[i]+c[i-1]*x;\n        if(fabs(c[n-1])==0.0)   // for complex \"abs\" instead of \"fabs\"\n        {\n            printf(\"Divide by Zero : ERROR !! \");\n            break;\n        }\n        x-=b[n]/c[n-1];\n        if(abs(b[n]/c[n-1])&lt;0.00001)\n        {\n            printf(\"\\nRoot is: %f and f(x) is %f\",x,b[n]);\n            for(i=1;i&lt;n;i++)\n                a[i]=b[i];\n            n--;\n        }\n    }\ngetch();\nreturn 0;\n}\n</code></pre>\n"}]