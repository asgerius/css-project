[{"tags": ["c", "sqlite", "pointers"], "comments": [{"owner": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "edited": false, "score": 0, "creation_date": 1439429443, "post_id": 31977288, "comment_id": 51862103, "body": "SQLite is used on <i>hundreds of millions</i> iOS and Android devices every day. Chances are, you haven&#39;t found a previously undiscovered bug in their fundamental number parsing."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4951117, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--9r-bh9W04Q/AAAAAAAAAAI/AAAAAAAAACU/GbLi23jE7tc/photo.jpg?sz=128", "display_name": "Anthony Santiago", "link": "https://stackoverflow.com/users/4951117/anthony-santiago"}, "edited": false, "score": 0, "creation_date": 1439424662, "post_id": 31977376, "comment_id": 51861070, "body": "This makes sense, but &#39;IsDigit(0)&#39; would evaluate to &#39;true&#39; because 0 is defined as a digit."}, {"owner": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "edited": false, "score": 0, "creation_date": 1439429715, "post_id": 31977376, "comment_id": 51862159, "body": "No, the <i>character</i> <code>&#39;0&#39;</code> (numeric value 48 in ASCII) will be recognized as a digit. The terminating NUL (numeric value 0) will not."}], "tags": [], "owner": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "is_accepted": false, "score": 1, "last_activity_date": 1439423992, "creation_date": 1439423992, "answer_id": 31977376, "question_id": 31977288, "link": "https://stackoverflow.com/questions/31977288/pointer-bounds-and-pointer-arithmetic-in-sqlite-source-code/31977376#31977376", "title": "Pointer bounds and pointer arithmetic in SQLite source code", "body": "<p>No, C strings are expected to be null terminated. </p>\n\n<p>If you pass a string containing only a <code>-</code> or <code>+</code> character, the <code>z</code> pointer will point to the null terminator after being incremented, and <code>IsDigit(*z)</code> will be equivalent to <code>IsDigit(0)</code>, which will evaluate to <code>false</code> and return 0.</p>\n"}], "owner": {"reputation": 51, "user_id": 4951117, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--9r-bh9W04Q/AAAAAAAAAAI/AAAAAAAAACU/GbLi23jE7tc/photo.jpg?sz=128", "display_name": "Anthony Santiago", "link": "https://stackoverflow.com/users/4951117/anthony-santiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439426176, "creation_date": 1439423364, "last_edit_date": 1439426176, "question_id": 31977288, "link": "https://stackoverflow.com/questions/31977288/pointer-bounds-and-pointer-arithmetic-in-sqlite-source-code", "title": "Pointer bounds and pointer arithmetic in SQLite source code", "body": "<p>I was browsing through the SQLite source code when I came across this function starting at line <code>387</code> in <code>shell.c</code>. </p>\n\n<p>Source code: <a href=\"https://www.sqlite.org/download.html\" rel=\"nofollow\">https://www.sqlite.org/download.html</a></p>\n\n<p>The function in question:</p>\n\n<pre><code>/*\n** Determines if a string is a number of not.\n*/\nstatic int isNumber(const char *z, int *realnum){\n  if( *z=='-' || *z=='+' ) z++;\n  if( !IsDigit(*z) ){\n    return 0;\n  }\n  z++;\n  if( realnum ) *realnum = 0;\n  while( IsDigit(*z) ){ z++; }\n  if( *z=='.' ){\n    z++;\n    if( !IsDigit(*z) ) return 0;\n    while( IsDigit(*z) ){ z++; }\n    if( realnum ) *realnum = 1;\n  }\n  if( *z=='e' || *z=='E' ){\n    z++;\n    if( *z=='+' || *z=='-' ) z++;\n    if( !IsDigit(*z) ) return 0;\n    while( IsDigit(*z) ){ z++; }\n    if( realnum ) *realnum = 1;\n  }\n  return *z==0;\n}\n</code></pre>\n\n<p>Note: IsDigit is a macro, which feeds an unsigned character into isdigit defined in ctype.</p>\n\n<pre><code>#define IsDigit(X)  isdigit((unsigned char)X)\n</code></pre>\n\n<p>The function and pointer use makes sense to me, however, the first two lines leads me to believe they may be used improperly based on my understanding.</p>\n\n<p>They use pointer arithmetic to shuffle through the string.</p>\n\n<pre><code>if( *z=='-' || *z=='+' ) z++; \n</code></pre>\n\n<p>If the char at the first position of the pointer is a '-' or '+', move the pointer over one position. However, this does not seem to take into account if the string passed into the function only has one character that happens to be a '-' or '+' symbol. </p>\n\n<pre><code>if( !IsDigit(*z) ){\n</code></pre>\n\n<p>When 'z' is dereferenced, isn't this corrupted/illegal memory access because it goes out of the bounds of the pointer, or is there something behind the scenes with pointer arithmetic that stops this from happening?</p>\n"}, {"tags": ["c", "intrinsics", "avx"], "comments": [{"owner": {"reputation": 5146, "user_id": 195447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996483d0dfbd79f30c9b99056f27553c?s=128&d=identicon&r=PG", "display_name": "Elalfer", "link": "https://stackoverflow.com/users/195447/elalfer"}, "edited": false, "score": 0, "creation_date": 1439439273, "post_id": 31977282, "comment_id": 51864404, "body": "How much you care about bytes order?"}, {"owner": {"reputation": 5146, "user_id": 195447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996483d0dfbd79f30c9b99056f27553c?s=128&d=identicon&r=PG", "display_name": "Elalfer", "link": "https://stackoverflow.com/users/195447/elalfer"}, "edited": false, "score": 0, "creation_date": 1439439938, "post_id": 31977282, "comment_id": 51864624, "body": "And do you process them as bytes later on in your algorithm?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1439473549, "post_id": 31977282, "comment_id": 51884471, "body": "Why don&#39;t you load 4 256 bits chunks and re-arrange them into 4 256 bit vectors?"}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "reply_to_user": {"reputation": 5146, "user_id": 195447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996483d0dfbd79f30c9b99056f27553c?s=128&d=identicon&r=PG", "display_name": "Elalfer", "link": "https://stackoverflow.com/users/195447/elalfer"}, "edited": false, "score": 0, "creation_date": 1439478750, "post_id": 31977282, "comment_id": 51888559, "body": "@Elalfer, yes ordering is important, and yes, once loaded, I perform byte level operations (In fact I perform a bit transposition)"}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1439479977, "post_id": 31977282, "comment_id": 51889475, "body": "@user3528438, sounds interesting, could you elaborate a little bit more?"}], "answers": [{"comments": [{"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1439850792, "post_id": 31978683, "comment_id": 52020184, "body": "Thanks for the tip,  indeed the compiler unrolled the loop (not completely though), the ugly was that a lot of redundant loads and stores were performed when filling the union byte-wise.  I ended up applying @Elalfer &#39;s solution to get rid of this problem."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1439930859, "post_id": 31978683, "comment_id": 52060698, "body": "@BlueStrat and davlet: the other weakness of this solution is that a store-&gt;load forwarding stall is guaranteed, because Intel and AMD CPUs both fail to forward multiple smaller stores to a wider load.  So there&#39;s an extra ~10 cycle latency penalty after all the byte-by-byte writes."}], "tags": [], "owner": {"reputation": 467, "user_id": 2646348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79dcb5a34dc981fa899f5f7afe6975a4?s=128&d=identicon&r=PG", "display_name": "davlet", "link": "https://stackoverflow.com/users/2646348/davlet"}, "is_accepted": false, "score": 2, "last_activity_date": 1439434033, "creation_date": 1439434033, "answer_id": 31978683, "question_id": 31977282, "link": "https://stackoverflow.com/questions/31977282/efficiently-gather-individual-bytes-separated-by-a-byte-stride-of-4/31978683#31978683", "title": "Efficiently gather individual bytes, separated by a byte-stride of 4", "body": "<p>You can try unrolling that loop, this should at least get rid of one comparison (i&lt;32), one increment (i++) and one multiplication (i*4) in the loop's body. Also constant array offsets might work slightly faster than variable. But note that your compiler might generate similar (or better) code anyway, with the appropriate compilation options enabled.</p>\n\n<pre><code>union {  __m256i   reg;   uint8_t bytes[32]; } aux;\n...\naux.bytes[0] = data[0];\naux.bytes[1] = data[3];\n...\naux.bytes[31] = data[124];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1439850623, "post_id": 32013564, "comment_id": 52020130, "body": "Nice solution!     Unfortunately I can&#39;t use BMI instructions, as the servers that will run this code don&#39;t  have CPUs with BMI support.  Thanks!"}, {"owner": {"reputation": 5146, "user_id": 195447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996483d0dfbd79f30c9b99056f27553c?s=128&d=identicon&r=PG", "display_name": "Elalfer", "link": "https://stackoverflow.com/users/195447/elalfer"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 1, "creation_date": 1439857998, "post_id": 32013564, "comment_id": 52022051, "body": "BMI suppose to be supported on all platforms with AVX2 support for both Intel &amp; AMD."}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1439914068, "post_id": 32013564, "comment_id": 52051238, "body": "you&#39;re totally right.  I stated AVX2 instructions but in reality my target CPUs only support AVX.  Still I could apply your technique. Thanks again!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1439929074, "post_id": 32013564, "comment_id": 52059743, "body": "@BlueStrat and Elalfer: if you want to do a 128b version of this, you could use <code>punpcklqdq</code> to combine registers (<code>dest[64:127] = src2[0:63]</code>).  This would cut down on needing different shuffle masks.  Also possibly interesting is AND-masking the bytes you don&#39;t want to zero, then using <code>packusdw</code> to squish dwords from 2 concatenated regs down to words in 1 reg.  Neither of these is great, and I think using <code>POR</code> for the merging is the best bet.  pack/punpck won&#39;t help at all for the 256b case, because it does two separate 128b lane operations."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1439930774, "post_id": 32013564, "comment_id": 52060655, "body": "Actually, in the 256b case, you could just slap a permute at the end, like this Elalfer&#39;s solution.  <code>pshufb</code> has the same in-lane behaviour as <code>pack&#47;punpck</code>, which is what the final permute fixes.  You&#39;d have 4 ANDs with the same mask, then two <code>packusdw</code>, then one <code>packuswb</code>, then a permute.  I&#39;ll post an answer with this."}, {"owner": {"reputation": 5146, "user_id": 195447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996483d0dfbd79f30c9b99056f27553c?s=128&d=identicon&r=PG", "display_name": "Elalfer", "link": "https://stackoverflow.com/users/195447/elalfer"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1440002525, "post_id": 32013564, "comment_id": 52096716, "body": "@PeterCordes you are right, one might use <code>unpack</code> instructions in order to merge the regs. There are a couple of reasons why I used <code>pshufb</code> &amp; <code>por</code> - OOO will load masks way in advance so it is not a problem, there are more execution units for <code>por</code> than for <code>pack&#47;unpack</code> and <code>por</code> will be executed in parallel with <code>pshufb</code> (at least for Haswell/Broadwell microarchitectures)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1440003017, "post_id": 32013564, "comment_id": 52096978, "body": "@Elalfer: See my answer for code.  I do 4 <code>pand</code> (any port) and 3 <code>pack</code> insns (shuffle port).  You do 4 <code>pshufb</code> (shuffle port), and 3 <code>por</code>.  So in my case, the dependent operations (<code>pack</code>) are also the ones with more limited throughput.  Also, I agree it&#39;s a minor advantage to save on masks, but with mine you could even generate the mask with 2 instructions before a loop instead of loading it, thus not touching any data cache lines. (<code>pcmpeq xmm5, xmm5 &#47; psrld xmm5, 24</code>, which takes prob. only 8 insn bytes)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1440003317, "post_id": 32013564, "comment_id": 52097127, "body": "@Elalfer: In your version, the dep chain would be shorter if you did <code>L1=or( L4, or(L3, or(L1,L2)))</code>.  Then instead of 2 cycles of dependency after the 4th <code>pshufb</code>, you only have one.  cycle1, 2: pshufb only.  cycle3: pshufb+por.  cycle4: pshufb+por cycle5: por.  (Different on SnB/IvB, and Nehalem, which have 2 shuffle ports.  Core2 has a slow pshufb.)"}], "tags": [], "owner": {"reputation": 5146, "user_id": 195447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996483d0dfbd79f30c9b99056f27553c?s=128&d=identicon&r=PG", "display_name": "Elalfer", "link": "https://stackoverflow.com/users/195447/elalfer"}, "is_accepted": false, "score": 4, "last_activity_date": 1440003827, "last_edit_date": 1440003827, "creation_date": 1439565999, "answer_id": 32013564, "question_id": 31977282, "link": "https://stackoverflow.com/questions/31977282/efficiently-gather-individual-bytes-separated-by-a-byte-stride-of-4/32013564#32013564", "title": "Efficiently gather individual bytes, separated by a byte-stride of 4", "body": "<p>One of the ways would be - pack the bytes with <code>_mm256_shuffle_epi8</code>, blend all <code>_mm256_blend_epi32</code> resulting vectors (you'll need to do 4 such load+shuffle), and do a single 32bit permute <code>_mm256_permutevar8x32_epi32</code>.</p>\n\n<p>Here is a pseudo code (I hope you can come up with the shuffle masks):</p>\n\n<pre><code>L1 = load32byte(buf)\nL2 = load32byte(buf+32)\nL3 = load32byte(buf+64)\nL4 = load32byte(buf+96)\n\n// Pack 4 bytes in the corresponding 32bit DWORD in each lane and zero-out other bytes\nL1 = shuffle(L1, mask_for_L1)   \nL2 = shuffle(L2, mask_for_L2)\nL3 = shuffle(L3, mask_for_L3)\nL4 = shuffle(L4, mask_for_L4)\n\n// Vec = blend(blend(L1,L2),blend(L3,L4))\nVec = or(or(or(L1,L2),L3),L4)\nVec = permute(Vec)  // fix DWORD order in the vector\n</code></pre>\n\n<p><strong>Update</strong>: Forgot the reason I said \"zero-out other bytes\" - this way you can replace <code>blend</code> with <code>or</code></p>\n\n<p><strong>Update</strong>: Reduced one cycle latency by rearranging <code>or</code> operations per Peter's comment below.</p>\n\n<p><strong>PS</strong>. I'd also recommend you to take a look at the BMI Instruction Set as you do bit manipulations.</p>\n"}, {"comments": [{"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1439938545, "post_id": 32082519, "comment_id": 52063899, "body": "Thanks @PeterCordes  !   You&#39;re right!   I didn&#39;t notice that the _mm256_shuffle_epi8 intrinsic is tagged AVX2.  It works on my development machine, but won&#39;t work on the target servers  (Sandy Bridge)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 1, "creation_date": 1439946633, "post_id": 32082519, "comment_id": 52065857, "body": "@BlueStrat: Yeah, just work with 128b vectors using VEX-coded instructions (compile with AVX support, and make sure the disassembly shows <code>vpand</code>, not <code>pand</code>, etc.)  All the integer 256b stuff is AVX2-only, except <code>loadu_si256</code>.  You won&#39;t be able to do the bitwise shifts you need with 256b vectors.  (But 3-operand non-destructive operations are great for saving on <code>mov</code> instructions, though.  Which is an even bigger win on SnB, because handling <code>mov*</code> instructions at the register-rename stage didn&#39;t arrive until IvyBridge.)"}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1439996991, "post_id": 32082519, "comment_id": 52093140, "body": "thank you very much again- I am very curious, you exhibit tremendous knowledge on SIMD programming and processor related information. Did you gain it by some special training?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 1, "creation_date": 1439997861, "post_id": 32082519, "comment_id": 52093765, "body": "@BlueStrat: I trained for many years with a shao-lin monk master  computer-fu.  No seriously, I just like knowing how things <i>really</i> work, and tweaking / optimizing things.  I learned everything I know in this area from reading stuff online, with occasional experiments with perf counters.  I read <a href=\"http://realworldtech.com/\" rel=\"nofollow noreferrer\">realworldtech.com</a> articles about CPU designs, and <a href=\"http://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a> guides to CPU internals.  Once you have a mental model of what your CPU is doing, the pieces fit together pretty well, and any new information slots in."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 1, "creation_date": 1439998066, "post_id": 32082519, "comment_id": 52093887, "body": "@BlueStrat: Also get a copy of Intel&#39;s instruction reference manual.  I&#39;ve updated <a href=\"http://stackoverflow.com/tags/x86/info\">stackoverflow.com/tags/x86/info</a> recently with links to good stuff."}, {"owner": {"reputation": 5146, "user_id": 195447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996483d0dfbd79f30c9b99056f27553c?s=128&d=identicon&r=PG", "display_name": "Elalfer", "link": "https://stackoverflow.com/users/195447/elalfer"}, "edited": false, "score": 2, "creation_date": 1440002729, "post_id": 32082519, "comment_id": 52096837, "body": "<a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/\" rel=\"nofollow noreferrer\">software.intel.com/sites/landingpage/IntrinsicsGuide</a> - good quick reference on intrinsics. I use it all the time."}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1440015474, "post_id": 32082519, "comment_id": 52104292, "body": "@PeterCordes wish I could upvote this more, thanks for the detailed cycle count!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1440016465, "post_id": 32082519, "comment_id": 52104848, "body": "@BlueStrat: you can change which answer you marked as accepted.  Elalfer&#39;s answer is good, but I think mine&#39;s better :)  Glad you found this useful. :)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1440013003, "last_edit_date": 1495540865, "creation_date": 1439931885, "answer_id": 32082519, "question_id": 31977282, "link": "https://stackoverflow.com/questions/31977282/efficiently-gather-individual-bytes-separated-by-a-byte-stride-of-4/32082519#32082519", "title": "Efficiently gather individual bytes, separated by a byte-stride of 4", "body": "<p>I only just noticed the edit, which has a special-case answer.</p>\n\n<p>If you need to do many different bit positions on the same data, then your current plan is good.</p>\n\n<p>If you only need one bit position (esp. the highest bit position) from 128B of memory, you could use <code>_mm256_movemask_ps</code> to get the high bit from each 32b element.  Then combine four 8bit masks in GP registers.  </p>\n\n<p>A good compiler should optimize that to:</p>\n\n<pre><code>vmovdqu   ymm0, [buf + 0]\n; to select a different bit:\n; vpslld  ymm0, ymm0, count   ; count can be imm8 or the low byte of an xmm register\nvmovmskps eax, ymm0\n\nvmovdqu   ymm0, [buf + 32]\nvmovmskps ebx, ymm0\n\n...  ecx and edx\n\nmov       ah, bl\nmov       ch, dl\nshl       ecx, 16\nor        eax, ecx\n</code></pre>\n\n<p>This is nice only if you're testing the high bit (so you don't need to shift each vector before <code>vmovmsk</code>).  Even so, this is probably more instructions (and code size) than the other solution.</p>\n\n<hr>\n\n<p>Answer to the original question:</p>\n\n<p>Similar to Elalfer's idea, but use the shuffle unit for <code>pack</code> instructions instead of <code>pshufb</code>.  Also, all the ANDs are independent, so they can execute in parallel.  Intel CPUs can do 3 ANDs at once, but only one shuffle.  (Or two shuffles at once on pre-Haswell.)</p>\n\n<pre><code>// without AVX2: you won't really be able to\n// do anything with a __m256i, only __m128i\n// just convert everything to regular _mm_..., and leave out the final permute\n\nmask = _mm256_set1_epi32(0x000000ff);\n\n// same mask for all, and the load can fold into the AND\n// You can write the load separately if you like, it'll still fold\nL1 = and(mask, (buf))     // load and zero the bytes we don't want\nL2 = and(mask, (buf+32))\nL3 = and(mask, (buf+64))\nL4 = and(mask, (buf+96))\n\n// squish dwords from 2 concatenated regs down to words in 1 reg\npack12 = _mm256_packus_epi32(L1, L2);\npack34 = _mm256_packus_epi32(L3, L4);\n\npacked = _mm256_packus_epi16(pack12, pack34);  // note the different width: zero-padded-16 -&gt; 8\n\nVec = permute(packed)  // fix DWORD order in the vector (only needed for 256b version)\n\nVec = shift(Vec, bit_wanted)\nbitvec = movemask(Vec)\n\n    // shift:\n    //  I guess word or dword granularity is fine, since byte granularity isn't available.\n    //  You only care about the high bit, so it doesn't matter than you're not shifting zeroes into the bottom of each byte.\n\n    // _mm_slli_epi32(Vec, imm8): 1 uop, 1c latency if your count is a compile-time constant.\n    // _mm_sll_epi32 (Vec, _mm_cvtsi32_si128(count)): 2uop 2c latency if it's variable.\n\n    // *not* _mm_sllv_epi32(): slower: different shift count for each element.\n</code></pre>\n\n<p>If you're doing this with just AVX (like you said) then you won't have 256b integer instructions available.  Just build 128b vectors, and get 16b at a time of mask data.  You won't need a final permute at the end.</p>\n\n<p>Merge masks with integer instructions: <code>(m2&lt;&lt;16) | m1</code>.  If desired, even go up to 64b of mask data, by combining two 32b masks.</p>\n\n<p>Performance: This avoids the need for separate load instructions with AVX, since <code>vpand</code> can <a href=\"https://stackoverflow.com/questions/26046634/micro-fusion-and-addressing-modes/31027695#31027695\">micro-fuse a memory operand if used with a one-register addressing mode</a>.</p>\n\n<ul>\n<li>cycle 1: 3 <code>vpand</code> instructions.  (or only 2, if we were waiting on the address, since there's only 2 load ports.)</li>\n<li>cycle 2: last one or two <code>vpand</code>, one <code>pack</code> (L1, L2)</li>\n<li>cycle 3: next <code>pack</code> (L3, L4)</li>\n<li>cycle 4: final <code>pack</code></li>\n<li>// 256b AVX2: permute</li>\n<li>cycle 5: packed shift with imm8 count: 1 uop, 1c latency.</li>\n<li>cycle 6: movemask (3 cycle latency)</li>\n</ul>\n\n<p>Latency = 8 (SnB and later)</p>\n\n<p>Throughput: 3 shuffles (p5), 4 logicals (p015), 1 shift (p0), 1 pmovmsk (p0).  4 load uops.</p>\n\n<ul>\n<li>SnB/IvB: 9 ALU uops -> 3c.  4 memory reads: 2c.<br>\nSo depending on what you're doing with the masks, 3 accumulators would be needed to keep the execution ports saturated.  (ceil(8/3) = 3.).</li>\n</ul>\n\n<p>With shift count in a variable that can't be resolved to a compile-time constant by compiler inlining / unrolling:  latency = 9.  And the shift produces another uop for p1/p5.</p>\n\n<p>With AVX2 for Haswell and later, there's another 3 extra latency for the <code>vpermd</code>.</p>\n"}], "owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1567, "favorite_count": 0, "accepted_answer_id": 32082519, "answer_count": 3, "score": 9, "last_activity_date": 1440013003, "creation_date": 1439423343, "last_edit_date": 1439940418, "question_id": 31977282, "link": "https://stackoverflow.com/questions/31977282/efficiently-gather-individual-bytes-separated-by-a-byte-stride-of-4", "title": "Efficiently gather individual bytes, separated by a byte-stride of 4", "body": "<p>I'm trying to optimize an algorithm that will process massive datasets that could strongly benefit from AVX SIMD instructions.  Unfortunately, the input memory layout is not optimal for the required computations. Information must be reordered, by assembling <code>__m256i</code> values from individual bytes that are exactly 4 bytes apart:</p>\n\n<p><strong>BEGIN EDIT</strong></p>\n\n<p>My target CPUS do not support AVX2 instructions, so like @Elalfer and @PeterCordes pointed out, I can't make use of __m256i values, code must be converted to use __m128i values instead)</p>\n\n<p><strong>END EDIT</strong></p>\n\n<p>DataSet layout in memory</p>\n\n<hr>\n\n<pre><code>Byte 0   | Byte 1   | Byte 2   | Byte 3\nByte 4   | Byte 5   | Byte 6   | Byte 7\n...\nByte 120 | Byte 121 | Byte 122 | Byte 123\nByte 124 | Byte 125 | Byte 126 | Byte 127\n</code></pre>\n\n<p>Desired values in <code>__m256i</code> variable:</p>\n\n<hr>\n\n<pre><code>| Byte 0 | Byte 4 | Byte 8 |     ...     | Byte 120 | Byte 124 |\n</code></pre>\n\n<hr>\n\n<p><strong>Is there a more efficient way to gather and rearrange the strided data other than this straightforward code?</strong></p>\n\n<pre><code>union {  __m256i   reg;   uint8_t bytes[32]; } aux;\n...\nfor( int i = 0; i &lt; 32; i++ )\n    aux.bytes[i] = data[i * 4];\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>The step I'm trying to optimize is a bit column transposition; in other words, the bits of a certain column (32 possible bit columns in my data arrangement) should become a single <code>uint32_t</code> value, while the rest of the bits are ignored.</p>\n\n<p>I perform the transposition by rearranging the data as shown, performing a left shift to bring the desired bit column as the most significant bits in each sub-byte, and finally extract and assemble the bits into a single <code>uint32</code>_t value via the <code>_mm256_movemask_epi8()</code> intrinsic.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1439422879, "post_id": 31977113, "comment_id": 51860638, "body": "Could you post the result of <code>gcc --version</code>?"}, {"owner": {"reputation": 1853, "user_id": 3029274, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/678505a60d20e850fb26b7bc12a440a0?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/3029274/maddy"}, "edited": false, "score": 0, "creation_date": 1439422883, "post_id": 31977113, "comment_id": 51860640, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/16221776/why-dividing-two-integers-doesnt-get-a-float\">Why dividing two integers doesn&#39;t get a float?</a>"}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 2, "creation_date": 1439422920, "post_id": 31977113, "comment_id": 51860650, "body": "Wait, this isn&#39;t an integer division problem..."}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439422946, "post_id": 31977113, "comment_id": 51860660, "body": "<code>a</code> and <code>b</code> are both floats, so the result of that division should be <code>0.5</code>, yet printing that as a float results in <code>0.0</code>..."}, {"owner": {"reputation": 179, "user_id": 3390897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62735a65862b458e14dc2d7d478c7bd6?s=128&d=identicon&r=PG&f=1", "display_name": "byrnesj1", "link": "https://stackoverflow.com/users/3390897/byrnesj1"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1439423087, "post_id": 31977113, "comment_id": 51860700, "body": "@Schwern gcc (GCC) 4.6.3 20111208 (prerelease) using gcc -o, -Wall gives some helpful warnings. On the first variant: &#39;%d&#39; expects argument of type &#39;int&#39;, but argument 2 has type double. However, I still get the same (0 0.0) result in the executable."}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439424022, "post_id": 31977113, "comment_id": 51860926, "body": "I&#39;m not satisfied with any of the answers; while it&#39;s undefined behavior, I&#39;d like to know exactly what is happening to render this result. I&#39;ll answer shortly. :)"}], "answers": [{"comments": [{"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 2, "creation_date": 1439423000, "post_id": 31977209, "comment_id": 51860674, "body": "Not bizarre, it&#39;s just treating the IEEE 754 floating point format as a binary integer, which is understandably just a large number."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439425735, "post_id": 31977209, "comment_id": 51861289, "body": "@Purag It only makes sense if you already know about IEEE floating point numbers. Most humans think of numbers as numbers. Most programmers only have experience with high level languages which abstract the internal representation. The ways computers represent numbers and do math have little in common with how we were all taught math in school. Yes, it&#39;s bizarre. That you don&#39;t think it&#39;s bizarre... is bizarre. :)"}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439426886, "post_id": 31977209, "comment_id": 51861514, "body": "It&#39;s bizarre for someone just learning, indeed. However, I take every answer as an opportunity to peel back a layer of abstraction, since it can only help the programmer to know exactly what&#39;s going on under the hood. This is the way I learned C, and I think it helps me. :) I don&#39;t underestimate people reading this answer, so I think it would do better with a brief explanation of how the floating point is being interpreted in the way it is. :)"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439430432, "post_id": 31977209, "comment_id": 51862308, "body": "@Purag I think introducing type casting is plenty for one answer. As for why the OP is getting that odd result from <code>printf()</code>, <code>0 0.0</code> instead of the expected <code>0 0.5</code>, I&#39;m chalking it up to that some internal state in <code>printf()</code> got corrupted after getting a float for <code>%d</code>, or maybe the optimizer got confused."}, {"owner": {"reputation": 179, "user_id": 3390897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62735a65862b458e14dc2d7d478c7bd6?s=128&d=identicon&r=PG&f=1", "display_name": "byrnesj1", "link": "https://stackoverflow.com/users/3390897/byrnesj1"}, "edited": false, "score": 0, "creation_date": 1439458287, "post_id": 31977209, "comment_id": 51873860, "body": "Thanks for the insight, it really helps. I am still a little puzzled by my output, however I think the problems are compiler specific and not general. In your output, I can grasp that <code>%d</code> converts i/b to its binary representation, and <code>%1.1f</code> correctly prints <code>0.5</code> = a/b. What I don&#39;t understand is why trying to print <code>i&#47;b</code> as <code>%d</code> would affect printing <code>a&#47;b</code> as <code>%1.1f</code> in my output (if I put <code>%1.1f</code> &lt;- <code>a&#47;b</code> before <code>%d</code> &lt;- <code>i&#47;b</code> I get <code>0.5 0</code>). Further, <code>printf(&quot;%d %1.1f&quot;, i&#47;b, a)</code>; gives me <code>0 0.0</code> -- which again I think has to do with my compiler. Anyways, thanks again."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 179, "user_id": 3390897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62735a65862b458e14dc2d7d478c7bd6?s=128&d=identicon&r=PG&f=1", "display_name": "byrnesj1", "link": "https://stackoverflow.com/users/3390897/byrnesj1"}, "edited": false, "score": 1, "creation_date": 1439478330, "post_id": 31977209, "comment_id": 51888212, "body": "@byrnesj1: The <code>%d</code> doesn&#39;t <i>convert</i> <code>i&#47;b</code> to its binary representation. It&#39;s already in its binary representation. The <code>%d</code> format causes <code>printf</code> to <i>assume</i> that the argument is of type <code>int</code>. It&#39;s the lack of a conversion that causes the problem. (A <i>conversion</i> would translate a value of one type to a value of another type, keeping the same mathematical value if possible.)"}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439492078, "post_id": 31977209, "comment_id": 51896476, "body": "The trick here is that the same pattern of bits can mean very, very different things based on how it&#39;s interpreted. <code>int</code>, <code>float</code>, and all the types are just different ways of interpreting bit patterns."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 179, "user_id": 3390897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62735a65862b458e14dc2d7d478c7bd6?s=128&d=identicon&r=PG&f=1", "display_name": "byrnesj1", "link": "https://stackoverflow.com/users/3390897/byrnesj1"}, "edited": false, "score": 0, "creation_date": 1439494466, "post_id": 31977209, "comment_id": 51897739, "body": "@byrnesj1 <i><code>What I don&#39;t understand is why trying to print i&#47;b as %d would affect printing a&#47;b as %1.1f</code></i>. Yes, that is puzzling. My best idea is that once you&#39;ve fed printf the wrong types, something about it&#39;s internal state got corrupted. This would change from implementation to implementation and version to version."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 3, "last_activity_date": 1439423204, "last_edit_date": 1439423204, "creation_date": 1439422867, "answer_id": 31977209, "question_id": 31977113, "link": "https://stackoverflow.com/questions/31977113/c-data-types-casting-with-printf/31977209#31977209", "title": "C: Data Types &amp; Casting with printf()", "body": "<p>I get a different result.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int i;\n    float a,b;\n\n\n    i = 2;\n    a = 2.0;\n    b = 4.0;\n\n    printf(\"%d %1.1f\", i/b,a/b);\n}\n\n1432933728 0.5\n</code></pre>\n\n<p><code>gcc -Wall</code> provides a warning.  You should always be running with <code>-Wall</code> to get helpful warnings.</p>\n\n<pre><code>$ gcc -Wall try.c \ntry.c:12:24: warning: format specifies type 'int' but the argument has type 'float' [-Wformat]\n    printf(\"%d %1.1f\", i/b,a/b);\n            ~~         ^~~\n            %f\n1 warning generated.\n</code></pre>\n\n<p>printf is doing something bizarre when it interprets the float as an integer.  C is not intelligent about data and will simply apply the raw binary floating point number as an integer.  It will usually get garbage.</p>\n\n<p>When I fix that by changing it to <code>printf(\"%1.1f %1.1f\", i/b,a/b);</code> I get the expect result of <code>0.5 0.5</code>.</p>\n\n<p>This is Apple's \"gcc\", which is actually clang.</p>\n\n<pre><code>$ gcc --version\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 6.1.0 (clang-602.0.53) (based on LLVM 3.6.0svn)\nTarget: x86_64-apple-darwin14.4.0\nThread model: posix\n</code></pre>\n\n<p>While I got a different result, the lesson is you can't cast a float to a decimal with <code>%d</code>.  Generally, function argument types will not be cast for you, even printf.  You have to do it with explicit type casting.  You could have written this...</p>\n\n<pre><code>printf(\"%1.1f %d\", i/b, (int)(a/b));\n</code></pre>\n\n<p>Note the extra parens are necessary because type casting has a higher precedence than division.</p>\n\n<p>Rather than relying on type casting, you get better control by explicitly rounding a floating point result using <a href=\"https://en.wikipedia.org/wiki/C_mathematical_functions\" rel=\"nofollow\">ceil(), floor(), round() and related functions</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1439423598, "post_id": 31977235, "comment_id": 51860827, "body": "So, the fix is... either use the <code>%f</code> format specifier for both expressions, or force the expression that is using the <code>%d</code> specifier to be an <code>int</code> (perhaps by using a cast to make it so)."}], "tags": [], "owner": {"reputation": 712, "user_id": 5162472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6112b39c23570cfb2597cb39db82e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "dfogni", "link": "https://stackoverflow.com/users/5162472/dfogni"}, "is_accepted": false, "score": 7, "last_activity_date": 1439423034, "creation_date": 1439423034, "answer_id": 31977235, "question_id": 31977113, "link": "https://stackoverflow.com/questions/31977113/c-data-types-casting-with-printf/31977235#31977235", "title": "C: Data Types &amp; Casting with printf()", "body": "<p>You are invoking undefined behaviour.</p>\n\n<p>printf is a vararg function, there is no link between the format string and how the other arguments are passed to the function. The usual rules for <code>/</code> apply so <code>i/b</code> stays a double and is passed as it is to printf, this causes undefined behaviour when the function tries to read it as an int.</p>\n\n<p>If you compile with -Wall you will see these warnings</p>\n\n<pre><code>a.c: In function \u2018main\u2019:\na.c:12:12: warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018double\u2019 [-Wformat=]\n     printf(\"%d %1.1f\", i/b,a/b);\n             ^\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 3390897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62735a65862b458e14dc2d7d478c7bd6?s=128&d=identicon&r=PG&f=1", "display_name": "byrnesj1", "link": "https://stackoverflow.com/users/3390897/byrnesj1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 1, "accepted_answer_id": 31977209, "answer_count": 2, "score": 2, "last_activity_date": 1439434114, "creation_date": 1439422215, "last_edit_date": 1439434114, "question_id": 31977113, "link": "https://stackoverflow.com/questions/31977113/c-data-types-casting-with-printf", "title": "C: Data Types &amp; Casting with printf()", "body": "<p>I'm fairly new to programming, and am starting to get used to C. I apologize if this is a repeat question (I don't know the underlying process i.e. what to search for).</p>\n\n<p>I'm working with a simple program to get used to the nuances of data types:</p>\n\n<pre><code>main(){\n    int i;\n    float a,b;\n\n\n    i = 2;\n    a = 2.0;\n    b = 4.0;\n\n    printf(\"%d %1.1f\", i/b,a/b);\n}\n</code></pre>\n\n<p>I expected the program to print 0 0.5 (since a and b are both floats and I am printing their ratio as a float), yet the program printed 0 0.0 (I'm using gcc -o). However, when I reverse the printf order (without switching the order of corresponding variables), that is:</p>\n\n<pre><code>printf(\"%1.1f %d\", i/b,a/b);\n</code></pre>\n\n<p>The print result is 0.5 0. I'm not exactly sure what's happening here. It appears that in the first program b is being converted to int in i/b and fails to be converted to float in a/b. However, in the second variant, b doesn't have any trouble printing out as two different types. Can ints not be coerced into floats? Can someone explain this or point me in the right direction?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439417958, "post_id": 31976309, "comment_id": 51859190, "body": "I suggest putting a specific error message in the body of the question."}, {"owner": {"reputation": 2440, "user_id": 2676096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1178790d916aa2177656a70aba28f86?s=128&d=identicon&r=PG&f=1", "display_name": "Banex", "link": "https://stackoverflow.com/users/2676096/banex"}, "edited": false, "score": 4, "creation_date": 1439417974, "post_id": 31976309, "comment_id": 51859199, "body": "Did you try stepping through the code with a debugger?"}, {"owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "edited": false, "score": 2, "creation_date": 1439417993, "post_id": 31976309, "comment_id": 51859207, "body": "You start with str[len++] e.g. str[26] and increment it 26 times more. E.g. You write into str from char 26 to char 52 and your buffer size is 30."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1439418314, "post_id": 31976309, "comment_id": 51859312, "body": "You should really learn to use a debugger."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1439418315, "post_id": 31976309, "comment_id": 51859314, "body": "Yes, and so IMMEDIATELY OBVIOUS if run under a debugger, or even with a couple printf calls."}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439418444, "post_id": 31976309, "comment_id": 51859363, "body": "@Martin James what are the correct values for len and seed"}, {"owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "edited": false, "score": 0, "creation_date": 1439418480, "post_id": 31976309, "comment_id": 51859369, "body": "This might be not an easy bug to debug for a fresh programmer as it crashes later when returning from <code>main</code>."}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439418510, "post_id": 31976309, "comment_id": 51859387, "body": "Well I spotted the error almost immediately after looking at the code. I have some experience but it does feel like you didn&#39;t try to understand the code. Not sure SO is the right format for these &quot;find my blunder&quot; questions: what help is us telling you the solution? How is this question useful to others?"}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "reply_to_user": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "edited": false, "score": 0, "creation_date": 1439418564, "post_id": 31976309, "comment_id": 51859410, "body": "@fukanchik: That will depend on your implementation and environment."}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "reply_to_user": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439418701, "post_id": 31976309, "comment_id": 51859462, "body": "@Veltas which the problem"}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439418812, "post_id": 31976309, "comment_id": 51859503, "body": "My most prudent advice: <i>learn to use a debugger</i>, e.g. gdb if you&#39;re using gcc or on a UNIX-style, valgrind is good if you&#39;re on Linux. <i>Stop coming here for these simple problems</i>, I can be sympathetic that it will take us like 3 seconds to spot the error and you may take many minutes, but you&#39;ll learn better if you build a solid notion of the way C works yourself, not just getting strangers to debug everything."}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439418866, "post_id": 31976309, "comment_id": 51859519, "body": "@Tony: &quot;which the problem&quot; What does that mean?"}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439418945, "post_id": 31976309, "comment_id": 51859546, "body": "gdb is a godsend and would have revealed this issue to you immediately."}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "reply_to_user": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439419168, "post_id": 31976309, "comment_id": 51859614, "body": "@Veltas maybe a translator error, I&#39;m sorry"}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439419268, "post_id": 31976309, "comment_id": 51859648, "body": "@Tony: Consider finding a <i>stackoverflow</i> for your native language. Out of interest, what is your language?"}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "edited": false, "score": 0, "creation_date": 1439419342, "post_id": 31976309, "comment_id": 51859670, "body": "I do not understand this code should work fine The bug is in that I&#39;m passing incorrect parameters"}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439419414, "post_id": 31976309, "comment_id": 51859690, "body": "@Tony: Read Purag&#39;s answer. I think you are wrong and the code has a bug."}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "reply_to_user": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439419445, "post_id": 31976309, "comment_id": 51859705, "body": "@Veltas el espa&#241;ol es mi idioma nativo existe alg&#250;n sitio de stackoverflow en ese idioma"}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "reply_to_user": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439419735, "post_id": 31976309, "comment_id": 51859786, "body": "@Veltas in this case because no one realized in another thread"}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439420398, "post_id": 31976309, "comment_id": 51859944, "body": "@Tony: Maybe check out <a href=\"http://pt.stackoverflow.com/\">Stack Overflow em Portugu&#234;s</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "is_accepted": false, "score": 1, "last_activity_date": 1439418343, "last_edit_date": 1439418343, "creation_date": 1439418200, "answer_id": 31976423, "question_id": 31976309, "link": "https://stackoverflow.com/questions/31976309/segment-violation-to-the-run-a-generator-words/31976423#31976423", "title": "Segment violation to the run a generator words", "body": "<p>You pass 26 for <code>len</code> when calling the function in <code>main</code> and start filling in the buffer at that index. Your buffer has size 30, so after 3 iterations you're accessing and assigning into unallocated space, which causes the segmentation fault.</p>\n\n<p>You probably want another variable, initialized to 0, to use as your index for assigning into the buffer. Loop as long as that variable is <code>&lt; len</code>.</p>\n\n<pre><code>int bufIndex = 0;\nwhile (bufIndex &lt; len &amp;&amp; n &gt; 0)\n{\n    const size_t i = seed % n;\n    seed /= n;\n    str[bufIndex++] = letter[i];\n    letter[i] = letter[--n];\n}\n</code></pre>\n"}], "owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1439461869, "answer_count": 1, "score": -3, "last_activity_date": 1439418343, "creation_date": 1439417636, "question_id": 31976309, "link": "https://stackoverflow.com/questions/31976309/segment-violation-to-the-run-a-generator-words", "closed_reason": "Not suitable for this site", "title": "Segment violation to the run a generator words", "body": "<p>This problem occurs when compiling a example provided by a user, in <a href=\"https://stackoverflow.com/questions/31826746/trying-to-generate-9-digit-numbers-with-each-unique-digits/%22this%22\">this </a>thread, really I do not understand because the error occurs here the code that I used to call the function</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar *construct_word(char *const str, size_t len, size_t seed)\n{\n    char letter[26] = { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i',\n                        'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r',\n                        's', 't', 'u', 'v', 'w', 'x', 'y', 'z'\n                      };\n    size_t n = 26;\n\n    if (str == NULL || len &lt; 1)\n        return NULL;\n\n    while (len &gt; 1 &amp;&amp; n &gt; 0)\n    {\n        const size_t i = seed % n;\n        seed /= n;\n        str[len++] = letter[i];\n        letter[i] = letter[--n];\n    }\n    str[len] = '\\0';\n\n    return str;\n}\n\nint main (void)\n{\n    char buffer[30];\n    printf(\"%s\\n\", construct_word(buffer, 26, 15));\n\n    return 0;\n}\n</code></pre>\n\n<p>Anyone know I'm doing wrong?</p>\n"}, {"tags": ["c++", "c", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 1564, "user_id": 3126402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7c2502d74600c9f320495ae855f98134?s=128&d=identicon&r=PG&f=1", "display_name": "Astrid", "link": "https://stackoverflow.com/users/3126402/astrid"}, "edited": false, "score": 0, "creation_date": 1439482082, "post_id": 31983195, "comment_id": 51890934, "body": "I see, so am I wrong in thinking that all libraries <code>.cpp</code> and <code>.c</code> are not to be appended to the <code>target_link_variables</code> directive? Moreover, I thought only the main project files were supposed to be added to <code>add_executables</code>? I am still new to cmake."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 1564, "user_id": 3126402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7c2502d74600c9f320495ae855f98134?s=128&d=identicon&r=PG&f=1", "display_name": "Astrid", "link": "https://stackoverflow.com/users/3126402/astrid"}, "edited": false, "score": 1, "creation_date": 1439485734, "post_id": 31983195, "comment_id": 51893011, "body": "<code>.cpp</code> and <code>.c</code> are not <i>libraries</i>. They are <i>source files</i>. You can make library from these files using <code>add_library(&lt;library-name&gt; &lt;sources..&gt;)</code> command. After that, you may link executable with this library: <code>target_link_libraries(HelloTest &lt;library-name&gt;)</code>."}, {"owner": {"reputation": 1564, "user_id": 3126402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7c2502d74600c9f320495ae855f98134?s=128&d=identicon&r=PG&f=1", "display_name": "Astrid", "link": "https://stackoverflow.com/users/3126402/astrid"}, "edited": false, "score": 0, "creation_date": 1439493411, "post_id": 31983195, "comment_id": 51897222, "body": "Oh I see, so in actuality since I do not have <code>add_library</code> the above stood no chance of working anyway. Hence, I must add my sources to a library, but not the headers (?), and then I link them to my target."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 1564, "user_id": 3126402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7c2502d74600c9f320495ae855f98134?s=128&d=identicon&r=PG&f=1", "display_name": "Astrid", "link": "https://stackoverflow.com/users/3126402/astrid"}, "edited": false, "score": 0, "creation_date": 1439496467, "post_id": 31983195, "comment_id": 51898710, "body": "Actually, library is an alternative for making executable from all sources. But you are right about headers - no needs to enumerate them for building library/executable."}, {"owner": {"reputation": 1564, "user_id": 3126402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7c2502d74600c9f320495ae855f98134?s=128&d=identicon&r=PG&f=1", "display_name": "Astrid", "link": "https://stackoverflow.com/users/3126402/astrid"}, "edited": false, "score": 0, "creation_date": 1439499899, "post_id": 31983195, "comment_id": 51900358, "body": "Right, I think that solved this issue, it raised a few other ones, but I&#39;ll create another question for that. Thanks."}], "tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 1, "last_activity_date": 1439454694, "creation_date": 1439454694, "answer_id": 31983195, "question_id": 31976279, "link": "https://stackoverflow.com/questions/31976279/cmake-make2-no-rule-to-make-target-path-to-uthash-utarray-h-needed-by/31983195#31983195", "title": "CMake make[2]: *** No rule to make target `/path/to/uthash/utarray.h&#39;, needed by `HelloTest&#39;. Stop", "body": "<p>You set <code>C_SOURCE</code> variable to list of sources and headers, but use it in commands <code>link_directories</code> and <code>target_link_libraries</code>, related to <em>linking</em>, not a <em>compiling</em>.</p>\n\n<p>Probably, you need to append content of this variable to <code>SOURCE_FILES</code> instead.</p>\n"}], "owner": {"reputation": 1564, "user_id": 3126402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7c2502d74600c9f320495ae855f98134?s=128&d=identicon&r=PG&f=1", "display_name": "Astrid", "link": "https://stackoverflow.com/users/3126402/astrid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4186, "favorite_count": 0, "accepted_answer_id": 31983195, "answer_count": 1, "score": 0, "last_activity_date": 1439454694, "creation_date": 1439417447, "last_edit_date": 1439417866, "question_id": 31976279, "link": "https://stackoverflow.com/questions/31976279/cmake-make2-no-rule-to-make-target-path-to-uthash-utarray-h-needed-by", "title": "CMake make[2]: *** No rule to make target `/path/to/uthash/utarray.h&#39;, needed by `HelloTest&#39;. Stop", "body": "<p>I am trying to build some mixed C/C++ code to run some simple test code (HelloTest) as such:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"cpp_header.h\"\nextern \"C\"\n{\n    #include \"c_header.h\"\n}\n\nusing namespace std;\n\nint main(int argc, char **argv) {\n    cout &lt;&lt; \"Hello, World!\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>but I get this very strange error:</p>\n\n<pre><code>/Applications/CLion.app/Contents/bin/cmake/bin/cmake --build /Users/user/Library/Caches/clion10/cmake/generated/c1d0f54d/c1d0f54d/Debug --target all -- -j 2\nmake[2]: *** No rule to make target `/path/to/uthash/utarray.h', needed by `HelloTest'.  Stop.\nmake[1]: *** [CMakeFiles/HelloTest.dir/all] Error 2\nmake: *** [all] Error 2\n</code></pre>\n\n<p>Now, utarray.h is part of uthash (<a href=\"http://troydhanson.github.io/uthash/\" rel=\"nofollow\">http://troydhanson.github.io/uthash/</a>), and savvy readers will know that this is not a question of the <code>.c/cpp</code> missing - <code>utarray.h</code> doesn't have one.</p>\n\n<p>The CMake file -ish looks like this </p>\n\n<pre><code>cmake_minimum_required(VERSION 3.2)\nproject(HelloTest)\n\n# CPP stuff\nfind_package(CPP_PACKAGE REQUIRED)\ninclude_directories(${CPP_PACKAGE_INCLUDE_DIR})\nlink_directories(${CPP_PACKGE_LIB_DIR})\n\n# C Headers\nset(C_ROOT_DIR \"/path/to/c/library\")\nset(C_INCLUDE_DIR ${C_ROOT_DIR}/src\n                      ${C_ROOT_DIR}/ext/mtrand\n                      ${C_ROOT_DIR}/ext/uthash/src)\ninclude_directories(${C_INCLUDE_DIR})\n\n# C Headers &amp; Source [we want to avoid globbing]\nset(C_SOURCE   ${C_ROOT_DIR}/src/bnp.c\n                    ${C_ROOT_DIR}/src/bnp.h\n.\n.\n.\n                    ${C_ROOT_DIR}/ext/uthash/utarray.h\n                    ${C_ROOT_DIR}/ext/uthash/uthash.h\n                    ${C_ROOT_DIR}/ext/uthash/utlist.h\n                    ${C_ROOT_DIR}/ext/uthash/utstring.h)\nlink_directories(${C_SOURCE})\n\nset(SOURCE_FILES main.cpp)\nadd_executable(HelloTest ${SOURCE_FILES})\ntarget_link_libraries(HelloTest ${CPP_LIBRARIES} ${C_SOURCE})\n</code></pre>\n"}, {"tags": ["c", "visual-studio", "parameters"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1439416934, "post_id": 31976138, "comment_id": 51858867, "body": "Does the compiler see a prototype of MyFunction? (before it gets to the line <code>MyFunction(&amp;variable);</code>)"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1439416937, "post_id": 31976138, "comment_id": 51858870, "body": "Do you have function prototypes in header files?"}, {"owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1439416994, "post_id": 31976138, "comment_id": 51858892, "body": "@aschepler yes, I have this problem even with functions with prototypes specified in header files"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1439417173, "post_id": 31976138, "comment_id": 51858951, "body": "Set the warning level to <code>-W4</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1439417350, "post_id": 31976138, "comment_id": 51859011, "body": "Warnings, warnings. I get 2 off the line <code>MyFunction(&amp;aVariable);</code>"}, {"owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1439417393, "post_id": 31976138, "comment_id": 51859021, "body": "@user3386109 OK, I will try that tomorrow and update. However, I am afraid that if it only turns on more warnings they will get lost among the tons that are already generated today (we&#39;re using a really horrendous library; the project is a nightmare. Unfortunately nothing that can be done about the library)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1439417453, "post_id": 31976138, "comment_id": 51859039, "body": "Tons of warnings? Deal with them, one by one. Perhaps it&#39;s not the libray&#39;s fault but the way you are using it."}, {"owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1439417626, "post_id": 31976138, "comment_id": 51859096, "body": "@WeatherVane thanks for the idea. I&#39;m not sure it&#39;s possible due to the library we&#39;re using (not my choice)."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1439417668, "post_id": 31976138, "comment_id": 51859110, "body": "Did you turn them off? <code>&#47;W1</code> should be enough in this case. Visual Studio projects default to <code>&#47;W3</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1439417685, "post_id": 31976138, "comment_id": 51859114, "body": "If it&#39;s a library then it&#39;s precompiled: it doesn&#39;t give warnings. The way you call it does."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1439417969, "post_id": 31976138, "comment_id": 51859197, "body": "@Alejandro Yup, I know that feeling. One project I was hired to fix had 240 warnings when I first compiled it. About 30 of those were actual bugs. So you&#39;ve got three choices: a) find and fix all the warnings, b) spend the rest of your life debugging crappy code, or c) run away!!! and get a another job :)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1439418031, "post_id": 31976138, "comment_id": 51859219, "body": "Turning off warnings, sticking your head in the sand, and blaming the library isn&#39;t going to get you far. Better to understand the library you have to use in the first place. Your example of passing <code>int*</code> to <code>int</code> parameter proves my point."}, {"owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1439418336, "post_id": 31976138, "comment_id": 51859324, "body": "@user3386109 So it seems. I&#39;ll check the feasiblity of going through all the warnings. Additionally I will check with different warning levels. There might be some that leave the warnings I&#39;m looking for and hide the others. (I have actually considered option c too :P)"}, {"owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1439418468, "post_id": 31976138, "comment_id": 51859366, "body": "@WeatherVane the example is oversimplified, so don&#39;t take it as proof of anything.  With tons of warnings, I mean easily 1000+ . Not my code. Sample project code, that is almost unreadable. I appreciate your attempt to help, however."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1439418585, "post_id": 31976138, "comment_id": 51859417, "body": "Oh.. some people might recommend a can of gas and a box of matches for this job.  I couldn&#39;t possibly comment myself."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1439418691, "post_id": 31976138, "comment_id": 51859455, "body": "If it is your your job to fix an inherited catastrophe, start at the first warning, and work your way through methodically. Or leave."}, {"owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1439418955, "post_id": 31976138, "comment_id": 51859551, "body": "@WeatherVane OK. You&#39;ve made your point. I get it. It might not be possible. Again, thank you for your suggestions."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1439419119, "post_id": 31976138, "comment_id": 51859599, "body": "... but it might be possible. Be upbeat to fuel you."}], "answers": [{"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 2, "last_activity_date": 1439417481, "creation_date": 1439417481, "answer_id": 31976285, "question_id": 31976138, "link": "https://stackoverflow.com/questions/31976138/c-catching-wrong-parameter-errors/31976285#31976285", "title": "C - catching wrong parameter errors", "body": "<p>Insert a function declaration of the form</p>\n\n<pre><code> void MyFunction(int parameter);\n</code></pre>\n\n<p>before attempting to call it.   If you don't do that, when calling <code>MyFunction()</code> a C compiler is required to assume <code>MyFunction()</code> accepts a variable argument list (arbitrary number and types of arguments) and returns int.</p>\n\n<p>Hence code will compile without error, even if the function is called with incorrect arguments or calling code attempts to use the return value (which should not be done with a <code>void</code> function).    The result, if the arguments supplied do not match what the actual function definition expects, is often in the realm of undefined behaviour.</p>\n\n<p>Declaring the function before calling it is good practice, and allows the compiler to detect a problem, and issue errors or warnings as needed.  Without the declaration, some compilers do issue warnings, but not all compilers do.</p>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "edited": false, "score": 0, "creation_date": 1439450695, "post_id": 31976438, "comment_id": 51869281, "body": "Thank you for all the comments. I have started addressing most warnings and have turned a few into errors, so that no matter what they cannot be ignored. Thank you also for the explanation as it helps clarify why these errors went unnoticed in the first place (the prototypes were there and generating warnings when misused, only they got lost in way too many warnings!)."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 3, "last_activity_date": 1439422256, "last_edit_date": 1439422256, "creation_date": 1439418278, "answer_id": 31976438, "question_id": 31976138, "link": "https://stackoverflow.com/questions/31976138/c-catching-wrong-parameter-errors/31976438#31976438", "title": "C - catching wrong parameter errors", "body": "<p>If the function <code>MyFunction</code> is <em>declared with prototype</em> before the point of the call, then </p>\n\n<pre><code>MyFunction(&amp;aVariable);\n</code></pre>\n\n<p>is a genuine full-blown <em>constraint violation</em> in C, i.e. it is what we usually call \"an error\". That's what the language specification says. In other words, your belief that this is somehow allowed \"due to the C standard specifications\" is incorrect: this is explicitly disallowed by C standard.</p>\n\n<p>Any C compiler will issue at least a <em>warning</em> for such code, which you should also pay attention to. If your C compiler does not report this violation as an <em>error</em>, it can usually be changed through compiler setup.</p>\n\n<p>In case of Visual Studio compiler, one approach is to watch the warning number issued in such cases and ask the compiler to convert such warnings into errors. This can be done through either <code>#pragma warning</code> or through project settings.</p>\n"}], "owner": {"reputation": 183, "user_id": 1527560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a39f8107eacb80d44d11d99a8543475?s=128&d=identicon&r=PG", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/1527560/alejandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 31976438, "answer_count": 2, "score": 2, "last_activity_date": 1439422256, "creation_date": 1439416802, "last_edit_date": 1439418886, "question_id": 31976138, "link": "https://stackoverflow.com/questions/31976138/c-catching-wrong-parameter-errors", "title": "C - catching wrong parameter errors", "body": "<p>I'm working with a large C-only project, and I keep getting bitten by the following problem:</p>\n\n<p>Lets say I have a function </p>\n\n<pre><code>void MyFunction(int parameter)\n{\n    printf(\"parameter: %d\\n\", parameter);\n}\n</code></pre>\n\n<p>Which normally gets called</p>\n\n<pre><code>int aVariable = 5;\nMyFunction(aVariable);\n</code></pre>\n\n<p>However, apparently due to the C standard specifications, this does not cause a compilation error:</p>\n\n<pre><code>int aVariable = 5;\nMyFunction(&amp;aVariable); // No error signaled, but causes all sorts of mayhem\n</code></pre>\n\n<p>How can I catch this kind of error, specifically in Visual Studio? Is there any setting I can turn on to make it stricter? \nAny strategy you might recommend (besides \"don't make typos\")?</p>\n\n<p>Edit:\nI might add that due to the (crappy) nature of the project, the sample code already generates tons of warnings; I am not sure I can remove all of them in the time I have. Generating more warnings might not be the best option -- however being able to discern about these specific warnings (as one answer suggests) might be the solution to this particular problem.</p>\n"}, {"tags": ["c", "gcc", "elf", "dwarf"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1439413888, "post_id": 31975376, "comment_id": 51857609, "body": "Possibly you are using libraries compiled with a newer dwarf version? You should only have one <code>Compilation Unit</code> clause unless you are statically linking something ..."}, {"owner": {"reputation": 329, "user_id": 1542938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca16532fc154a479c70dada5415fabb?s=128&d=identicon&r=PG", "display_name": "MuchToLearn", "link": "https://stackoverflow.com/users/1542938/muchtolearn"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1439417140, "post_id": 31975376, "comment_id": 51858940, "body": "Unless it&#39;s something implicit like glibc causing it, I&#39;m out of ideas. This happened even with the minimal program in the question which doesn&#39;t even use <code>printf()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 5, "last_activity_date": 1439609927, "creation_date": 1439609927, "answer_id": 32021281, "question_id": 31975376, "link": "https://stackoverflow.com/questions/31975376/gcc-4-8-inserts-version-4-in-a-compilation-unit-header-even-with-gdwarf-2/32021281#32021281", "title": "GCC 4.8 inserts version 4 in a compilation unit header even with -gdwarf-2", "body": "<blockquote>\n  <p>This happens even if you compile a minimal C program as follows:</p>\n</blockquote>\n\n<p>Even this minimal program will statically link parts of libc (namely, <code>crt1.o</code>, <code>crtbegin.o</code>, etc.).</p>\n\n<p>You should verify that the compilation units that have version 4 are really coming from your program, and not from a library (just look at their <code>DW_AT_name</code> and <code>DW_AT_comp_dir</code>).</p>\n\n<p>My gcc-4.8: <code>gcc (Ubuntu 4.8.4-2ubuntu1~14.04) 4.8.4</code> produces version 2 when I ask it to:</p>\n\n<pre><code>gcc -g -c t.c\nreadelf -wi t.o | grep -A2 'Compilation Unit'\n  Compilation Unit @ offset 0x0:\n   Length:        0x4e (32-bit)\n   Version:       4\n\ngcc -gdwarf-2 -c t.c\nreadelf -wi t.o | grep -A2 'Compilation Unit'\n  Compilation Unit @ offset 0x0:\n   Length:        0x52 (32-bit)\n   Version:       2\n</code></pre>\n\n<p>If the version 4 objects are really just <code>crt1.o</code> or similar, note that you can safely run <code>strip -g</code> on these objects -- you will not lose much (unless you have to debug libc startup issues, which is unlikely).</p>\n"}], "owner": {"reputation": 329, "user_id": 1542938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca16532fc154a479c70dada5415fabb?s=128&d=identicon&r=PG", "display_name": "MuchToLearn", "link": "https://stackoverflow.com/users/1542938/muchtolearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 32021281, "answer_count": 1, "score": 9, "last_activity_date": 1439686598, "creation_date": 1439413472, "last_edit_date": 1439686598, "question_id": 31975376, "link": "https://stackoverflow.com/questions/31975376/gcc-4-8-inserts-version-4-in-a-compilation-unit-header-even-with-gdwarf-2", "title": "GCC 4.8 inserts version 4 in a compilation unit header even with -gdwarf-2", "body": "<p>I compiled an application with GCC 4.8 and I'm trying to debug it on an older system that does not have GDB 7.5+ (which supposedly added support for DWARF-4). Upgrading GDB on that system is not an option. I can't debug it because GDB outputs the following message:</p>\n\n<pre><code>Dwarf Error: wrong version in compilation unit header (is 4, should be 2) [in module a.out]\n</code></pre>\n\n<p>I tried compiling with -gdwarf-2 -gstrict-dwarf as suggested in other questions but the compiler keeps inserting a couple of compilation unit headers with version 4:</p>\n\n<pre><code>/tmp&gt; readelf --debug-dump=info a.out | grep -A2 'Compilation Unit @'\nreadelf: Warning: CU at offset 6b contains corrupt or unsupported version number: 4.\nreadelf: Warning: CU at offset 1eb contains corrupt or unsupported version number: 4.\n  Compilation Unit @ offset 0x0:\n   Length:        0x67 (32-bit)\n   Version:       2\n--\n  Compilation Unit @ offset 0x6b:\n   Length:        0x84 (32-bit)\n   Version:       4\n--\n  Compilation Unit @ offset 0xf3:\n   Length:        0x62 (32-bit)\n   Version:       2\n--\n  Compilation Unit @ offset 0x159:\n   Length:        0x8e (32-bit)\n   Version:       2\n--\n  Compilation Unit @ offset 0x1eb:\n   Length:        0x136 (32-bit)\n   Version:       4\n--\n  Compilation Unit @ offset 0x325:\n   Length:        0x62 (32-bit)\n   Version:       2\n</code></pre>\n\n<p>This happens even if you compile a minimal C program as follows:</p>\n\n<pre><code>/home/MuchToLearn/src&gt; cat main.c\nint main(void)\n{\n  return 0;\n}\n/home/MuchToLearn/src&gt; gcc -gdwarf-2 -gstrict-dwarf main.c\n</code></pre>\n\n<p>Am I missing something here? What's the point of having the -gdwarf-2 option if it's not going to generate binaries that can be debugged by older GDB versions that only support DWARF-2?</p>\n\n<p><strong>Edit:</strong> Employed Russian's answer is correct. The version-4 compilation units were coming from <code>/usr/lib/crt1.o</code> and <code>/usr/lib/libc_nonshared.a</code>. To fix the issue, I copied them into a local directory and removed their debugging symbols with <code>strip -g</code>. Then, I linked the executable as follows:</p>\n\n<pre><code>ld -o main -dynamic-linker /lib/ld-linux.so.2 crt1.o /usr/lib/crti.o main.o /lib/libc.so.6 libc_nonshared.a /usr/lib/crtn.o\n</code></pre>\n\n<p>The resulting executable does not contain any version-4 compilation units and GDB stopped complaining about that.</p>\n"}, {"tags": ["c", "sockets", "ssh", "distributed", "libssh"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 5, "creation_date": 1439412468, "post_id": 31975067, "comment_id": 51856846, "body": "<code>man system(): [...]and returns after the command has been completed.[...]</code>."}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1439412771, "post_id": 31975067, "comment_id": 51857006, "body": "Run the server on one thread and the system command on a different thread."}, {"owner": {"reputation": 3076, "user_id": 2112731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0cd41c5afcd4701fbb21ca081bcb0c?s=128&d=identicon&r=PG", "display_name": "DoxyLover", "link": "https://stackoverflow.com/users/2112731/doxylover"}, "edited": false, "score": 2, "creation_date": 1439414712, "post_id": 31975067, "comment_id": 51858007, "body": "Use <code>fork</code> and <code>execl</code> to start the client so the server can continue running."}, {"owner": {"reputation": 3076, "user_id": 2112731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0cd41c5afcd4701fbb21ca081bcb0c?s=128&d=identicon&r=PG", "display_name": "DoxyLover", "link": "https://stackoverflow.com/users/2112731/doxylover"}, "reply_to_user": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1439414778, "post_id": 31975067, "comment_id": 51858042, "body": "@cup - threads are probably not a good idea if the code isn&#39;t already thread-safe. Better to use separate processes but arrange it so that the parent can run parallel with the child."}, {"owner": {"reputation": 2102, "user_id": 2828925, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/18abe23c6b1123371f171f55be659ef5?s=128&d=identicon&r=PG&f=1", "display_name": "Jes", "link": "https://stackoverflow.com/users/2828925/jes"}, "edited": false, "score": 0, "creation_date": 1439416851, "post_id": 31975067, "comment_id": 51858830, "body": "Thanks all. One thing I just tried works. I ass &quot;&amp;&quot; right after the command for system call."}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439421390, "post_id": 31975067, "comment_id": 51860222, "body": "@Jes: Yes that&#39;s one way of doing it, although checking for the return code will not work with the <code>system</code> call anymore, and using the POSIX process API is more portable."}], "owner": {"reputation": 2102, "user_id": 2828925, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/18abe23c6b1123371f171f55be659ef5?s=128&d=identicon&r=PG&f=1", "display_name": "Jes", "link": "https://stackoverflow.com/users/2828925/jes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439412370, "creation_date": 1439412370, "question_id": 31975067, "link": "https://stackoverflow.com/questions/31975067/running-two-socket-applications-within-one-program", "title": "Running two socket applications within one program", "body": "<p>I have two C/C++ socket programs, say <code>server</code> and <code>client</code>, and both communicate to each other through <code>read</code> and <code>write</code>. The entire flow works fine (i.e., communication, read, write) when I run the two programs on two separate terminals in localhost. To avoid manually starting the <code>client</code> program, I use <code>system(exec_cmd_to_run_client_program)</code> in my server program. However, doing so doesn't give me the correct result as that of two separate terminals. I do see <code>server</code> and <code>client</code> running in the job monitor, but the communication in between seems never happens. What could be the problem? </p>\n\n<p>Also I tried using ssh library <code>libssh</code> in the <code>server</code> program to open a new ssh session and send execution command to run the <code>client</code> program. Again I see the same result as system call. Both programs showed up in the job monitor but communication never happens. Did I miss something?</p>\n"}, {"tags": ["c", "clang"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1439411672, "post_id": 31974449, "comment_id": 51856395, "body": "See <a href=\"http://stackoverflow.com/q/24294578/1708801\">log(10.0) can compile but log(0.0) cannot?</a> basically it is using a builtin and so in those cases it does not need to link against the math library."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1439412248, "post_id": 31974449, "comment_id": 51856714, "body": "@ShafikYaghmour I think that&#39;s a different issue. The compiler is evaluating <code>log(10.0)</code> rather than writing code to evaluate at runtime."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1439412886, "post_id": 31974449, "comment_id": 51857081, "body": "@ShafikYaghmour I don&#39;t agree."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1439413120, "post_id": 31974449, "comment_id": 51857211, "body": "@DavidHeffernan well the best way to test is to use -fno-builtin if that changes the need for -lm then it is indeed the case."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1439423913, "post_id": 31974449, "comment_id": 51860901, "body": "Indeed using <code>-fno-builtin</code> forces <code>-lm</code> to be required <a href=\"http://coliru.stacked-crooked.com/a/6b04f743ad98ac1e\" rel=\"nofollow noreferrer\">see it live</a> so this is indeed the same issue as I linked above. In order to make the above program work we would have to add <code>-lm</code>."}], "answers": [{"tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 6, "last_activity_date": 1439410282, "creation_date": 1439410282, "answer_id": 31974485, "question_id": 31974449, "link": "https://stackoverflow.com/questions/31974449/need-to-use-lm-in-clang-with-pow-but-not-sqrt/31974485#31974485", "title": "Need to use -lm in Clang with pow(), but not sqrt()", "body": "<p>You are targeting a processor whose floating point hardware implements <code>sqrt</code> directly, as do all IEEE-754 compliant units. As such, the compiler can generate code for <code>sqrt</code> directly and does not need to link to a library function. </p>\n\n<p>On the other hand, floating point hardware does not typically offer implementations of <code>pow</code> and so it does need to be implemented in a library.</p>\n"}], "owner": {"reputation": 87, "user_id": 3803845, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/k9xgn.png?s=128&g=1", "display_name": "Webtm", "link": "https://stackoverflow.com/users/3803845/webtm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "accepted_answer_id": 31974485, "answer_count": 1, "score": 4, "last_activity_date": 1439411987, "creation_date": 1439410149, "last_edit_date": 1439411987, "question_id": 31974449, "link": "https://stackoverflow.com/questions/31974449/need-to-use-lm-in-clang-with-pow-but-not-sqrt", "title": "Need to use -lm in Clang with pow(), but not sqrt()", "body": "<p>On FreeBSD <code>10.1</code> and using Clang version <code>3.4.1</code></p>\n\n<p>Now I have seen other threads asking <strong>how to compile with using pow()</strong>, but I haven't seen a thread with this question. Take for example:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n  float result;\n  result = pow(2,3);\n  printf(\"%d\", result);\n  return 0;\n}\n</code></pre>\n\n<p>Now using <code>pow()</code>, I need to issue clang the argument -lm. </p>\n\n<blockquote>\n  <p>cc -lm -o name name.c</p>\n</blockquote>\n\n<p>However, replacing <code>pow(2,3)</code> with <code>sqrt(5);</code>, I can compile with <code>cc -o name name.c</code>. If they both use <code>math.h</code>, then why does <code>pow()</code> need to be linked to the library?\nSide not: Installed gcc to test, and I don't need to use -lm at all.</p>\n"}, {"tags": ["c", "linux", "sockets"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439409439, "post_id": 31974157, "comment_id": 51855280, "body": "I won&#39;t flag it as duplicate as it is referring to a different language, but essentially the same: <a href=\"http://stackoverflow.com/questions/1365265/on-localhost-how-to-pick-a-free-port-number\" title=\"on localhost how to pick a free port number\">stackoverflow.com/questions/1365265/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1439409352, "creation_date": 1439409352, "answer_id": 31974245, "question_id": 31974157, "link": "https://stackoverflow.com/questions/31974157/bind-to-specific-address-but-random-port-linux/31974245#31974245", "title": "Bind to specific address but random port Linux", "body": "<p>Just set <code>addr.sin_port</code> to zero.  The OS will pick one for you.</p>\n\n<p>After the <code>bind</code>, you can call <code>getsockname</code> to find out which port you were bound to.</p>\n"}], "owner": {"reputation": 1338, "user_id": 1772510, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/507de10a282f571a93a2ad2193b5b9e0?s=128&d=identicon&r=PG", "display_name": "dreadiscool", "link": "https://stackoverflow.com/users/1772510/dreadiscool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 1, "accepted_answer_id": 31974245, "answer_count": 1, "score": 1, "last_activity_date": 1439409352, "creation_date": 1439409002, "question_id": 31974157, "link": "https://stackoverflow.com/questions/31974157/bind-to-specific-address-but-random-port-linux", "title": "Bind to specific address but random port Linux", "body": "<p>Is there an idiomatic way to specify a specific address to bind to, but a random port?</p>\n\n<p>In my application, I open a few dozen connections. I call bind() before connect() so that I can specify the IP address that the connection should be established with. However, I have to find an open port myself. It works fine for now, but it could become an issue if I need to open thousands of connections, as finding an open port will become slower and slower</p>\n\n<pre><code>int fd;\nstruct sockaddr_in addr;\n\nfd = socket(AF_INET, SOCK_STREAM, 0);\n\nwhile (TRUE)\n{\n    addr.sin_family = AF_INET;\n    addr.sin_addr.s_addr = inet_addr(\"192.168.0.1\");\n    addr.sin_port = htons((rand() % 65000) + 1);\n\n    if (bind(fd, (struct sockaddr *)&amp;addr, sizeof (struct sockaddr_in)) == 0)\n        break;\n}\n</code></pre>\n\n<p>I considered writing my own \"port management\" system, but I figured I would try to see if the OS already has a feature before going ahead and doing that</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 1632, "user_id": 4178025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159c588df64aaa5d1b2c96c1461e85cf?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/4178025/diego"}, "edited": false, "score": 0, "creation_date": 1439409314, "post_id": 31974007, "comment_id": 51855220, "body": "You may be interested in <a href=\"http://stackoverflow.com/questions/29357259/gnu-make-wildcard-alternative\">this question</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4713908"}, "reply_to_user": {"reputation": 1632, "user_id": 4178025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159c588df64aaa5d1b2c96c1461e85cf?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/4178025/diego"}, "edited": false, "score": 0, "creation_date": 1439410186, "post_id": 31974007, "comment_id": 51855639, "body": "Thanks. I&#39;ll do my search about wildcards. I wasn&#39;t aware of it!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4713908"}, "reply_to_user": {"reputation": 1632, "user_id": 4178025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159c588df64aaa5d1b2c96c1461e85cf?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/4178025/diego"}, "edited": false, "score": 0, "creation_date": 1439414442, "post_id": 31974007, "comment_id": 51857881, "body": "@Diego. Thanks brow. Wildcards are awesome."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1439415877, "post_id": 31974007, "comment_id": 51858493, "body": "Make is a lot easier to handle if the Makefile itself is in your build tree rather than the source tree (see how GMake builds them, for example)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4713908"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1439467045, "post_id": 31974007, "comment_id": 51879592, "body": "@LeeDanielCrocker: I have another Makefile in the my built directory. I have one in the root directory that give orders to src//Makefile and built/Makefile depending on the type of target I want to call. src/Makefile is only for compilation and built/Makefile is for link and clean operations. I&#39;m plenty new on Make world, so I&#39;ll see what I can learn from GMake, as you said. Thanks."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1442855965, "post_id": 31974007, "comment_id": 53245109, "body": "Rather than putting the answer in the question, post it separately as an answer to your own question and accept it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4713908"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1442923656, "post_id": 31974007, "comment_id": 53275173, "body": "Good one @dbush. Thanks!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4713908"}, "is_accepted": true, "score": 1, "last_activity_date": 1442923707, "creation_date": 1442923707, "answer_id": 32716489, "question_id": 31974007, "link": "https://stackoverflow.com/questions/31974007/geting-source-code-structure-in-makefile/32716489#32716489", "title": "Geting source code structure in Makefile", "body": "<h3>EDIT [Solved]</h3>\n\n<p>I like to do the following. </p>\n\n<h2>Create Variables to Each Directory of the Project</h2>\n\n<pre><code>SRCDIR = src                                                           \nOBJDIR = obj\nLIBDIR = lib\nDOCDIR = doc\nHDRDIR = include\n\nCFLAGS = -g -Wall -O3\n</code></pre>\n\n<h2>Get Only the Internal Structure of SRCDIR Recursively</h2>\n\n<pre><code>STRUCTURE := $(shell find $(SRCDIR) -type d)     \n</code></pre>\n\n<h2>Get All Files inside the STRUCTURE Variable</h2>\n\n<pre><code>CODEFILES := $(addsuffix /*,$(STRUCTURE))\nCODEFILES := $(wildcard $(CODEFILES))            \n</code></pre>\n\n<h2>Filter Out Only Specific Files</h2>\n\n<pre><code># Filter Only Specific Files                                \nSRCFILES := $(filter %.c,$(CODEFILES))\nHDRFILES := $(filter %.h,$(CODEFILES))\nOBJFILES := $(subst $(SRCDIR),$(OBJDIR),$(SRCFILES:%.c=%.o))\n\n# Filter Out Function main for Libraries\nLIBDEPS := $(filter-out $(OBJDIR)/main.o,$(OBJFILES))\n</code></pre>\n\n<h2>Now it is Time to create the Rules</h2>\n\n<pre><code>compile: $(OBJFILES)\n\n$(OBJDIR)/%.o: $(addprefix $(SRCDIR)/,%.c %.h)\n    $(CC) -c $&lt; -o $@ $(CFLAGS) \n</code></pre>\n\n<p>With this approach, you can see that I'm using the STRUCTURE variable only to get the files inside the SRCDIR directory, but it can be used for others purposes as well, like mirror the SRCDIR inside OBJDIR once STRUCTURE stores only the internal sub-directories. It is quite useful after clean operations like:</p>\n\n<pre><code>clean:\n    -rm -r $(OBJDIR)/*\n</code></pre>\n\n<p>NOTE: The compile rule only works well if for each *.c there is the corresponding *.h file (with the same base name, I mean).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4713908"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 32716489, "answer_count": 1, "score": 3, "last_activity_date": 1446141789, "creation_date": 1439408501, "last_edit_date": 1446141789, "question_id": 31974007, "link": "https://stackoverflow.com/questions/31974007/geting-source-code-structure-in-makefile", "title": "Geting source code structure in Makefile", "body": "<p>I'm working on a C project, and I decided to put the source code and its objects in different directories. The root directory has something like that:</p>\n\n<pre><code>SmartC  \u25b6 tree -L 1\n.\n\u251c\u2500\u2500 built\n\u251c\u2500\u2500 doc\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 src\n\u251c\u2500\u2500 tests\n\u2514\u2500\u2500 trash\n</code></pre>\n\n<p>So, inside both src and built directories, I put two others Makefiles to do the compile and link jobs. </p>\n\n<p>The src directory (where I put the source code) has the following structure:</p>\n\n<pre><code>src\n\u251c\u2500\u2500 graph.c\n\u251c\u2500\u2500 graph.h\n\u251c\u2500\u2500 list.c\n\u251c\u2500\u2500 list.h\n\u251c\u2500\u2500 main.c\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 node.c\n\u251c\u2500\u2500 node.h\n\u251c\u2500\u2500 tree.c\n\u251c\u2500\u2500 tree.h\n\u2514\u2500\u2500 types\n    \u251c\u2500\u2500 complex.c\n    \u251c\u2500\u2500 complex.h\n    \u251c\u2500\u2500 matrix.c\n    \u2514\u2500\u2500 matrix.h\n</code></pre>\n\n<p>and the built has the same structure, but it is intended to store all objects made by compilation. </p>\n\n<p>My question is about my src/Makefile:</p>\n\n<pre><code>BINDIR = ../built/src                \n\nCC = gcc\n\nCFLAGS = -g -Wall -O3\n\nOBJECTS = \\\n          $(BINDIR)/main.o          \\\n          $(BINDIR)/node.o          \\\n          $(BINDIR)/list.o          \\\n          $(BINDIR)/graph.o         \\\n          $(BINDIR)/tree.o          \\\n          $(BINDIR)/types/complex.o \\\n          $(BINDIR)/types/matrix.o  \\\n\n\ncompile: $(OBJECTS)\n\n$(BINDIR)/%.o: %.c\n    $(CC) -c $&lt; -o $@ $(CFLAGS)\n</code></pre>\n\n<p>This Makefile creates all the objects of the source code, inside src directory, and move them to built/src. But, every time I create a new source code file (*.c), I have to put the name of its object in this makefile, so it can be compiled. I'd like to do an automatic search, inside the src directory, and fill the \"OBJECTS\" variable with this search.</p>\n\n<p>Is anyone has some idea of how to accomplish this? I mean, automatic search for source code inside an specific directory? </p>\n\n<p>I even accept any other strategy rather than what I'm making. </p>\n\n<p>=========== Answer ===============</p>\n\n<p>I got the tip (in comments) about wildcards. So I did. Here is the solution I found.</p>\n\n<p>src/Makefile</p>\n\n<pre><code>BINDIR = ../built/src                                         \n\nCC = gcc                                                      \n\nCFLAGS = -g -Wall -O3                                         \n\n\nOBJECTS := $(patsubst %.c,$(BINDIR)/%.o,$(wildcard *.c */*.c))\n\ncompile: $(OBJECTS)                                           \n\n$(BINDIR)/%.o: %.c                                            \n    $(CC) -c $&lt; -o $@ $(CFLAGS)                               \n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1439409544, "post_id": 31973854, "comment_id": 51855339, "body": "I have a feeling that the problem is with the <code>Compare</code> function, not the <code>EmployeeList</code> array. Posting a <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a> would make this question a lot easier to answer."}, {"owner": {"reputation": 537, "user_id": 3902763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02819225c6fcfa3af9aa411a13e654bc?s=128&d=identicon&r=PG&f=1", "display_name": "oneday", "link": "https://stackoverflow.com/users/3902763/oneday"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1439410009, "post_id": 31973854, "comment_id": 51855563, "body": "I have modified the code part and put much more relevant part of code. if Its not sufficient - will put the entire code - just trying to avoid cluster."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1439411151, "post_id": 31973854, "comment_id": 51856107, "body": "I see no problems with that code, the <code>Compare</code> function looks correct. I filled in the blanks to make an MCVE, and it compiles without error or warning (using clang with -Wall), and runs fine. Which compiler are you using?"}, {"owner": {"reputation": 537, "user_id": 3902763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02819225c6fcfa3af9aa411a13e654bc?s=128&d=identicon&r=PG&f=1", "display_name": "oneday", "link": "https://stackoverflow.com/users/3902763/oneday"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1439411790, "post_id": 31973854, "comment_id": 51856454, "body": "I am using microsoft compiler"}], "answers": [{"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1439410728, "post_id": 31974505, "comment_id": 51855881, "body": "Of course it will change data pointed by <code>EmployeeList</code> : it&#39;s the pointers it&#39;s supposed to sort. The <code>const</code> only applies to the next level of dereferencing."}, {"owner": {"reputation": 537, "user_id": 3902763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02819225c6fcfa3af9aa411a13e654bc?s=128&d=identicon&r=PG&f=1", "display_name": "oneday", "link": "https://stackoverflow.com/users/3902763/oneday"}, "edited": false, "score": 0, "creation_date": 1439411665, "post_id": 31974505, "comment_id": 51856392, "body": "@user996142 - Thanks for the detailed answer. I do understand that and I tried to point out that problem in my question - I was wondering is there a way to overcome it - assuming I cannot change   const char *EmployeeList[] =    {       &quot;Larry Page&quot;, &quot;Sergy Brin&quot;, &quot;Sundar Pichai&quot;, &quot;Merrisa Mayer&quot;    };"}, {"owner": {"reputation": 537, "user_id": 3902763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02819225c6fcfa3af9aa411a13e654bc?s=128&d=identicon&r=PG&f=1", "display_name": "oneday", "link": "https://stackoverflow.com/users/3902763/oneday"}, "edited": false, "score": 0, "creation_date": 1439411763, "post_id": 31974505, "comment_id": 51856442, "body": "I just changed void SortEmployee(const char *EmployeeList[], size_t EmployeeCount) to void SortEmployee(char *EmployeeList[], size_t EmployeeCount) and I no longer see it  - Thanks for the help !!"}], "tags": [], "owner": {"reputation": 2397, "user_id": 996142, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/22f659c828b9c60e26aa2359387cebfb?s=128&d=identicon&r=PG", "display_name": "user996142", "link": "https://stackoverflow.com/users/996142/user996142"}, "is_accepted": true, "score": 7, "last_activity_date": 1543598013, "last_edit_date": 1543598013, "creation_date": 1439410345, "answer_id": 31974505, "question_id": 31973854, "link": "https://stackoverflow.com/questions/31973854/warning-c4090-function-different-const-qualifiers/31974505#31974505", "title": "warning C4090: &#39;function&#39; : different &#39;const&#39; qualifiers", "body": "<p>The problem is <code>qsort</code> <em>does not</em> declare its argument as <code>const</code>, while your code <em>does</em>. That means <code>qsort</code> may (in theory) change data, pointed by <code>EmployeeList</code>. So, the compiler reports this error. </p>\n\n<p>Here is the official example: <a href=\"https://msdn.microsoft.com/en-us/library/k77bkb8d.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/k77bkb8d.aspx</a></p>\n\n<p>How ever, here is a simple version to demonstrate my idea: </p>\n\n<pre><code>void foo(char* a) {\n   *a = '1'; // I got pointer to char, and changed this char!\n}\n\n\nint main() {\n   const char *a = \"A\"; // I have \"CONSTANT POINTER\": it points to CONSTANT memory, that CAN NOT be changed (by the way, string constants can't in many environments).\n   foo(a); // I pass it to my function, that will change it.\n   return 0;\n}\n</code></pre>\n\n<p>Image your compiler stores <code>a</code> in read-only memory (It can, because we told it \"this is a pointer to READ ONLY data\"). You then modify it (in <code>main</code> function). Something bad may happen. So, the compiler warns you \"hey, you pass a pointer to <em>constant</em> data to some function, that <em>does not know</em> that this data is constant and <em>may</em> change it\"</p>\n"}], "owner": {"reputation": 537, "user_id": 3902763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02819225c6fcfa3af9aa411a13e654bc?s=128&d=identicon&r=PG&f=1", "display_name": "oneday", "link": "https://stackoverflow.com/users/3902763/oneday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10797, "favorite_count": 0, "accepted_answer_id": 31974505, "answer_count": 1, "score": 2, "last_activity_date": 1543598013, "creation_date": 1439407878, "last_edit_date": 1443714839, "question_id": 31973854, "link": "https://stackoverflow.com/questions/31973854/warning-c4090-function-different-const-qualifiers", "title": "warning C4090: &#39;function&#39; : different &#39;const&#39; qualifiers", "body": "<p>I am observing error \"warning C4090: 'function' : different 'const' qualifiers \" because of below line of code. Going through other similar questions on SO I understand (not 100 percent) it is because of </p>\n\n<p>-->  const char* EmployeeList[]  and my declaration in qsort of EmployeeList</p>\n\n<pre><code>    #define Elements(array) (sizeof(array)/sizeof((array)[0]))\n\n   const char *EmployeeList[] =\n   {\n      \"Larry Page\", \"Sergy Brin\", \"Sundar Pichai\", \"Merrisa Mayer\"\n   };\n\n// called from main\nSortEmployee(EmployeeList, Elements(EmployeeList));\n\nint Compare(const void *elemA, const void *elemB)\n{\n ...\n}\n\nvoid SortEmployee(const char *EmployeeList[], size_t EmployeeCount)\n{\n    qsort(EmployeeList, EmployeeCount, sizeof(EmployeeList[0]), Compare);\n}\n</code></pre>\n\n<p>However I am unable to resolve it- Any pointers how to do it for array of strings.</p>\n"}, {"tags": ["c", "multithreading", "mfc"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1439408274, "post_id": 31973709, "comment_id": 51854668, "body": "<a href=\"https://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library\" rel=\"nofollow noreferrer\">MFC</a> is a C++ framework, not C."}, {"owner": {"reputation": 906, "user_id": 3906985, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6Qygd.jpg?s=128&g=1", "display_name": "Robson", "link": "https://stackoverflow.com/users/3906985/robson"}, "edited": false, "score": 0, "creation_date": 1439453173, "post_id": 31973709, "comment_id": 51870720, "body": "you question is about the basics of multithreading, we all have to learn somehow =) so check out this youtube serie <a href=\"https://www.youtube.com/watch?v=LL8wkskDlbs&amp;list=PL5jc9xFGsL8E12so1wlMS0r0hTQoJL74M\" rel=\"nofollow noreferrer\">youtube.com/&hellip;</a> it is quite good and the person explains quite well!"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 2038186, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/cSCYr.jpg?s=128&g=1", "display_name": "Fernanda Brum Lousada", "link": "https://stackoverflow.com/users/2038186/fernanda-brum-lousada"}, "edited": false, "score": 0, "creation_date": 1439409647, "post_id": 31973780, "comment_id": 51855391, "body": "Thanks for your reply, @shf301! if I debug the code, one thread only prints when another thread is created in the for statement. Is there a relation between them or it has nothing to do?"}, {"owner": {"reputation": 29966, "user_id": 161455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f48b3bc50d995b0cbc7a1038760ea02?s=128&d=identicon&r=PG", "display_name": "shf301", "link": "https://stackoverflow.com/users/161455/shf301"}, "reply_to_user": {"reputation": 329, "user_id": 2038186, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/cSCYr.jpg?s=128&g=1", "display_name": "Fernanda Brum Lousada", "link": "https://stackoverflow.com/users/2038186/fernanda-brum-lousada"}, "edited": false, "score": 2, "creation_date": 1439411084, "post_id": 31973780, "comment_id": 51856079, "body": "You&#39;ll see completely different behavior when debugging since that will affects how the threads are running."}], "tags": [], "owner": {"reputation": 29966, "user_id": 161455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f48b3bc50d995b0cbc7a1038760ea02?s=128&d=identicon&r=PG", "display_name": "shf301", "link": "https://stackoverflow.com/users/161455/shf301"}, "is_accepted": true, "score": 2, "last_activity_date": 1439407589, "creation_date": 1439407589, "answer_id": 31973780, "question_id": 31973709, "link": "https://stackoverflow.com/questions/31973709/multithread-behavior/31973780#31973780", "title": "Multithread behavior?", "body": "<p>Each thread is printing the numbers that are assigned to it.  It's just that all of your threads are running at the same time so their output is overlapping.  You'll probably see what is happening better if you add <code>printf</code> at the start and end of the of <code>ThreadFunc</code>.</p>\n\n<p>Windows make no guarantees on the order that threads will run or exactly how long a thread will run for, which is why you see variable.  You will most likely get different results each time you run your program.</p>\n"}], "owner": {"reputation": 329, "user_id": 2038186, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/cSCYr.jpg?s=128&g=1", "display_name": "Fernanda Brum Lousada", "link": "https://stackoverflow.com/users/2038186/fernanda-brum-lousada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 31973780, "answer_count": 1, "score": 2, "last_activity_date": 1439407589, "creation_date": 1439407323, "question_id": 31973709, "link": "https://stackoverflow.com/questions/31973709/multithread-behavior", "title": "Multithread behavior?", "body": "<p>I've the following MFC console program:</p>\n\n<pre><code>UINT ThreadFunc(LPVOID);\n\nint _tmain(int argc, TCHAR* argv[], TCHAR* envp[])\n{\n    for (int i = 0; i &lt; 5; i++)\n    {\n        if (AfxBeginThread(ThreadFunc, (LPVOID)i))\n        {\n            printf(\"Thread launched: %d\\n\", i);\n        }\n    }\n\n    Sleep(2000);\n\n    system(\"pause\");\n\n    return 0;\n}\n\nUINT ThreadFunc(LPVOID n)\n{\n    for (int i = 0; i &lt; 10; i++)\n    {\n        printf(\"%d%d%d%d%d%d%d%d\\n\", (int)n, (int)n, (int)n, (int)n, (int)n, (int)n, (int)n, (int)n);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Whose output, in some execution, is:</p>\n\n<pre><code>Thread launched: 0\n00000000\n00000000\n00000000\n00000000\n00000000\n00000000\nThread launched: 1\n11111111\n11111111\n11111111\nThread launched: 2\n00000000\n00000000\n00000000\n00000000\n33333333\n33333333\n33333333\nThread launched: 3\n11111111\n11111111\n11111111\n11111111\n44444444\n44444444\n44444444\nThread launched: 4\n22222222\n22222222\n22222222\n22222222\n22222222\n22222222\n22222222\n22222222\n22222222\n22222222\n11111111\n11111111\n11111111\n44444444\n44444444\n44444444\n44444444\n44444444\n44444444\n44444444\n33333333\n33333333\n33333333\n33333333\n33333333\n33333333\n33333333\n</code></pre>\n\n<p>So I would like to understand what is going on here. Why do thread's prints differ from each other (one thread prints numbers that should be printed by other thread)? Why do one thread only prints (all at once!) after the next thread to be created? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1439406945, "post_id": 31973366, "comment_id": 51853967, "body": "Start with indenting your code properly, so people could read it without breaking their eyes."}, {"owner": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439407145, "post_id": 31973366, "comment_id": 51854076, "body": "please see the search node part only...thnk u !!"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439407969, "post_id": 31973366, "comment_id": 51854516, "body": "<a href=\"http://stackoverflow.com/a/605858/3233393\">Please do not cast the result of <code>malloc()</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "edited": false, "score": 0, "creation_date": 1439406612, "post_id": 31973447, "comment_id": 51853792, "body": "why this search function is not wrking then...am fed up"}, {"owner": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "edited": false, "score": 0, "creation_date": 1439407273, "post_id": 31973447, "comment_id": 51854152, "body": "it is working fine...but when i try to search for the node...it goes into infinite recursion i think !!"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "reply_to_user": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "edited": false, "score": 1, "creation_date": 1439407377, "post_id": 31973447, "comment_id": 51854228, "body": "No, its not; insert never actually puts anything into the tree."}], "tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": true, "score": 2, "last_activity_date": 1439406400, "creation_date": 1439406400, "answer_id": 31973447, "question_id": 31973366, "link": "https://stackoverflow.com/questions/31973366/why-the-address-returned-by-the-create-function-is-not-same-as-root-for-the-firs/31973447#31973447", "title": "Why the address returned by the create function is not same as root for the first node", "body": "<p>You print the result of calling <code>create</code>, and then call <code>create</code> <em>again</em> for the return value, thus creating a second node.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "edited": false, "score": 0, "creation_date": 1439462930, "post_id": 31974461, "comment_id": 51876836, "body": "i have added nodes using the above code....it is accepting the integers and printing it in sorted order when i print the inorder traversal for it !!"}, {"owner": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "edited": false, "score": 0, "creation_date": 1439462971, "post_id": 31974461, "comment_id": 51876864, "body": "but i dont understnd y the same approach is not working for the search"}, {"owner": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "edited": false, "score": 0, "creation_date": 1439463049, "post_id": 31974461, "comment_id": 51876913, "body": "moreover am adding nthng to the parent node...so i dnt think it would matter much since evry node&#39;s parent part would be null..but the left and right will have the addresses of their children"}], "tags": [], "owner": {"reputation": 167, "user_id": 2901527, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9eaba4f92e17fec2b7fdf55460e5fe93?s=128&d=identicon&r=PG&f=1", "display_name": "Kdawg", "link": "https://stackoverflow.com/users/2901527/kdawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1457559023, "last_edit_date": 1457559023, "creation_date": 1439410182, "answer_id": 31974461, "question_id": 31973366, "link": "https://stackoverflow.com/questions/31973366/why-the-address-returned-by-the-create-function-is-not-same-as-root-for-the-firs/31974461#31974461", "title": "Why the address returned by the create function is not same as root for the first node", "body": "<p>First the problems with your BST Algorithm: Your node creation algorithm never attaches new nodes to a parent. Create() sets node->parent to NULL and your insert() never updates the parent variable to root. Additionally, you're never setting the new left/right fields of your new node's parent</p>\n\n<p>Change</p>\n\n<pre><code> return create(a)\n</code></pre>\n\n<p>to</p>\n\n<pre><code> tree_node * new_node = create(a);\n new_node-&gt;parent=root;\n new_node-&gt;parent-&gt;left/right=new_node;  //include some way to distinguish whether you went left or right in the previous recursive call\n return new_node\n</code></pre>\n\n<p>Now for your address question, you call create() twice, which (think procedurally) results in two malloc() calls, and thus two addresses.</p>\n"}], "owner": {"reputation": 11, "user_id": 3590607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77dbbc6881b221cd30d044aeaf6c46db?s=128&d=identicon&r=PG&f=1", "display_name": "user3590607", "link": "https://stackoverflow.com/users/3590607/user3590607"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 31973447, "answer_count": 2, "score": 0, "last_activity_date": 1457559023, "creation_date": 1439406080, "last_edit_date": 1439406253, "question_id": 31973366, "link": "https://stackoverflow.com/questions/31973366/why-the-address-returned-by-the-create-function-is-not-same-as-root-for-the-firs", "title": "Why the address returned by the create function is not same as root for the first node", "body": "<p>Below is my code for the BST :\ninsert works fine but search doesnt   </p>\n\n<pre><code>typedef struct tree_node{\n\nstruct tree_node* parent;\nstruct tree_node* left;\nstruct tree_node* right;\nint x;\n}tree_node;\n\ntree_node *strt=NULL;\n\ntree_node *traverse;\n\ntree_node* create(int info){\n\ntree_node *temp=NULL;\ntemp=(tree_node*)malloc(sizeof(tree_node));\n\ntemp-&gt;parent=NULL;\ntemp-&gt;left=NULL;\ntemp-&gt;right=NULL;\ntemp-&gt;x=info;\n\nreturn temp;\n}\n\ntree_node* insert(tree_node *root, int a){\n\n/* here i am printing the address of the node which must be same as the root for the first node */\n\nif(root==NULL){\n   printf(\"%d \",create(a)); \n   return create(a);        \n}\n\nelse if(a &lt;= root-&gt;x)\n    return insert(root-&gt;left,a);\n\nelse\n    return insert(root-&gt;right,a);\n\nreturn root;\n}\n\ntree_node* search_ele(tree_node *root,int info){\n\nif(root==NULL || root-&gt;x==info)\n    return root ;\n\nif(info &lt; root-&gt;x)\n    return search_ele(root-&gt;left,info);\n\nelse\n    return search_ele(root-&gt;right,info);\n\n}\n\nvoid display_inorder(tree_node *root){\n\nif(root==NULL)\n    return;\n\ndisplay_inorder(root-&gt;left);\nprintf(\"%d \",root-&gt;x);\ndisplay_inorder(root-&gt;right);\n}\n\nvoid main(){\n\nint element;\ntree_node *search_element;\n\nwhile(1){\n\nchar ch;\nint num;\n\nprintf(\"\\nWant to enter a node..??\\n\\n\");\nscanf(\" %c\",&amp;ch);\nif(ch=='n'||ch=='N')\nbreak;\n\nelse{\n\n    printf(\"Enter the number \\n\");\n    scanf(\"%d\",&amp;num);\n\n    if(strt==NULL)\n        printf(\"Tree is empty...entering first node...!!!\\n\");\n\n    strt=insert(strt,num);\n    printf(\"%d\",strt);\n    }\n  }\n\n\n\nprintf(\"Enter the element u want to search\\n\");\nscanf(\"%d \",&amp;element);\n\nif(search_ele(strt,element)==NULL)\nprintf(\"no such element\\n\");\n\nelse\n    printf(\"element found\\n\");\n\ndisplay_inorder(strt);\n}\n</code></pre>\n\n<p>The output displays :</p>\n\n<pre><code>Want to enter a node ?\n\ny\nEnter the number \n6\nTree is empty...entering first node...!!!\n5279480 5279504 (why are these different??)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6434, "user_id": 356307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G3ppl.jpg?s=128&g=1", "display_name": "Jens", "link": "https://stackoverflow.com/users/356307/jens"}, "edited": false, "score": 2, "creation_date": 1439405494, "post_id": 31973141, "comment_id": 51853200, "body": "This question can not be answered in a generic way, but depends on what platform (OS and hardware) you run the code, and what compiler and optimization you use. For x86 perhaps look at <a href=\"http://www.csee.umbc.edu/~chang/cs313.s02/stack.shtml\" rel=\"nofollow noreferrer\">this link</a>"}, {"owner": {"reputation": 35069, "user_id": 1324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883238a436c061eaf848af87b8fda561?s=128&d=identicon&r=PG", "display_name": "Paul Roub", "link": "https://stackoverflow.com/users/1324/paul-roub"}, "edited": false, "score": 1, "creation_date": 1439405515, "post_id": 31973141, "comment_id": 51853212, "body": "The second one will print the address of <code>c</code>, or at least an integer&#39;s-worth of that address. The first one is undefined. Changing compilers, or even compiler options, can change the stack contents."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1439405665, "post_id": 31973141, "comment_id": 51853288, "body": "Yeah.  More rubbish code with UB &#39;cos printf specifiers don&#39;t match with arguments."}, {"owner": {"reputation": 2295, "user_id": 1015722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bc6501f8452eb4b459bf2dc4de5a96?s=128&d=identicon&r=PG", "display_name": "Jeremy Rodi", "link": "https://stackoverflow.com/users/1015722/jeremy-rodi"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1439415218, "post_id": 31973141, "comment_id": 51858237, "body": "@MartinJames of course it compiles; C isn&#39;t here to baby sit you, so if you want to shoot yourself in the foot, it&#39;ll let you."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 2295, "user_id": 1015722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bc6501f8452eb4b459bf2dc4de5a96?s=128&d=identicon&r=PG", "display_name": "Jeremy Rodi", "link": "https://stackoverflow.com/users/1015722/jeremy-rodi"}, "edited": false, "score": 0, "creation_date": 1439415380, "post_id": 31973141, "comment_id": 51858306, "body": "@JeremyRodi Any compiler from this millenium would bury you in warnings though. If you enabled them, that is."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 2295, "user_id": 1015722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bc6501f8452eb4b459bf2dc4de5a96?s=128&d=identicon&r=PG", "display_name": "Jeremy Rodi", "link": "https://stackoverflow.com/users/1015722/jeremy-rodi"}, "edited": false, "score": 0, "creation_date": 1439417188, "post_id": 31973141, "comment_id": 51858957, "body": "@JeremyRodi - would it not need a forward declaration for foo()?"}, {"owner": {"reputation": 2295, "user_id": 1015722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bc6501f8452eb4b459bf2dc4de5a96?s=128&d=identicon&r=PG", "display_name": "Jeremy Rodi", "link": "https://stackoverflow.com/users/1015722/jeremy-rodi"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439418664, "post_id": 31973141, "comment_id": 51859446, "body": "@MartinJames To compile?  <a href=\"http://stackoverflow.com/q/2575153/1015722\">No</a>.  In fact, <a href=\"https://eval.in/416033\" rel=\"nofollow noreferrer\">this compiles</a>.  The code in the question <a href=\"https://eval.in/416034\" rel=\"nofollow noreferrer\">also compiles</a>."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 2367424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a303052924a839c88b5edabb7fc3a?s=128&d=identicon&r=PG", "display_name": "ArBel", "link": "https://stackoverflow.com/users/2367424/arbel"}, "is_accepted": false, "score": 0, "last_activity_date": 1439405783, "creation_date": 1439405783, "answer_id": 31973290, "question_id": 31973141, "link": "https://stackoverflow.com/questions/31973141/want-to-understand-how-function-variables-are-stored-in-stack/31973290#31973290", "title": "Want to understand how function variables are stored in stack", "body": "<p><strong>TO 8086 platforms:</strong> As you can read <a href=\"http://gribblelab.org/CBootcamp/7_Memory_Stack_vs_Heap.html\" rel=\"nofollow\">here</a>, stack is the runtime/call stack, each function local vars are stored in the current procedure stack frame. read more about runtime/call stack <a href=\"https://en.wikipedia.org/wiki/Call_stack\" rel=\"nofollow\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 2758, "user_id": 446006, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zV0uM.jpg?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/446006/abhi"}, "is_accepted": true, "score": 1, "last_activity_date": 1439415111, "creation_date": 1439415111, "answer_id": 31975779, "question_id": 31973141, "link": "https://stackoverflow.com/questions/31973141/want-to-understand-how-function-variables-are-stored-in-stack/31975779#31975779", "title": "Want to understand how function variables are stored in stack", "body": "<p><code>%x</code> is a format specifier indicates you want to print in lower-case hexadecimal.\nSo when you don't specify data in the first <code>printf</code> the result is undefined.  Even though the code compiles  - it is incomplete!</p>\n\n<p>So let us fix the code first- here is the revised code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid foo(char *str);\n\nint main(int argc, char* argv[])\n{\n\n    foo(\"%x\");\n    return 0;\n}\n\nvoid foo(char *str)\n{\n\n    char c='c';\n    printf(str,c);\n\n    printf(\"\\n%x\",&amp;c);\n}\n</code></pre>\n\n<p>Now to answer your questions \"how variables are stored in the memory stack\" \nThe stack pointer registers the top of the stack,every time a value is pushed on to or popped out of the stack - the stack pointer is adjusted to point to the free memory. And then there is the stack frame, it corresponds to a call to the function which has not yet terminated with a return.\n<a href=\"https://i.stack.imgur.com/npcIY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/npcIY.png\" alt=\"enter image description here\"></a></p>\n\n<p>the other part was \"what the printf statements are printing.\"\nThe first parameter in the printf is a format specifier, the second parameter onwards are the data that are to be used for those format specifier(s). When you did not have the c in your first original printf - it just picked up the adjacent int  and printed that for %x that was specified. In the revised first printf I made it print he cvalue of c in hexadecimal. In your second printf  you make it print the address of C variable that is in the stack.</p>\n\n<p>Check these links for further details -\n<a href=\"https://en.wikipedia.org/wiki/Call_stack#Structure\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Call_stack#Structure</a>\nAlso other Stackoverflow Q&amp;As that show up on the right pane.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1032317"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 31975779, "answer_count": 2, "score": 0, "last_activity_date": 1439415111, "creation_date": 1439405296, "question_id": 31973141, "link": "https://stackoverflow.com/questions/31973141/want-to-understand-how-function-variables-are-stored-in-stack", "title": "Want to understand how function variables are stored in stack", "body": "<p>I am trying to understand how variables are stored in the memory stack and what the printf statements are printing. Your insight in this will be highly appreciated. Thank you.</p>\n\n<p>Ideone link <a href=\"http://ideone.com/uWvPpX\" rel=\"nofollow\">http://ideone.com/uWvPpX</a>  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n\n    foo(\"%x\");\n    return 0;\n}\n\nvoid foo(char *str)\n{\n\n    char c='c';\n    printf(str);\n\n    printf(\"\\n%x\",&amp;c);\n}\n</code></pre>\n"}, {"tags": ["c", "file", "exit", "manpage"], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 6, "last_activity_date": 1439406092, "last_edit_date": 1439406092, "creation_date": 1439404818, "answer_id": 31972979, "question_id": 31972860, "link": "https://stackoverflow.com/questions/31972860/is-it-good-to-use-exit-instead-of-fcloseall-for-closing-multiple-files/31972979#31972979", "title": "Is it good to use exit() instead of fcloseall() for closing multiple files?", "body": "<p>The <code>fcloseall</code> function is a GNU extension. Using it makes your program less portable.</p>\n\n<p>The <code>exit</code> function closes and flushes all stdio streams -- but it also terminates your program, which <code>fcloseall</code> doesn't do, so it's hardly a substitute.</p>\n\n<p>There's probably no point in calling <code>fcloseall</code> if the program will continue to execute, and if it's just about to terminate anyway, <code>exit</code> will do the same thing.</p>\n\n<p>The standard streams <code>stdin</code>, <code>stdout</code>, and <code>stderr</code> generally don't need to be closed explicitly. It's perfectly all right to let the system close them for you when the program terminates. If you've opened any other streams, say by calling <code>fopen</code>, you should keep track of each such stream yourself, and close it explicitly when you're finished with it.</p>\n"}, {"tags": [], "owner": {"reputation": 7821, "user_id": 954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed8998ef7c610932db0159960df1a24?s=128&d=identicon&r=PG", "display_name": "Ted Percival", "link": "https://stackoverflow.com/users/954/ted-percival"}, "is_accepted": true, "score": 9, "last_activity_date": 1439405547, "last_edit_date": 1439405547, "creation_date": 1439404851, "answer_id": 31972988, "question_id": 31972860, "link": "https://stackoverflow.com/questions/31972860/is-it-good-to-use-exit-instead-of-fcloseall-for-closing-multiple-files/31972988#31972988", "title": "Is it good to use exit() instead of fcloseall() for closing multiple files?", "body": "<p>Short answer: yes, <code>exit()</code> is better.</p>\n\n<p>Long answer:</p>\n\n<p>It depends how you design your program. It is generally better to have each component clean up after itself, removing any temporary files and flushing buffers - this would be especially common for a C++ program where object destructors can handle this.</p>\n\n<p>In that case you would use neither <code>exit()</code> nor <code>fcloseall()</code> - you'd have your components clean up after themselves then simply <code>return</code> from <code>main()</code>.</p>\n\n<p>For a C program you might prefer to design it expecting that everything will be cleaned up automatically at exit by one of these functions. If you are considering using either, then <code>exit()</code> is a safer bet because it will do more: it will do what <code>fcloseall()</code> does, <em>plus</em> it will remove temporary files created with <code>tmpfile()</code>.</p>\n\n<p>In addition, <code>fcloseall()</code> is a GNU extension which might affect the portability of your program.</p>\n\n<p><strong>Perhaps more importantly</strong>, these functions serve different purposes. </p>\n\n<p>The purpose of <code>exit()</code> is to end your program.</p>\n\n<p>The purpose of <code>fcloseall()</code> is to flush &amp; close file descriptors, but not to end your program. It's perhaps most useful when you want to ensure you have closed all files (including stdin/stdout/stderr) before calling <code>exec</code> to start another process, without leaking any file descriptors into the new process that it will not expect and perhaps never close.</p>\n"}], "owner": {"reputation": 111, "user_id": 4991685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3922aed4087d310825af5ee5b27a83?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Dixit", "link": "https://stackoverflow.com/users/4991685/saurabh-dixit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3960, "favorite_count": 1, "accepted_answer_id": 31972988, "answer_count": 2, "score": 9, "last_activity_date": 1439406092, "creation_date": 1439404409, "last_edit_date": 1439405957, "question_id": 31972860, "link": "https://stackoverflow.com/questions/31972860/is-it-good-to-use-exit-instead-of-fcloseall-for-closing-multiple-files", "title": "Is it good to use exit() instead of fcloseall() for closing multiple files?", "body": "<p>The man page of <code>exit</code> says, </p>\n\n<ol>\n<li>All open <code>stdio</code> streams are flushed and  closed. Files  created  by   <code>tmpfile</code> are removed.</li>\n<li>Parameters of <code>exit</code> i.e <code>EXIT_SUCCESS</code> and <code>EXIT_FAILURE</code> are slightly more portable  (to non-UNIX  environments) than the use of 0 and some nonzero value like 1 or -1.  In particular, VMS uses a different convention. </li>\n</ol>\n\n<p>The man page of <code>fcloseall</code> says,</p>\n\n<ol>\n<li>The standard streams, <code>stdin</code>, <code>stdout</code>, and <code>stderr</code> are also closed.</li>\n<li>The <code>fcloseall</code> function does not  lock  the  streams, so  it  is  not thread-safe.</li>\n</ol>\n\n<p>Many online tutorials say that deallocating \"all\" resources of a given type is a programming error. They should be deallocated individually by the code that owns them or not at all.</p>\n\n<p>So is it good to use <code>exit</code> instead of <code>fcloseall</code>? </p>\n"}, {"tags": ["c++", "c", "xcode", "debugging", "lldb"], "comments": [{"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1439402922, "post_id": 31972345, "comment_id": 51851775, "body": "Are you using lldb from XCode or from the command-line?"}, {"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1439404360, "post_id": 31972345, "comment_id": 51852589, "body": "You should be able to set a breakpoint on the function and step through - it will show you all that."}, {"owner": {"reputation": 17, "user_id": 5146687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0ac507ba5c04bce8050f5f550cae77?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5146687/daniel"}, "reply_to_user": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1439405019, "post_id": 31972345, "comment_id": 51852924, "body": "That works if I have the code of the inspected app. But, what if I&#39;m debugging an app that I don&#39;t have the source code for? (for instance, this is a test app from our teacher, it has symbols exported)."}, {"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1439405921, "post_id": 31972345, "comment_id": 51853439, "body": "It works the same way... In terminal (eg. lldb some.app), then set a breakpoint on the function or offset."}, {"owner": {"reputation": 17, "user_id": 5146687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0ac507ba5c04bce8050f5f550cae77?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5146687/daniel"}, "reply_to_user": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1439407317, "post_id": 31972345, "comment_id": 51854186, "body": "Right. I see 3 groups (Exception State Registers, Floating point registers, general purpose registers). But still, no idea how to get the arguments value. (I updated my question to reflect what I really want). Thanks!"}, {"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1439414480, "post_id": 31972345, "comment_id": 51857898, "body": "Using <code>frame variable</code> should show you the args; sometimes it doesn&#39;t and you need to find the pointer, which you can generally get from register read --all."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5146687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0ac507ba5c04bce8050f5f550cae77?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5146687/daniel"}, "edited": false, "score": 0, "creation_date": 1440183706, "post_id": 31977147, "comment_id": 52184562, "body": "Architecture: 32bits, calling convention: x86"}], "tags": [], "owner": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "is_accepted": true, "score": 1, "last_activity_date": 1439422461, "creation_date": 1439422461, "answer_id": 31977147, "question_id": 31972345, "link": "https://stackoverflow.com/questions/31972345/how-to-print-the-memory-address-and-the-value-of-the-arguments-of-a-c-c-functi/31977147#31977147", "title": "How to print the memory address and the value of the arguments of a C/C++ function that is being debugged with LLDB?", "body": "<p>The disassembly that you posted is x86. The arguments are on the stack. If you break before the function prolog, the arguments are relative to the stack pointer, <code>%esp</code> (which is accessed as <code>$esp</code> in <code>lldb</code>):</p>\n\n<pre><code># The return address:\nx/w $esp\n# The first argument:\nx/w $esp+4\n# The second argument:\nx/w $esp+8\n</code></pre>\n\n<p>If you break after the prolog (<code>0x9a7bfc3c</code> in your example), which is where symbolic breakpoints are usually placed, the arguments are found relative to the frame pointer (<code>%ebp</code> a.k.a. <code>$ebp</code>):</p>\n\n<pre><code># The saved frame pointer of the previous frame:\nx/w $ebp\n# The return address:\nx/w $ebp+4\n# The first argument:\nx/w $ebp+8\n# The second argument:\nx/w $ebp+12\n</code></pre>\n\n<p>For other architectures, the arguments will be stored differently, often in the registers. Also, the above assumes the \"cdecl\" calling convention. There are others. Have you been told which architecture(s) and calling convention(s) you're expected to be familiar with?</p>\n"}], "owner": {"reputation": 17, "user_id": 5146687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0ac507ba5c04bce8050f5f550cae77?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5146687/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 31977147, "answer_count": 1, "score": 1, "last_activity_date": 1439422461, "creation_date": 1439402615, "last_edit_date": 1439414729, "question_id": 31972345, "link": "https://stackoverflow.com/questions/31972345/how-to-print-the-memory-address-and-the-value-of-the-arguments-of-a-c-c-functi", "title": "How to print the memory address and the value of the arguments of a C/C++ function that is being debugged with LLDB?", "body": "<p>I'm getting ready for my OS test. One of the tools we use is the debugger(LLDB) and my goal is to inspect the arguments of a C function or a C++ method.</p>\n\n<p>For instance: How may I see the memory address and the value of the arguments passed to _SMenuItemCommandID?? - I have tried different things, but died in the attempt.</p>\n\n<pre><code>HITestBox`_SMenuItemCommandID(MenuData*, unsigned short, unsigned long):\n0x9a7bfc35:  pushl  %ebp\n0x9a7bfc36:  movl   %esp, %ebp\n0x9a7bfc38:  pushl  %esi\n0x9a7bfc39:  subl   $52, %esp\n0x9a7bfc3c:  movl   8(%ebp), %esi\n0x9a7bfc3f:  movl   88(%esi), %eax\n0x9a7bfc42:  movl   %eax, -16(%ebp)\n0x9a7bfc45:  movzwl 12(%ebp), %ecx\n0x9a7bfc49:  movw   %cx, -12(%ebp)\n0x9a7bfc4d:  movl   $0, -8(%ebp)\n0x9a7bfc54:  leal   -8(%ebp), %edx\n0x9a7bfc57:  movl   %edx, 28(%esp)\n0x9a7bfc5b:  movl   %ecx, 4(%esp)\n0x9a7bfc5f:  movl   %eax, (%esp)\n0x9a7bfc62:  movl   $0, 24(%esp)\n0x9a7bfc6a:  movl   $4, 20(%esp)\n0x9a7bfc72:  movl   $0, 16(%esp)\n0x9a7bfc7a:  movl   $1835232612, 12(%esp)\n0x9a7bfc82:  movl   $12, 8(%esp)\n0x9a7bfc8a:  calll  0x9a5f7c9b                ; elementGetDataAtIndex\n0x9a7bfc8f:  movl   16(%ebp), %eax\n0x9a7bfc92:  cmpl   %eax, -8(%ebp)\n0x9a7bfc95:  je     0x9a7bfcae                ; _SMenuItemCommandID(MenuData*, unsigned short, unsigned long) + 121\n0x9a7bfc97:  movl   %eax, 4(%esp)\n0x9a7bfc9b:  leal   -16(%ebp), %eax\n0x9a7bfc9e:  movl   %eax, (%esp)\n0x9a7bfca1:  calll  0x9a7e2914                ; mID::SetCommandID(unsigned long)\n0x9a7bfca6:  movl   %esi, (%esp)\n0x9a7bfca9:  calll  0x9a5f7c65                ; invalidate(MenuData*)\n0x9a7bfcae:  xorl   %eax, %eax\n0x9a7bfcb0:  addl   $52, %esp\n0x9a7bfcb3:  popl   %esi\n0x9a7bfcb4:  popl   %ebp\n0x9a7bfcb5:  ret    \n</code></pre>\n\n<p>Edit:\nSay I'm debugging an app which I don't have the source code, but I have the symbols exported.\nSay, at some moment this code gets executed:</p>\n\n<pre><code>MenuData *myData = (MenuData *)0x28ff44;;\nSMenuItemCommandID(myData, 3, 4);\n</code></pre>\n\n<p>What do I need to do (with LLDB) to get:  </p>\n\n<pre><code>arg0 = 0x28ff44   \narg1 =3  \narg2 =4  \n</code></pre>\n"}, {"tags": ["c", "string", "pointers", "if-statement", "structure"], "comments": [{"owner": {"reputation": 19923, "user_id": 66519, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/83ea6683f15edb2087f6a3ad4f42605b?s=128&d=identicon&r=PG", "display_name": "ojblass", "link": "https://stackoverflow.com/users/66519/ojblass"}, "edited": false, "score": 1, "creation_date": 1439400775, "post_id": 31971787, "comment_id": 51850576, "body": "Please provide the errors that you are getting compiling or running your code."}, {"owner": {"reputation": 2397, "user_id": 996142, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/22f659c828b9c60e26aa2359387cebfb?s=128&d=identicon&r=PG", "display_name": "user996142", "link": "https://stackoverflow.com/users/996142/user996142"}, "edited": false, "score": 1, "creation_date": 1439400779, "post_id": 31971787, "comment_id": 51850580, "body": "Have you tried to use debugger or some debug printing to find error?"}, {"owner": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 1, "creation_date": 1439401802, "post_id": 31971787, "comment_id": 51851173, "body": "1) fix your code formatting so it can actually be read without turning one&#39;s brain into a pretzel, 2) use <code>strcmp()</code> or something similar to compare NULL-terminated C strings, not <code>==</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1439403026, "post_id": 31971787, "comment_id": 51851828, "body": "I started to edit your code, but I don&#39;t have time. First off, it needs to be formatted as code: highlight the code and click the <code>{}</code> icon (this indents it by 4 columns). Use consistent indentation, and don&#39;t double-space it; blank lines are good for showing overall structure, but you don&#39;t need a blank line after every line of code. <code>void main()</code> should be <code>int main(void)</code>. And you need a tag to specify what language you&#39;re using (I&#39;ll add that)."}, {"owner": {"reputation": 2041, "user_id": 3825483, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/jqg7b.jpg?s=128&g=1", "display_name": "Marcelo Camargo", "link": "https://stackoverflow.com/users/3825483/marcelo-camargo"}, "edited": false, "score": 0, "creation_date": 1439408768, "post_id": 31971787, "comment_id": 51854914, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/8004237/how-do-i-properly-compare-strings-in-c\">How do I properly compare strings in C?</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1439490157, "post_id": 31971787, "comment_id": 51895435, "body": "<code>l</code> is a poor name for a variable; it looks too much like the digit <code>1</code>."}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 0, "last_activity_date": 1439408602, "creation_date": 1439408602, "answer_id": 31974037, "question_id": 31971787, "link": "https://stackoverflow.com/questions/31971787/semantic-error-in-structures/31974037#31974037", "title": "Semantic error in structures", "body": "<p>This is not the proper way to compare strings:</p>\n\n<pre><code>if ((name + l)-&gt;name.lname == llastname)\n</code></pre>\n\n<p>Use <a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow\">strcmp</a> instead</p>\n"}], "owner": {"reputation": 61, "user_id": 5188486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/52cb6ac1c775c3ae568aa29cec168945?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran C K", "link": "https://stackoverflow.com/users/5188486/kiran-c-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 31974037, "answer_count": 1, "score": -1, "last_activity_date": 1439408602, "creation_date": 1439400608, "last_edit_date": 1439408529, "question_id": 31971787, "link": "https://stackoverflow.com/questions/31971787/semantic-error-in-structures", "title": "Semantic error in structures", "body": "<p>The purpose of the code is to store library card information and search for books using author's last name. When I search using author's name, it says \"no books by this author last name found\". Below is my code. What am I doing wrong here?</p>\n\n<pre><code>//Program to store Library card Information and search for record using last name\n#include&lt;stdio.h&gt;\n\nvoid search(struct lib_card *name)\n\nstruct author\n{\n    char fname[20];\n    char lname[20];\n};\n\nstruct pub_date\n{\n    int day;\n    int month;\n    int year;\n};\n\nstruct lib_card //Structure declaration for storing Library card information\n{\n    char title[80];\n    struct author name;\n    struct pub_date date;\n};\n\nvoid main()\n{\n    struct lib_card card[2];\n    int l; //l is a variable assigned for loop\n    for (l = 0; l &lt; 2; l++)\n    {\n        printf(\"********Enter Library Card Information********\\n\");\n        printf(\"Card # %d\\n\", l + 1);\n        printf(\"Enter Book Title:             \");\n        scanf(\"\\n%[^\\n]s\", card[l].title);\n\n        printf(\"Enter Author's First name:  \");\n        scanf(\"\\n%s\", card[l].name.fname);\n\n        printf(\"Enter Author's Last name:   \");\n        scanf(\"\\n%[^\\n]s\", card[l].name.lname);\n\n        printf(\"\\nEnter Published date:\\n\");\n        printf(\"\\t\\tdate(dd):\");\n        scanf(\"\\n%d\", &amp;card[l].date.day);\n\n        printf(\"\\t\\tMonth(mm):\");\n        scanf(\"\\n%d\", &amp;card[l].date.month);\n\n        printf(\"\\t\\t\\Year(yy):\");\n        scanf(\"\\n%d\", &amp;card[l].date.year);\n    }\n\n    search(card); //Structure's address is passed to search function\n}\n\nvoid search(struct lib_card *name)\n{\n    char llastname[20];\n    int l;\n\n    printf(\"\\nEnter Author's Last name to search for books:\");\n    scanf(\"\\n%[^\\n]s\", llastname); //Get author's last name to search the books\n\n    for (l = 0; l &lt; 2; l++)\n    {\n        printf(\"%s\\n\", (name + l)-&gt;name.lname);\n        if ((name + l)-&gt;name.lname == llastname)\n        {\n            printf(\"%s\\n\", (name + l)-&gt;title);\n        }\n        else if (l == 1)\n        {\n            printf(\"\\nNo books by this Author's Last name found\");\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "unix", "memory-management"], "comments": [{"owner": {"reputation": 2470, "user_id": 385891, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mf9jm.png?s=128&g=1", "display_name": "raylu", "link": "https://stackoverflow.com/users/385891/raylu"}, "edited": false, "score": 0, "creation_date": 1439591189, "post_id": 31971573, "comment_id": 51941443, "body": "&quot;even if a very big array is defined, it will get actual memory only when needed&quot;  What makes you think that?"}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "reply_to_user": {"reputation": 2470, "user_id": 385891, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mf9jm.png?s=128&g=1", "display_name": "raylu", "link": "https://stackoverflow.com/users/385891/raylu"}, "edited": false, "score": 0, "creation_date": 1439612471, "post_id": 31971573, "comment_id": 51945083, "body": "do you mean that char buf[2048] will be assigned all physical memory at moment of declaration? according to my understanding the assigned memory will be proportional to the number of elements actually used/accessed. when i actually touch the elements of array it will be assigned memory though paging. Am I right?"}, {"owner": {"reputation": 2470, "user_id": 385891, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mf9jm.png?s=128&g=1", "display_name": "raylu", "link": "https://stackoverflow.com/users/385891/raylu"}, "edited": false, "score": 0, "creation_date": 1439614321, "post_id": 31971573, "comment_id": 51945328, "body": "In user mode, <code>char buf[2048]</code> (can) &quot;allocate&quot; 2K on the stack. If you cross a page boundary halfway through, the kernel handles a page fault and maps in the next page of the buf. In kernel mode, this (probably) doesn&#39;t apply."}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "reply_to_user": {"reputation": 2470, "user_id": 385891, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mf9jm.png?s=128&g=1", "display_name": "raylu", "link": "https://stackoverflow.com/users/385891/raylu"}, "edited": false, "score": 0, "creation_date": 1439650071, "post_id": 31971573, "comment_id": 51953358, "body": "please check the link in my answer"}], "answers": [{"tags": [], "owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "is_accepted": false, "score": 0, "last_activity_date": 1439584620, "creation_date": 1439584620, "answer_id": 32018283, "question_id": 31971573, "link": "https://stackoverflow.com/questions/31971573/preference-of-kmalloc-over-array-in-kernel-space-of-a-process/32018283#32018283", "title": "preference of kmalloc over array in kernel space of a process", "body": "<p>I come across this link <a href=\"http://blog.csdn.net/macyang/article/details/5807008\" rel=\"nofollow\">http://blog.csdn.net/macyang/article/details/5807008</a> which explains clearly with simple example the reason for not using arrays in kernel space. the main reason is that in kernel space stack is fixed size (usually two pages) instead of dynamically grow stack. the arrays are stored on stack and very large arrays can not have enough space on stack.</p>\n\n<p>But at the same time this explanation also arise many concerns. if using kamlloc is not efficient as compared to using array (my contention asked) but we are still forced to use it due to fixed size stack, it means fixed size stacks are necessary. The reason for small fixed size stack is limited memory available and fear of stack overflow which in kernel space can be disastrous. So we can not use dynamically grow stacks so we also can not use large arrays to be saved on stack.</p>\n"}], "owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1439584620, "creation_date": 1439399828, "last_edit_date": 1439584520, "question_id": 31971573, "link": "https://stackoverflow.com/questions/31971573/preference-of-kmalloc-over-array-in-kernel-space-of-a-process", "title": "preference of kmalloc over array in kernel space of a process", "body": "<p>I was reading some material on memory allocation in kernel space of a process. even though i know that kernel has some small/limited amount of memory(usually 1GB) but why dynamic allocation of memory through kmalloc()is preferred/recommended on defining large arrays?\nIn other words it is not preferred to allocate large array in kernel space but instead use of dynamically allocated memory is recommended.</p>\n\n<p>My point of contention is that even if a very big array is defined, it will get actual memory only when needed so it will put less pressure on memory. whereas Kmalloc() will assign all demanded memory. 2nd problem is that as kmalloc assign physical memory, finding/preparing demanded size will put extra pressure on system.</p>\n\n<p>But if i read this preference in many sources then there will be some justified reason far away from my reasoning. Can anybody throw light on merits and demerits(if any) for using array and kmalloc() in kernel space</p>\n"}, {"tags": ["c", "pointers", "casting"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1439399697, "post_id": 31971502, "comment_id": 51849977, "body": "By casting like that you&#39;re breaking <a href=\"http://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">the strict aliasing rule</a>. And using the pointer to <code>int</code> you will end up with undefined behavior, floating point values and integer values have different encodings in memory. To answer your question: The expression <code>*int_pointer += 30</code> does bad things, and may even cause <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">nasal demons</a>"}, {"owner": {"reputation": 11, "user_id": 5220361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbef92f1db998f6d1c6ab80105822e1?s=128&d=identicon&r=PG", "display_name": "user5220361", "link": "https://stackoverflow.com/users/5220361/user5220361"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1439399897, "post_id": 31971502, "comment_id": 51850103, "body": "Many thanks. Will look into that strict aliasing rule"}], "answers": [{"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1439407525, "post_id": 31971659, "comment_id": 51854296, "body": "Every possible pattern of bits is a valid int, so the += 30 will not fail. It will just scramble the bits of the float, possibly into an invalid representation, but probably not--the low-order bits of a float are all mantissa, so changing them will probably generate a perfectly valid float. It just won&#39;t bear much relationship to the &quot;30&quot; you ostensibly added."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1439400142, "last_edit_date": 1495540281, "creation_date": 1439400142, "answer_id": 31971659, "question_id": 31971502, "link": "https://stackoverflow.com/questions/31971502/pointer-casting-in-c-what-does-the-code-mean/31971659#31971659", "title": "Pointer casting in C what does the code mean", "body": "<p>I see two questions there.</p>\n\n<ol>\n<li><p>What happens when you use</p>\n\n<pre><code>int* int_pointer = (int*) number_pointer;\n</code></pre>\n\n<p>That line takes the address of an object that holds a <code>float</code> and stores that address in <code>int_pointer</code>. At this point, the compiler will be able to treat the address as though it holds an integer. That constitutes a violation of the <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing rule</a>.</p></li>\n<li><p>What happens when you use</p>\n\n<pre><code>*int_pointer += 30;\n</code></pre>\n\n<p>It increments the value of the object that <code>int_pointer</code> points to by <code>30</code>. In cases where <code>int_pointer</code> points to a valid <code>int</code> object, that operation will be fine. In your case, this will cause undefined behavior since <code>int_pointer</code> really points to an object of type <code>float</code>.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3945745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c74b2603a8fb916b1fcbeacfb7b3418b?s=128&d=identicon&r=PG&f=1", "display_name": "Jesvin George", "link": "https://stackoverflow.com/users/3945745/jesvin-george"}, "is_accepted": false, "score": 0, "last_activity_date": 1439411072, "creation_date": 1439411072, "answer_id": 31974718, "question_id": 31971502, "link": "https://stackoverflow.com/questions/31971502/pointer-casting-in-c-what-does-the-code-mean/31974718#31974718", "title": "Pointer casting in C what does the code mean", "body": "<p>Let me explain each statement:</p>\n\n<pre><code>float number = 1.0;\n</code></pre>\n\n<p>Here you have declared and initialized a float variable called <code>number</code>.</p>\n\n<pre><code>float* number_pointer = &amp;number;\n</code></pre>\n\n<p>Declared and initialized float type pointer <code>number_pointer</code> to <code>number</code>. This means <code>number_pointer</code> holds the address of the variable <code>number</code> and <code>*number_pointer</code> gives the value of the variable <code>number</code>, i.e., <code>1.0</code>.</p>\n\n<pre><code>int* int_pointer = (int*) number_pointer;\n</code></pre>\n\n<p>Type-casted float pointer <code>number_pointer</code> to integer pointer and initialized to <code>int_pointer</code>. After this explicit type-casting, the value of <code>*int_pointer</code> is not  <code>1.0</code> but its corresponding integer <code>1065353216</code>.</p>\n\n<pre><code>*int_pointer += 30;\n</code></pre>\n\n<p>This is a short hand for <code>*int_pointer = *int_pointer + 30;</code>. <code>*int_pointer</code> becomes <code>1065353246</code>.</p>\n\n<pre><code>printf(\"%f \\n\",number);\n</code></pre>\n\n<p>Prints the value of <code>number</code>, which is now <code>1.000004</code> and not the initial <code>1.000000</code>. The change is caused by the addition performed on <code>int_pointer</code> which points to where <code>number_pointer</code> is pointing which in turn is the variable <code>number</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 5220361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbef92f1db998f6d1c6ab80105822e1?s=128&d=identicon&r=PG", "display_name": "user5220361", "link": "https://stackoverflow.com/users/5220361/user5220361"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 31971659, "answer_count": 2, "score": -1, "last_activity_date": 1439411072, "creation_date": 1439399550, "last_edit_date": 1439401474, "question_id": 31971502, "link": "https://stackoverflow.com/questions/31971502/pointer-casting-in-c-what-does-the-code-mean", "title": "Pointer casting in C what does the code mean", "body": "<pre><code>float number = 1.0;\nfloat* number_pointer = &amp;number;\nint* int_pointer = (int*) number_pointer;                  \n*int_pointer += 30;\nprintf(\"%f \\n\",number);\n</code></pre>\n\n<p>What does the line <code>(*int_pointer)+= 30;</code> do here?</p>\n"}, {"tags": ["c++", "c", "loops", "compiler-warnings", "loop-unrolling"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439398365, "post_id": 31971130, "comment_id": 51849261, "body": "Is there any side effects of <code>func</code>?"}, {"owner": {"reputation": 29, "user_id": 4954497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nAhIEUBNXkI/AAAAAAAAAAI/AAAAAAAAAKM/VVmGum5T3pQ/photo.jpg?sz=128", "display_name": "Sunwoo Lee", "link": "https://stackoverflow.com/users/4954497/sunwoo-lee"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439398917, "post_id": 31971130, "comment_id": 51849548, "body": "In side of the func is a very simple loop. Just a for loop with 1024 iteration again. What kinds of side effect would be possible?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439398960, "post_id": 31971130, "comment_id": 51849575, "body": "Please add it to the question body"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1439398981, "post_id": 31971130, "comment_id": 51849589, "body": "please post a minimum compilable example...."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1439399047, "post_id": 31971130, "comment_id": 51849615, "body": "the problem is centered on using the &#39;i&#39; index variable in a unrolled loop.  because the &#39;i&#39; variable is not being properly incremented when the loop is unrolled.   suggest: int pointer = values;  for(i=0; i&lt;num; i++){     *pointer = func(a, b, c); pointer++; }"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439399365, "post_id": 31971130, "comment_id": 51849779, "body": "Right. The <code>i</code> in the <code>func</code> is undeclared, so I presume it is the same <code>i</code> as outside (global). So the loops won&#39;t work as intended, and it is not the optimization problem."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439401919, "post_id": 31971130, "comment_id": 51851235, "body": "I suspect the code you have posted is not representative of your problem. Are <code>a</code>,<code>b</code> and <code>c</code> constant during the loop?"}, {"owner": {"reputation": 29, "user_id": 4954497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nAhIEUBNXkI/AAAAAAAAAAI/AAAAAAAAAKM/VVmGum5T3pQ/photo.jpg?sz=128", "display_name": "Sunwoo Lee", "link": "https://stackoverflow.com/users/4954497/sunwoo-lee"}, "edited": false, "score": 0, "creation_date": 1439409807, "post_id": 31971130, "comment_id": 51855465, "body": "I modified the code to include all the local variables. It was just a simple mistake, sorry about that."}, {"owner": {"reputation": 29, "user_id": 4954497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nAhIEUBNXkI/AAAAAAAAAAI/AAAAAAAAAKM/VVmGum5T3pQ/photo.jpg?sz=128", "display_name": "Sunwoo Lee", "link": "https://stackoverflow.com/users/4954497/sunwoo-lee"}, "edited": false, "score": 0, "creation_date": 1439410786, "post_id": 31971130, "comment_id": 51855903, "body": "And also, replacing dists[i] with *dists and dists++ makes same slow result."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439474643, "post_id": 31971130, "comment_id": 51885255, "body": "when asking a runtime question, always post code that cleanly compiles, is small, and displays the problem being ask about."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439474758, "post_id": 31971130, "comment_id": 51885327, "body": "how are you compiling the code, such that you know the loops are being unrolled?"}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439474415, "post_id": 31990244, "comment_id": 51885083, "body": "note: this line: &#39;total = a<i>b+c;&#39;  does not accumulate the calculated value, so no worries about math overflow.   things would be more &#39;interesting&#39; if the line were: &#39;total += a</i>b+c;&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439474551, "post_id": 31990244, "comment_id": 51885185, "body": "in the func() function, a good compiler can optimize the loop out of existence and/or move the constant expression total = a*b+c; to outside the loop."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1439474138, "creation_date": 1439474138, "answer_id": 31990244, "question_id": 31971130, "link": "https://stackoverflow.com/questions/31971130/effect-of-unroll-and-jam-on-a-large-loop/31990244#31990244", "title": "Effect of Unroll and Jam on a large loop", "body": "<p>I created a version of your code that actually compiles:</p>\n\n<p>overflow in the math may have occurred, but I did not check for that</p>\n\n<p>then ran it.</p>\n\n<p>It ran in the 'blink of an eye'</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define num (1024)\n\nint values[num];\nint value;\nint a=2;\nint b=3;\nint c=4;\n\nint func(int a, int b, int c)\n{\n    int i=0;\n    int total=0;\n    for(i=0; i&lt;num; i++){\n        total = a*b+c;\n    }\n    return total;\n}\n\nint main(void){\n    int i=0;\n    //int min=0;\n    for(i=0; i&lt;num; i++){\n        values[i] = func(a, b, c);\n    }\n\n    for(i=0; i&lt;num; i++){\n        value = values[i];\n    }\n    printf(\"value: %d\\n\", value);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4954497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nAhIEUBNXkI/AAAAAAAAAAI/AAAAAAAAAKM/VVmGum5T3pQ/photo.jpg?sz=128", "display_name": "Sunwoo Lee", "link": "https://stackoverflow.com/users/4954497/sunwoo-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1093, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439474138, "creation_date": 1439398244, "last_edit_date": 1439410476, "question_id": 31971130, "link": "https://stackoverflow.com/questions/31971130/effect-of-unroll-and-jam-on-a-large-loop", "title": "Effect of Unroll and Jam on a large loop", "body": "<p>When I compiled my application, the performance was worse than I expected and I figured out the compiler was reporting a warning like the below.</p>\n\n<p>remark #25461: Imperfect Loop Unroll-Jammed by 2 (pre-vector)</p>\n\n<p>And this is my short code.</p>\n\n<pre><code>for(i=0; i&lt;num; i++){\n    values[i] = func(a, b, c);\n}\n</code></pre>\n\n<p>The index variable, num is alwasy 1024. Why is the loop unroll-jammmed imperfectly? Also, When I modify the code like the below, unroll-jamming doesn't occur! What is the condition of occuring unroll-jamming?</p>\n\n<pre><code>for(i=0; i&lt;num; i++){\n    value += func(a, b, c);\n}\n</code></pre>\n\n<p>Actually, the code is a part of large file, so I can't write the entire code here. But the below is the code including func().</p>\n\n<pre><code>int values[num];\n\nint func(int a, int b, int c)\n{\n    int i=0;\n    int total=0;\n    for(i=0; i&lt;num; i++){\n        total = a*b+c;\n    }\n    return total;\n}\n\nint main(void){\n    int i=0;\n    int min=0;\n    for(i=0; i&lt;num; i++){\n        values[i] = func(a, b, c);\n    }\n\n    for(i=0; i&lt;num; i++){\n        value = values[i];\n    }\n    printf(\"value: %d\\n\", value);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "vigenere", "cs50"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1439396661, "post_id": 31970588, "comment_id": 51848269, "body": "And what does <code>gdb</code> say?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1439396710, "post_id": 31970588, "comment_id": 51848293, "body": "<code>s= argv[1];</code> what if I ran the binary like <code>.&#47;a.out</code>? then, <code>isalpha(s[i]</code>...."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1439396767, "post_id": 31970588, "comment_id": 51848317, "body": "first change <code>for (i = 0; n = strlen(s), i &lt; n ; i++)</code> to <code>for (i = 0, n = strlen(s); i &lt; n ; i++)</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1439396850, "post_id": 31970588, "comment_id": 51848359, "body": "@EugeneSh. or, just an option, move <code>n = strlen(s);</code> out of <code>for</code> loop statement altogether."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439396891, "post_id": 31970588, "comment_id": 51848382, "body": "Actually it happens twice."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439396946, "post_id": 31970588, "comment_id": 51848413, "body": "Then the only cause of segfault I can see is the <code>argv</code> thing. Or something with the hidden <code>string</code> api."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439397017, "post_id": 31970588, "comment_id": 51848455, "body": "Oh no, wait. <code>vige</code> is NULL, but you are happily indexing it with <code>i</code>."}, {"owner": {"reputation": 1, "user_id": 5220099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2296bb0d66729a0ca5857b72a2b480ca?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya Roy", "link": "https://stackoverflow.com/users/5220099/kaya-roy"}, "edited": false, "score": 0, "creation_date": 1439397542, "post_id": 31970588, "comment_id": 51848771, "body": "If I remove the NULL, I get an error saying: Variable vige is uninitialized. Initialize the variable &#39;vige&#39; to silence this warning     string vige;                ^                 = NULL"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439397629, "post_id": 31970588, "comment_id": 51848811, "body": "You need to initialize it to a some preallocated space of sufficient size. As the implementation of <code>string</code> is hidden from us, I can&#39;t tell how."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439397658, "post_id": 31970588, "comment_id": 51848831, "body": "The code has a problem that needs to be addressed before going further into debug operations.  there are two valid and one optional ways to declare the main function:  1) int main( int argc, char *argv[] )  2) int main( void )  and optionally 3) int main().  Note: &#39;char *argv[]&#39; and &#39;char **argv&#39; are the same thing."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439398080, "post_id": 31970588, "comment_id": 51849088, "body": "Always compile with all warnings enabled.  (for gcc, at a minimum use: &#39;-Wall -Wextra -pedantic&#39;)  Then, after fixing the main() declaration, a long-long sequence of problems will be listed by the compiler.  suggest, for portability, replacing all &#39;string&#39; type declarations with &#39;char *&#39; type declarations and replacing the &#39;GetString()&#39; function with &#39;readline()&#39;."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439398535, "post_id": 31970588, "comment_id": 51849358, "body": "given the posted code, if the input string is 30 characters or longer, then a large portion of the characters being output by the printf() statements will be unprintable and can seriously mess with the operation of the terminal you use when running the program."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439398689, "post_id": 31970588, "comment_id": 51849426, "body": "along with the several compile time problems, if the code is run, with out fixing those problems, then assignments are being made to the char pointer &#39;vige&#39;.  However, vige contains NULL (pointer to address 0) so any accessing off that pointer will result in undefined behaviour, leading to a seg fault event.  Suggest calling malloc() to allocate memory for the copied/modified input string"}], "answers": [{"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 1, "last_activity_date": 1439397341, "creation_date": 1439397341, "answer_id": 31970879, "question_id": 31970588, "link": "https://stackoverflow.com/questions/31970588/cs50-pset-2-vigenere-cipher-segmentation-fault/31970879#31970879", "title": "CS50 PSet 2: Vigenere cipher Segmentation Fault", "body": "<p><code>vige</code> is initialized to <code>NULL</code>, but later on it is dereferenced using the index notation <code>vige[i]</code>, which is an attempt to access the memory the code doesn't own, causing memory violation and thus undefined behavior.</p>\n"}], "owner": {"reputation": 1, "user_id": 5220099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2296bb0d66729a0ca5857b72a2b480ca?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya Roy", "link": "https://stackoverflow.com/users/5220099/kaya-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1469854190, "creation_date": 1439396443, "last_edit_date": 1469854190, "question_id": 31970588, "link": "https://stackoverflow.com/questions/31970588/cs50-pset-2-vigenere-cipher-segmentation-fault", "title": "CS50 PSet 2: Vigenere cipher Segmentation Fault", "body": "<p>I an new to the subject. I tried to debug this myself, but <strong>Segmentation Fault Core dumped</strong>, comes up and I cannot figure out why. Can someone help me please?</p>\n\n<pre><code># include&lt;cs50.h&gt;\n# include&lt;stdio.h&gt;\n# include&lt;ctype.h&gt;\n# include&lt;string.h&gt;\n\nint main(int argc, string argv[])\n\n{\n    int i, n, no;\n    string s;\n    string vige = NULL;\n    string msg;\n    s= argv[1];\n    for (i = 0; n = strlen(s), i &lt; n ; i++)\n    {  \n        if (argc != 2 || (!isalpha(s[i]) ))\n        {\n            printf(\"Error \\n\");\n            return 1;\n        }\n\n    }   \n\n           printf(\"Secret message: \");\n            msg = GetString();\n\n    for(i = 0; i &lt; strlen(s) ; i++)\n    {\n        if(isupper(s[i]))\n        {\n            vige[i] = s[i] - 65;\n        }\n        else if(islower(s[i]))            {\n            vige[i] = s[i] - 97;  \n        }\n    }\n    for(i = 0; no = strlen(msg), i &lt; no; i++)\n    {\n        if(isalpha(msg[i]))\n        {\n            if(islower(msg[i]))\n            {  \n               printf(\"%c\", (msg[i] + (vige[i] % n)) + 97) ;\n            }\n            else if(isupper(msg[i]))\n            {\n                printf(\"%c\", (msg[i] + (vige[i] % n)) + 65) ;\n            }\n            else\n            {\n                printf(\"%c\", msg[i]);\n            }\n            return 0;\n        }    \n    }\n}\n</code></pre>\n\n<p>In case there are other errors, I will figure them out myself, but the Segmentation fault is beyond my understanding.</p>\n"}, {"tags": ["c", "ncurses"], "answers": [{"tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 2, "last_activity_date": 1439394750, "creation_date": 1439394750, "answer_id": 31970077, "question_id": 31969893, "link": "https://stackoverflow.com/questions/31969893/color-at-specific-point-ncurses/31970077#31970077", "title": "Color at specific point - ncurses", "body": "<p>Have a look at <a href=\"http://linux.die.net/man/3/mvchgat\" rel=\"nofollow\"><code>mvchgat()</code></a> for changing the color (and other attributes) of an already-existing character.<br>\nYou can also use <a href=\"http://linux.die.net/man/3/mvaddch\" rel=\"nofollow\"><code>mvaddch</code></a><code>(10, 10, ' ' | COLOR_PAIR(1))</code> to move the cursor and output a space character with a custom color (or other attributes).</p>\n"}], "owner": {"reputation": 35, "user_id": 5219776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec0e42932c4a848b8071bbd442fdf61e?s=128&d=identicon&r=PG&f=1", "display_name": "JhW", "link": "https://stackoverflow.com/users/5219776/jhw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 31970077, "answer_count": 1, "score": 1, "last_activity_date": 1439394750, "creation_date": 1439394270, "question_id": 31969893, "link": "https://stackoverflow.com/questions/31969893/color-at-specific-point-ncurses", "title": "Color at specific point - ncurses", "body": "<p>I'm trying to color at a specific point of the screen using ncurses lib.<br>\nI have written this code:<br>\n</p>\n\n<pre><code>#include&lt;curses.h&gt;\n\nint main(void)\n{\n    initscr();\n    start_color();\n    init_pair(1, COLOR_BLACK, COLOR_RED);\n    attron(COLOR_PAIR(1));\n    move(10, 10);\n    printw(\" \\n\");\n    refresh();\n    getch();\n    endwin();\n\n    return 0;\n}\n</code></pre>\n\n<p>There is a better way to do this? Or this is the only way?</p>\n"}, {"tags": ["c", "winapi", "visual-studio-2013"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 4, "creation_date": 1439394318, "post_id": 31969866, "comment_id": 51846770, "body": "If you want to restrict the user to the items in the list, use the drop down list style, <code>CBS_DROPDOWNLIST</code>"}, {"owner": {"reputation": 235, "user_id": 4708080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff6d19ddbac87e1ae02e1ca24ab5320?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/4708080/heather"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1439394614, "post_id": 31969866, "comment_id": 51846996, "body": "Thank you David, thats what I was looking for"}], "owner": {"reputation": 235, "user_id": 4708080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff6d19ddbac87e1ae02e1ca24ab5320?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/4708080/heather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439394714, "creation_date": 1439394209, "last_edit_date": 1439394714, "question_id": 31969866, "link": "https://stackoverflow.com/questions/31969866/how-to-make-combobox-read-only-or-at-least-recognize-when-a-typed-value-is-in-t", "title": "How to make combobox read-only, or at least recognize when a typed value is in the combobox list", "body": "<p>I made a dialog box (handle is hConfigDialog) in the Resource View, that has a combobox (IDC_COMBO1). The combobox has a defined set of values, lets say 1, 2, 3.</p>\n\n<p>I understand if I type in 4 into the combobox, and use the following code</p>\n\n<pre><code>int index = SendDlgItemMessage(hConfigDialog, IDC_COMBO1, \n                               CB_GETCURSEL, (WPARAM)0, (LPARAM)0);\n</code></pre>\n\n<p>index will be -1, since 4 is not in the defined list.</p>\n\n<p>But instead, if I type in 3, I still get index -1. However, if I click 3 from the drop down box, I will get index 3.</p>\n\n<p>I have been looking at the properties listed for the combobox, and it seems like there is no option to set it to read only. Is this true? Is there at least a way to get it to recognize that the typed in 3 is actually a value in the drop down box, so I will get index 3?</p>\n\n<p>Maybe instead of getting the index, I should just read the value in the combobox, so I will know the value regardless of the index it thinks its at...but I just wanted to confirm there is no way to get around this index issue.</p>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 7, "creation_date": 1439394147, "post_id": 31969802, "comment_id": 51846649, "body": "Craaaaaank up the warnings. <code>-Wall -Wextra</code> on GCC and Clang."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1439394175, "post_id": 31969802, "comment_id": 51846669, "body": "You have a memory leak: You allocate memory for the point, then in <code>read_circle</code> you <i>copy</i> the <code>point</code> structure but never free the memory you allocated for it."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439394246, "post_id": 31969802, "comment_id": 51846723, "body": "a memory leak after <code>point* p = read_point();</code>."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5220003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17cb601ae65a9c49a955bd0720f851e1?s=128&d=identicon&r=PG&f=1", "display_name": "Agnaroc ", "link": "https://stackoverflow.com/users/5220003/agnaroc"}, "edited": false, "score": 2, "creation_date": 1439394235, "post_id": 31969838, "comment_id": 51846713, "body": "Thank you, this was indeed the problem. 2 hours of work for a simple exercise from school and I miss something like that."}], "tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": true, "score": 4, "last_activity_date": 1439394099, "creation_date": 1439394099, "answer_id": 31969838, "question_id": 31969802, "link": "https://stackoverflow.com/questions/31969802/dereferencing-an-array-of-struct-pointers/31969838#31969838", "title": "Dereferencing an array of struct pointers", "body": "<p><code>read_circle</code> isn't returning <code>c</code> (or anything, for that matter).</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 5220003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17cb601ae65a9c49a955bd0720f851e1?s=128&d=identicon&r=PG&f=1", "display_name": "Agnaroc ", "link": "https://stackoverflow.com/users/5220003/agnaroc"}, "edited": false, "score": 0, "creation_date": 1439394570, "post_id": 31969879, "comment_id": 51846963, "body": "If I cast using (point*) and (circle*) respectively, is my solution then correct ? (I know I have to free after I use point and circle)"}, {"owner": {"reputation": 185, "user_id": 5210083, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/459344cbcdfe2b871a369699c7f6a2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mikrosaft", "link": "https://stackoverflow.com/users/5210083/mikrosaft"}, "reply_to_user": {"reputation": 45, "user_id": 5220003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17cb601ae65a9c49a955bd0720f851e1?s=128&d=identicon&r=PG&f=1", "display_name": "Agnaroc ", "link": "https://stackoverflow.com/users/5220003/agnaroc"}, "edited": false, "score": 1, "creation_date": 1439395405, "post_id": 31969879, "comment_id": 51847522, "body": "@Agnaroc <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Don&#39;t cast the return value of malloc()</a>  What I ment is to check if malloc() failed (i.e. returned NULL)"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1439396416, "post_id": 31969879, "comment_id": 51848120, "body": "@Mikrosaft: Good advice, but wouldn&#39;t solve the current problem."}, {"owner": {"reputation": 185, "user_id": 5210083, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/459344cbcdfe2b871a369699c7f6a2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mikrosaft", "link": "https://stackoverflow.com/users/5210083/mikrosaft"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1439397288, "post_id": 31969879, "comment_id": 51848624, "body": "@ScottHunter True, but since you already answered it, I didn&#39;t feel like I needed to write it again. (It would have made more sense if I commented on his question, but I still can&#39;t due to low reputation)"}, {"owner": {"reputation": 45, "user_id": 5220003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17cb601ae65a9c49a955bd0720f851e1?s=128&d=identicon&r=PG&f=1", "display_name": "Agnaroc ", "link": "https://stackoverflow.com/users/5220003/agnaroc"}, "edited": false, "score": 0, "creation_date": 1439398178, "post_id": 31969879, "comment_id": 51849159, "body": "@Mikrosaft in the school examples malloc is always casted. Why shouldn&#39;t it be done here ?"}, {"owner": {"reputation": 185, "user_id": 5210083, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/459344cbcdfe2b871a369699c7f6a2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mikrosaft", "link": "https://stackoverflow.com/users/5210083/mikrosaft"}, "reply_to_user": {"reputation": 45, "user_id": 5220003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17cb601ae65a9c49a955bd0720f851e1?s=128&d=identicon&r=PG&f=1", "display_name": "Agnaroc ", "link": "https://stackoverflow.com/users/5220003/agnaroc"}, "edited": false, "score": 0, "creation_date": 1439399287, "post_id": 31969879, "comment_id": 51849730, "body": "@Agnaroc Read the link I sent, it gives a few reasons why not to cast. The only reason I can think of to cast malloc(), is to add compilability between C and C++ (in C++ the cast is mandatory), but since you&#39;re writing in C, and since in C++ <a href=\"http://stackoverflow.com/questions/184537/in-what-cases-do-i-use-malloc-vs-new\">you shouldn&#39;t use malloc()</a>, I see no reason to cast."}], "tags": [], "owner": {"reputation": 185, "user_id": 5210083, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/459344cbcdfe2b871a369699c7f6a2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Mikrosaft", "link": "https://stackoverflow.com/users/5210083/mikrosaft"}, "is_accepted": false, "score": 0, "last_activity_date": 1439394239, "creation_date": 1439394239, "answer_id": 31969879, "question_id": 31969802, "link": "https://stackoverflow.com/questions/31969802/dereferencing-an-array-of-struct-pointers/31969879#31969879", "title": "Dereferencing an array of struct pointers", "body": "<p>You might also want to check the return value of malloc().</p>\n"}], "owner": {"reputation": 45, "user_id": 5220003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17cb601ae65a9c49a955bd0720f851e1?s=128&d=identicon&r=PG&f=1", "display_name": "Agnaroc ", "link": "https://stackoverflow.com/users/5220003/agnaroc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 31969838, "answer_count": 2, "score": 0, "last_activity_date": 1439395634, "creation_date": 1439393970, "last_edit_date": 1439395634, "question_id": 31969802, "link": "https://stackoverflow.com/questions/31969802/dereferencing-an-array-of-struct-pointers", "title": "Dereferencing an array of struct pointers", "body": "<p>I have declared 2 structs: <code>point</code> (which holds 2 doubles) and <code>circle</code> (which holds a point and the radius of the circle, a double).</p>\n\n<pre><code>typedef struct {\n    double x;\n    double y;   \n} point;\n\ntypedef struct {\n    point m;\n    double r;\n} circle;\n</code></pre>\n\n<p>To create a circle I use these 2 functions:</p>\n\n<pre><code>point* read_point() {\n    point* p = malloc (sizeof(point));\n    printf(\"\\nx middle:\");\n    scanf(\"%lf\",&amp;p-&gt;x);\n    printf(\"\\ny middle:\");\n    scanf(\"%lf\",&amp;p-&gt;y);\n    return p;\n}\n\ncircle* read_circle() {\n    circle* c = malloc(sizeof(circle));\n    point* p = read_point();\n    printf(\"\\nradius circle:\");\n    scanf(\"%lf\",&amp;c-&gt;r);\n    c-&gt;m = *p;\n}\n</code></pre>\n\n<p>In my <code>main</code> I declare an array of circle pointers, add one circle and then try to print out the center point and the radius. (At this point my program crashes.)</p>\n\n<pre><code>circle* array[3];\narray[0] = read_circle();\nprint_circle(array[0]); //Crashes\n</code></pre>\n\n<p>This is what the print function looks like:</p>\n\n<pre><code>void print_circle(circle* c){\n    point p = c-&gt;m;\n    printf(\"\\n%lf\",p.x);\n    printf(\"\\n%lf\",p.y);\n    printf(\"\\n%lf\",c-&gt;r);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "module", "embedded-linux", "drivers"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1439394903, "post_id": 31969610, "comment_id": 51847191, "body": "Try using an absolute path. Also, <code>system</code>? Do you really need to run a shell?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439394920, "post_id": 31969610, "comment_id": 51847203, "body": "What is the difference between the drivers you <i>can</i> install and these you <i>cannot</i>? Path? Permissions?"}, {"owner": {"reputation": 1147, "user_id": 5071535, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8bc64d99de802e3fc17bedc722f6dd9e?s=128&d=identicon&r=PG&f=1", "display_name": "user5071535", "link": "https://stackoverflow.com/users/5071535/user5071535"}, "edited": false, "score": 0, "creation_date": 1439396792, "post_id": 31969610, "comment_id": 51848327, "body": "Could it be that your /lib/modules/i2c_core.ko is actually a symlink to a missing file? Check with $ ls -l /lib/modules"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439397410, "post_id": 31969610, "comment_id": 51848680, "body": "Yes I could try an absolute path but I don&#39;t like to hard code paths. Besides it&#39;s a work around. I&#39;d really like to know why some drivers are found and others aren&#39;t."}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439397592, "post_id": 31969610, "comment_id": 51848792, "body": "Permissions are the same. The error says the file is not found...doesn&#39;t say permission problem."}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439397654, "post_id": 31969610, "comment_id": 51848829, "body": "Path 1 (works): kernel/drivers/video/avalanche_glcd"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439397713, "post_id": 31969610, "comment_id": 51848867, "body": "Path 2 (doesn&#39;t work): /kernel/drivers/i2c"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439397913, "post_id": 31969610, "comment_id": 51848987, "body": "i2c-core.ko is not a symlink."}, {"owner": {"reputation": 8600, "user_id": 450758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ccb382a98f56c846d0e064f44920dc?s=128&d=identicon&r=PG", "display_name": "marko", "link": "https://stackoverflow.com/users/450758/marko"}, "edited": false, "score": 0, "creation_date": 1439665956, "post_id": 31969610, "comment_id": 51958204, "body": "There are some fairly apparent security hazards to this approach, as your app presumably needs to run as root to achieve this (or at least be able to <code>setUID()</code> to <code>root</code>.  A better approach might be  to execute a script with the setUID permission."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439398243, "post_id": 31970976, "comment_id": 51849194, "body": "Why doesn&#39;t it need the path for other drivers that do install?"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439398278, "post_id": 31970976, "comment_id": 51849216, "body": "Modprobe doesn&#39;t work. Module dependency files are not generated."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439400466, "post_id": 31970976, "comment_id": 51850413, "body": "Have you run <code>depmod -a</code> after building new modules? Also, double-check current working directory (both when you test from command line and when you try to load from your application). Anyway, at least my <code>insmod</code> on Ubuntu does not find modules without path (and <code>man insmod</code> does not talk anything about search path)."}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439400956, "post_id": 31970976, "comment_id": 51850702, "body": "Yes just looking into depmod -a."}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439400992, "post_id": 31970976, "comment_id": 51850719, "body": "Sorry what exactly do you mean double check? Double check for what?"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439401078, "post_id": 31970976, "comment_id": 51850767, "body": "I do insmod from the same directory as I run the program from. That what you mean?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439403599, "post_id": 31970976, "comment_id": 51852163, "body": "@carlh Yeah, basically that (unless the program changes working directory before executing <code>insmod</code>)."}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439411789, "post_id": 31970976, "comment_id": 51856453, "body": "depmod -a -b /home/carl/SandBox/PhoneDev/SourceCode/buildroot/build_mipse&zwnj;&#8203;l_nofpu/root -r 2.6.10_dev-malta-mips2_fp_len"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439411877, "post_id": 31970976, "comment_id": 51856507, "body": "The dependency file shows all appropriate dependencies:"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439412130, "post_id": 31970976, "comment_id": 51856636, "body": "modprobe fails to find drivers"}, {"owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "edited": false, "score": 0, "creation_date": 1439412244, "post_id": 31970976, "comment_id": 51856710, "body": "# modprobe avalanche_ssp_i2c.ko modprobe: module avalanche_ssp_i2c.ko not found. modprobe: failed to load module avalanche_ssp_i2c.ko"}], "tags": [], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "is_accepted": false, "score": 0, "last_activity_date": 1439398089, "last_edit_date": 1439398089, "creation_date": 1439397738, "answer_id": 31970976, "question_id": 31969610, "link": "https://stackoverflow.com/questions/31969610/cant-install-some-driver-modules-from-c-program/31970976#31970976", "title": "Can&#39;t install some driver modules from C program", "body": "<p><code>insmod</code> wants the correct path (absolute or relative, <code>insmod i2c_core.ko</code> is same as <code>insmod ./i2c_core.ko</code>). If the module is properly installed for the kernel, try using <code>modprobe</code>:</p>\n\n<pre><code>system(\"modprobe i2c_core\");\n</code></pre>\n\n<p>Otherwise, you need to figure out how to find the correct path to the module file.</p>\n"}], "owner": {"reputation": 31, "user_id": 4495218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3c45850f9a16316867fb75095a4da9?s=128&d=identicon&r=PG&f=1", "display_name": "carlh", "link": "https://stackoverflow.com/users/4495218/carlh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439398089, "creation_date": 1439393460, "last_edit_date": 1439394768, "question_id": 31969610, "link": "https://stackoverflow.com/questions/31969610/cant-install-some-driver-modules-from-c-program", "title": "Can&#39;t install some driver modules from C program", "body": "<p>I have an embedded Linux application that can find and install <em>some</em> drivers from my C based application, but there are other drivers that it can't find at all.</p>\n\n<p>From application:</p>\n\n<pre><code>system(\"insmod i2c_core.ko\");\n</code></pre>\n\n<p>Debug error message:</p>\n\n<pre><code>insmod: i2c_core.ko: no module by that name found \n</code></pre>\n\n<p>However I have no problem installing any of the same drivers from the command line using the insmod command.</p>\n\n<p>It's not a driver sequence dependency problem because the error message would be different than the above error message.</p>\n\n<p>Linux version is 2.6.10 (old yes, but from reference design)</p>\n\n<p>All the drivers are under this path '/lib/modules' and are built as part of the kernel build.</p>\n"}, {"tags": ["c", "file", "disk", "msgpack"], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 3569471, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9139a126d3b268b1c52c5cc438a57f85?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3569471/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1439547223, "creation_date": 1439547223, "answer_id": 32007631, "question_id": 31969518, "link": "https://stackoverflow.com/questions/31969518/how-to-unpack-a-msgpack-file/32007631#32007631", "title": "How to unpack a msgpack file?", "body": "<p>Okay, I managed to do it. </p>\n\n<p>Here is how to write: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;msgpack.h&gt;\n#include &lt;msgpack/fbuffer.h&gt;\n\nint main(int argc, char **argv) {\n    if(2 != argc) {\n            fprintf(stderr, \"Call all writeFile &lt;file&gt;\");\n            return;\n    }\n\n    FILE *fp = fopen(argv[1], \"ab\");\n    msgpack_packer pk;\n    msgpack_packer_init(&amp;pk, fp, msgpack_fbuffer_write);\n\n    for(int i=0;i&lt;2048;i++) {\n            msgpack_pack_int(&amp;pk, i);\n    }\n    fclose(fp);\n}\n</code></pre>\n\n<p>And this is what the read looks like: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;msgpack.h&gt;\n\nstatic const int BUFFERSIZE = 2048;\n\nint main(int argc, char **argv) {\n    if(2 != argc) {\n            fprintf(stderr, \"Call with readFile &lt;file&gt;\");\n            return 1;\n    }\n\n    char *inbuffer = (char *) malloc(BUFFERSIZE);\n    if(NULL == inbuffer) {\n            fprintf(stderr, \"Out of memory!\");\n            return 1;\n    }\n\n    FILE *fp = fopen(argv[1], \"rb\");\n    size_t off = 0;\n    size_t read = 0;\n    msgpack_unpacked unpacked;\n    msgpack_unpacked_init(&amp;unpacked);\n    do {\n            read = fread(inbuffer, sizeof(char), BUFFERSIZE - off, fp);\n            off = 0;\n            while(msgpack_unpack_next(&amp;unpacked, inbuffer, read, &amp;off)) {\n                    msgpack_object_print(stdout, unpacked.data);\n                    puts(\"\");\n            }\n            memcpy(inbuffer, &amp;(inbuffer[off]), read-off);\n            off = read - off;\n    } while(read != 0);\n    free(inbuffer);\n    fclose(fp);\n    msgpack_unpacked_destroy(&amp;unpacked);\n    return 0;\n}\n</code></pre>\n\n<p>I did not try, but I think it will work with larger objects (arrays, maps etc.) as well.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 5234697, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/98a5e59c47fefbd97d60e39dc5a75cf6?s=128&d=identicon&r=PG", "display_name": "NiteHawk", "link": "https://stackoverflow.com/users/5234697/nitehawk"}, "is_accepted": true, "score": 2, "last_activity_date": 1439804642, "creation_date": 1439804642, "answer_id": 32047245, "question_id": 31969518, "link": "https://stackoverflow.com/questions/31969518/how-to-unpack-a-msgpack-file/32047245#32047245", "title": "How to unpack a msgpack file?", "body": "<p>You might consider using \"msgpack_unpacker\" for that instead, which seems to be the official way that MessagePack implements a 'streaming' deserializer. Have a look at msgpack-c/example/c/lib_buffer_unpack.c</p>\n\n<p>Regards, NiteHawk</p>\n"}], "owner": {"reputation": 741, "user_id": 3569471, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9139a126d3b268b1c52c5cc438a57f85?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3569471/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2049, "favorite_count": 0, "accepted_answer_id": 32047245, "answer_count": 2, "score": 3, "last_activity_date": 1439804642, "creation_date": 1439393226, "question_id": 31969518, "link": "https://stackoverflow.com/questions/31969518/how-to-unpack-a-msgpack-file", "title": "How to unpack a msgpack file?", "body": "<p>I am writing msgpack-encoded data to a file. On writing, I am just using the fbuffer of the C API. As in (I striped all error handling for the example):</p>\n\n<pre><code>FILE *fp = fopen(filename, \"ab\");\nmsgpack_packer pk;\nmsgpack_packer_init(pk, fp, msgpack_fbuffer_write);\nmsgpack_pack_int(pk, 42);\n// more data ...\n</code></pre>\n\n<p>How do I read this file back in? All the example I found assume that the data is in memory, however, my files are up to 5GB, it is not exactly a good idea to hold this in memory completely. Also I do not want to read in chunks myself. After all, I do not know how long the msgpack objects are, so chances are I end up with half an integer in my buffer. </p>\n\n<p>Can msgpack's unpack somehow read from disk directly? Or is there some standard pattern to do this?</p>\n"}, {"tags": ["c", "typedef", "sizeof"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1439393040, "post_id": 31969194, "comment_id": 51845840, "body": "That&#39;s <code>sizeof hello + strlen(hello.chaine) + 1</code>. (But there&#39;s no way to generalize this for arbitrary structs that contains pointers.)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1439394022, "post_id": 31969194, "comment_id": 51846547, "body": "There are some answers <b><i><a href=\"http://stackoverflow.com/a/26568649/645128\">here</a></i></b>, including those besides mine, that discuss this in detail."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439394413, "post_id": 31969194, "comment_id": 51846843, "body": "&quot;the actual size of a structure with severals members&quot; is <code>sizeof hello</code>.  Noting more, nothing less."}], "answers": [{"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1439392982, "post_id": 31969343, "comment_id": 51845790, "body": "Oh yes, so much +1 on the &quot;you need to learn&quot;. This one is set up for a visit to segfault land <i>real</i> soon. ;-)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1439393005, "post_id": 31969343, "comment_id": 51845810, "body": "A <code>char *</code> is <b>not</b> always 8 bytes."}, {"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439393017, "post_id": 31969343, "comment_id": 51845821, "body": "@EOF: I mean on his compiler."}], "tags": [], "owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "is_accepted": false, "score": 4, "last_activity_date": 1439393047, "last_edit_date": 1439393047, "creation_date": 1439392781, "answer_id": 31969343, "question_id": 31969194, "link": "https://stackoverflow.com/questions/31969194/sizeof-whole-struct-with-member/31969343#31969343", "title": "sizeof whole struct with member", "body": "<p>A <code>char*</code> is a pointer.  It's always 8 bytes (or whatever size pointers are in your architecture; on 32-bit systems, it'll be 4 bytes).  The actual string data lives elsewhere, and is not \"owned\" by the struct in any way.</p>\n\n<p>You need to learn about pointers and memory management.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1439393066, "creation_date": 1439393066, "answer_id": 31969470, "question_id": 31969194, "link": "https://stackoverflow.com/questions/31969194/sizeof-whole-struct-with-member/31969470#31969470", "title": "sizeof whole struct with member", "body": "<p><code>sizeof</code> operator returns the size of it's operand. In this case, the operand is <code>hello</code> which is of type <code>struct mastruct</code>, so it will produce the size of the structure itself, that is, the size of the member variables, plus padding (if any).</p>\n\n<p>There is no way, it can measure the size of the memory location <em>pointed to</em> by a pointer type member variable.</p>\n\n<p>Also, FWIW, without being a structure member also, <code>sizeof</code>  will return the type of the variable itself (size of a pointer type), not the <em>amount of memory allocated</em>, for a pointer variable.</p>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1439393170, "post_id": 31969482, "comment_id": 51845925, "body": "<code>sizeof(float)</code> is probably more consistently 4 than <code>sizeof(int)</code>."}, {"owner": {"reputation": 17, "user_id": 5219820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b4a8d64d1e891d2805f3efa91fbd1181?s=128&d=identicon&r=PG&f=1", "display_name": "Lion.24", "link": "https://stackoverflow.com/users/5219820/lion-24"}, "edited": false, "score": 0, "creation_date": 1439394866, "post_id": 31969482, "comment_id": 51847156, "body": "Ok that exactly what I was asking. Thank you very much for your fast and precise response."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 17, "user_id": 5219820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b4a8d64d1e891d2805f3efa91fbd1181?s=128&d=identicon&r=PG&f=1", "display_name": "Lion.24", "link": "https://stackoverflow.com/users/5219820/lion-24"}, "edited": false, "score": 0, "creation_date": 1439398247, "post_id": 31969482, "comment_id": 51849199, "body": "@Lion.24 no need for thanks, but an upvote and/or accepting the answer would be appreciated."}], "tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": false, "score": 0, "last_activity_date": 1439393101, "creation_date": 1439393101, "answer_id": 31969482, "question_id": 31969194, "link": "https://stackoverflow.com/questions/31969194/sizeof-whole-struct-with-member/31969482#31969482", "title": "sizeof whole struct with member", "body": "<p>Your code is performing correctly. It is listing the size of the struct. The <code>struct</code> contains:</p>\n\n<ul>\n<li>An <code>int</code> (4 bytes)</li>\n<li>A <code>char *</code> (4 bytes on 32 bit, 8 bytes on 64 bit)</li>\n<li>A <code>float</code> (here 4 bytes)</li>\n</ul>\n\n<p>You thus get the total of 16 bytes. It's thus doing what you asked it to do.</p>\n\n<p>If you want the size of the <code>struct</code> and the size of the things pointed do by the <code>struct</code>, use</p>\n\n<pre><code>sizeof(hello) + strlen(hello.chaine) + 1\n</code></pre>\n\n<p>the <code>+ 1</code> is for the terminating zero. Note though that multiple <code>struct</code> entries might point to the same string (depending on how you have things set up), so this won't necessarily represent the total memory allocated in respect of this item (only). Equally it might point to a constant string, in which case no (dynamic) memory will be allocated.    </p>\n"}, {"tags": [], "owner": {"reputation": 414, "user_id": 4369740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/465640e769a726efeeb7d16db1b01259?s=128&d=identicon&r=PG&f=1", "display_name": "tipaye", "link": "https://stackoverflow.com/users/4369740/tipaye"}, "is_accepted": false, "score": 1, "last_activity_date": 1439393549, "creation_date": 1439393549, "answer_id": 31969659, "question_id": 31969194, "link": "https://stackoverflow.com/questions/31969194/sizeof-whole-struct-with-member/31969659#31969659", "title": "sizeof whole struct with member", "body": "<p>First you'll have to somehow manage the memory for chaine safely. If you're allocating it directly using the malloc family, then you'll already know the size.\nIf you're going to point it to a char array on the stack, then again you already know the size (use sizeof or strlen if in doubt).\nThe point is that you have to look for 2 sizes:\n1. Your struct, including (sizeof char *)\n2. The actual string pointed to by chaine\nPlease keep in mind that it is very unlikely your char array and struct will be contiguous, so you can't use this final size for indexing.</p>\n"}], "owner": {"reputation": 17, "user_id": 5219820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b4a8d64d1e891d2805f3efa91fbd1181?s=128&d=identicon&r=PG&f=1", "display_name": "Lion.24", "link": "https://stackoverflow.com/users/5219820/lion-24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1439393549, "creation_date": 1439392399, "last_edit_date": 1439392725, "question_id": 31969194, "link": "https://stackoverflow.com/questions/31969194/sizeof-whole-struct-with-member", "title": "sizeof whole struct with member", "body": "<p>Sorry for that dumb question but how can I know the actual size of a structure with severals members in it. </p>\n\n<p>For example here is my struct : </p>\n\n<pre><code>typedef struct mastruct mastruct;\nstruct mastruct{\n    int val;\n    char *chaine;\n    float decimal;\n}__attribute__((packed));\n</code></pre>\n\n<p>and the affectation : </p>\n\n<pre><code>mastruct hello =\n{\n    23,\n    \"Hello world!\",\n    3.141592654\n};\n</code></pre>\n\n<p>printf return me this : </p>\n\n<pre><code>printf(\"int : %d, char* : %d, float : %d\\n\", sizeof(int), sizeof(char*), sizeof(float));\nprintf(\"struct size : %d\\n\", sizeof(hello));\n\nint : 4, char* : 8, float : 4\nstruct size : 16\n</code></pre>\n\n<p>which is normal because int + char* + float = 16 bytes but this is not what I want. I want to know the complete size of the structure in memory.</p>\n\n<p>For example if I'm writing \"Hello world!!!!!!!!!!!!!!!!!!!!!!!\" instead of \"Hello world!\" this would modify the footprint memory and I need to know that.</p>\n\n<p>With this example if I'm printing the size of the struct I still get 16 bytes : </p>\n\n<pre><code>mastruct hello =\n    {\n        23,\n        \"Hello world! Hellooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\",\n        3.141592654\n    };\n</code></pre>\n"}, {"tags": ["c", "strcat", "strcat-s"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439397279, "post_id": 31968903, "comment_id": 51848614, "body": "suggest reading the man page for strcat() and comparing it to the man page for strcat_s().   The man page(s) are very informative about returned values.  A &#39;google&#39; of strcat will find plenty of references about the limitations of strcat() and the preference to use strncat()."}, {"owner": {"reputation": 1, "user_id": 5219867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8beb76335e9579808e7368e656316?s=128&d=identicon&r=PG&f=1", "display_name": "viki", "link": "https://stackoverflow.com/users/5219867/viki"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439650010, "post_id": 31968903, "comment_id": 51953344, "body": "thanks for reference."}], "answers": [{"tags": [], "owner": {"reputation": 5694, "user_id": 1552737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfC6P.jpg?s=128&g=1", "display_name": "IKavanagh", "link": "https://stackoverflow.com/users/1552737/ikavanagh"}, "is_accepted": false, "score": 3, "last_activity_date": 1439392350, "last_edit_date": 1439392350, "creation_date": 1439391964, "answer_id": 31969021, "question_id": 31968903, "link": "https://stackoverflow.com/questions/31968903/does-strcat-return-an-error-as-strcat-s-does/31969021#31969021", "title": "Does strcat() return an error as strcat_s() does?", "body": "<p><code>strcat()</code> does not return an error code but you can still use it incorrectly and run into errors. It can be used instead of <code>strcat_s()</code> like</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>strcat(str1, str2);\n</code></pre>\n\n<p>It may help you to look up a reference for C functions like <a href=\"http://en.cppreference.com/w/c/string/byte/strcat\" rel=\"nofollow\">cppreference.com/w/c</a> to find out the answer to similar questions like this.</p>\n"}], "owner": {"reputation": 1, "user_id": 5219867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8beb76335e9579808e7368e656316?s=128&d=identicon&r=PG&f=1", "display_name": "viki", "link": "https://stackoverflow.com/users/5219867/viki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1439393402, "creation_date": 1439391688, "last_edit_date": 1439393402, "question_id": 31968903, "link": "https://stackoverflow.com/questions/31968903/does-strcat-return-an-error-as-strcat-s-does", "title": "Does strcat() return an error as strcat_s() does?", "body": "<p>Does <code>strcat()</code> return an error as <code>strcat_s()</code> does? Can <code>strcat()</code> replace strcat_s()`?</p>\n\n<pre><code> char str1[50] = \"To be, or not to be, \";\n char str2[] = \"that is the question.\";\n int retval = strcat_s(str1, sizeof str1, str2);\n if(retval)\n     printf(\"There was an error joining the strings. Error code = %d\",retval);\n else\n     printf(\"The combined strings:\\n%s\\n\", str1);\n</code></pre>\n"}, {"tags": ["c", "standards", "strict-aliasing"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1439391534, "post_id": 31968576, "comment_id": 51844790, "body": "No, it is not correct code. Strict aliasing is a requirement of the standard, not the compiler. It is a courtesy of gcc to disable this for broken code."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1529531982, "post_id": 31968576, "comment_id": 88912688, "body": "@Olaf: Some implementations define the behavior of the above code, and some don&#39;t.  Code that is limited to compilers that support behaviors beyond what the Standard requires (i.e. most useful programs) might not be completely portable, but that doesn&#39;t mean they are in any sense &quot;broken&quot;.  By contrast, gcc&#39;s behavior in many cases (though  admittedly not the above) would be downright broken unless it either (1) applies the &quot;One Program Rule&quot; in a way that would render the Standard meaningless, or (2) documents that it conformance requires <code>-fno-strict-aliasing</code> or <code>-O0</code>."}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1448092548, "post_id": 31968869, "comment_id": 55446822, "body": "I think a major key to understanding the rule is to recognize that the authors of the Standard perceived zero need to define a language suitable for systems-programming purposes, since anyone seeking to make an implementation be suitable for such purpose could specify that the aliasing rules don&#39;t apply (even though, oddly, I think I&#39;ve seen more compilers whose authors pretend the rule doesn&#39;t exist than explicitly renounce its use for optimization).  Too bad the Committee never defined a &quot;type aliasing barrier&quot; since that would have made the language suitable for systems programming..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1448092665, "post_id": 31968869, "comment_id": 55446844, "body": "...and eliminated the need for the &quot;character-type&quot; exception to the aliasing rules."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1448096872, "post_id": 31968869, "comment_id": 55447794, "body": "@supercat well, compilers have implemented such a thing (<code>-fno-strict-aliasing</code>)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1448136186, "post_id": 31968869, "comment_id": 55460540, "body": "Is there any <i>standard</i> way by which a program can indicate that it needs to be able to ensure that all writes to a block of memory using any type before a certain point need to precede all writes of that memory using any type after that point?  Many programs that require no-strict-aliasing would in fact work just fine with 99% aliasing optimizations enabled if there were a way that a programmer could block the 1% that would cause trouble."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1439391587, "creation_date": 1439391587, "answer_id": 31968869, "question_id": 31968576, "link": "https://stackoverflow.com/questions/31968576/strict-aliasing-and-pointer-to-union-fields/31968869#31968869", "title": "Strict-aliasing and pointer to union fields", "body": "<p>The C standard says that aliasing via unions is explicitly permitted.  </p>\n\n<p>However check the following code:</p>\n\n<pre><code>void func(int *a, short *b)\n{\n     *a = 1; \n     printf(\"%f\\n\", *b);\n}\n</code></pre>\n\n<p>The intent of the strict aliasing rule is that <code>a</code> and <code>b</code> should be assumed to not alias. However you could call <code>func(&amp;u.f1, &amp;u.f2);</code> .</p>\n\n<p>To resolve this dilemma, a common sense solution is to say that the 'bypass permit' that unions have to avoid the strict aliasing rule only applies to when the union members are accessed by name. </p>\n\n<p>The Standard doesn't explicitly state this. It could be argued that \"If the member used...\" (6.5.2.3) actually is specifying that the 'bypass' only occurs when accessing the member by name, but it's not 100% clear.</p>\n\n<p>However it is hard to come up with any alternative and self-consistent interpretation.  One possible alternative interpretation goes along the lines that writing <code>func(&amp;u.f1, &amp;u.f2)</code> causes UB because overlapping objects were passed to a function that 'knows' it does not receive overlapping objects -- sort of like a <code>restrict</code> violation.</p>\n\n<p>If we apply this first interpretation to your example, we would say that the <code>*a</code> in your <code>printf</code> causes UB because the current object stored at that location is a <code>short</code>, and 6.5.2.3 doesn't kick in because we are not using the union member by name.</p>\n\n<p>I'd guess based on your posted results that gcc is using the same interpretation.</p>\n\n<p>This has been discussed before here but I can't find the thread right now.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1529012771, "post_id": 31968885, "comment_id": 88735123, "body": "That provision is of rather limited utility given that the only types of union members that can be accessed without UB are <code>char</code>, <code>signed char</code>, and <code>unsigned char</code>."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1529460384, "post_id": 31968885, "comment_id": 88876554, "body": "@supercat could you please elaborate?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1529472172, "post_id": 31968885, "comment_id": 88879215, "body": "@JerryJeremiah: According to N1570 6.5p7, an object of an aggregate type may only be accessed using an lvalue of its own type, a character type, or an <i>enclosing</i> aggregate type.  There is no rule that allows an object of aggregate type to be accessed using an lvalue of member type.  The authors of the Standard likely figured that compiler writers would recognize that given something simple like <code>int *p = unionPtr-&gt;intMember; *p = 1;</code> a quality compiler would recognize the association between <code>*p</code> and the union whether the Standard would require it or not, but..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1529472310, "post_id": 31968885, "comment_id": 88879273, "body": "...gcc and clang are more &quot;clever&quot; and will generate more &quot;efficient&quot; code that can&#39;t reliably handle the possibility that the union might also be accessed as some other type."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1529524054, "post_id": 31968885, "comment_id": 88909448, "body": "@JerryJeremiah: While compiler writers seem to recognize most expressions that use of the form <code>unionPtr-&gt;intMember</code> directly, they cannot reliably handle a sequence like <code>unionPtr-&gt;member = expression1; memberType *p = &amp;unionPtr-&gt;member; *p = expression2; memberType result = unionPtr-&gt;member;</code>, though I&#39;m not sure how the <code>&amp;</code> operator can meaningfully be said to yield a pointer of the member type if a compiler can&#39;t reliably handle a straightforward usage case like that."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1529539346, "post_id": 31968885, "comment_id": 88914502, "body": "@JerryJeremiah: Our resident &quot;I-know-everything-better&quot; is misleading once more. He forgot to read the footnote which clarifies this: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#note95\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#note95</a> As I wrote, taype-punning by a <code>union</code> is the only strictly legal way. Note that this still leave the interpretationm of the data as <i>imnplementation defined</i> and on some implementations it can result in UB. But this has to be specified by the implementation e.g. by stating integers can have a trap representation, so it can be verified in advanced and guaranteed to work for a specific implementation."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1529539463, "post_id": 31968885, "comment_id": 88914536, "body": "@JerryJeremiah: And, yes, this part of the standard is mandatory for every C compiler. I&#39;d be very surprised gcc or clang fail at this particularily. If they do, though, it would be a bug and should be reported (if not done already). Wouldn&#39;t be the first time the optimiser runs amok. The example in the second comment does not even use a <code>union</code>. It&#39;s a common missconception thinking the pointer to a union-<b>member</b> is a pointer to a union. At this point 6.5p6 ff indeed are in effect. But that&#39;s a completely different subject."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1534289248, "post_id": 31968885, "comment_id": 90655143, "body": "@toohonestforthissite: The way the N1570 p6.5p7 is written, only a tiny minority of programs that use structs or unions actually have defined behavior; ability to run them is a Quality of Implementation issue.  Implementations that make a bona fide effort not to be obtuse will support most such programs, however, including many which obtuse compilers&#39; optimizers will break."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1439391637, "creation_date": 1439391637, "answer_id": 31968885, "question_id": 31968576, "link": "https://stackoverflow.com/questions/31968576/strict-aliasing-and-pointer-to-union-fields/31968885#31968885", "title": "Strict-aliasing and pointer to union fields", "body": "<p>The C99 Technical Corrigendum 3 is clarifying about the type-punning based on the union method by stating in the section 6.5.2.3:</p>\n\n<blockquote>\n  <p>If the member used to access the contents of a union object is not\n  the same as the member last used to store a value in the object, the\n  appropriate part of the object representation of the value is\n  reinterpreted as an object representation in the new type as described\n  in 6.2.6 (a process sometimes called \"type punning\").</p>\n</blockquote>\n\n<p>See <a href=\"http://c0x.coding-guidelines.com/6.5.2.3.html\" rel=\"nofollow\">here</a> from 1042 through 1044</p>\n"}], "owner": {"reputation": 242, "user_id": 1690972, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/163cba45201bf40c81c7bd5defc0c2bb?s=128&d=identicon&r=PG", "display_name": "alexanius", "link": "https://stackoverflow.com/users/1690972/alexanius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 1, "accepted_answer_id": 31968869, "answer_count": 2, "score": 4, "last_activity_date": 1439391637, "creation_date": 1439390880, "question_id": 31968576, "link": "https://stackoverflow.com/questions/31968576/strict-aliasing-and-pointer-to-union-fields", "title": "Strict-aliasing and pointer to union fields", "body": "<p>I've got a question about strict-aliasing rules, unions and standard. Assume we have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunion\n{\n    int f1;\n    short f2;\n} u = {0x1};\n\nint     * a = &amp;u.f1;\nshort   * b = &amp;u.f2;\n\nint main()\n{\n    u.f1 = 1;\n    *a += 1;\n    u.f2 = 2;\n    *b *= 2;\n\n    printf( \"%d %hd\\n\", *a, *b);\n\n    return 0;\n}\n</code></pre>\n\n<p>Now let's look how it works:</p>\n\n<pre><code>$ gcc-5.1.0-x86_64 t.c -O3 -Wall &amp;&amp; ./a.out \n2 4\n$ gcc-5.1.0-x86_64 t.c -O3 -Wall -fno-strict-aliasing &amp;&amp; ./a.out \n4 4\n</code></pre>\n\n<p>We can see that strict-aliasing breaks dependencies. Moreover it seems to be a correct code without breaking strict-aliasing rule.</p>\n\n<ol>\n<li>Does it turn out than in case of union fields an object laying at the address is compatible with all types of union members?</li>\n<li>If 1 is true what should compiler do with pointers to union members? Is it a problem in the standard, that <strong>allows</strong> such compiler behavior? If not - why?</li>\n<li>Generally speaking different behavior of the compiler with the correct code is inadmissible in any case. So it seems to be a compiler bug too (especially if taking address to union field will be inside functions, the SA does not breaks dependence).</li>\n</ol>\n"}, {"tags": ["c", "compilation"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1439390738, "post_id": 31968486, "comment_id": 51844174, "body": "<code>extern struct rtModel_capacitor *const capacitor_rtM;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1142, "user_id": 1818443, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/j4sUq.gif?s=128&g=1", "display_name": "Lukas Bystricky", "link": "https://stackoverflow.com/users/1818443/lukas-bystricky"}, "edited": false, "score": 0, "creation_date": 1439391701, "post_id": 31968620, "comment_id": 51844915, "body": "That fixed it. Thank you very much."}, {"owner": {"reputation": 414, "user_id": 4369740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/465640e769a726efeeb7d16db1b01259?s=128&d=identicon&r=PG&f=1", "display_name": "tipaye", "link": "https://stackoverflow.com/users/4369740/tipaye"}, "edited": false, "score": 0, "creation_date": 1439393951, "post_id": 31968620, "comment_id": 51846491, "body": "Looks like you&#39;re writing in a newer style than your compiler supports. Have you checked your compiler flags to see if you can select different dialects and perhaps compile a more recent syntax? That code should not be a problem in C99 and beyond. I tried using gcc 4.8.4, and your code compiled fine, as it should."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 2, "last_activity_date": 1439391483, "last_edit_date": 1439391483, "creation_date": 1439390981, "answer_id": 31968620, "question_id": 31968486, "link": "https://stackoverflow.com/questions/31968486/compilation-error-involving-struct/31968620#31968620", "title": "compilation error involving struct", "body": "<p>Different ways to resolve the problem:</p>\n\n<pre><code>struct rtModel_capacitor {\n  ....\n};\nextern struct rtModel_capacitor *const capacitor_rtM;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>struct rtModel_capacitor {\n  ....\n};\ntypedef struct rtModel_capacitor rtModel_capacitor;\nextern rtModel_capacitor *const capacitor_rtM;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>typedef struct {\n  ....\n}rtModel_capacitor;\nextern rtModel_capacitor *const capacitor_rtM;\n</code></pre>\n"}], "owner": {"reputation": 1142, "user_id": 1818443, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/j4sUq.gif?s=128&g=1", "display_name": "Lukas Bystricky", "link": "https://stackoverflow.com/users/1818443/lukas-bystricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 31968620, "answer_count": 1, "score": 0, "last_activity_date": 1439391483, "creation_date": 1439390637, "question_id": 31968486, "link": "https://stackoverflow.com/questions/31968486/compilation-error-involving-struct", "title": "compilation error involving struct", "body": "<p>I really dislike asking about compilation errors here, but this one has been really bugging me.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>struct rtModel_capacitor {\n  ....\n};\nextern rtModel_capacitor *const capacitor_rtM;\n</code></pre>\n\n<p>This gives the error (for the last line):</p>\n\n<pre><code>expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018*\u2019 token\n</code></pre>\n\n<p>Why won't this compile? </p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 3008, "user_id": 2209329, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e62709eac24c8a174c5f876e1cb63b39?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Szyd\u0142owski", "link": "https://stackoverflow.com/users/2209329/micha%c5%82-szyd%c5%82owski"}, "edited": false, "score": 2, "creation_date": 1439390551, "post_id": 31968406, "comment_id": 51844029, "body": "Should throw a segfault while evaluating the IF condition."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1439390854, "post_id": 31968406, "comment_id": 51844250, "body": "Not necessarily. Especially in Windows there is no segfaults... It&#39;s an undefined behaviour. It can blow up the Moon, for example, so please don&#39;t do this. We still need it."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1439391705, "post_id": 31968406, "comment_id": 51844920, "body": "<a href=\"http://stackoverflow.com/a/605858/3233393\">Please do not cast the result of <code>malloc()</code></a>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439396021, "post_id": 31968406, "comment_id": 51847889, "body": "I&#39;m voting to close this question as off-topic because it&#39;s yet another &#39;I know it&#39;s UB but I still want SO contributors to waste time on it&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "is_accepted": false, "score": 1, "last_activity_date": 1439390737, "creation_date": 1439390737, "answer_id": 31968519, "question_id": 31968406, "link": "https://stackoverflow.com/questions/31968406/linked-list-in-data-structures/31968519#31968519", "title": "Linked List In Data Structures", "body": "<p>If <code>temp-&gt;next</code> is NULL, dereferencing it to get <code>temp-&gt;next-&gt;next</code> is <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow\">undefined behavior</a>.  A crash is likely, but other things could happen.  In principle, <em>anything</em> could happen.</p>\n\n<p>Don't dereference null pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 1380, "user_id": 2165806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2921d9118eb14ea118e5efe367c5203?s=128&d=identicon&r=PG", "display_name": "Vouze", "link": "https://stackoverflow.com/users/2165806/vouze"}, "is_accepted": true, "score": 1, "last_activity_date": 1439390845, "creation_date": 1439390845, "answer_id": 31968557, "question_id": 31968406, "link": "https://stackoverflow.com/questions/31968406/linked-list-in-data-structures/31968557#31968557", "title": "Linked List In Data Structures", "body": "<p>NULL->next must give you a segfault.</p>\n\n<p>You may want to have something like :</p>\n\n<pre><code>if(p-&gt;next != NULL &amp;&amp; p-&gt;next-&gt;next==NULL)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if(p-&gt;next == NULL || p-&gt;next-&gt;next==NULL)\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5185934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e9a80fca1fa7938a2fc53878a1f12371?s=128&d=identicon&r=PG&f=1", "display_name": "ankush kapoor", "link": "https://stackoverflow.com/users/5185934/ankush-kapoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 31968557, "answer_count": 2, "score": 0, "last_activity_date": 1439391961, "creation_date": 1439390416, "last_edit_date": 1439391961, "question_id": 31968406, "link": "https://stackoverflow.com/questions/31968406/linked-list-in-data-structures", "title": "Linked List In Data Structures", "body": "<p>Suppose <code>temp</code> is a pointer to structure <code>node</code>. <code>temp-&gt;next</code> is <code>NULL</code>. So what will be the value of <code>temp-&gt;next-&gt;next</code>?</p>\n\n<p>In short what is the value of <code>NULL-&gt;next</code>? Is it compiler dependent because I have seen different result in ubuntu and code blocks(windows)?</p>\n\n<p>What will be the output of the program below?   </p>\n\n<pre><code> struct node\n {\n  int data;\n   struct node *next;\n };\n\n main()\n {\n   struct node *temp,*p;\n   int c=0;\n   temp=(struct node *)malloc(sizeof(struct node));\n   temp-&gt;data=50;\n   temp-&gt;next=NULL;\n   p=temp;\n   if(p-&gt;next-&gt;next==NULL)//will it enter the if loop?\n      c++;\n   printf(\"%d\",c);\n  }\n</code></pre>\n"}, {"tags": ["c", "string", "file"], "comments": [{"owner": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "edited": false, "score": 0, "creation_date": 1439390380, "post_id": 31968279, "comment_id": 51843891, "body": "array index might overflow.You allocated  &#39;struct String tabdata1[6];, but reading the file * while (!feof(fichier))&#39; { .. }make sure you allocated enough space"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439390651, "post_id": 31968279, "comment_id": 51844110, "body": "No memory was allocated for <code>data1.string</code>, so <code>fscanf(fichier, &quot;%s\\n&quot;, data1);</code> is a <i>really</i> bad idea."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1439390659, "post_id": 31968279, "comment_id": 51844119, "body": "<code>data1.string = malloc(need size);fscanf(fichier, &quot;%s\\n&quot;, data1.string);</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1439392311, "post_id": 31968279, "comment_id": 51845318, "body": "Before writing code like <code>fscanf(fichier, &quot;%s\\n&quot;, data1);</code>, it would be good to know what <code>%s</code> expects. You&#39;re not fulfilling that. <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">See the documentation of the <code>scanf</code> function family</a>."}], "owner": {"reputation": 23, "user_id": 5211207, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207354002917421/picture?type=large", "display_name": "Monia Monia", "link": "https://stackoverflow.com/users/5211207/monia-monia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439390135, "creation_date": 1439390135, "question_id": 31968279, "link": "https://stackoverflow.com/questions/31968279/read-a-file-and-saves-it-in-an-array-of-string-in-c", "title": "read a file and saves it in an array of string in C", "body": "<p>I work with Eclipse luna, Cygwin and windows 8.</p>\n\n<p>I want to read a file that contains this information:</p>\n\n<pre><code>    A 3.0\n    B 4\n    C 7\n</code></pre>\n\n<p>and store them in an array of String ** ** tabdata1.</p>\n\n<p>The class Lire.h is:</p>\n\n<pre><code>struct String {\nchar *string;\n};\nvoid PSOConstants();\ndouble data[3] ;\n</code></pre>\n\n<p>and the class Lire.C is:</p>\n\n<pre><code>void PSOConstants()   {\n    struct String data1;\n    struct String tabdata1[6];\n    double copiedata[6];\n    FILE* fichier= fopen(\"E:\\\\processing_Times_C\\\\info1.txt\", \"r\");  \n    int i=0;\n    while (!feof(fichier)){\n        fscanf(fichier, \"%s\\n\", data1);\n        tabdata1[i]=data1;\n        printf(\"%s\", data1);\n        i=i+1;\n    }\n    fclose(fichier);\n }\n\nint main(){\n    PSOConstants();\n    return 0;\n}\n</code></pre>\n\n<p>this generates a cygwin_exception :: open_stackdumpfile: Dumping stack trace. Knowing that all is well when I delete the two lines:</p>\n\n<pre><code>        tabdata1[i]=data1;\n        i=i+1;\n</code></pre>\n\n<p>Do you have an idea ?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "c", "sockets", "ssh", "libssh"], "comments": [{"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1439390178, "post_id": 31968193, "comment_id": 51843698, "body": "Unless all three run on the same host, you have to use three sessions. A session is a connection. A channel is a logical stream (or set of streams) of data sent over that session."}, {"owner": {"reputation": 2102, "user_id": 2828925, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/18abe23c6b1123371f171f55be659ef5?s=128&d=identicon&r=PG&f=1", "display_name": "Jes", "link": "https://stackoverflow.com/users/2828925/jes"}, "reply_to_user": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1439393516, "post_id": 31968193, "comment_id": 51846175, "body": "OK I see! Thank you!"}], "owner": {"reputation": 2102, "user_id": 2828925, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/18abe23c6b1123371f171f55be659ef5?s=128&d=identicon&r=PG&f=1", "display_name": "Jes", "link": "https://stackoverflow.com/users/2828925/jes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439390061, "creation_date": 1439389890, "last_edit_date": 1439390061, "question_id": 31968193, "link": "https://stackoverflow.com/questions/31968193/distributed-program-with-libssh", "title": "Distributed program with libssh", "body": "<p>I am designing a distributed program using C/C++ based socket communication. Basically, I have one server program <code>S</code> and three client programs <code>A</code>, <code>B</code>, and <code>C</code>, and client programs communicate with the server program <code>S</code> through customized socket port. Instead of manually starting the four programs (<code>S</code>, <code>A</code>, <code>B</code>, and <code>C</code>), I want to use libssh to create ssh session(s) and send <code>exec</code> method to run client programs. However, I am a bit confused by the definition between <code>ssh session</code> and <code>ssh channel</code>. In my case, I would like to run ssh API on server program <code>S</code> to invoke these three client programs on remote hosts. Should I use one ssh session with three channels or three ssh sessions with one channel each?</p>\n"}, {"tags": ["c", "file", "input", "io", "output"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1439389626, "post_id": 31968023, "comment_id": 51843242, "body": "Where does it crash ? Your debugger will tell you. Also please show the calling code as well as variable and type declarations such as <code>SVG</code>."}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 2, "creation_date": 1439389810, "post_id": 31968023, "comment_id": 51843388, "body": "Note that <code>getc</code> returns an <code>int</code>. <code>EOF</code> may not fit in a <code>char</code>. Declare <code>c</code> as an <code>int</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1439389834, "post_id": 31968023, "comment_id": 51843412, "body": "Your <code>total_length</code> doesn&#39;t include space for a null-terminator."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1439389845, "post_id": 31968023, "comment_id": 51843420, "body": "Please <a href=\"http://stackoverflow.com/q/605845/2173917\">see why not to cast</a> the return value of <code>malloc()</code> and family in <code>C</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439389873, "post_id": 31968023, "comment_id": 51843435, "body": "Unrelated, but <code>sizeof(char)</code> is always 1 per definition."}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "edited": false, "score": 0, "creation_date": 1439389921, "post_id": 31968023, "comment_id": 51843478, "body": "S\u0130nce I&#39;m using devc++ it shows nothing :)) I also tried in Visual Studio without precompiler header and set as C compiler, I got the malloc problem which says you cannot be initialized with the type &quot;Coord&quot;. I&#39;m updating my post with the header parts."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439389992, "post_id": 31968023, "comment_id": 51843537, "body": "Try <code>malloc(total_length * 2)</code> just for testing purposes. If it doesn&#39;t crash anymore, then the problem is probably that you don&#39;t allocate enough memory and you write beyont the allocated memory."}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "edited": false, "score": 0, "creation_date": 1439390089, "post_id": 31968023, "comment_id": 51843628, "body": "Kninnug, I have no problem in that part I know it.  For example instead of writing with fprintf, I just type like printf(&quot;%s&quot;, str_joined); it works correctly ?"}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439390223, "post_id": 31968023, "comment_id": 51843732, "body": "@Michael Walz, I tried what you saying but it still crashes :("}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439390243, "post_id": 31968023, "comment_id": 51843754, "body": "Test  if <code>fp</code> is NULL after <code>fp = fopen(input, &quot;r&quot;);</code>."}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439390396, "post_id": 31968023, "comment_id": 51843904, "body": "@Michael Walz, it doesnt work either. Also I&#39;m using w+ flag which means create file if not exist or delete all content write on it. So it doesnt really matter to check whether ftp_out is null or not"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1439390499, "post_id": 31968023, "comment_id": 51843992, "body": "<b>Never</b> assume <code>fopen</code> succeeds. It can fail for a lot of (sometimes unexpected) reasons"}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "edited": false, "score": 0, "creation_date": 1439390584, "post_id": 31968023, "comment_id": 51844056, "body": "So what you are suggesting me. I must do this in C, I&#39;m even better in C++ but This is required like this for the work."}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 4, "creation_date": 1439390897, "post_id": 31968023, "comment_id": 51844284, "body": "@Destroy we suggest you 1: check your <code>fopen</code> calls for <code>NULL</code>s. 2: use <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>snprintf</code></a> instead of <code>sprintf</code> to prevent overflow. 3: <code>malloc</code> string-length + 1 for your strings, don&#39;t cast the result but do check if it isn&#39;t <code>NULL</code>."}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "edited": false, "score": 0, "creation_date": 1439391170, "post_id": 31968023, "comment_id": 51844517, "body": "I check fopen whether it is null or not. I looked at the malloc issue and fixed it i guess. But nothing changed right now. So finally, I&#39;m going to check the &quot;snprintf&quot;, After checking I will write the result again."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439391233, "post_id": 31968023, "comment_id": 51844563, "body": "@Destroy can you tell us <b>where excatly</b> the crash occurs and what is the error message you get ?"}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "edited": false, "score": 0, "creation_date": 1439391772, "post_id": 31968023, "comment_id": 51844965, "body": "I&#39;m getting crash when the buffer is writtin in svg file. I know since when I change it to printf to check the buffer is correct. It is correct. But I tested that when the buffer size bigger than 16-18 kb I&#39;m getting this crash. For instance, when I got input as 40 kb, when the writing process, it crashes. I&#39;m not getting any error message because of the stupidity of devexpress. Now, I&#39;m trying to compile with gcc."}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "reply_to_user": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1439391878, "post_id": 31968023, "comment_id": 51845042, "body": "@Kninnug, I tested but \u0131 have no problem with sprintf either. It gets any buffer in anysize without any error. So let me see what&#39;s going to happen when compiling in gcc. I&#39;ll write soon"}, {"owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "edited": false, "score": 0, "creation_date": 1439393529, "post_id": 31968023, "comment_id": 51846188, "body": "So, I compiled with GCC but there is no error as not in devexpress. I have getting crash without any warning while program running. Cant get it really :("}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "is_accepted": true, "score": 0, "last_activity_date": 1439397265, "creation_date": 1439397265, "answer_id": 31970854, "question_id": 31968023, "link": "https://stackoverflow.com/questions/31968023/app-crashes-when-the-input-data-to-write-on-txt-is-bigger-than-16kb-c-programmi/31970854#31970854", "title": "App crashes when the input data to write on txt is bigger than 16kb (C programming)", "body": "<p>Ok, Thanks for the helps really. I solved the problem. I configured the Visual Studio for C compiling and also standardized my code as C99. So final shape of my code is the following and it works. </p>\n\n<pre><code>void generate_svg(char *input, char *output)\n{\n\n    //INPUT OPERAT\u0130ONS //\n\n    FILE *fp, *fp_out;  SVG *svg;  Coord *coord;\n    int array_size = 0, i=0, max_lines = 0;  // Line counters\n    char c;  // To store a character read from file to check whether newline or not\n    char *str_joined = NULL;\n    size_t total_length=0, length=0;\n\n    // Open the file\n    fp = fopen(input, \"r\");\n    if (fp == NULL)\n    {\n        perror(\"Error\");\n    }\n    else\n    {\n         //Count the number of lines for the array size \n        for (c = getc(fp); c != EOF; c = getc(fp))\n            if (c == '\\n') \n                array_size = array_size + 1;\n        fclose(fp);\n    }\n\n\n\n\n    // read the file into an array of coordinates\n    coord = (Coord*)malloc(array_size * sizeof(Coord)); //preallocation for performance\n    fp = fopen(input, \"r\");\n    if (fp == NULL)\n    {\n        perror(\"Error\");\n    }\n    else\n    {\n        while(!feof(fp))\n        {\n           //check whether input getting correctly             \n           if(fscanf(fp, \"%d, %d\", &amp;coord[i].x, &amp;coord[i].y)==2)      \n              i++;           \n\n        }\n        fclose(fp);\n    }\n\n\n    //OUTPUT OPERATIONS\n    max_lines = i;\n    svg = (SVG*)malloc(array_size * sizeof(SVG)); // allocate memory\n     //total length and length of string\n    for(i=0; i&lt;max_lines; i++)\n    {\n        sprintf(svg[i].xy , \"%d,%d \", coord[i].x, coord[i].y);\n        total_length += strlen(svg[i].xy); \n        //printf(\"%s\\n\", svg[i].xy);\n    }\n\n    str_joined = (char*)malloc(total_length * 2); // allocate memory for joined strings\n    str_joined[0] = '\\0'; // empty string we can append to\n\n    for(i=0; i&lt;max_lines; i++)\n    {\n        strcat(str_joined, svg[i].xy);\n\n    }\n\n    fp_out = fopen(output,\"w+\"); //erase the content and write on it if exists or create the file and write on it\n    if (fp_out==NULL)\n    {\n        perror(\"Error\");\n    }\n    else\n    {\n        fprintf(fp_out, \"&lt;svg&gt;&lt;polyline points='%s'/&gt;&lt;/svg&gt;\" , str_joined);\n        printf(\"Operation successful.\\n\");\n    }\n\n\n    //printf(\"%s\\n\", str_joined);\n\n\n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 3820552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7fefcfa69bc646092b70d8ac55e6490?s=128&d=identicon&r=PG&f=1", "display_name": "Destroy", "link": "https://stackoverflow.com/users/3820552/destroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 31970854, "answer_count": 1, "score": 1, "last_activity_date": 1439397265, "creation_date": 1439389476, "last_edit_date": 1439393707, "question_id": 31968023, "link": "https://stackoverflow.com/questions/31968023/app-crashes-when-the-input-data-to-write-on-txt-is-bigger-than-16kb-c-programmi", "title": "App crashes when the input data to write on txt is bigger than 16kb (C programming)", "body": "<p>I'm trying to make a program which gets inputs from txt file (coordinates like x1,x2) and store it on element to write in SVG format. The code I wrote below works actually. The problem is when I get input bigger than 16kb, while writing on svg file application crashes. So I cannot find the problem actually. It should be about \"strcat(str_joined, svg[i].xy);\" this since I'm joining so much string into one string variable.</p>\n\n<p>Input Example : </p>\n\n<pre><code>339, 52\n339, 52\n339, 52\n338, 53\n338, 53\n337, 54\n337, 54\n337, 54\n337, 55\n337, 55\n336, 56\n336, 56\n336, 56\n336, 57\n335, 57\n335, 56\n334, 56\n334, 56\n333, 56\n332, 56\n332, 56\n331, 56\n331, 56\n330, 56\n330, 56\n329, 56\n</code></pre>\n\n<p>Output Example : <code>&lt;svg&gt;&lt;polyline points='339,52 339,52 339,52 338,53 338,53 337,54 '/&gt;&lt;/svg&gt;</code></p>\n\n<p>And Code : I just put the generate_svg part of the code.</p>\n\n<pre><code>void generate_svg(char *input, char *output)\n{         \n    //INPUT OPERAT\u0130ONS //\n\nFILE *fp;\nint array_size = 0, i=0, max_lines = 0;  // Line counters\nchar c;  // To store a character read from file to check whether newline or not\nchar *str_joined = NULL;\n\n// Open the file\nfp = fopen(input, \"r\");\n\n//Count the number of lines for the array size \nfor (c = getc(fp); c != EOF; c = getc(fp))\n    if (c == '\\n') \n        array_size = array_size + 1;\nfclose(fp);\n\n\n// read the file into an array of coordinates\nCoord *coord = malloc(array_size * sizeof *coord); //preallocation for performance\nfp = fopen(input, \"r\");\nwhile(!feof(fp))\n{\n   //check whether input getting correctly             \n   if(fscanf(fp, \"%d, %d\", &amp;coord[i].x, &amp;coord[i].y)==2)      \n      i++;           \n}\nfclose(fp);\n\n//OUTPUT OPERATIONS\nmax_lines = i;\nSVG *svg = malloc(array_size * sizeof *svg); // allocate memory\nsize_t total_length=0, length=0; //total length and length of string\nfor(i=0; i&lt;max_lines; i++)\n{\n    sprintf(svg[i].xy , \"%d,%d \", coord[i].x, coord[i].y);\n    total_length += strlen(svg[i].xy); \n    //printf(\"%s\\n\", svg[i].xy);\n}\n\nstr_joined = (char*)malloc(total_length * sizeof *str_joined); // allocate memory for joined strings\nstr_joined[0] = '\\0'; // empty string we can append to\n\nfor(i=0; i&lt;max_lines; i++)\n{\n         strcat(str_joined, svg[i].xy);\n         length = strlen(str_joined);\n\n         str_joined[length+1] = '\\0';           /* followed by terminator */\n\n}\n\nFILE *fp_out;\nfp_out = fopen(output,\"w+\"); //erase the content and write on it if exists or create the file and write on it\n\nif(fp_out == NULL)\n{\n  printf(\"Error\");           \n}\nelse\n{\n  fprintf(fp_out, \"&lt;svg&gt;&lt;polyline points='%s'/&gt;&lt;/svg&gt;\" , str_joined);\n\n   printf(\"Operation successful.\\n\");\n}\n//printf(\"%s\\n\", str_joined);\n</code></pre>\n\n<p>}</p>\n\n<p>So any help will be appreciated. Thanks in advance.</p>\n\n<p>//UPDATE</p>\n\n<p>Header: </p>\n\n<pre><code>//definitions\n#define MAX_FILE_NAME 100\n#define OUTPUT_FILE_NAME \"svg_output.svg\"\n\nvoid generate_svg(char *input, char *output);\n//storage for coordinates\ntypedef struct Coord\n{\n    int x;\n    int y;\n}Coord;\n\ntypedef struct SVG\n{\n  char xy[20];        \n\n}SVG;\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/yP1IR.jpg\" rel=\"nofollow\">So application crash image :</a></p>\n"}, {"tags": ["c", "udp", "payload"], "comments": [{"owner": {"reputation": 2255, "user_id": 5200357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b47b82126f1028d2db47358b696764f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua K", "link": "https://stackoverflow.com/users/5200357/joshua-k"}, "edited": false, "score": 1, "creation_date": 1439389718, "post_id": 31967938, "comment_id": 51843322, "body": "same way as usual.. define struct for ipv4 header, ipv6 header, udp header. now use this structs to &quot;parse&quot; your data and get the information you want... at which point are you struggling?"}, {"owner": {"reputation": 108, "user_id": 3432594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WQj9D.jpg?s=128&g=1", "display_name": "axellink", "link": "https://stackoverflow.com/users/3432594/axellink"}, "edited": false, "score": 0, "creation_date": 1439389924, "post_id": 31967938, "comment_id": 51843483, "body": "<a href=\"http://www.binarytides.com/packet-sniffer-code-c-linux/\" rel=\"nofollow noreferrer\">packet sniffer in C</a> see how he uses struct and pointer"}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439390542, "post_id": 31967938, "comment_id": 51844021, "body": "Since this is a Sflow data, I have to capture specific informations. in sflow documentation which I referred, the url is this : sflow.org/sflow_version_5.txt . It defines struct for each of them I mentioned in my question.  what I thought was I can define these structs in my code and use memcpy to fetch the information from buffer. But to specify the location of these, I need to find the octet value for these. that&#39;s the place where I am confused."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1439399803, "post_id": 31967938, "comment_id": 51850051, "body": "How exactly did you capture this packet?  More specifically, can you show the code you used to open the socket and read the data?"}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1439401229, "post_id": 31967938, "comment_id": 51850861, "body": "@dbush I have attached my code in the question."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439403360, "post_id": 31972292, "comment_id": 51852012, "body": "I was told not to make use of packet capture library like libpcap by my supervisor. Also the packet what I am receiving is a UDP packet. In that case SOCK_DGRAM is the right sock type isn&#39;t ?? is there any other way of mentioning the sock type ?"}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439403525, "post_id": 31972292, "comment_id": 51852117, "body": "As you said, if the Ethernet, IP and UDP headers are removed  and only data payload is stored in the buffer, then will the buffer does not contain any information on IP address, port etc which are seen in headers.?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439403622, "post_id": 31972292, "comment_id": 51852174, "body": "@userknown Yes <code>SOCK_DGRAM</code> is the correct socket type.  Since you can&#39;t use a packet capture library, the buffer you get back from <code>recvfrom</code> contains only the sflow data, and nothing from the upper layer headers.  All you get from this is the socket info returned in the fifth parameter to <code>recvfrom</code>."}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439406159, "post_id": 31972292, "comment_id": 51853568, "body": "The payload which I mentioned above contains IP addresses and other informations..How can I print them from the payload mentioned above. is use of memcpy a wise idea to use ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439426659, "post_id": 31972292, "comment_id": 51861475, "body": "@userknown See my edit.  Let me know if you have any other questions."}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439464486, "post_id": 31972292, "comment_id": 51877859, "body": "I am trying to use structs relevant for the parameters I need to pick from the payload, but they are showing many errors."}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439464806, "post_id": 31972292, "comment_id": 51878061, "body": "udps.c:131: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected udps.c:147: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected udps.c:163: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected udps.c:173: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected"}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439465206, "post_id": 31972292, "comment_id": 51878326, "body": "udps.c:45: error: expected specifier-qualifier-list before \u2018header_protocol\u2019 udps.c:58: error: expected specifier-qualifier-list before \u2018ip_v4\u2019 udps.c:69: error: two or more data types in declaration specifiers udps.c:74: error: expected specifier-qualifier-list before \u2018ip_v6\u2019 udps.c:87: error: two or more data types in declaration specifiers udps.c:93: error: two or more data types in declaration specifiers udps.c:93: error: two or more data types in declaration specifiers udps.c:93: error: expected \u2018)\u2019 before \u2018type\u2019 udps.c:115: error: two or more data types in declaration specifiers"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439467642, "post_id": 31972292, "comment_id": 51880025, "body": "The errors you listed do not appear when your code is compiled.  Please update your question with the code you are actually trying to use, along with the errors you get when building it."}, {"owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "edited": false, "score": 0, "creation_date": 1439470437, "post_id": 31972292, "comment_id": 51881986, "body": "I have updated the code with the structs I am using and also pasted my error log in the question."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1439567693, "last_edit_date": 1495535201, "creation_date": 1439402447, "answer_id": 31972292, "question_id": 31967938, "link": "https://stackoverflow.com/questions/31967938/finding-octet-in-a-udp-data-payload-in-c-program/31972292#31972292", "title": "Finding Octet in a UDP data payload in C program", "body": "<p>When use create a socket of type AF_INET / SOCK_DGRAM, the operating system processes the Ethernet, IP, and UDP headers and strips them off before passing them to you.  What you see in buffer is what immediately follows the UDP header.</p>\n\n<p>The fifth parameter to <code>recvfrom</code> gives you the source IP and source port of the incoming packet.  If you want to see more than just that you need to use a packet capture library like libpcap.</p>\n\n<p>Edit:</p>\n\n<p>It seems that this data packet contains IP addresses as part of sflow data.  You were trying to parse it as if it was a raw Ethernet frame.  What you instead need to do is look at the sflow datagram definition and use that to figure out how the packet is laid out and parse accordingly.  You don't need to use <code>memcpy</code> to do that, just use pointers to the relevant structs to point to the proper place in the buffer.  This is the same basic technique you were using before, just with a different set of structs.</p>\n\n<p>Edit 2:</p>\n\n<p>It looks like we're way off on what the data looks like.  I took the bytes from the packet listed above, read them into a buffer and sent it out in a UDP packet.  I fired up Wireshark, which gave us this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yYfZX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yYfZX.png\" alt=\"Wireshark capture\"></a></p>\n\n<p>So the packet contains:</p>\n\n<ul>\n<li>The sflow version, 32-bit (5)</li>\n<li>an 32 bit int (value=1)</li>\n<li>a <code>struct sample_datagram_v5</code></li>\n<li>the number of samples (32-bit int, value=6)</li>\n<li>six samples</li>\n</ul>\n\n<p>The first sample contains:</p>\n\n<ul>\n<li>The sample type as a <code>data_format</code>  (in this case a flow sample)</li>\n<li>a <code>struct flow_sample</code></li>\n<li>the number of flow samples (32-bit int, value=2)</li>\n</ul>\n\n<p>The first flow in the first sample:</p>\n\n<ul>\n<li>The flow type as a <code>data_format</code> (int this case a raw packet sample, so...)</li>\n<li>the flow data length (32-bit int, value=144)</li>\n<li>a <code>struct sampled_header</code></li>\n<li>4 bytes that are skipped as per the value of <code>sampled_header.stripped</code></li>\n<li>ethernet header</li>\n<li>IP header (payload=TCP)</li>\n<li>TCP header (port=80)</li>\n<li>data bytes (62)</li>\n</ul>\n\n<p>The second flow in the first sample:</p>\n\n<ul>\n<li>The flow type as a <code>data_format</code> (int this case extended switch data)</li>\n<li>the flow data length (32-bit int, value=16)</li>\n<li>a <code>struct extended_switch</code></li>\n</ul>\n\n<p>Then five more samples.  In this case, all the samples contain a raw packet header and extended switch data.</p>\n\n<p>So this should give you a better idea of what you need to do.  Since each data packet will be different, you'll need to figure our how many samples you have.  Then for each sample, you'll need to figure out the type, and based on that figure out how to parse the individual flows.</p>\n\n<p>If you need more examples I'd strongly suggest using Wireshark to capture these sflow packets so you can see exactly what's in them to validate that your parser works for all expected input.</p>\n\n<p>Related question for reference:  <a href=\"https://stackoverflow.com/questions/31995486/use-of-memcpy-to-store-data-from-buffer-into-struct/32011201\">use of memcpy to store data from buffer into struct</a></p>\n"}], "owner": {"reputation": 31, "user_id": 5219684, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28add534dca4b0a380dc244e5adaa4a3?s=128&d=identicon&r=PG&f=1", "display_name": "user known", "link": "https://stackoverflow.com/users/5219684/user-known"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 822, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1439567693, "creation_date": 1439389256, "last_edit_date": 1439470102, "question_id": 31967938, "link": "https://stackoverflow.com/questions/31967938/finding-octet-in-a-udp-data-payload-in-c-program", "title": "Finding Octet in a UDP data payload in C program", "body": "<p>I am trying to collect UDP data payload information using C program by capturing the packet from port 6343. The code I am using is as follows:</p>\n\n<pre><code>#include&lt;stdio.h&gt;             //For standard things\n#include&lt;stdlib.h&gt;            //malloc\n#include&lt;string.h&gt;            //memset\n#include&lt;netinet/ip_icmp.h&gt;   //Provides declarations for icmp header\n#include&lt;netinet/udp.h&gt;       //Provides declarations for udp header\n#include&lt;netinet/tcp.h&gt;       //Provides declarations for tcp header\n#include&lt;netinet/ip.h&gt;        //Provides declarations for ip header\n#include&lt;sys/socket.h&gt;\n#include&lt;arpa/inet.h&gt;\n#include&lt;net/ethernet.h&gt;\n#include&lt;netinet/if_ether.h&gt;\n#define PORT 6343             // define the port to connect\n#define ETH_P_IP 0x0800\n\nvoid ProcessPacket(unsigned char*, int);\nvoid print_ethernet_header(unsigned char*, int);\nvoid print_ip_header(unsigned char* , int);\nvoid print_udp_packet(unsigned char*, int);\nvoid Dataint (unsigned char* , int);\nvoid print(const int *, const int);\nint sockt;\nint i,j;\nstruct sockaddr_in source,dest; \n\nconst MAX_HEADER_SIZE = 256;   /* The maximum sampled header size. */\n\nstruct sampled_header {\nheader_protocol protocol;       /* Format of sampled header */\nunsigned int frame_length;      /* Original length of packet before\n                                  sampling */\nopaque header{MAX_HEADER_SIZE}; /* Header bytes */\n}\n\n/* Packet IP version 4 data */\n\nstruct sampled_ipv4 {\nunsigned int length;     /* The length of the IP packet excluding\n                           lower layer encapsulations */\nunsigned int protocol;   /* IP Protocol type\n                           (for example, TCP = 6, UDP = 17) */\nip_v4 src_ip;            /* Source IP Address */\nip_v4 dst_ip;            /* Destination IP Address */\nunsigned int src_port;   /* TCP/UDP source port number or\n                           equivalent */\nunsigned int dst_port;   /* TCP/UDP destination port number or\n                           equivalent */\nunsigned int tcp_flags;  /* TCP flags */\nunsigned int tos;        /* IP type of service */\n}\n/* Packet IP version 6 data */\n\nstruct sampled_ipv6 {\nunsigned int length;     /* The length of the IP packet excluding\n                           lower layer encapsulations */\nunsigned int protocol;   /* IP next header\n                           (for example, TCP = 6, UDP = 17) */\nip_v6 src_ip;            /* Source IP Address */\nip_v6 dst_ip;            /* Destination IP Address */\nunsigned int src_port;   /* TCP/UDP source port number or\n                           equivalent */\nunsigned int dst_port;   /* TCP/UDP destination port number or\n                           equivalent */\nunsigned int tcp_flags;  /* TCP flags */\nunsigned int priority;   /* IP priority */\n}\n\nstruct extended_switch {\nunsigned int src_vlan;     /* The 802.1Q VLAN id of incoming frame */\nunsigned int src_priority; /* The 802.1p priority of incoming\n                             frame */\nunsigned int dst_vlan;     /* The 802.1Q VLAN id of outgoing frame */\nunsigned int dst_priority; /* The 802.1p priority of outgoing\n                             frame */\n}\n\n int main()\n {\n\nint saddr_size,data_size, datasize; \nstruct sockaddr_in saddr;\nstruct sockaddr_in daddr;\nstruct in_addr addr;\nint protocol=17;\nunsigned char* buffer = (unsigned char *)malloc(65535); // Its Big ! Malloc allocates a block of size bytes of memory,returning a pointer to the begining of the block\n\n//Create a socket\n\nsockt = socket(AF_INET ,SOCK_DGRAM ,IPPROTO_UDP);\nif(sockt &lt; 0)\n{\n    printf(\"Socket Error\\n\");\n    return 1;\n}\nmemset((char *)&amp;daddr,0,sizeof(daddr));\n\n//prepare the sockaddr_in structure\nsaddr.sin_family = AF_INET;\ndaddr.sin_family = AF_INET;\ndaddr.sin_addr.s_addr = htonl(INADDR_ANY);\ndaddr.sin_port = htons(PORT);\nsaddr.sin_port = htons(PORT);\n//Bind the socket\n\nif(bind(sockt,(struct sockaddr *)&amp;daddr, sizeof(daddr))&lt;0)\n{\n  printf(\"bind failed\");\n  return 1;\n}\nprintf(\"bind done\");\n\nwhile(1)\n{\nsaddr_size = sizeof saddr;\nprintf(\" waiting for data...\\n\");\n\n//Receive a packet\n\ndatasize = recvfrom(sockt , buffer ,65535 , 0 , (struct sockaddr*) &amp;saddr , (socklen_t*)&amp;saddr_size);\ndata_size = recvfrom(sockt , buffer ,65535 , 0 , NULL , NULL);\nif(data_size &lt;0)\n{\n  printf(\"Packets not recieved \\n\");\n  return 1;\n}\nprintf(\"Packets arrived from %d \\n\",ntohs(daddr.sin_port));\nprintf(\"packet recieved : %lu bytes\\n\", datasize);\n\nProcessPacket(buffer , data_size);\n\n}\nclose(sockt);\nprintf(\"Finished\");\nreturn 0;\n}\n\n\nvoid ProcessPacket(unsigned char* buffer, int len)\n{\n  print_udp_packet(buffer , len);\n\n}\n\nvoid print_ethernet_header(unsigned char* buffer, int len)\n{\n  struct ethhdr *eth = (struct ethhdr *)buffer;\n  printf(\"Ethernet Header\\n\");\n  printf(\"---------------------------------------\\n\");\n  printf(\"Ethernet Header Length   : %u bytes \\n\",sizeof(eth));\n  printf(\"Destination MAC : %.2X-%.2X-%.2X-%.2X-%.2X-%.2X \\n\", eth-&gt;h_dest[0] , eth-&gt;h_dest[1] , eth-&gt;h_dest[2] , eth-&gt;h_dest[3] , eth-&gt;h_dest[4] , eth-&gt;h_dest[5] );\n  printf(\"Source MAC      : %.2X-%.2X-%.2X-%.2X-%.2X-%.2X \\n\", eth-&gt;h_source[0] , eth-&gt;h_source[1] , eth-&gt;h_source[2] , eth-&gt;h_source[3] , eth-&gt;h_source[4] , eth-&gt;h_source[5] );\n  printf(\"Ethernet Type   : %u \\n\",eth-&gt;h_proto);\n  printf(\"---------------------------------------\\n\");\n  }\n\n  void print_ip_header(unsigned char* buffer, int len)\n  {\n  //print_ethernet_header(buffer , len);\n\n  struct iphdr *iph = (struct iphdr *)(buffer + sizeof(struct ethhdr));\n  unsigned short iphdrlen = iph-&gt;ihl*4;\n\n  memset(&amp;source,0,sizeof(source));\n  source.sin_addr.s_addr = iph -&gt;saddr;\n  memset(&amp;dest,0,sizeof(dest));\n  dest.sin_addr.s_addr = iph-&gt;daddr;\n\n  printf(\"IP Header\\n\");\n  printf(\"---------------------------------------\\n\");\n  printf(\"IP Length        : %d\\n\", ntohs(iph-&gt;tot_len));\n  printf(\"Source IP        : %s\\n\",inet_ntoa(source.sin_addr));\n  printf(\"Destination IP   : %s\\n\",inet_ntoa(dest.sin_addr));\n  printf(\"Protocol         : %d\\n\", iph-&gt;protocol);\n  printf(\"Type Of Service  : %d\\n\",htons(iph-&gt;tos));\n  printf(\"---------------------------------------\\n\");\n  }\n\n\n  void print_udp_packet(unsigned char* buffer , int len)\n  {\n  struct sockaddr_in saddr;\n  struct sockaddr_in daddr;\n  unsigned short iphdrlen;\n  unsigned char* payload = (unsigned char *)malloc(1024);\n  struct iphdr *iph = (struct iphdr *)(buffer+ sizeof(struct ethhdr));\n  iphdrlen = iph-&gt;ihl*4;\n\n   struct udphdr *udph = (struct udphdr*)(buffer + sizeof(struct iphdr)+sizeof(struct ethhdr));\n\n   int header_size =  sizeof(struct ethhdr) + iphdrlen + sizeof udph;\n\n   print_ip_header(buffer,len);\n\n   printf(\"UDP Header\\n\");\n   printf(\"---------------------------------------\\n\");\n   printf(\"UDP Length       : %d\\n\", ntohs(udph-&gt;len));\n   //printf(\"UDP Length       : %d\\n\", ntohs(sizeof (struct udphdr))); \n   printf(\"Source Port      : %d\\n \",ntohs(udph-&gt;source));\n   printf(\"Destination Port : %d\\n \",ntohs(udph-&gt;dest));\n   printf(\"Source Port      : %d\\n \",ntohs(saddr.sin_port));\n   printf(\"Destination Port : %d\\n \",ntohs(daddr.sin_port)); \n   printf(\"---------------------------------------\\n\");\n\n   printf(\"Data Payload\\n\");  \n   //PrintData(buffer + header_size , len - header_size);\n   Dataint(buffer ,len);\n   printf(\"--------------------------------------------\\n\"); \n\n\n   }\n\n  void Dataint (unsigned char* buffer , int len)\n  {\n\n  int i,j;\n  i=0;\n  for(i=0 ; i &lt;= len ; i++)\n  {\n    if( i!=0 &amp;&amp; i%16==0)   // prints every hex line with a space\n    {\n        printf(\"  \");\n    } \n\n     // prints entire data in integer\n      if(i%16==0) \n        printf(\"   \");                           // prints the first element of hex line                      \n        printf(\" %d\",(unsigned int)buffer[i]);  \n\n    //print the last spaces         \n    if( i==len-1)  \n    {\n        for(j=0;j&lt;16-i%16;j++) \n        printf(\"   \");\n\n    }\n   }\n  } \n</code></pre>\n\n<p>I have the payload converted to integer form as shown below: </p>\n\n<pre><code>0 0 0 5 0 0 0 1 147 188 192 6 0 0 0 0      0 50 170 143 37 107 3 154 0 0 0 6 0 0 0 1      0 0 0 208 1 30 136 36 0 0 0 29 0 0 1 0      236 205 212 188 0 22 44 215 0 0 0 29 0 0 0 40      0 0 0 2 0 0 0 1 0 0 0 144 0 0 0 1      0 0 5 238 0 0 0 4 0 0 0 128 240 146 28 72      194 0 0 14 12 48 199 199 8 0 69 0 5 220 65 28      64 0 47 6 24 125 193 104 215 69 147 188 192 24 0 80      142 152 237 55 211 205 114 104 162 142 128 16 0 54 188 178      0 0 1 1 8 10 139 71 198 30 37 2 188 177 205 144      135 164 154 194 155 33 30 238 48 113 112 179 62 180 223 221      169 24 234 48 163 41 188 139 148 98 130 255 16 229 123 58      202 165 56 101 14 217 132 108 10 156 47 29 77 156 220 141      202 248 196 75 240 252 232 27 19 140 52 187 0 0 3 233      0 0 0 16 0 0 0 3 0 0 0 2 0 0 0 2      255 255 255 255 0 0 0 1 0 0 0 208 1 30 136 37      0 0 0 29 0 0 1 0 236 205 214 47 0 22 44 215      0 0 0 29 0 0 0 40 0 0 0 2 0 0 0 1      0 0 0 144 0 0 0 1 0 0 5 238 0 0 0 4      0 0 0 128 240 146 28 72 194 0 0 14 12 48 199 199      8 0 69 0 5 220 65 243 64 0 47 6 23 166 193 104      215 69 147 188 192 24 0 80 142 152 237 60 147 229 114 104      162 142 128 16 0 54 13 151 0 0 1 1 8 10 139 71      198 66 37 2 188 213 16 243 209 241 120 208 124 252 85 108      101 62 10 255 21 98 62 58 136 127 106 62 238 76 85 231      227 224 70 62 31 217 151 211 47 106 246 111 160 87 164 114      43 83 45 230 197 131 18 49 110 159 251 162 207 148 178 31      212 40 81 190 0 0 3 233 0 0 0 16 0 0 0 3      0 0 0 2 0 0 0 2 255 255 255 255 0 0 0 1      0 0 0 148 1 30 136 38 0 0 0 29 0 0 1 0      236 205 214 158 0 22 44 215 0 0 0 0 0 0 0 29      0 0 0 2 0 0 0 1 0 0 0 84 0 0 0 1      0 0 0 70 0 0 0 4 0 0 0 68 0 14 12 48      199 199 240 146 28 72 194 0 8 0 69 0 0 52 28 175      64 0 63 6 50 146 147 188 192 24 193 104 215 69 142 152      0 80 114 104 162 142 237 62 109 231 128 16 36 63 51 129      0 0 1 1 8 10 37 2 188 231 139 71 198 66 0 0      0 0 3 233 0 0 0 16 255 255 255 255 0 0 0 0      0 0 0 3 255 255 255 255 0 0 0 1 0 0 0 208      1 30 136 39 0 0 0 29 0 0 1 0 236 205 215 173      0 22 44 215 0 0 0 29 0 0 0 40 0 0 0 2      0 0 0 1 0 0 0 144 0 0 0 1 0 0 5 238      0 0 0 4 0 0 0 128 240 146 28 72 194 0 0 14      12 48 199 199 8 0 69 0 5 220 67 10 64 0 47 6      22 143 193 104 215 69 147 188 192 24 0 80 142 152 237 66      188 223 114 104 162 142 128 16 0 54 185 33 0 0 1 1      8 10 139 71 198 102 37 2 188 248 226 4 177 86 140 52      15 181 49 144 230 162 19 81 72 179 190 46 196 123 24 85      38 153 175 213 96 59 3 73 194 138 211 35 187 143 148 46      200 190 255 249 6 223 220 57 180 2 123 223 184 204 149 28      127 218 240 134 94 247 236 103 0 0 3 233 0 0 0 16      0 0 0 3 0 0 0 2 0 0 0 2 255 255 255 255      0 0 0 1 0 0 0 208 1 30 136 40 0 0 0 29      0 0 1 0 236 205 216 48 0 22 44 215 0 0 0 29      0 0 0 40 0 0 0 2 0 0 0 1 0 0 0 144      0 0 0 1 0 0 5 238 0 0 0 4 0 0 0 128      240 146 28 72 194 0 0 14 12 48 199 199 8 0 69 0      5 220 67 144 64 0 47 6 22 9 193 104 215 69 147 188      192 24 0 80 142 152 237 69 173 223 114 104 162 142 128 16      0 54 47 172 0 0 1 1 8 10 139 71 198 102 37 2      188 249 253 49 241 16 12 100 96 130 25 195 170 251 218 202      149 6 45 216 81 206 145 254 7 147 240 20 103 185 112 138      115 50 158 226 156 204 78 113 98 240 114 65 240 51 253 252      102 174 242 80 12 50 241 179 148 204 90 200 196 66 118 137      0 0 3 233 0 0 0 16 0 0 0 3 0 0 0 2      0 0 0 2 255 255 255 255 0 0 0 1 0 0 0 148      1 30 136 41 0 0 0 29 0 0 1 0 236 205 217 14      0 22 44 215 0 0 0 29 0 0 0 25 0 0 0 2      0 0 0 1 0 0 0 84 0 0 0 1 0 0 0 70      0 0 0 4 0 0 0 68 240 146 28 72 194 0 0 14      12 48 199 199 8 0 69 0 0 52 174 239 0 0 48 6      219 72 216 58 210 78 147 188 194 70 1 187 179 154 222 83      63 174 28 240 175 235 128 16 5 91 120 31 0 0 1 1      8 10 94 165 224 71 49 84 232 65 0 0 0 0 3 233      0 0 0 16 0 0 0 3 0 0 0 2 0 0 0 14      255 255 255 255 \n</code></pre>\n\n<p>This is a sflow data collected from a core switch.So I have to find the Ethernet, IPv4, IPv6,extended switch data from this payload and print them. Before that I need to find the octet position of each of these in the payload. can you advise me how should I find the octet position of each of them ?</p>\n\n<p>Errors while using the structs in above code:                            </p>\n\n<pre><code>     udps.c:25: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018ip_v4\u2019\nudps.c:26: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018ip_v6\u2019\nudps.c:33: error: two or more data types in declaration specifiers\nudps.c:33: error: expected \u2018)\u2019 before \u2018type\u2019\nudps.c:45: error: expected specifier-qualifier-list before \u2018header_protocol\u2019\nudps.c:58: error: expected specifier-qualifier-list before \u2018ip_v4\u2019\nudps.c:69: error: two or more data types in declaration specifiers\nudps.c:74: error: expected specifier-qualifier-list before \u2018ip_v6\u2019\nudps.c:87: error: two or more data types in declaration specifiers\nudps.c:93: error: two or more data types in declaration specifiers\nudps.c:93: error: two or more data types in declaration specifiers\nudps.c:93: error: expected \u2018)\u2019 before \u2018type\u2019\nudps.c:115: error: two or more data types in declaration specifiers\nudps.c: In function \u2018main\u2019:\nudps.c:131: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected\nudps.c:147: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected\nudps.c:163: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected\nudps.c:173: error: incompatible types when returning type \u2018int\u2019 but \u2018struct extended_switch\u2019 was expected\n</code></pre>\n"}, {"tags": ["c", "casting", "undefined-behavior"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439388259, "post_id": 31967370, "comment_id": 51842078, "body": "As long as <code>INT_MAX</code> is greater than <code>UINT16_MAX</code> (true on most 32- or 64-bit platforms) there will not be any undefined behavior, since arithmetic is done on the promoted type."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439388675, "post_id": 31967370, "comment_id": 51842441, "body": "@Quentin: But if <code>INT_MAX</code> is greater than <code>INT16_MAX</code>, the operands will be promoted."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439388883, "post_id": 31967370, "comment_id": 51842624, "body": "@EOF And I answered a question about that two days ago. Shame :&lt;"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1439389132, "post_id": 31967370, "comment_id": 51842838, "body": "If you can spare the bytes, use <code>uint64_t</code>, don&#39;t worry about wraparound, and hope to live long enough to witness your protocol wrapping around.  By a quick estimate, I think it&#39;d take over 500 years for 1 kB packets sent at 1 gB/sec to wrap using a 64-bit counter."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1439418493, "post_id": 31967370, "comment_id": 51859378, "body": "Some communications devices have very limited payloads.  A lot of cheap 2.4GHz radios, for example, limit packets to less than 40 bytes total including preamble, address, and CRC.  Adding an extra six bytes of sequence number could reduce useful payload by more than 20%."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1439388607, "post_id": 31967554, "comment_id": 51842378, "body": "C11 draft standard: <code>7.20.1.1 Exact-width integer types 1 The typedef name intN_t designates a signed integer type with width N , no padding bits, and a two\u2019s complement representation. Thus, int8_t denotes such a signed integer type with a width of exactly 8 bits.[...]</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1439388661, "post_id": 31967554, "comment_id": 51842431, "body": "<code>current - last</code> can never be undefined"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439388681, "post_id": 31967554, "comment_id": 51842446, "body": "@EOF: realised that, edited out my waffle, invalidated your comment, but could still be wrong about 16 bit int"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1439388757, "post_id": 31967554, "comment_id": 51842512, "body": "@MattMcNabb: what happens for 16 bit int? Is it promoted to a bigger type?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1439388788, "post_id": 31967554, "comment_id": 51842534, "body": "@Bathsheba there is no promotion if <code>int</code> is 16-bit, because <code>uint16_t</code> does not have a range that is a subset of <code>int</code>&#39;s range"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1439388873, "post_id": 31967554, "comment_id": 51842616, "body": "So the result for current &gt; last will be wrapped around? But then you get UB since you could be casting a large positive to a signed type? Do I need to go back to C school?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1439389042, "post_id": 31967554, "comment_id": 51842759, "body": "@Bathsheba: C11.. oh, you know by now <code>6.3.1.3 Signed and unsigned integers 3 Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an implementation-defined signal is raised.</code>"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439419152, "post_id": 31967554, "comment_id": 51859607, "body": "@EOF: Is there anything in the Standard that would mandate that a conversion from larger types to <code>int16_t</code> couldn&#39;t peg values below -32768 or above 32767 to either -32768 or 32767, respectively?  Some hardware includes instructions that work like that, and while I wouldn&#39;t want a compiler to work that way as a default, such behavior (if available as an option) might on occasion be useful."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439419448, "post_id": 31967554, "comment_id": 51859708, "body": "@supercat: You mean saturation? Sure, that&#39;s a valid implementation-defined behavior for narrowing to a signed integer type. It&#39;s not so popular though, because narrowing to an <i>unsigned</i> integer type is defined as &quot;repeatedly adding or subtracting one more than the maximum representable number&quot;, which is truncation for 2&#39;s complement. It&#39;s easy and conformant to do just do exactly the same for signed integers."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439419770, "post_id": 31967554, "comment_id": 51859798, "body": "@EOF: Is there any concise means by which code can test whether an implementation performs all narrowing conversions via two&#39;s-complement mod reduction?  For that matter, is there a requirement that an implementation where an out-of-range cast would raise a signal at runtime must do anything in particular if an out-of-range cast is performed in a compile-time constant?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439420170, "post_id": 31967554, "comment_id": 51859896, "body": "@supercat: Uh, I don&#39;t know. AFAIK, an implementation can do pretty much anything it wants, as long as it documents exactly what it does. I try to stick to sane environments, which means 2&#39;s complement/truncation, no integer trap representations, no padding bits in integer types, ieee754 floats/doubles, the works. You know, the stuff computers today <i>actually</i> do?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439445702, "post_id": 31967554, "comment_id": 51866620, "body": "@EOF: Until recently, I would have thought that any sane 32-bit environment could be relied upon to evaluate <code>x&lt;&lt;32</code> as either yielding <code>x</code> or <code>0</code> (arbitrarily chosen) unless it was configured for pedantic mode, in which case it might trap in controlled fashion.  I would not have thought that any sane platform would interpret it as negating laws of time and causality (well, actually I still don&#39;t think any <i>sane</i> platform would do that).  If the intention of the Standard is that compilers should do things a certain way absent a good reason not to, it should say that.  Otherwise..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439446046, "post_id": 31967554, "comment_id": 51866769, "body": "...it could quite reasonably be argued that because the Standard doesn&#39;t require implementations to implement signed down-sizing coercion in a genuinely useful fashion, the requirement that it be done in a consistent fashion is a useless impediment to optimization, and since implementations are free to define behaviors in cases where the Standard does not, there&#39;s really no reason it shouldn&#39;t be UB.  Indeed, if there were a recognized category of UB where compilers have historically demonstrated a narrow range of behaviors, and compilers were strongly encouraged to abide by tradition..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439446821, "post_id": 31967554, "comment_id": 51867115, "body": "...absent a compelling reason to do otherwise, I would argue that certain narrowing conversions by assignment (as opposed to a casting) should be interpreted in the fashion that compilers have <i>traditionally</i> regarded overflow [yielding a partially-indeterminate value which may arbitrarily behave in wrapping or non-wrapping fashion, with no requirement of consistency].  Of course, if compiler writers convince the committee to make it UB, I see no reason to trust that they&#39;d continue to abide by laws of time and causality."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439449300, "post_id": 31967554, "comment_id": 51868458, "body": "@supercat: What? I have no idea where you are going with this, but to clarify a few points: 1. narrowing conversion to an <i>unsigned</i> type is precisely defined. 2. narrowing conversion to a <i>signed</i> type is <i>implementation-defined</i> 3. shift of greater or equal the bit-width of the type is <i>undefined</i>. Why are you even bringing that up? There is absolutely <i>no</i> reason to make narrowing conversion undefined. It&#39;d be insane."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439484724, "post_id": 31967554, "comment_id": 51892432, "body": "@EOF: The present Standard offers no way of indicating &quot;I need something that needs to fit in two bytes and hold values -2147483648 to 2147483647, but I don&#39;t care whether the compiler mod-wraps values outside that range&quot;.  Given that the Standard-imposed requirement for mod-wrapping impairs efficient code generation <i>even in cases where it offers no benefit to applications</i>, and given the attitude shown in the Committee&#39;s response in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_451.htm\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/dr_451.htm</a> (Defect Report 451), it would hardly seem implausible that the Committee would decide to change that."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439492504, "post_id": 31967554, "comment_id": 51896699, "body": "@supercat: uh, unless <code>CHAR_BIT &gt;= 16</code>, your hypothetical type is impossible. Also, how exactly does &quot;mod-wrapping&quot; impair efficient code generation? Furthermore, I see no problem looking at the defect report. C11 draft std. <code>Annex J.2 Undefined behavior: The value of an object with automatic storage duration is used while it is indeterminate (6.2.4, 6.7.9, 6.8).</code>"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439493920, "post_id": 31967554, "comment_id": 51897499, "body": "@EOF: By my reading of the defect report, the Committee is saying that even in cases where the Standard <i>expressly</i> specifies that reading an uninitialized variable of type <code>unsigned char</code> yields an unspecified value of type <code>unsigned char</code>, members feel that compilers should feel free to regard almost any attempt to use that value as Undefined Behavior.  Am I not understanding that correctly?  As for my hypothetical type, I was wavering between saying 2 bytes and -32768/32767 or 4 bytes and +/-2bill and apparently left things inconsistent.  A lot of ARM code ends up inserting useless..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439494245, "post_id": 31967554, "comment_id": 51897651, "body": "...instructions to sign-extend 16-bit values held in 32-bit registers; while the DEC Alpha was ahead of its time in using 64-bit operations for all register operations (it still supported 32-bit loads and stores) it&#39;s hardly implausible that future 64-bit architectures will follow that lead.  My point was that there are a lot of times where code needs something which can hold values as large as e.g. <code>int16_t</code> can hold, and is no larger than that type, but where code doesn&#39;t care if the compiler uses a larger register to hold it and doesn&#39;t sign-extend it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439494589, "post_id": 31967554, "comment_id": 51897790, "body": "@supercat: <code>[u]int_fastN_t</code>, <code>[u]int_leastN_t</code>?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439497402, "post_id": 31967554, "comment_id": 51899200, "body": "@EOF: The semantics of &quot;fast&quot; and &quot;least&quot; types are simultaneously so poorly specified as to preclude their use in many arrays, structures, unions, or other such places where their storage format would matter, but too strictly specified to allow compilers to yield optimal code if some operations (e.g. addition) are faster on larger types and others (e.g. division) are faster on smaller ones.  Further, given <code>uint_fast16_t u; int32_t i;</code>, some compilers would regard <code>u+i</code> as signed, and some would regard it as unsigned; not exactly helpful semantics."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": -1, "last_activity_date": 1439448563, "last_edit_date": 1439448563, "creation_date": 1439388329, "answer_id": 31967554, "question_id": 31967370, "link": "https://stackoverflow.com/questions/31967370/is-detecting-unsigned-wraparound-via-cast-to-signed-undefined-behavior/31967554#31967554", "title": "Is detecting unsigned wraparound via cast to signed undefined behavior?", "body": "<p>The subtraction will take place using a promoted type unless <code>int</code> is 16 bit in which case the behaviour is implementation defined.</p>\n\n<p>To be on the safe side, you could compute the absolute difference using a ternary:</p>\n\n<p><code>current &gt; last ? current - last : last - current</code></p>\n"}, {"comments": [{"owner": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1439448758, "post_id": 31967680, "comment_id": 51868153, "body": "The trouble with your approach is that it requires the constant on the right-hand side to depend on the actual type of the unsigned variable. That&#39;s more annoying in a template and not always possible/practical in a macro."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1439580277, "post_id": 31967680, "comment_id": 51937058, "body": "On systems where <code>int</code> is 16 bits, <code>current-last</code> will be evaluated as <code>uint16_t</code>.  On systems where <code>int</code> is 17 bits or larger, not counting padding, <code>current-last</code> will be evaluated as (signed) <code>int</code>.  For addition and subtraction, the situation may generally be remedied by casting the sum or difference back to type <code>uint16_t</code>.  In the rare event that one wants to compute the 16 lower bits of the product of two 16-bit values which could exceed 46,340, one should first multiply one of the numbers by <code>1u</code>.  Given <code>uint16_t x=65533;</code>, the value of <code>(uint16_t)(1u*x*x)</code> will be 9, since..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1439581023, "post_id": 31967680, "comment_id": 51937393, "body": "...65533u*65533 == 4294574089u, and (uint16_t)4294574089u == 9, but an attempt to perform the computation as <code>(uint16_t)(x*x)</code> or <code>x*x</code> when x is 46341 or larger may cause some 32-bit compilers to throw all concepts of time and causality out the window.  As crazy as it might seem, some compiler writers figure that since the standard allows compilers to turn <code>if (x &lt; 65000) foo(x); x*=x;</code> into <code>foo(x); x*=x;</code>, and the latter is &quot;more efficient&quot;, they should try to make their compilers do just that.  If one wants <code>if (x &lt; 65000) foo(x); x*=x;</code> one must write it <code>if (x &lt; 65000) foo(x); x*=1u*x;</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439606251, "post_id": 31967680, "comment_id": 51944092, "body": "@supercat I&#39;m not sure what you are talking about. &quot;the situation may generally be remedied&quot;  - there&#39;s nothing that needs remedying.  There&#39;s no multiplication going on here"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1439658105, "post_id": 31967680, "comment_id": 51955745, "body": "@MattMcNabb: Arithmetic operators&#39; promotion of short unsigned operands to signed int will <i>usually</i> not affect behavior if the results are cast back to short unsigned values, but it&#39;s important that anyone relying upon such casts be aware of cases where unwanted promotions will not affect any defined behaviors but can result in Undefined Behavior."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 6, "last_activity_date": 1439449272, "last_edit_date": 1439449272, "creation_date": 1439388626, "answer_id": 31967680, "question_id": 31967370, "link": "https://stackoverflow.com/questions/31967370/is-detecting-unsigned-wraparound-via-cast-to-signed-undefined-behavior/31967680#31967680", "title": "Is detecting unsigned wraparound via cast to signed undefined behavior?", "body": "<p>The behaviour of out-of-range conversion is <em>implementation-defined</em>.</p>\n\n<p>Why don't you just avoid this issue entirely and write:</p>\n\n<pre><code>if ( current != last &amp;&amp; current - last &lt; 0x8000 )\n    printf(\"current is newer\\n\");\nelse\n    printf(\"current is older (or same)\\n\");\n</code></pre>\n\n<p>Note: This answer only applies to the specific question involving <code>uint16_t</code>. For other types, different code would be required.</p>\n"}, {"tags": [], "owner": {"reputation": 668, "user_id": 5010116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sIte7.jpg?s=128&g=1", "display_name": "Top Sekret", "link": "https://stackoverflow.com/users/5010116/top-sekret"}, "is_accepted": false, "score": 0, "last_activity_date": 1458820952, "last_edit_date": 1458820952, "creation_date": 1452008412, "answer_id": 34615546, "question_id": 31967370, "link": "https://stackoverflow.com/questions/31967370/is-detecting-unsigned-wraparound-via-cast-to-signed-undefined-behavior/34615546#34615546", "title": "Is detecting unsigned wraparound via cast to signed undefined behavior?", "body": "<p>You may cast <code>uint16_t</code>s to <code>int32_t</code>s and do the subtracting.</p>\n\n<pre><code>if (((int32_t) current - (int32_t) last) &gt; 0) {\n    printf(\"current is newer\\n\");\n} else {\n    printf(\"current is older (or same)\\n\");\n}\n</code></pre>\n\n<p>Note: when casting to <code>int16_t</code>, <code>uint16_t</code>s larger than 32767 will show up as negative (in signed integer most significant bit set to 1 means negative one, in unsigned types it's just a regular bit).</p>\n"}], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 2, "accepted_answer_id": 31967680, "answer_count": 3, "score": 12, "last_activity_date": 1458820952, "creation_date": 1439387888, "question_id": 31967370, "link": "https://stackoverflow.com/questions/31967370/is-detecting-unsigned-wraparound-via-cast-to-signed-undefined-behavior", "title": "Is detecting unsigned wraparound via cast to signed undefined behavior?", "body": "<p>I'm using a <code>uint16_t</code> as a sequence counter in a network protocol.  This counter commonly wraps around as expected.  When a receiver gets a packet it checks this counter against the most recently received to see whether it's a new packet or an out of order packet.</p>\n\n<p>Wraparound needs to be taken into account when comparing sequence numbers.  So if for example the last sequence number was <code>0x4000</code>, then a sequence number from <code>0x4001</code> to <code>0xBFFF</code> is newer, and a sequence number from <code>0xC000</code> to <code>0xFFFF</code> and from <code>0x0000</code> to <code>0x3FFF</code> is smaller.</p>\n\n<p>The way I'm currently doing this is as follows:</p>\n\n<pre><code>uint16_t last;\nuint16_t current;\n...\n// read in values for last and current\n...\nif ((int16_t)(current - last) &gt; 0) {\n    printf(\"current is newer\\n\");\n} else {\n    printf(\"current is older (or same)\\n\");\n}\n</code></pre>\n\n<p>By subtracting the two and treating the result as a <code>int16_t</code>, I can easily see which is greater and by how much.  So for example if the current sequence number is at least 5 less that the last, i.e <code>((int16_t)(current - last) &lt; -5)</code>, I can assume this is not due to normal packet reordering and drop the packet.</p>\n\n<p>I realize that signed wraparound is undefined, however in this case I'm treating an unsigned value as signed for the sake of doing comparisons.  Does this invoke undefined behavior, and if so what would be a better way to do this type of comparison?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1439387964, "post_id": 31967329, "comment_id": 51841858, "body": "<code>strtol()</code>? <code>sscanf()</code>? <i>Anything but the code you&#39;ve written?</i>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1439388070, "post_id": 31967329, "comment_id": 51841944, "body": "@SouravGhosh: No. <code>strtol()</code> needs no <code>strtok()</code>, since it can return the end of the current number in the <code>char **endptr</code>-argument."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1439388392, "post_id": 31967329, "comment_id": 51842187, "body": "<a href=\"http://stackoverflow.com/questions/7021725/converting-string-to-integer-c\">Has close resemblance to this one.</a>"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1439388475, "post_id": 31967329, "comment_id": 51842255, "body": "<code>while(strcmp(&amp;TEMPS[c], &quot;\\0&quot;) != 0)</code>  <code>while(TEMPS[c] != &#39;\\0&#39;)</code>"}, {"owner": {"reputation": 49, "user_id": 4015664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andy Nonomous", "link": "https://stackoverflow.com/users/4015664/andy-nonomous"}, "edited": false, "score": 2, "creation_date": 1439389128, "post_id": 31967329, "comment_id": 51842836, "body": "Thanks for the advice. No need to be hostile EOF, I&#39;m new and don&#39;t know what I&#39;m doing, that&#39;s why I stated at the beginning that my solution was ridiculous."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439389178, "post_id": 31967329, "comment_id": 51842873, "body": "@AndyNonomous: yeah, sorry if I&#39;m being a bit abrasive. The magic numbers in your code triggered me."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439396553, "post_id": 31967619, "comment_id": 51848200, "body": "Better to use <code>strtoul()</code> with &quot;unsigned long integer&quot; and <code>strtol()</code> with <code>long ret</code>."}], "tags": [], "owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "is_accepted": true, "score": 2, "last_activity_date": 1439388492, "creation_date": 1439388492, "answer_id": 31967619, "question_id": 31967329, "link": "https://stackoverflow.com/questions/31967329/parsing-a-string-into-an-array-of-integers-in-c/31967619#31967619", "title": "Parsing a string into an array of integers in C", "body": "<p>I would use strtol - here's a good site for how it works and examples</p>\n\n<p><a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_strtol.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/c_standard_library/c_function_strtol.htm</a></p>\n\n<p><strong>long int strtol(const char *str, char **endptr, int base)</strong></p>\n\n<p>Parameters</p>\n\n<ul>\n<li>str -- This is the string containing the representation of an integral number.</li>\n<li><p>endptr -- This is the reference to an object of type char*, whose value is set by the function to the next character in str after the numerical value.</p></li>\n<li><p>base -- This is the base, which must be between 2 and 36 inclusive, or be the special value 0.</p></li>\n</ul>\n\n<p><em>Return Value</em></p>\n\n<ul>\n<li>This function returns the converted integral number as a long int value, else zero value is r</li>\n</ul>\n\n<p>I've included one example from the site.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n   char str[30] = \"2030300 This is test\";\n   char *ptr;\n   long ret;\n\n   ret = strtol(str, &amp;ptr, 10);\n   printf(\"The number(unsigned long integer) is %ld\\n\", ret);\n   printf(\"String part is |%s|\", ptr);\n\n   return(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4015664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andy Nonomous", "link": "https://stackoverflow.com/users/4015664/andy-nonomous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 31967619, "answer_count": 1, "score": -2, "last_activity_date": 1439388492, "creation_date": 1439387797, "question_id": 31967329, "link": "https://stackoverflow.com/questions/31967329/parsing-a-string-into-an-array-of-integers-in-c", "title": "Parsing a string into an array of integers in C", "body": "<p>So now that I've figured out how to get what I want, I'm just hoping somebody can let me know a cleaner, less ridiculous way of achieving the same thing. I'm just learning C. Here was my approach.</p>\n\n<pre><code>int main()\n{\n    // String of positive and negative integer values \n    // Numbers are never more than 2 digits\n\n    char TEMPS[256] = \"1 -22 -8 14 5\";\n    int N = 5;\n\n    int ints[N];\n    int i = 0;\n    int mult;\n\n    // Arbitrary number to identify that num is not yet in use\n    int num = 999;  \n\n    int c = 0;\n    mult = (TEMPS[c] != 45) ? -1 : 1;\n    while(strcmp(&amp;TEMPS[c], \"\\0\") != 0)\n    {  \n       if(TEMPS[c] == 32)\n       {            \n            ints[i] = mult * num;                        \n            i++;\n            num = 999;\n            mult = (TEMPS[c + 1] == 45) ? -1 : 1;\n       } \n       else if((TEMPS[c] != 45) &amp;&amp; (TEMPS[c] != 32))\n       {\n            if(num == 999)\n            {\n                num = TEMPS[c] - '0';\n            }\n            else\n            {\n                num = num * 10 + (TEMPS[c] - '0');\n            }\n       }       \n       c++;\n    }\n    ints[i] = mult * num;    \n}\n</code></pre>\n"}, {"tags": ["c", "linux", "usb"], "answers": [{"comments": [{"owner": {"reputation": 694, "user_id": 1442040, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a7efef0810471f16092c09b54ff9eb?s=128&d=identicon&r=PG", "display_name": "samairtimer", "link": "https://stackoverflow.com/users/1442040/samairtimer"}, "edited": false, "score": 0, "creation_date": 1439433967, "post_id": 31973373, "comment_id": 51863145, "body": "Actually it is c/c++ code which and not a script. Ideally on device plugin some decisions are to be taken, for detection i am using libudev library which provides C interfaces. I am looking for a C liibrary which can be used for the same."}], "tags": [], "owner": {"reputation": 326, "user_id": 4164964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70bd4909742348c82b83a229c8b8484b?s=128&d=identicon&r=PG&f=1", "display_name": "9y7h0n", "link": "https://stackoverflow.com/users/4164964/9y7h0n"}, "is_accepted": false, "score": 2, "last_activity_date": 1439406108, "creation_date": 1439406108, "answer_id": 31973373, "question_id": 31967295, "link": "https://stackoverflow.com/questions/31967295/how-to-get-port-information-for-usb-ports-using-libudev/31973373#31973373", "title": "How to get port information for usb ports using libudev?", "body": "<p>Using the <code>lsusb</code> command and doing a <code>grep</code> to find the line with the name of the device. This command will output all sorts of useful information about all connected USB devices. You can also use <code>lsusb -v</code> to get very detailed info.</p>\n\n<p>Check out the manpage for lsusb \n<a href=\"http://manpages.ubuntu.com/manpages/hardy/man8/lsusb.8.html\" rel=\"nofollow\">http://manpages.ubuntu.com/manpages/hardy/man8/lsusb.8.html</a> </p>\n"}, {"tags": [], "owner": {"reputation": 694, "user_id": 1442040, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a7efef0810471f16092c09b54ff9eb?s=128&d=identicon&r=PG", "display_name": "samairtimer", "link": "https://stackoverflow.com/users/1442040/samairtimer"}, "is_accepted": true, "score": 1, "last_activity_date": 1439435454, "creation_date": 1439435454, "answer_id": 31978877, "question_id": 31967295, "link": "https://stackoverflow.com/questions/31967295/how-to-get-port-information-for-usb-ports-using-libudev/31978877#31978877", "title": "How to get port information for usb ports using libudev?", "body": "<p>After a bit of a research i found that it is possible using libusb.\nFrom <a href=\"http://libusb.sourceforge.net/api-1.0/group__dev.html#ga14879a0ea7daccdcddb68852d86c00c4\" rel=\"nofollow\">here</a>, libusb can be used to get a list of all devices plugged in , now the devices discovered using libudev can be checked in the list of devices available via <code>libusb_get_device_list</code>. </p>\n\n<p>Further <code>libusb_get_port_number</code> could be used to get the port number for the same device.</p>\n"}], "owner": {"reputation": 694, "user_id": 1442040, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a7efef0810471f16092c09b54ff9eb?s=128&d=identicon&r=PG", "display_name": "samairtimer", "link": "https://stackoverflow.com/users/1442040/samairtimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 1, "accepted_answer_id": 31978877, "answer_count": 2, "score": 2, "last_activity_date": 1439435454, "creation_date": 1439387697, "question_id": 31967295, "link": "https://stackoverflow.com/questions/31967295/how-to-get-port-information-for-usb-ports-using-libudev", "title": "How to get port information for usb ports using libudev?", "body": "<p>For a small project i am using libudev to get notification for USB devices plug-in/plug-out.\nIs there any way of knowing which USB port was used to plug in the device via libudev.\nActually there are multiple ports available and it is necessary to know which one was used.\nAny hints would be highly appreciated!</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1439387385, "post_id": 31967132, "comment_id": 51841405, "body": "Please <a href=\"http://stackoverflow.com/q/605845/2173917\">see why not to cast</a> the return value of <code>malloc()</code> and family in <code>C</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1439387449, "post_id": 31967132, "comment_id": 51841467, "body": "Is this C or C++?  There is no C/C++ language"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1439387843, "post_id": 31967132, "comment_id": 51841760, "body": "On which line do you get the &quot;runtime error&quot; ? Your debugger will tell you where the error occurs. What is the error message ? You don&#39;t know how to use a debugger ? Then it&#39;s the perfect moment to start learning it."}, {"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "edited": false, "score": 0, "creation_date": 1439387884, "post_id": 31967132, "comment_id": 51841791, "body": "can you provide sample usage example and input file for this code ?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1439388072, "post_id": 31967132, "comment_id": 51841945, "body": "0) <code>List *head</code> at <code>CreateList</code> should be initialize E.g <code>List *head=NULL</code> 1) <code>ptr-&gt;str = token;</code> make clone. E.g <code>ptr-&gt;str = strdup(token);</code>"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1439388252, "post_id": 31967132, "comment_id": 51842074, "body": "when you do  <code>ptr-&gt;next = head</code> <code>head</code> is not initialized"}], "answers": [{"tags": [], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "is_accepted": false, "score": 0, "last_activity_date": 1439388637, "creation_date": 1439388637, "answer_id": 31967683, "question_id": 31967132, "link": "https://stackoverflow.com/questions/31967132/having-problems-assigning-character-string-pointer-string-value/31967683#31967683", "title": "Having problems assigning character string pointer string value", "body": "<p>the variable 'head' is not initialized in createNode, so that the following substitution of head in 'ptr->next' may result unexpected behavior when you later traverse the tree in searchNode or PrintList.</p>\n"}], "owner": {"reputation": 73, "user_id": 2081525, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/89fd4eb739359af9892fa2d8a0d2e8b5?s=128&d=identicon&r=PG", "display_name": "Patrick Glenn", "link": "https://stackoverflow.com/users/2081525/patrick-glenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1439388637, "creation_date": 1439387257, "last_edit_date": 1439387400, "question_id": 31967132, "link": "https://stackoverflow.com/questions/31967132/having-problems-assigning-character-string-pointer-string-value", "title": "Having problems assigning character string pointer string value", "body": "<p>I am having problems assigning <code>ptr-&gt;str</code> to token value. Not sure whats going on <code>ptr-&gt;str</code> is pointer to char so is token. The <code>printf</code> is not printing char value. I am getting a runtime error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include \"C2A6E4_List-Driver.h\"\ntypedef struct List\n{\n    struct List *next;   /* pointer to the next list node */\n    char *str;           /* pointer to the string represented */\n    int count;           /* # of occurrences of this string */\n} List;\n\n#endif\n\n\n#define LINESIZE 256\n#define DELIMETERS \" \"\n\ntypedef enum { false, true }bool;\n\nList *newNode(void);\nbool searchNode(List *head, char *key);\n\nList *CreateList(FILE *fp)\n{\n    List *head, *ptr;\n    int cnt = 0;\n    size_t length;\n    bool firstNode = true;\n    bool srchResult = false;\n    char buf[LINESIZE];\n\n    while (fgets(buf, (int)sizeof(buf), fp) != NULL) { /* read line of file*/\n        char *token = strtok(buf, DELIMETERS);\n        while (token != NULL) {\n            if (firstNode) {\n                ptr = newNode();\n                length = strlen(token) + 1;\n                //  ptr-&gt;str = (char *)malloc(sizeof(char) * length);\n                ptr-&gt;next = head;\n                ptr-&gt;str = token;\n                ptr-&gt;count = 1;\n                head = ptr;\n                firstNode = false;\n            }\n            else {\n                srchResult = searchNode(head, token);\n                printf(\"srchResult= %d\\n\", srchResult);\n                if (srchResult) {\n                    ptr = newNode();\n                    length = strlen(token) + 1;\n                    ptr-&gt;next = head;\n                    ptr-&gt;str = token;\n                    printf(\"ptr_str = %s\", ptr-&gt;str);\n                    ptr-&gt;count += 1;\n                    head = ptr;\n                }//end if\n            }\n            printf(\"token = %s\\n\", token);\n            token = strtok(NULL, DELIMETERS);\n        }//end while\n    }// end while fgets\n    return head;\n}\n\n\n\nList *newNode(void)\n{\n    List *ptr = (List *)malloc(sizeof(List));\n    if (ptr == NULL) {\n        fputs(\"Out of Memory\\n \", stderr);\n        exit(EXIT_FAILURE);\n    }\n    return ptr;\n}\n\n\nbool searchNode(List *head, char *key)\n{\n    List *cur = head;\n    bool cmpResult = false;\n    printf(\"key = %s\\n\", key);\n    while (cur) {\n        printf(\"call strmcmp\\n\");\n        printf(\"cur-&gt;str = \\n\", cur-&gt;str);\n        cmpResult = strcmp(cur-&gt;str, key);\n        printf(\"cmpResult = %d\\n\", cmpResult);\n        if (cmpResult == 0) {\n            return false;\n            cur-&gt;count += 1;\n        }\n        cur = cur-&gt;next;\n        printf(\"curnext\\n\");\n    }\n    if (cmpResult &gt; 0 || cmpResult &lt; 0)\n        cmpResult = true;\n    printf(\"return\\n\");\n    return cmpResult;\n}\n\n\nList *PrintList(const List *head)\n{\n    List *cur = head;\n    while (cur) {\n        printf(\" %s  %d   ea\\n\", cur-&gt;str, cur-&gt;count);\n        cur = cur-&gt;next;\n    }\n    return (List *)head;\n}\n\n\nvoid FreeList(List *head)\n{\n    List *cur = head, *tmp;\n\n    while (cur) {\n        tmp = head;\n        head = head-&gt;next;\n        free(tmp);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "floating-point", "ieee-754"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 3, "creation_date": 1439387982, "post_id": 31967040, "comment_id": 51841873, "body": "For most modern architectures you can assume that. But not all architectures use IEEE-754 <a href=\"http://stackoverflow.com/q/2234468/995714\">Do any real-world CPUs not use IEEE 754?</a>, <a href=\"http://stackoverflow.com/q/6971886/995714\">Exotic architectures the standards committees care about</a>"}, {"owner": {"reputation": 13141, "user_id": 1834147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0991b9f14a94a126187ac3aa342d3d2?s=128&d=identicon&r=PG", "display_name": "tmyklebu", "link": "https://stackoverflow.com/users/1834147/tmyklebu"}, "edited": false, "score": 3, "creation_date": 1439389687, "post_id": 31967040, "comment_id": 51843295, "body": "This assumption is safe if you care about producing code that works on common platforms.  It is totally unsafe if you care about to-the-letter programming language standard compliance."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439394997, "post_id": 31967040, "comment_id": 51847260, "body": "What is your definition of &quot;safe&quot;?  For a life critical assumption, the assumption is not safe: various implementations use <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format#IEEE_754_single-precision_binary_floating-point_format:_binary32\" rel=\"nofollow noreferrer\">binary32</a> yet to not fully comply with NANs, sub-normals, etc.  The FP math operations vary as to there correctness.  In the end, you need to present a criteria for &quot;safe&quot;, otherwise the answers are as nebulous as the question."}, {"owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439397661, "post_id": 31967040, "comment_id": 51848835, "body": "@chux By safe I mean, the bit pattern on one system means the same on the another (after the byte rotation to deal with endianness)."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 1, "creation_date": 1439400126, "post_id": 31967040, "comment_id": 51850234, "body": "@Calmarius - what do you mean by portable? Will this code have to run on an Apple II, a Cray 1, ... ?"}, {"owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "reply_to_user": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1439459224, "post_id": 31967040, "comment_id": 51874494, "body": "@rcgldr This code needs to run on modern hardware: PCs, Macbooks, smartphones, and on wide variety of OSes: Windows 2K or higher, Many flavors of Linuxes, FreeBSD and Solaris."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1439463338, "post_id": 31967040, "comment_id": 51877129, "body": "@Calmarius - Sorry to use old examples, I was trying to figure out the range of hardware involved. So modern hardware, but not low end devices (like some blue tooth devices), or high end systems like mainframes. Some of that modern hardware (like ARM processors) may not include native floating point support, so the libraries would be the issue. If most of the systems you plan to work with support IEEE-754, is the conversion overhead an issue for those platforms that don&#39;t support it?"}, {"owner": {"reputation": 2031, "user_id": 2539867, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/3gog5.png?s=128&g=1", "display_name": "Jubatian", "link": "https://stackoverflow.com/users/2539867/jubatian"}, "edited": false, "score": 0, "creation_date": 1449642608, "post_id": 31967040, "comment_id": 56091311, "body": "What if you used the direct approach by default (assuming IEEE754), but had a conversion algorithm to that also written, possible to be enabled by a compile time switch. For automating the build, you could write a set of tests which tests the binary representations of what your software / protocol has to support. If all tests pass, the direct approach can be used, if a test fails, the build script would compile the conversion algorithm in. So you have portability and retain performance on systems where the tests pass."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1449868957, "post_id": 31967040, "comment_id": 56209405, "body": "The fundamental thing to consider is whether a) it is okay if your software only runs on hardware that you can get your hands on, or b) if it is supposed to run even on hardware that you may never get your hands on.  If &quot;a&quot; is true, then fine, go with the recommendations below. If &quot;b&quot; is true, forget it: just play it safe and convert everything to 7-bit ascii."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471363399, "post_id": 31967040, "comment_id": 65311811, "body": "Detail: <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow noreferrer\">IEEE Standard for Floating-Point Arithmetic (IEEE 754)</a> includes both <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\"><i>binary</i></a> and <a href=\"https://en.wikipedia.org/wiki/Decimal32_floating-point_format\" rel=\"nofollow noreferrer\"><i>decimal</i></a> floating point formats.  Certainly OP meant the <i>binary</i> IEEE754 float format."}], "answers": [{"comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 4, "creation_date": 1439387371, "post_id": 31967139, "comment_id": 51841394, "body": "That macro may not <a href=\"http://stackoverflow.com/questions/19955968/why-is-math-pow0-0-1/19955996#comment29710753_19956041\">always be useful</a>"}, {"owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "edited": false, "score": 0, "creation_date": 1439387555, "post_id": 31967139, "comment_id": 51841554, "body": "That macro is not defined in the MSVC9 compiler."}, {"owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "reply_to_user": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "edited": false, "score": 3, "creation_date": 1439387718, "post_id": 31967139, "comment_id": 51841678, "body": "@Calmarius Probably because it doesn&#39;t support C99."}, {"owner": {"reputation": 13141, "user_id": 1834147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0991b9f14a94a126187ac3aa342d3d2?s=128&d=identicon&r=PG", "display_name": "tmyklebu", "link": "https://stackoverflow.com/users/1834147/tmyklebu"}, "edited": false, "score": 1, "creation_date": 1439389618, "post_id": 31967139, "comment_id": 51843238, "body": "That macro doesn&#39;t always give you the right answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1449460917, "post_id": 31967139, "comment_id": 56000891, "body": "Whether the macro gives the right answer is beside the point.  That C provides a macro aimed at testing this feature implies that the standard supposes that it is unsafe to assume a specific answer <i>without</i> testing."}, {"owner": {"reputation": 251699, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1462862084, "post_id": 31967139, "comment_id": 61801474, "body": "And C++ has <code>std::numeric_limits&lt;T&gt;::is_iec559</code>: <a href=\"http://stackoverflow.com/a/37130892/895245\">stackoverflow.com/a/37130892/895245</a>"}], "tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 7, "last_activity_date": 1462861154, "last_edit_date": 1462861154, "creation_date": 1439387271, "answer_id": 31967139, "question_id": 31967040, "link": "https://stackoverflow.com/questions/31967040/is-it-safe-to-assume-floating-point-is-represented-using-ieee754-floats-in-c/31967139#31967139", "title": "Is it safe to assume floating point is represented using IEEE754 floats in C?", "body": "<p>There is a macro to check (since C99):</p>\n\n<blockquote>\n  <h3>C11 \u00a76.10.8.3 Conditional feature macros</h3>\n  \n  <p><code>__STDC_IEC_559__</code> The integer constant 1, intended to indicate conformance to the specifications in annex F (IEC 60559 floating-point arithmetic).</p>\n</blockquote>\n\n<p><em>IEC 60559</em> (short for <em>ISO/IEC/IEEE 60559</em>) is another name for IEEE-754.</p>\n\n<p>Annex F then establishes the mapping between C floating types and IEEE-754 types:</p>\n\n<blockquote>\n  <p>The C floating types match the IEC 60559 formats as follows:</p>\n  \n  <ul>\n  <li>The float type matches the IEC 60559 single format.</li>\n  <li>The double type matches the IEC 60559 double format.</li>\n  <li>The long double type matches an IEC 60559 extended format, 357) else a\n  non-IEC 60559 extended format, else the IEC 60559 double format. </li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1439389314, "creation_date": 1439389314, "answer_id": 31967964, "question_id": 31967040, "link": "https://stackoverflow.com/questions/31967040/is-it-safe-to-assume-floating-point-is-represented-using-ieee754-floats-in-c/31967964#31967964", "title": "Is it safe to assume floating point is represented using IEEE754 floats in C?", "body": "<p>Almost all common architectures now use IEEE-754, this is not required by the standard. There used to be old non IEE-754 architectures, and some could still be around.</p>\n\n<p>If the only requirement is for exchange of network data, my advice is:</p>\n\n<ul>\n<li>if <code>__STDC_IEC_559__</code> is defined, only use network order for the bytes and assume you do have standard IEE-754 for float and double.</li>\n<li>if <code>__STDC_IEC_559__</code> is not defined, use a special interchange format, that could be IEE-754 - one single protocol - or anything else - need a protocol indication.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1439405459, "post_id": 31973105, "comment_id": 51853178, "body": "Are you sure that <a href=\"https://en.wikipedia.org/wiki/IBM_System_z\" rel=\"nofollow noreferrer\">IBM System Z</a> - the indirect successor of IBM/370 - is using IEEE754?"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 3, "creation_date": 1439405797, "post_id": 31973105, "comment_id": 51853369, "body": "@BasileStarynkevitch Well-remembered. :) IBM has indeed carried their crazy-ass base-16 system through to the current day, but only as a backwards-compatibility option. Unless you go out of your way to use it, you&#39;ll be using normal base-2 floats."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1439406824, "post_id": 31973105, "comment_id": 51853904, "body": "Embedded  example &quot;cheap-out&quot;: rather than inf/NaN, these bit patterns simple represent numbers with a &quot;IEEE754_max_exponent+1&quot; exponent.  Also see <a href=\"https://www.ccsinfo.com/faq.php?page=mchp_float_format\" rel=\"nofollow noreferrer\">non IEEE-754</a> example."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439411357, "post_id": 31973105, "comment_id": 51856214, "body": "@Sneftel  This answer is the basis for a <i>very</i> good answer.  Some other thoughts, use as desired: The 1st 2 points address the FP format (OP&#39;s concern), and the later points bring in computation issues of which there are many.  Another &quot;cheap-out&quot;, though very niched, is <code>+&#47;- 0.0</code>:  Some platforms ignore the sign and never generate <code>-0.0</code>.  Types of NaN (Signaling and Quiet) often fit the &quot;except for blah&quot; category.  Meaning and values of NaN payload is another undefined area.   MS use of 64-bit for <code>long double</code> vs MS historic 80-bit use and other&#39;s 128-bit use is another incompatible area."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1439479604, "post_id": 31973105, "comment_id": 51889216, "body": "This is an excellent answer, I am wondering are there any references out there that cover this even partially? Seems like this applies equally to C++ as well."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1439485994, "post_id": 31973105, "comment_id": 51893143, "body": "@ShafikYaghmour Well, Higham&#39;s &quot;Accuracy and Stability of Numerical Algorithms&quot; discusses the implications of guard digits and denormal numbers. (And, yes, also hexadecimal FP.) It&#39;s honestly a very interesting book."}, {"owner": {"reputation": 3695, "user_id": 3798657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHD3g.png?s=128&g=1", "display_name": "rubicks", "link": "https://stackoverflow.com/users/3798657/rubicks"}, "edited": false, "score": 0, "creation_date": 1449954704, "post_id": 31973105, "comment_id": 56231857, "body": "@Sneftel thank you for mentioning the Higham text. Some other helpful references: Wilkinson&#39;s &quot;Rounding Errors in Algebraic Processes&quot; and &quot;The Algebraic Eigenvalue Problem&quot;"}], "tags": [], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "is_accepted": false, "score": 25, "last_activity_date": 1556197277, "last_edit_date": 1556197277, "creation_date": 1439405183, "answer_id": 31973105, "question_id": 31967040, "link": "https://stackoverflow.com/questions/31967040/is-it-safe-to-assume-floating-point-is-represented-using-ieee754-floats-in-c/31973105#31973105", "title": "Is it safe to assume floating point is represented using IEEE754 floats in C?", "body": "<p>Essentially all architectures in current non-punch-card use, including embedded architectures and exotic signal processing architectures, offer one of two floating point systems:</p>\n\n<ul>\n<li>IEEE-754.</li>\n<li>IEEE-754 <em>except for blah</em>. That is, they <em>mostly</em> implement 754, but cheap out on some of the more expensive and/or fiddly bits.</li>\n</ul>\n\n<p>The most common cheap-outs:</p>\n\n<ul>\n<li>Flushing denormals to zero. This invalidates certain sometimes-useful theorems (in particular, the theorem that <code>a-b</code> can be exactly represented if <code>a</code> and <code>b</code> are within a factor of 2), but in practice it's generally not going to be an issue.</li>\n<li>Failure to recognize <code>inf</code> and <code>NaN</code> as special. These architectures will fail to follow the rules regarding <code>inf</code> and <code>NaN</code> as operands, and may not saturate to <code>inf</code>, instead producing numbers that are larger than <code>FLT_MAX</code>, which will generally be recognized by other architectures as <code>NaN</code>.</li>\n<li>Proper rounding of division and square root. It's a whole lot easier to guarantee that the result is within 1-3 ulps of the exact result than within 1/2 ulp. A particularly common case is for division to be implemented as reciprocal+multiplication, which loses you one bit of precision.</li>\n<li>Fewer or no guard digits. This is an unusual cheap-out, but means that other operations can be 1-2 ulps off.</li>\n</ul>\n\n<p>BUUUUT... even those <em>except for blah</em> architectures still use IEEE-754's representation of numbers. Other than byte ordering issues, the bits describing a <code>float</code> or <code>double</code> on architecture A are essentially guaranteed to have the same meaning on architecture B.</p>\n\n<p>So as long as all you care about is the representation of values, you're totally fine. If you care about cross-platform consistency of operations, you may need to do some extra work.</p>\n\n<p><strong>EDIT</strong>: As Chux mentions in the comments, a common extra source of inconsistency between platforms is the use of extended precision, such as the x87's 80-bit internal representation. That's the opposite of a cheap-out, and (with proper treatment) fully conforms to both IEEE-754 and the C standard, but it will likewise cause results to differ between architectures, and even between compiler versions and following apparently minor and unrelated code changes. However: a particular x86/x64 executable will NOT produce different results on different processors due to extended precision.</p>\n"}, {"tags": [], "owner": {"reputation": 3695, "user_id": 3798657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHD3g.png?s=128&g=1", "display_name": "rubicks", "link": "https://stackoverflow.com/users/3798657/rubicks"}, "is_accepted": false, "score": 1, "last_activity_date": 1450035238, "last_edit_date": 1450035238, "creation_date": 1449513805, "answer_id": 34140838, "question_id": 31967040, "link": "https://stackoverflow.com/questions/31967040/is-it-safe-to-assume-floating-point-is-represented-using-ieee754-floats-in-c/34140838#34140838", "title": "Is it safe to assume floating point is represented using IEEE754 floats in C?", "body": "<p>Strictly speaking, it's not safe to assume floating-point support; generally speaking, the vast majority of platforms will support it. Notable exceptions include (now deprecated) VMS systems running on Alpha chips</p>\n\n<p>If you have the luxury of runtime checking, consider <a href=\"http://www.netlib.org/paranoia/paranoia.c\" rel=\"nofollow\"><code>paranoia</code></a>, a floating-point vetting tool written by <a href=\"https://en.wikipedia.org/wiki/William_Kahan\" rel=\"nofollow\">William Kahan</a>.</p>\n\n<p>Edit: sounds like your application is more concerned with binary formats as they pertain to storage and/or serialization. I would suggest narrowing your scope to choosing a third-party library that supports this. You could do worse than <a href=\"https://developers.google.com/protocol-buffers/docs/proto?hl=en#scalar\" rel=\"nofollow\">Google Protocol Buffers</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1449525780, "post_id": 34144048, "comment_id": 56036432, "body": "The hazard here arises from byte ordering issues. 754 doesn&#39;t specify whether floating point numbers are big-endian (with the sign and some of the exponent at the lowest memory address) or little-endian (with the LSB of the mantissa at the lowest memory address). IME, FP ordering matches integer ordering, but if you go down this road you need to make sure you do network byte order conversion going in/out."}, {"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "reply_to_user": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1449526084, "post_id": 34144048, "comment_id": 56036578, "body": "@Sneftel Of course you have to care about byte order. The user asking the question mentioned that he&#39;s aware of that. The test I posted works regardless of byte order and implicitly verifies that floating point numbers and integers use the same byte order."}, {"owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "reply_to_user": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1449526626, "post_id": 34144048, "comment_id": 56036812, "body": "@Sneftel Floating point and integers have the same endianness aren&#39;t they? So I think the test above would pass on both platforms."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "edited": false, "score": 0, "creation_date": 1449526726, "post_id": 34144048, "comment_id": 56036860, "body": "@Calmarius It&#39;s not guaranteed, but I&#39;ve never seen it otherwise. The risk is not that the test would spuriously fail, though, but that it would pass, but then writing the float to a network socket and reading it on a different OS would produce a different value. As nwellnhof points out, though, the OP is aware of byte-ordering issues."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": false, "score": 1, "last_activity_date": 1449525433, "creation_date": 1449525433, "answer_id": 34144048, "question_id": 31967040, "link": "https://stackoverflow.com/questions/31967040/is-it-safe-to-assume-floating-point-is-represented-using-ieee754-floats-in-c/34144048#34144048", "title": "Is it safe to assume floating point is represented using IEEE754 floats in C?", "body": "<p>Like others have mentioned, there's the <code>__STDC_IEC_559__</code> macro, but it isn't very useful because it's only set by compilers that completely implement the respective annex in the C standard. There are compilers that implement only a subset but still have (mostly) usable IEEE floating point support.</p>\n\n<p>If you're only concerned with the binary representation, you should write a <em>feature test</em> that checks the bit patterns of certain floating numbers. Something like:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef union {\n    double   d;\n    uint64_t i;\n} double_bits;\n\nint main() {\n    double_bits b;\n    b.d = 2.5;\n    if (b.i != UINT64_C(0x4004000000000000)) {\n        fprintf(stderr, \"Not an IEEE-754 double\\n\");\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Check a couple of numbers with different exponents, mantissae, and signs, and you should be on the safe side. Since these tests aren't expensive, you could even run them once at runtime.</p>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 3, "last_activity_date": 1449878630, "creation_date": 1449878630, "answer_id": 34234566, "question_id": 31967040, "link": "https://stackoverflow.com/questions/31967040/is-it-safe-to-assume-floating-point-is-represented-using-ieee754-floats-in-c/34234566#34234566", "title": "Is it safe to assume floating point is represented using IEEE754 floats in C?", "body": "<p>I suggest you need to look more carefully at your definition of portable.</p>\n\n<p>I would also suggest your definition of \"safe\" is insufficient.   Even if the binary representation (allowing for endianness) is okay, the operations on variables may behave differently.   After all, there are few applications of floating point that don't involve operations on variables.</p>\n\n<p>If you want to support all host architectures that have ever been created then assuming IEEE floating point format is inherently unsafe.   You will have to deal with systems that support different formats, systems that don't support floating point at all, systems for which compilers have switches to select floating point behaviours (with some behaviours being associated with non-IEEE formats), CPUs that have an optional co-processor (so floating point support depends on whether an additional chip is installed, but otherwise variants of the CPU are identical), systems that emulate floating point operations in software (some such software emulators are configurable at run time), and systems with buggy or incomplete implementation of floating point (which may or may not be IEEE based).</p>\n\n<p>If you are willing to limit yourself to hardware of post 2000 vintage, then your risk is lower but non-zero.   Virtually all CPUs of that vintage support IEEE in some form.   However you still (as with older CPUs too) need to consider what floating point operations you wish to have supported, and the trade-offs you are willing to accept to have them.   Different CPUs (or software emulation) have less complete implementation of floating point than others, and some are configured by default to not support some features - so it is necessary to change settings to enable some features, which can impact on performance or correctness of your code.</p>\n\n<p>If you need to share floating point values between applications (which may be on different hosts with different features, built with different compilers, etc) then you will need to define a protocol.  That protocol might involve IEEE format, but all your applications will need to be able to handle conversion between the protocol and their native representations.</p>\n"}], "owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2268, "favorite_count": 6, "answer_count": 6, "score": 23, "last_activity_date": 1556197277, "creation_date": 1439387055, "last_edit_date": 1439397613, "question_id": 31967040, "link": "https://stackoverflow.com/questions/31967040/is-it-safe-to-assume-floating-point-is-represented-using-ieee754-floats-in-c", "title": "Is it safe to assume floating point is represented using IEEE754 floats in C?", "body": "<p>Floating point is implementation defined in the C. So there isn't any guarantees.</p>\n\n<p>Our code needs to be portable, we are discussing whether or not acceptable to use IEEE754 floats in our protocol. For performance reasons it would be nice if we don't have to convert back and forth between a fixed point format when sending or receiving data.</p>\n\n<p>While I know that there can be differences between platforms and architectures regarding the size of <code>long</code> or <code>wchar_t</code>. But I can't seem to find any specific about the <code>float</code> and <code>double</code>. </p>\n\n<p>What I found so far that the byte order maybe reversed on big endian platforms. While there are platforms without floating point support where a code containing <code>float</code> and <code>double</code> wouldn't even link. Otherwise platforms seem to stick to IEEE754 single and double precision.</p>\n\n<p>So is it safe to assume that floating point is in IEEE754 when available?</p>\n\n<p>EDIT: In response to a comment:</p>\n\n<blockquote>\n  <p>What is your definition of \"safe\"?</p>\n</blockquote>\n\n<p>By safe I mean, the bit pattern on one system means the same on the another (after the byte rotation to deal with endianness). </p>\n"}, {"tags": ["c", "getchar", "putchar"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1439386556, "post_id": 31966754, "comment_id": 51840761, "body": "The quickest and easiest solution, define an array of 1000 elements and use that to store, but otherwise, you can use pointers and realloc() the memory as you go."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 2, "creation_date": 1439386655, "post_id": 31966754, "comment_id": 51840825, "body": "You could declare an array of size 1000 and store the input in it using any input methods (<code>fgets</code>,<code>scanf</code> etc). Or use <code>getline</code> if available. Or <code>malloc</code>+<code>realloc</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1439386741, "post_id": 31966754, "comment_id": 51840899, "body": "@CoolGuy What about <code>fgets()</code> and <code>scanf()</code> here? Aren&#39;t we already having the input value in <code>c</code> and a simple assignment will do?"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1439387893, "post_id": 31966754, "comment_id": 51841796, "body": "@SouravGhosh Sure. That will also do."}, {"owner": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 1, "creation_date": 1439390318, "post_id": 31966754, "comment_id": 51843827, "body": "Btw: <code>c</code> should be <code>int</code> instead of <code>char</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1439388010, "post_id": 31967227, "comment_id": 51841892, "body": "<code>for(int i = 0;i &lt; count + 1;i++)</code> should be <code>for(int i = 0; i &lt; count; i++)</code>. The same goes for the <code>malloc</code> version. Why? Because there isn&#39;t a NUL-terminator (because input is taken one by one via <code>getchar</code> until <code>EOL</code>). You need to add that manually."}], "tags": [], "owner": {"reputation": 116, "user_id": 5090510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71488730c8e1a39181f32e02b3cdb3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Caden Depatie", "link": "https://stackoverflow.com/users/5090510/caden-depatie"}, "is_accepted": false, "score": 1, "last_activity_date": 1439388239, "last_edit_date": 1439388239, "creation_date": 1439387499, "answer_id": 31967227, "question_id": 31966754, "link": "https://stackoverflow.com/questions/31966754/i-am-using-while-loop-to-enter-characters-one-by-onetotal-number-of-characters/31967227#31967227", "title": "I am using while loop to enter characters one by one(total number of characters to be entered is unknown). How can I store my characters in an array:", "body": "<p>If you don't know exactly how many characters will be in the string, but have a hard upper limit, you can simply allocate enough space for that upper limit:</p>\n\n<pre><code>char tmpArray[1000];\n</code></pre>\n\n<p>Store the characters in there:</p>\n\n<pre><code>while((c=getchar())!=EOL)\n{\n    tmpArray[count] = c;\n    count++;\n}\n</code></pre>\n\n<p>and then after your loop finishes and you know how many characters there are (via count variable), you can allocate a new array with the correct amount and copy the temp string into it:</p>\n\n<pre><code>char actualArray[count];\nfor(int i = 0;i &lt; count + 1;i++) {\n    actualArray[i] = tmpArray[i];\n}\n</code></pre>\n\n<p>However this is not great as the large array cannot be freed up/removed from memory. It is probably a better idea to use malloc and a char* to do this:</p>\n\n<pre><code>char* tmpArray = malloc((sizeof(char)) * 1001);\nwhile((c=getchar())!=EOL) {\n    tmpArray[count] = c;\n    count++;\n}\n\nchar* actualArray = malloc((sizeof(char)) * count + 1);\nstrncpy(actualArray, tmpArray, count + 1);\nfree(tmpArray);\n\n/***later in the program, once you are done with array***/\nfree(actualArray);\n</code></pre>\n\n<p>strncpy's arguments are (destination, source, num) where num is the number of characters to be transferred. We add one to count so that the null terminator at the end of the string is transferred as well.</p>\n"}, {"comments": [{"owner": {"reputation": 298, "user_id": 5164330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f3ce9073c9b9753cfc7a903d17263d?s=128&d=identicon&r=PG&f=1", "display_name": "Peut22", "link": "https://stackoverflow.com/users/5164330/peut22"}, "edited": false, "score": 0, "creation_date": 1439389404, "post_id": 31967741, "comment_id": 51843069, "body": "Why not a <code>malloc</code>instead of a <code>calloc</code>here ?"}, {"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "reply_to_user": {"reputation": 298, "user_id": 5164330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f3ce9073c9b9753cfc7a903d17263d?s=128&d=identicon&r=PG&f=1", "display_name": "Peut22", "link": "https://stackoverflow.com/users/5164330/peut22"}, "edited": false, "score": 0, "creation_date": 1439389976, "post_id": 31967741, "comment_id": 51843528, "body": "@Peut22 <code>calloc</code> allocates  a <b>zero-initialized</b> memory block of <code>size</code> chars"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439390103, "post_id": 31967741, "comment_id": 51843639, "body": "@sergej the question holds, as you overwrite it anyway."}, {"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439390548, "post_id": 31967741, "comment_id": 51844027, "body": "@Quentin <code>malloc</code> would of course also work, you would just have to terminate the string."}], "tags": [], "owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "is_accepted": true, "score": 1, "last_activity_date": 1441447958, "last_edit_date": 1592644375, "creation_date": 1439388771, "answer_id": 31967741, "question_id": 31966754, "link": "https://stackoverflow.com/questions/31966754/i-am-using-while-loop-to-enter-characters-one-by-onetotal-number-of-characters/31967741#31967741", "title": "I am using while loop to enter characters one by one(total number of characters to be entered is unknown). How can I store my characters in an array:", "body": "<h1>Implement a dynamically growing array</h1>\n<ol>\n<li><p>use <code>calloc()</code> or <code>malloc()</code> to allocate a small memory block - let's say for 10 chars</p>\n</li>\n<li><p>use <code>realloc()</code> to increase the size of the memory block if needed</p>\n</li>\n</ol>\n<p><strong>Example:</strong></p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define EOL '\\n'\n\nint main()\n{\n    int count = 0;\n    int size = 10;\n    char *chars = NULL;\n    char c;\n    \n    /* allocate memory for 10 chars */\n    chars = calloc(size, sizeof(c));\n    if(chars == NULL) {\n        printf(&quot;allocating memory failed!\\n&quot;);\n        return EXIT_FAILURE;\n    }\n\n    /* read chars ... */\n    while((c = getchar()) != EOL) {\n        /* re-allocate memory for another 10 chars if needed */\n        if (count &gt;= size) {\n            size += size;\n            chars = realloc(chars, size * sizeof(c));\n            if(chars == NULL) {\n                printf(&quot;re-allocating memory failed!\\n&quot;);\n                return EXIT_FAILURE;\n            }\n        }\n        chars[count++] = c;\n    }\n\n    printf(&quot;chars: %s\\n&quot;, chars);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 304, "user_id": 4774977, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/815892025162850/picture?type=large", "display_name": "Sunil Kumar", "link": "https://stackoverflow.com/users/4774977/sunil-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 31967741, "answer_count": 2, "score": -1, "last_activity_date": 1441447958, "creation_date": 1439386404, "last_edit_date": 1439387310, "question_id": 31966754, "link": "https://stackoverflow.com/questions/31966754/i-am-using-while-loop-to-enter-characters-one-by-onetotal-number-of-characters", "title": "I am using while loop to enter characters one by one(total number of characters to be entered is unknown). How can I store my characters in an array:", "body": "<p>User has to input a string of unknown length(&lt;1000). So here I am using <code>while</code> loop, <code>#define</code>, <code>getchar</code>.<br>\nWhat should I do to store the characters simultaneously? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define EOL '\\n'\n\nint main()\n{\n    int count=0;\n    char c;\n\n    while((c=getchar())!= EOL)// These c's have to be stored.\n    {\n        count++;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>EDIT: Sorry I didn't tell this thing earlier. I don't have to waste 1000 bytes if <code>count!=1000</code>. That's why I am not declaring any array of 1000 elements initially.</p>\n"}, {"tags": ["c", "multithreading", "pointers", "pthreads", "posix"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1439384313, "post_id": 31965809, "comment_id": 51838923, "body": "You haven&#39;t explained how its behavior is different from what you wanted/expected."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439387478, "post_id": 31965809, "comment_id": 51841488, "body": "Ahem..... &#39;pthread_create(&amp;t, NULL, add, (void *)&amp;p);&#39; by the time that add() function is run by your new thread, it&#39;s quite likely that  adder() has returned, p has disappeared and add() tries to dereference an illegal pointer - UB."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439402267, "post_id": 31965809, "comment_id": 51851451, "body": "Also, you&#39;re leaking a <code>pthread_t</code>, which means the spawned thread turns into a zombie when it exits."}, {"owner": {"reputation": 175, "user_id": 3545370, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1551536573/picture?type=large", "display_name": "user3545370", "link": "https://stackoverflow.com/users/3545370/user3545370"}, "edited": false, "score": 0, "creation_date": 1439415825, "post_id": 31965809, "comment_id": 51858473, "body": "do you mean that I just forgot to terminate the thread?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439419131, "post_id": 31965809, "comment_id": 51859603, "body": "By default, a thread is created in <code>joinable</code> state. It means that after the thread exits, another thread can <code>pthread_join()</code> with the thread, synchronizing further execution and optionally using the return value of the joined pthread. <code>man pthread_create: [...]Only when a  terminated joinable thread  has  been joined are the last of its resources released back to the system.[...]</code>. Alternatively, you can <code>pthread_detach()</code> the thread."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1439538354, "post_id": 31965809, "comment_id": 51912279, "body": "Please do not use the suffix <code>_t</code> for your own type. It is reserved by POSIX for system types."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 3545370, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1551536573/picture?type=large", "display_name": "user3545370", "link": "https://stackoverflow.com/users/3545370/user3545370"}, "edited": false, "score": 0, "creation_date": 1439390433, "post_id": 31966089, "comment_id": 51843943, "body": "thanks for the info, this isn&#39;t really an assignment, just lecture notes I don&#39;t quite understand yet, but I think I&#39;m getting there, yes I looked up void pointers and they seem to be very similar to type parameters from java, nobody ever really explains this stuff well in college, thanks again, I thought that the parameters would be passed to the start routine and you confirmed my suspicions"}], "tags": [], "owner": {"reputation": 791, "user_id": 4245519, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wxicC.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4245519/mark-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1439386027, "last_edit_date": 1439386027, "creation_date": 1439384574, "answer_id": 31966089, "question_id": 31965809, "link": "https://stackoverflow.com/questions/31965809/posix-threads-program-explanation/31966089#31966089", "title": "posix threads program explanation?", "body": "<p>The * before <code>add</code> indicates that <code>add</code> returns a <code>void*</code> - that is, a pointer.  The reason it has to return a <code>void*</code> and not some other type, or void, is that that's what functions called with <code>pthread_create</code> have to return.</p>\n\n<p>The function <code>add</code> is <em>not</em> void, contrary to your comment.  It returns a value which is a <code>void *</code>.  I'd recommend a quick Google of <code>void *</code> pointers.</p>\n\n<p>You can (and should) look up the parameters to <code>pthread_create</code> and that would answer your question about its parameters.  The last parameter is passed as the argument to <code>add</code>.</p>\n\n<p>Telling you the answer to your assignment is probably not the best way to help you learn... but here it is.  Think about <em>scope</em> and try to work it out for yourself before you read my answer.</p>\n\n<blockquote class=\"spoiler\">\n  <p> I can see one bug - <code>adder</code>'s variable <code>p</code> has scope local to <code>adder</code>.  You pass a pointer to it to <code>add</code>.  As soon as <code>adder</code> returns, <code>p</code> will go out of scope and <code>add</code> will be working on memory which may not contain what you want it to.</p>\n</blockquote>\n\n<p>There may be others that I haven't spotted.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 791, "user_id": 4245519, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wxicC.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4245519/mark-smith"}, "edited": false, "score": 0, "creation_date": 1439386186, "post_id": 31966324, "comment_id": 51840459, "body": "@MarkSmith Oh my, indeed that&#39;s a rather fatal bug. Can&#39;t believe I didn&#39;t think of that :) I&#39;ll leave this answer as it is and upvote yours."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1439388329, "post_id": 31966324, "comment_id": 51842134, "body": "@BlueMoon Because it is not self-documenting code. It is not clear if the programmer meant 0 to be NULL, or if they for some reason intended to return a value or an error code. Same reason why for example <code>if(ptr == NULL)</code> is so much better and clearer style than <code>if(!ptr)</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1439446700, "post_id": 31966324, "comment_id": 51867060, "body": "@BlueMoon Well, your style is banned by widely-recognized coding standards such as MISRA-C. And since MISRA-C is not a style guide, they have a safety-related rationale for banning that style: treating if statement conditions etc as something that must have essentially bool type leads to stronger typing, and stronger typing leads to less bugs."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1439469908, "post_id": 31966324, "comment_id": 51881586, "body": "@BlueMoon I&#39;m curious to know then, for what purpose do you think the macro NULL exists?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1439469945, "post_id": 31966324, "comment_id": 51881615, "body": "@BlueMoon As for the C standard, it allows all kinds of madness. It is not in the slightest concerned about rationales, consistency, readability or program safety. The C standard doesn&#39;t care about if your programs work as intended or crash. This is why professional programmers use coding standards to create safer subsets of the dangerous and complicated C language. For POSIX/desktop programming, <a href=\"https://www.securecoding.cert.org/confluence/display/c/SEI+CERT+C+Coding+Standard\" rel=\"nofollow noreferrer\">CERT C</a> is perhaps more suitable than MISRA-C. It even has a chapter addressing POSIX-specifics."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1439474202, "post_id": 31966324, "comment_id": 51884909, "body": "@BlueMoon I already mentioned the rationale in the very first comment: explicit code is self-documenting code."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1439386118, "last_edit_date": 1439386118, "creation_date": 1439385223, "answer_id": 31966324, "question_id": 31965809, "link": "https://stackoverflow.com/questions/31965809/posix-threads-program-explanation/31966324#31966324", "title": "posix threads program explanation?", "body": "<p><code>void * add(void *p_in)</code> is a function taking a void pointer as argument and returns a void pointer. Some people find this coding style more readable: <code>void* add (void* p_in)</code> (equivalent meaning). </p>\n\n<p><code>void*</code> has the advantage of being a generic pointer which can point at any type. And any pointer type can be converted to/from a void pointer type without explicit casts. So a function that both returns void* and takes void* as parameter is the most generic function you can have.</p>\n\n<p>(The cast <code>(void *)&amp;p</code> is fishy: it is superfluous and may indicate that you are doing something wrong, such as compiling C code on a C++ compiler.)</p>\n\n<p>POSIX threads demand that you pass a function pointer to a function with such a format when you create the thread. This will be the thread <em>callback</em> function. It must have that exact format or your program will crash and burn. </p>\n\n<p>If you need to pass several parameters, you'll have to bake them together in a struct as in your example, then cast them back to the struct type from inside the callback function.</p>\n\n<p>Regarding the parameters of the phread_create, the manual can tell you as much as I. Basically it goes like this:</p>\n\n<pre><code>pthread_create(&amp;t,   // thread to create\n               NULL, // attributes, advanced feature, ignore for now\n               add,  // thread callback function\n               &amp;p);  // pointer to the parameter to pass to the thread callback\n</code></pre>\n\n<p>The return 0 is a sloppy way of writing return NULL. This is bad practice in C, it is preferred to always use the NULL macro. </p>\n"}, {"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439387841, "post_id": 31966405, "comment_id": 51841759, "body": "Yes, I missed you answer and wrote my own:("}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439388015, "post_id": 31966405, "comment_id": 51841897, "body": "OTOH, you missed the classic &#39;allocate the struct with new/malloc and delete/free it at the end of the thread function&#39;.  No need for globals or waiting."}], "tags": [], "owner": {"reputation": 45, "user_id": 2185767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77459731ea2c6bc2f5f3f64e7fd46e81?s=128&d=identicon&r=PG", "display_name": "wrinkl3", "link": "https://stackoverflow.com/users/2185767/wrinkl3"}, "is_accepted": false, "score": 2, "last_activity_date": 1439389103, "last_edit_date": 1439389103, "creation_date": 1439385470, "answer_id": 31966405, "question_id": 31965809, "link": "https://stackoverflow.com/questions/31965809/posix-threads-program-explanation/31966405#31966405", "title": "posix threads program explanation?", "body": "<blockquote>\n  <p>what kind of parameter is (void *p_in)?  </p>\n</blockquote>\n\n<p>That's a <a href=\"http://www.c4learn.com/c-programming/c-void-pointers/\" rel=\"nofollow\">void pointer</a>, basically a pointer that doesn't have a type associated with it. POSIX threads only accept void pointers as arguments, and to use them you have to <a href=\"http://www.tutorialspoint.com/cprogramming/c_type_casting.htm\" rel=\"nofollow\">cast</a> them to the type you want, which is what's done on the first line of add().<br>\nThe code fails because p is a local variable and is discarded once adder returns (and since add() is a thread, adder() doesn't wait for it to return), to fix it either make p a global variable, or make adder() wait until the add() thread returns.<br>\nedit: as Martin James pointed out, dynamically allocating the p with malloc, passing the resulting pointer to the thread and calling free on it at the end of the thread would also do the trick. </p>\n"}, {"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439387909, "post_id": 31967322, "comment_id": 51841810, "body": "Note: @wrinkl3 had seen this 40 minutes ago, but I missed it - upvote him/her, not me:("}], "tags": [], "owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "is_accepted": false, "score": 0, "last_activity_date": 1439387759, "creation_date": 1439387759, "answer_id": 31967322, "question_id": 31965809, "link": "https://stackoverflow.com/questions/31965809/posix-threads-program-explanation/31967322#31967322", "title": "posix threads program explanation?", "body": "<p>Do not allocate thread argument struts/objects/whatever in automatic storage in the function block that creates the thread unless the lifetime of the creating function/block is guaranteed to be the same as, or longer, than the time that the created thread requires access to it.</p>\n"}], "owner": {"reputation": 175, "user_id": 3545370, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1551536573/picture?type=large", "display_name": "user3545370", "link": "https://stackoverflow.com/users/3545370/user3545370"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1519220844, "creation_date": 1439383957, "last_edit_date": 1519220844, "question_id": 31965809, "link": "https://stackoverflow.com/questions/31965809/posix-threads-program-explanation", "title": "posix threads program explanation?", "body": "<p>I have to learn POSIX threads, still getting my head around pointers and de-referencing, I think I understand the basics of &amp; * and changing values/memory locations. Now we have to start coding POSIX threads, we were given this sample question in our lectures and I can't quite get what's going on. </p>\n\n<p>apparently there is a problem with this code that probably has something to do with parsing arguments, could anyone possibly give me a quick explanation? I have commented what I think is going on</p>\n\n<pre><code>typedef struct { int a, b; } pair_t;           /*creating new struct pair_t, takes in 2 integers */\n\nvoid * add(void *p_in)                         /* here is where I start to get confused, what is the * before add, what kind of parameter is (void *p_in)? */\n{\n    pair_t *p = (pair_t *)p_in;                /* \"*p\" is a pointer for a \"pair_t\", (pair_t *)p_in ? */\n    printf(\"Answer is: %d\\n\", p-&gt;a + p-&gt;b);    /* prints out pair_t -&gt; a? */\n    return (0);                                /* its a void method so no return value */\n}\n\nvoid adder(int x, int y){                      /* takes two integers as parameters */`\n    pthread_t t;                               /* initialises POSIX thread \"t\" */\n    pair_t p;                                  /* initialises new pair_t \"p\" */\n    p.a = x;                                   /* sets p.a and p.b as x and y respectively */\n    p.b = y;\n    pthread_create(&amp;t, NULL, add, (void *)&amp;p); /* creates a new thread, thread ID is pthread \"t\", NULL -&gt; default thread attributes, void add = start routine, (void *)&amp;p = thread arguments */\n}\n</code></pre>\n\n<p>when the pthread_create is called, are the thread arguments being passed to the add method? and what if anything is wrong with this code?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 4070, "user_id": 2453089, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/vhgD8.jpg?s=128&g=1", "display_name": "vish4071", "link": "https://stackoverflow.com/users/2453089/vish4071"}, "edited": false, "score": 0, "creation_date": 1439384147, "post_id": 31965756, "comment_id": 51838770, "body": "Try reading the input using scanf() or gets().Still, I don&#39;t think your code would do what you want it to."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1439384191, "post_id": 31965756, "comment_id": 51838812, "body": "Your problem starts with the declaration of <code>read</code> as an array of pointers, continues with you assigning <code>read</code> (which decays to a pointer, and becomes a pointer to a pointer to <code>char</code>) to <code>ch</code> which is a pointer to <code>char</code>. I&#39;m sure een a beginner lie you should be able to see that there is a difference between a pointer to pointer to <code>char</code>, and a pointer to <code>char</code>"}, {"owner": {"reputation": 54437, "user_id": 108796, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/1yySS.jpg?s=128&g=1", "display_name": "Blindy", "link": "https://stackoverflow.com/users/108796/blindy"}, "edited": false, "score": 3, "creation_date": 1439384200, "post_id": 31965756, "comment_id": 51838822, "body": "The language is old?"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 1, "creation_date": 1439384333, "post_id": 31965756, "comment_id": 51838934, "body": "em... you need to know what <code>read</code>&#39;s type is first."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1439384505, "last_edit_date": 1439384505, "creation_date": 1439384161, "answer_id": 31965900, "question_id": 31965756, "link": "https://stackoverflow.com/questions/31965756/c-how-to-store-words-in-a-char-pointer-from-the-user-input/31965900#31965900", "title": "C how to store words in a char pointer from the user input", "body": "<p>You should use <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow\">getline(3)</a> if your system (e.g. a POSIX one) has it. Otherwise, declare a large enough line buffer (e.g. <code>char linebuf[200];</code>) and use <a href=\"http://man7.org/linux/man-pages/man3/fgets.3.html\" rel=\"nofollow\">fgets(3)</a></p>\n\n<p>Then, you might parse the string (that is, your line buffer). You could use functions from <code>&lt;ctype.h&gt;</code> like <a href=\"http://man7.org/linux/man-pages/man3/isalpha.3.html\" rel=\"nofollow\">isalpha(3)</a>, or perhaps use <a href=\"http://man7.org/linux/man-pages/man3/sscanf.3.html\" rel=\"nofollow\">sscanf(3)</a> (with e.g. a control string containing <code>%70[A-Za-z]</code>...)</p>\n\n<p>Things would become more complex if you want to parse <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow\">UTF-8</a> strings (since non-latin letters -like the Russian <a href=\"https://en.wikipedia.org/wiki/Yery\" rel=\"nofollow\">yery</a> e.g. <code>\u042b</code>- have multi-byte encoding). Then use some <a href=\"https://en.wikipedia.org/wiki/Unicode\" rel=\"nofollow\">Unicode</a> library like <a href=\"http://www.gnu.org/software/libunistring/\" rel=\"nofollow\">libunistring</a></p>\n"}, {"tags": [], "owner": {"reputation": 458, "user_id": 1045877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574cb3c8f5d01f74fdf77813fe4a5db2?s=128&d=identicon&r=PG", "display_name": "Laurens Ruijtenberg", "link": "https://stackoverflow.com/users/1045877/laurens-ruijtenberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1439384296, "creation_date": 1439384296, "answer_id": 31965962, "question_id": 31965756, "link": "https://stackoverflow.com/questions/31965756/c-how-to-store-words-in-a-char-pointer-from-the-user-input/31965962#31965962", "title": "C how to store words in a char pointer from the user input", "body": "<p>Strings in C don't have all the fancy stuff that Strings in Java or C#/.Net have. C strings are basically array's of char which are ended by a '\\0' character. So when a function is doing operations on C string it starts reading characters at the memory location as specified by your char* pointer and goes on reading until it finds a '\\0' character in the string. If it doesn't find a '\\0' character it will go on reading characters until it hits an error because it's trying to read memory in a non assigned/allocated memory address. ps. You cannot assign void as value as it is a type.</p>\n"}, {"tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": false, "score": 4, "last_activity_date": 1439385437, "last_edit_date": 1439385437, "creation_date": 1439384428, "answer_id": 31966005, "question_id": 31965756, "link": "https://stackoverflow.com/questions/31965756/c-how-to-store-words-in-a-char-pointer-from-the-user-input/31966005#31966005", "title": "C how to store words in a char pointer from the user input", "body": "<p>Three problems:</p>\n\n<ol>\n<li><code>char *read[100];</code> isn't array of <code>char</code>s. It is an array of pointers to <code>char</code>. Change that to <code>char read[100];</code> to get an array of <code>char</code>s of size 100.</li>\n<li><code>printf(\"%s\",*back);</code> is wrong as <code>*back</code> is a <code>char</code> but <code>\u2105s</code> expects a <code>char*</code>. Change it to <code>printf(\"%c\",*back);</code>.</li>\n<li>This <code>for (back = ch; back != read; back--) {</code> should be <code>for (back = ch - 1; back &gt;= read; back--) {</code>. Otherwise, you'll be reading an uninitialized memory location in the first iteration of the loop.</li>\n</ol>\n\n<p>Now that your code is vulnerable to a buffer overflow, i.e, when more than 100 characters are inputted, anything could be the result as your program will read and write from invalid memory locations invoking undefined behavior.</p>\n"}], "owner": {"reputation": 5, "user_id": 4157760, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098020eb22eb3384dc1a109134097379?s=128&d=identicon&r=PG&f=1", "display_name": "jonathan", "link": "https://stackoverflow.com/users/4157760/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2427, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1439385437, "creation_date": 1439383829, "last_edit_date": 1439383960, "question_id": 31965756, "link": "https://stackoverflow.com/questions/31965756/c-how-to-store-words-in-a-char-pointer-from-the-user-input", "title": "C how to store words in a char pointer from the user input", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n    char *read[100];\n    char *ch, *back;\n    int i;\n\n    ch = read;\n\n    printf(\"Enter a sentence and get it reversed: \");\n    while (getchar() != '\\n') {\n        *ch = getchar();\n        ch++;\n    }\n\n    for (back = ch; back != read; back--) {\n        printf(\"%s\",*back);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here's my code. Does is it possible to store Strings in a Array or a pointer. This language is old. For exampel if the user wrote void and null the output should be null and void. And i tries this with a pointer to char array and want to just print the word backwords and it dosen't do anything. Whats wrong with my code?</p>\n"}, {"tags": ["c", "singly-linked-list"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1439383413, "post_id": 31965536, "comment_id": 51838112, "body": "<a href=\"https://en.wiktionary.org/wiki/TL;DR\" rel=\"nofollow noreferrer\">TL;DR!</a>. Please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us instead."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1439383506, "post_id": 31965536, "comment_id": 51838198, "body": "<code>list-&gt;head-&gt;next==NULL</code>  this condition in <code>if</code> you assume list is empty but list can have 1 node only. That should be taken care of .You should check if <code>head</code> is null or not for empty list."}, {"owner": {"reputation": 2027, "user_id": 270654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db8e6e1cf36dfcc4c4d59e4b5827344?s=128&d=identicon&r=PG", "display_name": "nemetroid", "link": "https://stackoverflow.com/users/270654/nemetroid"}, "edited": false, "score": 2, "creation_date": 1439384106, "post_id": 31965536, "comment_id": 51838734, "body": "I&#39;m having a hard time understanding how this code executes at all without segfaulting. In <code>getList</code>, you first call <code>makeEmptyList</code> which sets <code>list-&gt;head=NULL</code>, then you call <code>insertDataToEndList</code> which accesses <code>list-&gt;head-&gt;next</code> (i.e. dereferencing the null pointer <code>list-&gt;head</code>). When I compile and run the program it crashes at this point."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439387164, "post_id": 31965536, "comment_id": 51841238, "body": "<a href=\"http://stackoverflow.com/a/605858/3233393\">Please don&#39;t cast the result of <code>malloc()</code></a>."}, {"owner": {"reputation": 6824, "user_id": 3202093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004496564514/picture?type=large", "display_name": "sp2danny", "link": "https://stackoverflow.com/users/3202093/sp2danny"}, "edited": false, "score": 0, "creation_date": 1439387946, "post_id": 31965536, "comment_id": 51841844, "body": "does have to be singly linked? a doubly liked list with a sentry node is a lot easier to verify for correctness. see <a href=\"http://pastebin.com/HC1DLK4M\" rel=\"nofollow noreferrer\">example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 5194429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b14755584451bd9307ed253fe9790e?s=128&d=identicon&r=PG&f=1", "display_name": "V. Couvignou", "link": "https://stackoverflow.com/users/5194429/v-couvignou"}, "is_accepted": false, "score": 1, "last_activity_date": 1439388027, "last_edit_date": 1439388027, "creation_date": 1439385016, "answer_id": 31966263, "question_id": 31965536, "link": "https://stackoverflow.com/questions/31965536/c-linked-list-inserting-node-at-the-end-without-replacing-previous-node/31966263#31966263", "title": "C linked list inserting node at the end without replacing previous node", "body": "<p>In this function, you access to list->head->next but on the first\ninsertDataToEndList, list->head == NULL since you used makeEmptyList so\nthe result will be a segmentation fault. Also, you want to check if the\nlist is Empty so do list->head == NULL instead.</p>\n\n<pre><code>void insertDataToEndList(List *list, int num)\n{    \n    ListNode *cell_to_add= createCell (num);\n    if (list-&gt;head-&gt;next==NULL)\n        addToEmtyList(list, cell_to_add);\n    else\n        addToEndList(list, cell_to_add);\n}\n</code></pre>\n\n<p>In this method, you have to set the first and the last node of your list,\nnot the next so replace by list->head and list->tail instead of lis->head->nest.\nand list->tail->next.</p>\n\n<pre><code>void addToEmtyList(List *list, ListNode *cell)\n{\n    list-&gt;head-&gt;next=list-&gt;tail-&gt;next=cell;\n\n}\n</code></pre>\n\n<p>You can do that instead :</p>\n\n<pre><code>ListNode *createCell (int num)\n{\n    ListNode *cell=(ListNode*)malloc(sizeof(ListNode));\n    if (!cell)\n    {\n        printf(\"memory allocation failed\\n\");\n        exit(1);\n    }\n    int *temp = (int*)malloc(sizeof(int));\n    *temp = num;\n    cell-&gt;dataPtr=temp;\n    cell-&gt;next=NULL;\n\n    return cell;\n}\n</code></pre>\n\n<p>Else, I advise you to do one assignement by line to be more lisible.</p>\n"}, {"tags": [], "owner": {"reputation": 2027, "user_id": 270654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db8e6e1cf36dfcc4c4d59e4b5827344?s=128&d=identicon&r=PG", "display_name": "nemetroid", "link": "https://stackoverflow.com/users/270654/nemetroid"}, "is_accepted": false, "score": 1, "last_activity_date": 1439387514, "creation_date": 1439387514, "answer_id": 31967231, "question_id": 31965536, "link": "https://stackoverflow.com/questions/31965536/c-linked-list-inserting-node-at-the-end-without-replacing-previous-node/31967231#31967231", "title": "C linked list inserting node at the end without replacing previous node", "body": "<p>There are a few errors here. Most are relatively simple pointer errors:</p>\n\n<p>In one place you have</p>\n\n<pre><code>curr_cell2=curr_cell1-&gt;next;\n</code></pre>\n\n<p>where it should be</p>\n\n<pre><code>curr_cell2 = curr_cell2-&gt;next;\n</code></pre>\n\n<p>In <code>addToEmtyList</code>, you have</p>\n\n<pre><code>list-&gt;head-&gt;next=list-&gt;tail-&gt;next=cell\n</code></pre>\n\n<p>but if the list is empty, then both <code>head</code> and <code>tail</code> are null. Similarily, the condition in <code>insertDataToEndList</code> should check <code>list-&gt;head</code> and not <code>list-&gt;head-&gt;next</code>.</p>\n\n<p>A more aggravating error is that you're taking the address of a local variable (<code>num</code>) and saving it in each cell. Saving the address of a local variable is something you should almost <em>never</em> do, since the pointer will become invalid as soon as you leave its scope (in this case, when you leave <code>createCell</code>).</p>\n\n<p>What you should do, if you really want to have a pointer to the data, is allocate memory for it separately. I.e.:</p>\n\n<pre><code>ListNode *createCell (int num){\n    ListNode *cell=(ListNode*)malloc(sizeof(ListNode));\n    int *data = malloc(sizeof(*data));\n\n    if (!cell || !data)\n    {\n        printf(\"memory allocation failed\\n\");\n        exit(1);\n    }\n\n    *data = num;\n    cell-&gt;dataPtr=data;\n    cell-&gt;next=NULL;\n\n    return cell;\n}\n</code></pre>\n\n<p>Another option is to change <code>listNode</code> to contain an <code>int</code> instead of an <code>int*</code>. Then you'd have</p>\n\n<pre><code>typedef struct listNode{\n    int data;\n    struct listNode* next;\n}ListNode;\n</code></pre>\n\n<p>and in <code>createCell</code> simply</p>\n\n<pre><code>cell-&gt;data = num;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5219242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94457a40fafe48b2a3aa3e440919c073?s=128&d=identicon&r=PG&f=1", "display_name": "mirit", "link": "https://stackoverflow.com/users/5219242/mirit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1439388027, "creation_date": 1439383235, "last_edit_date": 1439384545, "question_id": 31965536, "link": "https://stackoverflow.com/questions/31965536/c-linked-list-inserting-node-at-the-end-without-replacing-previous-node", "title": "C linked list inserting node at the end without replacing previous node", "body": "<p>I'm having some trouble with my insertion method for a linked list in C. It looks like every insertion i make only replaces the previous one. so at the end the list always contains only one cell . i think the problem starts with \"insertToEndList\" function. Do you see any reason why it's failing?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct listNode{\n    int* dataPtr;\n    struct listNode* next;\n}ListNode;\n\ntypedef struct list\n{\n    ListNode* head;\n    ListNode* tail;\n}List;\n\nvoid deleteFromBeginnigOfList (List *list);\nvoid deallocateListCell (ListNode *cell);\nvoid freeList (List *list);\nvoid printList (List *list);\nvoid insertDataToBeginningList (List *list, int num);\nvoid addToBeginningList (List *list, ListNode *cell);\nList merge (List list1, List list2);\nListNode *createCell (int num);\nvoid addToEmtyList(List *list, ListNode *cell);\nvoid addToEndList(List *list, ListNode *cell);\nvoid insertDataToEndList(List *list, int num);\nvoid makeEmptyList(List *list);\nList getList();\nvoid main()\n{\n\n    List lst1, lst2, mergedList;\n\n    lst1 = getList();\n    lst2 = getList();\n    mergedList = merge(lst1,lst2);\n\n    printf(\"Merged list:\\n\");\n    printList(&amp;mergedList);\n\n    freeList(&amp;lst1);\n    freeList(&amp;lst2);\n    freeList(&amp;mergedList);\n\n}\n\nList getList()\n{\n    List res;\n    int size, num, i;\n\n    makeEmptyList(&amp;res);\n\n    printf(\"Please enter the number of items to be entered:\\n\");\n    scanf(\"%d\", &amp;size);\n\n    printf(\"Please enter the numbers:\\n\");\n    for(i = 0; i &lt; size; i++)\n    {\n        scanf(\"%d\", &amp;num);\n        insertDataToEndList(&amp;res, num);\n    }\n\n    return res;\n\n}\nvoid makeEmptyList(List *list){\n    list-&gt;head=list-&gt;tail=NULL;\n}\nvoid insertDataToEndList(List *list, int num){\n\n    ListNode *cell_to_add= createCell (num);\n    if (list-&gt;head==NULL)\n        addToEmtyList(list, cell_to_add);\n    else\n        addToEndList(list, cell_to_add);\n}\nListNode *createCell (int num){\n    ListNode *cell=(ListNode*)malloc(sizeof(ListNode));\n    if (!cell)\n    {\n        printf(\"memory allocation failed\\n\");\n        exit(1);\n    }\n    cell-&gt;dataPtr=&amp;num;\n    cell-&gt;next=NULL;\n\n    return cell;\n}\nvoid addToEmtyList(List *list, ListNode *cell){\n    list-&gt;head=list-&gt;tail=cell;\n}\nvoid addToEndList(List *list, ListNode *cell){\n    list-&gt;tail-&gt;next=cell;\n    list-&gt;tail=cell;\n}\nList merge (List list1, List list2){\n    List merge_res; \n    ListNode *curr_cell1=list1.head, *curr_cell2=list2.head; \n    ListNode *cell_to_add;\n\n    makeEmptyList (&amp;merge_res); \n    while (curr_cell1 &amp;&amp; curr_cell2) \n    {\n        if (*(curr_cell1-&gt;dataPtr)&gt;*(curr_cell2-&gt;dataPtr))\n        {\n            insertDataToEndList(&amp;merge_res, *(curr_cell1-&gt;dataPtr));\n            curr_cell1=curr_cell1-&gt;next;\n        }\n        else\n        {\n            insertDataToEndList(&amp;merge_res, *(curr_cell2-&gt;dataPtr));\n            curr_cell2=curr_cell1-&gt;next;\n        }\n    }\n    while (curr_cell1)\n    {\n        insertDataToEndList(&amp;merge_res, *(curr_cell1-&gt;dataPtr));\n        curr_cell1=curr_cell1-&gt;next;\n    }\n    while (curr_cell2)\n    {\n        insertDataToEndList(&amp;merge_res, *(curr_cell2-&gt;dataPtr));\n        curr_cell2=curr_cell2-&gt;next;\n    }\n    return merge_res;\n}\n\nvoid printList (List *list){\n    ListNode *curr_cell=list-&gt;head;\n\n    while (curr_cell)\n    {\n        printf(\"%d, \", *(curr_cell-&gt;dataPtr));\n        curr_cell=curr_cell-&gt;next;\n    }\n}\nvoid freeList (List *list){\n    while (list-&gt;head)\n        deleteFromBeginnigOfList(list);\n}\nvoid deleteFromBeginnigOfList (List *list){\n    ListNode *cell_to_delete=list-&gt;head;\n    list-&gt;head=list-&gt;head-&gt;next;\n    if (list-&gt;head==NULL)\n        list-&gt;tail=NULL;\n    deallocateListCell (cell_to_delete);\n}\nvoid deallocateListCell (ListNode *cell){\n    free(cell-&gt;dataPtr);\n    free (cell);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "winapi", "win32gui"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1439385204, "post_id": 31965523, "comment_id": 51839659, "body": "<i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers.</i>"}, {"owner": {"reputation": 3558, "user_id": 389833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fc01b03cab64a85b58f30b70190eafb8?s=128&d=identicon&r=PG", "display_name": "Bukes", "link": "https://stackoverflow.com/users/389833/bukes"}, "edited": false, "score": 0, "creation_date": 1439386907, "post_id": 31965523, "comment_id": 51841024, "body": "Please post the problematic dialog definition from your .rc file."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1439387085, "post_id": 31965523, "comment_id": 51841180, "body": "Why are you passing <code>hwnd</code> as the first parameter to <code>CreateDialog()</code>? That first parameter is an <code>HINSTANCE</code>; it needs to be the <code>HINSTANCE</code> passed to <code>WinMain()</code> or <code>DllMain()</code>. Use <code>#define STRICT</code>. Also the cast to <code>DLGPROC</code> is suspicious. Fix your dialog procedure signature. What is it?"}, {"owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "edited": false, "score": 0, "creation_date": 1439387604, "post_id": 31965523, "comment_id": 51841597, "body": "The call to CreateDialog works using the same info with other dialogs using the exact same setup. So I&#39;m not worried about my call, and more worried about the dialog itself."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1439387827, "post_id": 31965523, "comment_id": 51841748, "body": "Try using <code>DS_CONTROL</code> in addition to <code>WS_CHILD</code>?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1439388453, "post_id": 31965523, "comment_id": 51842240, "body": "IMO the problem is totally unrelated to the number of editboxes, but happens in the initialization. Could you show us the dialog procedure? Could you also check the error code, using <code>GetLastError()</code>, after <code>CreateDialog()</code> returns NULL?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1439390042, "post_id": 31965523, "comment_id": 51843580, "body": "To verify that this is related to the EDIT controls, remove the <code>etc...</code> portion of your resource script. Since the dialog manager calls <code>CreateWindowEx</code> for each control, you will have to make sure, that noone interferes with this call. One way for code to interfere with window creation is a hook. Are you (or a library you&#39;re using) calling <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644990.aspx\" rel=\"nofollow noreferrer\">SetWindowsHookEx</a>?"}, {"owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "edited": false, "score": 0, "creation_date": 1439390255, "post_id": 31965523, "comment_id": 51843769, "body": "DS_CONTROL did not change anything. GetLastError() returns 0. I have removed the ETC portion, and have verified that it is only related to the edittexts. The dialog has about 20 edittexts in it, and it does not matter which four+ i leave in, only 3 render and the fourth (presumably) throws the error. I do not believe SetWindowsHookEx is being called at all, but this I will have to verify."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1439390733, "post_id": 31965523, "comment_id": 51844170, "body": "<code>SetWindowsHookEx</code> can also set a <i>global hook</i>. Make sure that you do not have any tools installed in your system, that might induce bugs. To verify this, open your executable in <i>Dependency Walker</i>, note the dependencies, and match them against the <i>Modules</i> list in Visual Studio&#39;s debugger while debugging. Alternatively, set up a virtual machine with a clean OS install for testing."}, {"owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "edited": false, "score": 0, "creation_date": 1439391037, "post_id": 31965523, "comment_id": 51844392, "body": "The development is already being done in a VM, and across 3 different machines the problem persisted. I will have to take a look at the dependencies. Thanks."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1439391202, "post_id": 31965523, "comment_id": 51844544, "body": "Or, even easier, since you have the instruction pointer address printed out as the first value of the exception message, you can match that to the offending module. Visual Studio&#39;s <i>Modules</i> window has an <i>Address</i> column, displaying the memory range where the module resides. This may give you enough of a clue to take it from there."}, {"owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "edited": false, "score": 0, "creation_date": 1439391835, "post_id": 31965523, "comment_id": 51845009, "body": "Good idea. Looks like user32.dll is the one throwing the exception. Time to dig into this more"}, {"owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "edited": false, "score": 0, "creation_date": 1439392833, "post_id": 31965523, "comment_id": 51845682, "body": "As another note, everything is still working fine in the Application file created when I build the solution. So this seems to be deeper than a simple library error."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1439394256, "post_id": 31965523, "comment_id": 51846731, "body": "Hard to understand why you won&#39;t make an MCVE. If you did then you&#39;d isolate the problem yourself. At the moment we have a needle in a haystack."}, {"owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "edited": false, "score": 0, "creation_date": 1439394668, "post_id": 31965523, "comment_id": 51847038, "body": "Its inherited code with a large codebase. I wouldn&#39;t be using win32 unless I had to. Not a lot of options here, so I need to work around the current error."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1439398137, "post_id": 31965523, "comment_id": 51849125, "body": "<code>DlgProc()</code> is still wrong; it should return <code>INT_PTR</code>, not <code>LRESULT</code>. That shouldn&#39;t fix it, but it&#39;ll get rid of the need to cast to <code>DLGPROC</code>. Is your dialog procedure ever called before the crash?"}, {"owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "edited": false, "score": 0, "creation_date": 1439398949, "post_id": 31965523, "comment_id": 51849567, "body": "Yup, the code reaches the DialogProc perfectly fine, and as I said, the same structure works 100% fine for Dialogs with less than 4 Edittexts. WM_INITDIALOG is never called, but presumably that is because the initialization fails on one of the Edittext controls."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1439447823, "post_id": 31965523, "comment_id": 51867643, "body": "Again, it&#39;s hard to understand why you won&#39;t make an MCVE. It&#39;s almost as if you don&#39;t want help."}, {"owner": {"reputation": 6920, "user_id": 4394169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aETL5.jpg?s=128&g=1", "display_name": "Vlad Feinstein", "link": "https://stackoverflow.com/users/4394169/vlad-feinstein"}, "edited": false, "score": 0, "creation_date": 1439993788, "post_id": 31965523, "comment_id": 52090579, "body": "@Jesavino - Could you please show your DlgProc? Alternatively, you can place a breakpoint on its first line and add a watch <code>msg,wm</code>. The <code>CreateDialog()</code> call will cause multiple messages to be sent to your DlgProc: <code>WM_SETFONT</code>, <code>WM_INITDIALOG</code>, and then some.Are you saying you never get <code>WM_INITDIALOG</code>? Then what are you doing in <code>WM_SETFONT</code> handler?"}], "owner": {"reputation": 89, "user_id": 3015783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/363c5f956b06453b7a4cbeed184836e8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesavino", "link": "https://stackoverflow.com/users/3015783/jesavino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439390566, "creation_date": 1439383205, "last_edit_date": 1439390566, "question_id": 31965523, "link": "https://stackoverflow.com/questions/31965523/win32-memory-access-exception-with-4-edittext-controls", "title": "Win32 Memory Access Exception with 4+ Edittext controls", "body": "<p>I am currently working on a project in win32 using Visual Studio 2010. I am encountering a problem where any dialog I have defined in a resource script (.rc) throws a first chance exception after calling CreateDialog IF the specific dialog has more than 3 Edittext's in it. This is consistent across dialogs in the solution. </p>\n\n<p>The memory access error does not cause execution to halt, but it does cause the dialog to not render on the screen. If I add the DS_NOFAILCREATE style flag, the other controls in the dialog will render, but only 3 of the Edittext's will. </p>\n\n<p>When I run the application created from the build process, all of the dialogs render as expected, and it looks like no first chance exceptions are being thrown. </p>\n\n<p>Any clues or insights into this would be very helpful! </p>\n\n<p>What is happening:</p>\n\n<pre><code>// in my cpp file\nHWND myWnd = CreateDialog( hInst, \"MY_DIALOG\" , pHwnd, (DLGPROC) DlgProc);\n\n//in the header, this setup works fine in other pars of the project\nLRESULT CALLBACK DlgProc(HWND, UINT, WPARAM, LPARAM);\n</code></pre>\n\n<p>In this example, myWnd is coming back as NULL, with an error code of 0. The handle is null because of a failure during creation, which seems to occur on the 4th Edittext control in the resource script. This causes the dialog to not appear when I call ShowWindow(). </p>\n\n<p>I am wondering why the CreateDialog is throwing this error ONLY when there are more than 4 Edittext controls. </p>\n\n<p>Adding the rc file</p>\n\n<pre><code>MY_DIALOG DIALOGEX 50, 50, 1000, 1000\nSTYLE DS_SETFONT | WS_CHILD | WS_BORDER | DS_NOFAILCREATE\nFONT 8, \"MS Sans Serif\", 0,0,0x0\nBEGIN\n    EDITTEXT    IDC_EDIT1, 222, 33, 40, 14 , ES_CENTER | ES_AUTOHSCROLL\n    EDITTEXT    IDC_EDIT2, 222, 50, 40, 14 , ES_CENTER | ES_AUTOHSCROLL\n    EDITTEXT    IDC_EDIT3, 222, 65, 40, 14 , ES_CENTER | ES_AUTOHSCROLL\n    EDITTEXT    IDC_EDIT4, 222, 85, 40, 14 , ES_CENTER | ES_AUTOHSCROLL\n    etc...\nEND\n</code></pre>\n\n<p>The error thrown (which does not halt execution) is:</p>\n\n<pre><code>First-chance exception at 0x763aa225 in Program.exe: 0xC0000005: Access violation reading location 0x4c41434f\n</code></pre>\n\n<p>This is thrown 2-3 times PER editbox over the third. </p>\n"}, {"tags": ["c", "parsing", "apdu"], "comments": [{"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1596298233, "post_id": 31965261, "comment_id": 111770211, "body": "Did you find a way to do that in C or C++?"}], "answers": [{"tags": [], "owner": {"reputation": 1850, "user_id": 4963244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e2b8e5dbeeefcfad35b4bcff6ecc1f?s=128&d=identicon&r=PG", "display_name": "iso8583.info support", "link": "https://stackoverflow.com/users/4963244/iso8583-info-support"}, "is_accepted": false, "score": 2, "last_activity_date": 1440022574, "creation_date": 1440022574, "answer_id": 32106543, "question_id": 31965261, "link": "https://stackoverflow.com/questions/31965261/how-to-create-apdu-tlv-parser-in-c/32106543#32106543", "title": "how to create APDU (TLV) parser in C", "body": "<p>To implement EMV TLV data parsing you need to follow <strong>ISO 8825-1 BER-TLV</strong> encoding rules, also known as <strong>ASN.1 Basic Encoding Rules (BER)</strong>.</p>\n\n<p>To be short, to extract correct BER-TLV <em>Value</em> you need analyse <em>Tag</em> and <em>Length</em> bits to get its correct size.</p>\n\n<p>Then your sample buffer will be like this:</p>\n\n<pre><code>tag: \"6F\"\nlen: \"35\" #  // 53\nval:#\"8408454F504343415244A5295006555A4B4152545F2D06757A7275656E87..0B0A\"\n- x84:#\"8408454F504343415244\"\n  - tag: \"84\"\n  - len: \"08\" #  // 8\n  - val: \"454F504343415244\"\n- xA5:#\"A5295006555A4B4152545F2D06757A7275656E8701019F1101019F120655..0B0A\"\n  - tag: \"A5\"\n  - len: \"29\" #  // 41\n  - val:#\"5006555A4B4152545F2D06757A7275656E8701019F1101019F1206555A4B..0B0A\"\n    - x50:#\"5006555A4B415254\"\n      - tag: \"50\"\n      - len: \"06\" #  // 6\n      - val: \"555A4B415254\"\n    - x5F2D:#\"5F2D06757A7275656E\"\n      - tag: \"5F2D\"\n      - len: \"06\" #  // 6\n      - val: \"757A7275656E\"\n    - x87:#\"870101\"\n      - tag: \"87\"\n      - len: \"01\" #  // 1\n      - val: \"01\"\n    - x9F11:#\"9F110101\"\n      - tag: \"9F11\"\n      - len: \"01\" #  // 1\n      - val: \"01\"\n    - x9F12:#\"9F1206555A4B415254\"\n      - tag: \"9F12\"\n      - len: \"06\" #  // 6\n      - val: \"555A4B415254\"\n    - xBF0C:#\"BF0C059F4D020B0A\"\n      - tag: \"BF0C\"\n      - len: \"05\" #  // 5\n      - val:#\"9F4D020B0A\"\n        - x9F4D:#\"9F4D020B0A\"\n          - tag: \"9F4D\"\n          - len: \"02\" #  // 2\n          - val: \"0B0A\"\n</code></pre>\n\n<p>Or, in case you wish to apply EMV analysis:</p>\n\n<pre><code># Cheef's parser.\n# lib   : \"/lib/EMV/\" - EMV - Integrated Circuit Card Specifications for Payment Systems\n# node  : \"TLVs\"\n\nTLVs:#\"6F358408454F504343415244A5295006555A4B4152545F2D06757A727565..0B0A\" # EMV, Tag + Length + Value (TLV) series\n- x6F:#\"6F358408454F504343415244A5295006555A4B4152545F2D06757A727565..0B0A\" # ISO 7816, Template, File Control Parameters and File Management Data (FCI)\n  - tag: \"6F\"\n  - len: \"35\" #  // 53\n  - val:#\"8408454F504343415244A5295006555A4B4152545F2D06757A7275656E87..0B0A\"\n    - x84:#\"8408454F504343415244\" # EMV, Dedicated File (DF) Name\n      - tag: \"84\"\n      - len: \"08\" #  // 8\n      - val:#\"454F504343415244\" # Dedicated File (DF) Name.\n        - RID: \"454F504343\" # Registered Application Provider Identifier (RID)\n        - PIX: \"415244\" # Proprietary Application Identifier Extension (PIX)\n    - xA5:#\"A5295006555A4B4152545F2D06757A7275656E8701019F1101019F120655..0B0A\" # EMV, Template, FCI A5\n      - tag: \"A5\"\n      - len: \"29\" #  // 41\n      - val:#\"5006555A4B4152545F2D06757A7275656E8701019F1101019F1206555A4B..0B0A\"\n        - x50:#\"5006555A4B415254\" # ISO 7816, Application Label\n          - tag: \"50\"\n          - len: \"06\" #  // 6\n          - val: \"555A4B415254\" # Application Label. // UZKART\n        - x5F2D:#\"5F2D06757A7275656E\" # ISO 7816, Language Preference\n          - tag: \"5F2D\"\n          - len: \"06\" #  // 6\n          - val:#\"757A7275656E\" # Language Preference. // uzruen\n            - A21: \"uz\" # ISO 639, Language Code (a2) // Uzbek\n            - A22: \"ru\" # ISO 639, Language Code (a2) // Russian\n            - A23: \"en\" # ISO 639, Language Code (a2) // English\n        - x87:#\"870101\" # EMV, Application Priority Indicator\n          - tag: \"87\"\n          - len: \"01\" #  // 1\n          - val:#\"01\" # Application Priority Indicator.\n            - S01: \"0\" #  // Application may be selected without confirmation of cardholder\n            - S02: \"1\" #  // No priority assigned\n        - x9F11:#\"9F110101\" # EMV, Issuer Code Table Index\n          - tag: \"9F11\"\n          - len: \"01\" #  // 1\n          - val: \"01\" # Issuer Code Table Index. // ISO 8859, Part 1\n        - x9F12:#\"9F1206555A4B415254\" # EMV, Application Preferred Name\n          - tag: \"9F12\"\n          - len: \"06\" #  // 6\n          - val: \"555A4B415254\" # Name, Application Preferred. // UZKART\n        - xBF0C:#\"BF0C059F4D020B0A\" # EMV, FCI Issuer Discretionary Data\n          - tag: \"BF0C\"\n          - len: \"05\" #  // 5\n          - val:#\"9F4D020B0A\" # FCI Issuer Discretionary Data.\n            - x9F4D:#\"9F4D020B0A\" # EMV, Log Entry\n              - tag: \"9F4D\"\n              - len: \"02\" #  // 2\n              - val:#\"0B0A\" # Log Entry.\n                - B01: \"0B\" # SFI containing the cyclic transaction log file (binary) // 11\n                - B02: \"0A\" # Maximum number of records in the transaction log file (binary) // 10\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6033, "user_id": 5128464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25BuB.png?s=128&g=1", "display_name": "vlp", "link": "https://stackoverflow.com/users/5128464/vlp"}, "is_accepted": false, "score": 1, "last_activity_date": 1460716529, "creation_date": 1460716529, "answer_id": 36644826, "question_id": 31965261, "link": "https://stackoverflow.com/questions/31965261/how-to-create-apdu-tlv-parser-in-c/36644826#36644826", "title": "how to create APDU (TLV) parser in C", "body": "<p>I can provide the following code to parse BER-TLV:</p>\n\n<pre><code>int parseTlv(const unsigned char *buffer, int length, void* ctx, int (*tagCallback)(void* ctx, int tag, int length, const unsigned char* value)) {\n    while(length&gt;0) {\n        // Get tag\n        int tag=*(buffer++);\n        int tagLength,tmp;\n        length--;\n        if((tag&amp;0x1F)==0x1F) {\n            if((length--)==0) return -1;\n            tag=(tag&lt;&lt;8)|*(buffer++);\n            if((tag&amp;0x80)==0x80) {\n                if((length--)==0) return -1;\n                tag=(tag&lt;&lt;8)|*(buffer++);\n                if((tag&amp;0x80)==0x80) {\n                    if((length--)==0) return -1;\n                    tag=(tag&lt;&lt;8)|*(buffer++);\n                    if((tag&amp;0x80)==0x80) {\n                        // Longer tags are NOT supported\n                        return -1;\n                    }\n                }\n            }\n        } else {\n            if(tag==0) {\n                continue;\n            }\n        }\n\n        // Get length\n        if((length--)==0) return -1;\n        tmp=*(buffer++);\n        tagLength=0;\n\n        switch(tmp) {\n            case 0x84:\n                if((length--)==0) return -1;\n                tagLength=*(buffer++);\n                /* no break */\n            case 0x83:\n                if((length--)==0) return -1;\n                tagLength=(tagLength&lt;&lt;8)|*(buffer++);\n                /* no break */\n            case 0x82:\n                if((length--)==0) return -1;\n                tagLength=(tagLength&lt;&lt;8)|*(buffer++);\n                /* no break */\n            case 0x81:\n                if((length--)==0) return -1;\n                tagLength=(tagLength&lt;&lt;8)|*(buffer++);\n                break;\n            default:\n                if(tmp&gt;=0x80) {\n                    // Other 8x variants are NOT supported\n                    return -1;\n                }\n                tagLength=tmp;\n                break;\n        }\n\n        // Check value\n        if(tagLength&gt;length) return -1;\n\n        // Process tag\n        if(tagCallback(ctx, tag, tagLength, buffer)&lt;0) {\n            return -1;\n        }\n        buffer+=tagLength;\n        length-=tagLength;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 5022776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba05ad6ef402bcfaac291c177bb50239?s=128&d=identicon&r=PG&f=1", "display_name": "hitman47", "link": "https://stackoverflow.com/users/5022776/hitman47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4753, "favorite_count": 3, "answer_count": 2, "score": 3, "last_activity_date": 1460716529, "creation_date": 1439382524, "question_id": 31965261, "link": "https://stackoverflow.com/questions/31965261/how-to-create-apdu-tlv-parser-in-c", "title": "how to create APDU (TLV) parser in C", "body": "<p>For example I have R-APDU like this</p>\n\n<pre><code>uchar rApdu[] = {0x6F, 0x35 ,0x84 ,0x08 ,0x45 ,0x4F ,0x50 ,\n    0x43 ,0x43 ,0x41 ,0x52 ,0x44 ,0xA5 ,0x29 ,0x50 ,0x06 ,0x55 ,0x5A ,0x4B ,0x41 ,0x52 ,0x54 ,0x5F,\n    0x2D, 0x06 ,0x75 ,0x7A ,0x72 ,0x75 ,0x65 ,0x6E ,0x87 ,0x01 ,0x01 ,0x9F ,0x11 ,0x01 ,0x01 ,0x9F,   \n    0x12 ,0x06 ,0x55 ,0x5A ,0x4B ,0x41 ,0x52 ,0x54 ,0xBF ,0x0C ,0x05 ,0x9F ,0x4D ,0x02 ,0x0B ,0x0A};\n</code></pre>\n\n<p>I want to parse this TLV in C, like on this page: <a href=\"http://www.emvlab.org/tlvutils/?data=6F%2035%2084%2008%2045%204F%2050%20%0D%0A%2043%2043%2041%2052%2044%20A5%2029%2050%2006%2055%205A%204B%2041%2052%2054%205F%20%20%20%0D%0A%202D%2006%2075%207A%2072%2075%2065%206E%2087%2001%2001%209F%2011%2001%2001%209F%20%20%20%0D%0A%2012%2006%2055%205A%204B%2041%2052%2054%20BF%200C%2005%209F%204D%2002%200B%200A\" rel=\"nofollow\">parsed TLV</a></p>\n\n<p>It should parse all tags and their value and take in structure.\nI tried to parse and that's what I got:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n#define uchar unsigned char\n#define uint unsigned int\n#define ushort unsigned short\n\n#define k6f 0x6F\n\ntypedef enum{\n    false,\n    true\n}bool;\n\nstruct TAG{\n    uchar *data;\n    uint len;\n};\nstruct TLVdata{\n    struct TAG s6F;\n    struct TAG s84;\n    struct TAG sA5;\n    struct TAG s50;\n    struct TAG s5F2D;\n    struct TAG s87;\n    struct TAG s9F11;\n    struct TAG s9F12;\n    struct TAG sBF0C;\n    struct TAG s9F4D;\n};\n\nstatic int readTLV(uchar rApdu[]);\n\nint main(void){\n    uchar rApdu[] = {0x6F, 0x35 ,0x84 ,0x08 ,0x45 ,0x4F ,0x50 ,\n        0x43 ,0x43 ,0x41 ,0x52 ,0x44 ,0xA5 ,0x29 ,0x50 ,0x06 ,0x55 ,0x5A ,0x4B ,0x41 ,0x52 ,0x54 ,0x5F,\n        0x2D, 0x06 ,0x75 ,0x7A ,0x72 ,0x75 ,0x65 ,0x6E ,0x87 ,0x01 ,0x01 ,0x9F ,0x11 ,0x01 ,0x01 ,0x9F,   \n        0x12 ,0x06 ,0x55 ,0x5A ,0x4B ,0x41 ,0x52 ,0x54 ,0xBF ,0x0C ,0x05 ,0x9F ,0x4D ,0x02 ,0x0B ,0x0A};\n    if (readTLV(rApdu) == 0)\n        printf(\"ok!\\n\");\n    system(\"PAUSE\");\n    return false;\n}\n\n\n\nstatic int readTLV(uchar rApdu[]){\n    uint i, j, aLen, tLen, tlvIndex;\n    struct TLVdata newtlv;\n    aLen = sizeof(rApdu);\n    tlvIndex = 0;\n\n    switch(rApdu[tlvIndex]){\n        case k6f:\n        tLen = (int)rApdu[++tlvIndex];\n        for(i=0; i &lt;= tLen; i++, ++tlvIndex){\n            if(rApdu[tlvIndex] == 0x84){\n                newtlv.s84.len = (int)rApdu[++tlvIndex];\n                ++tlvIndex;\n                newtlv.s84.data = (char*)malloc(10*sizeof(char));\n                for(j=0; j &lt; newtlv.s84.len; j++, ++tlvIndex){\n                    newtlv.s84.data[j] = rApdu[tlvIndex];\n                }\n                newtlv.s84.data[j] = '\\0';\n                printf(\"%s\\n\", newtlv.s84.data);\n            }\n\n        }\n        break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I found one parser. Only it is written in Java or do not know in what language. Can someone help?\n<a href=\"https://github.com/rrajaguk/ApduParser/blob/master/ParserLib/APDU.cs\" rel=\"nofollow\">apduparser</a></p>\n"}, {"tags": ["c++", "c", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1439382632, "post_id": 31965085, "comment_id": 51837500, "body": "1. You lock and directly unlock <code>mutex</code> in <code>outer</code>. 2. You can&#39;t unlock <code>mutex</code> in <code>inner</code> when it is only locked in <code>outer</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": false, "score": 2, "last_activity_date": 1439384999, "last_edit_date": 1439384999, "creation_date": 1439382713, "answer_id": 31965336, "question_id": 31965085, "link": "https://stackoverflow.com/questions/31965085/helgrind-in-valgrind-complains-with-simple-mutex/31965336#31965336", "title": "helgrind in valgrind complains with simple mutex", "body": "<p>From the man page of <a href=\"http://linux.die.net/man/3/pthread_mutex_lock\" rel=\"nofollow\"><code>pthread_mutex_lock</code></a>:</p>\n\n<blockquote>\n  <p>If a thread attempts to unlock a mutex that it has not locked or a\n  mutex which is unlocked, undefined behavior results.</p>\n</blockquote>\n\n<p>So you have to lock and unlock a mutex in the same thread. </p>\n\n<p>Also your functions should return a value, which matches the prototype.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\npthread_mutex_t mutex;\n\nvoid *inner(void *ptr){\n  size_t threadid = *(size_t *)ptr;\n  int sleepval = rand() % 5 +1;\n  pthread_mutex_lock(&amp;mutex);\n  fprintf(stderr,\"thread: %lu will wait:%d\\n\",threadid,sleepval);\n  fflush(stderr);\n  sleep(sleepval);\n  pthread_mutex_unlock(&amp;mutex);\n  return NULL;\n}\n\nint outer(size_t ntimes){\n  pthread_t thread[ntimes];\n  size_t i, id[ntimes];\n  for(i=0;i&lt;ntimes;i++){\n    id[i] = i;\n    if(pthread_create(thread + i, NULL, inner, &amp;id[i]))\n      fprintf(stderr,\"Problems creating thread\\n\");\n  }\n\n  for(i=0;i&lt;ntimes;i++)\n    pthread_join(thread[i], NULL);\n  return 0;\n}\n\nint main(void){\n\n  pthread_mutex_init(&amp;mutex, NULL);\n  outer(3);\n  return 0;\n}\n</code></pre>\n\n<p>This works for me. I also added the missing headers and changed the function parameter to match the new requirements.</p>\n\n<p>A side note: The <code>outer</code> function uses variable length arrays now, so it is only working in C99, not in C++ (The question is tagged as both).</p>\n"}, {"tags": [], "owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "is_accepted": true, "score": 4, "last_activity_date": 1439384105, "creation_date": 1439384105, "answer_id": 31965876, "question_id": 31965085, "link": "https://stackoverflow.com/questions/31965085/helgrind-in-valgrind-complains-with-simple-mutex/31965876#31965876", "title": "helgrind in valgrind complains with simple mutex", "body": "<p>The immediate issue is that you lock a mutex in one thread and unlock it in a different thread. You also try to lock the same non-recursive  mutex twice in the same thread. Since only the thread which acquired the lock can release it that woukd be a dead-lock.</p>\n\n<p>To achieve the senantic you want you probably want you can just join the newly created thread: the join will block until the corresponding thread exits.</p>\n\n<p>Alternatively you can protect an active thread count which is increamented by the creating thread and decremented by when the thread finishes. The finishing thread would also signal a condition variable. The creating thread would check the count and wait on the condition variable if the count is too high.</p>\n\n<p>Having a processor thread which uses and potentially blocks on a job queue is probably the easiest and most effective approach to limit the number of worker threads.</p>\n"}], "owner": {"reputation": 6088, "user_id": 237472, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5320c763e53994fe8be0626d6b4282b8?s=128&d=identicon&r=PG", "display_name": "monkeyking", "link": "https://stackoverflow.com/users/237472/monkeyking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1851, "favorite_count": 0, "accepted_answer_id": 31965876, "answer_count": 2, "score": 2, "last_activity_date": 1439384999, "creation_date": 1439382110, "question_id": 31965085, "link": "https://stackoverflow.com/questions/31965085/helgrind-in-valgrind-complains-with-simple-mutex", "title": "helgrind in valgrind complains with simple mutex", "body": "<p>Im debugging some threaded code, and was using valgrind --tool=helgrind and for some reason helgrind does not like the simple example below. </p>\n\n<p>Before I start a thread I lock the mutex. In the end of the thread I'm unlocking, and thereby making sure that only one thread can run at a time, by assuming that the mutex will be locked until the thread is finished.</p>\n\n<p>Why is this not valid according to valgrind?</p>\n\n<p>This is a part of a bigger program, where my main program is reading/parsing data it will launch an analysis thread, but I only want one analysis thread running at a time. </p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\npthread_mutex_t mutex;\n\nvoid *inner(void *ptr){\n  size_t threadid=(size_t)ptr;\n  int sleepval = lrand48() % 5 +1;\n  fprintf(stderr,\"thread: %lu will wait:%d\\n\",threadid,sleepval);fflush(stderr);  \n  sleep(sleepval);\n  pthread_mutex_unlock(&amp;mutex);\n}\n\n\n\n\nint outer(size_t ntimes){\n  pthread_t thread1;\n  size_t i;\n  for(i=0;i&lt;ntimes;i++){\n    pthread_mutex_lock(&amp;mutex);\n    if(pthread_create( &amp;thread1, NULL, inner, (void*) i))\n      fprintf(stderr,\"Problems creating thread\\n\");\n  }\n    pthread_mutex_lock(&amp;mutex);\n    pthread_mutex_unlock(&amp;mutex);\n}\n\n\nint main(){\n  pthread_mutex_init(&amp;mutex, NULL);\n  outer(3);\n  return 0;\n}\n\n==8326== Helgrind, a thread error detector\n==8326== Copyright (C) 2007-2013, and GNU GPL'd, by OpenWorks LLP et al.\n==8326== Using Valgrind-3.10.0.SVN and LibVEX; rerun with -h for copyright info\n==8326== Command: ./a.out\n==8326== \nthread: 0 will wait:1\n==8326== ---Thread-Announcement------------------------------------------\n==8326== \n==8326== Thread #1 is the program's root thread\n==8326== \n==8326== ----------------------------------------------------------------\n==8326== \n==8326== Thread #1: Attempt to re-lock a non-recursive lock I already hold\n==8326==    at 0x4C32010: pthread_mutex_lock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400959: outer (threadTest.c:21)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326==  Lock was previously acquired\n==8326==    at 0x4C32145: pthread_mutex_lock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400959: outer (threadTest.c:21)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326== \n==8326== ---Thread-Announcement------------------------------------------\n==8326== \n==8326== Thread #2 was created\n==8326==    at 0x515543E: clone (clone.S:74)\n==8326==    by 0x4E44199: do_clone.constprop.3 (createthread.c:75)\n==8326==    by 0x4E458BA: pthread_create@@GLIBC_2.2.5 (createthread.c:245)\n==8326==    by 0x4C30C90: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400976: outer (threadTest.c:22)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326== \n==8326== ----------------------------------------------------------------\n==8326== \n==8326== Thread #2 unlocked lock at 0x6010A0 currently held by thread #1\n==8326==    at 0x4C325C0: pthread_mutex_unlock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400937: inner (threadTest.c:11)\n==8326==    by 0x4C30E26: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4E45181: start_thread (pthread_create.c:312)\n==8326==    by 0x515547C: clone (clone.S:111)\n==8326==   Lock at 0x6010A0 was first observed\n==8326==    at 0x4C31DDA: pthread_mutex_init (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4009D0: main (threadTest.c:31)\n==8326== \n==8326== ----------------------------------------------------------------\n==8326== \n==8326== Thread #1: Bug in libpthread: recursive write lock granted on mutex/wrlock which does not support recursion\n==8326==    at 0x4C32145: pthread_mutex_lock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400959: outer (threadTest.c:21)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326== \nthread: 1 will wait:4\n==8326== ---Thread-Announcement------------------------------------------\n==8326== \n==8326== Thread #3 was created\n==8326==    at 0x515543E: clone (clone.S:74)\n==8326==    by 0x4E44199: do_clone.constprop.3 (createthread.c:75)\n==8326==    by 0x4E458BA: pthread_create@@GLIBC_2.2.5 (createthread.c:245)\n==8326==    by 0x4C30C90: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400976: outer (threadTest.c:22)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326== \n==8326== ----------------------------------------------------------------\n==8326== \n==8326== Thread #3 unlocked lock at 0x6010A0 currently held by thread #1\n==8326==    at 0x4C325C0: pthread_mutex_unlock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400937: inner (threadTest.c:11)\n==8326==    by 0x4C30E26: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4E45181: start_thread (pthread_create.c:312)\n==8326==    by 0x515547C: clone (clone.S:111)\n==8326==   Lock at 0x6010A0 was first observed\n==8326==    at 0x4C31DDA: pthread_mutex_init (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4009D0: main (threadTest.c:31)\n==8326== \nthread: 2 will wait:1\n==8326== ----------------------------------------------------------------\n==8326== \n==8326== Thread #1: Attempt to re-lock a non-recursive lock I already hold\n==8326==    at 0x4C32010: pthread_mutex_lock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4009B1: outer (threadTest.c:25)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326==  Lock was previously acquired\n==8326==    at 0x4C32145: pthread_mutex_lock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400959: outer (threadTest.c:21)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326== \n==8326== ---Thread-Announcement------------------------------------------\n==8326== \n==8326== Thread #4 was created\n==8326==    at 0x515543E: clone (clone.S:74)\n==8326==    by 0x4E44199: do_clone.constprop.3 (createthread.c:75)\n==8326==    by 0x4E458BA: pthread_create@@GLIBC_2.2.5 (createthread.c:245)\n==8326==    by 0x4C30C90: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400976: outer (threadTest.c:22)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326== \n==8326== ----------------------------------------------------------------\n==8326== \n==8326== Thread #4 unlocked lock at 0x6010A0 currently held by thread #1\n==8326==    at 0x4C325C0: pthread_mutex_unlock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x400937: inner (threadTest.c:11)\n==8326==    by 0x4C30E26: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4E45181: start_thread (pthread_create.c:312)\n==8326==    by 0x515547C: clone (clone.S:111)\n==8326==   Lock at 0x6010A0 was first observed\n==8326==    at 0x4C31DDA: pthread_mutex_init (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4009D0: main (threadTest.c:31)\n==8326== \n==8326== ----------------------------------------------------------------\n==8326== \n==8326== Thread #1: Bug in libpthread: recursive write lock granted on mutex/wrlock which does not support recursion\n==8326==    at 0x4C32145: pthread_mutex_lock (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)\n==8326==    by 0x4009B1: outer (threadTest.c:25)\n==8326==    by 0x4009DA: main (threadTest.c:32)\n==8326== \n==8326== \n==8326== For counts of detected and suppressed errors, rerun with: -v\n==8326== Use --history-level=approx or =none to gain increased speed, at\n==8326== the cost of reduced accuracy of conflicting-access information\n==8326== ERROR SUMMARY: 9 errors from 7 contexts (suppressed: 104 from 61)\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1439381665, "post_id": 31964897, "comment_id": 51836775, "body": "What has C to do with &quot;instructions&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1544337"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1439381761, "post_id": 31964897, "comment_id": 51836854, "body": "@KerrekSB at first a thought a not very optimal compiler might use more instructions for the bitshifts, but after reconsidering, that should not be the case. Thanks."}, {"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1439381802, "post_id": 31964897, "comment_id": 51836883, "body": "Maybe the programmer wanted the code to be less readable! That&#39;s the only thing I can think of!"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439381907, "post_id": 31964897, "comment_id": 51836974, "body": "This code shaves off the 16 highest bits of <code>b</code>, whatever its width is or becomes. Not sure why it would be useful, but yeah."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1544337"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439382003, "post_id": 31964897, "comment_id": 51837044, "body": "@Quentin &quot;whatever its width&quot; - that&#39;s correct. The <code>uint32_t</code> actually comes from a typedef. So, if another type was there (say <code>uint64_t</code>), it would still work. Could that be it?"}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1439382020, "post_id": 31964897, "comment_id": 51837058, "body": "May you tell us where you saw it?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1439382175, "post_id": 31964897, "comment_id": 51837178, "body": "@CamilStaps it&#39;s the only thing I can think of, but I don&#39;t see how that can be useful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1544337"}, "reply_to_user": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1439382222, "post_id": 31964897, "comment_id": 51837209, "body": "@black yeah, but it&#39;s not really interesting. It&#39;s a large project with few users. Anyway, you could head over to <a href=\"http://clean.cs.ru.nl/Download_Clean\" rel=\"nofollow noreferrer\">clean.cs.ru.nl/Download_Clean</a> and download the Linux Complete Sources. In that tarball, navigate to <code>&#47;src&#47;libraries&#47;ObjectIO&#47;ObjectIO&#47;OS Linux&#47;Linux_C_12</code>. Then it&#39;s <code>cCrossCallWindows_121.c</code>, line 641. I now noticed that the <code>uint32_t</code> already was edited, originally, it was <code>int</code> (it is a <code>gint</code>)."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1439382311, "post_id": 31964897, "comment_id": 51837281, "body": "The behaviour can change depending on whether it&#39;s signed or unsigned. For <code>uint32_t</code>, this is identical to the <code>&amp;</code> mask. For <code>int</code>, you might get sign extension on the right shift. What is <code>gint</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1544337"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1439382369, "post_id": 31964897, "comment_id": 51837321, "body": "@Useless it is from <code>qtypes.h</code> from the GLIB library: <code>typedef int gint</code>. This is part of a GTK+ app."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1439382386, "post_id": 31964897, "comment_id": 51837325, "body": "Try it with -1, or 0x8000, and note that &amp; is <i>not</i> the same.  Presumably taking advantage of the undefined sign extension behavior was intentional."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 5, "creation_date": 1439382561, "post_id": 31964897, "comment_id": 51837439, "body": "That last change is pretty radical from unit32_t to int, that is pretty big mistake to make and now that you have answers it makes a difference. I wouldn&#39;t add an answer to this question until the OP clarifies what the deal is."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1439383489, "post_id": 31964897, "comment_id": 51838181, "body": "<a href=\"http://stackoverflow.com/q/1857928/995714\">Right shifting negative numbers in C</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1544337"}, "edited": false, "score": 0, "creation_date": 1439382703, "post_id": 31965278, "comment_id": 51837553, "body": "I didn&#39;t mean to comment that typedef, apologies."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1439382754, "post_id": 31965278, "comment_id": 51837593, "body": "Oh, I thought the <code>uint32_t</code> typedef was in the code and commented out. No worries, anyway."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1439382967, "post_id": 31965278, "comment_id": 51837753, "body": "&quot;will still be negative due to sign extension&quot;  No, the code invokes both undefined and implementation-defined behavior in such a case. There is no telling what such code will do."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1439383359, "post_id": 31965278, "comment_id": 51838069, "body": "Agreed, I added some detail around the portability limitation."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1439383967, "post_id": 31965278, "comment_id": 51838621, "body": "<code>1&lt;&lt;16</code> is UB if <code>int</code> is 16 bit. <code>(uint32_)1 &lt;&lt; 16</code> would be correct."}], "tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 1, "last_activity_date": 1439383091, "last_edit_date": 1439383091, "creation_date": 1439382576, "answer_id": 31965278, "question_id": 31964897, "link": "https://stackoverflow.com/questions/31964897/why-first-bitshifting-left-and-then-right-instead-of-and-ing/31965278#31965278", "title": "Why first bitshifting left and then right, instead of AND-ing?", "body": "<p>For an unsigned integral type (eg, the <code>uint32_t</code> we first thought was being used),</p>\n\n<pre><code>(b &lt;&lt; 16) &gt;&gt; 16\n</code></pre>\n\n<p><em>is</em> identical to <code>b &amp; (1&lt;&lt;16 - 1)</code>.</p>\n\n<p>For a signed integral type though,</p>\n\n<pre><code>(b &lt;&lt; 16)\n</code></pre>\n\n<p>could become negative (ie, the low int16_t would have been considered negative when taken on its own), in which case</p>\n\n<pre><code>(b &lt;&lt; 16) &gt;&gt; 16\n</code></pre>\n\n<p>will (probably) <em>still</em> be negative due to sign extension. In that case, it isn't the same as the <code>&amp;</code> mask, because the top bits will be set instead of zero.</p>\n\n<hr>\n\n<p>Either this behaviour is deliberate (in which case the commented-out typedef is misleading), or it's a bug. I can't tell without reading the code.</p>\n\n<p>Oh, and the shift behaviour in both directions is how I'd expect gcc to behave on x86, but I can't comment on how portable it is outside that. The left-shift may be UB as Lundin points out, and sign extension on the right-shift is implementation defined.</p>\n"}, {"comments": [{"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 1, "creation_date": 1439383362, "post_id": 31965282, "comment_id": 51838074, "body": "I like this answer for throwing the book at OP while they change their question to the dismay of the answerers, but I think you should criticise the assumption that <code>int</code> is 32-bits, certainly not &quot;portable&quot;. Nevertheless, the <code>&amp;</code> as it is is preferable to the shifts to avoid undefined behaviour."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1439383621, "post_id": 31965282, "comment_id": 51838297, "body": "The signed left shift is undefined <i>by the standard</i>. Since part of the point of UB is to allow implementation leeway, it can still be defined <i>by the platform</i>. In practice, gcc has <a href=\"https://gcc.gnu.org/ml/gcc/2000-04/msg00152.html\" rel=\"nofollow noreferrer\">well-defined behaviour including sign extension</a>"}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439384766, "post_id": 31965282, "comment_id": 51839274, "body": "Another rationale you might use is that for an unsigned left operand the upper 16-bits are cleared regardless of the size of the operand. I can&#39;t think of a usecase for this immediately where you might change the size of the operand. Either way I&#39;m deleting my own answer, since it&#39;s redundant after OP&#39;s edits."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 3, "last_activity_date": 1439383020, "last_edit_date": 1439383020, "creation_date": 1439382591, "answer_id": 31965282, "question_id": 31964897, "link": "https://stackoverflow.com/questions/31964897/why-first-bitshifting-left-and-then-right-instead-of-and-ing/31965282#31965282", "title": "Why first bitshifting left and then right, instead of AND-ing?", "body": "<p>Assuming that the size of <code>int</code> is 32 bits, then there is no need to use shifts. Indeed, bitwise &amp; with a mask would be more readable, more portable and safer.</p>\n\n<p>It should be noted that left-shifting on negative signed integers invokes undefined behavior, and that left-shifting things into the sign bits of a signed integer could also invoke undefined behavior. C11 6.5.7 (emphasis mine):</p>\n\n<blockquote>\n  <p>The result of E1 &lt;&lt; E2 is E1 left-shifted E2 bit positions; vacated\n  bits are filled with zeros. If E1 has an unsigned type, the value of\n  the result is E1 \u00d7 2E2, reduced modulo one more than the maximum value\n  representable in the result type. <strong>If E1 has a signed type and\n  nonnegative value, and E1 \u00d7 2E2 is representable in the result type,\n  then that is the resulting value; otherwise, the behavior is\n  undefined.</strong></p>\n</blockquote>\n\n<hr>\n\n<p>(The only possible rationale I can think of, is some pre-mature optimization for a 16-bit CPU that comes with a poor compiler. Then the code would be more efficient if you broke up the arithmetic in 16 bit chunks. But on such a system, <code>int</code> would most likely be 16 bits, so the code wouldn't make any sense then.)</p>\n\n<p>As a side note, it doesn't make any sense to use the signed <code>int</code> type either. The most correct and safe type for this code would have been <code>uint32_t</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1439383200, "post_id": 31965304, "comment_id": 51837955, "body": "Right-shift on signed types with non-negative values is defined in the spec, actually."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439383229, "post_id": 31965304, "comment_id": 51837977, "body": "It is only implementation-defined in case the type is both signed and negative, which isn&#39;t the case here. In order to get there with this code, you would first have to predict the outcome of the undefined behavior of left shifting data into the sign bits."}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439383566, "post_id": 31965304, "comment_id": 51838244, "body": "@Lundin: The question does not outrule negative results for right-shifting."}, {"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1439383682, "post_id": 31965304, "comment_id": 51838375, "body": "@davmac Yeah, the correct way of putting it would be thus: <i>formally, the operation of right shift is only partly defined on domains of signed integral types; thus, the full definition depends on implementation</i>."}, {"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439383843, "post_id": 31965304, "comment_id": 51838517, "body": "@Lundin, I cannot find any wording in the Standard as to left-shifting data into the sign bit causing undefined behavior. Could you provide some substantiation?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439384066, "post_id": 31965304, "comment_id": 51838694, "body": "@AndreyChernyakhovskiy See the quoted part in my answer. &quot;If E1 has a signed type and nonnegative value, and E1 &#215; 2E2 is <b>representable</b> in the result type...&quot; In the case of for example <code>INT_MAX &lt;&lt; 1</code>, the result is (arguably) not representable in an <code>int</code> and therefore undefined behavior."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1439384411, "post_id": 31965304, "comment_id": 51839015, "body": "@AndreyChernyakhovskiy actually the behavior is <i>undefined</i> by the standard if the value is negative. Thus &quot;the full definition depends on the implementation&quot; would be true only if the implementation makes additional guarantees beyond what the standard requires. While many implementations may produce a seemingly predictable result for such a calculation it would be unwise to rely on this."}, {"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439384447, "post_id": 31965304, "comment_id": 51839043, "body": "@Lundin, Curious, I looked up the C++ Standard and it has no such clause. Had no idea C differs here. Apparently, yet another unaccountable tiny discrepancy between the two languages."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439385811, "post_id": 31965304, "comment_id": 51840130, "body": "@AndreyChernyakhovskiy Curious. If the standard doesn&#39;t mention it at all, that&#39;s also undefined behavior, just harder to spot. It would seem that C++03 has identical text as C90, while C99 and C11 explicitly lists this as UB. This has apparently been corrected in C++11, which has the same text as C11."}], "tags": [], "owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "is_accepted": false, "score": 1, "last_activity_date": 1439382633, "creation_date": 1439382633, "answer_id": 31965304, "question_id": 31964897, "link": "https://stackoverflow.com/questions/31964897/why-first-bitshifting-left-and-then-right-instead-of-and-ing/31965304#31965304", "title": "Why first bitshifting left and then right, instead of AND-ing?", "body": "<blockquote>\n  <p>So, the 16 highest bits are discarded.</p>\n</blockquote>\n\n<p>They are not. Though it is formally implementation-defined how right-shift operation is performed on signed types, most compilers do it so as to replicate the sign bit.</p>\n\n<p>Thus, the 16 highest bits are filled by the replicated value of the 15th bit as the result of this expression.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1544337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 31965282, "answer_count": 3, "score": 6, "last_activity_date": 1439383091, "creation_date": 1439381590, "last_edit_date": 1439382690, "question_id": 31964897, "link": "https://stackoverflow.com/questions/31964897/why-first-bitshifting-left-and-then-right-instead-of-and-ing", "title": "Why first bitshifting left and then right, instead of AND-ing?", "body": "<p>I came across this piece of C code:</p>\n\n<pre><code>typedef int gint\n// ...\ngint a, b;\n// ...\na = (b &lt;&lt; 16) &gt;&gt; 16;\n</code></pre>\n\n<p>For ease of notation let's assume that <code>b = 0x11223344</code> at this point. As far as I can see it does the following:</p>\n\n<ul>\n<li><code>b &lt;&lt; 16</code> will give <code>0x33440000</code></li>\n<li><code>&gt;&gt; 16</code> will give <code>0x00003344</code></li>\n</ul>\n\n<p>So, the 16 highest bits are discarded.</p>\n\n<p>Why would anyone write <code>(b &lt;&lt; 16) &gt;&gt; 16</code> if <code>b &amp; 0x0000ffff</code> would work as well? Isn't the latter form more understandable? Is there any reason to use bitshifts in a case like this? Is there any edge-case where the two could not be the same?</p>\n"}, {"tags": ["c", "linux", "stdin", "input-buffer"], "comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1439378858, "post_id": 31963835, "comment_id": 51834904, "body": "You should add &quot;linux&quot; as a tag, since this is system-dependent, and from your &quot;/bin/stty raw&quot; (and statistics) I assume you are on Linux?"}, {"owner": {"reputation": 1191, "user_id": 2713198, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zOKTu.png?s=128&g=1", "display_name": "bytestorm", "link": "https://stackoverflow.com/users/2713198/bytestorm"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1439378926, "post_id": 31963835, "comment_id": 51834947, "body": "@ThomasPadron-McCarthy yes, I am in ubuntu"}, {"owner": {"reputation": 59, "user_id": 2367424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a303052924a839c88b5edabb7fc3a?s=128&d=identicon&r=PG", "display_name": "ArBel", "link": "https://stackoverflow.com/users/2367424/arbel"}, "edited": false, "score": 0, "creation_date": 1439379278, "post_id": 31963835, "comment_id": 51835200, "body": "Look here: <a href=\"http://stackoverflow.com/questions/7469139/what-is-equivalent-to-getch-getche-in-linux\" title=\"what is equivalent to getch getche in linux\">stackoverflow.com/questions/7469139/&hellip;</a>"}, {"owner": {"reputation": 1169, "user_id": 7731046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4421d9cc740a327082631cf828105f85?s=128&d=identicon&r=PG&f=1", "display_name": "fghzxm", "link": "https://stackoverflow.com/users/7731046/fghzxm"}, "edited": false, "score": 0, "creation_date": 1532100787, "post_id": 31963835, "comment_id": 89862057, "body": "Why not just use the readline library?"}], "answers": [{"comments": [{"owner": {"reputation": 1191, "user_id": 2713198, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zOKTu.png?s=128&g=1", "display_name": "bytestorm", "link": "https://stackoverflow.com/users/2713198/bytestorm"}, "edited": false, "score": 0, "creation_date": 1439380425, "post_id": 31964140, "comment_id": 51835943, "body": "Your code works... But read my question, I said &quot;Keep the default terminal behaviours&quot;, I need it to work exactly like normal terminal. Your code behaves very similar to using <code>system (&quot;&#47;bin&#47;stty raw&quot;);</code>"}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 3, "last_activity_date": 1439379526, "creation_date": 1439379526, "answer_id": 31964140, "question_id": 31963835, "link": "https://stackoverflow.com/questions/31963835/how-to-read-terminals-input-buffer-immediately-after-keypress/31964140#31964140", "title": "How to read terminal&#39;s input buffer immediately after keypress", "body": "<p>On my Linux Machine I use ncurses:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;ncurses.h&gt;\n\nvoid checkArrow(){\n    int ch;\n\n    initscr();\n    raw();\n    keypad(stdscr, TRUE);\n    noecho();\n\n    printw(\"Press q to Exit\\t\");\n\n    do{\n        switch(ch){\n            case KEY_UP: {\n                printw(\"\\n\\nUp Arrow\\n\");\n                printw(\"Press q to Exit\\t\");\n                break;\n            }\n            case KEY_DOWN:{\n                printw(\"\\n\\nDown Arrow\\n\");\n                printw(\"Press q to Exit\\t\");\n                break;\n            }\n            case KEY_LEFT:{\n                printw(\"\\n\\nLeft Arrow\\n\");\n                printw(\"Press q to Exit\\t\");\n                break;\n            }\n            case KEY_RIGHT:{\n                printw(\"\\n\\nRight Arrow\\n\");\n                printw(\"Press q to Exit\\t\");\n                break;\n            }\n        }\n    }while((ch = getch()) != 'q');\n\n    printw(\"\\n\\n\\t\\t\\t-=GoodBye=-!\\n\");\n    refresh();\n    endwin();\n}\n\nint main(){\n    checkArrow();\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n<pre><code>Up Arrow\nPress q to Exit \n</code></pre>\n</blockquote>\n\n<pre><code>Down Arrow\nPress q to Exit \n\nLeft Arrow\nPress q to Exit \n\nRight Arrow\nPress q to Exit \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2346, "user_id": 2294535, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/18P2I.jpg?s=128&g=1", "display_name": "Amrith Krishna", "link": "https://stackoverflow.com/users/2294535/amrith-krishna"}, "edited": false, "score": 0, "creation_date": 1439394257, "post_id": 31969844, "comment_id": 51846733, "body": "@bishal - You might need to fine tune the flags after calling tcgetattr to get it as per your requirments. Here you can see the getchar has become nonblocking. thats why I needed to put the condition for -1"}, {"owner": {"reputation": 1191, "user_id": 2713198, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zOKTu.png?s=128&g=1", "display_name": "bytestorm", "link": "https://stackoverflow.com/users/2713198/bytestorm"}, "edited": false, "score": 1, "creation_date": 1439451421, "post_id": 31969844, "comment_id": 51869733, "body": "Thanks this is the code I was looking for. I had to do some more tweaking to get a similar behaviour like terminal. I have added my the code above."}, {"owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "edited": false, "score": 0, "creation_date": 1598797212, "post_id": 31969844, "comment_id": 112568739, "body": "\ud83d\ude02! a variable named <code>newt</code>"}], "tags": [], "owner": {"reputation": 2346, "user_id": 2294535, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/18P2I.jpg?s=128&g=1", "display_name": "Amrith Krishna", "link": "https://stackoverflow.com/users/2294535/amrith-krishna"}, "is_accepted": true, "score": 6, "last_activity_date": 1439394118, "creation_date": 1439394118, "answer_id": 31969844, "question_id": 31963835, "link": "https://stackoverflow.com/questions/31963835/how-to-read-terminals-input-buffer-immediately-after-keypress/31969844#31969844", "title": "How to read terminal&#39;s input buffer immediately after keypress", "body": "<p>It seems you are looking for something like this.</p>\n\n<p>The program essentially waits for user input. If up arrow key is pressed, the program prints \"Arrow key pressed\" and then exits. If anything else is pressed, it waits for the user to complete what he is typing and prints it, then exits.</p>\n\n<pre><code>#include &lt;termios.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\nint main()\n{\n  struct termios oldt, newt;\n  char ch, command[20];\n  int oldf;\n\n  tcgetattr(STDIN_FILENO, &amp;oldt);\n  newt = oldt;\n  newt.c_lflag &amp;= ~(ICANON | ECHO);\n  tcsetattr(STDIN_FILENO, TCSANOW, &amp;newt);\n  oldf = fcntl(STDIN_FILENO, F_GETFL, 0);\n  fcntl(STDIN_FILENO, F_SETFL, oldf | O_NONBLOCK);\n\n  while(1)\n  {\n    ch = getchar();\n    if (ch == '\\033')\n    { printf(\"Arrow key\\n\"); ch=-1; break;}\n    else if(ch == -1) // by default the function returns -1, as it is non blocking\n    {\n      continue;\n    }\n    else\n    {\n      break;\n    }\n\n  }\n  tcsetattr(STDIN_FILENO, TCSANOW, &amp;oldt);\n  fcntl(STDIN_FILENO, F_SETFL, oldf);\n\n   if(ch != EOF)\n   {\n      ungetc(ch,stdin);ith\n      putchar(ch);\n      scanf(\"%s\",command);\n      printf(\"\\n%s\\n\",command);\n\n      return 1;\n    }\n\n    return 0;\n  }\n</code></pre>\n"}], "owner": {"reputation": 1191, "user_id": 2713198, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zOKTu.png?s=128&g=1", "display_name": "bytestorm", "link": "https://stackoverflow.com/users/2713198/bytestorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3204, "favorite_count": 1, "accepted_answer_id": 31969844, "answer_count": 2, "score": 4, "last_activity_date": 1439451607, "creation_date": 1439378690, "last_edit_date": 1495541730, "question_id": 31963835, "link": "https://stackoverflow.com/questions/31963835/how-to-read-terminals-input-buffer-immediately-after-keypress", "title": "How to read terminal&#39;s input buffer immediately after keypress", "body": "<p>I want to read arrow keypresses in my c program and replace them(immediately in the terminal itself) by some other string. I am trying to implement the bash history functionality as in unix terminals. I wrote this code.</p>\n\n<pre><code>int\nmain(int argc, char *argv[])\n{\n    char c;\n    char str[1024];\n    int i = 0;\n    while((c = fgetc(stdin)) != '\\n'){\n      if(((int)c) == 27){\n        c=fgetc(stdin);\n        c=fgetc(stdin);\n        if (c == 'A')\n        {\n          printf(\"%c[A%c[2K\",27, 27);\n          printf(\"UP\");\n        }\n      }\n      str[i++] = c;\n    }\n    printf(\"\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>But, this doesn't work because terminals wait for a newline or EOF to send the input buffer to stdin. So, I have to press enter/return key to analyze the user input.</p>\n\n<p>Here in this <a href=\"https://stackoverflow.com/a/1799024/2713198\">answer</a> the user mentioned to use <code>system (\"/bin/stty raw\");</code> but this replaces all the default terminal behaviours (e.g. backspace, delete etc). </p>\n\n<p>So, is there any way I can read/manipulate the terminals input buffer directly and tweak the buffer itself if arrow keypress is detected?</p>\n\n<p><strong>Environment - Ubuntu (Linux)</strong></p>\n\n<p><strong>Update 1:</strong> Is there a method to change the signal/interrupt (default is pressing enter key) that makes the terminal send the stored input to buffer? This may also help me achieve the same behaviour.</p>\n\n<p><strong>Final Code:</strong></p>\n\n<p>I found out the ASCII characters for specific keypresses by checking output of <code>strace bash</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;termios.h&gt;\n\n#define ESCAPE '\\33'\n#define BACKSPACE '\\177'\n#define DELETE '~'\n\nint main(){\n    struct termios termios_p;\n    struct termios termios_save;\n    tcgetattr(0, &amp;termios_p);\n    termios_save = termios_p;\n\n    termios_p.c_lflag &amp;= ~(ICANON|ECHO);\n    tcsetattr(0,TCSANOW, &amp;termios_p);\n    char buff;\n    while(read(0, &amp;buff, 1) &gt;= 0){\n        if(buff &gt; 0){\n            if(buff == ESCAPE){\n                read(0, &amp;buff, 1);\n                read(0, &amp;buff, 1);\n                if(buff == 'A'){\n                    write(2, \"up\", 2);\n                }else if(buff == 'B'){\n                    write(2, \"down\", 4);\n\n                }else if(buff == 'C'){\n                    write(2, \"\\33[C\", 3);\n\n                }else if(buff == 'D'){\n                    write(2, \"\\10\", 2);                    \n                }\n            }else if(buff == BACKSPACE){\n                write(2, \"\\10\\33[1P\", 5);\n            }else if(buff == DELETE){\n                write(2, \"\\33[1P\", 4);\n            }else{\n                write(2,&amp;buff,1);\n            }\n            // write(2,&amp;buff,1);\n            if(buff == 'q'){\n                break;\n            }\n        }\n    }\n    tcsetattr(0,TCSANOW, &amp;termios_save);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "performance", "parallel-processing", "pthreads"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439394522, "post_id": 31963818, "comment_id": 51846926, "body": "The condition in your <code>while()</code>-loop is <i>never</i> true. <code>man pthread_cond_wait: [...]RETURN VALUE All condition variable functions return 0 on  success  and  a  non-zero error code on error. ERRORS pthread_cond_init,   pthread_cond_signal,  pthread_cond_broadcast and pthread_cond_wait never return an error code.[...]</code>. So the first condition of the <code>&amp;&amp;</code> is always false, and short-circuit evaluation means the second condition isn&#39;t even checked."}, {"owner": {"reputation": 2169, "user_id": 1311827, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0a1d005e0309fe9522853ebd7e5d60da?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/1311827/sean"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439405232, "post_id": 31963818, "comment_id": 51853039, "body": "@EOF <code>pthread_cond_wait</code> returns non-zero when it is not waked up by <code>pthread_cond_signal</code> or <code>pthread_cond_broadcast</code>. I am not sure why the man page says it never returns an error code, maybe the implementation can ensure this never happen? Anyway, putting <code>pthread_cond_wait</code> in <code>while()</code> should not be the problem. The second condition is not quite necessary in this case because there are only two threads here, however, I should change the order of the conditions for <code>&amp;&amp;</code> in a more general case."}, {"owner": {"reputation": 2169, "user_id": 1311827, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0a1d005e0309fe9522853ebd7e5d60da?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/1311827/sean"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1439405776, "post_id": 31963818, "comment_id": 51853358, "body": "@EOF Actually, the fact that <code>pthread_cond_wait</code> is never true is the best possible outcome for us in terms of performance."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439487636, "post_id": 31963818, "comment_id": 51894079, "body": "the posted code displays a &#39;race&#39; condition.  strongly suggest re-thinking the logic/execution flow."}, {"owner": {"reputation": 2169, "user_id": 1311827, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0a1d005e0309fe9522853ebd7e5d60da?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/1311827/sean"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439550594, "post_id": 31963818, "comment_id": 51919609, "body": "@user3629249 Do you mind elaborating your point? Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 2169, "user_id": 1311827, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0a1d005e0309fe9522853ebd7e5d60da?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/1311827/sean"}, "edited": false, "score": 0, "creation_date": 1439386810, "post_id": 31965899, "comment_id": 51840952, "body": "Thank you for your response. As I described in the question, there are two threads, and their IDs are 0 and 1 which are fixed. So for thread 0, my_rank is 0 and dest is 1. Similar for thread 1. In &quot;You should always call pthread_cond_signal() under the protection of the same mutex used with the condition variable being signaled.&quot;, I guess it is talking about a single condition variable, but I am using two condition variables here. Maybe I did not understand this right."}], "tags": [], "owner": {"reputation": 323, "user_id": 3960421, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec7fd7be4cac79a4647d71617ecc6a08?s=128&d=identicon&r=PG&f=1", "display_name": "evoliptic", "link": "https://stackoverflow.com/users/3960421/evoliptic"}, "is_accepted": false, "score": 1, "last_activity_date": 1439384161, "creation_date": 1439384161, "answer_id": 31965899, "question_id": 31963818, "link": "https://stackoverflow.com/questions/31963818/use-pthread-condition-variable-in-ping-pong-test/31965899#31965899", "title": "Use pthread condition variable in ping-pong test", "body": "<p>first of all, sorry, i wanted to put that into comment but i still can not.</p>\n\n<p>Well, in your code, i don't understand much what is \"my_rank\" and \"dest\", as i think my_rank should maybe vary within those loops, but i have found the following that may help you : <a href=\"http://www.cs.cf.ac.uk/Dave/C/node31.html#SECTION003125000000000000000\" rel=\"nofollow\">http://www.cs.cf.ac.uk/Dave/C/node31.html#SECTION003125000000000000000</a></p>\n\n<p>there it's said : </p>\n\n<blockquote>\n  <p>You should always call pthread_cond_signal() under the protection of the same mutex used with the condition variable being signaled. Otherwise, the condition variable could be signaled between the test of the associated condition and blocking in pthread_cond_wait(), which can cause an infinite wait.</p>\n</blockquote>\n\n<p>As you're using multiple mutexes in the first version, that may be the reason.</p>\n\n<p>an admin could move that to comments, please?</p>\n"}, {"tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 1, "last_activity_date": 1439429431, "creation_date": 1439429431, "answer_id": 31978073, "question_id": 31963818, "link": "https://stackoverflow.com/questions/31963818/use-pthread-condition-variable-in-ping-pong-test/31978073#31978073", "title": "Use pthread condition variable in ping-pong test", "body": "<p>The problem is in this line:</p>\n\n<pre><code>while (pthread_cond_wait(&amp;cond[my_rank], &amp;mutex[my_rank]) &amp;&amp; messages[my_rank]!=dest);\n</code></pre>\n\n<p>If the 'dest' thread gets scheduled after you unlock <code>mutex[dest]</code> and before you lock <code>mutex[my_rank]</code>, it will set <code>messages[my_rank]</code> and signal the condition variable, <em>before</em> this thread calls <code>pthread_cond_wait()</code>, so this thread will wait forever.</p>\n\n<p>The fix for this is very easy: test <code>messages[my_rank]</code> <em>before</em> waiting on the condition variable.  You also don't want <code>&amp;&amp;</code> here, because you always want to keep looping as long as <code>messages[my_rank] != dest</code> is true - you don't want to break out at the first non-zero return from <code>pthread_cond_wait()</code>.  So if you want to ignore errors from <code>pthread_cond_wait()</code> (as your original does, and this is perfectly fine if you aren't using error-checking or robust mutexes, since those are the only times <code>pthread_cond_wait()</code> is allowed to fail), use:</p>\n\n<pre><code>while (messages[my_rank] != dest)\n    pthread_cond_wait(&amp;cond[my_rank], &amp;mutex[my_rank]);\n</code></pre>\n\n<p>The reason that your alternate version doesn't have this bug is because the lock is continuously held between signalling the <code>dest</code> thread and waiting on the condition variable, so the <code>dest</code> thread doesn't get a chance to run until we're definitely waiting.</p>\n\n<hr>\n\n<p>As for your supplementary question:</p>\n\n<blockquote>\n  <p>Is it correct for two condition variable sharing a single mutex?</p>\n</blockquote>\n\n<p>Yes, this is allowed, but the converse is not (you <strong>cannot</strong> have two threads waiting on the same condition variable at the same time, using different mutexes).</p>\n"}], "owner": {"reputation": 2169, "user_id": 1311827, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0a1d005e0309fe9522853ebd7e5d60da?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/1311827/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 779, "favorite_count": 0, "accepted_answer_id": 31978073, "answer_count": 2, "score": 3, "last_activity_date": 1439456534, "creation_date": 1439378650, "last_edit_date": 1439456534, "question_id": 31963818, "link": "https://stackoverflow.com/questions/31963818/use-pthread-condition-variable-in-ping-pong-test", "title": "Use pthread condition variable in ping-pong test", "body": "<p>I am using pthread condition variable as a synchronization primitive in a ping-pong test. The ping-pong test consists of two threads execute alternatively. Each thread writes to the other thread's memory and wake it up using signal, then wait and sleep on its own memory which will be written by the other thread later. Here is my first version. It works fine when I loop this ping-pong test for 10,000 times, but when I change to 100,000 times, it will hang occasionally. N=1,000,000 will make it hang definitely. I tried to debug and print out the loop number for each loop, but the program never hangs again after I add the print statement, which is annoying. Here is the ping-pong test code:</p>\n\n<pre><code>for(i=0; i&lt;N+1; i++)\n{\n    if(i==N)\n    {\n        pthread_cond_signal(&amp;cond[dest]);\n        break;\n    }\n    pthread_mutex_lock(&amp;mutex[dest]);\n    messages[dest]=my_rank;\n    pthread_cond_signal(&amp;cond[dest]);\n    pthread_mutex_unlock(&amp;mutex[dest]);\n    pthread_mutex_lock(&amp;mutex[my_rank]);\n    while(pthread_cond_wait(&amp;cond[my_rank], &amp;mutex[my_rank]) &amp;&amp; messages[my_rank]!=dest);\n    messages[my_rank]=my_rank;\n    pthread_mutex_unlock(&amp;mutex[my_rank]);\n    printf(\"rank=%ld i=%ld messages[%ld]=%ld\\n\", my_rank, i, my_rank, messages[my_rank]);\n}\n</code></pre>\n\n<p>Then I tried a second version which works and never hangs, even I set N to 1,000,000. I changed from two mutexes to one mutex which is shared by the two condition variables. I am not sure if it is the right way to go but this one never hangs again. Here is the code:</p>\n\n<pre><code>for(i=0; i&lt;N+1; i++)\n{\n    if(i==N)\n    {\n        pthread_cond_signal(&amp;cond[dest]);\n        break;\n    }\n    pthread_mutex_lock(&amp;mutex[0]);\n    messages[dest]=my_rank;\n    pthread_cond_signal(&amp;cond[dest]);\n    while(pthread_cond_wait(&amp;cond[my_rank], &amp;mutex[0]) &amp;&amp; messages[my_rank]!=dest);\n    messages[my_rank]=my_rank;\n    pthread_mutex_unlock(&amp;mutex[0]);\n}\n</code></pre>\n\n<p>I am very confused. Could somebody help me explain why the first version hangs but the second version does not? Is it correct for two condition variable sharing a single mutex?</p>\n\n<p>Thanks.</p>\n\n<hr>\n\n<p>Thanks for everyone, especially caf. Here is my final code that works without hanging.</p>\n\n<pre><code>for(i=0; i&lt;N+1; i++)\n{\n    pthread_mutex_lock(&amp;mutex[dest]);\n    messages[dest]=my_rank;\n    pthread_cond_signal(&amp;cond[dest]);\n    pthread_mutex_unlock(&amp;mutex[dest]);\n    if(i!=N)\n    {\n        pthread_mutex_lock(&amp;mutex[my_rank]);\n        while(messages[my_rank]!=dest)\n            pthread_cond_wait(&amp;cond[my_rank], &amp;mutex[my_rank]);\n        messages[my_rank]=my_rank;\n        pthread_mutex_unlock(&amp;mutex[my_rank]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1439378629, "post_id": 31963738, "comment_id": 51834757, "body": "where is the <code>main()</code>?"}, {"owner": {"reputation": 2027, "user_id": 270654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db8e6e1cf36dfcc4c4d59e4b5827344?s=128&d=identicon&r=PG", "display_name": "nemetroid", "link": "https://stackoverflow.com/users/270654/nemetroid"}, "edited": false, "score": 1, "creation_date": 1439378707, "post_id": 31963738, "comment_id": 51834814, "body": "Don&#39;t use the same name for different functions."}, {"owner": {"reputation": 1976, "user_id": 5190019, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d8f7c232071e2af43512cff419eb9716?s=128&d=identicon&r=PG&f=1", "display_name": "Asoub", "link": "https://stackoverflow.com/users/5190019/asoub"}, "edited": false, "score": 0, "creation_date": 1439379139, "post_id": 31963738, "comment_id": 51835105, "body": "There should be semicolons at the ends of returns in both function. Also, at what line does the error appears ?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1439383393, "post_id": 31963738, "comment_id": 51838097, "body": "Please <b>edit your question</b> to separate the code chunks (of different files) and give the compilation command"}, {"owner": {"reputation": 13, "user_id": 5217258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d3ed6beb5eca4a7a95c6df96279cef?s=128&d=identicon&r=PG&f=1", "display_name": "Quang.Bui", "link": "https://stackoverflow.com/users/5217258/quang-bui"}, "edited": false, "score": 0, "creation_date": 1439439511, "post_id": 31963738, "comment_id": 51864497, "body": "Thanks for your edition."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1439449369, "post_id": 31963738, "comment_id": 51868513, "body": "The question needs straightening out. It is unclear whether it is a compile time error (as the error message suggests) or a linker error (as the current state of the code suggests)."}], "answers": [{"comments": [{"owner": {"reputation": 4561, "user_id": 14114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2fd42965c021b97da7021923a6df92d5?s=128&d=identicon&r=PG", "display_name": "Ronny Brendel", "link": "https://stackoverflow.com/users/14114/ronny-brendel"}, "edited": false, "score": 0, "creation_date": 1439397706, "post_id": 31965520, "comment_id": 51848860, "body": "what is the downvote for? If you clarify further I&#39;ll edit the answer"}], "tags": [], "owner": {"reputation": 4561, "user_id": 14114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2fd42965c021b97da7021923a6df92d5?s=128&d=identicon&r=PG", "display_name": "Ronny Brendel", "link": "https://stackoverflow.com/users/14114/ronny-brendel"}, "is_accepted": false, "score": -1, "last_activity_date": 1439383876, "last_edit_date": 1439383876, "creation_date": 1439383203, "answer_id": 31965520, "question_id": 31963738, "link": "https://stackoverflow.com/questions/31963738/symbol-multiply-defined/31965520#31965520", "title": "Symbol multiply defined", "body": "<p>After heavily fixing your supplied example (look at the edits) I run into the following error:</p>\n\n<p><code>function_1</code> is defined twice.</p>\n\n<p>I cannot reproduce the error you experience.</p>\n\n<p>Maybe I edited your example in an unintended way. Please change it so that the error you are experiencing occurs.</p>\n"}, {"comments": [{"owner": {"reputation": 4561, "user_id": 14114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2fd42965c021b97da7021923a6df92d5?s=128&d=identicon&r=PG", "display_name": "Ronny Brendel", "link": "https://stackoverflow.com/users/14114/ronny-brendel"}, "edited": false, "score": 0, "creation_date": 1439385311, "post_id": 31965773, "comment_id": 51839749, "body": "Oddly enough, even before editing the question, this error doesn&#39;t occur because of his use of &#39;static&#39;. It worked as intended."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "reply_to_user": {"reputation": 4561, "user_id": 14114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2fd42965c021b97da7021923a6df92d5?s=128&d=identicon&r=PG", "display_name": "Ronny Brendel", "link": "https://stackoverflow.com/users/14114/ronny-brendel"}, "edited": false, "score": 0, "creation_date": 1439391282, "post_id": 31965773, "comment_id": 51844605, "body": "Careful reading of the OP question (all edited versions) turns up an incomplete picture.  Specifically, the error mentions the function with 2 16 bit parameters, and that declaration is in file2.h, not included from main.c, as he said.  So why did the compiler know of it?  Perhaps it&#39;s a linker error report.  But the OP shows no linker details.  The question could be nit-picked to death, but the most important thing is that he get his declarations and definitions and uses consistent."}, {"owner": {"reputation": 13, "user_id": 5217258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d3ed6beb5eca4a7a95c6df96279cef?s=128&d=identicon&r=PG&f=1", "display_name": "Quang.Bui", "link": "https://stackoverflow.com/users/5217258/quang-bui"}, "edited": false, "score": 0, "creation_date": 1439430872, "post_id": 31965773, "comment_id": 51862385, "body": "That&#39;s right. It is a linker error report. And I don&#39;t know how to show the OP this is two function differently. Because, in each file.c , I have functions with same name. I used &quot;Static&quot; in main.c. But it does not make the code better."}, {"owner": {"reputation": 13, "user_id": 5217258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d3ed6beb5eca4a7a95c6df96279cef?s=128&d=identicon&r=PG&f=1", "display_name": "Quang.Bui", "link": "https://stackoverflow.com/users/5217258/quang-bui"}, "edited": false, "score": 0, "creation_date": 1439431196, "post_id": 31965773, "comment_id": 51862445, "body": "The main purpose is  the files .c contain the functions with the same name. But each function has the different work.  And if I want to use file_1.c. I just #include &quot;file_1.h&quot;."}], "tags": [], "owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "is_accepted": true, "score": -1, "last_activity_date": 1439383857, "creation_date": 1439383857, "answer_id": 31965773, "question_id": 31963738, "link": "https://stackoverflow.com/questions/31963738/symbol-multiply-defined/31965773#31965773", "title": "Symbol multiply defined", "body": "<p>C++ permits functions with the same name (with different parameters), but C does not.  You can eliminate your error by just modifying one of those function names.</p>\n"}], "owner": {"reputation": 13, "user_id": 5217258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d3ed6beb5eca4a7a95c6df96279cef?s=128&d=identicon&r=PG&f=1", "display_name": "Quang.Bui", "link": "https://stackoverflow.com/users/5217258/quang-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "accepted_answer_id": 31965773, "answer_count": 2, "score": -3, "last_activity_date": 1439454830, "creation_date": 1439378444, "last_edit_date": 1439454830, "question_id": 31963738, "link": "https://stackoverflow.com/questions/31963738/symbol-multiply-defined", "title": "Symbol multiply defined", "body": "<p>I have some mistake with .c file and .h file here. Could you please help me to find the reason.</p>\n\n<p><strong>file1.h</strong></p>\n\n<pre><code>#ifndef FILE_H_1\n#define FILE_H_1\nu32 function_1(u32 data);\nu32 function_2(u16 data);\n#endif\n</code></pre>\n\n<p><strong>file2.h</strong></p>\n\n<pre><code>#ifndef FILE_H_2\n#define FILE_H_2\nu32 function_1(u32 data);\nu32 function_3(u16 data, u16 reg);\n#endif\n</code></pre>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include \"file1.h\"\nstatic u32 function_3 (u32 data)\n{\n     //do something;\n}\n\nvoid main() {\n     u32 m = function_1(0);\n}\n</code></pre>\n\n<p><strong>file1.c</strong></p>\n\n<pre><code>#include \"file1.h\"\nu32 function_1 (u32 data) {\n      return 2*data;\n}\nu32 function_2(u16 data) {\n      return 3*data;\n}\n</code></pre>\n\n<p><strong>file2.c</strong></p>\n\n<pre><code>#include \"file2.h\"\nu32 function_1(u32 data){\n     return data;\n}\nu32 function_3(u16 data,u16 reg){\n     return 5*data + reg;\n}\n</code></pre>\n\n<p>It compile OK, but it has error linker.\nThe issue is \"u32 function_3(u16 data) incompatible with u32 function_3(u16 data, u16 reg). Although I only #include \"file1.h\" in main.c.</p>\n\n<p>Please help me to fix it.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "visual-studio-2012"], "comments": [{"owner": {"reputation": 9335, "user_id": 1614233, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d240c9dd98ca7a12ea291994dd5c4345?s=128&d=identicon&r=PG", "display_name": "Rohit", "link": "https://stackoverflow.com/users/1614233/rohit"}, "edited": false, "score": 0, "creation_date": 1439378158, "post_id": 31963528, "comment_id": 51834440, "body": "may I ask what is the reason for downvoting it ?"}, {"owner": {"reputation": 4604, "user_id": 711006, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/332d86b71d1ba573668d6620e2121a37?s=128&d=identicon&r=PG", "display_name": "Melebius", "link": "https://stackoverflow.com/users/711006/melebius"}, "edited": false, "score": 0, "creation_date": 1439378180, "post_id": 31963528, "comment_id": 51834452, "body": "You cannot <i>run</i> it? I cannot <i>compile</i> it and the error messages are pretty obvious. <a href=\"https://ideone.com/4xYDl5\" rel=\"nofollow noreferrer\">ideone.com/4xYDl5</a>"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1439378187, "post_id": 31963528, "comment_id": 51834457, "body": "What it is supposed to do ?"}, {"owner": {"reputation": 9335, "user_id": 1614233, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d240c9dd98ca7a12ea291994dd5c4345?s=128&d=identicon&r=PG", "display_name": "Rohit", "link": "https://stackoverflow.com/users/1614233/rohit"}, "reply_to_user": {"reputation": 4604, "user_id": 711006, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/332d86b71d1ba573668d6620e2121a37?s=128&d=identicon&r=PG", "display_name": "Melebius", "link": "https://stackoverflow.com/users/711006/melebius"}, "edited": false, "score": 0, "creation_date": 1439378464, "post_id": 31963528, "comment_id": 51834645, "body": "@Melebius but I cant see any error messages"}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1439378493, "post_id": 31963528, "comment_id": 51834666, "body": "pressing F5 to build and run the program doesn&#39;t work?"}, {"owner": {"reputation": 9335, "user_id": 1614233, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d240c9dd98ca7a12ea291994dd5c4345?s=128&d=identicon&r=PG", "display_name": "Rohit", "link": "https://stackoverflow.com/users/1614233/rohit"}, "reply_to_user": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1439378576, "post_id": 31963528, "comment_id": 51834722, "body": "@CyberSpock All i can see is blank console but when I type my text and hit enter I am not getting the value of <code>nl</code>"}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 1, "creation_date": 1439378608, "post_id": 31963528, "comment_id": 51834742, "body": "Then do CTRL-F5, after the F5 the program runs and terminates so the console window closes. With CTRL-F5 it stays open. Also the stop input use F7 after entering characters in the console."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1439378727, "post_id": 31963528, "comment_id": 51834837, "body": "@kyle  Or use <code>GetChar</code> as you use Visual stdio."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1439378985, "post_id": 31963528, "comment_id": 51834988, "body": "notice this line <code>while ((c = getchar()) != EOF)</code>....any pointers?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1439381897, "post_id": 31963528, "comment_id": 51836967, "body": "Just noticed your post was edited to remove the last call to <code>getchar(c);</code>.  Put it back, as the last line, but without the argument (as several answers have suggested):  simply put:  getchar(); as the last line and because it is a blocking function, your stdout console will stay visible until you enter a key (any key).  In this manner, your results should be visible to you.  (<code>printf(&quot;%d\\n&quot;, nl);</code> should result in a write to stdout )"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1439401716, "post_id": 31963528, "comment_id": 51851116, "body": "It might make sense you learn how to use VC&#39;s debug mode."}], "answers": [{"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 0, "last_activity_date": 1439378330, "last_edit_date": 1439378330, "creation_date": 1439378249, "answer_id": 31963657, "question_id": 31963528, "link": "https://stackoverflow.com/questions/31963528/cannot-run-program/31963657#31963657", "title": "Cannot run program", "body": "<pre><code>getchar(c);\n</code></pre>\n\n<p>See declaration of <code>getchar</code>.</p>\n\n<pre><code>       int getchar(void)\n</code></pre>\n\n<p>It doesn't take any parameter. Didn't it gave you error.</p>\n\n<p>And <code>main</code> should be <code>int main</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4604, "user_id": 711006, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/332d86b71d1ba573668d6620e2121a37?s=128&d=identicon&r=PG", "display_name": "Melebius", "link": "https://stackoverflow.com/users/711006/melebius"}, "edited": false, "score": 3, "creation_date": 1439378352, "post_id": 31963677, "comment_id": 51834563, "body": "He\u2019s using MSVC, not GCC."}, {"owner": {"reputation": 19790, "user_id": 1430607, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AUcNJ.png?s=128&g=1", "display_name": "Luis Sieira", "link": "https://stackoverflow.com/users/1430607/luis-sieira"}, "reply_to_user": {"reputation": 4604, "user_id": 711006, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/332d86b71d1ba573668d6620e2121a37?s=128&d=identicon&r=PG", "display_name": "Melebius", "link": "https://stackoverflow.com/users/711006/melebius"}, "edited": false, "score": 0, "creation_date": 1439378489, "post_id": 31963677, "comment_id": 51834661, "body": "well, then I don&#39;t know what&#39;s the equivalent command-line, I&#39;ll be glad to get my answer edited by someone who knows"}], "tags": [], "owner": {"reputation": 19790, "user_id": 1430607, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/AUcNJ.png?s=128&g=1", "display_name": "Luis Sieira", "link": "https://stackoverflow.com/users/1430607/luis-sieira"}, "is_accepted": false, "score": 0, "last_activity_date": 1439378559, "last_edit_date": 1439378559, "creation_date": 1439378299, "answer_id": 31963677, "question_id": 31963528, "link": "https://stackoverflow.com/questions/31963528/cannot-run-program/31963677#31963677", "title": "Cannot run program", "body": "<p>There are several issues. First, main has to have a type, usually int</p>\n\n<pre><code>- main()\n+ int main()\n</code></pre>\n\n<p>and your program should return an exit status</p>\n\n<p>Secondly getchar takes no arguments, and returns the input</p>\n\n<p><a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_getchar.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/c_standard_library/c_function_getchar.htm</a></p>\n\n<pre><code>- getchar(c)\n+ c = getchar()\n</code></pre>\n\n<p>You can compile your program by calling</p>\n\n<pre><code>gcc -Wall test.c -o test\n</code></pre>\n\n<p>Where test.c is your code, and test is the binary. -Wall will show all the \"warning\" (errors that don't interfere with the program execution)</p>\n"}, {"tags": [], "owner": {"reputation": 357, "user_id": 5205075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ooHmA.jpg?s=128&g=1", "display_name": "Braisly", "link": "https://stackoverflow.com/users/5205075/braisly"}, "is_accepted": false, "score": 0, "last_activity_date": 1439379258, "creation_date": 1439379258, "answer_id": 31964036, "question_id": 31963528, "link": "https://stackoverflow.com/questions/31963528/cannot-run-program/31964036#31964036", "title": "Cannot run program", "body": "<p>I believe that you use Windows, it's better to add:</p>\n\n<pre><code>system(\"pause\");\n</code></pre>\n\n<p>Moreover to use system(\"pause\"), only in Windows, you need to include another library:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n</code></pre>\n\n<p>You can see your results but the problem here, is that you have an infinite loop. Yo need to check the \\n, count and when you have a specific number, you leave from the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1439401603, "post_id": 31964626, "comment_id": 51851063, "body": "Ctrl-C is expected to end the program immidiately."}], "tags": [], "owner": {"reputation": 182, "user_id": 5184415, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203025935607711/picture?type=large", "display_name": "venki", "link": "https://stackoverflow.com/users/5184415/venki"}, "is_accepted": true, "score": 2, "last_activity_date": 1439433429, "last_edit_date": 1439433429, "creation_date": 1439380817, "answer_id": 31964626, "question_id": 31963528, "link": "https://stackoverflow.com/questions/31963528/cannot-run-program/31964626#31964626", "title": "Cannot run program", "body": "<p>The program you posted here is for counting number of lines.</p>\n\n<blockquote>\n  <p>Q. However all I get is blank console and when I type text and press\n  enter,no value is displayed</p>\n</blockquote>\n\n<p>A. Yes it shows nothing because <code>while ((c = getchar()) != EOF)</code> waits until you enter EOF (use ctrl + z then you will get number for lines).</p>\n"}], "owner": {"reputation": 9335, "user_id": 1614233, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d240c9dd98ca7a12ea291994dd5c4345?s=128&d=identicon&r=PG", "display_name": "Rohit", "link": "https://stackoverflow.com/users/1614233/rohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 31964626, "answer_count": 4, "score": 1, "last_activity_date": 1439433429, "creation_date": 1439377871, "last_edit_date": 1439382862, "question_id": 31963528, "link": "https://stackoverflow.com/questions/31963528/cannot-run-program", "title": "Cannot run program", "body": "<p>I started learning C programming with <code>C Programming Language</code> by <strong>Denis M Ritchie</strong> I am trying to execute program from that book</p>\n\n<pre><code>     #include &lt;stdio.h&gt;\n     /* count lines in input */\n     main()\n     {\n         int c, nl;\n         nl = 0;\n         while ((c = getchar()) != EOF)\n         if (c == '\\n')\n         ++nl;\n         printf(\"%d\\n\", nl);\n\n         getchar();\n\n    }\n</code></pre>\n\n<p>However all I get is blank console and when I type text and press enter,no value is displayed.\nI am using Visual Studio 2013 IDE.</p>\n"}, {"tags": ["c", "vim", "syntastic"], "comments": [{"owner": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 0, "creation_date": 1439397107, "post_id": 31963231, "comment_id": 51848512, "body": "Why do you expect <code>g:syntastic_c_config_file</code> to be set if you didn&#39;t set it?  Have you tried enabling debugging to see what&#39;s going on?  Did you read the wiki page for the gcc checker?"}, {"owner": {"reputation": 7673, "user_id": 876937, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6bc562fd4d7d98d1a2688ea44e196968?s=128&d=identicon&r=PG", "display_name": "Xophmeister", "link": "https://stackoverflow.com/users/876937/xophmeister"}, "reply_to_user": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 0, "creation_date": 1439398353, "post_id": 31963231, "comment_id": 51849251, "body": "I have read <a href=\"https://github.com/scrooloose/syntastic/wiki/C%3A---gcc\" rel=\"nofollow noreferrer\">github.com/scrooloose/syntastic/wiki/C%3A---gcc</a> where it suggests that <code>g:syntastic_c_config_file</code> defaults to <code>.syntastic_c_config</code>. Indeed, when this file exists the behaviour is different, so it&#39;s definitely doing something regardless of me explicitly setting the variable... I wasn&#39;t aware of a debugging mode; I&#39;ll try that."}, {"owner": {"reputation": 7673, "user_id": 876937, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6bc562fd4d7d98d1a2688ea44e196968?s=128&d=identicon&r=PG", "display_name": "Xophmeister", "link": "https://stackoverflow.com/users/876937/xophmeister"}, "reply_to_user": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 0, "creation_date": 1439464162, "post_id": 31963231, "comment_id": 51877656, "body": "With <code>let syntastic_debug=63</code>, it appears as though Syntastic <i>is</i> correctly opening the <code>.syntastic_c_config</code> file (regardless of it being unset) and passes those options into the call to <code>gcc</code> (without setting the <code>g:syntastic_c_*</code> options explicitly). The output was complaining that my <code>-L</code> and <code>-l</code> flags were useless: when I removed them from the config, it all started working."}, {"owner": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 1, "creation_date": 1439489229, "post_id": 31963231, "comment_id": 51894919, "body": "According to the maintainer, syntastic doesn&#39;t use the <code>g:syntastic_*</code> variables to keep state.  It uses them to update its internal states <i>at the right moment</i>.  They are still taken into account if you set them.  As for the contents of the config file, you&#39;d typically take the incantation to compile files from the <code>Makefile</code>, and keep only the compilation flags (<code>-l</code> and <code>-L</code> are linker flags).  Some checkers can use compilation databases, but you need to configure them for that.  This is described in the wiki."}], "answers": [{"tags": [], "owner": {"reputation": 7673, "user_id": 876937, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6bc562fd4d7d98d1a2688ea44e196968?s=128&d=identicon&r=PG", "display_name": "Xophmeister", "link": "https://stackoverflow.com/users/876937/xophmeister"}, "is_accepted": true, "score": 2, "last_activity_date": 1439464422, "creation_date": 1439464422, "answer_id": 31986602, "question_id": 31963231, "link": "https://stackoverflow.com/questions/31963231/syntastic-c-configuration-file/31986602#31986602", "title": "Syntastic C configuration file", "body": "<p>It turns out that Syntastic will source the configuration file without explicitly setting the respective variable. Moreover, the contents of the configuration file are not passed into any <code>syntastic_c_*</code> variables, but nonetheless passed into the call to <code>gcc</code>. Syntastic is also clever enough to backtrace to look for the configuration file (e.g., it will go up levels until it finds it, so you can keep the <code>.syntastic_c_config</code> in your project root).</p>\n\n<p>As to why it was failing, the debug log was showing that my compiler was ignoring the library flags (<code>-L/some/path</code> and <code>-lfoo</code>) and that was blocking Syntastic from any further syntax checking. Removing those lines from my config file solved the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 4970085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524a9bd8ccab933d9cb01ffcdb4e415?s=128&d=identicon&r=PG", "display_name": "BReddy", "link": "https://stackoverflow.com/users/4970085/breddy"}, "is_accepted": false, "score": 2, "last_activity_date": 1595108903, "creation_date": 1595108903, "answer_id": 62974131, "question_id": 31963231, "link": "https://stackoverflow.com/questions/31963231/syntastic-c-configuration-file/62974131#62974131", "title": "Syntastic C configuration file", "body": "<p>This is an old post, but I stumbled upon here searching for an answer to the same problem. Looks like Syntastic has changed quite a bit. Documentation listed above by OP is not valid anymore. Current (as of 18 July 2020) documentation is at: <a href=\"https://github.com/vim-syntastic/syntastic/blob/master/doc/syntastic-checkers.txt\" rel=\"nofollow noreferrer\">https://github.com/vim-syntastic/syntastic/blob/master/doc/syntastic-checkers.txt</a></p>\n<p>To add include paths to 'gcc' checker, you would need to create a file with your include dirs, one per line, preceded by '-I'. For example, in <em>/home/user/.syntastic_c_config_file</em> add:</p>\n<pre><code>-I/usr/include/glib-2.0/include\n-I/usr/include/boost\n</code></pre>\n<p>Then in your {vimrc} file (usually, ~/.vimrc), add one line:</p>\n<pre><code>let g:syntastic_c_config_file='/home/user/.syntastic_c_config_file'\n</code></pre>\n<p>Syntastic has become more powerful now and contains many options in the above linked documentation.</p>\n"}], "owner": {"reputation": 7673, "user_id": 876937, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6bc562fd4d7d98d1a2688ea44e196968?s=128&d=identicon&r=PG", "display_name": "Xophmeister", "link": "https://stackoverflow.com/users/876937/xophmeister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2503, "favorite_count": 1, "accepted_answer_id": 31986602, "answer_count": 2, "score": 2, "last_activity_date": 1595108903, "creation_date": 1439377036, "last_edit_date": 1439464468, "question_id": 31963231, "link": "https://stackoverflow.com/questions/31963231/syntastic-c-configuration-file", "title": "Syntastic C configuration file", "body": "<p>In an attempt to add the include paths to Syntastic (3.6.0-106; Vim 7.3), to stop it from giving a fatal error at the first include it can't find, I tried creating a <code>.syntastic_c_config</code> file. There's not a lot of information on how this is supposed to work, but there are references out there and I followed their example:</p>\n\n<pre><code>-I/path/to/include\n-I/you/get/the/idea\n-L/some/library\n-lfoo\n-lbar\n-DHAVE_SOME_FLAG\n-pedantic\n-Wall\n-std=c99\n</code></pre>\n\n<p>That is, one compiler argument per line.</p>\n\n<p>This has had the effect of removing virtually all error checking, unless I force it with <code>:SynasticCheck</code> -- at which point, it seems to work a <em>little</em> bit better, but not exactly how I'd expect. However, either way, if I <code>:echo g:syntastic_c_config_file</code> (or any other option that I'm expecting to be set), Vim just gives me an undefined variable warning.</p>\n\n<p>I'm clearly doing something fundamentally wrong, but I'm not really sure what!</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1439377183, "post_id": 31963198, "comment_id": 51833787, "body": "It seems there is used a language extension of the compiler that allows to use compound statements like expressions."}], "answers": [{"comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 3, "creation_date": 1439381119, "post_id": 31963344, "comment_id": 51836414, "body": "It is a gcc extension, documented here <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html</a>"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1439377378, "creation_date": 1439377378, "answer_id": 31963344, "question_id": 31963198, "link": "https://stackoverflow.com/questions/31963198/what-does-this-kernel-code-mean/31963344#31963344", "title": "What does this kernel code mean?", "body": "<p>It seems that this construction</p>\n\n<pre><code>({ tpos = hlist_entry(pos, typeof(*tpos), member); 1;});\n</code></pre>\n\n<p>is based on its own language extension of the compiler and allows to use compound statements in expressions. It is similar to lambda expressions in C++.</p>\n\n<p>I think that the result of evaluation of the construction has value 1. </p>\n\n<p>In my opinion it is simply a bad code because the same can be written using the comma operator like</p>\n\n<pre><code>pos &amp;&amp; ( ( tpos = hlist_entry(pos, typeof(*tpos), member) ), 1 ); \\\n             pos = pos-&gt;next)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9263, "user_id": 114979, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fd94af0c2af6b774da12b4ad74a1d39f?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/114979/jay"}, "is_accepted": false, "score": 2, "last_activity_date": 1444330558, "last_edit_date": 1444330558, "creation_date": 1439380717, "answer_id": 31964579, "question_id": 31963198, "link": "https://stackoverflow.com/questions/31963198/what-does-this-kernel-code-mean/31964579#31964579", "title": "What does this kernel code mean?", "body": "<p>It's a GCC language extension, \"braced-groups\" within expressions.\nAs @nos said in a comment on the other answer, the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow\">GCC documentation</a> explains it.\nThe expression <code>(EXP1; EXP2; ...; EXPn;)</code> has he value of <code>EXPn</code>.\nYou're supposed to use the others for their side effects -- see this example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    int b;\n    printf(\"%d\\n\", ({ b=3; 2;}) );  \n    printf(\"%d\\n\",b);\n    exit(0);\n}\n</code></pre>\n\n<p>If you compile this with GCC without any compile options, for example, it will print 2, and then 3.</p>\n\n<p>But compiling with <code>-Wall -pedantic</code> forces GCC to strictly follow the standard, rejecting anything that the standard dowsn't allow. It will tell us that this extension is not allowed: </p>\n\n<pre><code>gcc -Wall -pedantic a.c\na.c: In function \u2018main\u2019:\na.c:5:17: warning: ISO C forbids braced-groups within expressions [-Wpedantic]\n  printf(\"%d\\n\", ({ b=3; 2;}) ); \n                 ^\n</code></pre>\n"}], "owner": {"reputation": 1794, "user_id": 2261492, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/51d5547fb6cd7bdf0ca5cb2213943f8f?s=128&d=identicon&r=PG", "display_name": "Mayank", "link": "https://stackoverflow.com/users/2261492/mayank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1444330558, "creation_date": 1439376954, "last_edit_date": 1439381022, "question_id": 31963198, "link": "https://stackoverflow.com/questions/31963198/what-does-this-kernel-code-mean", "title": "What does this kernel code mean?", "body": "<p>I found this in an old kernel code :</p>\n\n<pre><code>#define hlist_for_each_entry(tpos, pos, head, member)                    \\\n        for (pos = (head)-&gt;first;                                        \\\n             pos &amp;&amp;                                                      \\\n                ({ tpos = hlist_entry(pos, typeof(*tpos), member); 1;}); \\\n             pos = pos-&gt;next)\n</code></pre>\n\n<p>but I don't understand how I should interpret the meaning of this line:</p>\n\n<pre><code>({ tpos = hlist_entry(pos, typeof(*tpos), member); 1;});\n</code></pre>\n\n<p>How does the compiler undersand the meaning of more than one expression inside braces/parentheses (the <code>({...;...;})</code> construct)?</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "edited": false, "score": 7, "creation_date": 1439376382, "post_id": 31962908, "comment_id": 51833255, "body": "What do you mean by <i>only the first character of each element will be used</i>? Are they string literals in the real code?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 5, "creation_date": 1439376575, "post_id": 31962908, "comment_id": 51833383, "body": "You don&#39;t have a single question in your text. What is the issue here? Please edit and clarify."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1439376742, "post_id": 31962908, "comment_id": 51833485, "body": "@user1920212 Also it is not clear whether the strings have the same size."}, {"owner": {"reputation": 4625, "user_id": 1964969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0879c1954a7ee8660f80eafdf9f66776?s=128&d=identicon&r=PG", "display_name": "Yury Schkatula", "link": "https://stackoverflow.com/users/1964969/yury-schkatula"}, "edited": false, "score": 0, "creation_date": 1439376909, "post_id": 31962908, "comment_id": 51833581, "body": "Efficiency of a structure depends on its major usage case. This is why we have arrays, lists, trees... What is your major use-case for the data?"}], "answers": [{"tags": [], "owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": false, "score": 1, "last_activity_date": 1439377798, "creation_date": 1439377798, "answer_id": 31963492, "question_id": 31962908, "link": "https://stackoverflow.com/questions/31962908/array-of-string1-type-in-c/31963492#31963492", "title": "Array of [String][1] type in C", "body": "<p>Or you can simply assume first character of string for second value and has simple array of strings (char pointers):</p>\n\n<pre><code>\"astring 1\"\n\"bstring 2\"\n\"astring n\"\n</code></pre>\n\n<p>If your array is <code>char ** str</code> you will access <code>a</code> and <code>b</code> values as <code>str[n][0]</code> and other like <code>str[n] + 1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "is_accepted": true, "score": 2, "last_activity_date": 1446127719, "last_edit_date": 1446127719, "creation_date": 1439378710, "answer_id": 31963838, "question_id": 31962908, "link": "https://stackoverflow.com/questions/31962908/array-of-string1-type-in-c/31963838#31963838", "title": "Array of [String][1] type in C", "body": "<p>Using an array of string pointers is quite typical (it's the same type as the second parameter of <code>main()</code>).</p>\n\n<pre><code>const char *stuff[][2] = {\n    {\"string 1\", \"a\"},\n    {\"string 2\", \"b\"},\n    {\"string n\", \"a\"}\n};\n</code></pre>\n\n<p>The difference here is I have marked the contents as <code>const</code> because we are saving pointers to string literals: this is allowed, but modifying string literals is not, so the <code>const</code> is there for safety.</p>\n"}], "owner": {"reputation": 482, "user_id": 1920212, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcb77bf6d2242db7ea1416e2f610f180?s=128&d=identicon&r=PG&f=1", "display_name": "qwerty", "link": "https://stackoverflow.com/users/1920212/qwerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 31963838, "answer_count": 2, "score": -3, "last_activity_date": 1446127719, "creation_date": 1439376186, "last_edit_date": 1439378676, "question_id": 31962908, "link": "https://stackoverflow.com/questions/31962908/array-of-string1-type-in-c", "title": "Array of [String][1] type in C", "body": "<p>I have a set of values of the following form:</p>\n\n<pre><code>{\"a\" \"string 1\", \"a\"}\n{\"b\" \"string 2\", \"b\"}\n{\"c\" \"string n\", \"a\"}\n</code></pre>\n\n<p>EDIT: If I declare an array like char foo[][/<em>charactersOfString</em>/][/<em>specianUniqueCharacter</em>/], and the third dimension only uses one of the columns, there would exist not required positions that would imply wasting a lot of memory space ([0][0][1] should not exist. [0][0][0] or [1][2][0] should exist).</p>\n\n<p>How can I solve this problem without using a structure or appending the content of column 3 to the end of column 2?</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1439376196, "post_id": 31962302, "comment_id": 51833132, "body": "It is unclear what you are going to do with the pointer."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 2367424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a303052924a839c88b5edabb7fc3a?s=128&d=identicon&r=PG", "display_name": "ArBel", "link": "https://stackoverflow.com/users/2367424/arbel"}, "is_accepted": false, "score": 0, "last_activity_date": 1439375417, "last_edit_date": 1439375417, "creation_date": 1439374988, "answer_id": 31962476, "question_id": 31962302, "link": "https://stackoverflow.com/questions/31962302/how-to-fill-pointer-element-of-struct-with-array-in-c/31962476#31962476", "title": "how to fill pointer element of struct with array in C", "body": "<p>In case you dont trying to set the pData offset, try to use * operator like this:</p>\n\n<pre><code>*(myTag.pData) = number;\n</code></pre>\n\n<p><strong>UPDATE</strong> this in case you want only fill one value in your tag, if you want to copy the whole array see the other answer.</p>\n"}, {"tags": [], "owner": {"reputation": 1353, "user_id": 4309016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhCj8.jpg?s=128&g=1", "display_name": "Krystian Sakowski", "link": "https://stackoverflow.com/users/4309016/krystian-sakowski"}, "is_accepted": true, "score": 2, "last_activity_date": 1439380880, "last_edit_date": 1439380880, "creation_date": 1439375134, "answer_id": 31962531, "question_id": 31962302, "link": "https://stackoverflow.com/questions/31962302/how-to-fill-pointer-element-of-struct-with-array-in-c/31962531#31962531", "title": "how to fill pointer element of struct with array in C", "body": "<p>First of all your <strong>pData must point to some valid buffer</strong> if it points to some valid buffer you can fill it just like that.</p>\n\n<pre><code>for(i=0; i&lt;MAX; i++) {\n    // Note that newData must be this same type or you have\n    // to truncate whatever type you are writing there to char.\n    myTag.pData[i] = newData[i];\n}\n</code></pre>\n\n<p>If you want to copy this same value all over the buffer which I doubt (however your code implies that) just use <strong>memset</strong> standard library function for this purpose.</p>\n\n<p><strong>Please specify on the example what do you want to happen to this buffer and give more context of your use case. It looks like you are beginner and you might need a little bit more help than you asked in order to make your program fine.</strong></p>\n\n<p>Here you have working code example for sth I think you want but you don't know how to ask about it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct tag{ char *pData; };\n\nint main(void) {\n    int i;\n    struct tag myTag;\n    myTag.pData = (char*)malloc(10*sizeof(char));\n    if(NULL == myTag.pData) {\n        return 0;\n    }\n\n    const char *test = \"Hello\";\n\n    for(i=0; i&lt;strlen(test); i++) {\n        myTag.pData[i] = test[i];\n    }\n\n    // Put null termination at the end of string.\n    myTag.pData[i] = '\\0';\n\n    printf(\"%s\", myTag.pData);\n\n    free(myTag.pData);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1353, "user_id": 4309016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhCj8.jpg?s=128&g=1", "display_name": "Krystian Sakowski", "link": "https://stackoverflow.com/users/4309016/krystian-sakowski"}, "edited": false, "score": 0, "creation_date": 1439376054, "post_id": 31962758, "comment_id": 51833043, "body": "The memcpy() function copies n bytes from memory area src to memory area dest.  The memory areas must not overlap.  Function declaration: void *memcpy(void *dest, const void *src, size_t n) Header: &lt;string.h&gt;"}, {"owner": {"reputation": 33, "user_id": 4994694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23df66f763955a1e351ec078988ca2aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sneh Kumar", "link": "https://stackoverflow.com/users/4994694/sneh-kumar"}, "reply_to_user": {"reputation": 1353, "user_id": 4309016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhCj8.jpg?s=128&g=1", "display_name": "Krystian Sakowski", "link": "https://stackoverflow.com/users/4309016/krystian-sakowski"}, "edited": false, "score": 0, "creation_date": 1439376288, "post_id": 31962758, "comment_id": 51833192, "body": "Yep. That would suffice."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1439376307, "post_id": 31962758, "comment_id": 51833202, "body": "The size you allocate is it correct ? Stings have to be <code>null</code> terminated and you fill whole memory without leaving space for <code>null</code> in <code>pData</code>."}, {"owner": {"reputation": 33, "user_id": 4994694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23df66f763955a1e351ec078988ca2aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sneh Kumar", "link": "https://stackoverflow.com/users/4994694/sneh-kumar"}, "edited": false, "score": 0, "creation_date": 1439376613, "post_id": 31962758, "comment_id": 51833399, "body": "Yep. For copying a string MAX+1 memory should be allocated.Moreover myTag.pData[MAX] should be set to &#39;\\0&#39;"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1439376793, "post_id": 31962758, "comment_id": 51833517, "body": "Yes , please update  your answer and let OP know or he may end up with UB ."}], "tags": [], "owner": {"reputation": 33, "user_id": 4994694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23df66f763955a1e351ec078988ca2aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sneh Kumar", "link": "https://stackoverflow.com/users/4994694/sneh-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1439377050, "last_edit_date": 1439377050, "creation_date": 1439375792, "answer_id": 31962758, "question_id": 31962302, "link": "https://stackoverflow.com/questions/31962302/how-to-fill-pointer-element-of-struct-with-array-in-c/31962758#31962758", "title": "how to fill pointer element of struct with array in C", "body": "<p>If you want to fill the array elements into pData then use malloc to allocate memory and then assign values. The following code should be useful</p>\n\n<pre><code>myTag.pData=malloc(MAX*sizeof(char));\nfor(i=0; i&lt;MAX; i++)\n{\n    myTag.pData[i] = newData[i];\n}\n</code></pre>\n\n<p>The mistake in your code is that you are trying to assign a char value to a char pointer.</p>\n\n<p>The above code will reserve memory for an array of characters and make myTag.pData point to the first element of this array.Then, myTag.pData[i] can be used to assign values to the ith element of the array.</p>\n\n<p>If you want to copy a string then the code should be</p>\n\n<pre><code>myTag.pData=malloc((MAX+1)*sizeof(char));\nfor(i=0; i&lt;MAX; i++)\n{\n    myTag.pData[i] = newData[i];\n}\nmyTag.pData[MAX]='\\0';\n</code></pre>\n\n<p>You could also use library function strcpy() by including string.h header file.</p>\n\n<pre><code>myTag.pData=malloc((MAX+1)*sizeof(char));\nstrcpy(myTag.pData,newData);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1439377849, "last_edit_date": 1439377849, "creation_date": 1439377175, "answer_id": 31963273, "question_id": 31962302, "link": "https://stackoverflow.com/questions/31962302/how-to-fill-pointer-element-of-struct-with-array-in-c/31963273#31963273", "title": "how to fill pointer element of struct with array in C", "body": "<p>Because <code>pData</code> is a <code>char *</code> without any space allocated for the data, if you don't need to preserve the contents of array <code>newData</code>, you can simply assign to the pointer:</p>\n\n<pre><code>char newData[10];\nmyTag.pData = newData;\n</code></pre>\n\n<p>Or alternatively create another array fill it then assign to the pointer.</p>\n"}], "owner": {"reputation": 217, "user_id": 5022776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba05ad6ef402bcfaac291c177bb50239?s=128&d=identicon&r=PG&f=1", "display_name": "hitman47", "link": "https://stackoverflow.com/users/5022776/hitman47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1606, "favorite_count": 0, "accepted_answer_id": 31962531, "answer_count": 4, "score": 3, "last_activity_date": 1439380880, "creation_date": 1439374548, "last_edit_date": 1439375385, "question_id": 31962302, "link": "https://stackoverflow.com/questions/31962302/how-to-fill-pointer-element-of-struct-with-array-in-c", "title": "how to fill pointer element of struct with array in C", "body": "<p>I have struct like this</p>\n\n<pre><code>struct tag{ char *pData};\n</code></pre>\n\n<p>I want to fill this element (pData) in loop.</p>\n\n<pre><code>for(i=0; i&lt;MAX; i++){\n    myTag.pData = newData[i]; // question is here!\n}\n</code></pre>\n\n<p>Help me please guys.</p>\n"}, {"tags": ["c", "parallel-processing", "mpi"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5218577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ed2a53c0cd1bc4fdae842b4d0d94bd?s=128&d=identicon&r=PG&f=1", "display_name": "stroopy", "link": "https://stackoverflow.com/users/5218577/stroopy"}, "edited": false, "score": 0, "creation_date": 1439379012, "post_id": 31962857, "comment_id": 51835007, "body": "Thank you for your response, I have now changed the allocation of my arrays, however, I am still getting the same seg fault unfortunately.."}, {"owner": {"reputation": 31, "user_id": 5218577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ed2a53c0cd1bc4fdae842b4d0d94bd?s=128&d=identicon&r=PG&f=1", "display_name": "stroopy", "link": "https://stackoverflow.com/users/5218577/stroopy"}, "edited": false, "score": 0, "creation_date": 1439379689, "post_id": 31962857, "comment_id": 51835444, "body": "Nevermind, I had another silly mistake in my code elsewhere as well. All working now, thank you!"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "reply_to_user": {"reputation": 31, "user_id": 5218577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ed2a53c0cd1bc4fdae842b4d0d94bd?s=128&d=identicon&r=PG&f=1", "display_name": "stroopy", "link": "https://stackoverflow.com/users/5218577/stroopy"}, "edited": false, "score": 0, "creation_date": 1439379805, "post_id": 31962857, "comment_id": 51835520, "body": "@stroopy: To mark this question as answered, please consider accepting the answer. It improves visibility in search and might make it easier for the next person to find"}], "tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": false, "score": 2, "last_activity_date": 1439376054, "creation_date": 1439376054, "answer_id": 31962857, "question_id": 31961482, "link": "https://stackoverflow.com/questions/31961482/mpi-gathering-2d-subarrays/31962857#31962857", "title": "MPI gathering 2D subarrays", "body": "<p>The fundamental problem here is that MPI expects all allocations to be contiguous blocks of memory. Your <code>site</code> and <code>global_site</code> arrays are not, they are arrays of pointers. The MPI routines are just reading past the end of each individual row allocation and causing your segfault.</p>\n\n<p>If you want to allocate an <code>n x n</code> array to use with the MPI then you need to replace this:</p>\n\n<pre><code>  double **global_site;\n  if(rank==0){\n    global_site = malloc(sizeof(double *)*(N));\n    for(i=0; i&lt;N; i++)\n      global_site[i] = malloc(sizeof(double)*(N));\n  }\n</code></pre>\n\n<p>with something like this:</p>\n\n<pre><code>  double *global_site = malloc(sizeof(double)*(N * N));\n</code></pre>\n\n<p>You will obviously need to adjust the rest of your code accordingly.</p>\n\n<p>It seems the only reason you are actually using arrays of pointers is for the convenience of <code>[i][j]</code> style 2D indexing. If you use linear or pitched linear memory, you can easily make a little preprocessor macro or helper function which can give you that style of indexing into row or column major ordered storage which is still compatible with MPI.</p>\n"}], "owner": {"reputation": 31, "user_id": 5218577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ed2a53c0cd1bc4fdae842b4d0d94bd?s=128&d=identicon&r=PG&f=1", "display_name": "stroopy", "link": "https://stackoverflow.com/users/5218577/stroopy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1439379737, "creation_date": 1439372410, "last_edit_date": 1592644375, "question_id": 31961482, "link": "https://stackoverflow.com/questions/31961482/mpi-gathering-2d-subarrays", "title": "MPI gathering 2D subarrays", "body": "<p>I know this has been answered many times before and there is a comprehensive answer <a href=\"https://stackoverflow.com/questions/9269399/sending-blocks-of-2d-array-in-c-using-mpi/9271753#9271753\">here</a> which I have read and attempted to use but I just can't get my code to work for some reason.</p>\n<p>I have stripped my code down a bit to make it a bit easier to follow, but basically what I am trying to do is have each process initialise a sub-array and work on it, then put the whole big array back together on rank 0. <code>MPI_Gatherv</code> is giving me a segfault and I cannot figure out why.</p>\n<p>Any help would be greatly appreciated.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include &lt;mpi.h&gt;\n#define N 32\n\nvoid init_lattice(double **site, int row, int col){\n  int i,j;\n  for(i=0; i&lt;row; i++){\n    for(j=0; j&lt;col; j++){\n      site[i][j]=(drand48()/4294967295.0 + 0.5)*2*M_PI;\n    }\n  }\n}\n\nint main(int argc, char *argv[]){\n\n  int nprocs, rank;\n  MPI_Init(&amp;argc, &amp;argv);\n  MPI_Comm_size (MPI_COMM_WORLD, &amp;nprocs);\n  MPI_Comm_rank (MPI_COMM_WORLD, &amp;rank);   \n\n  int dim = 2;\n  int grid[dim];\n  grid[0]=0;\n  grid[1]=0;\n\n  // Assign the grid dimensions\n  MPI_Dims_create(nprocs, dim, grid);\n  printf(&quot;Dim grid: length: %d, width: %d\\n&quot;, grid[0], grid[1]);\n  // The new communicator\n  MPI_Comm comm_grid;\n  // Allow cyclic behavior\n  int periodic[dim];\n  periodic[0] = 1;\n  periodic[1] = 1;\n  \n  // Create the communicator\n  MPI_Cart_create(MPI_COMM_WORLD, dim, grid, periodic, 0, &amp;comm_grid);\n\n  int block_len, block_width;\n  block_len = N/grid[1];\n  block_width = N/grid[0];\n \n  int i, j;\n  //Create lattice subset\n  double  *data   = (double  *) malloc (block_len * block_width * sizeof(double));\n  double **site = (double **) malloc (block_len * sizeof(double *));\n  for (i = 0; i &lt; block_len; i++)\n    site[i] = &amp; (data[i * block_width]);\n\n  //Initialise lattice\n  init_lattice(site, block_len, block_width);\n\n  MPI_Datatype newtype, subtype;\n\n  int sizes[dim];\n  sizes[0]=N;\n  sizes[1]=N;\n\n  int subsizes[dim];  \n  subsizes[0] = block_len;\n  subsizes[1] = block_width;\n\n  int starts[dim];   \n  starts[0] = 0;\n  starts[1] = 0;  \n\n  MPI_Type_create_subarray(2, sizes, subsizes, starts, MPI_ORDER_C, MPI_DOUBLE, &amp;newtype);\n  MPI_Type_create_resized(newtype, 0, N/grid[1]*sizeof(double), &amp;subtype);\n  MPI_Type_commit(&amp;subtype);\n\n  int sendcounts[grid[0]*grid[1]];\n  int displs[grid[0]*grid[1]];\n\n  if (rank == 0) {\n    for (i=0; i&lt;grid[0]*grid[1]; i++) sendcounts[i] = 1;\n    int disp = 0;\n    for (i=0; i&lt;grid[0]; i++) {\n      for (j=0; j&lt;grid[1]; j++) {\n        displs[i*grid[0]+j] = disp;\n        disp += 1;\n      }\n      disp += ((N/grid[1])-1)*grid[0];\n    }\n  }\n\n  //Create global lattice\n  double  *global_data   = (double  *) malloc (N * N * sizeof(double));\n  double **global_site = (double **) malloc (N * sizeof(double *));\n  for (i = 0; i &lt; N; i++)\n    global_site[i] = &amp; (global_data[i * N]);\n\n  MPI_Gatherv(&amp;(site[0][0]), N*N/(grid[0]*grid[1]),  MPI_DOUBLE, &amp;(global_site[0][0]), sendcounts, displs, subtype, 0, MPI_COMM_WORLD);\n\n  if(rank==0){\n    printf(&quot;Rank: %d\\n&quot;, rank);\n    for(i=0; i&lt;N; i++){\n      for(j=0; j&lt;N; j++){\n        printf(&quot;%.2lf &quot;, global_site[i][j]);  \n      }\n      printf(&quot;\\n&quot;);\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n<p>EDIT:\nOk so I have changed my array allocations to contiguous memory and everything is working as it should now. Thanks talonmies!</p>\n"}, {"tags": ["c++", "sql", "c", "oracle", "embedded-sql"], "owner": {"reputation": 6643, "user_id": 2032021, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c1c31bca855c458b3f218ef6a303184d?s=128&d=identicon&r=PG", "display_name": "Dr. Debasish Jana", "link": "https://stackoverflow.com/users/2032021/dr-debasish-jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1439372298, "creation_date": 1439372298, "question_id": 31961433, "link": "https://stackoverflow.com/questions/31961433/oracle-proc-way-to-query-db-for-difference-of-array-values-and-db-column-values", "title": "Oracle pro*c way to query DB for difference of array values and DB column values", "body": "<p>I have c/c++ code with embedded SQL for Oracle through Pro*C. Is there any mechanism to get the difference of values of array values and DB column values? For example, say, I have an array like this:</p>\n\n<pre><code>int nums[] = {10,20,35,45};\nvector&lt;int&gt; vnums (nums, nums + sizeof(nums) / sizeof(int) );\n</code></pre>\n\n<p>Now, I have a DB table <code>tbl1</code> with <code>col1</code> containing values: </p>\n\n<pre><code>20\n40\n60\n</code></pre>\n\n<p>I would like to get the unmatched array values that are not present in <code>tbl1</code>.\nSo, result should be:</p>\n\n<pre><code>10\n35\n45\n</code></pre>\n\n<p>I know one way. I may run the following SQL query:</p>\n\n<pre><code>select col1 from tab1\n</code></pre>\n\n<p>And store the results in an vector say, <code>vec2</code>.\nNow, I see the difference of these two vectors vnums and vec2.\nCan you suggest a better way?</p>\n"}, {"tags": ["c++", "c", "linker", "llvm"], "answers": [{"comments": [{"owner": {"reputation": 985, "user_id": 292095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ae09ff56044340ea0de3479869687?s=128&d=identicon&r=PG", "display_name": "mjturner", "link": "https://stackoverflow.com/users/292095/mjturner"}, "edited": false, "score": 3, "creation_date": 1439376918, "post_id": 31961563, "comment_id": 51833591, "body": "The OP wants to convert LLVM IR bitcode into C (notice the <code>-emit-llvm</code> option, which <i>should</i> produce bitcode and not an object file). It was supported in earlier releases (see, eg, <a href=\"http://llvm.org/releases/3.1/docs/FAQ.html#translatecxx\" rel=\"nofollow noreferrer\">this FAQ</a>), but the C backend was removed in 3.1 (<a href=\"http://llvm.org/releases/3.1/docs/ReleaseNotes.html\" rel=\"nofollow noreferrer\">release notes</a>)."}], "tags": [], "owner": {"reputation": 15167, "user_id": 16827, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/xMFTQ.png?s=128&g=1", "display_name": "Remo.D", "link": "https://stackoverflow.com/users/16827/remo-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1439372602, "creation_date": 1439372602, "answer_id": 31961563, "question_id": 31960290, "link": "https://stackoverflow.com/questions/31960290/using-the-llvm-linker-to-produce-c-code/31961563#31961563", "title": "Using the LLVM linker to produce C code", "body": "<p>As the manual page says:</p>\n\n<pre><code>The llc command compiles LLVM source inputs\ninto assembly language for a specified architecture.\n</code></pre>\n\n<p>It does not reverse-engineer an object file to produce a C file (that is what you are trying to achieve) which is something that makes little sense to me.</p>\n\n<p>To know which architecture are supported (roughly meaning which CPU) you can use:</p>\n\n<pre><code> llc -version\n</code></pre>\n\n<p>(you'll notice that 'C' is not an architecture).</p>\n\n<p>If you are trying to rewrite a piece of C++ code as C, your best bet is to just do it manually. You'll need to rewrite all the C++ specific things (classes, exceptions, templates, ...) in C which is something that will take a more or less time depending on the complexity of your C++ code.</p>\n"}, {"tags": [], "owner": {"reputation": 985, "user_id": 292095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ae09ff56044340ea0de3479869687?s=128&d=identicon&r=PG", "display_name": "mjturner", "link": "https://stackoverflow.com/users/292095/mjturner"}, "is_accepted": true, "score": 5, "last_activity_date": 1439377133, "last_edit_date": 1495539984, "creation_date": 1439373186, "answer_id": 31961787, "question_id": 31960290, "link": "https://stackoverflow.com/questions/31960290/using-the-llvm-linker-to-produce-c-code/31961787#31961787", "title": "Using the LLVM linker to produce C code", "body": "<p>Unfortunately emitting LLVM bitcode on Ubuntu systems can be a bit painful because they ship DragonEgg as the default frontend - see <a href=\"https://stackoverflow.com/questions/9447318/llvm-not-generation-byte-code-properly\">this question</a> and <a href=\"https://bugs.launchpad.net/ubuntu/+source/dragonegg/+bug/712199\" rel=\"nofollow noreferrer\">this bugreport</a>.</p>\n\n<p>If you do a <code>file example.o</code> on the file you generated above, you'll see that it's not actually LLVM IR bitcode (which explains the error):</p>\n\n<pre><code>$ file example.o\nexample.o: ELF 64-bit LSB  relocatable, x86-64, version 1 (SYSV), not stripped\n</code></pre>\n\n<p>The easiest way to get LLVM IR bitcode on an Ubuntu system is to use clang:</p>\n\n<pre><code>$ clang -emit-llvm -c example.cpp -o example.o\n$ file example.o\nexample.o: LLVM IR bitcode\n</code></pre>\n\n<p>That said, the C backend was removed in LLVM 3.1 (see the <a href=\"http://llvm.org/releases/3.1/docs/ReleaseNotes.html#whatsnew\" rel=\"nofollow noreferrer\">release notes</a> and <a href=\"https://stackoverflow.com/questions/11597664/llvm-cpp-backend-does-it-replace-c-backend\">this question</a>). As you can see from the output of <code>llc -version</code> it's not listed and trying to use it gives the following error on my Ubuntu 14.04 system:</p>\n\n<pre><code>llc-3.4: error: invalid target 'c'.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "is_accepted": false, "score": 4, "last_activity_date": 1596638771, "last_edit_date": 1596638771, "creation_date": 1567438171, "answer_id": 57759526, "question_id": 31960290, "link": "https://stackoverflow.com/questions/31960290/using-the-llvm-linker-to-produce-c-code/57759526#57759526", "title": "Using the LLVM linker to produce C code", "body": "<p>The original C backend (llvm-cbe) was removed in 3.1 (<a href=\"http://releases.llvm.org/3.1/docs/ReleaseNotes.html\" rel=\"nofollow noreferrer\">release notes</a>), but there is this Julia project, <a href=\"https://github.com/JuliaComputing/llvm-cbe\" rel=\"nofollow noreferrer\">resurrected LLVM &quot;C Backend&quot;, with improvements</a>, which resurrected it.</p>\n"}], "owner": {"reputation": 518, "user_id": 3924272, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/1b01be61acf18c3d7b41427d4c655cf5?s=128&d=identicon&r=PG&f=1", "display_name": "edition", "link": "https://stackoverflow.com/users/3924272/edition"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5186, "favorite_count": 2, "accepted_answer_id": 31961787, "answer_count": 3, "score": 5, "last_activity_date": 1596638771, "creation_date": 1439369284, "question_id": 31960290, "link": "https://stackoverflow.com/questions/31960290/using-the-llvm-linker-to-produce-c-code", "title": "Using the LLVM linker to produce C code", "body": "<p>I have tried to generate C code from C++ code compiled by <code>llvm-g++</code>, using the following commands:</p>\n\n<pre><code>llvm-g++ -emit-llvm -c ./example.cpp -o example.o\nllc -march=c example.o\n</code></pre>\n\n<p>I tried these commands on a machine running <code>Ubuntu (Linux 3.16.0-45-generic)</code>.</p>\n\n<p>However instead of writing C code to standard output, the LLVM static linker reports that the compiled file is invalid: <code>error: expected top-level entity</code>.</p>\n\n<p>How can I generate C code using the LLVM linker?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1439369099, "post_id": 31960137, "comment_id": 51828112, "body": "No - the VLA is on the stack in this particular case, but it&#39;s placed after the other local variables (for obvious reasons). Wherever it&#39;s located though, it would be wrong to try and free it explicitly."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1439369327, "post_id": 31960137, "comment_id": 51828295, "body": "@PaulR Quick, Batman, to the answer box !"}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1439369361, "post_id": 31960137, "comment_id": 51828320, "body": "&quot;variable-length arrays are created on heap&quot; \u2013 nope. If you <code>printf(&quot;%p&quot;, malloc(1));</code> it will probably yield an address <i>far away</i> from both your statically-sized local variables and your VLA. The extra space before/after the VLA is probably just alignment/padding."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 4, "creation_date": 1439369385, "post_id": 31960137, "comment_id": 51828332, "body": "I&#39;m voting to close this question as off-topic because it is based on a false premise."}, {"owner": {"reputation": 327, "user_id": 3874595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BWnuQ.jpg?s=128&g=1", "display_name": "Yetti99", "link": "https://stackoverflow.com/users/3874595/yetti99"}, "edited": false, "score": 0, "creation_date": 1439369422, "post_id": 31960137, "comment_id": 51828361, "body": "Maybe you are thinking of dynarray."}, {"owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "edited": false, "score": 0, "creation_date": 1439369430, "post_id": 31960137, "comment_id": 51828370, "body": "See <a href=\"http://c-faq.com/malloc/alloca.html\" rel=\"nofollow noreferrer\">C-FAQ</a>."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1439369464, "post_id": 31960137, "comment_id": 51828399, "body": "@Quentin: heh - I&#39;m not sure the question is worth a full answer, as it&#39;s based on a false premise (as noted above!) and should probably therefore be closed."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1439370152, "last_edit_date": 1439370152, "creation_date": 1439369696, "answer_id": 31960424, "question_id": 31960137, "link": "https://stackoverflow.com/questions/31960137/variable-length-arrays-are-created-on-heap-but-we-cannot-free-them/31960424#31960424", "title": "Variable-length arrays are created on heap, but we cannot free them?", "body": "<p>Variable length arrays have automatic storage duration and have either block scope or function prototype scope.</p>\n\n<p>So this array</p>\n\n<pre><code>int a2[n];\n</code></pre>\n\n<p>has automatic storage duration and the block scope of the function main. It was not created in the heap. It is the compiler that generates the corresponding code to free the allocated memory for the array when the control will exit the block scope.</p>\n\n<p>According to the C Standard (6.2.4 Storage durations of objects)</p>\n\n<blockquote>\n  <p>7 For such an object that does have a variable length array type, its\n  lifetime extends from the declaration of the object until execution of\n  the program leaves the scope of the declaration.35) If the scope is\n  entered recursively, a new instance of the object is created each\n  time. The initial value of the object is indeterminate.</p>\n</blockquote>\n\n<p>You may apply function <code>free</code> only to objects that were allocated using one of the memory allocation functions like malloc, calloc or realloc.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1439369699, "creation_date": 1439369699, "answer_id": 31960426, "question_id": 31960137, "link": "https://stackoverflow.com/questions/31960137/variable-length-arrays-are-created-on-heap-but-we-cannot-free-them/31960426#31960426", "title": "Variable-length arrays are created on heap, but we cannot free them?", "body": "<p>How an implementation allocates storage for VLAs is implementation defined. VLAs have automatic storage duration and you should not try to <code>free()</code> it.\nYou should treat it just like any other local variable for all practical purposes.</p>\n\n<p>You only free() whatever the memory you allocated using <code>malloc()</code> family functions.</p>\n\n<p>VLAs are not supported by all implementation and it is a conditional feature. </p>\n\n<p>The macro </p>\n\n<pre><code>_ _STDC_NO_VLA_ _\n</code></pre>\n\n<p>is used to test if VLAs are supported or not by implementation (if it's 1 then VLAs are not supported).</p>\n\n<p>In my opinion, VLAs should not used mainly because:</p>\n\n<ul>\n<li>They are optional in C11  </li>\n<li>The allocation failure is not portable detectable  </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1439370050, "creation_date": 1439370050, "answer_id": 31960550, "question_id": 31960137, "link": "https://stackoverflow.com/questions/31960137/variable-length-arrays-are-created-on-heap-but-we-cannot-free-them/31960550#31960550", "title": "Variable-length arrays are created on heap, but we cannot free them?", "body": "<blockquote>\n  <p>Is this a defect of C?</p>\n</blockquote>\n\n<p>Absolutely not. You made several wrong assumptions, which lead you to a wrong conclusion.</p>\n\n<p>First, let's get terminology straight: \"stack\" is called <em>automatic storage area</em>; \"heap\" is called <em>dynamic storage area</em>. C standard does not make any claims about any of the things listed below:</p>\n\n<ul>\n<li>Relative order of addresses in automatic and dynamic areas</li>\n<li>Relative order of addresses of items within the same storage area</li>\n<li>Presence or absence of gaps between allocations within the same area</li>\n</ul>\n\n<p>This makes it impossible to determine if a variable is in an automatic or in a dynamic area simply by looking at numeric addresses, without making a guess. In particular, what appears \"obvious\" to you has nothing to do with what is actually happening.</p>\n\n<blockquote>\n  <p>So who will be responsible to free these memories?</p>\n</blockquote>\n\n<p>You are responsible for calling <code>free</code> on everything that you allocated in the dynamic storage area. You do not allocate your variable-length array in the dynamic storage area<sup>*</sup>, hence you are not responsible for calling <code>free</code> on it.</p>\n\n<p><sup>*</sup> If a compiler implementation were to allocate a VLA in the dynamic storage area, the compiler would be responsible for calling <code>free</code> on that pointer.</p>\n"}], "owner": {"reputation": 138, "user_id": 4830788, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/wafMs.jpg?s=128&g=1", "display_name": "Pufan Jiang", "link": "https://stackoverflow.com/users/4830788/pufan-jiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1439370429, "creation_date": 1439368836, "last_edit_date": 1439370429, "question_id": 31960137, "link": "https://stackoverflow.com/questions/31960137/variable-length-arrays-are-created-on-heap-but-we-cannot-free-them", "title": "Variable-length arrays are created on heap, but we cannot free them?", "body": "<p>I've verified that variable-length arrays are created on heap (see code below), but we cannot use a free operation to free them (cause a fault trap 6).</p>\n\n<p>I was taught that the heap is managed by user and thus we have to explicitly free anything on heap if we don't need them. So who will be responsible to free these memories? Is this a defect of C?</p>\n\n<hr/>\n\n<p>Code that shows variable-length arrays are created on heap. (Platform: Mac OS X, gcc, 64bits)</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main(int argc, char **argv)\n{\n    int n = atoi(argv[1]);\n    int a1[10];\n    int a2[n];\n    int a3[10];\n\n    printf(\"address for a1:%p,address for a2:%p, address for a3:%p\\n\",a1,a2,a3);\n    printf(\"a1-a2: %lx, a1-a3: %lx\\n\",(a1-a2),(a1-a3));\n\n    //free(t); // will cause fault trap 6\n\n    return 0;\n}\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>$ ./run 10\naddress for a1:0x7fff5d095aa0,address for a2:0x7fff5d0959e0, address for a3:0x7fff5d095a70\na1-a2: 30, a1-a3: c\n</code></pre>\n\n<p>It's obvious that a1 and a3 is consecutive and thus are on stack, but a2 has a lower address, thus on heap.</p>\n"}, {"tags": ["c", "pointers", "pass-by-pointer"], "comments": [{"owner": {"reputation": 6287, "user_id": 2447152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xlyJP.jpg?s=128&g=1", "display_name": "Rustam", "link": "https://stackoverflow.com/users/2447152/rustam"}, "edited": false, "score": 0, "creation_date": 1439367696, "post_id": 31959621, "comment_id": 51827300, "body": "size of int and double are not same"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1439367704, "post_id": 31959621, "comment_id": 51827302, "body": "Step 1: get a <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">decent book on C</a>, step 2: read it."}, {"owner": {"reputation": 381, "user_id": 1998844, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/200101f7230a9960d4f02ebafeea076f?s=128&d=identicon&r=PG", "display_name": "user1998844", "link": "https://stackoverflow.com/users/1998844/user1998844"}, "edited": false, "score": 0, "creation_date": 1439368766, "post_id": 31959621, "comment_id": 51827902, "body": "the type cast in incme((double *)&amp;i); will to cast the int to double ?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1439369524, "post_id": 31959621, "comment_id": 51828442, "body": "The type cast will cast the <code>int*</code> to a <code>double*</code>, which causes all the rules of C to fall out the window because you&#39;re not actually allowed to do that."}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 1998844, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/200101f7230a9960d4f02ebafeea076f?s=128&d=identicon&r=PG", "display_name": "user1998844", "link": "https://stackoverflow.com/users/1998844/user1998844"}, "edited": false, "score": 0, "creation_date": 1439368860, "post_id": 31959742, "comment_id": 51827965, "body": "the type cast in incme((double *)&amp;i); will to cast the int to double ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 381, "user_id": 1998844, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/200101f7230a9960d4f02ebafeea076f?s=128&d=identicon&r=PG", "display_name": "user1998844", "link": "https://stackoverflow.com/users/1998844/user1998844"}, "edited": false, "score": 0, "creation_date": 1439369505, "post_id": 31959742, "comment_id": 51828426, "body": "@user1998844 No, it will cast a pointer to <code>int</code> to pointer to <code>double</code>. Integer values and floating point values are not encoded in the same way in computers, integers are stored as is in ther binary form while floating point values usually uses <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow noreferrer\">IEEE754</a> encoding."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 381, "user_id": 1998844, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/200101f7230a9960d4f02ebafeea076f?s=128&d=identicon&r=PG", "display_name": "user1998844", "link": "https://stackoverflow.com/users/1998844/user1998844"}, "edited": false, "score": 0, "creation_date": 1439369609, "post_id": 31959742, "comment_id": 51828495, "body": "@user1998844 Besides that, because of the size difference and depending on machine <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a> you could be writing to unallocated memory in your function."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1439367641, "last_edit_date": 1495540679, "creation_date": 1439367641, "answer_id": 31959742, "question_id": 31959621, "link": "https://stackoverflow.com/questions/31959621/why-is-this-pass-by-pointer-is-not-working-as-intended/31959742#31959742", "title": "why is this pass by pointer is not working as intended?", "body": "<p>Because of <em>undefined behavior</em>. Integers are not floating point, and floating point is not integers. Besides that, I think you will find that <code>sizeof(int) != sizeof(double)</code>.</p>\n\n<p>You're also breaking the <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing rule</a>.</p>\n\n<hr>\n\n<p>Unrelated to your question, you should use the <code>\"%p\"</code> format if you want to print pointers.</p>\n"}, {"comments": [{"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1439368070, "post_id": 31959864, "comment_id": 51827504, "body": "For <code>%p</code> param should be <code>(void*)</code>"}], "tags": [], "owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1439367974, "creation_date": 1439367974, "answer_id": 31959864, "question_id": 31959621, "link": "https://stackoverflow.com/questions/31959621/why-is-this-pass-by-pointer-is-not-working-as-intended/31959864#31959864", "title": "why is this pass by pointer is not working as intended?", "body": "<p>The main reason, the printf statements should read - </p>\n\n<pre><code>printf( \"%p,%f\", p, *p );\n</code></pre>\n\n<p>This will show your increment of the double.</p>\n\n<p>Also - as stated, an int is generally 4 bytes and a double uses 8 bytes. (on most systems)</p>\n"}, {"comments": [{"owner": {"reputation": 381, "user_id": 1998844, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/200101f7230a9960d4f02ebafeea076f?s=128&d=identicon&r=PG", "display_name": "user1998844", "link": "https://stackoverflow.com/users/1998844/user1998844"}, "edited": false, "score": 0, "creation_date": 1439369031, "post_id": 31959887, "comment_id": 51828071, "body": "so the type cast at the function wont cast the i to double ?"}, {"owner": {"reputation": 1126, "user_id": 1062711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fad2444fce303057347404b993d15c15?s=128&d=identicon&r=PG", "display_name": "ex0ns", "link": "https://stackoverflow.com/users/1062711/ex0ns"}, "reply_to_user": {"reputation": 381, "user_id": 1998844, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/200101f7230a9960d4f02ebafeea076f?s=128&d=identicon&r=PG", "display_name": "user1998844", "link": "https://stackoverflow.com/users/1998844/user1998844"}, "edited": false, "score": 0, "creation_date": 1439369521, "post_id": 31959887, "comment_id": 51828438, "body": "It does cast it but as they do not have the same size or memory layout when you cast <code>int 1</code> to double, it gives you 0 because as a double it gives you a exponent of 0 (see the wikipedia page linked), and when you increment it, you get a 1 (in double representation, on 64bits) and thoses bits are lost when you print it back as an integer."}], "tags": [], "owner": {"reputation": 1126, "user_id": 1062711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fad2444fce303057347404b993d15c15?s=128&d=identicon&r=PG", "display_name": "ex0ns", "link": "https://stackoverflow.com/users/1062711/ex0ns"}, "is_accepted": false, "score": 2, "last_activity_date": 1439368648, "last_edit_date": 1439368648, "creation_date": 1439368046, "answer_id": 31959887, "question_id": 31959621, "link": "https://stackoverflow.com/questions/31959621/why-is-this-pass-by-pointer-is-not-working-as-intended/31959887#31959887", "title": "why is this pass by pointer is not working as intended?", "body": "<p>When you do <code>*p = *p + 1;</code> with p beeing a <code>double*</code> there is a lot going under the hood, indeed, double are represented using a custom format <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow\">(wiki)</a>, when you use <code>printf</code> to display it as a integer after that, the internal representation of the memory at this address has changed (to a double representation), this is why you obtain such a result.</p>\n\n<p>I ran the code and obtained the following output:</p>\n\n<pre><code>205afc2c,205afd28\n205afc2c,593b4ab0\n205afc2c,0\n</code></pre>\n\n<p>It shows use that the value is invalid as a double, and when it's incremented, it does not update the <code>sizeof(int)</code> first bits of the double (as it print 0 in the last line).</p>\n\n<p>Hope I made myself clear !</p>\n\n<h3>Edit</h3>\n\n<p>I changed the code a little to show you what actually happen:</p>\n\n<pre><code>void incme(double *p)\n{\n    printf(\"%x,%lf\\n\",p,*p);\n    *p = *p + 1;\n    printf(\"%x,%lf\\n\",p,*p);\n}\nint main()\n{\n    int i = 1;\n    incme((double *)&amp;i);    \n    printf(\"%x, %lf, %d\",&amp;i,i, i);\n}\n</code></pre>\n\n<p>Gives me the following output:</p>\n\n<pre><code>cb90990c,0.000000\ncb90990c,1.000000\ncb90990c, 1.000000, 0\n</code></pre>\n\n<p>As you can see, if you print them as double, the value is indeed correct (but the binary representation of <code>1.0000</code> is not <code>00000000001</code> as I said previously, this is why the hex formatting gives you a large number).\nBack in the main, if you display the value as a double (event if i is supposed to be a int) as the <code>incme</code> function changed the memory layout of it, it does print 1.0000, but the first 32bits of the memory at this address are 0 hence, printing it as an int gives you 0.</p>\n"}], "owner": {"reputation": 381, "user_id": 1998844, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/200101f7230a9960d4f02ebafeea076f?s=128&d=identicon&r=PG", "display_name": "user1998844", "link": "https://stackoverflow.com/users/1998844/user1998844"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1439369158, "creation_date": 1439367227, "last_edit_date": 1439369158, "question_id": 31959621, "link": "https://stackoverflow.com/questions/31959621/why-is-this-pass-by-pointer-is-not-working-as-intended", "title": "why is this pass by pointer is not working as intended?", "body": "<p>I am trying to understand why the following code does not work... please help:</p>\n\n<pre><code>void incme(double *p)\n{\n    printf(\"%x,%x\\n\",p,*p);\n    *p = *p + 1;\n    printf(\"%x,%x\\n\",p,*p);\n}\nint main()\n{\n    int i = 1;\n    incme((double *)&amp;i);    \n    printf(\"%x,%x\",&amp;i,i);\n}\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>ff99a348,1\nff99a348,1\nff99a348,1\n</code></pre>\n\n<p>I am expecting:\n    ff99a348,1\n    ff99a348,2\n    ff99a348,2<br>\nit breaks everything I know about pointers... </p>\n\n<p>Thanks.</p>\n\n<p>EDIT:</p>\n\n<p>the main question i am asking the the type cast in incme((double *)&amp;i); why isit not casting it to double and pass it to the function ? ... sorry for not pointing out eailer ....</p>\n"}, {"tags": ["c++", "c", "linux", "netbeans"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439486943, "post_id": 31959220, "comment_id": 51893697, "body": "Suggest posting the makefile and layout of your directories and what directory your building from.  Until we have the background info, all we can do is guess as to the root of the problem."}], "answers": [{"comments": [{"owner": {"reputation": 594, "user_id": 2123079, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8a94c20ffd4bd50f6c15628fc975219?s=128&d=identicon&r=PG", "display_name": "user2123079", "link": "https://stackoverflow.com/users/2123079/user2123079"}, "edited": false, "score": 0, "creation_date": 1439371996, "post_id": 31960496, "comment_id": 51830256, "body": "Yes. libnetfilter_queue depends from other 2. They build before main library so that is not a problem. And -l flag is needed while linkage and I have error in compilation stage. But thank&#39;s"}], "tags": [], "owner": {"reputation": 327, "user_id": 4148500, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7551dcc8d1e48c3dd5b8d2c7a16f203b?s=128&d=identicon&r=PG&f=1", "display_name": "Share_Improve", "link": "https://stackoverflow.com/users/4148500/share-improve"}, "is_accepted": false, "score": 0, "last_activity_date": 1439369880, "creation_date": 1439369880, "answer_id": 31960496, "question_id": 31959220, "link": "https://stackoverflow.com/questions/31959220/no-such-file-or-directory-but-file-present/31960496#31960496", "title": "No such file or directory but file present", "body": "<p>From your question, it sounds like you are building different libraries right?</p>\n\n<p>if so, if you are building using make file, first create a library file(.a) file of libnfnetlink and while building libnetfilter_queue, in the c flag add the library -I </p>\n"}], "owner": {"reputation": 594, "user_id": 2123079, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8a94c20ffd4bd50f6c15628fc975219?s=128&d=identicon&r=PG", "display_name": "user2123079", "link": "https://stackoverflow.com/users/2123079/user2123079"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439369880, "creation_date": 1439366064, "question_id": 31959220, "link": "https://stackoverflow.com/questions/31959220/no-such-file-or-directory-but-file-present", "title": "No such file or directory but file present", "body": "<p>I am trying to build libnetfilter_queue by myself. I successfully build libmnl and libnfnetlink. But when I trying to build libnetfilter_queue, I've got and an error:</p>\n\n<pre><code>libnetfilter_queue.c:33:39: fatal error: libnfnetlink/libnfnetlink.h: No such file or directory\n</code></pre>\n\n<p>All the pathes are setted. I tried to set them both by -I flag and in NetBeans project settings (as relative path, as absolute path etc) but it still doesn't work. I also installed build-essential but still the same problem. chmod tells me, that file is readable for all users. And also interesting thing is when I try to do \"Navigate->Go to declaration/Definition\", it opens that file. What is the problem?</p>\n"}, {"tags": ["c", "image-processing", "computer-vision", "image-segmentation"], "answers": [{"tags": [], "owner": {"reputation": 1436, "user_id": 1095879, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4c7e69e9d4fb6d02e78d219c00239354?s=128&d=identicon&r=PG", "display_name": "nojka_kruva", "link": "https://stackoverflow.com/users/1095879/nojka-kruva"}, "is_accepted": false, "score": 0, "last_activity_date": 1439368155, "creation_date": 1439368155, "answer_id": 31959918, "question_id": 31959176, "link": "https://stackoverflow.com/questions/31959176/locate-and-segment-rectangles/31959918#31959918", "title": "Locate and segment rectangles", "body": "<p>One possible direction is:</p>\n\n<ol>\n<li>Fit straight lines to the edges you have detected.</li>\n<li>Detect pairs of lines that are perpendicular.</li>\n<li>Match the pairs to create candidate rectangles.</li>\n<li>Try to fine tune the lines of each candidate rectangle in order to improve the fit to the image data.</li>\n<li>Assign a confidence score to each candidate rectangle.</li>\n<li>Filter the candidates by a score threshold that you have chosen according to your desired precision/recall tradeoff.</li>\n</ol>\n"}], "owner": {"reputation": 180, "user_id": 5218118, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/712c19ee522b71854d1e6d2d7d2639be?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Ludvigsen", "link": "https://stackoverflow.com/users/5218118/peter-ludvigsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439368155, "creation_date": 1439365942, "last_edit_date": 1439366590, "question_id": 31959176, "link": "https://stackoverflow.com/questions/31959176/locate-and-segment-rectangles", "title": "Locate and segment rectangles", "body": "<p>I want to develop a system for locating and segmentate rectangles in an image. The rectangles (I want to find) are large an visible, however, they might be touching each other and the might even overlap a little bit.</p>\n\n<p>I have attached a sample image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0mQKy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0mQKy.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and here I have outlined (approximately) what I hope to achieve. I know there are many more rectangles on the image (especially the suitcase itself) but I think filtering out false positives based on size should be easy enough. </p>\n\n<p><a href=\"https://i.stack.imgur.com/THsXQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/THsXQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>From trying to find the solution myself I find that edge detection is pretty easy, but I am unsure how I go from there to actually segment the various objects into different classes.</p>\n\n<p>I do not hope for someone here to post a complete solution, but only get some help into which direction I should be going, which standard methods exists out there.</p>\n"}, {"tags": ["c", "openssl", "key", "sha256", "digest"], "comments": [{"owner": {"reputation": 14334, "user_id": 1380680, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TRgwX.png?s=128&g=1", "display_name": "Reinier Torenbeek", "link": "https://stackoverflow.com/users/1380680/reinier-torenbeek"}, "edited": false, "score": 1, "creation_date": 1439554616, "post_id": 31958070, "comment_id": 51921978, "body": "The command <code>openssl dgst -sha256 -signature license.secret  -verify pub-key.pem license</code> will do what you are looking for. Check out the <code>openssl</code> source code in <code>apps&#47;dgst.c</code> to recreate that in your own code, in particular look for <code>EVP_Digest</code> calls. However, you will also need to verify that the public key (<code>pub-key.pem</code>) is authentic (someone could have tampered with it), which is not as easy. See <a href=\"https://en.wikipedia.org/wiki/Public_key_certificate\" rel=\"nofollow noreferrer\">Public key certificate</a>"}, {"owner": {"reputation": 904, "user_id": 4004688, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1002512873/picture?type=large", "display_name": "Itay Sela", "link": "https://stackoverflow.com/users/4004688/itay-sela"}, "reply_to_user": {"reputation": 14334, "user_id": 1380680, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TRgwX.png?s=128&g=1", "display_name": "Reinier Torenbeek", "link": "https://stackoverflow.com/users/1380680/reinier-torenbeek"}, "edited": false, "score": 0, "creation_date": 1439711667, "post_id": 31958070, "comment_id": 51967111, "body": "can i store the public key as an array inside my C program?"}, {"owner": {"reputation": 14334, "user_id": 1380680, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TRgwX.png?s=128&g=1", "display_name": "Reinier Torenbeek", "link": "https://stackoverflow.com/users/1380680/reinier-torenbeek"}, "edited": false, "score": 0, "creation_date": 1439727841, "post_id": 31958070, "comment_id": 51970961, "body": "Yes, you can. That will make it harder, but not impossible, to modify it."}], "answers": [{"tags": [], "owner": {"reputation": 1051, "user_id": 1504288, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/051642b6b0a0fe390305bc55ff002a2a?s=128&d=identicon&r=PG", "display_name": "Nimjox", "link": "https://stackoverflow.com/users/1504288/nimjox"}, "is_accepted": false, "score": 0, "last_activity_date": 1590195536, "creation_date": 1590195536, "answer_id": 61966105, "question_id": 31958070, "link": "https://stackoverflow.com/questions/31958070/how-to-verify-digest-using-openssl-library/61966105#61966105", "title": "How to verify digest using openssl library?", "body": "<p>You'll want to use <code>libopenssl-dev</code> or the Windows equivalent to build a C program similar to this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;openssl/pem.h&gt;\n#include &lt;openssl/rsa.h&gt;\n#include &lt;openssl/sha.h&gt;\n\n// Buffer for file read operations. The buffer must be able to accomodate\n// the RSA signature in whole (e.g. 4096-bit RSA key produces 512 byte signature)\n#define BUFFER_SIZE 512\nstatic unsigned char buffer[BUFFER_SIZE];\n\nint main(int argc, char *argv[])\n{\n    if(argc != 4)\n    {\n        fprintf(stderr, \"Usage: %s datafile signature_file public_key\\n\", argv[0]);\n        return -1;\n    }\n    const char* filename = argv[1];\n    const char* sigfile = argv[2];\n    const char* pubkeyfile = argv[3];\n\n    unsigned bytes = 0;\n\n    // Calculate SHA256 digest for datafile\n    FILE* datafile = fopen(filename , \"rb\");\n\n    // Buffer to hold the calculated digest\n    unsigned char digest[SHA256_DIGEST_LENGTH];\n    SHA256_CTX ctx;\n    SHA256_Init(&amp;ctx);\n\n    // Read data in chunks and feed it to OpenSSL SHA256\n    while((bytes = fread(buffer, 1, BUFFER_SIZE, datafile)))\n    {\n        SHA256_Update(&amp;ctx, buffer, bytes);\n    }\n\n    SHA256_Final(digest, &amp;ctx);\n    fclose(datafile);\n\n    // Read signature from file\n    FILE* sign = fopen (sigfile , \"r\");\n\n    bytes = fread(buffer, 1, BUFFER_SIZE, sign);\n    fclose(sign);\n\n    // Verify that calculated digest and signature match\n    FILE* pubkey = fopen(pubkeyfile, \"r\"); \n\n    // Read public key from file\n    RSA* rsa_pubkey = PEM_read_RSA_PUBKEY(pubkey, NULL, NULL, NULL);\n\n    // Decrypt signature (in buffer) and verify it matches\n    // with the digest calculated from data file.\n    int result = RSA_verify(NID_sha256, digest, SHA256_DIGEST_LENGTH,\n                            buffer, bytes, rsa_pubkey);\n    RSA_free(rsa_pubkey);\n    fclose(pubkey);\n\n    if(result == 1)\n    {\n        printf(\"Signature is valid\\n\");\n        return 0;\n    }\n    else\n    {\n        printf(\"Signature is invalid\\n\");\n        return 1;\n    }\n}\n</code></pre>\n\n<p>Also instead of passing in the public key as a file parameter you can also back it in easily by using <code>xxd -i pub-key.pem</code> to generate a nice C style header of the key which can be used by the program in place of <code>pubkeyfile</code>.</p>\n\n<p>Example code from: <a href=\"https://pagefault.blog/2019/04/22/how-to-sign-and-verify-using-openssl/\" rel=\"nofollow noreferrer\">https://pagefault.blog/2019/04/22/how-to-sign-and-verify-using-openssl/</a></p>\n"}], "owner": {"reputation": 904, "user_id": 4004688, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1002512873/picture?type=large", "display_name": "Itay Sela", "link": "https://stackoverflow.com/users/4004688/itay-sela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1597, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1590195536, "creation_date": 1439362644, "last_edit_date": 1489853469, "question_id": 31958070, "link": "https://stackoverflow.com/questions/31958070/how-to-verify-digest-using-openssl-library", "title": "How to verify digest using openssl library?", "body": "<p>I'm build a Licensing system in the following way. I generated a matching public and private keys:</p>\n\n<pre><code>openssl genrsa -out mykey.pem 1024\nopenssl rsa -in mykey.pem -des3 -out prv-key.pem\nopenssl rsa -in mykey.pem -pubout -out pub-key.pem\n</code></pre>\n\n<p>Now I took a license message which contains unique information about the user and license details. my product reads this message, verifies the information, and if everything goes as planned it reads the license policy and runs accordingly.</p>\n\n<p>so I've taken that license file and digested it with a signature using my private key</p>\n\n<pre><code>openssl dgst -sha256 -sign prv-key.pem -out license.secret license\n</code></pre>\n\n<p>and now I'm sending both the license and the signed license files to the customer.</p>\n\n<p>My Question is: How can i verify digest using the public key (pub-key.pem) on the Customer side from within a C program. \nI've looking libssl and openssl library but couldn't find a good example for digest verification</p>\n"}, {"tags": ["c", "qnx"], "comments": [{"owner": {"reputation": 7278, "user_id": 642680, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3yGtY.jpg?s=128&g=1", "display_name": "D-D\u1d19um", "link": "https://stackoverflow.com/users/642680/d-d%e1%b4%99um"}, "edited": false, "score": 0, "creation_date": 1439403102, "post_id": 31957759, "comment_id": 51851874, "body": "As an alternative to QNX, look at the Yocto project: <a href=\"https://www.yoctoproject.org/\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6709, "user_id": 447438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ffdc5279fd70540799b762c14e66665?s=128&d=identicon&r=PG", "display_name": "jwernerny", "link": "https://stackoverflow.com/users/447438/jwernerny"}, "is_accepted": true, "score": 1, "last_activity_date": 1439395514, "creation_date": 1439395514, "answer_id": 31970314, "question_id": 31957759, "link": "https://stackoverflow.com/questions/31957759/how-to-develop-app-for-qnx-from-scratch-with-proper-gui/31970314#31970314", "title": "How to develop app for QNX from scratch with proper GUI?", "body": "<p>Now that <a href=\"http://doc.qt.io/qt-5/platform-notes-qnx.html\" rel=\"nofollow\">Qt 5 has support on QNX 6.6</a>, I would suggest using it.  With Qt you can either develop your GUI in either in native C++ (Qt Widgets) or with <a href=\"http://doc.qt.io/qt-5/qmlapplications.html\" rel=\"nofollow\">Qt Quick</a>.</p>\n\n<p>The biggest limiting factor will be the hardware you are running on (particularly the GPU or lack of) and the available QNX drivers for the hardware.</p>\n"}, {"tags": [], "owner": {"reputation": 2089, "user_id": 4766168, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xrRVf1o5oQk/AAAAAAAAAAI/AAAAAAAAAEk/Uu9PgLhfHwA/photo.jpg?sz=128", "display_name": "Dmitrii Z.", "link": "https://stackoverflow.com/users/4766168/dmitrii-z"}, "is_accepted": false, "score": 1, "last_activity_date": 1441617087, "last_edit_date": 1592644375, "creation_date": 1441617087, "answer_id": 32434991, "question_id": 31957759, "link": "https://stackoverflow.com/questions/31957759/how-to-develop-app-for-qnx-from-scratch-with-proper-gui/32434991#32434991", "title": "How to develop app for QNX from scratch with proper GUI?", "body": "<p>You might not want to use QT in your QNX app, because it is not supported in QNX 6.5 or lower.\nIf you want to write a GUI app for QNX 6.5 or lower you should use <a href=\"http://www.qnx.com/developers/docs/6.4.1/photon/prog_guide/about.html\" rel=\"nofollow noreferrer\">photon</a></p>\n<p>Since qnx 6.5 you can't develop your apps inside QNX, though company provides SDK and IDE for developing on windows/linux (not sure about osx). It can be downloaded with SDK from their <a href=\"http://www.qnx.com/download/group.html?programid=26071\" rel=\"nofollow noreferrer\">official site</a> (though it cost some $$ if you are not student).</p>\n<p>People normally use virtual machines to develop (I didn't find a way to install QNX 6.6 on a PC, but there are many instructions how to deploy it on any sort of arm mPC)</p>\n<p>EDIT: It is worth thinking about making WEB GUI for your app btw.</p>\n"}], "owner": {"reputation": 155, "user_id": 5163650, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b8036ef6b57e4407c5ace910565d1fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bharat Jain", "link": "https://stackoverflow.com/users/5163650/bharat-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "accepted_answer_id": 31970314, "answer_count": 2, "score": 0, "last_activity_date": 1441617087, "creation_date": 1439361686, "question_id": 31957759, "link": "https://stackoverflow.com/questions/31957759/how-to-develop-app-for-qnx-from-scratch-with-proper-gui", "title": "How to develop app for QNX from scratch with proper GUI?", "body": "<p>I was wondering around Internet for proper article regarding how to develop a good UI app for QNX . I was able to find things like -</p>\n\n<ol>\n<li>We can use jamaicaVM to port our code developed on java to c .</li>\n</ol>\n\n<p>Following are my questions :</p>\n\n<ol>\n<li>On what platform should i develop the app for QNX .</li>\n<li>The app should have proper UI.</li>\n</ol>\n\n<p>This might even help other beginner . </p>\n"}, {"tags": ["c", "if-statement", "sizeof"], "comments": [{"owner": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "edited": false, "score": 4, "creation_date": 1439361440, "post_id": 31957514, "comment_id": 51823707, "body": "This would likely have been caught if you had more warnings enabled."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 14, "last_activity_date": 1439361622, "last_edit_date": 1439361622, "creation_date": 1439360975, "answer_id": 31957563, "question_id": 31957514, "link": "https://stackoverflow.com/questions/31957514/c-language-if-statement-with-sizeof/31957563#31957563", "title": "c language if statement with sizeof", "body": "<p>First of all, the value produced by <code>sizeof</code> is of <code>size_t</code> which is <code>unsigned</code> type. <sup>NOTE</sup></p>\n\n<p>As the <code>unsigned</code> type is of higher <em>rank</em> than the <code>signed</code> type, while performing the comparison, as per the norms of the relation operator,  the usual arithmetic conversions are performed, meaning the signed type is promoted to unsigned type.</p>\n\n<p>In your case, the <code>-1</code>, when considered as <code>unsigned</code>, represent the highest possible <code>unsigned</code> value, thus, no wonder</p>\n\n<pre><code> if (sizeof(int) &gt; -1)\n</code></pre>\n\n<p>Evaluates to <em>false</em>.</p>\n\n<p>Moral of the story: Attempted comparison between a <code>signed</code> and an <code>unsigned</code> is <em>expected</em> to produce weird result, just as in your case. You should enable compiler warning and try to solve the issues reported by the compiler.</p>\n\n<hr>\n\n<p>NOTE:</p>\n\n<p>From <code>C11</code>, chapter \u00a77.19, <code>&lt;stddef.h&gt;</code>,</p>\n\n<blockquote>\n  <p><code>size_t</code><br>\n  which is the <code>unsigned</code> integer type of the result of the <code>sizeof</code> operator.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "is_accepted": false, "score": 2, "last_activity_date": 1439362221, "last_edit_date": 1439362221, "creation_date": 1439361259, "answer_id": 31957638, "question_id": 31957514, "link": "https://stackoverflow.com/questions/31957514/c-language-if-statement-with-sizeof/31957638#31957638", "title": "c language if statement with sizeof", "body": "<p><code>sizeof</code> is an operator which returns the size and the returned value type is <code>unsigned int</code>.\nSince <code>unsigned</code> is having higher rank than <code>singed</code> type, -1 is treated as unsigned number.\n-1 in this case is treated as 0xFFFF. \nHence <code>if (sizeof(int) &gt; 0XFFFF)</code> is evaluated to <code>false</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/S2Y82.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S2Y82.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1439362933, "post_id": 31957777, "comment_id": 51824533, "body": "Actually, because of the way the standard specifies conversions from signed to unsigned, the internal representation of a negative number doesn&#39;t really matter...  <code>-1</code> converts to the same unsigned value regardless (maximum value for the unsigned type)."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1439361755, "creation_date": 1439361755, "answer_id": 31957777, "question_id": 31957514, "link": "https://stackoverflow.com/questions/31957514/c-language-if-statement-with-sizeof/31957777#31957777", "title": "c language if statement with sizeof", "body": "<p>If you write</p>\n\n<pre><code>if ( ( int )sizeof(int) &gt; -1)\n</code></pre>\n\n<p>you will get the expected result that is <code>True</code>.</p>\n\n<p>Operator sizeof returns a value of type <code>size_t</code> that corresponds to some implementation defined unsigned integer type. </p>\n\n<p>From the C STandard (6.5.3.4 The sizeof and alignof operators)</p>\n\n<blockquote>\n  <p>5 The value of the result of both operators is implementation-defined,\n  <strong>and its type (an unsigned integer type)</strong> is size_t, defined in  (and other headers).</p>\n</blockquote>\n\n<p>The rank of <code>size_t</code> in any case greater than or at least equal to the rank of type <code>int</code>. It means that when the compiler need to determine the type of an expression it converts operand will lower rank to the type of the operand with higher rank. If operands have the same rank but one operand has unsigned integer type and other has signed integer type then the common type is unsigned int type.</p>\n\n<p>Thus in the condition of the if statement</p>\n\n<pre><code>if ( sizeof(int) &gt; -1)\n</code></pre>\n\n<p><code>-1</code> is converted to unsigned integer type <code>size_t</code> and due to its internal representation where all bits are set to 1 is freater than the value of <code>sizeof( int )</code></p>\n"}], "owner": {"reputation": 285, "user_id": 4551608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b44003d1cfe9183fed5b8d4f47424326?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/4551608/harish"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "closed_date": 1439362160, "accepted_answer_id": 31957563, "answer_count": 3, "score": 6, "last_activity_date": 1439362221, "creation_date": 1439360823, "last_edit_date": 1439361530, "question_id": 31957514, "link": "https://stackoverflow.com/questions/31957514/c-language-if-statement-with-sizeof", "closed_reason": "Duplicate", "title": "c language if statement with sizeof", "body": "<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n   if (sizeof(int) &gt; -1)\n       printf(\"True\");\n   else\n       printf(\"False\");\n}\n</code></pre>\n\n<p>ANSWER: </p>\n\n<blockquote>\n  <p>False</p>\n</blockquote>\n\n<p>but according to the logic <code>sizeof(int)</code> return 2 and <code>if(2&gt;-1)</code> return 1 and it should print True.</p>\n\n<p>Why it is behaving otherwise?</p>\n"}, {"tags": ["c++", "c", "postgresql", "dev-c++"], "comments": [{"owner": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439358944, "post_id": 31956932, "comment_id": 51822552, "body": "There are many simple examples of PostgreSQL database connection on the internet like this <a href=\"http://www.tutorialspoint.com/postgresql/postgresql_c_cpp.htm\" rel=\"nofollow noreferrer\">one</a>. What&#39;s the problem?"}, {"owner": {"reputation": 23, "user_id": 4964512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I7P7jAr7KfY/AAAAAAAAAAI/AAAAAAAAALA/VYYmrqO9Uj4/photo.jpg?sz=128", "display_name": "Humaira", "link": "https://stackoverflow.com/users/4964512/humaira"}, "reply_to_user": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439359626, "post_id": 31956932, "comment_id": 51822856, "body": "I tried the same yesterday. I added libpxx. But when the code is run, it is showing &#39;there is no such directory named pqxx&#39;."}, {"owner": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439359717, "post_id": 31956932, "comment_id": 51822909, "body": "Are you using Visual Studio or GCC?"}, {"owner": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439359779, "post_id": 31956932, "comment_id": 51822940, "body": "Sorry, just noticed you had mentioned it already with Windows Application. The problem is you haven&#39;t set up the include directories right in your project."}, {"owner": {"reputation": 23, "user_id": 4964512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I7P7jAr7KfY/AAAAAAAAAAI/AAAAAAAAALA/VYYmrqO9Uj4/photo.jpg?sz=128", "display_name": "Humaira", "link": "https://stackoverflow.com/users/4964512/humaira"}, "reply_to_user": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439359881, "post_id": 31956932, "comment_id": 51822989, "body": "I added that &#39;pqxx&#39; directory into it, still getting error"}, {"owner": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439360095, "post_id": 31956932, "comment_id": 51823104, "body": "Check <a href=\"https://stackoverflow.com/questions/257795/header-files-in-dev-c\">this question</a>. Same type of error. <a href=\"https://stackoverflow.com/questions/257795/header-files-in-dev-c\">Here&#39;s</a> also another one addressing the problem with not found header files"}, {"owner": {"reputation": 23, "user_id": 4964512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I7P7jAr7KfY/AAAAAAAAAAI/AAAAAAAAALA/VYYmrqO9Uj4/photo.jpg?sz=128", "display_name": "Humaira", "link": "https://stackoverflow.com/users/4964512/humaira"}, "reply_to_user": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439361458, "post_id": 31956932, "comment_id": 51823720, "body": "Just now I tried the steps in the given link. This is theerror I&#39;m getting: [Error] ld returned 1 exit status"}, {"owner": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439362621, "post_id": 31956932, "comment_id": 51824357, "body": "Maybe <a href=\"https://stackoverflow.com/questions/17717946/c-compile-error-id-returned-1-exit-status\">this</a> is the issue?"}, {"owner": {"reputation": 23, "user_id": 4964512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I7P7jAr7KfY/AAAAAAAAAAI/AAAAAAAAALA/VYYmrqO9Uj4/photo.jpg?sz=128", "display_name": "Humaira", "link": "https://stackoverflow.com/users/4964512/humaira"}, "reply_to_user": {"reputation": 239, "user_id": 1080762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/93ce87dad662479a2f8e8c2e2ec14276?s=128&d=identicon&r=PG", "display_name": "Erfan", "link": "https://stackoverflow.com/users/1080762/erfan"}, "edited": false, "score": 0, "creation_date": 1439364724, "post_id": 31956932, "comment_id": 51825536, "body": "This is the error i am getting after adding pqxx directory : [Error] pqxx/binarystring: No such file or directory Compilation Terminated. Also getting &#39;pqxx file name not recognized&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 416, "user_id": 14039238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jFxIRx-pN3I/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuck1vQYfLpXVTBGjJUq5EFKGgVok4w/photo.jpg?sz=128", "display_name": "I S", "link": "https://stackoverflow.com/users/14039238/i-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1597117217, "creation_date": 1597117217, "answer_id": 63351158, "question_id": 31956932, "link": "https://stackoverflow.com/questions/31956932/accessing-postgres-using-c-c/63351158#63351158", "title": "Accessing Postgres using C/C++", "body": "<p>The steps to access postgresql from applicaiton are</p>\n<ol>\n<li>Add &quot;postgresql installation folder&quot;\\inclue directory to compile stage.</li>\n<li>Add &quot;postgresql installation folder&quot;\\lib directory to linker stage.</li>\n<li>Add libpq.lib to linker stage.</li>\n<li>Copy libpq.dll from &quot;postgresql installation folder&quot;\\lib to your applicaiton folder.</li>\n<li>Include &quot;libpq-fe.h&quot; in your project.</li>\n</ol>\n<p>If you need any help about any step just comment.</p>\n"}], "owner": {"reputation": 23, "user_id": 4964512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I7P7jAr7KfY/AAAAAAAAAAI/AAAAAAAAALA/VYYmrqO9Uj4/photo.jpg?sz=128", "display_name": "Humaira", "link": "https://stackoverflow.com/users/4964512/humaira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1273, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1597965905, "creation_date": 1439358494, "question_id": 31956932, "link": "https://stackoverflow.com/questions/31956932/accessing-postgres-using-c-c", "title": "Accessing Postgres using C/C++", "body": "<p>I have created a window using Dev-C++ as a windows application (not console application) and I want to access the PostgreSql database through my C++ code from the windows code for executing simple queries and display the result in that window. I tried searching on internet for connection codes but constantly getting errors and none worked.</p>\n\n<p>I tried both the C and C++ codes and the respective procedures to connect. Can anyone help me get through this? \nHelp is appreciated! </p>\n"}, {"tags": ["c", "arrays", "file", "structure"], "comments": [{"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1439358514, "post_id": 31956897, "comment_id": 51822372, "body": "Can you provide your entire main function? You&#39;ve given only half a program..."}, {"owner": {"reputation": 21, "user_id": 5217700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90c16587415db771af4e1b9dc4137e0?s=128&d=identicon&r=PG&f=1", "display_name": "cstudent2015", "link": "https://stackoverflow.com/users/5217700/cstudent2015"}, "reply_to_user": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1439358859, "post_id": 31956897, "comment_id": 51822521, "body": "sorry, ive included my entire main function now"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1439358959, "post_id": 31956897, "comment_id": 51822565, "body": "See <a href=\"http://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\"><code>while (!feof(file))</code> is always wrong</a> for a discussion of why your loop is wrong.  TL;DR \u2014 test the result of <code>fscanf()</code>; do not use <code>feof()</code>."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1439359408, "post_id": 31956897, "comment_id": 51822765, "body": "What is <code>struct SalesPerson</code> ? Could it contain <code>char *lastName</code> ?"}, {"owner": {"reputation": 21, "user_id": 5217700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90c16587415db771af4e1b9dc4137e0?s=128&d=identicon&r=PG&f=1", "display_name": "cstudent2015", "link": "https://stackoverflow.com/users/5217700/cstudent2015"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1439359825, "post_id": 31956897, "comment_id": 51822959, "body": "@SergeBallesta struct SalesPerson has 5 pieces of information that the text im reading from already has. Im trying to create an array that stores those 5 pieces of information. I will post my sturcture int he above question."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1439359453, "post_id": 31957004, "comment_id": 51822781, "body": "The sample data has been updated since this (originally correct) answer was given."}], "tags": [], "owner": {"reputation": 4827, "user_id": 2372604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dba658108aa453906cfe0e229a8a18d?s=128&d=identicon&r=PG", "display_name": "ilent2", "link": "https://stackoverflow.com/users/2372604/ilent2"}, "is_accepted": false, "score": 1, "last_activity_date": 1439359246, "last_edit_date": 1439359246, "creation_date": 1439358871, "answer_id": 31957004, "question_id": 31956897, "link": "https://stackoverflow.com/questions/31956897/how-to-read-from-file-and-save-in-to-array-in-c-programing/31957004#31957004", "title": "How to read from file and save in to array in C programing?", "body": "<p>If your file has entries like <code>1;Smith;John;3;43</code> your <code>fscanf(fp, \"%d:%[^:]:%[^:]:%d:%lf\\n\"</code> should contain <code>;</code> instead of <code>:</code>.  Not sure if this is your only problem, but this is the first that jumps out at me.</p>\n\n<p><s>You may or may not need the <code>\\n</code> at the end either since (from memory) <code>scanf</code> will discard whitespace sometimes (I'll find a link).</s></p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5217700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90c16587415db771af4e1b9dc4137e0?s=128&d=identicon&r=PG&f=1", "display_name": "cstudent2015", "link": "https://stackoverflow.com/users/5217700/cstudent2015"}, "edited": false, "score": 0, "creation_date": 1439361788, "post_id": 31957269, "comment_id": 51823893, "body": "This has fixed my issue. Thank You"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 4, "last_activity_date": 1439359881, "last_edit_date": 1495539841, "creation_date": 1439359881, "answer_id": 31957269, "question_id": 31956897, "link": "https://stackoverflow.com/questions/31956897/how-to-read-from-file-and-save-in-to-array-in-c-programing/31957269#31957269", "title": "How to read from file and save in to array in C programing?", "body": "<p>You have an extraneous level of indentation; you really don't need the <code>{</code> after the declaration of the unused <code>openRead()</code> function, or the corresponding <code>}</code>.</p>\n\n<p>You've updated the data to match the code, which isn't entirely fair on <a href=\"https://stackoverflow.com/users/2372604/ilent2\">ilent2</a> whose <a href=\"https://stackoverflow.com/a/31957004/15168\">answer</a> was originally pertinent but is no longer as relevant.</p>\n\n<p>You have major problems in the reading loops \u2014 one of the problems being that there are two nested loops:</p>\n\n<pre><code>for (i=0;i&lt;SIZE;i++){\n    while(!feof(fp)){\n        fscanf(fp, \"%d:%[^:]:%[^:]:%d:%lf\\n\", &amp;s[i].salesNum, s[i].lastName, s[i].firstName, &amp;s[i].salesRate, &amp;s[i].salesAmount);\n    }\n}\n</code></pre>\n\n<p>Your inner loop suffers from <a href=\"https://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\"><code>while (!feof(file))</code> is always wrong</a>.  Additionally, you read to EOF for <code>i == 0</code>, and the subsequent reads all fail immediately.  (This doesn't tie in with your claimed result: it isn't clear to me what you've done here.)  You should be testing that the <code>fscanf()</code> read the correct number of values.  So, you need a single loop, and it should look more like:</p>\n\n<pre><code>for (i = 0; i &lt; SIZE; i++)\n{\n    if (fscanf(fp, \"%d:%[^:]:%[^:]:%d:%lf\\n\", &amp;s[i].salesNum, s[i].lastName,\n               s[i].firstName, &amp;s[i].salesRate, &amp;s[i].salesAmount) != 5)\n        break;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5217700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e90c16587415db771af4e1b9dc4137e0?s=128&d=identicon&r=PG&f=1", "display_name": "cstudent2015", "link": "https://stackoverflow.com/users/5217700/cstudent2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2770, "favorite_count": 1, "accepted_answer_id": 31957269, "answer_count": 2, "score": 1, "last_activity_date": 1439370763, "creation_date": 1439358360, "last_edit_date": 1439370763, "question_id": 31956897, "link": "https://stackoverflow.com/questions/31956897/how-to-read-from-file-and-save-in-to-array-in-c-programing", "title": "How to read from file and save in to array in C programing?", "body": "<p>I am trying to read from a file that contains multiple lines of numbers and strings and save it to an array. However when I call upon the elements of values stored in that array, and I got incorrect results.</p>\n\n<p>For example if I have a text file that has </p>\n\n<pre><code>1:Smith:John:3;43\n2:Saget:Bob:5:55\n3:Wayne:Bruce:7:21\n</code></pre>\n\n<p>I'm trying to store the objects for the first line in the array in <code>s[0]</code>, second line in <code>s[1]</code>, and third line in <code>s[3]</code>.   </p>\n\n<p>Here is my <code>struct SalesPerson</code></p>\n\n<pre><code>struct SalesPerson {\n    int salesNum; // 4-digit integer\n    char lastName[31]; // salesperson's last name\n    char firstName[31]; // salesperson's first name\n    int salesRate; // commission level for each salesperson\n    double salesAmount; //amount the salesperson committed for the week   \n};\n</code></pre>\n\n<p>Here is my main function</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"sales.h\"\n#define SIZE 1000\n\nint main()\n{\n    struct SalesPerson s[SIZE];\n\n    //opening the file for reading\n    FILE * openRead(char salesinfo[]);\n    {\n        FILE *fp;\n        fp = fopen(\"salesinfo.txt\", \"r\");\n\n        int i;\n\n        if(fp != NULL){\n\n            //read from the file and save it to array s\n            for (i=0;i&lt;SIZE;i++){\n                while(!feof(fp)){\n                    fscanf(fp, \"%d:%[^:]:%[^:]:%d:%lf\\n\" ,&amp;s[i].salesNum,     s[i].lastName, s[i].firstName, &amp;s[i].salesRate, &amp;s[i].salesAmount);\n                }\n            }\n            fclose(fp);\n        }\n        else\n            printf(\"ERROR! Cannot open the file!\\n\");\n    }\n}\n</code></pre>\n\n<p>If I do</p>\n\n<pre><code>printf(\"%d\\n\", s[i].salesRate);\n</code></pre>\n\n<p>I get all the results for <code>salesRate</code>.</p>\n\n<pre><code>3\n5\n7\n</code></pre>\n\n<p>However, when I try a <code>printf</code></p>\n\n<pre><code>printf(\"%d\\n\", s[1].salesRate);\n</code></pre>\n\n<p>Instead of giving me <code>5</code>, I got an incorrect result. Can someone tell me where I am going wrong? Is my for loop condition incorrect? </p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 791, "user_id": 4870385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jSWXK.jpg?s=128&g=1", "display_name": "Ritesh Sinha", "link": "https://stackoverflow.com/users/4870385/ritesh-sinha"}, "edited": false, "score": 0, "creation_date": 1439358195, "post_id": 31956704, "comment_id": 51822261, "body": "The code is working fine.I ran it and i got the output in the same order of the input . <code>:~$ cc dll.c :~$ .&#47;a.out Enter data(y&#47;n)?y Enter data3 Enter more data..?(y&#47;n)y Enter data4 Enter more data..?(y&#47;n)y Enter data5 Enter more data..?(y&#47;n)n 345</code>"}, {"owner": {"reputation": 1597, "user_id": 1307255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7XEd.jpg?s=128&g=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/1307255/nishant"}, "edited": false, "score": 0, "creation_date": 1439358337, "post_id": 31956704, "comment_id": 51822300, "body": "Code is working fine for me..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1439359231, "post_id": 31956704, "comment_id": 51822691, "body": "Please fix this: <code>scanf(&quot;%s&quot;,&amp;ch);</code> Your code already invokes undefined behavior for any non-empty input string."}], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1439366507, "post_id": 31957175, "comment_id": 51826581, "body": "actually <code>scanf(&quot;%s&quot;,&amp;ch);</code> is correct - second argument should be a pointer to char, and <code>&amp;ch</code> is a pointer to char"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 1, "creation_date": 1439372008, "post_id": 31957175, "comment_id": 51830269, "body": "@mangusta Even if you enter a single character, it will write the <code>&#39;\\0&#39;</code> past <code>ch</code>. So it&#39;s only good as long as you don&#39;t use it, which doesn&#39;t make it very good indeed."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5034652"}, "is_accepted": false, "score": 3, "last_activity_date": 1439359560, "creation_date": 1439359560, "answer_id": 31957175, "question_id": 31956704, "link": "https://stackoverflow.com/questions/31956704/insertion-at-the-end-of-doubly-linked-list/31957175#31957175", "title": "Insertion at the end of doubly linked list", "body": "<p>Your logic of the code is correct but here is the error: make <code>scanf(\"%s\",&amp;ch);</code> as <code>scanf(\" %c\",&amp;ch);</code></p>\n"}, {"comments": [{"owner": {"reputation": 850, "user_id": 1994152, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/03Tav.jpg?s=128&g=1", "display_name": "Akhil V Suku", "link": "https://stackoverflow.com/users/1994152/akhil-v-suku"}, "edited": false, "score": 0, "creation_date": 1439443864, "post_id": 31958747, "comment_id": 51865866, "body": "why did you vote down ? Plz give me the reason, so that I can improve."}], "tags": [], "owner": {"reputation": 850, "user_id": 1994152, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/03Tav.jpg?s=128&g=1", "display_name": "Akhil V Suku", "link": "https://stackoverflow.com/users/1994152/akhil-v-suku"}, "is_accepted": false, "score": 1, "last_activity_date": 1453879231, "last_edit_date": 1453879231, "creation_date": 1439364656, "answer_id": 31958747, "question_id": 31956704, "link": "https://stackoverflow.com/questions/31956704/insertion-at-the-end-of-doubly-linked-list/31958747#31958747", "title": "Insertion at the end of doubly linked list", "body": "<p>Try this, simplest code for your problem, the changes I have made are,</p>\n\n<blockquote>\n  <p>changed scanf(\"%s\",&amp;ch); to scanf(\"%c\",&amp;ch);</p>\n</blockquote>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;stdlib.h&gt; \n\n#define _CRT_SECURE_NO_WARNINGS\n\nusing namespace std;\ntypedef struct d_list{\n    int data;\n    struct d_list *next;\n    struct d_list *prev;\n}node; \n\ntypedef node *list;\nint main()\n{\n    char ch;\n    int n;\n    list head = NULL,temp = NULL,tail = NULL;  \n    do{\n        printf(\"\\nEnter data ?(y/n):\\n\");\n        scanf(\"%c\",&amp;ch); \n        if(ch=='n'||ch=='N')\n            break;\n        printf(\"\\nEnter data :\\n\");\n        scanf_s(\"%d\",&amp;n);\n        temp=(list)malloc(sizeof(node));\n        temp-&gt;data=n;\n        temp-&gt;next=NULL;\n        if(head == NULL)\n        {  \n            temp-&gt;prev=NULL;\n            head=temp; \n        }\n        else\n        {\n            temp-&gt;prev=tail;\n            tail-&gt;next=temp;\n        }\n        tail=temp;  \n    }while(ch=='y'||ch == 'Y');\n\n    temp=head;\n    while(temp!=NULL){\n        printf(\"\\n%d\",temp-&gt;data);\n        temp=temp-&gt;next;\n    } \n    getch();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 416, "user_id": 5217697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755f286b04cb48392859a2418494e902?s=128&d=identicon&r=PG&f=1", "display_name": "SAHIL SINGH SODHI", "link": "https://stackoverflow.com/users/5217697/sahil-singh-sodhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1453879231, "creation_date": 1439357388, "question_id": 31956704, "link": "https://stackoverflow.com/questions/31956704/insertion-at-the-end-of-doubly-linked-list", "title": "Insertion at the end of doubly linked list", "body": "<p>I am only able to view the very first element of the input.The code is given as follows:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;stdlib.h&gt;\n\ntypedef struct d_list{\n    int data;\n    struct d_list *next;\n    struct d_list *prev;\n}node;\n</code></pre>\n\n<p>// Without recursively calling the insert function. </p>\n\n<pre><code>typedef node *list;\nmain(){\n    printf(\"Enter data(y/n)?\");\n    char ch;\n    scanf(\"%s\",&amp;ch);\n    int n;\n    list head;\n    list temp;\n    list tail;\n    head=tail=temp=NULL;\n    if(ch=='y'||ch=='Y'){\n        printf(\"Enter data\");\n        scanf(\"%d\",&amp;n);\n        temp=(list)malloc(sizeof(node));\n        temp-&gt;data=n;\n        temp-&gt;next=temp-&gt;prev=NULL;\n        head=temp;\n        tail=temp;\n    }\n    printf(\"Enter more data..?(y/n)\");\n    scanf(\"%s\",&amp;ch);\n    while(ch=='y'||ch=='Y'){\n        printf(\"Enter data\");\n        scanf(\"%d\",&amp;n);\n        temp=(list)malloc(sizeof(node));\n        temp-&gt;data=n;\n        temp-&gt;prev=tail;\n        temp-&gt;next=NULL;\n        tail-&gt;next=temp;\n        tail=temp;\n        printf(\"Enter more data..?(y/n)\");\n        scanf(\"%s\",&amp;ch);\n    }\n\n    temp=head;\n    while(temp!=NULL){\n        printf(\"%d\",temp-&gt;data);\n        temp=temp-&gt;next;\n    }\n    getch();\n}\n</code></pre>\n\n<p>I want to display all the inputs in the order they were input.What is the problem here?</p>\n"}, {"tags": ["c++", "c", "visual-studio", "command-line-interface"], "comments": [{"owner": {"reputation": 1339, "user_id": 3770004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x3XVp.jpg?s=128&g=1", "display_name": "Daniel Brose", "link": "https://stackoverflow.com/users/3770004/daniel-brose"}, "edited": false, "score": 0, "creation_date": 1439356999, "post_id": 31956487, "comment_id": 51821832, "body": "You need to share more info, ideally check the source code of that linked file, as it seems that the file is where the error is."}, {"owner": {"reputation": 731, "user_id": 2412696, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/4rShN.jpg?s=128&g=1", "display_name": "novian kristianto", "link": "https://stackoverflow.com/users/2412696/novian-kristianto"}, "reply_to_user": {"reputation": 1339, "user_id": 3770004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x3XVp.jpg?s=128&g=1", "display_name": "Daniel Brose", "link": "https://stackoverflow.com/users/3770004/daniel-brose"}, "edited": false, "score": 0, "creation_date": 1439361275, "post_id": 31956487, "comment_id": 51823611, "body": "@DanielBrose this sampe code daniel. please tell me what happen"}, {"owner": {"reputation": 1339, "user_id": 3770004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x3XVp.jpg?s=128&g=1", "display_name": "Daniel Brose", "link": "https://stackoverflow.com/users/3770004/daniel-brose"}, "edited": false, "score": 0, "creation_date": 1439361752, "post_id": 31956487, "comment_id": 51823878, "body": "I cant say at a glance, but pls edit your question to remove first line in error code block unless it actually printing that first line too. The first error looks to be syntax, i cant see a missing close there, but worth checking elsewhere for it and if possible removing code sections till you find point when issue disapears, to be certain its actually those lines you shared at fault. There should also be a stacktrace, you can see when the first error occured and jump to that position - its a matter then of chasing all code before then (including in calling functions) to see if issue is there"}, {"owner": {"reputation": 731, "user_id": 2412696, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/4rShN.jpg?s=128&g=1", "display_name": "novian kristianto", "link": "https://stackoverflow.com/users/2412696/novian-kristianto"}, "reply_to_user": {"reputation": 1339, "user_id": 3770004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x3XVp.jpg?s=128&g=1", "display_name": "Daniel Brose", "link": "https://stackoverflow.com/users/3770004/daniel-brose"}, "edited": false, "score": 0, "creation_date": 1439364359, "post_id": 31956487, "comment_id": 51825299, "body": "i dont know, why every i added &lt;msclr\\marshal_cppstd.h&gt;, my project always error. and the error is always about winuser.h"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1439374002, "post_id": 31956487, "comment_id": 51831686, "body": "You are battling a macro.  Omitting the line numbers from the error messages doesn&#39;t help us help you.  Swap the two #includes and you&#39;ll know more."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439435612, "post_id": 31956487, "comment_id": 51863546, "body": "that is c++ code, so please remove the &#39;c&#39; tag"}], "owner": {"reputation": 731, "user_id": 2412696, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/4rShN.jpg?s=128&g=1", "display_name": "novian kristianto", "link": "https://stackoverflow.com/users/2412696/novian-kristianto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 574, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439361862, "creation_date": 1439356202, "last_edit_date": 1439361862, "question_id": 31956487, "link": "https://stackoverflow.com/questions/31956487/msclr-marshal-cppstd-h-error-when-open-on-visual-studio-2013", "title": "msclr\\marshal_cppstd.h error when open on visual studio 2013", "body": "<p>i develop some function using visual studio 2015 that include</p>\n\n<pre><code>#include &lt;msclr\\marshal_cppstd.h&gt;;\n</code></pre>\n\n<p>when i try to open on visual studio 2013,</p>\n\n<pre><code>error C2059: syntax error : ')'\nerror C2059: syntax error : ')'\nerror C2059: syntax error : ')'\nerror C2059: syntax error : ')'\nerror C2143: syntax error : missing ';' before '__stdcall'\nerror C2143: syntax error : missing ';' before '__stdcall'\nerror C2146: syntax error : missing ')' before identifier 'hDesktop'\nerror C2146: syntax error : missing ')' before identifier 'hDesktop'\nerror C2146: syntax error : missing ')' before identifier 'hDesktop'\nerror C2146: syntax error : missing ')' before identifier 'hDesktop'\nerror C2146: syntax error : missing ';' before identifier 'hdesk'\nerror C2377: 'HDESK' : redefinition; typedef cannot be overloaded with any other symbol\nerror C2440: 'initializing' : cannot convert from 'HDESK' to 'BOOL'\nerror C2440: 'initializing' : cannot convert from 'HDESK' to 'BOOL'\nerror C2440: 'initializing' : cannot convert from 'HDESK' to 'BOOL'\nerror C2440: 'initializing' : cannot convert from 'HDESK' to 'BOOL'\n</code></pre>\n\n<p>what it can happen?\ncan some one tell me why?</p>\n\n<p>this the code</p>\n\n<pre><code>    #include \"Stdafx.h\"\n#include \"Image.h\"\n#include &lt;msclr\\marshal_cppstd.h&gt;\n    Image::Image(System::String^ path)\n    {\n        std::string str = msclr::interop::marshal_as&lt;std::string&gt;(path);\n        _mat = new cv::Mat();\n        (*_mat) = cv::imread(str);\n    }\n</code></pre>\n\n<p>the code running well in visual studio 2015, but in vs2013. it's not working</p>\n"}, {"tags": ["c", "gcc", "sqlite"], "answers": [{"tags": [], "owner": {"reputation": 1298, "user_id": 143279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I0Npe.jpg?s=128&g=1", "display_name": "bleakgadfly", "link": "https://stackoverflow.com/users/143279/bleakgadfly"}, "is_accepted": true, "score": 1, "last_activity_date": 1439363324, "creation_date": 1439363324, "answer_id": 31958279, "question_id": 31956355, "link": "https://stackoverflow.com/questions/31956355/sqlite3-adding-custom-function/31958279#31958279", "title": "Sqlite3 adding custom function", "body": "<p>Try to include the assert header </p>\n\n<pre><code>diff --git a/rank_orig.c b/rank.c\nindex 5d51b4d..4940e1b 100644\n--- a/rank_orig.c\n+++ b/rank.c\n@@ -1,5 +1,6 @@\n #if !defined(SQLITE_CORE) || defined(SQLITE_ENABLE_RANK)\n #include &lt;stdio.h&gt;\n+#include &lt;assert.h&gt;\n #ifndef SQLITE_CORE\n   #include \"sqlite3ext.h\"\n</code></pre>\n\n<p>Compile:</p>\n\n<pre><code>$ gcc -shared -fPIC -lm rank.c -o librank.so\n</code></pre>\n\n<p>Load</p>\n\n<pre><code>$ sqlite3 \nSQLite version 3.8.10.1 2015-05-09 12:14:55\nsqlite&gt; .load ./librank.so \nsqlite&gt; \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": false, "score": 0, "last_activity_date": 1439366067, "creation_date": 1439366067, "answer_id": 31959222, "question_id": 31956355, "link": "https://stackoverflow.com/questions/31956355/sqlite3-adding-custom-function/31959222#31959222", "title": "Sqlite3 adding custom function", "body": "<p>The error message shows that SQLite already appends \".so\" to the file name.\nSo you must specify the bare library name:</p>\n\n<pre><code>&gt; .load './librank'\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 4962779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26ac74c302a0e3ddda89856574e6f63c?s=128&d=identicon&r=PG&f=1", "display_name": "ohss117", "link": "https://stackoverflow.com/users/4962779/ohss117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 31958279, "answer_count": 2, "score": 0, "last_activity_date": 1439366067, "creation_date": 1439355549, "last_edit_date": 1592644375, "question_id": 31956355, "link": "https://stackoverflow.com/questions/31956355/sqlite3-adding-custom-function", "title": "Sqlite3 adding custom function", "body": "<p>I'm trying to add a custom rank function written in C for SQLite3. The code compiles, but I can't seem to load it in sqlite3. When I do <code>.load './librank.so'</code> in SQLite3, I see this error message:</p>\n<pre><code>./librank.so.so: cannot open shared object file: No such file or directory\n</code></pre>\n<p>The code (from <a href=\"http://www.sqlite.org/fts3.html#appendix_a\" rel=\"nofollow noreferrer\">http://www.sqlite.org/fts3.html#appendix_a</a>)</p>\n<h1>Rank.c</h1>\n<pre><code>#if !defined(SQLITE_CORE) || defined(SQLITE_ENABLE_RANK)\n#include &lt;stdio.h&gt;\n#ifndef SQLITE_CORE\n  #include &quot;sqlite3ext.h&quot;\n  SQLITE_EXTENSION_INIT1\n#else\n  #include &quot;sqlite3.h&quot;\n#endif\n\n\nstatic void rankfunc(sqlite3_context *pCtx, int nVal, sqlite3_value **apVal){\n  int *aMatchinfo;                /* Return value of matchinfo() */\n  int nCol;                       /* Number of columns in the table */\n  int nPhrase;                    /* Number of phrases in the query */\n  int iPhrase;                    /* Current phrase */\n  double score = 0.0;             /* Value to return */\n\n  assert( sizeof(int)==4 );\n\n  /* Check that the number of arguments passed to this function is correct.\n  ** If not, jump to wrong_number_args. Set aMatchinfo to point to the array\n  ** of unsigned integer values returned by FTS function matchinfo. Set\n  ** nPhrase to contain the number of reportable phrases in the users full-text\n  ** query, and nCol to the number of columns in the table.\n  */\n  if( nVal&lt;1 ) goto wrong_number_args;\n  aMatchinfo = (unsigned int *)sqlite3_value_blob(apVal[0]);\n  nPhrase = aMatchinfo[0];\n  nCol = aMatchinfo[1];\n  if( nVal!=(1+nCol) ) goto wrong_number_args;\n\n  /* Iterate through each phrase in the users query. */\n  for(iPhrase=0; iPhrase&lt;nPhrase; iPhrase++){\n    int iCol;                     /* Current column */\n\n    /* Now iterate through each column in the users query. For each column,\n    ** increment the relevancy score by:\n    **\n    **   (&lt;hit count&gt; / &lt;global hit count&gt;) * &lt;column weight&gt;\n    **\n    ** aPhraseinfo[] points to the start of the data for phrase iPhrase. So\n    ** the hit count and global hit counts for each column are found in \n    ** aPhraseinfo[iCol*3] and aPhraseinfo[iCol*3+1], respectively.\n    */\n    int *aPhraseinfo = &amp;aMatchinfo[2 + iPhrase*nCol*3];\n    for(iCol=0; iCol&lt;nCol; iCol++){\n      int nHitCount = aPhraseinfo[3*iCol];\n      int nGlobalHitCount = aPhraseinfo[3*iCol+1];\n      double weight = sqlite3_value_double(apVal[iCol+1]);\n      if( nHitCount&gt;0 ){\n        score += ((double)nHitCount / (double)nGlobalHitCount) * weight;\n      }\n    }\n  }\n\n  sqlite3_result_double(pCtx, score);\n  return;\n\n  /* Jump here if the wrong number of arguments are passed to this function */\nwrong_number_args:\n  sqlite3_result_error(pCtx, &quot;wrong number of arguments to function rank()&quot;, -1);\n}\n\nint sqlite3rankInit(sqlite3 *db){\n  sqlite3_create_function(db, &quot;rank&quot;, -1, SQLITE_UTF8, 0, &amp;rankfunc, 0, 0);\n  return 0;\n}\n\n#if !SQLITE_CORE\nint sqlite3_extension_init(\n  sqlite3 *db, \n  char **pzErrMsg,\n  const sqlite3_api_routines *pApi\n){\n  SQLITE_EXTENSION_INIT2(pApi)\n  return sqlite3rankInit(db);\n}\n#endif\n\n#endif\n\n\nCompiled with: gcc -shared -fPIC -lm rank.c -o librank.so\n</code></pre>\n<p>Can someone help me see what I did incorrectly?</p>\n"}, {"tags": ["c++", "c", "networking", "ipv6"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1439362748, "post_id": 31955924, "comment_id": 51824418, "body": "Practically speaking, won&#39;t all ranges be between  /32 and /96 ?"}, {"owner": {"reputation": 8333, "user_id": 813192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee82a22b9a73f459fe180128811e4c1?s=128&d=identicon&r=PG", "display_name": "Sander Steffann", "link": "https://stackoverflow.com/users/813192/sander-steffann"}, "edited": false, "score": 1, "creation_date": 1439366720, "post_id": 31955924, "comment_id": 51826715, "body": "IPv6 is designed so that you always have more addresses than you&#39;ll ever need, so I hope you&#39;ll never need this code. Thinking about the number of addresses with IPv6 is usually a sign that you&#39;re still stuck in an IPv4 mindset :)"}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 1, "creation_date": 1439403350, "post_id": 31955924, "comment_id": 51852005, "body": "With a few exceptions, an IPv6 address range (subnet) will be a /64, and that equals 18,446,744,073,709,551,616 addresses per subnet. For other sizes, you could always calculate 2^(128-mask length)."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1439445669, "post_id": 31955924, "comment_id": 51866595, "body": "Subtraction is the wrong solution. You&#39;ve asked the wrong question."}], "answers": [{"tags": [], "owner": {"reputation": 4666, "user_id": 981367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ca05a550269a76bcdc899350338f5501?s=128&d=identicon&r=PG", "display_name": "VoidStar", "link": "https://stackoverflow.com/users/981367/voidstar"}, "is_accepted": true, "score": 3, "last_activity_date": 1439356009, "last_edit_date": 1439356009, "creation_date": 1439354669, "answer_id": 31956210, "question_id": 31955924, "link": "https://stackoverflow.com/questions/31955924/how-can-i-subtract-two-ipv6-addresses-128bit-numbers-in-c-c/31956210#31956210", "title": "How can I subtract two IPv6 addresses (128bit numbers) in C/C++?", "body": "<p>You could use some kind of big-int library (if you can tolerate LGPL, GMP is the choice). Fortunately, 128 bit subtraction is easy to simulate by hand if necessary. Here is a quick and dirty demonstration of computing the absolute value of (a-b), for 128 bit values:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\nstruct U128\n{\n    unsigned long long hi;\n    unsigned long long lo;\n};\n\nbool subtract(U128&amp; a, U128 b)\n{\n    unsigned long long carry = b.lo &gt; a.lo;\n    a.lo -= b.lo;\n    unsigned long long carry2 = b.hi &gt; a.hi || a.hi == b.hi &amp;&amp; carry;\n    a.hi -= carry;\n    a.hi -= b.hi;\n    return carry2 != 0;\n}\n\nint main()\n{\n    U128 ipAddressA = { 45345, 345345 };\n    U128 ipAddressB = { 45345, 345346 };\n\n    bool carry = subtract(ipAddressA, ipAddressB);\n\n    // Carry being set means that we underflowed; that ipAddressB was &gt; ipAddressA.\n    // Lets just compute 0 - ipAddressA as a means to calculate the negation \n    // (0-x) of our current value. This gives us the absolute value of the\n    // difference.\n    if (carry)\n    {\n        ipAddressB = ipAddressA;\n        ipAddressA = { 0, 0 };\n        subtract(ipAddressA, ipAddressB);\n    }\n\n    // Print gigantic hex string of the 128-bit value\n    std::cout.fill ('0');\n    std::cout &lt;&lt; std::hex &lt;&lt; std::setw(16) &lt;&lt; ipAddressA.hi &lt;&lt; std::setw(16) &lt;&lt; ipAddressA.lo &lt;&lt; std::endl; \n}\n</code></pre>\n\n<p>This gives you the absolute value of the difference. If the range is not huge (64 bits or less), then <code>ipAddressA.lo</code> can be your answer as a simple <code>unsigned long long</code>.</p>\n\n<p>If you have perf concerns, you can make use of compiler intrinsics for taking advantage of certain architectures, such as amd64 if you want it to be optimal on that processor. <code>_subborrow_u64</code> is the amd64 intrinsic for the necessary subtraction work.</p>\n"}, {"comments": [{"owner": {"reputation": 195, "user_id": 1779052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81d5b73d1f5ccc0bb7ea15690d5225be?s=128&d=identicon&r=PG", "display_name": "shadowyman", "link": "https://stackoverflow.com/users/1779052/shadowyman"}, "edited": false, "score": 0, "creation_date": 1439415185, "post_id": 31974203, "comment_id": 51858221, "body": "What would&#39;ve been the method if I could rely on existence of uint64_t. So, to make things simpler, I&#39;ve <b>uint64_t addr_begin[2]</b> and <b>uint64_t addr_end[2]</b>, where it&#39;s guaranteed that <b>addr_end &gt;= addr_begin</b>. How could I store the result in <b>uint64_t result[2]</b>?  Thanks a lot Brett, for your time."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "reply_to_user": {"reputation": 195, "user_id": 1779052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81d5b73d1f5ccc0bb7ea15690d5225be?s=128&d=identicon&r=PG", "display_name": "shadowyman", "link": "https://stackoverflow.com/users/1779052/shadowyman"}, "edited": false, "score": 1, "creation_date": 1439445269, "post_id": 31974203, "comment_id": 51866416, "body": "@shadowyman - added examples. the u128 difference uses same subtract/borrow idea as the byte &#39;vector&#39;."}], "tags": [], "owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "is_accepted": false, "score": 1, "last_activity_date": 1439451541, "last_edit_date": 1439451541, "creation_date": 1439409197, "answer_id": 31974203, "question_id": 31955924, "link": "https://stackoverflow.com/questions/31955924/how-can-i-subtract-two-ipv6-addresses-128bit-numbers-in-c-c/31974203#31974203", "title": "How can I subtract two IPv6 addresses (128bit numbers) in C/C++?", "body": "<p>The <code>in6_addr</code> structure stores the address in network byte order - or 'big endian' - with the most significant byte @ <code>s6_addr[0]</code>. You can't count on the other union members being consistently named, or defined. Even If you accessed the union through a (non-portable) <code>uint32_t</code> field, the values would have to be converted with <code>ntohl</code>. So a <em>portable</em> method of finding the difference needs some work.</p>\n\n<p>You can convert the <code>in6_addr</code> to <code>uint64_t[2]</code>. Sticking with typical 'bignum' conventions, we use [0] for the low 64-bits and [1] for the high 64-bits:</p>\n\n<pre><code>static inline void\nin6_to_u64 (uint64_t dst[2], const struct in6_addr *src)\n{\n    uint64_t hi = 0, lo = 0;\n\n    for (unsigned int i = 0; i &lt; 8; i++)\n    {\n        hi = (hi &lt;&lt; 8) | src-&gt;s6_addr[i];\n        lo = (lo &lt;&lt; 8) | src-&gt;s6_addr[i + 8];\n    }\n\n    dst[0] = lo, dst[1] = hi;\n}\n</code></pre>\n\n<p>and the difference:</p>\n\n<pre><code>static inline unsigned int\nu64_diff (uint64_t d[2], const uint64_t x[2], const uint64_t y[2])\n{\n    unsigned int b = 0, bi;\n\n    for (unsigned int i = 0; i &lt; 2; i++)\n    {\n        uint64_t di, xi, yi, tmp;\n\n        xi = x[i], yi = y[i];\n        tmp = xi - yi;\n        di = tmp - b, bi = tmp &gt; xi;\n        d[i] = di, b = bi | (di &gt; tmp);\n    }\n\n    return b; /* borrow flag = (x &lt; y) */\n}\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 1779052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81d5b73d1f5ccc0bb7ea15690d5225be?s=128&d=identicon&r=PG", "display_name": "shadowyman", "link": "https://stackoverflow.com/users/1779052/shadowyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 3, "accepted_answer_id": 31956210, "answer_count": 2, "score": 6, "last_activity_date": 1439451541, "creation_date": 1439352910, "last_edit_date": 1439354116, "question_id": 31955924, "link": "https://stackoverflow.com/questions/31955924/how-can-i-subtract-two-ipv6-addresses-128bit-numbers-in-c-c", "title": "How can I subtract two IPv6 addresses (128bit numbers) in C/C++?", "body": "<p>I'm storing the IP address in <code>sockaddr_in6</code> which supports an array of four 32-bit, <strong>addr[4]</strong>. Essentially a 128 bit number.</p>\n\n<p>I'm trying to calculate number of IPs in a given IPv6 range (how many IPs between). So it's a matter of subtracting one from another using two arrays with a length of four.</p>\n\n<p>The problem is since there's no <strong>128bit</strong> data type, I can't convert into decimal.</p>\n\n<p>Thanks a ton! </p>\n"}, {"tags": ["c", "function", "queue", "printf", "getter"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1439351514, "post_id": 31955624, "comment_id": 51820252, "body": "I don&#39;t think it is your problem, but <code>get_data()</code> isn&#39;t consistent - it prints <code>current-&gt;data</code> and then checks <code>current</code> - you should null check first - a) avoid undefined behavior, b) value printed will match value returned."}, {"owner": {"reputation": 359, "user_id": 3109926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r7ymx.png?s=128&g=1", "display_name": "Lencho Reyes", "link": "https://stackoverflow.com/users/3109926/lencho-reyes"}, "edited": false, "score": 1, "creation_date": 1439351958, "post_id": 31955624, "comment_id": 51820356, "body": "Can you please add the code for your construct_queue() function?"}, {"owner": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1439353933, "post_id": 31955624, "comment_id": 51820864, "body": "@ Lencho Reyes - I did!  @John3136 - I will try that right now."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439354703, "post_id": 31955624, "comment_id": 51821078, "body": "Is <code>get_data()</code> declare/defined before first use?"}, {"owner": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "edited": false, "score": 0, "creation_date": 1439355159, "post_id": 31955624, "comment_id": 51821199, "body": "You got it. I forgot to include it into the header. Many thanks! Please post it as the answer and I will select it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439355678, "post_id": 31955624, "comment_id": 51821360, "body": "You may post your own - time for my beauty sleep ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "edited": false, "score": 0, "creation_date": 1439355932, "post_id": 31956384, "comment_id": 51821453, "body": "To pinpoint the actual problem, as chux said and as you coded -  I did not include &quot;get_data&quot; in the header. Thanks for the thorough answer!"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1439356145, "last_edit_date": 1439356145, "creation_date": 1439355666, "answer_id": 31956384, "question_id": 31955624, "link": "https://stackoverflow.com/questions/31955624/function-seems-to-return-the-correct-value-but-the-outside-caller-never-gets-it/31956384#31956384", "title": "Function seems to return the correct value, but the outside caller never gets it in C", "body": "<p>There was a lot of missing code that had to be reconstructed.  This code, which carefully ensures that all functions are declared before being used, seems to work correctly:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef int attribute_value;\n\n#define TESTING \"%s\\n\"\n\nstruct entry\n{\n    double data;\n    attribute_value time_stamp;\n    struct entry *next;\n};\n\ntypedef struct queue_struct\n{\n    struct entry *front;\n    struct entry *end;\n    int size;\n} queue;\n\ndouble get_data(struct entry *current);\nqueue *construct_queue(void);\nstruct entry *get_front(queue *Q);\nstruct entry *get_end(queue *Q);\nvoid print_queau(queue *Q);\nvoid push(queue *Q, double input, attribute_value time_stamp);\nvoid test_queue_push(bool enable_print);\nstruct entry *get_next(struct entry *curr);\nvoid set_front(queue *Q, struct entry *in);\nvoid set_end(queue *Q, struct entry *in);\nvoid set_next(struct entry *E, struct entry *in);\n\nvoid set_front(queue *Q, struct entry *in)\n{\n    if (Q != 0)\n        Q-&gt;front = in;\n}\n\nvoid set_end(queue *Q, struct entry *in)\n{\n    if (Q != 0)\n        Q-&gt;end = in;\n}\n\nvoid set_next(struct entry *E, struct entry *in)\n{\n    if (E != 0)\n        E-&gt;next = in;\n}\n\nstruct entry *get_next(struct entry *curr)\n{\n    if (curr != 0)\n        return curr-&gt;next;\n    return 0;\n}\n\ndouble get_data(struct entry *current)\n{\n    if (current)\n    {\n        printf(\"!!!!!!!!!!!!! %lf\\n\", current-&gt;data);\n        return current-&gt;data;\n    }\n    return 0;\n}\n\nstruct entry *get_end(queue *Q)\n{\n    return Q-&gt;end;\n}\n\nstruct entry *get_front(queue *Q)\n{\n    return Q-&gt;front;\n}\n\nvoid test_queue_push(bool enable_print)\n{\n    printf(TESTING, \"Testing push in queue.c\");\n    queue *Q = construct_queue();\n\n    push(Q, 10, 0);\n    if (enable_print)\n        print_queau(Q);\n\n\n    printf(\"GET DATA: %lf\\n\", get_data(get_front(Q)));\n}\n\nvoid print_queau(queue *Q)\n{\n    struct entry *temp = get_front(Q);\n    while (temp != NULL)\n    {\n        printf(\"%lf -&gt; \", get_data(temp));\n        temp = get_next(temp);\n    }\n    printf(\"\\n\");\n}\n\nvoid push(queue *Q, double input, attribute_value time_stamp)\n{\n    if (Q)\n    {\n        struct entry *in;\n        if ((in = calloc(1, sizeof(struct entry))) != 0)\n        {\n            Q-&gt;size = Q-&gt;size + 1;\n            in-&gt;data = input;\n            in-&gt;next = NULL;\n            in-&gt;time_stamp = time_stamp;\n\n            if (get_front(Q) == NULL &amp;&amp; get_end(Q) == NULL)\n            {\n                set_front(Q, in);\n                set_end(Q, in);\n                return;\n            }\n            set_next(get_end(Q), in);\n            set_end(Q, in);\n        }\n    }\n}\n\nqueue *construct_queue(void)\n{\n    queue *Q;\n    if ((Q = calloc(1, sizeof(queue))) != 0)\n    {\n        Q-&gt;front = NULL;\n        Q-&gt;end = NULL;\n        Q-&gt;size = 0;\n    }\n    if (Q == NULL)\n    {\n        fprintf(stderr, \"Ran out of memory when allocating memory for queue in construct_queue in queue.c\\n\");\n    }\n    return Q;\n}\n\nint main(void)\n{\n    test_queue_push(true);\n    return 0;\n}\n</code></pre>\n\n<p>Compilation:</p>\n\n<pre><code>$ gcc -O3 -g -std=c11 -Wall -Wextra -Wmissing-prototypes -Wstrict-prototypes \\\n&gt;     -Werror queue.c -o queue\n$\n</code></pre>\n\n<p>That's GCC 5.1.0 on Mac OS X 10.10.4, with options set fussy and no warnings.  The 'prototypes' options ensure that functions are declared before they're defined or used \u2014 or are <code>static</code> functions.  I didn't make anything <code>static</code> here; I usually do when there's only a single source file.</p>\n\n<p>Sample output:</p>\n\n<pre><code>Testing push in queue.c\n!!!!!!!!!!!!! 10.000000\n10.000000 -&gt; \n!!!!!!!!!!!!! 10.000000\nGET DATA: 10.000000\n</code></pre>\n\n<p>There is room to suppose that the problem was either in an absence of one or more function prototypes or a bug in one of the functions omitted.  Note that I fixed the code in <code>get_data()</code> so it does not crash if the <code>current</code> pointer is NULL \u2014 your code tried to print the value in <code>current-&gt;data</code> regardless of whether <code>current</code> was null or not (even though it then checked the value <code>current</code> \u2014 just a little too late).</p>\n"}], "owner": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 31956384, "answer_count": 1, "score": 2, "last_activity_date": 1439356145, "creation_date": 1439350853, "last_edit_date": 1439356145, "question_id": 31955624, "link": "https://stackoverflow.com/questions/31955624/function-seems-to-return-the-correct-value-but-the-outside-caller-never-gets-it", "title": "Function seems to return the correct value, but the outside caller never gets it in C", "body": "<p>I implemented a queue using a linked list. I also created a getter that reads the data of any entry in this queue. When I call this function from a tester, I find that the value that is being returned as the value of the entry inside the queue is not the same as the one being read within the getter. </p>\n\n<pre><code>struct entry{\n    double data;\n    attribute_value time_stamp;\n    struct entry* next;\n};\n\n\ntypedef struct queue_struct{\n    struct entry* front;\n    struct entry* end;\n    int size;\n} queue;\n</code></pre>\n\n<p>The getter below takes in an entry of the queue and returns the value for the data structure variable, if the current entry is not null:</p>\n\n<pre><code>double get_data(struct entry *current){\n    // The value is correct here\n    printf(\"!!!!!!!!!!!!! %lf\\n\", current-&gt;data);\n    if(current) return current-&gt;data; \n    return 0;\n}\n</code></pre>\n\n<p>I use this helper to get the very first entry of the queue:</p>\n\n<pre><code>struct entry* get_front(queue *Q){\n    return Q-&gt;front;\n}\n</code></pre>\n\n<p>Here is the tester. It creates a queue (which simply allocates space for it and assigns first = NULL, end = NULL, and size = 0). Then it pushed value 10 to the queue. (Ignore the zero! It does not have anything to do with the data). Then, it prints the queue successfully by starting at its first element and printing the \"data\" variable until it hits a NULL element. Then, I ask it to print the data of the very first entry/element in the queue. This is where I get the wrong value.</p>\n\n<pre><code>void test_queue_push(bool enable_print){\n    printf(TESTING, \"Testing push in queue.c\");\n    queue* Q = construct_queue();\n\n    push(Q, 10, 0);\n    if(enable_print) print_queau(Q); // This prints the queue correctly!\n\n    // The wrong value is printed here!\n    printf(\"GET DATA: %lf\\n\", get_data(get_front(Q))); \n}\n</code></pre>\n\n<p>This tested prints out the following:</p>\n\n<pre><code>10.000000 -&gt;                        // This is result of print_queue\n!!!!!!!!!!!!! 10.000000             // This is data of first entry printed INSIDE the getter function itself\nGET DATA: 0.000000                  // This is the returned data of first entry, printed inside the tester\n</code></pre>\n\n<p>I do not understand why I do not get the value \"10.0000\" for both - the second and third line.</p>\n\n<blockquote>\n  <p>I just tried using \"long long int\" instead of \"double\" for the entry's data variable and all of the other functions. The error disappears if I use a different data type. No idea why.</p>\n</blockquote>\n\n<p>Print queue also uses get_data function, and the first line of the print out reflects that get_data inside print_queue works just fine. Here is the function:</p>\n\n<pre><code>void print_queau(queue* Q) {\n    struct entry* temp = get_front(Q);\n    while(temp != NULL) {\n        printf(\"%lf -&gt; \", get_data(temp));\n        temp = get_next(temp);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Just in case, this is what the push function looks like:</p>\n\n<pre><code>void push(queue* Q, double input, attribute_value time_stamp){\n    if(Q){ //if Queue exists\n    struct entry* in;   //create a new entry object\n        if(in = calloc(1, sizeof(struct entry))){ //if allocating space for the entry object succeeds\n            Q-&gt;size = Q-&gt;size + 1;\n            in-&gt;data = input; //enter the input as its current data\n            in-&gt;next = NULL; //set next to null because the end of the queue can have no next entry that follows it\n            in-&gt;time_stamp = time_stamp; //set the time stamp to the Power On Hours on the system\n\n            if(get_front(Q) == NULL &amp;&amp; get_end(Q) == NULL){  //if front and end of the queue have not yet been set\n                set_front(Q, in); //then this entry is both the front\n                set_end(Q, in); //and the end\n                return;\n            }\n            set_next(get_end(Q), in); //next value of the entry at the end is now our new entry\n            set_end(Q, in);\n            //printf(\"The End is: %i\\n\", Q-&gt;size);\n        }\n    }\n}\n</code></pre>\n\n<p>Construct queue looks like this:</p>\n\n<pre><code>/*Constructor for the Queue structure instance\n    @param none\n    @return pointer to queue or NULL pointer in case of memory allocaion failure\n*/\nqueue* construct_queue(){\n    queue* Q;\n    if(Q = calloc(1, sizeof(queue))){ \n        Q-&gt;front = NULL;  //at first the queue does not have any entries\n        Q-&gt;end = NULL;    //therefore it has no front and no end\n        Q-&gt;size = 0;      //its size starts off at zero to indicate that there are no entries.\n    }\n    if(Q == NULL){\n        fprintf(stderr, \"Ran out of memory when allocating memory for queue in construct_queue in queue.c\\n\");\n    }\n    return Q;\n}\n</code></pre>\n\n<p>I used the following code to build the code above: <a href=\"https://gist.github.com/mycodeschool/7510222\" rel=\"nofollow\">https://gist.github.com/mycodeschool/7510222</a></p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 3814, "user_id": 2776146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pIofO.jpg?s=128&g=1", "display_name": "TryinHard", "link": "https://stackoverflow.com/users/2776146/tryinhard"}, "edited": false, "score": 0, "creation_date": 1439352204, "post_id": 31955609, "comment_id": 51820415, "body": "Why you didn&#39;t use fscanf()?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1439352821, "post_id": 31955609, "comment_id": 51820591, "body": "Show declaration of <code>salesNum,lastName,firstName,salesLevel,salesAmount</code>  for a good complete answer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3814, "user_id": 2776146, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pIofO.jpg?s=128&g=1", "display_name": "TryinHard", "link": "https://stackoverflow.com/users/2776146/tryinhard"}, "edited": false, "score": 1, "creation_date": 1439353347, "post_id": 31955609, "comment_id": 51820729, "body": "@TryinHard Using <code>fgets()</code> is much better at coping with error handing and presenting maintainable code than <code>fscanf()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 25, "user_id": 4312502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-09UrW5ZANKs/AAAAAAAAAAI/AAAAAAAAAGw/XenSRN07KoU/photo.jpg?sz=128", "display_name": "Dragon Wish", "link": "https://stackoverflow.com/users/4312502/dragon-wish"}, "edited": false, "score": 0, "creation_date": 1439354215, "post_id": 31955964, "comment_id": 51820942, "body": "<code>sscanf()</code> returns the number of successfully scanned fields (variables).  In this code, if it does not return <code>5</code>, something is wrong.  Various <code>sscanf()</code> details are web-available."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1439354362, "post_id": 31955964, "comment_id": 51820988, "body": "This is the POSIX specification for <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sscanf.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1439353904, "last_edit_date": 1439353904, "creation_date": 1439353191, "answer_id": 31955964, "question_id": 31955609, "link": "https://stackoverflow.com/questions/31955609/sscanf-to-scan-a-line-with-columns/31955964#31955964", "title": "Sscanf to scan a line with columns", "body": "<p><code>\"%d:%[^:]:%[^:]:%d[^:]:%lf\"</code> is wrong (a typo).  Format likely should be<br>\n<code>\"%d:%[^:]:%[^:]:%d:%lf\"</code>.</p>\n\n<p>For the future: if code checked the return value of <code>sscanf()</code>, which was certainly <code>4</code>, OP would likely have discovered this.</p>\n\n<hr>\n\n<p>Untested candidate improvement:</p>\n\n<pre><code>int salesNum;\nchar lastName[100];\nchar firstName[50];\nint salesLevel;\ndouble salesAmount;\n\nchar oneline[200];\nwhile(fgets(oneline, sizeof oneline, fPointer) != NULL) {\n  char sentinel;\n  if (5 != sscanf(oneline,\"%d : %99[^:]: %49[^:]:%d :%lf %c\",\n      &amp;salesNum, lastName, firstName, &amp;salesLevel, &amp;salesAmount, &amp;sentinel)) break;\n  printf(\"%d , '%s' , '%s' , %d , %lf\\n\",  \n      salesNum, lastName, firstName, salesLevel, salesAmount);\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4312502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-09UrW5ZANKs/AAAAAAAAAAI/AAAAAAAAAGw/XenSRN07KoU/photo.jpg?sz=128", "display_name": "Dragon Wish", "link": "https://stackoverflow.com/users/4312502/dragon-wish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 31955964, "answer_count": 1, "score": 2, "last_activity_date": 1439354299, "creation_date": 1439350757, "last_edit_date": 1439354299, "question_id": 31955609, "link": "https://stackoverflow.com/questions/31955609/sscanf-to-scan-a-line-with-columns", "title": "Sscanf to scan a line with columns", "body": "<p>I am trying to read a file line by line and transfer it to another file.\nThis is the format for the first file-</p>\n\n<pre><code>1001:Brendes:Howard:0:750.92 \n</code></pre>\n\n<p>So I got thru most of the line but the decimal at the end is giving me trouble.\nHere is what I have until now. I declared <code>salesAmount</code> as <code>double</code> and tried it with <code>%f</code>, <code>%lf</code>, <code>%d</code>, <code>%lf[^n]</code>, <code>%lf[^\\0]</code> but nothing works. </p>\n\n<pre><code>while(fgets(oneline, 200 ,fPointer)!= NULL){\n    sscanf(oneline,\"%d:%[^:]:%[^:]:%d[^:]:%lf\", &amp;salesNum, lastName, firstName, &amp;salesLevel, &amp;salesAmount);\n    printf(\"%d , %s , %s , %d , %lf \\n\", salesNum, lastName, firstName, salesLevel, salesAmount);\n}\n</code></pre>\n\n<p>This is the normal Output:</p>\n\n<pre><code>1001 , Brendes , Howard , 0 , -0.380207\n\n1002 , Jervis , Michael , 0 , -0.380207\n\n1003 , Chen , Jessica , 1 , -0.380207\n\n1004 , Ding , Sheng , 1 , -0.380207\n</code></pre>\n\n<p>So what do I have to do to make my code read the last decimal properly?</p>\n"}, {"tags": ["c++", "c", "algorithm", "language-agnostic", "cpu-cache"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1439350788, "post_id": 31955567, "comment_id": 51820091, "body": "I&#39;m flagging this as C/C++ as I&#39;ll be rewriting the implementation in one of those, and that&#39;s probably where people with expertise on the matter are. But this question in general is language agnostic, so I&#39;m not sure what tags I should keep."}], "answers": [{"comments": [{"owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "edited": false, "score": 2, "creation_date": 1439402413, "post_id": 31965232, "comment_id": 51851539, "body": "There are many other ways to implement a graph in a more spatially-local way, look at CSR for example (compressed sparse row format)"}], "tags": [], "owner": {"reputation": 792, "user_id": 2508468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/767532940df8fe6804390e133118badc?s=128&d=identicon&r=PG", "display_name": "vdolez", "link": "https://stackoverflow.com/users/2508468/vdolez"}, "is_accepted": false, "score": -1, "last_activity_date": 1439382445, "creation_date": 1439382445, "answer_id": 31965232, "question_id": 31955567, "link": "https://stackoverflow.com/questions/31955567/how-to-store-graphs-in-order-to-maximize-locality-for-graph-reduction-algorithms/31965232#31965232", "title": "How to store graphs in order to maximize locality for graph-reduction algorithms?", "body": "<p>I only know of two ways to \"store\" a graph. By \"storing\" I mean implementing.</p>\n\n<p>Either the edges are stored in a linked-list for each node, with all the benefits from it : adding and removing an edge is fast, but finding one is long. </p>\n\n<p>Either the edges are stored in a matrix of nodes and the value of Array[node1][node2] is the weight of the edge. Adding and removing a node is long, but finding a node or an edge is fast.</p>\n\n<p>With the linked-list method, you store only what exists, with the matrix method, you store every edge even if it does not exist, you have to provide a value for it.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1439382445, "creation_date": 1439350381, "question_id": 31955567, "link": "https://stackoverflow.com/questions/31955567/how-to-store-graphs-in-order-to-maximize-locality-for-graph-reduction-algorithms", "title": "How to store graphs in order to maximize locality for graph-reduction algorithms?", "body": "<p>I'm implementing an algorithm based on graph-reduction rules. <a href=\"https://www.youtube.com/watch?v=lhNtgbFTXFE&amp;feature=youtu.be\" rel=\"nofollow\">This video</a> explains the algorithm better than words could, but, for completion's sake, here's a quick summary: </p>\n\n<blockquote>\n  <p>The algorithm operates in a graph where every node has 3 edges, one of which is the \"main\" one. When main edges intersect, a node is said to be active and a reduction rule is applied. It is also worth noting that, when two nodes interact, it is very likely that another node very close to them will become active. </p>\n</blockquote>\n\n<p>I'm currently storing this graph with no sense of locality whatsoever: I just append new nodes to a buffer. This is the code for the naive allocation strategy I'm using, prototyped in JavaScript:</p>\n\n<pre><code>function Node(type,tag){\n    var idx = garbage.pop() || memory.length;\n    memory[idx+0] = type;      // Node type (used on readback)\n    memory[idx+1] = 0;         // Port 0 target port\n    memory[idx+2] = 0;         // Port 1 target port\n    memory[idx+3] = 0;         // Port 2 target port\n    memory[idx+4] = 0;         // Port 0 target node\n    memory[idx+5] = 0;         // Port 1 target node\n    memory[idx+6] = 0;         // Port 2 target node\n    memory[idx+7] = ++next_id; // Unique id\n    memory[idx+8] = tag;       // Tag (used to decide which reduction rule apply)\n    return idx;\n};\n</code></pre>\n\n<p>What is a superior way to organize this graph in memory in order to maximize locality and cache-efficiency for that kind of graph algorithm?</p>\n"}, {"tags": ["c++", "c", "sockets", "udp"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 3, "creation_date": 1439350818, "post_id": 31955514, "comment_id": 51820099, "body": "Binding is not connecting, and printing &#39;connection error&#39; on a bind error is just misleading yourself. You can use sendto() instead of connecting the socket."}, {"owner": {"reputation": 2530, "user_id": 395131, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KWhe2.png?s=128&g=1", "display_name": "Tahlil", "link": "https://stackoverflow.com/users/395131/tahlil"}, "edited": false, "score": 2, "creation_date": 1439350885, "post_id": 31955514, "comment_id": 51820110, "body": "I thought connect API is used for TCP socket. What purpose does it serve here?"}, {"owner": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "edited": false, "score": 2, "creation_date": 1439351140, "post_id": 31955514, "comment_id": 51820178, "body": "For UDP socket program you no need to use connect.it is not an proper UDP code.have a look on simple echo server.it will help you."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "edited": false, "score": 0, "creation_date": 1439439705, "post_id": 31955514, "comment_id": 51864560, "body": "@NaveenKumar It isn&#39;t necessary but it&#39;s possible, and doing so is not improper coding."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1439439748, "post_id": 31955514, "comment_id": 51864574, "body": "@Tahil Look it up, or ask your own question."}, {"owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "edited": false, "score": 1, "creation_date": 1521825677, "post_id": 31955514, "comment_id": 85913275, "body": "this looks more like a <b>TCP</b> socket hiding behind <b>SOCK_DGRAM</b>"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 8588200, "user_type": "registered", "profile_image": "https://graph.facebook.com/1638606706173057/picture?type=large", "display_name": "slangley", "link": "https://stackoverflow.com/users/8588200/slangley"}, "is_accepted": false, "score": 2, "last_activity_date": 1526945815, "creation_date": 1526945815, "answer_id": 50457856, "question_id": 31955514, "link": "https://stackoverflow.com/questions/31955514/simple-udp-socket-code-sending-and-receiving-messages/50457856#50457856", "title": "Simple UDP socket code, sending and receiving messages", "body": "<p>If you use the function recvfrom()</p>\n\n<pre><code>    ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags,\n             struct sockaddr *src_addr, socklen_t *addrlen);\n</code></pre>\n\n<p>What this function does is it fills a structure of sockaddr with the IP and port information of the packet that it has just received. For example, if your code that sends first then receives sends a packet to the receiver, the receiver should be able to fill the structure values of sin_addr and sin_port with the correct values. You can then make a call of sendto() with this information in order to send it to the correct machine.</p>\n\n<p>Here's the man pages for these functions: </p>\n\n<p><a href=\"https://linux.die.net/man/2/recvfrom\" rel=\"nofollow noreferrer\">https://linux.die.net/man/2/recvfrom</a></p>\n\n<p><a href=\"https://linux.die.net/man/2/sendto\" rel=\"nofollow noreferrer\">https://linux.die.net/man/2/sendto</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9822627, "user_type": "registered", "profile_image": "https://graph.facebook.com/1806809216029253/picture?type=large", "display_name": "Aditya Kothari", "link": "https://stackoverflow.com/users/9822627/aditya-kothari"}, "is_accepted": false, "score": 1, "last_activity_date": 1527250052, "last_edit_date": 1527250052, "creation_date": 1527249639, "answer_id": 50528756, "question_id": 31955514, "link": "https://stackoverflow.com/questions/31955514/simple-udp-socket-code-sending-and-receiving-messages/50528756#50528756", "title": "Simple UDP socket code, sending and receiving messages", "body": "<p>Try using this:</p>\n\n<pre><code>inet_pton(AF_INET, \"127.0.0.1\", &amp;serv_addr.sin_addr)\n</code></pre>\n\n<p>127.0.0.1 is the loopback IP. The address is used to establish an IP connection to the same machine, which seems to be your case.</p>\n\n<p>A detailed way to solve the problem can be found <a href=\"https://www.geeksforgeeks.org/socket-programming-cc/\" rel=\"nofollow noreferrer\" title=\"Hello message b/w server &amp; client\">here</a></p>\n"}], "owner": {"reputation": 101, "user_id": 5213298, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a633b4a467982e6b6327d7120d010fed?s=128&d=identicon&r=PG&f=1", "display_name": "forever_fighting_21", "link": "https://stackoverflow.com/users/5213298/forever-fighting-21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29193, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1527250052, "creation_date": 1439350006, "question_id": 31955514, "link": "https://stackoverflow.com/questions/31955514/simple-udp-socket-code-sending-and-receiving-messages", "title": "Simple UDP socket code, sending and receiving messages", "body": "<p>I am just learning UDP sockets and this is my first code involving it. I have two programs which send and receive messages back and forth. My question is it seems I have to declare which IP address I am sending/receiving from multiple times throughout the code as it changes but I feel there is a better way to do this without changing the inet_addr manually within the codes. From my reading it looks like sendto and recvfrom may be able to help but I am unsure how to use them in this context. If anyone could show me how to fix my simple problem I would greatly appreciate it! Thanks</p>\n\n<p>CODE 1: Send then Receive</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n//initialize socket and structure\nint socket_info;\nstruct sockaddr_in server;\nchar message[100];\nchar incoming_message[100];\n\nprintf(\"Input Message: \");\nfgets(message, 100, stdin);\n\n    //create socket\n    socket_info = socket(AF_INET, SOCK_DGRAM, 0);\n    if (socket_info == -1) {\n    printf(\"Could not create socket\");\n    }\n\n//assign local values\n    server.sin_addr.s_addr = inet_addr(\"172.21.8.178\");\n    server.sin_family = AF_INET;\n    server.sin_port = htons( 1100 );\n\n    //binds connection\n    if (bind(socket_info, (struct sockaddr *)&amp;server, sizeof(server)) &lt; 0) {    \nperror(\"Connection error\");\n       return 1;\n    }\n    puts(\"Bind\");\n\n    //assign new value to connect to\n    server.sin_addr.s_addr = inet_addr(\"172.21.8.179\");\n\n    //checks connection \n    if (connect(socket_info, (struct sockaddr *)&amp;server, sizeof(server)) &lt;       0) {\n    perror(\"Connection error\");\n       return 1;\n    }\n    puts(\"Connected\");\n\n    //sends message\nif(send(socket_info, message, strlen(message), 0) &lt;0) {        \nperror(\"Send failed\");\n    return 1;\n    }\n    puts(\"Message Sent\");\n\n//receives message back    \nif(recv(socket_info, incoming_message, sizeof(incoming_message), 0) &lt;0) {    \nputs(\"Received failed\");\n    return 1;\n    }\n    puts(\"Message received\");\n    puts(incoming_message);\n\nclose(socket_info);\n\n}\n</code></pre>\n\n<p>CODE 2: Receive then Send</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n//initialize socket and structure\nint socket_info;\nstruct sockaddr_in server;\nchar incoming_message[100];\n\n    //create socket\n    socket_info = socket(AF_INET, SOCK_DGRAM, 0);\n    if (socket_info == -1) {\n    printf(\"Could not create socket\");\n    }\n\n    //assign values\n    server.sin_addr.s_addr = inet_addr(\"172.21.8.179\");\n    server.sin_family = AF_INET;\n    server.sin_port = htons( 1100 );\n\n    //checks connection\n    if (bind(socket_info, (struct sockaddr *)&amp;server, sizeof(server)) &lt; 0) {\n    perror(\"Connection error\");\n       return 1;\n    }\n    puts(\"Bind\");\n\n    //Receive an incoming message\nif( recv(socket_info, incoming_message, sizeof(incoming_message), 0) &lt; 0) {      \nputs(\"Received failed\");\n    return 1;\n    }\n    puts(\"Message received\");\n    puts(incoming_message);\n\nserver.sin_addr.s_addr = inet_addr(\"172.21.8.178\");\n\nif (connect(socket_info, (struct sockaddr *)&amp;server, sizeof(server)) &lt; 0) {\n    perror(\"Connection error\");\n     return 1;\n    }\n    puts(\"Connected\");\n\n//Sends message back\nchar message[100];\n\nprintf(\"Input Message: \");\nfgets(message, 100, stdin);\n\nif(send(socket_info, message, strlen(message), 0) &lt;0) {        \nperror(\"Send failed\");\n    return 1;\n    }\n    puts(\"Message Sent\");\n\nclose(socket_info);\n}\n</code></pre>\n"}, {"tags": ["c", "math", "division"], "comments": [{"owner": {"reputation": 647, "user_id": 3138501, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/cjFNH.jpg?s=128&g=1", "display_name": "Bender", "link": "https://stackoverflow.com/users/3138501/bender"}, "edited": false, "score": 0, "creation_date": 1439350119, "post_id": 31955491, "comment_id": 51819949, "body": "<a href=\"http://stackoverflow.com/questions/1351925/why-does-2-mod-4-2\">stackoverflow.com/questions/1351925/why-does-2-mod-4-2</a> <a href=\"http://math.stackexchange.com/questions/194629/how-is-3-modulo-5-3\" title=\"how is 3 modulo 5 3\">math.stackexchange.com/questions/194629/how-is-3-modulo-5-3</a> <a href=\"http://www.cplusplus.com/forum/general/17383/\" rel=\"nofollow noreferrer\">cplusplus.com/forum/general/17383</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 4, "creation_date": 1439350938, "post_id": 31955491, "comment_id": 51820125, "body": "Er... Any how exactly do you plan to pass your argument to that <code>main</code> function of yours? How does that <code>5</code> get there? How do you set that <code>x</code> to <code>5</code>?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1439351238, "post_id": 31955491, "comment_id": 51820202, "body": "I&#39;m somewhat surprised at the answers that claim to simply perform <code>x%2 == 0</code> exclusively as the test. That will <i>not</i> do what that question asks for. The melon must be (a) an even number of kilos, <i>and</i> (b) weight <i>more</i> than 2 kilos outright. Any even number greater than 2 can be split into two even numbers (and often in multiple partition configurations)."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1439353094, "post_id": 31955491, "comment_id": 51820674, "body": "<code>(x&#47;2) % 2</code> is equivalent to <code>x &amp; 0x2</code>. You want divisibility by 4, use <code>x % 4</code> instead"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1439356455, "post_id": 31955491, "comment_id": 51821617, "body": "@L\u01b0uV\u0129nhPh&#250;c divisibility by four won&#39;t cut it either. 10 is a valid weight for the problem. It can be split into two pieces, 6 and 4, both of which are even numbers. Nothing in the problem says the split must be the <i>same</i> number for <i>both</i> pieces. It would probably have been handy had the OP <a href=\"http://codeforces.com/problemset/problem/4/A\" rel=\"nofollow noreferrer\">linked the original question</a> in the post. Or are you saying it should be <code>(x&#47;4) % 2</code> ?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1439356563, "post_id": 31955491, "comment_id": 51821670, "body": "@WhozCraig as I read &quot;split the watermelon in two halves&quot; I thought that it&#39;s cut into 2 equal halves"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1439356613, "post_id": 31955491, "comment_id": 51821690, "body": "@L\u01b0uV\u0129nhPh&#250;c I would have thought so as well, but I&#39;ve seen the problem before, and the phrasing in the question was somewhat weak. The answer, however, is as I described. Any even number larger than 2 will suffice as a valid source weight."}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1439353649, "post_id": 31955510, "comment_id": 51820790, "body": "he wants divisibility by 4, not 2, as after dividing by 2 it&#39;s still an even number"}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 0, "last_activity_date": 1439350311, "last_edit_date": 1439350311, "creation_date": 1439349980, "answer_id": 31955510, "question_id": 31955491, "link": "https://stackoverflow.com/questions/31955491/trouble-with-mod-c/31955510#31955510", "title": "Trouble with mod C", "body": "<pre><code>if((x/2) % 2 == 0)\n</code></pre>\n\n<p>This condition is why you get <code>yes</code> for <code>5</code> as <code>5/2</code> is <code>2</code>(as it is int) and <code>2%2</code> is <code>0</code>.</p>\n\n<p>just this will work -</p>\n\n<pre><code>if(x%2==0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 180, "user_id": 1065928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnMI.jpg?s=128&g=1", "display_name": "Marco Ram&#237;rez", "link": "https://stackoverflow.com/users/1065928/marco-ram%c3%adrez"}, "is_accepted": false, "score": 0, "last_activity_date": 1439350161, "creation_date": 1439350161, "answer_id": 31955530, "question_id": 31955491, "link": "https://stackoverflow.com/questions/31955491/trouble-with-mod-c/31955530#31955530", "title": "Trouble with mod C", "body": "<p>Since the argument is an int then the division the remainder will be left. That is: 5 / 2 will result in a 2. Then that 2 mod 2 will give you a zero. What you should dp is to just put x % 2 inside the 'if' statement. So, with that 5 % 2 will give you a '1' which is thenn different to zero</p>\n"}, {"tags": [], "owner": {"reputation": 1330, "user_id": 5077395, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a928f65219971856056abc53e9d615f0?s=128&d=identicon&r=PG&f=1", "display_name": "pri", "link": "https://stackoverflow.com/users/5077395/pri"}, "is_accepted": false, "score": 0, "last_activity_date": 1439354729, "creation_date": 1439354729, "answer_id": 31956225, "question_id": 31955491, "link": "https://stackoverflow.com/questions/31955491/trouble-with-mod-c/31956225#31956225", "title": "Trouble with mod C", "body": "<p>Since you are performing operation with integers, <code>(5/2)=2</code>, Hence you are getting \"YES\" as the output.<br>Try this code<br><pre><code>int main (int x) {\n    if(x % 4 == 0) {\n        printf(\"YES\");\n    }else {\n        printf(\"NO\");\n    }\n    return 0;\n}</code></pre><br><br> If the condition is true, it will mean that the halves are even as well.</p>\n"}, {"comments": [{"owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "edited": false, "score": 0, "creation_date": 1439365997, "post_id": 31956455, "comment_id": 51826252, "body": "Try changing <code>printf(&quot;YES&quot;);</code> to <code>printf(&quot;YES %d&quot;, x);</code>"}], "tags": [], "owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "is_accepted": false, "score": 2, "last_activity_date": 1439358035, "last_edit_date": 1439358035, "creation_date": 1439355985, "answer_id": 31956455, "question_id": 31955491, "link": "https://stackoverflow.com/questions/31955491/trouble-with-mod-c/31956455#31956455", "title": "Trouble with mod C", "body": "<p>The problem has nothing to do with <code>mod</code>, but with parameter passing.</p>\n\n<p>The typical prototype for main is</p>\n\n<pre><code>int main(int argument_count, char *arg_list[], ...);\n</code></pre>\n\n<p>Calling <code>my_exe 5</code> will set the first parameter <code>x</code> (argument_count) as 2, and the next <em>unused</em> parameter </p>\n\n<pre><code>arg_list[0] = \"my_exe\",  // the first (0th) argument is the executable name\narg_list[1] = \"5\"        // rest of parameters as arrays of chars\n</code></pre>\n\n<p>Calling <code>my_exe</code> without parameters sets <code>x = 1</code> giving <code>YES</code></p>\n\n<p>Also if the argument <code>x</code> is a character <code>'5'</code> with the decimal value of 53 (0x35), the result is <code>YES</code>. This would be rather unconventional behavior, but definitely possible within some undisclosed IDE or coding framework.</p>\n"}], "owner": {"reputation": 25, "user_id": 5026357, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2Q_laP9JQqE/AAAAAAAAAAI/AAAAAAAABDo/YcCZ-XH8rio/photo.jpg?sz=128", "display_name": "Alki Kollias", "link": "https://stackoverflow.com/users/5026357/alki-kollias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "closed_date": 1439366461, "answer_count": 4, "score": 0, "last_activity_date": 1439358035, "creation_date": 1439349816, "last_edit_date": 1439353472, "question_id": 31955491, "link": "https://stackoverflow.com/questions/31955491/trouble-with-mod-c", "closed_reason": "Not suitable for this site", "title": "Trouble with mod C", "body": "<p>I just started doing codeforces problems, I started with problem 4-A (Watermelon), in which given an int x number of kilos the program will print \"YES\" if when you split the watermelon in two halves, each one has an even number of kilos, if not \"NO\".\nMy problem here is that I get \"YES\" when the input is 5, and it should be \"NO\"\nHere is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main (int x) {\n    if((x/2) % 2 == 0) {\n        printf(\"YES\");\n    }else {\n        printf(\"NO\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "memory-leaks", "lua", "valgrind"], "comments": [{"owner": {"reputation": 718, "user_id": 1453919, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3ee95c17de7ae891ca688f8ec6ec9764?s=128&d=identicon&r=PG", "display_name": "bnsh", "link": "https://stackoverflow.com/users/1453919/bnsh"}, "edited": false, "score": 0, "creation_date": 1439350110, "post_id": 31955462, "comment_id": 51819947, "body": "I tried changing the lua_open() to luaL_newstate(), but I still get the same problem with valgrind.."}, {"owner": {"reputation": 1298, "user_id": 143279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I0Npe.jpg?s=128&g=1", "display_name": "bleakgadfly", "link": "https://stackoverflow.com/users/143279/bleakgadfly"}, "edited": false, "score": 0, "creation_date": 1439363743, "post_id": 31955462, "comment_id": 51824953, "body": "Does this fix your problem? <a href=\"http://stackoverflow.com/questions/14840569/sigsegv-error-in-some-lua-c-code\" title=\"sigsegv error in some lua c code\">stackoverflow.com/questions/14840569/&hellip;</a>"}, {"owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "edited": false, "score": 1, "creation_date": 1439377866, "post_id": 31955462, "comment_id": 51834250, "body": "LuaJIT needs to be compiled with Valgrind support. Search the LuaJIT Makefile (in the <code>src</code> sub-directory) for <code>LUAJIT_USE_VALGRIND</code>."}, {"owner": {"reputation": 718, "user_id": 1453919, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3ee95c17de7ae891ca688f8ec6ec9764?s=128&d=identicon&r=PG", "display_name": "bnsh", "link": "https://stackoverflow.com/users/1453919/bnsh"}, "edited": false, "score": 0, "creation_date": 1439381294, "post_id": 31955462, "comment_id": 51836528, "body": "Interesting. The Makefile has... seemingly contradictory information about whether or not I can use it on x64:  # Use the system provided memory allocator (realloc) instead of the # bundled memory allocator. This is slower, but sometimes helpful for # debugging. This option cannot be enabled on x64, since realloc usually # doesn&#39;t return addresses in the right address range. # OTOH this option is mandatory for Valgrind&#39;s memcheck tool on x64 and # the only way to get useful results from it for all other architectures. #XCFLAGS+= -DLUAJIT_USE_SYSMALLOC  (Just before the -DLUAJIT_USE_VALGRIND)"}, {"owner": {"reputation": 718, "user_id": 1453919, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3ee95c17de7ae891ca688f8ec6ec9764?s=128&d=identicon&r=PG", "display_name": "bnsh", "link": "https://stackoverflow.com/users/1453919/bnsh"}, "edited": false, "score": 0, "creation_date": 1439382099, "post_id": 31955462, "comment_id": 51837107, "body": "Although... Even when I add that, and make clean, etc, and recompile, I <i>still</i> get the SIGSEGV... But, given that it seems clear that LuaJIT must be doing some black magic to accomplish what it does, I&#39;m willing to live with it. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 2173, "user_id": 4172685, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc5e77bda4a42c3470b58ce69c9a84a?s=128&d=identicon&r=PG&f=1", "display_name": "Conchylicultor", "link": "https://stackoverflow.com/users/4172685/conchylicultor"}, "edited": false, "score": 0, "creation_date": 1475214211, "post_id": 32076010, "comment_id": 66862638, "body": "The problem seems corrected for the version 3.11.0."}], "tags": [], "owner": {"reputation": 1298, "user_id": 143279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I0Npe.jpg?s=128&g=1", "display_name": "bleakgadfly", "link": "https://stackoverflow.com/users/143279/bleakgadfly"}, "is_accepted": true, "score": 2, "last_activity_date": 1439910099, "creation_date": 1439910099, "answer_id": 32076010, "question_id": 31955462, "link": "https://stackoverflow.com/questions/31955462/lua-c-api-memory-leak-valgrind/32076010#32076010", "title": "Lua C API Memory Leak? (valgrind)", "body": "<p>The reason for this issue seems to be Valgrind, not LuaJIT. Valgrind is <a href=\"http://permalink.gmane.org/gmane.comp.lang.lua.luajit/4826\" rel=\"nofollow\">blocking MAP_32BIT which breaks LuaJIT</a>. To demonstrate, add a check for <code>NULL</code> on <code>lua_State * L</code> and you'll see it is NULL while run under Valgrind, and non-<code>NULL</code> while running regularly.</p>\n\n<p>Here is the modifications I did to your sample:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(L == NULL) {\n    printf(\"Could not create luaL_newstate()\\n\");\n} else {\n    luaL_openlibs(L);\n    lua_close(L);\n    printf(\"I can create luaL_newstate fine!\\n\");\n}\n</code></pre>\n\n<p>When I run this normally:</p>\n\n<pre><code>$ ./pure_lua_test \nI can create luaL_newstate fine!\n</code></pre>\n\n<p>But when I run it under Valgrind:</p>\n\n<pre><code>$ valgrind ./pure_lua_test\n==8211== Memcheck, a memory error detector\n==8211== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==8211== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==8211== Command: ./pure_lua_test\n==8211== \nCould not create luaL_newstate()\n==8211== \n</code></pre>\n\n<p>GDB also report that the application exited as it should:</p>\n\n<pre><code>(gdb) run\nStarting program: /tmp/pure_lua_test \nI can create luaL_newstate fine!\n[Inferior 1 (process 8621) exited normally]\n</code></pre>\n\n<p>Here is a complete MCVE:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\nextern \"C\" {\n        #include &lt;lua.h&gt;\n        #include &lt;lauxlib.h&gt;\n        #include &lt;lualib.h&gt;\n}\n\nint main(int argc, char *argv[]) {\n    lua_State *L;\n    L = luaL_newstate();\n\n    if(L == NULL) {\n        printf(\"Could not create luaL_newstate()\\n\");\n    } else {\n        luaL_openlibs(L);\n\n        lua_close(L);\n        printf(\"I can create luaL_newstate fine!\\n\");\n    }\n\n    return(0);\n}\n</code></pre>\n\n<p><a href=\"https://lwn.net/Articles/294642/\" rel=\"nofollow\">Here</a> is a nice article on MAP_32BIT. Hope this helps in any way.</p>\n"}], "owner": {"reputation": 718, "user_id": 1453919, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3ee95c17de7ae891ca688f8ec6ec9764?s=128&d=identicon&r=PG", "display_name": "bnsh", "link": "https://stackoverflow.com/users/1453919/bnsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1301, "favorite_count": 1, "accepted_answer_id": 32076010, "answer_count": 1, "score": 6, "last_activity_date": 1439910099, "creation_date": 1439349538, "last_edit_date": 1439382129, "question_id": 31955462, "link": "https://stackoverflow.com/questions/31955462/lua-c-api-memory-leak-valgrind", "title": "Lua C API Memory Leak? (valgrind)", "body": "<p>I'm trying to write a C program with Lua embedded inside.. And, I tried a very simple program to start, it just creates the Lua context, and then destroys it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\nextern \"C\" {\n    #include &lt;lua.h&gt;\n    #include &lt;lauxlib.h&gt;\n    #include &lt;lualib.h&gt;\n}\n\nint main(int argc, char *argv[]) {\n    lua_State *L = lua_open();\n    luaL_openlibs(L);\n\n    lua_close(L);\n    fprintf(stderr, \"%s: %d\\n\", __FILE__, __LINE__);\n    return(0);\n}\n</code></pre>\n\n<p>I'm compiling it like so: (I'm actually using Torch7, so..)</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>g++ -c -g3 -O2 -Wall -Werror -I/usr/local/torch/install/include/ -fPIC pure_lua_test.C -o pure_lua_test.o\ng++ -g3 -O2 -Wall -Werror -I/usr/local/torch/install/include/ -fPIC -o pure_lua_test pure_lua_test.o -L/usr/local/torch/install/lib/ -lluajit\n</code></pre>\n\n<p>When I run it on it's own, it prints</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>pure_lua_test.C: 16\n</code></pre>\n\n<p>as expected, (just before the return).</p>\n\n<p>But, when I run it with valgrind, (as valgrind ./pure_lua_test )</p>\n\n<p>I get</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>==9165== Memcheck, a memory error detector\n==9165== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==9165== Using Valgrind-3.10.0.SVN and LibVEX; rerun with -h for copyright info\n==9165== Command: ./pure_lua_test\n==9165== \n==9165== Invalid read of size 4\n==9165==    at 0x4E9EE97: lua_pushcclosure (in /usr/local/src/torch-2015-05-25/install/lib/libluajit.so)\n==9165==    by 0x4EB4CDD: luaL_openlibs (in /usr/local/src/torch-2015-05-25/install/lib/libluajit.so)\n==9165==    by 0x400700: main (pure_lua_test.C:13)\n==9165==  Address 0x8 is not stack'd, malloc'd or (recently) free'd\n==9165== \n==9165== \n==9165== Process terminating with default action of signal 11 (SIGSEGV)\n==9165==  Access not within mapped region at address 0x8\n==9165==    at 0x4E9EE97: lua_pushcclosure (in /usr/local/src/torch-2015-05-25/install/lib/libluajit.so)\n==9165==    by 0x4EB4CDD: luaL_openlibs (in /usr/local/src/torch-2015-05-25/install/lib/libluajit.so)\n==9165==    by 0x400700: main (pure_lua_test.C:13)\n==9165==  If you believe this happened as a result of a stack\n==9165==  overflow in your program's main thread (unlikely but\n==9165==  possible), you can try to increase the size of the\n==9165==  main thread stack using the --main-stacksize= flag.\n==9165==  The main thread stack size used in this run was 8388608.\n==9165== \n==9165== HEAP SUMMARY:\n==9165==     in use at exit: 0 bytes in 0 blocks\n==9165==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated\n==9165== \n==9165== All heap blocks were freed -- no leaks are possible\n==9165== \n==9165== For counts of detected and suppressed errors, rerun with: -v\n==9165== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Does anyone know what's happening? Why is it SIGSEGV'ing in valgrind? Is this something I should worry about? Basically, I was hoping to verify that a plugin I was writing for Torch had no memory leaks... But, if it fails with this, then, I'm kind of stuck.</p>\n"}, {"tags": ["c", "function", "return"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1439347780, "post_id": 31955132, "comment_id": 51819383, "body": "Although the parentheses are redundant in <code>return</code>, some argue that they make a difference in other places, <a href=\"http://stackoverflow.com/questions/30557710/do-parentheses-make-a-difference-when-determining-the-size-of-an-array\">see here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1439346985, "creation_date": 1439346985, "answer_id": 31955149, "question_id": 31955132, "link": "https://stackoverflow.com/questions/31955132/what-is-the-difference-between-return-1-and-return1/31955149#31955149", "title": "what is the difference between return 1 and return(1)?", "body": "<p>There is absolutely no difference: parentheses in this context do not mean a function call, they are regular parentheses for enforcing a particular evaluation order (which is completely unnecessary here).</p>\n\n<p>C allows programmers to place parentheses around any expressions, for whatever reason they wish, so compiler interprets both versions of the <code>return</code> in the same way, as long as parentheses are in balance:</p>\n\n<pre><code>return (((((1)))));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2163, "user_id": 3767017, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ff89e2f953faecd962b38cfd3c8391f8?s=128&d=identicon&r=PG&f=1", "display_name": "Anurag Bhakuni", "link": "https://stackoverflow.com/users/3767017/anurag-bhakuni"}, "edited": false, "score": 0, "creation_date": 1439359835, "post_id": 31955151, "comment_id": 51822964, "body": "so i would assume () is only preferrable when this is some computation take place ahead of return  for more readable of the code ."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 2163, "user_id": 3767017, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ff89e2f953faecd962b38cfd3c8391f8?s=128&d=identicon&r=PG&f=1", "display_name": "Anurag Bhakuni", "link": "https://stackoverflow.com/users/3767017/anurag-bhakuni"}, "edited": false, "score": 0, "creation_date": 1439360441, "post_id": 31955151, "comment_id": 51823260, "body": "@Lea-rner, yes, but you&#39;ll <i>never</i> need it outside the <i>entire</i> expression. In other words, while <code>return 3 * (7 + 12)</code> may be necessary for an expression where you want to override the order of evaluation, <code>return (3 * (7 + 12))</code> will never be."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1439347023, "creation_date": 1439347023, "answer_id": 31955151, "question_id": 31955132, "link": "https://stackoverflow.com/questions/31955132/what-is-the-difference-between-return-1-and-return1/31955151#31955151", "title": "what is the difference between return 1 and return(1)?", "body": "<p>There should be no functional or performance difference at all at run time, since you're either returning the expression <code>1</code> or the expression <code>(1)</code>, which is the same thing.</p>\n\n<p>It's no different to the following situation, where the statements should have identical run time cost:</p>\n\n<pre><code>int a = 42;\nint b = (42);\n</code></pre>\n\n<p>There's probably the <em>smallest</em> difference at compile time since the compiler has to evaluate more characters in the translation unit but I'd be <em>very</em> surprised if it was noticeable.</p>\n"}, {"tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1439347039, "creation_date": 1439347039, "answer_id": 31955154, "question_id": 31955132, "link": "https://stackoverflow.com/questions/31955132/what-is-the-difference-between-return-1-and-return1/31955154#31955154", "title": "what is the difference between return 1 and return(1)?", "body": "<p>They are equivalent. It's similar to:</p>\n\n<pre><code>1 + 2\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>(1) + (2)\n</code></pre>\n\n<p>The latter is legal, but the parenthesis is useless.</p>\n"}], "owner": {"reputation": 2163, "user_id": 3767017, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ff89e2f953faecd962b38cfd3c8391f8?s=128&d=identicon&r=PG&f=1", "display_name": "Anurag Bhakuni", "link": "https://stackoverflow.com/users/3767017/anurag-bhakuni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 31955151, "answer_count": 3, "score": 1, "last_activity_date": 1439347039, "creation_date": 1439346820, "question_id": 31955132, "link": "https://stackoverflow.com/questions/31955132/what-is-the-difference-between-return-1-and-return1", "title": "what is the difference between return 1 and return(1)?", "body": "<p>Is there any difference between the two? this take the program into two different point or what ,please provide all the detail of it. return is a statement, so why even used <code>return(1)</code>(looking like a function call), please give the detail of 'how it actually works'?. </p>\n"}, {"tags": ["c", "gcc", "output"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1439347940, "post_id": 31955038, "comment_id": 51819421, "body": "If you want to know what gcc did for this particular run, look at the assembly output (use <code>-S</code> switch). Bear in mind that this may change at any time, especially if you change compiler switches or use a different compiler or make a change anywhere else in the program."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1439349061, "post_id": 31955038, "comment_id": 51819726, "body": "&quot;Always, consistently&quot;? Really? Even if we restrict ourselves to a single specific build of the compiler, are you sure you tested all possible combinations of compiler settings? What about all possible variants of surrounding contexts? And if you didn&#39;t, how can you make that &quot;always, consistently&quot; claim?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1439349240, "post_id": 31955038, "comment_id": 51819766, "body": "In any case, what makes you think that it is <i>deliberately following</i> some order as opposed to producing the same order unintentionally, out of raw natural primeval determinism of computer programs?"}, {"owner": {"reputation": 11364, "user_id": 1135954, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e7a1accbdba46d580172b43527ed201?s=128&d=identicon&r=PG", "display_name": "mtk", "link": "https://stackoverflow.com/users/1135954/mtk"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1439350060, "post_id": 31955038, "comment_id": 51819935, "body": "@Ant no i didn&#39;t test with different settings. I mean by &#39;always, consistently&#39; is that i thought for different runs the output should be different.. and i didn&#39;t see such behaviour"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1439350326, "post_id": 31955038, "comment_id": 51819985, "body": "@mtk: You mean for different runs of the same, already compiled executable? If so, then no, it is a rather unrealistic thing to expect the behavior to change. It is possible to produce undefined behavior that might behave differently from one run of the same executable to another, but what you have above is not it."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1439350329, "post_id": 31955038, "comment_id": 51819986, "body": "And in that case I don&#39;t understand your reference to &quot;what order is gcc following&quot;. A compiled executable does not have any attachment to gcc anymore."}, {"owner": {"reputation": 714, "user_id": 4560635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmlM6.png?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/4560635/jeremy"}, "edited": false, "score": 1, "creation_date": 1439351392, "post_id": 31955038, "comment_id": 51820227, "body": "I played around with this a bit. I&#39;ll call &quot;A&quot; &quot;<code>i++</code>&quot;, and &quot;B&quot; &quot;<code>i</code>&quot;.  So <code>printf(&quot;%d %d %d\\n&quot;, i++, i++, i)</code> is &quot;AAB&quot;. Okay?  <code>AAAB</code> is <code>3214</code>. <code>AAAAB</code> is 43215.  <code>AAABAB</code> is 432515. <code>AAAABAABAB</code> is <code>7654321818</code>.  The rule <b>seems</b> to be to perform all operations right-to-left, performing substitution at the same time, and then replace any variables.  I don&#39;t have any ambitions to find out for certain."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1439354315, "post_id": 31955038, "comment_id": 51820975, "body": "<a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined behavior</a> doesn&#39;t mean that the behavior must change every run"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1439371891, "post_id": 31955038, "comment_id": 51830198, "body": "I&#39;m voting to close this question as off-topic because it asks for UB to be explained for one version of gcc only.  I see no lasting value in this for SO visitors.  If someone wants UB investigated, they should do it themselves."}], "answers": [{"comments": [{"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439346750, "post_id": 31955046, "comment_id": 51819147, "body": "i bet adding another <code>i++</code> will print <code>3 2 1 4</code> and another one will print <code>4 3 2 1 5</code>."}, {"owner": {"reputation": 667, "user_id": 3602281, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5yMLT.jpg?s=128&g=1", "display_name": "Don Larynx", "link": "https://stackoverflow.com/users/3602281/don-larynx"}, "reply_to_user": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439346808, "post_id": 31955046, "comment_id": 51819163, "body": "Yes, or in the latter case, even <code>3 2 1 4 5</code>."}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 1, "creation_date": 1439346816, "post_id": 31955046, "comment_id": 51819166, "body": "Another possibility is that mutating arguments are evaluated right to left, and then the non-mutators are evaluated. There are really many ways to get this behavior."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439346938, "post_id": 31955046, "comment_id": 51819196, "body": "this is the most &quot;comprehensive&quot; UB. i will explain."}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1439347037, "post_id": 31955046, "comment_id": 51819226, "body": "Eh, if anyone wants an example of the expanded behaviour, I made a longer chain on <a href=\"http://coliru.stacked-crooked.com/a/ecaa62233833e0b2\" rel=\"nofollow noreferrer\">Coliru</a>. After all the warnings, it does print the <code>543216</code> pattern"}], "tags": [], "owner": {"reputation": 667, "user_id": 3602281, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5yMLT.jpg?s=128&g=1", "display_name": "Don Larynx", "link": "https://stackoverflow.com/users/3602281/don-larynx"}, "is_accepted": false, "score": 1, "last_activity_date": 1439346671, "last_edit_date": 1439346671, "creation_date": 1439346209, "answer_id": 31955046, "question_id": 31955038, "link": "https://stackoverflow.com/questions/31955038/understanding-output-of-c-code-on-gcc-compiler/31955046#31955046", "title": "understanding output of c code on gcc compiler", "body": "<p>Undefined behavior means that one compiler may compile it differently than another compiler. This is because <strong>there is no standard</strong>.</p>\n\n<p>In regards to the gcc 4.9.1 compiler, it's evaluating the middle one, then the left one, then the right one. It's hopping like a bunny. Maybe it goes from the middle to the left to the right in the general case.</p>\n"}, {"tags": [], "owner": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "is_accepted": false, "score": 1, "last_activity_date": 1439348153, "last_edit_date": 1439348153, "creation_date": 1439347532, "answer_id": 31955212, "question_id": 31955038, "link": "https://stackoverflow.com/questions/31955038/understanding-output-of-c-code-on-gcc-compiler/31955212#31955212", "title": "understanding output of c code on gcc compiler", "body": "<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.2.0/gcc/C_002b_002b-Implementation.html#C_002b_002b-Implementation\" rel=\"nofollow\">GCC doesn't appear to have an extensive and comprehensive database or documentation concerning undefined behavior</a>--if anything, it seems to be generally understood not to venture off into undefined territory. It does, however, have notes on <strong>implementation-defined behavior.</strong></p>\n\n<p>To be clear, I don't think that the <code>i = i++</code> problem <em>can</em> be optimally standardized across platforms and implementations of the same compiler because of differing semantics of calling and computation across architectures: <a href=\"http://blogs.msdn.com/b/oldnewthing/archive/2004/01/08/48616.aspx\" rel=\"nofollow\">this article</a> may be related or help clarify how an architecture can have a peculiar calling convention.</p>\n\n<p>Also, even the C++ Standard allows for some \"compiler room\" to allow them to make optimizations in such a way by imposing restrictions on the programmer, though they are often quite small and esoteric, can matter, such as <a href=\"http://cellperformance.beyond3d.com/articles/2006/06/understanding-strict-aliasing.html\" rel=\"nofollow\">strict aliasing</a>.</p>\n\n<p>Execution order of individual expressions that inherently collide no matter how you fit them into an expression would probably fit under \"compiler-space\" where the compiler is generally assumed to have full control over this.</p>\n\n<p>Also, due to the age and large volume of the GCC codebase, I'd doubt that this sort of documentation will exist if it doesn't already.</p>\n\n<p>**Edit: User <code>HuStmpHrrr</code> seems to have a handle on how GCC is implemented. Looks like it'll take some digging!</p>\n"}, {"comments": [{"owner": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "edited": false, "score": 0, "creation_date": 1439347714, "post_id": 31955216, "comment_id": 51819371, "body": "I like this answer, but is this apparent in the documentation anywhere else?"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "edited": false, "score": 0, "creation_date": 1439347828, "post_id": 31955216, "comment_id": 51819392, "body": "@VermillionAzure i can&#39;t dig into the forest of documentation now but i can clearly inform that what <a href=\"http://www.amazon.ca/Computer-Systems-Programmers-Perspective-3rd/dp/013409266X/ref=sr_1_1?ie=UTF8&amp;qid=1439347803&amp;sr=8-1&amp;keywords=computer+system+a+programmer\" rel=\"nofollow noreferrer\">CSAPP</a> introduces is exact the construct of <code>gcc</code> implementation."}, {"owner": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "edited": false, "score": 0, "creation_date": 1439348036, "post_id": 31955216, "comment_id": 51819448, "body": "I like your knowledge but the lack of ability to quote something concrete is such a shame for GCC :("}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "edited": false, "score": 0, "creation_date": 1439348236, "post_id": 31955216, "comment_id": 51819502, "body": "@VermillionAzure i will try to dig then tomorrow if i have a chance. it&#39;s not too good to read too much documentation before bed."}, {"owner": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "edited": false, "score": 0, "creation_date": 1439348257, "post_id": 31955216, "comment_id": 51819509, "body": "Can you give a link so maybe we can start digging?"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "edited": false, "score": 0, "creation_date": 1439348350, "post_id": 31955216, "comment_id": 51819539, "body": "@VermillionAzure i don&#39;t have secrete in me. all i have are google, <code>info gcc</code> and CSAPP by hand. at least you can try to grap that book and have a read."}], "tags": [], "owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "is_accepted": false, "score": 3, "last_activity_date": 1439347727, "last_edit_date": 1439347727, "creation_date": 1439347585, "answer_id": 31955216, "question_id": 31955038, "link": "https://stackoverflow.com/questions/31955038/understanding-output-of-c-code-on-gcc-compiler/31955216#31955216", "title": "understanding output of c code on gcc compiler", "body": "<p>you specified <code>gcc</code> so i will state something very <code>gcc</code> specific.</p>\n\n<p>this is undefined but if you consider how gcc implements call stack, you will know why it's consistent. basically, stack grows from high address to low address, and function like <code>printf</code> which has <code>...</code> in its argument list will dump the arguments into the stack. given the direction of stack, there aren't too many choices:</p>\n\n<pre><code>func(a1, a2, a3, a4);\n</code></pre>\n\n<p>push from left to right:</p>\n\n<pre><code>high| ... |\n    | a1  |\n    | a2  |\n    | a3  |\nlow | a4  |\n</code></pre>\n\n<p>or right to left:</p>\n\n<pre><code>high| ... |\n    | a4  |\n    | a3  |\n    | a2  |\nlow | a1  |\n</code></pre>\n\n<p>the truth is, <code>gcc</code> takes the second approach. it may sound counter-intuitive, but given such stack construct, this is very nicely designed. if you have to access the arguments in sequence, you naturally form an array in this way, so each of <code>arr[0]</code>, <code>arr[1]</code>, etc will correspond to a correct argument in position.</p>\n\n<p>so after knowing this, the evaluation order isn't very hard to comprehend any more, since <code>gcc</code> handles arguments from right to left any ways. if i need to implement a compiler handles function calls, why would i choose to handle arguments from left to right in this case and right to left in that case? that's more than confusing.</p>\n\n<p><code>gcc</code> is a very comprehensive compiler if you know some of its implementation. a technical decision often will drive to a very obvious consequence.</p>\n\n<p>this is very <code>gcc</code> specific so things could change easily if somebody changes the growth direction of stack or just feel like creating special case. for instance, <code>clang</code> seems to behave the other way around.</p>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 5064572, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5e63a9b32851ec6beb9c49893bb83ad?s=128&d=identicon&r=PG&f=1", "display_name": "JoseleMG", "link": "https://stackoverflow.com/users/5064572/joselemg"}, "is_accepted": false, "score": 0, "last_activity_date": 1439348936, "creation_date": 1439348936, "answer_id": 31955369, "question_id": 31955038, "link": "https://stackoverflow.com/questions/31955038/understanding-output-of-c-code-on-gcc-compiler/31955369#31955369", "title": "understanding output of c code on gcc compiler", "body": "<p>You can ask GCC to generate assembly code with:</p>\n\n<pre><code>gcc -S -o my_asm_output.s main.c\n</code></pre>\n\n<p>I got this :</p>\n\n<pre><code>call    ___main\nmovl    $1, 28(%esp)\nmovl    28(%esp), %edx\nleal    1(%edx), %eax\nmovl    %eax, 28(%esp)\nmovl    28(%esp), %eax\nleal    1(%eax), %ecx\nmovl    %ecx, 28(%esp)\nmovl    28(%esp), %ecx\nmovl    %ecx, 12(%esp)\nmovl    %edx, 8(%esp)\nmovl    %eax, 4(%esp)\nmovl    $LC0, (%esp)\ncall    _printf\n</code></pre>\n\n<p>where LC0:</p>\n\n<pre><code>LC0:\n    .ascii \"%d %d %d\\12\\0\"\n    .text\n    .globl  _main\n    .def    _main;  .scl    2;  .type   32; .endef\n</code></pre>\n\n<p>I'm not an expert of assembly but, it look like  the print order will be     <code>printf(\"eax edx ecx\\n\");</code>  with the correspondence increment:</p>\n\n<pre><code>movl    $1, 28(%esp)\nmovl    28(%esp), %edx\nleal    1(%edx), %eax\nleal    1(%eax), %ecx\n</code></pre>\n\n<p>But it is just a fast speculation, maybe I skip something important.</p>\n"}], "owner": {"reputation": 11364, "user_id": 1135954, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e7a1accbdba46d580172b43527ed201?s=128&d=identicon&r=PG", "display_name": "mtk", "link": "https://stackoverflow.com/users/1135954/mtk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1439348936, "creation_date": 1439346147, "last_edit_date": 1495539834, "question_id": 31955038, "link": "https://stackoverflow.com/questions/31955038/understanding-output-of-c-code-on-gcc-compiler", "title": "understanding output of c code on gcc compiler", "body": "<p>I understand from several post like this <a href=\"https://stackoverflow.com/questions/367633/what-are-all-the-common-undefined-behaviours-that-a-c-programmer-should-know-a\">What are all the common undefined behaviours that a C++ programmer should know about?</a>, that the behaviour is undefined and left to compiler.</p>\n\n<p>But for given code, the output is <code>2 1 3</code> (ALWAYS, CONSISTENTLY)</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n    int i = 1;\n    printf(\"%d %d %d\\n\", i++, i++, i);\n    return 0;\n}\n</code></pre>\n\n<p>So, I would like to know, what order is gcc following, doesn't look like left-to-right or right-to-left? The output is same always, and this question is pertaining to just gcc 4.9.1 compiler.</p>\n"}, {"tags": ["c", "ssh", "libssh"], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 4968103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1092c2923633444324a75768f105c6?s=128&d=identicon&r=PG&f=1", "display_name": "wunaozai", "link": "https://stackoverflow.com/users/4968103/wunaozai"}, "is_accepted": true, "score": 1, "last_activity_date": 1439349300, "last_edit_date": 1495541784, "creation_date": 1439349300, "answer_id": 31955429, "question_id": 31954905, "link": "https://stackoverflow.com/questions/31954905/libssh-failed-to-connect-to-localhost/31955429#31955429", "title": "libssh - failed to connect to localhost", "body": "<p>you see the config  <code>/etc/ssh/sshd_config</code></p>\n\n<p>change \n<code>passwordauthentication no</code>\nto\n<code>passwordauthentication yes</code></p>\n\n<p>refer: <a href=\"https://stackoverflow.com/questions/1556056/permission-denied-publickey-keyboard-interactive\">Permission denied (publickey,keyboard-interactive)</a></p>\n"}], "owner": {"reputation": 2102, "user_id": 2828925, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/18abe23c6b1123371f171f55be659ef5?s=128&d=identicon&r=PG&f=1", "display_name": "Jes", "link": "https://stackoverflow.com/users/2828925/jes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 1, "accepted_answer_id": 31955429, "answer_count": 1, "score": 1, "last_activity_date": 1439349300, "creation_date": 1439345255, "question_id": 31954905, "link": "https://stackoverflow.com/questions/31954905/libssh-failed-to-connect-to-localhost", "title": "libssh - failed to connect to localhost", "body": "<p>I have no idea why my libssh program fails to connect to the localhost but it works fine for remote host. </p>\n\n<pre><code>ssh_session my_ssh_session = ssh_new();\nssh_options_set(my_ssh_session, SSH_OPTIONS_USER, \"my_user_name\");\nssh_options_set(my_ssh_session, SSH_OPTIONS_HOST, \"localhost\");\n\nint rc = ssh_connect(my_ssh_session);\nif(rc != SSH_OK) {\n  printf(\"Error connecting to the localhost\\n\");\n  exit(-1);\n}\n// Authorized by the password.\nrc = ssh_userauth_password(my_ssh_session, \"my_user_name\", \"my_password\");\n</code></pre>\n\n<p>The program can successfully create the session but it always failed in the last line when I tried to get authenticated. The error message I got from <code>ssh_userauth_password</code> is <code>(Access denied. Authentication that can continue: publickey,keyboard-interactive)</code>. </p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1439344565, "post_id": 31954782, "comment_id": 51818649, "body": "That&#39;s probably a typo, since it&#39;s equivalent to <code>value1 &amp; (value2 == value2)</code>.  Which is <code>value1 &amp; true</code>."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1439344685, "post_id": 31954782, "comment_id": 51818665, "body": "<code>value1 &amp; value2 == value2</code> checks that <code>value2</code>s  pattern is matched in <code>value1</code> completely unclear what&#39;s unclear in that statement."}, {"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 0, "creation_date": 1439345146, "post_id": 31954782, "comment_id": 51818764, "body": "Are there some brackets in that code that you didn&#39;t show? Is the code just that or is there more, because you should be able to see from the context what it&#39;s doing."}, {"owner": {"reputation": 131, "user_id": 4306787, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001574520285/picture?type=large", "display_name": "Brahmaprasad R", "link": "https://stackoverflow.com/users/4306787/brahmaprasad-r"}, "edited": false, "score": 0, "creation_date": 1439363916, "post_id": 31954782, "comment_id": 51825060, "body": "I just edited my question. In fact I was missing the paranthesis enclosing value1 &amp; value2."}], "answers": [{"comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1439345186, "post_id": 31954853, "comment_id": 51818772, "body": "Ha!  You just added what I was going to throw into a secondary answer.  Very thorough."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1439345190, "post_id": 31954853, "comment_id": 51818774, "body": "Which I doubt the original programmer meant.  I suspect the intent was <code>( ( value1 &amp; value2 ) == value2 )</code>, which checks if all the bits set in <code>value2</code> are also set in <code>value1</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1439345722, "post_id": 31954853, "comment_id": 51818918, "body": "&quot;you want to know if a particular set of flags are enabled.&quot; - putting it more clearly: this tells you if <b>all</b> of the given flags are set; as opposed to <code>value1 &amp; value2</code> which tells you if <b>any</b> of the given flags are set."}, {"owner": {"reputation": 131, "user_id": 4306787, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001574520285/picture?type=large", "display_name": "Brahmaprasad R", "link": "https://stackoverflow.com/users/4306787/brahmaprasad-r"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1439358037, "post_id": 31954853, "comment_id": 51822205, "body": "@AndrewHenle, yes I meant exactly what you wrote. It was my mistake while typing the question."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 5, "last_activity_date": 1439345475, "last_edit_date": 1439345475, "creation_date": 1439344937, "answer_id": 31954853, "question_id": 31954782, "link": "https://stackoverflow.com/questions/31954782/why-would-you-check-whether-the-result-of-bitwise-and-is-equal-to-one-of-the-val/31954853#31954853", "title": "Why would you check whether the result of bitwise AND is equal to one of the values?", "body": "<p>Since <code>==</code> has a higher precedence that <code>&amp;</code>, the expression is effectively:</p>\n\n<pre><code>(value1 &amp; (value2 == value2))\n</code></pre>\n\n<p>The inner expression will always evaluate to true, so the numeric value will be 1.  Then you're left with <code>value1 &amp; 1</code> which in boolean context tests if the least significant bit is set.</p>\n\n<p>That's probably not what was intended, however.  It most likely was meant to be:</p>\n\n<pre><code>((value1 &amp; value2) == value2)\n</code></pre>\n\n<p>The first part returns a value that has only the bits set that were set in both <code>value1</code> and <code>value2</code>.  Then it compares that value for equality against <code>value2</code>.</p>\n\n<p>So that expression evaluates to true if the bits set in <code>value1</code> are a superset of the bits set in <code>value2</code>.  This could be useful if for example your variable contains a set of boolean flags and you want to know if a particular set of flags are enabled.</p>\n"}, {"tags": [], "owner": {"reputation": 2478, "user_id": 366855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f7c2b25936ee77a48182e5686afa52?s=128&d=identicon&r=PG", "display_name": "Dominique McDonnell", "link": "https://stackoverflow.com/users/366855/dominique-mcdonnell"}, "is_accepted": false, "score": 5, "last_activity_date": 1439365266, "creation_date": 1439365266, "answer_id": 31958947, "question_id": 31954782, "link": "https://stackoverflow.com/questions/31954782/why-would-you-check-whether-the-result-of-bitwise-and-is-equal-to-one-of-the-val/31958947#31958947", "title": "Why would you check whether the result of bitwise AND is equal to one of the values?", "body": "<p>That all of the tested value bits were set in the other value. </p>\n\n<p>A few simple examples:</p>\n\n<pre>\n1111 & 1010 = 1010\n1110 & 1010 = 1010\n1010 & 1010 = 1010\n0010 & 1010 = 0010\n1000 & 1010 = 1000\n</pre>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1439365776, "last_edit_date": 1439365776, "creation_date": 1439365455, "answer_id": 31959009, "question_id": 31954782, "link": "https://stackoverflow.com/questions/31954782/why-would-you-check-whether-the-result-of-bitwise-and-is-equal-to-one-of-the-val/31959009#31959009", "title": "Why would you check whether the result of bitwise AND is equal to one of the values?", "body": "<p>In this case, the <code>value2</code> is both used as a mask and to check the actual value.</p>\n\n<p>In case, <code>value1</code> has some other value than that of <code>value2</code> a straight comparison will fail.</p>\n\n<p>If we're interested in only a certain part of the value, we have to first mask out the unnecessary bits and  then perform the comparison.</p>\n\n<p>Suppose, </p>\n\n<ul>\n<li><code>value1</code> has a value of <code>14</code> (binary <code>00001110</code>), </li>\n<li><code>value2</code> has a value of <code>2</code>   (binary <code>00000010</code>)</li>\n<li>and we're interested only in checking the the value contained in the LSB and LSB +1 equals to the value held by <code>value2</code> or not </li>\n</ul>\n\n<p>So, in that case, doing a</p>\n\n<pre><code>  if (value1 == value2)     \n</code></pre>\n\n<p>will fail and will not serve our purpose. OTOH,</p>\n\n<pre><code> if( (value1 &amp; value2 ) == value2)\n</code></pre>\n\n<p>will be first masking out the other bit values from <code>value1</code> and then perform the comparison with <code>value2</code>, which will give us the desired result.</p>\n\n<p>A wide use of this technique is seen in case of checking a <em>flag</em> value.</p>\n"}, {"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 1, "last_activity_date": 1439365715, "creation_date": 1439365715, "answer_id": 31959092, "question_id": 31954782, "link": "https://stackoverflow.com/questions/31954782/why-would-you-check-whether-the-result-of-bitwise-and-is-equal-to-one-of-the-val/31959092#31959092", "title": "Why would you check whether the result of bitwise AND is equal to one of the values?", "body": "<p>That's the classical way to check if a group of flags is set in a bitfield.</p>\n\n<pre><code>enum FileAttributes {\n    ReadOnly = 1,\n    Archive = 2,\n    System = 4,\n    Hidden = 8\n};\n\nunsigned int requiredAttrs = System | Hidden;\nif((GetFileAttributes(fileName) &amp; requiredAttrs) == requiredAttrs) {\n    ...\n}\n</code></pre>\n\n<p>The <code>&amp;</code> is used to mask out the attributes that we don't care about (for example, the file may be <code>ReadOnly</code>, but we don't care), the <code>==</code> checks if <em>all</em> the required attributes are there.</p>\n"}], "owner": {"reputation": 131, "user_id": 4306787, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001574520285/picture?type=large", "display_name": "Brahmaprasad R", "link": "https://stackoverflow.com/users/4306787/brahmaprasad-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1439355506, "creation_date": 1439344400, "last_edit_date": 1439355506, "question_id": 31954782, "link": "https://stackoverflow.com/questions/31954782/why-would-you-check-whether-the-result-of-bitwise-and-is-equal-to-one-of-the-val", "title": "Why would you check whether the result of bitwise AND is equal to one of the values?", "body": "<p>I have just found a code where \"bitwise and\" is done, but unable to understand the logic clearly.</p>\n\n<pre><code>if( (value1 &amp; value2 ) == value2)\n{\n    //Some code.\n}\n</code></pre>\n\n<p>I know that the binary bit by bit AND operation is done on the variables.\nBut my question is if \"bitwise and\" between \"value1\" and \"value2\" yields \"value2\", what information am I supposed to deduce regarding the values?</p>\n"}, {"tags": ["c", "playing-cards"], "comments": [{"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 2, "creation_date": 1439344139, "post_id": 31954722, "comment_id": 51818552, "body": "What does 52 cards have to do with counting pairs? Just count the number of cards that are the same and divide it by 2. 2 and 3 cards gives 1 and four gives 2; just what you wanted."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1439396874, "post_id": 31954722, "comment_id": 51848368, "body": "Writing a &quot;naive&quot; poker hand evaluator like this, you&#39;re on the right track, but a couple of notes: sort the hand first, it will speed up later tests; check for hand types top-down: i.e., straight flush, quads, full house...no pair, rather than bottom up, because that will allow simple early returns. Cards as simple integers is good, but since you&#39;ve ordered them A,2,3,,,K,A,2,,,,K, you can see that you need lots of %13s. Better to order them 2,2,2,2,3,3,3,3,...A,A,A,A, then you only need fast bit masking, and you can compare ranks without even separating them."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439488147, "post_id": 31954722, "comment_id": 51894332, "body": "when formatting code, never use tabs for horizontal spacing because every wordprocessor and editor has the tab widths/tab stops set differently.  Suggest using 4 spaces for indenting.   I.E. indent 4 spaces after every opening brace &#39;{&#39; and un-indent before every closing brace &#39;}&#39;"}, {"owner": {"reputation": 9, "user_id": 2871050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3f8ecbee2782b14b0bf0f5e7f69dc2?s=128&d=identicon&r=PG&f=1", "display_name": "user2871050", "link": "https://stackoverflow.com/users/2871050/user2871050"}, "edited": false, "score": 0, "creation_date": 1440553410, "post_id": 31954722, "comment_id": 52317128, "body": "Can someone give code on how to do it."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 1874518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b03d89b00def734566ab7151aa49395b?s=128&d=identicon&r=PG&f=1", "display_name": "goal4321", "link": "https://stackoverflow.com/users/1874518/goal4321"}, "is_accepted": false, "score": 1, "last_activity_date": 1457613367, "creation_date": 1457613367, "answer_id": 35916689, "question_id": 31954722, "link": "https://stackoverflow.com/questions/31954722/how-to-find-count-and-show-card-pairs-in-c-where-2-or-3-of-a-kind-is-one-pair/35916689#35916689", "title": "How to find, count and show card pairs in C, where 2 or 3 of a kind is one pair, and 4 of a kind is two pairs?", "body": "<p>Once the cards are sorted, you can find the pairs just by comparing the consecutive cards. Before that there is another problem in your code, when you are sorting you are sorting it in hands[h] and for findpairs()  you are giving handssorted array. so first copy the values to handssorted and sort them. </p>\n\n<p>After that you just compare the consecutive values in findpairs call. Once you found the pairs increment the pointer to 3rd card. </p>\n\n<pre><code> pairs findpairs ( card *h )\n  {\n   pairs numpairs=0;\n   int card1, card2;\n   /* find the pairs here */\n    for(int i = 0; i&lt;4; i++){\n       /* Compare the card values here */\n        card1 = h[i];\n        card2 = h[i++]; /*extract values according to your encoding scheme*/\n       if(card1 == card2){\n          numpairs++;\n          i++; // skip the next card to avoid counting 3 of a kind, since it is just a pair \n     }\n\n   return numpairs;\n    }\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 2871050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3f8ecbee2782b14b0bf0f5e7f69dc2?s=128&d=identicon&r=PG&f=1", "display_name": "user2871050", "link": "https://stackoverflow.com/users/2871050/user2871050"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1799, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457613367, "creation_date": 1439343892, "last_edit_date": 1439344831, "question_id": 31954722, "link": "https://stackoverflow.com/questions/31954722/how-to-find-count-and-show-card-pairs-in-c-where-2-or-3-of-a-kind-is-one-pair", "title": "How to find, count and show card pairs in C, where 2 or 3 of a kind is one pair, and 4 of a kind is two pairs?", "body": "<p>I am struggling and have no idea how to determine and show number of pairs where</p>\n\n<ul>\n<li>2 or 3 of a kind is one pair and 4 of a kind is two pairs.</li>\n<li>2 of a kind is 2 cards having the same number, 3 of a kind is 3 cards having the same number, and 4 of a kind is 4 cards having the same number.</li>\n</ul>\n\n<p>How would you find, count and show number of pairs, since the deck of cards has 52 cards?</p>\n\n<p>Code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n\n/* handy typedefs */\ntypedef unsigned char card;\ntypedef unsigned char pairs;\n\n/* arrays for the names of things */\nstatic char *suits[4] = {\"Hearts\",\"Diamonds\",\"Clubs\",\"Spades\"};\nstatic char *values[13]= {\"Ace\",\"Two\",\"Three\",\"Four\",\"Five\",\"Six\",\"Seven\",\n                      \"Eight\",\"Nine\",\"Ten\",\"Jack\",\"Queen\",\"King\"};\nstatic char *colour[2]= {\"Red\",\"Black\"};\n\nint compareface(const void * c1, const void * c2);\nint comparesuit(const void * c1, const void * c2);\nvoid shuffle(int deck[52]);\npairs findpairs ( card *h ) ; /* finds any pairs in a hand */\nint main()\n{\n int deck[52];\n pairs numpairs[5], highest;\n int s, c, a, i, j;\n\n j = 0;\n for(s = 0; s &lt; 4; s++)//for filling a deck of 52 cards\n {\n   for(c = 0; c &lt; 13; c++)\n   {\n   deck[s * 13 + c] = j;\n   j++;\n   }\n }\n\nfor(a = 0; a &lt; 52; a++)\n{     \n  printf(\" %s of\", values[ deck[a] % 13 ]);\n  printf(\" %s, is \", suits[ deck[a] / 13 ]);\n  printf(\"%s\\n\", colour[ deck[a] / 26 ]);\n}\n\nint hands[5][5],h,cd,winner,handssorted[5][5];\nint irand;\nsrand(time(NULL));       /* seed the random number generator */\n\n// shuffle the deck before to get the hands:\nshuffle(deck);\nj = 0;\nfor (h=0;h&lt;5;h++)\n{\n  for ( i = 0; i &lt; 5; i++) {\n    hands[h][i] = deck[j];\n    j++;\n  }\n}\n// sort the cards by card value:\nfor (h=0;h&lt;5;h++)\n{\n  qsort(hands[h], 5, sizeof(int), compareface);\n\n}\n// print the hand:\nfor (h=0;h&lt;5;h++)\n{\n  printf(\"\\nHand %d:\\n\",h+1 );\n  for ( i = 0; i &lt; 5; i++) {\n    printf(\" %s of\", values[ hands[h][i] % 13 ]);\n    printf(\" %s, is \", suits[ hands[h][i] / 13 ]);\n    printf(\"%s\\n\", colour[ hands[h][i] / 26 ]);\n  }\n printf(\"Number of pairs: \\n\");\n}\n\n// sort the cards by card value then card suit:\nfor (h=0;h&lt;5;h++)\n{\n  qsort(hands[h], 5, sizeof(int), comparesuit);\n  numpairs[h]= findpairs( handssorted[h] );\n}\n// print the hand:\n  for (h=0;h&lt;5;h++)\n  {\n   for ( i = 0; i &lt; 4; i++) {\n    for(j = i+1; j &lt; 5; j++) {\n     if( (hands[h][i] / 13 &gt; hands[h][j] / 13) &amp;&amp; (hands[h][i] % 13 ==  hands[h][j] % 13) ) {\n      c = hands[h][i];\n      hands[h][i] = hands[h][j];\n      hands[h][j] = c;\n                                         }\n                         }\n                       }\n              }\n       /* determine the winner and print it */\n       return 0;\n        }\n\n     void shuffle(int deck[52])\n     {\n      int i,rnd, c;\n\n      for(i=0;i&lt;52;i++)\n      {\n        /* generate a random number between 0 &amp; 51 */\n         rnd=rand() * 52.0 / RAND_MAX;\n         c = deck[i];\n         deck[i] = deck[rnd];\n         deck[rnd] = c;\n        }\n      }\n\n    int compareface(const void * c1, const void * c2)\n    {\n    const int cd1 = *(const int*)c1;\n    const int cd2 = *(const int*)c2;\n    if(cd1 % 13 &gt; cd2 % 13) return 1;\n    if(cd1 % 13 == cd2 % 13) return 0;\n     return -1;\n    }\n\n    int comparesuit(const void * c1, const void * c2)\n     {\n     const int cd1 = *(const int*)c1;\n     const int cd2 = *(const int*)c2;\n     if(cd1 / 13 &gt; cd2 / 13) return 1;\n     if(cd1 / 13 == cd2 / 13) return 0;\n     return -1;\n     }\n\n      pairs findpairs ( card *h )\n      {\n       pairs numpairs=0;\n       /* find the pairs here */\n       return numpairs;\n        }\n</code></pre>\n"}, {"tags": ["c++", "c", "calibration", "adc"], "comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 1, "creation_date": 1439342985, "post_id": 31954562, "comment_id": 51818272, "body": "How are you sure that it&#39;s actually 10v? Is there a possibility that the measuring device you&#39;re using has its own potential difference?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1439343795, "post_id": 31954562, "comment_id": 51818463, "body": "Doesn&#39;t 10V exceed the max ratings for the ADC?  How are you scaling your input and reference voltages?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1439347299, "post_id": 31954562, "comment_id": 51819294, "body": "You should be able to compensate for some gain error by adjusting the voltage divider ratio at the input..."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439372230, "post_id": 31954562, "comment_id": 51830412, "body": "If you already have a calibration curve for each equipment, I can&#39;t see what more you can do in software.  Production testing and conformance are procedural and contractual matters that are outside the scope of SO."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1439378528, "post_id": 31954562, "comment_id": 51834692, "body": "@Dmitri The divider ratio is pre set to be exact and precise as possible. the divider uses 0.1% resistors and a 5% cap. This was spec given to me. It has to be done in software."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1439378622, "post_id": 31954562, "comment_id": 51834750, "body": "@MartinJames I made the calibration curve in excel for one ADC input only just to see a curve in general. I could characterize the whole device, but I&#39;m not sure of the best/most efficient.industry standard methos of calibration."}], "owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 389, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1439344249, "creation_date": 1439342537, "last_edit_date": 1439344249, "question_id": 31954562, "link": "https://stackoverflow.com/questions/31954562/adc-calibration-method", "title": "ADC Calibration Method", "body": "<p>I'm using a MOD54415 NetBurner Module to drive a SPI controlled, 16 input, 12 bit ADC (AD7490B) but I'm noticing a >0.3% error in the readback - I sample 10.000 volts, I get a reading of 9.9645 volts back. I'm trying to write a calibration routine for it to close that error to 0.1% or better, but I'm really not sure how to proceed. I have done quadratic curve matching in Excel with a plot of the data input and data read from the ADC, but I'm not sure if that's the best way to implement it, how many cycles the floating point math will consume, and if there's a better way. Overall, I've never had to do any kind of calibration before, so I'm not really sure where to start. Can someone point me in the right direction? If it helps, the processor is 250MHz, and I poll all 16 channels every 0.1 seconds (SPI speed is 20MHz). Thanks all!</p>\n\n<p>Edit: The inputs are actually only 5V tolerant. I have a follower buffer, and a 2:1 divider filter. I provided 5.000 and 10.000 from a reference source, and measured it with a DMM that reads 4 decimal places. A the input pin of the ADC, I read 5.0009V and 2.5005, and the ADC should be reading 0xFFF (+/- 2LSB) but it's reading 0xFEC to 0xFF3 (approximate). I just did the math to calculate the numbers.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 1627, "user_id": 973745, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d76d7da0d148f26c10ce3241e6b2c50?s=128&d=identicon&r=PG", "display_name": "LogicG8", "link": "https://stackoverflow.com/users/973745/logicg8"}, "edited": false, "score": 1, "creation_date": 1439341124, "post_id": 31954360, "comment_id": 51817854, "body": "Can you provide the definition for cmdRequest_t?"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439341209, "post_id": 31954360, "comment_id": 51817876, "body": "how do you know it doesn&#39;t work?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1439341393, "post_id": 31954360, "comment_id": 51817922, "body": "That assignment syntax is not usable in C.  You are trying to use an initialization list with an assignment statement and you can&#39;t do that. You will need to assign the individual members one at a time."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1439341716, "post_id": 31954360, "comment_id": 51817994, "body": "Btw <code>_t</code> is a reserved suffix"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1439341749, "post_id": 31954360, "comment_id": 51817998, "body": "What&#39;s the point of doing &quot;zero&quot;, if you want to &quot;assign&quot; afterwards anyway?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1627, "user_id": 973745, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d76d7da0d148f26c10ce3241e6b2c50?s=128&d=identicon&r=PG", "display_name": "LogicG8", "link": "https://stackoverflow.com/users/973745/logicg8"}, "edited": false, "score": 0, "creation_date": 1439351539, "post_id": 31954360, "comment_id": 51820256, "body": "@LogicG8 it&#39;s better off without the definition, then we have no chance of giving a non-general answer"}], "answers": [{"comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1439341350, "post_id": 31954376, "comment_id": 51817910, "body": "This should fill any remaining members with 0 too."}], "tags": [], "owner": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "is_accepted": true, "score": 7, "last_activity_date": 1439341121, "creation_date": 1439341121, "answer_id": 31954376, "question_id": 31954360, "link": "https://stackoverflow.com/questions/31954360/zero-and-initialize-a-c-structure/31954376#31954376", "title": "Zero and initialize a C structure", "body": "<p>Simply do:</p>\n\n<pre><code>cmdRequest_t cmdRequest = {3, \"d t\"};\n</code></pre>\n\n<p>There's no need to zero the structure if you're going to immediately fill in other values.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1439341693, "post_id": 31954401, "comment_id": 51817990, "body": "Pre-C99 it can be written <code>{ cmdRequest_t temp = { 3, &quot;d t&quot; }; cmdRequest = temp; }</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1439341820, "post_id": 31954401, "comment_id": 51818013, "body": "@MattMcNabb: Yes, that works, though it can be argued that it uses an initialization as well as the assignment."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1439341320, "creation_date": 1439341320, "answer_id": 31954401, "question_id": 31954360, "link": "https://stackoverflow.com/questions/31954360/zero-and-initialize-a-c-structure/31954401#31954401", "title": "Zero and initialize a C structure", "body": "<p>If you need to do the assignment and cannot use an initialization, then you need to use a (C99 or later) compound literal:</p>\n\n<pre><code>cmdRequest = (cmdRequest_t){ 3, \"d t\" };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 1, "last_activity_date": 1439350283, "creation_date": 1439350283, "answer_id": 31955551, "question_id": 31954360, "link": "https://stackoverflow.com/questions/31954360/zero-and-initialize-a-c-structure/31955551#31955551", "title": "Zero and initialize a C structure", "body": "<p>Others have given the answer for initialisation already:</p>\n\n<pre><code>cmdRequest_t cmdRequest = {3, \"d t\"};\n</code></pre>\n\n<p>If by chance you wanted to reassign this struct, setting the first member to 42 and the second member (implicitly) to a null pointer, you could use this:</p>\n\n<pre><code>cmdRequest = (cmdRequest_t) { 42 };\n</code></pre>\n\n<p>If you wanted to reassign the struct, setting the second member, you'd need to use the name of the second member in the initialisation list. For example, if we consider that the second member is named <em><code>fubar</code></em>:</p>\n\n<pre><code>cmdRequest = (cmdRequest_t) { .fubar = \"hello world\" };\n</code></pre>\n\n<p>I advise explicitly initialising using the member names like this, because that way refactoring the struct at your whim becomes simple; you can change the order, the member names, etc, and the compiler will do most of the grunt work for you.</p>\n"}], "owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 31954376, "answer_count": 3, "score": 1, "last_activity_date": 1439350283, "creation_date": 1439341004, "question_id": 31954360, "link": "https://stackoverflow.com/questions/31954360/zero-and-initialize-a-c-structure", "title": "Zero and initialize a C structure", "body": "<p>I have a struct that I want to zero and then set the members. I tried this:</p>\n\n<pre><code>cmdRequest_t cmdRequest = {0};\ncmdRequest = {3, \"d t\"};\n</code></pre>\n\n<p>but that doesn't work. I have also tried several variants, but I always get a syntax error on that second line. How can I do this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1439337874, "post_id": 31953960, "comment_id": 51817068, "body": "Did you see the large list of suggested existing questions?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1439337964, "post_id": 31953960, "comment_id": 51817086, "body": "Some more advice: Only put one question into a StackOverflow question. Your second paragraph is a different question."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1439338835, "post_id": 31953960, "comment_id": 51817281, "body": "If you read the line with <code>fgets()</code> what would be the reason to read it again with <code>gets()</code>? You already have the line of data."}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439338952, "post_id": 31953960, "comment_id": 51817316, "body": "I&#39;m probably repeating info here, as for checking in advance of using <code>gets()</code>, you can sometimes seek through stdin with <code>fseek()</code> (usually not possible if stdin is just terminal input), and determine length of string, but this would never be an ideal solution. Realistically you could make your own function to read in a line and store it in heap memory for arbitrary sized lines, or if you don&#39;t mind using a max length use <code>fgets()</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1439340754, "post_id": 31953960, "comment_id": 51817763, "body": "The way to prevent buffer overflows when calling <code>gets()</code> is not to call <code>gets()</code>.  Ever. It&#39;s inherently unsafe, and has been removed from the C standard as of 2011."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1439341000, "post_id": 31953960, "comment_id": 51817818, "body": "See also <a href=\"http://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">Why is the <code>gets()</code> function so dangerous that it should not be used?</a>"}], "owner": {"reputation": 1, "user_id": 5217076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b0d03a9450d680adfc596820c03e59?s=128&d=identicon&r=PG&f=1", "display_name": "Baby_truck_driver", "link": "https://stackoverflow.com/users/5217076/baby-truck-driver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1439340872, "answer_count": 0, "score": 0, "last_activity_date": 1495920131, "creation_date": 1439337731, "last_edit_date": 1495920131, "question_id": 31953960, "link": "https://stackoverflow.com/questions/31953960/c-performing-checks-for-functions-such-as-gets-to-prevent-buffer-overflow", "closed_reason": "Duplicate", "title": "C, performing checks for functions such as gets() to prevent buffer overflow", "body": "<p>Is it even possible in the first place? Since checks are usually performed after the function has been executed, I can only assume that this is not possible because by then the buffer would have overflowed, and the check that comes after it would be irrelevant. Is that right?</p>\n"}, {"tags": ["c", "for-loop", "multidimensional-array", "malloc", "double-pointer"], "comments": [{"owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "edited": false, "score": 0, "creation_date": 1439341076, "post_id": 31953889, "comment_id": 51817838, "body": "You should just post the entire piece of code, like this is harder to follow, for example, what is the  <code>npixles</code> you use in the <code>malloc</code>?"}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1439342185, "post_id": 31953889, "comment_id": 51818103, "body": "Are you asking how to set up an array of pointers to double?"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439343061, "post_id": 31953889, "comment_id": 51818292, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 2, "creation_date": 1439344148, "post_id": 31954545, "comment_id": 51818554, "body": "Why would you assume that it needs to be initialized to 0s.  If you are going to initialize it immediately, its just a wasted call to memset at best and possibly preventS the compiler from doing optimizations using its malloc builtins."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1439342384, "creation_date": 1439342384, "answer_id": 31954545, "question_id": 31953889, "link": "https://stackoverflow.com/questions/31953889/how-to-allocate-memory-dynamically-for-pointers-and-three-dimensional-arrays/31954545#31954545", "title": "how to allocate memory dynamically for pointers and three dimensional arrays", "body": "<p>How about this:</p>\n\n<pre><code>double *pix[20];\nint i;\nfor (i=0;i&lt;20;i++) {\n    pix[i] = calloc(npixels, sizeof(double));\n    if (pix[i] == NULL) {\n        perror(\"calloc failed\");\n        exit(1);\n    }\n}\n</code></pre>\n\n<p>I'm using <code>calloc</code> instead of <code>malloc</code> because the former is geared toward creating an array, and has the side effect of initializing all bytes to zero.</p>\n"}, {"comments": [{"owner": {"reputation": 7373, "user_id": 5200329, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/da6b14c198704567425703ff9507dfb4?s=128&d=identicon&r=PG", "display_name": "Bhishan Poudel", "link": "https://stackoverflow.com/users/5200329/bhishan-poudel"}, "edited": false, "score": 0, "creation_date": 1439351878, "post_id": 31954583, "comment_id": 51820333, "body": "then how to free the memory, like this?  for (int i = 1; i &lt; 21; i++)   free(  pix[i])"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 7373, "user_id": 5200329, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/da6b14c198704567425703ff9507dfb4?s=128&d=identicon&r=PG", "display_name": "Bhishan Poudel", "link": "https://stackoverflow.com/users/5200329/bhishan-poudel"}, "edited": false, "score": 0, "creation_date": 1439352027, "post_id": 31954583, "comment_id": 51820373, "body": "I said <code>free(pix_base)</code>; the <code>naxes</code> array is an automatic (or <code>static</code>) array and does not need freeing."}, {"owner": {"reputation": 7373, "user_id": 5200329, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/da6b14c198704567425703ff9507dfb4?s=128&d=identicon&r=PG", "display_name": "Bhishan Poudel", "link": "https://stackoverflow.com/users/5200329/bhishan-poudel"}, "edited": false, "score": 0, "creation_date": 1439408649, "post_id": 31954583, "comment_id": 51854855, "body": "i did like this: where N = 20;   &#39;double *pix[N]; \t     for (int i=0;i&lt;N;i++)      {         pix[i] = calloc(npixels, sizeof(double));         if (pix[i] == NULL)          {             printf(&quot;Error: allocating memory to pixels failed&quot;);             return (1);         }     } then, to free the memory for(j=0;j&lt;N;j++)         {             free(pix[j]);         }&#39;"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1439342761, "creation_date": 1439342761, "answer_id": 31954583, "question_id": 31953889, "link": "https://stackoverflow.com/questions/31953889/how-to-allocate-memory-dynamically-for-pointers-and-three-dimensional-arrays/31954583#31954583", "title": "how to allocate memory dynamically for pointers and three dimensional arrays", "body": "<p>When you have written variable names <code>naxes1</code>, <code>naxes2</code>, \u2026, <code>naxes20</code>, you need to rewrite the code to use an array.  If you need indexes <code>1..20</code>, then you could write:</p>\n\n<pre><code>int naxes[21][3] = { { -1, -1, -1 },  /* Element 0 - unused */\n                     { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 },\n                     { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 },\n                     { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 },\n                     { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 },\n                     { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 }, { 1, 1, 1 },\n                   };\n</code></pre>\n\n<p>Or, using a very sensible and convenient GCC <a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.2.0/gcc/Designated-Inits.html#Designated-Inits\" rel=\"nofollow\">extension</a>:</p>\n\n<pre><code>int naxes[21][3] = { [0] = { -1, -1, -1 }, [1 ... 20] = { 1, 1, 1 }, };\n</code></pre>\n\n<p>The range notation <code>[1 ... 20]</code> is the extension; the <code>[0] = { -1, -1, -1 },</code> is standard C99 \u2014 a designated initializer.</p>\n\n<p>With this, you can use <code>naxes[n][m]</code> for <code>n</code> in the range <code>1..20</code> and <code>m</code> in the range <code>0..2</code> to access the elements of <code>naxes</code>.</p>\n\n<p>Similar comments apply to the <code>pixN</code> variables.  However, there you want dynamic memory allocation; you might then use:</p>\n\n<pre><code>double *pix_base = malloc(20 * npixels * sizeof(double));\nif (pix_base == 0) { \u2026handle out of memory error\u2026 }\n\ndouble  pix[21];\npix[0] = 0;\nfor (int i = 1; i &lt; 21; i++)\n    pix[i] = pix_base + (i - 1) * npixels;\n</code></pre>\n\n<p>You can now use <code>pix[n][m]</code> for <code>n</code> in the range <code>1..20</code> and <code>m</code> in the range <code>0..(npixels-1)</code> to access the data.  When finished, you call <code>free(pix_base)</code> to free all the memory at once.  This is more economical on space than 20 separate memory allocations (and more economical on calls to <code>malloc()</code> and <code>free()</code>).</p>\n\n<p>You can adapt this second technique to handle the arrays of integers too.</p>\n\n<p>If you can use entries 0..19 instead of 1..20, then you can save a little complexity.</p>\n"}, {"tags": [], "owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "is_accepted": false, "score": 1, "last_activity_date": 1439343072, "creation_date": 1439343072, "answer_id": 31954620, "question_id": 31953889, "link": "https://stackoverflow.com/questions/31953889/how-to-allocate-memory-dynamically-for-pointers-and-three-dimensional-arrays/31954620#31954620", "title": "how to allocate memory dynamically for pointers and three dimensional arrays", "body": "<p>You likely did a lot of copying and pasting to come up with that code. Well let's use that systematic logic of yours and separate out repeated logic, with the aid of some 2D arrays:</p>\n\n<pre><code>long naxes[20][3];\nconst long naxes_init[3] = {1, 1, 1};\n\nfor (int i = 0; i &lt; 20; ++i)\n{\n    memcpy(naxes[i], naxes_init, 3 * sizeof (long));\n}\n\ndouble *pix[20];\n\nfor (int i = 0; i &lt; 20; ++i)\n{\n    pix[i]  = (double *) malloc(npixels * sizeof(double));\n}\n</code></pre>\n\n<p>You already have most of the logic down: you just need to understand for-loop syntax. After all, the line in the second loop is almost exactly what you had copied 20 times earlier.</p>\n\n<p>Lastly, a key difference is that of course C uses 0-based indices... and so should you. e.g. <code>pix[0]</code> is the equivalent to your <code>pix1</code>.</p>\n"}], "owner": {"reputation": 7373, "user_id": 5200329, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/da6b14c198704567425703ff9507dfb4?s=128&d=identicon&r=PG", "display_name": "Bhishan Poudel", "link": "https://stackoverflow.com/users/5200329/bhishan-poudel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 31954583, "answer_count": 3, "score": 1, "last_activity_date": 1439348347, "creation_date": 1439337276, "last_edit_date": 1439348347, "question_id": 31953889, "link": "https://stackoverflow.com/questions/31953889/how-to-allocate-memory-dynamically-for-pointers-and-three-dimensional-arrays", "title": "how to allocate memory dynamically for pointers and three dimensional arrays", "body": "<p>I want to <em>allocate memory dynamically</em> using <code>malloc</code> so that i can use <em>for loop</em> to access each array and array element.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>long naxes1[3]  = {1,1,1}, naxes2[3]  = {1,1,1}, naxes3[3]  = {1,1,1}, naxes4[3]  = {1,1,1}; //upto naxes20\n</code></pre>\n\n<p>Another line of code is:</p>\n\n<pre><code>double *pix1,  *pix2,  *pix3,  *pix4,  *pix5; //upto *pix20\n</code></pre>\n\n<p>To allocate the memory, I do this:</p>\n\n<pre><code>pix1  = (double *) malloc(npixels * sizeof(double));        \npix2  = (double *) malloc(npixels * sizeof(double));//20 times,\n</code></pre>\n\n<p>How can we use for loop to allocate memory for pixels instead of this? </p>\n\n<p>moreover, </p>\n\n<pre><code>#include\"cfitsio.h\"\nlong        npixels = 1;\nfits_read_pix(names[0], TDOUBLE, firstpix, npixels, NULL, pix1, NULL, &amp;status)\n</code></pre>\n\n<p>here, names[i] are names of fitsfile inputs, TDOUBLE is double type, first pixels, npixels, etc are local variables inside C library routine cfitsio.h</p>\n"}, {"tags": ["c", "bitwise-operators"], "answers": [{"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1439347768, "post_id": 31957013, "comment_id": 51822540, "body": "Last sentence: No, it can be either 0 or <code>1 &lt;&lt; (15 - t)</code>"}], "tags": [], "owner": {"reputation": 217, "user_id": 4250401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Qdmf.png?s=128&g=1", "display_name": "esoterik", "link": "https://stackoverflow.com/users/4250401/esoterik"}, "is_accepted": false, "score": 0, "last_activity_date": 1439410046, "last_edit_date": 1439410046, "creation_date": 1439339050, "answer_id": 31957013, "question_id": 31957012, "link": "https://stackoverflow.com/questions/31957012/c-decompress-bitmask-source/31957013#31957013", "title": "C decompress Bitmask source", "body": "<blockquote>\n  <p>The if statement is what I don't understand completely? Whats triggering the if? If the bit is greater then 0? ... I just really need to know whats triggering this if statement? i think i might be over thinking it, but is it simply trigger if the current bit is greater then 0?</p>\n</blockquote>\n\n<p>The C (and C++) if statement \"triggers\" when the conditional statement evaluates to true, which is any non-zero value; zero equates to false.</p>\n\n<p>Straight C doesn't have a Boolean type, it just use the convention of zero (0) is false, and any other value is true.</p>\n\n<pre><code>if (mask &amp; (1 &lt;&lt; (15 - t))) {...}\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>if ((mask &amp; (1 &lt;&lt; (15 - t))) != 0) {...}\n</code></pre>\n\n<p>The expression you gave is only true (non-zero) when there is a bit in the mask in the same position that the 1 was shifted by. i.e. is the 15th bit in the mask set, etc. </p>\n\n<p>N.b. </p>\n\n<pre><code>mask &amp; (1 &lt;&lt; (15 - t)) \n</code></pre>\n\n<p><strike>can only ever be 0 or 1</strike> er... will only have one bit set.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 5083530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2Id7z.gif?s=128&g=1", "display_name": "Dchaps", "link": "https://stackoverflow.com/users/5083530/dchaps"}, "edited": false, "score": 0, "creation_date": 1439398889, "post_id": 31959229, "comment_id": 51849526, "body": "Thanks alot David, very informative answer, greatly appreciated!"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1439366081, "creation_date": 1439366081, "answer_id": 31959229, "question_id": 31957012, "link": "https://stackoverflow.com/questions/31957012/c-decompress-bitmask-source/31959229#31959229", "title": "C decompress Bitmask source", "body": "<p>Be careful here. </p>\n\n<blockquote>\n  <p><code>for arguments sake mask is 2 bytes 10 04, or 1040(decimal)</code> </p>\n</blockquote>\n\n<p>That assumption may be nowhere close to true. You need to show how <code>mask</code> is defined, but generally a mask of bytes <code>10</code> (<code>00001010</code>) and <code>40</code> (<code>00101000</code>) is binary <code>101000101000</code> or decimal (<code>2600</code>) not quite 1040. </p>\n\n<p>The general mask of <code>2600</code> decimal will match when <code>bits 4,6,10 &amp; 12</code> are <code>set</code>. Remember a <strong>bit mask</strong> is nothing more than a number whose binary representation when <code>anded</code> or <code>ored</code> with a second number produces some desired result. Nothing magic about a <strong>bit mask</strong>, its just a number with the right bits set for your intended purpose.</p>\n\n<p>When you <code>and</code> two numbers together and test, your are testing whether there are common bits set in both numbers. Using the <code>for</code> loop and <code>shift</code>, you are doing a bitwise test for which common bits are set. Using the <code>mask</code> of <code>2600</code> with the loop counter will test true when bits <code>4,6,10 &amp; 12</code> are <code>set</code>. In other words when the test clause equals <code>8, 32, 512 or 2048</code>.</p>\n\n<p>The following is a short example of what is happening in the <code>loop</code> and <code>if</code> statements.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/* BUILD_64 */\n#if defined(__LP64__) || defined(_LP64)\n# define BUILD_64   1\n#endif\n\n/* BITS_PER_LONG */\n#ifdef BUILD_64\n# define BITS_PER_LONG 64\n#else\n# define BITS_PER_LONG 32\n#endif\n\n/* CHAR_BIT */\n#ifndef CHAR_BIT\n# define CHAR_BIT  8\n#endif\n\nchar *binpad (unsigned long n, size_t sz);\n\nint main (void) {\n\n    unsigned short t, mask;\n\n    mask = (10 &lt;&lt; 8) | 40;\n\n    printf (\"\\n mask : %s  (%hu)\\n\\n\",\n            binpad (mask, sizeof mask * CHAR_BIT), mask);\n\n    for (t = 0; t&lt;16; t++)\n        if (mask &amp; (1 &lt;&lt; (15 - t)))\n            printf (\" t %2hu : %s  (%hu)\\n\", t, \n                    binpad (mask &amp; (1 &lt;&lt; (15 - t)), sizeof mask * CHAR_BIT), \n                    mask &amp; (1 &lt;&lt; (15 - t)));\n\n\n    return 0;\n}\n\n/** returns pointer to binary representation of 'n' zero padded to 'sz'.\n *  returns pointer to string contianing binary representation of\n *  unsigned 64-bit (or less ) value zero padded to 'sz' digits.\n */\nchar *binpad (unsigned long n, size_t sz)\n{\n    static char s[BITS_PER_LONG + 1] = {0};\n    char *p = s + BITS_PER_LONG;\n    register size_t i;\n\n    for (i = 0; i &lt; sz; i++)\n        *--p = (n&gt;&gt;i &amp; 1) ? '1' : '0';\n\n    return p;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>$ ./bin/bitmask1040\n\n mask : 0000101000101000  (2600)\n\n t  4 : 0000100000000000  (2048)\n t  6 : 0000001000000000  (512)\n t 10 : 0000000000100000  (32)\n t 12 : 0000000000001000  (8)\n</code></pre>\n"}], "migrated_from": {"other_site": {"aliases": ["http://programmer.stackexchange.com", "http://programmers.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1292524346, "open_beta_date": 1283972400, "closed_beta_date": 1283367600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon@2.png", "twitter_account": "StackSoftEng", "favicon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon.png", "audience": "professionals, academics, and students working within the systems development life cycle", "site_url": "https://softwareengineering.stackexchange.com", "api_site_parameter": "softwareengineering", "logo_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/logo.png", "name": "Software Engineering", "site_type": "main_site"}, "on_date": 1439358896, "question_id": 293458}, "owner": {"reputation": 79, "user_id": 5083530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2Id7z.gif?s=128&g=1", "display_name": "Dchaps", "link": "https://stackoverflow.com/users/5083530/dchaps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 31959229, "answer_count": 2, "score": 2, "last_activity_date": 1439410046, "creation_date": 1439336668, "question_id": 31957012, "link": "https://stackoverflow.com/questions/31957012/c-decompress-bitmask-source", "title": "C decompress Bitmask source", "body": "<p>This may be somewhat of an odd question as well as my first one ever on this site and a pretty complicated thing to ask basically I have this decompresser for a very specific archived file, I barely understand this but from what i can grasp its some sort of \"bit mask\" it reads the first 2 bytes out of target file, and stores them as a sequence.</p>\n\n<p>The first for loop is where I get confused</p>\n\n<p>Say for arguments sake mask is 2 bytes <code>10 04</code>, or 1040(decimal) thats what it usually is in these files</p>\n\n<pre><code>    for (t = 0; t&lt;16; t++) {\n        if (mask &amp; (1 &lt;&lt; (15 - t))) { \n</code></pre>\n\n<p>This seems to be looping through all 16 bits of those 2 bytes and running an AND operation on mask (1040) on every bit?<br>\nThe if statement is what I don't understand completely? Whats triggering the <code>if</code>? If the bit is greater then 0? </p>\n\n<p>Because if mask is 1040, then really what were looking at is</p>\n\n<pre><code>if(1040 &amp; 32768)    index 15\nif(1040 &amp; 16384)    index 14\nif(1040 &amp; 8192)     index 13\nif(1040 &amp; 4096)     index 12\nif(1040 &amp; 2048)     index 11\nif(1040 &amp; 1024)     index 10\nif(1040 &amp; 512)      and so on.....\nif(1040 &amp; 256)\n</code></pre>\n\n<p>I just really need to know whats triggering this if statement? i think i might be over thinking it, but is it simply trigger if the current bit is greater then 0?</p>\n\n<p>The only other thing i can do is compile this source myself, insert printfs on key variables and go hand in hand with a hex editor and try and figure out whats actually going on here, if anyone could give me a hand would be awesome.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nuint8_t  dest[1024 * 1024 * 4]; // holds the actual data\n\nint main(int argc, char *argv[]) {\n    FILE *fi, *fo;\n    char fname[255];\n\n    uint16_t mask, tmp, offset, length;\n    uint16_t seq;\n    uint32_t dptr, sptr;\n    uint16_t l, ct;\n    uint16_t t, s;\n    int test_len;\n    int t_length, t_off;\n\n\n    // Print Usage if filename is missing\n    if (argc&lt;3) {\n        printf(\"sld_unpack - Decompressor for .sld files ()\\nsld_unpack &lt;filename.sld&gt; &lt;filename.t2&gt;\\n\");\n        return(-1);\n    }\n\n    // Open .SLD-file\n    if (!(fi = fopen(argv[1], \"rb\"))) {\n        printf(\"Error opening %s\\n\", argv[1]);\n        return(-1);\n    }\n\n    dptr = 0;\n\n    fread((uint16_t*)&amp;seq, 1, 2, fi); // read 1st 2 bytes in file\n    test_len = ftell(fi);\n\n    printf(\"[Main Header sequence: %d]\\n 'offset' : %d \\n\", seq, test_len);\n    sptr = 0;\n\n    fread((uint16_t*)&amp;seq, 1, 2, fi);\n\n\n\n    while (!feof(fi)) { // while not at the end of the file set mask equal to sequence (first 2 bytes of header)\n        mask = seq;\n        // loop through 16 bit mask\n\n        for (t = 0; t&lt;16; t++) {\n            if (mask &amp; (1 &lt;&lt; (15 - t))) { // check all bit fields and run AND check to if value greater then 0?\n\n                test_len = ftell(fi);\n                fread((uint16_t*)&amp;seq, 1, 2, fi); // read \n\n\n                sptr = sptr + 2; // set from 0 to 2\n                tmp = seq; // set tmp to sequence\n                offset = ((uint32_t)tmp &amp; 0x07ff) * 2; \n\n\n                length = ((tmp &gt;&gt; 11) &amp; 0x1f) * 2; //  32 - 1?\n\n\n\n                if (length&gt;0) {\n\n                    for (l = 0; l&lt;length; l++) {\n                        dest[dptr] = dest[dptr - offset];\n                        dptr++;\n\n                    }\n                }\n                else { // if length == 0 \n\n                    t_length = ftell(fi);\n                    fread((uint16_t*)&amp;seq, 1, 2, fi);\n\n\n                    sptr = sptr + 2;\n                    length = seq * 2;\n\n                    for (s = 0; s&lt;length; s++) {\n                        dest[dptr] = dest[dptr - offset];\n                        dptr++;\n\n                    }\n                }\n            }\n            else { // if sequence AND returns 0 (or less)?\n\n                fread((uint16_t*)&amp;seq, 1, 2, fi);\n                t_length = ftell(fi);\n\n                sptr = sptr + 2;\n                dest[dptr++] = seq &amp; 0xff;\n                dest[dptr++] = (seq &gt;&gt; 8) &amp; 0xff;\n            }\n        }\n        fread((uint16_t*)&amp;seq, 1, 2, fi);\n\n    }\n\n    fclose(fi);\n\n    sprintf(fname, \"%s\\0\", argv[2]);\n\n    if (!(fo = fopen(fname, \"wb\"))) { // if file \n        printf(\"Error creating %s\\n\", fname);\n        return(-1);\n    }\n\n    fwrite((uint8_t*)&amp;dest, 1, dptr, fo);\n\n\n    fclose(fo);\n\n    printf(\"Done.\\n\");\n\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "crc16"], "comments": [{"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1439334230, "post_id": 31953396, "comment_id": 51816030, "body": "not sure, but you might want to check if the <code>&lt;&lt;</code> operator doesn&#39;t add <code>1&#39;s</code> at the end of the words."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 1, "creation_date": 1439334406, "post_id": 31953396, "comment_id": 51816085, "body": "Sorry, my bad, that only seems to apply to the <code>&gt;&gt;</code> (for signed types) operator. <a href=\"https://msdn.microsoft.com/en-us/library/xt18et0d.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/xt18et0d.aspx</a>"}, {"owner": {"reputation": 5237, "user_id": 2531341, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/vhbsU.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/2531341/chris"}, "edited": false, "score": 1, "creation_date": 1439335571, "post_id": 31953396, "comment_id": 51816462, "body": "You sure about 0xA8A9? That code (when tested at <a href=\"http://www.lammertbies.nl/comm/info/crc-calculation.html\" rel=\"nofollow noreferrer\">lammertbies.nl/comm/info/crc-calculation.html</a>) gives 0x9629, which seems to correspond to CRC-CCITT (XModem)."}, {"owner": {"reputation": 5237, "user_id": 2531341, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/vhbsU.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/2531341/chris"}, "edited": false, "score": 0, "creation_date": 1439335640, "post_id": 31953396, "comment_id": 51816483, "body": "*Haven&#39;t tested the C version though."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439335696, "post_id": 31953396, "comment_id": 51816508, "body": "Post how the functions were called.  What <i>length</i> is used?"}, {"owner": {"reputation": 414, "user_id": 4880090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9731995440b63d4cbf69257df481c87?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Kolokowsky", "link": "https://stackoverflow.com/users/4880090/steve-kolokowsky"}, "edited": false, "score": 0, "creation_date": 1439335702, "post_id": 31953396, "comment_id": 51816510, "body": "Print wCrc at every step - you&#39;ll see where they don&#39;t match."}, {"owner": {"reputation": 487, "user_id": 2766387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b93034102fea1e1d793b2fef66e69b?s=128&d=identicon&r=PG", "display_name": "Oleg Mazurov", "link": "https://stackoverflow.com/users/2766387/oleg-mazurov"}, "edited": false, "score": 0, "creation_date": 1439336171, "post_id": 31953396, "comment_id": 51816640, "body": "Not a direct answer to your question, but you can calculate CRC with much less difficulty like so  -&gt; <a href=\"https://github.com/felis/DMCI-XC8/blob/master/bsp.c#L293\" rel=\"nofollow noreferrer\">github.com/felis/DMCI-XC8/blob/master/bsp.c#L293</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 5237, "user_id": 2531341, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/vhbsU.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/2531341/chris"}, "edited": false, "score": 0, "creation_date": 1439336176, "post_id": 31953396, "comment_id": 51816644, "body": "@Chris The C version gives 0x9629 as well (when compiled as C++)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 487, "user_id": 2766387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b93034102fea1e1d793b2fef66e69b?s=128&d=identicon&r=PG", "display_name": "Oleg Mazurov", "link": "https://stackoverflow.com/users/2766387/oleg-mazurov"}, "edited": false, "score": 0, "creation_date": 1439336427, "post_id": 31953396, "comment_id": 51816705, "body": "@OlegMazurov There is no <i>the</i> way to calculate CRC. There are <a href=\"https://en.wikipedia.org/wiki/Cyclic_redundancy_check#Standards_and_common_use\" rel=\"nofollow noreferrer\">many ways</a>, and the point is to calculate in the exact way a particular device expects."}, {"owner": {"reputation": 487, "user_id": 2766387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b93034102fea1e1d793b2fef66e69b?s=128&d=identicon&r=PG", "display_name": "Oleg Mazurov", "link": "https://stackoverflow.com/users/2766387/oleg-mazurov"}, "edited": false, "score": 0, "creation_date": 1439336536, "post_id": 31953396, "comment_id": 51816737, "body": "I am aware of that. Mine is just an example, you may need different lookup table for different polynomial."}, {"owner": {"reputation": 5237, "user_id": 2531341, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/vhbsU.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/2531341/chris"}, "edited": false, "score": 1, "creation_date": 1439365902, "post_id": 31953396, "comment_id": 51826198, "body": "If both the C and C# version gives 0x9629, I&#39;d say the code works fine. What about encoding?"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1439366786, "post_id": 31954694, "comment_id": 51826765, "body": "<i>In both examples, the second cast to an unsigned 16 bit integer is unneeded</i> - no, it is needed. In C# the shift operators are <a href=\"https://msdn.microsoft.com/ru-ru/library/aa691377%28v=vs.71%29.aspx\" rel=\"nofollow noreferrer\">defined to return variations of <code>int</code> and <code>long</code></a>. These need to be casted back to <code>ushort</code>. Same goes for the <code>^</code> operator. There&#39;s a <a href=\"http://stackoverflow.com/a/31953476/11683\">deleted answer</a> in this question that you <a href=\"http://stackoverflow.com/help/privileges\">can&#39;t see</a>, it says the same thing, and it was deleted apparently because this change does not in fact make a difference."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1439367429, "post_id": 31954694, "comment_id": 51827145, "body": "So converting to <code>ushort</code> is not needed because C# will promote the argument before shifting anyway. What does make a difference though is replacing <code>Convert.ToUInt16(value)</code> with <code>unchecked((ushort)(value))</code> to match the C behaviour. With the current code, there will be an overflow exception on the second <code>ToUInt16</code>."}], "tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": true, "score": 4, "last_activity_date": 1439455514, "last_edit_date": 1439455514, "creation_date": 1439343714, "answer_id": 31954694, "question_id": 31953396, "link": "https://stackoverflow.com/questions/31953396/calculating-crc16-in-c/31954694#31954694", "title": "Calculating CRC16 in C#", "body": "<p>The problem here is that the message including the ETB (\\x17) is 4 bytes long (the leading sync byte isn't used for the CRC): \"OPN\\x17\" == {'O', 'P', 'N', 0x17}, which results in a CRC of {0xA8, 0xA9} to be appended to the message. So the CRC function is correct, but the original test data wasn't including the 4th byte which is 0x17.</p>\n\n<p>This is a working example (at least with VS2015 express).</p>\n\n<pre><code>private static ushort Calc(byte[] data)\n{\n    ushort wCRC = 0;\n    for (int i = 0; i &lt; data.Length; i++)\n    {\n        wCRC ^= (ushort)(data[i] &lt;&lt; 8);\n        for (int j = 0; j &lt; 8; j++)\n        {\n            if ((wCRC &amp; 0x8000) != 0)\n                wCRC = (ushort)((wCRC &lt;&lt; 1) ^ 0x1021);\n            else\n                wCRC &lt;&lt;= 1;\n        }\n    }\n    return wCRC;\n}\n</code></pre>\n"}], "owner": {"reputation": 1491, "user_id": 1127363, "user_type": "registered", "accept_rate": 54, "profile_image": "https://graph.facebook.com/625087165/picture?type=large", "display_name": "Gutemberg Ribeiro", "link": "https://stackoverflow.com/users/1127363/gutemberg-ribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6789, "favorite_count": 0, "accepted_answer_id": 31954694, "answer_count": 1, "score": 0, "last_activity_date": 1439513334, "creation_date": 1439333956, "last_edit_date": 1439513334, "question_id": 31953396, "link": "https://stackoverflow.com/questions/31953396/calculating-crc16-in-c", "title": "Calculating CRC16 in C#", "body": "<p>I'm trying to port an old code from C to C# which basically receives a string and returns a CRC16 of it... </p>\n\n<p>The C method is as follow:</p>\n\n<pre><code>#define CRC_MASK 0x1021 /* x^16 + x^12 + x^5 + x^0 */\n\nUINT16 CRC_Calc (unsigned char *pbData, int iLength)\n{\n    UINT16 wData, wCRC = 0;\n    int i;\n\n    for ( ;iLength &gt; 0; iLength--, pbData++) {\n        wData = (UINT16) (((UINT16) *pbData) &lt;&lt; 8);\n        for (i = 0; i &lt; 8; i++, wData &lt;&lt;= 1) {\n            if ((wCRC ^ wData) &amp; 0x8000)\n                wCRC = (UINT16) ((wCRC &lt;&lt; 1) ^ CRC_MASK);\n            else\n                wCRC &lt;&lt;= 1;\n        }\n    }\n    return wCRC;\n}\n</code></pre>\n\n<p>My ported C# code is this:</p>\n\n<pre><code>private static ushort Calc(byte[] data)\n    {\n        ushort wData, wCRC = 0;\n        for (int i = 0; i &lt; data.Length; i++)\n        {\n            wData = Convert.ToUInt16(data[i] &lt;&lt; 8);\n            for (int j = 0; j &lt; 8; j++, wData &lt;&lt;= 1)\n            {\n                var a = (wCRC ^ wData) &amp; 0x8000;\n                if ( a != 0)\n                {\n                    var c = (wCRC &lt;&lt; 1) ^ 0x1021;\n                    wCRC = Convert.ToUInt16(c);\n                }\n                else\n                {\n                    wCRC &lt;&lt;= 1;\n                }\n            }\n        }\n        return wCRC;\n    }\n</code></pre>\n\n<p>The test string is \"OPN\"... It must return a uint which is (ofc) 2 bytes A8 A9 and the #CRC_MASK is the polynomial for that calculation. I did found several examples of CRC16 here and around the web, but none of them achieve this result since this CRC calculation must match the one that the device we are connecting to.</p>\n\n<p>WHere is the mistake? I really appreciate any help.</p>\n\n<p>Thanks! best regards</p>\n\n<p>Gutemberg</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Following the answer from @rcgldr, I put together the following sample:</p>\n\n<pre><code>_serial = new SerialPort(\"COM6\", 19200, Parity.None, 8, StopBits.One);\n        _serial.Open();\n        _serial.Encoding = Encoding.GetEncoding(1252);\n        _serial.DataReceived += Serial_DataReceived;\n        var msg = \"OPN\";\n        var data = Encoding.GetEncoding(1252).GetBytes(msg);\n        var crc = BitConverter.GetBytes(Calc(data));\n        var msb = crc[0].ToString(\"X\");\n        var lsb = crc[1].ToString(\"X\");\n        //The following line must be something like: \\x16OPN\\x17\\xA8\\xA9\n        var cmd = string.Format(@\"{0}{1}{2}\\x{3}\\x{4}\", SYN, msg, ETB, msb, lsb);\n        //var cmd = \"\\x16OPN\\x17\\xA8\\xA9\";\n        _serial.Write(cmd);\n</code></pre>\n\n<p>The value of the <strong>cmd</strong> variable is what I'm trying to send to the device. If you have a look the the commented <strong>cmd</strong> value, this is a working string. The 2 bytes of the CRC16, goes in the last two parameters (msb and lsb). So, in the sample here, msb MUST be \"\\xA8\" and lsb MUST be \"\\xA9\" in order to the command to work(the CRC16 match on the device).</p>\n\n<p>Any clues?</p>\n\n<p>Thanks again.</p>\n\n<p><strong>UPDATE 2</strong>\nFor those who fall in the same case were you need to format the string with \\x this is what I did to get it working:</p>\n\n<pre><code>protected string ToMessage(string data)\n    {\n        var msg = data + ETB;\n        var crc = CRC16.Compute(msg);\n        var fullMsg = string.Format(@\"{0}{1}{2:X}{3:X}\", SYN, msg, crc[0], crc[1]);\n        return fullMsg;\n    }\n</code></pre>\n\n<p>This return to me the full message that I need inclusing the \\x on it. The SYN variable is '\\x16' and ETB is '\\x17'</p>\n\n<p>Thank you all for the help!</p>\n\n<p>Gutemberg</p>\n"}, {"tags": ["c++", "c", "eclipse", "enums", "gnutls"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1439333850, "post_id": 31953314, "comment_id": 51815903, "body": "@avaProphet I do not see the definition of that enumerator GNUTLS_X509_FMT_PEM in the enumeration you showed."}, {"owner": {"reputation": 805, "user_id": 3618509, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2ebf555307f721af722397544de00285?s=128&d=identicon&r=PG&f=1", "display_name": "JavaProphet", "link": "https://stackoverflow.com/users/3618509/javaprophet"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1439333876, "post_id": 31953314, "comment_id": 51815914, "body": "@VladfromMoscow It&#39;s in another enum, should I add that in?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1439334012, "post_id": 31953314, "comment_id": 51815962, "body": "@avaProphet If the enumerations are defined in the same header then the compiler should see them."}, {"owner": {"reputation": 805, "user_id": 3618509, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2ebf555307f721af722397544de00285?s=128&d=identicon&r=PG&f=1", "display_name": "JavaProphet", "link": "https://stackoverflow.com/users/3618509/javaprophet"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1439334208, "post_id": 31953314, "comment_id": 51816020, "body": "@VladfromMoscow I did GCC manually and it did not output an issue. I did a quick google and found <a href=\"http://stackoverflow.com/questions/11866873/eclipse-cdt-c-enum-could-not-be-resolved\" title=\"eclipse cdt c enum could not be resolved\">stackoverflow.com/questions/11866873/&hellip;</a> which solved the issue. Feel free to post that as a solution."}], "answers": [{"tags": [], "owner": {"reputation": 7089, "user_id": 2852165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JwDJG.jpg?s=128&g=1", "display_name": "SHR", "link": "https://stackoverflow.com/users/2852165/shr"}, "is_accepted": true, "score": 0, "last_activity_date": 1439334310, "creation_date": 1439334310, "answer_id": 31953459, "question_id": 31953314, "link": "https://stackoverflow.com/questions/31953314/c-enum-reference-undefined-yet-sitting-in-a-included-header-file/31953459#31953459", "title": "C Enum reference undefined, yet sitting in a included header file?", "body": "<p>how to find? add <code>-I/usr/local/include</code> to your gcc command line, or CFLAGS in the makefile, or look <a href=\"http://help.eclipse.org/mars/index.jsp?topic=%2Forg.eclipse.cdt.doc.user%2Ftasks%2Fcdt_t_proj_paths.htm\" rel=\"nofollow\">here for how to add it in eclipse</a></p>\n\n<p>If the compiler is finding some values while not finding the include, maybe they defined elsewhere. try to redefine them, and look in the error where the other definition is. \nto redefine you can declare as different type, (like: <code>typedef int whatever;</code>, to see if and where <code>whatever</code> declared) since if it is the same typedef it may considered as a forward deceleration.</p>\n"}], "owner": {"reputation": 805, "user_id": 3618509, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2ebf555307f721af722397544de00285?s=128&d=identicon&r=PG&f=1", "display_name": "JavaProphet", "link": "https://stackoverflow.com/users/3618509/javaprophet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "accepted_answer_id": 31953459, "answer_count": 1, "score": 0, "last_activity_date": 1439334310, "creation_date": 1439333551, "question_id": 31953314, "link": "https://stackoverflow.com/questions/31953314/c-enum-reference-undefined-yet-sitting-in-a-included-header-file", "title": "C Enum reference undefined, yet sitting in a included header file?", "body": "<p>So, I'm playing with GNUTLS, and it has this enum: </p>\n\n<pre><code>typedef enum {\n    GNUTLS_PK_UNKNOWN = 0,\n    GNUTLS_PK_RSA = 1,\n    GNUTLS_PK_DSA = 2,\n    GNUTLS_PK_DH = 3,\n    GNUTLS_PK_EC = 4\n} gnutls_pk_algorithm_t;\n</code></pre>\n\n<p>sitting in it's main header file(gnutls.h, version 3.3.17). I reference it here: </p>\n\n<pre><code>    unsigned int bits = gnutls_sec_param_to_pk_bits(GNUTLS_PK_DH, GNUTLS_SEC_PARAM_LEGACY);\n</code></pre>\n\n<p>(right out of the example). I do have the <code>#include &lt;gnutls/gnutls.h&gt;</code>, and that all seems to reference fine(other enums are fine, except for <code>GNUTLS_X509_FMT_PEM</code>). I read something about the compiler not seeing gnutls.h, and it is in <code>/usr/local/include</code> and not <code>/usr/include</code>, however I do have that in the Includes side thing in Eclipse. If it is a compiler-not-finding-it, why is it finding some values, and how do I make it find it? If not, what is the issue?</p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439332634, "post_id": 31953181, "comment_id": 51815536, "body": "Might want to clarify the reason for &#39;overriding&#39; rather than having an alias... for context that might aid answering the question."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1439333443, "post_id": 31953181, "comment_id": 51815783, "body": "@ChristianStewart: Only as far as it meets the requirement of being a &quot;a <b>practical</b>, answerable problem that is unique to software development&quot;  Purely hypothetical questions can be closed."}, {"owner": {"reputation": 14495, "user_id": 431369, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ac0a17cdc0247f909093802caa4f3bd0?s=128&d=identicon&r=PG", "display_name": "Christian Stewart", "link": "https://stackoverflow.com/users/431369/christian-stewart"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1439333567, "post_id": 31953181, "comment_id": 51815827, "body": "@BenVoigt Well, this is practical... What you&#39;re saying is targeted at questions that are saying things like &quot;how would I make a simple function compile to as large as possible of a binary&quot; or &quot;what would be the best way to build this app&quot;... At least as I interpret it."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1439333790, "post_id": 31953181, "comment_id": 51815883, "body": "Well, this is more practical than some questions, but less than &quot;I want to customize the symbol name because I&#39;m linking with a module that expects a particular name that isn&#39;t a valid C++ identifier&quot; or &quot;I want to customize the symbol name so that my actual function and class names aren&#39;t visible to <code>strings</code> or <code>dumpbin</code> or <code>nm</code>&quot;  In the latter case, removing the name altogether using <code>strip</code> might be a useful additional suggestion."}, {"owner": {"reputation": 14495, "user_id": 431369, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ac0a17cdc0247f909093802caa4f3bd0?s=128&d=identicon&r=PG", "display_name": "Christian Stewart", "link": "https://stackoverflow.com/users/431369/christian-stewart"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1439334909, "post_id": 31953181, "comment_id": 51816229, "body": "@BenVoigt In this case I&#39;m building a shared library and can&#39;t eliminate the symbol altogether. But I&#39;d like to change the names a bit so that it&#39;s not quite so obvious what they do."}], "answers": [{"comments": [{"owner": {"reputation": 14495, "user_id": 431369, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ac0a17cdc0247f909093802caa4f3bd0?s=128&d=identicon&r=PG", "display_name": "Christian Stewart", "link": "https://stackoverflow.com/users/431369/christian-stewart"}, "edited": false, "score": 0, "creation_date": 1439333204, "post_id": 31953254, "comment_id": 51815717, "body": "What about for classes?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 14495, "user_id": 431369, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ac0a17cdc0247f909093802caa4f3bd0?s=128&d=identicon&r=PG", "display_name": "Christian Stewart", "link": "https://stackoverflow.com/users/431369/christian-stewart"}, "edited": false, "score": 1, "creation_date": 1439333288, "post_id": 31953254, "comment_id": 51815743, "body": "Classes don&#39;t exist at link time."}, {"owner": {"reputation": 14495, "user_id": 431369, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ac0a17cdc0247f909093802caa4f3bd0?s=128&d=identicon&r=PG", "display_name": "Christian Stewart", "link": "https://stackoverflow.com/users/431369/christian-stewart"}, "edited": false, "score": 0, "creation_date": 1439333372, "post_id": 31953254, "comment_id": 51815765, "body": "That makes sense, thanks. So you would change the constructor asm then."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1439333122, "creation_date": 1439333122, "answer_id": 31953254, "question_id": 31953181, "link": "https://stackoverflow.com/questions/31953181/customizing-overriding-symbol-names-at-compile-time/31953254#31953254", "title": "Customizing/overriding symbol names at compile time", "body": "<p>Yes, gcc supports this with the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Asm-Labels.html\" rel=\"nofollow\"><code>__asm__</code> keyword</a>:</p>\n\n<pre><code>void name1() __asm__(\"name2\");\n</code></pre>\n"}], "owner": {"reputation": 14495, "user_id": 431369, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ac0a17cdc0247f909093802caa4f3bd0?s=128&d=identicon&r=PG", "display_name": "Christian Stewart", "link": "https://stackoverflow.com/users/431369/christian-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 31953254, "answer_count": 1, "score": 2, "last_activity_date": 1439333122, "creation_date": 1439332588, "question_id": 31953181, "link": "https://stackoverflow.com/questions/31953181/customizing-overriding-symbol-names-at-compile-time", "title": "Customizing/overriding symbol names at compile time", "body": "<p>I'm interested in overriding compiler symbol names, generally automatically generated using mangled strings like this:</p>\n\n<p><code>modules::ModuleAPI::ModuleAPI()</code> becomes <code>_ZN7modules9ModuleAPIC2Ev</code></p>\n\n<p>I know there's an alias attribute:</p>\n\n<p><code>\nvoid name1() __attribute__((alias (\"name2\")));\n</code></p>\n\n<p>I'd prefer to do the same, except instead of aliasing, overriding it altogether.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["c", "error-handling", "openssl"], "comments": [{"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439338457, "post_id": 31952519, "comment_id": 51817202, "body": "At a glance there are some files with the error codes and strings, and then the keys they are given would be referenced in the implementations of the API functions. You&#39;re going to have to do some legwork, the error codes reported with <code>ERR_error_string()</code> don&#39;t seem to be listed in the official docs, although they seem to specify when to check for a code."}, {"owner": {"reputation": 1554, "user_id": 4499919, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n2u5L.jpg?s=128&g=1", "display_name": "udit043", "link": "https://stackoverflow.com/users/4499919/udit043"}, "edited": false, "score": 0, "creation_date": 1464717452, "post_id": 31952519, "comment_id": 62593621, "body": "@SkypeMeSM did you get the list ? I also want the list."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7475152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e59c5fe6ea8cae4f7c9c3800235a402?s=128&d=identicon&r=PG&f=1", "display_name": "Janosch", "link": "https://stackoverflow.com/users/7475152/janosch"}, "is_accepted": false, "score": -2, "last_activity_date": 1485454209, "creation_date": 1485454209, "answer_id": 41880134, "question_id": 31952519, "link": "https://stackoverflow.com/questions/31952519/how-to-get-a-list-of-all-openssl-or-libcrypto-error-codes/41880134#41880134", "title": "How to get a list of all openssl or libcrypto error codes", "body": "<p>Perhaps you were searching for this? <a href=\"https://github.com/openssl/openssl/blob/master/crypto/err/openssl.ec\" rel=\"nofollow noreferrer\">openssl.ec</a>\nIt seems like the error codes are generated by util/mkerr.pl</p>\n"}], "owner": {"reputation": 2858, "user_id": 439888, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da051abac41879aed4060d544d37fd6f?s=128&d=identicon&r=PG", "display_name": "SkypeMeSM", "link": "https://stackoverflow.com/users/439888/skypemesm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4945, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1485454209, "creation_date": 1439329596, "last_edit_date": 1439333406, "question_id": 31952519, "link": "https://stackoverflow.com/questions/31952519/how-to-get-a-list-of-all-openssl-or-libcrypto-error-codes", "title": "How to get a list of all openssl or libcrypto error codes", "body": "<p>How can I get a list of all the Error Codes and Strings for LibCrypto or OpenSSL API that the ERR_ APIs from OpenSSL use (for e.x. <a href=\"https://www.openssl.org/docs/crypto/ERR_error_string.html\" rel=\"nofollow\">ERR_error_string</a>)? Digging through the source code of libcrypto did not get me anywhere, and neither did any of my web searches. </p>\n\n<p>My end goal is to write tests corresponding to failure scenarios outlined in the error cases.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1439328939, "post_id": 31952342, "comment_id": 51814085, "body": "Since <code>str</code> is recurringly (re-)injected the numbers will be concatenated in the result."}], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 3581442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c7a638579046483e2851fffd8dc49355?s=128&d=identicon&r=PG&f=1", "display_name": "Doan", "link": "https://stackoverflow.com/users/3581442/doan"}, "edited": false, "score": 0, "creation_date": 1439377274, "post_id": 31952580, "comment_id": 51833858, "body": "at me it works, but i didn&#39;t unterstand it, when i swa this code ;)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 164, "user_id": 3581442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c7a638579046483e2851fffd8dc49355?s=128&d=identicon&r=PG&f=1", "display_name": "Doan", "link": "https://stackoverflow.com/users/3581442/doan"}, "edited": false, "score": 1, "creation_date": 1439385980, "post_id": 31952580, "comment_id": 51840281, "body": "@Doan Code prints the number into <code>p</code>.  <code>n</code> is the number of characters printed.  So <code>p += n;</code> updated <code>p</code> to the end of the string."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1439331195, "last_edit_date": 1439331195, "creation_date": 1439329847, "answer_id": 31952580, "question_id": 31952342, "link": "https://stackoverflow.com/questions/31952342/usage-of-sprintf-with-format/31952580#31952580", "title": "Usage of sprintf with Format", "body": "<p><code>sprintf(str, \"%s%.3f;\", str, averrage[i]);</code> is <em>undefined behavior</em>.</p>\n\n<p>With <code>sprintf()</code>, attempting to read and write to the same pointer <code>str</code> makes for bad code.</p>\n\n<blockquote>\n  <p>... If copying takes place between objects that overlap, the behavior is undefined.<br>\n  C11dr \u00a77.21.6.6 2</p>\n</blockquote>\n\n<hr>\n\n<p>Sample idea to concatenate follows.</p>\n\n<pre><code>char str[200];\nstr[0] = '\\0';\nchar *p = str;\ndouble averrage[NUMBER_INPUTS];\nfor (int i = 0; i &lt; NUMBER_INPUTS; i++) {\n   int n = sprintf(p, \"%.3f;\", averrage[i]);\n   if (n &lt; 0) break;\n   p += n;\n}\nputs(str);\n</code></pre>\n\n<p>Additional code is needed to prevent <code>str</code> overrun.  Consider <code>snprintf()</code>.</p>\n"}], "owner": {"reputation": 164, "user_id": 3581442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c7a638579046483e2851fffd8dc49355?s=128&d=identicon&r=PG&f=1", "display_name": "Doan", "link": "https://stackoverflow.com/users/3581442/doan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 31952580, "answer_count": 1, "score": -2, "last_activity_date": 1439375674, "creation_date": 1439328723, "last_edit_date": 1439328964, "question_id": 31952342, "link": "https://stackoverflow.com/questions/31952342/usage-of-sprintf-with-format", "title": "Usage of sprintf with Format", "body": "<p>Given is the following code</p>\n\n<pre><code>char str[200];\nstr[0] = '\\0';\ndouble averrage[NUMBER_INPUTS];\nfor (int i = 0; i &lt; NUMBER_INPUTS; i++) {\n   ...\n\n        sprintf(str, \"%s%.3f;\", str, averrage[i]);\n}\n</code></pre>\n\n<p>I am trying to understand sprintf, but I cant. Specialy because of the variable <code>str</code>.</p>\n\n<p>I hope anybody can helps me, to understand.</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439329142, "post_id": 31952290, "comment_id": 51814172, "body": "Try <code>printf(&quot;%c&quot;, 1[&quot;Hello&quot;])</code>. You might be surprised. The swap <code>1</code> and the string literal and try again. Note: That is just to make you think - do not use this in your code. You will find the answer here already, so please do not add a new one."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439331597, "post_id": 31952290, "comment_id": 51815190, "body": "in C, an array degrades to the address of the array.   In the statement: &#39;char* s = &quot;my String&quot;;&#39; the char string &#39;my String&#39; +&#39;\\0&#39; is placed in a readonly memory segment.  and &#39;s&#39; receives a pointer to that char string (I.E. the address of that string)  The char string cannot be modified, but can be read."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1439331723, "post_id": 31952290, "comment_id": 51815224, "body": "1) Could use <code>char s[] = &quot;my string&quot;;</code> and <code>s</code> is right-sized to 10.  2) <code>&amp;s</code> is the address of a pointer to an array of 10 <code>char</code> - not the same type as <code>char *</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1439331943, "post_id": 31952290, "comment_id": 51815297, "body": "@user3629249 &quot;placed in a readonly memory segment&quot; and &quot;The char string cannot be modified,&quot; are not specified by C.  Attempting to modify it is undefined behavior. We agree code should not attempt/expect modifying to work."}, {"owner": {"reputation": 1679, "user_id": 703128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b28d09a40a5c6b6482f20ff0681e00b?s=128&d=identicon&r=PG", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/703128/leonardo"}, "edited": false, "score": 0, "creation_date": 1439363501, "post_id": 31952290, "comment_id": 51824839, "body": "For 3), <code>s</code> is a variable, as such it needs memory (as any normal <code>int</code> would). It happens that it points to an address, but thats just a detail. No additional space is required, if you lose that address, its lost for good, no one keeps track of it. Then, <code>s</code> is a variable (that consumes 4 bytes), that points to a piece of memory that has 10 bytes. Hope this clarifies a bit."}], "answers": [{"tags": [], "owner": {"reputation": 399, "user_id": 4889312, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1a3fee35905597f15f58493d5c22d6ba?s=128&d=identicon&r=PG", "display_name": "Matt Olson", "link": "https://stackoverflow.com/users/4889312/matt-olson"}, "is_accepted": false, "score": 3, "last_activity_date": 1439328667, "creation_date": 1439328667, "answer_id": 31952322, "question_id": 31952290, "link": "https://stackoverflow.com/questions/31952290/legitimate-usage-of-char/31952322#31952322", "title": "Legitimate usage of char*", "body": "<p><code>char* s = \"my String\";</code> declares a string constant and a pointer to it.  It's no less legitimate than using a bare string in, say, a <code>printf</code> call.  Note, however, that because you have a pointer to your string you might be tempted to try to modify it -- <em>that</em> is undefined behaviour.</p>\n"}, {"comments": [{"owner": {"reputation": 4294, "user_id": 2738262, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ead9263d3f0f0cc74f54d5d9fdbaa4cd?s=128&d=identicon&r=PG", "display_name": "Damian Yerrick", "link": "https://stackoverflow.com/users/2738262/damian-yerrick"}, "edited": false, "score": 2, "creation_date": 1439330142, "post_id": 31952325, "comment_id": 51814645, "body": "Would <code>const char *s = &quot;my String&quot;</code> help avoid the potential for accidental UB?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 4294, "user_id": 2738262, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ead9263d3f0f0cc74f54d5d9fdbaa4cd?s=128&d=identicon&r=PG", "display_name": "Damian Yerrick", "link": "https://stackoverflow.com/users/2738262/damian-yerrick"}, "edited": false, "score": 0, "creation_date": 1439330223, "post_id": 31952325, "comment_id": 51814679, "body": "@tepples Yes, in some cases, it can help. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1439329327, "last_edit_date": 1439329327, "creation_date": 1439328672, "answer_id": 31952325, "question_id": 31952290, "link": "https://stackoverflow.com/questions/31952290/legitimate-usage-of-char/31952325#31952325", "title": "Legitimate usage of char*", "body": "<p>In your case</p>\n\n<pre><code> char* s = \"my String\"\n</code></pre>\n\n<p>is legal and valid, because a representation like <code>\"my String\"</code> is called a string literal and the representation <em>essentially</em> gives the address of the first element in the string, which is again a pointer to a <code>char</code>. So, we can store that in another pointer to a <code>char</code>.</p>\n\n<p>The usability, is <em>mostly</em> same with <code>char s[10] = \"my string\";</code>, except the fact that in former case, <code>s</code> pointing to a string literal, you cannot (<em>even attempt to</em>) modify it. Trying so will invoke undefined behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1439329532, "post_id": 31952400, "comment_id": 51814354, "body": "The first 3 bullets most definitely take place <b>before</b> runtime, i.e., during compilation. The 4th bullet should also take place during compilation, assuming a decent compiler is in use (since the address of the constant string is well known at this point). Perhaps you meant to say &quot;here&#39;s what your <b>compiler</b> will do at run time&quot; (its own runtime)..."}, {"owner": {"reputation": 3036, "user_id": 3466415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610a8a95f861678ab9f72ee483d1c1a7?s=128&d=identicon&r=PG&f=1", "display_name": "David K", "link": "https://stackoverflow.com/users/3466415/david-k"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1439329744, "post_id": 31952400, "comment_id": 51814450, "body": "@barakmanos I had in mind that the locations in (virtual) memory actually get &quot;allocated&quot; when the program is loaded. However, a lot of what happens in the first three bullets <i>is</i> decided at compile time, whereas corresponding actions for the second example might only be decided when the program actually runs."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1439330155, "post_id": 31952400, "comment_id": 51814650, "body": "<code>locations in (virtual) memory actually get &quot;allocated&quot; when the program is loaded</code> - that&#39;s an OS issue, which is unrelated to (and independent of) the program. In other words, the program &quot;knows&quot; nothing about it. As far as it &quot;concerns&quot;, that string is allocated at the RO data section of the executable image. Of course, the actual (physical) address of that string maybe different every time the OS creates a process and loads it into memory. But it&#39;s like saying that the program may be running at a different place around the world, depending on where your computer is located."}, {"owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "edited": false, "score": 0, "creation_date": 1439330282, "post_id": 31952400, "comment_id": 51814714, "body": "More similar to <b><code>const</code></b> <code>char s_buffer[10] = &quot;my String&quot;;</code> \u2026"}, {"owner": {"reputation": 3036, "user_id": 3466415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610a8a95f861678ab9f72ee483d1c1a7?s=128&d=identicon&r=PG&f=1", "display_name": "David K", "link": "https://stackoverflow.com/users/3466415/david-k"}, "reply_to_user": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "edited": false, "score": 0, "creation_date": 1439331565, "post_id": 31952400, "comment_id": 51815182, "body": "@Potatoswatter Thanks, I had momentarily considered the <code>const</code>, but omitted it for some reason. It is a better example as a <code>const</code> string (with corresponding changes to what the programmer can or can&#39;t do)."}, {"owner": {"reputation": 3036, "user_id": 3466415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610a8a95f861678ab9f72ee483d1c1a7?s=128&d=identicon&r=PG&f=1", "display_name": "David K", "link": "https://stackoverflow.com/users/3466415/david-k"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1439331872, "post_id": 31952400, "comment_id": 51815278, "body": "@barakmanos OK, I give up. You&#39;re right, of course. The program could be compiled into a FPGA for all we know. So I removed &quot;at run time&quot; from the answer. The rest of this argument seems to be about concerns that (I think) are beyond anything the OP would want to know at this time"}], "tags": [], "owner": {"reputation": 3036, "user_id": 3466415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610a8a95f861678ab9f72ee483d1c1a7?s=128&d=identicon&r=PG&f=1", "display_name": "David K", "link": "https://stackoverflow.com/users/3466415/david-k"}, "is_accepted": false, "score": 5, "last_activity_date": 1439331337, "last_edit_date": 1439331337, "creation_date": 1439329045, "answer_id": 31952400, "question_id": 31952290, "link": "https://stackoverflow.com/questions/31952290/legitimate-usage-of-char/31952400#31952400", "title": "Legitimate usage of char*", "body": "<p>If you have this line of code in your source file,</p>\n\n<pre><code>char* s = \"my String\";\n</code></pre>\n\n<p>here's what your program will do:</p>\n\n<ol>\n<li>It will reserve 10 bytes of memory somewhere.</li>\n<li>It will put the characters of \"my String\" (including terminating null) in those ten bytes of memory.</li>\n<li>It will declare <code>s</code> as a <code>char*</code>.</li>\n<li>It will set the value of the pointer, <code>s</code>, to the address of the first byte of those 10 bytes of memory, where the character <code>'m'</code> resides.</li>\n</ol>\n\n<p>So it really is not very much different from this:</p>\n\n<pre><code>const char s_buffer[10] = \"my String\";\nchar* s = &amp;s_buffer[0];\n</code></pre>\n\n<p>One difference that you might notice is that in the first case, there is no symbol <code>s_buffer</code> that you can make use of separately from <code>s</code>. In the first example, if the very next line is <code>s = \"another string\"</code> then (at least in principle) you lose the ability to read the particular 10 bytes that <code>s</code> intially pointed to.</p>\n"}], "owner": {"reputation": 11, "user_id": 5194214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/205af11c3da9a4e7e4610db1eecf20a9?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Y.", "link": "https://stackoverflow.com/users/5194214/sam-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1439865790, "creation_date": 1439328516, "last_edit_date": 1439865790, "question_id": 31952290, "link": "https://stackoverflow.com/questions/31952290/legitimate-usage-of-char", "title": "Legitimate usage of char*", "body": "<p>I am having a little bit of trouble understanding the use of pointers.  Specifically, I am confused about the following line of code:</p>\n\n<pre><code>char* s = \"my String\";\n</code></pre>\n\n<p><strong>I have two questions:</strong></p>\n\n<ol>\n<li><p>Is this code even legitimate?  From watching some of the Harvard CS 50 videos, I would think that it is.</p></li>\n<li><p>If the answer to (1) is yes, then I am quite confused.  I thought the meaning of the statement: \"char* s\" is that you want to create a new variable called s that is of type char*.  This means that s is a pointer to some char variable (and at this point, we don't even know what this char variable is).  If this is the case, then the right hand side of the above line of code should be an address in memory, and not a string.</p></li>\n</ol>\n\n<p>I would be more comfortable with something like:</p>\n\n<pre><code>char s[10] = \"my string\"; //10 because including extra space for null 0  \nchar* AddressOfs = &amp;s;\n</code></pre>\n\n<p><strong>EDIT/UPDATE</strong>: Thanks for all the great answers.  David K's answer has made things much clearer (I like the step-by-step structure), but I am still a bit confused in some respects.  </p>\n\n<ol start=\"3\">\n<li><p>In step 1 of David K's answer, he said that </p>\n\n<blockquote>\n  <p>It will reserve 10 bytes of memory somewhere.</p>\n</blockquote></li>\n</ol>\n\n<p>But it has to reserve more than just 10 bytes, right? We need 10 bytes for the contents of the string <em>plus</em> 4 bytes for the contents of the address in memory.  </p>\n\n<ol start=\"4\">\n<li><p>Do you agree with the following: So if we stick with the \"variables-as-containers\" analogy, the line </p>\n\n<pre><code>char* s = \"my string\";\n</code></pre></li>\n</ol>\n\n<p>reserves 14 bytes of storage (10 for the contents of the string and 4 for the address of the contents of the string), but there is only one \"container\".  This container is named s and holds the 4 bytes.  The 10 bytes that hold the contents of the string are \"container-less\", i.e. these 10 bytes are allocated somewhere in memory, but there is no label that we can associate with these 10 bytes.  (I'm not saying we have no way of accessing these 10 bytes.  I'm just saying that there is no formal variable label that is being applied to these 10 bytes.)</p>\n"}, {"tags": ["c", "arrays", "struct", "malloc", "realloc"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439328749, "post_id": 31952283, "comment_id": 51813990, "body": "<code>memcpy(&amp;p, ptr, sizeof(p));</code> Why not just <code>p = ptr;</code>? There is no aliasing problem; even more as you instantly overwrite <code>p</code> anyway. That is not the only &quot;strange&quot; code here. You seem to have fundamental missunderstanding how pointer work. - No offence! (Truely none)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1439329109, "post_id": 31952283, "comment_id": 51814153, "body": "<code>p = realloc(p, size)</code>...bad, very bad. Horror starts when <code>realloc()</code> fails,"}, {"owner": {"reputation": 626, "user_id": 4951552, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L3CRU.jpg?s=128&g=1", "display_name": "yguw", "link": "https://stackoverflow.com/users/4951552/yguw"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1439329309, "post_id": 31952283, "comment_id": 51814257, "body": "@Sourav Ghosh: these methods are copied from Linux file system. I am making a small change in that and it isn&#39;t working. So, I tried to recreate the same scenario in a test program. code is failing when I am trying to do printf at the end."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1439329470, "post_id": 31952283, "comment_id": 51814328, "body": "@yguw Point 1. The above comment is a <i>comment</i>, not an answer, so just treat it like a suggestion. Point 2. Irrespective of the occurrence of the code, its a bad code. You may want to read up about the failure scenario of <code>realloc()</code> in detail to understand more."}, {"owner": {"reputation": 626, "user_id": 4951552, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L3CRU.jpg?s=128&g=1", "display_name": "yguw", "link": "https://stackoverflow.com/users/4951552/yguw"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439329497, "post_id": 31952283, "comment_id": 51814340, "body": "@Olaf - These methods are copied from a file system code and I am trying to test few things by making some changes and unfortunately these methods you have pointed out are in the code from a long time."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439329682, "post_id": 31952283, "comment_id": 51814422, "body": "So turn of your own reason and think for yourself. Not all code you find is good code. Fact is you have memory leaking like a hairtrap."}], "owner": {"reputation": 626, "user_id": 4951552, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L3CRU.jpg?s=128&g=1", "display_name": "yguw", "link": "https://stackoverflow.com/users/4951552/yguw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439329684, "creation_date": 1439328497, "last_edit_date": 1439329684, "question_id": 31952283, "link": "https://stackoverflow.com/questions/31952283/how-to-resize-a-structure-array-within-a-structure", "title": "How to resize a structure array within a structure?", "body": "<p>I have resized the array and when I am trying to print the resized content it throws segmentation fault after printing 5 elements. </p>\n\n<p><em>I think I am missing initialization of array in the newly added region and that's why its throwing error as it's not able to find the next index.</em> </p>\n\n<p>But how should I correct it? </p>\n\n<p><strong><em>My Code:</em></strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nstruct new{\n  int x;\n  int y;\n};\n\nstruct score{\n  int score;\n  struct new* sub_super[];\n};\n\ntypedef struct score *ext2_filsys;\n\nint ext2fs_get_mem(unsigned long size, void *ptr)\n{\n  void *pp;\n  pp = malloc(size);\n\n  if(!pp)\n    return -1;\n  memcpy(ptr, &amp;pp, sizeof(pp));\n  return 0;\n}\n\n/*\n * Free memory\n */\nint ext2fs_free_mem(void *ptr)\n{\n  void *p;\n\n  memcpy(&amp;p, ptr, sizeof(p));\n  free(p);\n  p = 0;\n  memcpy(ptr, &amp;p, sizeof(p));\n  return 0;\n}\n\nint ext2fs_resize_mem(unsigned long old_size,\n                                     unsigned long size, void *ptr)\n{\n  void *p;\n\n  /* Use \"memcpy\" for pointer assignments here to avoid problems\n   * with C99 strict type aliasing rules. */\n  memcpy(&amp;p, ptr, sizeof(p));\n  p = realloc(p, size);\n  if (!p)\n    return -1;\n  memcpy(ptr, &amp;p, sizeof(p));\n  return 0;\n}\nint main()\n{\n  ext2_filsys fs;\n  int retval = 0;\n  retval = ext2fs_get_mem((sizeof(struct score) + 5 * sizeof(struct new)), &amp;fs);\n  if(retval)\n    return retval;\n\n  memset(fs, 0, (sizeof(struct score) + 5 * sizeof(struct new)));\n\n  int i;\n\n  for(i=0; i&lt;5; i++) {\n    retval = ext2fs_get_mem(sizeof(struct new), &amp;fs-&gt;sub_super[i]);\n    fs-&gt;sub_super[i]-&gt;x = i;\n    fs-&gt;sub_super[i]-&gt;y = 15-i;\n  }\n\n  for(i=0; i&lt;5; i++)\n    printf(\"Data at %d = %d and address = %p\\n\", i, fs-&gt;sub_super[i]-&gt;x, fs-&gt;sub_super[i]);\n\n  ext2_filsys tempfs;\n\n\n  retval = ext2fs_get_mem(sizeof(struct score), &amp;tempfs);\n  if(retval)\n    return retval;\n\n  *tempfs = *fs;\n\n  retval = ext2fs_get_mem((5 * sizeof(struct new)), &amp;tempfs-&gt;sub_super);\n  printf(\"Pointer of tempfs-&gt;sub_super = %p\\n\", tempfs-&gt;sub_super);\n\n  for(i=0; i&lt;5; i++) {\n    retval = ext2fs_get_mem(sizeof(struct new), &amp;tempfs-&gt;sub_super[i]);\n    if(retval)\n      return retval;\n    memcpy(tempfs-&gt;sub_super[i], fs-&gt;sub_super[i], sizeof(struct new));\n  }\n\n  for(i=0; i&lt;5; i++)\n    printf(\"Data at %d = %d and address = %p\\n\", i, tempfs-&gt;sub_super[i]-&gt;x, tempfs-&gt;sub_super[i]);\n\n  printf(\"================================================================\\n\");\n  retval = ext2fs_resize_mem(5 * sizeof(struct new), 10 * sizeof(struct new), &amp;tempfs-&gt;sub_super);\n  if(retval)\n    return retval;\n\n\n  for(i=0; i&lt;10; i++)\n    printf(\"Data at %d = %d and address = %p\\n\", i, tempfs-&gt;sub_super[i]-&gt;x, tempfs-&gt;sub_super[i]);\n\n return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 297030, "user_id": 1226963, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yjY1E.png?s=128&g=1", "display_name": "rmaddy", "link": "https://stackoverflow.com/users/1226963/rmaddy"}, "edited": false, "score": 1, "creation_date": 1439335110, "post_id": 31952007, "comment_id": 51816309, "body": "FYI - this issue has nothing at all to do with Xcode. It&#39;s a &quot;feature&quot; of the C language."}], "answers": [{"tags": [], "owner": {"reputation": 3258, "user_id": 1389596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e0170920998e386d56d20ddfce18a9?s=128&d=identicon&r=PG", "display_name": "Kevin Seifert", "link": "https://stackoverflow.com/users/1389596/kevin-seifert"}, "is_accepted": false, "score": 1, "last_activity_date": 1439327553, "creation_date": 1439327553, "answer_id": 31952036, "question_id": 31952007, "link": "https://stackoverflow.com/questions/31952007/why-am-i-not-experiencing-an-error-when-working-with-strings-in-xcode/31952036#31952036", "title": "Why am I not experiencing an error when working with strings in Xcode?", "body": "<p>C will happily clobber any memory you hand it.  AKA, a buffer overflow. :-)</p>\n"}, {"comments": [{"owner": {"reputation": 8256, "user_id": 1135714, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/JGgeJ.jpg?s=128&g=1", "display_name": "Cesare", "link": "https://stackoverflow.com/users/1135714/cesare"}, "edited": false, "score": 0, "creation_date": 1439327649, "post_id": 31952048, "comment_id": 51813459, "body": "Thanks! Then why isn&#39;t the compiler complaining instead of printing out the entire string? This sounds very weird."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 8256, "user_id": 1135714, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/JGgeJ.jpg?s=128&g=1", "display_name": "Cesare", "link": "https://stackoverflow.com/users/1135714/cesare"}, "edited": false, "score": 0, "creation_date": 1439327721, "post_id": 31952048, "comment_id": 51813504, "body": "@CeceXX The string is inputted by the user at runtime, so the compiler knows nothing about it.  It also doesn&#39;t keep track of how big an array is.  You&#39;re expected to handle that yourself."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 8256, "user_id": 1135714, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/JGgeJ.jpg?s=128&g=1", "display_name": "Cesare", "link": "https://stackoverflow.com/users/1135714/cesare"}, "edited": false, "score": 0, "creation_date": 1439327729, "post_id": 31952048, "comment_id": 51813509, "body": "@CeceXX compiler has no idea about the allocated memory at the supplied pointer and no control over the runtime input, so it has no reason to complain. It is the duty of programmer to ensure buffer overflow does not happen."}, {"owner": {"reputation": 8256, "user_id": 1135714, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/JGgeJ.jpg?s=128&g=1", "display_name": "Cesare", "link": "https://stackoverflow.com/users/1135714/cesare"}, "edited": false, "score": 0, "creation_date": 1439328067, "post_id": 31952048, "comment_id": 51813654, "body": "Thank you so much guys! It is much appreciated :-) @Sourav I&#39;m going to accept your answer whenever it lets me. Thanks for editing my question also!"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1439328199, "last_edit_date": 1439328199, "creation_date": 1439327576, "answer_id": 31952048, "question_id": 31952007, "link": "https://stackoverflow.com/questions/31952007/why-am-i-not-experiencing-an-error-when-working-with-strings-in-xcode/31952048#31952048", "title": "Why am I not experiencing an error when working with strings in Xcode?", "body": "<p>In your case, as you've defined <code>myString</code> to have 5 <code>char</code>s, any input running longer than 4 chars (consider terminating null also as the 5th) will actually cause out of bound memory access, which produces <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>. The result can be anything, inducing working <em>normally</em>, as if you had allocated <em>enough</em> memory.</p>\n\n<p>You should be limiting your input using</p>\n\n<pre><code> scanf(\"%4s\", myString);\n</code></pre>\n\n<p>and likewise.</p>\n\n<p>Also, as a note, the recommended signature for <code>main()</code> is <code>int main(int argc, char *argv[])</code> or at least, <code>int main(void)</code>.</p>\n"}], "owner": {"reputation": 8256, "user_id": 1135714, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/JGgeJ.jpg?s=128&g=1", "display_name": "Cesare", "link": "https://stackoverflow.com/users/1135714/cesare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 31952048, "answer_count": 2, "score": 1, "last_activity_date": 1460600805, "creation_date": 1439327438, "last_edit_date": 1460600805, "question_id": 31952007, "link": "https://stackoverflow.com/questions/31952007/why-am-i-not-experiencing-an-error-when-working-with-strings-in-xcode", "title": "Why am I not experiencing an error when working with strings in Xcode?", "body": "<p>In Xcode I declared a string called <code>myString</code> with 5 spaces in memory.</p>\n\n<pre><code>int main() {\n\n    char myString[5];\n\n    printf(\"Insert a string: \");\n    scanf(\"%s\", myString);\n    printf(\"Your string is %s.\", myString);\n\n    return 0;\n}\n</code></pre>\n\n<p>The problem is that whenever I type a word longer than 4 characters the console still prints out with <code>printf()</code> my string instead of complaining about it.</p>\n\n<p>What is this due to?</p>\n"}, {"tags": ["c", "printf", "undefined-behavior"], "comments": [{"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 0, "creation_date": 1439328507, "post_id": 31951796, "comment_id": 51813870, "body": "You might not get a compiler error, but I would almost guarantee you get a compiler <i>warning</i>.  Get in the habit of paying attention to those if you expect to do much C programming."}], "answers": [{"comments": [{"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 0, "creation_date": 1439328468, "post_id": 31951831, "comment_id": 51813857, "body": "This is 100% correct, I think this is a good case to illustrate to a new programmer why it&#39;s absolutely vital in C to read compiler warnings and often helpful to crank up the verbosity, e.g. with GCC <code>-Wall</code>.  Any decent modern compiler will warn about this particular problem by default."}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439329437, "post_id": 31951831, "comment_id": 51814312, "body": "Yeah yeah, this is correct and all, but I dislike the idea of dismissing on account of undefined behavior. Isn&#39;t it more interesting to know what <i>is</i> happening, as illustrated in one of the other answers?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439329604, "post_id": 31951831, "comment_id": 51814385, "body": "@Purag I understand, but what <i>is</i> happening is <b>not guaranteed</b> in general, and heavily dependent on platform and not at all covered by the <code>C</code> standard."}, {"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 0, "creation_date": 1439329703, "post_id": 31951831, "comment_id": 51814433, "body": "I think there could be a great answer here that discusses why there&#39;s a random number there (it has to come from somewhere!) <i>and</i> discourages using <code>printf</code> this way due to undefined behavior (and the possibility of crashing your program if you&#39;re not so lucky...)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1439327638, "last_edit_date": 1439327638, "creation_date": 1439326767, "answer_id": 31951831, "question_id": 31951796, "link": "https://stackoverflow.com/questions/31951796/why-random-integer-is-outputed-when-more-conversions-than-data-arguments-err/31951831#31951831", "title": "Why random integer is outputed when more &#39;%&#39; conversions than data arguments error occurs in c?", "body": "<p>As per the <code>printf()</code> specification, if there are insufficient number of arguments for the required format specifier, it invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>So, your code</p>\n\n<pre><code>printf(\"I'm %d years old\\n\");\n</code></pre>\n\n<p>which is missing the required argument for <code>%d</code>, invokes UB and not guaranteed to produce any valid result.</p>\n\n<p>Cross reference, <code>C11</code> standard, chapter \u00a77.21.6.1</p>\n\n<blockquote>\n  <p>[..] If there are insufficient arguments for the format, the behavior is\n  undefined. [..]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1439327025, "creation_date": 1439327025, "answer_id": 31951896, "question_id": 31951796, "link": "https://stackoverflow.com/questions/31951796/why-random-integer-is-outputed-when-more-conversions-than-data-arguments-err/31951896#31951896", "title": "Why random integer is outputed when more &#39;%&#39; conversions than data arguments error occurs in c?", "body": "<p>According to the C Standard (7.21.6.1 The fprintf function - the same is valid for printf)</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>...<strong>If there are insufficient arguments for the format, the behavior is undefined.</strong> If the format is exhausted while arguments\n  remain, the excess arguments are evaluated (as always) but are\n  otherwise ignored.</li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 2367424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a303052924a839c88b5edabb7fc3a?s=128&d=identicon&r=PG", "display_name": "ArBel", "link": "https://stackoverflow.com/users/2367424/arbel"}, "is_accepted": false, "score": 1, "last_activity_date": 1439327258, "creation_date": 1439327258, "answer_id": 31951961, "question_id": 31951796, "link": "https://stackoverflow.com/questions/31951796/why-random-integer-is-outputed-when-more-conversions-than-data-arguments-err/31951961#31951961", "title": "Why random integer is outputed when more &#39;%&#39; conversions than data arguments error occurs in c?", "body": "<p>The printf using cdecl, which using stack arguments. If you implied to the function that you are using one argument, it will be pulled out of the runtime stack, and if you didn't put there your number, the place will probably contain some garbage data. So the argument which will be printed is some arbitrary data.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1439490637, "creation_date": 1439490637, "answer_id": 31995859, "question_id": 31951796, "link": "https://stackoverflow.com/questions/31951796/why-random-integer-is-outputed-when-more-conversions-than-data-arguments-err/31995859#31995859", "title": "Why random integer is outputed when more &#39;%&#39; conversions than data arguments error occurs in c?", "body": "<p>With only one exception I know of, the C Standard imposes no requirements with regard to any action which in some plausible implementations might be usefully trapped.  It is not hard to imagine a C compiler passing a variadic function like <code>printf</code> an indication of what arguments it has passed, nor would it be hard to an implementer thinking that it could be useful to have the compiler trigger a trap if code tries to retrieve a variadic parameters of some type when the corresponding argument is some other type or doesn't exist at all.  Because it could be useful to have compilers trap in such cases, and because the behavior of such a trap would be outside the jurisdiction of the Standard, the Standard imposes no requirements about what may or may not happen when a variadic function tries to receive arguments which weren't passed to it.</p>\n\n<p>In practice, rather than letting variadic functions know how many arguments they've received, most compilers simply have conventions which describe a relationship between the location of the non-variadic argument and the locations of subsequent variadic arguments.  The generated code won't know whether a function has received e.g. two arguments of type <code>int</code>, but it will know that each such argument, <em>if it exists</em>, will be stored in a certain place.  On such a compiler, using excess format specifiers will generally result in the generated code looking at the places where additional arguments would have been stored had they existed.  In many cases, this location will have been used for some other purpose and then abandoned, and may hold the last value stored there for that purpose, but there is generally no reason to expect anything in particular about the contents of abandoned memory.</p>\n"}], "owner": {"reputation": 796, "user_id": 3453023, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6ca5e757ad552b723e42c8d1e387499a?s=128&d=identicon&r=PG&f=1", "display_name": "tlaminator", "link": "https://stackoverflow.com/users/3453023/tlaminator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 31951831, "answer_count": 4, "score": 2, "last_activity_date": 1439490637, "creation_date": 1439326670, "last_edit_date": 1439327083, "question_id": 31951796, "link": "https://stackoverflow.com/questions/31951796/why-random-integer-is-outputed-when-more-conversions-than-data-arguments-err", "title": "Why random integer is outputed when more &#39;%&#39; conversions than data arguments error occurs in c?", "body": "<p>I take out the age variable from the <code>printf()</code> call just to see what happens. I then compile it with make. It seems it only throws warning about more % conversions than data arguments and unused age variable but no compile error. I then run the executable file and it does run. Only every time I run it, it returns different random integer. I'm wondering what causes this behavior?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *arg[]) {\n  int age = 10;\n  int height = 72;\n\n  printf(\"I'm %d years old\\n\");\n  printf(\"I'm %d inches tall\\n\", height);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1439330943, "post_id": 31951654, "comment_id": 51814946, "body": "Neither of those is thread-safe.  The return value of the second variant points to the thread-local storage of the thread that made the call, but there is no guarantee that the pointer won&#39;t be passed to another thread."}, {"owner": {"reputation": 101, "user_id": 2962885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e008aae580aa0104074ac26917e96a4?s=128&d=identicon&r=PG&f=1", "display_name": "user2962885", "link": "https://stackoverflow.com/users/2962885/user2962885"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1439334444, "post_id": 31951654, "comment_id": 51816092, "body": "True. But i just needed it for a debug output. So it works for me. But as you pointed out the return value can&#39;t be used after a subsequent call to the same function. Sending it to another thread per se wil work.  =When the address-of operator is applied to a thread-local variable, it is evaluated at run-time and returns the address of the current thread&#39;s instance of that variable. An address so obtained may be used by any thread. = quote from gcc"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1439326273, "creation_date": 1439326273, "answer_id": 31951696, "question_id": 31951654, "link": "https://stackoverflow.com/questions/31951654/can-thread-can-be-used-for-a-local-variable/31951696#31951696", "title": "Can __thread can be used for a local variable", "body": "<p>Yes, this will work, but keep the <code>static</code> specifier.  From the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Thread-Local.html\" rel=\"nofollow\">gcc docs</a>:</p>\n\n<blockquote>\n  <p>The __thread specifier may be used alone, with the extern or static\n  specifiers, but with no other storage class specifier. When used with\n  extern or static, __thread must appear immediately after the other\n  storage class specifier.</p>\n  \n  <p>The __thread specifier may be applied to any global, file-scoped\n  static, function-scoped static, or static data member of a class. It\n  may not be applied to block-scoped automatic or non-static data\n  member.</p>\n</blockquote>\n"}], "owner": {"reputation": 101, "user_id": 2962885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e008aae580aa0104074ac26917e96a4?s=128&d=identicon&r=PG&f=1", "display_name": "user2962885", "link": "https://stackoverflow.com/users/2962885/user2962885"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 31951696, "answer_count": 1, "score": 3, "last_activity_date": 1439579985, "creation_date": 1439326074, "last_edit_date": 1439579985, "question_id": 31951654, "link": "https://stackoverflow.com/questions/31951654/can-thread-can-be-used-for-a-local-variable", "title": "Can __thread can be used for a local variable", "body": "<p>I have a function like this that uses static variable. Now i need to use it in a multi threaded application. </p>\n\n<pre><code>char *\nether_ntoa(const struct ether_addr *n)\n{\n    static char a[18];\n    return (ether_ntoa_r(n, a));\n}\n</code></pre>\n\n<p>Can i use the __thread variable instead?</p>\n\n<pre><code>char *\nether_ntoa(const struct ether_addr *n)\n{\n   __thread char a[18];\n   return (ether_ntoa_r(n, a));\n}\n</code></pre>\n\n<p>I realize  i can add another argument to ether_ntoa function, but was wondering whether this will work as well?</p>\n"}, {"tags": ["c", "casting", "volatile", "misra"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1439323935, "post_id": 31951051, "comment_id": 51811494, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/23746870/casting-the-results-of-a-volatile-expression-to-void\">Casting the results of a volatile expression to void</a>"}, {"owner": {"reputation": 1415, "user_id": 1502121, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/0Lsxb.jpg?s=128&g=1", "display_name": "m4l490n", "link": "https://stackoverflow.com/users/1502121/m4l490n"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439324023, "post_id": 31951051, "comment_id": 51811545, "body": "@Olaf: This is not exactly a duplicate since I&#39;m looking for an alternate way of doing it besides the shown in the referenced thread"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439324094, "post_id": 31951051, "comment_id": 51811585, "body": "Well, I think it is actually a dup. Because you are also asking if that is optimized away. Not sure what you mean with &quot;I&#39;m not able to change ...&quot;. You do not have to change the declarations. The accessed object is basically the same as yours."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439324133, "post_id": 31951051, "comment_id": 51811610, "body": "What do you mean with &quot;alternate way? Alternative to the correct way?"}, {"owner": {"reputation": 1415, "user_id": 1502121, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/0Lsxb.jpg?s=128&g=1", "display_name": "m4l490n", "link": "https://stackoverflow.com/users/1502121/m4l490n"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439324170, "post_id": 31951051, "comment_id": 51811633, "body": "I mean another correct way"}, {"owner": {"reputation": 1415, "user_id": 1502121, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/0Lsxb.jpg?s=128&g=1", "display_name": "m4l490n", "link": "https://stackoverflow.com/users/1502121/m4l490n"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439324204, "post_id": 31951051, "comment_id": 51811646, "body": "Because with the one shown I still getting a MISRA C 2012 error regarding dead code"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439324347, "post_id": 31951051, "comment_id": 51811735, "body": "The same crap checker you had trouble multiple times already? Please provide the error message. And already write an email to the vendor."}, {"owner": {"reputation": 1415, "user_id": 1502121, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/0Lsxb.jpg?s=128&g=1", "display_name": "m4l490n", "link": "https://stackoverflow.com/users/1502121/m4l490n"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439324527, "post_id": 31951051, "comment_id": 51811835, "body": "@Olaf: yeah the same one. I&#39;ll write to the vendor definitely But it wouldn&#39;t hurt to know of an alternative method if anyone knows one."}, {"owner": {"reputation": 9309, "user_id": 2963099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TtYW1.gif?s=128&g=1", "display_name": "Glenn Teitelbaum", "link": "https://stackoverflow.com/users/2963099/glenn-teitelbaum"}, "edited": false, "score": 1, "creation_date": 1439324733, "post_id": 31951051, "comment_id": 51811939, "body": "This question should be, &quot;Why is the MISRA rule checker flagging this as dead code?&quot;.  That makes it clearer and avoids it being a dup"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439326127, "post_id": 31951051, "comment_id": 51812662, "body": "<code>typedef volatile struct _Ifx_SCU</code> declared this struct to be volatile, but what about the fields inside? are they lifted to volatile too? i am not sure. if not, that&#39;s a good reason to be dead code. things involving <code>volatile</code> should not be dead otherwise. personally, i used system specified all registers as volatile <code>uchar</code>, <code>uint</code> etc but never try such definition."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1439328178, "post_id": 31951051, "comment_id": 51813707, "body": "@HuStmpHrrr: The fields belong to the <code>struct</code>. So, If the whole struct is <code>volatile</code>, the fields are too. Note that this is the same for all qualifiers and storage class specifiers. Why do you think it would be different from the <code>const</code> <i>qualifier</i>?"}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1439333071, "post_id": 31951051, "comment_id": 51815680, "body": "&quot;Why is the MISRA rule checker flagging this as dead code?&quot;  Because as Olaf said this tool has some serious problems.  In fact the dead code rule (MISRA-C:2012 Rule 2.2) explicitly says: &quot;Exception: A cast to void is assumed to indicate a value that is intentionally not being used. The cast is therefore not dead code itself. It is treated as using its operand which is therefore also not dead code.&quot;"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439335117, "post_id": 31951051, "comment_id": 51816311, "body": "@Olaf ok. sounds good."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439375670, "post_id": 31951051, "comment_id": 51832798, "body": "This is a quite common compiler/analyser problem. Possible work-around which means the same thing: <code>volatile uint32_t dummy = MODULE_SCU.reg;</code>"}, {"owner": {"reputation": 1415, "user_id": 1502121, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/0Lsxb.jpg?s=128&g=1", "display_name": "m4l490n", "link": "https://stackoverflow.com/users/1502121/m4l490n"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439392735, "post_id": 31951051, "comment_id": 51845609, "body": "@Lundin: I&#39;ve tried also this and is complaining about not using &quot;dummy&quot;. I mean, the problem with MODULE_SCU.reg is just passed to dummy"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1439446811, "post_id": 31951051, "comment_id": 51867106, "body": "@m4l490n But it <i>is</i> used, right there... seems that your tool doesn&#39;t understand the meaning of volatile or side-effects at all."}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1439713917, "post_id": 31951051, "comment_id": 51967528, "body": "Your code is not in violation of MISRA C:2012 - your tool is incorrectly flagging <i>volatile</i> access as dead code."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 3, "creation_date": 1439325854, "post_id": 31951296, "comment_id": 51812529, "body": "@Veltas: Please state the part of the standard you come to this conclusion. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.1.2.3p2\" rel=\"nofollow noreferrer\">5.1.2.3p2+</a> imply the opposite"}, {"owner": {"reputation": 9309, "user_id": 2963099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TtYW1.gif?s=128&g=1", "display_name": "Glenn Teitelbaum", "link": "https://stackoverflow.com/users/2963099/glenn-teitelbaum"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1439326268, "post_id": 31951296, "comment_id": 51812727, "body": "@Olaf odd that programmers have typos where they type whole keywords in error :)  And don&#39;t worry about downvote, I figured it wasn&#39;t you"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1439327224, "post_id": 31951296, "comment_id": 51813225, "body": "@GlennTeitelbaum: Freudian slip? :-)"}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 1, "creation_date": 1439333947, "post_id": 31951296, "comment_id": 51815942, "body": "Upvote, I would just add the technical description of dead code is a statement that has no side effects - and usually indicates a mistake.  In this case there is no dead code.  I would not be surprise the checker ignore volatile altogether, this would lead to a lot of &quot;unreachable code&quot; violations as well."}], "tags": [], "owner": {"reputation": 9309, "user_id": 2963099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TtYW1.gif?s=128&g=1", "display_name": "Glenn Teitelbaum", "link": "https://stackoverflow.com/users/2963099/glenn-teitelbaum"}, "is_accepted": false, "score": 4, "last_activity_date": 1452258557, "last_edit_date": 1452258557, "creation_date": 1439324675, "answer_id": 31951296, "question_id": 31951051, "link": "https://stackoverflow.com/questions/31951051/what-would-be-an-alternate-way-to-properly-discard-a-volatile-variable-content-i/31951296#31951296", "title": "What would be an alternate way to properly discard a volatile variable content in C?", "body": "<blockquote>\n  <p>Here reg has to be read in order to reset it's bits, there is no other\n  way to reset some bits other thatn reading them, So, MISRA rule\n  checker is complaining that there is dead code and it's right.</p>\n</blockquote>\n\n<p>Dead code is code that does nothing. Technically dead code is a statement that has no side effects. In this case the <code>volatile</code> keyword indicates that it is indeed doing something, it is reading memory and therefore reseting the bits, A definite side effect.</p>\n\n<p>The volatile keyword also ensures that compliant optimizers do not remove that line.</p>\n\n<p>So, in fact the MISRA rule checker is wrong, the code is perfectly fine as is and should not be flagged.</p>\n\n<p>There is no need to find an alternate to the correct approach.</p>\n"}, {"comments": [{"owner": {"reputation": 9309, "user_id": 2963099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TtYW1.gif?s=128&g=1", "display_name": "Glenn Teitelbaum", "link": "https://stackoverflow.com/users/2963099/glenn-teitelbaum"}, "edited": false, "score": 0, "creation_date": 1439326740, "post_id": 31951557, "comment_id": 51812966, "body": "is <code>(void)</code> truly required for a <code>volatile</code>, or is that just a bandage for non-complient warnings"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439326922, "post_id": 31951557, "comment_id": 51813067, "body": "@Veltas: Thanks; feel free to edit such typos, I have a crappy keyboard;-)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 9309, "user_id": 2963099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TtYW1.gif?s=128&g=1", "display_name": "Glenn Teitelbaum", "link": "https://stackoverflow.com/users/2963099/glenn-teitelbaum"}, "edited": false, "score": 0, "creation_date": 1439327013, "post_id": 31951557, "comment_id": 51813114, "body": "@GlennTeitelbaum: Actually, the expresion as such is sufficient (use that myself), but some compilers might warn, so just play safe. Just added details."}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439329094, "post_id": 31951557, "comment_id": 51814149, "body": "FYI OP mentions that casting to <code>void</code> results in the same error as before, so is not a work-around. Obviously your main advice is still correct: ditch the tool."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439329289, "post_id": 31951557, "comment_id": 51814244, "body": "@Veltas: &quot;OP mentions that casting to void results in the same error as before ...&quot; No wonder it results in the same <b>complain</b>. But with or without, it is no <b>error</b> and no reason to actually complain. Therefore the last paragraph of my answer applies."}, {"owner": {"reputation": 868, "user_id": 1396410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2dcf867468889b06b5d39e2c16b0d23?s=128&d=identicon&r=PG", "display_name": "Veltas", "link": "https://stackoverflow.com/users/1396410/veltas"}, "edited": false, "score": 0, "creation_date": 1439331168, "post_id": 31951557, "comment_id": 51815039, "body": "@Olaf: I don&#39;t disagree with your question at all, I&#39;m just saying in response to: &quot;If the tool complains anyway&quot;: the tool <i>does</i> complain, and indeed OP should trash it."}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1439333458, "post_id": 31951557, "comment_id": 51815786, "body": "@Olaf - Correct, however, I would argue with a very bad tool its harder to blindly follow MISRA Rules - which is BTW (according to the process activities added in MISRA-C:2012) actually non-compliant development ;-)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1439383114, "post_id": 31951557, "comment_id": 51837873, "body": "@Veriloud: &quot;to blindly follow ...&quot; is <b>always</b> recipe for failure, not even limited to programming. My idea after the first questions from OP was to make him think on his own <b>...</b> (I better stop here)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": true, "score": 3, "last_activity_date": 1452258407, "last_edit_date": 1452258407, "creation_date": 1439325694, "answer_id": 31951557, "question_id": 31951051, "link": "https://stackoverflow.com/questions/31951051/what-would-be-an-alternate-way-to-properly-discard-a-volatile-variable-content-i/31951557#31951557", "title": "What would be an alternate way to properly discard a volatile variable content in C?", "body": "<p>The correct way to read an object and discard the result is:</p>\n\n<pre><code>(void)object;\n</code></pre>\n\n<p>The cast is actually not necessary, but might keep the compiler from complaining (not sure about MISRA actually). FYI: it is an <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.8.3\" rel=\"nofollow\">expression-statement</a>.</p>\n\n<p>If <code>object</code> is qualified <code>volatile</code>, the access may not be optimized away by the compiler, as this keyword tells the compiler that there is a side-effect, even if the compiler does not see it. That the cast applies to the result of the expression (the \"read\"), not the object, so it does <em>not</em> remove the qualifier as your comment implies.</p>\n\n<p>The MISRA-checker should not complain, as the line actually <strong>does</strong> something. (That is implied by the <code>volatile</code> <em>qualifier</em>). If the tool complains anyway, trash it. Even more as this is not the first time you appear to have trouble with it.</p>\n"}], "owner": {"reputation": 1415, "user_id": 1502121, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/0Lsxb.jpg?s=128&g=1", "display_name": "m4l490n", "link": "https://stackoverflow.com/users/1502121/m4l490n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 31951557, "answer_count": 2, "score": 2, "last_activity_date": 1452258557, "creation_date": 1439323772, "last_edit_date": 1495540364, "question_id": 31951051, "link": "https://stackoverflow.com/questions/31951051/what-would-be-an-alternate-way-to-properly-discard-a-volatile-variable-content-i", "title": "What would be an alternate way to properly discard a volatile variable content in C?", "body": "<p>When programming micro-controllers, there sometimes are registers that need to be read in order to reset some flags. These registers are memory mapped and are declared as pointers to volatile in the code.</p>\n\n<p>Assume the next snippet as example:</p>\n\n<pre><code>typedef volatile struct _Ifx_SCU\n{\n   ...\n   uint32_t reg;\n   ...\n}Ifx_SCU;\n\n\n#define MODULE_SCU ((*(Ifx_SCU*)0xF0036000u))\n\n\nvoid foo(void)\n{\n   ... \n\n   MODULE_SCU.reg; /* Read required to reset bits in reg */\n\n   ...\n}\n</code></pre>\n\n<p>Here <strong>reg</strong> has to be read in order to reset it's bits, there is no other way to reset some bits other thatn reading them, So, MISRA rule checker is complaining that there is dead code and it's right.</p>\n\n<p>My question is <strong>What would be an ALTERNATE way of reading and discarding **reg</strong> value in order to avoid having \"dead code\"?** Because using the method in the post <a href=\"https://stackoverflow.com/questions/23746870/casting-the-results-of-a-volatile-expression-to-void\">Casting the results of a volatile expression to void</a>\nwhich has a very similar situation, I still getting a MISRA c 2012 rule violation. I'm not able to change anything from the <strong>#define MODULE_SCU</strong> or the struct so a correct alternative method is the way to go.</p>\n\n<p>I don't want to just silence the compiler casting to void as I read from this thread: <a href=\"https://stackoverflow.com/questions/10767933/what-does-void-casting-do?rq=1\">What does void casting do?</a> because if I cast to void then the optimizer may optimize away that read and that is not desirable.</p>\n\n<p><em>Don't pay too much attention to the correctness of the snippet, I only included it to illustrate the question</em></p>\n"}]