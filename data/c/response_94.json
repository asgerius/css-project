[{"tags": ["c", "linux", "pthreads", "fork"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1477526553, "post_id": 40273993, "comment_id": 67807597, "body": "From the <a href=\"https://linux.die.net/man/2/wait\" rel=\"nofollow noreferrer\">wait man page</a>: A child that terminates, but has not been waited for becomes a &quot;zombie&quot;......If a parent process terminates, then its &quot;zombie&quot; children (if any) are adopted by init(8), which automatically performs a wait to remove the zombies. &quot;"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1477526638, "post_id": 40273993, "comment_id": 67807622, "body": "You could daemonize the child so it immediately loses its parent."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1477526668, "post_id": 40273993, "comment_id": 67807631, "body": "@kaylum Thanks. I know about zombies. I thought there was a way to fork() and not need to reap because you don&#39;t care about the child&#39;s return code and have the system auto reap the child so that a zombie isn&#39;t created."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1477526693, "post_id": 40273993, "comment_id": 67807638, "body": "Wasn&#39;t clear from your question. But yes, @KerrekSB describes that."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1477526730, "post_id": 40273993, "comment_id": 67807647, "body": "@KerrekSB Thank you. I thought there was a much simpler way. Perhaps my memory is wrong. I wonder if I&#39;m thinking of some Glib function."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1477526842, "post_id": 40273993, "comment_id": 67807673, "body": "<a href=\"https://stackoverflow.com/questions/17015830\">stackoverflow.com/questions/17015830</a>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1477527325, "post_id": 40273993, "comment_id": 67807791, "body": "@Chimera: Daemonizing is pretty damn simple. Don&#39;t know how much simpler you need it to be."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1477527389, "post_id": 40273993, "comment_id": 67807805, "body": "@KerrekSB Yes it&#39;s simple. I just thought I remembered a simpler way. As it turns out I was thinking of Glib&#39;s g_spawn_* methods."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1477527473, "post_id": 40273993, "comment_id": 67807822, "body": "@Chimera: The benefit of that seems mainly that it hooks up the I/O with the new process for you, which can indeed be quite fiddly and tricky (and deadlock-prone). (But you don&#39;t usually do I/O with daemon processes.)"}], "answers": [{"comments": [{"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1477529657, "post_id": 40274362, "comment_id": 67808327, "body": "I appreciate your answer."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 3, "last_activity_date": 1477529288, "creation_date": 1477529288, "answer_id": 40274362, "question_id": 40273993, "link": "https://stackoverflow.com/questions/40273993/how-to-forking-process-in-a-way-such-that-reaping-the-child-isnt-neccessary/40274362#40274362", "title": "How to forking process in a way such that reaping the child isn&#39;t neccessary", "body": "<p>The portable way to do this is to double-fork:</p>\n\n<pre><code>pid = fork();\nif (pid&gt;0) {\n    int status;\n    while (waitpid(pid, &amp;status, 0) &amp;&amp; !WIFEXITED(status) &amp;&amp; !WIFSIGNALED(status));\n    if (WIFSIGNALED(status) || WEXITSTATUS(status)) goto error;\n} else if (!pid) {\n    pid = fork();\n    if (pid) _exit(pid&lt;0);\n    else {\n        // do child work here\n        _exit(0);\n    }\n} else goto error;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "is_accepted": false, "score": 3, "last_activity_date": 1477529835, "creation_date": 1477529835, "answer_id": 40274421, "question_id": 40273993, "link": "https://stackoverflow.com/questions/40273993/how-to-forking-process-in-a-way-such-that-reaping-the-child-isnt-neccessary/40274421#40274421", "title": "How to forking process in a way such that reaping the child isn&#39;t neccessary", "body": "<p>I was thinking of Glib's <a href=\"https://developer.gnome.org/glib/stable/glib-Spawning-Processes.html\" rel=\"nofollow\">g_spawn_*</a> methods that auto-reap the child unless you specify you don't want that default behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1477581842, "post_id": 40276255, "comment_id": 67835177, "body": "Thank you. Saw that as well. But I read that it&#39;s not supported in older Linux kernels? And of course I&#39;m working on embedded Linux systems with very old kernels."}, {"owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "reply_to_user": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1481411501, "post_id": 40276255, "comment_id": 69368683, "body": "@Chimera That is correct: it&#39;s not supported prior to <code>POSIX.1-2001</code>, which is aligned with the C99 (<code>ISO&#47;IEC 9899:1999</code>). If you&#39;re using an older system, this will not work."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1481421810, "post_id": 40276255, "comment_id": 69370515, "body": "@DevNull You <b>really</b> down vote this! It&#39;s not a wrong answer Omg <a href=\"http://meta.stackexchange.com/questions/157841/what-do-i-do-when-someone-deliberately-downvotes-many-of-my-answers\" title=\"what do i do when someone deliberately downvotes many of my answers\">meta.stackexchange.com/questions/157841/&hellip;</a>. He never say in his question that he work with old kernels!"}, {"owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1481423608, "post_id": 40276255, "comment_id": 69370769, "body": "This isn&#39;t serial downvoting. I was curious why you so vehemently defended your critique of my answer the other day, despite being proven dead wrong, so I investigated other answers of yours because I was curious if you were spreading misinformation on SO: I was correct. Also, TC noted in a comment <b>just above this one</b> that he/she is using older kernels."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": false, "score": 2, "last_activity_date": 1477543266, "creation_date": 1477543266, "answer_id": 40276255, "question_id": 40273993, "link": "https://stackoverflow.com/questions/40273993/how-to-forking-process-in-a-way-such-that-reaping-the-child-isnt-neccessary/40276255#40276255", "title": "How to forking process in a way such that reaping the child isn&#39;t neccessary", "body": "<p>You can ignore SIGCHLD so it's doesn't create zombie ;)</p>\n\n<p><code>signal(SIGCHLD, SIG_IGN);</code></p>\n\n<p>doc here: <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow\">http://man7.org/linux/man-pages/man2/sigaction.2.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 6298204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e34d79f9326a008b0f9fcc9d28cab21?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya Tetali", "link": "https://stackoverflow.com/users/6298204/chaitanya-tetali"}, "is_accepted": false, "score": 0, "last_activity_date": 1560373901, "last_edit_date": 1560373901, "creation_date": 1560373015, "answer_id": 56570262, "question_id": 40273993, "link": "https://stackoverflow.com/questions/40273993/how-to-forking-process-in-a-way-such-that-reaping-the-child-isnt-neccessary/56570262#56570262", "title": "How to forking process in a way such that reaping the child isn&#39;t neccessary", "body": "<p>This can also be done via <a href=\"http://man7.org/linux/man-pages/man2/prctl.2.html\" rel=\"nofollow noreferrer\">prctl()</a></p>\n\n<p><code>prctl(PR_SET_PDEATHSIG, SIGTERM);</code> </p>\n\n<p>The above line inserted in the child process can cause it's termination when the parent process is dead. This can also work when any sub-reapers die(after they parent the child process), and if you need it's actual parent's death to kill the child process, then store the parent's <code>pid</code> before <code>fork()</code> and check it in the child process.</p>\n\n<p><code>if (getppid() != parent_pid_before_fork)\n        exit(1);</code>  </p>\n"}], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 40274362, "answer_count": 4, "score": 3, "last_activity_date": 1560373901, "creation_date": 1477526293, "last_edit_date": 1477529697, "question_id": 40273993, "link": "https://stackoverflow.com/questions/40273993/how-to-forking-process-in-a-way-such-that-reaping-the-child-isnt-neccessary", "title": "How to forking process in a way such that reaping the child isn&#39;t neccessary", "body": "<p>I seem to have a vague memory that some facility in Linux exists that allows one to fork() a process in such a way that the child is automatically reaped by the system without a zombie being created. What is this mechanism? Or is my memory just wrong?</p>\n"}, {"tags": ["c", "file", "sorting", "linked-list"], "comments": [{"owner": {"reputation": 995, "user_id": 2679327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Gmc3.png?s=128&g=1", "display_name": "Milack27", "link": "https://stackoverflow.com/users/2679327/milack27"}, "edited": false, "score": 0, "creation_date": 1477525468, "post_id": 40273708, "comment_id": 67807331, "body": "Those three prototypes should be out of the <code>categoryStore</code> function, shouldn&#39;t they? (Just to clarify, obviously this won&#39;t resolve your problem)."}, {"owner": {"reputation": 995, "user_id": 2679327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Gmc3.png?s=128&g=1", "display_name": "Milack27", "link": "https://stackoverflow.com/users/2679327/milack27"}, "edited": false, "score": 1, "creation_date": 1477526281, "post_id": 40273708, "comment_id": 67807515, "body": "At the beginning of <code>addStart</code> and <code>insertionSort</code>, the variable <code>temp-&gt;data</code> is being assigned twice, first with the result of malloc, and then with the argument <code>line</code>. When you make the second assignment, you&#39;re losing the reference for your allocated memory, so you can&#39;t free it later. This is surely causing memory leak."}, {"owner": {"reputation": 1, "user_id": 7077623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80de6e1762e11e75917efde6bd070bd7?s=128&d=identicon&r=PG&f=1", "display_name": "Rohini", "link": "https://stackoverflow.com/users/7077623/rohini"}, "reply_to_user": {"reputation": 995, "user_id": 2679327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Gmc3.png?s=128&g=1", "display_name": "Milack27", "link": "https://stackoverflow.com/users/2679327/milack27"}, "edited": false, "score": 0, "creation_date": 1477528409, "post_id": 40273708, "comment_id": 67808043, "body": "Hi @Milack, thanks for your comment. When I tried to remove <code>temp-&gt;data</code> (the second occurence), a segmentation fault occurs at the strcpy line."}, {"owner": {"reputation": 1, "user_id": 7077623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80de6e1762e11e75917efde6bd070bd7?s=128&d=identicon&r=PG&f=1", "display_name": "Rohini", "link": "https://stackoverflow.com/users/7077623/rohini"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1477530325, "post_id": 40273708, "comment_id": 67808445, "body": "@wildplasser sorry, i forgot to add in my struct <code>Node</code> . it&#39;s at the top of the code now."}, {"owner": {"reputation": 995, "user_id": 2679327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Gmc3.png?s=128&g=1", "display_name": "Milack27", "link": "https://stackoverflow.com/users/2679327/milack27"}, "edited": false, "score": 0, "creation_date": 1477570547, "post_id": 40273708, "comment_id": 67826951, "body": "Oh, I see some supsicious points here. First, you&#39;re initializing <code>head</code> twice. I&#39;m surprised your compiler lets you do that out of a function. I think you meant <code>Node *head = NULL</code>, remove the malloc. Also, at <code>addStart</code>, <code>temp-&gt;next</code> is a pointer, but you&#39;re assigning <code>*head</code> to it, which is a full struct. Again, I&#39;m surprised your compiler lets you do that without a warning, or even an error. I think you meant <code>temp-&gt;next = head</code>. Next line, you&#39;re doing just the opposite, filling a struct with a pointer. I think you meant <code>head = temp</code>. Similar considerations apply to <code>insertionSort</code>."}, {"owner": {"reputation": 995, "user_id": 2679327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Gmc3.png?s=128&g=1", "display_name": "Milack27", "link": "https://stackoverflow.com/users/2679327/milack27"}, "edited": false, "score": 0, "creation_date": 1477571160, "post_id": 40273708, "comment_id": 67827376, "body": "Also, I see a lot of <code>malloc</code> calls, but I don&#39;t see any <code>free</code> call. If you&#39;re serious about C programming, you&#39;ve got to fix that."}], "answers": [{"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1477638028, "last_edit_date": 1477638028, "creation_date": 1477621419, "answer_id": 40297090, "question_id": 40273708, "link": "https://stackoverflow.com/questions/40273708/linked-list-sort-only-taking-in-the-last-line-of-a-file-in-c/40297090#40297090", "title": "Linked List sort only taking in the last line of a file in c", "body": "<p>The problem is that the array of pointers for catstore is only allocated one time, so each new line overwrites all the field pointers from any previous lines. You need to move the line that allocates an array of pointers, and it only needs to allocate numCols pointers. </p>\n\n<pre><code>            for( j = 0; j &lt; numRows; j++ )\n            {\n                /* moved this line, deleted the \"50 *\"  */\n                catstore = ( char** )malloc( numCols*sizeof( char* ) );\n                for(i = 0; i &lt;= numCols - 1; i++)\n                {\n</code></pre>\n\n<p>insertionSort() needs to be fixed / cleaned up. If you fix insertionSort() so that it handles an empty list, you can get rid of addStart().</p>\n\n<pre><code>    /* delete this line */\n    temp-&gt;data = ( char** )malloc( 50*numCols*sizeof( char* ) );\n\n    /* this line is ok */ \n    temp-&gt;data = line;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7077623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80de6e1762e11e75917efde6bd070bd7?s=128&d=identicon&r=PG&f=1", "display_name": "Rohini", "link": "https://stackoverflow.com/users/7077623/rohini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477638028, "creation_date": 1477524304, "last_edit_date": 1477530270, "question_id": 40273708, "link": "https://stackoverflow.com/questions/40273708/linked-list-sort-only-taking-in-the-last-line-of-a-file-in-c", "title": "Linked List sort only taking in the last line of a file in c", "body": "<p>This function is supposed to print the linked list of a file every time the for loop for j runs. The user inputs a number that they wish to sort by, for example, if they input '3' the program will sort by the 3rd element in the list. However, it is giving the incorrect output. </p>\n\n<pre><code>typedef struct Node\n{\n    char **data;    \n    struct Node *next;\n}Node;\n\nNode *head = ( Node* )malloc( sizeof( Node ) );\nhead = NULL; //empty list\n\nvoid categoryStore( FILE* fpi, int numCols, int numRows, Node *head )\n{\n\n    void addStart(Node**, char**, int );\n    void insertionSort( Node**, char**, int, int );\n    void printLinkedList( Node*, int );\n\n    int i = 0, j = 0, ret = 0, userinput;\n    char *firstLine, *dump, **catstore;\n\n    dump = ( char* )malloc( 50*sizeof( char ) );\n    firstLine = ( char* )malloc( 50*sizeof( char ) );\n    catstore = ( char** )malloc( 50*numCols*sizeof( char* ) );\n\n    do\n    {\n        scanf( \"%d\", &amp;userinput ); /* let the user select the catagory via a number */\n\n        if( userinput &gt;= 0 &amp;&amp; userinput &lt; numCols)\n        {\n\n            fscanf( fpi,\"%s%*[^\\n]\\n\", firstLine );\n\n            for( j = 0; j &lt; numRows; j++ )\n            {\n\n                for(i = 0; i &lt;= numCols - 1; i++)\n                {\n                    catstore[i] = ( char* )malloc( 50*sizeof( char ) );\n\n                    if( i &lt; numCols - 1 )\n                    {\n                        fscanf( fpi, \"%[^,],\", catstore[i] );\n                    }\n\n                    else\n                    {\n                        fscanf( fpi, \"%[^\\n]\\n\", catstore[i] );\n                    }\n\n\n                }\n\n                if( j == 0 )\n                {\n                    addStart( &amp;head, catstore, numCols );\n                    printLinkedList( head, numCols );\n                }\n\n                else\n                {\n                    insertionSort( &amp;head, catstore, userinput, numCols );\n                    printLinkedList( head, numCols );\n                }\n\n            }\n\n        }\n\n        else if( userinput == numCols )\n        {\n            printf( \"goodbye\\n\" );\n        }\n\n        else\n        {\n            printf( \"Invalid input, please try again\\n\" );\n            ret = -1;\n        }\n\n    }while( ret != 0 );\n\n}  \n\n\n  /* function to add a node to the start of the linkedlist */\nvoid addStart( Node** head, char **line, int numCols )\n{\n    int i;\n\n    Node *temp = ( Node* )malloc( sizeof( Node ) ); //create and temporarily store the address of temp\n    temp-&gt;data = ( char** )malloc( 50*numCols*sizeof( char* ) );\n    temp-&gt;data = line;\n\n    for( i = 0; i &lt; numCols; i++ )\n    {\n        strcpy( temp-&gt;data[i], line[i] );\n    }\n\n\n    temp-&gt;next = *head; //dereferences temp and points the element \"next\" to what head is pointing to\n\n\n    *head = temp; //now head points to temp\n}\n\n\n/* function to insert addition lines and sort them */\n\nvoid insertionSort(Node **head, char **line, int select, int numCols)\n{\n    int i;\n    Node *temp = ( Node* )malloc( sizeof( Node ) );\n    temp-&gt;data = ( char** )malloc( 50*numCols*sizeof( char* ) );\n    temp-&gt;data = line;\n\n    for( i = 0; i &lt; numCols; i++ )\n    {\n        strcpy( temp-&gt;data[i], line[i] );\n    }\n\n    Node *temp1, *temp2;\n    temp1 = *head;\n    temp2 = *head;\n    temp1 = temp1-&gt;next;\n\n\n    if( strcmp( temp2-&gt;data[select], temp-&gt;data[select] ) &gt;= 0 )\n    {\n        temp-&gt;next = temp2;\n        *head = temp;\n    }\n    else\n    {\n\n        if(temp1-&gt;next != NULL)\n        {\n\n            while( strcmp( temp1-&gt;data[select], temp-&gt;data[select] ) &lt; 0 &amp;&amp; temp1-&gt;next != NULL )\n            {\n                temp1 = temp1-&gt;next;\n                temp2 = temp2-&gt;next;\n            }\n\n            if ( temp1-&gt;next == NULL &amp;&amp; strcmp( temp1-&gt;data[select], temp-&gt;data[select] ) &lt; 0 )\n            {\n                temp-&gt;next = NULL;\n                temp1-&gt;next = temp;\n            }\n\n            else\n            {\n                temp2-&gt;next = temp;\n                temp-&gt;next = temp1;\n            }\n        }\n\n        else\n        {\n            if( strcmp( temp1-&gt;data[select], temp-&gt;data[select] ) &lt; 0 )\n            {\n                temp-&gt;next = NULL;\n                temp1-&gt;next = temp;\n            }\n\n            else\n            {   \n                temp2-&gt;next = temp;\n                temp-&gt;next = temp1;\n            }\n        }   \n    }\n}\n\n\n/* print the linked list */  \nvoid printLinkedList( Node* head, int numCols )\n{\n    while( head != NULL )\n    {\n        int i=0;\n        for (i = 0; i &lt; numCols; i++)\n        {\n            printf( \"%s\", head-&gt;data[i] );\n        }\n        printf( \"\\n\" );\n        head = head-&gt;next;\n    }   \n}\n</code></pre>\n\n<p>The input file contains:  </p>\n\n<p>name (string), age (integer), address (string), food (string), colour (string)<br>\nmark, 21, at home, cheese, yellow<br>\njordan, 19, his place, cupcake, dark blue<br>\njohn, 40, mt everest, salad, red<br>\ngeralt, 100, kaer morhan, wolf, white<br>\nsam, 50, the shire, potatoes and strawberries, green  </p>\n\n<p>If the input was 3</p>\n\n<p>The output should be:</p>\n\n<p>mark 21 at home cheese yellow  </p>\n\n<p>mark 21 at home cheese yellow<br>\njordan 19 his place cupcake dark blue  </p>\n\n<p>mark 21 at home cheese yellow<br>\njordan 19 his place cupcake dark blue<br>\njohn 40 mt everest salad red  </p>\n\n<p>mark 21 at home cheese yellow<br>\njordan 19 his place cupcake dark blue<br>\ngeralt 100 kaer morhan wolf white<br>\njohn 40 mt everest salad red  </p>\n\n<p>mark 21 at home cheese yellow<br>\njordan 19 his place cupcake dark blue<br>\ngeralt 100 kaer morhan wolf white<br>\njohn 40 mt everest salad red<br>\nsam 50 the shire potatoes and strawberries green  </p>\n\n<p>The output currently is:  </p>\n\n<p>mark 21 at home cheese yellow<br>\njordan 19 his place cupcake dark blue<br>\njordan 19 his place cupcake dark blue<br>\njohn 40 mt everest salad red<br>\njohn 40 mt everest salad red<br>\njohn 40 mt everest salad red<br>\ngeralt 100 kaer morhan wolf white<br>\ngeralt 100 kaer morhan wolf white<br>\ngeralt 100 kaer morhan wolf white<br>\ngeralt 100 kaer morhan wolf white<br>\nsam 50 the shire potatoes and strawberries green<br>\nsam 50 the shire potatoes and strawberries green<br>\nsam 50 the shire potatoes and strawberries green<br>\nsam 50 the shire potatoes and strawberries green<br>\nsam 50 the shire potatoes and strawberries green   </p>\n\n<p>It appears as though the last line read is being taken in every time the function is called, and is replacing every line that is currently in the linked list. Could anyone tell me why this is happening. Any help would be greatly appreciated! Thanks.</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "answers": [{"comments": [{"owner": {"reputation": 1934, "user_id": 779269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5216008e0b231a760d20d22b01c4328?s=128&d=identicon&r=PG", "display_name": "kaiwan", "link": "https://stackoverflow.com/users/779269/kaiwan"}, "edited": false, "score": 1, "creation_date": 1477574495, "post_id": 40273925, "comment_id": 67829732, "body": "Right. Another possibility: do this in the bootloader? One way: by specifying an infinite timeout thus forcing the user to press a key. Of course, then it&#39;s very bootloader specific.."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 1, "last_activity_date": 1477525899, "creation_date": 1477525899, "answer_id": 40273925, "question_id": 40273707, "link": "https://stackoverflow.com/questions/40273707/read-keyboard-input-in-linux-kernel-boot/40273925#40273925", "title": "Read keyboard input in linux kernel boot", "body": "<p>You don't. Blocking for user input should be handled by userspace applications.</p>\n\n<p>If you want to prompt the user for input during startup, you can do this in an init script, possibly in an initrd.</p>\n\n<p>If you need to allow the user to supply configuration information to the kernel, you can do that by accepting a kernel command-line parameter.</p>\n"}], "owner": {"reputation": 13, "user_id": 4249428, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/suzxp.jpg?s=128&g=1", "display_name": "Carlos Perez", "link": "https://stackoverflow.com/users/4249428/carlos-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477576755, "creation_date": 1477524299, "last_edit_date": 1477576755, "question_id": 40273707, "link": "https://stackoverflow.com/questions/40273707/read-keyboard-input-in-linux-kernel-boot", "title": "Read keyboard input in linux kernel boot", "body": "<p>I compiled linux kernel and I added a message (<code>\"Hi, press any key to continue..\"</code>) to boot process, using <code>pr_alert()</code> function, is working fine, but I need to detect when a keyboard key is pressed to continue with boot process, I don't know what function I can use. please help.</p>\n"}, {"tags": ["c", "opencv"], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 4525932, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh4.googleusercontent.com/-2dHCJYSOCSE/AAAAAAAAAAI/AAAAAAAAABo/pZ1mLVANuzc/photo.jpg?sz=128", "display_name": "dmedine", "link": "https://stackoverflow.com/users/4525932/dmedine"}, "edited": false, "score": 0, "creation_date": 1477589046, "post_id": 40279331, "comment_id": 67839746, "body": "This is good news, but the documentation says that VideoWriter::write returns a void, not a boolean. Am I misunderstanding this?"}, {"owner": {"reputation": 1719, "user_id": 2256753, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Mhcg5.jpg?s=128&g=1", "display_name": "Balaji R", "link": "https://stackoverflow.com/users/2256753/balaji-r"}, "reply_to_user": {"reputation": 454, "user_id": 4525932, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh4.googleusercontent.com/-2dHCJYSOCSE/AAAAAAAAAAI/AAAAAAAAABo/pZ1mLVANuzc/photo.jpg?sz=128", "display_name": "dmedine", "link": "https://stackoverflow.com/users/4525932/dmedine"}, "edited": false, "score": 0, "creation_date": 1477634563, "post_id": 40279331, "comment_id": 67855723, "body": "May i know what doc you are referring?"}, {"owner": {"reputation": 454, "user_id": 4525932, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh4.googleusercontent.com/-2dHCJYSOCSE/AAAAAAAAAAI/AAAAAAAAABo/pZ1mLVANuzc/photo.jpg?sz=128", "display_name": "dmedine", "link": "https://stackoverflow.com/users/4525932/dmedine"}, "edited": false, "score": 0, "creation_date": 1477672776, "post_id": 40279331, "comment_id": 67876224, "body": "The one I link to in the question: <a href=\"http://docs.opencv.org/3.0-beta/modules/videoio/doc/reading_and_writing_video.html\" rel=\"nofollow noreferrer\">docs.opencv.org/3.0-beta/modules/videoio/doc/&hellip;</a>"}, {"owner": {"reputation": 454, "user_id": 4525932, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh4.googleusercontent.com/-2dHCJYSOCSE/AAAAAAAAAAI/AAAAAAAAABo/pZ1mLVANuzc/photo.jpg?sz=128", "display_name": "dmedine", "link": "https://stackoverflow.com/users/4525932/dmedine"}, "edited": false, "score": 0, "creation_date": 1478564861, "post_id": 40279331, "comment_id": 68198585, "body": "sort of. My goal is to separate the read and write phases of an openCV based video capture application. My strategy now is to make a lockfree queue object (based on boost::lockfree::spsc_queue) and have the read and write thread read and write to the queue asynchronously. I&#39;ve not quite got it working yet, but this way I can monitor exactly which frames are written by hand."}], "tags": [], "owner": {"reputation": 1719, "user_id": 2256753, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Mhcg5.jpg?s=128&g=1", "display_name": "Balaji R", "link": "https://stackoverflow.com/users/2256753/balaji-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1477555509, "creation_date": 1477555509, "answer_id": 40279331, "question_id": 40273416, "link": "https://stackoverflow.com/questions/40273416/what-is-the-meaning-of-cvwriteframe-return-value/40279331#40279331", "title": "what is the meaning of cvWriteFrame return value?", "body": "<p>Please don't use the depreciated </p>\n\n<p>C API: cvWriteFrame </p>\n\n<p>You can use the c++ API: <a href=\"http://docs.opencv.org/3.0-beta/modules/videoio/doc/reading_and_writing_video.html?highlight=cvwriteframe#videowriter-write\" rel=\"nofollow\">VideoWriter::write</a> or <a href=\"http://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html?highlight=imwrite#imwrite\" rel=\"nofollow\">imwrite</a> \nwhich will return a bool value that says the success or failure of the write operation!</p>\n"}], "owner": {"reputation": 454, "user_id": 4525932, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh4.googleusercontent.com/-2dHCJYSOCSE/AAAAAAAAAAI/AAAAAAAAABo/pZ1mLVANuzc/photo.jpg?sz=128", "display_name": "dmedine", "link": "https://stackoverflow.com/users/4525932/dmedine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477555509, "creation_date": 1477522493, "last_edit_date": 1477523153, "question_id": 40273416, "link": "https://stackoverflow.com/questions/40273416/what-is-the-meaning-of-cvwriteframe-return-value", "title": "what is the meaning of cvWriteFrame return value?", "body": "<p>I am writing a video capture application and I need to check to make sure that frames are actually being written to file in a timely manner (sometimes this doesn't happen). I see from openCV's <a href=\"http://docs.opencv.org/3.0-beta/modules/videoio/doc/reading_and_writing_video.html#int%20cvWriteFrame(CvVideoWriter*%20writer,%20const%20IplImage*%20image)\" rel=\"nofollow\">documentation</a> that the C api call to <code>cvWriteFrame</code> returns an <code>int</code>. Will this confirm whether or not the frame got written? I see that the Python and C++ versions of this call don't return anything. No error checking here? Why not?</p>\n"}, {"tags": ["c", "compilation", "infinite-loop"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 7, "creation_date": 1477522070, "post_id": 40273245, "comment_id": 67806418, "body": "Show your <i>entire</i> program.  You talk about a loop, but there is no loop here."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1477522540, "post_id": 40273245, "comment_id": 67806549, "body": "1. Don&#39;t compile it like that, do it like this <code>gcc -Wall -Werror -o readSum readSum.c</code>. 2. There is no <b>loop</b> anywhere in that program. 3. Your <code>main()</code> prototype is wrong but you would know that if you compile it like I say."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1477522631, "post_id": 40273245, "comment_id": 67806576, "body": "Either explain that the code you show <i>is</i> your entire source (and as if by magic, the loop occurs), or include the missing pieces (if there are any) that actually show the looping conditions."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1477522790, "post_id": 40273245, "comment_id": 67806627, "body": "&quot;it enters the loop before anything is even entered&quot;. Do you mean the program just sits there waiting before any input is entered? That is exactly what <code>scanf</code> is supposed to do."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1477524048, "post_id": 40273245, "comment_id": 67806974, "body": "You actually should rarely post your <i>entire</i> code .. you need to post enough code for an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>, so others can (try to) reproduce your problem and diagnose it. The code you provided doesn&#39;t show a loop even though you talk about one. Perhaps the bug is in the loop, how can any of us know?"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "edited": false, "score": 0, "creation_date": 1477524212, "post_id": 40273245, "comment_id": 67807014, "body": "I mean why would I not post the entire code when it is this short and straightforward...never mind that."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1477524316, "post_id": 40273245, "comment_id": 67807034, "body": "if it&#39;s that short, then yes, edit your question and post the entire code, copy and paste, <code>#include</code>s and all, don&#39;t re-type. Also compile as @iharob suggested and fix all the warnings. As he stated your <code>main</code> prototype is wrong,, in this case it should be <code>int main(void)</code>"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "edited": false, "score": 0, "creation_date": 1477524456, "post_id": 40273245, "comment_id": 67807069, "body": "I think scanf is just hating on me or something, stuck on this for hours.  Since no one else has a problem (and glad I am for that, meaning nobody has to go through what I had to), this must mean something else is wrong then."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1477524577, "post_id": 40273245, "comment_id": 67807100, "body": "&quot;why would I not post the entire code when it is this short and straightforward&quot;  - you tell us... why didn&#39;t you post it?"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "edited": false, "score": 0, "creation_date": 1477524647, "post_id": 40273245, "comment_id": 67807128, "body": "copy and paste works for longer codes too, you know"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "edited": false, "score": 0, "creation_date": 1477524674, "post_id": 40273245, "comment_id": 67807135, "body": "@ M.M What do you mean? I did post it"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1477524742, "post_id": 40273245, "comment_id": 67807157, "body": "@TestBug you just changed the code to have <code>#include &lt;stdio.h&gt;</code>. (Which is an important difference). Does your real code actually have it or not?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1477524807, "post_id": 40273245, "comment_id": 67807175, "body": "@iharob in C89 (and gnu89, which gcc defaults to), <code>main() {</code> is a valid definition"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1477524907, "post_id": 40273245, "comment_id": 67807200, "body": "@M.M Yes, that is one thing I can confidently write down every single time I have to write anything."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1477524986, "post_id": 40273245, "comment_id": 67807217, "body": "What happens if you press <code>1</code> then Enter after running your program? Also I suggest you add a <code>printf</code> line like in Clara&#39;s example, then you will know whether the scanf has passed."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1477525800, "post_id": 40273245, "comment_id": 67807393, "body": "you can post images. For example: <a href=\"http://stackoverflow.com/questions/40273878/c-wrong-output-value\">stackoverflow.com/questions/40273878/c-wrong-output-value</a>"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1477526125, "post_id": 40273245, "comment_id": 67807474, "body": "@M.M Thank you for your help.  I added the printf and tried that, but it won&#39;t respond.  I will uninstall the system, and if it works then, the system must not have installed correctly in some ways which causes the loop."}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1477526205, "post_id": 40273245, "comment_id": 67807495, "body": "@yano No, you need this thing called reputation."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1477526282, "post_id": 40273245, "comment_id": 67807517, "body": "@TestBug please answer the question: what happens if you press 1 then Enter after running your program?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1477526340, "post_id": 40273245, "comment_id": 67807531, "body": "ahh ,, well not much. My man over at that link is sitting at 1 rep right now,, that&#39;s after 5 DVs on that question though,, guess he can no longer post images. Yes I&#39;m curious too, what&#39;s the answer to @M.M question?"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "edited": false, "score": 0, "creation_date": 1477526928, "post_id": 40273245, "comment_id": 67807699, "body": "Like I said in the very beginning."}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "edited": false, "score": 0, "creation_date": 1477526954, "post_id": 40273245, "comment_id": 67807706, "body": "Nothing works <i>sob</i>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1477527372, "post_id": 40273245, "comment_id": 67807801, "body": "&quot;Nothing works&quot; is useless. <i>What</i> doesn&#39;t work? You press 1 and it doesn&#39;t appear on the screen? Did you add a <code>printf</code> to your program? You should add one before the <code>scanf</code> and after. Do either of those print? Do they infinitely print? <i>None</i> of us are sitting beside you, we can&#39;t know a thing that&#39;s happening if you won&#39;t tell us. I&#39;m starting to think you&#39;re just trolling at this point."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1477527551, "post_id": 40273245, "comment_id": 67807838, "body": "Run the program, then copy and paste the output from your terminal.  That will give us a better idea of what is happening."}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1477527665, "post_id": 40273245, "comment_id": 67807867, "body": "@yano Yes, I press 1 and it doesn&#39;t appear on the screen.  Yes, I added the printf.  The printf before the scanf does.  The printf after it doesn&#39;t.  Nothing prints and nothing can be done until you press ctrl+z.  I would thank you for not accusing me of being a troll, sir, my day is bad enough without that."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1477528016, "post_id": 40273245, "comment_id": 67807951, "body": "Finally, some information! Ok, so the <code>printf</code> before the <code>scanf</code> prints,, just once I&#39;m assuming? That discards the possibility of an infinite loop. You press &#39;1&#39; and it doesn&#39;t appear on the screen .. are you sure the terminal window you&#39;re trying to type into has focus? Guess it does if Ctrl+Z does something. No keys you type appear on the screen? Ctrl+Z is the only key presses that you know of that garner a response? And update your question with the <b>exact</b> code you are now running and it&#39;s output."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1477528403, "post_id": 40273245, "comment_id": 67808040, "body": "Did you press the enter key after pressing 1?"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1477528939, "post_id": 40273245, "comment_id": 67808172, "body": "@dbush Yeah I did...maybe it&#39;s just being stupid and takes really long to process this incredibly short command?"}, {"owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "edited": false, "score": 0, "creation_date": 1477529069, "post_id": 40273245, "comment_id": 67808213, "body": "I do have smt to work on, I&#39;ll wait till it&#39;s finished reinstalling, and then I&#39;ll get back..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477532820, "post_id": 40273245, "comment_id": 67809003, "body": "Did you link in the math library?  <code>gcc -o readSum readSum.c</code> appears to be missing that."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1477545779, "post_id": 40273245, "comment_id": 67812205, "body": "When you print, include a newline at the end of the format string.  Do that in the <code>printf()</code> before the <code>scanf()</code>, and in the <code>printf()</code> after.  You show the <code>0.000000</code> output; you don&#39;t seem to show an input value.  Did you actually type <code>3.141593</code> or some other value into the program?  You should be using something like: <code>if (scanf(&quot;%f&quot;, &amp;num) != 1) printf(&quot;Read failed\\n&quot;); else </code>printf(&quot;Value: %f\\n&quot;, num);` testing whether the input works. When I run the code shown in the question, I can type 3.14159 after the 0.000000 and then I see 3.141590 followed immediately by my command-line prompt."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1477524229, "post_id": 40273476, "comment_id": 67807017, "body": "Saying that the code works is not an answer. It should just be a comment. When you get enough reputation you&#39;ll be able to comment on other people&#39;s questions. Until then, you should not abuse the answer method."}, {"owner": {"reputation": 51, "user_id": 6462000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5A1bO.jpg?s=128&g=1", "display_name": "Clara Nguy\u1ec5n", "link": "https://stackoverflow.com/users/6462000/clara-nguy%e1%bb%85n"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1477524392, "post_id": 40273476, "comment_id": 67807054, "body": "Got it. Thanks. :)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1477524536, "post_id": 40273476, "comment_id": 67807091, "body": "@Barmar in this case, saying &quot;there&#39;s no infinite loop in your code&quot; is a reasonable answer IMO, and providing an MCVE since OP refuses to"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1477524620, "post_id": 40273476, "comment_id": 67807119, "body": "It&#39;s not an answer. Obviously the question is incomplete, and the comments above are trying to get the poster to clarify it."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1477525024, "post_id": 40273476, "comment_id": 67807227, "body": "suggest initializing <code>num</code>, to avoid printing uninitiialized value in case <code>scanf</code> failed"}, {"owner": {"reputation": 51, "user_id": 6462000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5A1bO.jpg?s=128&g=1", "display_name": "Clara Nguy\u1ec5n", "link": "https://stackoverflow.com/users/6462000/clara-nguy%e1%bb%85n"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1477525278, "post_id": 40273476, "comment_id": 67807297, "body": "@M.M Done. I put a &quot;= 0&quot; in there."}], "tags": [], "owner": {"reputation": 51, "user_id": 6462000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5A1bO.jpg?s=128&g=1", "display_name": "Clara Nguy\u1ec5n", "link": "https://stackoverflow.com/users/6462000/clara-nguy%e1%bb%85n"}, "is_accepted": false, "score": 1, "last_activity_date": 1477525188, "last_edit_date": 1477525188, "creation_date": 1477522883, "answer_id": 40273476, "question_id": 40273245, "link": "https://stackoverflow.com/questions/40273245/why-is-this-simple-c-scanf-code-causing-infinite-loop/40273476#40273476", "title": "Why is this simple c scanf code causing infinite loop?", "body": "<p>Works fine actually. Even added a print statement to check. I think you're confusing inputting a number with an infinite loop because there is no loop to begin with.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nmain() {\n    float num = 0;\n    scanf(\"%f\", &amp;num);\n    printf(\"%f\\n\", num);\n}\n</code></pre>\n\n<p>Try it out: <a href=\"https://ideone.com/RBDTYf\" rel=\"nofollow\">https://ideone.com/RBDTYf</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7077421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0649dde72e31a7f9b5b203599753df?s=128&d=identicon&r=PG&f=1", "display_name": "Test Bug", "link": "https://stackoverflow.com/users/7077421/test-bug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1477530422, "creation_date": 1477521594, "last_edit_date": 1477530422, "question_id": 40273245, "link": "https://stackoverflow.com/questions/40273245/why-is-this-simple-c-scanf-code-causing-infinite-loop", "title": "Why is this simple c scanf code causing infinite loop?", "body": "<p>first question on stack overflow for me, let's see how well this goes!</p>\n\n<p>I can't understand why this simple piece of c code is causing an infinite loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (void) {\n  float num=0;\n  printf(\"%f\", num);\n  scanf(\"%f\", &amp;num);\n  printf(\"%f\", num);\n}\n</code></pre>\n\n<p>I checked out the other questions, but they were asking about why <em>entering illegal input types</em> causes an infinite loop.</p>\n\n<p>My code causes an infinite loop upon <em>execution</em>, meaning it enters the loop before anything is even entered.</p>\n\n<p>I compiled it like this:</p>\n\n<pre><code>gcc -o readSum readSum.c\n</code></pre>\n\n<p>Terminal output:</p>\n\n<pre><code>vim readSum.c\n15jz4@hera:~$ gcc -o readSum readSum.c\n15jz4@hera:~$ ./readSum\n0.000000\n</code></pre>\n\n<p>-Nothing happens after pressing any keys\n-Ctrl+Z exits the status but there could be some other key that stops it.\n-Going to reinstall, until then...I can't c+p.</p>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>Whoa...got responses pretty fast.</p>\n\n<p>Really guys, what's up with the 'entire code' thing?  Why would I not put up my entire code? This is my entire code.  Or should I tell you I have the #include  at the top?</p>\n\n<p>I created this just to test scanf.</p>\n\n<p>That's exactly the point, for some reason after execution it just enters an infinite loop for no logical reason at all! I've tried int main() { }, ending it with return 0; without the scanf it works fine, like if I use any other functions like printf(...) but I can't figure out why immediately after I execute it, nothing happens, and I can only go back by using ctrl+z.  I compared it with other similar codes, can't see the reason.</p>\n\n<p>No it is not sitting there waiting for input.  Literally the screen just goes out like it would in an infinite loop.</p>\n\n<p>Judging by the comments there is nothing wrong with it logically then, it must be something in the background, like missing some library sources (although I don't think this is likely).</p>\n\n<p>Nonononononono...why no images?? It would help the situation much!!</p>\n"}, {"tags": ["c", "prime-factoring"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 10, "creation_date": 1477520760, "post_id": 40273079, "comment_id": 67805992, "body": "You realize that the first time around, <code>n</code> is still undefined?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 6, "creation_date": 1477520765, "post_id": 40273079, "comment_id": 67805995, "body": "Use a debugger. Step through your execution."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1477521349, "post_id": 40273079, "comment_id": 67806214, "body": "<code>n = n&#47;a;</code> has no effect, because you immediately do <code>n=triangularNum</code> the next time through the loop."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1477521366, "post_id": 40273079, "comment_id": 67806219, "body": "You should do that initialization of <code>n</code> at the very beginning."}, {"owner": {"reputation": 845, "user_id": 2291248, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62020bb07b3c5292ba8a064d6abf6a4d?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/2291248/adam"}, "edited": false, "score": 0, "creation_date": 1539423589, "post_id": 40273079, "comment_id": 92503823, "body": "<a href=\"https://en.wikipedia.org/wiki/Trial_division\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Trial_division</a>"}], "answers": [{"tags": [], "owner": {"reputation": 995, "user_id": 2679327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Gmc3.png?s=128&g=1", "display_name": "Milack27", "link": "https://stackoverflow.com/users/2679327/milack27"}, "is_accepted": true, "score": 4, "last_activity_date": 1477524255, "creation_date": 1477524255, "answer_id": 40273702, "question_id": 40273079, "link": "https://stackoverflow.com/questions/40273079/find-all-prime-factors-of-a-given-number/40273702#40273702", "title": "Find all prime factors of a given number", "body": "<p>Your code works just fine if you remove this <code>triangularNum</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  int a, n;\n  scanf(\"%d\", &amp;n);\n\n  for (a=2; a&lt;=n; ++a)\n  {\n    while(n%a==0)\n    {\n      printf(\"%d\\t\", a);\n      n = n/a;\n    }\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1596721871, "post_id": 63283290, "comment_id": 111906830, "body": "While this code may solve the question, <a href=\"//meta.stackexchange.com/q/114762\">including an explanation</a> of how and why this solves the problem would really help to improve the quality of your post, and probably result in more up-votes. Remember that you are answering the question for readers in the future, not just the person asking now. Please <a href=\"https://stackoverflow.com/posts/63283290/edit\">edit</a> your answer to add explanations and give an indication of what limitations and assumptions apply."}], "tags": [], "owner": {"reputation": 1, "user_id": 13973529, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0H87Wp0prL8/AAAAAAAAAAI/AAAAAAAAAM8/Dj17VuuhGfo/photo.jpg?sz=128", "display_name": "Gaurav Chaudhry", "link": "https://stackoverflow.com/users/13973529/gaurav-chaudhry"}, "is_accepted": false, "score": 0, "last_activity_date": 1596727073, "last_edit_date": 1596727073, "creation_date": 1596715716, "answer_id": 63283290, "question_id": 40273079, "link": "https://stackoverflow.com/questions/40273079/find-all-prime-factors-of-a-given-number/63283290#63283290", "title": "Find all prime factors of a given number", "body": "<p>The below code finds all prime factors of a given number much faster.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n  int a, n;\n  scanf(&quot;%d&quot;, &amp;n);\n  \n  int sqroot = (int)sqrt(n);\n  \n  while (n % 2 == 0)\n  {\n    n = n / 2;\n    printf(&quot;%d\\t&quot;, 2);\n  }\n  \n  for (a=3; a&lt;=sqroot; a+=2)\n  {\n    while(n%a==0)\n    {\n      printf(&quot;%d\\t&quot;, a);\n      n = n/a;\n    }\n  }\n}\n</code></pre>\n<p>The most basic method of checking the primality of a given integer n is called trial division. This method divides n by each integer from 2 up to the square root of n. Any such integer dividing n evenly establishes n as composite; otherwise, it is prime. Integers larger than the square root do not need to be checked because, whenever n = a \u22c5 b, one of the two factors a and b is less than or equal to the square root of n. Another optimization is to check only primes as factors in this range. <a href=\"https://en.wikipedia.org/wiki/Prime_number\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Prime_number</a></p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 14651946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53ac6ee205c9c3dd16f158782ab0577?s=128&d=identicon&r=PG&f=1", "display_name": "Amisha Sahu", "link": "https://stackoverflow.com/users/14651946/amisha-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1617342512, "last_edit_date": 1617342512, "creation_date": 1617340953, "answer_id": 66914817, "question_id": 40273079, "link": "https://stackoverflow.com/questions/40273079/find-all-prime-factors-of-a-given-number/66914817#66914817", "title": "Find all prime factors of a given number", "body": "<pre><code> void factor(int n){\n   if(n&lt;=1) return;\n   while(n%2==0){\n      printf(&quot;2 &quot;);\n      n=n/2;  \n   }\n   while(n%3==0){\n       printf(&quot;3 &quot;);\n       n=n/3;\n   }\n   for(int i=5;i*i&lt;=n;i=i+6){\n       while(n%i==0){\n           printf(&quot;%d\\t&quot;,i);\n           n=n/i;\n       }\n       while(n%(i+2)==0){\n           printf(&quot;%d\\t&quot;,(i+2));\n           n=n/(i+2);\n       }\n   }\n   if(n&gt;3)\n    printf(&quot;%d\\t&quot;,n);\n</code></pre>\n<p>}</p>\n<p>Worst case Time complexity: O(sqrt(n))</p>\n"}], "owner": {"reputation": 25, "user_id": 7077518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56c0e74a41104456f542ec04ac4e6f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aisa.Imn", "link": "https://stackoverflow.com/users/7077518/aisa-imn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2107, "favorite_count": 1, "accepted_answer_id": 40273702, "answer_count": 3, "score": -5, "last_activity_date": 1617342512, "creation_date": 1477520634, "last_edit_date": 1539456755, "question_id": 40273079, "link": "https://stackoverflow.com/questions/40273079/find-all-prime-factors-of-a-given-number", "title": "Find all prime factors of a given number", "body": "<p>I want to find <a href=\"https://en.wikipedia.org/wiki/Integer_factorization\" rel=\"nofollow noreferrer\">all prime factors of a number</a>, for example <code>8: 2   2   2</code> or <code>12: 2   2   3</code>.</p>\n\n<p>So I write this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a, triangularNum, n;\n\n    scanf(\"%d\", &amp;triangularNum);\n\n    for (a = 2; a &lt;= n; ++a) {\n        while (n % a == 0) {\n            n = triangularNum;\n            printf(\"%d\\t\", a);\n            n = n / a;\n        }\n    }\n}\n</code></pre>\n\n<p>But when it has a factor with power > 1, it only prints that factor many times.</p>\n"}, {"tags": ["c", "unit-testing", "pthreads", "function-pointers", "stub"], "comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1477519862, "post_id": 40272742, "comment_id": 67805705, "body": "Observe that according your debugger, you didn&#39;t even enter <code>my_pthread_create</code>. Maybe you are somehow shadowing your function pointer and have garbage in the copy that you are calling."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1477519897, "post_id": 40272742, "comment_id": 67805723, "body": "Consider building your code with debug information, and possibly with optimization disabled.  Gdb should then be able to give you more information about the error.  Note also that you can still examine the stack after gdb catches the segfault -- debug information will help with that, too."}, {"owner": {"reputation": 65, "user_id": 4765642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc2fd8975abbd395cb79b9139ffa2b1b?s=128&d=identicon&r=PG&f=1", "display_name": "travisco_nabisco", "link": "https://stackoverflow.com/users/4765642/travisco-nabisco"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1477520231, "post_id": 40272742, "comment_id": 67805817, "body": "@Jens Gusted&quot; Yes, I am aware the my_pthread_create never got called. If I execute &quot;p (*sys_pthreads_create)(&amp;thr, 0, thread, arg)&quot; from within gdb the function pointer is called correctly and gdb shows that the thread is spawned."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1477520442, "post_id": 40272742, "comment_id": 67805891, "body": "Enable debug symbols in your build. So you can see exactly which memory access is causing the problem"}, {"owner": {"reputation": 65, "user_id": 4765642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc2fd8975abbd395cb79b9139ffa2b1b?s=128&d=identicon&r=PG&f=1", "display_name": "travisco_nabisco", "link": "https://stackoverflow.com/users/4765642/travisco-nabisco"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1477520657, "post_id": 40272742, "comment_id": 67805960, "body": "@kaylum I have debug symbols enabled, but can&#39;t make much sense of it beyond that."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1477520740, "post_id": 40272742, "comment_id": 67805985, "body": "Are you sure you have that enabled on the entire build? It does not seem to be enabled for <code>mypthreads.o</code>."}, {"owner": {"reputation": 65, "user_id": 4765642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc2fd8975abbd395cb79b9139ffa2b1b?s=128&d=identicon&r=PG&f=1", "display_name": "travisco_nabisco", "link": "https://stackoverflow.com/users/4765642/travisco-nabisco"}, "edited": false, "score": 0, "creation_date": 1477520910, "post_id": 40272742, "comment_id": 67806044, "body": "mypthreads was build with the following: gcc -g -D_REENTRANT -DQTC_TARGET_LINUX -Wall -c -fmessage-length=0 -MMD -MP -o LINUX_INTEL/mypthreads.o  mypthreads.c Maybe on of the other flags is messing things up."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1477523013, "post_id": 40272742, "comment_id": 67806694, "body": "the header file is missing the multiple include guard statements.  the <code>extern</code> modifier is not needed.  the <code>TH_THREAD_FUNC</code>  is not defined anywhere in the posted code.  the <code>th_opts</code> is not defined anywhere in the posted code.  the <code>sys_pthreads_create</code> redeclared as different kind of symbol. the <code>_REENTRANT</code> is not utilized in the posted code.  the <code>QTC_TARGET_LINUX</code> is not utilized in the posted code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1477523238, "post_id": 40272742, "comment_id": 67806757, "body": "when debugging with <code>gdb</code>, the <code>-g</code> parameter should be: <code>-ggdb</code>"}, {"owner": {"reputation": 65, "user_id": 4765642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc2fd8975abbd395cb79b9139ffa2b1b?s=128&d=identicon&r=PG&f=1", "display_name": "travisco_nabisco", "link": "https://stackoverflow.com/users/4765642/travisco-nabisco"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1477523512, "post_id": 40272742, "comment_id": 67806837, "body": "@user3629249 All good insight. The symbols that are undefined or not used are part of the backend build structure and I&#39;m not interested in ripping it apart Can you expand on the &#39;sys_pthread_create&#39; comment"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1477523559, "post_id": 40272742, "comment_id": 67806846, "body": "the prototype for <code>sys_pthread_create()</code> and the actual call do not have matching signatures."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1477523637, "post_id": 40272742, "comment_id": 67806868, "body": "how do you expect us to debug your problem if key definitions, data structures, etc are not included in the posted code?"}, {"owner": {"reputation": 65, "user_id": 4765642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc2fd8975abbd395cb79b9139ffa2b1b?s=128&d=identicon&r=PG&f=1", "display_name": "travisco_nabisco", "link": "https://stackoverflow.com/users/4765642/travisco-nabisco"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1477523651, "post_id": 40272742, "comment_id": 67806872, "body": "@user3629249 Thanks for the insight with &#39;-ggdb&#39;. That is one I was unfamiliar with. I am just ramping up on using gdb again after quite a few years away from Linux development."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1477524169, "post_id": 40272742, "comment_id": 67807001, "body": "what was expected to be done with this line: <code>int (*sys_pthreads_create)(pthread_t *thread, const pthread_attr_t *attr,                           void *(*start_routine) (void *), void *arg) = my_pthread_create; </code>?"}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "edited": false, "score": 0, "creation_date": 1477524212, "post_id": 40272742, "comment_id": 67807013, "body": "<code>-ggdb</code> and <code>-g</code> mean the same thing on Linux - it&#39;s the default debugging info type on that platform."}], "answers": [{"tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 3, "last_activity_date": 1477525314, "last_edit_date": 1477525314, "creation_date": 1477524166, "answer_id": 40273687, "question_id": 40272742, "link": "https://stackoverflow.com/questions/40272742/using-a-function-pointer-to-pthread-create-causes-segfault/40273687#40273687", "title": "Using a function pointer to pthread_create causes segfault", "body": "<p>The problem is that your declaration in <code>mypthreads.h</code> has the wrong type:</p>\n\n<pre><code>extern int (*sys_pthreads_create(pthread_t *, const pthread_attr_t *, void *(*) (void*), void *));\n</code></pre>\n\n<p>Due to a misplaced parantheses, the type of this symbol is a function that returns a pointer to <code>int</code>, but your actual <code>sys_pthreads_create</code> object is a pointer to a function.</p>\n\n<p>This means that when you call:</p>\n\n<pre><code>ret = (*sys_pthreads_create)(opts ? &amp;opts-&gt;thr : &amp;thr, 0, thread, arg);\n</code></pre>\n\n<p><code>sys_pthreads_create</code> is converted to a pointer to a function by implicitly taking the address of it, then that address is dereferenced and called.  But that's not really the address of a function - it's the address of a pointer to a function! So the call jumps into the data segment where <code>sys_pthreads_create</code> lives and crashes when it tries to execute the function pointer as code (or crashes due to a non-executable mapping).</p>\n\n<p>There's a clue to this in the gdb output:</p>\n\n<pre><code>#0  0x080660c4 in sys_pthreads_create ()\n</code></pre>\n\n<p>It says that it's executing within <code>sys_pthreads_create</code> - but <code>sys_pthreads_create</code> is a variable, not a function.</p>\n\n<p>The compiler would have diagnosed this for you if you had included <code>&lt;mypthreads.h&gt;</code> in <code>mypthreads.c</code>, because the conflicting types for <code>sys_pthreads_create</code> would have been visible to it (that's why you should always include the header file that declares objects in the source files that define those objects).</p>\n\n<p>The correct declaration of course is the one that matches <code>mypthreads.c</code>:</p>\n\n<pre><code>extern int (*sys_pthreads_create)(pthread_t *thread, const pthread_attr_t *attr,\n                      void *(*start_routine) (void *), void *arg);\n</code></pre>\n\n<p>The reason that <code>gdb</code> was able to call the function pointer successfully was that gdb uses the type information stored in the debugging info to determine the type of <code>sys_pthreads_create</code>, not the bogus information from the header file.</p>\n"}], "owner": {"reputation": 65, "user_id": 4765642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc2fd8975abbd395cb79b9139ffa2b1b?s=128&d=identicon&r=PG&f=1", "display_name": "travisco_nabisco", "link": "https://stackoverflow.com/users/4765642/travisco-nabisco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 40273687, "answer_count": 1, "score": 2, "last_activity_date": 1477525314, "creation_date": 1477518876, "last_edit_date": 1477520522, "question_id": 40272742, "link": "https://stackoverflow.com/questions/40272742/using-a-function-pointer-to-pthread-create-causes-segfault", "title": "Using a function pointer to pthread_create causes segfault", "body": "<p>I am attempting to stub out pthread_create to be able to fully unit test a module.  When the function pointer is called from within the test framework a segmentation fault occurs. If I debug the program using 'gdb' I am able to directly call the function pointer and it works correctly. </p>\n\n<p>I am using CppUTest as the unit test framework and have compiled my object files using gcc.</p>\n\n<p>This function has worked in production code prior to altering it to use a function pointer for pthread_create, so I am confident in the function in general.</p>\n\n<p>Stack Trace from GDB</p>\n\n<pre><code>&gt; Starting program:\n&gt; /home/lucid/depot/torr_linux_common_dev/main/src/Utilities/tests/testRunner\n&gt; [Thread debugging using libthread_db enabled] Using host libthread_db\n&gt; library \"/lib/i386-linux-gnu/libthread_db.so.1\".\n&gt; \n&gt; Program received signal SIGSEGV, Segmentation fault. 0x080660c4 in\n&gt; sys_pthreads_create () (gdb) backtrace\n&gt; #0  0x080660c4 in sys_pthreads_create ()\n&gt; #1  0x08049ee4 in th_start_thread_name (thread=0x8049e64 &lt;TestThread&gt;, arg=0x0, opts=0x0, name=0x0) at thr.c:177\n&gt; #2  0x08049e47 in test_ThreadTestGroup_ThreadCreateUnnamed_wrapper_c () at thr_test.c:66\n&gt; #3  0x08049223 in TEST_ThreadTestGroup_ThreadCreateUnnamed_Test::testBody\n&gt; (this=0x806cc90) at testRunner.c:21\n&gt; #4  0x0805576a in PlatformSpecificSetJmpImplementation ()\n&gt; #5  0x08053ab7 in Utest::run() ()\n&gt; #6  0x080550d5 in UtestShell::runOneTestInCurrentProcess(TestPlugin*, TestResult&amp;) ()\n&gt; #7  0x08053645 in helperDoRunOneTestInCurrentProcess ()\n&gt; #8  0x0805576a in PlatformSpecificSetJmpImplementation ()\n&gt; #9  0x08053b8f in UtestShell::runOneTest(TestPlugin*, TestResult&amp;) ()\n&gt; #10 0x080530ef in TestRegistry::runAllTests(TestResult&amp;) ()\n&gt; #11 0x0804a3ef in CommandLineTestRunner::runAllTests() ()\n&gt; #12 0x0804a4e9 in CommandLineTestRunner::runAllTestsMain() ()\n&gt; #13 0x0804a628 in CommandLineTestRunner::RunAllTests(int, char const**) ()\n&gt; #14 0x08049246 in main (argc=1, argv=0xbffff244) at testRunner.c:25\n</code></pre>\n\n<p>If I call the function pointer from within gdb it works</p>\n\n<pre><code>(gdb) p (*sys_pthreads_create)(&amp;thr, 0, thread, arg)\n[New Thread 0xb7c01b40 (LWP 17717)]\n$4 = 0\n</code></pre>\n\n<p>Function I am testing</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include \"mypthreads.h\"\nlong th_start_thread_name(TH_THREAD_FUNC thread, void *arg, th_opts *opts, const char* name)\n{\n    pthread_t thr;\n    int ret, sret;\n    //pthread_create(opts ? &amp;opts-&gt;thr : &amp;thr, NULL, thread, arg);\n    ret = (*sys_pthreads_create)(opts ? &amp;opts-&gt;thr : &amp;thr, 0, thread, arg);\n    if (ret == 0 &amp;&amp; name != NULL)\n    {\n       extern int pthread_setname_np(pthread_t thr, const char *name);  /* Fix warning from missing prototype. */\n\n       sret = pthread_setname_np(opts ? opts-&gt;thr : thr, name);\n       /* pthreads says that thread names must not exceed 16, including NULL. */\n       if (sret != 0 &amp;&amp; strlen(name) &gt; 15)\n       {\n           ret = -1;\n       }\n    }\n    return (long)ret;\n}\n</code></pre>\n\n<p>mypthreads.h</p>\n\n<pre><code>extern int (*sys_pthreads_create(pthread_t *, const pthread_attr_t *,\n                             void *(*) (void*), void *));\n</code></pre>\n\n<p>mypthreads.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\nint my_pthread_create(pthread_t *thread, const pthread_attr_t *attr,\n                          void *(*start_routine) (void *), void *arg)\n{\n    printf(\"Did you get the messsage?\");\n    return pthread_create(thread, attr, start_routine, arg);\n}\n\n\nint (*sys_pthreads_create)(pthread_t *thread, const pthread_attr_t *attr,\n                          void *(*start_routine) (void *), void *arg) = my_pthread_create;\n</code></pre>\n\n<p>Edit: Added output from gdb when I call the function pointer and it succeeds.</p>\n"}, {"tags": ["c", "file", "mmap"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 3, "creation_date": 1477517595, "post_id": 40272437, "comment_id": 67804930, "body": "How much RAM do you have? Odds are most of the smaller file fit in the system file cache (so paging in a page just means mapping in part of the cache), while the larger file does not (so paging in part of the file means actually reading it). You might try using <code>posix_madvise</code> (*NIX) or <code>PrefetchVirtualMemory</code> (Windows) to see if bulk prefetch helps when you do have enough RAM."}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1477517643, "post_id": 40272437, "comment_id": 67804950, "body": "@ShadowRanger 8gb"}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1477517746, "post_id": 40272437, "comment_id": 67804991, "body": "Also when I just read top 880 MB in second file the time to read was same as first."}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1477518331, "post_id": 40272437, "comment_id": 67805196, "body": "@ShadowRanger I tried <code>posix_madvise</code> but there was no improvement"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477518470, "post_id": 40272437, "comment_id": 67805241, "body": "What code did you use to &quot;iterate through the file&quot;?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477518578, "post_id": 40272437, "comment_id": 67805278, "body": "BTW you should expect time for &quot;linearly&quot; processing large data to increase proportional to <code>n*sqrt(n)</code>, not <code>n</code>. See <a href=\"http://www.ilikebigbits.com/blog/2014/4/21/the-myth-of-ram-part-i\" rel=\"nofollow noreferrer\">ilikebigbits.com/blog/2014/4/21/the-myth-of-ram-part-i</a> And 30 is pretty close to <code>10*sqrt(10)</code>"}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477518706, "post_id": 40272437, "comment_id": 67805328, "body": "@R.. I am just using <code>char c = arr[ptr++]</code>, where arr is the mmap ptr."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477518776, "post_id": 40272437, "comment_id": 67805353, "body": "@Anshuman: If you don&#39;t <i>do anything</i> with that, you should expect the compiler to optimize it out and for the entire operation to take zero time."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477518958, "post_id": 40272437, "comment_id": 67805414, "body": "Anyway the complete test code would be needed to have a good chance at getting a correct answer."}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477519072, "post_id": 40272437, "comment_id": 67805457, "body": "@R.. After that I am making a string from it. And Then Indexing it using unordered_map. But I don&#39;t think The problem is in  that part. It something related to mmap only."}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477519716, "post_id": 40272437, "comment_id": 67805657, "body": "@R.. I have updating the test Code"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 3, "creation_date": 1477520049, "post_id": 40272437, "comment_id": 67805766, "body": "So you&#39;re not just doing linear processing of the file, but storing data read from it in a custom <code>Indexer</code> object using <code>unordered_map</code>, and you just omitted that from the question until now? Most likely something in your indexing brings in a <code>sqrt(n)</code> or even just <code>log(n)</code> factor to the big-O."}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477520290, "post_id": 40272437, "comment_id": 67805839, "body": "@R.. But as I am replicating the content of file so Indexer is effetively just returning the value. Also there shouldn&#39;t be a certain jump from 3 times to 4 times. As I have mentioned"}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477520295, "post_id": 40272437, "comment_id": 67805840, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/126768/discussion-between-anshuman-and-r\">continue this discussion in chat</a>."}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1477522587, "post_id": 40272437, "comment_id": 67806563, "body": "@R.. I don&#39;t think there was any effect of unordered_map"}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "edited": false, "score": 0, "creation_date": 1477522651, "post_id": 40273149, "comment_id": 67806583, "body": "I don&#39;t think there is any effect of unordered map. See the updated question."}, {"owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "edited": false, "score": 0, "creation_date": 1477523028, "post_id": 40273149, "comment_id": 67806699, "body": "Sorry, But question is still the same. I just removed the unwanted code which was of less significance. I added those code as R.. asked me to do so."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "edited": false, "score": 0, "creation_date": 1477523147, "post_id": 40273149, "comment_id": 67806735, "body": "@Anshuman: If you need to expand a question to clarify things or remove unnecessary detail, do so.  But don&#39;t just change the question.  You get mostly the same answer either way."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 3, "last_activity_date": 1477524176, "last_edit_date": 1495540845, "creation_date": 1477520985, "answer_id": 40273149, "question_id": 40272437, "link": "https://stackoverflow.com/questions/40272437/mmap-perfoming-different-with-different-file-sizes/40273149#40273149", "title": "mmap perfoming different with different file sizes", "body": "<p>Access time is not constant, it gets slower the larger your dataset is.  I suggest reading <a href=\"https://gist.github.com/jboner/2841832\" rel=\"nofollow noreferrer\"><em>Latency Numbers Every Programmer Should Know</em></a>.</p>\n\n<p>If you run a benchmark and adjust the dataset size, you will see several ranges where the performance changes.</p>\n\n<ol>\n<li><p>Performance is fastest when the dataset fits in L1 cache.  L1 cache is small, say 64 KiB per core, but it is fast (~1 cycle access time, almost as fast as registers).</p></li>\n<li><p>Performance suddenly drops when you need L2 cache.  L2 cache is larger and slower than L1 cache.  The drop in performance is something like 10x or so.</p></li>\n<li><p>Performance drops again when your dataset is too large for L2 cache but fits in RAM.  Another 10x performance drop or so for cache misses.</p></li>\n<li><p>Performance drops through the floor when your dataset is too large for RAM but fits on disk.  The performance hit is like 1000x for cache misses, assuming you have a fast SSD, and maybe 100,000x if you have a non-SSD hard drive.</p></li>\n</ol>\n\n<p>Your 880 MB dataset fits neatly in 8 GiB of RAM, but the 8,800 MB dataset does not, it cannot all be resident at the same time.  Random access patterns are somewhat pessimal, but even with linear access patterns your pages will all get evicted from cache and the kernel will have to read them from disk over and over again.</p>\n\n<p>It's nice to pretend that you have an infinite amount of storage that is all the same speed but that is not even remotely true.</p>\n\n<h2>Red herrings</h2>\n\n<ul>\n<li><p>Practically speaking, the only two ways you get the file into memory is with either <code>read</code> or <code>mmap</code>.  Other options are just layers on top of those two.  For sequential access to data that's not in a page cache, the difference between <code>read</code> and <code>mmap</code> is not relevant, see <a href=\"https://stackoverflow.com/questions/45972/mmap-vs-reading-blocks\">mmap() vs. reading blocks</a></p></li>\n<li><p>Access patterns will change how much the performance drops when your dataset gets larger, but it won't change the fact that datasets too large to be resident can't be faster than disk.</p></li>\n</ul>\n\n<h2>Minor notes</h2>\n\n<ul>\n<li><p>If you're going to <code>mmap</code> then use <code>open</code> not <code>fopen</code>, the <code>fopen</code> is unnecessary.</p></li>\n<li><p>The <code>\"m\"</code> flag for <code>fopen</code> does not do what you think it does, it serves no purpose here.</p></li>\n<li><p>Don't use <code>open64</code>, <code>fopen64</code>, <code>mmap64</code> or any of that nonsense.  Just use <code>#define _FILE_OFFSET_BITS 64</code>.  This is the modern way to do things, but of course, it's only relevant on 32-bit systems--and since you're using <code>mmap</code> at offset zero, there's no point.</p></li>\n<li><p>Calling <code>perror</code> but continuing is a mistake.  The <code>err()</code> function is not universally available but does what you want.</p></li>\n<li><p>No good reason not to use <code>MAP_SHARED</code> here, but it won't change anything.</p></li>\n</ul>\n\n<p>Here's how the code would look with more consistent error checking:</p>\n\n<pre><code>int fp = open(\"filename\", O_RDONLY);\nif (fp == -1)\n    err(1, \"open\");\nstruct stat st;\nint r = fstat(fp, &amp;st);\nif (r == -1)\n    err(1, \"stat\");\n// Compiler warning on 64-bit, but is correct\nif (st.st_size &gt; (size_t)-1)\n    errx(1, \"file too large\");\nsize_t sz = st.st_size;\nvoid *data = mmap(NULL, sz, PROT_READ, MAP_SHARED, fp, 0);\nif (data == MAP_FAILED)\n    err(1, \"mmap\");\nunsigned counter = 0;\nfor (char *ptr = data, end = ptr + sz; ptr != end; ptr++)\n    counter += *ptr;\nprintf(\"%u\\n\", counter);\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 3724987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1aa8c9b735db43ecca5858fa2f0273?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman", "link": "https://stackoverflow.com/users/3724987/anshuman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 40273149, "answer_count": 1, "score": -1, "last_activity_date": 1477524176, "creation_date": 1477517453, "last_edit_date": 1477522535, "question_id": 40272437, "link": "https://stackoverflow.com/questions/40272437/mmap-perfoming-different-with-different-file-sizes", "title": "mmap perfoming different with different file sizes", "body": "<p>I am using a mmap to read a file. Now when filesize is around 880 MB it take around  0.5 second to iterate through file.</p>\n\n<p>Now I increased the filesize by 10 times by replicating the content of file. Now using mmap again took around 1 min.</p>\n\n<p>I thought that time to iterate should increase linearly with filesize.</p>\n\n<p>Here is the simple test Code</p>\n\n<pre><code>FILE *fp = fopen64(\"filename\", \"rm\");\nif (fp == NULL)\n{\n    perror(NULL);\n}\nstruct stat st;\nfstat(fileno(fp), &amp;st);\noff_t fileSize = st.st_size;\nchar *data = (char *)mmap64(NULL, fileSize, PROT_READ,MAP_PRIVATE,fileno(fp), 0);\noff_t ptr =0;\nchar c =(char)0;\nwhile(ptr &lt; fileSize) { c += data[ptr++] ;}\nstd::cout &lt;&lt; c &lt;&lt; \"\\n\";\n</code></pre>\n\n<p>Here are the results. </p>\n\n<p>For fileSize 880MB</p>\n\n<pre><code>real    0m0.501s\nuser    0m0.447s\nsys     0m0.053s\n</code></pre>\n\n<p>For fileSize 8.8 GB</p>\n\n<pre><code>real    0m57.685s\nuser    0m10.773s\nsys     0m3.690s\n</code></pre>\n"}, {"tags": ["c", "binary"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6454261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cd8dG.png?s=128&g=1", "display_name": "Beto", "link": "https://stackoverflow.com/users/6454261/beto"}, "is_accepted": false, "score": 0, "last_activity_date": 1477533593, "creation_date": 1477533593, "answer_id": 40274946, "question_id": 40272399, "link": "https://stackoverflow.com/questions/40272399/converting-binary-to-decimal-c-program/40274946#40274946", "title": "converting binary to decimal c program", "body": "<p>i think your approach is not the best, maybe if you store the binary number in a char array and then analyze it everything goes easier ;).</p>\n\n<p>If I were you I do something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main ()\n{\n    char binary [20];\n    printf (\"Input the binary number:  \");\n    scanf (\"%s\", binary);\n\n    int length = 0;\n    while (binary [length] != '\\0')\n       ++length;\n\n    int decimal = 0;\n    for (int i = length - 1; i &gt; -1; --i)\n    {\n        if (binary [i] == '1')\n            decimal += pow (2, length - i - 1);\n    }\n\n    printf (\"To decimal: %d\\n\", decimal);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7077359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d218d76ab84d23d1f367ffac7838e548?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey Inman", "link": "https://stackoverflow.com/users/7077359/mikey-inman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1571, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1477533593, "creation_date": 1477517280, "last_edit_date": 1477529760, "question_id": 40272399, "link": "https://stackoverflow.com/questions/40272399/converting-binary-to-decimal-c-program", "title": "converting binary to decimal c program", "body": "<p>I need help writing a binary conversion program in c. I need a way to increase the size of an array depending on how many bits are in a binary number, put the 1's and 0's in another array and add the numbers in the first array to get the converted number in decimal. I'm learning c programming as my first programming language.\nhere's what I have so far</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    printf(\"Please input binary number to convert to decimal.\");\n    Scanf(\"%d\");\n    for(i=2;i&lt;= /*number of integers in binary number*/;i++ )\n    {\n        int i\n        char conversiontable [2][i] ={\n            /*array1*/{'1','2',},\n            /*array2*/{}\n        };\n        /*inputs 110001101*/\n        /*increase size of array1 according to number of 1's and 0's in the binary number*/\n        /*fill empty slots in array 1 with the output of (2^2)2 starting in slot 3 and add 1 to the number outside the parenthesis for each slot*/\n        /*put binary number in array 2*/\n        /*add together the numbers in array 1 in correspondence to wherever there is a 1 in array 2*/\n\n        /*example*/\n        /*1,2,4,8,16,32,64,128,256*/\n        /*1,1,0,0, 0, 1, 1,  0,  1*/\n\n        /*1+2+32+64+256=355*/\n        /*outputs 355 for answer*/\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "process", "mpi"], "comments": [{"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 2, "creation_date": 1477546731, "post_id": 40272055, "comment_id": 67812567, "body": "Use <code>MPI_Sendrecv</code> instead in order to prevent deadlocks."}, {"owner": {"reputation": 333, "user_id": 6276393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c487619bb374f49795f7112884efa21d?s=128&d=identicon&r=PG&f=1", "display_name": "Adelov", "link": "https://stackoverflow.com/users/6276393/adelov"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1477604344, "post_id": 40272055, "comment_id": 67847647, "body": "how can i use it ?"}], "answers": [{"comments": [{"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1477694555, "post_id": 40311464, "comment_id": 67885522, "body": "Sends of a single integer are almost guaranteed to be buffered. The real problem is that the code for the intermediate ranks starts with a pair of blocking receives and those cannot return before both left and right messages have arrived. Also, you do not need to make both the sends and the receives non-blocking, only the logically first set of operations. In you case, that would be <code>MPI_Isend</code> followed by <code>MPI_Recv</code> followed by <code>MPI_Waitall</code>. BTW, <code>MPI_Sendrecv</code> in Open MPI is implemented as <code>MPI_Irecv</code> / <code>MPI_Send</code> / <code>MPI_Wait</code>."}, {"owner": {"reputation": 333, "user_id": 6276393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c487619bb374f49795f7112884efa21d?s=128&d=identicon&r=PG&f=1", "display_name": "Adelov", "link": "https://stackoverflow.com/users/6276393/adelov"}, "edited": false, "score": 0, "creation_date": 1477740468, "post_id": 40311464, "comment_id": 67893349, "body": "look at my answer and try that code , and tell me why ?"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1477858157, "post_id": 40311464, "comment_id": 67921112, "body": "@HristoIliev : thanks for your enlighted feedback! Indeed, the code did not freeze if two or three processes are used, likely because buffered send mode is used."}, {"owner": {"reputation": 333, "user_id": 6276393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c487619bb374f49795f7112884efa21d?s=128&d=identicon&r=PG&f=1", "display_name": "Adelov", "link": "https://stackoverflow.com/users/6276393/adelov"}, "edited": false, "score": 0, "creation_date": 1488060920, "post_id": 40311464, "comment_id": 72066608, "body": "thanx a lot , i know it&#39;s late but thanx"}], "tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": true, "score": 0, "last_activity_date": 1477680640, "creation_date": 1477680640, "answer_id": 40311464, "question_id": 40272055, "link": "https://stackoverflow.com/questions/40272055/i-have-an-interblockage-in-my-code-which-is-about-linear-process-calculation/40311464#40311464", "title": "I have an interblockage in my code which is about linear process calculation", "body": "<p>To understand the deadlock, imagine how it would run if two processes are used: both processes would call <code>MPI_Send()</code> and none of them would receive the messages because <code>MPI_Send()</code> is blocking.</p>\n\n<p>Hence, to overcome this problem, the messages have to be received! There are many solutions available:</p>\n\n<ol>\n<li>As suggested by Hristo Iliev, you can use <a href=\"https://www.open-mpi.org/doc/v1.8/man3/MPI_Sendrecv.3.php\" rel=\"nofollow\"><code>MPI_Sendrecv()</code></a>. Indeed, the documentation of OpenMPI cleary refers to your situation as a typical use of <code>Sendrecv()</code>:</li>\n</ol>\n\n<blockquote>\n  <p><code>MPI_Sendrecv()</code> combines in one call the sending of a message to one destination and the receiving of another message, from another process. A send-receive operation is useful for executing a shift operation across a chain of processes. If blocking sends and receives are used for such a shift, then one needs to order the sends and receives correctly (for example, even processes send, then receive; odd processes receive first, then send) in order to prevent cyclic dependencies that may lead to deadlock. </p>\n</blockquote>\n\n<p>The following <a href=\"http://www.mcs.anl.gov/research/projects/mpi/tutorial/mpiexmpl/src/exchange/C/exchange/solution.html\" rel=\"nofollow\">example</a> illustrates this option.</p>\n\n<ol start=\"2\">\n<li><p>Non-blocking communications can be used through the function <a href=\"https://www.open-mpi.org/doc/v1.8/man3/MPI_Isend.3.php\" rel=\"nofollow\"><code>MPI_Isend()</code></a> and <a href=\"https://www.open-mpi.org/doc/v1.8/man3/MPI_Irecv.3.php\" rel=\"nofollow\"><code>MPI_Irecv()</code></a>. But there must be a call to a function like <a href=\"http://www.mpich.org/static/docs/latest/www3/MPI_Waitall.html\" rel=\"nofollow\"><code>MPI_Waitall()</code></a> to ensure that all messages were actually sent and received.</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc,char *argv[])\n{\n    int  world_size, world_rank;\n    MPI_Init(&amp;argc,&amp;argv);\n    MPI_Comm_size(MPI_COMM_WORLD,&amp;world_size);\n    MPI_Comm_rank(MPI_COMM_WORLD,&amp;world_rank);\n\n    int x[world_size];\n\n    x[world_rank]=world_rank;\n\n    int up=world_rank+1;\n    int down=world_rank-1;\n    if(up&gt;=world_size){\n        up=MPI_PROC_NULL;\n    }\n    if(down&lt;0){\n        down=MPI_PROC_NULL;\n    }\n    MPI_Request req[4];\n    MPI_Isend(&amp;x[world_rank], 1, MPI_INT, up, 0, MPI_COMM_WORLD, &amp;req[0]); \n    MPI_Isend(&amp;x[world_rank], 1, MPI_INT, down, 0, MPI_COMM_WORLD, &amp;req[1]);\n    MPI_Irecv(&amp;x[(world_rank-1+world_size)%world_size], 1, MPI_INT, down, 0, MPI_COMM_WORLD, &amp;req[2]);\n    MPI_Irecv(&amp;x[(world_rank+1+world_size)%world_size], 1, MPI_INT, up, 0, MPI_COMM_WORLD, &amp;req[3]);\n    MPI_Waitall(4, req, MPI_STATUSES_IGNORE);\n\n    printf(\"rank %d has %d %d %d\\n\",world_rank,x[(world_rank-1+world_size)%world_size],x[world_rank],x[(world_rank+1+world_size)%world_size]); \n\n    MPI_Finalize();\n    return 0;\n}\n</code></pre></li>\n</ol>\n\n<p>To be compiled by <code>mpicc main.c -o main -Wall</code> and ran by <code>mpirun -np 10 main</code>. </p>\n"}], "owner": {"reputation": 333, "user_id": 6276393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c487619bb374f49795f7112884efa21d?s=128&d=identicon&r=PG&f=1", "display_name": "Adelov", "link": "https://stackoverflow.com/users/6276393/adelov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "closed_date": 1564950451, "accepted_answer_id": 40311464, "answer_count": 1, "score": 1, "last_activity_date": 1566026460, "creation_date": 1477515743, "last_edit_date": 1566026460, "question_id": 40272055, "link": "https://stackoverflow.com/questions/40272055/i-have-an-interblockage-in-my-code-which-is-about-linear-process-calculation", "closed_reason": "Needs more focus", "title": "I have an interblockage in my code which is about linear process calculation", "body": "<p>we suppose that we have a n linear  process P1...P2 , &amp; every process will communicate with his neighbours(left &amp; right) , &amp; we have a vector X of size n , &amp; \nXi= (X-1 + Xi + Xi+1 )/4  &amp; 0&lt; i &lt; n-1\nin this case every  process i send data Xi to his neighbour Xi+1 &amp; Xi-1 and receive Xi-1 &amp; Xi+1 from i-1 &amp; i+1 , for calculate the new value of Xi</p>\n\n<p>this is what i have done but i had an interblockage , so please help to find the errors : </p>\n\n<pre><code> #include&lt;stdio.h&gt;\n#include&lt;mpi.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[]){\n\nint world_rank;\nint world_size; \ndouble rec=0,rec2=0;\nint i,j;\n\nMPI_Init (&amp;argc, &amp;argv);\nMPI_Comm_rank(MPI_COMM_WORLD,&amp;world_rank);\nMPI_Comm_size(MPI_COMM_WORLD,&amp;world_size);\ndouble x[world_size];\n\nfor(i=0;i&lt;world_size;i++)x[i]=i;\n\nfor(i=0;i&lt;world_size;i++){\n    if(world_rank==i){\n        if(world_rank==0){\n            int a1=MPI_Send(&amp;x[i],1,MPI_INT,i+1,0,MPI_COMM_WORLD);\n            int a2=MPI_Recv(&amp;rec,1,MPI_INT,i+1,0,MPI_COMM_WORLD,MPI_STATUS_IGNORE);\n            if((a1==MPI_SUCCESS)&amp;&amp;(a2==MPI_SUCCESS)){\n                x[i]=(x[i]+rec)/4;  \n                printf(\"x[%d]= %f\\n\",i,x[i]);\n              }\n            }else if(world_rank==world_size-1){\n                            int a4=MPI_Send(&amp;x[i],1,MPI_INT,i-1,0,MPI_COMM_WORLD);\n                            int a3=MPI_Recv(&amp;rec,1,MPI_INT,i-1,0,MPI_COMM_WORLD,MPI_STATUS_IGNORE);\n\n                            if((a3==MPI_SUCCESS)&amp;&amp;(a4==MPI_SUCCESS)){\n                                x[i]=(x[i]+rec)/4;  \n                                printf(\"x[%d]= %f\\n\",i,x[i]);\n                             }\n                        }else{\n                            int a7=MPI_Recv(&amp;rec,1,MPI_INT,i+1,0,MPI_COMM_WORLD,MPI_STATUS_IGNORE); \n                            int a8=MPI_Recv(&amp;rec2,1,MPI_INT,i-1,0,MPI_COMM_WORLD,MPI_STATUS_IGNORE); \n                            int a5=MPI_Send(&amp;x[i],1,MPI_INT,i+1,0,MPI_COMM_WORLD);\n                            int a6=MPI_Send(&amp;x[i],1,MPI_INT,i-1,0,MPI_COMM_WORLD);\n\n                            if((a5==MPI_SUCCESS)&amp;&amp;(a5==MPI_SUCCESS)&amp;&amp;(a5==MPI_SUCCESS)&amp;&amp;(a5==MPI_SUCCESS)){\n                                x[i]=(x[i]+x[i+1]+x[i-1])/4;\n                                    printf(\"x[%d]= %f\\n\",i,x[i]);\n                            }\n}                           \n}\n}\n\n/*for(i=0;i&lt;world_size;i++)\nprintf(\"x[%d]= %f\\n\",i,x[i]);*/\n\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "lua"], "comments": [{"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1477516010, "post_id": 40272051, "comment_id": 67804169, "body": "<code>-llua</code> should work. Are you building Lua from scratch? Is Lua installed system-wide? Looks like you&#39;re missing an <code>-L path</code> in there."}, {"owner": {"reputation": 37, "user_id": 5221614, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44900ca6c40aec80a2a2b20719e67d49?s=128&d=identicon&r=PG&f=1", "display_name": "Adam G.", "link": "https://stackoverflow.com/users/5221614/adam-g"}, "reply_to_user": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1477516358, "post_id": 40272051, "comment_id": 67804323, "body": "I have lua installed in my /usr/local/ folder, what file would i use for the library? what would it be called?"}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 2, "creation_date": 1477516432, "post_id": 40272051, "comment_id": 67804358, "body": "And <code>ls &#47;usr&#47;local&#47;lib&#47;liblua.a</code> successfully shows a file? If so, you might have a bad setup of clang. To test, try appending <code>-L&#47;usr&#47;local&#47;lib</code> to your command line."}, {"owner": {"reputation": 37, "user_id": 5221614, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44900ca6c40aec80a2a2b20719e67d49?s=128&d=identicon&r=PG&f=1", "display_name": "Adam G.", "link": "https://stackoverflow.com/users/5221614/adam-g"}, "reply_to_user": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1477516798, "post_id": 40272051, "comment_id": 67804560, "body": "yep it successfully shows the file exists. and just a question, what would executing <code>gcc -o first first.c -lm -L&#47;usr&#47;local&#47;lib -llua</code> do? Like what effect would <code>-L&#47;usr&#47;local&#47;lib</code> have?"}, {"owner": {"reputation": 37, "user_id": 5221614, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44900ca6c40aec80a2a2b20719e67d49?s=128&d=identicon&r=PG&f=1", "display_name": "Adam G.", "link": "https://stackoverflow.com/users/5221614/adam-g"}, "reply_to_user": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1477516944, "post_id": 40272051, "comment_id": 67804643, "body": "Update: It works, I just want to know why :P"}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 3, "creation_date": 1477518924, "post_id": 40272051, "comment_id": 67805405, "body": "<code>-L</code> tells the compiler to look in an additional directory for <code>.a</code> (library) files when linking. For whatever reason, your installation of clang isn&#39;t looking in <code>&#47;usr&#47;local&#47;lib</code> by default, which it should be doing. What platform are you on? OS/X? I&#39;m assuming so since your <code>gcc</code> command is symlinked to <code>clang</code>."}, {"owner": {"reputation": 20508, "user_id": 2196426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e8759ad9a50739704dca2e84fa9b50?s=128&d=identicon&r=PG", "display_name": "Jakuje", "link": "https://stackoverflow.com/users/2196426/jakuje"}, "reply_to_user": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1478115460, "post_id": 40272051, "comment_id": 68028401, "body": "@Qix You should fill the answer to get rid of unanswered questions."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 11589015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccaf4e034bdff539e5a469da4e4e09f?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy1005", "link": "https://stackoverflow.com/users/11589015/tommy1005"}, "is_accepted": false, "score": 0, "last_activity_date": 1578569144, "creation_date": 1578569144, "answer_id": 59662931, "question_id": 40272051, "link": "https://stackoverflow.com/questions/40272051/lua-c-compiling-llua-error/59662931#59662931", "title": "Lua C Compiling -llua Error", "body": "<p>Please check the name of the static library file. e.g. if it is called <code>liblua.a</code> the linker cannot find the <code>llua</code> library.</p>\n\n<p>I simply renamed the file <code>liblua.a</code> to 'llua.a'.</p>\n"}], "owner": {"reputation": 37, "user_id": 5221614, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44900ca6c40aec80a2a2b20719e67d49?s=128&d=identicon&r=PG&f=1", "display_name": "Adam G.", "link": "https://stackoverflow.com/users/5221614/adam-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578569144, "creation_date": 1477515724, "question_id": 40272051, "link": "https://stackoverflow.com/questions/40272051/lua-c-compiling-llua-error", "title": "Lua C Compiling -llua Error", "body": "<p>I am attempting to compile some C code to run with Lua through the command:</p>\n\n<pre><code>gcc -o first first.c -llua -lm\n</code></pre>\n\n<p>and the output I receive:</p>\n\n<pre><code>ld: library not found for -llua\nclang: error: linker command failed with exit code 1\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre><code>-llua53\n-llua5.3\n</code></pre>\n\n<p>But it still provides the same error. Would anyone be able to lead me to find out what library I need to provide with compiling, and where it's located?</p>\n"}, {"tags": ["c", "linux"], "answers": [{"comments": [{"owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "edited": false, "score": 0, "creation_date": 1477517680, "post_id": 40272141, "comment_id": 67804962, "body": "How do I exactly use fgets? I beleive it needs parsing a file?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1477520007, "post_id": 40272141, "comment_id": 67805749, "body": "Using fgets() is extremely bad practice -- it provides no bounds checking, is thus open to serious security bugs -- and most companies won&#39;t allow any code that uses it to pass code review for that reason."}, {"owner": {"reputation": 1953, "user_id": 6035082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jd06O.jpg?s=128&g=1", "display_name": "Melik\u015fah \u015eim\u015fek", "link": "https://stackoverflow.com/users/6035082/melik%c5%9fah-%c5%9eim%c5%9fek"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1477521333, "post_id": 40272141, "comment_id": 67806207, "body": "@CharlesDuffy I think you should be wrong. Because scanf does not have any bound check. You can use fgets like fgets(argv, 4, stdin). Second argument checks bounds. You can not enter more than 4 character now."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1477521690, "post_id": 40272141, "comment_id": 67806327, "body": "@Melik\u015fah\u015eim\u015fek, I didn&#39;t say that scanf was good practice either. And yes, adding an argument adding bounds checking resolves the concern."}, {"owner": {"reputation": 1953, "user_id": 6035082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jd06O.jpg?s=128&g=1", "display_name": "Melik\u015fah \u015eim\u015fek", "link": "https://stackoverflow.com/users/6035082/melik%c5%9fah-%c5%9eim%c5%9fek"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1477522671, "post_id": 40272141, "comment_id": 67806591, "body": "@CharlesDuffy My example that before last edit have bound checking parameter also. I don&#39;t understand why you comment bad and vote down?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1477582633, "post_id": 40272141, "comment_id": 67835749, "body": "Frankly, I still don&#39;t consider this answer clear at explaining why and how the OP&#39;s code was wrong (&quot;easier&quot; doesn&#39;t describe the immediate bug in any detail), though it does include a correct alternative implementation (for the limited input domain at hand, which is a long way from supporting POSIX shell parsing rules). That said, as-extended, it no longer deserves a downvote."}, {"owner": {"reputation": 1953, "user_id": 6035082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jd06O.jpg?s=128&g=1", "display_name": "Melik\u015fah \u015eim\u015fek", "link": "https://stackoverflow.com/users/6035082/melik%c5%9fah-%c5%9eim%c5%9fek"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1477584790, "post_id": 40272141, "comment_id": 67837204, "body": "@CharlesDuffy thanks Duffy. I have editted my answer according to your answer. I wish this answer explains more information about bug and how fgets handle with this problem."}], "tags": [], "owner": {"reputation": 1953, "user_id": 6035082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jd06O.jpg?s=128&g=1", "display_name": "Melik\u015fah \u015eim\u015fek", "link": "https://stackoverflow.com/users/6035082/melik%c5%9fah-%c5%9eim%c5%9fek"}, "is_accepted": true, "score": 2, "last_activity_date": 1477584593, "last_edit_date": 1477584593, "creation_date": 1477516120, "answer_id": 40272141, "question_id": 40272013, "link": "https://stackoverflow.com/questions/40272013/c-shell-to-execute-commands/40272141#40272141", "title": "C Shell to execute commands", "body": "<p>You should use fgets() instead of scanf(). Because fgets does not delete white spaces from your input. scanf function only consumes input until the whitespace. For example if you enter \"ps -f\" scanf consumes this input as \"ps\". If you write ps directly to your shell terminal you can face with same exception that is what your programme exception. You can use fgets as stream reader that can be file stream or standard input stream(stdin). I have written code that solves your problem. You can check how you can use.</p>\n\n<pre><code>/* ----------------------------------------------------------------- */\n/* PROGRAM  shell.c                                                  */\n/*    This program reads in an input line, parses the input line     */\n/* into tokens, and use execvp() to execute the command.             */\n/* ----------------------------------------------------------------- */\n\n#include  &lt;stdio.h&gt;\n#include  &lt;sys/types.h&gt;\n\n/* ----------------------------------------------------------------- */\n/* FUNCTION  parse:                                                  */\n/*    This function takes an input line and parse it into tokens.    */\n/* It first replaces all white spaces with zeros until it hits a     */\n/* non-white space character which indicates the beginning of an     */\n/* argument.  It saves the address to argv[], and then skips all     */\n/* non-white spaces which constitute the argument.                   */\n/* ----------------------------------------------------------------- */\n\nvoid  parse(char *line, char **argv)\n{\n     while (*line != '\\0') {       /* if not the end of line ....... */ \n          while (*line == ' ' || *line == '\\t' || *line == '\\n')\n               *line++ = '\\0';     /* replace white spaces with 0    */\n          *argv++ = line;          /* save the argument position     */\n          while (*line != '\\0' &amp;&amp; *line != ' ' &amp;&amp; \n                 *line != '\\t' &amp;&amp; *line != '\\n') \n               line++;             /* skip the argument until ...    */\n     }\n     *argv = '\\0';                 /* mark the end of argument list  */\n}\n\n/* ----------------------------------------------------------------- */\n/* FUNCTION execute:                                                 */\n/*    This function receives a commend line argument list with the   */\n/* first one being a file name followed by its arguments.  Then,     */\n/* this function forks a child process to execute the command using  */\n/* system call execvp().                                             */\n/* ----------------------------------------------------------------- */\n\nvoid  execute(char **argv)\n{\n     pid_t  pid;\n     int    status;\n\n     if ((pid = fork()) &lt; 0) {     /* fork a child process           */\n          printf(\"*** ERROR: forking child process failed\\n\");\n          exit(1);\n     }\n     else if (pid == 0) {          /* for the child process:         */\n          if (execvp(*argv, argv) &lt; 0) {     /* execute the command  */\n               printf(\"*** ERROR: exec failed\\n\");\n               exit(1);\n          }\n     }\n     else {                                  /* for the parent:      */\n          while (wait(&amp;status) != pid)       /* wait for completion  */\n               ;\n     }\n}\n\n/* ----------------------------------------------------------------- */\n/*                  The main program starts here                     */\n/* ----------------------------------------------------------------- */\n\nvoid  main(void)\n{\n     char  line[1024];             /* the input line                 */\n     char  *argv[64];              /* the command line argument      */\n\n     while (1) {                   /* repeat until done ....         */\n          printf(\"Shell -&gt; \");     /*   display a prompt             */\n          fgets(line,1024,stdin);  /*   read in the command line     */\n          int i = strlen(line)-1;\n          if( line[ i ] == '\\n') \n              line[i] = '\\0';\n          parse(line, argv);       /*   parse the line               */\n          if (strcmp(argv[0], \"exit\") == 0)  /* is it an \"exit\"?     */\n               exit(0);            /*   exit if it is                */\n          execute(argv);           /* otherwise, execute the command */\n     }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/YjcH7.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/YjcH7.png\" alt=\"output\"></a></p>\n"}], "owner": {"reputation": 1008, "user_id": 5562737, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1096635253687967/picture?type=large", "display_name": "Amine", "link": "https://stackoverflow.com/users/5562737/amine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 40272141, "answer_count": 1, "score": 1, "last_activity_date": 1477584593, "creation_date": 1477515570, "last_edit_date": 1477519951, "question_id": 40272013, "link": "https://stackoverflow.com/questions/40272013/c-shell-to-execute-commands", "title": "C Shell to execute commands", "body": "<p>I have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n\nvoid  passe(char *ligne, char **argv)\n{\n     while (*ligne != '\\0')\n     {\n          while (*ligne == ' ' || *ligne == '\\t' || *ligne == '\\n')\n               *ligne++ = '\\0';\n          *argv++ = ligne;\n          while (*ligne != '\\0' &amp;&amp; *ligne != ' ' &amp;&amp;  *ligne != '\\t' &amp;&amp; *ligne != '\\n') \n               ligne++;   \n     }\n     *argv = '\\0';\n}\n\nvoid  executer(char **argv)\n{\n     pid_t  pid;\n     int    status;\n\n     if ((pid=fork()) == 0)\n     {\n          if (execvp(*argv, argv) &lt; 0) \n          {\n               printf(\"*** ERREUR: exec echou\u00e9\\n\");\n               exit(1);\n          }\n     }\n     wait(&amp;status);\n}\n\nint  main(void)\n{\n     char  ligne[1024];\n     char  *argv[64];\n\n     while (1)\n     {\n          printf(\"Shell -&gt; \");\n          scanf(\"%s\",ligne);\n          printf(\"\\n\");\n          passe(ligne, argv);\n          if (strcmp(argv[0], \"exit\") == 0)\n               exit(0);\n          executer(argv);\n     }\n     return 0;\n}\n</code></pre>\n\n<p>The programme works fine, however when I parse something like \"ps -f\" it retunrs \"execvp echou\u00e9\", as the code removes the spaces. What should I exactly do to make it accept comands with options such as ps -f?</p>\n"}, {"tags": ["c", "matrix", "decimal", "strtok"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477518675, "post_id": 40271917, "comment_id": 67805316, "body": "&quot;I have a function that reads in a file and prints&quot; --&gt; post that code."}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 2, "last_activity_date": 1477515330, "creation_date": 1477515330, "answer_id": 40271956, "question_id": 40271917, "link": "https://stackoverflow.com/questions/40271917/how-would-i-get-strtok-to-return-the-decimal-number-and-not-whole-numbers/40271956#40271956", "title": "How would I get strtok() to return the decimal number and not whole numbers?", "body": "<p>Your problem isn't <code>strtok</code>, it's this:</p>\n\n<pre><code>double newVal = strtol(value, &amp;ptr, 10);\n</code></pre>\n\n<p><code>strtol</code> converts the string to a <code>long</code>, not a <code>double</code>, so it's discarding the fractional portion.  Use <code>strtod</code> instead:</p>\n\n<pre><code>double newVal = strtod( value, &amp;ptr );\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5394924, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l8lnd.jpg?s=128&g=1", "display_name": "Wesley", "link": "https://stackoverflow.com/users/5394924/wesley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 40271956, "answer_count": 1, "score": -1, "last_activity_date": 1477517448, "creation_date": 1477515196, "last_edit_date": 1477517448, "question_id": 40271917, "link": "https://stackoverflow.com/questions/40271917/how-would-i-get-strtok-to-return-the-decimal-number-and-not-whole-numbers", "title": "How would I get strtok() to return the decimal number and not whole numbers?", "body": "<p>I have a function that reads in a file and prints it out as a grid.</p>\n\n<p>This is the file (input):</p>\n\n<pre><code>2 2\n1.83 5.64\n7.36 4.10\n</code></pre>\n\n<p>But when it prints out the matrix it only returns whole numbers (output):</p>\n\n<pre><code>2 2\n    1.00     5.00 \n    7.00     4.00 \n</code></pre>\n\n<p>How do I get the function to print out the decimal number? </p>\n\n<p>Wanted Output (i.e):</p>\n\n<pre><code>2 2\n    1.83     5.64 \n    7.36     4.10 \n</code></pre>\n"}, {"tags": ["c", "loops", "division"], "comments": [{"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 1, "creation_date": 1477514080, "post_id": 40271608, "comment_id": 67803247, "body": "I suggest learning how to use a debugger to step through your code and examine the variables."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1477514092, "post_id": 40271608, "comment_id": 67803254, "body": "It looks like you have disproved the Collatz conjecture...."}], "answers": [{"comments": [{"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1477514562, "post_id": 40271765, "comment_id": 67803454, "body": "Also consider the fact the for loop variable will only exit when n&gt;=j, which could be 1000 even if I was 2."}, {"owner": {"reputation": 50, "user_id": 5544537, "user_type": "registered", "profile_image": "https://graph.facebook.com/1638495549739028/picture?type=large", "display_name": "Pablo Marcos", "link": "https://stackoverflow.com/users/5544537/pablo-marcos"}, "edited": false, "score": 0, "creation_date": 1477514593, "post_id": 40271765, "comment_id": 67803476, "body": "For example debbuging with i=3 and j=5  the sequence of count, n is      0 - 3, 1 - 10, 2 - 5, 3 - 16, 4 - 8, 5 - 4, 6 - 2, 0 - 2, 0 - 2, 0 - 2, etc... For any reason fail in the case 2/2"}], "tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": true, "score": 2, "last_activity_date": 1477514845, "last_edit_date": 1477514845, "creation_date": 1477514490, "answer_id": 40271765, "question_id": 40271608, "link": "https://stackoverflow.com/questions/40271608/division-by-2-and-infinite-loop-in-c/40271765#40271765", "title": "Division by 2 and infinite loop in C", "body": "<p>It <em>is</em> changing <code>n</code>, and is exiting the <code>while</code> loop.  However, the code that gets executed after that is responsible for the infinite loop.</p>\n\n<p>If you can't use a debugger, try adding a <code>printf</code> statement right after <code>count = 0</code> to see what is happening.  Or, assuming that the <code>while</code> loop does exit with <code>n</code>=1 (which it does), what will happen to <code>n</code> when you start another iteration of the <code>for</code> loop?</p>\n"}], "owner": {"reputation": 50, "user_id": 5544537, "user_type": "registered", "profile_image": "https://graph.facebook.com/1638495549739028/picture?type=large", "display_name": "Pablo Marcos", "link": "https://stackoverflow.com/users/5544537/pablo-marcos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 40271765, "answer_count": 1, "score": -1, "last_activity_date": 1477515448, "creation_date": 1477513889, "last_edit_date": 1477515448, "question_id": 40271608, "link": "https://stackoverflow.com/questions/40271608/division-by-2-and-infinite-loop-in-c", "title": "Division by 2 and infinite loop in C", "body": "<p>I'm doing an implementation of the 3n+1 algorithm, but for some reason when n=2, the division n = n/2 doesn't change the value, creating an infinite loop, and I can't see why:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main(void)\n{\n    int i=0,j=0,n=0,count,max;\n\n        scanf(\"%d\",&amp;i);\n        scanf(\"%d\",&amp;j);\n\n        max = 0;\n\n        for(n=i; n&lt;=j; n++){\n            count = 0;\n\n            while(n != 1){\n                //Debug print\n                printf(\"%d - %d\\n\",count,n);\n\n                if(n%2 != 0){ //Odd\n                    n = 3 * n + 1;\n                } else { //Even\n\n                    n = n / 2;\n\n                    //n /= 2;\n                    //n = n &gt;&gt; 1;\n                }\n                count++;\n            }\n            max = (count &gt; max) ? count : max;\n        }\n        printf(\"%d %d %d\\n\",i,j,max);\n\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>[Solve] The for loop and de while loop was changing the value of n</p>\n\n<pre><code>for(k=i; k&lt;j;k++){\n    count =0;\n    n = k;\n    while( n!= 1){\n          . . .\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 1, "creation_date": 1477513560, "post_id": 40271508, "comment_id": 67803003, "body": "It hasn&#39;t grown. You&#39;ve allocated 2 chars for <code>s</code> and that&#39;s how much memory is set aside on the stack for it. However, <code>scanf()</code> just receives a pointer to the memory. It has no way of knowing how much memory is allocated, so it just reads and stores, writing to memory that is probably set side for something else, until it&#39;s done. It&#39;s up to you to do the memory management part. These kinds of bugs are the source of many &quot;what the...?&quot; debugging moments because it typically looks like something <i>else</i> is broken."}, {"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1477513680, "post_id": 40271508, "comment_id": 67803060, "body": "Why doesn&#39;t he have &amp;s in his scanf?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1477513680, "post_id": 40271508, "comment_id": 67803059, "body": "You are overwriting the bounds of your array, thus inducing undefined behavior. You&#39;re correct that your array only has 2 <code>char</code>s. You&#39;re just getting lucky that writing beyond 2 <code>char</code>s isn&#39;t wrecking something else. You may not be so lucky on another machine or with different compiler options. Furthermore, <code>c</code> strings are NULL (<code>\\0</code>) terminated, so you&#39;ll need an extra character in the array for that. &quot;helloworld&quot; is 10 <code>char</code>s long, meaning you&#39;ll need a <code>char</code> array 11 <code>char</code>s long to properly store it."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1477513689, "post_id": 40271508, "comment_id": 67803064, "body": "No, the array hasn&#39;t grown. By entering a long text you&#39;ve overwritten part of the stack (or whatever memory the array was allocated in) outside the array. When that happens with stack memory, it usually leads to crashes or execution of unwanted code, especially when the code is part of a remotely accessible service."}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 1, "creation_date": 1477513743, "post_id": 40271508, "comment_id": 67803094, "body": "You&#39;ve expose the very flaw in <code>scanf</code> which is that it&#39;s not memory safe. If you used <code>fgets</code> here, you&#39;d get <code>h</code> as your return (don&#39;t forget the null terminator)."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1477513909, "post_id": 40271508, "comment_id": 67803164, "body": "@OmidCompSCI because when <code>s</code> is used in this context, it decays to a pointer to the first element in the array."}, {"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1477514035, "post_id": 40271508, "comment_id": 67803223, "body": "@yano technically s is s = &amp;char[0]?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1477514391, "post_id": 40271508, "comment_id": 67803381, "body": "@OmidCompSCI: Unless it&#39;s the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is a string literal used to initialize another array in a declaration, an <i>expression</i> of type &quot;N-element array of <code>T</code>&quot; is converted (&quot;decays&quot;) to an expression of type &quot;pointer to <code>T</code>&quot;, and the value of the expression is the address of the first element of the array.  Note that <code>&amp;s</code> and <code>s</code> yield the same address value, but the <i>types</i> of the expressions are different - <code>char (*)[2]</code> vs <code>char *</code>.  <code>scanf</code> expects a <code>char *</code> for the <code>%s</code> specifier, so the argument should be <code>s</code>."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1477514555, "post_id": 40271508, "comment_id": 67803451, "body": "You are experiencing a <b>buffer overflow</b>, means that you are writing onto memory you didn&#39;t allocate/reserve. Standard says it is undefined behavior. Always use functions that bounds the memory they write in some way."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1477514941, "post_id": 40271508, "comment_id": 67803648, "body": "@EliSadoff: Just because it is not used correctly does not make <code>scanf</code> &quot;inherently unsafe&quot;. OP could easily have limited the length of the input to a safe range or use <code>scanf_s</code> if available."}], "answers": [{"tags": [], "owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "is_accepted": false, "score": 4, "last_activity_date": 1477513896, "creation_date": 1477513896, "answer_id": 40271610, "question_id": 40271508, "link": "https://stackoverflow.com/questions/40271508/declaring-variable-length-strings-in-c-apparently-dynamic/40271610#40271610", "title": "Declaring variable length strings in c - apparently dynamic?", "body": "<p>This shows the perfect reason as to why <code>scanf</code> is so dangerous. You've overwritten other memory that was not intended for this. A much safer way to read constant length strings is to do something like this</p>\n\n<pre><code>char a[2];\nfgets(a, sizeof(a), stdin);\nprintf(\"%s\\n\", a);\n</code></pre>\n\n<p>If you did this and you typed <code>helloworld</code> you would only get <code>h</code> to stdout (because strings have <code>sizeof(a) - 1</code> characters due to the null terminator. This means the array <code>a</code> is actually <code>{'h', '\\0'}</code>). <code>fgets</code> is a lot safer for reading constantly sized strings than <code>scanf</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477517536, "post_id": 40271659, "comment_id": 67804910, "body": "Nice answer.  Detail: &quot;C does not do any bounds checking on array accesses;&quot; --&gt; It is simply UB,  A compiler <i>could</i> do bounds checking.  Bounds checking is certainly not specified C behavior."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 3, "last_activity_date": 1477514669, "last_edit_date": 1477514669, "creation_date": 1477514124, "answer_id": 40271659, "question_id": 40271508, "link": "https://stackoverflow.com/questions/40271508/declaring-variable-length-strings-in-c-apparently-dynamic/40271659#40271659", "title": "Declaring variable length strings in c - apparently dynamic?", "body": "<p>Two issues:</p>\n\n<ul>\n<li>C does not do any bounds checking on array accesses;</li>\n<li>Under most circumstances, an <em>expression</em> of array type will be converted to an expression of pointer type, and the value of the expression will be the address of the first element of the array.  This includes array expressions passed as arguments to functions.  </li>\n</ul>\n\n<p>The <code>%s</code> conversion specification tells <code>printf</code> to print the <em>sequence</em> of characters starting at the specified address until it sees the 0 terminator at the end of the string.  Similarly, it tells <code>scanf</code> to store a sequence of characters starting at the specified address until it sees a whitespace character or EOF.  </p>\n\n<p>When you pass the <em>expression</em> <code>s</code> as an argument to <code>scanf</code> or <code>printf</code>, the expression is converted from type \"2-element array of <code>char</code>\" to \"pointer to <code>char</code>\", and the value of the expression is the address of the first element of the array (it's equivalent to passing the expression <code>&amp;s[0]</code>).  </p>\n\n<p>All <code>scanf</code> receives is a pointer value - it has no idea how big the array starting at that address is.  So it doesn't know that <code>s</code> is only large enough to contain two characters.  Instead, it happily writes those extra characters past the end of the array.  Similarly, <code>printf</code> doesn't know that the array is only 2 characters wide - it just keeps printing until it sees that 0 terminator.</p>\n\n<p>You can specify a <em>field width</em> as part of the conversion:</p>\n\n<pre><code>scanf( \"%1s\", s ); \n</code></pre>\n\n<p>This will read <em>at most</em> 1 character from standard input and store it to <code>s</code>.  Remember that a <em>string</em> is a sequence of characters followed by a 0 terminator, so to store an N-character string, you need to set aside an N+1-element array to store it.  </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477516024, "post_id": 40271930, "comment_id": 67804180, "body": "Detail: Code can use <code>sizeof</code> to get the size of a <i>string</i>.  <code>strlen(p)</code> uses the <i>pointer</i> <code>p</code>, which points to a <i>string</i> and returns the length of the string.  In C, a <i>string</i> is an array."}], "tags": [], "owner": {"reputation": 31, "user_id": 5464278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6901aba1d6bc884bed89ab72fb201a?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Manso", "link": "https://stackoverflow.com/users/5464278/tony-manso"}, "is_accepted": false, "score": 0, "last_activity_date": 1477515260, "creation_date": 1477515260, "answer_id": 40271930, "question_id": 40271508, "link": "https://stackoverflow.com/questions/40271508/declaring-variable-length-strings-in-c-apparently-dynamic/40271930#40271930", "title": "Declaring variable length strings in c - apparently dynamic?", "body": "<p>I don't think anyone has actually answered this question yet. There are two problems here...</p>\n\n<p>First, the array \"s\" is only 2 bytes long, so <em>scanf</em> of any string more than 1 character will generate undesired results. </p>\n\n<pre><code>char s[255]; // was char s[2];\n</code></pre>\n\n<p>Also, as mentioned before, <em>scanf</em> is a horrible way to input strings. Use <em>fgets</em> instead.</p>\n\n<pre><code>fgets(s, sizeof(s), stdin); // was scanf(\"%s\", s);\n</code></pre>\n\n<p>Second, you cannot use <em>sizeof</em> to get the length of a string. It will return you the length of the array that contains the string (not what you want, trust me). Instead, use <em>strlen</em>. </p>\n\n<pre><code>printf(\"strlen s %d\", strlen(s)); // was printf(\"sizeof s %d\", sizeof(s));\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user911625"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1402, "favorite_count": 0, "accepted_answer_id": 40271659, "answer_count": 3, "score": 0, "last_activity_date": 1477515260, "creation_date": 1477513405, "question_id": 40271508, "link": "https://stackoverflow.com/questions/40271508/declaring-variable-length-strings-in-c-apparently-dynamic", "title": "Declaring variable length strings in c - apparently dynamic?", "body": "<p>I am trying to understand something basic about how 'strings' are defined in c. </p>\n\n<pre><code>char s[2];\nscanf(\"%s\", s);\nprintf(\"%s\", s);\nprintf(\"sizeof s %d\", sizeof(s));\n</code></pre>\n\n<p>I'm not a c programmer. I'm aware that there are problems with using scanf to get user input and that I'm not even checking its return value etc. This is just to understand something basic about declaring strings.</p>\n\n<p>Given the above code what it does if I enter say 'helloworld' is print 'helloworld'. Good. But I thought by saying char s[2] I was saying something like 's is an array of length two where each element is of type char'.</p>\n\n<p>Thus I was expecting to see 'he' printed. Not 'helloworld'. Because my s array only has room for 2 chars. </p>\n\n<p>The sizeof still returns 2. But it looks like my array has grown to the size of the user input.</p>\n\n<p>What is happening?</p>\n"}, {"tags": ["c", "file", "pointers", "struct"], "comments": [{"owner": {"reputation": 116, "user_id": 6307670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rpZP.jpg?s=128&g=1", "display_name": "Fredrik Lundvall", "link": "https://stackoverflow.com/users/6307670/fredrik-lundvall"}, "edited": false, "score": 0, "creation_date": 1477512616, "post_id": 40271272, "comment_id": 67802526, "body": "You should include the error you get"}, {"owner": {"reputation": 661, "user_id": 5510623, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Yyk7K.png?s=128&g=1", "display_name": "RigidBody", "link": "https://stackoverflow.com/users/5510623/rigidbody"}, "edited": false, "score": 0, "creation_date": 1477512629, "post_id": 40271272, "comment_id": 67802536, "body": "Can you give us the exact error and how are you compiling?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1477512658, "post_id": 40271272, "comment_id": 67802549, "body": "In C, <code>gets_s(informacion[i].nombre);</code>  --&gt; that needs 2 arguments,  size missing.  What did the compiler say about this line?  Are warnings all enabled?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477512693, "post_id": 40271272, "comment_id": 67802573, "body": "So your whole program is a single error? Hardly. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477512809, "post_id": 40271272, "comment_id": 67802625, "body": "<code>fflush(stdin)</code> -&gt; undefined behaviour."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1477512895, "post_id": 40271272, "comment_id": 67802671, "body": "You don&#39;t show us where/what/how your read from the file. Can&#39;t help you then, however, if you do all those <code>fprintfs</code>, what makes you think you can read a <code>struct</code>? What about <code>fscanf</code>?"}], "owner": {"reputation": 11, "user_id": 7077103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rhWOL.jpg?s=128&g=1", "display_name": "ManuelDApi", "link": "https://stackoverflow.com/users/7077103/manueldapi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477519183, "creation_date": 1477512468, "last_edit_date": 1477519183, "question_id": 40271272, "link": "https://stackoverflow.com/questions/40271272/i-cannot-pass-the-value-from-the-file-to-the-struct", "title": "I cannot pass the value from the file to the struct", "body": "<p>I'm a beginner in C, I'm trying to read a file in order to update a struct but every time I do it it gives me an error (I'm working with visual studio 2013).</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Registro{\n    int cedula;\n    char nombre[20];\n    char apellido[20];\n    char direccion[50];\n    int ingreso;\n};\n\n\nvoid agregarP(struct Registro * informacion, int * n){\n    int op,i,aux;\n    printf(\"Cuantas personas desea agregar?\\n\");\n    fflush(stdin);\n    scanf_s(\"%i\", &amp;op);\n    aux = op;\n    op += *n;\n    for (i = *n; i &lt; op; i++){\n        printf(\"Introduzca la cedula\\n\");\n        scanf_s(\"%i\", &amp;informacion[i].cedula);\n        printf(\"Introduzca el nombre\\n\");\n        fflush(stdin);\n        gets_s(informacion[i].nombre);\n        printf(\"Introduzca el apellido\\n\");\n        gets_s(informacion[i].apellido);\n        printf(\"Introduzca la direccion\\n\");\n        gets_s(informacion[i].direccion);\n        printf(\"Introduzca el ingrso anual\\n\");\n        scanf_s(\"%i\", &amp;informacion[i].ingreso);\n        system(\"cls\");\n    }\n    *n += aux;\n}\n\nbool comprobacion(int n1, int n2){\n    if (n1 == n2){\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n\nvoid borrar(struct Registro * s, int *n){\n    int i, ced;\n    struct Registro aux;\n    bool compr;\n    printf(\"Introduzca la cedula de la persona que desea borrar\\n\");\n    fflush(stdin);\n    scanf_s(\"%i\",&amp;ced);\n    for (i = 0; i &lt; *n; i++){\n        if (s[i].cedula == ced){\n            compr = comprobacion(*n, i);\n            if (compr){\n                break;\n            }\n            else{\n                aux = s[*n - 1];\n                s[*n - 1] = s[i];\n                s[i] = aux;\n                break;\n            }\n        }\n    }\n    *n -= 1;\n}\n\nvoid mostrar(struct Registro * informacion, int n){\n    int i;\n    printf(\"Cedula \\t     Nombre \\t     Apellido \\t Direccion \\t  Ingreso \\n\");\n    for (i = 0; i &lt; n; i++){\n        printf(\"%i \\t \", informacion[i].cedula);\n        printf(\"%s \\t \", informacion[i].nombre);\n        printf(\"%s \\t \", informacion[i].apellido);\n        printf(\"%s \\t \", informacion[i].direccion);\n        printf(\"%i \\n\", informacion[i].ingreso);\n    }\n}\n\n\nvoid mostrarPorOrden(struct Registro * s, int n){\n    int i, j,cont = 0, op;\n    struct Registro aux;\n    printf(\"1 para mostrar por orden de cedula\\n\");\n    printf(\"2 para mostrar por orden de apellido\\n\");\n    fflush(stdin);\n    scanf_s(\"%i\", &amp;op);\n    switch (op){\n    case 1: for (i = 0; i &lt; n+1; i++){\n                cont = 0;\n                for (int j = 0; j &lt; n - 1; j++)\n                {\n                    if (s[j].cedula &gt; s[j + 1].cedula){\n                        aux = s[j+1];\n                        s[j + 1] = s[j];\n                        s[j] = aux;\n                        cont++;\n                    }\n                }\n                if (cont == 0) break;\n    }\n            mostrar(s, n);\n            break;\n    case 2: for (i = 0; i &lt; n + 1; i++){\n                cont = 0;\n                for (int j = 0; j &lt; n - 1; j++)\n                {\n                    if (s[j].apellido[0] &gt; s[j + 1].apellido[0]){\n                        aux = s[j+1];\n                        s[j + 1] = s[j];\n                        s[j] = aux;\n                        cont++;\n                    }\n                }\n                if (cont == 0) break;\n    }\n            mostrar(&amp;s[0], n);\n            break;\n    }\n}\n\nvoid guardarArch(FILE * ff, struct Registro * s, int n){\n    fopen_s(&amp;ff, \"Datos.txt\", \"w\");\n    int i;\n    for (i = 0; i &lt; n; i++){\n        fprintf(ff,\"%d\", s[i].cedula); fprintf(ff, \"\\n\");\n        fprintf(ff, s[i].nombre); fprintf(ff, \"\\n\");\n        fprintf(ff, s[i].apellido); fprintf(ff, \"\\n\");\n        fprintf(ff, s[i].direccion); fprintf(ff, \"\\n\");\n        fprintf(ff, \"%d\",s[i].ingreso); fprintf(ff, \"\\n\");\n\n    }\n\n        fclose(ff);\n}\n\nvoid leerArch(FILE * ff, struct Registro * s, int * n){\n    fopen_s(&amp;ff, \"Datos.txt\", \"r\");\n    int i = 0;\n    while (!feof(ff)){\n\n    }\n    fclose(ff);\n}\n\nvoid main(){\n    FILE * infor = new FILE;\n    struct Registro informacion[30];\n    int op = -1;\n    int persona = 0;\n    while (op != 0){\n        printf(\"1 para agregar una persona\\n\");\n        printf(\"2 para mostrar\\n\");\n        printf(\"3 para borrar\\n\");\n        printf(\"4 para mostrar ordenado\\n\");\n        printf(\"5 para guardarlo en un archivo\\n\");\n        printf(\"6 para leer de un archivo\\n\");\n        printf(\"0 para salir\\n\");\n        scanf_s(\"%i\", &amp;op);\n        fflush(stdin);\n        switch (op)\n        {\n        case 1: agregarP(&amp;informacion[0], &amp;persona);\n            printf(\"%i\", persona);\n            break;\n        case 2: mostrar(&amp;informacion[0], persona);\n            break;\n        case 3: borrar(&amp;informacion[0], &amp;persona);\n            break;\n        case 4: mostrarPorOrden(&amp;informacion[0], persona);\n            break;\n        case 5: guardarArch(infor, &amp;informacion[0], persona);\n            break;\n        case 6: leerArch(infor, &amp;informacion[0], &amp;persona);\n            break;\n        }\n        system(\"pause\");\n        system(\"cls\");\n    }\n}\n</code></pre>\n\n<p>PD: Sorry for my english.</p>\n\n<p>Edited.</p>\n\n<p>This is the part where I'm having trouble, it breaks automatically. It reads the stuff now but with a lot of new lines </p>\n\n<pre><code>int ayudaLeer(FILE * ff, struct Registro * s, int * n){\n    if (feof(ff)) return -1;\n    char * c = new char[];\n    int p = fgetc(ff);\n    fscanf_s(ff, \"%d\", &amp;s[*n].cedula);\n    fgets(c, 20, ff);\n    fgets(s[*n].nombre, 20, ff);\n    fgets(s[*n].apellido, 20, ff);\n    fgets(s[*n].direccion, 20, ff);\n    fscanf_s(ff, \"%d\", &amp;s[*n].ingreso);\n    *n+=1;\n    ayudaLeer(ff, s, n);\n}\n\nvoid leerArch(FILE * ff, struct Registro * s, int * n){\n    fopen_s(&amp;ff, \"Datos.txt\", \"r\");\n    int i = 0;\n    ayudaLeer(ff, s, &amp;i);\n    *n = i-1;\n    fclose(ff);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477512516, "post_id": 40271208, "comment_id": 67802475, "body": "It is always a good idea to the documentation of the functions one uses. Even better if one gets a fault report. You might notice `scanf_s expects extra parameters."}, {"owner": {"reputation": 1305, "user_id": 671636, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/jxL3M.jpg?s=128&g=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/671636/matthias"}, "edited": false, "score": 0, "creation_date": 1477512519, "post_id": 40271208, "comment_id": 67802479, "body": "In Visual Studio you have a debugger, it allows you to &quot;de bug&quot; your code.  Without any further reading of your code in detail, I would say there is something wrong with pointers. Activate debugger and step through your program (one line after the other). I am pretty sure the code listed in your code did not exactly look like this. When you have an integer you pass its pointer with the &amp; operator to the scan function (to pass its pointer)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 2, "creation_date": 1477512596, "post_id": 40271208, "comment_id": 67802513, "body": "For  a start, check your braces (curly brackets) and semi-colons in the posted code."}, {"owner": {"reputation": 1305, "user_id": 671636, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/jxL3M.jpg?s=128&g=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/671636/matthias"}, "edited": false, "score": 0, "creation_date": 1477512730, "post_id": 40271208, "comment_id": 67802592, "body": "Please! We are talking about C. A real language. With a real compiler and debugger. We do not need to look for those errors. The compiler does find curly brace and semicolon errors. It is not a scripting language that just gets executed and then randomly crashes due to such errors."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1477546059, "post_id": 40271208, "comment_id": 67812300, "body": "Except that the brace error means the OP did not show us his original code."}], "answers": [{"tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1477512545, "creation_date": 1477512545, "answer_id": 40271291, "question_id": 40271208, "link": "https://stackoverflow.com/questions/40271208/visual-studio-error-in-c/40271291#40271291", "title": "Visual Studio error in C", "body": "<p>You need to call scanf_s as:</p>\n\n<pre><code>    scanf_s(\"%d\", &amp;englishmark);\n</code></pre>\n\n<p>... and similarly for the other int values.</p>\n"}], "owner": {"reputation": 19, "user_id": 7077067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25c869bfe5820cd01491b9253df4e31d?s=128&d=identicon&r=PG&f=1", "display_name": "LoneWolf", "link": "https://stackoverflow.com/users/7077067/lonewolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1477512545, "creation_date": 1477512235, "last_edit_date": 1477512437, "question_id": 40271208, "link": "https://stackoverflow.com/questions/40271208/visual-studio-error-in-c", "title": "Visual Studio error in C", "body": "<p>I'm new to C programming and I am currently reading through the Tony Royce C programming book and I am doing the exercises using Microsoft Visual studio 2015. I have code for one of them. </p>\n\n<pre><code>#include \"stdafx.h\"\n\n\nint main();\n\n    char student_name[11];\n    int mathsmark = 0;\n    int englishmark = 0;\n    int computingmark = 0;\n    int averagemark = 0;\n\n    printf_s(\"Please key in your name:\\n\");\n    scanf_s(\"%s\", student_name);\n\n    printf_s(\"Please key in your English Mark:\\n\");\n    scanf_s(\"%d\", englishmark);\n\n    printf_s(\"Please key in your Maths Mark:\\n\");\n    scanf_s(\"%d\", mathsmark);\n\n    printf_s(\"Please key in your Computing Mark:\\n\");\n    scanf_s(\"%d\", computingmark);\n\n    averagemark = englishmark + mathsmark + computingmark / 3;\n\n    printf_s(student_name, \"Your average mark is %d\", averagemark);\n\n\n\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>When I run this code however it comes up with this error:</p>\n\n<p><strong>\"Exception thrown at 0x0F830B5C (ucrtbased.dll) in Tonyroycestuff.exe: 0xC0000005: Access violation writing location 0x00500000.\nIf there is a handler for this exception, the program may be safely continued.\"</strong></p>\n\n<p>And if I press continue it comes up with this error:</p>\n\n<p><strong>\"Unhandled exception at 0xFEFEFEFE in Tonyroycestuff.exe: 0xC00001A5: An invalid exception handler routine has been detected (parameters: 0x00000003).\"</strong></p>\n\n<p>I'm not sure why and I was wondering if someone could help me with this, any help would be greatly appreciated!</p>\n"}, {"tags": ["c", "winapi", "error-handling", "pipe"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477510913, "post_id": 40270829, "comment_id": 67801694, "body": "From the documentation: <i>The select function returns the total number of socket handles that are ready and contained in the fd_set structures, zero if the time limit expired, or SOCKET_ERROR if an error occurred. If the return value is SOCKET_ERROR, WSAGetLastError can be used to retrieve a specific error code.</i> You did not check the return value. Why not?"}, {"owner": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477511042, "post_id": 40270829, "comment_id": 67801753, "body": "sorry, I checked now, its -1 I&#39;ll edit"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477511135, "post_id": 40270829, "comment_id": 67801800, "body": "Also <code>fd[2]</code> is off the end of the array so you are corrupting the stack. And can you even pass a pipe to select?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477511515, "post_id": 40270829, "comment_id": 67801981, "body": "You aren&#39;t checking for errors when calling <code>_pipe</code> either. Not really a very good show. No error checking, stack corruption,  and an error code that could hardly be clearer. The system tells you that you are passing something that is not a socket. Obvious conclusion: a pipe is not a socket. What did you think 10038 meant?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1477512304, "post_id": 40270829, "comment_id": 67802372, "body": "Have you considered looking up Winsock error 10038?"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "edited": false, "score": 0, "creation_date": 1477838669, "post_id": 40271227, "comment_id": 67915451, "body": "One question please: Can I make non-blocking read on pipe created by _pipe?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "edited": false, "score": 0, "creation_date": 1477848987, "post_id": 40271227, "comment_id": 67918370, "body": "@Rasty on Linux, yes, using the <code>O_NONBLOCK</code> or <code>O_ASYNC</code> flag of <code>pipe()</code>. But on Windows, AFAIK <code>_pipe()</code> does not support those flags. Use a Win32 pipe instead, like I suggested earlier."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1477512715, "last_edit_date": 1477512715, "creation_date": 1477512291, "answer_id": 40271227, "question_id": 40270829, "link": "https://stackoverflow.com/questions/40270829/use-select-on-pipe-returns-10038/40271227#40271227", "title": "Use select on pipe returns 10038", "body": "<p>On most platforms, pipes and sockets are both represented using file descriptors, and as such both can be used with file I/O functions that operate on file descriptors, including <code>select()</code>.</p>\n\n<p>However, on Windows, sockets and pipes are distinct object types, and are not represented using file descriptors at all.  <code>select()</code> only supports sockets, not files or pipes.  That is why you are getting error 10038, aka <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740668.aspx\" rel=\"nofollow\"><code>WSAENOTSOCK</code></a>:</p>\n\n<blockquote>\n  <p>Socket operation on nonsocket.<br>\n  <strong>An operation was attempted on something that is not a socket</strong>. Either the socket handle parameter did not reference a valid socket, or for select, a member of an fd_set was not valid.</p>\n</blockquote>\n\n<p>There is no equivalent of <code>select()</code> for pipe objects created by <code>_pipe()</code>.  All you can do is read and write.</p>\n\n<p>If you need to detect when data arrives on a pipe before reading it, use <code>CreatePipe()</code> and <code>PeekNamedPipe()</code> instead of <code>_pipe()</code>.  Otherwise, consider using Overlapped I/O or an I/O Completion Port instead.  That will allow you to start an asynchronous read operation in the background and let it notify you when it has received data.</p>\n"}], "owner": {"reputation": 173, "user_id": 6573691, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39e8b737cbc3b789746652e6fc9f3ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Rasty", "link": "https://stackoverflow.com/users/6573691/rasty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 40271227, "answer_count": 1, "score": -1, "last_activity_date": 1614679505, "creation_date": 1477510747, "last_edit_date": 1614679505, "question_id": 40270829, "link": "https://stackoverflow.com/questions/40270829/use-select-on-pipe-returns-10038", "title": "Use select on pipe returns 10038", "body": "<p>I have problem with pipes. I'm creating pipes with <code>::_pipe</code> function and want to use <code>select</code> on it but <code>WSAGetLastError</code> returns <code>10038</code> and kua is -1. Here is my code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;Winsock2.h&gt;\n#include &lt;Windows.h&gt;\n#include &lt;Winbase.h&gt;\n#include &lt;FileAPI.h&gt;\n#include &lt;io.h&gt;\n#include &lt;wchar.h&gt;\n\nint main()\n{\n  WORD wVersionRequested;\n  wVersionRequested = MAKEWORD(2, 2);\n  WSADATA wsaData;\n\n  WSAStartup(wVersionRequested, &amp;wsaData);\n  int fd[2];\n  _pipe(&amp;fd[2], 65536, 0);\n  FD_SET set;\n\n  FD_SET((unsigned int) (fd[0]), (&amp;set));\n\n  timeval time;\n  time.tv_sec = 1;\n  time.tv_usec = 0;\n  int kua = select(0, &amp;set, NULL, NULL, &amp;time);\n  printf(&quot;last -&gt;%d\\n&quot;,  WSAGetLastError());\n  fflush(stdout);\n  }\n</code></pre>\n<p>Please dont pay attention on headers, I've read some topics which had same error but none of them where like this(pipe created this way). Hope you can help. Thanks.</p>\n<p><strong>EDIT</strong>\nI changed code a little bit now its <code>_pipe(fd, 65536, 0);</code> but in this case it gives me seg fault.</p>\n"}, {"tags": ["c", "algorithm", "checksum", "correctness"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1477511983, "post_id": 40270450, "comment_id": 67802228, "body": "In the <code>naive_fletcher</code>&#39;s the <code>% 0xffff</code> in the loop are not necessary. You can do that after the loop."}, {"owner": {"reputation": 24214, "user_id": 124257, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Y1Udo.jpg?s=128&g=1", "display_name": "fresskoma", "link": "https://stackoverflow.com/users/124257/fresskoma"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1477520574, "post_id": 40270450, "comment_id": 67805939, "body": "That&#39;s why its the naive implementation I suppose :D Thanks for the hint, but the question isn&#39;t really about optimization :)"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1518861055, "post_id": 40270450, "comment_id": 84684117, "body": "@PaulOgilvie: <code>% 0xffff in the loop are not necessary</code> <i>as long as there is no overflow</i>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1518864235, "post_id": 40270450, "comment_id": 84684967, "body": "@greybeard, and what would happen in overflow? Bits that will never be used will just fall out of the register."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1518882307, "post_id": 40270450, "comment_id": 84690109, "body": "@greybeard, I don&#39;t get your point. Nothing will be added to the low part upon overflow. The high part of 16 bits are not used."}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1518886220, "post_id": 40270450, "comment_id": 84691467, "body": "@PaulOgilvie: 0x10000%0xffff is 1, not 0: carries <i>need to</i> be accounted for."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1518949625, "post_id": 40270450, "comment_id": 84704689, "body": "@greybeard, you are correct. I did not see that. I was reasoning about bitwise and."}], "answers": [{"tags": [], "owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "is_accepted": false, "score": 1, "last_activity_date": 1477511067, "creation_date": 1477511067, "answer_id": 40270926, "question_id": 40270450, "link": "https://stackoverflow.com/questions/40270450/correctness-of-fletcher32-checksum-algorithm/40270926#40270926", "title": "Correctness of Fletcher32 checksum algorithm", "body": "<p>According to the <a href=\"https://tools.ietf.org/html/rfc1146#ref-Fletcher82\" rel=\"nofollow\">standard</a>, the right method is the one that Wikipedia provides \u2014 except the name:</p>\n\n<blockquote>\n  <p>Note that the 8-bit Fletcher algorithm gives a 16-bit checksum and the 16-bit algorithm gives a 32-bit checksum.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 24214, "user_id": 124257, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Y1Udo.jpg?s=128&g=1", "display_name": "fresskoma", "link": "https://stackoverflow.com/users/124257/fresskoma"}, "edited": false, "score": 0, "creation_date": 1477553663, "post_id": 40274206, "comment_id": 67816254, "body": "Thanks for the answer! To me, this still leaves the question why all other implementations I have found do not conform to this standard. That is, a standard that nobody implements is kind of worthless, but then again I haven&#39;t seen an implementation within TCP either, maybe I should check that out."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 24214, "user_id": 124257, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Y1Udo.jpg?s=128&g=1", "display_name": "fresskoma", "link": "https://stackoverflow.com/users/124257/fresskoma"}, "edited": false, "score": 1, "creation_date": 1477690219, "post_id": 40274206, "comment_id": 67884058, "body": "I left a request for clarification with your first reference. The second and third seem quite unofficial and there was no option to put in a request for clarification. In your third reference I did not find a reference to Fletcher or its RFC."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1477528434, "last_edit_date": 1477528434, "creation_date": 1477528011, "answer_id": 40274206, "question_id": 40270450, "link": "https://stackoverflow.com/questions/40270450/correctness-of-fletcher32-checksum-algorithm/40274206#40274206", "title": "Correctness of Fletcher32 checksum algorithm", "body": "<p>In the <a href=\"https://tools.ietf.org/html/rfc1146#ref-Fletcher82\" rel=\"nofollow\">standard</a> quoted in the answer of HideFromKGB, the algorithm is trivial: the 8-bit version uses only 8 bit accumulators (\"ints\"), producing 8 bit results A and B, and the 16-bit version uses 16 bit \"ints\", producing 16 bit results A and B.</p>\n\n<p>It should be noted that what Wikipedia calls the \"32 bit Fletcher\" is actually the \"16 bit Fletcher\". The number of bits in the name refers in the standard to the number of bits in each D[i] and in each of A and B, but on Wikipedia it refers to the number of bits in the \"stacked result\", i.e. in <code>A&lt;&lt;16 | B</code> for the 32 bit result.</p>\n\n<p>I did not implement this, but maybe this can explain the difference. I am inclined to say that your interpretation (implementation) is correct.</p>\n\n<p>N.b.: also note that it is necessary to pad <code>data</code> with zeroes to the appropriate number of bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 4406521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc38b52f9f398150cf3659f4ced1667c?s=128&d=identicon&r=PG", "display_name": "Boris Krassi", "link": "https://stackoverflow.com/users/4406521/boris-krassi"}, "is_accepted": false, "score": 1, "last_activity_date": 1507049934, "creation_date": 1507049934, "answer_id": 46549752, "question_id": 40270450, "link": "https://stackoverflow.com/questions/40270450/correctness-of-fletcher32-checksum-algorithm/46549752#46549752", "title": "Correctness of Fletcher32 checksum algorithm", "body": "<p>These are <a href=\"https://en.wikipedia.org/wiki/Fletcher&#39;s_checksum#Test_vectors\" rel=\"nofollow noreferrer\">test vectors</a>, which are cross checked with two different implementations for 16-bit and for 32-bit check sums:</p>\n\n<pre><code>8-bit implementation (16-bit checksum)\n \"abcde\" -&gt; 51440 (0xC8F0)\n \"abcdef\" -&gt; 8279 (0x2057)\n \"abcdefgh\" -&gt; 1575 (0x0627)\n\n16-bit implementation (32-bit checksum)\n \"abcde\" -&gt; 4031760169 (0xF04FC729)\n \"abcdef\" -&gt; 1448095018 (0x56502D2A)\n \"abcdefgh\" -&gt; 3957429649 (0xEBE19591)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "edited": false, "score": 0, "creation_date": 1580807165, "post_id": 48837342, "comment_id": 106209572, "body": "However, fletcher32_1 and fletcher32_2 don&#39;t always generate the same result (See analysis by Sven.) E.g., fletcher32_1(0,0) gives 0x0 and fletcher32_2(0,0)=0xffffffffffffffff. In general any code found on Wikipedia that has been modified compared to references should be treated as very suspicious."}], "tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 1, "last_activity_date": 1518834940, "creation_date": 1518834940, "answer_id": 48837342, "question_id": 40270450, "link": "https://stackoverflow.com/questions/40270450/correctness-of-fletcher32-checksum-algorithm/48837342#48837342", "title": "Correctness of Fletcher32 checksum algorithm", "body": "<p>TCP Alternate Checksum Options describes the Fletcher checksum algorithm for use with TCP:  <a href=\"https://tools.ietf.org/html/rfc1146\" rel=\"nofollow noreferrer\">RFC 1146</a> dated March 1990. </p>\n\n<p>The 8-bit Fletcher algorithm which gives a 16-bit checksum and the 16-bit algorithm which gives a 32-bit checksum are discussed.</p>\n\n<p>The 8-bit Fletcher Checksum Algorithm is calculated over a sequence\n   of data octets (call them D[1] through D[N]) by maintaining 2\n   unsigned 1's-complement 8-bit accumulators A and B whose contents are\n   initially zero, and performing the following loop where i ranges from\n   1 to N:</p>\n\n<pre><code>       A := A + D[i]\n       B := B + A\n</code></pre>\n\n<p>The 16-bit Fletcher Checksum algorithm proceeds in precisely the same\n   manner as the 8-bit checksum algorithm, except that A, B and the\n   D[i] are <strong>16-bit quantities</strong>.  It is necessary (as it is with the\n   standard TCP checksum algorithm) to pad a datagram containing an odd\n   number of octets with a zero octet.</p>\n\n<p>That agrees with <a href=\"https://en.wikipedia.org/wiki/Fletcher%27s_checksum\" rel=\"nofollow noreferrer\">Wikipedia</a> algorithms. The simple testing program confirms quoted results:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;stdint.h&gt; // for uint32_t\n\n    uint32_t fletcher32_1(const uint16_t *data, size_t len)\n    {\n            uint32_t c0, c1;\n            unsigned int i;\n\n            for (c0 = c1 = 0; len &gt;= 360; len -= 360) {\n                    for (i = 0; i &lt; 360; ++i) {\n                            c0 = c0 + *data++;\n                            c1 = c1 + c0;\n                    }\n                    c0 = c0 % 65535;\n                    c1 = c1 % 65535;\n            }\n            for (i = 0; i &lt; len; ++i) {\n                    c0 = c0 + *data++;\n                    c1 = c1 + c0;\n            }\n            c0 = c0 % 65535;\n            c1 = c1 % 65535;\n            return (c1 &lt;&lt; 16 | c0);\n    }\n\n    uint32_t fletcher32_2(const uint16_t *data, size_t l)\n    {\n        uint32_t sum1 = 0xffff, sum2 = 0xffff;\n\n        while (l) {\n            unsigned tlen = l &gt; 359 ? 359 : l;\n            l -= tlen;\n            do {\n                sum2 += sum1 += *data++;\n            } while (--tlen);\n            sum1 = (sum1 &amp; 0xffff) + (sum1 &gt;&gt; 16);\n            sum2 = (sum2 &amp; 0xffff) + (sum2 &gt;&gt; 16);\n        }\n        /* Second reduction step to reduce sums to 16 bits */\n        sum1 = (sum1 &amp; 0xffff) + (sum1 &gt;&gt; 16);\n        sum2 = (sum2 &amp; 0xffff) + (sum2 &gt;&gt; 16);\n        return (sum2 &lt;&lt; 16) | sum1;\n    }\n\n    int main()\n    {\n        char *str1 = \"abcde\";  \n        char *str2 = \"abcdef\";\n\n        size_t len1 = (strlen(str1)+1) / 2; //  '\\0' will be used for padding \n        size_t len2 = (strlen(str2)+1) / 2; // \n\n        uint32_t f1 = fletcher32_1(str1,  len1);\n        uint32_t f2 = fletcher32_2(str1,  len1);\n\n        printf(\"%u %X \\n\",    f1,f1);\n        printf(\"%u %X \\n\\n\",  f2,f2);\n\n        f1 = fletcher32_1(str2,  len2);\n        f2 = fletcher32_2(str2,  len2);\n\n        printf(\"%u %X \\n\",f1,f1);\n        printf(\"%u %X \\n\",f2,f2);\n\n        return 0;\n    }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>4031760169 F04FC729                                                                                                                                                                                                                              \n4031760169 F04FC729                                                                                                                                                                                                                              \n\n1448095018 56502D2A                                                                                                                                                                                                                              \n1448095018 56502D2A \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "edited": false, "score": 0, "creation_date": 1580735361, "post_id": 60039291, "comment_id": 106183418, "body": "After that correction it seems unclear if the optimized version is faster. (It will likely depend on the hardware.) Note that this change only concerns the optimization <i>outside</i> the loop, right?"}, {"owner": {"reputation": 1142, "user_id": 1080389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72bbbf9d6adde772be8fdd187e577cd?s=128&d=identicon&r=PG", "display_name": "Sven", "link": "https://stackoverflow.com/users/1080389/sven"}, "reply_to_user": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "edited": false, "score": 1, "creation_date": 1580736730, "post_id": 60039291, "comment_id": 106184202, "body": "I didn&#39;t do the math whether 359 is the correct bound. Apart from that, the loop is correct. My correction is not needed inside the loop. It&#39;s only needed once in the end."}, {"owner": {"reputation": 1142, "user_id": 1080389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72bbbf9d6adde772be8fdd187e577cd?s=128&d=identicon&r=PG", "display_name": "Sven", "link": "https://stackoverflow.com/users/1080389/sven"}, "reply_to_user": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "edited": false, "score": 0, "creation_date": 1580946641, "post_id": 60039291, "comment_id": 106269387, "body": "I added an explanation of the number 359."}], "tags": [], "owner": {"reputation": 1142, "user_id": 1080389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72bbbf9d6adde772be8fdd187e577cd?s=128&d=identicon&r=PG", "display_name": "Sven", "link": "https://stackoverflow.com/users/1080389/sven"}, "is_accepted": false, "score": 1, "last_activity_date": 1580946628, "last_edit_date": 1580946628, "creation_date": 1580733053, "answer_id": 60039291, "question_id": 40270450, "link": "https://stackoverflow.com/questions/40270450/correctness-of-fletcher32-checksum-algorithm/60039291#60039291", "title": "Correctness of Fletcher32 checksum algorithm", "body": "<p>My answer is focusses on the correctness of <code>s = (s &amp; 0xffff) + (s &gt;&gt; 16);</code>.\nThis is obviously supposed to replace the modulo operation. Now the big issue with the modulo operation is the division that needs to be performed. The trick is to not do the division and to estimate <code>floor(s / 65535)</code>. So instead of computing <code>s - floor(s/65535)*65535</code>, which would be the same as modulo, we compute <code>s - floor(s/65536)*65535</code>. This will obviously not be equivalent to doing modulo. But it's good enough to quickly reduce the size of <code>s</code>.</p>\n\n<p>Now we have </p>\n\n<pre><code>  s - floor(s / 65536) * 65535\n= s - (s &gt;&gt; 16) * 65535\n= s - (s &gt;&gt; 16) * (65536 - 1)\n= s - (s &gt;&gt; 16) * 65536 + (s &gt;&gt; 16)\n= (s &amp; 0xffff) + (s &gt;&gt; 16)\n</code></pre>\n\n<p>Since the <code>(s &amp; 0xffff) + (s &gt;&gt; 16)</code> is not equivalent to doing the modulo, it does not suffice to use this formula. If <code>s == 65535</code> then <code>s % 65535</code> would yield zero. However, the former formula yields <code>65535</code>. So the optimized Wikipedia implementation posted here is obviously false! The last 3 lines need to be changed to</p>\n\n<pre><code>        /* Second reduction step to reduce sums to 16 bits */\n        sum1 = (sum1 &amp; 0xffff) + (sum1 &gt;&gt; 16);\n        sum2 = (sum2 &amp; 0xffff) + (sum2 &gt;&gt; 16);\n        if (sum1 &gt;= 65535) { sum1 -= 65535; }\n        if (sum2 &gt;= 65535) { sum2 -= 65535; }\n        return (sum2 &lt;&lt; 16) | sum1;\n</code></pre>\n\n<p>It is noteworthy, that I can't find the optimized implementation on the Wikipedia page anymore (February 2020).</p>\n\n<p><strong>Addendum:</strong> \nImagine <code>s</code> would be equal to the maximum unsigned 32 bit value, that is <code>0xFFFF_FFFF</code>. Then the formula <code>(s &amp; 0xffff) + (s &gt;&gt; 16);</code> yields <code>0x1FFFE</code>. That is exactly two times 65535. So the correction step <code>if (s &gt;= 65535) { s -= 65535; }</code> will not work since it subtracts 65535 at most once. So we want to keep <code>sum1</code> and <code>sum2</code> in the loops strictly smaller than <code>0xFFFF_FFFF</code>. Then the formula yields at most 2*65535-1 and the correction step will work. The following simple python program determines, that <code>sum2</code> would become too big after 360 iterations. So processing at most 359 16 bit words at a time is exactly right.</p>\n\n<pre><code>s1 = 0x1FFFD\ns2 = 0x1FFFD\nfor i in range(1,1000):\n    s1 += 0xFFFF\n    s2 += s1\n    if s2 &gt;= 0xFFFFFFFF:\n        print(i)\n        break\n</code></pre>\n"}], "owner": {"reputation": 24214, "user_id": 124257, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Y1Udo.jpg?s=128&g=1", "display_name": "fresskoma", "link": "https://stackoverflow.com/users/124257/fresskoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2311, "favorite_count": 2, "answer_count": 5, "score": 8, "last_activity_date": 1580946628, "creation_date": 1477509314, "question_id": 40270450, "link": "https://stackoverflow.com/questions/40270450/correctness-of-fletcher32-checksum-algorithm", "title": "Correctness of Fletcher32 checksum algorithm", "body": "<p>I'm having a hard time figuring out which implementation of the 32-bit variation of the <a href=\"https://en.wikipedia.org/wiki/Fletcher%27s_checksum\" rel=\"noreferrer\">Fletcher checksum algorithm</a> is correct. Wikipedia provides the following optimized implementation:</p>\n\n<pre><code>uint32_t fletcher32( uint16_t const *data, size_t words ) {\n        uint32_t sum1 = 0xffff, sum2 = 0xffff;\n        size_t tlen;\n\n        while (words) {\n                tlen = words &gt;= 359 ? 359 : words;\n                words -= tlen;\n                do {\n                        sum2 += sum1 += *data++;\n                } while (--tlen);\n                sum1 = (sum1 &amp; 0xffff) + (sum1 &gt;&gt; 16);\n                sum2 = (sum2 &amp; 0xffff) + (sum2 &gt;&gt; 16);\n        }\n        /* Second reduction step to reduce sums to 16 bits */\n        sum1 = (sum1 &amp; 0xffff) + (sum1 &gt;&gt; 16);\n        sum2 = (sum2 &amp; 0xffff) + (sum2 &gt;&gt; 16);\n        return sum2 &lt;&lt; 16 | sum1;\n}\n</code></pre>\n\n<p>In addition, I've adapted the non-optimized 16-bit example from the Wikipedia article to compute a 32-bit checksum:</p>\n\n<pre><code>uint32_t naive_fletcher32(uint16_t *data, int words) {\n   uint32_t sum1 = 0;\n   uint32_t sum2 = 0;\n\n   int index;\n   for( index = 0; index &lt; words; ++index ) {\n      sum1 = (sum1 + data[index]) % 0xffff;\n      sum2 = (sum2 + sum1) % 0xffff;\n   }\n   return (sum2 &lt;&lt; 16) | sum1;\n}\n</code></pre>\n\n<p>Both these implementations yield the same results, e.g. <code>0x56502d2a</code> for the string <code>abcdef</code>. To verify that this is indeed correct, I tried to find other implementations of the algorithm:</p>\n\n<ul>\n<li><a href=\"http://www.nitrxgen.net/hashgen/\" rel=\"noreferrer\">An online checksum/hash generator</a></li>\n<li><a href=\"https://github.com/marcows/SRecord/blob/master/srecord/fletcher32.cc\" rel=\"noreferrer\">C++ implementation in the srecord project</a></li>\n<li><a href=\"https://codepen.io/ImagineProgramming/post/checksum-algorithms-in-javascript-checksum-js-engine\" rel=\"noreferrer\">There's also a JavaScript implementation</a></li>\n</ul>\n\n<p>All of these seem to agree that the checksum for <code>abcdef</code> is <code>0x8180255</code> instead of the value given by the implementation on Wikipedia. I've narrowed this down to how the data buffer the implementation operates on. All the above non-wikipedia implementation operate one byte at a time, whereas the Wikipedia implementation computes the checksum using 16-bit words. If I modify the above \"naive\" Wikipedia implementation to operate per-byte instead, it reads like this:</p>\n\n<pre><code>uint32_t naive_fletcher32_per_byte(uint8_t *data, int words) {\n   uint32_t sum1 = 0;\n   uint32_t sum2 = 0;\n\n   int index;\n   for( index = 0; index &lt; words; ++index ) {\n      sum1 = (sum1 + data[index]) % 0xffff;\n      sum2 = (sum2 + sum1) % 0xffff;\n   }\n   return (sum2 &lt;&lt; 16) | sum1;\n}\n</code></pre>\n\n<p>The only thing that changes is the signature, really. So this modified naive implementation and the above mentioned implementations (except Wikipedia) agree that the checksum of <code>abcdef</code> is indeed <code>0x8180255</code>. </p>\n\n<p>My problem now is: which one is correct?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1477508990, "post_id": 40270231, "comment_id": 67800669, "body": "You changed the input format to <code>%s</code> a string type (which skips leading whitespace) but you didn&#39;t change the variable type to an array, and you didn&#39;t test the first element of that array. Is your teacher a &quot;professor&quot;? Some countries generate &quot;professors&quot; like confetti."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1477509303, "post_id": 40270231, "comment_id": 67800824, "body": "<a href=\"https://stackoverflow.com/questions/16833526\">stackoverflow.com/questions/16833526</a> In summary, all you needed to do was change <code>&quot;%c&quot;</code> to <code>&quot; %c&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1477509375, "post_id": 40270231, "comment_id": 67800865, "body": "@WeatherVane I&#39;m not sure what you mean by changing the variable type to an array?"}, {"owner": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1477509471, "post_id": 40270231, "comment_id": 67800915, "body": "@user3386109 well my teacher told me to change <code>%c</code> to <code>%s</code> , is there no way to make that work?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1477509484, "post_id": 40270231, "comment_id": 67800923, "body": "Your variable is <code>char code;</code> but the format spec <code>%s</code> would require say <code>char code[100];</code> and then instead of <code>if(code == &#39;A&#39;)</code> you would need <code>if(code[0] == &#39;A&#39;)</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1477509656, "post_id": 40270231, "comment_id": 67801015, "body": "The <code>%s</code> simply replaces one problem with another. It will skip leading whitespace, and that&#39;s good. That&#39;s what the space in <code>&quot; %c&quot;</code> does. But now you have the problem that it will (potentially) read more than one character, which is not what you want."}, {"owner": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1477509667, "post_id": 40270231, "comment_id": 67801019, "body": "@WeatherVane omg thank you ! this worked like a charm ! But i think from now on I will use <code>&quot; %c&quot;</code> as this seems easier"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1477509698, "post_id": 40270231, "comment_id": 67801036, "body": "Which is what the &quot;professor&quot; should have taught you, in the first place."}, {"owner": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1477509958, "post_id": 40270231, "comment_id": 67801164, "body": "@WeatherVane Thanks again!"}, {"owner": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1477510015, "post_id": 40270231, "comment_id": 67801193, "body": "@user3386109 Yes I see that now , and if I use <code>%s</code> i need to change my variable type to array also! Thanks!"}, {"owner": {"reputation": 124, "user_id": 6855462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/482954b8dcb0b8d13a5cffb09c93ee18?s=128&d=identicon&r=PG&f=1", "display_name": "The Rookie Coder", "link": "https://stackoverflow.com/users/6855462/the-rookie-coder"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1477516581, "post_id": 40270231, "comment_id": 67804444, "body": "@user3386109 Hi can you explain why a space was required to get the input of char.?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 124, "user_id": 6855462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/482954b8dcb0b8d13a5cffb09c93ee18?s=128&d=identicon&r=PG&f=1", "display_name": "The Rookie Coder", "link": "https://stackoverflow.com/users/6855462/the-rookie-coder"}, "edited": false, "score": 1, "creation_date": 1477517000, "post_id": 40270231, "comment_id": 67804672, "body": "@TheRookieCoder Most conversions (<code>&quot;%d&quot;</code>, <code>&quot;%s&quot;</code>, <code>&quot;%f&quot;</code>, etc.) will automatically skip whitespace (which includes newlines). The <code>&quot;%c&quot;</code> conversion is an exception, it doesn&#39;t skip whitespace. Putting the space in the conversion <code>&quot; %c&quot;</code> causes <code>scanf</code> to skip any whitespace that precedes the non-whitespace character that you want."}, {"owner": {"reputation": 124, "user_id": 6855462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/482954b8dcb0b8d13a5cffb09c93ee18?s=128&d=identicon&r=PG&f=1", "display_name": "The Rookie Coder", "link": "https://stackoverflow.com/users/6855462/the-rookie-coder"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1477517901, "post_id": 40270231, "comment_id": 67805050, "body": "@user3386109 Thanks.. :)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "edited": false, "score": 0, "creation_date": 1477510124, "post_id": 40270382, "comment_id": 67801256, "body": "But since the exercise requires the <code>printf</code> statements to be separated for these two inputs ,I can&#39;t really fit in <code>100A&lt;enter&gt;</code>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "edited": false, "score": 0, "creation_date": 1477510793, "post_id": 40270382, "comment_id": 67801626, "body": "@B&#225;kaV&#237;ncentH&#243;ng So you didn&#39;t write code that did what you wanted. So, now that you see that, change the code to do what you want. For example, add code to read in the <code>&lt;enter&gt;</code> after you read the integer but before you read the character."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1477509094, "creation_date": 1477509094, "answer_id": 40270382, "question_id": 40270231, "link": "https://stackoverflow.com/questions/40270231/scanfc-skipped-after-scanfd-so-my-lecturer-told-me-to-change-scanf/40270382#40270382", "title": "scanf(&quot;%c&quot;) skipped after scanf(&quot;%d&quot;), so my lecturer told me to change scanf(&quot;%d&quot;) to scanf(&quot;%s&quot;), but now the code doesn&#39;t run properly anymore", "body": "<p>You put in \"<code>100&lt;enter&gt;A</code>\". Your code is designed to read an integer followed by a character. So it read in \"<code>100</code>\" and then \"<code>&lt;enter&gt;</code>\". You should have put in \"<code>100A&lt;enter&gt;</code>\" if your code is setup to read an integer followed by a character.</p>\n\n<p>If you want to read lines of input and parse them, write code that does that. You can use such a function after you read the integer to read the line ending after it. Then you can read the character.</p>\n"}], "owner": {"reputation": 13, "user_id": 7076789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210935121232563/picture?type=large", "display_name": "B&#225;ka V&#237;ncent H&#243;ng", "link": "https://stackoverflow.com/users/7076789/b%c3%a1ka-v%c3%adncent-h%c3%b3ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477509094, "creation_date": 1477508597, "question_id": 40270231, "link": "https://stackoverflow.com/questions/40270231/scanfc-skipped-after-scanfd-so-my-lecturer-told-me-to-change-scanf", "title": "scanf(&quot;%c&quot;) skipped after scanf(&quot;%d&quot;), so my lecturer told me to change scanf(&quot;%d&quot;) to scanf(&quot;%s&quot;), but now the code doesn&#39;t run properly anymore", "body": "<p>I need some help on my exercise.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JQVkF.jpg\" rel=\"nofollow\">Question of exercise</a></p>\n\n<p>And this was my code:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\nmain()\n{\nint price,new_price;\nchar code;\n\nprintf(\"Enter the price:\");\nscanf(\"%d\",&amp;price);\nprintf(\"Enter the pricing code:\");\nscanf(\"%s\",&amp;code);\n\nif(code == 'A')\n{\n    new_price=price*0.5;\n    printf(\"New discounted price is $%d.00\",new_price);\n}\n\nelse if(code =='B')\n\n{\n    new_price=price*0.6;\n    printf(\"New discounted price is $%d.00\",new_price);\n}\n}\n</code></pre>\n\n<p>I know that scanf(\"%c\") gets skipped after input of scanf(\"%d\"), so when I asked my lecturer for a solution , she told me to change scanf(\"%c\") to scanf(\"%s\"). THe problem is , I cannot obtain the new discounted price. The value would show up as $0.00.</p>\n\n<p>This image sums up my problem</p>\n\n<p><a href=\"https://i.stack.imgur.com/XKeAE.jpg\" rel=\"nofollow\">The value shows up as $0.00 even though the code runs</a></p>\n\n<p>I tried using switch and the code works perfectly fine, but I just want to figure out a way to make this code work without using scanf(\" %c\") formatter.. Any help would be greatly appreciated ! Thanks in advance !</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1119, "user_id": 5046042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lo5M0.jpg?s=128&g=1", "display_name": "galfisher", "link": "https://stackoverflow.com/users/5046042/galfisher"}, "edited": false, "score": 2, "creation_date": 1477508420, "post_id": 40270171, "comment_id": 67800391, "body": "Please supply the input and output you are expecting, and what did you try to do to debug your program until now?"}, {"owner": {"reputation": 1668, "user_id": 6034955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd88d2a52c87063ffe42204d769c93ce?s=128&d=identicon&r=PG&f=1", "display_name": "rob", "link": "https://stackoverflow.com/users/6034955/rob"}, "edited": false, "score": 1, "creation_date": 1477508614, "post_id": 40270171, "comment_id": 67800487, "body": "I&#39;m not a C coder, but it looks like   while (numberOfDays &lt; 1 ) will run forever since numberofdays never increases.  Infinite loop."}, {"owner": {"reputation": 11081, "user_id": 2161954, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/eccdcef378f17549482325c2051c4048?s=128&d=identicon&r=PG", "display_name": "SnakeDoc", "link": "https://stackoverflow.com/users/2161954/snakedoc"}, "edited": false, "score": 0, "creation_date": 1477508636, "post_id": 40270171, "comment_id": 67800495, "body": "Welcome to StackOverflow! We&#39;d love to help - but we need you to tell us where the problem is, what the problem is, and what you expect to see from the program. Don&#39;t let the down-votes get to you, they&#39;re only happening because you haven&#39;t provided us with what we need to help you. :)"}, {"owner": {"reputation": 69, "user_id": 7076814, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1196906750332715/picture?type=large", "display_name": "Boo92", "link": "https://stackoverflow.com/users/7076814/boo92"}, "edited": false, "score": 0, "creation_date": 1477509102, "post_id": 40270171, "comment_id": 67800720, "body": "I don&#39;t know where the problem is; but what is supposed to happen is the program is supposed to take the number of days and multiply it by 15 and the number of miles is supposed to be multiplied by .40 if the mileage is under 200. If it is 200 or more, the mileage then gets multiplied by .35. When I do it, it seems to skip over my if statements."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1477513667, "post_id": 40270171, "comment_id": 67803053, "body": "@Boo92 If you can&#39;t pinpoint the location of the error, the first thing you need to do is start debugging. Put print statements into your code to print out variables to see their value, or use an actual debugger to see the full state of your program. Debugging is a crucial skill for programming"}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 6832488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeGV4.jpg?s=128&g=1", "display_name": "Mario Klebsch", "link": "https://stackoverflow.com/users/6832488/mario-klebsch"}, "is_accepted": false, "score": 1, "last_activity_date": 1477509062, "creation_date": 1477509062, "answer_id": 40270369, "question_id": 40270171, "link": "https://stackoverflow.com/questions/40270171/cannot-figure-out-why-my-code-is-not-working/40270369#40270369", "title": "Cannot figure out why my code is not working", "body": "<p>Compiling your program with gcc gives the following warning:</p>\n\n<pre><code>t.c: In function \u2018main\u2019:\nt.c:21:5: warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 2 has type \u2018float *\u2019 [-Wformat=]\n     scanf(\"%d\", &amp;numberOfMiles);\n     ^\n</code></pre>\n\n<p>The problem is, that scanf() will store the number entered at the location of numberOfMiles using a binary format used for int variables, but numberOfMiles is a float variable. The integer bit pattern interpreted as float will probably have a very different meaning, or even can be an illegal float value.</p>\n\n<p>Changing the type of numberOfMiles from float to int fixes this problem.</p>\n\n<p>You also should change the second while condition to <code>while (numberOfMiles &lt; 1)</code>.</p>\n\n<p>I hope, this helps.</p>\n\n<p>73, Mario</p>\n"}, {"tags": [], "owner": {"reputation": 1136, "user_id": 2999921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0564f700a2fe14bc0aa8152a5b97925?s=128&d=identicon&r=PG", "display_name": "cwschmidt", "link": "https://stackoverflow.com/users/2999921/cwschmidt"}, "is_accepted": true, "score": 3, "last_activity_date": 1477509069, "creation_date": 1477509069, "answer_id": 40270374, "question_id": 40270171, "link": "https://stackoverflow.com/questions/40270171/cannot-figure-out-why-my-code-is-not-working/40270374#40270374", "title": "Cannot figure out why my code is not working", "body": "<p>If <code>numberOfMiles</code> should be of type <code>float</code> you have to exchange the following line</p>\n\n<pre><code>scanf(\"%d\", &amp;numberOfMiles);\n</code></pre>\n\n<p>by</p>\n\n<pre><code>scanf(\"%f\", &amp;numberOfMiles);\n</code></pre>\n\n<p>or you can set the type to <code>int</code>.</p>\n\n<p>--</p>\n\n<p>If you want to avoid an endless loop, exchange</p>\n\n<pre><code>} while (numberOfMiles &gt; 1);\n</code></pre>\n\n<p>by</p>\n\n<pre><code>} while (numberOfMiles &lt; 1);\n</code></pre>\n\n<p>Btw. why not allow distances that are shorter than a mile?</p>\n\n<p>e.g. by</p>\n\n<pre><code>} while (numberOfMiles &lt; 0);\n</code></pre>\n\n<p>For more specific answers, you have to be more precise.</p>\n"}], "owner": {"reputation": 69, "user_id": 7076814, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1196906750332715/picture?type=large", "display_name": "Boo92", "link": "https://stackoverflow.com/users/7076814/boo92"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1477930182, "accepted_answer_id": 40270374, "answer_count": 2, "score": -8, "last_activity_date": 1477509069, "creation_date": 1477508363, "last_edit_date": 1477508539, "question_id": 40270171, "link": "https://stackoverflow.com/questions/40270171/cannot-figure-out-why-my-code-is-not-working", "closed_reason": "Not suitable for this site", "title": "Cannot figure out why my code is not working", "body": "<p>I've been trying to figure out what is wrong with my code for days; I can't seem to find it. If statements confuse me quite a bit, so I'm thinking I messed those up, but still not sure. All I know is that I'm super stumped and would love all of the help I can get.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// function  main begins program execution\nint main(void)\n{\n    int numberOfDays = 0;\n    float numberOfMiles = 0;\n    float milesCharge = 0;\n    float milesTotal = 0;\n    float total = 0;\n    float subtotal = 0;\n    float tax = 0;\n\n    do {\n        printf(\"%s\", \"How many days was car rented?\\t\");\n        scanf(\"%d\", &amp;numberOfDays);\n    } while (numberOfDays &lt; 1 );\n\n    do {\n        printf(\"%s\", \"How many miles were driven?\\t\");\n        scanf(\"%d\", &amp;numberOfMiles);\n    } while (numberOfMiles &gt; 1);\n\n    if (numberOfMiles &gt; 1 || numberOfMiles &lt; 200) {\n        milesTotal = numberOfMiles * .40;\n    } else {\n        milesTotal = numberOfMiles * .35;\n    }\n\n    subtotal = milesTotal + numberOfDays * 15;\n    tax = subtotal * .06;\n    total = tax + subtotal; \n\n    printf(\"\\nSubtotal:\\t\\t\\t$%.2f\\n\", subtotal);\n    printf(\"Tax Amount:\\t\\t\\t$%.2f\\n\", tax);\n    printf(\"Total:\\t\\t\\t\\t$%.2f\\n\", total);\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "unit-testing", "cmake", "header-files", "cmock"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7080912, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WlzFTet1mZI/AAAAAAAAAAI/AAAAAAAAAAA/_mG1AjB0Huc/photo.jpg?sz=128", "display_name": "Mark Vander Voord", "link": "https://stackoverflow.com/users/7080912/mark-vander-voord"}, "is_accepted": true, "score": 2, "last_activity_date": 1477578508, "creation_date": 1477578508, "answer_id": 40287271, "question_id": 40270089, "link": "https://stackoverflow.com/questions/40270089/cmock-multiple-definitions/40287271#40287271", "title": "CMock - Multiple definitions", "body": "<p>See the answer here: <a href=\"https://github.com/ThrowTheSwitch/CMock/issues/97\" rel=\"nofollow\">https://github.com/ThrowTheSwitch/CMock/issues/97</a></p>\n\n<p>Basically, it all comes down to linking just the files that you need for each test. When using Unity, every test becomes its own Executable.</p>\n"}], "owner": {"reputation": 4296, "user_id": 1639078, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/uHDw2.jpg?s=128&g=1", "display_name": "isuPatches", "link": "https://stackoverflow.com/users/1639078/isupatches"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 1, "accepted_answer_id": 40287271, "answer_count": 1, "score": 0, "last_activity_date": 1477578508, "creation_date": 1477508077, "question_id": 40270089, "link": "https://stackoverflow.com/questions/40270089/cmock-multiple-definitions", "title": "CMock - Multiple definitions", "body": "<p>I am starting to work in test driven C development.</p>\n\n<p>I used CMock to generate my mock classes by running commands like:</p>\n\n<pre><code>ruby cmock.rb ../../../src/util.h\n</code></pre>\n\n<p>My current package structure is:</p>\n\n<pre><code>app/root\n  | bin\n      | *.*\n  | build\n      | *.*\n  |- cmake\n     |- modules\n        |- CodeCoverage.cmake\n  |- coverage\n      |- *.*\n  |- external\n      |- Unity\n      |- CMock\n      |- CMakeLists.txt\n  |- src\n      |- *.c\n      |- *.h\n      |- CMakeLists.txt\n  |- mocks\n      |- *.c\n      |- *.h\n      |- CMakeLists.txt\n  |- tests\n      |- *.c\n      |- *.h\n      |- CMakeLists.txt\n  |- CMakeLists.txt\n</code></pre>\n\n<p>I have the CMakeLists.txt setup to compile src as a library:</p>\n\n<pre><code>add_library(app SHARED ${SOURCE_FILES})\n</code></pre>\n\n<p>Tests is setup to compile as an executable: </p>\n\n<pre><code>add_executable(tests ${TEST_SOURCES})\n\ntarget_link_libraries(tests app Unity mocks)\n</code></pre>\n\n<p>And mocks is setup to compile as a library:</p>\n\n<pre><code>add_library(mocks ${MOCK_SOURCES})\n\ntarget_link_libraries(mocks app Unity CMock)\n</code></pre>\n\n<p>I've tried multiple locations for the mock headers and have been playing around, but I'm missing a fundamental of how to not get a <strong>multiple definitions</strong> error.  </p>\n\n<p>Can anyone lend some guidance on what is incorrect about my file structure or strategy?</p>\n"}, {"tags": ["c", "multithreading", "system", "mutex", "condition-variable"], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 5432208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ehCuw.jpg?s=128&g=1", "display_name": "Remixt", "link": "https://stackoverflow.com/users/5432208/remixt"}, "edited": false, "score": 0, "creation_date": 1477666829, "post_id": 40270008, "comment_id": 67872890, "body": "I&#39;m confused, the way my code is implemented now works just fine. Are you saying that it shouldn&#39;t work, or that the way you provided is just a better way to accomplish the goal?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 641, "user_id": 5432208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ehCuw.jpg?s=128&g=1", "display_name": "Remixt", "link": "https://stackoverflow.com/users/5432208/remixt"}, "edited": false, "score": 0, "creation_date": 1477675345, "post_id": 40270008, "comment_id": 67877549, "body": "@Remixt I&#39;m saying that you got it to work in an overcomplicated way that reflects a lack of understanding of how to use the functions properly. It is also partially working by luck because it doesn&#39;t properly handle spurious wakeups and can unlock the mutex twice in a row."}, {"owner": {"reputation": 641, "user_id": 5432208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ehCuw.jpg?s=128&g=1", "display_name": "Remixt", "link": "https://stackoverflow.com/users/5432208/remixt"}, "edited": false, "score": 0, "creation_date": 1477786209, "post_id": 40270008, "comment_id": 67905250, "body": "Thanks for the clarification. I appreciate it."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 4, "last_activity_date": 1477508329, "last_edit_date": 1477508329, "creation_date": 1477507735, "answer_id": 40270008, "question_id": 40269884, "link": "https://stackoverflow.com/questions/40269884/shouldnt-this-mutex-lock-if-you-are-trying-to-access-a-global-variable/40270008#40270008", "title": "Shouldn&#39;t this mutex &quot;lock&quot; if you are trying to access a global variable?", "body": "<p>You have the wait pattern wrong. It's:</p>\n\n<pre><code>    // acquire mutex lock\n    pthread_mutex_lock(&amp;mutex);\n\n    // while buffer is empty, wait\n    while (shared_count == 0)\n    {\n        pthread_cond_wait(&amp;bufferNotEmpty,&amp;mutex);\n    } \n\n    // read key from shared buffer\n    key = shared_buffer[cons_index];\n\n    // echo key\n    printf(\"consumer %d %c\\n\", id, key);\n\n    // update shared count variable\n    shared_count--;\n\n    // update consumer index\n    if (cons_index == NITEMS - 1)\n        cons_index = 0;\n    else\n        cons_index++;\n\n    // release mutex lock and signal producer thread\n    pthread_mutex_unlock(&amp;mutex);\n    pthread_cond_signal(&amp;bufferNotFull);\n</code></pre>\n\n<p>Fix the other side the same way. You need a loop that waits until the condition is satisfied, and you want to hold the (possibly re-acquired) mutex while you mess with the shared state.</p>\n\n<p>Notice I removed the first call to <code>pthread_cond_signal</code>. Whatever <em>made</em> the <code>shared_count</code> equal zero would already have woken the other thread. We didn't change anything yet, so there's nobody we need to tell anything to yet.</p>\n\n<p>There is no point in notifying another thread if you haven't done anything that it needs to be notified about. You call <code>pthread_cond_signal</code> when you need to tell another thread that you changed some shared state that it might be waiting for.</p>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 5432208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ehCuw.jpg?s=128&g=1", "display_name": "Remixt", "link": "https://stackoverflow.com/users/5432208/remixt"}, "edited": false, "score": 1, "creation_date": 1477513704, "post_id": 40270058, "comment_id": 67803072, "body": "Thanks for the clarification!"}], "tags": [], "owner": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "is_accepted": false, "score": 1, "last_activity_date": 1477507955, "creation_date": 1477507955, "answer_id": 40270058, "question_id": 40269884, "link": "https://stackoverflow.com/questions/40269884/shouldnt-this-mutex-lock-if-you-are-trying-to-access-a-global-variable/40270058#40270058", "title": "Shouldn&#39;t this mutex &quot;lock&quot; if you are trying to access a global variable?", "body": "<blockquote>\n  <p>Upon successful return, the mutex shall have been locked and shall be\n  owned by the calling thread</p>\n  \n  <p><a href=\"https://linux.die.net/man/3/pthread_cond_wait\" rel=\"nofollow\">https://linux.die.net/man/3/pthread_cond_wait</a></p>\n</blockquote>\n\n<p><code>pthread_cond_wait()</code> will lock the mutex, so calling</p>\n\n<pre><code>pthread_cond_wait(&amp;bufferNotEmpty,&amp;mutex);\n// mutex is already locked\npthread_mutex_lock(&amp;mutex);\n// deadlock\n</code></pre>\n\n<p>will result in a deadlock</p>\n"}], "owner": {"reputation": 641, "user_id": 5432208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ehCuw.jpg?s=128&g=1", "display_name": "Remixt", "link": "https://stackoverflow.com/users/5432208/remixt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 1, "accepted_answer_id": 40270008, "answer_count": 2, "score": 0, "last_activity_date": 1477508329, "creation_date": 1477507322, "question_id": 40269884, "link": "https://stackoverflow.com/questions/40269884/shouldnt-this-mutex-lock-if-you-are-trying-to-access-a-global-variable", "title": "Shouldn&#39;t this mutex &quot;lock&quot; if you are trying to access a global variable?", "body": "<p>My source code below works exactly as its supposed to. The problem is that I managed to get it working only because I used print f statements to find out where the code was getting \"stuck\". I don't understand why in the inner while loops the mutex must be unlocked instead of locked by the function using it. I'm sorry if that isn't very clear, but I'm having problems understanding it myself.</p>\n\n<p>For sanity sake I'll put the snip of code in question at the top on its own, and the full source code below it.</p>\n\n<pre><code>            // if buffer is full, release mutex lock and check again\n        if (shared_count == NITEMS)\n        {\n            // Signal consumer thread and sleep\n            pthread_cond_signal(&amp;bufferNotEmpty);\n            pthread_cond_wait(&amp;bufferNotFull,&amp;mutex);\n            pthread_mutex_unlock(&amp;mutex);\n            break;\n        }\n</code></pre>\n\n<p>Here is the full source code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\n#define NITEMS 10               // number of items in shared buffer\n\n// shared variables\nchar shared_buffer[NITEMS];     // echo buffer\nint shared_count;               // item count\n\npthread_mutex_t mutex;          // pthread mutex\npthread_cond_t bufferNotEmpty;  // pthread condition variable for consumer thread\npthread_cond_t bufferNotFull;   // pthread condition variable for producer thread\n\nunsigned int prod_index = 0;    // producer index into shared buffer\nunsigned int cons_index = 0;    // consumer index into shared buffer\n\n// function prototypes\nvoid * producer(void *arg);\nvoid * consumer(void *arg);\n\nint main() \n{ \n    pthread_t prod_tid, cons_tid1, cons_tid2; \n\n    // initialize pthread variables\n    pthread_mutex_init(&amp;mutex, NULL);\n    pthread_cond_init(&amp;bufferNotEmpty, NULL);\n    pthread_cond_init(&amp;bufferNotFull, NULL);\n\n    // start producer thread\n    pthread_create(&amp;prod_tid, NULL, producer, NULL);\n\n    // start consumer threads\n    pthread_create(&amp;cons_tid1, NULL, consumer, NULL);\n    pthread_create(&amp;cons_tid2, NULL, consumer, NULL);\n\n    // wait for threads to finish\n    pthread_join(prod_tid, NULL);\n    pthread_join(cons_tid1, NULL);\n    pthread_join(cons_tid2, NULL);\n\n    // clean up\n    pthread_mutex_destroy(&amp;mutex);\n    pthread_cond_destroy(&amp;bufferNotEmpty);\n    pthread_cond_destroy(&amp;bufferNotFull);\n\n    return 0;\n}\n\n// producer thread executes this function\nvoid * producer(void *arg)\n{\n    char key;\n\n    while (1)\n    {\n        // read input key\n        scanf(\"%c\", &amp;key);\n\n        while (1)\n        {\n            // acquire mutex lock\n            pthread_mutex_lock(&amp;mutex);\n\n            // if buffer is full, release mutex lock and check again\n            if (shared_count == NITEMS)\n            {\n                // Signal consumer thread and sleep\n                pthread_cond_signal(&amp;bufferNotEmpty);\n                pthread_cond_wait(&amp;bufferNotFull,&amp;mutex);\n                pthread_mutex_unlock(&amp;mutex);\n                break;\n            }\n\n            else\n                break;\n        }\n\n        // store key in shared buffer\n        shared_buffer[prod_index] = key;\n\n        // update shared count variable\n        shared_count++;\n\n\n        // update producer index\n        if (prod_index == NITEMS - 1)\n            prod_index = 0;\n        else\n            prod_index++;\n\n        // release mutex lock and signal consumer thread\n        pthread_mutex_unlock(&amp;mutex); \n        pthread_cond_signal(&amp;bufferNotEmpty);\n    }\n\n    return NULL;\n}\n\n// consumer thread executes this function\nvoid * consumer(void *arg)\n{\n    char key;\n\n    int id = (int)pthread_self();\n\n    while (1)\n    {\n        while (1)\n        {\n            // acquire mutex lock\n            pthread_mutex_lock(&amp;mutex);\n\n            // if buffer is empty, wake producer thread and sleep\n            if (shared_count == 0)\n            {\n                pthread_cond_signal(&amp;bufferNotFull);\n                pthread_cond_wait(&amp;bufferNotEmpty,&amp;mutex);\n                pthread_mutex_unlock(&amp;mutex);\n            } \n\n            else\n                break;\n        }\n\n        // read key from shared buffer\n        key = shared_buffer[cons_index];\n\n        // echo key\n        printf(\"consumer %d %c\\n\", id, key);\n\n        // update shared count variable\n        shared_count--;\n\n        // update consumer index\n        if (cons_index == NITEMS - 1)\n            cons_index = 0;\n        else\n            cons_index++;\n\n        // release mutex lock and signal producer thread\n        pthread_mutex_unlock(&amp;mutex);\n        pthread_cond_signal(&amp;bufferNotFull);\n    }\n\n    return NULL;\n}\n</code></pre>\n"}, {"tags": ["c", "event-handling", "xlib", "xserver", "window-management"], "answers": [{"comments": [{"owner": {"reputation": 4501, "user_id": 1291235, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f4e8c04e8802c3ac4e53c5fa790e0b57?s=128&d=identicon&r=PG", "display_name": "Moonlit", "link": "https://stackoverflow.com/users/1291235/moonlit"}, "edited": false, "score": 0, "creation_date": 1477509643, "post_id": 40270050, "comment_id": 67801006, "body": "thank you for your suggestion. tried it but it seems that <code>event</code> has no member called <code>parent</code>: <code>\u2018XEvent {aka union _XEvent}\u2019 has no member named \u2018parent\u2019</code>"}, {"owner": {"reputation": 4501, "user_id": 1291235, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f4e8c04e8802c3ac4e53c5fa790e0b57?s=128&d=identicon&r=PG", "display_name": "Moonlit", "link": "https://stackoverflow.com/users/1291235/moonlit"}, "edited": false, "score": 0, "creation_date": 1477510751, "post_id": 40270050, "comment_id": 67801607, "body": "ah ok, thank you i&#39;s now compilable, but unfortunately the behavior is the same."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 4501, "user_id": 1291235, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f4e8c04e8802c3ac4e53c5fa790e0b57?s=128&d=identicon&r=PG", "display_name": "Moonlit", "link": "https://stackoverflow.com/users/1291235/moonlit"}, "edited": false, "score": 0, "creation_date": 1477511473, "post_id": 40270050, "comment_id": 67801963, "body": "@Moonlit maybe the other windows are the chrome added by the window manager, then.  Use <a href=\"https://tronche.com/gui/x/xlib/ICC/client-to-window-manager/XFetchName.html\" rel=\"nofollow noreferrer\">XFetchName</a> (see <a href=\"http://stackoverflow.com/q/27910906/2877364\">this question</a>) to look at the window names and see if that gives you any ideas.  Since every application will have a different configuration of windows, this might be a tricky one."}, {"owner": {"reputation": 4501, "user_id": 1291235, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f4e8c04e8802c3ac4e53c5fa790e0b57?s=128&d=identicon&r=PG", "display_name": "Moonlit", "link": "https://stackoverflow.com/users/1291235/moonlit"}, "edited": false, "score": 0, "creation_date": 1477513132, "post_id": 40270050, "comment_id": 67802787, "body": "alright, I&#39;ll investigate this and post my solution as soon I&#39;ve got it working.  In the end I just want to get notified when an application gets started/displayed, and then put it to a specified location on the screen with a specified size. Do you think I am on the right track with this approach above, or do you think there might be an easier solution?"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 4501, "user_id": 1291235, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f4e8c04e8802c3ac4e53c5fa790e0b57?s=128&d=identicon&r=PG", "display_name": "Moonlit", "link": "https://stackoverflow.com/users/1291235/moonlit"}, "edited": false, "score": 0, "creation_date": 1477513470, "post_id": 40270050, "comment_id": 67802951, "body": "@Moonlit <a href=\"https://www.freedesktop.org/wiki/Specifications/startup-notification-spec/\" rel=\"nofollow noreferrer\">this</a>?  Logging off for the day.  Good luck!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1477652705, "post_id": 40270050, "comment_id": 67864472, "body": "Top-level windows are created right and left by as much as moving your mouse (e.g. tooltips are top-level windows). You are on a wrong track. It looks like you are trying to replicate or amend window manager functionality. It is not going to work. You need to write a window manager, or interface with your existing window manager (via dbus or whatever)."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": false, "score": 0, "last_activity_date": 1477510207, "last_edit_date": 1477510207, "creation_date": 1477507934, "answer_id": 40270050, "question_id": 40269723, "link": "https://stackoverflow.com/questions/40269723/createnotify-event-called-too-often/40270050#40270050", "title": "createNotify event called too often", "body": "<p>The events are for child windows.  Per <a href=\"https://tronche.com/gui/x/xlib/events/window-state-change/create.html\" rel=\"nofollow\">the Xlib Programming Manual</a>,  \"Creating any children ... generates an event.\"  A typical X application includes numerous child windows, and you're seeing each of them.</p>\n\n<p>When you get the event, check <code>event.xcreatewindow.parent</code> (<code>XEvent</code> is a union per <a href=\"https://tronche.com/gui/x/xlib/events/structures.html\" rel=\"nofollow\">the reference</a>).  If that is <code>win</code>, the root window, you have a top-level window.  Otherwise, you have a child window.  Try:</p>\n\n<pre><code>if ( (event.type == CreateNotify) &amp;&amp; (event.xcreatewindow.parent == win) )\n    puts(\"top-level create Notify event occured\\n\");\n</code></pre>\n"}], "owner": {"reputation": 4501, "user_id": 1291235, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f4e8c04e8802c3ac4e53c5fa790e0b57?s=128&d=identicon&r=PG", "display_name": "Moonlit", "link": "https://stackoverflow.com/users/1291235/moonlit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477510207, "creation_date": 1477506716, "last_edit_date": 1477508034, "question_id": 40269723, "link": "https://stackoverflow.com/questions/40269723/createnotify-event-called-too-often", "title": "createNotify event called too often", "body": "<p>I wrote the following code to detect when a window is created on the screen by another application (not by my code):</p>\n\n<pre><code>Display* display = XOpenDisplay(\":0\");\nXSetWindowAttributes attributes;\nattributes.event_mask = SubstructureNotifyMask | StructureNotifyMask;\nWindow win = XDefaultRootWindow(display);\nXChangeWindowAttributes(display, win, CWEventMask, &amp;attributes);\n\nwhile (1) {\n   XEvent event;\n   XNextEvent(display, &amp;event);\n   if (event.type == CreateNotify)\n      puts(\"create Notify event occured\\n\");\n}\n</code></pre>\n\n<p>The code basically works, however, I noticed that, when I start an application (e.g. terminal) the <code>CreateNotify</code> event seems to be fired multiple times. Can anybody explain why? I would have expected that <code>CreateNotify</code> will only be fired <strong>once</strong> for every started application/window. How do I have to modify the code to achieve this?</p>\n"}, {"tags": ["c", "file-io", "linked-list", "scanf"], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 0, "creation_date": 1477507030, "post_id": 40269753, "comment_id": 67799619, "body": "Yeah it works for some reason, could you explain why that change works?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 1, "creation_date": 1477507172, "post_id": 40269753, "comment_id": 67799707, "body": "@lufork You are setting every node&#39;s data to the same value, a pointer to <code>buffer</code>. Thus every node has the same data."}, {"owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 0, "creation_date": 1477507295, "post_id": 40269753, "comment_id": 67799771, "body": "Oh thanks guys. But one small query, I checked on another SO question and someone mentioned that strdup is non standard and hence should not be used. So would strncpy be more encouraged in general compared to strdup? Thanks"}, {"owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 0, "creation_date": 1477523065, "post_id": 40269753, "comment_id": 67806713, "body": "<a href=\"http://stackoverflow.com/questions/25746255/linked-list-in-c-read-from-file\" title=\"linked list in c read from file\">stackoverflow.com/questions/25746255/&hellip;</a> In the comments someone wrote that strdup is not a standard function."}], "tags": [], "owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "is_accepted": true, "score": 2, "last_activity_date": 1477507171, "last_edit_date": 1477507171, "creation_date": 1477506846, "answer_id": 40269753, "question_id": 40269681, "link": "https://stackoverflow.com/questions/40269681/c-printing-a-linked-list-not-working/40269753#40269753", "title": "C printing a linked list not working?", "body": "<p>At </p>\n\n<pre><code>newNode -&gt; data = malloc((1 + strlen(str)) * sizeof(char));\nnewNode -&gt; data = str;\n</code></pre>\n\n<p>did you wanted to do a string copy (<code>strncpy()</code>) from <code>str</code> to <code>newNode-&gt;data</code>?</p>\n\n<p>With <code>newNode-&gt;data = str;</code> the pointer is copied, the contents (e.g. \"how are you\") is <strong>not</strong> copied.</p>\n\n<p>A simple way might be</p>\n\n<pre><code>newNode-&gt;data = strdup(str);\n</code></pre>\n\n<p>From <a href=\"http://man7.org/linux/man-pages/man3/strdupa.3.html\" rel=\"nofollow\">http://man7.org/linux/man-pages/man3/strdupa.3.html</a></p>\n\n<blockquote>\n<pre><code>   The strdup() function returns a pointer to a new string which is a\n   duplicate of the string s.  Memory for the new string is obtained\n   with malloc(3), and can be freed with free(3).\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "is_accepted": false, "score": 1, "last_activity_date": 1477507354, "creation_date": 1477507354, "answer_id": 40269889, "question_id": 40269681, "link": "https://stackoverflow.com/questions/40269681/c-printing-a-linked-list-not-working/40269889#40269889", "title": "C printing a linked list not working?", "body": "<p><code>newNode-&gt;data = str;</code> is the problem. You're <code>malloc</code>ing space for a string, assigning that address to <code>newNode-&gt;data</code>, then immediately overwriting the address to that <code>malloc</code>ed space with the address to <code>str</code>, which actually is the address of <code>buffer</code> all the way from <code>main</code>.  Not only does this create a memory leak, but it explains your behavior.  Each time you create a node, you're assigning <code>newNode-&gt;data</code> to the address of <code>buffer</code>, so when the last word \"you\" is stored in <code>buffer</code>, this is the string all the nodes print.  What you really want to do is <code>strcpy</code> (or something equivalent) the string from <code>str</code> into your newly <code>malloc</code>ed space.  You should also check the return value of <code>malloc</code> first to make sure it returned a valid pointer:</p>\n\n<pre><code>#include &lt;string.h&gt;\n....\n\nif (newNode-&gt;data != NULL)\n{\n  strcpy(newNode-&gt;data, str);\n}\nelse\n{\n   // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 40269753, "answer_count": 2, "score": 0, "last_activity_date": 1477507354, "creation_date": 1477506604, "question_id": 40269681, "link": "https://stackoverflow.com/questions/40269681/c-printing-a-linked-list-not-working", "title": "C printing a linked list not working?", "body": "<p>I am reading from a file and trying to add it into a linked list and then traversing through the linked list to print the content out. I have a little trouble since my output is not printing the entire linked list, but only the last element multiple times. I have posted code down below and I have posted only snippets, and have removed error checking for brevity. </p>\n\n<pre><code>typedef struct Node{\n    char* data;\n    struct Node* next;\n} NODE;\n\nNODE* head = NULL;\nNODE* tail = NULL;\n\nint main(int argc, char* argv[])\n{\n    char buffer[1024];\n    FILE* fp = fopen(argv[1], \"r\");\n    while(fscanf(fp, \"%1023s\", buffer) == 1)\n    {\n        addNode(buffer);\n    }\n    print_linked_list(head);\n    return 0;\n}\n\nvoid print_linked_list(NODE* head)\n{\n    NODE* ptr = head; \n    while(ptr != NULL)\n    {\n        printf(\"%s \", ptr -&gt; data);\n        ptr = ptr -&gt; next;\n    }\n}\n\nvoid addNode(char* str)\n{\n    NODE* newNode = createNode(str);\n    if(head == tail &amp;&amp; tail == NULL)\n    {\n        head = newNode;\n        tail = newNode;\n        head -&gt; next = NULL;\n        tail -&gt; next = NULL;\n    }\n    else\n    {\n        tail -&gt; next = newNode;\n        tail = newNode;\n        tail -&gt; next = NULL;\n    }\n}\n\nNODE* createNode(char* str)\n{\n    NODE* newNode = malloc(sizeof(NODE));\n    newNode -&gt; data = malloc((1 + strlen(str)) * sizeof(char));\n    newNode -&gt; data = str;\n    newNode -&gt; next = NULL;\n    return newNode;\n}\n</code></pre>\n\n<p>So if a file contains some text like \"how are you\", I am expecting my output to be printed as \"how are you\", but all I get is \"you you you\". How do I fix this?</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1477506476, "post_id": 40269458, "comment_id": 67799274, "body": "a) Note that getchar() returns int, and may return EOF (-1).  You need to check for errors.  b) Create the thread once, not in a loop.  c) The problem may be that input_runner() blocks on getchar() while the other thread runs. Therefore movement stays the same, i.e., the last value given.   If you want do use threads, the input thread probably needs to notify the other thread that a new event (an input event) has occured."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1477506580, "post_id": 40269458, "comment_id": 67799335, "body": "<code>movefroggy</code> takes no arguments and refers to globals ... and you want to do this in a thread?"}, {"owner": {"reputation": 45, "user_id": 5616418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yomeD.jpg?s=128&g=1", "display_name": "twistedhat", "link": "https://stackoverflow.com/users/5616418/twistedhat"}, "edited": false, "score": 0, "creation_date": 1477507003, "post_id": 40269458, "comment_id": 67799601, "body": "b) how do you mean create once and not loop if i do so i will just get the first input and the map will not be loaded before the user hit a keyword. c) i can hit a and he will move to the left just he will get stuck moving to left till i dont&#39; hit other keywod, i don&#39;t think that is the problem. For a) yes that is a good idea :)"}, {"owner": {"reputation": 45, "user_id": 5616418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yomeD.jpg?s=128&g=1", "display_name": "twistedhat", "link": "https://stackoverflow.com/users/5616418/twistedhat"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1477509336, "post_id": 40269458, "comment_id": 67800840, "body": "@BjornA. can you check the code now, i edit it a little bit, do you know how to delete threads when i don&#39;t need them."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1477510479, "post_id": 40269458, "comment_id": 67801451, "body": "The current solution won&#39;t work since the input thread will be stuck in getchar() even after a player has won or lost. As others have mentioned, you need non-blocking IO and select(). Also, have a look at pthread_cond_wait(), pthread_cond_signal() and pthread_mutex_lock()/unlock(). It&#39;s not the easiest stuff to learn, a good tutorial is probably nice to have. Good luck"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5616418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yomeD.jpg?s=128&g=1", "display_name": "twistedhat", "link": "https://stackoverflow.com/users/5616418/twistedhat"}, "edited": false, "score": 0, "creation_date": 1477506548, "post_id": 40269628, "comment_id": 67799317, "body": "User input can be gathered using getchar() but the problem with it is, that it would block the whole program waiting for the user to type in a character if used in a single-threaded environment."}], "tags": [], "owner": {"reputation": 32602, "user_id": 7050130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd06b6898f66b91234471a40cffae45?s=128&d=identicon&r=PG", "display_name": "Mark Adelsberger", "link": "https://stackoverflow.com/users/7050130/mark-adelsberger"}, "is_accepted": false, "score": 1, "last_activity_date": 1477506439, "creation_date": 1477506439, "answer_id": 40269628, "question_id": 40269458, "link": "https://stackoverflow.com/questions/40269458/threads-in-c-how-to-use-them-to-move-a-player/40269628#40269628", "title": "threads in c, how to use them to move a player?", "body": "<p>Well, it seems the simple way to only move one step would be, at the bottom of <code>moveFroggy()</code> to clear <code>movement</code> value.</p>\n\n<p>As an aside, it looks like you're creating an input-processing thread on every iteration of your game loop; is that really what you intend?  If you want an input-processing thread, why not have it run its own loop to constantly read input until the game is over?</p>\n\n<p>I'm also not sure of this overall multithreading strategy, but perhaps it will work for you...</p>\n"}, {"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 0, "last_activity_date": 1477510036, "last_edit_date": 1495542801, "creation_date": 1477510036, "answer_id": 40270634, "question_id": 40269458, "link": "https://stackoverflow.com/questions/40269458/threads-in-c-how-to-use-them-to-move-a-player/40270634#40270634", "title": "threads in c, how to use them to move a player?", "body": "<p>This is not a good use of threads, and will be prone to synchronization errors.</p>\n\n<p>Variables that are accessed by multiple threads <strong>must</strong> be protected by a mutex or accessed using atomic methods. Failing to do so will result in unpredictable behavior.</p>\n\n<p>In any case, you don't need threads for this. If you want to read from the keyboard without blocking, <a href=\"https://stackoverflow.com/questions/448944/\">there are a number of ways of doing that</a>, including:</p>\n\n<ul>\n<li>If on Linux, use the ncurses library, which natively provides non-blocking keyboard input through <code>getch()</code>.</li>\n<li>If on Windows, use <code>kbhit()</code>.</li>\n<li>Use <code>fcntl()</code> with <code>F_SETFL</code> to set standard input as non-blocking.</li>\n<li>Use <code>select()</code> or <code>poll()</code> to check for input before trying to read.</li>\n<li>Avoid the console entirely, and use a graphics library such as SDL.</li>\n</ul>\n"}], "owner": {"reputation": 45, "user_id": 5616418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yomeD.jpg?s=128&g=1", "display_name": "twistedhat", "link": "https://stackoverflow.com/users/5616418/twistedhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477510036, "creation_date": 1477505813, "last_edit_date": 1477508434, "question_id": 40269458, "link": "https://stackoverflow.com/questions/40269458/threads-in-c-how-to-use-them-to-move-a-player", "title": "threads in c, how to use them to move a player?", "body": "<p>Update my code</p>\n\n<p>So i am working on a 2d game in c, now i am using threads to do different stuff in the same time, to move the player, cars etc. </p>\n\n<p>But somehow i don't get it how can i move my player just one step, i know that the problem lays in my global variable movement. But can figure it how to do it the right way. So i hope someone can help me.</p>\n\n<p>The code is huge so i will not passt all of it but the parts that are interesting for the player movement.</p>\n\n<pre><code>void moveFroggy() {\n    //    froggy.y = SCREEN_HEIGHT - OUTER_BORDER;\n    if((movement == 'a') &amp;&amp; (froggy.x &gt; OUTER_BORDER))\n        froggy.x--;\n    if((movement == 'd') &amp;&amp; (froggy.x &lt; (SCREEN_WIDTH - OUTER_BORDER)))\n        froggy.x++;\n    if ((movement == 'w') &amp;&amp; (froggy.y &gt;= (SCREEN_HEIGHT - NUM_LANES - OUTER_BORDER - GRASS_BORDER)))\n        froggy.y--;\n    if ((movement == 's') &amp;&amp; (froggy.y &lt; (SCREEN_HEIGHT - OUTER_BORDER)))\n        froggy.y++;\n    if(movement == 'q')\n        quit = 1;\n    if(froggy.y &lt;= (SCREEN_HEIGHT - NUM_LANES - OUTER_BORDER - GRASS_BORDER))\n    player_won = 1;\n    movement = '0';\n    }\n</code></pre>\n\n<p>Now inside the main we have a while loop that runs all the time, till the player complete the game or quit it.</p>\n\n<pre><code>pthread_create(&amp;input_t, NULL, input_runner, NULL);\n\nwhile(!quit &amp;&amp; !error &amp;&amp; !player_lost &amp;&amp; !player_won) {\n    moveFroggy();\n    moveCarsOnMotorway();\n    startCar((SCREEN_WIDTH - OUTER_BORDER));\n    drawScreen();\n    usleep(GAME_SPEED);\n}\n\npthread_join(input_t, NULL);\n</code></pre>\n\n<p>So my input_t thread is calling the input_runner function inside that function i get the user input.</p>\n\n<pre><code>void *input_runner(void* arg) {\n  char input;\n  if(!player_lost || !player_won){\n    while((input = getchar()) != EOF){\n     movement = input;\n    }\n  }\n  pthread_exit(0);\n\n}\n</code></pre>\n\n<p>Just to know movement is a global variable so i can use it for moveFroggy function. but that is the problem to because it stores \"w\" and it just repeat itself till the user hit any other command. But it should move the player just one step ahead, so how can i reset the value and how to do proper clean up for threads if one is needed.</p>\n\n<p>I am new in using thread, </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 4, "creation_date": 1477505626, "post_id": 40269294, "comment_id": 67798770, "body": "Bluntly, pretty much nothing you have above is correct and you really just need to learn C. I&#39;m sorry if that sounds harsh."}, {"owner": {"reputation": 1510, "user_id": 1319819, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/49cee2918420827e36c2490b5caa9a11?s=128&d=identicon&r=PG&f=1", "display_name": "SandBag_1996", "link": "https://stackoverflow.com/users/1319819/sandbag-1996"}, "edited": false, "score": 0, "creation_date": 1477505666, "post_id": 40269294, "comment_id": 67798794, "body": "Thats not how you initialize char arrays.."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1477505774, "post_id": 40269294, "comment_id": 67798855, "body": "For starters, you cannot assign a string with <code>string_one = &quot;hello&quot;;</code> where <code>string_one</code> is an array. You must either have the correct initialisation when it is defined (<code>char string_one[20] = &quot;hello&quot;;</code>) or use <code>strcpy</code>."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1477505771, "creation_date": 1477505771, "answer_id": 40269446, "question_id": 40269294, "link": "https://stackoverflow.com/questions/40269294/returning-two-user-input-strings-to-main-using-pointers/40269446#40269446", "title": "Returning two user input strings to main using pointers", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid get_user_info(char* user_string_one, char* user_string_two)\n{\n    strcpy(user_string_one, \"hello\");\n    strcpy(user_string_two, \"goodbye\");\n}\n\nint main(void)\n{\n    char user_string_one[20];\n    char user_string_two[20];\n\n    get_user_info(user_string_one, user_string_two);\n\n    printf(\"%s %s\\n\", user_string_one, user_string_two);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1477505974, "creation_date": 1477505974, "answer_id": 40269492, "question_id": 40269294, "link": "https://stackoverflow.com/questions/40269294/returning-two-user-input-strings-to-main-using-pointers/40269492#40269492", "title": "Returning two user input strings to main using pointers", "body": "<p>Strings can't be passed around that way in C.  When an array is passed to a function as an argument, the function receives a pointer to the first element only.  A pointer is not an array.</p>\n\n<p>You need to use functions in the standard header <code>&lt;string.h&gt;</code> to copy data in strings.  For example;</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nvoid get_user_info(char* user_string_one , char* user_string_two)\n{\n        strcpy(user_string_one, \"hello\");\n        strcpy(user_string_two, \"goodbye\");\n} \n\nint main(void)\n{\n    char user_string_one[20] = \"\";\n    char user_string_two[20] = \"\";\n\n    get_user_info(user_string_one, user_string_two);\n\n    printf(\"%s %s\\n\", user_string_one, user_string_two);\n\n    return 0;\n}\n</code></pre>\n\n<p>Bear in mind that a string literal, like <code>\"hello\"</code>, is represented as an array of <code>char</code>, with a terminating <code>'\\0'</code> (a <code>char</code> with value zero) appended (a marker representing the end).   So <code>\"hello\"</code> is represented in memory using the six characters <code>'h'</code>, <code>'e'</code>, <code>'l'</code>, <code>'l'</code>, <code>'o'</code>, and <code>'\\0'</code>.   <code>strcpy()</code> and similar functions ASSUME strings are provided in that form and relies on destination arrays (the ones being copied to) being long enough to hold everything up to and including the <code>'\\0'</code> marker.</p>\n"}], "owner": {"reputation": 39, "user_id": 6312742, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/cd78a59edb73fb6b0c1fb33d40e48ceb?s=128&d=identicon&r=PG&f=1", "display_name": "cadence glorpon", "link": "https://stackoverflow.com/users/6312742/cadence-glorpon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1477505974, "creation_date": 1477505265, "question_id": 40269294, "link": "https://stackoverflow.com/questions/40269294/returning-two-user-input-strings-to-main-using-pointers", "title": "Returning two user input strings to main using pointers", "body": "<p>I am trying to figure out the proper syntax to returned two scanned strings so that I can use them in main using pointers.</p>\n\n<pre><code>void get_user_info(char* user_string_one[20] , char* user_string_two[20]) {\nchar string_one[20] = \"\";\nchar string_two[20] = \"\";\n\nstring_one = \"hello\";\nstring_two = \"goodbye\";\n\n*user_string_one = string_one;\n*user_string_two = string_two;\n\nreturn;\n}\n\nint main(void) {\nchar user_string_one[20] = \"\";\nchar user_string_two[20] = \"\";\n\nget_user_info(user_string_one[20], user_string_two[20]);\n\nprintf(\"%s %s\\n\", user_string_one, user_string_two);\n\nreturn 0;\n}\n</code></pre>\n\n<p>I am sure I am making a really simple mistake, I just can't seem to figure it out. </p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1477503949, "post_id": 40268856, "comment_id": 67797871, "body": "<code>wider shape = *(wider*)wide;</code>, pass <code>&amp;all[count]</code> instead of <code>(wider*)all[count]</code>. Pointers."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1477504022, "post_id": 40268856, "comment_id": 67797916, "body": "Read the error message again. Is the argument to the thread function <i>a pointer</i>? Does it <i>return</i> a pointer?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1477504084, "post_id": 40268856, "comment_id": 67797952, "body": "Also, the <code>sizeof</code> operator returns the size of its operands <i>in bytes</i>. For your <code>sizeof(all)</code> it will return <code>sizeof(wider) * 3</code> bytes. Not the number of elements in the array. That will affect your <code>threads</code> array size."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1477504188, "post_id": 40268856, "comment_id": 67798005, "body": "Lastly, a pointer is not a structure, and a structure is not a pointer. Pointers and structures are not the same and are you can&#39;t just cast them to one another. <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">Find a good beginners book</a> and reread the chaper(s) on pointers, and especially about the address-of operator <code>&amp;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1477505328, "creation_date": 1477505328, "answer_id": 40269321, "question_id": 40268856, "link": "https://stackoverflow.com/questions/40268856/error-in-calling-thread-expected-void-void-but-argument-is-of-type/40269321#40269321", "title": "Error in calling thread: expected &#39;void * (*)(void *)&#39; but argument is of type", "body": "<p><code>pthread_create()</code> expects a function argument that takes a <code>void*</code> as input and returns <code>void*</code>. But your function does neither. So, the compiler complains about the type mismatch.</p>\n\n<p>Instead change the function:</p>\n\n<pre><code>void* funct(void *arg){\n   wider shape = *(wider*)arg;\n   printf(\"height: %d, width %d\", shape.height, shape.width);\n   return NULL;\n}\n</code></pre>\n\n<p>Your argument passing has another problem. You are not passing the address of the <code>all[count]</code> but converting a <code>wider</code> into <code>void*</code>. Your <code>sizeof</code> calculation is wrong too. You should divide by <code>sizeof(all[0])</code> to get the correct number of <code>wider</code> elements in the <code>all</code> array.</p>\n\n<pre><code>pthread_t threads[sizeof(all)/sizeof(all[0])];\nint count=0;\nfor(count=0; count &lt;sizeof(all)/sizeof(all[0]);++count)\n{\n  if(pthread_create(&amp;threads[count], NULL, funct,&amp;all[count])!=0)\n    {\n       printf(\"Error in creating thread: %d\",count);\n       break;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1002, "user_id": 5930693, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1a482e5984773556471c90dd22f0fc12?s=128&d=identicon&r=PG&f=1", "display_name": "CoderBC", "link": "https://stackoverflow.com/users/5930693/coderbc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3436, "favorite_count": 1, "accepted_answer_id": 40269321, "answer_count": 1, "score": 1, "last_activity_date": 1477505407, "creation_date": 1477503837, "last_edit_date": 1477505407, "question_id": 40268856, "link": "https://stackoverflow.com/questions/40268856/error-in-calling-thread-expected-void-void-but-argument-is-of-type", "title": "Error in calling thread: expected &#39;void * (*)(void *)&#39; but argument is of type", "body": "<p>I have a structure defined in C as</p>\n\n<pre><code>typedef struct shape{\n   int height;\n   int width;\n\n} rectangle;\n\n// just to denote the rectangles where width &gt; height\ntypedef rectangle wider;\n\nwider all[3]={{5,10},{2,4},{7,9}};\n</code></pre>\n\n<p>and I have a function that prints the height and width</p>\n\n<pre><code>void funct(wider shape){\nprintf(\"height: %d, width %d\", shape.height, shape.width);\n}\n</code></pre>\n\n<p>Now I want to achieve this for each shape, by creating threads and so  I tried this:</p>\n\n<pre><code>pthread_t threads[sizeof(all)];\nint count=0;\nfor(count=0; count &lt;sizeof(all);++count)\n{\n  if(pthread_create(&amp;threads[count], NULL, funct,(wider*)all[count])!=0)\n    {\n    printf(\"Error in creating thread: %d\",count);\n   break;\n    }\n}\n\nint i=0;\nfor(i=0; i&lt;count; ++i)\n{\nif(pthread_join(threads[i],NULL)!=0)\n  printf (\"Eroor joining: %d\"+i);\n}\n</code></pre>\n\n<p>However, this shows an error</p>\n\n<pre><code>expected 'void * (*)(void *)' but argument is of type 'void (*)(struct rectangle)'\n</code></pre>\n\n<p>I tried changing my function to </p>\n\n<pre><code>void funct(void *wide){\nwider shape=(wider)wide;\n// print same as before\n}\n</code></pre>\n\n<p>but this still doesn't work. what am I doing wrong?</p>\n"}, {"tags": ["c", "gcc", "matrix", "matrix-multiplication", "strtol"], "comments": [{"owner": {"reputation": 21, "user_id": 6876220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a351ff6b0bc8f28f96f8c674ea1a9222?s=128&d=identicon&r=PG&f=1", "display_name": "luizflleitao", "link": "https://stackoverflow.com/users/6876220/luizflleitao"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1477528761, "post_id": 40268811, "comment_id": 67808127, "body": "No, my teacher used that in a example and I just copied, but I didn&#39;t understand at all."}], "answers": [{"tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": false, "score": 1, "last_activity_date": 1477513159, "creation_date": 1477513159, "answer_id": 40271449, "question_id": 40268811, "link": "https://stackoverflow.com/questions/40268811/matrix-multiplication-strtol/40271449#40271449", "title": "Matrix-multiplication strtol", "body": "<p>these files compiled with <code>gcc -Wall -D _MY_DEBUG_ aula0601.c aula0602.c -o aula0602</code> to define, compile and link seem to work.<br>\nconsider using <code>index</code> with the calls to <code>strtol</code> to simplify indexing <code>argv</code>.<br>\nThis also works with one print function <code>MostrarMatriz</code>.  </p>\n\n<p>aula0601.h</p>\n\n<pre><code>#define LINHAS_1                            5\n#define COLUNAS_1                           3\n#define LINHAS_2                            3\n#define COLUNAS_2                           4\n#define NUMERO_DE_ARGUMENTOS_INVALIDO       1\n#define ARGUMENTO_INVALIDO                  2\n#define NUMERO_DE_ARGUMENTOS   LINHAS_1 * COLUNAS_1 + LINHAS_2 * COLUNAS_2 + 1\n#define EOS                              '\\0'\n\nvoid\nMultiplicarMatrizes (float matriz1 [LINHAS_1][COLUNAS_1],\n                     float matriz2 [LINHAS_2][COLUNAS_2],\n                     float matrizResultado [LINHAS_1][COLUNAS_2]);\n</code></pre>\n\n<p>aula0601.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"aula0601.h\"\n\nvoid\nMultiplicarMatrizes (float matriz1 [LINHAS_1][COLUNAS_1],\n                     float matriz2 [LINHAS_2][COLUNAS_2],\n                     float matrizResultado [LINHAS_1][COLUNAS_2])\n{\n\n    unsigned contador1, contador2, contador3;\n\n    for (contador1 = 0; contador1 &lt; LINHAS_1; contador1++)\n    {\n        for (contador2 = 0; contador2 &lt; COLUNAS_2; contador2++)\n        {\n            matrizResultado[contador1][contador2] = 0;\n            for (contador3 = 0; contador3 &lt; COLUNAS_1; contador3++)\n            {\n                matrizResultado[contador1][contador2] =\n                matrizResultado[contador1][contador2] +\n                matriz1[contador1][contador3] * matriz2 [contador3][contador2];\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>aula0602.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"aula0601.h\"\n\nvoid\nMostrarMatriz (int linhas, int colunas, float matriz [linhas][colunas])\n{\n    int linhas1;\n    int colunas1;\n\n    printf(\"\\n\");\n    for (linhas1 = 0; linhas1 &lt; linhas; linhas1++)\n    {\n        for (colunas1 = 0; colunas1 &lt; colunas; colunas1++)\n            printf(\"%12.2f\", matriz [linhas1][colunas1]);\n\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n}\n\nint main( int argc, char *argv[])\n{\n    unsigned char linhas1, colunas1, linhas2, colunas2;\n    float matriz1 [LINHAS_1][COLUNAS_1];\n    float matriz2 [LINHAS_2][COLUNAS_2];\n    float matrizResultado [LINHAS_1][COLUNAS_2];\n    char *validacao;\n    int index = 1;\n\n    if (argc != NUMERO_DE_ARGUMENTOS)\n    {\n        printf(\"N\u00famero de argumentos invalido.\\n\");\n        printf(\"Uso: &lt;a11&gt; &lt;a12&gt; ... &lt;a52&gt; &lt;a53&gt; &lt;b11&gt; &lt;b12&gt; ... &lt;b33&gt; &lt;b34&gt;\\n\");\n        exit (NUMERO_DE_ARGUMENTOS_INVALIDO);\n    }\n\n    index = 1;\n    for (linhas1 = 0; linhas1 &lt; LINHAS_1; linhas1++)\n    {\n        for (colunas1 = 0; colunas1 &lt; COLUNAS_1; colunas1++)\n        {\n            matriz1 [linhas1][colunas1]\n            = (float) strtoul (argv [index++], &amp;validacao, 10);\n            if (*validacao != EOS)\n            {\n                printf(\"Caractere invalido: \\\"%c\\\"\\n\", *validacao);\n                exit(ARGUMENTO_INVALIDO);\n            }\n        }\n    }\n\n    index = ( LINHAS_1 * COLUNAS_1) + 1;\n    for (linhas2 = 0; linhas2 &lt; LINHAS_2; linhas2++)\n    {\n        for (colunas2 = 0; colunas2 &lt; COLUNAS_2; colunas2++)\n        {\n            matriz2 [linhas2][colunas2]\n            = (float) strtoul (argv [index++], &amp;validacao, 10);\n            if (*validacao != EOS)\n            {\n                printf(\"Caractere invalido: \\\"%c\\\"\\n\", *validacao);\n                exit(ARGUMENTO_INVALIDO);\n            }\n        }\n    }\n\n    #ifdef _MY_DEBUG_\n    MostrarMatriz ( LINHAS_1, COLUNAS_1, matriz1);\n    MostrarMatriz ( LINHAS_2, COLUNAS_2, matriz2);\n    #endif\n\n    MultiplicarMatrizes ( matriz1, matriz2, matrizResultado);\n\n    #ifdef _MY_DEBUG_\n    MostrarMatriz ( LINHAS_1, COLUNAS_2, matrizResultado);\n    #endif\n\n    exit ( 0);\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6876220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a351ff6b0bc8f28f96f8c674ea1a9222?s=128&d=identicon&r=PG&f=1", "display_name": "luizflleitao", "link": "https://stackoverflow.com/users/6876220/luizflleitao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1477513159, "creation_date": 1477503687, "last_edit_date": 1477508734, "question_id": 40268811, "link": "https://stackoverflow.com/questions/40268811/matrix-multiplication-strtol", "title": "Matrix-multiplication strtol", "body": "<p>I am doing something wrong at strtoul function at aula0602.c file., and I can't print the three matrices. Apparently the files aula0601.h and aula0601.c are ok, but when I execute the binary file, none is printed at the command line. </p>\n\n<p>I write the following commands at bash on Linux:</p>\n\n<p>gcc -c -Wall aula0601.c</p>\n\n<p>gcc -c -Wall aula0602.c</p>\n\n<p>gcc -o aula0602 aula0601.o aula0602.o</p>\n\n<p>./aula0602 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27</p>\n\n<p>Edited:</p>\n\n<p>I make the following commands, but nothing is printed (Itried the instruction on the commments space).</p>\n\n<p>--> gcc -c -Wall aula0601.c</p>\n\n<p>--> gcc -c -Wall aula0602.c</p>\n\n<p>--> gcc -o aula0602 aula0601.o aula0602.o</p>\n\n<p>--> ./aula0602 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27</p>\n\n<p>--> </p>\n\n<pre><code>/* aula0601.h */  \n\n#ifndef _AULA0601_\n#define _AULA0601_ \"@(#)aula0601.h $Revision$\"\n\n#define LINHAS_1                        5\n#define COLUNAS_1                       3\n#define LINHAS_2                        3\n#define COLUNAS_2                       4\n\nvoid\nMultiplicarMatrizes (float [LINHAS_1][COLUNAS_1],\n                     float [LINHAS_2][COLUNAS_2],\n                     float [LINHAS_1][COLUNAS_2]);\n\n#endif\n\n\n\n\n/* aula0601.c */\n\n#include \"aula0601.h\"\n\nvoid\nMultiplicarMatrizes (float matriz1 [LINHAS_1][COLUNAS_1],\n                     float matriz2 [LINHAS_2][COLUNAS_2],\n                     float matrizResultado [LINHAS_1][COLUNAS_2])\n{\n\n  unsigned contador1, contador2, contador3;\n\n  for (contador1 = 0; contador1 &lt; LINHAS_1; contador1++)\n  {\n    for (contador2 = 0; contador2 &lt; COLUNAS_2; contador2++)\n    {\n      matrizResultado[contador1][contador2] = 0;\n      for (contador3 = 0; contador3 &lt; COLUNAS_1; contador3++)\n      {\n        matrizResultado[contador1][contador2] =\n        matrizResultado[contador1][contador2] +\n        matriz1[contador1][contador3] * matriz2 [contador3][contador2];\n      }\n    }\n  }\n\n}\n\n\n\n/* aula0602.c */\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"aula0601.h\"\n\n\n#define NUMERO_DE_ARGUMENTOS                    LINHAS_1 * COLUNAS_1 + LINHAS_2 * COLUNAS_2 + 1\n#define OK                                      0\n#define NUMERO_DE_ARGUMENTOS_INVALIDO           1\n#define ARGUMENTO_INVALIDO                      2\n#define EOS                                     '\\0'\n\n\nvoid\nMostrarMatriz1 (float [LINHAS_1][COLUNAS_1]);\n\nvoid\nMostrarMatriz2 (float [LINHAS_2][COLUNAS_2]);\n\nvoid\nMostrarMatrizResultado (float [LINHAS_1][COLUNAS_2]);\n\n\nvoid\nMostrarMatriz1 (float matriz1 [LINHAS_1][COLUNAS_1])\n{\n\n  unsigned linhas1, colunas1;\n\n  printf(\"\\n\");\n\n  for (linhas1 = 0; linhas1 &lt; LINHAS_1; linhas1++)\n  {\n    for (colunas1 = 0; colunas1 &lt; COLUNAS_1; colunas1++)\n      printf(\"%03f\\t\", matriz1 [linhas1][colunas1]);\n    printf(\"\\n\");\n  }\n\n  printf(\"\\n\");\n\n}\n\nvoid\nMostrarMatriz2 (float matriz2 [LINHAS_2][COLUNAS_2])\n{\n\n  unsigned linhas2, colunas2;\n\n  printf(\"\\n\");\n\n  for (linhas2 = 0; linhas2 &lt; LINHAS_2; linhas2++)\n  {\n    for (colunas2 = 0; colunas2 &lt; COLUNAS_2; colunas2++)\n      printf(\"%03f\\t\", matriz2 [linhas2][colunas2]);\n    printf(\"\\n\");\n  }\n\n  printf(\"\\n\");\n\n}\n\nvoid\nMostrarMatrizResultado (float matriz1 [LINHAS_1][COLUNAS_2])\n{\n\n  unsigned linhas1, colunas2;\n\n  printf(\"\\n\");\n\n  for (linhas1 = 0; linhas1 &lt; LINHAS_1; linhas1++)\n  {\n    for (colunas2 = 0; colunas2 &lt; COLUNAS_2; colunas2++)\n      printf(\"%03f\\t\", matriz1 [linhas1][colunas2]);\n    printf(\"\\n\");\n  }\n\n  printf(\"\\n\");\n\n}\n\n\nint\nmain (int argc, char *argv[])\n{\n\n  unsigned char linhas1, colunas1, linhas2, colunas2;\n  float matriz1 [LINHAS_1][COLUNAS_1];\n  float matriz2 [LINHAS_2][COLUNAS_2];\n  float matrizResultado [LINHAS_1][COLUNAS_2];\n  char *validacao;\n\n  if (argc != NUMERO_DE_ARGUMENTOS)\n  {\n    printf(\"N\u00famero de argumentos invalido.\\n\");\n    printf(\"Uso: &lt;a11&gt; &lt;a12&gt; ... &lt;a52&gt; &lt;a53&gt; &lt;b11&gt; &lt;b12&gt; ... &lt;b33&gt; &lt;b34&gt;\\n\");\n    exit (NUMERO_DE_ARGUMENTOS_INVALIDO);\n  }\n\n  for (linhas1 = 0; linhas1 &lt; LINHAS_1; linhas1++)\n  {\n    for (colunas1 = 0; colunas1 &lt; COLUNAS_1; colunas1++)\n    {\n      matriz1 [linhas1][colunas1] =\n        (float) strtoul (argv [(linhas1 * COLUNAS_1) + colunas1 + 1], &amp;validacao, 10);\n      if (*validacao != EOS)\n      {\n        printf(\"Caractere invalido: \\\"%c\\\"\\n\", *validacao);\n        exit(ARGUMENTO_INVALIDO);\n      }\n    }\n  }\n\n  for (linhas2 = 0; linhas2 &lt; LINHAS_2; linhas2++)\n  {\n    for (colunas2 = 0; colunas2 &lt; COLUNAS_2; colunas2++)\n    {\n      matriz2 [linhas2][colunas2] =\n        (float) strtoul (argv [(linhas2 * COLUNAS_2) + colunas2 + 1], &amp;validacao, 10);\n      if (*validacao != EOS)\n      {\n        printf(\"Caractere invalido: \\\"%c\\\"\\n\", *validacao);\n        exit(ARGUMENTO_INVALIDO);\n      }\n    }\n  }\n\n  #ifdef _MY_DEBUG_\n  MostrarMatriz1 (matriz1);\n  MostrarMatriz2 (matriz2);\n  #endif\n\n  MultiplicarMatrizes (matriz1, matriz2, matrizResultado);\n\n  #ifdef _MY_DEBUG_\n  MostrarMatrizResultado (matrizResultado);\n  #endif\n\n  return OK;\n}\n</code></pre>\n"}, {"tags": ["c", "mingw", "codeblocks"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1477503533, "post_id": 40268723, "comment_id": 67797611, "body": "It is populating the array of function pointers from a list contained in the <code>&quot;proclist.h&quot;</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1477503646, "post_id": 40268723, "comment_id": 67797676, "body": "Run the file through the preprocessor and look at the preprocessed output."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477504027, "post_id": 40268723, "comment_id": 67797919, "body": "Did you have a look at the header file? Maybe you also notice the syntax of the original is different from your&#39;s. In program code, every single character is important, often even in comments and string-literals."}], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "edited": false, "score": 0, "creation_date": 1477639893, "post_id": 40269183, "comment_id": 67858006, "body": "Can we declare a function pointer and define function together something like    &#39;void (*voidFptr)(void) = {     printf(&quot;Hello\\n&quot;); }&#39;"}, {"owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "reply_to_user": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "edited": false, "score": 0, "creation_date": 1477667314, "post_id": 40269183, "comment_id": 67873206, "body": "By defining a function, you are essentially &quot;declaring a function pointer&quot;; if you have <code>void voidf(void) { printf(&quot;Hello\\n&quot;); }</code>, then <code>voidf</code> and <code>&amp;voidf</code> are equivalent and valid function pointers."}], "tags": [], "owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "is_accepted": true, "score": 7, "last_activity_date": 1477504895, "creation_date": 1477504895, "answer_id": 40269183, "question_id": 40268723, "link": "https://stackoverflow.com/questions/40268723/function-pointer-declaration-and-function-definition-together/40269183#40269183", "title": "Function Pointer declaration and function definition together", "body": "<p>This:</p>\n\n<pre><code>void (*const m_exec[N_EXECS])(void)\n</code></pre>\n\n<p>is the way you declare an array of function pointers in C. You are not alone in finding this difficult to read. It declares an array of length <code>N_EXECS</code>, where each element in the array is a function that takes no arguments and returns a pointer to a const-void.</p>\n\n<p>The braces-enclosed block after it is the array initializer; probably <code>proclist.h</code> has a whole list of function pointer declarations in it, and this is essentially pasting those into this array. If you want to see what's actually happening after the <code>#include</code>, you can use the <code>-E</code> flag of your compiler. So if this were in <code>main.c</code>, you would run:</p>\n\n<pre><code>gcc -E -Ipath/to/headers -Iother/path/to/headers main.c\n</code></pre>\n\n<p>And it would give you a (probably huge) dump of source code, which is the result of pushing that file through the preprocessor and evaluating all of the <code>#include</code> statements.</p>\n\n<p>Edit: missed your last question.</p>\n\n<p>Probably (and this is conjecture without seeing <code>proclist.h</code>), the things its defining change the contents of <code>proclist.h</code>. For example, if it contained:</p>\n\n<pre><code>#ifdef PROCESS_TIMED\n&amp;function1_timed,\n&amp;function2_timed\n#else\n&amp;function1,\n&amp;function2\n#endif\n</code></pre>\n\n<p>Then <code>#define PROCESS_TIMED</code> would change what ended up in your <code>m_exec</code> array.</p>\n"}], "owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 40269183, "answer_count": 1, "score": 3, "last_activity_date": 1477504895, "creation_date": 1477503349, "question_id": 40268723, "link": "https://stackoverflow.com/questions/40268723/function-pointer-declaration-and-function-definition-together", "title": "Function Pointer declaration and function definition together", "body": "<p>I saw some piece of code in one of the old files.</p>\n\n<pre><code>void (*const m_exec[N_EXECS])(void) =\n   {\n       #define PROCESS_DEF_TIMED(name) name,   // defines macro for use in proclist.h\n       #define PROCESS_TIMED                   // define switch for section in proclist.h\n       #include \"proclist.h\"\n       #undef PROCESS_TIMED                    // undefine switch\n       #undef PROCESS_DEF_TIMED                // undefines macro\n   }; \n</code></pre>\n\n<p>I am unable to understand the meaning of this code. Is this a function pointer with declaration and function definition together? But if I try to declare similar function pointer like below, I get compilation error</p>\n\n<pre><code>void (*voidFptr)(void) =\n{\n    printf(\"Hello\\n\");\n}\n</code></pre>\n\n<p>Also what is #define here? Why this is inside the function I am not sure.</p>\n"}, {"tags": ["c", "operating-system"], "comments": [{"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 2, "creation_date": 1477503249, "post_id": 40268454, "comment_id": 67797446, "body": "This is not a code review site.  What&#39;s your question?"}, {"owner": {"reputation": 182, "user_id": 6926863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c492f08d041fd6b3c5dc5bd879f1a67?s=128&d=identicon&r=PG&f=1", "display_name": "Hasini Silva", "link": "https://stackoverflow.com/users/6926863/hasini-silva"}, "reply_to_user": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 1, "creation_date": 1477558108, "post_id": 40268454, "comment_id": 67818874, "body": "Actually I needed to verify is there any best practices to write these kind of codes. I&#39;m absolute beginner for this operating system stuff."}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 6926863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c492f08d041fd6b3c5dc5bd879f1a67?s=128&d=identicon&r=PG&f=1", "display_name": "Hasini Silva", "link": "https://stackoverflow.com/users/6926863/hasini-silva"}, "edited": false, "score": 0, "creation_date": 1477580139, "post_id": 40268893, "comment_id": 67834016, "body": "Better I ask this. I forgot about NULL terminator. But I have something to clarify. I thought I&#39;ve already check the return value to make sure the &#39;read&#39; succeed at the beginning. if &#39;( pipe(fd) &lt; 0 ) {         perror( &quot;pipe&quot; );         exit( 1 );     }&#39;"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 182, "user_id": 6926863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c492f08d041fd6b3c5dc5bd879f1a67?s=128&d=identicon&r=PG&f=1", "display_name": "Hasini Silva", "link": "https://stackoverflow.com/users/6926863/hasini-silva"}, "edited": false, "score": 2, "creation_date": 1477582870, "post_id": 40268893, "comment_id": 67835925, "body": "@hasinisilva Checking the return value from <code>pipe</code> tells you whether the pipe was created successfully. Under normal conditions, if creating the pipe worked, then the <code>read</code> should succeed. But it&#39;s good practice to check the return value from <code>read</code> anyways. For example, if the parent is stopped by a <code>SIGSTOP</code> or <code>SIGKILL</code> before it sends the message, then the <code>read</code> in the child will fail."}, {"owner": {"reputation": 182, "user_id": 6926863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c492f08d041fd6b3c5dc5bd879f1a67?s=128&d=identicon&r=PG&f=1", "display_name": "Hasini Silva", "link": "https://stackoverflow.com/users/6926863/hasini-silva"}, "edited": false, "score": 0, "creation_date": 1477583529, "post_id": 40268893, "comment_id": 67836402, "body": "now I got it. I was misunderstanding that. Anyway I appreciate, you answered me. I could clear so many uncertain points. And the other confusing thing was &#39;exit(1)&#39;. Why we always use &#39;1&#39; rather than other numeric value. I tried using 0 once. Code was executed without any trouble."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 182, "user_id": 6926863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c492f08d041fd6b3c5dc5bd879f1a67?s=128&d=identicon&r=PG&f=1", "display_name": "Hasini Silva", "link": "https://stackoverflow.com/users/6926863/hasini-silva"}, "edited": false, "score": 1, "creation_date": 1477584890, "post_id": 40268893, "comment_id": 67837274, "body": "@hasinisilva The value that you pass to <code>exit</code> has no effect inside your program. However, if you call the program from a shell script, then the value is returned to the script. And the script can take different actions depending on whether your program succeeded or failed. Normally, <code>exit(0)</code> indicates that the program succeeded, and any other value indicates that the program failed."}, {"owner": {"reputation": 182, "user_id": 6926863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c492f08d041fd6b3c5dc5bd879f1a67?s=128&d=identicon&r=PG&f=1", "display_name": "Hasini Silva", "link": "https://stackoverflow.com/users/6926863/hasini-silva"}, "edited": false, "score": 1, "creation_date": 1477587191, "post_id": 40268893, "comment_id": 67838657, "body": "Actually I just got to know it. I used to use exit() without knowing exact thing behind it. It&#39;s good to have great help like this. Thanks @user3386109"}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 5, "last_activity_date": 1477548608, "last_edit_date": 1477548608, "creation_date": 1477503973, "answer_id": 40268893, "question_id": 40268454, "link": "https://stackoverflow.com/questions/40268454/pipe-between-child-and-parent-process/40268893#40268893", "title": "pipe() between child and parent process", "body": "<p>The <code>switch</code> statement is mostly ok, although you don't need the <code>pid</code> variable since you don't do anything with it.</p>\n\n<p>The parent code is also mostly ok, but the string is actually 18 bytes without the NUL terminator, and 19 bytes with the NUL terminator. It's good practice to handle the newline and NUL terminator in the child, so I would stick with 17 and remove the newline from the string.</p>\n\n<p>The child code is wrong. You need a variable to store the return value from <code>read</code>. You need to check the return value to make sure the <code>read</code> succeeded. And you need to add a NUL terminator to the string. In the C programming language, a <em>\"string\"</em> is an array of characters that ends with a zero byte (called the NUL terminator, and written as <code>'\\0'</code>). It's your job to make sure that the buffers you use are always big enough to hold the NUL terminator, and that every string <em>has</em> a NUL terminator. </p>\n\n<p>So the fixed code looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main( void )\n{\n    int fd[2];\n    char buffer[20];\n\n    if ( pipe(fd) &lt; 0 ) {\n        perror( \"pipe\" );\n        exit( 1 );\n    }\n\n    switch( fork() ) {\n        case -1:\n            perror( \"fork\" );\n            exit( 1 );\n\n        case 0:\n            /*child process*/\n            close(fd[1]);\n            ssize_t count = read( fd[0], buffer, sizeof(buffer)-1 );\n            if ( count &lt;= 0 ) {\n                perror( \"read\" );\n                exit( 1 );\n            }\n            buffer[count] = '\\0';\n            printf( \"Child read message from parent: %s\\n\", buffer );\n            exit(1);\n\n        default:\n            /*parent process*/\n            close(fd[0]);\n            char *message = \"Hello from parent\";\n            size_t length = strlen( message );\n            write( fd[1], message, length );\n            break;\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 182, "user_id": 6926863, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c492f08d041fd6b3c5dc5bd879f1a67?s=128&d=identicon&r=PG&f=1", "display_name": "Hasini Silva", "link": "https://stackoverflow.com/users/6926863/hasini-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3428, "favorite_count": 1, "accepted_answer_id": 40268893, "answer_count": 1, "score": 4, "last_activity_date": 1477548608, "creation_date": 1477502385, "question_id": 40268454, "link": "https://stackoverflow.com/questions/40268454/pipe-between-child-and-parent-process", "title": "pipe() between child and parent process", "body": "<p>I write this code for pipe() between child and parent process. I need to ensure whether this is a correct code or not. By the way it's gives the answer what is suppose to see !    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n\n\nint main(int argc, char *argv[]){\n    pid_t pid;\n    int fd[2];\n    char buf[20];\n\npipe(fd);\n\n\nswitch(pid = fork()){\n\n    case -1:\n        perror(\"pipe\");\n        exit(1);\n\n    case 0: \n        /*child process*/\n        close(fd[1]);\n        read(fd[0], buf, 20);\n        printf(\"Child read message from parent: %s\\n\", buf);\n        exit(1);\n        break;\n\n    default:\n     /*parent process*/\n        close(fd[0]);\n        write(fd[1], \"Hello from parent\\n\", 17);\n        break;\n    } \n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477502143, "post_id": 40268362, "comment_id": 67796831, "body": "You should use seperate headers. C and C++ are different languages."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1477502503, "post_id": 40268362, "comment_id": 67797036, "body": "<code>#ifndef __cplusplus</code> ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1477502832, "post_id": 40268362, "comment_id": 67797230, "body": "In MSVC, <code>stdlib.h</code> already contains the macros <code>min </code> and <code>max</code>, which are controlled by <code>#ifndef __cplusplus ... #endif</code>"}], "owner": {"reputation": 79, "user_id": 5546019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S9vUT.jpg?s=128&g=1", "display_name": "Jagadeesh", "link": "https://stackoverflow.com/users/5546019/jagadeesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1477502121, "creation_date": 1477502085, "last_edit_date": 1477502121, "question_id": 40268362, "link": "https://stackoverflow.com/questions/40268362/how-to-define-macros-only-for-c-compilers", "title": "How to define macros only for c compilers?", "body": "<p>I am building a application in c and c++. I have header file st.h in which i defined two macros min and max.\nI need to compile these macros only for .c file calls and   for .cpp file  calls it should not preprocess  these macros.It should preprocess for .c file calls for below macros. What is the option to undefine these macros only for.cpp files??    </p>\n\n<pre><code>#define max(a, b)  (((a) &gt; (b)) ? (a) : (b))\n#define min(a, b)  (((a) &lt; (b)) ? (a) : (b))\n</code></pre>\n"}, {"tags": ["c", "overflow", "fread"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1477502168, "post_id": 40268339, "comment_id": 67796845, "body": "Your problem in the allocated size of <code>charString</code> most likely."}, {"owner": {"reputation": 698, "user_id": 1651859, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ebe4a0622e91e002e3960dc5b53841f8?s=128&d=identicon&r=PG", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/1651859/gaurav"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1477502331, "post_id": 40268339, "comment_id": 67796935, "body": "Changed it to correct code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1477502380, "post_id": 40268339, "comment_id": 67796964, "body": "What&#39;s <code>else true</code>?  change it to <code>else return true</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1477502644, "post_id": 40268339, "comment_id": 67797118, "body": "<a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 2, "last_activity_date": 1477503178, "creation_date": 1477503178, "answer_id": 40268675, "question_id": 40268339, "link": "https://stackoverflow.com/questions/40268339/fread-leads-to-heap-overflow/40268675#40268675", "title": "fread leads to heap overflow", "body": "<p>What you say can't be true: <code>sizeof_data</code> is 1024 and the buffer is too, so no problem there. So the problem is in code you don't show us. Two possibilities:</p>\n\n<ol>\n<li><p><code>sizeof_data</code> is larger than the buffer and you overwrite the stack (or other data);</p></li>\n<li><p>You expect to read a string and don't terminate it with `\\0' and later you print it, causing f/s/printf to cause a segfault.</p></li>\n</ol>\n\n<p>Try this code:</p>\n\n<pre><code>    char charString[1024];\n    size_t n;\n\n    if ((n=fread(charString, 1, (sizeof_data&lt;1024?sizeof_data:1023), filePointer))==0)\n        return false;\n    CharString[n]='\\0';          // terminate\n    printf(\"%s\\n\",charString);   // safe to print now\n    return true;\n</code></pre>\n\n<p>Note that we want to read chars, so item size is 1, and we want to read up to 1023 of them, so count is max 1024.</p>\n"}], "owner": {"reputation": 698, "user_id": 1651859, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ebe4a0622e91e002e3960dc5b53841f8?s=128&d=identicon&r=PG", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/1651859/gaurav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 40268675, "answer_count": 1, "score": -1, "last_activity_date": 1477503178, "creation_date": 1477501989, "last_edit_date": 1477502423, "question_id": 40268339, "link": "https://stackoverflow.com/questions/40268339/fread-leads-to-heap-overflow", "title": "fread leads to heap overflow", "body": "<p>Using below c code snippet</p>\n\n<pre><code>char charString[1024];\n\nif (fread(charString, sizeof_data, 1, filePointer) != 1){ return false;}\nelse return true;\n</code></pre>\n\n<p>If I provide \nsizeof_data = 1024 and file pointed by filePointer have only 10bytes to read from file. I receive Abort signal from program.</p>\n\n<p>How do I handle it gracefully?</p>\n"}, {"tags": ["c++", "c", "visual-studio", "visual-studio-2015", "precompiled-headers"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1477500838, "post_id": 40267915, "comment_id": 67796206, "body": "Remove all .pch files the compiler complains about."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1477501463, "post_id": 40267915, "comment_id": 67796516, "body": "You only selected the file, you are looking at the wrong tool window.  Instead, right-click it and choose Properties to bring up the property pages for the file."}, {"owner": {"reputation": 172, "user_id": 6355709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ce6786b1f4abb994b373518a0f17b?s=128&d=identicon&r=PG&f=1", "display_name": "asantacreu", "link": "https://stackoverflow.com/users/6355709/asantacreu"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1477555521, "post_id": 40267915, "comment_id": 67817322, "body": "@n.m. Deleted even the entire folder.. no luck."}, {"owner": {"reputation": 172, "user_id": 6355709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ce6786b1f4abb994b373518a0f17b?s=128&d=identicon&r=PG&f=1", "display_name": "asantacreu", "link": "https://stackoverflow.com/users/6355709/asantacreu"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1477555688, "post_id": 40267915, "comment_id": 67817424, "body": "@HansPassant I edited the post with an image showing what I click when trying to select properties."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1477557844, "post_id": 40267915, "comment_id": 67818705, "body": "You are still looking at the wrong tool window.  I don&#39;t know why you can&#39;t see the settings dialog for the file, maybe your VS2015 install is broken.  Try another machine."}, {"owner": {"reputation": 172, "user_id": 6355709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ce6786b1f4abb994b373518a0f17b?s=128&d=identicon&r=PG&f=1", "display_name": "asantacreu", "link": "https://stackoverflow.com/users/6355709/asantacreu"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1477558976, "post_id": 40267915, "comment_id": 67819422, "body": "@HansPassant I found a workaround, its explained in the answer. Thank you for your time!"}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 6355709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ce6786b1f4abb994b373518a0f17b?s=128&d=identicon&r=PG&f=1", "display_name": "asantacreu", "link": "https://stackoverflow.com/users/6355709/asantacreu"}, "reply_to_user": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1477640325, "post_id": 40280227, "comment_id": 67858214, "body": "Wow,Of course you can @shrike didn&#39;t you see the question linked? Moreover, if you take a look at my screenshot, I am in the property page of the file <b>autofit.c</b> not in the project properties. So, yes, I can <b>Not Use</b> precompiled headers for a single file and <b>Use</b> them for the rest of the project."}, {"owner": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 0, "creation_date": 1477643686, "post_id": 40280227, "comment_id": 67859792, "body": "You&#39;re right, indeed.(Should better refrain commenting sometimes...) Now I know it is possible, comment removed so far, thanks."}], "tags": [], "owner": {"reputation": 172, "user_id": 6355709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ce6786b1f4abb994b373518a0f17b?s=128&d=identicon&r=PG&f=1", "display_name": "asantacreu", "link": "https://stackoverflow.com/users/6355709/asantacreu"}, "is_accepted": true, "score": 2, "last_activity_date": 1477644144, "last_edit_date": 1477644144, "creation_date": 1477558413, "answer_id": 40280227, "question_id": 40267915, "link": "https://stackoverflow.com/questions/40267915/cant-disable-precompiled-headers-for-single-c-file-in-vs2015/40280227#40280227", "title": "Can&#39;t disable precompiled headers for single C file in VS2015", "body": "<p>I found a workaround to make the right tool I needed appear... I leave it here as an answer in case someone else encounters this problem.</p>\n\n<p>It won't appear by clicking file -> <em>Properties</em>, but it appears when clicking project -> <em>Properties</em> so, once opened, I selected the file autofit.c from the tree view and finally I could disable precompiled headers from this  single file !</p>\n\n<p><a href=\"https://i.stack.imgur.com/85jxE.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/85jxE.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 172, "user_id": 6355709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ce6786b1f4abb994b373518a0f17b?s=128&d=identicon&r=PG&f=1", "display_name": "asantacreu", "link": "https://stackoverflow.com/users/6355709/asantacreu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 40280227, "answer_count": 1, "score": 1, "last_activity_date": 1487760443, "creation_date": 1477500384, "last_edit_date": 1495542715, "question_id": 40267915, "link": "https://stackoverflow.com/questions/40267915/cant-disable-precompiled-headers-for-single-c-file-in-vs2015", "title": "Can&#39;t disable precompiled headers for single C file in VS2015", "body": "<p>I'm trying to disable precompiled headers for the C files of my project because VS2015 gives me this error (line broken for readability): </p>\n\n<pre><code>..\\..\\..\\..\\Lib\\freetype2\\src\\autofit\\autofit.c : fatal error C1853: \n  'Y:\\obj\\TwoNav_PC_15\\headers\\CompeTwoNav.pch' precompiled header file \n  is from a previous version of the compiler, or the precompiled header \n  is C++ and you are using it from C (or vice versa)\n</code></pre>\n\n<p>Looking on how to do it I found <a href=\"https://stackoverflow.com/questions/9318951/disabling-precompiled-headers-for-a-specific-file-in-a-vc-2010-project\">this post</a>,\nbut when I try to do it in my Visual Studio 2015 Professional, I can't see the option referred to. </p>\n\n<p><strong>Edit</strong>: This is how I try to select the properties:</p>\n\n<p><img src=\"https://i.stack.imgur.com/7xuWB.png\" alt=\"enter image description here\"></p>\n\n<p>This image is what I see when I select the properties of the file:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1IGMH.png\" alt=\"File Properties dialogbox\"></p>\n"}, {"tags": ["c", "algorithm", "hashmap"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1477501154, "post_id": 40267815, "comment_id": 67796368, "body": "Reading:<a href=\"https://en.m.wikipedia.org/wiki/Hash_table\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/Hash_table</a>"}], "answers": [{"comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1477501117, "post_id": 40267982, "comment_id": 67796345, "body": "10 items per bucket, load factor 10, seems extremely high... Might be justifiable for some uses, but load factor around 1 seems better for general purpose use."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1477501832, "post_id": 40267982, "comment_id": 67796715, "body": "I&#39;m assuming that he doesn&#39;t want to go to the trouble of writing code to vary the number of buckets as the number of elements changes. That forces a compromise between high load factor when the table has lots of elements versus wasted memory when it has very few."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1477502445, "post_id": 40267982, "comment_id": 67797009, "body": "Isn&#39;t it more common to decide the load factor, and then do re-hashing with larger bucket count when it is exceeded. In any case the buckets need to be dynamic, or some othet strategy is needed for worst case input (possibly intentionally crafted), which will put most (or all) items in one bucket."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1477502551, "post_id": 40267982, "comment_id": 67797060, "body": "I&#39;m not really sure which approach is more common. But for someone trying to learn how to make a hash table, the logical next step is to support some fixed number of buckets with collisions."}, {"owner": {"reputation": 1733, "user_id": 5018637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa5267033b2b33f15648273cbe845534?s=128&d=identicon&r=PG&f=1", "display_name": "user464502", "link": "https://stackoverflow.com/users/5018637/user464502"}, "edited": false, "score": 0, "creation_date": 1477514061, "post_id": 40267982, "comment_id": 67803237, "body": "Prime values for bucket counts is better for open addressing, but not of much use with separate chaining, where I&#39;d suggest power-of-two number of buckets."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1477500659, "creation_date": 1477500659, "answer_id": 40267982, "question_id": 40267815, "link": "https://stackoverflow.com/questions/40267815/how-to-design-a-hashtable-that-doesnt-use-so-much-memory/40267982#40267982", "title": "How to design a hashtable that doesn&#39;t use so much memory?", "body": "<p>Decide how many buckets you want the hash to have based on the number of items that it will have, and then reduce the hash range to that range.</p>\n\n<p>So if you want a hash to hold around 100,000 items with around 10 items per bucket, you want around 10,000 buckets. So after you compute the hash, take the hash modulo 10,000 to decide which bucket to put the item in.</p>\n\n<p>Generally, using prime values for the bucket counts tend to work best, so perhaps 9,973.</p>\n"}], "owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 40267982, "answer_count": 1, "score": 0, "last_activity_date": 1477500659, "creation_date": 1477500085, "last_edit_date": 1477500420, "question_id": 40267815, "link": "https://stackoverflow.com/questions/40267815/how-to-design-a-hashtable-that-doesnt-use-so-much-memory", "title": "How to design a hashtable that doesn&#39;t use so much memory?", "body": "<p>To learn C, I'm designing a simple object system, perhaps for a Forth-like lanugage. One of the datastructures I've designed is the hashtable, or <code>hash_t</code>. </p>\n\n<pre><code>typedef struct {\n  array_t* keys;     // intelligent array object\n  assoc_t* vals;     // array&lt;pair&gt;\n\n  ssize_t* idxs;     // raw C array\n  size_t   idxs_len; // and its length\n\n} hash_t;\n</code></pre>\n\n<p>I've implemented it under my understanding of this description of <a href=\"https://stackoverflow.com/questions/39980323/dictionaries-are-ordered-in-python-3-6\">Python 3.6's dictionaries</a>:</p>\n\n<pre><code>a hashtable consists of:\n    non-sparse array_t of keys\n    non-sparse associative array of pairs of values and their key's hashes\n    sparse raw array of which values map to which actual entries.\n\n  { 1: 'a', 2: 'b', 3: 'c' }\n\n  is represented in this structure as:\n\n  hash-&gt;keys = array{ 1, 2, 3 }\n  hash-&gt;vals = assoc{\n    pair{ 'a' 5 }\n    pair{ 'b' 7 }\n    pair{ 'c' 9 }\n  }\n  hash-&gt;idxs = array{ -1 -1 -1 -1 -1  0 -1  1 -1  2  -1 }\n                                      ^     ^     ^ \n                                      5     7     9\n\n  where 5, 7, and 9 are the hashes of 1, 2, and 3.\n</code></pre>\n\n<p><code>-1</code> takes the place of <code>None</code> in the Python post to indicate a nonexistent value.</p>\n\n<p>The problem arises when my key, <code>1</code>, (stringified) hashes to <code>0x340ca71c</code>, or <code>873,244,444</code>. Thus, the array of key indicies (<code>hash-&gt;idxs</code>) needs to be <code>sizeof (ssize_t) * (873,244,444 + 1)</code>, or <code>8 * 873,244,444 = 6,985,955,552</code> bytes, or ~7 GB, which is more RAM than my laptop has, and also more RAM than I want <em>one</em> hashtable to take up.</p>\n\n<p>Surely, each dictionary I create in Python does not take up millions or even hundreds of thousands of bytes of RAM, yet it appears to be implemented this way, in C. What have I missed?</p>\n"}, {"tags": ["c", "ssh", "cryptography", "libssh"], "comments": [{"owner": {"reputation": 20508, "user_id": 2196426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e8759ad9a50739704dca2e84fa9b50?s=128&d=identicon&r=PG", "display_name": "Jakuje", "link": "https://stackoverflow.com/users/2196426/jakuje"}, "edited": false, "score": 0, "creation_date": 1477509385, "post_id": 40267037, "comment_id": 67800872, "body": "the link to your tutorial would be helpful"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6519500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae82d2ce9e7dff6ac4fb9b28349e8ded?s=128&d=identicon&r=PG&f=1", "display_name": "Diogo Salgueiro", "link": "https://stackoverflow.com/users/6519500/diogo-salgueiro"}, "edited": false, "score": 0, "creation_date": 1477595405, "post_id": 40270534, "comment_id": 67843143, "body": "Thank you for your answer! As expected, it solved the issue ;) I didn&#39;t notice that the code of the tutorial I was trying to execute wasn&#39;t the actual main function but a function called after connecting to the server.."}], "tags": [], "owner": {"reputation": 20508, "user_id": 2196426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e8759ad9a50739704dca2e84fa9b50?s=128&d=identicon&r=PG", "display_name": "Jakuje", "link": "https://stackoverflow.com/users/2196426/jakuje"}, "is_accepted": true, "score": 0, "last_activity_date": 1477509611, "creation_date": 1477509611, "answer_id": 40270534, "question_id": 40267037, "link": "https://stackoverflow.com/questions/40267037/libssh-ssh-is-host-known-called-without-cryptographic-context/40270534#40270534", "title": "libssh: ssh_is_host_known called without cryptographic context", "body": "<p>According to the <a href=\"http://api.libssh.org/master/libssh_tutor_guided_tour.html\" rel=\"nofollow\">tour (tutorial) on official page</a>, you need to connect to the server, before verifying that the server is known (the server needs to send you its host key). Therefore add a </p>\n\n<pre><code>rc = ssh_connect(my_ssh_session);\nif (rc != SSH_OK)\n{\n    fprintf(stderr, \"Error connecting to localhost: %s\\n\",\n            ssh_get_error(my_ssh_session));\n    exit(-1);\n}\n</code></pre>\n\n<p>before checking <code>ssh_is_server_known()</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6519500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae82d2ce9e7dff6ac4fb9b28349e8ded?s=128&d=identicon&r=PG&f=1", "display_name": "Diogo Salgueiro", "link": "https://stackoverflow.com/users/6519500/diogo-salgueiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 40270534, "answer_count": 1, "score": 1, "last_activity_date": 1477509812, "creation_date": 1477497692, "last_edit_date": 1477509812, "question_id": 40267037, "link": "https://stackoverflow.com/questions/40267037/libssh-ssh-is-host-known-called-without-cryptographic-context", "title": "libssh: ssh_is_host_known called without cryptographic context", "body": "<p>I was trying to include SSH communication into my program using libssh 0.7.0. I followed the tutorial to create a simple connection to a remote machine but I came across this error:</p>\n\n<pre><code>[2016/10/26 16:38:56.280261, 1] ssh_is_server_known:  ssh_is_host_known called without cryptographic context\n</code></pre>\n\n<p>After searching the source code of the library and its documentation, I didn't find anything related to this \"lack\" of cryptographic context that could help solving the issue.</p>\n\n<p>Here's the code I'm trying to execute (it's part of a function; IP address and user are not the actual ones):</p>\n\n<pre><code>ssh_session session;\nint verbosity = SSH_LOG_PROTOCOL;\nint port = 22;\nint state;\n\nssh_init();\n\nsession = ssh_new();\nif (session == NULL){\n    printf(\"Failed to create SSH session\\n\"); return NULL;\n}\n\nssh_options_set(session, SSH_OPTIONS_HOST, \"111.111.111.111\");\nssh_options_set(session, SSH_OPTIONS_USER, \"user\");\nssh_options_set(session, SSH_OPTIONS_LOG_VERBOSITY, &amp;verbosity);\nssh_options_set(session, SSH_OPTIONS_PORT, &amp;port);\n\nstate = ssh_is_server_known(session);\nif(state != SSH_SERVER_KNOWN_OK){\n    printf(\"SSH Server is not known\\n\");\n}\n</code></pre>\n\n<p>(I tried to execute this section without calling <code>ssh_init()</code> but the error occurred on both cases). </p>\n"}, {"tags": ["c", "gcc", "linker", "shared-libraries", "ld"], "comments": [{"owner": {"reputation": 109, "user_id": 4578558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WfekC.jpg?s=128&g=1", "display_name": "Mahmoud Mubarak", "link": "https://stackoverflow.com/users/4578558/mahmoud-mubarak"}, "edited": false, "score": 0, "creation_date": 1477497753, "post_id": 40266969, "comment_id": 67794380, "body": "Add your lib directory to LD_LIBRARY_PATH."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1477498192, "post_id": 40266969, "comment_id": 67794651, "body": "If you use <code>dlopen</code> it will search <code>&#47;lib</code> and <code>&#47;usr&#47;lib</code> (in that order) automatically."}, {"owner": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477499588, "post_id": 40266969, "comment_id": 67795463, "body": "Would I call dlsym as well, or use the original symbol names and build with -Wl,--unresolved-symbols=ignore-in-object-files?"}], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477499304, "post_id": 40267045, "comment_id": 67795304, "body": "Does not work; probably since it was built without -l*"}, {"owner": {"reputation": 374, "user_id": 4150006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bebb83038d5b9a879c9914bc281fd026?s=128&d=identicon&r=PG", "display_name": "Kendrick Wong", "link": "https://stackoverflow.com/users/4150006/kendrick-wong"}, "reply_to_user": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477507557, "post_id": 40267045, "comment_id": 67799918, "body": "Can you clarify how you built the executable?  This reference may help you as well: <a href=\"http://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html\" rel=\"nofollow noreferrer\">cprogramming.com/tutorial/shared-libraries-linux-gcc.html</a>"}, {"owner": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477513400, "post_id": 40267045, "comment_id": 67802915, "body": "gcc -o app src.c -Wl,--unresolved-symbols=ignore-in-object-files"}, {"owner": {"reputation": 374, "user_id": 4150006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bebb83038d5b9a879c9914bc281fd026?s=128&d=identicon&r=PG", "display_name": "Kendrick Wong", "link": "https://stackoverflow.com/users/4150006/kendrick-wong"}, "reply_to_user": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 1, "creation_date": 1477514583, "post_id": 40267045, "comment_id": 67803465, "body": "Try: <code>LD_PRELOAD=&#47;usr&#47;lib&#47;libx.so; .&#47;app</code>"}, {"owner": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477519631, "post_id": 40267045, "comment_id": 67805631, "body": "Works! But the semicolon is not necessary. Now if only I could get the same effect at build time..."}, {"owner": {"reputation": 374, "user_id": 4150006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bebb83038d5b9a879c9914bc281fd026?s=128&d=identicon&r=PG", "display_name": "Kendrick Wong", "link": "https://stackoverflow.com/users/4150006/kendrick-wong"}, "reply_to_user": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477537286, "post_id": 40267045, "comment_id": 67810050, "body": "What are you trying to achieve at build time?"}, {"owner": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477554165, "post_id": 40267045, "comment_id": 67816571, "body": "I&#39;d like to build the app to load libx.so on startup without having to use -lx. If that&#39;s not possible, I&#39;ll settle for LD_PRELOAD=libx.so"}, {"owner": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "edited": false, "score": 0, "creation_date": 1477592039, "post_id": 40267045, "comment_id": 67841388, "body": "The dlopen() idea should be a separate answer. I believe dlopen() by itself has the same effect as LD_PRELOAD. I definitely don&#39;t want to call dlsym() for each shared lib routine."}], "tags": [], "owner": {"reputation": 374, "user_id": 4150006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bebb83038d5b9a879c9914bc281fd026?s=128&d=identicon&r=PG", "display_name": "Kendrick Wong", "link": "https://stackoverflow.com/users/4150006/kendrick-wong"}, "is_accepted": false, "score": 1, "last_activity_date": 1477590734, "last_edit_date": 1477590734, "creation_date": 1477497708, "answer_id": 40267045, "question_id": 40266969, "link": "https://stackoverflow.com/questions/40266969/build-for-shared-library-without-a-so-file/40267045#40267045", "title": "Build for shared library without a .so file", "body": "<p><em>REVISED from original suggestion of LD_LIBRARY_PATH.</em></p>\n\n<p>Assuming you are on a linux system, shared libraries may be loaded before execution starts via the <code>LD_PRELOAD</code> environment variable:</p>\n\n<pre><code>$ LD_PRELOAD=\"/usr/lib/libx.so\" your_app\n</code></pre>\n\n<p>However, linking with <code>-Wl,--unresolved-symbols=ignore-in-object-files</code> is probably not a good practice.  I'd recommend using <code>dlsym</code> to load arbitrary symbols from a dynamic library.  For example,</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n\nint main ()\n{\n   void *handle;\n   void (*foo_fp) (void);  // function signature from dynamic library\n\n   // Dynamically load libfoo.so, searching it from LD_LIBRARY_PATH\n   handle = dlopen (\"libfoo.so\", RTLD_LAZY);\n\n   // Load function 'foo' from libfoo.so\n   foo_fp = dlsym(handle, \"foo\");\n\n   // Calls 'foo' from libfoo.so\n   foo_fp();\n   return 0;\n}\n</code></pre>\n\n<p>To compile this:</p>\n\n<pre><code>gcc -o main main.c -ldl\n</code></pre>\n\n<p>To execute:</p>\n\n<pre><code>export LD_LIBRARY_PATH=&lt;location of libfoo.so&gt;\n./main\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 328, "user_id": 4844822, "user_type": "registered", "profile_image": "https://graph.facebook.com/459123704243311/picture?type=large", "display_name": "Zsigmond L\u0151rinczy", "link": "https://stackoverflow.com/users/4844822/zsigmond-l%c5%91rinczy"}, "is_accepted": false, "score": 1, "last_activity_date": 1477844949, "creation_date": 1477844949, "answer_id": 40331155, "question_id": 40266969, "link": "https://stackoverflow.com/questions/40266969/build-for-shared-library-without-a-so-file/40331155#40331155", "title": "Build for shared library without a .so file", "body": "<p>Create a 'dummy' libx.so file that exports the needed symbols.</p>\n"}], "owner": {"reputation": 413, "user_id": 474023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df17cf3191ad39a181427d010985f2a9?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/474023/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477844949, "creation_date": 1477497502, "last_edit_date": 1477589985, "question_id": 40266969, "link": "https://stackoverflow.com/questions/40266969/build-for-shared-library-without-a-so-file", "title": "Build for shared library without a .so file", "body": "<p>I'm compiling C source which calls a shared library, and have only the library header on the build machine, not the .so file (different cpu architecture). How do I make the code find and load /usr/lib/libx.so at runtime?</p>\n"}, {"tags": ["c", "towers-of-hanoi"], "comments": [{"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 1, "creation_date": 1477497529, "post_id": 40266927, "comment_id": 67794217, "body": "please use descriptive variable names."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 1, "creation_date": 1477497582, "post_id": 40266927, "comment_id": 67794255, "body": "the problem is that <code>2</code> is hardcoded."}, {"owner": {"reputation": 145, "user_id": 7076083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f2c666b942ffbbc0a50d633a47cccb?s=128&d=identicon&r=PG&f=1", "display_name": "AxiomaticApproach", "link": "https://stackoverflow.com/users/7076083/axiomaticapproach"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1477498357, "post_id": 40266927, "comment_id": 67794753, "body": "@KarolyHorvath I see... How can I bypass that? Plugging in a variable with the value 2 at the beginning of the function wouldnt solve it.. :/"}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 1, "creation_date": 1477498976, "post_id": 40266927, "comment_id": 67795113, "body": "you need the number of the 3rd peg. you already know the other two. it&#39;s not that difficult ;)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1477499460, "post_id": 40266927, "comment_id": 67795385, "body": "<code>Other_peg = (1+2+3) - i - j</code>."}, {"owner": {"reputation": 145, "user_id": 7076083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f2c666b942ffbbc0a50d633a47cccb?s=128&d=identicon&r=PG&f=1", "display_name": "AxiomaticApproach", "link": "https://stackoverflow.com/users/7076083/axiomaticapproach"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477499698, "post_id": 40266927, "comment_id": 67795535, "body": "@chux I see. Just realised as well that putting in a constant number into the third peg wont solve it with this approach. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1477502404, "last_edit_date": 1495541631, "creation_date": 1477502404, "answer_id": 40268462, "question_id": 40266927, "link": "https://stackoverflow.com/questions/40266927/why-does-my-tower-of-hanoi-algorithm-not-work/40268462#40268462", "title": "Why does my tower of hanoi algorithm not work?", "body": "<p>Code needs to use the <em>other</em> peg, rather than <code>2</code> as commented by <a href=\"https://stackoverflow.com/questions/40266927/why-does-my-tower-of-hanoi-algorithm-not-work?noredirect=1#comment67795113_40266927\">@Karoly Horvath</a></p>\n\n<pre><code>void hanoi(int m, int i, int j){    \n    if (m==1) {\n        move(i,j);\n        return;\n    }\n    int Other_peg = (1+2+3) - i - j;\n    hanoi(m-1,i,Other_peg);\n    move(i,j);\n    hanoi(m-1,Other_peg,j);\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7076083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f2c666b942ffbbc0a50d633a47cccb?s=128&d=identicon&r=PG&f=1", "display_name": "AxiomaticApproach", "link": "https://stackoverflow.com/users/7076083/axiomaticapproach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 40268462, "answer_count": 1, "score": 0, "last_activity_date": 1477502404, "creation_date": 1477497417, "question_id": 40266927, "link": "https://stackoverflow.com/questions/40266927/why-does-my-tower-of-hanoi-algorithm-not-work", "title": "Why does my tower of hanoi algorithm not work?", "body": "<p>I need to write a hanoi recursion algorithm with 3 parameters. This is what I got:</p>\n\n<pre><code>#include &lt;stdio.h&gt; #include &lt;stdio.h&gt;\n\nvoid hanoi(int m, int i, int j);\nvoid move(int start, int end);\n\nint main(){\n    int n = 0;\n    int i = 1;\n    int j = 3;\n    printf(\"Enter how many disks you want to move: \");\n    scanf(\"%d\", &amp;n);\n    int m = n;\n    hanoi(m,i,j);\n\n}\n\nvoid hanoi(int m, int i, int j){    \n    if (m==1)\n    {\n        move(i,j);\n        return;\n    }\n    hanoi(m-1,i,2);\n    move(i,j);\n    hanoi(m-1,2,j);\n\n}\n\nvoid move(int start, int end){\n    printf(\"A disk moves from position %d. to %d.\\n\", start,end);\n}\n</code></pre>\n\n<p>The output for n=3 is the following:</p>\n\n<pre><code>Enter how many disks you want to move: 3\nA disk moves from position 1. to 2.\nA disk moves from position 1. to 2.\nA disk moves from position 2. to 2.\nA disk moves from position 1. to 3.\nA disk moves from position 2. to 2.\nA disk moves from position 2. to 3.\nA disk moves from position 2. to 3.\n</code></pre>\n\n<p>I looked at other algorithms, I know there is tons of those for solving the goold old hanoi problem. However, they all have 4 parameters and use characters, whereas I would like to only use numbers and leave out the auxiliary tower parameter in my function. How can I fix it? For n=1 and n=2 the algorithm works fine.</p>\n"}, {"tags": ["c", "arrays", "input"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1477498813, "post_id": 40266892, "comment_id": 67795026, "body": "Better to post text as text rather than a picture of text."}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477499097, "post_id": 40266892, "comment_id": 67795178, "body": "I&#39;m of the same opinion as @chux - posting as text (rather than an image of a text) makes it easier for other people with a similar problem to find the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477499219, "post_id": 40266892, "comment_id": 67795252, "body": "Another benefit: It is also easier for folks who answer to cut/paste parts of the post."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1477500005, "post_id": 40266892, "comment_id": 67795730, "body": "This code looks fine to me, except that you should initialize <code>i</code> to <code>0</code> in the first loop."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1477510817, "post_id": 40270027, "comment_id": 67801643, "body": "Well, <code>i</code> was initialized, it was just initialized to 1 instead of 0."}], "tags": [], "owner": {"reputation": 76, "user_id": 6894826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ad481929ebd2d3502d40f40cfbbfa8?s=128&d=identicon&r=PG&f=1", "display_name": "Rafih_m", "link": "https://stackoverflow.com/users/6894826/rafih-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1477507816, "creation_date": 1477507816, "answer_id": 40270027, "question_id": 40266892, "link": "https://stackoverflow.com/questions/40266892/how-to-get-read-an-input-along-with-whitespace-and-sort-the-input-to-2-arrays/40270027#40270027", "title": "How to get read an input along with whitespace and sort the input to 2 arrays?", "body": "<p>you have missed to initialize the variable <code>i</code> in the for loop <code>for(; i&lt;terms*2; i++){</code>\nand you didnt specify the format specifier <code>%d</code> here <code>printf( \"Your array has these values: \", arr[i] );</code></p>\n\n<p>here is the working code, i have also written the <code>print_poylynom</code> function :-)</p>\n\n<pre><code>`#include&lt;stdio.h&gt;\nvoid print_polynom(int coeff[],int exp[],int terms)\n{\n    int i=0;\n    printf(\"the polynomial is \\n\");\n    for(i=0;i&lt;terms;i++)\n    {\n        printf(\"%dX^%d\",coeff[i],exp[i]);\n        if(i&lt;terms-1)\n            printf(\"+\");\n    }\n}\nvoid init_polynom(int coeff[], int exp[])\n{\n    int i=0;\n    for(i=0; i&lt;100; i++)\n    {\n        coeff[i]=0;\n        exp[i]=0;\n    }\n}\n\nvoid get_polynom( int coeff[ ], int exp[ ] )\n{\n    init_polynom( coeff, exp); //calling the initialization function\n    int i=1;\n    int terms = 0;\n    int inputs=0;\n    int arr[100];\n\n\n    scanf(\"%d\", &amp;terms);    \n    for(i=0; i&lt;terms*2; i++)\n    {\n        scanf(\"%d\", &amp;inputs);\n        arr[i] = inputs;\n        printf( \"Your array has these values:%d\\n\", arr[i] );\n    }\n\n    for(i=0; i&lt; terms; i++)\n    {\n        coeff[i] = arr[2*i];\n        exp[i] = arr[2*i +1];\n    }\n    print_polynom(coeff,exp,terms);\n}\n\nint main()\n{\n    int i=0;\n    int coeff[100],exp[100];\n    get_polynom(coeff,exp);\n    return 0;\n}\n</code></pre>\n\n<p>`</p>\n"}], "owner": {"reputation": 21, "user_id": 7055620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de997da85d2376d958d2c46a84121312?s=128&d=identicon&r=PG&f=1", "display_name": "Rez", "link": "https://stackoverflow.com/users/7055620/rez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 40270027, "answer_count": 1, "score": -1, "last_activity_date": 1477507816, "creation_date": 1477497329, "question_id": 40266892, "link": "https://stackoverflow.com/questions/40266892/how-to-get-read-an-input-along-with-whitespace-and-sort-the-input-to-2-arrays", "title": "How to get read an input along with whitespace and sort the input to 2 arrays?", "body": "<p>I am a new C learner. I really need to help with the following example:\n<a href=\"https://i.stack.imgur.com/b6BJw.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/b6BJw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here are my codes for the get_polynom function, please let me know how can I accept the input along with the whitespaces and store them in 2 different arrays according to the ques says. Thanks in advance :)</p>\n\n<p>******* Note: I am not allowed to use any default C functions other than printf() and scanf().***********</p>\n\n<pre><code>void get_polynom( int coeff[ ], int exp[ ] )\n{ \n    init_polynom( coeff, exp); /* calling the initialization function*/\n    int i=1;\n    int terms = 0;\n    int inputs=0;\n    int arr[ASIZE];\n\n\n    scanf(\"%d\", &amp;terms);\n\n    for(; i&lt;terms*2; i++){\n        scanf(\"%d\", &amp;inputs);\n        arr[i] = inputs;\n     printf( \"Your array has these values: \", arr[i] );\n    }\n\n    for(i=0; i&lt; terms; i++){\n            coeff[i] = arr[2*i];\n            exp[i] = arr[2*i +1];\n    }\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1477497970, "post_id": 40266877, "comment_id": 67794528, "body": "In two functions you are using and returning the value of <code>int total</code> which is uninitialised (see compiler warnings)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1477498066, "post_id": 40266877, "comment_id": 67794581, "body": "You are also using the loop <code>for(i=0;i&lt;sizeof(*cart);++i)</code> which is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4863125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4dcb8e1e3ffb7a8459e46c7e4398fd?s=128&d=identicon&r=PG", "display_name": "Louis Person", "link": "https://stackoverflow.com/users/4863125/louis-person"}, "is_accepted": false, "score": 2, "last_activity_date": 1477498035, "creation_date": 1477498035, "answer_id": 40267151, "question_id": 40266877, "link": "https://stackoverflow.com/questions/40266877/c-getting-segmentation-fault/40267151#40267151", "title": "c getting Segmentation fault", "body": "<p>The problem in your code that cause the segmentation fault is in the <code>find_item</code> function, you're using the <code>sizeof</code> keyword where you should use the <code>size</code> attribute of your cart.</p>\n\n<p><code>sizeof</code> gives you the size in bytes of your cart structure (which will never change) whereas you store the number of items in your cart in its <code>size</code> attribute.</p>\n\n<p>Which means your function should be:</p>\n\n<pre><code>// Returns index of item with name `item_name` in the `items` array inside of `cart`. Returns -1 if not found.\nint find_item(cart_t *cart, const char* item_name) {\n    int i;\n    for(i=0;i&lt;cart-&gt;size;++i){\n        if(strcmp(cart-&gt;items[i]-&gt;name,item_name) == 0){\n            return i;\n        }\n    }\n\n    if(i == cart-&gt;size)\n        return -1;\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1686, "user_id": 3551483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/I4c4V.png?s=128&g=1", "display_name": "Fang", "link": "https://stackoverflow.com/users/3551483/fang"}, "edited": false, "score": 1, "creation_date": 1477498891, "post_id": 40267157, "comment_id": 67795059, "body": "Similarly, cart &lt; sizeof(*cart) is used in the output function and the total_cost and num_items functions."}], "tags": [], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "is_accepted": true, "score": 3, "last_activity_date": 1477499204, "last_edit_date": 1477499204, "creation_date": 1477498059, "answer_id": 40267157, "question_id": 40266877, "link": "https://stackoverflow.com/questions/40266877/c-getting-segmentation-fault/40267157#40267157", "title": "c getting Segmentation fault", "body": "<p>One problem at least is in the <code>find_item</code> function. <code>sizeof(*cart)</code> has nothing to do with the actual number of items in the cart,, <code>sizeof</code> returns the number of bytes in the data structure.  In this case, that's at least 44 bytes (assuming 4 byte <code>int</code> and 4 byte pointers). You should change this function to something like this:</p>\n\n<pre><code>// Returns index of item with name `item_name` in the `items` array inside of `cart`. Returns -1 if not found.\nint find_item(cart_t *cart, const char* item_name) {\n    int i;\n    for(i=0;i&lt;cart-&gt;size;++i){\n        if(strcmp(cart-&gt;items[i]-&gt;name,item_name) == 0){\n            return i;\n        }\n    }\n\n    return -1;  // if we get here, then no items were found, so return -1.\n                // I don't understand your logic in returning 0, since 0 is a valid item index\n}\n</code></pre>\n\n<p>As noted by @Fang, confusing the number of items in your cart (<code>cart-&gt;size</code>) with <code>sizeof(*cart)</code> is a common mistake throughout your code.  This will need to be changed any place you are trying to iterate through your items.</p>\n"}], "owner": {"reputation": 347, "user_id": 5442517, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5674814e7617844533373b622723fb20?s=128&d=identicon&r=PG&f=1", "display_name": "Zixuan Zhang", "link": "https://stackoverflow.com/users/5442517/zixuan-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 40267157, "answer_count": 2, "score": -1, "last_activity_date": 1477502279, "creation_date": 1477497295, "last_edit_date": 1477502279, "question_id": 40266877, "link": "https://stackoverflow.com/questions/40266877/c-getting-segmentation-fault", "title": "c getting Segmentation fault", "body": "<p>I am new to C, and I have been writing a simply script like below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef enum {FALSE, TRUE} bool;\n\n// item_t: information for a single item to be purchased\ntypedef struct _item_t {\n    char name[50];\n    int price;\n    int quantity;\n} item_t;\n\n// cart_t: information for the shopping cart\ntypedef struct _cart_t {\n    item_t *items[10];\n    int size;\n} cart_t;\n\n// Returns index of item with name `item_name` in the `items` array inside of `cart`. Returns -1 if not found.\nint find_item(cart_t *cart, const char* item_name) {\n    int i;\n    for(i=0;i&lt;sizeof(*cart);++i){\n        if(strcmp(cart-&gt;items[i]-&gt;name,item_name) == 0){\n            return i;\n        }\n    }\n\n    if(i == sizeof(*cart) -1)\n        return -1;\n    return 0;\n}\n\n// Adds item to cart's items array, if the cart is not full. Returns `FALSE` if the cart is full, and returns `TRUE` otherwise.\nbool add_new_item(cart_t *cart, item_t *item) {\n    if(10 == cart-&gt;size)\n        return FALSE;\n    else{\n        int i = cart-&gt;size;\n        cart-&gt;items[i] = item;\n        cart-&gt;size +=1;\n        return TRUE;\n    }\n}\n\n// Increases quantity by one of item with name `item_name` inside of `cart`, if such an item exists.\nvoid add_existing_item(cart_t *cart, const char* item_name) {\n    int i = find_item(cart,item_name);\n    if(i == -1)\n        return;\n    else{\n        cart-&gt;items[i]-&gt;quantity += 1;\n    }\n}\n\n// Removes item with name from cart's items array. Returns a pointer to the removed item, and shifts the items to the right of the deleted item in the `items` array \n// left to fill in the gap.\n// If the item is not found, return NULL.\nitem_t* remove_item(cart_t *cart, char *remove_me) {\n        item_t *p;\n        int j = 0;\n        int i = find_item(cart,remove_me);\n        if(i == -1)\n            return NULL;\n        else{\n\n            if(i == cart-&gt;size-1){\n                p = cart-&gt;items[i];\n                cart-&gt;items[i] = NULL;\n            }else{\n                p = cart-&gt;items[i];\n                for(j=i;j&lt;cart-&gt;size-1;++j){\n                    cart-&gt;items[j] = cart-&gt;items[j+1];\n                }\n                cart-&gt;items[cart-&gt;size-1] = NULL;\n                cart-&gt;size -= 1;\n            }\n            return p;\n        }\n    }\n\n// Determines and returns the total cost of items in cart.\nint total_cost(cart_t *cart) {\n    int total;\n    int i;\n    for(i=0;i&lt;sizeof(*cart);++i){\n        total += cart-&gt;items[i]-&gt;quantity * cart-&gt;items[i]-&gt;price;\n    }\n    return total;\n}\n\n//print  item's info and cost.\nvoid print_item_cost(item_t *item) {\n    printf(\"%s %d @ $%d = $%d\\n\", item-&gt;name, item-&gt;quantity,\n           item-&gt;price, (item-&gt;price * item-&gt;quantity));\n}\n\n//print the shopping cart info\nvoid print_total(cart_t *cart) {\n    int i = 0;\n    int cost = 0;\n\n    printf(\"Number of Items: %d\\n\\n\", num_items(cart));\n\n    if (cart-&gt;size &gt; 0) {\n        for (i = 0; i &lt; cart-&gt;size; ++i) {\n            print_item_cost(cart-&gt;items[i]);\n        }\n    }\n\n    else {\n        printf(\"SHOPPING CART IS EMPTY\\n\");\n    }\n\n    cost = total_cost(cart);\n\n    printf(\"\\nTotal: $%d\\n\", cost);\n}\n\n//this function clears items in the cart\nvoid clear_cart(cart_t *cart) {\n    int i = 0;\n    for (i = 0; i &lt; cart-&gt;size; i++) {\n        free(cart-&gt;items[i]);\n    }\n    cart-&gt;size = 0;\n}\n\n//a menu of options to manipulate the shopping cart\nvoid print_menu(cart_t *cart) {\n    char choice = ' ';\n    char name[50] = \"\";\n    int price = 0;\n    int quantity = 0;\n    int i = 0;\n    char c = ' ';\n    item_t *item;\n\n    while(choice != 'q') {\n\n        printf(\"MENU\\n\");\n        printf(\"a - Add item to cart\\n\");\n        printf(\"r - Remove item from cart\\n\");\n        printf(\"c - Change item quantity\\n\");\n        printf(\"o - Output shopping cart\\n\");\n        printf(\"q - Quit\\n\\n\");\n\n        while (choice != 'a' &amp;&amp;\n               choice != 'r' &amp;&amp;\n               choice != 'c' &amp;&amp;\n               choice != 'o' &amp;&amp;\n               choice != 'q') {\n            printf(\"Choose an option: \");\n            scanf(\" %c\", &amp;choice);\n            printf(\"\\n\");\n        }\n\n        switch (choice) {\n            case 'a':\n                while ((c = getchar()) != EOF &amp;&amp; c != '\\n');\n\n                printf(\"ADD ITEM TO CART\\n\");\n                printf(\"Enter the item name: \");\n                fgets(name, 50, stdin);\n                printf(\"\\n\");\n\n                i = find_item(cart, name);\n                if (i != -1) {\n                    printf(\"Item found. Updating quantity of item. \\n\");\n                    add_existing_item(cart, name);\n\n                    choice = ' ';\n                    printf(\"\\n\");\n                    break;\n                }\n\n                if (cart-&gt;size &gt;= 10) {\n                    printf(\"Cart full. Cannot add new item. \\n\");\n\n                    choice = ' ';\n                    printf(\"\\n\");\n                    break;\n                }\n\n                printf(\"Enter the item price: \");\n                scanf(\"%d\", &amp;price);\n                printf(\"\\n\");\n\n                printf(\"Enter the item quantity: \");\n                scanf(\"%d\", &amp;quantity);\n                printf(\"\\n\");\n\n\n                item = (item_t*)malloc(sizeof(item_t));\n                strcpy(item-&gt;name, name);\n                item-&gt;price = price;\n                item-&gt;quantity = quantity;\n                add_new_item(cart, item);\n\n                choice = ' ';\n                printf(\"\\n\");\n\n                break;\n\n            case 'r':\n                while ((c = getchar()) != EOF &amp;&amp; c != '\\n');\n\n                printf(\"REMOVE ITEM FROM CART\\n\");\n                printf(\"Enter name of item to remove: \");\n                fgets(name, 50, stdin);\n                printf(\"\\n\");\n\n                item = remove_item(cart, name);\n                if (item == NULL) {\n                    printf(\"Item not found. \\n\");\n                }\n                else {\n                    printf(\"Item removed. \\n\");\n                    free(item);\n                }\n\n                choice = '\\0';\n                printf(\"\\n\");\n                break;\n\n            case 'c':\n\n                while ((c = getchar()) != EOF &amp;&amp; c != '\\n');\n\n                printf(\"CHANGE ITEM QUANTITY\\n\");\n                printf(\"Enter the item name: \");\n                fgets(name, 50, stdin);\n                printf(\"\\n\");\n\n                i = find_item(cart, name);\n\n                if (i == -1) {\n                    printf(\"Item not found. \\n\");\n                    choice = ' ';\n                    printf(\"\\n\");\n                    break;\n                }\n\n                printf(\"Enter the item price: \");\n                scanf(\"%d\", &amp;price);\n                printf(\"\\n\");\n\n\n                printf(\"Enter the new quantity: \");\n                scanf(\"%d\", &amp;quantity);\n                printf(\"\\n\");\n\n                update_item_in_cart(cart, name, price, quantity);\n\n                choice = '\\0';\n                printf(\"\\n\");\n\n                break;\n\n            case 'o':\n                while ((c = getchar()) != EOF &amp;&amp; c != '\\n');\n                printf(\"OUTPUT SHOPPING CART\\n\");\n                print_total(cart);\n                choice = ' ';\n                printf(\"\\n\");\n                break;\n\n        }\n    }\n    clear_cart(cart);\n}\n\nint main(){\n    // malloc\n    cart_t *cart;\n    cart = (cart_t*)malloc(sizeof(cart_t));\n    cart-&gt;size = 0;\n\n    print_menu(cart);\n\n    //free\n    free(cart);\n    return 0;\n}\n</code></pre>\n\n<p>It may look long, but the idea is simply, it simulate item in a shopping cart, it takes in command to add items/remove items/change quantity/display current cart information. However, at the very beginning of debugging, when I do following in command window:</p>\n\n<pre><code>$ ./try\nMENU\na - Add item to cart\nr - Remove item from cart\nc - Change item quantity\no - Output shopping cart\nq - Quit\n\nChoose an option: a\n\nADD ITEM TO CART\nEnter the item name: tira\n\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>I am getting segmentation fault. I am wondering what could be the bug here? I am really new to C, and not sure about the correctness of pointer stuff in my code.</p>\n\n<p>PS:\nThanks for the reply, and yes it helps me solve the bugs in add_new_item function. However, when I debug remove_item, it terminate again with segmentation fault, the command line looks like below:</p>\n\n<pre><code>$ ./try\nMENU\na - Add item to cart\nr - Remove item from cart\nc - Change item quantity\no - Output shopping cart\nq - Quit\n\nChoose an option: a\n\nADD ITEM TO CART\nEnter the item name: shoes\n\nEnter the item price: 1\n\nEnter the item quantity: 2\n\n\nMENU\na - Add item to cart\nr - Remove item from cart\nc - Change item quantity\no - Output shopping cart\nq - Quit\n\nChoose an option: r\n\nREMOVE ITEM FROM CART\nEnter name of item to remove: shoes\n\nItem removed.\n\nMENU\na - Add item to cart\nr - Remove item from cart\nc - Change item quantity\no - Output shopping cart\nq - Quit\n\nChoose an option: o\n\nOUTPUT SHOPPING CART\nSegmentation fault (core dumped)\n</code></pre>\n"}, {"tags": ["c++", "c", "loops", "if-statement", "for-loop"], "comments": [{"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1477497215, "post_id": 40266789, "comment_id": 67793987, "body": "&lt;=c in your for loop?"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1477497288, "post_id": 40266789, "comment_id": 67794039, "body": "Why waste time with <code>a*a</code> when you never change the value of <code>a</code> from <code>1</code>?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1477497319, "post_id": 40266789, "comment_id": 67794064, "body": "You fix this with a <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">debugger</a> - step through the code, look at the variables and  you&#39;ll understand how everything is working when you&#39;re done."}, {"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1477497387, "post_id": 40266789, "comment_id": 67794111, "body": "Please store things in variables. aSquared = a * a; bSquared = b * b; cSquared = c*c; if(aSquared + bSquared != cSquared), readability would help others too....."}, {"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1477497429, "post_id": 40266789, "comment_id": 67794137, "body": "And your count is not initialized to 0 so when you do count++ its doing junk ++"}, {"owner": {"reputation": 73, "user_id": 7032678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/52fcaac4799a81ad29986c949fc24862?s=128&d=identicon&r=PG&f=1", "display_name": "vforbiedronka", "link": "https://stackoverflow.com/users/7032678/vforbiedronka"}, "edited": false, "score": 0, "creation_date": 1477498652, "post_id": 40266789, "comment_id": 67794923, "body": "I have added some corrections and still not functioning properly."}, {"owner": {"reputation": 73, "user_id": 7032678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/52fcaac4799a81ad29986c949fc24862?s=128&d=identicon&r=PG&f=1", "display_name": "vforbiedronka", "link": "https://stackoverflow.com/users/7032678/vforbiedronka"}, "edited": false, "score": 0, "creation_date": 1477500581, "post_id": 40266789, "comment_id": 67796064, "body": "I was trying to attempt this question with loop while but still does not work."}, {"owner": {"reputation": 73, "user_id": 7032678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/52fcaac4799a81ad29986c949fc24862?s=128&d=identicon&r=PG&f=1", "display_name": "vforbiedronka", "link": "https://stackoverflow.com/users/7032678/vforbiedronka"}, "edited": false, "score": 0, "creation_date": 1477503061, "post_id": 40266789, "comment_id": 67797353, "body": "How to improve my code?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1477504619, "post_id": 40266789, "comment_id": 67798227, "body": "I <a href=\"http://stackoverflow.com/a/35281353/4944425\">answered</a> a vaguely related question, some time ago. See if the code I used can help you."}, {"owner": {"reputation": 73, "user_id": 7032678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/52fcaac4799a81ad29986c949fc24862?s=128&d=identicon&r=PG&f=1", "display_name": "vforbiedronka", "link": "https://stackoverflow.com/users/7032678/vforbiedronka"}, "edited": false, "score": 0, "creation_date": 1477505497, "post_id": 40266789, "comment_id": 67798703, "body": "I do not understand how to use your code in my case..."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1477506837, "creation_date": 1477506837, "answer_id": 40269751, "question_id": 40266789, "link": "https://stackoverflow.com/questions/40266789/sum-of-two-squares-decomposition-counting/40269751#40269751", "title": "Sum of two squares decomposition counting", "body": "<p>The problem is that you're using an <code>if</code> expecting it to work like a loop.  At the bottom of the <code>if</code> you're incrementing <code>a</code>, however because it is an <code>if</code> and not a <code>while</code> or <code>for</code>, it doesn't jump back up to the top.</p>\n\n<p>Both <code>a</code> and <code>b</code> need to change, so you need a loop to control each one.</p>\n\n<pre><code>for (a=1; a&lt;=c; a++) {\n    for (b=a; b&lt;=c; b++) {\n        if (a*a + b*b == c*c) {\n            count++;\n        }\n    }\n}\n</code></pre>\n\n<p>Note that <code>b</code> starts at the current value of <code>a</code> instead of 1.  That way, you aren't trying the same pair of numbers (just switched) twice.</p>\n"}], "owner": {"reputation": 73, "user_id": 7032678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/52fcaac4799a81ad29986c949fc24862?s=128&d=identicon&r=PG&f=1", "display_name": "vforbiedronka", "link": "https://stackoverflow.com/users/7032678/vforbiedronka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "accepted_answer_id": 40269751, "answer_count": 1, "score": 0, "last_activity_date": 1477506837, "creation_date": 1477497076, "last_edit_date": 1477506477, "question_id": 40266789, "link": "https://stackoverflow.com/questions/40266789/sum-of-two-squares-decomposition-counting", "title": "Sum of two squares decomposition counting", "body": "<p>I want to count how many pairs of natural number there are such that a<sup>2</sup> + b<sup>2</sup> = c<sup>2</sup>. As an input to my function I have <code>c</code>.</p>\n\n<p>My idea was to first check whether the condition is fulfilled, than if not, I wanted to have a loop iterating desired expression up to <code>c</code>. If result is equal to the square of <code>c</code> than I wanted to have <code>count++</code>. Question is why this is not working?</p>\n\n<p>Some corrections added.</p>\n\n<pre><code>int sum(int c) {\n    int b=1;\n    int a=1;\n    int count=0;\n    int result;\n\n    if (a*a + b*b != c*c)\n    {\n        for (int i=1; i&lt;=c; i++)\n        {\n            b=i;\n            result = a*a + b*b;\n            if (result == c*c)\n                count++;\n        }\n        a++;\n    }\n    else\n        count++;\n\n    return count;\n}\n</code></pre>\n\n<p>The problem is I still do not understand why this does not want to work.</p>\n\n<p>My second idea was to approach it with while loop:</p>\n\n<pre><code>int sum(int c) {\n    int b=1;\n    int a=1;\n    int count=0;\n    int result;\n\n    if (a*a + b*b != c*c)\n    {\n        while(b&lt;=c)\n        {\n            result = a*a + b*b;\n            if (result == c*c)\n                {count++;\n                b++;\n                }\n                else\n                    b++;\n        }\n        a++;\n    }\n    else\n        count++;\n\n    return count;\n}\n</code></pre>\n\n<p>Not working as well.</p>\n\n<p><strong>Anybody any ideas as to how to make it work? Any of those two versions? Maybe hints?</strong></p>\n"}, {"tags": ["c", "pointers", "casting", "void"], "comments": [{"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 2, "creation_date": 1477496898, "post_id": 40266686, "comment_id": 67793762, "body": "Remove the ampersand in the call to test()."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1477497116, "post_id": 40266686, "comment_id": 67793912, "body": "Note: you do not need to cast a pointer either to of from <code>void*</code>. If you do, it can hide a problem if different levels of indirection have mistakenly been used."}, {"owner": {"reputation": 560, "user_id": 10850601, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3R2h7RDJ9yU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYNkQa9HPTd778Jo28o4mlsEFPJpw/mo/photo.jpg?sz=128", "display_name": "Ed Grimm", "link": "https://stackoverflow.com/users/10850601/ed-grimm"}, "edited": false, "score": 0, "creation_date": 1549144340, "post_id": 40266686, "comment_id": 95800876, "body": "I think this is a useful question for those of us who have used less smart compilers. Decades ago when I first learned C, the (mildly outdated even at the time) stock compiler actually generated warnings for assigning typed pointers to void * variables without casts. That set very many people up for fails. I remember being quite frustrated at one point because I had a function that took a pointer to an array fine, but not a pointer to a pointer. It was this exact issue, and it was masked because the compiler warned about the wrong thing. Using gcc showed my problem and let me fix it."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477497444, "post_id": 40266818, "comment_id": 67794143, "body": "&quot;Pointer to an array ...&quot; -  the sencence is ambiguous. The pointer has type <code>int(*)[3]</code>, not the array."}, {"owner": {"reputation": 33, "user_id": 7076006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696bb8d36225df4f849574544e6d03ce?s=128&d=identicon&r=PG&f=1", "display_name": "kcinicx", "link": "https://stackoverflow.com/users/7076006/kcinicx"}, "edited": false, "score": 0, "creation_date": 1477504802, "post_id": 40266818, "comment_id": 67798322, "body": "So what is the best way to describe the pointer type <code>int(*)3</code>? Is it an array of three pointers to an int?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 33, "user_id": 7076006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696bb8d36225df4f849574544e6d03ce?s=128&d=identicon&r=PG&f=1", "display_name": "kcinicx", "link": "https://stackoverflow.com/users/7076006/kcinicx"}, "edited": false, "score": 0, "creation_date": 1477505507, "post_id": 40266818, "comment_id": 67798709, "body": "@kcinicx The type <code>int(*)3</code> is not a valid type. The type <code>int(*)[3]</code> is a <i>pointer to an array of three ints</i>."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 2, "last_activity_date": 1477511938, "last_edit_date": 1477511938, "creation_date": 1477497160, "answer_id": 40266818, "question_id": 40266686, "link": "https://stackoverflow.com/questions/40266686/explain-difference-between-the-use-of-void-pointer/40266818#40266818", "title": "Explain difference between the use of void pointer", "body": "<p>The lower version tells you what the problem was in the first one: passing a pointer to the array instead of a pointer to the first element.</p>\n\n<p>Passing a pointer to the array, which has the type <code>int(*)[3]</code>:</p>\n\n<pre><code>test(&amp;test_array, var_1);\n</code></pre>\n\n<p>Passing a pointer to the first element, which has the type <code>int*</code>:</p>\n\n<pre><code>test(test_array, var_1);   \n</code></pre>\n\n<p>The code happens to work because the two pointers points to the same address, so the pointer to the array appears to work, but the code is still undefined. </p>\n\n<p>Passing a pointer to the first element is correct, as the array test_array, which has the type <code>int[3]</code> decays to type <code>int*</code> when it is passed to the function.</p>\n"}, {"tags": [], "owner": {"reputation": 360, "user_id": 4498053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N6ZyCZUJlTk/AAAAAAAAAAI/AAAAAAAAAAA/5Nb1G_PpL-c/photo.jpg?sz=128", "display_name": "J. Vergeer", "link": "https://stackoverflow.com/users/4498053/j-vergeer"}, "is_accepted": false, "score": 0, "last_activity_date": 1477497168, "creation_date": 1477497168, "answer_id": 40266824, "question_id": 40266686, "link": "https://stackoverflow.com/questions/40266686/explain-difference-between-the-use-of-void-pointer/40266824#40266824", "title": "Explain difference between the use of void pointer", "body": "<p>The warnings are shown because the compiler does static analysis on the code and identified a possible cause of bugs.</p>\n\n<p>When using the void pointer the compiler cannot do this static analysis since it does not know what type is used. </p>\n\n<p>If the datatype is known I would always prefer using this type as pointer instead of the void pointer. I would only use the void pointer when it is acceptable that the pointer can point to anything. In the end this is about personal taste and the code guidelines you follow.</p>\n"}], "owner": {"reputation": 33, "user_id": 7076006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696bb8d36225df4f849574544e6d03ce?s=128&d=identicon&r=PG&f=1", "display_name": "kcinicx", "link": "https://stackoverflow.com/users/7076006/kcinicx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 40266818, "answer_count": 2, "score": 3, "last_activity_date": 1477511938, "creation_date": 1477496773, "question_id": 40266686, "link": "https://stackoverflow.com/questions/40266686/explain-difference-between-the-use-of-void-pointer", "title": "Explain difference between the use of void pointer", "body": "<p>My code needs to pass an array to a void pointer (The struct has (void *) that cannot be modified). The two versions of code below produce the same output but the latter has two warnings. My question is which of the two methods is preferred? Is there a way to typecast to remove the warnings?</p>\n\n<p>This version does not have warnings and produces the output as expected: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid test(void *var_arr, char var_1);\n\ntypedef struct {\n    char chip;\n    void *buffer;\n}test_struct;\n\nint main()\n{\n   int test_array[3] = {3,7,5};\n    char var_1 = 0x20;\n\n    printf(\"Hello, World!\\n\");\n\n    test(&amp;test_array, var_1);\n    return 0;\n}\n\nvoid test(void *var_arr, char var_1)\n{\n    int i;\n\n    test_struct var_ts;\n\n    var_ts.chip = var_1;\n    var_ts.buffer = var_arr;\n\n    for (i=0; i&lt;3; ++i)\n        printf(\"\\nThe data values are : %X \\n\\r\", *((int *)var_ts.buffer+i));\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Hello, World!</p>\n</blockquote>\n\n<p>The data values are : 3 </p>\n\n<p>The data values are : 7 </p>\n\n<p>The data values are : 5 </p>\n\n<hr>\n\n<p>This version below has two warnings but compiles and produces the output expected:</p>\n\n<blockquote>\n  <p>Warning(s):\n  source_file.c: In function \u2018main\u2019:\n  source_file.c:17:10: warning: passing argument 1 of \u2018test\u2019 from incompatible pointer type\n       test(&amp;test_array, var_1);\n            ^\n  source_file.c:3:6: note: expected \u2018int <em>\u2019 but argument is of type \u2018int (</em>)[3]\u2019\n   void test(int *var_arr, char var_1);</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid test(int *var_arr, char var_1);\n\ntypedef struct {\n    char chip;\n    void *buffer;\n}test_struct;\n\nint main()\n{\n   int test_array[3] = {3,7,5};\n    char var_1 = 0x20;\n\n    printf(\"Hello, World!\\n\");\n\n    test(&amp;test_array, var_1);\n    return 0;\n}\n\nvoid test(int *var_arr, char var_1)\n{\n    int i;\n\n    test_struct var_ts;\n\n    var_ts.chip = var_1;\n    var_ts.buffer = (void *)var_arr;\n\n    for (i=0; i&lt;3; ++i)\n        printf(\"\\nThe data values are : %X \\n\\r\", *((int *)var_ts.buffer+i));\n\n}\n</code></pre>\n"}, {"tags": ["c", "go", "dlopen", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1477496989, "post_id": 40266634, "comment_id": 67793832, "body": "What is the output of running <code>ldd</code> on your go binary?"}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477501393, "post_id": 40266634, "comment_id": 67796488, "body": "updated the output of ldd"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477502680, "post_id": 40266634, "comment_id": 67797142, "body": "Does this help? <a href=\"https://groups.google.com/d/msg/golang-nuts/NPEKogRR9Q0/IC-IUUy7CQAJ\" rel=\"nofollow noreferrer\">groups.google.com/d/msg/golang-nuts/NPEKogRR9Q0/IC-IUUy7CQAJ</a>"}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477504230, "post_id": 40266634, "comment_id": 67798038, "body": "No it didn&#39;t help"}], "owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1477501238, "creation_date": 1477496649, "last_edit_date": 1477501238, "question_id": 40266634, "link": "https://stackoverflow.com/questions/40266634/issue-with-c-and-golang-integration", "title": "Issue with C and Golang integration", "body": "<p>I have a C shared library named libtest.so which in turn use another shared library lihelp.so.\nThe code for libtest.so use dlopen() to load the libhelp.so</p>\n\n<p>I have integrated libtest.so with my GO script gotest.go</p>\n\n<p>When I run gotest.go after building and installing, I am seeing libtest.so is getting loaded successfully and function in libtest is executed successfully.\nBut the dlopen() call in libtest.so to load libhelp.so is failining with error \"undefined symbol: dlopen\"</p>\n\n<p>But if I write a C application which use libtest.so all execution are fine withour any error.</p>\n\n<p>Here is the code snippet of my Go file</p>\n\n<pre><code>/*\n #cgo CFLAGS: -I./include\n #cgo LDFLAGS: -L. -ltest -ldl\n*/\n</code></pre>\n\n<p>Here is the Makefile entry for building libtest.so</p>\n\n<pre><code>CC = gcc # C compiler\nCFLAGS = -c -fPIC -I./include # C flags\nLDFLAGS = -shared -L/lib -ldl # linking flags\n</code></pre>\n\n<p>Can any one suggest what can be the problem?</p>\n\n<hr>\n\n<p>Output of ldd of my go binary</p>\n\n<pre><code>ldd app\n    linux-gate.so.1 =&gt;  (0xb77c3000)\n    libtest.so =&gt; ./libtest.so (0xb77bc000)\n    libgo.so.5 =&gt; /usr/lib/i386-linux-gnu/libgo.so.5 (0xb6ed0000)\n    libgcc_s.so.1 =&gt; /lib/i386-linux-gnu/libgcc_s.so.1 (0xb6eb2000)\n    libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb6d03000)\n    /lib/ld-linux.so.2 (0xb77c4000)\n    libpthread.so.0 =&gt; /lib/i386-linux-gnu/libpthread.so.0 (0xb6ce7000)\n    libm.so.6 =&gt; /lib/i386-linux-gnu/libm.so.6 (0xb6ca1000)\n</code></pre>\n"}, {"tags": ["c", "floating-point", "int"], "comments": [{"owner": {"reputation": 2477, "user_id": 2133335, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/45be35d97b8a8858aef5d4be1fc4c760?s=128&d=identicon&r=PG", "display_name": "Paulo", "link": "https://stackoverflow.com/users/2133335/paulo"}, "edited": false, "score": 0, "creation_date": 1477495802, "post_id": 40266333, "comment_id": 67793045, "body": "You have to find out how float works."}, {"owner": {"reputation": 303, "user_id": 4526828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/daafbb1d86dfad2e09acdb821e21ebac?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Paine", "link": "https://stackoverflow.com/users/4526828/thomas-paine"}, "edited": false, "score": 0, "creation_date": 1477495943, "post_id": 40266333, "comment_id": 67793145, "body": "Try using doubles or even long doubles if floats aren&#39;t precise enough for you."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 303, "user_id": 4526828, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/daafbb1d86dfad2e09acdb821e21ebac?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Paine", "link": "https://stackoverflow.com/users/4526828/thomas-paine"}, "edited": false, "score": 0, "creation_date": 1477496046, "post_id": 40266333, "comment_id": 67793213, "body": "@ThomasPaine the problem will still exist."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477496419, "post_id": 40266333, "comment_id": 67793447, "body": "&quot;but im getting 2260.001&quot;  --&gt; Posted code does not &quot;get&quot; 2260.001.  It prints <code>&quot;2260.00&quot;</code>."}], "owner": {"reputation": 241, "user_id": 6788029, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/eff9e8d639eddf05d904813953425345?s=128&d=identicon&r=PG&f=1", "display_name": "xxFlashxx", "link": "https://stackoverflow.com/users/6788029/xxflashxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1477496084, "answer_count": 0, "score": 0, "last_activity_date": 1477495732, "creation_date": 1477495732, "question_id": 40266333, "link": "https://stackoverflow.com/questions/40266333/getting-an-extra-0-001-in-my-calculation", "closed_reason": "Duplicate", "title": "getting an extra 0.001 in my calculation", "body": "<p>When i enter 0.2 as the volume i should get 2260.00 but im getting 2260.001 and i cant understand why. Even after adjusting how many decimals i want there is always 0.1 at the end...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int option;\n    float volume;\n    float density = 11300;\n    float mass;\n\n    while (option != 3)\n    {\n        printf(\"1: Calculate Mass\\n\");\n        printf(\"2: Calculate Volume\\n\");\n        printf(\"3: Exit\\n\");\n        printf(\"Input here: \");\n        scanf(\"%d\", &amp;option);\n\n        if (option == 1)\n        {\n            printf(\"Input Volume: \");\n            scanf(\"%f\", &amp;volume);\n\n            mass = volume*density;\n            printf(\"%.2f\", mass);\n        }\n\n    }\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "list", "integer"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477494912, "post_id": 40265906, "comment_id": 67792443, "body": "What is not working ? Does it not compile ? Does it not run ? Did it format your hard drive ? What is <code>print</code> ?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1477495026, "post_id": 40265906, "comment_id": 67792524, "body": "Unless you&#39;re planning on <i>guessing</i> the length of those variable-length arrays at some time later when you plan on using them, you likely want to create an array of <code>struct</code> where the structure is something like <code>struct IList { size_t length; int *values; }</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1199, "user_id": 1326705, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/fd1ee48f7ddcac45075584ed06292a16?s=128&d=identicon&r=PG", "display_name": "Dragan Marjanovic", "link": "https://stackoverflow.com/users/1326705/dragan-marjanovic"}, "is_accepted": false, "score": 1, "last_activity_date": 1477494936, "creation_date": 1477494936, "answer_id": 40266039, "question_id": 40265906, "link": "https://stackoverflow.com/questions/40265906/create-integer-list-of-lists-in-c/40266039#40266039", "title": "Create Integer List of Lists in C", "body": "<p>Your main array needs to hold pointers to other arrays. Therefore it should not be <code>int dataArray[length]</code> but rather <code>int* dataArray[length]</code> this means it will hold <code>length</code> amount of references to integer arrays.</p>\n\n<pre><code>int* array[length];\n\nint randomSizeArray[x];\nrandomSizeArray[0] = 1;\n.\n.\n.\nrandomSizeArray[x] = 5;\nint* array[0] = randomSizeArray;\n</code></pre>\n\n<p>Also <code>sizeof()</code> will not work the way you expect it to - in C you need to store separately how many elements are in an array. I'd recommend reading a C tutorial from the ground up as you seem to have shaky knowledge of basics.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1477499013, "creation_date": 1477499013, "answer_id": 40267469, "question_id": 40265906, "link": "https://stackoverflow.com/questions/40265906/create-integer-list-of-lists-in-c/40267469#40267469", "title": "Create Integer List of Lists in C", "body": "<p>The <code>sizeof</code> results in the byte count not element count.</p>\n\n<p>Divide the array size by the element size to find the element count.</p>\n\n<pre><code>int dataArray[length];\nint dataArray[0] = [1,2,3];\nint dataArray[1] = [5,6];\n...\n\n// for(int a = 0; a&lt;sizeof(dataArray); a++) {\nfor(size_t a = 0; a&lt;sizeof(dataArray)/sizeof(dataArray[0]); a++) {\n   tempArr = dataArray[a];\n   // for(into = 0; b&gt;sizeof(tempArr); b++) {\n   for(into = 0; b&gt;sizeof(tempArr)/sizeof(tempArr[0]); b++) {\n\n   // or do you really want\n   // for(size_t = 0; b&lt;sizeof(tempArr)/sizeof(tempArr[0]); b++) {\n\n      print(dataArray[a][b])\n   }\n} \n</code></pre>\n"}], "owner": {"reputation": 595, "user_id": 1760431, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0fc4a328d26cf7da40ab7de61998a875?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/1760431/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9599, "favorite_count": 1, "closed_date": 1477500089, "answer_count": 2, "score": -4, "last_activity_date": 1477499013, "creation_date": 1477494556, "question_id": 40265906, "link": "https://stackoverflow.com/questions/40265906/create-integer-list-of-lists-in-c", "closed_reason": "Not suitable for this site", "title": "Create Integer List of Lists in C", "body": "<p>I would like to create an integer list in C containing integer arrays of variable size. The length of the main list will not need to change.</p>\n\n<p>How would I declare it - my implementation - particularly my access is not working:</p>\n\n<pre><code>int dataArray[length];\nint dataArray[0] = [1,2,3];\nint dataArray[1] = [5,6];\n.\n.\n.\npopulate\n\nfor(int a = 0; a&lt;sizeof(dataArray); a++) {\n   tempArr = dataArray[a];\n   for(into = 0; b&gt;sizeof(tempArr); b++) {\n      print(dataArray[a][b])\n   }\n} \n</code></pre>\n"}, {"tags": ["c", "function", "operators"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 9, "creation_date": 1477493927, "post_id": 40265663, "comment_id": 67791717, "body": "read about conditional or ternary operators."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1477493970, "post_id": 40265663, "comment_id": 67791749, "body": "It is a recursive function."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1477494000, "post_id": 40265663, "comment_id": 67791781, "body": "fibonacci or something?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1477494016, "post_id": 40265663, "comment_id": 67791793, "body": "Factorial is my guess."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1477494039, "post_id": 40265663, "comment_id": 67791806, "body": "&quot;If y is less than or equal to 1 then return 1 else return y times f(y-1)&quot;"}, {"owner": {"reputation": 1250, "user_id": 6313992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766176ae92684010f7061da118223129?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Plaskota", "link": "https://stackoverflow.com/users/6313992/tomasz-plaskota"}, "edited": false, "score": 0, "creation_date": 1477494042, "post_id": 40265663, "comment_id": 67791810, "body": "Ye its pretty insefficient version of factorial"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1477494083, "post_id": 40265663, "comment_id": 67791843, "body": "When you say you want help figuring it out, can you please be more specific? There are three things going on: The ternary expression (the <code>?:</code> bit), the recursion (the call again to <code>f</code>), and the algorithm itself. Which is it you have trouble figuring out?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1477494115, "post_id": 40265663, "comment_id": 67791870, "body": "Might also get trouble with <i>integer overflow</i>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1477495073, "post_id": 40265663, "comment_id": 67792557, "body": "It should be noted that this is a very bad way to write programs. Not only is the algorithm hard to read, it also makes the program needlessly inefficient. As a rule of thumb, only use recursion as a very last resort. It has very limited practical use. Unfortunately books and teachers spend far too much time teaching about such a useless, inefficient, dangerous feature."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1477494965, "post_id": 40265726, "comment_id": 67792487, "body": "Remove the braces around <code>(condition)</code>. They are not part of the syntax."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1477495382, "post_id": 40265726, "comment_id": 67792767, "body": "Thank you @PaulOgilvie, it didn&#39;t feel right to be honest! :)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1477497636, "post_id": 40265726, "comment_id": 67794294, "body": "Also (see that only now): remove the <code>;</code>. (<code>;</code> is a statement terminator and turns an expression into a statement, but this is only an expression, so <i>no</i> <code>;</code>)"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1477502364, "last_edit_date": 1495541795, "creation_date": 1477494053, "answer_id": 40265726, "question_id": 40265663, "link": "https://stackoverflow.com/questions/40265663/how-does-this-return-work/40265726#40265726", "title": "How does this return work?", "body": "<p>This:</p>\n\n<pre><code>int f(int y)\n{\n  return (y&lt;=1) ? 1 : y*f(y-1);\n}\n</code></pre>\n\n<p>is equivalent to this:</p>\n\n<pre><code>int f(int y)\n{\n  if(y &lt;= 1)\n  {\n    return 1;\n  } else\n  {\n    return y*f(y-1);\n  }\n}\n</code></pre>\n\n<p>which should be clear to you by now, that it's a recursive function that uses <a href=\"https://stackoverflow.com/questions/758849/the-ternary-conditional-operator-in-c\">The ternary (conditional) operator in C</a>.</p>\n\n<p>The ternary operator has this general form:</p>\n\n<blockquote>\n  <p>condition ? a : b</p>\n</blockquote>\n\n<p>where if <code>condition</code> evaluates into <em>True</em>, then <code>a</code> will be executed, else <code>b</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 3825877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe0af73006f2590b10f4c0ede6f57ec5?s=128&d=identicon&r=PG&f=1", "display_name": "suyol854", "link": "https://stackoverflow.com/users/3825877/suyol854"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 40265726, "answer_count": 1, "score": -2, "last_activity_date": 1477502364, "creation_date": 1477493902, "last_edit_date": 1477495650, "question_id": 40265663, "link": "https://stackoverflow.com/questions/40265663/how-does-this-return-work", "title": "How does this return work?", "body": "<p>I found this piece of code and I am trying to figure out how it works, but I don't understand the part after the return statement. Can somebody explain this?</p>\n\n<pre><code>int f(int y)\n{\n  return (y&lt;=1)?1:y*f(y-1);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1477493175, "post_id": 40265253, "comment_id": 67791116, "body": "You might want to have a look into a good C book. Most of them detail what the different loops do and specifically what the <code>for</code> statement exactly does (and that is indeed syntactic sugar). They also should detail where each statement is better suited. Write code readable by humans. Caution: The <code>do</code> loop is indeed different!"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477492951, "post_id": 40265284, "comment_id": 67790928, "body": "That&#39;s an over-simplification. :)"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1477493229, "post_id": 40265284, "comment_id": 67791166, "body": "@SouravGhosh Can you provide a counter-example?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477493266, "post_id": 40265284, "comment_id": 67791189, "body": "@unwind which sort of counter-example you&#39;re expecting?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477493409, "post_id": 40265284, "comment_id": 67791305, "body": "A case where what @Arun said isn&#39;t true. I don&#39;t think there is one, I believe the above transformation works all the time."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477493462, "post_id": 40265284, "comment_id": 67791340, "body": "@unwind ok, technically speaking, an <code>init statement</code> is not part of a <code>while loop</code>, that is what i tried to explain in my answer."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477493485, "post_id": 40265284, "comment_id": 67791355, "body": "@unwind an optional decl of a for-loop init has no direct counterpart in a while-loop. The decl and init must appear outside the while-loop construct. <code>for(int i=...</code> must be done as <code>int i=...; while(...</code>. The locality of <code>i</code> is different, is it not?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1477493839, "post_id": 40265284, "comment_id": 67791647, "body": "@WhozCraig If you are looking for something that has exact syntax as a for loop then...you&#39;ll have to use <code>for</code> loops ;-) All we are concerned with here whether it&#39;d ever matter to write an equivalent while loop instead. The locality, if it matters,  can be overcome with an additional scope: <code>{ int x = 0; while (x &lt; 5) {...; x++} }</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477494229, "post_id": 40265284, "comment_id": 67791956, "body": "@unwind I certainly concur with you the <i>logic</i> is equivalent as Arun described.   Likewise your example of including an enclosing scope is spot-on with full equivalence including covering object scope. <i>That</i> would make a perfect synonymous example to the for-loop Arun has in his final example. Don&#39;t think I disagree on the logic path; only whether the two junkets are synonymous. In your example, they are completely so."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1477494234, "post_id": 40265284, "comment_id": 67791959, "body": "@unwind: it is an over-simplification in case there is a <code>continue</code> statement in the loop body as the <i>modify something</i> part would still be executed in the <code>for</code> statement and would be skipped in the proposed <code>while</code> translation."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1477494409, "post_id": 40265284, "comment_id": 67792077, "body": "Well, <code>do..while</code> construct has some other idiomatic uses than the looping. Update: Actually I see @Lundin have mentioned them in his answer.."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477495160, "post_id": 40265284, "comment_id": 67792615, "body": "Note: Please use the correct terms. <i>statement</i> is a well-defined term, which does not apply to e.g. the conditon, and may not apply to the &quot;init&quot; (whatever that be). The <code>for</code> allows for a <i>declaration</i> or an <i>expression</i> as <i>clause-1</i> and requires <i>expressions</i> for the latter 2."}], "tags": [], "owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "is_accepted": false, "score": 3, "last_activity_date": 1477502448, "last_edit_date": 1495541203, "creation_date": 1477492931, "answer_id": 40265284, "question_id": 40265253, "link": "https://stackoverflow.com/questions/40265253/for-versus-while-versus-do-loop-statements/40265284#40265284", "title": "For versus while versus do loop statements", "body": "<blockquote>\n  <p>Is there a difference between 'for' and 'while' statements? Is it just\n  syntax?</p>\n</blockquote>\n\n<p>To me, it is just syntax.</p>\n\n<p>From <strong>K&amp;R section 3.5 Loops -- While and For</strong>, I quote:</p>\n\n<blockquote>\n  <p>The <code>for</code> statement</p>\n\n<pre><code>for (expr1; expr2; expr3)\n  statement\n</code></pre>\n  \n  <p>is equivalent to</p>\n\n<pre><code>expr1;\nwhile (expr2) {\n  statement\n  expr3;\n}\n</code></pre>\n  \n  <p>except for the behavior of <code>continue</code>.</p>\n  \n  <p>Grammatically, the three components of a <code>for</code> loop are expressions.\n  Most commonly, <code>expr1</code> and <code>expr3</code> are assignments or function calls\n  and <code>expr2</code> is a relational expression.</p>\n</blockquote>\n\n<p><strong>Notes</strong></p>\n\n<p>As user @chqrlie has mentioned in the comments, control statements like <code>break</code> and <code>continue</code> make the situation slightly murkier.</p>\n\n<p>There are some situations where the modify statement is necessary in the loop body. For example <a href=\"https://stackoverflow.com/questions/3792600/erase-remove-idiom-with-stdset-failing-with-constness-related-error\">Erase-remove idiom with std::set failing with constness-related error</a> (in C++ though)</p>\n\n<p><strong>Example</strong></p>\n\n<p>As an example, let us write a loop to print all the odd numbers between 1 and 100.</p>\n\n<pre><code>int i = 1;\nwhile (i &lt;= 100) {\n  printf(\"%d\\n\", i);\n  i += 2;\n}\n\nfor (int i = 1; i &lt;= 100; i += 2) {\n  printf(\"%d\\n\", i);\n}\n</code></pre>\n\n<p><strong>Opinion</strong></p>\n\n<p>I am not a language expert, but in most situations in practice I find them transformable.</p>\n\n<p>I personally prefer using <code>for</code> syntax because:</p>\n\n<ul>\n<li>loop control structure is in one single place (the <code>for</code> header) making it easy to read, and</li>\n<li>the loop variable (e.g. <code>i</code>) is not exposed to the outer scope.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1477494605, "post_id": 40265778, "comment_id": 67792230, "body": "I&#39;d rather extend the usage of <code>for</code>: If the three parts (initialisation, condition and advance to next step) are closely related, it is preferable. All these are not hard criterions, though. Most important is readability. <code>do ... while</code> is a completely different beast, as it has different behaviour. There is not corresponding <code>do ... for</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477495242, "post_id": 40265778, "comment_id": 67792672, "body": "@Olaf Yeah I agree. There&#39;s a good rule of thumb saying that the 3 expressions of a for loop should only concern themselves with the loop iterator and not with other, unrelated things (that&#39;s also a MISRA-C rule)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477495379, "post_id": 40265778, "comment_id": 67792763, "body": "Good orientation for beginners (MISRA is worth reading the rationales for the rules, but forget about the rules themselves). It is like cooking: A good cook and a good programmer know when to bend the rules a bit. If you fail, both can result in a terrible product:-)"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1477494173, "creation_date": 1477494173, "answer_id": 40265778, "question_id": 40265253, "link": "https://stackoverflow.com/questions/40265253/for-versus-while-versus-do-loop-statements/40265778#40265778", "title": "For versus while versus do loop statements", "body": "<pre><code>for(cent_temp = 0; cent_temp &lt;= 20; cent_temp++)\n{ /* code */ }\n</code></pre>\n\n<p>is 100% equivalent to</p>\n\n<pre><code>cent_temp = 0;\nwhile(cent_temp &lt;= 20)\n{\n  /* code */\n  cent_temp++;\n}\n</code></pre>\n\n<p>But a <code>do-while</code> is different since it puts the condition check at the end.</p>\n\n<hr>\n\n<p>As for when to use which loop, it is a matter of style and therefore a bit subjective. The industry de facto standard style, used by the majority of all C programmers, goes like this:</p>\n\n<ul>\n<li><code>for</code> loops should always be used when performing a known number of iterations. It is then considered the most readable form. </li>\n<li><code>while</code> loops should be used the the number of iterations is unknown in advance, or when the loop is turning complex for some reason. For example if you need to alter the loop iterator variable inside the loop body, then you should use a <code>while</code> loop instead of a <code>for</code> loop.</li>\n<li><code>do while</code> loops should be used for special cases where you need to skip the condition check the first lap of the loop, for example <code>do { result = send(); }  while(result == ok);</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1477494264, "creation_date": 1477494264, "answer_id": 40265814, "question_id": 40265253, "link": "https://stackoverflow.com/questions/40265253/for-versus-while-versus-do-loop-statements/40265814#40265814", "title": "For versus while versus do loop statements", "body": "<p>From the point of view of algorithmic for and while are not the same. Shortly, in algorithmic, for should be used when bounds are known and while when you don't know if the condition can be met or when it can be. For is to repeat something n times (n known), which is exactly the case of your example computation; a for loop should be used (don't you think what the loop makes is more clearly stated in the for loop ?). If you want an example of a must be used while loop, look at something like Collatz sequence. From a point of view of computability, for loops can always be transformed in while loops but not the converse.</p>\n\n<p>From the point of view of computer languages it is now common to fuse both, in C for example, it makes no difference, only syntactic. But remember that in some other language that could be very different, for example in Pascal for loops are very limited. </p>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 6523756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a472dd3d7c8943de1480ee6c7de4a299?s=128&d=identicon&r=PG&f=1", "display_name": "Damien Baldy", "link": "https://stackoverflow.com/users/6523756/damien-baldy"}, "is_accepted": false, "score": 2, "last_activity_date": 1477496086, "creation_date": 1477496086, "answer_id": 40266458, "question_id": 40265253, "link": "https://stackoverflow.com/questions/40265253/for-versus-while-versus-do-loop-statements/40266458#40266458", "title": "For versus while versus do loop statements", "body": "<p>I looked at my <strong>Code Complete</strong>  by Steve McConnell <em>(the bible)</em>.</p>\n\n<p>Here is what you can read in chapter 16:</p>\n\n<p><em>A for loop is a good choice when you need a loop that executes a specified number of times. [...]</em></p>\n\n<p><em>Use for loops for simple activities that don't require internal loops controls. Use them when the loop involves simple increments or simple decrements, such as iterating  through the elements in a container. The point of a for loop is that you set it up at the top of the loop and then forget about it. You don't have to do anything inside the loop to control it. If you have a condition under which execution has to jump out of a loop, use a while loop instead.</em></p>\n\n<p><em>Likewise, don't explicitly change the index value of a for loop to force it to terminate. Use a while loop instead. The for loop is for simple uses. Most complicated looping tasks are better handled by a while loop.</em></p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1477496404, "creation_date": 1477496404, "answer_id": 40266570, "question_id": 40265253, "link": "https://stackoverflow.com/questions/40265253/for-versus-while-versus-do-loop-statements/40266570#40266570", "title": "For versus while versus do loop statements", "body": "<p>In general, you would use a <code>for</code> loop to iterate over a finite set of values, whereas you'd use a <code>while</code> or <code>do-while</code> loop to iterate while a specific condition or set of conditions is true.  In most of C's contemporaries (Basic, Pascal, Fortran, etc.), a <code>for</code> loop can <em>only</em> iterate over a scalar index:</p>\n\n<p>Fortran:</p>\n\n<pre><code>      DO 10 i=1,10\n        <em>statements</em>\n   10 CONTINUE\n</code></pre>  \n\n<p>Pascal:</p>\n\n<pre><code>for i := 1 to 10 do\nbegin\n  <em>statements</em>\nend;\n</code></pre>\n\n<p>Both of these snippets loop exactly 10 times.  The index <code>i</code> is initialized and updated by the loop automagically.  I'd have to go back and check, but I'm pretty sure you cannot write to <code>i</code> in the loop body.  </p>\n\n<p>C actually blurred the lines between a <code>for</code> and <code>while</code> loop by adding the control expression:</p>\n\n<pre><code>for ( <em>init-expr</em> ; <em>control-expr</em> ; <em>update-expr</em> )\n  <em>statement</em>\n</code></pre>\n\n<p>In C, a <code>for</code> loop can iterate over a scalar just like Fortran or Pascal:</p>\n\n<pre><code>for( i = 0; i &lt; 10; i++ )\n{\n  do_something_with( i );\n}\n</code></pre>\n\n<p>Or it can iterate over multiple scalars:</p>\n\n<pre><code>for ( i = 0, j = 0; i &lt; 10 &amp;&amp; j &lt; 10; i++, j++ )\n{\n  do_something_with( i, j );\n}\n</code></pre>\n\n<p>Or it can iterate over the contents of a file:</p>\n\n<pre><code>for( c = fgetc( in ); c != EOF; c = fgetc( in ) )\n{\n  do_something_with( c );\n}\n</code></pre>\n\n<p>Or it can iterate over a linked list:</p>\n\n<pre><code>for( cur = head; cur != NULL; cur = cur-&gt;next )\n{\n  do_something_with( cur );\n}\n</code></pre>\n\n<p>In Fortran and Pascal, those last three loops would have to be expressed as <code>while</code> loops (which I'm not going to do, because I've pretty much exhausted my Fortran and Pascal knowledge already).  </p>\n\n<p>The other big difference between a C <code>for</code> loop and those of Fortran or Pascal is that you can write to the loop index (<code>i</code>, <code>j</code>, <code>c</code>, or <code>cur</code>) in the loop body; it's not specially protected in any way.</p>\n\n<p>A <code>while</code> or <code>do-while</code> loop is used to iterate as long as a specific condition or set of conditions is true:</p>\n\n<pre><code>while( <em>control-expr</em> )\n  <em>statement</em>\n</code></pre>\n\n<pre><code>do\n  <em>statement</em>\nwhile( <em>control-expr</em> );\n</code></pre>\n\n<p>In both a <code>for</code> and <code>while</code> loop, the condition is tested <em>before</em> the loop body executes; in a <code>do-while</code> loop, the condition is tested <em>after</em> the loop body executes, so a <code>do-while</code> loop will always execute at least once.  </p>\n\n<p>In C, you can use either a <code>for</code> loop or a <code>while</code> loop in many circumstances:</p>\n\n<pre><code>while ( ( c = fgetc( in ) ) != EOF )\n  do_something_with( c );\n\nfor ( c = fgetc( in ); c != EOF; c = fgetc( in ) )\n  do_something_with( c );\n</code></pre>\n\n<p>Both loops do exactly the same thing; it's just a matter of which one you think more clearly expresses your intent, or which you think would be easier for other people to understand. </p>\n"}, {"tags": [], "owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "is_accepted": false, "score": 0, "last_activity_date": 1477496670, "creation_date": 1477496670, "answer_id": 40266644, "question_id": 40265253, "link": "https://stackoverflow.com/questions/40265253/for-versus-while-versus-do-loop-statements/40266644#40266644", "title": "For versus while versus do loop statements", "body": "<p>Source code is written not only to be compiled and executed by computers but also to be read and understood by humans.</p>\n\n<p>A computer doesn't really mind whether a <code>for</code> loop, a <code>while</code> loop or a <code>goto</code> is used. On the other hand, a human expects different meanings for different structures.</p>\n\n<ul>\n<li>computing values over a known range of inputs is best shown with a <code>for</code> loop;</li>\n<li>reading a file up to its end is best shown with a <code>while</code> loop.</li>\n</ul>\n\n<p>Choosing which structure to use is similar as choosing a variable name.</p>\n"}], "owner": {"reputation": 77, "user_id": 6894472, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9cf1cb4f543ac1ef10e59b3b01155a07?s=128&d=identicon&r=PG&f=1", "display_name": "Newtoprogram", "link": "https://stackoverflow.com/users/6894472/newtoprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 40266570, "answer_count": 6, "score": 2, "last_activity_date": 1477502448, "creation_date": 1477492859, "last_edit_date": 1477494048, "question_id": 40265253, "link": "https://stackoverflow.com/questions/40265253/for-versus-while-versus-do-loop-statements", "title": "For versus while versus do loop statements", "body": "<p>Is there a difference between <code>for</code> and <code>while</code> statements? Is it just syntax?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main() {\n    int cent_temp = 0;\n    int fah_temp;\n    while (cent_temp &lt;= 20) {\n        fah_temp = (9 * cent_temp) / 5 + 32;\n        printf(\"%d degrees C = %d degrees F\\n\", cent_temp, fah_temp);\n        cent_temp++;\n    }\n}\n</code></pre>\n\n<p>This means to me....</p>\n\n<p>While the value of <code>cent_temp</code> is less than <code>20</code> then calculate <code>fah_temp</code>. Then increase the value of <code>cent_temp</code> by <code>1</code> and check it is still less than <code>20</code>; then go round the loop again.</p>\n\n<p>Regarding the syntax: </p>\n\n<pre><code>printf(\"%d degrees C = %d degrees F\\n\", cent_temp, fah_temp);\n</code></pre>\n\n<p>This means <code>%d</code> means print to the screen, replace with a decimal number the value of <code>cent_temp</code> and <code>%d</code> means replace with a decimal number the value of <code>fah_temp</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main() {\n    int cent_temp;\n    int fah_temp;\n    for (cent_temp = 0; cent_temp &lt;= 20; cent_temp++) {\n        fah_temp = (9 * cent_temp) / 5 + 32;\n        printf(\"%2d degrees C = %2d degrees F\\n\", cent_temp, fah_temp);\n    }\n}\n</code></pre>\n\n<p>My interpretation of the above is:\nfor <code>cent_temp</code> = <code>0</code> repeat while <code>cent_temp</code> less than <code>20</code> and then execute <code>cent_temp+1</code> at the end. So <code>cent_temp</code> <code>0</code> goes into the loop to calculate <code>fah_temp</code> and gets printed to the screen. Then <code>cent_temp</code> goes up by one then goes round the loop again. Here I've used <code>%2d</code> instead of <code>%d</code> to signify that it should have 2 spaces for a decimal number (and they line up when executed). Both codes will not execute if <code>cent_temp &gt; 20</code>.</p>\n\n<p>Similarly rearranging the statement in a <code>do</code> <code>while</code> loop has a similar effect and doesn't really have an impact on the result.</p>\n\n<p>Does each type of loop have a different application?</p>\n\n<p>Please correct me if I wrong!</p>\n"}, {"tags": ["c", "xml", "docx"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1477492566, "post_id": 40265061, "comment_id": 67790622, "body": "What are you <b>actually</b> trying to achieve. This might be an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1477492620, "post_id": 40265061, "comment_id": 67790672, "body": "<code>docx</code> documents are supposed to be <a href=\"https://en.wikipedia.org/wiki/Office_Open_XML\" rel=\"nofollow noreferrer\">OfficeOpen XML</a> documents, which are standardized. Office is known for adding non-standard extensions to it, and there used to be some controversy about features that were barely documented or not documented at all. I suggest you try to find a library to handle the documents for you, not try to do it all yourself."}, {"owner": {"reputation": 13, "user_id": 7074058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7a8fbb4f9a0cbdc024233d0c343a7e?s=128&d=identicon&r=PG&f=1", "display_name": "user52327", "link": "https://stackoverflow.com/users/7074058/user52327"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477492983, "post_id": 40265061, "comment_id": 67790958, "body": "@MichaelWalz I want to read the contents of .docx file in a buffer and add anything I like in that buffer, then use it afterwards to create a new .docx file."}, {"owner": {"reputation": 13, "user_id": 7074058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7a8fbb4f9a0cbdc024233d0c343a7e?s=128&d=identicon&r=PG&f=1", "display_name": "user52327", "link": "https://stackoverflow.com/users/7074058/user52327"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1477493007, "post_id": 40265061, "comment_id": 67790976, "body": "Do you have any idea about such library? @Someprogrammerdude"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477493412, "post_id": 40265061, "comment_id": 67791309, "body": "@alex yes I understood that. But you should explain what the purpose of all this is. Why do you want to add &quot;something&quot; to a Word document. Suppose you manage to add &quot;something&quot; to the word document, then what ?"}, {"owner": {"reputation": 13, "user_id": 7074058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7a8fbb4f9a0cbdc024233d0c343a7e?s=128&d=identicon&r=PG&f=1", "display_name": "user52327", "link": "https://stackoverflow.com/users/7074058/user52327"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477499194, "post_id": 40265061, "comment_id": 67795244, "body": "@MichaelWalz I have edited my question now, kindly check it"}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1477499531, "post_id": 40265061, "comment_id": 67795425, "body": "@alex I think you&#39;re misunderstanding how encryption works - the AES algorithm does not need to understand your file or parse anything. It is bit-level manipulation, nothing more. If your file becomes corrupted along the way, your implementation of the algorithm is wrong."}, {"owner": {"reputation": 2083, "user_id": 639069, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/36ca255e1dbe80385228b10ce2950ca5?s=128&d=identicon&r=PG", "display_name": "R.D.", "link": "https://stackoverflow.com/users/639069/r-d"}, "edited": false, "score": 0, "creation_date": 1477506941, "post_id": 40265061, "comment_id": 67799560, "body": "@alex This doesn&#39;t directly answer your question, but you&#39;ll eventually need to parse the .docx file at some point, and that&#39;d involve string manipulation.  Doing <i>anything</i> string related in C is a giant PITA and you&#39;ll end up debugging unnecessary bugs.  I&#39;d wholeheartedly encourage you to use another language, preferably one that provides first class support for strings."}], "answers": [{"tags": [], "owner": {"reputation": 88945, "user_id": 290085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306077a2fb7af6587f470214a1b337ff?s=128&d=identicon&r=PG", "display_name": "kjhughes", "link": "https://stackoverflow.com/users/290085/kjhughes"}, "is_accepted": false, "score": 1, "last_activity_date": 1477493686, "creation_date": 1477493686, "answer_id": 40265581, "question_id": 40265061, "link": "https://stackoverflow.com/questions/40265061/how-to-read-manipulate-and-write-docx-file-in-c/40265581#40265581", "title": "How to read, manipulate and write .docx file in c", "body": "<p>DOCX files are based on OPC and OOXML.  OPC is based on Zip.  OOXML is based on XML.  Therefore, you can use Zip and XML tools to operate on DOCX files.  Beyond this, you'll have to be more specific about what you wish to do in order to receive better guidance.</p>\n\n<p>Poking characters into random index locations in an XML file is operating at the wrong level of abstraction.</p>\n"}], "owner": {"reputation": 13, "user_id": 7074058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7a8fbb4f9a0cbdc024233d0c343a7e?s=128&d=identicon&r=PG&f=1", "display_name": "user52327", "link": "https://stackoverflow.com/users/7074058/user52327"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477499163, "creation_date": 1477492295, "last_edit_date": 1477499163, "question_id": 40265061, "link": "https://stackoverflow.com/questions/40265061/how-to-read-manipulate-and-write-docx-file-in-c", "title": "How to read, manipulate and write .docx file in c", "body": "<p>I am reading .docx file in a buffer and writing it to a new file successfully. (Using fread and fwrite in C) However now I want to enhance the scope of this project for the purpose of encryption. For which I want to be able to manipulate the buffer, then write it in new file.</p>\n\n<p>Now one question might be, what manipulation do I need?\nIt could be anything really, like I'd write character 's' in buffer's location 15. Like below, and then write this new buffer (having character 's' at location 15, but the rest of the buffer remains unchanged) in a new .docx file.</p>\n\n<pre><code>buffer[15] = 's';\n</code></pre>\n\n<p>When I did this, the file that was created was corrupt. Since I am not fully aware of the structure of .docx file, this byte number 15 could be some potential identifier, or header, or any important information of .docx file needed for creating a non-corrupt file.</p>\n\n<p>However, the things I know about .docx internal structure are: </p>\n\n<ol>\n<li><p>It consists of XML files, zipped together. </p></li>\n<li><p>The content that is written in .docx file, (for e.g. I have a file named test.docx, and it contains \"Hello, how are you?\") then the contents \"Hello, how are you?\" are stored in XML files. </p></li>\n<li><p>There is a .rels (not confirm) extension file, among those files that are zipped together, that tells MS word about where the content is stored in file, i.e. where to look for content.</p></li>\n</ol>\n\n<p>Apart from these 3 points I don't know much about structure of .docx file. Now considering all this, I want to be able to extract the contents of .docx file, from the XML files zipped together, read it (in C) in a buffer, change the buffer as I need it, and create a new file, with the new content that is present in the buffer.</p>\n\n<p>Can someone guide me through this? \nAlso kindly mention, if I need to provide code, or any other essential details. Thanks in advance.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>PURPOSE OF ALL THIS:</p>\n\n<p>I want to do all this for encryption. As by encrypting a file (using AES) the whole file will become unreadable, corrupt and everything inside will be changed from its place. When I decrypt that file, the file is unable to open. My guess is, as AES decryption algo does not know how to parse the contents recovered from decrypting the encrypted file, in to a new .docx file, thus it is unable to place the contents/structure properly in its place.</p>\n\n<p>I have tried it. Original docx file was of 14 KB, encrypted docx file was of 14 KB as well as the decrypted docx file. But when I try to open the decrypted file, it says file is corrupt. Also I tried to check it in HEX editor. Decrypted file has just 00 bytes after exactly 30 Bytes.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 3, "creation_date": 1477492101, "post_id": 40264911, "comment_id": 67790299, "body": "Please see <a href=\"http://stackoverflow.com/help/mcve\">here</a> on how to create a <i>minimal, complete, and verifiable example</i> (with emphasis on <i>minimal</i>). The long and short of it is: don&#39;t just dump your entire code here - narrow it down to a small section of code that reproduces the issue and give us that."}, {"owner": {"reputation": 577, "user_id": 3034338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9324b483505227ab1839298f7159d1?s=128&d=identicon&r=PG&f=1", "display_name": "fernando.reyes", "link": "https://stackoverflow.com/users/3034338/fernando-reyes"}, "edited": false, "score": 1, "creation_date": 1477492311, "post_id": 40264911, "comment_id": 67790440, "body": "After the while(Compare())  you make deposit = depositPtr, that erases all the deposits you made and make it only worth the last one"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1477492610, "post_id": 40264911, "comment_id": 67790664, "body": "Note: <b>Never</b> use floating point types if you need <b>exact</b> values. They cannot represent almost all fractional values exactly. Use scaled integers for currencies."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1477492647, "post_id": 40264911, "comment_id": 67790699, "body": "Do not ever, under any circumstances, not even in &quot;I&#39;m learning&quot; test code, for any reason whatsoever use <code>float</code> or <code>double</code> when doing currency calculations. In fact, since you&#39;re learning, count other things. Don&#39;t touch money. Money is special, it is not floating point. Learn on anything else. Please. Money is really special and requires some knowledge to get right and if you learn bad habits when dealing with money bad things will happen. <code>Money is not floating point.</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1477492742, "post_id": 40264911, "comment_id": 67790768, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1477492762, "post_id": 40264911, "comment_id": 67790783, "body": "If you insist on learning with money anyway: use integers and count cents, not dollars. You won&#39;t get all rounding right all the time, but it will be correct in 99.9% of the cases. Floating points will almost never be correct."}, {"owner": {"reputation": 27, "user_id": 6866732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e04df3487bdfde880dad72132da8aa6d?s=128&d=identicon&r=PG&f=1", "display_name": "user6866732", "link": "https://stackoverflow.com/users/6866732/user6866732"}, "edited": false, "score": 0, "creation_date": 1477492887, "post_id": 40264911, "comment_id": 67790880, "body": "Thank you for your advice! I will keep this in mind."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1477496134, "post_id": 40264911, "comment_id": 67793267, "body": "Advice to not use <code>double</code> for currency is simply calling that approach bad without providing alternatives.  All approaches in C have their short-comings, not only <code>double</code>.  The best is to clearly understand and code for those issues - as with all programming tasks. <a href=\"http://stackoverflow.com/questions/32212213/how-to-represent-currency-or-money-in-c/32214586#32214586\">This</a> discusses some of those currency issues."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6866732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e04df3487bdfde880dad72132da8aa6d?s=128&d=identicon&r=PG&f=1", "display_name": "user6866732", "link": "https://stackoverflow.com/users/6866732/user6866732"}, "edited": false, "score": 0, "creation_date": 1477492803, "post_id": 40265021, "comment_id": 67790814, "body": "Thank you so much! I found the problem and fixed as you suggested :)"}], "tags": [], "owner": {"reputation": 187, "user_id": 6937350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9a63015fae205170708101ec33f586?s=128&d=identicon&r=PG&f=1", "display_name": "Isukthar", "link": "https://stackoverflow.com/users/6937350/isukthar"}, "is_accepted": false, "score": 2, "last_activity_date": 1477492209, "creation_date": 1477492209, "answer_id": 40265021, "question_id": 40264911, "link": "https://stackoverflow.com/questions/40264911/deposit-gives-negative-number/40265021#40265021", "title": "Deposit gives negative number?", "body": "<p>In this code : <code>GetChange(&amp;depositPtr, choiceCost);</code>\nYou shold pass <code>deposit</code> (total deposit) and not <code>&amp;depositPtr</code> (last deposit, only 10)</p>\n"}], "owner": {"reputation": 27, "user_id": 6866732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e04df3487bdfde880dad72132da8aa6d?s=128&d=identicon&r=PG&f=1", "display_name": "user6866732", "link": "https://stackoverflow.com/users/6866732/user6866732"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510535379, "creation_date": 1477491922, "question_id": 40264911, "link": "https://stackoverflow.com/questions/40264911/deposit-gives-negative-number", "title": "Deposit gives negative number?", "body": "<p>Good morning, guys! I'm currently a newly started programming learner. Down here is my code for a mini app store. However, there is a problem going on, yet I couldnt locate the problem. \nThe problem happen when I tried buying an app for $89.99 and I chose to redeem $10 9 times so I would have enough money to purchase the app (I didnt choose the $100 option because it would work just fine). However, the remained amount became  $-79.99 instead of $0.01. Like I said, if I chose to deposit $100, the remained balance would be $10.01, which is normal. I don't get where I did wrong. Here is my code!</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint Compare(double deposit, double choiceCost);\nvoid DisplayApps(char *selectionPtr);\nvoid SetCost(char selection, double *costPtr);\nvoid PaymentOptions(double *depositPtr,double cost);\nvoid DoItAgain(char *quitPtr);\n//void Pay(double *depositPtr, double choiceCost);\nvoid GetChange(double *depositPtr, double choiceCost);\nvoid DoItAgain(char *quitPtr);\n\nint main()\n{\n    char selectionPtr;\n    char selection;\n    char quitPtr;\n    double costPtr;\n    double deposit = 0.0;\n    double choiceCost;\n    double depositPtr = 0.0;\n    double cost = 0.0;\n\n    printf(\"Welcome to the App Store\\n\");\n    printf(\"***************************\\n\\n\");\n    printf(\"Your deposit is: %.2f\\n\", deposit);\n    printf(\"\\n\");\n\n    while (1)\n    {\n        do {\n            DisplayApps(&amp;selectionPtr);\n\n            selection = selectionPtr;\n            SetCost(selection, &amp;costPtr);\n\n            choiceCost = costPtr;\n            Compare(deposit, choiceCost);\n\n            while (Compare(deposit, choiceCost) == 0)\n            {\n                printf(\"Your balance isn't enough.\\n\");\n                printf(\"In order to purchase this item, you have to redeem more money.\\n\");\n                PaymentOptions(&amp;depositPtr, cost);\n                deposit += depositPtr;\n                printf(\"You have redeemed $%.2f\\n\", depositPtr);\n                printf(\"Your balance now is: $%.2f\\n\", deposit);\n                printf(\"\\n\");\n            }\n            deposit = depositPtr;\n\n            GetChange(&amp;depositPtr, choiceCost);\n\n            DoItAgain(&amp;quitPtr);\n        } while (quitPtr == 'Y' || quitPtr == 'y');\n        return 1;\n    }\n\n    return 0;\n}\n\nvoid DisplayApps(char *selectionPtr)\n{\n    printf(\"-------------------------\\n\");\n    printf(\"HERE ARE THE SLECTIONS\\n\");\n    printf(\"C -- Clown Punching             $299.99\\n\");\n    printf(\"V -- Virtual Snow Globe         $349.99\\n\");\n    printf(\"R -- Remote PC                  $999.99\\n\");\n    printf(\"G -- Grocery List Helper        $2.99\\n\");\n    printf(\"M -- Mobile Cam Viewer          $89.99\\n\");\n    printf(\"\\n\");\n\n    printf(\"Please enter a selection: \");\n    scanf(\" %c\", &amp;*selectionPtr);\n    printf(\"\\n\");\n\n}\n\nvoid SetCost(char selection, double *costPtr)\n{\n    if (selection == 'C' || selection == 'c')\n    {\n        *costPtr = 299.99;\n    }\n    else if (selection == 'V' || selection == 'v')\n    {\n        *costPtr = 349.99;\n    }\n    else if (selection == 'R' || selection == 'r')\n    {\n        *costPtr = 999.99;\n    }\n    else if (selection == 'G' || selection == 'g')\n    {\n        *costPtr = 2.99;\n    }\n    else if (selection == 'M' || selection == 'm')\n    {\n        *costPtr = 89.99;\n    }\n}\n\nint Compare(double deposit, double choiceCost)\n{\n    if (deposit &lt; choiceCost)\n    {\n        return 0;\n    }\n    else\n    {\n        return 1;\n    }\n}\n\nvoid PaymentOptions(double *depositPtr, double cost)\n{\n    printf(\"You have (4) options to choose:\\n\");\n    printf(\"1 - $1000.00\\n\");\n    printf(\"2 - $500.00\\n\");\n    printf(\"3 - $100.00\\n\");\n    printf(\"4 - $10.00\\n\");\n    printf(\"How much do you want to redeem?\");\n    printf(\"&gt;&gt;&gt;&gt;&gt; \");\n    scanf(\"%lf\", &amp;cost);\n    printf(\"\\n\");\n    printf(\"-------------------------------------\\n\");\n    if (cost == 1)\n    {\n        *depositPtr = 1000.00;\n    }\n    else if (cost == 2)\n    {\n        *depositPtr = 500.00;\n    }\n    else if (cost == 3)\n    {\n        *depositPtr = 100.00;\n    }\n    else if (cost == 4)\n    {\n        *depositPtr = 10.00;\n    }\n\n}\n\nvoid GetChange(double *depositPtr, double choiceCost)\n{\n    *depositPtr = *depositPtr - choiceCost;\n    printf(\"You have purchased this item successfully.\\n\");\n    printf(\"You still have $%.2f remained in you balance.\\n\", *depositPtr);\n}\n\nvoid DoItAgain(char *quitPtr)\n{\n    printf(\"Do you want to continue purchase another item? [Y/N]\\n\");\n    scanf(\" %c\", &amp;*quitPtr);\n}\n</code></pre>\n"}, {"tags": ["c", "performance", "haskell", "cairo"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477491904, "post_id": 40264828, "comment_id": 67790169, "body": "The easiest way to find out would of course be to disassemble two binaries. I&#39;m thinking there shouldn&#39;t be much Haskell&#39;s compiler can do to slow down the code inside Cairo, though."}, {"owner": {"reputation": 217, "user_id": 3916445, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/457c04fab5a8f301f264674174733af6?s=128&d=identicon&r=PG&f=1", "display_name": "nico7et8", "link": "https://stackoverflow.com/users/3916445/nico7et8"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1477492070, "post_id": 40264828, "comment_id": 67790279, "body": "Yup. But... Disassembling binaries -&gt; bit out of my league for now."}, {"owner": {"reputation": 1444, "user_id": 6062567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e87060f0ce67ed68a097ac5186027c5?s=128&d=identicon&r=PG&f=1", "display_name": "oldtechaa", "link": "https://stackoverflow.com/users/6062567/oldtechaa"}, "edited": false, "score": 0, "creation_date": 1477512667, "post_id": 40264828, "comment_id": 67802553, "body": "Just as a note, Haskell compilers may not be as optimized either, so you may take a performance hit there."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 9, "last_activity_date": 1477492140, "creation_date": 1477492140, "answer_id": 40264991, "question_id": 40264828, "link": "https://stackoverflow.com/questions/40264828/is-cairo-graphics-slower-in-other-languages-than-c-in-haskell-for-example/40264991#40264991", "title": "Is Cairo Graphics slower in other languages than c? In Haskell for example?", "body": "<p>There's some FFI overhead from most languages calling C libraries. It's a small (usually-)constant overhead on each call to a C function, but it will add up if you make lot of calls.</p>\n\n<p>This isn't unique to calling C, for what it's worth. Any crossing of memory management systems does the job.  That's why modern OpenGL recommends doing as much as possible in calls that send data to graphics memory in giant blocks, instead of one triangle at a time.</p>\n"}], "owner": {"reputation": 217, "user_id": 3916445, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/457c04fab5a8f301f264674174733af6?s=128&d=identicon&r=PG&f=1", "display_name": "nico7et8", "link": "https://stackoverflow.com/users/3916445/nico7et8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 40264991, "answer_count": 1, "score": 3, "last_activity_date": 1477492140, "creation_date": 1477491717, "question_id": 40264828, "link": "https://stackoverflow.com/questions/40264828/is-cairo-graphics-slower-in-other-languages-than-c-in-haskell-for-example", "title": "Is Cairo Graphics slower in other languages than c? In Haskell for example?", "body": "<p>I've been using Cairo Graphics in c for a while and I'd like to use it in a more high-level language (namely Haskell, I've also tried Python). It works but truthfully, I don't have a clear picture in my head on how that works internally.</p>\n\n<p>When my Haskell source is compiled, is the cairo-related part of the object file the same as if it had been compiled from a c source ?</p>\n\n<p>Will <code>cairo_line_to (cr, 100, 100)</code> in c be compiled into the same machine code as <code>LineTo 100 100</code> in Haskell? Will the performance be the same?</p>\n"}, {"tags": ["c", "pointers", "valgrind"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1477491338, "post_id": 40264686, "comment_id": 67789770, "body": "AFAIK, C does not have classes."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1477491353, "post_id": 40264686, "comment_id": 67789782, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 6, "creation_date": 1477491442, "post_id": 40264686, "comment_id": 67789852, "body": "<code>if(array ==NULL)     {      return (uint64_t*) 1;     }</code> is fishy..."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477491533, "post_id": 40264686, "comment_id": 67789914, "body": "@SouravGhosh: That&#39;s putting it mildly."}, {"owner": {"reputation": 6743, "user_id": 6919895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qqkN_JOgCvM/AAAAAAAAAAI/AAAAAAAAABE/m4r_i_2yiy8/photo.jpg?sz=128", "display_name": "Treycos", "link": "https://stackoverflow.com/users/6919895/treycos"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477491592, "post_id": 40264686, "comment_id": 67789953, "body": "@SouravGhosh Its not fishy, its almost a whale right there"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 3, "creation_date": 1477491704, "post_id": 40264686, "comment_id": 67790034, "body": "valgrind is telling you where the error is. You&#39;re calling <code>atoi</code> on a NULL pointer. This has nothing to do with malloc or free because you&#39;re crashing long before you&#39;ve had a chance to call malloc. You might want to check argc before you fiddle with argv."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1477492009, "post_id": 40264686, "comment_id": 67790241, "body": "I think @Art has your answer. You&#39;re initializing <code>limit</code> before you&#39;ve checked if there is an <code>argv[1]</code>. Fix that and you&#39;ll be on to your next bug. Good luck."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477492976, "post_id": 40264686, "comment_id": 67790953, "body": "What are the command line arguments ?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1477563210, "post_id": 40264686, "comment_id": 67822112, "body": "why did you removed the code from your question? It strips the answer you received of the context."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1477492080, "creation_date": 1477492080, "answer_id": 40264967, "question_id": 40264686, "link": "https://stackoverflow.com/questions/40264686/c-malloc-and-free-does-not-work/40264967#40264967", "title": "C malloc and free does not work", "body": "<p>The stack trace in the valgrind output attributes the error to one of the three calls to <code>atoi()</code> by <code>main()</code>.  The specific problem appears to be that a null pointer was passed to that function.  The argument to each <code>atoi()</code> call is an element of the <code>argv</code> array, so your (immediate) problem is with program argument handling, not with dynamic memory allocation.</p>\n\n<p>It looks like the problem must be here:</p>\n\n<pre><code>int limit = atoi(argv[1]);\n</code></pre>\n\n<p>You perform that <code>atoi()</code> call unconditionally, but when <code>argc</code> is less than 2, it exhibits undefined behavior.</p>\n"}], "owner": {"reputation": 231, "user_id": 5873351, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ab854d68db2952930c51a207bf1cd8bb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5873351/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477564275, "creation_date": 1477491297, "last_edit_date": 1477564275, "question_id": 40264686, "link": "https://stackoverflow.com/questions/40264686/c-malloc-and-free-does-not-work", "title": "C malloc and free does not work", "body": "<p>I am new to C and I have some troubles with malloc and free. I can not figure it out where is the problem. I have a program with prime.c and main.c </p>\n\n<p>I use malloc allocation for my array and when I call free in main.c valgrind shows me this error </p>\n\n<pre><code>==13518==     in use at exit: 0 bytes in 0 blocks\n==13518==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated\n==13518== \n==13518== All heap blocks were freed -- no leaks are possible\n==13518== \n==13518== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n==13518== \n==13518== 1 errors in context 1 of 1:\n==13518== Invalid read of size 1\n==13518==    at 0x40D2DFB: ____strtol_l_internal (in /usr/lib/libc-2.23.so)\n==13518==    by 0x40D2C68: strtol (in /usr/lib/libc-2.23.so)\n==13518==    by 0x40CFAFF: atoi (in /usr/lib/libc-2.23.so)\n==13518==    by 0x80487B0: main (in /media/test/prime)\n==13518==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==13518== \n==13518== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>here are my two classes</p>\n\n<p>prime.c</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"prime.h\"\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nuint64_t* findPrime(uint64_t max ,size_t* primeCount)\n{\n\n    int cnt=0;\n    uint64_t *array;\n    array = (uint64_t *) malloc(max * sizeof(uint64_t));\n\n\n    if(array ==NULL)\n    {\n\n    return (uint64_t*) 1;\n    }\n\n\nfor(int i =2; i &lt; max;i++)\n    {\n    array[i] = i;\n    }\n\nfor(int i = 2;i &lt;= sqrt(max);i++)\n    {\n\n    if(array[i] != 0)\n    {\n\nfor(int j = (i*i); j&lt; max; j =j+i)\n        {\n    array[j] = 0;\n        }\n    }\n    }\n\nfor(int i =2; i &lt;max; i++)\n    {\n        if(array[i])\n        {\n        cnt++;\n        }\n    }\n\n    *primeCount = cnt;\nreturn array;\n}\n</code></pre>\n\n<p>main.c </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"prime.h\"\n#include &lt;string.h&gt;\n\nint main(int argc, char* argv[]){\n\n    int len = argc-1;\n    int limit = atoi(argv[1]);\n    int ret =1;\n    size_t pc =0; \n\n\n    if(len == 1)\n    {\n    limit = atoi(argv[1]);\n    }\n    else if(len == 2)\n    {\n    limit = atoi(argv[2]);\n    ret = strcmp(argv[1],\"-p\");\n\n    if(ret != 0)\n    {\n    printf(\"Invalid input!\\n\");\n    return 1;\n    }\n    }\n    else\n    {\n    printf(\"Wrong number of arguments!!!\\n\");\n    return 1;    \n    }\n\n    uint64_t* primes  = findPrime(limit, &amp;pc);\n       printf(\"Total number of primes %zu \\n\", pc);\n\n    if(ret == 0)\n    { \n        for(int i =2; i &lt; limit;i++)\n        {\n        if(primes[i] != 0)\n        {\n            printf(\"primess: %lld \\n\", primes[i]);\n        }    \n        }\n    }\n    free(primes);\n    }\n</code></pre>\n"}, {"tags": ["c", "math", "floating-point", "precision", "division"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1477490984, "post_id": 40264523, "comment_id": 67789491, "body": "Because the <i>result</i> is <code>float</code>. But the operands and hence the operation itself is integer."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1477491087, "post_id": 40264523, "comment_id": 67789582, "body": "<a href=\"https://stackoverflow.com/questions/27674295/why-do-we-separately-cast-to-float-in-an-integer-division\">Related question here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1477491055, "post_id": 40264561, "comment_id": 67789553, "body": "<code>5.</code> or <code>2.</code> will do."}, {"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 4, "creation_date": 1477491266, "post_id": 40264561, "comment_id": 67789717, "body": "@alk: I just like to have the zeros there - they serve no real purpose, but with my decaying eyesight, I often miss <code>.</code> by itself but I haven&#39;t yet missed a <code>.0</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1477491389, "post_id": 40264561, "comment_id": 67789808, "body": "I&#39;d then propose to use <code>.00</code>, as you most likely have two eyes. ;-)"}, {"owner": {"reputation": 61, "user_id": 7031939, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fd1df26accafaf6afe32405d3df0414f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Lord", "link": "https://stackoverflow.com/users/7031939/alex-lord"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1477492540, "post_id": 40264561, "comment_id": 67790601, "body": "@alk  Thank you both! :D"}], "tags": [], "owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "is_accepted": true, "score": 7, "last_activity_date": 1477491092, "last_edit_date": 1477491092, "creation_date": 1477490990, "answer_id": 40264561, "question_id": 40264523, "link": "https://stackoverflow.com/questions/40264523/why-does-5-2-results-in-2-even-when-i-use-a-float/40264561#40264561", "title": "Why does 5/2 results in &#39;2&#39; even when I use a float?", "body": "<p><code>5</code> is an <code>int</code> and <code>2</code> is an <code>int</code>. Therefore, <code>5/2</code> will use integer division. If you replace <code>5</code> with <code>5.0f</code> (or <code>2</code> with <code>2.0f</code>), making one of the <code>int</code>s a <code>float</code>, you will get floating point division and get the <code>2.5</code> you expect. You can also achieve the same effect by explicitly casting either the numerator or denominator (e.g. <code>((float) 5) / 2</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 2, "last_activity_date": 1477508693, "last_edit_date": 1477508693, "creation_date": 1477490993, "answer_id": 40264562, "question_id": 40264523, "link": "https://stackoverflow.com/questions/40264523/why-does-5-2-results-in-2-even-when-i-use-a-float/40264562#40264562", "title": "Why does 5/2 results in &#39;2&#39; even when I use a float?", "body": "<blockquote>\n  <p>Why does 5/2 results in '2' even when I use a float?</p>\n</blockquote>\n\n<p>Because you do <strong>not</strong> \"<em>use <code>float</code></em>\". <code>5/2</code> is an integer division. Only its result (<code>2</code>) gets implicitly converted to a <code>float</code> to become a <code>2.</code> (mind the dot).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7075607, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0c491af62b5a72101ad54a7ed44e36f6?s=128&d=identicon&r=PG", "display_name": "user7075607", "link": "https://stackoverflow.com/users/7075607/user7075607"}, "is_accepted": false, "score": 0, "last_activity_date": 1477496439, "last_edit_date": 1477496439, "creation_date": 1477491297, "answer_id": 40264684, "question_id": 40264523, "link": "https://stackoverflow.com/questions/40264523/why-does-5-2-results-in-2-even-when-i-use-a-float/40264684#40264684", "title": "Why does 5/2 results in &#39;2&#39; even when I use a float?", "body": "<p>You should do proper type-casting .</p>\n\n<pre><code>float y = (float) 5/2 \n</code></pre>\n\n<p>Program will treat the numbers as <code>int</code>.<br>\nIt is dividing two <code>int</code>s and writing this to <code>float</code>. Hence, answer is 2.0</p>\n\n<p>You must type cast</p>\n"}], "owner": {"reputation": 61, "user_id": 7031939, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fd1df26accafaf6afe32405d3df0414f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Lord", "link": "https://stackoverflow.com/users/7031939/alex-lord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15452, "favorite_count": 1, "closed_date": 1477491244, "accepted_answer_id": 40264561, "answer_count": 3, "score": 3, "last_activity_date": 1477508693, "creation_date": 1477490893, "last_edit_date": 1477491265, "question_id": 40264523, "link": "https://stackoverflow.com/questions/40264523/why-does-5-2-results-in-2-even-when-i-use-a-float", "closed_reason": "Duplicate", "title": "Why does 5/2 results in &#39;2&#39; even when I use a float?", "body": "<p>I entered the following code (and had no compiling problems or anything):</p>\n\n<pre><code>float y = 5/2;\nprintf(\"%f\\n\", y);\n</code></pre>\n\n<p>The output was simply:  <code>2.00000</code></p>\n\n<p>My math isn't wrong is it? Or am I wrong on the / operator? It means divide doesn't it? And 5/2 should equal 2.5?</p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["c", "string", "memory-management", "tokenize", "strtok"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477490106, "post_id": 40264178, "comment_id": 67788854, "body": "<a href=\"https://www.google.com/search?q=parse+a+string+using+strtok\" rel=\"nofollow noreferrer\">google.com/search?q=parse+a+string+using+strtok</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477490118, "post_id": 40264178, "comment_id": 67788863, "body": "<a href=\"http://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow noreferrer\"><code>strtok</code></a> does not allocate any memory. What makes you think it does ?"}, {"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1477490136, "post_id": 40264178, "comment_id": 67788875, "body": "<code>strtok</code> successively replaces the delimiter by <code>&#39;\\0&#39;</code>, which mutates the string but keeps the substrings inside of the original place in memory."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477490170, "post_id": 40264178, "comment_id": 67788909, "body": "<a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">Read this</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">this</a>."}, {"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1477490287, "post_id": 40264178, "comment_id": 67789000, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3889992/how-does-strtok-split-the-string-into-tokens-in-c\">How does strtok() split the string into tokens in C?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": false, "score": 1, "last_activity_date": 1477490195, "creation_date": 1477490195, "answer_id": 40264254, "question_id": 40264178, "link": "https://stackoverflow.com/questions/40264178/memory-allocation-when-using-the-strtok-function/40264254#40264254", "title": "Memory allocation when using the strtok() function", "body": "<p><code>strtok</code> does not allocate any strings, it inserts <code>\\0</code> characters into the source string and returns pointers that point to the now separated tokens. The memory for the source string is now memory that stores multiple strings (the tokens).</p>\n"}, {"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1477490248, "creation_date": 1477490248, "answer_id": 40264272, "question_id": 40264178, "link": "https://stackoverflow.com/questions/40264178/memory-allocation-when-using-the-strtok-function/40264272#40264272", "title": "Memory allocation when using the strtok() function", "body": "<p><code>strtok</code> does not allocate any memory; it makes modifications to the string you pass in the initial call.  The tokens are left in the original string being tokenized, so as long as that isn't deallocated (by you; <code>strtok</code> won't do it), your tokens will still be there.</p>\n"}], "owner": {"reputation": 227, "user_id": 7019978, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db5a35293f57ef2941b6decefa776b0f?s=128&d=identicon&r=PG&f=1", "display_name": "user628544", "link": "https://stackoverflow.com/users/7019978/user628544"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1477490248, "creation_date": 1477489978, "question_id": 40264178, "link": "https://stackoverflow.com/questions/40264178/memory-allocation-when-using-the-strtok-function", "title": "Memory allocation when using the strtok() function", "body": "<p>Do you have to reallocate memory for a string every time you use <code>strtok()</code>, or does the function do this for you?  I'm wondering, because I'm writing a program that reads a line from a file and breaks it into tokens.  I want to store each token in a variable called <code>cell</code>.  I could create multiple strings and put them in a linked list, but that would add a lot of overhead to the program, so I want to try to avoid it if I can.  So say you set <code>cell</code>'s value to the first string returned from <code>strtok()</code>, use it, and then set its value to the second string returned form <code>strtok()</code>, using an assignment statement.  I understand that this would simply redirect the pointer to the new character array, abandoning the old array.  Would this result in the old string becoming a lost object, or does <code>strtok()</code> free the old string for you?</p>\n"}, {"tags": ["c++", "c", "linux", "operating-system"], "comments": [{"owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 3, "creation_date": 1477488343, "post_id": 40263529, "comment_id": 67787446, "body": "Did you read the error message?"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1477488380, "post_id": 40263529, "comment_id": 67787478, "body": "I see <code>Permission denied</code> everywhere. Try adding <code>sudo</code> e.g. <code>sudo make myProgram</code>"}, {"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1477488386, "post_id": 40263529, "comment_id": 67787481, "body": "you probably need to use <code>fakeroot</code>"}, {"owner": {"reputation": 1685, "user_id": 6261331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uNHq.png?s=128&g=1", "display_name": "Asu", "link": "https://stackoverflow.com/users/6261331/asu"}, "edited": false, "score": 0, "creation_date": 1477488433, "post_id": 40263529, "comment_id": 67787518, "body": "iirc the tool i used to build a kernel did forbid me to compile it as root."}, {"owner": {"reputation": 11, "user_id": 7044128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f87c48153c7826ffd2825cbe8a35b81?s=128&d=identicon&r=PG&f=1", "display_name": "FURQAN ", "link": "https://stackoverflow.com/users/7044128/furqan"}, "edited": false, "score": 0, "creation_date": 1477488827, "post_id": 40263529, "comment_id": 67787833, "body": "i am compling linux  and when i write                                                 &quot;/usr/src/linux-headers-3.12.9-31209$ make&quot; on terminal   this give me the error"}, {"owner": {"reputation": 11, "user_id": 7044128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f87c48153c7826ffd2825cbe8a35b81?s=128&d=identicon&r=PG&f=1", "display_name": "FURQAN ", "link": "https://stackoverflow.com/users/7044128/furqan"}, "edited": false, "score": 0, "creation_date": 1477489270, "post_id": 40263529, "comment_id": 67788213, "body": "Asu fake root not working .IIRC is difficult to get online i want solution in short time"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1477490359, "post_id": 40263529, "comment_id": 67789041, "body": "The problem is that you are trying to build in a directory that you do not own and do not have permission to write in.  You should probably be performing an out-of-source build."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1477490600, "post_id": 40263529, "comment_id": 67789222, "body": "If you want to perform an out-of-source build by hand, as opposed to via whatever kernel-building tools are provided by your distro, you could try this: (1) create a build directory within your home directory, e.g. <code>&#47;home&#47;furqan&#47;kernel</code>, and make that your working directory.  (2) Run <code>make</code> via this command: <code>make -f &#47;usr&#47;src&#47;linux-headers-3.12.9-31209&#47;Makefile VPATH=&#47;usr&#47;src&#47;linux-headers-3.12.9-31209</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1477490707, "post_id": 40263529, "comment_id": 67789303, "body": "Note also that demanding quick responses (&quot;i want solution in short time&quot;) is rarely well received on SO."}, {"owner": {"reputation": 11, "user_id": 7044128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f87c48153c7826ffd2825cbe8a35b81?s=128&d=identicon&r=PG&f=1", "display_name": "FURQAN ", "link": "https://stackoverflow.com/users/7044128/furqan"}, "edited": false, "score": 0, "creation_date": 1477503215, "post_id": 40263529, "comment_id": 67797427, "body": "no solution yet .Please help me out this is not my kernel i installed it from the internet so basically the problem is when i compiled it by getting in the directory and linux-headers-3.12.9-031209 i got a error same as above when i use &quot;sudo make&quot;"}, {"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1477545880, "post_id": 40263529, "comment_id": 67812243, "body": "Try asking at <a href=\"http://unix.stackexchange.com/\">unix.stackexchange.com</a>"}], "owner": {"reputation": 11, "user_id": 7044128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f87c48153c7826ffd2825cbe8a35b81?s=128&d=identicon&r=PG&f=1", "display_name": "FURQAN ", "link": "https://stackoverflow.com/users/7044128/furqan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1621, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477488728, "creation_date": 1477488259, "last_edit_date": 1477488728, "question_id": 40263529, "link": "https://stackoverflow.com/questions/40263529/linux-compilation-error-by-using-make", "title": "linux compilation error by using make", "body": "<p>i got the error when i try to 'make' the linux kernel 3.12.9   </p>\n\n<p>HOSTCC  scripts/basic/fixdep\nscripts/basic/fixdep.c:462:1: fatal error: opening dependency file scripts/basic/.fixdep.d: Permission denied</p>\n\n<p>}\n ^\ncompilation terminated.\nmake[2]: <strong>* [scripts/basic/fixdep] Error 1\nmake[1]: <em></strong> [scripts_basic] Error 2\nmkdir: cannot create directory \u2018arch/x86/syscalls/../include/generated\u2019: Permission denied\nmkdir: cannot create directory \u2018arch/x86/syscalls/../include/generated\u2019: Permission denied\nmake[1]: <strong></em> No rule to make target <code>arch/x86/syscalls/syscall_32.tbl', needed by</code>arch/x86/syscalls/../include/generated/asm/syscalls_32.h'.  Stop.\nmake: *</strong> [archheaders] Error 2</p>\n"}, {"tags": ["c", "arrays", "segmentation-fault", "structure"], "comments": [{"owner": {"reputation": 27, "user_id": 5705090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/923ac5ff87d0f8465bbb5388ee198121?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/5705090/emanuele"}, "edited": false, "score": 0, "creation_date": 1477488267, "post_id": 40263522, "comment_id": 67787376, "body": "You can find the whole program here <a href=\"http://collabedit.com/g4p4d\" rel=\"nofollow noreferrer\">collabedit.com/g4p4d</a>"}, {"owner": {"reputation": 86, "user_id": 6078437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c445d61a467a9198039c66cf2fbaaff1?s=128&d=identicon&r=PG&f=1", "display_name": "scarecrow-", "link": "https://stackoverflow.com/users/6078437/scarecrow"}, "edited": false, "score": 2, "creation_date": 1477488320, "post_id": 40263522, "comment_id": 67787430, "body": "you&#39;re obviously accessing an index that is out of bounds. Make sure all memory is properly allocated for each array."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 1, "creation_date": 1477488342, "post_id": 40263522, "comment_id": 67787445, "body": "Thanks for the link!  Would you please <a href=\"https://stackoverflow.com/posts/40263522/edit\">edit your question</a> to include the relevant pieces of the program?  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> for more about asking questions that will attract quality answers."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477488604, "post_id": 40263522, "comment_id": 67787653, "body": "What is the input ?"}, {"owner": {"reputation": 27, "user_id": 5705090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/923ac5ff87d0f8465bbb5388ee198121?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/5705090/emanuele"}, "edited": false, "score": 0, "creation_date": 1477488652, "post_id": 40263522, "comment_id": 67787688, "body": "It&#39;s an online game for programmer, the input is given by the website. Do rules allow me to say the name of the website?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5705090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/923ac5ff87d0f8465bbb5388ee198121?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/5705090/emanuele"}, "edited": false, "score": 0, "creation_date": 1477488728, "post_id": 40263622, "comment_id": 67787753, "body": "Thank you!!!! I didn&#39;t notice i&#39;ve put the for with j=0 in the comments. Stupid error, you probably saved me an afternoon."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 27, "user_id": 5705090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/923ac5ff87d0f8465bbb5388ee198121?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/5705090/emanuele"}, "edited": false, "score": 1, "creation_date": 1477488859, "post_id": 40263622, "comment_id": 67787860, "body": "@Emanuele learn how to use a debugger, that will save you lots of afternoons in the future."}], "tags": [], "owner": {"reputation": 672, "user_id": 3412998, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b901e64ec64a175169c2e3895d6070f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dragos", "link": "https://stackoverflow.com/users/3412998/dragos"}, "is_accepted": true, "score": 1, "last_activity_date": 1477488819, "last_edit_date": 1477488819, "creation_date": 1477488532, "answer_id": 40263622, "question_id": 40263522, "link": "https://stackoverflow.com/questions/40263522/segmentation-fault-in-c-comparing-integer-members-from-structure-to-array-in-mai/40263622#40263622", "title": "segmentation fault in C comparing integer members from structure to array in main", "body": "<p>You did not initialise j, thus <code>gates[j]</code> ends up with a segmentation fault.</p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1477488773, "creation_date": 1477488773, "answer_id": 40263710, "question_id": 40263522, "link": "https://stackoverflow.com/questions/40263522/segmentation-fault-in-c-comparing-integer-members-from-structure-to-array-in-mai/40263710#40263710", "title": "segmentation fault in C comparing integer members from structure to array in main", "body": "<p>You commented out this line:</p>\n\n<pre><code>//for(j=0; j &lt;E; j++){\n</code></pre>\n\n<p>and therefore <code>j</code> is not initialized, and therefore <code>gates[j]</code> yields in undefined behaviour, in your case a segfault.</p>\n"}], "owner": {"reputation": 27, "user_id": 5705090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/923ac5ff87d0f8465bbb5388ee198121?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/5705090/emanuele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 40263622, "answer_count": 2, "score": 0, "last_activity_date": 1477488819, "creation_date": 1477488221, "last_edit_date": 1477488611, "question_id": 40263522, "link": "https://stackoverflow.com/questions/40263522/segmentation-fault-in-c-comparing-integer-members-from-structure-to-array-in-mai", "title": "segmentation fault in C comparing integer members from structure to array in main", "body": "<p>I get segmentation fault in the line below.</p>\n\n<pre><code>if((rel[i].node1 == SI &amp;&amp; rel[i].node2 == gates[j]) || (rel[i].node2 == SI &amp;&amp; rel[i].node1 == gates[j])\n</code></pre>\n\n<p>Now, all the variables/members are integers and they are initialized.\nI don't really know what to do.\nI tryied to change indexes as well.</p>\n\n<p>I hope to get some help, thank you in advance.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/**\n * Auto-generated code below aims at helping you parse\n * the standard input according to the problem statement.\n **/\nstruct relationship {\n   int node1;\n   int node2;\n};\n\nint main()\n{\n\n    int N; // the total number of nodes in the level, including the gateways\n    int L; // the number of links\n    int E; // the number of exit gateways\n    scanf(\"%d%d%d\", &amp;N, &amp;L, &amp;E);\n\n    int gates[E];\n    struct relationship rel[L];\n\n    for (int i = 0; i &lt; L; i++) {\n        int N1; // N1 and N2 defines a link between these nodes\n        int N2;\n        scanf(\"%d%d\", &amp;N1, &amp;N2);\n        rel[i].node1 = N1;\n        rel[i].node2 = N2;\n    }\n\n    for (int i = 0; i &lt; E; i++) {\n        int EI; // the index of a gateway node\n        scanf(\"%d\", &amp;EI);\n        gates[i] = EI;\n    }\n\n    while (1) {\n        int SI; // The index of the node on which the Skynet agent is positioned this turn\n        scanf(\"%d\", &amp;SI);\n\n        int i, j;\n        for(i=0; i &lt; L; i++){\n\n            //for(j=0; j &lt;E; j++){\n\n                if((rel[i].node1 == SI &amp;&amp; rel[i].node2 == gates[j]) || (rel[i].node2 == SI &amp;&amp; rel[i].node1 == gates[j])) {\n                    printf(\"%d %d ood\\n\", rel[i].node1, rel[i].node2);\n                    rel[i].node1 = -1;\n                    rel[i].node2 = -1;\n\n                }\n           // }\n            /*if(SI == rel[i].node1 || SI ==rel[i].node2){\n                printf(\"%d %d %d \\n\", rel[i].node1, rel[i].node2, SI);\n               //printf(\"%d %d\\n\", rel[i].node1, rel[i].node2);\n               rel[i].node1 = -1;\n               rel[i].node2 = -1;\n               break;\n            }*/\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["objective-c", "c", "networking", "udp"], "answers": [{"tags": [], "owner": {"reputation": 6957, "user_id": 147805, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a7f61061e9e54a67cc5cea2c5b428459?s=128&d=identicon&r=PG", "display_name": "Codeguard", "link": "https://stackoverflow.com/users/147805/codeguard"}, "is_accepted": true, "score": 2, "last_activity_date": 1482699680, "last_edit_date": 1482699680, "creation_date": 1482698292, "answer_id": 41324345, "question_id": 40263390, "link": "https://stackoverflow.com/questions/40263390/udp-code-only-receiving-first-response-to-a-broadcast/41324345#41324345", "title": "UDP code only receiving first response to a broadcast", "body": "<p>I believe the culprit is in <code>while ((recvBytes = recvfrom</code> loop. I think it terminates with an error.</p>\n\n<p>One typical \"error\" for UDP broadcasts is <code>WSAECONNRESET</code>. I don't exactly know what that means, something about destination port was not reachable. Still, that's an error that routinely occurs in an UDP broadcast. Since this error is pretty much expected and it's related to one of the broadcast targets instead of your code, the solution would be to ignore this specific error and continue loop to the next <code>recvfrom</code> (you actually \"do\" this when you run code multiple times). Some OS allow to configure socket to ignore <code>WSAECONNRESET</code> automatically. For example, on Windows it would be <code>WSAIoctl(SIO_UDP_CONNRESET)</code></p>\n\n<p>If this doesn't help you, please provide more information about how your code runs: how many loop iterations, does it wait up to timeout, which exact error ends loop.</p>\n"}, {"tags": [], "owner": {"reputation": 2473, "user_id": 4490706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nmMcD.jpg?s=128&g=1", "display_name": "Ton Plooij", "link": "https://stackoverflow.com/users/4490706/ton-plooij"}, "is_accepted": false, "score": 2, "last_activity_date": 1483103987, "creation_date": 1483103987, "answer_id": 41396959, "question_id": 40263390, "link": "https://stackoverflow.com/questions/40263390/udp-code-only-receiving-first-response-to-a-broadcast/41396959#41396959", "title": "UDP code only receiving first response to a broadcast", "body": "<p>You should inspect errno after recvfrom returned -1. This will indicate if no data was available and the call returned due to a timeout (EAGAIN) or if some error happened (e.g. on the second call when you expect data from another server). Most likely your recvAddr and/or recvAddrLen data was changed after the first (successful) call and becomes invalid on the second invocation. You have to (re)initialise these variables upon each call.<br/><br/>\nNote that you initialise the recvAddr with an INADDR_ANY value, which will be overwritten with the server IP address after the first call. If recvfrom would use this address as an indication that it should only receive from this IP address it would explain the behaviour that you see. However, a standard recvfrom implementation does not use this address value.</p>\n"}], "owner": {"reputation": 16043, "user_id": 127853, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ppot0.png?s=128&g=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/127853/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 41324345, "answer_count": 2, "score": 1, "last_activity_date": 1483103987, "creation_date": 1477487876, "question_id": 40263390, "link": "https://stackoverflow.com/questions/40263390/udp-code-only-receiving-first-response-to-a-broadcast", "title": "UDP code only receiving first response to a broadcast", "body": "<p>I'm attempting to communicate with multiple <a href=\"https://technet.microsoft.com/en-us/library/ms181087(v=sql.105).aspx\" rel=\"nofollow\">SQL Server Browser</a> services using the following c + objective-c code.</p>\n\n<pre><code>+ (void) doBrowseForServers\n{\n    // http://mbielanczuk.com/2013/07/browsing-network-for-sql-server-instances-in-c/\n    // used as a reference.\n    SOCKET sock;\n    int broadcast = 1;\n\n    struct timeval timeout;\n    timeout.tv_sec  = 5; // 10 second timeout\n    timeout.tv_usec = 0;\n\n    if ((sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1)\n    {\n        NSLog(@\"MSSQLBrowserServiceClient failed to initialize socket.\");\n        return;\n    }\n\n    // Setting socket broadcast option.\n    if (setsockopt(sock, SOL_SOCKET, SO_BROADCAST, (char *)&amp;broadcast, sizeof(broadcast)) == -1)\n    {\n        NSLog(@\"MSSQLBrowserServiceClient failed to set broadcast option.\");\n        return;\n    }\n\n    // Set a timeout so that we do not wait forever.\n    if (setsockopt(sock, SOL_SOCKET, SO_SNDTIMEO, (char *)&amp;timeout, sizeof(timeout)) == -1)\n    {\n        NSLog(@\"MSSQLBrowserServiceClient failed to set send timeout.\", errno);\n        return;\n    }\n\n    // Set a timeout so that we do not wait forever.\n    if (setsockopt(sock, SOL_SOCKET, SO_RCVTIMEO, (char *)&amp;timeout, sizeof(timeout)) == -1)\n    {\n        NSLog(@\"MSSQLBrowserServiceClient failed to set receive timeout.\", errno);\n        return;\n    }\n\n    if(sendBroadcast(sock, MSSQL_BROWSER_SERVICE_PORT))\n    {\n        NSString * response = [self reciveBroadcastRespondFromSocket: sock\n                                                           usingPort: MSSQL_BROWSER_SERVICE_PORT];\n\n        NSDate * lastSeen = [NSDate date];\n\n        if(0 != response.length)\n        {\n           // Processing code omitted to focus on send/receive\n        } // End of we had responses\n    }\n    else\n    {\n        NSLog(@\"MSSQLBrowserServiceClient failed to browse for servers.\");\n    }\n} // End of beginBrowseForServers\n\nbool sendBroadcast(SOCKET sock, int port)\n{\n    struct sockaddr_in bcastAddr;\n    memset(&amp;bcastAddr, 0, sizeof(bcastAddr));\n    bcastAddr.sin_family = AF_INET;\n    bcastAddr.sin_addr.s_addr = htonl(INADDR_BROADCAST);\n    bcastAddr.sin_port = htons(port);\n    char query = 0x02;\n    if (sendto(sock, &amp;query, sizeof(query), 0, (struct sockaddr *)&amp;bcastAddr, sizeof(bcastAddr)) == -1)\n    {\n        return 0;\n    }\n\n    return 1;\n}\n\n+ (NSString*) reciveBroadcastRespondFromSocket: (SOCKET) sock\n                                     usingPort: (int) port\n{\n    ssize_t recvBytes = 0;\n    char buf[512] = {0x00};\n    memset(buf,'\\0', 512);\n\n    NSMutableData * mutableData = [NSMutableData data];\n\n    struct sockaddr_in recvAddr;\n    memset(&amp;recvAddr, 0, sizeof(recvAddr));\n    recvAddr.sin_family = AF_INET;\n    recvAddr.sin_addr.s_addr = htonl(INADDR_ANY);\n    recvAddr.sin_port = htons(port);\n    socklen_t recvAddrLen = sizeof(recvAddr);\n\n    while ((recvBytes = recvfrom(sock, buf, sizeof(buf)-1, 0, (struct sockaddr*)&amp;recvAddr, &amp;recvAddrLen)) != -1)\n    {\n        [mutableData appendBytes: buf\n                          length: recvBytes];\n    }\n\n    if(mutableData.length &lt;= 3)\n    {\n        return nil;\n    }\n\n    char * bytes = (char*)[mutableData bytes];\n\n    // Process code removed to focus on networking bits.\n    // ....\n\n    return @\"\";\n}\n</code></pre>\n\n<p>The problem is that I seem to only handle one server response at a time. If I run this code multiple times, I can end up receiving the results from different servers each time (one server per broadcast), but my understanding is that I should be receiving udp datagrams from all servers via a single broadcast. I've tried increasing my timeout but I still only receive results from one server per broadcast.</p>\n\n<p>Can anyone point out what I'm doing wrong?</p>\n"}, {"tags": ["c", "arrays", "file", "io"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1477487202, "post_id": 40263121, "comment_id": 67786555, "body": "where&#39;s the code?"}, {"owner": {"reputation": 1453, "user_id": 3195614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qw0hw.jpg?s=128&g=1", "display_name": "Zach P", "link": "https://stackoverflow.com/users/3195614/zach-p"}, "edited": false, "score": 1, "creation_date": 1477487239, "post_id": 40263121, "comment_id": 67786574, "body": "What parts of the task are you having trouble with? File I/O? Dynamic memory allocation? We are not here to just do your homework"}, {"owner": {"reputation": 1424, "user_id": 6635287, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/rbH3f.png?s=128&g=1", "display_name": "Radinator", "link": "https://stackoverflow.com/users/6635287/radinator"}, "reply_to_user": {"reputation": 1453, "user_id": 3195614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qw0hw.jpg?s=128&g=1", "display_name": "Zach P", "link": "https://stackoverflow.com/users/3195614/zach-p"}, "edited": false, "score": 0, "creation_date": 1477487361, "post_id": 40263121, "comment_id": 67786656, "body": "@ZachP: please read first: he needs help &quot;<b>to extract the numbers, put them in a array and [...] calculate them to output them in output.txt</b>&quot;"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 1, "creation_date": 1477487484, "post_id": 40263121, "comment_id": 67786744, "body": "Code please, and we will help."}, {"owner": {"reputation": 90, "user_id": 7064158, "user_type": "registered", "profile_image": "https://graph.facebook.com/1147406285352942/picture?type=large", "display_name": "Emmanuel Ban", "link": "https://stackoverflow.com/users/7064158/emmanuel-ban"}, "reply_to_user": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1477487692, "post_id": 40263121, "comment_id": 67786920, "body": "@RoadRunner  <a href=\"http://codepad.org/M5oMbLDh\" rel=\"nofollow noreferrer\">codepad.org/M5oMbLDh</a> This is the code"}, {"owner": {"reputation": 1453, "user_id": 3195614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qw0hw.jpg?s=128&g=1", "display_name": "Zach P", "link": "https://stackoverflow.com/users/3195614/zach-p"}, "reply_to_user": {"reputation": 1424, "user_id": 6635287, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/rbH3f.png?s=128&g=1", "display_name": "Radinator", "link": "https://stackoverflow.com/users/6635287/radinator"}, "edited": false, "score": 0, "creation_date": 1477487737, "post_id": 40263121, "comment_id": 67786947, "body": "@Radinator I read everything, how does what you quoted disregard my criticism? Extracting the numbers is simple file I/O, putting them in an array just concludes of dynamic memory allocation, calculation is simple and he says he already has that implemented and outputting them to a file is still just file I/O..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1477488330, "post_id": 40263121, "comment_id": 67787436, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon.  We&#39;ll help you fix your code; we won&#39;t write your program for you.  I&#39;m worried about your &quot;max 10^8 digits&quot;; did you mean the maximum value will be <code>1E8</code> or 10^8, so it fits easily in a 32-bit <code>int</code>?  Or did you really mean 100 million decimal digits (which is what you seem to say), in which case, you&#39;re into dealing with &#39;big numbers&#39;.  I assume it is actually the simpler &quot;it fits in a 32-bit <code>int</code>&quot; scenario."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477488959, "post_id": 40263121, "comment_id": 67787948, "body": "@EmmanuelBan first of all I&#39;d fix the warnings."}, {"owner": {"reputation": 90, "user_id": 7064158, "user_type": "registered", "profile_image": "https://graph.facebook.com/1147406285352942/picture?type=large", "display_name": "Emmanuel Ban", "link": "https://stackoverflow.com/users/7064158/emmanuel-ban"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1477489037, "post_id": 40263121, "comment_id": 67788021, "body": "@JonathanLeffler, yes, the result can have maximum 100 million digits, that&#39;s why I worked with array. I&#39;m in first year of university and started with C, something I never studied. The program works!!! The problem is I don&#39;t know how to read caracters from input.txt, put them in array and after calculating a^n with the program putting the results in output.txt."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477490282, "post_id": 40263121, "comment_id": 67788995, "body": "<a href=\"https://www.google.com/search?q=read+numbers+from+a+text+file+in+C\" rel=\"nofollow noreferrer\">google.com/search?q=read+numbers+from+a+text+file+in+C</a>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1477490408, "post_id": 40263121, "comment_id": 67789073, "body": "Just one of zillions of duplicates: <a href=\"http://stackoverflow.com/q/20378430/694576\">stackoverflow.com/q/20378430/694576</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1057, "user_id": 4153464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/D55Mz.jpg?s=128&g=1", "display_name": "Work of Artiz", "link": "https://stackoverflow.com/users/4153464/work-of-artiz"}, "is_accepted": false, "score": 0, "last_activity_date": 1477489135, "creation_date": 1477489135, "answer_id": 40263843, "question_id": 40263121, "link": "https://stackoverflow.com/questions/40263121/how-can-i-extract-information-from-an-input-file-and-put-them-in-an-array-in-c/40263843#40263843", "title": "How can I extract information from an input file and put them in an array in C?", "body": "<p>Look into <a href=\"http://www.cplusplus.com/reference/cstdio/fscanf/\" rel=\"nofollow\">fscanf</a> for reading a certain format from a file, and <a href=\"http://www.cplusplus.com/reference/cstdio/fprintf/?kw=fprintf\" rel=\"nofollow\">fprintf</a> for writing a certain format to a file.</p>\n\n<p>An example given some initialised <code>FILE *read_file</code> and <code>FILE *write_file</code> could be </p>\n\n<pre><code>int count, int a, n;\nfscanf(read_file, \"%d \", &amp;count);\n\nfor (i = 0; i &lt; count; i++) {\n    fscanf(read_file, \"%d %d \", &amp;a, &amp;n);\n    ... \n    /* calculate the output result */\n    ...\n    fprintf(write_file, \"%d\\n\", result);\n}\n</code></pre>\n"}], "owner": {"reputation": 90, "user_id": 7064158, "user_type": "registered", "profile_image": "https://graph.facebook.com/1147406285352942/picture?type=large", "display_name": "Emmanuel Ban", "link": "https://stackoverflow.com/users/7064158/emmanuel-ban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "closed_date": 1477502447, "answer_count": 1, "score": -2, "last_activity_date": 1477502399, "creation_date": 1477487153, "last_edit_date": 1477502399, "question_id": 40263121, "link": "https://stackoverflow.com/questions/40263121/how-can-i-extract-information-from-an-input-file-and-put-them-in-an-array-in-c", "closed_reason": "Duplicate", "title": "How can I extract information from an input file and put them in an array in C?", "body": "<p>I have an input.txt file:</p>\n\n<ul>\n<li>First line: <code>m</code> and on the following <code>m</code> lines I have pairs of 2 numbers <code>a</code> and <code>n</code></li>\n</ul>\n\n<p>I have to calculate a^n and the result can have max 10^8 digits. I made the program using arrays and giving values to <code>a</code> and <code>n</code>. It returned the correct answer. But what I have to do is to read the information from the file, calculate a^n and write the numbers in an output.txt file.</p>\n\n<p>Example:</p>\n\n<p>In input.txt I have on the first line</p>\n\n<pre><code>2\n2 10\n1 100000\n</code></pre>\n\n<p>output.txt</p>\n\n<pre><code>1024\n1\n</code></pre>\n\n<p>As I said, the program works with any numbers wrote by me in the main program. Now I need help to extract the numbers from input.txt, put them in array and after I calculate them to return them in output.txt.</p>\n\n<hr>\n\n<h3>Non-compiling code copied from codepad.org</h3>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nconst int MAX_NR_DIGITS = 10000;\n\nvoid longNumClone(char *from, char *to)\n{\n    int i;\n    for (i = 0; i &lt; MAX_NR_DIGITS; i++)\n        to[i] = from[i];\n}\n\nvoid longNumPrint(char *num, int sizeNum) {\n    int i;\n    for (i = sizeNum-1; i &gt;= 0; i--) {\n        printf(\"%i\", num[i]);\n    }\n}\n\nint longNumDiv2(char *rez, char *num, int sizeNum) {\n    int i;\n    num[sizeNum] = 0;\n    rez[sizeNum] = 0;\n\n    for (i = sizeNum - 1; i &gt;= 0; i--) {\n        rez[i] = ((num[i+1] - rez[i+1]*2) * 10 + num[i]) / 2;\n    }\n\n    if (rez[sizeNum - 1] == 0) {\n        return sizeNum - 1;\n    }\n    return sizeNum;\n}\n\nint multiply(char *rez, char *a, int sizeA, char *b, int sizeB) {\n    int sizeRez = 0, i;\n    for (i = 0; i &lt; MAX_NR_DIGITS; i++) {\n        rez[i] = 0;\n    }\n\n    int temp = 0, j;\n    for (i = 0; i &lt; sizeB; i++) {\n        for (j = 0; j &lt; sizeA; j++) {\n            temp = b[i] * a[j];\n\n            int inc = 0;\n            do {\n                temp = temp + rez[i + j + inc];\n                rez[i + j + inc] = temp % 10;\n                if (i + j + inc + 1 &gt; sizeRez) {\n                    sizeRez = i + j + inc + 1;\n                }\n                temp = temp / 10;\n                inc++;\n            }while (temp != 0);\n        }\n    }\n\n    return sizeRez;\n}\n\nint superpow(char *rez, char *base, int sizeBase, char *exp, int sizeExp) {\n    int i;\n    char temp[MAX_NR_DIGITS];\n    char temp1[MAX_NR_DIGITS];\n    char temp2[MAX_NR_DIGITS];\n\n    for (i = 0; i &lt; MAX_NR_DIGITS; i++) {\n        rez[i] = 0;\n    }\n\n    int sizeRez = 1;\n    rez[0] = 1;\n\n    while (sizeExp &gt; 0) {\n        if (exp[0] &amp; 1) {\n            longNumClone(rez, temp);\n            sizeRez = multiply(rez, temp, sizeRez, base, sizeBase);\n        }\n\n        longNumClone(exp, temp);\n        sizeExp = longNumDiv2(exp, temp, sizeExp);\n\n        longNumClone(base, temp1);\n        longNumClone(base, temp2);\n        sizeBase = multiply(base, temp1, sizeBase, temp2, sizeBase);\n\n          }\n\n    return sizeRez;\n}\n\nint main() {\n\n    // 4437053125^625\n    char a[MAX_NR_DIGITS] = {5, 2, 1, 3, 5, 0, 7, 3, 4, 4};\n    int sizeA = 10;\n    char n[MAX_NR_DIGITS] = {5, 2, 6};\n    int sizeN = 3;\n\n      char rez[MAX_NR_DIGITS];\n    int sizeRez = 0;\n\n\n    sizeRez = superpow(rez, a, sizeA, n, sizeN);\n    longNumPrint(rez, sizeRez);\n\n    return 0;\n}\n</code></pre>\n\n<p>The arrays in <code>main()</code> are deemed variable-length arrays (VLAs) because <code>MAX_NR_DIGITS</code> is not deemed to be an integer constant expression, and you can't initialize VLAs.  It would be OK in C++, but not in C.</p>\n"}, {"tags": ["c++", "c", "lua"], "comments": [{"owner": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "edited": false, "score": 2, "creation_date": 1477486834, "post_id": 40262966, "comment_id": 67786304, "body": "<code>liblua5.1.so.o</code> I am pretty sure that should be a 0 (zero) at the end and not o"}, {"owner": {"reputation": 9, "user_id": 6952841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb91db3f7694ca011be5cd3c34e7ec10?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Wong", "link": "https://stackoverflow.com/users/6952841/jacob-wong"}, "reply_to_user": {"reputation": 4718, "user_id": 152359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462dee3e00416ea83771eead7902e1c?s=128&d=identicon&r=PG", "display_name": "Hayt", "link": "https://stackoverflow.com/users/152359/hayt"}, "edited": false, "score": 0, "creation_date": 1477487303, "post_id": 40262966, "comment_id": 67786623, "body": "@Hayt thanks for remind. I hava edited again"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1477489233, "post_id": 40262966, "comment_id": 67788186, "body": "As you have discovered, you need the files in <code>lua-dev</code> to compile programs that link with liblua.  Why don&#39;t you want to install it?"}, {"owner": {"reputation": 9, "user_id": 6952841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb91db3f7694ca011be5cd3c34e7ec10?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Wong", "link": "https://stackoverflow.com/users/6952841/jacob-wong"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1477489550, "post_id": 40262966, "comment_id": 67788429, "body": "@zwol because i hava no permission to install <code>lua-dev</code> on the target machine, so i am finding a more portable way"}, {"owner": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 2, "creation_date": 1477490444, "post_id": 40262966, "comment_id": 67789101, "body": "@JacobWong: You cannot use Lua without <i>using Lua</i>."}, {"owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "edited": false, "score": 3, "creation_date": 1477501706, "post_id": 40262966, "comment_id": 67796646, "body": "Just download the source from lua.org and build Lua yourself. Fastest and simplest."}], "owner": {"reputation": 9, "user_id": 6952841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb91db3f7694ca011be5cd3c34e7ec10?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Wong", "link": "https://stackoverflow.com/users/6952841/jacob-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477489751, "creation_date": 1477486696, "last_edit_date": 1477489751, "question_id": 40262966, "link": "https://stackoverflow.com/questions/40262966/how-can-i-build-c-program-which-acts-as-a-wrapper-of-lua-language-in-a-machine", "title": "How can I build c++ program which acts as a wrapper of lua language in a machine without installing lua-dev?", "body": "<p>When I build c++ programe which acts as a wrapper of lua language in a machine without installing lua-dev, it prints error message like this:</p>\n\n<pre><code>/usr/bin/ld: warning: liblua5.1.so.0, needed by ../build/lib/liblua_print.so, not found (try using -rpath or -rpath-link)\n../build/lib/liblua_print.so: undefined reference to `luaL_newstate'\n../build/lib/liblua_print.so: undefined reference to `luaL_openlibs'\n../build/lib/liblua_print.so: undefined reference to `lua_pcall'\n../build/lib/liblua_print.so: undefined reference to `luaL_loadfile'\n../build/lib/liblua_print.so: undefined reference to `lua_close'\ncollect2: ld returned 1 exit status\n</code></pre>\n\n<p>My build process like this (error emerges at the last line):</p>\n\n<pre><code>g++ -fPIC -shared -I../include/ -c ./lua_print.cpp -o ../build/object/lua_print.o                                                                                  \ng++ -fPIC -shared -o ../build/lib/liblua_print.so ../build/object/lua_print.o -L../lib/ -llua5.1\ng++ -fPIC -shared -I. -c ./main.cpp -o ../build/object/main.o\ng++ -o ../build/bin/crnn_demo ../build/object/main.o ../build/lib/liblua_print.so\n</code></pre>\n\n<p>And my program organized as this :</p>\n\n<pre><code>demo\n  lib\n    liblua5.1.so (link to liblua5.1.so.0)\n    liblua5.1.so.0 (link to liblua5.1.so.0.0.0)\n    liblua5.1.so.0.0.0 (copy from another machine that installs lua-dev)\n  src\n    main.cpp\n    lua_print.c\n    lua_print.cpp\n  include\n    lua.hpp (copy from another machine)\n    ..(other lua's header file copied from another machine)\n  build (result dir)\n    object (store main.o, lua_print.o)\n    lib (store liblua_print.so)\n    bin (store final result)   \n</code></pre>\n"}, {"tags": ["c", "arrays", "return-value", "roman-numerals"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1477487293, "post_id": 40262827, "comment_id": 67786619, "body": "I&#39;d like to suggest that there are better ways to organize the conversion than to generate 4 letters and then remap those letters.  However, what you&#39;re seeking to do should be doable, even if not very convenient.  Note that VIIII should be mapped to IX, but IIII should be mapped to IV.  That is, finding the quad isn&#39;t sufficient; you also have to examine the letter before it (if there is one; XXIIII needs to map to XIV; XXXXIIII needs to map to XLIV, etc)."}, {"owner": {"reputation": 1453, "user_id": 3195614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qw0hw.jpg?s=128&g=1", "display_name": "Zach P", "link": "https://stackoverflow.com/users/3195614/zach-p"}, "edited": false, "score": 2, "creation_date": 1477487626, "post_id": 40262827, "comment_id": 67786861, "body": "The check function definitely works, there is probably a problem with the arguments you&#39;re passing (notice uppercase vs lowercase). Also, you could already implement that functionality in the conversion function"}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1477488654, "post_id": 40262827, "comment_id": 67787690, "body": "@JonathanLeffler I do agree there must be an easier way and my way is very inefficient if you take into account what you said about the previous letters. The one thing I find really difficult is that once the quadruple letters have been identified, how would I change them in the array? I&#39;m not very fluent with arrays or pointers, so this is where I had to come onto SO and ask about it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1477489161, "post_id": 40262827, "comment_id": 67788125, "body": "I use a data structure which contains a number and a string. For example, the first two entries are <code>1000, &quot;M&quot;</code> and <code>900, &quot;CM&quot;</code>.  I use this to guide the formatting.  Scanning \u2014 converting from roman to decimal \u2014 needs more information but uses the same core data."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477490172, "post_id": 40262827, "comment_id": 67788914, "body": "I think I know what you mean about substituting letters. I wrote a second version of the program that uses a similar concept, it&#39;s not as efficient as this, but it kind of works. If you want to see it, let me know and I&#39;ll post it in the question."}], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477488492, "post_id": 40263344, "comment_id": 67787564, "body": "Is it to do with the arguments, as Zach P said? It&#39;s kind of confusing, since I&#39;m not a seasoned programmer, so to speak. Also, what does <code>enum</code> mean? I&#39;ve seen it before but I don&#39;t quite know what it is?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477488557, "post_id": 40263344, "comment_id": 67787618, "body": "Probably, but since we can&#39;t see your non-working calls to the function, it is hard to know.  However, the problem is not in the function \u2014 that means it is probably in the code that calls the function."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477488668, "post_id": 40263344, "comment_id": 67787705, "body": "I&#39;ll also observe that the interface to <code>check()</code> isn&#39;t particularly useful.  You need to know where the sequence starts so that you can map it accurately.  You should never see repeats of V, L, D (the &#39;fives&#39;)."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477489494, "post_id": 40263344, "comment_id": 67788383, "body": "Update: the <code>check()</code> function does actually work, I tried it out in the terminal. It doesn&#39;t work in Xcode though, so I&#39;ll just have to carry on manually compiling it from now on. But ok, that makes sense, the function works, so now it&#39;s just the issue of sorting out the array wherever there are quadruples."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477489638, "post_id": 40263344, "comment_id": 67788507, "body": "Not working in XCode but working from the command line makes very little sense."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477490040, "post_id": 40263344, "comment_id": 67788797, "body": "How do you mean? I personally prefer the command line; I find it more rewarding to learn how to compile programs as opposed to using an IDE and not being able to figure out why it won&#39;t compile for you. I generally use a text editor like Sublime Text, but nevertheless, I want to be able to learn how to use Xcode for future development."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477497193, "post_id": 40263344, "comment_id": 67793967, "body": "What I meant was &#39;the program&#39; or &#39;the check function&#39; not working when run via XCode but working when run at the command line is not the (mis)behaviour I&#39;d expect. I use the command line mainly for development too.  Even on the Mac where I mainly work."}, {"owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "edited": false, "score": 0, "creation_date": 1477504345, "post_id": 40263344, "comment_id": 67798090, "body": "Oh ok, sorry, I interpreted that wrongly. I thought you meant there&#39;s no point using the command line when you have a full IDE. Could it perhaps be because of the LLVM compiler that Xcode uses? I&#39;ve read that it&#39;s used as a hybrid with GCC (which is what I&#39;m used to), but there may be slight differences. This isn&#39;t really my area of expertise :)"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1477681145, "last_edit_date": 1477681145, "creation_date": 1477487754, "answer_id": 40263344, "question_id": 40262827, "link": "https://stackoverflow.com/questions/40262827/how-to-change-4-repeated-digits-in-roman-numerals-converter/40263344#40263344", "title": "How to change 4 repeated digits in roman numerals converter?", "body": "<p>Used correctly, your <code>check()</code> function works correctly.  Here's a minimal <code>main()</code> function that tests it:</p>\n\n<pre><code>int main(void)\n{\n    char *str[] = { \"IIII\", \"XIIII\", \"XIII\", \"IIIXIIII\", \"IIIXIII\" };\n    enum { NUM_STR = sizeof(str)/sizeof(str[0]) };\n\n    for (int i = 0; i &lt; NUM_STR; i++)\n        printf(\"%s: %d\\n\", str[i], check(str[i], 'I'));\n\n    return 0;\n}\n</code></pre>\n\n<p>Output;</p>\n\n<pre><code>IIII: 1\nXIIII: 1\nXIII: 0\nIIIXIIII: 1\nIIIXIII: 0\n</code></pre>\n\n<p>So, the problem you've got isn't with the <code>check()</code> function per se.</p>\n\n<hr>\n\n<p>Here's an alternative way of formatting Roman numerals.  It uses a table to determine what's acceptable (and limits the range of numbers to 1 .. 3999).  In my main library, the structure has two extra fields to help with parsing and validating Roman numeral strings, converting them to an <code>int</code>.</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n\n/* Header \"roman.h\" */\nextern int fmt_roman(int i, char *buffer, size_t buflen);\n/* End \"roman.h\" */\n\ntypedef struct Roman\n{\n    int           value;\n    const char    chars[3];\n} Roman;\n\nenum { MAX_PERMITTED_ROMAN = 4000 };\n\nstatic const Roman numerals[] =\n{\n    {   1000,   \"M\",    },\n    {    900,   \"CM\",   },\n    {    500,   \"D\",    },\n    {    400,   \"CD\",   },\n    {    100,   \"C\",    },\n    {     90,   \"XC\",   },\n    {     50,   \"L\",    },\n    {     40,   \"XL\",   },\n    {     10,   \"X\",    },\n    {      9,   \"IX\",   },\n    {      5,   \"V\",    },\n    {      4,   \"IV\",   },\n    {      1,   \"I\",    },\n};\nenum { NUM_NUMERALS = sizeof(numerals) / sizeof(numerals[0]) };\n\nint fmt_roman(int i, char *buffer, size_t buflen)\n{\n    int rc = -1;\n\n    if (i &lt;= 0 || i &gt; MAX_PERMITTED_ROMAN)\n        errno = EDOM;\n    else if (buflen &lt;= 1)\n        errno = ENOSPC;\n    else\n    {\n        char *end = buffer + buflen;\n        char *dst = buffer;\n        const Roman *e = numerals + NUM_NUMERALS;\n\n        for (const Roman *r = numerals; i &gt; 0 &amp;&amp; r &lt; e; r++)\n        {\n            while (i &gt;= r-&gt;value)\n            {\n                const char *src = r-&gt;chars;\n                char c;\n                while ((c = *src++) != '\\0' &amp;&amp; dst &lt; end)\n                    *dst++ = c;\n                if (dst &gt;= end)\n                    break;\n                i -= r-&gt;value;\n            }\n        }\n        if (dst &lt; end)\n        {\n            *dst = '\\0';\n            rc = 0;\n        }\n        else\n            errno = ENOSPC;\n    }\n    return(rc);\n}\n</code></pre>\n\n<p>As usual, quite a lot of the code is associated with error handling.</p>\n"}], "owner": {"reputation": 364, "user_id": 6678549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/827f51c9a7535cba8fb8f7da39c7469b?s=128&d=identicon&r=PG&f=1", "display_name": "AkThao", "link": "https://stackoverflow.com/users/6678549/akthao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477681145, "creation_date": 1477486359, "question_id": 40262827, "link": "https://stackoverflow.com/questions/40262827/how-to-change-4-repeated-digits-in-roman-numerals-converter", "title": "How to change 4 repeated digits in roman numerals converter?", "body": "<p>I am writing a program that converts an integer from 0 to 3999 into its roman numerals equivalent.</p>\n\n<p>Currently, my main function, which actually does the converting, works fine. It takes in a number, uses the roman numeral variables to make up the roman numeral array until the integer the user entered becomes 0:</p>\n\n<pre><code>int main(int argc, const char * argv[])\n{\n    int num;\n    char roman[10];\n    int I = 1, V = 5, X = 10, L = 50, C = 100, D = 500, M = 1000;\n\n    printf(\"Please input a number from 1 to 3999:\\n\");\n    scanf(\"%d\", &amp;num);\n\n    do {\n        for (int j = 0; j &lt; 10; j++) {\n            if (num &gt;= M) {\n                num -= M;\n                roman[j] = 'M';\n            }\n            else if (num &gt;= D) {\n                num -= D;\n                roman[j] = 'D';\n            }\n            else if (num &gt;= C) {\n                num -= C;\n                roman[j] = 'C';\n            }\n            else if (num &gt;= L) {\n                num -= L;\n                roman[j] = 'L';\n            }\n            else if (num &gt;= X) {\n                num -= X;\n                roman[j] = 'X';\n            }\n            else if (num &gt;= V) {\n                num -= V;\n                roman[j] = 'V';\n            }\n            else if (num &gt;= I) {\n                num -= I;\n                roman[j] = 'I';\n            }\n        }\n    } while (num != 0);\n\n    // check(roman, 'X');\n\n        printf(\"\\nYour number in roman numerals is %s\\n\", roman);\n}\n</code></pre>\n\n<p>On the commented line is a separate function (called <code>check()</code>) that I wrote. This new function should ideally check for any letter that is repeated 4 times, and return true if there is such a case or false if not. It looks like this:</p>\n\n<pre><code>int check(char * numeralArray, char numeral)\n{\n    int counter = 0;\n    int size = strlen(numeralArray);\n\n    for (int i = 0; i &lt; size; i++) {\n        if(numeralArray[i] == numeral)     // check for each iteration if numeral is in numeralArray[i]\n            counter++;     // if it is then counter increases by 1\n        else\n            counter = 0;    // this resets the value to 0 if its not consecutive.\n\n        if(counter == 4)    // this stops the loop when 4 consecutive letters have been found.\n            break;\n    }\n\n    if(counter &gt;= 4)    // if counter is 4, it means 4 consecutive letters have been found\n        return 1;   // true\n    else\n        return 0;   // false\n}\n</code></pre>\n\n<p>So the idea is that I would use the function and pass <code>roman</code> and <code>I</code> as arguments to <code>check()</code>, for example. It would then check if <code>I</code> comes up 4 times consecutively. If it does, the function returns true (represented by 1). In my main function, if the value returned from <code>check()</code> is 1 (true), then I would want to change these four consecutive values (e.g. <code>IIII</code>) into the appropriate value (e.g. <code>IV</code>).</p>\n\n<p>The problem is, it does not work as it should, the <code>check()</code> function always returns 0 (false), even when I type in a number like 14, where instead of <code>XIIII</code>, it should be <code>XIV</code>. So I don't know how to get my function to return true in this case and then what would I have to do in order to make the desired change to the array? Also, in my main function, do I necessarily need a for loop inside the do-while loop? Or can I get rid of the for loop and just increment through the array each time the do-while loop runs (like this <code>j++</code>)? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 322, "user_id": 5804755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CkQXP.png?s=128&g=1", "display_name": "Theo Pnv", "link": "https://stackoverflow.com/users/5804755/theo-pnv"}, "edited": false, "score": 1, "creation_date": 1477486324, "post_id": 40262746, "comment_id": 67785933, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/39677935/how-to-switch-2nd-and-4th-digitbefore-comma-in-a-double-c-programming\">How to switch 2nd and 4th digit(before comma) in a double? C programming</a>"}, {"owner": {"reputation": 64, "user_id": 7060348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7adcc51f57b3496e583beda28b914c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sullivan", "link": "https://stackoverflow.com/users/7060348/sullivan"}, "reply_to_user": {"reputation": 322, "user_id": 5804755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CkQXP.png?s=128&g=1", "display_name": "Theo Pnv", "link": "https://stackoverflow.com/users/5804755/theo-pnv"}, "edited": false, "score": 0, "creation_date": 1477486480, "post_id": 40262746, "comment_id": 67786055, "body": "@TheoPnv How about you read what I wrote?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477486530, "post_id": 40262746, "comment_id": 67786095, "body": "Welcome to Stack Overflow! Please show your research/debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 64, "user_id": 7060348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7adcc51f57b3496e583beda28b914c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sullivan", "link": "https://stackoverflow.com/users/7060348/sullivan"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477487115, "post_id": 40262746, "comment_id": 67786502, "body": "@SouravGhosh Added my code:)"}, {"owner": {"reputation": 3315, "user_id": 1008563, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3ec34c4cd3354863a551d2f7539e3204?s=128&d=identicon&r=PG", "display_name": "samiles", "link": "https://stackoverflow.com/users/1008563/samiles"}, "edited": false, "score": 1, "creation_date": 1477489352, "post_id": 40262746, "comment_id": 67788274, "body": "@Sullivan It&#39;s normal to tag questions as duplicates, even if you mentioned it. Try not to have harsh words for people doing the moderation :)"}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 7060348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7adcc51f57b3496e583beda28b914c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sullivan", "link": "https://stackoverflow.com/users/7060348/sullivan"}, "edited": false, "score": 0, "creation_date": 1477489731, "post_id": 40263603, "comment_id": 67788561, "body": "Thanks for answering, what happens exactly in the if statement?"}, {"owner": {"reputation": 6743, "user_id": 6919895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qqkN_JOgCvM/AAAAAAAAAAI/AAAAAAAAABE/m4r_i_2yiy8/photo.jpg?sz=128", "display_name": "Treycos", "link": "https://stackoverflow.com/users/6919895/treycos"}, "reply_to_user": {"reputation": 64, "user_id": 7060348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7adcc51f57b3496e583beda28b914c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sullivan", "link": "https://stackoverflow.com/users/7060348/sullivan"}, "edited": false, "score": 0, "creation_date": 1477489882, "post_id": 40263603, "comment_id": 67788681, "body": "Which one ? The firs one checks if it finds the dot somewhere, the second one checks if the dot is located far enough to get the <code>dot -4</code> character, otherwise you would get an exception when checking <code>str[dot - 4]</code>"}, {"owner": {"reputation": 64, "user_id": 7060348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7adcc51f57b3496e583beda28b914c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sullivan", "link": "https://stackoverflow.com/users/7060348/sullivan"}, "edited": false, "score": 0, "creation_date": 1477490076, "post_id": 40263603, "comment_id": 67788827, "body": "Oh I see and why does int dot have the value -1?"}, {"owner": {"reputation": 6743, "user_id": 6919895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qqkN_JOgCvM/AAAAAAAAAAI/AAAAAAAAABE/m4r_i_2yiy8/photo.jpg?sz=128", "display_name": "Treycos", "link": "https://stackoverflow.com/users/6919895/treycos"}, "reply_to_user": {"reputation": 64, "user_id": 7060348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7adcc51f57b3496e583beda28b914c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sullivan", "link": "https://stackoverflow.com/users/7060348/sullivan"}, "edited": false, "score": 1, "creation_date": 1477490249, "post_id": 40263603, "comment_id": 67788970, "body": "<code>dot</code>can be initialized with any value under 4 without changing anything in the <i>actual</i> program, i just put <code>-1</code> to clearly show that if there is no dot in the array, its result won&#39;t point to a wrong value"}], "tags": [], "owner": {"reputation": 6743, "user_id": 6919895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qqkN_JOgCvM/AAAAAAAAAAI/AAAAAAAAABE/m4r_i_2yiy8/photo.jpg?sz=128", "display_name": "Treycos", "link": "https://stackoverflow.com/users/6919895/treycos"}, "is_accepted": true, "score": 1, "last_activity_date": 1477488465, "creation_date": 1477488465, "answer_id": 40263603, "question_id": 40262746, "link": "https://stackoverflow.com/questions/40262746/switching-the-2nd-and-4th-digit-from-rightrightmost-in-a-double/40263603#40263603", "title": "Switching the 2nd and 4th digit from right(rightmost) in a double", "body": "<p>You just have to do the exact same thing as in the link you've given:</p>\n\n<pre><code>int main() {\n    double A = 282936.67;\n\n    char str[50];\n    sprintf(str, \"%f\", A);\n\n    int dot = -1, i = 0;\n    //Finds the dot position\n    while (i != 50) {\n        if (str[i] == '.') {\n            dot = i;\n            break;\n        }\n        i++;\n    }\n\n    if (dot &gt;= 4) {\n        char tmp = str[dot - 2];//Search from the dot position\n        str[dot - 2] = str[dot - 4];\n        str[dot - 4] = tmp;\n    }\n    //Convert your string to a float\n    A = atof(str);\n    printf(\"%.2f\", A);\n\n    while (1);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 7060348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7adcc51f57b3496e583beda28b914c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sullivan", "link": "https://stackoverflow.com/users/7060348/sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 40263603, "answer_count": 1, "score": 1, "last_activity_date": 1596738017, "creation_date": 1477486150, "last_edit_date": 1596738017, "question_id": 40262746, "link": "https://stackoverflow.com/questions/40262746/switching-the-2nd-and-4th-digit-from-rightrightmost-in-a-double", "title": "Switching the 2nd and 4th digit from right(rightmost) in a double", "body": "<p>My question is pretty much the same as the question asked here: <a href=\"https://stackoverflow.com/questions/39677935/how-to-switch-2nd-and-4th-digitbefore-comma-in-a-double-c-programming\">question</a></p>\n\n<p>The difference is that I want to switch the 2nd and 4th digit from the right, instead of the left like in the other question. So rightmost number in my case is 1. \nExample: 28<strong>3</strong>9<strong>2</strong>6.67 becomes 28<strong>2</strong>9<strong>3</strong>6.67. \nHow do I code this?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main() {\n\n\n    double number;\n\n    printf(\"Give a number: \");\n    scanf(\"%lf\", &amp;number);\n\n    //printf(\"%.4f\", number);\n\n    char arr[sizeof(number)];\n    snprintf(arr, sizeof(number) + 1, \"%f\", number);\n\n    char ex = arr[1];\n    arr[1] = arr[3];\n    arr[3] = ex;\n\n    number = atof(arr);\n    printf(\"%.4f\\n\", number);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "serial-port", "embedded", "stm32", "uart"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1477499623, "post_id": 40262587, "comment_id": 67795485, "body": "Do you have a memory leak in <code>SendMessage</code>? You <code>malloc</code> memory but do not appear to <code>free</code> it. But why do you do that anyway?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1477520174, "post_id": 40262587, "comment_id": 67805806, "body": "Using <code>malloc</code> &amp; co is definitively the wrong approach on that platform. Embedded software is not the same as PC software."}, {"owner": {"reputation": 9, "user_id": 6285206, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-22FakKEk4ao/AAAAAAAAAAI/AAAAAAAAABA/nMsEixNPuxM/photo.jpg?sz=128", "display_name": "Jaco Bester", "link": "https://stackoverflow.com/users/6285206/jaco-bester"}, "edited": false, "score": 1, "creation_date": 1477569494, "post_id": 40262587, "comment_id": 67826250, "body": "Thank you Olaf and Weather Vane. Yes That was the problem. Wasn&#39;t thinking when implementing the malloc. Caused memory leak."}, {"owner": {"reputation": 6260, "user_id": 3820025, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zXOn4.png?s=128&g=1", "display_name": "Bence Kaulics", "link": "https://stackoverflow.com/users/3820025/bence-kaulics"}, "edited": false, "score": 1, "creation_date": 1477571829, "post_id": 40262587, "comment_id": 67827853, "body": "@JacoBester Post your fixed code as an answer and include in the answer what have you learnt. Just to share the useful information with the community."}], "owner": {"reputation": 9, "user_id": 6285206, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-22FakKEk4ao/AAAAAAAAAAI/AAAAAAAAABA/nMsEixNPuxM/photo.jpg?sz=128", "display_name": "Jaco Bester", "link": "https://stackoverflow.com/users/6285206/jaco-bester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 635, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477512412, "creation_date": 1477485665, "last_edit_date": 1477512412, "question_id": 40262587, "link": "https://stackoverflow.com/questions/40262587/stm32-uart-only-transmits-few-bytes-then-stops", "title": "STM32 UART Only transmits few bytes then stops", "body": "<p>I'm writing a program that sends serial data from STM32F429 Dev Board to PC via UART. The program sends a message but each time stops when it should keep sending the data at the same amount of bytes (157).</p>\n\n<p>The data I receive through a terminal program on my PC is correct but the terminal only shows 157 bytes received doesn't matter what input I give. \nThe board still runs and the while loop keeps executing (checked with a counter watch in debug) but no new data is received on port after 157 bytes.  </p>\n\n<pre><code>int main(void)\n{\n    HAL_Init();\n    SystemClock_Config();\n    MX_USART1_UART_Init();\n    __HAL_UART_ENABLE_IT(&amp;huart1, UART_IT_TC);\n\n    /* Infinite loop */\n    while (1)\n    {\n       if(serialFlag)\n       {\n           char Message[13];\n           for(int i=1;i&lt;6;i++)\n           {\n               SendMessage(\"Hello\\n\\r\");\n               HAL_Delay(1);\n           }\n\n           serialFlag=false;\n       }\n    }\n}\n</code></pre>\n\n<p>My ISR after transmision of my UART</p>\n\n<pre><code>void HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)\n{\n    __HAL_UART_FLUSH_DRREGISTER(&amp;huart1);\n}\n</code></pre>\n\n<p>Initialisation:</p>\n\n<pre><code>static void MX_USART1_UART_Init(void)\n{\n     huart1.Instance = USART1;\n     huart1.Init.BaudRate = 115200;\n     huart1.Init.WordLength = UART_WORDLENGTH_8B;\n     huart1.Init.StopBits = UART_STOPBITS_1;\n     huart1.Init.Parity = UART_PARITY_NONE;\n     huart1.Init.Mode = UART_MODE_TX_RX;\n     huart1.Init.HwFlowCtl = UART_HWCONTROL_NONE;\n     huart1.Init.OverSampling = UART_OVERSAMPLING_16;\n     if (HAL_UART_Init(&amp;huart1) != HAL_OK)\n     {\n        Error_Handler();\n     }\n}\n</code></pre>\n\n<p>This procedure handles the text sent to the UART</p>\n\n<pre><code>void SendMessage(char str[]) \n{\n    char *result = (char *)malloc(strlen(str)+1);\n    strcpy(result,str);\n    HAL_UART_Transmit_IT(&amp;huart1,(uint8_t*)result, strlen(str));\n}\n</code></pre>\n"}, {"tags": ["c", "file", "append"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1477484597, "post_id": 40262154, "comment_id": 67784743, "body": "Show an example of all involved files and the resulting file you get and the resulting file you want."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477484675, "post_id": 40262154, "comment_id": 67784811, "body": "Edit your question and don&#39;t post comments."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477484836, "post_id": 40262154, "comment_id": 67784930, "body": "How does the <code>stat.txt</code> file look <i>before</i> you run the program ?"}, {"owner": {"reputation": 9, "user_id": 6145775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8855d12229ec45fcc3675ae37c874b2?s=128&d=identicon&r=PG&f=1", "display_name": "xmitz", "link": "https://stackoverflow.com/users/6145775/xmitz"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477484999, "post_id": 40262154, "comment_id": 67785023, "body": "@MichaelWalz empty"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1477485453, "post_id": 40262154, "comment_id": 67785324, "body": "Please show an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "is_accepted": true, "score": 0, "last_activity_date": 1477486648, "last_edit_date": 1477486648, "creation_date": 1477484725, "answer_id": 40262275, "question_id": 40262154, "link": "https://stackoverflow.com/questions/40262154/c-append-on-2nd-line-of-file/40262275#40262275", "title": "C - Append on 2nd line of file", "body": "<p>Due to the way files and lines are considered in computers, you can not vertically print as you desire. Instead, what you can do is storing all these numbers (i.e. <em>tries</em> <strong>AND</strong> <em>(float)tries_sucess/num_letters</em>) in two arrays and printing the contents of each array on the same line in that order. In effect, this would be buffering your content before printing and formatting it as you desire.</p>\n\n<p>In that way, you can print all the data into two lines, which now correspond to an array, each.</p>\n\n<p>Alternatively, you can create two char arrays and consider them as actual string buffers and use sprintf to record into them. Then, once you're done, you can print each char array through a single fprintf call.</p>\n\n<p>Assuming you created two sufficiently long char arrays, below is a sample code for new write_stats. It now only serves to record the stats into two buffers.</p>\n\n<pre><code>void write_stats(int tries, int num_letters, int tries_sucess, char* buffer1, char* buffer2)\n{\n    sprintf(buffer1 + strlen(buffer1),\" %d\\n\",tries);\n    sprintf(buffer2 + strlen(buffer2),\" %f\",(float)tries_sucess/num_letters);\n}\n</code></pre>\n\n<p>Note that you need to initiate the buffers with 0 to be able to easily make use of strlen function as I did. Also, you will eventually (i.e. when you are done calling write_stats ) need to call fprintf, in a block that buffer1 and buffer2 are defined in, as follows.</p>\n\n<pre><code>FILE *stats;\nstats = fopen(\"C:\\\\Users\\\\rjmal\\\\Documents\\\\CLION PROJECTS\\\\JogoDaForca\\\\stats.txt\", \"a\");\nif(stats == NULL)\n{\n    printf(\"can't open file\\n\");\n    exit(0);\n}\nfprintf(stats,\"%s\\n%s\", buffer1, buffer2);\nfclose(stats);\n</code></pre>\n\n<p>Since there are quite a few details to keep in mind, I think it is best you see this idea at work. See <a href=\"http://ideone.com/dcK8q0\" rel=\"nofollow\">here</a> for a working implementation, with some comments to help elaborate some details. As you may observe, the output given there is horizontal and is in 2 lines, as you described and as given below.</p>\n\n<pre><code>1 3 13 55 233\n2.000000 1.600000 1.619048 1.617978 1.618037\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6145775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8855d12229ec45fcc3675ae37c874b2?s=128&d=identicon&r=PG&f=1", "display_name": "xmitz", "link": "https://stackoverflow.com/users/6145775/xmitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 40262275, "answer_count": 1, "score": 0, "last_activity_date": 1477486648, "creation_date": 1477484456, "last_edit_date": 1477484755, "question_id": 40262154, "link": "https://stackoverflow.com/questions/40262154/c-append-on-2nd-line-of-file", "title": "C - Append on 2nd line of file", "body": "<p>Im trying to append on the 2nd line of my txt file. The format I want for my txt file is the following:</p>\n\n<p><code>1 2 3 4 5</code></p>\n\n<p><code>1.2 3.5 6.4 1.2 6.5</code></p>\n\n<p>Basicly, I want to append on the first two lines of the file.</p>\n\n<pre><code>void write_stats(int tries, int num_letters, int tries_sucess)        \n    FILE *stats;\n    stats = fopen(\"C:\\\\Users\\\\rjmal\\\\Documents\\\\CLION PROJECTS\\\\JogoDaForca\\\\stats.txt\", \"a\");\n    if(stats == NULL)\n    {\n        printf(\"can't open file\\n\");\n        exit(0);\n    }\n    fprintf(stats,\" %d\\n\",tries);\n    fprintf(stats,\" %f\",(float)tries_sucess/num_letters);\n    fclose(stats);\n\n}\n</code></pre>\n\n<p>How do I make that without making a new line on the file everytime I run my program?</p>\n\n<p>With the code I made, I get something like:</p>\n\n<p><code>1</code></p>\n\n<p><code>3 1.5</code></p>\n\n<p><code>1 2.3</code></p>\n"}, {"tags": ["c", "linux", "linux-kernel", "device-tree", "max732x.c"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1477486733, "post_id": 40262148, "comment_id": 67786240, "body": "Take alook <a href=\"http://lxr.free-electrons.com/source/Documentation/devicetree/bindings/gpio/gpio-max732x.txt\" rel=\"nofollow noreferrer\">At this Doc</a> or <a href=\"http://lxr.free-electrons.com/source/Documentation/devicetree/bindings/gpio/gpio-pca953x.txt\" rel=\"nofollow noreferrer\">This Doc</a>"}], "answers": [{"comments": [{"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 0, "creation_date": 1477554758, "post_id": 40273092, "comment_id": 67816876, "body": "Thanks for a great answer, I didn&#39;t expect to be answered by the author of the patch :)  I didn&#39;t even know about <code>Documentation&#47;devicetree&#47;bindings</code> or Device Tree Overlays."}, {"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 0, "creation_date": 1477554872, "post_id": 40273092, "comment_id": 67816938, "body": "Why does <a href=\"http://lxr.free-electrons.com/source/Documentation/devicetree/bindings/gpio/gpio-max732x.txt?v=4.0\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/Documentation/devicetree/bindi&zwnj;&#8203;ngs/&hellip;</a> exist in 4.0 onwards if the support was not introduced until 4.2?  (Not an academic question - I only have 4.1.15 for this board.)"}, {"owner": {"reputation": 12261, "user_id": 3866447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52ieQ.jpg?s=128&g=1", "display_name": "Sam Protsenko", "link": "https://stackoverflow.com/users/3866447/sam-protsenko"}, "reply_to_user": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 1, "creation_date": 1477560502, "post_id": 40273092, "comment_id": 67820418, "body": "Yes, you are right, my patches were merged in v4.0. You can check it easily using next command: <code>git tag --contains 43c4bcf9425e | head</code>. I just used some other (later) patch to determine corresponding tag."}], "tags": [], "owner": {"reputation": 12261, "user_id": 3866447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52ieQ.jpg?s=128&g=1", "display_name": "Sam Protsenko", "link": "https://stackoverflow.com/users/3866447/sam-protsenko"}, "is_accepted": true, "score": 4, "last_activity_date": 1477560516, "last_edit_date": 1495535252, "creation_date": 1477520711, "answer_id": 40273092, "question_id": 40262148, "link": "https://stackoverflow.com/questions/40262148/ive-added-a-max7320-i2c-output-chip-how-can-i-get-the-kernel-to-load-the-drive/40273092#40273092", "title": "I&#39;ve added a MAX7320 i2c output chip. How can I get the kernel to load the driver for it?", "body": "<h2>Device Tree</h2>\n\n<p>There must be appropriate Device Tree definition for your chip, in order for driver to instantiate. There are 2 ways to do so:</p>\n\n<ol>\n<li><p>Modify <code>.dts</code> Device Tree file for your board (look in <code>arch/arm/boot/dts/)</code>, then recompile it and re-flash it to your device.</p>\n\n<p>This way is preferred in case when you have access you kernel sources for your board and you are able to re-flash <code>.dtb</code> file to your  device.</p></li>\n<li><p>Create <a href=\"http://lxr.free-electrons.com/source/Documentation/devicetree/overlay-notes.txt\" rel=\"nofollow noreferrer\">Device Tree Overlay</a> file, compile it and <a href=\"https://www.raspberrypi.org/documentation/configuration/device-tree.md#part3.5\" rel=\"nofollow noreferrer\">load</a> it on your device.</p>\n\n<p>This way is preferred when you don't have access to kernel sources for your board, or you are unable to flash new device tree blob to your device.</p></li>\n</ol>\n\n<p>Your device definition in Device Tree should look like (according to <a href=\"http://lxr.free-electrons.com/source/Documentation/devicetree/bindings/gpio/gpio-max732x.txt\" rel=\"nofollow noreferrer\">Documentation/devicetree/bindings/gpio/gpio-max732x.txt</a>):</p>\n\n<pre><code>&amp;i2c0 {\n    expander: max7320@5d {\n        compatible = \"maxim,max7320\";\n        reg = &lt;0x5d&gt;;\n        gpio-controller;\n        #gpio-cells = &lt;2&gt;;\n    };\n};\n</code></pre>\n\n<h2>Kernel configuration</h2>\n\n<p>As your expander chip (MAX7320) has no input GPIOs, you don't need IRQ support for MAX732x. So you can disable <code>CONFIG_GPIO_MAX732X_IRQ</code> in your kernel configuration.</p>\n\n<h2>Matching device with driver</h2>\n\n<p>Once you have your Device Tree loaded (with definition for MAX7320), MAX732x driver will be matched with device definition, and instantiated. Below is explained how matching happens.</p>\n\n<p>In Device Tree file you have <code>compatible</code> property:</p>\n\n<pre><code>compatible = \"maxim,max7320\";\n</code></pre>\n\n<p>In MAX732x driver you can see this table:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static const struct of_device_id max732x_of_table[] = {\n    ...\n    { .compatible = \"maxim,max7320\" },\n    ...\n</code></pre>\n\n<p>When driver is being loaded, and when Device Tree blob is being loaded, kernel tries to find the match for each driver and Device Tree definition. Just by comparing strings above. If strings are matched -- kernel instantiates driver, passing corresponding device parameters to it. Look at <a href=\"http://lxr.free-electrons.com/source/drivers/i2c/i2c-core.c?v=4.5#L503\" rel=\"nofollow noreferrer\">i2c_device_match()</a> function for details.</p>\n\n<h2>Obtaining patches</h2>\n\n<p>The best way is to use kernel sources that already have Device Tree support of MAX732x (v4.0+). But if it's not the case, then...</p>\n\n<p>You can cherry-pick patches from upstream kernel to your kernel:</p>\n\n<pre><code>$ git remote add upstream git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git\n$ git fetch --all\n$ git cherry-pick 43c4bcf9425e\n$ git cherry-pick 479f8a5744d8\n$ git cherry-pick 09afa276d52e\n$ git cherry-pick 996bd13f28e6\n</code></pre>\n\n<p>And if you still want to apply patches manually (worst option, actually), <a href=\"https://stackoverflow.com/a/27933950/3866447\">here</a> you can find direct links to patches. Click <strong>(patch)</strong> link to get a raw patch.</p>\n\n<p>Also check later patches for <code>gpio-max732x.c</code> <a href=\"https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/log/?qt=grep&amp;q=max732\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<h2>Hardware concerns</h2>\n\n<p>To be sure that your chip has <code>0x5d</code> I2C address, check that configuration pins are tied to next lines (as per <a href=\"https://datasheets.maximintegrated.com/en/ds/MAX7320.pdf\" rel=\"nofollow noreferrer\">datasheet</a>):</p>\n\n<pre><code>Pin    Line\n-----------\nAD2     V+\nAD0     V+\n</code></pre>\n"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 2, "accepted_answer_id": 40273092, "answer_count": 1, "score": 2, "last_activity_date": 1477560516, "creation_date": 1477484441, "last_edit_date": 1477484802, "question_id": 40262148, "link": "https://stackoverflow.com/questions/40262148/ive-added-a-max7320-i2c-output-chip-how-can-i-get-the-kernel-to-load-the-drive", "title": "I&#39;ve added a MAX7320 i2c output chip. How can I get the kernel to load the driver for it?", "body": "<p>I've added a MAX7320 i2c expander chip to i2c bus 0 on my ARM Linux board.</p>\n\n<p>The chip works correctly from userspace with commands such as <code>/usr/sbin/i2cset -y 0 0x5d 0x02</code> and <code>/usr/sbin/i2cget -y 0 0x5d</code>.</p>\n\n<p>There is a <code>drivers/gpio/gpio-max732x.c</code> file in the kernel source, which is compiled into the kernel that I'm running.  (I've built it from source.)</p>\n\n<p>How do I tell the kernel that it should instantiate the gpio-max732x driver on \"i2c bus 0, chip id 0x5d\"?</p>\n\n<p>Do I need to modify the device tree <code>.dts</code> file and put a new <code>.dtb</code> file in <code>/boot/dtbs/</code>?</p>\n\n<p>What would the clause for instantiating a <code>gpio-max732x</code> module look like?</p>\n\n<p>P.S. I've seen <a href=\"https://lkml.org/lkml/2015/1/13/305\" rel=\"nofollow\">https://lkml.org/lkml/2015/1/13/305</a> but I can't figure out how to get the patch files.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 374, "user_id": 4524421, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1027359560613190/picture?type=large", "display_name": "bane19", "link": "https://stackoverflow.com/users/4524421/bane19"}, "edited": false, "score": 2, "creation_date": 1477484193, "post_id": 40262001, "comment_id": 67784448, "body": "Can you please elaborate your problem ?  What exactly you want ? Please include the print statements in your code."}, {"owner": {"reputation": 155, "user_id": 5163650, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b8036ef6b57e4407c5ace910565d1fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bharat Jain", "link": "https://stackoverflow.com/users/5163650/bharat-jain"}, "edited": false, "score": 0, "creation_date": 1477484471, "post_id": 40262001, "comment_id": 67784653, "body": "First of all this is infinite loop  &amp; I do not understand how is it working for you ? Please give the precise information on what exactly you require ?"}, {"owner": {"reputation": 67, "user_id": 7074969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d37172f7510a8d4a120264d6984727a?s=128&d=identicon&r=PG&f=1", "display_name": "anthino12", "link": "https://stackoverflow.com/users/7074969/anthino12"}, "edited": false, "score": 1, "creation_date": 1477484613, "post_id": 40262001, "comment_id": 67784758, "body": "As I said, my goal is to print the nearest number bigger than &quot;a&quot; that is made only from EVEN numbers. In this case a = 135 so as an result I should get 200, because 2, 0 and 0 are even. If a was 1900 as a result I should&#39;ve had 2000. I didn&#39;t include the print statement because I don&#39;t know where should I put it exactly, tbh :$"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477486039, "post_id": 40262001, "comment_id": 67785742, "body": "This can be done without brute forcing by iterating the number."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1477486070, "post_id": 40262001, "comment_id": 67785760, "body": "@AnthinoRusso,<i>print the nearest number bigger than &quot;a&quot; that is made only from EVEN numbers</i>: well I could not spot something similar to this in your original question."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1477486081, "post_id": 40262001, "comment_id": 67785766, "body": "There are several possible solutions. Do you actually need to generate these numbers &quot;as numbers&quot; or is printing the correct digits enough?"}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1477493824, "post_id": 40262672, "comment_id": 67791633, "body": "Your code does not answer the question, after fixing the typo, it would always print <code>Value = 0</code>."}, {"owner": {"reputation": 374, "user_id": 4524421, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1027359560613190/picture?type=large", "display_name": "bane19", "link": "https://stackoverflow.com/users/4524421/bane19"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1477496084, "post_id": 40262672, "comment_id": 67793235, "body": "Is the approach totally wrong or with some improvements, it can be corrected ?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1477506221, "post_id": 40262672, "comment_id": 67799118, "body": "Your approach can be improved to make it work: try computing the output value incrementally and deal with odd digits appropriately and you&#39;ll get there."}], "tags": [], "owner": {"reputation": 374, "user_id": 4524421, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1027359560613190/picture?type=large", "display_name": "bane19", "link": "https://stackoverflow.com/users/4524421/bane19"}, "is_accepted": false, "score": 1, "last_activity_date": 1477486087, "last_edit_date": 1477486087, "creation_date": 1477485925, "answer_id": 40262672, "question_id": 40262001, "link": "https://stackoverflow.com/questions/40262001/even-numbers-beginner/40262672#40262672", "title": "Even numbers - beginner", "body": "<p>This might be helpful. Start with the number and check if every digit is even. If yes, it will come out of the loop and print the value else it will increment the number and do the same over again. It's kind of a infinite loop. </p>\n\n<pre><code>int value = 123;\nwhile (value &gt; 0) \n{\n   int digit = value % 10;\n   if(digit%2 == 0)\n   {\n      flag =true;\n   }\n   else\n   {\n     flag = false;\n     value = value + 1;\n     continue;\n   }\n   value /= 10;\n}\nprintf(\"Value = %d\",Value)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1477487668, "post_id": 40263114, "comment_id": 67786897, "body": "Nice and clean. I think it would benefit from a textual description, though. The algorithm may not be clear for a beginner."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477487840, "post_id": 40263114, "comment_id": 67787029, "body": "It fails for <code>2888896456</code>, must be a wrap-around. <code>4000000000</code> is representable in 32 unsigned bit."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1477488259, "post_id": 40263114, "comment_id": 67787370, "body": "@2501: correct! the algorithm fails when the number is too close to UINT_MAX. Fixing it makes to code less readable."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1477555731, "last_edit_date": 1477555731, "creation_date": 1477487136, "answer_id": 40263114, "question_id": 40262001, "link": "https://stackoverflow.com/questions/40262001/even-numbers-beginner/40263114#40263114", "title": "Even numbers - beginner", "body": "<p>Your solution does not work because you may need to propagate the oddness up by several powers of 10.</p>\n\n<p>Here is a simple method:</p>\n\n<ul>\n<li>check each digit from the least significant to the most significant ;</li>\n<li>for every odd digit, bump the number to the next multiple of the corresponding power of 10. A pattern of <code>xx1yyy</code> becomes <code>xx2000</code> and a pattern of <code>x9yyy</code> becomes <code>X0000</code> where <code>X</code> may be odd and will be handled in the next iteration.</li>\n</ul>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nunsigned next_even(unsigned n) {\n    for (unsigned div = 1; div &lt;= n; div *= 10) {\n        unsigned digit = (n / div) % 10;\n        if (digit &amp; 1) {\n            /* found an odd digit, bump number up to the\n               next multiple of div */\n            n = n - n % div + div;\n        }\n        if (div &gt; UINT_MAX / 10) {\n            /* Prevent wrap around.\n               The result may be incorrect for numbers &gt;= UINT_MAX / 10. */\n            break;\n        }\n    }\n    return n;\n}\n\nint main(int argc, char *argv[]) {\n    for (int i = 1; i &lt; argc; i++) {\n        unsigned n = strtoul(argv[i], NULL, 0);\n        printf(\"%u -&gt; %u\\n\", n, next_even(n));\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note that the above method does not work for all unsigned values because of potential overflow.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1477660651, "post_id": 40305723, "comment_id": 67868958, "body": "This solution uses brute force, but works for most integers, albeit slowly in many cases.  Note that <code>while(a &gt; 0)</code> is not an adequate test for overflow: if <code>a++</code> overflows the range of type <code>int</code>, the behavior is undefined."}], "tags": [], "owner": {"reputation": 67, "user_id": 7074969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d37172f7510a8d4a120264d6984727a?s=128&d=identicon&r=PG&f=1", "display_name": "anthino12", "link": "https://stackoverflow.com/users/7074969/anthino12"}, "is_accepted": false, "score": 1, "last_activity_date": 1477660419, "last_edit_date": 1477660419, "creation_date": 1477659781, "answer_id": 40305723, "question_id": 40262001, "link": "https://stackoverflow.com/questions/40262001/even-numbers-beginner/40305723#40305723", "title": "Even numbers - beginner", "body": "<p>Thanks everyone for helping me but I managed to get the solution about this problem myself. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int a;\n    scanf(\"%d\", &amp;a);\n    while (a &gt; 0) {\n        a++;\n        int n = a;\n        int cifra;\n        int flag = 0;\n\n        while (n &gt; 0) {\n            cifra = n % 10;\n            if (cifra % 2 == 0) {\n                flag = 1;\n                n = n / 10;\n            } else {\n                flag = 0;\n                break;\n            }\n        }\n        if (flag) {\n            printf(\"%d\", a);\n            return 0;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7074969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d37172f7510a8d4a120264d6984727a?s=128&d=identicon&r=PG&f=1", "display_name": "anthino12", "link": "https://stackoverflow.com/users/7074969/anthino12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 40263114, "answer_count": 3, "score": 1, "last_activity_date": 1477660419, "creation_date": 1477484036, "last_edit_date": 1477485861, "question_id": 40262001, "link": "https://stackoverflow.com/questions/40262001/even-numbers-beginner", "title": "Even numbers - beginner", "body": "<p>I'm a beginner and I'm trying to create a program that will generate numbers made only from even digits, rounding up to the nearest such number. </p>\n\n<p>Examples:</p>\n\n<blockquote>\n  <p>135 --> 200<br>\n  2700 --> 2800</p>\n</blockquote>\n\n<p>I have one code but whenever I try to print it, the number increments only for 1 because I print it in the <code>while</code> loop but whenever I try to print it out of the loop I dont get it out.</p>\n\n<p>Here's the code, check it out.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int a = 135;\n    int cifra;\n    int i = a;\n    int n;\n\n    while (i != 0) {\n        cifra = i % 10;\n        n = cifra;\n\n        if (n % 2 == 0) {\n            i /= 10;\n        } else {\n            ++a;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "tolower"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1477484041, "post_id": 40261963, "comment_id": 67784342, "body": "You have undefined behavior, that&#39;s why."}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1477484133, "post_id": 40261963, "comment_id": 67784410, "body": "If you have to use such function for a serious project, go for boost library to avoid different character set issues."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1477484203, "post_id": 40261963, "comment_id": 67784458, "body": "You are returning a buffer which becomes undefined after return. what means <code>char(tolower(str[i]))</code>? <code>tolower(str[i])</code> should be enough"}, {"owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "edited": false, "score": 0, "creation_date": 1477484271, "post_id": 40261963, "comment_id": 67784511, "body": "I&#39;m just trying to make it work for past 2 days... I&#39;m guessing something wrong with my buffer. I also tried doing this char buffer[strlen(str)]{}; but that also didn&#39;t help"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 2, "creation_date": 1477484289, "post_id": 40261963, "comment_id": 67784523, "body": "&quot;I&#39;m trying to perform case insensitive strcmp on two C-style strings.&quot; -- Then at no point do you need to store the <i>whole</i> string as lowercase. You only need to convert the characters you&#39;re comparing at the moment to lowercase. Do that, and you no longer need an answer to this question."}, {"owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "reply_to_user": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1477484358, "post_id": 40261963, "comment_id": 67784575, "body": "@Holger, I&#39;m casting it to char, since tolower returns me an int but my function should return a char array. So I either do (char) or char()"}, {"owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "edited": false, "score": 0, "creation_date": 1477484463, "post_id": 40261963, "comment_id": 67784646, "body": "@hvd, nice! I&#39;ll try that right now and convert my ToLowerCase function to CompareCStrings! I&#39;ll get back later, thanks!"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1477484499, "post_id": 40261963, "comment_id": 67784674, "body": "There&#39;s a function to do case insensitive comparisons.  On Posix systems you have <code>strcasecmp</code>.  Under MSVC, use <code>stricmp</code> instead."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1477485274, "post_id": 40261963, "comment_id": 67785190, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Although the error in this question matches exactly the problem described in the famous duplicate, I think OP&#39;s question is less about &quot;what&#39;s broken&quot; and more about &quot;how do I fix it&quot;."}, {"owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1477485284, "post_id": 40261963, "comment_id": 67785203, "body": "@dbush I&#39;m using MinGW so none of these ..."}, {"owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1477485565, "post_id": 40261963, "comment_id": 67785409, "body": "@dasblinkenlight yep! I didn&#39;t even think of that, so every time I did a wrong search on &quot;tolower&quot;. Maybe this thread will help someone else too!"}, {"owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "edited": false, "score": 0, "creation_date": 1477485577, "post_id": 40261963, "comment_id": 67785415, "body": "@hvd you are genius. Thank you again! That&#39;s perfect :)"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1477484144, "creation_date": 1477484144, "answer_id": 40262034, "question_id": 40261963, "link": "https://stackoverflow.com/questions/40261963/tolower-for-c-style-strings/40262034#40262034", "title": "tolower for C-style strings", "body": "<p>You cannot return local variables from functions, so returning <code>buffer</code> is undefined behavior.</p>\n\n<p>You have three choices to make this API:</p>\n\n<ul>\n<li>Take a non-const <code>str</code> and perform modifications in place</li>\n<li>Take a buffer for the string from the caller, and either assume that it has sufficient length, or also take the size of the buffer (much safer)</li>\n<li>Return a <code>malloc</code>-ed string. This would require the caller to free the result. Should you decide to go this route, note that you need to <code>malloc</code> <code>strlen(str)+1</code> bytes to accommodate null terminator.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "edited": false, "score": 0, "creation_date": 1477485229, "post_id": 40262056, "comment_id": 67785167, "body": "Wow I did not know that! Thank you for the answer with clarifications."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": true, "score": 2, "last_activity_date": 1477484179, "creation_date": 1477484179, "answer_id": 40262056, "question_id": 40261963, "link": "https://stackoverflow.com/questions/40261963/tolower-for-c-style-strings/40262056#40262056", "title": "tolower for C-style strings", "body": "<pre><code>return buffer;\n</code></pre>\n\n<p>You return a pointer to a variable that's local to <code>ToLowerCase</code>, the pointer will point to garbage after the call, resulting in undefined behaviour when trying to dereference the pointer. Either change the <code>str</code> itself or dynamically allocate the memory for <code>buffer</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 3512504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e55e5c9ca3d534e9e9aefb98baf854f?s=128&d=identicon&r=PG", "display_name": "Ilo", "link": "https://stackoverflow.com/users/3512504/ilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "closed_date": 1477484171, "accepted_answer_id": 40262056, "answer_count": 2, "score": 1, "last_activity_date": 1477488712, "creation_date": 1477483944, "last_edit_date": 1477488712, "question_id": 40261963, "link": "https://stackoverflow.com/questions/40261963/tolower-for-c-style-strings", "closed_reason": "Duplicate", "title": "tolower for C-style strings", "body": "<p>I'm trying to perform case insensitive strcmp on two C-style strings.</p>\n\n<p>I have a function to convert C-style strings to lowercase.</p>\n\n<pre><code>char* ToLowerCase(const char* str)\n{\n    char buffer[strlen(str)];\n    for (int i=0; i&lt;strlen(str); ++i)\n        buffer[i] = char(tolower(str[i]));\n    return buffer;\n}\n</code></pre>\n\n<p>One string comes from function char* GetMyString(int i), and the second is in array of C-style strings char* myStrings[5].</p>\n\n<p>So assuming that both GetMyString(0) and myString[0] both return \"TEXT\" </p>\n\n<pre><code>strcmp(ToLowerCase(GetMyString(0)), ToLowerCase(myStrings[0]));\n</code></pre>\n\n<p>compares strings like \"mytextxaogs5atx\" \"mytextxabs5atx\" (some random text gets added...)</p>\n\n<p>whilst</p>\n\n<pre><code>strcmp(GetMyString(0), myStrings[0]);\n</code></pre>\n\n<p>works just fine, so that I assume there's nothing to do with the null termination as some of you might think.</p>\n\n<p>What is wrong with my code? Did I miss something? I've looked at many questions about tolower but none of them were able to help with my problem.</p>\n"}, {"tags": ["c", "function-pointers"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1477485269, "post_id": 40261932, "comment_id": 67785183, "body": "Function pointer conversions from one function pointer type to another is formally undefined behavior. In reality such conversions might work on lots of systems - a compiler might even implement them in a deterministic way as a non-standard extension - but it is not recommended practice."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1477484010, "creation_date": 1477484010, "answer_id": 40261986, "question_id": 40261932, "link": "https://stackoverflow.com/questions/40261932/c-cast-from-specific-function-pointer-to-less-specific-function-pointer/40261986#40261986", "title": "C cast from specific function pointer to less specific function pointer", "body": "<p>The proper fix is to fold the implementation-specific things into the function \"behind\" the abstract interface, i.e.:</p>\n\n<pre><code>void funct_type1(void *s1)\n{\n struct something1 *s = s1;\n /* ... rest of function ... */\n}\n</code></pre>\n\n<p>Otherwise you're going to have to cast the function pointer in the calls to <code>general()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1477485580, "last_edit_date": 1477485580, "creation_date": 1477484180, "answer_id": 40262057, "question_id": 40261932, "link": "https://stackoverflow.com/questions/40261932/c-cast-from-specific-function-pointer-to-less-specific-function-pointer/40262057#40262057", "title": "C cast from specific function pointer to less specific function pointer", "body": "<p>You can use <code>void *</code></p>\n\n<pre><code>void general(void (*function)(void *something), void *something);\nvoid funct_type1(void* something);\nvoid funct_type2(void* something);\ngeneral(funct_type1, &amp;test1);\ngeneral(funct_type2, &amp;test2);\n</code></pre>\n\n<p>where</p>\n\n<pre><code>void funct_type1(void* something)\n{\n   struct something1 *castedPointer = something;\n\n//...YOUR STUFF\n}\n</code></pre>\n\n<p>Or you can use an <code>union</code> to group your structs</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct something1\n{\n    int a;\n};\n\nstruct something2\n{\n    int b;\n};\n\nunion something3\n{\n    struct something1 s1;\n    struct something2 s2;\n};\n\nvoid general(void (*function)(union something3 *something), union something3* something)\n{\n    if (function != NULL)\n        function(something);\n}\n\nvoid funct_type1(union something3* something)\n{\n    something-&gt;s1.a = 1;\n\n    printf(\"%s - something-&gt;s1.a = %d\\n\", __func__, something-&gt;s1.a);\n}\n\nvoid funct_type2(union something3* something)\n{\n    something-&gt;s2.b = 3;\n\n    printf(\"%s - something-&gt;s2.b = %d\\n\", __func__, something-&gt;s2.b);\n}\n\nint main()\n{\n    union something3 test1;\n    union something3 test2;\n\n    test1.s1.a = 0;\n    test2.s2.b = 0;\n\n    general(funct_type1, &amp;test1);\n    general(funct_type2, &amp;test2);\n\n    printf(\"%s - test1.s1.a = %d\\n\", __func__, test1.s1.a);\n    printf(\"%s - test2.s2.b = %d\\n\", __func__, test2.s2.b);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 1310345, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/8a7752ff8bb278a7e51475808ec234e2?s=128&d=identicon&r=PG", "display_name": "Catalin Vasile", "link": "https://stackoverflow.com/users/1310345/catalin-vasile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1477485580, "creation_date": 1477483857, "last_edit_date": 1477485150, "question_id": 40261932, "link": "https://stackoverflow.com/questions/40261932/c-cast-from-specific-function-pointer-to-less-specific-function-pointer", "title": "C cast from specific function pointer to less specific function pointer", "body": "<p>Lets say I have the following code in C:</p>\n\n<pre><code>void general(void (*function)(void *something), void *something);\nvoid funct_type1(struct something1 *something);\nvoid funct_type2(struct something2 *something);\ngeneral(funct_type1, something1);\ngeneral(funct_type2, something2);\n</code></pre>\n\n<p>How do I compile this without pointer conversion warnings, and without manually suppressing some errors?</p>\n\n<p>Later edit: I'm trying not to modify funct_type1() and func_type2() definition.</p>\n"}, {"tags": ["c", "file", "data-structures", "struct"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1477483967, "post_id": 40261895, "comment_id": 67784299, "body": "Fyi, <code>&quot;# Type effectiveness&quot;</code> is <b>21</b> chars wide, including the terminator. You&#39;re breaching your <code>Type2</code> array."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1477485172, "post_id": 40261895, "comment_id": 67785125, "body": "Is there always one word per line in the file?"}, {"owner": {"reputation": 9, "user_id": 5163043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206267198550490/picture?type=large", "display_name": "burnsieXD", "link": "https://stackoverflow.com/users/5163043/burnsiexd"}, "edited": false, "score": 0, "creation_date": 1477485520, "post_id": 40261895, "comment_id": 67785367, "body": "In order to test, I have simplified the file but only the contents in &#39;# Type effectiveness&#39; contain more than one word."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1477486500, "post_id": 40261895, "comment_id": 67786066, "body": "This code has many many issues... The main problem seems to be, in both do..while loops line is copied, but no fgets was made. The strcmp in the while() uses record[i] which is undefined."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1477498802, "post_id": 40261895, "comment_id": 67795018, "body": "This question is a duplicate of <a href=\"http://stackoverflow.com/questions/40256827/differentiating-data-in-a-file-c\" title=\"differentiating data in a file c\">stackoverflow.com/questions/40256827/&hellip;</a>. Please do not double-post."}], "answers": [{"tags": [], "owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "is_accepted": false, "score": 0, "last_activity_date": 1477488231, "creation_date": 1477488231, "answer_id": 40263524, "question_id": 40261895, "link": "https://stackoverflow.com/questions/40261895/reading-file-contents-section-by-section/40263524#40263524", "title": "Reading file contents section by section", "body": "<p>There are many issues in this code. To get it worked something like this sample should be used. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    typedef struct \n    {\n        char types[1000];\n        char effectiveness[1000];\n    } sinFile; \n\n    sinFile record[1000];\n\n    FILE* file; \n    char line[121];\n    char* bp; \n    int i=0, j=0;\n    int state=0;\n\n    file = fopen(\"Test3.txt\", \"r\");\n\n    while(fgets(line, 120, file)) {\n        for(bp=line;isspace(*bp);bp++);\n        if(state==0) {\n            if(*bp=='#') {\n                for(bp=line;isspace(*bp);bp++);\n                item = bp;\n                if(!strcmp(item,\"Type name\")) state=1;\n                else if(!strcmp(item,\"Type effectiveness\")) state=2;\n            }\n        }\n        else {\n            if(*bp=='.') {\n                state=0;\n            }\n            else if(state==1) {\n                strcpy(record[i].types, bp);\n                i++;\n            }\n            else if(state==2) {\n                strcpy(record[j].effectiveness, bp);\n                j++;\n            }\n        }\n    }\n\n    fclose(file);\n\n    printf(\"%s\", record[1].effectiveness);\n}\n</code></pre>\n\n<p>But with this code, the lines in the 1st block have to correspond with the lines in the 2nd block... It would be simpler to use key/value-pairs without blocks. </p>\n"}], "owner": {"reputation": 9, "user_id": 5163043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206267198550490/picture?type=large", "display_name": "burnsieXD", "link": "https://stackoverflow.com/users/5163043/burnsiexd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477488231, "creation_date": 1477483772, "question_id": 40261895, "link": "https://stackoverflow.com/questions/40261895/reading-file-contents-section-by-section", "title": "Reading file contents section by section", "body": "<p>I am trying to read a file contents in sections into useable structs, the '#' symbol begins a section while the '.' symbol ends it. An example would be: </p>\n\n<pre><code># Type name\nbird\nmammal\n.\n# Type effectiveness\nVeryEffective\nNotEffective\n.\n</code></pre>\n\n<p>So far I can read the contents of the first type, but when I try to read the contents of the second, I keep re-reading the contents of the first.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    typedef struct \n    {\n        char types[1000];\n        char effectiveness[1000];\n    } sinFile; \n    sinFile record[1000];\n\n    FILE* file; \n    char line[121];\n    char period[10];\n    char Type2[20];\n\n\n    char* item; \n    char* item2;\n    int i = 0;\n    int j;\n\n\n    file = fopen(\"Test3.txt\", \"r\");\n\n    while(fgets(line, 120, file)) {\n        item = strtok(line, \" \");\n        strcpy(period, \".\");\n        strcpy(Type2, \"# Type effectiveness\");\n\n        if (item[0] == '#' || item[0] == '.') {\n            continue;\n        } else {\n            do {\n                strcpy(record[i].types, line);\n                i++;\n            } while (strcmp(record[i].types, period) == 0);\n        }\n\n\n        for(j=0; strcmp(line, Type2) == 0; j++) { \n            do {\n                strcpy(record[j].effectiveness, line);\n                j++;\n            } while (strcmp(record[j].effectiveness, period)== 0);\n        }\n    }\n\n    fclose(file);\n\n    printf(\"%s\", record[1].effectiveness);\n}\n</code></pre>\n\n<p>Currently, record[1].types gives me the same result as record[1].effectiveness; i.e. 'mammal'. I feel like I am close but I'm not sure how to proceed. </p>\n"}, {"tags": ["c", "linux", "fanotify"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477482895, "post_id": 40261111, "comment_id": 67783603, "body": "Is the final resolved path without links and/or <code>.</code>/<code>..</code> elements longer than <code>PATH_MAX</code>?  If not, <code>realpath()</code> might work for you:  <a href=\"http://man7.org/linux/man-pages/man3/realpath.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/realpath.3.html</a>"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1477483366, "post_id": 40261111, "comment_id": 67783928, "body": "Aren&#39;t paths supposed to be, well, shorter than <code>PATH_MAX</code> characters? This sounds strange."}, {"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477483498, "post_id": 40261111, "comment_id": 67784003, "body": "@AndrewHenle, <code>realpath</code> needs a path in the first place. All I have is a file descriptor and a PID."}, {"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477483981, "post_id": 40261111, "comment_id": 67784308, "body": "@unwind No. I can&#39;t speak for all filesystems but on something like ext4 you can pretty much keep creating nested directories until you run out of inodes."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477484079, "post_id": 40261111, "comment_id": 67784372, "body": "@NikitaKakuev <i><code>realpath</code> needs a path in the first place.</i>  So does <code>readlink()</code>.  How are you getting <i>that</i> to work?"}, {"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477484978, "post_id": 40261111, "comment_id": 67785006, "body": "@AndrewHenle Exactly as I&#39;ve stated in my answer - by calling <code>readlink</code> on <code>&#47;proc&#47;self&#47;fd&#47;&lt;fd&gt;</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477485162, "post_id": 40261111, "comment_id": 67785116, "body": "@NikitaKakuev So, you do have a path."}, {"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477485793, "post_id": 40261111, "comment_id": 67785556, "body": "@AndrewHenle Oh, I forgot that <code>realpath</code> actually expands symlinks. In that case, I have a path (to a symlink), but it resolves to a path that&#39;s longer that PATH_MAX."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477489143, "post_id": 40261111, "comment_id": 67788103, "body": "1+ for bringing up this nice corner case issue. :-)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477493284, "post_id": 40261111, "comment_id": 67791200, "body": "What happens if you pass a buffer longer than <code>PATH_MAX</code>?  For example: <code>char buffer[ 128 * 1024 ]; readlink( &quot;&#47;proc&#47;self&#47;fd&#47;&lt;fd&gt;&quot;, buffer, sizeof( buffer ) );</code>  Because I don&#39;t see any checks for a path longer than <code>PATH_MAX</code> in the source code at <a href=\"http://lxr.free-electrons.com/source/fs/proc/base.c#L1599\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/fs/proc/base.c#L1599</a>"}, {"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477496208, "post_id": 40261111, "comment_id": 67793308, "body": "@AndrewHenle I don&#39;t see checks as well, but <code>readlink</code> still fails with <code>ENAMETOOLONG</code>."}, {"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1477516182, "post_id": 40261111, "comment_id": 67804252, "body": "@AndrewHenle On a second sight, I see the problem - <code>do_proc_readlink</code> doesn&#39;t use <code>buffer</code> directly. Instead, it allocates a page and uses it as a temporary buffer when it calls <code>d_path</code>. Consequently, <code>prepend</code> runs out of this buffer and returns <code>-ENAMETOOLONG</code>. A funny thing is that on amd64 PAGE_SIZE is 4096 bytes. Same as PATH_MAX."}], "answers": [{"comments": [{"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "edited": false, "score": 0, "creation_date": 1477486661, "post_id": 40262582, "comment_id": 67786189, "body": "That was the first thing I&#39;ve tried (it&#39;s suggested by <code>man 2 readlink</code>) and it didn&#39;t work. I get <code>ENAMETOOLONG</code> for long paths despite the size of the buffer."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "edited": false, "score": 0, "creation_date": 1477487343, "post_id": 40262582, "comment_id": 67786647, "body": "@NikitaKakuev: Just to double-check: you <i>did</i> pass the actual buffer size as the third argument?"}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 1, "last_activity_date": 1477485647, "creation_date": 1477485647, "answer_id": 40262582, "question_id": 40261111, "link": "https://stackoverflow.com/questions/40261111/get-path-from-file-descriptor-when-path-is-longer-than-path-max/40262582#40262582", "title": "Get path from file descriptor when path is longer than PATH_MAX", "body": "<p><code>readlink</code> <em>can</em> be used with a link target that's longer than <code>PATH_MAX</code>. There are two restrictions: the name of the link itself must be shorter than <code>PATH_MAX</code> (check, <code>\"/proc/self/fd/&lt;fd&gt;\"</code> is about 20 characters) and the provided output buffer must be large enough. You might want to call <code>lstat</code> first to figure out how big the output buffer should be, or just call <code>readlink</code> repeatedly with growing buffers.</p>\n"}, {"comments": [{"owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "edited": false, "score": 0, "creation_date": 1477519187, "post_id": 40272334, "comment_id": 67805504, "body": "That&#39;s an... interesting perspective. But check out the update to my question. As it turns out, I wasn&#39;t running into &quot;the limitation of <code>PATH_MAX</code>&quot;. The thing is that the implementation of <code>readlink</code> for <code>procfs</code> always works with a single-page buffer. If a path doesn&#39;t fit into this buffer, <code>-ENAMETOOLONG</code> is returned. If <code>do_proc_readlink</code> allocated a larger buffer, I would get the full path even if it was larger than PATH_MAX."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "edited": false, "score": 0, "creation_date": 1477592288, "post_id": 40272334, "comment_id": 67841547, "body": "What do you mean with a single-page buffer.  Buffer to system call has not neccesary to be aligned to a page boundary, so it&#39;s easy for the buffer to span two consecutive pages (with only two bytes of path, and this is one char filename and the final &#39;\\0&#39; character, you can get a path that uses two system pages)"}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1477517933, "last_edit_date": 1592644375, "creation_date": 1477516931, "answer_id": 40272334, "question_id": 40261111, "link": "https://stackoverflow.com/questions/40261111/get-path-from-file-descriptor-when-path-is-longer-than-path-max/40272334#40272334", "title": "Get path from file descriptor when path is longer than PATH_MAX", "body": "<p>the limitation of <code>PATH_MAX</code> births from the fact that the unix (or linux, from now) needs to bind the size of parameters passed to the kernel.  There's no limit on how deep a file hierarchy can grow, and always there's the possibility to access all files, independent on how deep they are in the filesystem hierarchy.  What is actually limited is the lenght of the string you can pass or receive from the kernel representing a file name.  This means you cannot create (because you have to pass the target path) a symlink longer than this length, but you can have easily paths far longer this limit.</p>\n<p>When you pass a filename to the kernel, you can do that for two reasons, to name a file (or device, or socket, or fifo, or whatever), to open it, etc.  YOu do this and your filename goes first to a routine that converts that path into an inode (which is what the kernel manages actually).  That routine begins scanning from two possible point in the filesystem hierarchi.  Those points are the inode reference of the root inode and the inode reference of the curren working diretory of a process.  The selection of which inode to use as departure inode depends on the presence of a leading <code>/</code> character at the begining of the path.  From this point, up to <code>PATH_MAX</code> characters will be processed each time, but that can lead us deep enough that we cannot get to the root in one step only...</p>\n<p>Suppose you use the path to change your current directory, and do a <code>chdir A/B/C/D/E/.../Z</code>.  Once there, you create new directories and do the same thing, <code>chdir AA/AB/AC/AD/AE/.../AZ</code>, then <code>chdir BA/BB/BC/BD/...</code> and so on... there's nothing in the system that forbids you to get so deep in the filesystem (you can try that yourself, I have done and tested before)  You can grow to a map that is by far larger than <code>PATH_MAX</code>.  But this only mean that you cannot get there directly from the filesystem root.  You can go there in steps, as much as the system allows you, and depending on where you fix you root directory (by means of the <code>chroot(2)</code> syscall) or your current directory (by means of the <code>chdir(2)</code> syscall)</p>\n<p>probably you have notice (or not) that there's no system call to get your curren working directory path from root... There are several reasons for this:</p>\n<ul>\n<li>root inode and curren working inode are two local-to-process concepts.  Two processes in the same system can have different working directories, and also different root directories, up to the point that they are able to share nothing in common and no way from one's directory to reach the other.</li>\n<li>inode path can be ambiguous.  Well, this is not true for a directory, as it is not allowed two hard links to point to the same directory inode (this was possible in older unices, where directories had to be created with the <code>mknod(2)</code> system call, if you have access to some hp-ux v6 or old Unix SysV R4 you can create directories with a <code>...</code> entry ---pointing to the granparent of a directory or similar things, just being root and knowing how to use the <code>mknod(2)</code> syscall)  The idea is that when two links point to the same inode, which (or both) of then goes to the root, which one is the right path from the root inode to the current dir?</li>\n<li>curren inode and root can be separated by a path far enough to not fit in the <code>PATH_MAX</code> limit.</li>\n<li>there can be several different filesystems (and filesystem types) involved in getting to the root.  So this is not something that can be obtained only knowing the stored data in the disks, you must know the mounting table.</li>\n</ul>\n<p>For these reasons, there's no direct support in the kernel to know the root path to a file.  And also there's no way to get the path (and this is what the <code>pwd(1)</code> command does) than to follow the <code>..</code> entry and get to the parent directory and search there a link that gets to the inode number of the current dir... and repeat this until the parent inode is the same as the last inode visited.  Only then you'll be in the root directory (your root directory, that is different in general of other processes root directories)</p>\n<p>Just try this exercise:</p>\n<pre><code>i=0\nwhile [ &quot;$i&quot; -lt 10000 ]\ndo\n    mkdir dir-$i\n    cd dir-$i\n    i=$(expr &quot;$i&quot; + 1)\ndone\n</code></pre>\n<p>and see how far you can go from the root directory in your hierarchy.</p>\n<h1>NOTE 1</h1>\n<p>Another reason to be impossible to get the path to a file from an open descriptor is that you have access only to the inode (the path you used to <code>open(2)</code> it can have no relationship to the actual root path, as you can use symlinks and relative to the working directory, or changed root dir in between the open call and the time you want to access the path, it can even not exist, as you can have <code>unlink(2)</code>d it)  The inode information has no reference to the path to the inode, as there can be multiple (even millions) paths to a file. In the inode you have only a ref count, which means the number of paths that actually finish on that inode.</p>\n"}], "owner": {"reputation": 956, "user_id": 4656786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a5be255ebdd3021405ce1db4032256?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Kakuev", "link": "https://stackoverflow.com/users/4656786/nikita-kakuev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 4, "answer_count": 2, "score": 7, "last_activity_date": 1477520533, "creation_date": 1477481284, "last_edit_date": 1477520533, "question_id": 40261111, "link": "https://stackoverflow.com/questions/40261111/get-path-from-file-descriptor-when-path-is-longer-than-path-max", "title": "Get path from file descriptor when path is longer than PATH_MAX", "body": "<p>I receive filesystem events from fanotify. Sometimes I want to get an absolute path to a file that's being accessed.</p>\n\n<p>Usually, it's not a problem - <code>fanotify_event_metadata</code> contains a file descriptor <code>fd</code>, so I can call <code>readlink</code> on <code>/proc/self/fd/&lt;fd&gt;</code> and get my path.</p>\n\n<p>However, if a path exceeds <code>PATH_MAX</code> <code>readlink</code> can no longer be used - it fails with <code>ENAMETOOLONG</code>. I'm wondering if there's a way to get a file path in this case.</p>\n\n<p>Obviously, I can <code>fstat</code> the descriptor I get from a fanotify and traverse the entire filesystem looking for files with identical device ID and inode number. But this approach is not feasible for me performance-wise (even if I optimize it to ignore paths shorter than <code>PATH_MAX</code>).</p>\n\n<p>I've tried getting a parent directory by reopening <code>fd</code> with <code>O_PATH</code> and calling <code>openat(fd, \"..\", ...)</code>. Obviously, that failed because <code>fd</code> doesn't refer to a directory. I've also tried examining contents of a buffer after a failed <code>readlink</code> call (hoping it contains partial path). That didn't work either.</p>\n\n<p>So far I've managed to get long paths for files inside the working directory of a process that opened them (fanotify events contain a <code>pid</code> of a target process, so I can read <code>/proc/&lt;pid&gt;/cwd</code> and get the path to the root from there). But that is a partial solution.</p>\n\n<p>Is there a way to get an absolute path from a file descriptor without traversing the whole filesystem? Preferably the one that will work with kernel 2.6.32/glibc 2.11.</p>\n\n<p><em>Update:</em> For the curious. I've figured out why calling <code>readlink(\"/proc/self/fd/&lt;fd&gt;\",  ...</code> with a buffer large enough to store the entire path doesn't work.</p>\n\n<p>Look at the implementation of <a href=\"http://lxr.free-electrons.com/source/fs/proc/base.c#L1599\" rel=\"nofollow\">do_proc_readlink</a>. Notice that it doesn't use provided <code>buffer</code> directly.  Instead, it allocates a single page and uses it as a temporary buffer when it calls <a href=\"http://lxr.free-electrons.com/source/fs/dcache.c#L3236\" rel=\"nofollow\">d_path</a>. In other words, no matter how large is <code>buffer</code>, <code>d_path</code> will always be limited to a size of a page. Which is 4096 bytes on amd64. Same as <code>PATH_MAX</code>! The <code>-ENAMETOOLONG</code> itself is returned by <a href=\"http://lxr.free-electrons.com/source/fs/dcache.c#L2988\" rel=\"nofollow\">prepend</a> when it runs out of mentioned page.</p>\n"}, {"tags": ["c", "bit-manipulation", "motordriver"], "comments": [{"owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 1, "creation_date": 1477480466, "post_id": 40260563, "comment_id": 67782144, "body": "Are you going to have only 4 values or any 4 bit number?"}, {"owner": {"reputation": 306, "user_id": 4198957, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/539942b1b7c7c10c48d79aad9a2a6297?s=128&d=identicon&r=PG&f=1", "display_name": "NT93", "link": "https://stackoverflow.com/users/4198957/nt93"}, "reply_to_user": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 0, "creation_date": 1477480842, "post_id": 40260563, "comment_id": 67782382, "body": "Well controlling the stepper motor using full-steps means that I simply output the above sequence as high/low values on 4 pins I have assigned to it.  Reading the answers below seems to have given me an opportunity to solve it. I&#39;m not quite sure why I didn&#39;t just think of having a set of &#39;X&#39; char values that I just rotate through."}, {"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 0, "creation_date": 1477495583, "post_id": 40260563, "comment_id": 67792901, "body": "<a href=\"http://stackoverflow.com/questions/15648116/bit-shifting-a-character-with-wrap-c\" title=\"bit shifting a character with wrap c\">stackoverflow.com/questions/15648116/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1477480556, "post_id": 40260679, "comment_id": 67782204, "body": "Note that this uses the confusingly-named <code>current_value</code> variable as an index into the table of actual motor values."}], "tags": [], "owner": {"reputation": 2973, "user_id": 70898, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d372a050859d3b70d1f3c10f71d5d5f7?s=128&d=identicon&r=PG", "display_name": "SurDin", "link": "https://stackoverflow.com/users/70898/surdin"}, "is_accepted": false, "score": 3, "last_activity_date": 1477479997, "creation_date": 1477479997, "answer_id": 40260679, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40260679#40260679", "title": "Bitwise rotate right of 4-bit value", "body": "<p>I would make an array with the values you need and load the correct value from the array. It will take you 4 bytes, it will be fast, and solve your problems even if you start using a different motor type.</p>\n\n<pre><code>for example:\nconst char values[4]={1,2,4,8};\nint current_value = 0;\n\n....\n\nif(++current_value&gt;=4)current_value=0;\nmotor = values[current_value];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1477480440, "last_edit_date": 1477480440, "creation_date": 1477480027, "answer_id": 40260689, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40260689#40260689", "title": "Bitwise rotate right of 4-bit value", "body": "<p>Use an 8-bit data type (like e.g. <code>uint8_t</code>). Initialize it to zero. Set the bit you want to set in the lower four bits of the byte (e.g. <code>value = 0x08</code>).</p>\n\n<p>For each \"rotation\" take the LSB (least significant bit) and save it. Shift one step right. Overwrite the fourth bit with the bit you saved.</p>\n\n<p>Something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nuint8_t rotate_one_right(uint8_t value)\n{\n    unsigned saved_bit = value &amp; 1;  // Save the LSB\n    value &gt;&gt;= 1;  // Shift right\n    value |= saved_bit &lt;&lt; 3;  // Make the saved bit the nibble MSB\n    return value;\n}\n\nint main(void)\n{\n    uint8_t value = 0x08;  // Set the high bit in the low nibble\n    printf(\"%02hhx\\n\", value);  // Will print 08\n    value = rotate_one_right(value);\n    printf(\"%02hhx\\n\", value);  // Will print 04\n    value = rotate_one_right(value);\n    printf(\"%02hhx\\n\", value);  // Will print 02\n    value = rotate_one_right(value);\n    printf(\"%02hhx\\n\", value);  // Will print 01\n    value = rotate_one_right(value);\n    printf(\"%02hhx\\n\", value);  // Will print 08 again\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/rVW0Bq\" rel=\"nofollow\">Live demonstration</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 306, "user_id": 4198957, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/539942b1b7c7c10c48d79aad9a2a6297?s=128&d=identicon&r=PG&f=1", "display_name": "NT93", "link": "https://stackoverflow.com/users/4198957/nt93"}, "edited": false, "score": 0, "creation_date": 1477480986, "post_id": 40260693, "comment_id": 67782462, "body": "This seems really nifty - I&#39;ll definitely try that, I just have to wrap my head around how assert works."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 0, "creation_date": 1477492498, "post_id": 40260693, "comment_id": 67790576, "body": "Note well that the other elements of the array still get initialised (which this answer does note), see the GCC docs: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html</a>"}, {"owner": {"reputation": 2392, "user_id": 3517622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2nYKV.gif?s=128&g=1", "display_name": "KevinZ", "link": "https://stackoverflow.com/users/3517622/kevinz"}, "edited": false, "score": 0, "creation_date": 1477503724, "post_id": 40260693, "comment_id": 67797727, "body": "You can get rid of the undefined behavior by doing <code>unsigned char table_right[8] = { 4, 8, 1, 0, 2, 0, 0, 0 };</code>. Then, have the next function do <code>return table_right[current &amp; 7]</code>.  This also makes the table fit in one QWORD."}, {"owner": {"reputation": 44559, "user_id": 411022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9905bf9a7b8d5a587c1bdff07ef2e801?s=128&d=identicon&r=PG", "display_name": "Ilmari Karonen", "link": "https://stackoverflow.com/users/411022/ilmari-karonen"}, "edited": false, "score": 8, "creation_date": 1477510043, "post_id": 40260693, "comment_id": 67801207, "body": "Why on earth would you use a lookup table for this, when there are plenty of trivial arithmetic solutions like <code>next = ((current &amp; 1) &lt;&lt; 3) | (current &gt;&gt; 1)</code>? Not only are you wasting space with the lookup table, but on most systems a memory fetch is likely to be quite a bit slower than a couple of bitwise ops."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 44559, "user_id": 411022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9905bf9a7b8d5a587c1bdff07ef2e801?s=128&d=identicon&r=PG", "display_name": "Ilmari Karonen", "link": "https://stackoverflow.com/users/411022/ilmari-karonen"}, "edited": false, "score": 3, "creation_date": 1477510679, "post_id": 40260693, "comment_id": 67801572, "body": "@IlmariKaronen Thank you for your opinion, that is a valid approach too. Please don&#39;t downvote a correct answer, rather go upvote others that use your approach just as I did, because I found them to be better than mine."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 21, "last_activity_date": 1477511739, "last_edit_date": 1477511739, "creation_date": 1477480036, "answer_id": 40260693, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40260693#40260693", "title": "Bitwise rotate right of 4-bit value", "body": "<p>With only 4 possible values you would use a table with 9 elements: </p>\n\n<pre><code>unsigned char table_right[] = { [0x1] = 0x8 , [0x2] = 0x1 , [0x4] = 0x2 , [0x8] = 0x4 };\n</code></pre>\n\n<p>When you need the next value you simply use the current value as the index:</p>\n\n<pre><code>unsigned char current = 0x4;    //value is: 0b0100\nunsigned char next = table_right[current];  //returns: 0b0010\nassert( next == 0x2 );\n</code></pre>\n\n<p>Doing this in a loop, will loop through all four possible values.</p>\n\n<p>Conveniently, passing an invalid value, will return a zero, so you can write a get function that also asserts next != 0. You should also assert value &lt; 9 before passing the value to the array.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 3, "creation_date": 1477480662, "post_id": 40260777, "comment_id": 67782258, "body": "Please don&#39;t post answer with only code. Try to provide explanation instead."}], "tags": [], "owner": {"reputation": 71, "user_id": 7074275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b09ea841687b0cabe673ddb8d00dc161?s=128&d=identicon&r=PG&f=1", "display_name": "ningwei", "link": "https://stackoverflow.com/users/7074275/ningwei"}, "is_accepted": false, "score": 7, "last_activity_date": 1477481408, "last_edit_date": 1477481408, "creation_date": 1477480316, "answer_id": 40260777, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40260777#40260777", "title": "Bitwise rotate right of 4-bit value", "body": "<p>you can use <code>10001000b</code> and mod <code>10000b</code></p>\n\n<p>and you can get <code>01000100b</code> <code>00100010b</code> <code>00010001b</code> <code>10001000b</code> repeat.</p>\n\n<p>for example:</p>\n\n<pre><code>char x = 0x88;\nMotor_Out(x &amp; 0xf);\nRotate_Right(step, 1);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1477481169, "post_id": 40260823, "comment_id": 67782596, "body": "The down side of this is that if it&#39;s a long running application, stepsIdx++ will eventually result in UB"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 5, "creation_date": 1477481583, "post_id": 40260823, "comment_id": 67782848, "body": "@UKMonkey: no it will not. See that last line that clips <code>stepsIdx</code> into range? (Personally I&#39;d write it as <code>stepsIdx &amp;= 3;</code> but most likely, a good optimizing compiler will do that for you.)"}, {"owner": {"reputation": 4708, "user_id": 667266, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ejOZy.png?s=128&g=1", "display_name": "borisbn", "link": "https://stackoverflow.com/users/667266/borisbn"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1477483870, "post_id": 40260823, "comment_id": 67784240, "body": "@RadLexus: if the next motor will need 5 (or 7) steps, a reminder  operation would be a better idea. And you&#39;re right: let compiler think about speed ))"}, {"owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "edited": false, "score": 2, "creation_date": 1477496281, "post_id": 40260823, "comment_id": 67793349, "body": "and to make it future proof: <code>stepsIdx = stepsIdx % sizeof(steps);</code> (possibly adding a <code>&#47;sizeof(steps[0])</code> if you ever change the type)"}, {"owner": {"reputation": 5071, "user_id": 1124744, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2f7980bcb4c6b1c604cd0f3424f06f84?s=128&d=identicon&r=PG", "display_name": "paulm", "link": "https://stackoverflow.com/users/1124744/paulm"}, "edited": false, "score": 0, "creation_date": 1477570717, "post_id": 40260823, "comment_id": 67827080, "body": "I like _countof even though it isn&#39;t standard instead of sizeof(a) / sizeof(a[0])"}], "tags": [], "owner": {"reputation": 4708, "user_id": 667266, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ejOZy.png?s=128&g=1", "display_name": "borisbn", "link": "https://stackoverflow.com/users/667266/borisbn"}, "is_accepted": false, "score": 8, "last_activity_date": 1477569125, "last_edit_date": 1477569125, "creation_date": 1477480425, "answer_id": 40260823, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40260823#40260823", "title": "Bitwise rotate right of 4-bit value", "body": "<p>IMO the easiest way is:</p>\n\n<pre><code>const unsigned char steps[ 4 ] = { 0x08, 0x04, 0x02, 0x01 };\nint stepsIdx = 0;\n...\nconst unsigned char step = steps[ stepsIdx++ ];\nstepsIdx = stepsIdx % ( sizeof( steps ) / sizeof( steps[ 0 ] ) );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": false, "score": 15, "last_activity_date": 1477480638, "creation_date": 1477480638, "answer_id": 40260907, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40260907#40260907", "title": "Bitwise rotate right of 4-bit value", "body": "<p>Just use an <code>int</code> to hold the value. When you do the rotate copy the least significant bit to bit 4 and then shift it right by 1:</p>\n\n<pre><code>int rotate(int value)\n{\n    value |= ((value &amp; 1) &lt;&lt; 4); // eg 1001 becomes 11001\n    value &gt;&gt;= 1;                 // Now value is 1100\n    return value;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "edited": false, "score": 1, "creation_date": 1477505496, "post_id": 40264780, "comment_id": 67798702, "body": "that <code>4 &gt;&gt; i</code> is surely a typo?"}], "tags": [], "owner": {"reputation": 1369, "user_id": 5771399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c801f6ed43d6b594cfe250a6bf05333?s=128&d=identicon&r=PG&f=1", "display_name": "v7d8dpo4", "link": "https://stackoverflow.com/users/5771399/v7d8dpo4"}, "is_accepted": false, "score": 3, "last_activity_date": 1477540107, "last_edit_date": 1477540107, "creation_date": 1477491584, "answer_id": 40264780, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40264780#40264780", "title": "Bitwise rotate right of 4-bit value", "body": "<p>You only need to output 1, 2, 4, and 8. So you can use a counter to mark which bit to set high.</p>\n\n<pre><code>Motor_Out(8 &gt;&gt; i);\ni = (i + 1) &amp; 3;\n</code></pre>\n\n<p>If you want to drive the motor at half steps, you can use an array to store the numbers you need.</p>\n\n<pre><code>const unsigned char out[] = {0x8, 0xc, 0x4, 0x6, 0x2, 0x3, 0x1, 0x9};\n\nMotor_out(out[i]);\ni = (i + 1) &amp; 7;\n</code></pre>\n\n<p>And you can rotate a 4-bit integer like this.</p>\n\n<pre><code>((i * 0x11) &gt;&gt; 1) &amp; 0xf\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477499117, "post_id": 40266999, "comment_id": 67795193, "body": "This is a nice solution, but using a table is just two mov instructions."}, {"owner": {"reputation": 2392, "user_id": 3517622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2nYKV.gif?s=128&g=1", "display_name": "KevinZ", "link": "https://stackoverflow.com/users/3517622/kevinz"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477504062, "post_id": 40266999, "comment_id": 67797936, "body": "@2501 I like your table approach too.  And in theory yours could be pretty compact (see my comment on your solution), but have you actually looked at the generated assembly?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477505426, "post_id": 40266999, "comment_id": 67798656, "body": "Yes, using unsigned type generates two mov<i>s</i>"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1477559868, "post_id": 40266999, "comment_id": 67820016, "body": "It&#39;s tagged as C, C doesn&#39;t have <code>constexpr</code>."}, {"owner": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477564460, "post_id": 40266999, "comment_id": 67822893, "body": "@2501: two <code>mov</code>s <i>and</i> a table, which is not shorter and also not necessarily faster than these pure arithmetic instructions. But it makes no sense to look at this function in isolation, it\u2019ll get inlined into the caller\u2019s context, usually."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 0, "creation_date": 1477564531, "post_id": 40266999, "comment_id": 67822941, "body": "@Holger Table is static. It is true that a mov might be slower due to cache effects. When did I comment about the entire function in isolation?"}, {"owner": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477565319, "post_id": 40266999, "comment_id": 67823453, "body": "@2501: the five instructions mentioned in this answer are from compiling this function in isolation. If you\u2019re not comparing with them, with what are you comparing otherwise? Of course, <i>your</i> two <code>mov</code> instructions are not from looking at a function, otherwise, there was a <code>ret</code> instruction too. After inlining, the optimizer may reduce the remaining four instruction to less. Ironically, if inlined to an unrolled loop, a straight-forward <code>x&gt;&gt;=1; if(!x) x=8;</code> implementation might benefit even better from an optimizer\u2019s prediction, to a net result of a single arithmetic instruction."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 239210, "user_id": 2711488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhkI9.jpg?s=128&g=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/2711488/holger"}, "edited": false, "score": 0, "creation_date": 1477565609, "post_id": 40266999, "comment_id": 67823650, "body": "@Holger I simply stated that a table is two instructions and complemented the answer. Your argument is a strawman."}], "tags": [], "owner": {"reputation": 2392, "user_id": 3517622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2nYKV.gif?s=128&g=1", "display_name": "KevinZ", "link": "https://stackoverflow.com/users/3517622/kevinz"}, "is_accepted": true, "score": 10, "last_activity_date": 1477497585, "creation_date": 1477497585, "answer_id": 40266999, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40266999#40266999", "title": "Bitwise rotate right of 4-bit value", "body": "<p>The arithmetic for this is simple enough that it will always be faster than the table approach:</p>\n\n<pre><code>constexpr unsigned rotate_right_4bit ( unsigned value )\n{\n    return ( value &gt;&gt; 1 ) | ( ( value &lt;&lt; 3 ) &amp; 15 );\n}\n</code></pre>\n\n<p>This turns into 5 lines of branch-free x86 assembly:</p>\n\n<pre><code>lea     eax, [0+rdi*8]\nshr     edi\nand     eax, 15\nor      eax, edi\nret\n</code></pre>\n\n<p>Or, alternatively, if you actually like to see the indexes <code>{3, 2, 1, 0}</code>, then you can split them up into 2 functions, one that \"increments\" the index, and the other that actually computes the value:</p>\n\n<pre><code>constexpr unsigned decrement_mod4 ( unsigned index )\n{\n    return ( index - 1 ) &amp; 3;\n}\n\nconstexpr unsigned project ( unsigned index )\n{\n    return 1u &lt;&lt; index;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "is_accepted": false, "score": 7, "last_activity_date": 1477510107, "last_edit_date": 1477510107, "creation_date": 1477505000, "answer_id": 40269218, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value/40269218#40269218", "title": "Bitwise rotate right of 4-bit value", "body": "<blockquote>\n  <p>if I use an 8-bit unsigned int I will eventually rotate the 1 off to the MSB</p>\n</blockquote>\n\n<p>So use a shift and reinitialize the bit you want when the value goes to zero. C doesn't have a rotate operation anyway, so you'll have to do at least two shifts. (And I suppose C++ doesn't have rotates either.)</p>\n\n<pre><code>x &gt;&gt;= 1;\nif (! x) x = 0x08;\n</code></pre>\n\n<p>Simple, short to write, and obvious in what it does. Yes, it'll compile into a branch (unless the processor has a conditional move operation), but until you have the profiler output to tell you it's important, you just lost more time thinking about it than those processor cycles will ever amount to.</p>\n"}], "owner": {"reputation": 306, "user_id": 4198957, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/539942b1b7c7c10c48d79aad9a2a6297?s=128&d=identicon&r=PG&f=1", "display_name": "NT93", "link": "https://stackoverflow.com/users/4198957/nt93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3093, "favorite_count": 1, "accepted_answer_id": 40266999, "answer_count": 9, "score": 23, "last_activity_date": 1477569125, "creation_date": 1477479693, "last_edit_date": 1477557895, "question_id": 40260563, "link": "https://stackoverflow.com/questions/40260563/bitwise-rotate-right-of-4-bit-value", "title": "Bitwise rotate right of 4-bit value", "body": "<p>I'm currently trying to control a stepper motor using simple full steps. This means that I'm currently outputting a sequence of values like this:</p>\n\n<pre><code>1000\n0100\n0010\n0001\n</code></pre>\n\n<p>I thought an easy way to do this was just take my 4-bit value and after each step, perform a rotate right operation. \"Code\" obviously isn't following any kind of syntax, it's simply there to illustrate my thoughts:</p>\n\n<pre><code>step = 1000;\n//Looping\nMotor_Out(step)\n//Rotate my step variable right by 1 bit\nRotate_Right(step, 1)\n</code></pre>\n\n<p>My problem is that there obviously isn't any 4-bit simple data types that I can use for this, and if I use an 8-bit unsigned int I will eventually rotate the 1 off to the MSB, which means the 4-bit value I'm actually interested in, will turn into 0000 for a few steps.</p>\n\n<p>I've read that you can use structs and bit-fields to solve this, but the majority of things I read from this is telling me that it's a very bad idea.</p>\n"}, {"tags": ["c", "function", "pointers", "struct", "function-calls"], "comments": [{"owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "edited": false, "score": 1, "creation_date": 1477479686, "post_id": 40260484, "comment_id": 67781614, "body": "C does not directly support partial function application, as far as I know :) However, you can prepare a function which allocate a new structure and prepare a function using this structure... However, it&#39;d be a nightmare to maintain"}, {"owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 0, "creation_date": 1477479972, "post_id": 40260484, "comment_id": 67781803, "body": "You cannot change function pointer&#39;s arguments once you declare it. You can do one thing, Delcare function pointer with variable number of arguments and then declare ALL your functions which you will assign to it with variable number of arguments and  then you can do what you want. I never did such thing... This tutorial might help -- <a href=\"http://www.cprogramming.com/tutorial/c/lesson17.html\" rel=\"nofollow noreferrer\">cprogramming.com/tutorial/c/lesson17.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1477480077, "post_id": 40260557, "comment_id": 67781881, "body": "@user694733 Gibberish. :) I missed a &quot;&#39;t&quot;, it should have been &quot;can&#39;t&quot; there in the beginning. Thanks, and fixed of course."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1477480048, "last_edit_date": 1477480048, "creation_date": 1477479680, "answer_id": 40260557, "question_id": 40260484, "link": "https://stackoverflow.com/questions/40260484/assign-member-c-function-pointer-with-another-member-as-default-argument/40260557#40260557", "title": "assign member C function pointer with another member as default argument", "body": "<p>No, you can't do closures like that in C.</p>\n\n<p>You also can't run-time define functions, since C is a compiled language where the compiler is not available when the code runs.</p>\n"}, {"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1477480768, "post_id": 40260841, "comment_id": 67782322, "body": "<code>MULTIPLY* m = {2, product}</code> is incorrect: you&#39;re assinging a struct to a pointer variable. It should be <code>struct MULTIPLY m = {2, product};</code>. Also: the <code>struct MULTIPLY</code> is not <code>typedef</code>&#39;ed, so it has to be  <code>struct MULTIPLY</code>"}, {"owner": {"reputation": 25, "user_id": 4919709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ed0dc3ff69ec2b8f821d042227bc4d?s=128&d=identicon&r=PG&f=1", "display_name": "ralux", "link": "https://stackoverflow.com/users/4919709/ralux"}, "edited": false, "score": 0, "creation_date": 1477565387, "post_id": 40260841, "comment_id": 67823504, "body": "Thanks, probably this is the best solution at the moment. Was trying to avoid passing pointers around, because the code <i>call(m, 5); // actual call</i> would be in a lib that I don&#39;t want to have access to my program&#39;s variables. But for now, this should be good enough."}, {"owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "reply_to_user": {"reputation": 25, "user_id": 4919709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ed0dc3ff69ec2b8f821d042227bc4d?s=128&d=identicon&r=PG&f=1", "display_name": "ralux", "link": "https://stackoverflow.com/users/4919709/ralux"}, "edited": false, "score": 0, "creation_date": 1477574139, "post_id": 40260841, "comment_id": 67829473, "body": "@ralux if you don&#39;t want <code>call</code> to access your variables you can use some pointer casting from your structure to structure exposed by <code>call</code> module, which would be first member of your structure (again, simulating OO-design - it&#39;d be something like subclassing)"}], "tags": [], "owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1477480795, "last_edit_date": 1477480795, "creation_date": 1477480469, "answer_id": 40260841, "question_id": 40260484, "link": "https://stackoverflow.com/questions/40260484/assign-member-c-function-pointer-with-another-member-as-default-argument/40260841#40260841", "title": "assign member C function pointer with another member as default argument", "body": "<p>Generally C does not support partial function application, and you need all signatures and names set up in compilation time, and functions generally cannot be defined in runtime (kernel can load them, but let's ignore it - userspace apps don't do it). However...</p>\n\n<p><em>On some level of abstraction</em> this is possible (e.g. many interpreters written in C allow that), but for pure C it's not directly possible and, if you need to do it, you probably picked up a wrong language. </p>\n\n<p>You can work around it by using an emulation of object-oriented approach (always passing another argument as <code>this</code> pointer). Pseudocode:</p>\n\n<pre><code>struct MULTIPLY{\n   int by;            //some factor to multiply, can be seen as instance id/key\n\n   // intended private\n   int (*f)(int, int);\n} multiply;\n\nint call(MULTIPLY m, int i) {\n  return *(m.f)(by, i);\n}\n\nMULTIPLY m = {2, product} // + allocation etc.;\ncall(m, 5); // actual call\n</code></pre>\n\n<p>It's much nicer in languages which really support object-oriented design, but you can do it in C as well - still, you need to remember about this additional argument (<code>this</code>, <code>context</code>, <code>self</code> or however you want to call it), which kinda messes up the code.</p>\n\n<p>If you're ultra-determined to do it without any additional arguments, you can make a global <code>MULTIPLY</code> instance and use it from <code>call</code>. This would be something like:</p>\n\n<pre><code>// global scope!\nMULTIPLY m;\nint call(int i) {\n    return *(m.f)(m.by, i);\n}\n\n// m initialization etc.\n// some stuff happening\ncall(5);\n</code></pre>\n\n<p>But please, don't. It'll be ultra-hard to maintain, because of the global binding. Plus, it won't work exactly as a closure - once you change value in <code>m</code>, all places where you've passed <code>call</code> will start to behave differently (previous, object oriented approach will work properly everywhere).</p>\n"}], "owner": {"reputation": 25, "user_id": 4919709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ed0dc3ff69ec2b8f821d042227bc4d?s=128&d=identicon&r=PG&f=1", "display_name": "ralux", "link": "https://stackoverflow.com/users/4919709/ralux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 40260841, "answer_count": 2, "score": 0, "last_activity_date": 1477563518, "creation_date": 1477479490, "last_edit_date": 1495535654, "question_id": 40260484, "link": "https://stackoverflow.com/questions/40260484/assign-member-c-function-pointer-with-another-member-as-default-argument", "title": "assign member C function pointer with another member as default argument", "body": "<p>Let's say I have a C struct</p>\n\n<pre><code>struct MULTIPLY{\n   int by;            //some factor to multiply, can be seen as instance id/key\n   int (*get)(int c); //the function that actually returns the result\n} multiply;\n</code></pre>\n\n<p>and that I want to assign the <em>multiply</em> instance using the following function</p>\n\n<pre><code>int product(int a, int b)\n{\n    return a*b;\n}\n</code></pre>\n\n<p>In main I would like  to assign to <em>multiply->get</em> a function that computes  the product of <em>multiply->by</em> and a new argument. I could do this by passing a pointer to the multiply instance, but I wonder if there is any way to call it without changing the signature of <em>get</em> function</p>\n\n<pre><code>multiply-&gt;by = 2;\nmultiply-&gt;get(int c) = product(multiply-&gt;by, c); ???\n\nmultiply-&gt;get(5); // 10\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>EDIT: </p>\n\n<p>Thanks for the answers. Indeed, by default there's no way to do closures in C. I was looking for a workaround. I found 2 solutions but are quite limited. One is Blocks.h (also works with obj-C) needs to be compiled with Clang. The other is FFCALL (<a href=\"http://www.haible.de/bruno/packages-ffcall-README.html\" rel=\"nofollow noreferrer\">http://www.haible.de/bruno/packages-ffcall-README.html</a> ), which is limited to some processor architectures. </p>\n\n<p>So, in my case, I decided to just pass some pointers around to access the id (by, in this example). Pretty much what <a href=\"https://stackoverflow.com/users/2671214/tomasz-lewowski\">Tomasz Lewowski</a> suggested.</p>\n"}, {"tags": ["c", "enums"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 3, "creation_date": 1477477648, "post_id": 40259768, "comment_id": 67780364, "body": "If we think of a way to do this, it would be more complicated than writing out the numbers yourself."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1477477722, "post_id": 40259768, "comment_id": 67780425, "body": "C doesn&#39;t have custom stepping of enumeration values. It&#39;s either plus one, or whatever value you explicitly set it to."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 4, "last_activity_date": 1477477688, "creation_date": 1477477688, "answer_id": 40259815, "question_id": 40259768, "link": "https://stackoverflow.com/questions/40259768/incrementing-enum-values-by-a-fixed-number-in-c/40259815#40259815", "title": "Incrementing enum values by a fixed number in C", "body": "<p>No, there's no such support in the language.</p>\n\n<p>You might be able to do something more or less horrible using macros of course. I think the whole \"automatically\" part is troublesome, but people can come up with the most troublesome preprocessor constructs when motivated enough.</p>\n"}, {"comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1477480919, "post_id": 40260475, "comment_id": 67782428, "body": "This will not work if <code>VALA</code> or <code>VALB</code> is removed by <code>#ifdef</code>"}, {"owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1477481325, "post_id": 40260475, "comment_id": 67782702, "body": "@RishikeshRaje Yes.. Updated the answer"}], "tags": [], "owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "is_accepted": false, "score": 0, "last_activity_date": 1477481299, "last_edit_date": 1477481299, "creation_date": 1477479473, "answer_id": 40260475, "question_id": 40259768, "link": "https://stackoverflow.com/questions/40259768/incrementing-enum-values-by-a-fixed-number-in-c/40260475#40260475", "title": "Incrementing enum values by a fixed number in C", "body": "<p>Enums are very similar to <code>#define</code>. One of the advantage is that they make code readable. Instead of Magic numbers spread across the code, It's better to have a name for the number.</p>\n\n<p>For the compiler, it will just replace the name with the associated number during it's operation.</p>\n\n<p>There's no such option to \"Auto-increment\" by fixed number, you can follow this approach:</p>\n\n<pre><code>#define INCREMENT_ENUM_BY_NUM    4\n\ntypedef enum {\n    VAL_A = 0 + INCREMENT_ENUM_BY_NUM,\n    VAL_B = VAL_A + INCREMENT_ENUM_BY_NUM,\n    VAL_C = VAL_B + INCREMENT_ENUM_BY_NUM,\n}ENUM_X;\n</code></pre>\n\n<p>This is useful if your Enum values are change frequently. But as with your 2nd part with <code>#ifdef</code>, this won't be feasible as you have to change the code everytime.</p>\n\n<p>We had a case where some enums were changed as per customer requirement. So change those enum, build and deliver. There, this apporach was useful. \nBut in general, This is better -- </p>\n\n<pre><code>typedef enum {\n    VAL_A = 4,\n    VAL_B = 8,\n    VAL_C = 12\n}ENUM_X;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1477481790, "last_edit_date": 1477481790, "creation_date": 1477481260, "answer_id": 40261100, "question_id": 40259768, "link": "https://stackoverflow.com/questions/40259768/incrementing-enum-values-by-a-fixed-number-in-c/40261100#40261100", "title": "Incrementing enum values by a fixed number in C", "body": "<p>Here is a solution. This will work even if only one of the 3 enums is defined.</p>\n\n<pre><code>#define INCREMENT_VALUE 4\n#define VALUE 4\n#define VALTEMP 4\n\n#define INCR_OPERATION   \\\n    #undef VALTEMP  \\\n    #define VALTEMP VALUE \\\n    #undef VALUE \\\n    #define VALUE (VALTEMP+ INCREMENT_VALUE) \\\n\n\ntypedef enum {\n    #ifdef A\n    VAL_A = VALUE,\n    INCR_OPERATION\n    #endif\n\n    #ifdef B\n    VAL_B = VALUE,\n    INCR_OPERATION\n    #endif\n\n    #ifdef C\n    VAL_C = VALUE,\n    INCR_OPERATION\n    #endif\n\n    VAL_END = VALUE\n}ENUM_X;\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 2780015, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/k55aI.jpg?s=128&g=1", "display_name": "rango", "link": "https://stackoverflow.com/users/2780015/rango"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1652, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1477481790, "creation_date": 1477477552, "question_id": 40259768, "link": "https://stackoverflow.com/questions/40259768/incrementing-enum-values-by-a-fixed-number-in-c", "title": "Incrementing enum values by a fixed number in C", "body": "<p>Is it possible to increment the values of fields of an enum by a fixed number?</p>\n\n<p>Say if I have an enum</p>\n\n<pre><code>typedef enum {\n    VAL_A,\n    VAL_B,\n    VAL_C\n}ENUM_X;\n</code></pre>\n\n<p>I want to define the enum in such a way that the values may increment by a fixed number (other than 1 which is default).  This would result in me having (let's say number is 4)</p>\n\n<pre><code>VAL_A = 4; VAL_B = 8; VAL_C = 12;\n</code></pre>\n\n<p>Also if the above answer is true, and there is any such mechanism, is it possible to make the values increment sequentially?</p>\n\n<p>Say I've the same enum redefined as </p>\n\n<pre><code>typedef enum {\n    #ifdef A\n    VAL_A,\n    #endif\n\n    #ifdef B\n    VAL_B,\n    #endif\n\n    #ifdef C\n    VAL_C,\n    #endif\n\n    VAL_END\n}ENUM_X;\n</code></pre>\n\n<p>And if for the above enum I define A and C, I should get</p>\n\n<pre><code>VAL_A = 4; VAL_C = 8;\n</code></pre>\n\n<p>But if I define only B and C, I should get</p>\n\n<pre><code>VAL_B = 4; VAL_C = 8;\n</code></pre>\n\n<p>And if I define all A, B and C, I should get</p>\n\n<pre><code>VAL_A = 4; VAL_B = 8; VAL_C = 12;\n</code></pre>\n"}, {"tags": ["c", "string", "scanf", "fgets", "gets"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6450828"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1477478578, "post_id": 40259687, "comment_id": 67780917, "body": "what do you mean by new line and where&#39;s that new line coming from?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6450828"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1477479081, "post_id": 40259687, "comment_id": 67781239, "body": "and only scanf() is working in add_diary()"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 6949091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pFNKs.png?s=128&g=1", "display_name": "Chapo", "link": "https://stackoverflow.com/users/6949091/chapo"}, "is_accepted": false, "score": 0, "last_activity_date": 1477486273, "creation_date": 1477486273, "answer_id": 40262798, "question_id": 40259687, "link": "https://stackoverflow.com/questions/40259687/cant-take-input-in-a-string/40262798#40262798", "title": "Can&#39;t take input in a string", "body": "<p>From my understanding this is how scanf works:</p>\n\n<p>Let's say you have them input \"Hello World\", what is actually brought in is \"Hello World\\n\". You can work around this by selecting n-1 in the array ('\\n') and replace it with a terminating ('\\o').</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6450828"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477486273, "creation_date": 1477477331, "question_id": 40259687, "link": "https://stackoverflow.com/questions/40259687/cant-take-input-in-a-string", "title": "Can&#39;t take input in a string", "body": "<p>In this program, I'm not able to get input in string c[] (in add_diary() ) by using fgets() or gets(), the program just skips the input process, please tell me what am I doing wrong. I just can't get it started. In a diary the most important thing is to write and the thing is 'you can't write, cuz fgets() isn't working'.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid access();\nvoid diary_main(char user[],char pass[]);\nvoid diary_login();\nvoid add_diary(unsigned dd, unsigned mm, unsigned yy);\nvoid add_entry(unsigned choice);\nvoid del_entry(unsigned dd, unsigned mm, unsigned yy);\nvoid update_entry(unsigned dd, unsigned mm, unsigned yy);\nvoid logout();\n\nvoid main() {\n    access();\n}\n\nvoid access() {\n    char password[10],username[20], ch;\n    int i;\n    printf(\"Enter User name: \");\n    gets(username);\n    printf(\"Enter the password (8 characters):\");\n    for(i=0;i&lt;8;i++) {\n            ch = getch();\n            password[i] = ch;\n            ch = '*' ;\n            printf(\"%c\", ch);\n     }\n     password[i] = '\\0';\n     /*printf(\"\\nYour password is :\");\n     for(i=0;i&lt;8;i++) {\n    printf(\"%c\", password[i]);*/\n    diary_main(username, password);\n}\n\nvoid diary_main(char user[],char pass[]) {\n    /*FILE *fptr;\n    //char file_name[10];\n    //sprintf(file_name, \"user%s.txt\", user);\n    fptr = fopen(\"login.txt\", \"w\");\n    fprintf(fptr,\"\\n%s\",user);\n    fclose(fptr);*/\n    diary_login();\n}\n\nvoid diary_login() {\n    unsigned choice;\n    printf(\"\\nEnter your choice\\n\");\n    printf(\"1. Add Diary Entry\\n\");\n    printf(\"2. Delete Diary Entry\\n\");\n    printf(\"3. Update Diary Entry\\n\");\n    printf(\"4. Logout\\n\");\n    printf(\"5. Exit\\n\");\n    scanf(\"%d\", &amp;choice);\n    if (choice == 1) {\n        add_entry(choice);\n    }\n    else if (choice == 2) {\n        add_entry(choice);\n    }\n    else if (choice == 3) {\n        add_entry(choice);\n    }\n    else if (choice == 4) {\n        logout();\n    }\n    else if (choice == 5) {\n        exit(1);\n    }\n    else {\n        //printf(\"%d\", choice);\n        printf(\"Enter correct choice\");\n        diary_login();\n    }\n}\n\nvoid add_entry(unsigned choice) {\n    unsigned dd, mm, yy;\n    printf(\"Enter date (DD/MM/YY):\");\n    scanf(\"%u/%u/%u\", &amp;dd, &amp;mm, &amp;yy);\n    //printf(\"%u/%u/%u\", dd, mm, yy);\n    if ((dd&gt;31 || mm&gt;12) || (dd&gt;29 &amp;&amp; mm == 2) || (yy!=17)) {\n        printf(\"\\nEnter correct date\\n\");\n        add_entry(choice);\n    }\n    else {\n        //printf(\"else\");\n        switch(choice) {\n            case 1: add_diary(dd, mm, yy);\n                    break;\n            case 2: del_entry(dd, mm, yy);\n                    break;\n            case 3: update_entry(dd, mm, yy);\n                    break;\n        }\n    }\n}\n\nvoid add_diary(unsigned dd, unsigned mm, unsigned yy) {\n    //printf(\"add_diary\");\n    long file_extra;\n    char file_name[50], c[5000];\n    FILE *fptr;\n    file_extra = (((dd*100)+mm)*100)+yy;\n    sprintf(file_name, \"diary%ld.txt\", file_extra);\n    fptr = fopen(file_name, \"w\");\n    /*if(fptr == NULL){\n       printf(\"Error\");\n       exit(1);\n    }*/\n    printf(\"\\nStart writing diary..\\n\");\n    scanf(\"%s\", c);\n    //fgets(c, sizeof(c), stdin);\n    //gets(c);\n    fprintf(fptr,\"%s\",c);\n    fclose(fptr);\n}\n\nvoid del_entry(unsigned dd, unsigned mm, unsigned yy) {\n     long file_extra;\n     char file_name[50];\n     file_extra = (((dd*100)+mm)*100)+yy;\n     sprintf(file_name, \"diary%ld.txt\", file_extra);\n     int status;\n     status = remove(file_name);\n     if( status == 0 ) {\n        printf(\"Entry deleted successfully.\\n\");\n     }\n     else {\n        printf(\"Unable to delete the file\\n\");\n    }\n}\nvoid update_entry(unsigned dd, unsigned mm, unsigned yy) {\n    long file_extra;\n    char file_name[50], c[5000];\n    file_extra = (((dd*100)+mm)*100)+yy;\n    sprintf(file_name, \"diary%ld.txt\", file_extra);\n    FILE *fptr;\n    fptr = fopen(file_name, \"w\");\n    printf(\"\\nStart editing diary..\\n\");\n    scanf(\"%s\", c);\n    //fgets(c, sizeof(c), stdin);\n    //gets(c);\n    fprintf(fptr,\"%s\",c);\n    fclose(fptr);\n}\nvoid logout(){\n\n}\n</code></pre>\n"}, {"tags": ["c", "vb.net", "encryption", "des", "3des"], "comments": [{"owner": {"reputation": 1613, "user_id": 162313, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/298ba5e3e7f636656efc5493a1a51e39?s=128&d=identicon&r=PG", "display_name": "MarkL", "link": "https://stackoverflow.com/users/162313/markl"}, "edited": false, "score": 1, "creation_date": 1477476474, "post_id": 40258914, "comment_id": 67779656, "body": "Your key above is 8 bytes long.  I&#39;m not familiar with that web site, but it would appear that the key you input there was a long(ish?) integer.  Try using a hex key of 0102030405060708 on that web site."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1477488452, "post_id": 40258914, "comment_id": 67787534, "body": "3DES should not be used in new work, it is not secure enough, use AES."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4566187, "user_type": "registered", "profile_image": "https://graph.facebook.com/749409511839630/picture?type=large", "display_name": "M Aoun", "link": "https://stackoverflow.com/users/4566187/m-aoun"}, "edited": false, "score": 0, "creation_date": 1478538773, "post_id": 40260085, "comment_id": 68185892, "body": "The key can be specified as text, but turns out i was using classic DES. Had so much issues with thr initial vector but got it to work eventually. Cheers and thanks!"}], "tags": [], "owner": {"reputation": 834, "user_id": 3169277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bb1594eb0c9b20a84b5ad02665c705b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Goodfellow", "link": "https://stackoverflow.com/users/3169277/tom-goodfellow"}, "is_accepted": true, "score": 0, "last_activity_date": 1477478438, "creation_date": 1477478438, "answer_id": 40260085, "question_id": 40258914, "link": "https://stackoverflow.com/questions/40258914/vb-unable-to-retrieve-string-after-3des-encryption/40260085#40260085", "title": "VB Unable to retrieve string after 3DES encryption", "body": "<p>A good idea to test your crypto against some other \"oracle\". But two issues apparent with your use of the online tool:</p>\n\n<ul>\n<li>the key should be given as hex not text (the VB code has a byte array). Presumably 0102030405060708</li>\n<li>3DES is the algorithm, but the VB code uses classic DES - there's a separate TripleDESCryptoServiceProvider for 3DES</li>\n</ul>\n\n<p>However that site gives me the same encrypted text for both DES and 3DES, so it may not be a reliable oracle anyway? Try another, but may need to use a plain text key (first two I looked at didn't offer hex input in any obvious way)</p>\n"}], "owner": {"reputation": 11, "user_id": 4566187, "user_type": "registered", "profile_image": "https://graph.facebook.com/749409511839630/picture?type=large", "display_name": "M Aoun", "link": "https://stackoverflow.com/users/4566187/m-aoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 40260085, "answer_count": 1, "score": -1, "last_activity_date": 1477478438, "creation_date": 1477475212, "question_id": 40258914, "link": "https://stackoverflow.com/questions/40258914/vb-unable-to-retrieve-string-after-3des-encryption", "title": "VB Unable to retrieve string after 3DES encryption", "body": "<p>Initial conditions:</p>\n\n<pre><code>Private TheKey() As Byte = {1, 2, 3, 4, 5, 6, 7, 8}\nPrivate Vector() As Byte = {&amp;H7C, &amp;H22, &amp;H2F, &amp;HB2, &amp;H92, &amp;H7D, &amp;H82, &amp;H8A}\n</code></pre>\n\n<p>I then proceed to encrypt the string: \"asd\" (without quotations) using:</p>\n\n<pre><code>CryptoStream(ms, des.CreateEncryptor(TheKey, Vector), CryptoStreamMode.Write)\n</code></pre>\n\n<p><strong>input: asd<br>\noutput: 82804AD2B295E9E3</strong></p>\n\n<p>When i try to encrypt the same string with the same key/vector on <a href=\"http://tripledes.online-domain-tools.com/\" rel=\"nofollow\">http://tripledes.online-domain-tools.com/</a> as shown below (can't post image due to reputation):</p>\n\n<p><a href=\"https://i.stack.imgur.com/hIB4r.png\" rel=\"nofollow\">online 3DES encryption</a></p>\n\n<p>I get a different result.</p>\n\n<p>My ultimate goal is to have this output decrypted in a C application. But two 3DES encryptors giving 2 different results is a show stopper.. Any thoughts about what could be causing this ?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "c", "linux", "debugging", "gcc"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1477477717, "post_id": 40258579, "comment_id": 67780423, "body": "Why are you using a 64 bit debugger to debug a 32-bit executable, or vice versa?"}, {"owner": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1477479958, "post_id": 40258579, "comment_id": 67781795, "body": "I am building a generic debugger which supports both 32 - bit &amp; 64 - bit at the same time and 64 - bit programs are working fine only 32 - bit once are causing trouble."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1477480571, "post_id": 40258579, "comment_id": 67782208, "body": "Yeah, okay.   Problem is that <code>sizeof</code> for most types (<code>int</code>, structs, etc) is actually independent of whether the executable is 32-bit or 64-bit.   You either need to build your debugger with assumed (or hard-coded) knowledge about how each compiler works, or somehow coerce each compiler to put information about <code>sizeof</code> for various types into the executable (e.g. as part of debugging information that the compiler outputs for use by the debugger).  The former potentially breaks if a compiler is updated.  The latter - even if possible - means you need to read your compiler documentation."}, {"owner": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1477487150, "post_id": 40258579, "comment_id": 67786522, "body": "Very True... The problem is mainly with pointer types that is architecture dependent. Hard coding will not make my debugger robust and the later option though possible still is difficult especially in case of large structure which has numerous members each of which further may be a structure itself and also holds pointers in different locations, parsing through them all is hectic. That is the reason I am looking for a flexible sizeof operator which returns result according to user requirement."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1477493389, "post_id": 40258579, "comment_id": 67791292, "body": "You need more than <code>sizeof</code> for each target architecture; you also need <code>offsetof</code>. Summing the sizes of each member of a struct won&#39;t get you the correct offset, because there&#39;s also padding issues. The compiler will place all this info in the executable if you give gcc the <code>-g</code> option. <a href=\"https://sourceforge.net/projects/libdwarf/\" rel=\"nofollow noreferrer\">libdwarf</a> will help you read that info."}], "owner": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1477474312, "creation_date": 1477474312, "question_id": 40258579, "link": "https://stackoverflow.com/questions/40258579/c-implement-sizeof-32-and-sizeof-64-for-32-bit-and-64-bit-compilations", "title": "C : Implement sizeof_32() and sizeof_64() for 32 - bit and 64 - bit compilations", "body": "<p>I am building a custom debugger compiled as 64 - bit (<code>cc -q64 ...</code>) which can attach to both 32 - bit and 64 - bit executables and peep into memory segments. I am facing the following scenario:</p>\n\n<p><code>a.h</code>:</p>\n\n<pre><code>struct dll{\n    void *nxt;\n    void *prev;\n};\n\nstruct obj{\n    struct dll link;\n    int unique_id;    //Unique id to find this structure in the stack or data area\n    ...    //Some more members\n};\n</code></pre>\n\n<p><code>a.c</code>:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include\"a.h\"\n\nstruct obj ob1;\n\nmain(){\n    struct obj ob 2;\n    ob1.id = 0x189acf;\n    ob2.id = 0x98bdac;\n    while(1);\n}\n</code></pre>\n\n<p><code>debug.c</code>:</p>\n\n<pre><code>#include\"a.h\"\n\nmain(){\n    //attaching toprocess a.c\n    //peeping into stack area to find 0x98bdac found at address1\n    //Peeping into data area to find 0x189acf found at address2\n    //Using address1 - sizeof(struct dll) trying to reach the begining of obj1\n    //Using address2 - sizeof(struct dll) trying to reach the begining of obj2\n}\n</code></pre>\n\n<p>The problem encountering is:\n    When a.c is compiled in 32 - bit mode the size of <code>struct dll</code> is 4+4= 8 bytes but in the debuger (always a 64 - bit) finds size of <code>struct dll</code> 8+8 = 16 bytes thus in the debugger doing <code>adress1 - sizeof(struct dll)</code>  takes me off course by 8 bytes from begining of ob1 &amp; similar for ob2.\n    I have lot of such structures declared in <code>a.h</code> which have several members of data a well as pointers and sub-structures which makes it infeasible to calculate structure sizes by individually finding out sizes of each member and summing it to find total struct size.</p>\n\n<p>I am looking for an implementation of a method sizeof_32() and sizeof_64() which would calculate size of the structures as per 32 - bit and 64 - bit.</p>\n\n<p>Thanks...</p>\n"}, {"tags": ["c", "embedded", "xilinx", "zynq"], "answers": [{"tags": [], "owner": {"reputation": 648, "user_id": 2859410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/834e0b28fb94afe36b0c9ea6d2745e21?s=128&d=identicon&r=PG", "display_name": "igorauad", "link": "https://stackoverflow.com/users/2859410/igorauad"}, "is_accepted": true, "score": 1, "last_activity_date": 1485470355, "creation_date": 1485470355, "answer_id": 41884256, "question_id": 40258402, "link": "https://stackoverflow.com/questions/40258402/ethernet-driver-implementation-in-zynq-in-bare-metal/41884256#41884256", "title": "Ethernet driver implementation in zynq in bare metal", "body": "<p>You can successfully transmit frames using the example application with the Zybo board by simply introducing a wait of the auto-negotiation completion. Check Step 4 of Section 16.3.4 (\"Configure the PHY\") in the ZYNQ manual.</p>\n\n<p>One additional thing to notice is that the example application was probably written for another PHY. By looking at the PHY registers that are configured within the Ethernet initialization, I assume it is the Marvell PHY of the ZC706 board.</p>\n\n<p>I have written a detailed tutorial about using the Ethernet interface in the Zybo board. I recommend you to check it at: <a href=\"http://igorfreire.com.br/zynq-ethernet-interface-zybo-board/\" rel=\"nofollow noreferrer\">http://igorfreire.com.br/zynq-ethernet-interface-zybo-board/</a></p>\n"}], "owner": {"reputation": 67, "user_id": 6885713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-yBihup7UDEI/AAAAAAAAAAI/AAAAAAAAABc/Va-zeyukjCI/photo.jpg?sz=128", "display_name": "Govindh", "link": "https://stackoverflow.com/users/6885713/govindh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2088, "favorite_count": 0, "accepted_answer_id": 41884256, "answer_count": 1, "score": 0, "last_activity_date": 1485470355, "creation_date": 1477473799, "last_edit_date": 1477559911, "question_id": 40258402, "link": "https://stackoverflow.com/questions/40258402/ethernet-driver-implementation-in-zynq-in-bare-metal", "title": "Ethernet driver implementation in zynq in bare metal", "body": "<p>I'm starting to work with the Zybo and I'm very lost. I want to establish an Ethernet connection between the board and a PC, running in the Zybo a bare-metal application.</p>\n\n<p>I've tried to make work the example of the Xilinx driver emacps (which don't seems very simple to me...), but I don't see any result. I'm running the example on the Zybo and Wireshark in the PC. As long as I know, I should receive some frames from the board, but I don't see anything (after power up the board I see a lot of frames, but they aren't sent from my application).</p>\n\n<p>I did also run the PTP example application which sends some frames periodically. The Tx done interrupt is getting invoked after sending frames but no packets comes out of the Ethernet port(I'm using wireshark and even the link and act led's aren't blinking).</p>\n\n<p>Maybe I'm wrong about what the example shoud do. I just want to learn the simplest way to send and receive frames and see it works...</p>\n\n<p>Any help?</p>\n"}, {"tags": ["java", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 109, "user_id": 4578558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WfekC.jpg?s=128&g=1", "display_name": "Mahmoud Mubarak", "link": "https://stackoverflow.com/users/4578558/mahmoud-mubarak"}, "edited": false, "score": 0, "creation_date": 1477476019, "post_id": 40258239, "comment_id": 67779375, "body": "Have you checked LD_LIBRARY_PATH?"}, {"owner": {"reputation": 1651, "user_id": 530657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ee153df5bde2f63d63b463be459e1d?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Luis", "link": "https://stackoverflow.com/users/530657/jos%c3%a9-luis"}, "edited": false, "score": 1, "creation_date": 1477477203, "post_id": 40258239, "comment_id": 67780130, "body": "Welcome to SO. Please have a look at <a href=\"http://stackoverflow.com/tour\">the tour</a>. You may also want to check <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about</a>, and <a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, and <a href=\"http://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">The perfect question</a>, and how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable example</a>. Post the code you have tried and the errors you have received. Be as specific as possible as it will lead to better answers."}, {"owner": {"reputation": 64505, "user_id": 413337, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/783783f968e84cf5047544e9a0f3ccf4?s=128&d=identicon&r=PG", "display_name": "Codo", "link": "https://stackoverflow.com/users/413337/codo"}, "edited": false, "score": 0, "creation_date": 1477482150, "post_id": 40258239, "comment_id": 67783192, "body": "I doesn&#39;t look as if the second function is the problem. It already fails when tring to call any C code from Java. Have you been able at all to call C code from Java? Please post your code."}, {"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1477482698, "post_id": 40258239, "comment_id": 67783488, "body": "As Jos&#233; already said, it&#39;s hard to help without having more details. Usually you&#39;ll see this error when you don&#39;t link anything you&#39;ll need into your <code>.so</code>. Make sure you link the object files produced from <i>both</i> your <code>.c</code> files into <code>libhello.so</code>. The linker won&#39;t complain when one is missing. You will only notice at runtime with the message you posted."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6384738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b36cd880248c141f9adcb62c3282f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tortxu13", "link": "https://stackoverflow.com/users/6384738/tortxu13"}, "edited": false, "score": 0, "creation_date": 1477553454, "post_id": 40263985, "comment_id": 67816105, "body": "How can I put them both in the same shared library? And if I put them in separate ones, how can I link HelloWorld to HelloWorld2? System.loadLibrary()?"}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "reply_to_user": {"reputation": 77, "user_id": 6384738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b36cd880248c141f9adcb62c3282f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tortxu13", "link": "https://stackoverflow.com/users/6384738/tortxu13"}, "edited": false, "score": 0, "creation_date": 1477560554, "post_id": 40263985, "comment_id": 67820452, "body": "Take a look at this sample:   github.com/mkowsiak/jnicookbook/tree/master/recipeNo018  This sample shows how to perform following calls: Java -&gt; JNI (calling C code) -&gt; from the JNI called code, call some other code in C.  github.com/mkowsiak/jnicookbook/tree/master/recipeNo021  This sample, on the other hand, will put both C functions inside single shared lib."}], "tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": true, "score": 1, "last_activity_date": 1477489467, "creation_date": 1477489467, "answer_id": 40263985, "question_id": 40258239, "link": "https://stackoverflow.com/questions/40258239/can-i-call-a-c-function-from-a-c-program-called-by-jni/40263985#40263985", "title": "Can I call a C function from a C program called by JNI?", "body": "<p>Assuming that you have two files:</p>\n\n<p>HelloWorld.c\nHelloWorld2.c</p>\n\n<p>and HelloWorld is supposed to call something from HelloWorld2 you can:</p>\n\n<ul>\n<li>put both into the same shared lib</li>\n<li>put both into separate shared lib and make sure HelloWorld is linked with HelloWorld2</li>\n</ul>\n\n<p>Make sure that shared libraries are visible by setting LD_LIBRARY_PATH.</p>\n\n<p>You can find some JNI samples here: <a href=\"http://jnicookbook.owsiak.org/\" rel=\"nofollow\">http://jnicookbook.owsiak.org/</a></p>\n"}], "owner": {"reputation": 77, "user_id": 6384738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b36cd880248c141f9adcb62c3282f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tortxu13", "link": "https://stackoverflow.com/users/6384738/tortxu13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 40263985, "answer_count": 1, "score": -1, "last_activity_date": 1477489467, "creation_date": 1477473300, "last_edit_date": 1477480311, "question_id": 40258239, "link": "https://stackoverflow.com/questions/40258239/can-i-call-a-c-function-from-a-c-program-called-by-jni", "title": "Can I call a C function from a C program called by JNI?", "body": "<p>I have already done a research about JNI,and I think I understand how it works, but I've been trying to call to a C function from another C func called by JNI.</p>\n\n<p>I have 2 <code>.c</code>, HelloWorld and HelloWorld2, and a java program to call HelloWorld. HelloWorld at the same time calls to a function defined in HelloWold2 but this causes an error when executing. </p>\n\n<blockquote>\n  <p>java: symbol lookup error: /home/hduser/Desktop/final2/libhello.so: undefined symbol: helloworld</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1477473294, "post_id": 40258136, "comment_id": 67777628, "body": "You can use <a href=\"https://linux.die.net/man/3/strdup\" rel=\"nofollow noreferrer\">strdup</a> to do so"}, {"owner": {"reputation": 576, "user_id": 6648034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e100071b1105de5f4ca2e0ad4ddd2aee?s=128&d=identicon&r=PG&f=1", "display_name": "k_kaz", "link": "https://stackoverflow.com/users/6648034/k-kaz"}, "edited": false, "score": 2, "creation_date": 1477473421, "post_id": 40258136, "comment_id": 67777713, "body": "for the commands[5] array you need to allocate space for every element. use malloc, and then strcpy to copy the string, don&#39;t use value assignment"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1477473551, "post_id": 40258136, "comment_id": 67777796, "body": "Instead of adding lots of printfs for debugging you should consider to use a debugger."}], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1477474941, "post_id": 40258379, "comment_id": 67778705, "body": "why setting <code>struct str a[1];</code> instead of suggested <code>struct str a[2];</code> ?"}, {"owner": {"reputation": 17, "user_id": 7071902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36d3b987596ef519a5bf67c90029f2d?s=128&d=identicon&r=PG&f=1", "display_name": "Aguen", "link": "https://stackoverflow.com/users/7071902/aguen"}, "edited": false, "score": 0, "creation_date": 1477475769, "post_id": 40258379, "comment_id": 67779196, "body": "Thank you, it solved my problem."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 0, "last_activity_date": 1477475123, "last_edit_date": 1592644375, "creation_date": 1477473735, "answer_id": 40258379, "question_id": 40258136, "link": "https://stackoverflow.com/questions/40258136/reading-space-delimited-strings-line-by-line-and-storing-them-in-arrays-in-c/40258379#40258379", "title": "Reading Space Delimited Strings Line by Line and Storing Them in Arrays (in C)", "body": "<p>From <a href=\"https://linux.die.net/man/3/strtok\" rel=\"nofollow noreferrer\">the Man</a></p>\n<blockquote>\n<p><strong>Return Value</strong></p>\n<p>The strtok() and strtok_r() functions return a pointer to the next token, or NULL if there are no more tokens.</p>\n</blockquote>\n<p>So pointers you are storing are addresses of <code>char lib[1000]</code>, that, at the end of your process, will contain the last line read.</p>\n<hr />\n<p>Take also note that you defined a bad array, without dimension:</p>\n<pre><code>struct str a[];\n</code></pre>\n<p>should be, at least,</p>\n<pre><code>struct str a[2];\n</code></pre>\n<hr />\n<p>The fastest correction can be:</p>\n<pre><code>#define _BSD_SOURCE\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct str\n{\nchar *commands[5];\n};\n\nstruct str a[2];\nint main()\n{\n    int i=0;\n    int j=0;\n    char *token;\n    printf(&quot;Starting the program...\\n&quot;);\n    char filename[] = &quot;input.txt&quot;;\n    FILE *file = fopen ( filename, &quot;r&quot; );\n\n    if (file != NULL) {\n        char line [1000];\n        printf(&quot;Read a new line...\\n&quot;);\n        while(fgets(line,sizeof line,file)!= NULL) /* read a line from a file */ {\n            j=0;\n            printf(&quot;%s\\n&quot;,line);\n            printf(&quot;Start token stuff...\\n&quot;);\n            /* get the first token */\n            token = strtok(line, &quot; &quot;);\n\n            /* walk through other tokens */\n            while( token != NULL )\n            {\n                char *temp = strdup(token);\n                if (temp != NULL)\n                {\n                    a[i].commands[j]=temp;\n                }\n                else\n                {\n                    fprintf(stderr, &quot;No memory available to store string\\n&quot;);\n                    return 1;\n                }\n                printf( &quot;Stored Command : %s\\n&quot;, token );\n                token = strtok(NULL, &quot; &quot;);\n                j++;\n            }\n            i++;\n        }\n\n        fclose(file);\n    }\n    else {\n        perror(filename); //print the error message on stderr.\n    }\n    printf(&quot;Finished processing tokens...\\n\\n\\n&quot;);\n\n    printf(&quot;%s\\n%s\\t%s\\t%s\\t%s\\n&quot;, a[0].commands[0], a[0].commands[1],a[0].commands[2],a[0].commands[3],a[0].commands[4]);\n    printf(&quot;%s\\n%s\\t%s\\t%s\\t%s\\n&quot;, a[1].commands[0], a[1].commands[1],a[1].commands[2],a[1].commands[3],a[1].commands[4]);\n    return 0;\n}\n</code></pre>\n<p>In more complex project, duplicated strings must be <code>free</code>d due to heap allocation performed by <code>strdup</code>.</p>\n<hr />\n<p>Another solution can be implemented using <a href=\"https://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\">malloc</a> and allocating space for each element and using <a href=\"https://linux.die.net/man/3/strcpy\" rel=\"nofollow noreferrer\">strcpy</a> to copy the token.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct str\n{\n    char *commands[5];\n};\n\nstruct str a[2];\n\nint main()\n{\n    int i=0;\n    int j=0;\n    char *token;\n    printf(&quot;Starting the program...\\n&quot;);\n    char filename[] = &quot;input.txt&quot;;\n    FILE *file = fopen ( filename, &quot;r&quot; );\n\n    if (file != NULL) {\n        char line [1000];\n        printf(&quot;Read a new line...\\n&quot;);\n        while(fgets(line,sizeof line,file)!= NULL) /* read a line from a file */ {\n            j=0;\n            printf(&quot;%s\\n&quot;,line);\n            printf(&quot;Start token stuff...\\n&quot;);\n            /* get the first token */\n            token = strtok(line, &quot; &quot;);\n\n            /* walk through other tokens */\n            while( token != NULL )\n            {\n                a[i].commands[j] = malloc(strlen(token)+1);\n                if (a[i].commands[j] != NULL)\n                {\n                    strcpy(a[i].commands[j], token);\n                }\n                else\n                {\n                    fprintf(stderr, &quot;No memory available to store string\\n&quot;);\n                    return 1;\n                }\n                printf( &quot;Stored Command : %s\\n&quot;, token );\n                token = strtok(NULL, &quot; &quot;);\n                j++;\n            }\n            i++;\n        }\n\n        fclose(file);\n    }\n    else {\n        perror(filename); //print the error message on stderr.\n    }\n    printf(&quot;Finished processing tokens...\\n\\n\\n&quot;);\n\n    printf(&quot;%s\\n%s\\t%s\\t%s\\t%s\\n&quot;, a[0].commands[0], a[0].commands[1],a[0].commands[2],a[0].commands[3],a[0].commands[4]);\n    printf(&quot;%s\\n%s\\t%s\\t%s\\t%s\\n&quot;, a[1].commands[0], a[1].commands[1],a[1].commands[2],a[1].commands[3],a[1].commands[4]);\n    return 0;\n}\n</code></pre>\n<p>Same thing here, you should <code>free</code>d <code>malloc</code>ated memory.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1477474109, "post_id": 40258474, "comment_id": 67778168, "body": "And since <code>strdup</code> calls <code>malloc</code>, what else do you need to be responsible for to prevent memory leaks? Nothing wrong with dynamic allocations, but if the data is of a known max size (e.g. each <code>command</code> <code>16-char</code> or less, using static arrays in <code>struct str</code> would be another option -- tailored to the learning level)"}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1477474861, "post_id": 40258474, "comment_id": 67778659, "body": "@DavidC.Rankin answer updated"}], "tags": [], "owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "is_accepted": false, "score": 1, "last_activity_date": 1477474814, "last_edit_date": 1477474814, "creation_date": 1477474016, "answer_id": 40258474, "question_id": 40258136, "link": "https://stackoverflow.com/questions/40258136/reading-space-delimited-strings-line-by-line-and-storing-them-in-arrays-in-c/40258474#40258474", "title": "Reading Space Delimited Strings Line by Line and Storing Them in Arrays (in C)", "body": "<p>As @LPs suggests, just add a strdup() call to keep the extracted string when storing in your array. But before, be sure that you have allocated your struct str a[];</p>\n\n<p>Step1 replace:</p>\n\n<pre><code>struct str a[];\n</code></pre>\n\n<p>by:</p>\n\n<pre><code>#define MAX_NB_LINES (100)\nstruct str a[MAX_NB_LINES];\n</code></pre>\n\n<p>Step2 add a strdup() when storing in the array:</p>\n\n<pre><code>while( token != NULL )\n{\n    a[i].commands[j]=strdup(token);\n    printf( \"Stored Command : %s\\n\", token );\n    token = strtok(NULL, \" \");\n    j++;\n    if (j &gt;= 5) break; // stop extraction when 5 commands are stored\n}\n</code></pre>\n\n<blockquote>\n  <p>Before starting to use struct str a[], initialize char pointer to\n  NULL.</p>\n</blockquote>\n\n<pre><code>for(i=0;i&lt;MAX_NB_LINES;i++) {\n    for(j=0;j&lt;5;j++) {\n        a[i].commands[j]=NULL;\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>After using the struct str a[], simply free the allocated memory.</p>\n</blockquote>\n\n<pre><code>for(i=0;i&lt;MAX_NB_LINES;i++) {\n    for(j=0;j&lt;5;j++) {\n        // free only the allocated char pointer\n        if (a[i].commands[j]!=NULL) free(a[i].commands[j]);\n        a[i].commands[j]=NULL;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7071902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36d3b987596ef519a5bf67c90029f2d?s=128&d=identicon&r=PG&f=1", "display_name": "Aguen", "link": "https://stackoverflow.com/users/7071902/aguen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "closed_date": 1477474502, "accepted_answer_id": 40258379, "answer_count": 2, "score": 1, "last_activity_date": 1477475123, "creation_date": 1477472986, "question_id": 40258136, "link": "https://stackoverflow.com/questions/40258136/reading-space-delimited-strings-line-by-line-and-storing-them-in-arrays-in-c", "closed_reason": "Duplicate", "title": "Reading Space Delimited Strings Line by Line and Storing Them in Arrays (in C)", "body": "<p>I have an input file consisting of:  </p>\n\n<pre><code>CREATEHALL \"Red-Hall\" \"StarDust\" 24 20\nCREATEHALL \"Orange-Hall\" \"Last_Samurai\" 10 20\n</code></pre>\n\n<p>And I want to store each line in an array for future uses.</p>\n\n<p><strong>So far my code is:</strong>\n(Added lots of printf's for debugging purposes.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nstruct str\n{\nchar *commands[5];\n};\n\nstruct str a[];\nint main()\n{\n    int i=0;\n    int j=0;\n    char *token;\n    printf(\"Starting the program...\\n\");\n    char filename[] = \"input.txt\";\n    FILE *file = fopen ( filename, \"r\" );\n\n    if (file != NULL) {\n        char line [1000];\n        printf(\"Read a new line...\\n\");\n        while(fgets(line,sizeof line,file)!= NULL) /* read a line from a file */ {\n            j=0;\n            printf(\"%s\\n\",line);\n            printf(\"Start token stuff...\\n\");\n            /* get the first token */\n            token = strtok(line, \" \");\n\n            /* walk through other tokens */\n            while( token != NULL )\n            {\n                a[i].commands[j]=token;\n                printf( \"Stored Command : %s\\n\", token );\n                token = strtok(NULL, \" \");\n                j++;\n            }\n            i++;\n        }\n\n        fclose(file);\n    }\n    else {\n        perror(filename); //print the error message on stderr.\n    }\n    printf(\"Finished processing tokens...\\n\\n\\n\");\n\n    printf(\"%s\\n%s\\t%s\\t%s\\t%s\\n\", a[0].commands[0], a[0].commands[1],a[0].commands[2],a[0].commands[3],a[0].commands[4]);\n    printf(\"%s\\n%s\\t%s\\t%s\\t%s\\n\", a[1].commands[0], a[1].commands[1],a[1].commands[2],a[1].commands[3],a[1].commands[4]);\n    return 0;\n}\n</code></pre>\n\n<p><strong>The output I get on the console is this:</strong></p>\n\n<pre><code>Starting the program...\nRead a new line...\nCREATEHALL \"Red-Hall\" \"StarDust\" 24 20\n\nStart token stuff...\nStored Command : CREATEHALL\nStored Command : \"Red-Hall\"\nStored Command : \"StarDust\"\nStored Command : 24\nStored Command : 20\n\nCREATEHALL \"Orange-Hall\" \"Last_Samurai\" 10 20\nStart token stuff...\nStored Command : CREATEHALL\nStored Command : \"Orange-Hall\"\nStored Command : \"Last_Samurai\"\nStored Command : 10\nStored Command : 20\nFinished processing tokens...\n\n\nCREATEHALL\n\"Orange-Hall\"   l\"      murai\"  ai\"\nCREATEHALL\n\"Orange-Hall\"   \"Last_Samurai\"  10      20\n</code></pre>\n\n<p>I'm not very good with C, (this is a very small part of an assignment) but I believe the error is in the  </p>\n\n<pre><code>a[i].commands[j]=token;\n</code></pre>\n\n<p>line, since before that it reads the words fine.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "linux", "gcc", "ubuntu-14.04", "cpu"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1477472946, "post_id": 40258060, "comment_id": 67777383, "body": "You want serialized runs using multiple processes? If you want the <code>client</code> to be executed first, why do you want to run it in background as a separate process?"}, {"owner": {"reputation": 1, "user_id": 6536741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec1dca272c8a9c6314e06356442740f?s=128&d=identicon&r=PG&f=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/6536741/pradeep"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1477473017, "post_id": 40258060, "comment_id": 67777428, "body": "The condition is  1.I should run client in background  2.system in foreground and output should be like the above one"}, {"owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "edited": false, "score": 0, "creation_date": 1477474288, "post_id": 40258060, "comment_id": 67778280, "body": "@pradeep do you have to use the system and client programs? Or is your task to create a process that runs a background process and wait in the foreground process until the background process is done?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6536741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec1dca272c8a9c6314e06356442740f?s=128&d=identicon&r=PG&f=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/6536741/pradeep"}, "edited": false, "score": 0, "creation_date": 1477480544, "post_id": 40259138, "comment_id": 67782191, "body": "....It is a nice catch to use fork.But if client is doing some continuos running job.if it never ends.Then parent should always wait.I just want to know that my client successfully runs upto that print statement in client.Is there is any way to know such status...???"}, {"owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "reply_to_user": {"reputation": 1, "user_id": 6536741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec1dca272c8a9c6314e06356442740f?s=128&d=identicon&r=PG&f=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/6536741/pradeep"}, "edited": false, "score": 0, "creation_date": 1477481942, "post_id": 40259138, "comment_id": 67783066, "body": "So your print statement may be understood as an initialization of child process. So parent should wait until child reaches some point (until it is initialized and running) and then kept on working without taking care about child anymore?"}], "tags": [], "owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "is_accepted": false, "score": 0, "last_activity_date": 1477479502, "last_edit_date": 1477479502, "creation_date": 1477475773, "answer_id": 40259138, "question_id": 40258060, "link": "https://stackoverflow.com/questions/40258060/how-to-run-a-background-process-before-all-foreground-processes-or-a-particular/40259138#40259138", "title": "How to run a background process before all foreground processes or a particular foreground process?", "body": "<p>Maybe have a look at this and inspire yourself.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    int pid;\n    int status;\n\n    pid = fork();\n    if (pid == -1)\n    {\n        // handle error\n    }\n\n    if (pid == 0)\n    {\n        // exec child process\n        execl(\"./client\", \"client\", NULL);\n    }\n    else\n    {\n        wait(&amp;status);\n    }\n\n    printf(\"WE are in main program\\n\");\n    printf(\"WE are in main program\\n\");\n    printf(\"WE are in main program\\n\");\n    printf(\"WE are in main program\\n\");\n    printf(\"WE are in main program\\n\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6536741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec1dca272c8a9c6314e06356442740f?s=128&d=identicon&r=PG&f=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/6536741/pradeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477996457, "creation_date": 1477472764, "last_edit_date": 1477996457, "question_id": 40258060, "link": "https://stackoverflow.com/questions/40258060/how-to-run-a-background-process-before-all-foreground-processes-or-a-particular", "title": "How to run a background process before all foreground processes or a particular foreground process?", "body": "<blockquote>\n  <p>This is a program <strong>system.c</strong></p>\n</blockquote>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    int main()\n    {\n        system(\"./client &amp;\");\n        printf(\"WE are in main program\\n\");\n        printf(\"WE are in main program\\n\");\n        printf(\"WE are in main program\\n\");\n        printf(\"WE are in main program\\n\");\n        printf(\"WE are in main program\\n\");\n        return 0;\n     }\n</code></pre>\n\n<blockquote>\n  <p>This is <strong>client.c</strong></p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    printf(\"We are in background process\\n\");\n    do {\n        //doing some process on message queue to receive messages\n    } while (1);\n    return 0;\n}   \n</code></pre>\n\n<blockquote>\n  <p>How to get the output of\n  <strong>./system</strong> running from linux terminal as like as the below one</p>\n</blockquote>\n\n<pre><code>We are in background process\nWE are in main program\nWE are in main program\nWE are in main program\nWE are in main program\nWE are in main program\n</code></pre>\n\n<blockquote>\n  <p>Can anyone please explain with much more clarity?</p>\n</blockquote>\n"}, {"tags": ["c", "multithreading", "queue", "atomic"], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4047104, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/536f70b261ae6154daa331941d49035b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Sweeney", "link": "https://stackoverflow.com/users/4047104/mike-sweeney"}, "edited": false, "score": 0, "creation_date": 1477555975, "post_id": 40264129, "comment_id": 67817601, "body": "No, the &quot;dummy&quot; node isn&#39;t physically the same node throughout the queue&#39;s lifetime. The &quot;dummy&quot; advances as you dequeue nodes. Most of the time &quot;dummy&quot; is the node that was dequeued last and hence when  <code>dequeue()</code> is called you return HEAD-&gt;next and not HEAD itself. The only time you get to the <code>free(old_head)</code> is if you have a real node in the queue so the dummy node and at least 1 real node so <code>enqueue()</code> should never touch <code>old_head</code>. I&#39;m hoping you can address the specific questions labelled in my question and code as 1., 2., and 3."}, {"owner": {"reputation": 1396, "user_id": 4047104, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/536f70b261ae6154daa331941d49035b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Sweeney", "link": "https://stackoverflow.com/users/4047104/mike-sweeney"}, "edited": false, "score": 0, "creation_date": 1477584506, "post_id": 40264129, "comment_id": 67837039, "body": "Yeah, I&#39;ve read tons of lock-free queue examples in the last few weeks and saw that bit about cache alignment. One such example is this one: <a href=\"https://software.intel.com/en-us/articles/single-producer-single-consumer-queue\" rel=\"nofollow noreferrer\">software.intel.com/en-us/articles/&hellip;</a>. I&#39;m really doing this just for understanding the barriers part so I&#39;m avoiding C11 atomics which many of the examples use."}], "tags": [], "owner": {"reputation": 918, "user_id": 4936507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36df2f476a2ed16bb905fc814370f720?s=128&d=identicon&r=PG&f=1", "display_name": "Domso", "link": "https://stackoverflow.com/users/4936507/domso"}, "is_accepted": false, "score": 0, "last_activity_date": 1477569648, "last_edit_date": 1477569648, "creation_date": 1477489833, "answer_id": 40264129, "question_id": 40257816, "link": "https://stackoverflow.com/questions/40257816/memory-barriers-in-single-producer-single-consumer-queue/40264129#40264129", "title": "Memory Barriers in Single Producer Single Consumer Queue", "body": "<p>first of all, it depends your specific hardware-architecture, OS, language, etc.</p>\n\n<p>1.)\nno. because you need a additional barrier to pass the pointer to the other thread anyway</p>\n\n<p>2.)\nyes, <code>old_tail-&gt;next = the_queue-&gt;tail</code> needs to be executed after <code>the_queue-&gt;tail = new_node</code></p>\n\n<p>3.)\nIt would have no effect, since there is nothing before the barrier, but theoretically you could need a barrier after <code>old_tail-&gt;next = the_queue-&gt;tail</code> in <code>enqueue()</code>. The compiler wont reorder outside of a function, but the CPU could maybe do something like that. (very unlikely, but not 100% sure)</p>\n\n<p>OT: since you are already doing some micro-optimization, you could add some padding for the cache</p>\n\n<pre><code>typedef struct queue_t {\n    queue_node_t *head; // consumer consumes from head\n    char cache_pad[64]; // head and tail shouldnt be in the same cache-line(-&gt;64 Byte)\n    queue_node_t *tail; // producer adds at tail\n} queue_t;\n</code></pre>\n\n<p>and if you have really enough memory to waste, you could do something like this </p>\n\n<pre><code>typedef struct queue_node_t {\n    int data;\n    struct queue_node_t *next;\n    char cache_pad[56]; // sizeof(queue_node_t) == 64; only for 32Bit\n} queue_node_t;\n</code></pre>\n"}], "owner": {"reputation": 1396, "user_id": 4047104, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/536f70b261ae6154daa331941d49035b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Sweeney", "link": "https://stackoverflow.com/users/4047104/mike-sweeney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1477569648, "creation_date": 1477472032, "last_edit_date": 1477555419, "question_id": 40257816, "link": "https://stackoverflow.com/questions/40257816/memory-barriers-in-single-producer-single-consumer-queue", "title": "Memory Barriers in Single Producer Single Consumer Queue", "body": "<p>I've spent the last few weeks doing a lot of reading on memory models, compiler reordering, CPU reordering, memory barriers, and lock-free programming and I think I've driven myself into confusion now. I've written a single producer single consumer queue and am trying to figure out where I need memory barriers for things to work and if some operations need to be atomic. My single producer single consumer queue is as follows:</p>\n\n<pre><code>typedef struct queue_node_t {\n    int data;\n    struct queue_node_t *next;\n} queue_node_t;\n\n// Empty Queue looks like this:\n// HEAD TAIL\n//   |    |\n// dummy_node\n\n// Queue: insert at TAIL, remove from HEAD\n//    HEAD           TAIL\n//     |              |\n// dummy_node -&gt; 1 -&gt; 2 -&gt; NULL\n\ntypedef struct queue_t {\n    queue_node_t *head; // consumer consumes from head\n    queue_node_t *tail; // producer adds at tail\n} queue_t;\n\nqueue_node_t *alloc_node(int data) {\n    queue_node_t *new_node = (queue_node_t *)malloc(sizeof(queue_node_t));\n    new_node-&gt;data = data;\n    new_node-&gt;next = NULL;\n    return new_node;\n}\n\nqueue_t *create_queue() {\n    queue_t *new_queue = (queue_t *)malloc(sizeof(queue_t));\n    queue_node_t *dummy_node = alloc_node(0);\n    dummy_node-&gt;next = NULL;\n    new_queue-&gt;head = dummy_node;\n    new_queue-&gt;tail = dummy_node;\n    // 1. Do we need any kind of barrier to make sure that if the\n    // thread that didn't call this performs a queue operation\n    // and happens to run on a different CPU that queue structure\n    // is fully observed by it? i.e. the head and tail are properly\n    // initialized\n    return new_queue;\n}\n\n// Enqueue modifies tail\nvoid enqueue(queue_t *the_queue, int data) {\n    queue_node_t *new_node = alloc_node(data);\n    // insert at tail\n    new_node-&gt;next = NULL;\n\n    // Let us save off the existing tail\n    queue_node_t *old_tail = the_queue-&gt;tail;\n\n    // Make the new node the new tail\n    the_queue-&gt;tail = new_node;\n\n    // 2. Store/Store barrier needed here?\n\n    // Link in the new node last so that a concurrent dequeue doesn't see\n    // the node until we're done with it\n    // I don't know that this needs to be atomic but it does need to have\n    // release semantics so that this isn't visible until prior writes are done\n    old_tail-&gt;next = the_queue-&gt;tail;\n    return;\n}\n\n// Dequeue modifies head\nbool dequeue(queue_t *the_queue, int *item) {\n    // 3. Do I need any barrier here to make sure if an enqueue already happened\n    // I can observe it? i.e., if an enqueue was called on \n    // an empty queue by thread 0 on CPU0 and dequeue is called\n    // by thread 1 on CPU1\n    // dequeue the oldest item (FIFO) which will be at the head\n    if (the_queue-&gt;head-&gt;next == NULL) {\n        return false;\n    }\n    *item = the_queue-&gt;head-&gt;next-&gt;data;\n    queue_node_t *old_head = the_queue-&gt;head;\n    the_queue-&gt;head = the_queue-&gt;head-&gt;next;\n    free(old_head);\n    return true;\n}\n</code></pre>\n\n<p>Here are my questions corresponding to the comments in my code above:</p>\n\n<ol>\n<li>In <code>create_queue()</code> do I need some kind of barrier before I return? I'm wondering if I call this function from thread 0 running on CPU0 and then use the pointer returned in thread 1 which happens to run on CPU1 is it possible thread 1 sees a <code>queue_t</code> structure that isn't fully initialized?</li>\n<li>Do I need a barrier in <code>enqueue()</code> to make sure the new node isn't linked in to the queue until all of the new node's fields are initialized?</li>\n<li>Do I need a barrier in <code>dequeue()</code>? I feel like it would be correct without one but I may need one if I want to make sure I see any completed enqueue.</li>\n</ol>\n\n<p>Update: I tried to make it clear with the comments in the code but the HEAD of this queue always points to a dummy node. This is a common technique that makes it so that the producer only ever needs to access the TAIL and the consumer only ever accesses the HEAD. An empty queue will contain a dummy node and <code>dequeue()</code> always returns the node after the HEAD, if there is one. As nodes are dequeued the dummy node advances and the previous \"dummy\" is freed.</p>\n"}, {"tags": ["c++", "c", "makefile", "msys", "msys2"], "answers": [{"tags": [], "owner": {"reputation": 968, "user_id": 2929854, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sD7KU.jpg?s=128&g=1", "display_name": "Klamer Schutte", "link": "https://stackoverflow.com/users/2929854/klamer-schutte"}, "is_accepted": false, "score": 0, "last_activity_date": 1477471617, "last_edit_date": 1495541796, "creation_date": 1477471617, "answer_id": 40257680, "question_id": 40257679, "link": "https://stackoverflow.com/questions/40257679/how-do-i-define-a-path-from-an-msys-makefile-for-a-c-program/40257680#40257680", "title": "How do I define a path from an MSYS Makefile for a C++ program?", "body": "<p>Part of the question is addressed in <a href=\"https://stackoverflow.com/questions/12015348/msys-path-conversion-or-cygpath-for-msys\">msys path conversion (or cygpath for msys?)</a>, namely how to convert a msys style path to a windows style path. My full solution in the Makefile is:</p>\n\n<pre><code>ifeq ($(PYTHONMAJOR),3)\n    L=L\nendif\nDEFINES += -DPYTHON_ROOT_DIR=$(L)'\"'$(shell (cmd //c echo $(PYTHON_ROOT_DIR)) | sed 's|/|\\\\\\\\\\\\\\\\|g')'\"'\n</code></pre>\n\n<p>which defines the preprocessor symbol PYTHON_ROOT_DIR with the proper path.</p>\n"}], "owner": {"reputation": 968, "user_id": 2929854, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sD7KU.jpg?s=128&g=1", "display_name": "Klamer Schutte", "link": "https://stackoverflow.com/users/2929854/klamer-schutte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477471617, "creation_date": 1477471617, "question_id": 40257679, "link": "https://stackoverflow.com/questions/40257679/how-do-i-define-a-path-from-an-msys-makefile-for-a-c-program", "title": "How do I define a path from an MSYS Makefile for a C++ program?", "body": "<p>My problem: in a Makefile which I use in both the MSYS and the MSYS2 environment I know a path, PYTHON_ROOT_DIR, which shall be used at compilation time in a C++ program. Problem is PYTHON_ROOT_DIR is in the Makefile known as posix style path such as <code>/mingw64/bin</code>, where in the C++ program it shall have a form like <code>\"C:\\\\prog64\\\\msys64\\\\mingw64\\\\bin\"</code>. Additional challenge is that depending on a configuration variable PYTHONMAJOR the path shall be wide characters or normal characters.</p>\n\n<p>My question: how do I solve this in the Makefile without a need to install additional programs/scripts in the msys or msys2 environments?</p>\n"}, {"tags": ["c", "unions"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1477469783, "post_id": 40256870, "comment_id": 67775381, "body": "C11 draft N1548 might say that there\u2019ll be no issues. I can\u2019t tell for sure. Still reading. A footnote: \u201c95) If the member used to read the contents of a union object is not the same as the member last used to store a value in the object, the appropriate part of the object representation of the value is reinterpreted as an object representation in the new type as described in 6.2.6 (a process sometimes called \u2018\u2018type punning\u2019\u2019). This might be a trap representation.\u201d"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 4, "last_activity_date": 1477469826, "creation_date": 1477469826, "answer_id": 40257065, "question_id": 40256870, "link": "https://stackoverflow.com/questions/40256870/union-members-of-the-same-type/40257065#40257065", "title": "Union members of the same type", "body": "<p>Yes, that's fine.</p>\n\n<p>The standard (C11 draft) says:</p>\n\n<blockquote>\n  <p>[...] if a union contains several structures that share a common initial \n  sequence (see below), and if the union object currently contains one of \n  these structures, it is permitted to inspect the common initial part of any\n  of them anywhere that a declaration of the completed type of the union is\n  visible</p>\n</blockquote>\n\n<p>Here the two integers can be considered to be (very simple) structures that share the same initial sequence.</p>\n\n<p>Even ignoring that, there's also:</p>\n\n<blockquote>\n  <p>If the member used to read the contents of a union object is not the same \n  as the member last used to store a value in the object, the appropriate \n  part of the object representation of the value is reinterpreted as an \n  object representation in the new type</p>\n</blockquote>\n\n<p>Reinterpreting an <code>int</code> as an <code>int</code> is pretty safe. :)</p>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 40257065, "answer_count": 1, "score": 5, "last_activity_date": 1490543999, "creation_date": 1477469141, "last_edit_date": 1490543999, "question_id": 40256870, "link": "https://stackoverflow.com/questions/40256870/union-members-of-the-same-type", "title": "Union members of the same type", "body": "<p>Suppose I have a union u with two members <code>a</code> and <code>b</code> of the same type (e.g., int).</p>\n\n<pre><code>union u{\n    int a,b;\n    char c;\n};\n</code></pre>\n\n<p>If I write to <code>a</code>, pass it to a function by value, and the function reads from <code>b</code>, expecting to get the <code>a</code> value, will there be any issues, considering <code>a</code> and <code>b</code> have the same type? Do the member reads need to mirror member writes exactly?</p>\n"}, {"tags": ["c", "file", "data-structures"], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 6149112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0btmin8oCMo/AAAAAAAAAAI/AAAAAAAAAAA/lnk059CLpqg/photo.jpg?sz=128", "display_name": "Ya\u011fmur Oymak", "link": "https://stackoverflow.com/users/6149112/ya%c4%9fmur-oymak"}, "is_accepted": false, "score": 0, "last_activity_date": 1477469710, "creation_date": 1477469710, "answer_id": 40257029, "question_id": 40256827, "link": "https://stackoverflow.com/questions/40256827/differentiating-data-in-a-file-c/40257029#40257029", "title": "Differentiating data in a file C", "body": "<p>The problem is in the way you are using <code>strtok()</code>. From the manpage:</p>\n\n<blockquote>\n  <p>The strtok() function parses a string into a sequence of tokens. On the first call to strtok() the string to be parsed should be specified in str. In each subsequent call that should parse the same string, str should be NULL.</p>\n</blockquote>\n\n<p>That means to parse <code>str</code>, you have to first call it as <code>strtok(str, \" \")</code>, and to further parse the string, you have to call it as <code>strtok(NULL, \" \")</code>. When you call it as <code>strtok(str, \" \")</code> the second time, it starts again from the beginning of <code>str</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 5163043, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206267198550490/picture?type=large", "display_name": "burnsieXD", "link": "https://stackoverflow.com/users/5163043/burnsiexd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477469710, "creation_date": 1477469003, "question_id": 40256827, "link": "https://stackoverflow.com/questions/40256827/differentiating-data-in-a-file-c", "title": "Differentiating data in a file C", "body": "<p>I am trying to read the contents of a file which are sectioned into two separate types. This is shown below: </p>\n\n<pre><code># Type names\nbird\nmammal\nreptile\n.\n# Type effectiveness\nVery_effective\nNot_effective\n.\n</code></pre>\n\n<p>So far I can read the contents of the first type, but when I try to read the contents of the second, I keep re-reading the contents of the first. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    typedef struct \n    {\n        char types[1000];\n        char effectiveness[1000];\n    } sinFile; \n    sinFile record[1000];\n\n    FILE* file; \n    char line[121];\n    char period[10];\n    char hash[10];\n\n    char* item; \n    char* item2;\n    int i = 0;\n    int j = 0;\n\n    file = fopen(\"Test.txt\", \"r\");\n\n    while(fgets(line, 120, file)) {\n        item = strtok(line, \" \");\n        strcpy(period, \".\");\n\n        if (item[0] == '#') {\n            continue;\n        } else {\n            do {\n                strcpy(record[i].types, line);\n                i++;\n            } while (strcmp(record[i].types, period) == 0);\n        }\n        item2 = strtok(line, \" \");\n        if (item2[0] == '#') {\n            continue;\n        } else {\n            do {\n                strcpy(record[j].effectiveness, line);\n                j++;\n            } while (strcmp(record[j].effectiveness, period)== 0);\n        }\n    }\n\n    fclose(file);\n\n    printf(\"%s\", record[0].effectiveness);\n}\n</code></pre>\n\n<p>At the moment when I try to print out the first effectiveness type, it prints out 'bird' etc. </p>\n\n<p>I feel like I am close but I'm not sure as to how to procede. </p>\n"}, {"tags": ["c", "char", "void", "spi", "atmega16"], "comments": [{"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1477468906, "post_id": 40256730, "comment_id": 67774922, "body": "<code>SPI_SlaveReceive</code> is not returning anything, so no return type other than <code>void</code>. What is problem in that"}, {"owner": {"reputation": 576, "user_id": 6648034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e100071b1105de5f4ca2e0ad4ddd2aee?s=128&d=identicon&r=PG&f=1", "display_name": "k_kaz", "link": "https://stackoverflow.com/users/6648034/k-kaz"}, "edited": false, "score": 1, "creation_date": 1477468925, "post_id": 40256730, "comment_id": 67774932, "body": "char SPI_SlaveReceive(void) takes nothing when called, and returns a char. void SPI_SlaveInit(void) takes nothing, returns nothing"}, {"owner": {"reputation": 27011, "user_id": 1490355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296f0478cb1b6724e3f862ace601fa99?s=128&d=identicon&r=PG", "display_name": "SingerOfTheFall", "link": "https://stackoverflow.com/users/1490355/singerofthefall"}, "edited": false, "score": 4, "creation_date": 1477468955, "post_id": 40256730, "comment_id": 67774941, "body": "Because &quot;they&quot; want to return a value?"}], "answers": [{"tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1477469049, "creation_date": 1477469049, "answer_id": 40256848, "question_id": 40256730, "link": "https://stackoverflow.com/questions/40256730/c-difference-between-char-functionvoid-and-void-functionvoid/40256848#40256848", "title": "C difference between char function(void) and void function(void)", "body": "<p><code>SPI_SlaveReceive</code> receives something, so it's returning that \"something\" as a <code>char</code>, hence the return type. If it was typed to return <code>void</code> you wouldn't be able to get the received value, which wouldn't be very useful!</p>\n\n<p>If it didn't return what it received how would you ever get what was received..?</p>\n"}], "owner": {"reputation": 39, "user_id": 6090814, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/16a57ced602bbf960ff1fec9ed79f31d?s=128&d=identicon&r=PG&f=1", "display_name": "TMJ", "link": "https://stackoverflow.com/users/6090814/tmj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1477473136, "creation_date": 1477468716, "last_edit_date": 1477473136, "question_id": 40256730, "link": "https://stackoverflow.com/questions/40256730/c-difference-between-char-functionvoid-and-void-functionvoid", "title": "C difference between char function(void) and void function(void)", "body": "<p>For my thesis I'm using an ATmega16 to communicate with MCP2515 over SPI. When we are checking the example code to set up SPI as a slave mode in the Atmega16 datasheet we get next example code.</p>\n\n<pre><code>void SPI_SlaveInit(void)\n{\n/* Set MISO output, all others input */\n    DDR_SPI = (1&lt;&lt;DD_MISO);\n/* Enable SPI */\n    SPCR = (1&lt;&lt;SPE);\n}\nchar SPI_SlaveReceive(void)\n{\n/* Wait for reception complete */\n    while(!(SPSR &amp; (1&lt;&lt;SPIF)))\n;\n/* Return data register */\n    return SPDR;\n}\n</code></pre>\n\n<p>We don't understand why they are using char SPI_SlaveReceive(void) instead of just void  SPI_SlaveReceive(void).\nCan somebody explain us why they use the char instead of void? What is the difference? \nI can't find a good explanation on the internet.</p>\n"}, {"tags": ["c", "arrays", "string", "pointers", "strcpy"], "comments": [{"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 4, "creation_date": 1477468223, "post_id": 40256559, "comment_id": 67774538, "body": "You think <code>Tmp</code> has enough memory to hold your string?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477469174, "post_id": 40256559, "comment_id": 67775067, "body": "@andy please don;t add <code>thank you</code> and alike, it was removed for a reson. :)"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1477469337, "last_edit_date": 1477469337, "creation_date": 1477468241, "answer_id": 40256586, "question_id": 40256559, "link": "https://stackoverflow.com/questions/40256559/using-strcpy-on-a-dynamic-array/40256586#40256586", "title": "Using strcpy on a dynamic array", "body": "<p>The problem here is with </p>\n\n<pre><code> char Tmp[]=\"\";\n</code></pre>\n\n<p>here, <code>Tmp</code> is <strong>not</strong> an dynamic array, it's an array with <em>exactly</em> one element (initialized via the initializer). When you use this as destination for <code>strcpy()</code>, you're overrunning the buffer. Basically, your code tries to access out of bound memory, which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>Related, quoting <code>C11</code>, chapter \u00a77.24.2.3, <em><code>strcpy()</code></em>, <em>emphasis mine</em></p>\n\n<blockquote>\n  <p>The <code>strcpy</code> function copies the string pointed to by <code>s2</code> <strong>(including the terminating null\n  character)</strong> into the array pointed to by <code>s1</code>. [...]</p>\n</blockquote>\n\n<p>and then, for \"String function conventions\", \u00a77.24.1,</p>\n\n<blockquote>\n  <p>[....] If an array is accessed beyond the end of an object, the behavior is undefined.</p>\n</blockquote>\n\n<p><strong>Solution</strong>: You need to ensure that <code>Tmp</code> has enough memory to hold the content to be copied into it, including the null terminator.</p>\n\n<p>That said, for a hosted environment, <code>int main()</code> should at least be <code>int main(void)</code> to be conforming to the standard.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1477468624, "post_id": 40256623, "comment_id": 67774782, "body": "Or use a VLA: <code>char Tmp[ strlen(sNext1) + 1 ];</code>"}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": true, "score": 1, "last_activity_date": 1477468359, "creation_date": 1477468359, "answer_id": 40256623, "question_id": 40256559, "link": "https://stackoverflow.com/questions/40256559/using-strcpy-on-a-dynamic-array/40256623#40256623", "title": "Using strcpy on a dynamic array", "body": "<p>Allocate memory to <code>Tmp</code> before copying the string to <code>Tmp</code>.</p>\n\n<p><code>Tmp</code> is an character array of size 1. </p>\n\n<p>Allocate memory dynamically as shown below. (If you are trying to do dynamic memory allocatio)</p>\n\n<pre><code>char *Tmp = malloc(strlen(sNext1) + 1);\n</code></pre>\n\n<p>Then try doing <code>strcpy()</code></p>\n"}], "owner": {"reputation": 27, "user_id": 7073626, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e87737fc5de7124d73c8322238d93198?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Lu", "link": "https://stackoverflow.com/users/7073626/andy-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2455, "favorite_count": 0, "accepted_answer_id": 40256623, "answer_count": 2, "score": 1, "last_activity_date": 1477469337, "creation_date": 1477468153, "last_edit_date": 1477469148, "question_id": 40256559, "link": "https://stackoverflow.com/questions/40256559/using-strcpy-on-a-dynamic-array", "title": "Using strcpy on a dynamic array", "body": "<p>I have got a basic question about the following code:</p>\n\n<pre><code>int main() {\n    char *sNext1=\"DABCD\";\n    char Tmp[]=\"\";\n    strcpy(Tmp, sNext1);\n    return 0;\n}\n</code></pre>\n\n<p>There is a error happened in \"strcpy\" when I run it. It seems that it doesn't allow me to copy a string into a dynamic array. Does anyone know what causes this error? And how can I fix it?</p>\n"}, {"tags": ["c", "printing", "pipe", "fork", "message"], "answers": [{"tags": [], "owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "is_accepted": true, "score": 1, "last_activity_date": 1477467860, "creation_date": 1477467860, "answer_id": 40256475, "question_id": 40256379, "link": "https://stackoverflow.com/questions/40256379/getting-unwanted-characters-at-the-end-of-a-message/40256475#40256475", "title": "Getting unwanted characters at the end of a message", "body": "<p>Send also null character that is at the end of the string. Same for reading.</p>\n\n<pre><code>write(pipefd[1],\"Hello from parent\",18);\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6749099, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/260883700955418/picture?type=large", "display_name": "Amal", "link": "https://stackoverflow.com/users/6749099/amal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 40256475, "answer_count": 1, "score": 0, "last_activity_date": 1477467860, "creation_date": 1477467568, "question_id": 40256379, "link": "https://stackoverflow.com/questions/40256379/getting-unwanted-characters-at-the-end-of-a-message", "title": "Getting unwanted characters at the end of a message", "body": "<p>The following c program is used to send a message from parent process to the child process(created using fork()) via a pipe and is run on the linux terminal!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\nint main(int argc,char *arg[]){\n    pid_t child;\n    int pipefd[2];\n    int ret;\n    char message[20];\n    ret =pipe(pipefd);\n\n\n          if((child=fork())==0){\n                              printf(\"The child process \\n\");\n                              close(pipefd[0]);\n                                   write(pipefd[1],\"Hello from parent\",17);\n\n                              }\n\n                              else{\n                                   close(pipefd[1]);\n                              read(pipefd[0],message,17);\n                              printf(\"Message from parent %s\\n\",message);\n                                   }\n                                   return 0;\n                                   }\n</code></pre>\n\n<p>The above code prints the message \"Hello from parent\" but at the end of parent part an @ sign is printed! what is the reason and how can i rectify it?                           </p>\n"}, {"tags": ["c", "c++11", "cygwin"], "comments": [{"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 2, "creation_date": 1477468273, "post_id": 40256368, "comment_id": 67774578, "body": "To be a bit nit-picky. Are these values really 20+ digits of precision? They look like 34.9 and 121.8 plus some tiny artefacts from previous floating-point calculations."}, {"owner": {"reputation": 9, "user_id": 6652681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa6d652d26d9b2b78c44db1fe2dbf85a?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan G", "link": "https://stackoverflow.com/users/6652681/rohan-g"}, "reply_to_user": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1477472380, "post_id": 40256368, "comment_id": 67777018, "body": "no till 15 places"}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1477475179, "post_id": 40256368, "comment_id": 67778848, "body": "And do you actually have/need that much precision? Bear in mind that 15 significant digits is very nearly enough to represent the circumference of the solar system (~1.43e13m) to the nearest centimeter."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6652681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa6d652d26d9b2b78c44db1fe2dbf85a?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan G", "link": "https://stackoverflow.com/users/6652681/rohan-g"}, "edited": false, "score": 0, "creation_date": 1477472020, "post_id": 40256537, "comment_id": 67776776, "body": "its okay till 15 places to read but i am not getting the value as mentioned in file."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 9, "user_id": 6652681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa6d652d26d9b2b78c44db1fe2dbf85a?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan G", "link": "https://stackoverflow.com/users/6652681/rohan-g"}, "edited": false, "score": 0, "creation_date": 1477487635, "post_id": 40256537, "comment_id": 67786874, "body": "@RohanG: Something, something roundoff error\u2026 Floating point can represent only a (small) subset of rational numbers with absolute precision. For everything outside that set you only get an approximate value. That&#39;s the deal you have to agree to when using floating point."}], "tags": [], "owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "is_accepted": true, "score": 2, "last_activity_date": 1477468073, "creation_date": 1477468073, "answer_id": 40256537, "question_id": 40256368, "link": "https://stackoverflow.com/questions/40256368/read-the-data-from-file-precision-to-15-decimal-places-in-c/40256537#40256537", "title": "read the data from file (precision to 15 decimal places) in C", "body": "<blockquote>\n  <p>which is of type float and constraint is that i cannot change the data type of buffer</p>\n</blockquote>\n\n<p>Then you've got a problem.</p>\n\n<blockquote>\n  <p>values after decimal is always constant in number till 15 places</p>\n</blockquote>\n\n<p>That's about the number of significant digits a double precision float can hold. There are 53 bits available for the mantissa in a IEEE 754 double precision floating point value. That gives you log10(2^53) = 15.95 decimal digits of precision (round that down to 15). That's what it can hold.</p>\n\n<p>If you need higher precision you must use a different data type possibly combined with using a multiprecision math library.</p>\n"}], "owner": {"reputation": 9, "user_id": 6652681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa6d652d26d9b2b78c44db1fe2dbf85a?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan G", "link": "https://stackoverflow.com/users/6652681/rohan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 40256537, "answer_count": 1, "score": 0, "last_activity_date": 1477471937, "creation_date": 1477467529, "last_edit_date": 1477471937, "question_id": 40256368, "link": "https://stackoverflow.com/questions/40256368/read-the-data-from-file-precision-to-15-decimal-places-in-c", "title": "read the data from file (precision to 15 decimal places) in C", "body": "<p>My text file which needs to be read is in following format (data.dat) -</p>\n\n<p>0.001505882352941<br>\n   34.900000000000018<br>\n   121.800000000000010 </p>\n\n<p>i want to assign the following values to given buffer which is of type float and constraint is that i cannot change the data type of buffer</p>\n\n<pre><code> fprintf(file_ptr, \"%f\", &amp;buffer); \n</code></pre>\n\n<p>i tried other methods also      </p>\n\n<pre><code>double val;  \nfprintf(file_ptr,\"%lf\", &amp;val);\nbuffer = (float *) val;\n</code></pre>\n\n<p>but i am not getting proper values<br>\ni am running this program on cygwin window</p>\n\n<p>values after decimal is always constant in number till 15 places </p>\n"}, {"tags": ["c", "arrays", "type-conversion", "mikroc"], "answers": [{"comments": [{"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1477467465, "post_id": 40256306, "comment_id": 67774054, "body": "pow ? Never use this function when you want integer, because pow(10,2) may return 99.9999, not 100. Juste have a variable &quot;pow&quot; initialized to 1, and pow *= 10 in the for."}, {"owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1477467553, "post_id": 40256306, "comment_id": 67774119, "body": "True, it is also going to be a double type and not an <code>int</code>."}], "tags": [], "owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "is_accepted": false, "score": -1, "last_activity_date": 1477467602, "last_edit_date": 1477467602, "creation_date": 1477467297, "answer_id": 40256306, "question_id": 40256242, "link": "https://stackoverflow.com/questions/40256242/converting-array-to-number-in-mikro-c/40256306#40256306", "title": "Converting array to number in (Mikro) C", "body": "<p>The digits represent the value in the tens place.</p>\n\n<pre><code>Array[0]*1 + Array[1]*10 + Array[2]*100 ... etc.\n</code></pre>\n\n<p>You could make a loop to do it.</p>\n\n<pre><code>int value = 0;\nint pow = 1;\nfor(int i = 0; i&lt;length; i++){\n\n   value += Array[i]*pow;\n   pow *=10;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "edited": false, "score": 0, "creation_date": 1477469978, "post_id": 40256468, "comment_id": 67775492, "body": "That is a bit funny. Maybe you should mention you mean the function <code>pow</code> in <code>math.h</code>. Also, what sort of system has a floating point number representation that cannot represent 100 accurately?  I guess c doesn&#39;t always define it, so it could be possible that your precision is less than 7 bits, but your example is still a bit far fetched."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "edited": false, "score": 0, "creation_date": 1477470167, "post_id": 40256468, "comment_id": 67775589, "body": "@matt Floating point accuracy and what it can&#39;t/can accurately represent isn&#39;t defined by the C standard. And implementations vary wildly. So it is absolutely not safe to assume that they&#39;re always going to be accurate."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 3, "creation_date": 1477471061, "post_id": 40256468, "comment_id": 67776122, "body": "It is defined in the floating point standard which should be used by c. There you have a guarantee that integers to a given point are always totally accurate."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1477472083, "post_id": 40256468, "comment_id": 67776821, "body": "@KamiKaze Should =/= Guaranteed. Its not safe. Floating point math in general in C is absolutely not safe."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1477636702, "post_id": 40256468, "comment_id": 67856537, "body": "This was not about calculation it was about accuracy. Depending on the given algorithm you can not be sure to hit an integer (i.e 0.9*10), but entering 9 you can be sure that it is 9. and not 8.99999. That&#39;s what I wanted to make clear."}], "tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 0, "last_activity_date": 1477467840, "creation_date": 1477467840, "answer_id": 40256468, "question_id": 40256242, "link": "https://stackoverflow.com/questions/40256242/converting-array-to-number-in-mikro-c/40256468#40256468", "title": "Converting array to number in (Mikro) C", "body": "<p>Given if all the array entries are <code>0-9</code>, and given they are in a data type that can be converted to <code>int</code> without a cast, this could work for you:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n\nint lenght = 6;\nint Array[lenght];\nArray[0] = 9;\nArray[1] = 4;\nArray[2] = 5;\nArray[3] = 8;\nArray[4] = 1;\nArray[5] = 0;\nint pow = 1;\nint val = 0;\n\nfor (int i = 0; i &lt; lenght; i++) {\n    val += Array[lenght-i-1] * pow;\n    pow *= 10;\n}\n\nprintf(\"Val is %d\", val);\nreturn 0;\n}\n</code></pre>\n\n<p>Note: This is a primitive, non error handled approach. It may not work in all cases.</p>\n\n<p>Reason for not using <code>pow</code>: </p>\n\n<p><code>pow</code> does not return a integer, leading to inaccuracies with implicit integer casts. E.G 100 could be 99.9999 instead and then get truncated to 99.</p>\n"}, {"comments": [{"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1477467954, "post_id": 40256497, "comment_id": 67774381, "body": "Thats actually a pretty elegant solution compared to the one I came up with below. +1 for that :)"}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 1, "last_activity_date": 1477468020, "last_edit_date": 1477468020, "creation_date": 1477467908, "answer_id": 40256497, "question_id": 40256242, "link": "https://stackoverflow.com/questions/40256242/converting-array-to-number-in-mikro-c/40256497#40256497", "title": "Converting array to number in (Mikro) C", "body": "<p>Use a loop. You must know the length of the number, or the length of the array. Unused positions in the array should be <code>0</code>.</p>\n\n<pre><code>int i;\nlong result = 0; // Choose a suitable integer type. \nfor (i = length; i &lt;= 0; --i) {\n    result = result * 10 + Array[i];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6856643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZsedKk7RqRk/AAAAAAAAAAI/AAAAAAAAACY/4tosZUJXtI0/photo.jpg?sz=128", "display_name": "Johan Gracious", "link": "https://stackoverflow.com/users/6856643/johan-gracious"}, "is_accepted": false, "score": 0, "last_activity_date": 1477468916, "creation_date": 1477468916, "answer_id": 40256797, "question_id": 40256242, "link": "https://stackoverflow.com/questions/40256242/converting-array-to-number-in-mikro-c/40256797#40256797", "title": "Converting array to number in (Mikro) C", "body": "<p>I'm not 100% sure what you are trying to do, but is this what you want to do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ( void )\n{\n\n    int numbers[] = { 1, 2, 3, 4, 5, 6 };\n    int multiplier = 1;\n\n    printf ( \"First printout\\n\" );\n    for ( int i = 0; i &lt; 5; ++i )\n        printf ( \"Numbers[%i] = %i\\n\", i, numbers[i] );\n\n    //this is where the numbers in the array are made into the 1, 10s, 100s etc\n    for ( int i = 0; i &lt; 5; ++i )\n    {\n        numbers[i] *= multiplier;\n        multiplier *= 10;\n    }\n\n    printf ( \"Second printout\\n\" );\n    for ( int i = 0; i &lt; 5; ++i )\n        printf ( \"Numbers[%i] = %i\\n\", i, numbers[i] );\n\n    return 0;\n\n}\n</code></pre>\n\n<p>I just started learning C a couple of months ago. I'm sure there are better ways to do this, but this is a solution that seems to solve your problem. I hope this helps!</p>\n"}], "owner": {"reputation": 123, "user_id": 6808434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/82af5faaa3e2d1dc766a6b990e82b563?s=128&d=identicon&r=PG&f=1", "display_name": "DowinskiField", "link": "https://stackoverflow.com/users/6808434/dowinskifield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1477468916, "creation_date": 1477467060, "question_id": 40256242, "link": "https://stackoverflow.com/questions/40256242/converting-array-to-number-in-mikro-c", "title": "Converting array to number in (Mikro) C", "body": "<p>I'm running into some coding troubles.</p>\n\n<p>I am reading serial input into my program, and it saves the numbers into an array.</p>\n\n<p>Now I want to convert this array into an integer to do calculations, where Array index 0 represents the one digits, index 1 the ten digits etc.</p>\n\n<pre><code>Array[0] represents 1 digit\nArray[1] represents 10 digit\nArray[2] represents 100 digit\nArray[3] represents 1000 digit\nArray[4] represents 10000 digit\nArray[5] represents 100000 digit\n</code></pre>\n\n<p>The array is dynamic, so could have only 2 indexes.</p>\n"}, {"tags": ["c", "windows", "winapi", "dll", "dll-injection"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1477465484, "post_id": 40255705, "comment_id": 67773013, "body": "Is the target a 64 bit process. You also ignore return value of NtCreateThreadEx.  Don&#39;t. What is that value."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477465823, "post_id": 40255705, "comment_id": 67773199, "body": "FWIW your code leaks handles like crazy but perhaps you know and don&#39;t care."}, {"owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477466009, "post_id": 40255705, "comment_id": 67773285, "body": "@DavidHeffernan it is the 64 bit notepad.exe , and I have also try to inject to the 64 bit Internet Explore.exe"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477467663, "post_id": 40255705, "comment_id": 67774194, "body": "And the return value? After all, in case of failure what is there to set hRemoteThread to NULL?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1477469702, "post_id": 40255705, "comment_id": 67775330, "body": "you need simply debug injector and target process for understand where/why error"}, {"owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477470242, "post_id": 40255705, "comment_id": 67775623, "body": "@DavidHeffernan   how to get the return value? And it cannot set hRemoteThread to NULL? <a href=\"http://securityxploded.com/ntcreatethreadex.php\" rel=\"nofollow noreferrer\">here</a>  sets it to null"}, {"owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477470874, "post_id": 40255705, "comment_id": 67776021, "body": "@DavidHeffernan I have debug it with  x64dbg, the return value of it is <code>00000000C00000F2</code> ."}, {"owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1477471152, "post_id": 40255705, "comment_id": 67776183, "body": "@RbMm I debug it with x64dbg , I attach x64dbg to the target process (64 bit notepad.exe) , and I set the debug events to be break when DLL attachs . But it doesnot  break ."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477471802, "post_id": 40255705, "comment_id": 67776596, "body": "That&#39;s <code>STATUS_INVALID_PARAMETER_4</code>, the 4th parameter is invalid. Failing to perform error checking is really poor. Injection is not easy. Ignoring the feedback doesn&#39;t make it easier."}, {"owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477472301, "post_id": 40255705, "comment_id": 67776978, "body": "@DavidHeffernan So you mean the parameter <code>hProcess</code> is invalid? But when I call <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code> , it doesnot throw any exception ."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477472672, "post_id": 40255705, "comment_id": 67777216, "body": "It&#39;s invalid in the eyes of <code>NtCreateThreadEx</code>. Of course, what the rules are for <code>NtCreateThreadEx</code> are unknown, it being undocumented. Why did you choose this particular injection method? So you can inject into a process in a different session? If you don&#39;t need to do that you can use other methods that use documented functions."}, {"owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477476422, "post_id": 40255705, "comment_id": 67779625, "body": "@DavidHeffernan what other methods can inject to other process in a different session?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1477477430, "post_id": 40255705, "comment_id": 67780249, "body": "I didn&#39;t say that there were other methods. I asked if that was why you chose this method"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1477538343, "post_id": 40255705, "comment_id": 67810270, "body": "Are you sure that you have the correct signature for the 64-bit version of NtCreateThreadEx ?"}], "answers": [{"tags": [], "owner": {"reputation": 1065, "user_id": 1458237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83a2bbacabb878f413699313f48a0e3?s=128&d=identicon&r=PG", "display_name": "djgandy", "link": "https://stackoverflow.com/users/1458237/djgandy"}, "is_accepted": false, "score": 0, "last_activity_date": 1477490904, "creation_date": 1477490904, "answer_id": 40264527, "question_id": 40255705, "link": "https://stackoverflow.com/questions/40255705/my-dll-injection-succeed-when-compiled-as-32-bit-but-failed-when-compiled-as/40264527#40264527", "title": "my dll injection . succeed when compiled as 32 bit , but failed when compiled as 64 bit", "body": "<p>I'd guess that the line causing you the 32/64-bit problem in your example is the following.</p>\n\n<pre><code>lpThreadProc = (LPTHREAD_START_ROUTINE)::GetProcAddress(hModule, \n\"LoadLibraryW\");\n</code></pre>\n\n<p>This gives you the address of LoadLibraryW in your current process, not that target process. Given the target process is 64-bit, the address is 99.99999% going to be different.</p>\n\n<p>Even within 32-bit processes you shouldn't generally assume that DLLs will always load into the same address footprint.</p>\n\n<p>To get around your issue you will probably have to enumerate modules within the target process and find your entry point from there. There are API's to help with this. A google for <code>GetRemoteProcAddress</code> will also point you in the right direction.</p>\n\n<p>That aside, there are many other issues with your loader. Personally I'd advise you to use one that someone else has already written. There used to be plenty of good loaders around that cover many of the caveats and have multiple injection mechanisms too.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "is_accepted": true, "score": 0, "last_activity_date": 1477567401, "creation_date": 1477567401, "answer_id": 40283404, "question_id": 40255705, "link": "https://stackoverflow.com/questions/40255705/my-dll-injection-succeed-when-compiled-as-32-bit-but-failed-when-compiled-as/40283404#40283404", "title": "my dll injection . succeed when compiled as 32 bit , but failed when compiled as 64 bit", "body": "<p>Thanks everyone , I have solved the problem . About the function <code>NtCreateThreadEx</code> , the type of the 8th , 9th and 10 th paramter (the <code>stacksize</code> parameter, the <code>dw1</code> parameter , the <code>dw2</code> parameter) should be <code>SIZE_T</code> , not <code>DWORD</code> . If it is <code>DWORD</code> , the it has no problem when you compile the code as 32 bit , but it would not work if you compile it as 64 bit . \nSo , this line of code should be written as below</p>\n\n<pre><code>typedef NTSTATUS (WINAPI *pFunction)(PHANDLE ThreadHandle, ACCESS_MASK DesiredAccess, LPVOID ObjectAttributes, HANDLE ProcessHandle, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, BOOL CreateSuspended, SIZE_T dwStackSize, SIZE_T dw1, DWORD SIZE_T, LPVOID pUnknown);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7073490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0474e3722e46fa34c74607f3d64f2?s=128&d=identicon&r=PG&f=1", "display_name": "freedom3", "link": "https://stackoverflow.com/users/7073490/freedom3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 40283404, "answer_count": 2, "score": -1, "last_activity_date": 1477567401, "creation_date": 1477465246, "question_id": 40255705, "link": "https://stackoverflow.com/questions/40255705/my-dll-injection-succeed-when-compiled-as-32-bit-but-failed-when-compiled-as", "title": "my dll injection . succeed when compiled as 32 bit , but failed when compiled as 64 bit", "body": "<p>My OS is Windows 8.1 64 bit . My program is to inject a <code>DLL</code> file to a target process,and when this DLL file attached to a process , it will create a <code>.txt</code> file on <code>D:</code> and write some words into it and save .It is just a test.But when I compile my program as a 32 bit program and my DLL code is compiled as 32 bit , it succeed , it can create the file and save the content . But when I compile my code of DLL  and my program as 64 bit , it hasnot throw any exception , all seems that it succeed . But you cannot find the <code>.txt</code> file it create . So , it fails , not excuting the things you want to do . </p>\n\n<p>The follow is my code of my DLL </p>\n\n<pre><code>#include \"stdafx.h\"\n#include&lt;Windows.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nBOOL create();\n\nBOOL APIENTRY DllMain( HMODULE hModule,\n                   DWORD  ul_reason_for_call,\n                   LPVOID lpReserved\n                 )\n{\nswitch (ul_reason_for_call)\n{\ncase DLL_PROCESS_ATTACH:\n    create();\n    break;\ncase DLL_PROCESS_DETACH:\n    break;\n}\nreturn TRUE;\n}\n\n\nBOOL create()\n{\nwchar_t FileName[] = L\"D:\\\\x64injecttest.txt\";\nHANDLE hFile = ::CreateFile(FileName, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_ALWAYS, NULL, NULL);\nif (hFile == INVALID_HANDLE_VALUE)\n{\n    printf(\"createfile fails,the error code is:%u\\n\", GetLastError());\n    system(\"PAUSE\");\n    return 0;\n}\n\nchar str[] = \"if you see this file,then you have success\\n\";\nWriteFile(hFile, str, strlen(str) + 1, NULL, NULL);\n\nCloseHandle(hFile);\nreturn TRUE;\n}\n</code></pre>\n\n<p>The follow is the code of my program</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;Windows.h&gt;\n#include&lt;TlHelp32.h&gt;\n\n\nLPTHREAD_START_ROUTINE lpThreadProc;   //pointes to the address of LoadLibraryW API\ntypedef DWORD(WINAPI *pFunction)(PHANDLE ThreadHandle, ACCESS_MASK DesiredAccess, LPVOID ObjectAttributes, HANDLE ProcessHandle, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, BOOL CreateSuspended, DWORD dwStackSize, DWORD dw1, DWORD dw2, LPVOID pUnknown); //I inject DLL to other process with the NtCreateThreadEx API , and this function pointer would point to the address of this API \n\n\nDWORD SearchForTarget(wchar_t target[])\n{\nPROCESSENTRY32 pe32;\npe32.dwSize = sizeof(pe32);\n\nHANDLE hSnap = ::CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);\nif (hSnap == INVALID_HANDLE_VALUE)\n{\n    printf(\"fails when createtoolhelp32snapshot,the error code is:%u\\n\", GetLastError());\n    system(\"PAUSE\");\n    exit(-1);\n}\n\nBOOL b = ::Process32First(hSnap, &amp;pe32);\nwhile (b)\n{\n    printf(\"the process name is:%ws\\n\", pe32.szExeFile);\n    printf(\"the process id is:%u\\n\", pe32.th32ProcessID);\n\n    if (wcscmp(pe32.szExeFile, target) == 0)\n        return pe32.th32ProcessID;\n\n    b = Process32Next(hSnap, &amp;pe32);\n}\n\nreturn -1;\n\n}\n\nBOOL InjectDLL(DWORD pid)\n{\n\nwchar_t DLLPath[] = L\"C:\\\\Users\\\\Dell-pc\\\\Desktop\\\\x64InjectTest\\\\Debug\\\\DLL.dll\";\n\nDWORD length = wcslen(DLLPath);\nDWORD trueLength = length * 2 + 2;\n\nHANDLE hProcess = ::OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);\nif (hProcess == INVALID_HANDLE_VALUE)\n{\n    printf(\"openprocess fails,the error code is:%u\\n\", GetLastError());\n    system(\"PAUSE\");\n    exit(-1);\n}\n\nLPVOID pBaseAddress = ::VirtualAllocEx(hProcess, NULL, trueLength, MEM_COMMIT, PAGE_READWRITE);\nif (pBaseAddress == NULL)\n{\n    printf(\"virtualallocex fails,the error code is:%u\\n\", GetLastError());\n    system(\"PAUSE\");\n    exit(-1);\n}\n\nBOOL b = WriteProcessMemory(hProcess, pBaseAddress, DLLPath, trueLength, NULL);\nif (b == 0)\n{\n    printf(\"writeprocessmemory fail,the error code is:%u\\n\", GetLastError());\n    system(\"PAUSE\");\n    exit(-1);\n}\n\nHMODULE hModule = ::LoadLibrary(L\"kernel32.dll\");\nlpThreadProc = (LPTHREAD_START_ROUTINE)::GetProcAddress(hModule, \"LoadLibraryW\");\n\nHMODULE hNtdll = ::LoadLibrary(L\"ntdll.dll\");\npFunction pFunc = (pFunction)GetProcAddress(hNtdll, \"NtCreateThreadEx\");\n\nprintf(\"it is ready to create thread\\n\");\n\nHANDLE hRemoteThread;\npFunc(&amp;hRemoteThread, 0x1FFFFF, NULL, hProcess, lpThreadProc, pBaseAddress, FALSE, NULL, NULL, NULL, NULL);\n\nif (hRemoteThread == NULL)\n{\n    printf(\"nrcreateprocessex fails,the error code is:%u\\n\", GetLastError());\n    system(\"PAUSE\");\n    exit(-1);\n}\n\nWaitForSingleObject(hRemoteThread, INFINITE);\n\nreturn TRUE;\n}\n\nint main()\n{\nwchar_t target[] = L\"notepad.exe\";   //inject my DLL to notepad.exe\nDWORD pid = SearchForTarget(target);\nif (pid == -1)\n{\n    printf(\"not find the target \\n\");\n    system(\"PAUSE\");\n    return -1;\n}\nInjectDLL(pid);\n\nsystem(\"PAUSE\");\n\nreturn 0;\n}\n</code></pre>\n\n<p>I compile my code (both my program and my DLL ) as 32 bit , and run it on my Windows 8.1 64 bit OS , it succeed . But when I compile it (both my program and my DLL) as 64 bit , it hasnot throw any exception , and it seems it succeed , only except it has not create the file and write some words into it (and this is what should do when the DLL attached to the process ) . So , anyone know where the problem is ? One more thing , I use Visual Studio 2013 .</p>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477471841, "post_id": 40255524, "comment_id": 67776628, "body": "<code>char (*p)[2][3][4] = (char(*)[2][3][4])&amp;blk;</code> Using p from this point on is undefined behavior."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1477472463, "post_id": 40255524, "comment_id": 67777063, "body": "@2501 <code>char *blk = malloc(1000); if(!blk) return -1; char (*p)[2][3][4] = (char(*)[2][3][4])blk</code> better?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1477473802, "post_id": 40255524, "comment_id": 67777981, "body": "One is defined, the other isn&#39;t. And you&#39;re allocating too much memory since 1000 isn&#39;t divisible by 24."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477489453, "post_id": 40255524, "comment_id": 67788359, "body": "OT: Doing <code>void * blk;</code> would drop the need for this ugly cast."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1477465380, "last_edit_date": 1477465380, "creation_date": 1477464785, "answer_id": 40255557, "question_id": 40255524, "link": "https://stackoverflow.com/questions/40255524/casting-a-flat-pointer-to-a-multidimensional-array/40255557#40255557", "title": "Casting a flat pointer to a multidimensional array", "body": "<p>You added an extra dimension, try this instead:</p>\n\n<pre><code>char (*p)[3][4] = (char(*)[3][4])blk;\n</code></pre>\n\n<p>Also note that your <code>printf</code> format is incorrect: the difference of 2 pointers has type <code>ptrdiff_t</code>, the corresponding format length modifier is <code>t</code>:</p>\n\n<pre><code>#define At(a,x,y,z) printf(\"[\"#x\"][\"#y\"][\"#z\"]=%td\\n\", &amp;(a)[x][y][z] - &amp;(a)[0][0][0]);\n</code></pre>\n\n<p>If your C library is not fully C99 compliant, you should use a cast:</p>\n\n<pre><code>#define At(a,x,y,z) printf(\"[\"#x\"][\"#y\"][\"#z\"]=%ld\\n\", (long)(&amp;(a)[x][y][z] - &amp;(a)[0][0][0]));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13596, "user_id": 551045, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d3cf04e39bcaab5592938990ea158d51?s=128&d=identicon&r=PG", "display_name": "RedX", "link": "https://stackoverflow.com/users/551045/redx"}, "is_accepted": true, "score": 1, "last_activity_date": 1477464860, "creation_date": 1477464860, "answer_id": 40255592, "question_id": 40255524, "link": "https://stackoverflow.com/questions/40255524/casting-a-flat-pointer-to-a-multidimensional-array/40255592#40255592", "title": "Casting a flat pointer to a multidimensional array", "body": "<p>I think you are missing a dereference. You now have a pointer to a 3 dimensional array.</p>\n\n<p>You need to do this:</p>\n\n<pre><code>At(*p, 0, 0, 1);\n</code></pre>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 40255592, "answer_count": 2, "score": 2, "last_activity_date": 1477472541, "creation_date": 1477464665, "last_edit_date": 1477472541, "question_id": 40255524, "link": "https://stackoverflow.com/questions/40255524/casting-a-flat-pointer-to-a-multidimensional-array", "title": "Casting a flat pointer to a multidimensional array", "body": "<p>Is it possible to get the compiler to do the same pointer arithmetic on flat pointers as it does on multidimensional arrays?</p>\n\n<p>With multidimensional arrays, the pointer arithmetic appears to work as follows:</p>\n\n<pre><code>int main(void)\n{\n    char ar[2][3][4];\n#define At(a,x,y,z) printf(\"[\"#x\"][\"#y\"][\"#z\"]=%ld\\n\", &amp;(a)[x][y][z] - &amp;(a)[0][0][0]);\n    At(ar,0,0,0);\n    At(ar,0,0,1);\n    At(ar,0,0,2);\n    At(ar,0,0,3);\nputs(\"\");\n    At(ar,0,1,0);\n    At(ar,0,2,0);\n    At(ar,0,3,0);\nputs(\"\");\n    At(ar,1,0,0);\n    At(ar,2,0,0);\n    At(ar,3,0,0);\n/*\n    [0][0][0]=0\n    [0][0][1]=1\n    [0][0][2]=2\n    [0][0][3]=3\n\n    [0][1][0]=4  // 1 * 4\n    [0][2][0]=8  // 2 * 4\n    [0][3][0]=12 // 3 * 4\n\n    [1][0][0]=12 // 1 * 3 * 4\n    [2][0][0]=24 // 2 * 3 * 4\n    [3][0][0]=36 // 3 * 3 * 4 \n*/\n}\n</code></pre>\n\n<p>So I tried:</p>\n\n<pre><code>    char *blk;\n    if(!(blk=malloc(1000))) return -1;\n    char (*p)[2][3][4] = (char(*)[2][3][4])blk;\n\n    At(p,0,0,0);\n    At(p,0,0,1);\n    At(p,0,0,2);\n    At(p,0,0,3);\nputs(\"\");\n    At(p,0,1,0);\n    At(p,0,2,0);\n    At(p,0,3,0);\nputs(\"\");\n    At(p,1,0,0);\n    At(p,2,0,0);\n    At(p,3,0,0);\n\n/*\n    [0][0][0]=0\n    [0][0][1]=1\n    [0][0][2]=2\n    [0][0][3]=3\n\n    [0][1][0]=3\n    [0][2][0]=6\n    [0][3][0]=9\n\n    [1][0][0]=6\n    [2][0][0]=12\n    [3][0][0]=18\n*/\n}\n</code></pre>\n\n<p>But as you can see, this doesn't give corresponding results. \nWhat exactly is going on here? Can the results be made to match?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1477464630, "post_id": 40255465, "comment_id": 67772551, "body": "Why do you only access <code>data[x].depend[x]</code> when your <code>depend</code> has two dimensions? I mean, thats not your issue, but methinks that may be unintended."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1477466158, "post_id": 40255465, "comment_id": 67773368, "body": "Sizeof <code>parseData</code> is 3MB. <code>struct parseData data[5000]</code> trys to get 15GB from your stack. Do you have enough RAM?"}], "answers": [{"tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 0, "last_activity_date": 1477466099, "last_edit_date": 1495535248, "creation_date": 1477466099, "answer_id": 40255946, "question_id": 40255465, "link": "https://stackoverflow.com/questions/40255465/placing-values-into-array-of-structs/40255946#40255946", "title": "Placing values into array of structs?", "body": "<p>If the error is in <code>fseek(fp,0L,SEEK_END);</code> you probably haven't opened the file or an error occurred when you open the file.</p>\n\n<p>Did you check the return from <code>fp=fopen(...);</code> wasn't <code>NULL</code>?</p>\n\n<p>You haven't posted a Minimum Verifiable Complete Example (MVCE) so it's hard to provide much help.</p>\n\n<p><a href=\"https://stackoverflow.com/help/mcve\">https://stackoverflow.com/help/mcve</a></p>\n"}, {"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 0, "last_activity_date": 1477468086, "last_edit_date": 1477468086, "creation_date": 1477466226, "answer_id": 40255982, "question_id": 40255465, "link": "https://stackoverflow.com/questions/40255465/placing-values-into-array-of-structs/40255982#40255982", "title": "Placing values into array of structs?", "body": "<pre><code>struct parseData {\n    char rules[1000][1000];\n    char depend[1000][1000];\n    char commands[1000][1000];\n};\n\nstruct parseData data[5000];\n</code></pre>\n\n<p><code>parseData</code> need 3MB for these 3 2-dimensional arrays, so <code>data</code> needs 15GB of memory. This is way above stack limit (usually about 10MB or 100MB depending on compiler). Your code suggests the arrays can be reduced as follows:</p>\n\n<pre><code>struct parseData \n{\n    char rules[1000][50];\n    char depend[1000][50];\n};\n...\nstruct parseData data[1000];\n</code></pre>\n\n<p><code>data</code> will still need 100MB of memory, which is probably still over stack limit. Therefore you should declare <code>data</code> on heap.</p>\n\n<pre><code>struct parseData data[1000];\nint main()\n{\n    ...\n}\n</code></pre>\n\n<p>You can also write a small test program for using <code>realloc</code>, this allows you to increase the amount the memory during run time, so you won't need a huge buffer.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5615247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477751610, "creation_date": 1477464441, "last_edit_date": 1477751610, "question_id": 40255465, "link": "https://stackoverflow.com/questions/40255465/placing-values-into-array-of-structs", "title": "Placing values into array of structs?", "body": "<p>I'm having trouble putting values into my array of structs. With a single struct it works fine, however as soon as I make an array of them, I get a \"Segmentation fault (core dumped)\" error. I've run this code through a debugger and it says that the segfault is caused in <code>readFile</code> at <code>fseek(fp,0L,SEEK_END)</code>. if I remove the variables that has to do with any sort of memory allocation, the error simply shifts to the next variable in the line.</p>\n\n<p>I'm pretty sure this has something to do with how I am trying to put values into the array of structs.</p>\n\n<p>the method that I am using to put the values that I need, into the struct array.</p>\n\n<p>I realise this code is really rough, I'm just trying to get a working model before cleaning it up.</p>\n"}, {"tags": ["c", "pointers", "void"], "comments": [{"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 1, "creation_date": 1477463650, "post_id": 40255234, "comment_id": 67772055, "body": "<code>pNewBuffer</code> is what?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477463654, "post_id": 40255234, "comment_id": 67772056, "body": "what is <code>pNewBuffer</code>?"}, {"owner": {"reputation": 2438, "user_id": 6517320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5AiJr.jpg?s=128&g=1", "display_name": "Ivan Rubinson", "link": "https://stackoverflow.com/users/6517320/ivan-rubinson"}, "edited": false, "score": 1, "creation_date": 1477463821, "post_id": 40255234, "comment_id": 67772132, "body": "What&#39;s <code>sizeof(int)</code> on your machine? If it&#39;s 4 bytes, <code>printf</code> will print 4 bytes (even though you <code>malloc</code> 8)"}, {"owner": {"reputation": 852, "user_id": 1917004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e12a0abb82fac3b2293597967a7ec90d?s=128&d=identicon&r=PG", "display_name": "ctrl-shift-esc", "link": "https://stackoverflow.com/users/1917004/ctrl-shift-esc"}, "edited": false, "score": 1, "creation_date": 1477463859, "post_id": 40255234, "comment_id": 67772154, "body": "You&#39;re printing with <code>%d</code> and casting the pointer to an <code>int*</code> type. It will print an <code>int</code> for how ever long that is."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1477463764, "creation_date": 1477463764, "answer_id": 40255293, "question_id": 40255234, "link": "https://stackoverflow.com/questions/40255234/c-memcpy-two-ints-to-a-single-void-pointer/40255293#40255293", "title": "C - Memcpy two int&#39;s to a single Void pointer", "body": "<p>The major problem here is this part</p>\n\n<pre><code>memcpy (&amp;buffer, ...);\n//      ^\n</code></pre>\n\n<p>First of all, if you want an \"array\" or <code>int</code> then why don't you use a pointer to <code>int</code>? You can always cast it to a generic <code>void *</code> later. This will solve <em>one</em> problem, which is the pointer arithmetic you attempt to do in the second <code>memcpy</code> call.</p>\n\n<p>Going back to my highlighted part, using the address-of operator for <code>buffer</code> is <em>wrong</em> and will pass a pointer to where the <em>variable</em> <code>buffer</code> is stored, not the address where <code>buffer</code> is pointing. Drop the address-of operator there.</p>\n\n<p>To sum it up:</p>\n\n<pre><code>int *int_buffer = malloc(sizeof *int_buffer * 2);\nmemcpy(int_buffer, &amp;int1, sizeof int1);     // or &amp;int_buffer[0]\nmemcpy(int_buffer + 1, &amp;int2, sizeof int2); // or &amp;int_buffer[1]\n\nvoid *buffer = int_buffer;\n</code></pre>\n\n<hr>\n\n<p>For your printing, you only tell <code>printf</code> to print the very first <code>int</code> element. If you want to print both <code>int</code> elements you need to tell <code>printf</code> to do that.</p>\n"}, {"comments": [{"owner": {"reputation": 10492, "user_id": 146377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b36bf29056af38269b2147d5c36b94e?s=128&d=identicon&r=PG", "display_name": "Patrick Schl&#252;ter", "link": "https://stackoverflow.com/users/146377/patrick-schl%c3%bcter"}, "edited": false, "score": 0, "creation_date": 1477570105, "post_id": 40255298, "comment_id": 67826661, "body": "The post is marked C, so no type cast from <code>void *</code> to <code>int *</code> is necessary. You can also avoid the use of the <code>buffer</code> alltogether. <code>int *intbuffer = malloc(sizeof(int)*2);</code> is enough."}], "tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": true, "score": 3, "last_activity_date": 1477464176, "last_edit_date": 1477464176, "creation_date": 1477463771, "answer_id": 40255298, "question_id": 40255234, "link": "https://stackoverflow.com/questions/40255234/c-memcpy-two-ints-to-a-single-void-pointer/40255298#40255298", "title": "C - Memcpy two int&#39;s to a single Void pointer", "body": "<p>You are copying to pointer of the pointer.</p>\n\n<p>Change these two lines:</p>\n\n<pre><code>memcpy (&amp;buffer, &amp;int1, sizeof(int));\nmemcpy (&amp;buffer + sizeof(int), &amp;int2, sizeof(int));\n</code></pre>\n\n<p>To be this:</p>\n\n<pre><code>memcpy (buffer, &amp;int1, sizeof(int));\nmemcpy (buffer + sizeof(int), &amp;int2, sizeof(int));\n</code></pre>\n\n<p>Better form:</p>\n\n<pre><code>void* buffer = malloc(sizeof(int) * 2);\nint* intbuffer = (int*)buffer;\n\nmemcpy(intbuffer, &amp;int1, sizeof(int));\nmemcpy(intbuffer+1, &amp;int2, sizeof(int));\n</code></pre>\n\n<p>You can even avoid the memcpy altogether:</p>\n\n<pre><code>void* buffer = malloc(sizeof(int) * 2);\nint* intbuffer = (int*)buffer;\n\nintbuffer[0] = int1;\nintbuffer[1] = int2;\n</code></pre>\n\n<p>The corresponding <code>printf(\"%d\", *(int*)buffer);</code> works for all three examples above.</p>\n"}], "owner": {"reputation": 47, "user_id": 5995267, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70c7dece0320c569a1f3ca3cc1c776b8?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/5995267/nark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "accepted_answer_id": 40255298, "answer_count": 2, "score": 0, "last_activity_date": 1477464176, "creation_date": 1477463543, "last_edit_date": 1477463791, "question_id": 40255234, "link": "https://stackoverflow.com/questions/40255234/c-memcpy-two-ints-to-a-single-void-pointer", "title": "C - Memcpy two int&#39;s to a single Void pointer", "body": "<p>I am trying to copy two ints into a void pointer, and be able to access them, so far no luck.</p>\n\n<pre><code>void *buffer;\nbuffer = malloc (sizeof(int) + sizeof(int))\nmemcpy (&amp;buffer, &amp;int1, sizeof(int));\nmemcpy (&amp;buffer + sizeof(int), &amp;int2, sizeof(int));\nprintf (\"%d\", *(int*)buffer);\n</code></pre>\n\n<p>When printing, all I get is the value in the first 4 bytes. Any help would be appreciated, thanks.</p>\n"}, {"tags": ["c", "rust", "ffi"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1477464095, "post_id": 40255192, "comment_id": 67772266, "body": "I assume you can&#39;t change the library function? Then you probably have to live with the cast and the warning."}, {"owner": {"reputation": 6933, "user_id": 2580955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WZR9N.jpg?s=128&g=1", "display_name": "s3rvac", "link": "https://stackoverflow.com/users/2580955/s3rvac"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1477464410, "post_id": 40255192, "comment_id": 67772433, "body": "@Someprogrammerdude No, I cannot change the C library."}], "answers": [{"tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": false, "score": 0, "last_activity_date": 1477466032, "creation_date": 1477466032, "answer_id": 40255928, "question_id": 40255192, "link": "https://stackoverflow.com/questions/40255192/how-to-handle-passing-usize-to-a-c-function-that-expects-uint32-t/40255928#40255928", "title": "How to handle passing usize to a C function that expects uint32_t?", "body": "<ul>\n<li>If it makes sense to read/write chunks with <code>lib_foo</code>, wrap it in a loop that processes chunks of 2**32 (at increasing offsets) and then processes the remainder. In most cases it will skip the loop, but in the exceptional case, it will just call <code>lib_foo</code> more than once</li>\n<li>If truncating is acceptable behavior for <code>lib_foo</code>, truncate and tell user somehow</li>\n<li>If it's not, complain loudly if len >= 2**32</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 28979, "user_id": 266720, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7c9333e1816aefc7fc97f64b09afe05c?s=128&d=identicon&r=PG", "display_name": "Vi.", "link": "https://stackoverflow.com/users/266720/vi"}, "edited": false, "score": 0, "creation_date": 1482264574, "post_id": 40256023, "comment_id": 69701204, "body": "For <code>unsigned char</code> it is reasonable, but isn&#39;t lengthening <code>u32</code> to <code>libc::uint32_t</code> excessive, as <code>uint32_t</code> clearly and explicitly intended to always represent a 32-bit unsigned integer, just like <code>u32</code>?"}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "reply_to_user": {"reputation": 28979, "user_id": 266720, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7c9333e1816aefc7fc97f64b09afe05c?s=128&d=identicon&r=PG", "display_name": "Vi.", "link": "https://stackoverflow.com/users/266720/vi"}, "edited": false, "score": 0, "creation_date": 1482431119, "post_id": 40256023, "comment_id": 69781417, "body": "@Vi.: On the other hand, when you have a C header file to translate to Rust, it&#39;s so much easier to just slap <code>libc::</code> in front of the type name and be done with it."}], "tags": [], "owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1477466325, "creation_date": 1477466325, "answer_id": 40256023, "question_id": 40255192, "link": "https://stackoverflow.com/questions/40255192/how-to-handle-passing-usize-to-a-c-function-that-expects-uint32-t/40256023#40256023", "title": "How to handle passing usize to a C function that expects uint32_t?", "body": "<p>First of all, please use the <a href=\"https://crates.io/crates/libc\" rel=\"nofollow\"><code>libc</code></a> crate for types.</p>\n\n<p>That is: <code>extern fn lib_foo(buf: *const libc::c_uchar, buf_len: libc::uint32_t);</code></p>\n\n<p>While it is slightly longer, it will avoid making assumption (<code>unsigned char</code> maps to <code>u8</code>) and makes the translation automatic.</p>\n\n<hr>\n\n<p>Then, onto the high level wrapper.</p>\n\n<p>Without any assumption, the simplest solution is to panic, and document this.</p>\n\n<pre><code>/// Calls `lib_foo`, ...\n///\n/// # Panics\n///\n/// If the size of the buffer is strictly greater than 2^32-1 bytes.\npub fn foo(buf: &amp;[u8]) {\n    assert!(buf.len() &lt;= (std::u32::MAX as usize));\n\n    unsafe { lib_foo(buf.as_ptr() as *const _, buf.len() as libc::uint32_t) }\n}\n</code></pre>\n\n<p>Then, depending on the domain, other options may arise:</p>\n\n<ul>\n<li>saturation may be an option (using <code>std::cmp::min</code>)</li>\n<li>repeated calls may be another</li>\n<li>...</li>\n</ul>\n\n<p>in any case, if the difference of behavior is observable to the user, <em>document</em>.</p>\n"}], "owner": {"reputation": 6933, "user_id": 2580955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WZR9N.jpg?s=128&g=1", "display_name": "s3rvac", "link": "https://stackoverflow.com/users/2580955/s3rvac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 40256023, "answer_count": 2, "score": 1, "last_activity_date": 1477466703, "creation_date": 1477463391, "question_id": 40255192, "link": "https://stackoverflow.com/questions/40255192/how-to-handle-passing-usize-to-a-c-function-that-expects-uint32-t", "title": "How to handle passing usize to a C function that expects uint32_t?", "body": "<p>I am writing a Rust wrapper around a C library. The C library provides the following function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void lib_foo(const unsigned char *buf, uint32_t buf_len);\n</code></pre>\n\n<p>I have created the following <code>extern</code> wrapper:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>fn lib_foo(buf: *const u8, buf_len: u32);\n</code></pre>\n\n<p>and the following high-level wrapper:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>pub fn foo(buf: &amp;[u8]) {\n    unsafe { lib_foo(buf.as_ptr(), buf.len() as u32) }\n}\n</code></pre>\n\n<p>However, the cast from <code>usize</code> (the type of <code>buf.len()</code>) to <code>u32</code> may cause the size to be truncated. What is the best way of dealing with this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 8, "creation_date": 1477460515, "post_id": 40254527, "comment_id": 67770750, "body": "why you can&#39;t use simple assignment?"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 3, "creation_date": 1477460652, "post_id": 40254527, "comment_id": 67770798, "body": "Why do you think you need anything different from a regular assignment? Do you realize that the fact that you use <code>strcpy</code> comes from the fact that you are copying NUL-terminated arrays of bytes, and has nothing to do with structures?"}, {"owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "edited": false, "score": 0, "creation_date": 1477461061, "post_id": 40254527, "comment_id": 67770964, "body": "The &#39;normal&#39; use to copy a integer value is really simpler. Just assign as <code>holder[pos].key = new.key</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1477463036, "post_id": 40254527, "comment_id": 67771769, "body": "It would help to see the structure definition."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477464545, "post_id": 40254527, "comment_id": 67772506, "body": "What about <code>memcpy()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 6160020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YKm7XmRRzWk/AAAAAAAAAAI/AAAAAAAABMA/0SMhweWTkPY/photo.jpg?sz=128", "display_name": "aneesh jose", "link": "https://stackoverflow.com/users/6160020/aneesh-jose"}, "is_accepted": false, "score": 1, "last_activity_date": 1477462275, "creation_date": 1477462275, "answer_id": 40254927, "question_id": 40254527, "link": "https://stackoverflow.com/questions/40254527/is-there-something-similar-to-strcpy-but-for-int-value/40254927#40254927", "title": "Is there something similar to strcpy but for int value?", "body": "<p>please use </p>\n\n<p><code>holder[pos].position = new.position</code> </p>\n"}, {"tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 3, "last_activity_date": 1477463678, "last_edit_date": 1477463678, "creation_date": 1477462635, "answer_id": 40255015, "question_id": 40254527, "link": "https://stackoverflow.com/questions/40254527/is-there-something-similar-to-strcpy-but-for-int-value/40255015#40255015", "title": "Is there something similar to strcpy but for int value?", "body": "<p>You don't need <code>strcpy</code> or any special function for that. Strcopy is only necessary because strings aren't strictly just a data type in C, but null-terminated char arrays.</p>\n\n<p>You can do it like this:</p>\n\n<pre><code>holder[pos].position = new.position; // Assigns the value of new.position to holder[pos].position\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7073118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ec6a629bd5614727efdbcf9c3a835c?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/7073118/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4203, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1477527118, "creation_date": 1477460466, "last_edit_date": 1477527118, "question_id": 40254527, "link": "https://stackoverflow.com/questions/40254527/is-there-something-similar-to-strcpy-but-for-int-value", "title": "Is there something similar to strcpy but for int value?", "body": "<p>Thank you, it works ....................................................................                                                               </p>\n\n<pre><code>strcpy(holder[pos].key, new.key); \n\nholder[pos].position = new.position\n\nstrcpy(holder[pos].name, new.name);\n\nstrcpy(holder[pos].country, new.country);\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1477459564, "post_id": 40254326, "comment_id": 67770411, "body": "<a href=\"https://www.google.com/search?q=c+dynamic+array\" rel=\"nofollow noreferrer\">google.com/search?q=c+dynamic+array</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1477459636, "post_id": 40254326, "comment_id": 67770436, "body": "Have you ever heard of <a href=\"http://en.cppreference.com/w/c/memory/malloc\" rel=\"nofollow noreferrer\"><code>malloc</code></a> and <a href=\"http://en.cppreference.com/w/c/memory/free\" rel=\"nofollow noreferrer\"><code>free</code></a>?"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477462516, "post_id": 40254384, "comment_id": 67771531, "body": "So this isn&#39;t &quot;one&quot; array, but &quot;1 + rows*columns&quot; arrays."}, {"owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477463373, "post_id": 40254384, "comment_id": 67771944, "body": "This is how C works, you cannot dynamically allocate &quot;one 2D array&quot;. Because statically allocated 2D arrays (m x n) are actually allocated as a 1D array of length m<i>n, and then when accessing this array like arr[i][j], it accesses memory position [i</i>n+j], but since the compiler isn&#39;t aware of &quot;n&quot; when the array is dynamically allocated, you can&#39;t assign it as one array, if you do you can&#39;t access it as arr[i][j]"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477463726, "post_id": 40254384, "comment_id": 67772088, "body": "&quot;<i>you cannot dynamically allocate &quot;one 2D array&quot;</i>&quot; you can! :-) You might like to have a look at my answer."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477463984, "post_id": 40254384, "comment_id": 67772211, "body": "What your example creates is called a &quot;jagged&quot; array, it&#39;s scattered, not using one continuous block of memory."}, {"owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1477464199, "post_id": 40254384, "comment_id": 67772327, "body": "yes, it&#39;s not allocated contiguously in memory, and it&#39;s a little wasteful of memory because you have an array of length &quot;r&quot; of pointers that doesn&#39;t really store useful data. But this is the easiest way to do it, without changing access code."}], "tags": [], "owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "is_accepted": true, "score": 2, "last_activity_date": 1477459793, "creation_date": 1477459793, "answer_id": 40254384, "question_id": 40254326, "link": "https://stackoverflow.com/questions/40254326/how-can-i-create-dynamically-allocated-array-in-c/40254384#40254384", "title": "How can i create dynamically allocated array In C", "body": "<p>Assuming you have the number of rows \"r\"  and the number of columns \"c\", you can do this:</p>\n\n<pre><code>int **arr;\narr = malloc(r*sizeof(int*));\nfor(int i=0; i &lt; r; i++)\n{\n    arr[i] = malloc(c*sizeof(int));\n}\n</code></pre>\n\n<p>this dynamically allocates an array of pointers to integers, and then allocates arrays of integers to each pointer. Don't forget to delete dynamically allocated arrays when you're done, in this case you should delete the integer arrays first and then the pointer array:</p>\n\n<pre><code>for(int i=0; i &lt; r; i++)\n{\n    free(arr[i]);\n}\nfree(arr);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1477462988, "last_edit_date": 1477462988, "creation_date": 1477462180, "answer_id": 40254899, "question_id": 40254326, "link": "https://stackoverflow.com/questions/40254326/how-can-i-create-dynamically-allocated-array-in-c/40254899#40254899", "title": "How can i create dynamically allocated array In C", "body": "<p>Define a pointer to an array and allocated as much memory it is defined to point to:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\n#define ROWS (5)\n#define COLUMNS (7)\n\n\nint main(void)\n{\n  /* Define and initialise the pointer to the array. */\n  int (*p)[ROWS][COLUMNS] = malloc(sizeof *p);\n\n  if (NULL == p)\n  {\n    perror(\"malloc() failed\");\n    return EXIT_FAILURE;\n  }\n\n  /* Initialize the array's members. */\n  {\n    size_t r, c;\n\n    for (r = 0; r &lt; ROWS; ++r)\n    {\n      for (c = 0; c &lt; COLUMNS; ++c)\n      {\n        (*p)[r][c] = r * c;\n      }\n    }\n  }\n\n  /* Print the array's members' values. */\n  {\n    size_t r, c;\n\n    for (r = 0; r &lt; ROWS; ++r)\n    {\n      for (c = 0; c &lt; COLUMNS; ++c)\n      {\n        printf(\"array[%zu][%zu] = %d\\n\", r, c (*p)[r][c]);\n      }\n    }\n  }\n\n  /* Free the array. */\n\n  free(p)\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>If the C implementation in use supports VLAs one alternatively can do:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint main(void)\n{\n  size_t ROWS = 5;\n  size_t COLUMNS = 7;\n\n  ...\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4431945, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4bPcd.jpg?s=128&g=1", "display_name": "Ananthu", "link": "https://stackoverflow.com/users/4431945/ananthu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2852, "favorite_count": 0, "closed_date": 1477464310, "accepted_answer_id": 40254384, "answer_count": 2, "score": -6, "last_activity_date": 1477462988, "creation_date": 1477459487, "last_edit_date": 1477462739, "question_id": 40254326, "link": "https://stackoverflow.com/questions/40254326/how-can-i-create-dynamically-allocated-array-in-c", "closed_reason": "Duplicate", "title": "How can i create dynamically allocated array In C", "body": "<p>How can I allocate memory to an array dynamically(2D)? </p>\n\n<pre><code>    int arr[n];\n</code></pre>\n\n<p>If I need more or less memory, the dynamic allocation will be more suitable.How can i Do it in C?</p>\n"}, {"tags": ["c", "arrays", "sorting", "median"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1477458495, "post_id": 40254137, "comment_id": 67770084, "body": "Have you verified that they are in sorted order?  Have you done any kind of debugging yet?  If you had, you would probably find that you have written your sorting function incorrectly.  But I&#39;ll leave that as an exercise for you to figure out."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477458683, "post_id": 40254137, "comment_id": 67770137, "body": "Welcome to Stack Overflow! Please show your research/debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}], "answers": [{"tags": [], "owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "is_accepted": false, "score": 0, "last_activity_date": 1477460424, "creation_date": 1477460424, "answer_id": 40254514, "question_id": 40254137, "link": "https://stackoverflow.com/questions/40254137/c-program-random-number-array-program-and-sort-in-ascending-order-then-find/40254514#40254514", "title": "(C program) Random Number Array program, and sort in ascending order, then find the median", "body": "<p>Why do you always assume the median is \"tenarray[5]\"? This will only work if SIZE=11, you should do something like this:</p>\n\n<pre><code>if(SIZE%2==1)\n    median = tenarray[SIZE/2];\nelse\n    median = (tenarray[SIZE/2] + tenarray[(SIZE/2)-1])/2;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7055071, "user_type": "registered", "profile_image": "https://graph.facebook.com/1196265837104225/picture?type=large", "display_name": "Parker Pattillo", "link": "https://stackoverflow.com/users/7055071/parker-pattillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2938, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1477460424, "creation_date": 1477458441, "question_id": 40254137, "link": "https://stackoverflow.com/questions/40254137/c-program-random-number-array-program-and-sort-in-ascending-order-then-find", "title": "(C program) Random Number Array program, and sort in ascending order, then find the median", "body": "<p>I've created an array with random numbers, and then afterwards it will sort the numbers in ascending order, and then I want to print what the median is of the sorted numbers, but I have no idea what I'm doing wrong in my program, it just won't give me the median. I know it must be something that is so simple but I can't seem to figure out what I'm doing wrong</p>\n\n<pre><code>int main() \n{\n\nint *tenarray = (int *) malloc(sizeof(int) * SIZE);\nint i;\nint j;\nint num;\nint swap;\nint median;\nsrand(time(NULL));\n\nfor (i = 0; i &lt; SIZE; i++)\n{\n    num = rand() % 100;\n    tenarray[i] = num;\n    printf(\"%d\\n\", tenarray[i]);\n}\n\nfor (i=0; i&lt;SIZE; i++)\n{\n    for (j=0; j&lt;SIZE+1; j++)\n    {\n        if(tenarray[j] &gt; tenarray[j+1])\n        {\n            swap = tenarray[j];\n            tenarray[j] = tenarray[j+1];\n            tenarray[j+1] = swap;\n\n        }\n    }\n}\n\n\nfor(i=0; i&lt;SIZE; i++)\n{\n    printf(\"Ascending bubble sort is: %d\\n\", tenarray[i]);\n\n}\n\nmedian = (tenarray[5]);\nprintf(\"median is: %d\\n\", median);\n\nsystem(\"PAUSE\");\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "getopt"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1477458919, "post_id": 40254116, "comment_id": 67770209, "body": "Go back to that manpage, read the bit that says <i>&quot;optstring is a string containing the legitimate option characters. If such a character is followed by a colon, the option requires an argument, so getopt() places a pointer to the following text in the same argv-element, or the text of the following argv-element, in optarg.&quot;</i> -- then read it again and again until it sinks in."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477459149, "post_id": 40254116, "comment_id": 67770294, "body": "No offense, is it you who asked a similar question just yesterday?"}, {"owner": {"reputation": 1562, "user_id": 6828329, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cb5516b7f44760e32dcceabb543a0ebc?s=128&d=identicon&r=PG&f=1", "display_name": "The Pointer", "link": "https://stackoverflow.com/users/6828329/the-pointer"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477459186, "post_id": 40254116, "comment_id": 67770301, "body": "@SouravGhosh Yes it is."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1477459240, "post_id": 40254116, "comment_id": 67770315, "body": "OK, this time instead of a longer comment, I compiled an actual answer. See if that helps."}], "answers": [{"comments": [{"owner": {"reputation": 1562, "user_id": 6828329, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cb5516b7f44760e32dcceabb543a0ebc?s=128&d=identicon&r=PG&f=1", "display_name": "The Pointer", "link": "https://stackoverflow.com/users/6828329/the-pointer"}, "edited": false, "score": 1, "creation_date": 1477460113, "post_id": 40254216, "comment_id": 67770607, "body": "I got it. Thanks."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1477459366, "last_edit_date": 1477459366, "creation_date": 1477458898, "answer_id": 40254216, "question_id": 40254116, "link": "https://stackoverflow.com/questions/40254116/the-variable-optarg-of-getopt/40254216#40254216", "title": "The variable optarg of getopt()", "body": "<p>The <a href=\"https://linux.die.net/man/3/optarg\" rel=\"noreferrer\">man page</a> says, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p><em>optstring</em> is a string containing the legitimate option characters. If such a character is followed by a colon, the option requires an argument, so <code>getopt()</code> places <strong>a pointer to the following text in the same argv-element, or the text of the following argv-element, in <code>optarg</code></strong>. Two colons mean an option takes an optional arg; if there is text in the current argv-element (i.e., in the same word as the option name itself, for example, \"-oarg\"), then it is returned in optarg, otherwise optarg is set to zero. [...]</p>\n</blockquote>\n\n<p>and the given code snippet below shows the usage.</p>\n\n<pre><code>while ((opt = getopt(argc, argv, \"nt:\")) != -1) {\n    switch (opt) {\n    case 'n':\n        flags = 1;\n        break;\n    case 't':\n        nsecs = atoi(optarg);\n        tfnd = 1;\n        break;\n    default: /* '?' */\n        fprintf(stderr, \"Usage: %s [-t nsecs] [-n] name\\n\",\n                argv[0]);\n        exit(EXIT_FAILURE);\n    }\n}\n</code></pre>\n\n<p>To elaborate, by seeing the syntax <code>\"nt:\"</code> we can understand that the option <code>n</code> does not need any argument but option <code>t</code> will have a following argument to it. So, when the option <code>t</code> is found, the corresponding argument is stored into <code>optarg</code> and can be retrieved by accessing <code>optarg</code>.</p>\n\n<p>So, basically, <code>getopt()</code> will return the <em>option</em> and <code>optarg</code> will return the <em>supplied argument</em> for that option, if any.</p>\n\n<p>In case the binary is run like <code>./a.out -t 30</code>, then when <code>getopt()</code> returns <code>t</code>, <code>optarg</code> will be holding a pointer to a <em>string</em> containing <code>30</code> (not an <code>int</code>, mind it).</p>\n"}], "owner": {"reputation": 1562, "user_id": 6828329, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cb5516b7f44760e32dcceabb543a0ebc?s=128&d=identicon&r=PG&f=1", "display_name": "The Pointer", "link": "https://stackoverflow.com/users/6828329/the-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1371, "favorite_count": 0, "accepted_answer_id": 40254216, "answer_count": 1, "score": 2, "last_activity_date": 1477460487, "creation_date": 1477458307, "last_edit_date": 1477460487, "question_id": 40254116, "link": "https://stackoverflow.com/questions/40254116/the-variable-optarg-of-getopt", "title": "The variable optarg of getopt()", "body": "<p>I've read through the <a href=\"https://linux.die.net/man/3/optarg\" rel=\"nofollow\">documentation for <code>getopt()</code></a>, but I do not find the explanations of <code>optarg</code> clear. </p>\n\n<p>I cannot find any other sources which explicitly and clearly explain general information about <code>optarg</code>.</p>\n\n<p>I would appreciate it if someone could clarify and elaborate on the general information about <code>optarg</code>. </p>\n\n<p>I would like to know:</p>\n\n<ul>\n<li>What <code>optarg</code> is.</li>\n<li>How <code>optarg</code> gets its value.</li>\n<li>The documentation mentions something about colons changing the value of <code>optarg</code>.</li>\n</ul>\n\n<p>The documentation has examples of how to use <code>optarg</code>. I am more-so interested in clear and elaborate explanations of the variable itself. </p>\n"}, {"tags": ["c", "function", "structure", "function-pointers", "void-pointers"], "answers": [{"tags": [], "owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "is_accepted": true, "score": 1, "last_activity_date": 1477457479, "creation_date": 1477457479, "answer_id": 40253975, "question_id": 40253943, "link": "https://stackoverflow.com/questions/40253943/expected-identifier-before-token-in-function-pointer/40253975#40253975", "title": "Expected identifier before token in function pointer", "body": "<p>You are assigning the values to function pointers wrongly.</p>\n\n<p>It should be like below for all the cases</p>\n\n<pre><code>if(f2.m == 1)\n{                                                                           \n    f2.payload_ptr = DLL;\n    f2.payload_ptr();\n}\n</code></pre>\n\n<p>Please ensure that functions like DLL are of type <code>void DLL();</code></p>\n"}], "owner": {"reputation": 111, "user_id": 7045940, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/526c1780d7fbd82f6cf3dc411061fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "Milan Shah", "link": "https://stackoverflow.com/users/7045940/milan-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "accepted_answer_id": 40253975, "answer_count": 1, "score": 0, "last_activity_date": 1477457545, "creation_date": 1477457278, "last_edit_date": 1477457545, "question_id": 40253943, "link": "https://stackoverflow.com/questions/40253943/expected-identifier-before-token-in-function-pointer", "title": "Expected identifier before token in function pointer", "body": "<pre><code>typedef enum\n{\n    TCP = 1,\n    UDP\n}protocol;\n\ntypedef enum\n{\n    DLL_Operation = 1,\n    MT_Operation,\n    Fork_Operation,\n    IPC_Operation\n}msgc;\n\nstruct f\n{\n    int seqNo;\n    protocol p;\n    msgc m;\n    protocol q;\n    int PayLoadSize;\n    void (*payload_ptr)();\n};\n</code></pre>\n\n<p>This is my structure which i am using...</p>\n\n<p>Now i am assigning address of function in that function pointer defining in strucutre...</p>\n\n<pre><code>if(f2.m == 1)\n{                                                                           \n    f2.(*payload_ptr) = DLL;\n    f2.payload_ptr();\n}\nelse if(f2.m == 2)\n{\n    f2.(*payload_ptr) = MT; \n    f2.payload_ptr();       \n}\nelse if(f2.m == 3)\n{\n    f2.(*payload_ptr) = Fork;   \n    f2.payload_ptr();\n}\nelse\n{\n    f2.(*payload_ptr) = IPC;        \n    f2.payload_ptr();\n}   \n</code></pre>\n\n<p>in compiling this program... it is showing error like..</p>\n\n<p><strong>error: expected identifier before \u2018(\u2019 token</strong></p>\n\n<p><strong>f2.(*payload_ptr) = DLL;</strong></p>\n\n<p>&amp; same for all condition.... what is the solution..</p>\n\n<p>this DLL, MT all are some function which i define for certain operation...</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "edited": false, "score": 0, "creation_date": 1477457459, "post_id": 40253904, "comment_id": 67769763, "body": "I know I haven&#39;t called <code>freeifaddrs()</code>. No need to point out."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1477457690, "post_id": 40253904, "comment_id": 67769829, "body": "You should at least show the definition of <code>ip</code> so we know it&#39;s sane."}, {"owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1477458076, "post_id": 40253904, "comment_id": 67769971, "body": "@paddy Re-edited. :-)"}], "answers": [{"tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 1, "last_activity_date": 1477458119, "creation_date": 1477458119, "answer_id": 40254078, "question_id": 40253904, "link": "https://stackoverflow.com/questions/40253904/i-get-wrong-ip-address-with-getifaddrs/40254078#40254078", "title": "I get wrong ip address with getifaddrs", "body": "<p>You have assumed that the first entry you encounter for a name will be in the <code>AF_INET</code> family, but you did not check.</p>\n\n<p>Use <code>ips-&gt;ifa_addr-&gt;sa_family</code> to check that it's <code>AF_INET</code>.</p>\n\n<p>Chances are that the first <code>lo</code> and <code>eth0</code> devices you encounter will be in the <code>AF_PACKET</code> family.</p>\n"}], "owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 40254078, "answer_count": 1, "score": 2, "last_activity_date": 1477458171, "creation_date": 1477457061, "last_edit_date": 1477458171, "question_id": 40253904, "link": "https://stackoverflow.com/questions/40253904/i-get-wrong-ip-address-with-getifaddrs", "title": "I get wrong ip address with getifaddrs", "body": "<p><strong>Function to get ethernet specified ip address:</strong>  </p>\n\n<pre><code>char *get_ethernet_ip(const char *ethernet, char *ip, size_t len) {\n    struct ifaddrs *ips;\n    int rc = getifaddrs(&amp;ips);\n    if (rc == -1) {\n        SYSLOG(\"getifaddrs() failed (%s)\", strerror(errno));\n        return NULL;\n    }\n\n    for (; ips != NULL; ips = ips-&gt;ifa_next) {\n        if (strcasecmp(ethernet, ips-&gt;ifa_name) == 0) {\n            in_addr local_ip = ((sockaddr_in *)ips-&gt;ifa_addr)-&gt;sin_addr;\n            const char *p = inet_ntop(AF_INET, &amp;local_ip, ip, len);\n            if (p == NULL) {\n                SYSLOG(\"inet_ntop() failed (%s)\", strerror(errno));\n                return NULL;\n            }\n\n            return ip;\n        }\n    }\n\n    return NULL;\n}\n</code></pre>\n\n<p><strong>Used in main:</strong>  </p>\n\n<pre><code>char ip[32];\nSYSLOG(\"ethernet lo ip: %s\", get_ethernet_ip(\"lo\", ip, 32));\nSYSLOG(\"ethernet eth0 ip: %s\", get_ethernet_ip(\"eth0\", ip, 32));\n</code></pre>\n\n<p><strong>Result:</strong><br>\n<em>[ 2016-10-26 04:37:52 UTC ] [ server_info.cpp:90 ] [ main ] ethernet lo ip: 1.0.0.0<br>\n[ 2016-10-26 04:37:52 UTC ] [ server_info.cpp:91 ] [ main ] ethernet eth0 ip: 2.0.0.0</em></p>\n\n<p><strong>Question:</strong><br>\nThe ip for <code>lo</code> should be <code>127.0.0.1</code>, and for <code>eth0</code> it should not be <code>2.0.0.0</code>, am I right?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1477457179, "post_id": 40253875, "comment_id": 67769700, "body": "You must pass <code>void malloc_and_check(int **var)</code> and call it with <code>malloc_and_check(&amp;pi);</code> Also <b>do not</b> cast the return of <code>malloc</code>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1477457435, "post_id": 40253875, "comment_id": 67769759, "body": "Use <code>perror(&quot;malloc&quot;); exit(EXIT_FAILURE);</code> on <code>malloc</code> failure"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1477457215, "post_id": 40253922, "comment_id": 67769705, "body": "I got you by 3 seconds <code>:)</code> Get rid of the cast for <code>malloc</code>"}, {"owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1477457320, "post_id": 40253922, "comment_id": 67769733, "body": "@David, : )). Done!!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1477457378, "post_id": 40253922, "comment_id": 67769743, "body": "Perfect. I&#39;d give you the SO sight, but I&#39;m changing laptops and have lost my 2nd quick reference brain (Basket Notepads -- kde3)"}], "tags": [], "owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "is_accepted": false, "score": 1, "last_activity_date": 1477457242, "last_edit_date": 1477457242, "creation_date": 1477457182, "answer_id": 40253922, "question_id": 40253875, "link": "https://stackoverflow.com/questions/40253875/dynamic-array-and-functionalize-malloc/40253922#40253922", "title": "Dynamic array and functionalize malloc", "body": "<p>You are trying to pass the pointer by value (pass by value). You need to pass a double pointer to the function  <code>malloc_and_check</code>. Due to this the value assigned to the pointer is not reflecting back in the caller.</p>\n\n<p>Please modify your code as below:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n void malloc_and_check(int **var)\n {\n     if(!(*var = malloc(sizeof(int))))\n     {\n        fprintf(stderr, \"Insufficient Memory\\n\");\n        exit(EXIT_FAILURE);\n     } \n }\n\n int main(int argc, const char * argv[]) \n {\n    int *pi;\n    malloc_and_check(&amp;pi);\n    *pi = 5;\n    printf(\"%d\", *pi);\n    free(pi);\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1477457312, "post_id": 40253933, "comment_id": 67769732, "body": "Assigning the return is another option, but technically, that&#39;s the answer to a slightly different question. (but I won&#39;t split hairs)"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1477457340, "last_edit_date": 1477457340, "creation_date": 1477457236, "answer_id": 40253933, "question_id": 40253875, "link": "https://stackoverflow.com/questions/40253875/dynamic-array-and-functionalize-malloc/40253933#40253933", "title": "Dynamic array and functionalize malloc", "body": "<p>The change you make to <code>var</code> in the function is lost when the function returns. Either you need to pass <code>var</code> as a double pointer or you need to return a pointer from the function.</p>\n\n<p>Example where the function returns a pointer:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n int* malloc_and_check()\n {\n     int *var;\n     if(!(var = malloc(sizeof(int))))\n     {\n        fprintf(stderr, \"Insufficient Memory\\n\");\n        exit(EXIT_FAILURE);\n     } \n     return var;\n }\n\n int main(int argc, const char * argv[]) \n {\n    int *pi;\n    pi = malloc_and_check();\n    *pi = 5;\n    printf(\"%d\", *pi);\n    free(pi);\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1477457581, "post_id": 40253955, "comment_id": 67769798, "body": "Yes, another way to explain it is that when anything is passed as a function parameter, the function receives a <b><i>copy</i></b> (with its very own, and very different address). In the case of an allocated pointer, it makes no difference, because the <b><i>value</i></b> of the pointer still points to the original block of memory. However, with an unallocated pointer, the address returned by <code>malloc</code> is assigned to the copy of the pointer and there is no correlation to the original pointer address back in <code>main</code>. (which also results in a memory leak)"}], "tags": [], "owner": {"reputation": 1324, "user_id": 6212666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6979ce8911c0f0e6c27f93bb6b39f09?s=128&d=identicon&r=PG", "display_name": "John D", "link": "https://stackoverflow.com/users/6212666/john-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1477457341, "creation_date": 1477457341, "answer_id": 40253955, "question_id": 40253875, "link": "https://stackoverflow.com/questions/40253875/dynamic-array-and-functionalize-malloc/40253955#40253955", "title": "Dynamic array and functionalize malloc", "body": "<p>When you pass the <code>int * var</code> into <code>malloc_and_check</code> you are updating a local copy of the pointer so the original is unchanged. You can fix this in two ways:<br>\n(a) return the pointer from <code>malloc_and_check</code></p>\n\n<pre><code>int * malloc_and_check()\n{\n    int * var = 0;\n    if(!(var = (int*)malloc(sizeof(int))))\n    {\n        fprintf(stderr, \"Insufficient Memory\\n\");\n        return 0;\n    } \n    return var;\n}  \n</code></pre>\n\n<p>Then you would call it as </p>\n\n<pre><code>pi = malloc_and_check();\n</code></pre>\n\n<p>(b) pass in a pointer to the pointer</p>\n\n<pre><code>void malloc_and_check(int ** var)\n{\n    if(!( *var = (int*)malloc(sizeof(int))))\n    {\n        fprintf(stderr, \"Insufficient Memory\\n\");\n        exit(EXIT_FAILURE);\n    } \n}  \n</code></pre>\n\n<p>Then you would pass it in as </p>\n\n<pre><code> malloc_and_check(&amp;pi);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 7045778, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O2D8aUiiCO4/AAAAAAAAAAI/AAAAAAAAAEY/_dOwZgx1zNo/photo.jpg?sz=128", "display_name": "Darshan b", "link": "https://stackoverflow.com/users/7045778/darshan-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1477647680, "last_edit_date": 1477647680, "creation_date": 1477457956, "answer_id": 40254057, "question_id": 40253875, "link": "https://stackoverflow.com/questions/40253875/dynamic-array-and-functionalize-malloc/40254057#40254057", "title": "Dynamic array and functionalize malloc", "body": "<p>The pointer var is allocated memory dynamically but it is local to the function malloc_and_check. The pointer pi in the function main will not get to know the address of the memory allocated to var. It is a bad access and may also result in crash sometimes.</p>\n\n<p>try the code below to get the expected results : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n void malloc_and_check(int **var)\n {\n     int *var1;\n     if(!(var1 = (int*)malloc(sizeof(int))))\n     {\n        fprintf(stderr, \"Insufficient Memory\\n\");\n        exit(EXIT_FAILURE);\n     } \n     else \n        *var = var1;\n }\n\n int main(int argc, const char * argv[]) \n {\n    int *pi;\n    malloc_and_check(&amp;pi);\n    *pi = 5;\n    printf(\"%d\", *pi);\n    free(pi);\n }\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7046829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc40f1312deea35d641d2615932d5ea?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley.Chung", "link": "https://stackoverflow.com/users/7046829/wesley-chung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1477489559, "accepted_answer_id": 40254057, "answer_count": 4, "score": 0, "last_activity_date": 1477647680, "creation_date": 1477456886, "last_edit_date": 1477461812, "question_id": 40253875, "link": "https://stackoverflow.com/questions/40253875/dynamic-array-and-functionalize-malloc", "closed_reason": "Duplicate", "title": "Dynamic array and functionalize malloc", "body": "<p>I try to malloc an array functionally, and this function also can check whether the memory is enough or not.</p>\n\n<p>The first code block can't work.\nWhen it executes \" <code>*pi = 5</code> \", the compiler shows this error message \" <code>Thread 1: EXC_BAD_ACCESS(code=1, address=0x0) \"</code> . </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n void malloc_and_check(int *var)\n {\n     if(!(var = (int*)malloc(sizeof(int))))\n     {\n        fprintf(stderr, \"Insufficient Memory\\n\");\n        exit(EXIT_FAILURE);\n     } \n }\n\n int main(int argc, const char * argv[]) \n {\n    int *pi;\n    malloc_and_check(pi);\n    *pi = 5;\n    printf(\"%d\", *pi);\n    free(pi);\n }\n</code></pre>\n\n<p>However, the codes as below can work normally.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    int main(int argc, const char * argv[])\n    {\n        int *pi;\n\n        if(!(pi = (int*)malloc(sizeof(int))))\n        {\n            fprintf(stderr, \"Insufficient Memory\\n\");\n            exit(EXIT_FAILURE);\n        }\n\n        *pi = 5;\n        printf(\"%d\", *pi);\n        free(pi);\n    }\n</code></pre>\n\n<p>What are the difference between them? Thanks!</p>\n"}, {"tags": ["c", "function", "loops", "call"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1477719944, "post_id": 40253735, "comment_id": 67889667, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "edited": false, "score": 0, "creation_date": 1477457035, "post_id": 40253768, "comment_id": 67769662, "body": "strcpy might not work as the the contents of the char array doesn&#39;t seem to be &#39;\\0&#39; terminated."}, {"owner": {"reputation": 11, "user_id": 4714633, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd0ebd87e54808ed2f655b1d40e73e67?s=128&d=identicon&r=PG&f=1", "display_name": "raymondxuym", "link": "https://stackoverflow.com/users/4714633/raymondxuym"}, "edited": false, "score": 0, "creation_date": 1477504225, "post_id": 40253768, "comment_id": 67798032, "body": "@Jean-BaptisteYun&#232;s Thanks the answer and it works great! Though the dl_bny is initialized somewhere else but what you mentioned did resolve my another question about &#39;\\0&#39; terminator! Appreciate it!"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 1, "last_activity_date": 1477464969, "last_edit_date": 1477464969, "creation_date": 1477456235, "answer_id": 40253768, "question_id": 40253735, "link": "https://stackoverflow.com/questions/40253735/why-i-call-this-function-8-times-all-results-are-from-last-time-in-c/40253768#40253768", "title": "Why I call this function 8 times, all results are from last time? In C", "body": "<p>You return a static buffer, then it is the same for all calls and will then contains the last produced value.</p>\n\n<p>You can (for example) simply copy the returned result each time you call <code>tohex</code> :</p>\n\n<pre><code>char dl_hex[8][9];\n\n...\n\nstrcpy(dl_hex[i], tohex(dl_bny[i]));\n</code></pre>\n\n<p>Beware that your code if wrong in some places: <code>dl_bny</code> not initialized, strings must contains a final 0 so length should be 33...</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4714633, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd0ebd87e54808ed2f655b1d40e73e67?s=128&d=identicon&r=PG&f=1", "display_name": "raymondxuym", "link": "https://stackoverflow.com/users/4714633/raymondxuym"}, "edited": false, "score": 0, "creation_date": 1477504718, "post_id": 40253886, "comment_id": 67798278, "body": "Thanks for the answer and explanation! I tried strncpy then I got the correct results. I was wondering, for the first iteration, why not the first slot takes the first pointer immediately and then goes to the second iteration? For the case I have, It seems like the compiler calls the function 8 times at first, and then assign those 8 results to the 8 slots?"}], "tags": [], "owner": {"reputation": 22021, "user_id": 236222, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf4f3c341534395199d4dbe35a432f9d?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/236222/jay"}, "is_accepted": false, "score": 1, "last_activity_date": 1477456975, "creation_date": 1477456975, "answer_id": 40253886, "question_id": 40253735, "link": "https://stackoverflow.com/questions/40253735/why-i-call-this-function-8-times-all-results-are-from-last-time-in-c/40253886#40253886", "title": "Why I call this function 8 times, all results are from last time? In C", "body": "<p>You are returning a pointer to a static buffer <code>hexout</code> from the function <code>tohex</code>. The contents of the static buffer <code>hexout</code> keeps changing during each iteration. Since, you are basically, storing the pointer to <code>hexout</code>. All the slots of <code>dl_hex</code> will be containing the same pointer (to hexout) and hence will contain the same value which is be the value obtained during the last run.</p>\n\n<p>The best way for you would be to copy the values.</p>\n\n<p>Change the main function of the code as below:</p>\n\n<pre><code>int main (int argc, char**argv)\n{\nchar dl_hex[8][8];\nchar dl_bny[8][32];\n\nfor (i=0;i&lt;8;i++) {\n    strncpy(dl_hex[i],tohex(dl_bny[i]), 8);\n }\n}\n\nfor (i=0;i&lt;8;i++) {\n    for (j=0;j&lt;8;j++){\n        printf(\"%c\",*(dl_hex[i]+j));\n    }\n        printf(\"\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4714633, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd0ebd87e54808ed2f655b1d40e73e67?s=128&d=identicon&r=PG&f=1", "display_name": "raymondxuym", "link": "https://stackoverflow.com/users/4714633/raymondxuym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477464969, "creation_date": 1477456050, "question_id": 40253735, "link": "https://stackoverflow.com/questions/40253735/why-i-call-this-function-8-times-all-results-are-from-last-time-in-c", "title": "Why I call this function 8 times, all results are from last time? In C", "body": "<p>This function is to convert strings represent binary to strings represent hex</p>\n\n<pre><code>char *tohex(char bnyin[32]) {\n\nstatic char hexout[8];\n\nint i=0;\nint j=0;\n\nfor (i=0;i&lt;8;i++){\n\n    char txt[4];\n    char hex;\n\n    txt[0]  =   bnyin[i*4+0];\n    txt[1]  =   bnyin[i*4+1];\n    txt[2]  =   bnyin[i*4+2];\n    txt[3]  =   bnyin[i*4+3];\n\n    switch (atoi(txt)) {\n        case    0:      hex = '0';  break;\n        case    1:      hex = '1';  break;\n        case   10:      hex = '2';  break;\n        case   11:      hex = '3';  break;\n        case  100:      hex = '4';  break;\n        case  101:      hex = '5';  break;\n        case  110:      hex = '6';  break;\n        case  111:      hex = '7';  break;\n        case 1000:      hex = '8';  break;\n        case 1001:      hex = '9';  break;\n        case 1010:      hex = 'a';  break;\n        case 1011:      hex = 'b';  break;\n        case 1100:      hex = 'c';  break;\n        case 1101:      hex = 'd';  break;\n        case 1110:      hex = 'e';  break;\n        case 1111:      hex = 'f';  break;\n    }\n    hexout[i]   =   hex;\n}\nreturn hexout;\n}\n</code></pre>\n\n<p>Main function calls the tohex function 8 times </p>\n\n<pre><code>int main (int argc, char**argv)\n{\nchar *dl_hex[8];\nchar dl_bny[8][32];\n\nfor (i=0;i&lt;8;i++) {\n    dl_hex[i] = tohex(dl_bny[i]);\n }\n}\n\nfor (i=0;i&lt;8;i++) {\n    for (j=0;j&lt;8;j++){\n        printf(\"%c\",*(dl_hex[i]+j));\n    }\n        printf(\"\\n\");\n}\n</code></pre>\n\n<p>After printed out all dl_hex, all results are the same with dl_hex[7], if I change to loop number to 6 times, all result are dl_hex[5], seems that no matter how many times I call the tohex function, all result will go for the last one.</p>\n"}]