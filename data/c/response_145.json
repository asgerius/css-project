[{"tags": ["c", "gcc", "assembly", "intel", "disassembly"], "comments": [{"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1508369710, "post_id": 46820740, "comment_id": 80588967, "body": "Look into <code>cfi_def_cfa_offset</code> .. I think this will give you big hint at what you&#39;re looking for."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1508369900, "post_id": 46820740, "comment_id": 80589020, "body": "<code>rbp</code> is the base pointer, which points to the base of the current stack frame, and <code>rsp</code> is the stack pointer, which points to the top of the current stack frame."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1508369923, "post_id": 46820740, "comment_id": 80589027, "body": "If you literally just look into each line one by one, you will figure this out @VladimirVonMartel"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1508369955, "post_id": 46820740, "comment_id": 80589034, "body": "&quot;what is the command that place j on top of the stack&quot; - that&#39;s easy, <code>j</code> is never on top of the stack. Are you sure that&#39;s the question? Did you just mean places it on the stack (not necessarily at the top)? You can find that, yeah. But don&#39;t bother with the <code>cfi...</code> stuff, instead, read about the <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow noreferrer\">calling convention</a> that tells you how <code>j</code> is passed into the function."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1508370055, "post_id": 46820740, "comment_id": 80589060, "body": "J is on the stack."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1508370101, "post_id": 46820740, "comment_id": 80589070, "body": "I&#39;m voting to close this question as off-topic because this seems to be a homework problem rather than a programming problem."}, {"owner": {"reputation": 27, "user_id": 5500512, "user_type": "registered", "profile_image": "https://graph.facebook.com/1510018725984961/picture?type=large", "display_name": "Vladimir Von Martel", "link": "https://stackoverflow.com/users/5500512/vladimir-von-martel"}, "edited": false, "score": 0, "creation_date": 1508370176, "post_id": 46820740, "comment_id": 80589088, "body": "to an extent it is im learning basics of assembly for a job i&#39;ll close it later this evening"}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1508370242, "post_id": 46820740, "comment_id": 80589106, "body": "I think he is mostly concerned that you asked a question without showing you tried to answer it first yourself. @VladimirVonMartel"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508382239, "post_id": 46820740, "comment_id": 80591877, "body": "Related: <a href=\"https://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output\" title=\"how to remove noise from gcc clang assembly output\">stackoverflow.com/questions/38552116/&hellip;</a>.  It&#39;s actually easier to read output from <code>gcc -Og</code> or <code>-O1</code>, because it&#39;s not spilling / reloading everything to memory around every C statement.  So it&#39;s closer to what a human might write to implement the whole simple function."}], "answers": [{"comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1508370410, "post_id": 46820839, "comment_id": 80589148, "body": "The important thing is to know how <code>j</code> is passed into the function, then it&#39;s easy to see how it&#39;s copied to the stack."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1508371377, "last_edit_date": 1508371377, "creation_date": 1508370144, "answer_id": 46820839, "question_id": 46820740, "link": "https://stackoverflow.com/questions/46820740/assembly-output-questions-about-stacks/46820839#46820839", "title": "assembly output + questions about stacks", "body": "<p>Taking into account these instructions</p>\n\n<pre><code>mov eax, DWORD PTR [rbp-28]\nadd eax, 1\n</code></pre>\n\n<p>it seems that <code>j</code> is stored at address <code>rbp-28</code> While <code>ptr</code> is stored at address <code>rbp-24</code>.</p>\n\n<p>These are instructions where the values are stored in the stack</p>\n\n<pre><code>mov QWORD PTR [rbp-24], rdi\nmov DWORD PTR [rbp-28], esi\n</code></pre>\n\n<p>It seems the arguments are passed to the function using registers <code>rdi</code> and <code>esi</code>. </p>\n\n<p>Compilers can optimize their calls of functions and use registers instead of the stack to pass arguments of small sizes to functions. Within the functions they can use the stack to temporary store the arguments passed through registers.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508382306, "post_id": 46822030, "comment_id": 80591891, "body": "I disagree that disabling optimization is a good idea.  <code>-O1 -fverbose-asm</code> output won&#39;t spill/reload everything around every statement, so there are many fewer instructions.  It&#39;s easier to keep track of what&#39;s going on with many fewer instructions."}], "tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1508380400, "creation_date": 1508380400, "answer_id": 46822030, "question_id": 46820740, "link": "https://stackoverflow.com/questions/46820740/assembly-output-questions-about-stacks/46822030#46822030", "title": "assembly output + questions about stacks", "body": "<p>Just a suggestion for further explorations on your own. Use <code>gcc -O0 -g2 f.c -Wa,-adhln</code>. It will turn off optimizations and generate assembly code intermixed with the source. It might give you better ideas about what it does. </p>\n\n<p>As an alternative you can use the <code>objdump -Sd f.o</code> on the output '.o' or executable. Just make sure that you add debugging info and turn off optimizations at compilation. </p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508451662, "post_id": 46823788, "comment_id": 80627291, "body": "<code>gcc -O2</code> output is significantly easier to read.  I included both <code>-O0</code> and <code>-O2</code> panes in the godbolt link I added to your question.  (You can link to code on Godbolt with the &quot;share&quot; button, instead of linking just the front page.)"}, {"owner": {"reputation": 653, "user_id": 8306489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e52cea2296c4a35ebcc0e110ac913d7e?s=128&d=identicon&r=PG&f=1", "display_name": "Forward", "link": "https://stackoverflow.com/users/8306489/forward"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508461411, "post_id": 46823788, "comment_id": 80629791, "body": "Thanks Peter for enriching my answer and fixing my problem in English grammar. BTW, my first question in stackoverflow is answered by you :)"}], "tags": [], "owner": {"reputation": 653, "user_id": 8306489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e52cea2296c4a35ebcc0e110ac913d7e?s=128&d=identicon&r=PG&f=1", "display_name": "Forward", "link": "https://stackoverflow.com/users/8306489/forward"}, "is_accepted": true, "score": 1, "last_activity_date": 1508451543, "last_edit_date": 1508451543, "creation_date": 1508393930, "answer_id": 46823788, "question_id": 46820740, "link": "https://stackoverflow.com/questions/46820740/assembly-output-questions-about-stacks/46823788#46823788", "title": "assembly output + questions about stacks", "body": "<p>The variable <code>j</code> is the second parameter for <code>func</code>; it is stored in the register <code>esi</code> in the x86-64 System V ABI calling convention.  This instruction <code>mov DWORD PTR [rbp-28], esi</code> put <code>j</code> into the stack.</p>\n\n<p>You can see it very clearly by writing a simple function that calls \"func\" and compiling it with <code>-O0</code> (or with <code>-O2</code> and marking it as <code>noinline</code>, or only providing a prototype so there's nothing for the compiler to inline).</p>\n\n<pre><code>unsigned int func(int *ptr, unsigned int j) {\n    unsigned int res = j;   \n    int i = ptr[j+1];\n\n    for(; i&lt;8; ++i) {\n        res &gt;&gt;= 1;\n    }\n    return res;\n}\n\nint main()\n{\n    int a = 1;\n    int array[10];    \n    func (array, a);\n    return 0;\n}\n</code></pre>\n\n<p>Using the Godbolt compiler explorer, <a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,source:&#39;//+__attribute__((noinline))%0Aunsigned+int+func(int+*ptr,+unsigned+int+j)+%7B%0A++++unsigned+int+res+%3D+j%3B+++%0A++++int+i+%3D+ptr%5Bj%2B1%5D%3B%0A%0A++++for(%3B+i%3C8%3B+%2B%2Bi)+%7B%0A++++++++res+%3E%3E%3D+1%3B%0A++++%7D%0A++++return+res%3B%0A%7D%0A%0Aint+main()%0A%7B%0A++++int+a+%3D+1%3B%0A++++int+array%5B10%5D%3B++++%0A++++func+(array,+a)%3B%0A++++return+0%3B%0A%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:33.779038357644524,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g72,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),libs:!(),options:&#39;-xc+-Wall+-O0+-fverbose-asm&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.2+(Editor+%231,+Compiler+%231)&#39;,t:&#39;0&#39;)),k:32.88762830902216,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g72,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),libs:!(),options:&#39;-xc+-Wall+-O2+-fverbose-asm&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.2+(Editor+%231,+Compiler+%232)&#39;,t:&#39;0&#39;)),k:33.33333333333333,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">we can easily get <code>gcc -O0 -fverbose-asm</code> assembly output</a>.\nPlease focus on the following instructions:</p>\n\n<pre><code># in main:\n...\nmov DWORD PTR [rbp-4], 1\nmov edx, DWORD PTR [rbp-4]\n...\nmov esi, edx\n...\n\n\nfunc(int*, unsigned int):\n...\nmov DWORD PTR [rbp-28], esi   # j, j\n...\n</code></pre>\n\n<p><code>j,  j</code> is a comment added by <code>gcc -fverbose-asm</code> tell you that the source and destination operands are both the C variable <code>j</code> in that instruction.</p>\n\n<p>The full assembly instructions:</p>\n\n<pre><code>func(int*, unsigned int):\n  push rbp\n  mov rbp, rsp\n  mov QWORD PTR [rbp-24], rdi\n  mov DWORD PTR [rbp-28], esi\n  mov eax, DWORD PTR [rbp-28]\n  mov DWORD PTR [rbp-4], eax\n  mov eax, DWORD PTR [rbp-28]\n  add eax, 1\n  mov eax, eax\n  lea rdx, [0+rax*4]\n  mov rax, QWORD PTR [rbp-24]\n  add rax, rdx\n  mov eax, DWORD PTR [rax]\n  mov DWORD PTR [rbp-8], eax\n  jmp .L2\n.L3:\n  shr DWORD PTR [rbp-4]\n  add DWORD PTR [rbp-8], 1\n.L2:\n  cmp DWORD PTR [rbp-8], 7\n  jle .L3\n  mov eax, DWORD PTR [rbp-4]\n  pop rbp\n  ret\nmain:\n  push rbp\n  mov rbp, rsp\n  sub rsp, 48\n  mov DWORD PTR [rbp-4], 1\n  mov edx, DWORD PTR [rbp-4]\n  lea rax, [rbp-48]\n  mov esi, edx\n  mov rdi, rax\n  call func(int*, unsigned int)\n  mov eax, 0\n  leave\n  ret\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5500512, "user_type": "registered", "profile_image": "https://graph.facebook.com/1510018725984961/picture?type=large", "display_name": "Vladimir Von Martel", "link": "https://stackoverflow.com/users/5500512/vladimir-von-martel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 46823788, "answer_count": 3, "score": 0, "last_activity_date": 1508451543, "creation_date": 1508369459, "last_edit_date": 1508369660, "question_id": 46820740, "link": "https://stackoverflow.com/questions/46820740/assembly-output-questions-about-stacks", "title": "assembly output + questions about stacks", "body": "<p>I was studying one of my courses when I ran into a specific exercise that I cannot seem to resolve... It is pretty basic because I am VERY new to assembly. So lets begin.</p>\n\n<p>I have a C function </p>\n\n<pre><code>unsigned int func(int *ptr, unsigned int j) {\n    unsigned int res = j;   \n    int i = ptr[j+1];\n\n    for(; i&lt;8; ++i) {\n        res &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre>\n\n<p>I translated it with gcc to assembly</p>\n\n<pre><code>.file   \"func.c\"\n.intel_syntax noprefix\n.text\n.globl  func\n.type   func, @function\nfunc:\n.LFB0:\n.cfi_startproc\npush    rbp\n    .cfi_def_cfa_offset 16\n    .cfi_offset 6, -16\n    mov rbp, rsp\n    .cfi_def_cfa_register 6\n    mov QWORD PTR [rbp-24], rdi\n    mov DWORD PTR [rbp-28], esi\n    mov eax, DWORD PTR [rbp-28]\n    mov DWORD PTR [rbp-8], eax\n    mov eax, DWORD PTR [rbp-28]\n    add eax, 1\n    mov eax, eax\n    lea rdx, [0+rax*4]\n    mov rax, QWORD PTR [rbp-24]\n    add rax, rdx\n    mov eax, DWORD PTR [rax]\n    mov DWORD PTR [rbp-4], eax\n    jmp .L2\n.L3:\n    shr DWORD PTR [rbp-8]\n    add DWORD PTR [rbp-4], 1\n.L2:\n    cmp DWORD PTR [rbp-4], 7\n    jle .L3\n    mov eax, DWORD PTR [rbp-8]\n    pop rbp\n    .cfi_def_cfa 7, 8\n    ret\n    .cfi_endproc\n.LFE0:\n    .size   func, .-func\n    .ident  \"GCC: (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4\"\n    .section    .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p>The question is as follow. what is the command that place <code>j</code> (variable in the c function) on top of the stack?</p>\n\n<p>I sincerely cannot find out please enlighten me XD.</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1508368980, "post_id": 46820639, "comment_id": 80588792, "body": "How do you write the line of code where you free the space?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508369177, "post_id": 46820639, "comment_id": 80588842, "body": "<code>array</code> is <code>int**</code>. <code>array_head</code> is <code>int*</code>. Both are different."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1508369713, "post_id": 46820639, "comment_id": 80588969, "body": "Do you really intend to return a pointer to a pointer of int?  As in, are you looking for an array of int pointers?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1508369906, "post_id": 46820639, "comment_id": 80589021, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1508370055, "post_id": 46820639, "comment_id": 80589061, "body": "If it&#39;s a 2D matrix of integers your looking for, then len should be sizeof(int) * rows * cols."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1508370116, "post_id": 46820639, "comment_id": 80589078, "body": "@jwdonahue What this seems to be is a 2D matrix of integers, but it has a header containing pointers to each row."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1508370206, "post_id": 46820639, "comment_id": 80589099, "body": "So it&#39;s like a matrix implemented as an array of pointers to rows, but it ensures that the rows are contiguous with each other and the pointer array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1508370293, "post_id": 46820639, "comment_id": 80589122, "body": "The only value I can see in this design is that it&#39;s good for locality, and you can free the entire thing with one call to <code>free()</code>."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1508370411, "post_id": 46820639, "comment_id": 80589150, "body": "@Barmar, I agree, but I just wanted to make sure that this is the OP&#39;s intent."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508377965, "post_id": 46820639, "comment_id": 80590908, "body": "<code>int len = sizeof(int*)*rows + sizeof(int)*rows*cols + 1;</code> is wrong size for various reasons: First drop the +1.  2nd type should be <code>size_t</code> 3rd: most important: code does not insure proper aliment of the <code>int</code>.  This <i>may</i> work for OP, but is is not correct in general."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508382389, "post_id": 46820639, "comment_id": 80591905, "body": "The code will fail on a platform where <code>sizeof(int) != sizeof(int *)</code>. This would write out of bounds for access to latter parts of the array, causing heap corruption (and perhaps therefore, failure of free)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508383722, "post_id": 46820639, "comment_id": 80592229, "body": "@M.M Once again thanks for the good feed back"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508383764, "post_id": 46820639, "comment_id": 80592240, "body": "See <a href=\"https://stackoverflow.com/a/42652072/2410359\">C pass variable size 2-D array to function</a>"}, {"owner": {"reputation": 61, "user_id": 8116018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d27fb343391cf37b403b8b535c9a08e?s=128&d=identicon&r=PG&f=1", "display_name": "MyCoy", "link": "https://stackoverflow.com/users/8116018/mycoy"}, "edited": false, "score": 0, "creation_date": 1508460890, "post_id": 46820639, "comment_id": 80629685, "body": "I just use free(array) to free the allocated memory"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8116018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d27fb343391cf37b403b8b535c9a08e?s=128&d=identicon&r=PG&f=1", "display_name": "MyCoy", "link": "https://stackoverflow.com/users/8116018/mycoy"}, "edited": false, "score": 0, "creation_date": 1508507010, "post_id": 46820886, "comment_id": 80648167, "body": "Hi, Barmar, you are right, thanks for pointing out the issue."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1508370477, "creation_date": 1508370477, "answer_id": 46820886, "question_id": 46820639, "link": "https://stackoverflow.com/questions/46820639/memory-management-for-a-dynamically-allocated-2d-space/46820886#46820886", "title": "memory management for a dynamically allocated 2D space", "body": "<p>The problem in the second version is that you're doing the pointer arithmetic on an <code>int **</code> instead of <code>int *</code>, because you have the cast outside the arithmetic.</p>\n\n<pre><code>for(i=0; i&lt;rows; i++)\n    array[i] =  ((int *)(array + rows) + i*cols);   // &lt;--- the major difference\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8116018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d27fb343391cf37b403b8b535c9a08e?s=128&d=identicon&r=PG&f=1", "display_name": "MyCoy", "link": "https://stackoverflow.com/users/8116018/mycoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 46820886, "answer_count": 1, "score": 2, "last_activity_date": 1508383974, "creation_date": 1508368826, "question_id": 46820639, "link": "https://stackoverflow.com/questions/46820639/memory-management-for-a-dynamically-allocated-2d-space", "title": "memory management for a dynamically allocated 2D space", "body": "<p>everyone:\nI just come across an approach to allocate a 2D matrix in C. While practicing it, I'm confused about an unknown bug. </p>\n\n<p>here is the function, first version:</p>\n\n<pre><code>//first version\nstatic int ** my2DAlloc(int rows, int cols){\n    int ** array;\n    int * array_head;\n    int i;\n    int len = sizeof(int*)*rows + sizeof(int)*rows*cols + 1;\n    array = (int**)malloc( len );\n    memset(array, 0, len);\n\n    array_head = (int *) (array + rows);\n    for(i=0; i&lt;rows; i++)\n        array[i] = array_head + i*cols ;\n\n    return array;\n}\n</code></pre>\n\n<p>I don't have any problem with this version. However, I've tried to change the code a little, as the following:</p>\n\n<pre><code>//second version\nstatic int ** my2DAlloc(int rows, int cols){\n    int ** array;\n    int * array_head;\n    int i;\n    int len = sizeof(int*)*rows + sizeof(int)*rows*cols + 1;\n    array = (int**)malloc( len );\n    memset(array, 0, len);\n\n    //array_head = (int *) (array + rows);\n    for(i=0; i&lt;rows; i++)\n        array[i] = (int *) (array + rows + i*cols);   // &lt;--- the major difference\n\n    return array;\n}\n</code></pre>\n\n<p>Regarding this second version, it seems fine to write data to the matrix and read data out. \nBut when I try to free the allocated space, I get system error like: </p>\n\n<pre><code>free(): invalid next size (fast): 0x00000000020df010\n</code></pre>\n\n<p>It seems to be some memory error. But I could not figure out the problem. \nCould anyone help me out?</p>\n\n<p>Thanks &amp; Regards</p>\n"}, {"tags": ["c", "zeromq", "pgm-protocol"], "comments": [{"owner": {"reputation": 888, "user_id": 4162084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7xGHkctBZDo/AAAAAAAAAAI/AAAAAAAAAEg/vzBUlmaZceo/photo.jpg?sz=128", "display_name": "Jakub Piskorz", "link": "https://stackoverflow.com/users/4162084/jakub-piskorz"}, "edited": false, "score": 0, "creation_date": 1508450852, "post_id": 46820308, "comment_id": 80627048, "body": "Your code is working for me. How did you confirm that it is not receiving any messages? Try to change zipcode generation to something like this: <code>zipcode     = randof (100) + 9990;</code>, 1/100000 hit 100 times might take a while to actualy get something printed. Add prints inside loops to see if it really is not receiving anything."}, {"owner": {"reputation": 58, "user_id": 8483324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86fae536a13aaf001d5375e243bdc95?s=128&d=identicon&r=PG&f=1", "display_name": "Runms", "link": "https://stackoverflow.com/users/8483324/runms"}, "reply_to_user": {"reputation": 888, "user_id": 4162084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7xGHkctBZDo/AAAAAAAAAAI/AAAAAAAAAEg/vzBUlmaZceo/photo.jpg?sz=128", "display_name": "Jakub Piskorz", "link": "https://stackoverflow.com/users/4162084/jakub-piskorz"}, "edited": false, "score": 0, "creation_date": 1508881000, "post_id": 46820308, "comment_id": 80788408, "body": "Sorry for my late reply. I was travelling. I tried it again, with only one zipcode and only one loop adding and it worked. It astonishs me, because both side were running quite a while, maybe I did a mistake on starting, after a long time of triying.  In any case thank you for your answer :-)."}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 8483324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86fae536a13aaf001d5375e243bdc95?s=128&d=identicon&r=PG&f=1", "display_name": "Runms", "link": "https://stackoverflow.com/users/8483324/runms"}, "is_accepted": true, "score": 0, "last_activity_date": 1508881384, "creation_date": 1508881384, "answer_id": 46920534, "question_id": 46820308, "link": "https://stackoverflow.com/questions/46820308/dont-get-messages-with-epgm-while-with-tcp-do-why/46920534#46920534", "title": "Don&#39;t get messages with epgm://, while with tcp:// do. Why?", "body": "<p>For later visitors of the question, the code is fine and running. To see if it works on your system, change the for-loop to one loop and set the zipcode in the publisher on 10001, if you start the subscriber without an argument.</p>\n"}], "owner": {"reputation": 58, "user_id": 8483324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86fae536a13aaf001d5375e243bdc95?s=128&d=identicon&r=PG&f=1", "display_name": "Runms", "link": "https://stackoverflow.com/users/8483324/runms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 46920534, "answer_count": 1, "score": 2, "last_activity_date": 1508881384, "creation_date": 1508366297, "last_edit_date": 1508374940, "question_id": 46820308, "link": "https://stackoverflow.com/questions/46820308/dont-get-messages-with-epgm-while-with-tcp-do-why", "title": "Don&#39;t get messages with epgm://, while with tcp:// do. Why?", "body": "<p>I try to use the weather example from the ZeroMQ guide, with an <strong><code>epgm://</code></strong> transport-class. At first my code:</p>\n\n<pre><code>// Publisher\n\n#include \"zhelpers.h\"\n\nint main (void) {\n    //  Prepare our context and publisher\n    void *context = zmq_ctx_new ();\n    void *publisher = zmq_socket ( context, ZMQ_PUB );\n    // int rc = zmq_bind ( publisher, \"tcp://*:5556\" );\n       int rc = zmq_bind ( publisher, \"epgm://192.168.1.4;224.0.0.251:5556\" );\n    assert ( rc == 0 );\n\n    //  Initialize random number generator\n    srandom ( (unsigned) time (NULL) );\n    while (1) {\n        //  Get values that will fool the boss\n        int zipcode, temperature, relhumidity;\n        zipcode     = randof (100000);\n        temperature = randof (215) - 80;\n        relhumidity = randof (50) + 10;\n\n        //  Send a message to all subscribers\n        char update [20];\n        sprintf ( update, \"%05d %d %d\", zipcode, temperature, relhumidity );\n        s_send ( publisher, update );\n    }\n    zmq_close ( publisher );\n    zmq_ctx_destroy ( context );\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>    // Subscriber\n    #include \"zhelpers.h\"\n\n    int main ( int argc, char *argv [] )\n    {\n        //  Socket to talk to server\n        printf ( \"Collecting updates from weather server\u2026\\n\" );\n        void *context = zmq_ctx_new ();\n        void *subscriber = zmq_socket ( context, ZMQ_SUB );\n        // int rc = zmq_connect ( subscriber, \"tcp://192.168.1.4:5556\" );\n           int rc = zmq_connect ( subscriber, \"epgm://192.168.1.9;224.0.0.251:5556\" );\n        assert ( rc == 0 );\n\n        //  Subscribe to zipcode, default is NYC, 10001\n        char *filter = ( argc &gt; 1 )? argv [1]: \"10001 \";\n        rc = zmq_setsockopt ( subscriber, ZMQ_SUBSCRIBE,\n                              filter, strlen (filter) );\n        assert ( rc == 0 );\n\n        //  Process 100 updates\n        int update_nbr;\n        long total_temp = 0;\n        for ( update_nbr = 0; update_nbr &lt; 100; update_nbr++ ) {\n            char *string = s_recv ( subscriber );\n\n            int zipcode, temperature, relhumidity;\n            sscanf ( string, \"%d %d %d\",\n                    &amp;zipcode, &amp;temperature, &amp;relhumidity );\n            total_temp += temperature;\n            free ( string );\n        }\n        printf ( \"Average temperature for zipcode '%s' was %dF\\n\",\n            filter, (int) ( total_temp / update_nbr ) );\n\n        zmq_close ( subscriber );\n        zmq_ctx_destroy ( context );\n        return 0;\n    }\n</code></pre>\n\n<ol>\n<li>I've tried this code with <code>tcp://</code> on the same hosts ( see comments ) and it works fine.  </li>\n<li>I tried the multicast address with this example <a href=\"http://openbook.rheinwerk-verlag.de/linux_unix_programmierung/Kap11-018.htm\" rel=\"nofollow noreferrer\">Openbook Linux</a> ( with my multicast address ), and I got the messages.  </li>\n<li>I installed ZeroMQ with <strong><code>pgm://</code></strong> ( before I was getting assertion faults ).  </li>\n<li>My hosts both are Ubuntu 16.04 systems  </li>\n<li>I'm using ZeroMQ 4</li>\n</ol>\n\n<p>My problem is that I don't get any messages with <code>epgm://</code>. Both programs were running, but no message were received. What am I missing? I don't understand what could be wrong.  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 4, "creation_date": 1508366166, "post_id": 46820247, "comment_id": 80588031, "body": "The variable tmp should be of the type Vara. Also this condition if(reg[j]&gt;reg[j+1]){ does not make sense because the operator &gt; is not defined for structure."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1508366977, "post_id": 46820247, "comment_id": 80588256, "body": "As I understand you have to swap structure objects instead of just one their data member"}], "answers": [{"tags": [], "owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "is_accepted": false, "score": 0, "last_activity_date": 1508367339, "creation_date": 1508367339, "answer_id": 46820445, "question_id": 46820247, "link": "https://stackoverflow.com/questions/46820247/how-to-bubble-sort-in-c-an-array-of-type-struct-using-temporary-int-tmp/46820445#46820445", "title": "How to Bubble sort in C an array of type struct using temporary int (tmp)?", "body": "<p>As @vladfrommoscow points out, and in other words; tmp must be of the same type as the structs in the array.</p>\n"}], "owner": {"reputation": 93, "user_id": 8662390, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1645712235500090/picture?type=large", "display_name": "Kevin Punkt", "link": "https://stackoverflow.com/users/8662390/kevin-punkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508367339, "creation_date": 1508365936, "last_edit_date": 1508366358, "question_id": 46820247, "link": "https://stackoverflow.com/questions/46820247/how-to-bubble-sort-in-c-an-array-of-type-struct-using-temporary-int-tmp", "title": "How to Bubble sort in C an array of type struct using temporary int (tmp)?", "body": "<p>I get error from the compiler because I can't assign an integrer type <code>tmp</code> to a struct type. I try to bubble sort array of struct type. The code is bigger than this but I think this is enough to provide all the info you need.</p>\n\n<pre><code>struct varor{\n     int varunummer;\n     char namn[WORDLENGTH];\n     int lagersaldo; \n };\n typedef struct varor Vara;\n\n void sorteraVaror(Vara reg[]){\n         int i,j, tmp;\n         for(i=0; i&lt; MAX-1; i++){\n             for(j=0; j&lt;MAX-1; j++){\n                 if(reg[j].varunummer&gt;reg[j+1].varunummer){\n                 tmp=reg[j].varunummer;\n                 reg[j].varunummer=reg[j+1].varunummer;\n                 reg[j+1].varunummer=tmp;\n                 }\n             }\n         }   \n }\n</code></pre>\n"}, {"tags": ["c", "recursion", "segmentation-fault"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1508366416, "post_id": 46820225, "comment_id": 80588097, "body": "compile with -g and run under gdb (asumming on linux). THis will at least show the failing line"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 5, "creation_date": 1508366427, "post_id": 46820225, "comment_id": 80588106, "body": "Your &quot;west&quot; is wrong. It should be strictly adjusting on the y-axis; not x. <code>x-1,y-1</code> is effectively a diagonal move. Regardless, include your code that builds your matrices; effectively a minimum, <b>complete</b> example that demonstrates your problem. Reading this code is pointless if you borked the code that loads the arrays and or primes the four global variables you&#39;re apparently using."}, {"owner": {"reputation": 2508, "user_id": 1491278, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb9277b775f30c8d5574627cfb79ed14?s=128&d=identicon&r=PG", "display_name": "Grantly", "link": "https://stackoverflow.com/users/1491278/grantly"}, "edited": false, "score": 1, "creation_date": 1508366567, "post_id": 46820225, "comment_id": 80588137, "body": "Are you sure you need the very last return 0....Could it be return 1 perhaps?  (As nothing happens so all is good?)"}, {"owner": {"reputation": 193, "user_id": 5572331, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/769226f9647b7150695c6ead05c36b04?s=128&d=identicon&r=PG&f=1", "display_name": "Habil Ganbarli", "link": "https://stackoverflow.com/users/5572331/habil-ganbarli"}, "edited": false, "score": 0, "creation_date": 1508366568, "post_id": 46820225, "comment_id": 80588139, "body": "Thank you very much :) So,i have numofLines() function which counts the number of lines in maze.txt file in my main funtion(). and i call it in my main function like that:    MazeSolution(mazeArray,startX,startY,pathArray);"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1508366762, "post_id": 46820225, "comment_id": 80588195, "body": "What is <code>pathArray[x][y] == &#39;E&#39;;</code> supposed to do? If you want to assign, it should be <code>=</code>. If you&#39;re comparing, it needs to be inside an <code>if</code> test."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1508366811, "post_id": 46820225, "comment_id": 80588206, "body": "There&#39;s nothing preventing infinite recursion. When you test North, it will then test South, which gets back to the same place, and then they&#39;ll go back and forth like this."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1508366818, "post_id": 46820225, "comment_id": 80588209, "body": "Concur with Barmar. That mistake is repeated in at least three places."}, {"owner": {"reputation": 193, "user_id": 5572331, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/769226f9647b7150695c6ead05c36b04?s=128&d=identicon&r=PG&f=1", "display_name": "Habil Ganbarli", "link": "https://stackoverflow.com/users/5572331/habil-ganbarli"}, "edited": false, "score": 0, "creation_date": 1508366895, "post_id": 46820225, "comment_id": 80588230, "body": "Barmar, thanks for the attention and that part is exit coordinates and assigns char E in my patharray for the route."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1508366970, "post_id": 46820225, "comment_id": 80588254, "body": "@HabilGanbarli No, it doesn&#39;t. That&#39;s the point. It&#39;s an unused expression. There is no assignment on that line, nor on the others that are using <code>==</code> where assignment is intended."}, {"owner": {"reputation": 193, "user_id": 5572331, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/769226f9647b7150695c6ead05c36b04?s=128&d=identicon&r=PG&f=1", "display_name": "Habil Ganbarli", "link": "https://stackoverflow.com/users/5572331/habil-ganbarli"}, "edited": false, "score": 0, "creation_date": 1508367206, "post_id": 46820225, "comment_id": 80588321, "body": "Thanks WhozCraig, that is very kind of you.I corrected them but it is again the same error. Do you have any idea why the program stops working?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1508367232, "post_id": 46820225, "comment_id": 80588333, "body": "One obvious bug is that the &quot;west&quot; move check is moving on a diagonal rather than simply west.  Change <code>x-1,y-1</code> to <code>x,y-1</code>."}, {"owner": {"reputation": 193, "user_id": 5572331, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/769226f9647b7150695c6ead05c36b04?s=128&d=identicon&r=PG&f=1", "display_name": "Habil Ganbarli", "link": "https://stackoverflow.com/users/5572331/habil-ganbarli"}, "edited": false, "score": 0, "creation_date": 1508367528, "post_id": 46820225, "comment_id": 80588426, "body": "Tom Karzes yeah you are right i corrected it but the thing is that it does not check east or west control statements.Just between south and north"}, {"owner": {"reputation": 193, "user_id": 5572331, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/769226f9647b7150695c6ead05c36b04?s=128&d=identicon&r=PG&f=1", "display_name": "Habil Ganbarli", "link": "https://stackoverflow.com/users/5572331/habil-ganbarli"}, "edited": false, "score": 0, "creation_date": 1508372452, "post_id": 46820225, "comment_id": 80589690, "body": "Thanks everybody for giving me ideas.That is really kind of you :), Found the errors.There was infinite recursion because the coordinate always getting back to (0,4) to starting point, from north to south and vice verse.And one main thing for this was i have not checked the tried places"}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 3, "last_activity_date": 1508375655, "creation_date": 1508375655, "answer_id": 46821491, "question_id": 46820225, "link": "https://stackoverflow.com/questions/46820225/c-recursion-segmentation-fault/46821491#46821491", "title": "C Recursion segmentation fault", "body": "<p>Here is a call sequence that leads to an infinite loop:</p>\n\n<pre><code>recursiveMaze(M, x, y, p)\n   recursiveMaze(M, x-1, y, p)\n       recursiveMaze(M, x-1, y, p) -&gt; run to completion\n       recursiveMaze(M, x+1, y, p) -&gt; infinite loop\n</code></pre>\n\n<p>It is infinite because in the second recursive call, you increment back the value that had been decremented in the first recursive call, which takes you back to the same state as the initial call.</p>\n"}], "owner": {"reputation": 193, "user_id": 5572331, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/769226f9647b7150695c6ead05c36b04?s=128&d=identicon&r=PG&f=1", "display_name": "Habil Ganbarli", "link": "https://stackoverflow.com/users/5572331/habil-ganbarli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 46821491, "answer_count": 1, "score": 2, "last_activity_date": 1523015323, "creation_date": 1508365829, "last_edit_date": 1523015323, "question_id": 46820225, "link": "https://stackoverflow.com/questions/46820225/c-recursion-segmentation-fault", "title": "C Recursion segmentation fault", "body": "<p>I am new to C and trying to do a maze problem where 0 and letters are passing points and 1 is a barrier.</p>\n\n<p>My 2D maze array are below where the starting point is at(0,4) and every time I have to check for 4 directions (N,S,E,W), and I have also the path array (initially contains \"0\" as chars) where I will put the routes as \"R\" which is also the same size:</p>\n\n<pre><code>1111S11110       \n0000010001\n110100010d\nt001111110\n0100000001\n0111111101\n1111111101\n00000D01T1\n0111110001\n0000E01110\n</code></pre>\n\n<p>I am using recursive solution for pathfinding and in total use 3 functions which are below:</p>\n\n<pre><code>int isSafe(char Mazearray[matrixSize][matrixSize],int x,int y){\n    if(x &gt;= 0 &amp;&amp; x &lt; matrixSize &amp;&amp; y &gt;= 0 &amp;&amp; y &lt; matrixSize &amp;&amp; Mazearray[x][y] != '1'){\n        return 1;\n    }\n    return 0;\n\n\n}\n\nvoid MazeSolution(char Mazearray[matrixSize][matrixSize],int x,int y,char pathArray[matrixSize][matrixSize]){\n    if(recursiveMaze(Mazearray,x,y,pathArray) == 0){\n        printf(\"There does not exist a possible solution!!!\");\n    }\n    else{\n        int i,j;\n        for (i = 0; i &lt; matrixSize; ++i){\n            for (j = 0; j &lt; matrixSize; ++j){\n                printf(\"%c\",pathArray[i][j]);\n            }\n        printf(\"\\n\");\n        }\n    }\n}\n\nint recursiveMaze(char Mazearray[matrixSize][matrixSize],int x,int y,char pathArray[matrixSize][matrixSize]){\n    if(x == exitX &amp;&amp; y == exitY){\n        pathArray[x][y] == 'E';\n        return 1;\n    }\n    // check if the coordinate is safe to go(not 1)\n    if(isSafe(Mazearray,x,y) == 1){\n        pathArray[x][y] == 'R';\n        // Move North\n        if(recursiveMaze(Mazearray,x-1,y,pathArray) == 1){\n            return 1;\n        }\n        // Move South\n        if(recursiveMaze(Mazearray,x+1,y,pathArray) == 1){\n            return 1;\n        }\n        // Move East\n        if(recursiveMaze(Mazearray,x,y+1,pathArray) == 1){\n            return 1;\n        }\n        // Move West\n        if(recursiveMaze(Mazearray,x-1,y-1,pathArray) == 1){\n            return 1;\n        }\n        pathArray[x][y] == '0';\n        return 0;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When I run the <code>MazeSolution()</code>, the program terminates with error code 255 and segmentation fault. When I debugged the problem appears at <code>recursiveMaze()</code> function.</p>\n\n<p>So that, starting from first if statement it does not execute and the other problem is it goes and comes back between south and north control points.</p>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 1953, "user_id": 4124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L8UMv.png?s=128&g=1", "display_name": "mendosi", "link": "https://stackoverflow.com/users/4124287/mendosi"}, "edited": false, "score": 0, "creation_date": 1508378189, "post_id": 46820050, "comment_id": 80590955, "body": "I think that the <a href=\"https://stackoverflow.com/questions/tagged/dax\">dax</a> tag refers to a different thing. Not sure if there is a tag for your kind of dax."}, {"owner": {"reputation": 31, "user_id": 8571113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1004dcac59972c0d08597762c3ef361d?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/8571113/megan"}, "reply_to_user": {"reputation": 1953, "user_id": 4124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L8UMv.png?s=128&g=1", "display_name": "mendosi", "link": "https://stackoverflow.com/users/4124287/mendosi"}, "edited": false, "score": 0, "creation_date": 1508425914, "post_id": 46820050, "comment_id": 80613901, "body": "Sorry about that. Fixed it."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8571113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1004dcac59972c0d08597762c3ef361d?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/8571113/megan"}, "edited": false, "score": 0, "creation_date": 1508793036, "post_id": 46845556, "comment_id": 80744389, "body": "Thank you for clarifying that. I was not clear (and am still a bit fuzzy) about how the device dax functions versus filesystems mounted with the dax option. I attempted reconfiguring the namespace with ndctl as you suggest. For some reason, I keep getting an error &quot;Resource temporarily unavailable&quot;. I have tried disabling namespace manually, and even tried to delete it, but so far I have not been able to get it to successfully reconfigure."}, {"owner": {"reputation": 11, "user_id": 8805481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d568d9ba60d80f97bb9c99f2def17f?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Balcer", "link": "https://stackoverflow.com/users/8805481/piotr-balcer"}, "reply_to_user": {"reputation": 31, "user_id": 8571113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1004dcac59972c0d08597762c3ef361d?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/8571113/megan"}, "edited": false, "score": 0, "creation_date": 1508842300, "post_id": 46845556, "comment_id": 80763769, "body": "I&#39;ve added more information about DAX to the post. I encourage you to read the LWN article I linked if you are interested in the details. As for your problem, I&#39;m afraid I never encountered your issue. What kernel/ndctl versions are you using? I strongly recommend using the latest kernel (4.13 at the time of writing) and the latest ndctl (v58.2)."}], "tags": [], "owner": {"reputation": 11, "user_id": 8805481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d568d9ba60d80f97bb9c99f2def17f?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Balcer", "link": "https://stackoverflow.com/users/8805481/piotr-balcer"}, "is_accepted": false, "score": 1, "last_activity_date": 1508842096, "last_edit_date": 1508842096, "creation_date": 1508489482, "answer_id": 46845556, "question_id": 46820050, "link": "https://stackoverflow.com/questions/46820050/trying-to-get-emulated-pmem-to-be-recognized-by-libpmem-as-pmem/46845556#46845556", "title": "Trying to get emulated pmem to be recognized by libpmem as pmem", "body": "<p>The library works as expected. Please see the note in current (1.3 at the time of writing) version of <code>man 3 libpmem</code> regarding the state of linux kernel enabling of persistent memory:</p>\n\n<blockquote>\n  <p>NOTE: On Linux, pmem_is_pmem() returns true only if the entire range\n  is mapped directly from Device DAX (/dev/daxX.Y) without an\n  intervening file system. In the future, as file systems become\n  available that support flushing with pmem_persist(), pmem_is_pmem()\n  will return true as appropriate.</p>\n  \n  <p>WARNING: Using pmem_persist() on a range where pmem_is_pmem() returns\n  false may not do anything useful \u2013 use msync(2) instead.</p>\n</blockquote>\n\n<p>This is hopefully going to change soon, see the <a href=\"https://lwn.net/Articles/736332/\" rel=\"nofollow noreferrer\">synchronous page faults patches</a>.</p>\n\n<p>In the meantime, you have two options if you want <code>pmem_is_pmem()</code> to return true:</p>\n\n<ul>\n<li>Use the <code>PMEM_IS_PMEM_FORCE=1</code> environment variable, this is going to force the function to return true.</li>\n<li>Reconfigure your emulated pmem device to device dax. For that task, you will need <a href=\"https://github.com/pmem/ndctl\" rel=\"nofollow noreferrer\">ndctl</a>. The command is: <code>ndctl create-namespace -f -e namespaceX.Y -m dax</code> where the X is the region ID and Y is the ID of the namespace within the region (most likely <code>namespace0.0</code> if you only configured one emulated device).</li>\n</ul>\n\n<p>Device DAX is a special character device that allows one to <code>mmap</code> it and safely perform userspace flushing, whereas in the case of all current linux file systems there <em>might</em> be background/asynchronous work like allocating extents, live defrag and so on - this means that on regular fs, despite mounting it as dax, you still need to call <code>msync()</code> to ensure consistency of your data. And that's what <code>pmem_is_pmem()</code> is informing you about.</p>\n\n<p>You can read more about the problem <a href=\"https://lwn.net/Articles/717953/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 8571113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1004dcac59972c0d08597762c3ef361d?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/8571113/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1508842096, "creation_date": 1508364765, "last_edit_date": 1508795421, "question_id": 46820050, "link": "https://stackoverflow.com/questions/46820050/trying-to-get-emulated-pmem-to-be-recognized-by-libpmem-as-pmem", "title": "Trying to get emulated pmem to be recognized by libpmem as pmem", "body": "<p>I am trying to develop some software using libpmem. I am setting up a test environment, where I can emulated pmem and have the library recognize it as such. I am either having problems, or not understanding something about how pmem is handled by mmap.</p>\n\n<p>I have followed this: <a href=\"http://pmem.io/2016/02/22/pm-emulation.html\" rel=\"nofollow noreferrer\">http://pmem.io/2016/02/22/pm-emulation.html</a></p>\n\n<p>Everything looks great. Boot logs show type 12 memory at the ranges I have specified. I created an ext4 filesystems on the /dev/pmemXX, then mounted it with dax. So now I have:</p>\n\n<pre><code>$ mount | grep pmem\n/dev/pmem0m on /mnt/mem type ext4 (rw,relatime,dax,data=ordered)\n</code></pre>\n\n<p>Now I run into a problem. I create a file, <code>/mnt/mem/data/test1</code>. Next, I run the simple copy example from libpmem. In this, I make a call:</p>\n\n<pre><code>addr = pmem_map_file(\"/mnt/mem/data/test2\", ...)\n</code></pre>\n\n<p>The file is created and data is copied into it. The problem comes when I get the result from:</p>\n\n<pre><code>is_pmem = pmem_is_pmem(addr, file_size)\n</code></pre>\n\n<p>The address returned by the call to <code>pmem_map_file</code> does not register as pmem. When I step through the code, it is clear that the <code>addr</code> returned by the mapping is not in the memory range I have reserved as emulated type 12 memory. Also, the filepath to <code>/mnt/mem/data/test2</code> does not register as a dax character device when the library uses file stat, so both the mapped address and file path fail tests to be recognized as pmem.</p>\n\n<p>From reading about DAX, it sounds as though filesystems mounted as DAX would have files memory mapped directly, and not copied into actual RAM. I am trying to understand what this means about the <code>addr</code> returned when the file is mapped.</p>\n\n<p>I feel like I am missing something here. Shouldn't a mapped file in a filesystem built on emulated pmem, mounted as DAX, return true when I query if it is pmem?</p>\n\n<p>*** EDIT</p>\n\n<p>Thanks Piotr for the clarification. I can use <code>PMEM_IS_PMEM_FORCE</code>, but I would also like to look at device dax operation. I am trying to reconfigure the namespace to device dax, but not having success.</p>\n\n<pre><code>$ sudo strace ./local/opt/bin/ndctl create-namespace -f -e namespace0.0 -m dax\n. . .\nopen(\"/sys/devices/platform/e820_pmem/ndbus0/region0/pfn0.0/align\", \nO_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/sys/devices/platform/e820_pmem/ndbus0/region0/pfn0.0/resource\", \nO_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nopen(\"/sys/devices/platform/e820_pmem/ndbus0/region0/pfn0.0/size\", \nO_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\ngetdents(3, /* 0 entries */, 32768)     = 0\nclose(3)                                = 0\nopen(\"/sys/devices/platform/e820_pmem/ndbus0/region0/dax_seed\", \nO_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)\nwrite(2, \"failed to reconfigure namespace:\"..., 66failed to reconfigure \nnamespace: Resource temporarily unavailable\n) = 66\nexit_group(245)                         = ?\n+++ exited with 245 +++\n</code></pre>\n\n<p>Maybe this is a problem with the kernel I am running? (4.4.0-97 Ubuntu)</p>\n"}, {"tags": ["c", "directory", "readdir", "dirent.h"], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1508373783, "post_id": 46820105, "comment_id": 80589973, "body": "NAME_MAX doesn&#39;t include the terminator, just strlen, so it matches d_name."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 4, "last_activity_date": 1508373849, "last_edit_date": 1508373849, "creation_date": 1508365090, "answer_id": 46820105, "question_id": 46819975, "link": "https://stackoverflow.com/questions/46819975/struct-dirent-in-c-d-name256-and-name-max-definition/46820105#46820105", "title": "struct dirent in C d_name[256] and NAME_MAX definition", "body": "<p><code>NAME_MAX</code> is declared in <code>limits.h</code>. You can also use <code>pathconf()</code> or <code>fpathconf()</code> to get the per-filesystem limit.</p>\n\n<pre><code>long max = pathconf(pathname, _PC_NAME_MAX);\n</code></pre>\n\n<p>Since the structure has this hard-coded to <code>256</code>, it can't actually handle filesystems with longer filenames. So <code>NAME_MAX</code> will necessarily be at most <code>255</code> (which is indeed its value on my OS X machine).</p>\n"}], "owner": {"reputation": 1689, "user_id": 3587282, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/56579efbf0b000eb9e51e41ca5550b65?s=128&d=identicon&r=PG&f=1", "display_name": "hi15", "link": "https://stackoverflow.com/users/3587282/hi15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2900, "favorite_count": 0, "accepted_answer_id": 46820105, "answer_count": 1, "score": 1, "last_activity_date": 1508373849, "creation_date": 1508364256, "last_edit_date": 1508364601, "question_id": 46819975, "link": "https://stackoverflow.com/questions/46819975/struct-dirent-in-c-d-name256-and-name-max-definition", "title": "struct dirent in C d_name[256] and NAME_MAX definition", "body": "<p>I am confused by the use of <code>d_name[256]</code> and <code>NAME_MAX</code> in struct dirent definition. Does <code>d_name[256]</code> mean that the filename length can be atmost 256 character? Then it also mentions NAME_MAX (quoted in the bottom). So, my question is how <code>NAME_MAX</code> relates here and where can I find <code>NAME_MAX</code> value and definition? </p>\n\n<p>In <code>man readdir</code> <code>struct dirent</code> is defined as following. </p>\n\n<pre><code>struct dirent {\n    ino_t          d_ino;       /* inode number */\n    off_t          d_off;       /* not an offset; see NOTES */\n    unsigned short d_reclen;    /* length of this record */\n    unsigned char  d_type;      /* type of file; not supported\n                                    by all filesystem types */\n    char           d_name[256]; /* filename */\n};\n</code></pre>\n\n<p>It also asserts that</p>\n\n<blockquote>\n  <p>The only fields in the dirent structure that are mandated by POSIX.1\n         are: <code>d_name[]</code>, of unspecified size, with at most <code>NAME_MAX</code> characters\n         preceding  the  terminating  null byte ('\\0'); and (as an XSI exten\u2010\n         sion) <code>d_ino</code>.  The other fields are unstandardized, and  not  present\n         on all systems; see NOTES below for some further details.</p>\n</blockquote>\n"}, {"tags": ["c", "linker", "gnu"], "comments": [{"owner": {"reputation": 30092, "user_id": 10098, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01bb891a03442bf5494b7e35804c6dc1?s=128&d=identicon&r=PG", "display_name": "wds", "link": "https://stackoverflow.com/users/10098/wds"}, "edited": false, "score": 0, "creation_date": 1508389789, "post_id": 46819925, "comment_id": 80593634, "body": "This appears to work with binutils 2.26. What version are you using?"}, {"owner": {"reputation": 29701, "user_id": 558639, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f4a1073df397d894cf3ae596988b687?s=128&d=identicon&r=PG", "display_name": "fearless_fool", "link": "https://stackoverflow.com/users/558639/fearless-fool"}, "reply_to_user": {"reputation": 30092, "user_id": 10098, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/01bb891a03442bf5494b7e35804c6dc1?s=128&d=identicon&r=PG", "display_name": "wds", "link": "https://stackoverflow.com/users/10098/wds"}, "edited": false, "score": 0, "creation_date": 1508514626, "post_id": 46819925, "comment_id": 80652921, "body": "According to Eclipse, it&#39;s using: &quot;GNU ARM C/C++ Cross Compiler\t2.4.1.201704251808\tilg.gnuarmeclipse.managedbuild.c&zwnj;&#8203;ross.feature.group\tL&zwnj;&#8203;iviu Ionescu&quot; Not clear which particular version of the linker it&#39;s using."}], "answers": [{"comments": [{"owner": {"reputation": 29701, "user_id": 558639, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f4a1073df397d894cf3ae596988b687?s=128&d=identicon&r=PG", "display_name": "fearless_fool", "link": "https://stackoverflow.com/users/558639/fearless-fool"}, "edited": false, "score": 0, "creation_date": 1508514741, "post_id": 46840971, "comment_id": 80652996, "body": "Sigh.  That&#39;s what I feared -- thanks for the clear interpretation."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 1, "last_activity_date": 1508461377, "creation_date": 1508461377, "answer_id": 46840971, "question_id": 46819925, "link": "https://stackoverflow.com/questions/46819925/defining-a-symbolic-constant-for-gnu-ld-script-origin/46840971#46840971", "title": "Defining a symbolic constant for GNU .ld script origin", "body": "<p>the LD manual states, for MEMORY :</p>\n\n<p>\"The origin is an expression for the start address of the memory region. The expression must evaluate to a constant before memory allocation is performed, which means that you may not use any section relative symbols. The keyword ORIGIN may be abbreviated to org or o (but not, for example, ORG). \"</p>\n\n<p>And the expression: <code>BASE_ADDR = 0X4000;</code>  is a section relative symbol</p>\n\n<p>The following text also pertains:</p>\n\n<p>\"However, other values (such as symbol values) are not known or needed until after storage allocation. Such values are evaluated later, when other information (such as the sizes of output sections) is available for use in the symbol assignment expression. \"</p>\n\n<p>Suggest using hard coded values in the MEMORY allocations</p>\n"}], "owner": {"reputation": 29701, "user_id": 558639, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f4a1073df397d894cf3ae596988b687?s=128&d=identicon&r=PG", "display_name": "fearless_fool", "link": "https://stackoverflow.com/users/558639/fearless-fool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1594, "favorite_count": 0, "accepted_answer_id": 46840971, "answer_count": 1, "score": 1, "last_activity_date": 1508461377, "creation_date": 1508363945, "question_id": 46819925, "link": "https://stackoverflow.com/questions/46819925/defining-a-symbolic-constant-for-gnu-ld-script-origin", "title": "Defining a symbolic constant for GNU .ld script origin", "body": "<p>I'm creating a GNU .ld linker script, and would like to define the origins of some of the memory sections symbolically.  The following doesn't work:</p>\n\n<pre><code>BASE_ADDR = 0x4000;\n\nMEMORY\n{\n  m_interrupts        (RX) : ORIGIN = BASE_ADDR, LENGTH = 0x0200\n  m_bootloader_config (RX) : ORIGIN = BASE_ADDR + 0x3C0, LENGTH = 0x0040\n  m_text              (RX) : ORIGIN = BASE_ADDR + 0x400, LENGTH = 0x10000 - (BASE_ADDR + 0x400)\n  m_data              (RW) : ORIGIN = 0x1FFFF000, LENGTH = 0x4000\n}\n</code></pre>\n\n<p>This results in the following error:</p>\n\n<pre><code>Invoking: Cross ARM C++ Linker\n../MKL27Z64xxx4_flash.ld:67: nonconstant expression for origin\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>The error is referring to the line that reads:</p>\n\n<pre><code>m_interrupts        (RX) : ORIGIN = BASE_ADDR, LENGTH = 0x0200\n</code></pre>\n\n<p>What baffles me is that <code>BASE_ADDR</code> looks pretty constant to me.  Is there some special syntax that I need to invoke to convince <code>ld</code> that <code>BASE_ADDR</code> is constant?</p>\n"}, {"tags": ["c", "eclipse", "codeblocks", "clion", "operator-precedence"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1508363293, "post_id": 46819758, "comment_id": 80587053, "body": "The compilers are fine. It&#39;s undefined behavior."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508363355, "post_id": 46819758, "comment_id": 80587076, "body": "Why would you want to increment and decrement a value in the same expression anyway?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508363407, "post_id": 46819758, "comment_id": 80587096, "body": "@WeatherVane I can think of some funny applications when it&#39;s some hardware register..."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1508364410, "post_id": 46819758, "comment_id": 80587484, "body": "In this case, different compilers are free to translate the same thing differently, because the C standard does not define the order in which the operands are evaluated.  In other words, never do this, at best it&#39;s a bug waiting to happen.  A new compiler release, different optimization setting, etc. could suddenly cause the behavior to change."}, {"owner": {"reputation": 1, "user_id": 5705654, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Aa3DbUSDFmY/AAAAAAAAAAI/AAAAAAAAAQo/K-kg4nUWs8E/photo.jpg?sz=128", "display_name": "Troy Giorshev", "link": "https://stackoverflow.com/users/5705654/troy-giorshev"}, "edited": false, "score": 0, "creation_date": 1508368714, "post_id": 46819758, "comment_id": 80588725, "body": "All of the examples I have found involve assigning a variable to itself, with the increment operator.  Like <code>i = i++ + --i</code>.  It&#39;s good to know that this applies in general!"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1508378598, "post_id": 46819758, "comment_id": 80591043, "body": "The description page you cited is about Java.  Java has well-defined rules for expressions like this, but C does not.  In C, this expression is <i>undefined</i>, specifically because it tries to modify variable <code>y</code> twice."}], "owner": {"reputation": 1, "user_id": 5705654, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Aa3DbUSDFmY/AAAAAAAAAAI/AAAAAAAAAQo/K-kg4nUWs8E/photo.jpg?sz=128", "display_name": "Troy Giorshev", "link": "https://stackoverflow.com/users/5705654/troy-giorshev"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1508363284, "answer_count": 0, "score": 0, "last_activity_date": 1508363132, "creation_date": 1508363132, "question_id": 46819758, "link": "https://stackoverflow.com/questions/46819758/c-order-of-operations-contradiction-between-eclipse-clion-codeblocks-and-mor", "closed_reason": "Duplicate", "title": "C Order of Operations Contradiction between Eclipse, CLion, Code::Blocks and more", "body": "<p>I have seemingly very basic question about the order of operations in c, specifically involving the increment operator.</p>\n\n<p>If I have this code:</p>\n\n<pre><code>int x,y;\ny = 4;\nx = ++y + y--;\n\nprintf(\"x: %d y: %d\", x,y)\n</code></pre>\n\n<p>The output I expect is:<br>\n<code>x: 10 y: 4</code></p>\n\n<p>I got this using the process described here:<br>\n<a href=\"http://ntci.on.ca/compsci/java/ch2/2_3.html\" rel=\"nofollow noreferrer\">http://ntci.on.ca/compsci/java/ch2/2_3.html</a><br>\n(See Example 2, in the red box)</p>\n\n<p>When I run this in eclipse on Mac with the MacOSX GCC, this is the answer it gives.  Great.</p>\n\n<p>However, when I use CLion (under MinGW), it gives:<br>\n<code>x: 9 y: 4</code></p>\n\n<p>So does Code::Blocks (with MinGW), and many online compilers such as:<br>\n<a href=\"https://www.onlinegdb.com/online_c_compiler\" rel=\"nofollow noreferrer\">https://www.onlinegdb.com/online_c_compiler</a><br>\nand<br>\njdoodle's<br>\nand<br>\ntutorialspoint's.</p>\n\n<p>What gives?  Is eclipse and my understanding of the order of operations in C wrong?</p>\n\n<p>Or are CLion, Code::Blocks, and a ton of online compilers wrong? </p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1508363584, "post_id": 46819670, "comment_id": 80587164, "body": "Is it possible one of your threads is returning before being cancelled and <code>115390242</code> is its return value?"}, {"owner": {"reputation": 704, "user_id": 143622, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1474506b68f43176119367b3637c5315?s=128&d=identicon&r=PG", "display_name": "ExpertNoob1", "link": "https://stackoverflow.com/users/143622/expertnoob1"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1508364159, "post_id": 46819670, "comment_id": 80587385, "body": "As I said, I have printfs everywhere, and I&#39;m sure the thread ends in a testcancel(). The only <code>pthread_exit(&amp;err)</code>s in the thread routine are called with a variable <code>err</code> that only gets values 0 or 1. All lines mentioning <code>err</code> either assign it a value of 0, or a 1."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1508743945, "post_id": 46819670, "comment_id": 80715361, "body": "Is <code>pthread_join</code> always returning 0?"}], "owner": {"reputation": 704, "user_id": 143622, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1474506b68f43176119367b3637c5315?s=128&d=identicon&r=PG", "display_name": "ExpertNoob1", "link": "https://stackoverflow.com/users/143622/expertnoob1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508362707, "creation_date": 1508362707, "question_id": 46819670, "link": "https://stackoverflow.com/questions/46819670/canceled-pthread-but-not-pthread-canceled", "title": "Canceled pthread, but not PTHREAD_CANCELED?", "body": "<p>After canceling a bunch of identical (same function) pthreads with <code>pthread_cancel()</code>, I wait on them to stop and collect exit codes : </p>\n\n<pre><code>for(j = oldest; j &lt; thCnt ; j++){\n  pthread_join(thT[j], &amp;ret); rc = (int)(intptr_t) ret;\n}\n</code></pre>\n\n<p>Most threads end up with <code>ret == PTHREAD_CANCELED</code>, but one of them does not, and its rc is 115390242 (always the same value, even though the \"eccentric\" thread may change). From the million printfs I  used to trace this in detail, I'm pretty sure they all caught the <code>pthread_testcancel()</code>, so why does one of them not end up with <code>ret == PTHREAD_CANCELED</code> ?\nAnyone suffered a similar oddity ?</p>\n\n<p>I'm under Linux, using <code>PTHREAD_CANCEL_DEFERRED</code> threads.</p>\n"}, {"tags": ["c++", "c", "multithreading", "file"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508362197, "post_id": 46819473, "comment_id": 80586558, "body": "Well, obviously <code>fread()</code> <i>can</i> be non-reentrant.  I guess the question is whether it <i>is</i> non-reentrant on Win32, and perhaps whether that would be conforming."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1508363249, "post_id": 46819473, "comment_id": 80587033, "body": "According to microsoft (look at remarks in <a href=\"https://msdn.microsoft.com/en-us/library/0ys3hc0b.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/0ys3hc0b.aspx</a> ) the return value from <code>ftell()</code> or (as you&#39;re using) <code>_ftelli64()</code>  is determined by the last I/O operation.  They wouldn&#39;t have made that sort of remark unless there was potential for some mismatch, such as what you have seen."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1508363739, "post_id": 46819473, "comment_id": 80587223, "body": "@Peter, those comments seem to be directed mainly at files opened in append mode, where the next write will always occur at the end of the file, which may not be immediately following the last read."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1508368892, "post_id": 46819473, "comment_id": 80588770, "body": "Those deviations don&#39;t look like race conditions to me. They look like error returns being misinterpreted as byte counts. Try logging more information about mismatches. (Starting position, bytes reported read, reported ending position, filename.)"}, {"owner": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1508396745, "post_id": 46819473, "comment_id": 80596061, "body": "@rici : I updated the example and typical output"}, {"owner": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "edited": false, "score": 0, "creation_date": 1508396870, "post_id": 46819473, "comment_id": 80596122, "body": "<code>ferror</code> never reports any error even when there is a mismatch. Besides this 1)I&#39;m reading from hdd not from a faulty IO source 2)This happens on all systems I have tested so this is not due to the hardware/system 3)It does not happen with 1 thread 4)It does not happen with std::iostream =&gt; To me this is a race condition"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508400956, "post_id": 46819473, "comment_id": 80598384, "body": "Unicode filenames work like a charm in fstreams under cygwin g++."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1508426134, "post_id": 46819473, "comment_id": 80614046, "body": "@galinette: Thanks, that seems like useful information."}, {"owner": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508429502, "post_id": 46819473, "comment_id": 80616297, "body": "@n.m. you mean that std::fstream has a wstring constructor? I&#39;d like a proof of this..."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508430086, "post_id": 46819473, "comment_id": 80616626, "body": "No, it works with narrow strings (converts to and from utf8?)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1508435246, "post_id": 46819473, "comment_id": 80619373, "body": "@galinette: ok, i&#39;m convinced that it is not related to an error return. The regularity of your test output, however, leads me to still be a bit skeptical about the race condition theory, although it is of course possible. But there are many other possibilities. One question I have is whether your _ftelli64 is really calling that msvcrt function, or whether it might be using <code>_telli64(fileno(f))</code> instead, which I believe has slightly different semantics."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1508492631, "post_id": 46819473, "comment_id": 80640329, "body": "Windows systems do <code>fopen</code> in text mode by eliminating CRLF sequences and converting them into <code>\\n</code> chars.... this can lead to reading some chars less or more than you expect, if you have this sequences in a binary file that&#39;s being read in text mode.  Be careful and check you didn&#39;t <code>fopen</code> in text mode."}], "answers": [{"comments": [{"owner": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "edited": false, "score": 0, "creation_date": 1508397203, "post_id": 46820063, "comment_id": 80596297, "body": "fread always returns the number of bytes I have asked. ferror always returns 0 (no error)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "edited": false, "score": 0, "creation_date": 1508422045, "post_id": 46820063, "comment_id": 80611172, "body": "Well then, @galinette, unless two of your threads are reading from the same file, you are observing a bug in Microsoft&#39;s C library.  Do note that multiple threads reading the same file really could produce the results you describe, though.  Two different threads&#39; <code>fread()</code> calls on the same file could occasionally occur between between the <code>_ftelli64()</code> calls of one or both threads, producing the behavior you observe.  That would be consistent with the fact that the differences you observe appear to balance out to zero on a file-by-file basis."}, {"owner": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "edited": false, "score": 0, "creation_date": 1508429688, "post_id": 46820063, "comment_id": 80616399, "body": "Rather a bug from MinGW dll. One of the MinGW developpers told me that _ftelli64 is not exported by msvcrt.dll, so they reimplemented it (and possibly broke it)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "edited": false, "score": 0, "creation_date": 1508432610, "post_id": 46820063, "comment_id": 80617998, "body": "@galinette, in that event, yes, it is plausible that the bug is in MinGW rather than in msvcrt.  I&#39;m not sure how one would prove it, but I&#39;m also not sure it matters which one is to blame.  Anyway, the bottom line remains that the behavior you observe does not conform to the requirements of the standard."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1508439301, "post_id": 46820063, "comment_id": 80621419, "body": "@john: but that code does not read from the same  <code>FILE</code> in two different threads. It doesn&#39;t even read from the same file in two threads. Also: <code>_ftelli64</code> does not form part of any standard and according to OP, there is no problem when the standard <code>ftell</code> is used."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1508441608, "post_id": 46820063, "comment_id": 80622622, "body": "@rici, if the problem is indeed in <code>_ftelli64()</code> then you&#39;re right.  Although the fact that the problem is not observed when <code>ftell()</code> is used instead is suggestive that this is the case, it is not definitive.  Anyway, I don&#39;t really care in which function the problem lies.  The bottom line -- as I should have said it -- is that the observed joint behavior of the two functions does not conform to the functions&#39; respective specifications."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1508365232, "last_edit_date": 1508365232, "creation_date": 1508364858, "answer_id": 46820063, "question_id": 46819473, "link": "https://stackoverflow.com/questions/46819473/can-fread-be-non-rentrant/46820063#46820063", "title": "Can fread be non rentrant?", "body": "<p>Since you're asking mostly about the C standard library, the C standard says:</p>\n\n<blockquote>\n  <p>Each stream has an associated lock that is used to prevent data races when multiple threads of execution access a stream, and to restrict the interleaving of stream operations performed by multiple threads. Only one thread may hold this lock at a time. The lock is reentrant: a single thread may hold the lock multiple times at a given time.</p>\n  \n  <p>All functions that read, write, position, or query the position of a stream lock the stream before accessing it. They release the lock associated with the stream when the access is complete.</p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.2p7\" rel=\"nofollow noreferrer\">C2011 7.21.2/7-8</a>)</p>\n\n<p>C++ folks should note that in C, \"stream\" means the kind of thing accessed via a <code>FILE *</code>.  Of <code>fread()</code>, the standard says, in part,</p>\n\n<blockquote>\n  <p>The file position indicator for the stream (if defined) is advanced by the number of characters successfully read.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>The fread function returns the number of elements successfully read</p>\n</blockquote>\n\n<p>but also</p>\n\n<blockquote>\n  <p>If an error occurs, the resulting value of the file position indicator for the stream is indeterminate.</p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.8.1p2\" rel=\"nofollow noreferrer\">C2011, 7.21.8.1/2-3</a>)</p>\n\n<p>It seems not to characterize reaching the end of the stream as an error.</p>\n\n<p>Although C11 does not specifically say that <code>fread()</code> must be thread-safe, it does acknowledge the existence of multithreaded programs and define their semantics.  It specifies that in such programs,</p>\n\n<blockquote>\n  <p>The execution of each thread proceeds as defined by the remainder of this standard.</p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.1.2.4p1\" rel=\"nofollow noreferrer\">C2011, 5.1.2.4/1</a>)</p>\n\n<p>That does not afford the possibility of <code>fread()</code> failing to behave as documented when called in parallel on different streams, and the locking requirements I cited earlier prevent data races and the attending undefined behavior even when it is called in parallel on <em>the same</em> stream.</p>\n\n<p><code>_ftelli64()</code> is not a standard library function in ISO C, but the Win32 docs specify its behavior in the same terms that that they specify the behavior of <code>ftell()</code>, which <em>is</em> a standard library function.  Both</p>\n\n<blockquote>\n  <p>retrieve the current position of the file pointer (if any) associated with <code>stream</code>. The position is expressed as an offset relative to the beginning of the stream. </p>\n</blockquote>\n\n<p>(<a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/ftell-ftelli64\" rel=\"nofollow noreferrer\">Microsoft C library documentation</a>)</p>\n\n<p>Microsoft's \"file pointer\" is the same thing as ISO C's \"file position\".  Overall, then, the only way I can see the observed behavior conforming is if a few of the <code>fread()</code> calls encounter errors.  You can check for this by calling <code>ferror()</code> in the event that <code>fread()</code> returns 0.  If there are errors, then all bets are off.</p>\n"}], "owner": {"reputation": 7908, "user_id": 2042388, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Qz7YO.jpg?s=128&g=1", "display_name": "galinette", "link": "https://stackoverflow.com/users/2042388/galinette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1508397001, "creation_date": 1508361782, "last_edit_date": 1508397001, "question_id": 46819473, "link": "https://stackoverflow.com/questions/46819473/can-fread-be-non-rentrant", "title": "Can fread be non rentrant?", "body": "<p>In a program written in C++ and compiled with MinGW-w64 under windows, I read several files concurrently in separate threads. Since the file names may have non ASCII characters, I cannot use the C++ standard library <code>std::ifstream</code> as it does not support <code>wchar</code> file names. So I need to use the C library with <code>_wfopen</code> from the Win32 API.</p>\n\n<p>However, I get a very strange bug which I have reproduced in a MCVE. After reading n bytes with fread(), the result from <code>_ftelli64</code> is sometimes not increased by n, but by a few bytes less or more.</p>\n\n<p>With single thread reading, the issue is gone, and with <code>std::ifstream</code> as well.</p>\n\n<p>It acts as if there was a race condition in fread, which would then be non-reentrant.</p>\n\n<p>In the following example, I replaced <code>_wfopen</code> by <code>fopen</code> as the bug is still there.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;fstream&gt;\n#include &lt;thread&gt;\n\nconstexpr const int numThreads = 8;\nconstexpr const int blockSize = 65536+8;\nconstexpr const int fileBlockCount = 48; //3MB files\n\nvoid readFile(const std::string &amp; path)\n{\n    std::cout &lt;&lt; \"Reading file \" &lt;&lt; path &lt;&lt; \"\\n\";\n    std::vector&lt;char&gt; buffer(blockSize);\n\n    FILE * f = fopen(path.c_str(), \"rb\");\n    for(int i=0;i&lt;fileBlockCount;++i)\n    {\n\n        int64_t pos_before = _ftelli64(f);\n        int64_t n = fread(buffer.data(), 1, buffer.size(),f);\n        int64_t pos_after = _ftelli64(f);\n        int64_t posMismatch = (int64_t)pos_after-(pos_before+n);\n        if(ferror(f))\n        {\n            std::cout &lt;&lt; \"fread error\\n\";\n        }\n        if(posMismatch!=0)\n        {\n            std::cout &lt;&lt; \"Error \" &lt;&lt; path\n                  &lt;&lt; \" / ftell before \" &lt;&lt; pos_before\n                  &lt;&lt; \" / fread returned \" &lt;&lt; n\n                  &lt;&lt; \" / ftell after \" &lt;&lt; pos_after\n                  &lt;&lt; \" / mismatch \" &lt;&lt; posMismatch &lt;&lt; \"\\n\";\n        }\n    }\n    fclose(f);\n}\n\nint main()\n{\n    //Generate file names\n    std::vector&lt;std::string&gt; fileNames(numThreads);\n    for(int i=0;i&lt;numThreads;++i)\n    {\n        std::ostringstream oss;\n        oss &lt;&lt; i &lt;&lt; \".dat\";\n        fileNames[i] = oss.str();\n    }\n\n\n    //Create dummy data files\n    for(int i=0;i&lt;numThreads;++i)\n    {\n        std::ofstream f(fileNames[i], std::ios_base::binary);\n        for(int j=0;j&lt;blockSize*fileBlockCount;++j)\n        {\n            f.put((char)(j&amp;255));\n        }\n    }\n\n\n    //Read data files in separate threads\n    std::vector&lt;std::thread&gt; threads;\n    for(int i=0;i&lt;numThreads;++i)\n    {\n        threads.emplace_back(readFile, fileNames[i]);\n    }\n\n    //This waits for the threads to finish\n    for(int i=0;i&lt;numThreads;++i)\n    {\n        threads[i].join();\n    }\n    threads.clear();\n\n    std::cout &lt;&lt; \"Done\";\n}\n</code></pre>\n\n<p>The output is randomly something like:</p>\n\n<pre><code>Error 3.dat / ftell before 65544 / fread returned 65544 / ftell after 131089 / mismatch 1\nError 7.dat / ftell before 0 / fread returned 65544 / ftell after 65543 / mismatch -1\nError 7.dat / ftell before 65543 / fread returned 65544 / ftell after 131088 / mismatch 1\nError 3.dat / ftell before 2162953 / fread returned 65544 / ftell after 2228498 / mismatch 1\nError 7.dat / ftell before 2162952 / fread returned 65544 / ftell after 2228497 / mismatch 1\nError 3.dat / ftell before 3080570 / fread returned 65544 / ftell after 3146112 / mismatch -2\nError 7.dat / ftell before 3080569 / fread returned 65544 / ftell after 3146112 / mismatch -1\nError 2.dat / ftell before 65544 / fread returned 65544 / ftell after 131089 / mismatch 1\nError 6.dat / ftell before 0 / fread returned 65544 / ftell after 65543 / mismatch -1\nError 6.dat / ftell before 65543 / fread returned 65544 / ftell after 131088 / mismatch 1\nError 2.dat / ftell before 2162953 / fread returned 65544 / ftell after 2228498 / mismatch 1\nError 6.dat / ftell before 2162952 / fread returned 65544 / ftell after 2228497 / mismatch 1\nError 2.dat / ftell before 3080570 / fread returned 65544 / ftell after 3146112 / mismatch -2\nError 6.dat / ftell before 3080569 / fread returned 65544 / ftell after 3146112 / mismatch -1\n</code></pre>\n\n<p><strong><em>EDIT : This seems related to <code>_ftelli64</code></em></strong></p>\n\n<p>If I replace <code>_ftelli64</code> by <code>ftell</code>, the issue is not there anymore\nSo is this a broken not reentrent implementation of <code>_ftelli64</code> ?</p>\n"}, {"tags": ["c", "embedded", "stm32f4discovery"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1508362530, "post_id": 46819082, "comment_id": 80586725, "body": "There is no reason <code>pin_no</code> and <code>mode</code> should have the same type. Their values are not used together as occurs in operations like add or multiply. Rather, <code>pin_no</code> is simply an index, used (with 2) to calculate how much to shift a value (<code>mode</code>). The number of bits to shift simply has to be a number; it does not have to be the same type as the thing being shifted. So, while operators like <code>+</code> and <code>*</code> require that their operands be converted to the same type, the <code>&lt;&lt;</code> operator may have different types on its left and right sides."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1508369514, "post_id": 46819082, "comment_id": 80588917, "body": "Look at the moder register in the gpio section of the documentation for the chip.  You will see that this is simply setting a couple of bits in this register."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1508424321, "post_id": 46819082, "comment_id": 80612792, "body": "Google: &quot;c how do the bitwise operators work&quot;. Or read a book."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1508362283, "post_id": 46819460, "comment_id": 80586606, "body": "I would add to it that it is likely a mode for each pin is encoded by two bits and can have 4 different values. And this function is assuming the mode is initially set to <code>00</code>."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1508369432, "post_id": 46819460, "comment_id": 80588900, "body": "yes fine for post reset depending on the reset state, but should mask off before orring."}], "tags": [], "owner": {"reputation": 2091, "user_id": 5226287, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/27CtT.png?s=128&g=1", "display_name": "Georg P.", "link": "https://stackoverflow.com/users/5226287/georg-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1508361719, "creation_date": 1508361719, "answer_id": 46819460, "question_id": 46819082, "link": "https://stackoverflow.com/questions/46819082/bitwise-operations-in-c-coding/46819460#46819460", "title": "Bitwise operations in C coding", "body": "<p>Trying to explain the line <code>GPIOx-&gt;MODER |= (mode &lt;&lt; (2* pin_no));</code>:</p>\n\n<ul>\n<li><code>GPIOx</code> is a pointer to a structure</li>\n<li><code>GPIOx-&gt;MODER</code> accesses the member <code>MODER</code> inside this structure</li>\n<li><code>x |= y</code> is an abbreviation of <code>x = x | y</code>, which means \"perform a logic OR of x and y, and write the result back to x</li>\n<li><code>mode &lt;&lt; (2* pin_no)</code> means left-shift the content of variable <code>mode</code> by twice <code>pin_no</code> bits.</li>\n</ul>\n\n<p>Hence, the line means \"take the content of <code>GPIOx-&gt;MODER</code>, bitwise-OR it with the left-shiftet content of <code>mode</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 8798036, "user_type": "registered", "profile_image": "https://graph.facebook.com/1870902679605671/picture?type=large", "display_name": "Aditya Rajguru", "link": "https://stackoverflow.com/users/8798036/aditya-rajguru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 46819460, "answer_count": 1, "score": 0, "last_activity_date": 1508362150, "creation_date": 1508360123, "last_edit_date": 1508362150, "question_id": 46819082, "link": "https://stackoverflow.com/questions/46819082/bitwise-operations-in-c-coding", "title": "Bitwise operations in C coding", "body": "<p>I'm trying to learn how to write drivers for GPIO pins in STM32F4 Discovery. I was going through the tutorials and I came across this line:</p>\n\n<pre><code>static void hal_gpio_configure_pin_mode (GPIO_TypeDef *GPIOx, uint16_t pin_no, uint32_t mode)\n{\n    GPIOx-&gt;MODER |= (mode &lt;&lt; (2* pin_no));\n}\n</code></pre>\n\n<p>I am relatively new to embedded systems and don't know what <code>GPIOX-&gt;MODER |= (mode &lt;&lt; (2* pin_no));</code> does. Also, I don't know why pin_no is 16 bit while mode is 32 bit. I know that &lt;&lt; is the left shift bitwise operator. But I still don't get the complete context.</p>\n\n<p>Can anybody explain all this?</p>\n"}, {"tags": ["c", "opengl", "glut"], "comments": [{"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1508358945, "post_id": 46818588, "comment_id": 80584954, "body": "1) You are setting the color <i>after</i> the triangle has been drawn. 2) Your second and third vertex are the same."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7910995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532fb2862eb9cf8c3c50126b22f27505?s=128&d=identicon&r=PG&f=1", "display_name": "zien Alhaoushe", "link": "https://stackoverflow.com/users/7910995/zien-alhaoushe"}, "edited": false, "score": 0, "creation_date": 1508598609, "post_id": 46818842, "comment_id": 80676831, "body": "yes it was initializing issue it works right now thank you"}], "tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 0, "last_activity_date": 1508426262, "last_edit_date": 1508426262, "creation_date": 1508359050, "answer_id": 46818842, "question_id": 46818588, "link": "https://stackoverflow.com/questions/46818588/my-open-gl-doesnt-work-properly/46818842#46818842", "title": "my open gl doesn&#39;t work properly?", "body": "<p>You have to initialize the <a href=\"https://www.opengl.org/resources/libraries/glut/\" rel=\"nofollow noreferrer\">GLUT</a> library (see <a href=\"https://www.opengl.org/resources/libraries/glut/spec3/node10.html\" rel=\"nofollow noreferrer\"><code>glutInit</code></a>):</p>\n\n<p>Either:</p>\n\n<pre><code>int main()\n{\n    int cnt = 0;\n    glutInit(&amp;cnt, NULL);\n    .....\n</code></pre>\n\n<p>or </p>\n\n<pre><code>int main(int argc, char** argv)\n{\n    glutInit(&amp;argc, argv);\n    .....\n</code></pre>\n\n<p>Further 2 points of your triangle are equal. Change it for example to:</p>\n\n<pre><code> glBegin(GL_TRIANGLES);\n glColor3f(1.0f, 0.0f, 0.0f);\n glVertex2f( 0.0f, 1.0f );\n glVertex2f( 0.5f, 0.0f );\n glVertex2f( 0.5f, 1.0f );\n glEnd();\n</code></pre>\n\n<p><br/>\nSee further <a href=\"https://stackoverflow.com/questions/45473091/undefined-reference-when-using-glew-and-mingw/45476269#45476269\">Undefined reference when using glew and mingw?</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7910995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532fb2862eb9cf8c3c50126b22f27505?s=128&d=identicon&r=PG&f=1", "display_name": "zien Alhaoushe", "link": "https://stackoverflow.com/users/7910995/zien-alhaoushe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "closed_date": 1508367292, "accepted_answer_id": 46818842, "answer_count": 1, "score": 0, "last_activity_date": 1508426262, "creation_date": 1508358030, "last_edit_date": 1508358818, "question_id": 46818588, "link": "https://stackoverflow.com/questions/46818588/my-open-gl-doesnt-work-properly", "closed_reason": "Not suitable for this site", "title": "my open gl doesn&#39;t work properly?", "body": "<p>i was trying to setup opengl libraries on visual studio 2013 this code for drawing a triangle i don't have error in error list which relate to include files but  it dosen't work \nthis is the code: </p>\n\n<pre><code>#include&lt;glut.h&gt;\n\nstatic void redraw();\n\nvoid main()\n{\n    glutInitDisplayMode(GLUT_RGB | GLUT_SINGLE);\n    glutInitWindowPosition(100, 100); \n    glutInitWindowSize(400, 300); \n    glutCreateWindow(\"Application11\");\n    glutDisplayFunc(redraw);\n    glutMainLoop();\n}\n\nstatic void redraw()\n{\n    glBegin(GL_TRIANGLES);\n    glVertex2f(0,1);\n    glVertex2f(0.5,0);\n    glVertex2f(0.5,0);\n    glColor3f(1,0,0);\n    glEnd();\n    glFlush();\n}\n</code></pre>\n"}, {"tags": ["c", "process", "waitpid"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1508357283, "post_id": 46818373, "comment_id": 80584100, "body": "<code>ps aux | grep a.out</code> might surprise you"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1508357345, "post_id": 46818373, "comment_id": 80584134, "body": "just want to know for what purpose you wrote the code?"}, {"owner": {"reputation": 361, "user_id": 6591057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaYfz.jpg?s=128&g=1", "display_name": "kww", "link": "https://stackoverflow.com/users/6591057/kww"}, "reply_to_user": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1508357438, "post_id": 46818373, "comment_id": 80584172, "body": "@LethalProgrammer This is from a tutorial as an example of silly code. But I do want to figure it out."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1508358456, "post_id": 46818373, "comment_id": 80584682, "body": "If you&#39;re an inexperienced C programmer, then <code>fork()</code> is <i>not</i> the place to start."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1508358702, "post_id": 46818373, "comment_id": 80584833, "body": "Nevertheless, if you&#39;re determined to figure this out, then the appropriate thing to do would be to read the documentation for the functions you are calling: <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\"><code>fork()</code></a>, <a href=\"http://man7.org/linux/man-pages/man2/wait.2.html\" rel=\"nofollow noreferrer\"><code>waitpid()</code></a>, and <a href=\"http://man7.org/linux/man-pages/man3/printf.3.html\" rel=\"nofollow noreferrer\"><code>printf()</code></a>.  If that&#39;s too heavy for you, you can likely find tutorial-level information about these scattered across the web.  Google is your friend."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1508468090, "last_edit_date": 1508468090, "creation_date": 1508463129, "answer_id": 46841167, "question_id": 46818373, "link": "https://stackoverflow.com/questions/46818373/could-not-understand-the-output-from-the-code/46841167#46841167", "title": "Could not understand the output from the code", "body": "<p>the function: <code>fork()</code>  can set the <code>pid</code> to any of three different meanings: </p>\n\n<ol>\n<li><code>-1</code> means an error occurred.  </li>\n<li><code>=0</code> means currently running the child process.  </li>\n<li><code>&gt;0</code> means currently running the parent process.</li>\n</ol>\n\n<p>So the parent forks children according to the number of command line parameters.  Then waits for each consecutive child to exit.</p>\n\n<p>Each child process executes the <code>printf()</code> function then exits</p>\n\n<p>Finally the parent executes the <code>printf()</code> function with a <code>argc</code> of 0</p>\n\n<p>Note:  the code should be checking the returned value from the call to <code>waitpid()</code></p>\n\n<p>Note: the code should be checking the variable <code>id</code> > 0 to assure the call to <code>fork()</code> was successful.   As it is, a failure of that call (returned -1) will result in the call to <code>waitpid()</code> to wait forever because there is no child process to wait on\n.</p>\n\n<p>Here is a pair of example rund where <code>untitled1</code> is the name of the executable</p>\n\n<pre><code>rkwill@richard-desktop:~/Documents/forum$ ./untitled1 1 2 3\n3:3\n2:2\n1:1\n0:./untitled1\nrkwill@richard-desktop:~/Documents/forum$ ./untitled1 \n0:./untitled1\nrkwill@richard-desktop:~/Documents/forum$ \n</code></pre>\n\n<p>As you can see from the above, when given parameters, it lists them in reverse order, then lists the <code>argv[0]</code>.</p>\n\n<p>When given no parameters, it still lists the <code>argv[0]</code></p>\n"}], "owner": {"reputation": 361, "user_id": 6591057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaYfz.jpg?s=128&g=1", "display_name": "kww", "link": "https://stackoverflow.com/users/6591057/kww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 46841167, "answer_count": 1, "score": 0, "last_activity_date": 1508468090, "creation_date": 1508357214, "question_id": 46818373, "link": "https://stackoverflow.com/questions/46818373/could-not-understand-the-output-from-the-code", "title": "Could not understand the output from the code", "body": "<p>I wrote the following code and ran it for a couple times. But every time the result is different.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/wait.h&gt;\nint main(int argc, char **argv) {\n  pid_t id;\n  int status; \n  while (--argc &amp;&amp; (id=fork())) {\n    waitpid(id,&amp;status,0); /* Wait for child*/\n  }\n  printf(\"%d:%s\\n\", argc, argv[argc]);\n  return 0;\n}\n</code></pre>\n\n<p>I ran like:</p>\n\n<pre><code>./a.out 1 2 3\n</code></pre>\n\n<p>Then sometimes I got:</p>\n\n<pre><code>3: 3\n2: 2\n1: 1\n0: ./a.out\n$ 0: ./a.out  (It seems still running, waiting for my input)\n</code></pre>\n\n<p>Sometimes I got:</p>\n\n<pre><code>3: 3\n$ 3: 3 (It seems still running, waiting for my input)\n</code></pre>\n\n<p>Any idea? Thanks!</p>\n"}, {"tags": ["c", "for-loop"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 2, "creation_date": 1508356774, "post_id": 46818233, "comment_id": 80583846, "body": "Have you tried to step through that code with a <a href=\"https://stackoverflow.com/questions/25385173/what-is-a-debugger-and-how-can-it-help-me-diagnose-problems\">debugger</a> or <i>execute</i> it on paper (try with a small x)?"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1508356816, "post_id": 46818233, "comment_id": 80583872, "body": "Look at the condition of the inner <code>for</code> loop, look <i>up to how much</i> it counts. You could also try adding debug <code>printf</code> statements to show the evolution of the values of <code>x, y and n</code> (but don&#39;t forget to add <code>{...}</code>to enclose statements in appropriate blocks)."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1508356846, "post_id": 46818233, "comment_id": 80583885, "body": "Not really sure what you&#39;re expecting from us, stepping through would be easiest failing that, just dry run it."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1508356867, "post_id": 46818233, "comment_id": 80583898, "body": "What part is giving you trouble. As a brief explanation, the inner loop adds 1 to <code>n</code> for every value of <code>y</code> between 0 and <code>x</code> (including 0 but not <code>x</code>), or in total adds <code>x</code> to <code>n</code>. The outer loop repeats that for every value of <code>x</code> between 0 and 10. Thus, in total, it adds  0 + 1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 = 45 to <code>n</code>. Is part of that unclear, or is there something I didn\u2019t address?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1508357478, "post_id": 46818233, "comment_id": 80584195, "body": "@DanielH: your comment would make a clear and concise answer."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1508357792, "post_id": 46818233, "comment_id": 80584336, "body": "@chqrlie Yes, but dale_dale12\u2019s is better, and I had expected the question would be closed before I finished writing the answer."}, {"owner": {"reputation": 15257, "user_id": 648078, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9698c2f1c188de4ebf3c4496d9f07eb0?s=128&d=identicon&r=PG", "display_name": "Marius Bancila", "link": "https://stackoverflow.com/users/648078/marius-bancila"}, "edited": false, "score": 0, "creation_date": 1508358015, "post_id": 46818233, "comment_id": 80584450, "body": "That is an implementation of sum(n), where n=10. That is n*(n-1)/2. When n=10, sum(n)=45."}], "answers": [{"tags": [], "owner": {"reputation": 1821, "user_id": 3278648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sPO0s.png?s=128&g=1", "display_name": "Dale", "link": "https://stackoverflow.com/users/3278648/dale"}, "is_accepted": false, "score": 6, "last_activity_date": 1508409999, "last_edit_date": 1508409999, "creation_date": 1508357247, "answer_id": 46818383, "question_id": 46818233, "link": "https://stackoverflow.com/questions/46818233/explanation-for-a-nested-for-loop/46818383#46818383", "title": "Explanation for a nested for loop", "body": "<p>Try expanding the first loop out help yourself understand. If you did that you would get code like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;  \nint main() { \n    int x, y, n;\n    n = 0;\n\n    /* x=0 */\n    for (y=0; y&lt;0; y++)\n        n++; /* doesn't get hit n=0 */\n\n    /* x=1 */\n    for (y=0; y&lt;1; y++)\n        n++; /* gets hit once n=1 */\n\n    /* x=2 */\n    for (y=0; y&lt;2; y++)\n        n++; /* gets hit twice n=3 */\n\n    /* x=3 */\n    for (y=0; y&lt;3; y++)\n        n++; /* gets hit three times n=6 */\n\n    /* x=4 */\n    for (y=0; y&lt;4; y++)\n        n++; /* gets hit four times n=10 */\n\n    /* x=5 */\n    for (y=0; y&lt;5; y++)\n        n++; /* gets hit five times n=15 */\n\n    /* x=6 */\n    for (y=0; y&lt;6; y++)\n        n++; /* gets hit six times n=21 */\n\n    /* x=7 */\n    for (y=0; y&lt;7; y++)\n        n++; /* gets hit seven times n=28 */\n\n    /* x=8 */\n    for (y=0; y&lt;8; y++)\n        n++; /* gets hit eight times n=36 */\n\n    /* x=9 */\n    for (y=0; y&lt;9; y++)\n        n++; /* gets hit nine times n=45 */\n\n    /* x=10 exit loop */\n\n    printf (\"%d\\n\", n); /* prints 45 */\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 5421172, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/794045460705503/picture?type=large", "display_name": "Ethan Itovitch", "link": "https://stackoverflow.com/users/5421172/ethan-itovitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508409999, "creation_date": 1508356691, "last_edit_date": 1508357353, "question_id": 46818233, "link": "https://stackoverflow.com/questions/46818233/explanation-for-a-nested-for-loop", "title": "Explanation for a nested for loop", "body": "<p>Hi could someone please explain to me how the following loop prints <code>45</code>. I guess I'm not quite understanding how these nested loops work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int x, y, n;\n    n = 0;\n    for (x = 0; x &lt; 10; x++)\n        for (y = 0; y &lt; x; y++)\n            n++;\n\n    printf(\"%d\\n\", n);\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1508356634, "post_id": 46818194, "comment_id": 80583761, "body": "<a href=\"https://stackoverflow.com/a/34459969/669576\">stackoverflow.com/a/34459969/669576</a>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508356826, "post_id": 46818194, "comment_id": 80583876, "body": "You&#39;re probably entering two characters at a time:  The letter you type, and enter.  After hitting enter, the program sees the letter, processes it, then immediately picks up the newline.  Only then does it wait for you to type more."}, {"owner": {"reputation": 1, "user_id": 8797706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tLwLz.jpg?s=128&g=1", "display_name": "sunny", "link": "https://stackoverflow.com/users/8797706/sunny"}, "edited": false, "score": 0, "creation_date": 1508357172, "post_id": 46818194, "comment_id": 80584044, "body": "Yes after entering first character it waits until i type z as i mentioned my code. But same program working fine for storing integer"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508357209, "post_id": 46818194, "comment_id": 80584061, "body": "That is because <code>%d</code> always discards leading whitespace but <code>%c</code> does not, unless you instruct it to."}, {"owner": {"reputation": 1, "user_id": 8797706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tLwLz.jpg?s=128&g=1", "display_name": "sunny", "link": "https://stackoverflow.com/users/8797706/sunny"}, "edited": false, "score": 0, "creation_date": 1508357294, "post_id": 46818194, "comment_id": 80584108, "body": "But i am not entering any white space, So how can i make it right ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508357308, "post_id": 46818194, "comment_id": 80584118, "body": "The newline is whitespace. Please read the duplicate before asking anything else."}], "owner": {"reputation": 1, "user_id": 8797706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tLwLz.jpg?s=128&g=1", "display_name": "sunny", "link": "https://stackoverflow.com/users/8797706/sunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1508357223, "answer_count": 0, "score": 0, "last_activity_date": 1511786614, "creation_date": 1508356515, "last_edit_date": 1511786614, "question_id": 46818194, "link": "https://stackoverflow.com/questions/46818194/output-printed-twice-instead-of-once", "closed_reason": "Duplicate", "title": "Output printed twice instead of once", "body": "<p>My Code is:- </p>\n\n<p>/* Program to store data in link list and then print all data*/</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\nstruct value\n{\n    char data;\n    struct value *next;\n};\n\nvoid main(void)\n{\n    struct value *head, *temp;\n    char i;\n\n    head = (struct value *) malloc (sizeof(struct value));\n\n    temp = head;\n    while (temp != NULL)\n    {\n        printf(\"Enter value to store in link list Enter z to stop\\n\");\n        scanf(\"%c\", &amp;i);\n\n        temp-&gt;data = i;\n        if (i == 'z')\n        {\n            temp-&gt;next = NULL;\n        }\n        else\n        {\n            temp-&gt;next = (struct value *) malloc (sizeof(struct value));\n        }\n        temp = temp-&gt;next; \n    }\n\n    temp = head;\n    while (temp != NULL)\n    {\n        printf(\"Data is %c\\n\", temp-&gt;data);\n        temp = temp-&gt;next;\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>Output:- </p>\n\n<p>Enter value to store in link list Enter z to stop<br>\na<br>\nEnter value to store in link list Enter z to stop<br>\nEnter value to store in link list Enter z to stop<br>\nb<br>\nEnter value to store in link list Enter z to stop<br>\nEnter value to store in link list Enter z to stop<br>\nc<br>\nEnter value to store in link list Enter z to stop<br>\nEnter value to store in link list Enter z to stop<br>\nz<br></p>\n\n<p>Data is a<br>\nData is<br><br>\nData is b<br>\nData is<br><br>\nData is<br> c\nData is<br><br>\nData is<br> z</p>\n\n<hr>\n\n<p>Process exited after 4.95 seconds with return value 0\nPress any key to continue . . .</p>\n\n<p>Please tell me why its printing one statement twice. Whats wrong with the code\nThanks</p>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1508355598, "post_id": 46817961, "comment_id": 80583231, "body": "Add a counter...."}, {"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1508355608, "post_id": 46817961, "comment_id": 80583237, "body": "You can add counter in loop? And then just printf value of that counter."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1508355663, "post_id": 46817961, "comment_id": 80583264, "body": "How have you even came up with this code without having the concept of a counter ??"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1508355700, "post_id": 46817961, "comment_id": 80583283, "body": "It&#39;s time to start reading your C text book."}, {"owner": {"reputation": 23, "user_id": 8605435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SHfvI.jpg?s=128&g=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/8605435/saeed"}, "edited": false, "score": 0, "creation_date": 1508355884, "post_id": 46817961, "comment_id": 80583390, "body": "well guys, it is my home work and i am limited to what i said"}, {"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1508355943, "post_id": 46817961, "comment_id": 80583423, "body": "Your school textbook should have the answer"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1508355985, "post_id": 46817961, "comment_id": 80583438, "body": "In case there was something unclear in the comments: <code>int counter = 0;  while ((x*y &lt;= 100) &amp;&amp; (x*y!=0)) { ++counter; &#47;* ... *&#47; } printf(&quot;The loop has run %d times\\n&quot;, counter);</code>"}, {"owner": {"reputation": 182, "user_id": 3529457, "user_type": "registered", "profile_image": "https://graph.facebook.com/512037426/picture?type=large", "display_name": "prushik", "link": "https://stackoverflow.com/users/3529457/prushik"}, "edited": false, "score": 0, "creation_date": 1508360908, "post_id": 46817961, "comment_id": 80585875, "body": "I  would like to mention the first part of your expression in the while loop condition (x*y &lt;= 100) is not needed as it will always be true. rand()%10 can only be between 0 and 9 inclusive, and 9*9 is still less than 100."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1508365846, "post_id": 46817961, "comment_id": 80587936, "body": "But it can be 0. So the second part of the &amp;&amp; can be zero."}], "answers": [{"tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": true, "score": 1, "last_activity_date": 1508356271, "creation_date": 1508356271, "answer_id": 46818119, "question_id": 46817961, "link": "https://stackoverflow.com/questions/46817961/how-can-i-count-how-many-times-this-loop-has-been-ran-after-it-finishes/46818119#46818119", "title": "How can I count how many times this loop has been ran after it finishes?", "body": "<p>C is not the kind of language that does things for you. Do it yourself:</p>\n\n<pre><code>int loop_count = 0;\n\nwhile (...) {\n   loop_count += 1;\n   ...\n}\n\nprintf(\"Loop ran %d times.\\n\", loop_count);\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8605435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SHfvI.jpg?s=128&g=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/8605435/saeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "closed_date": 1508365801, "accepted_answer_id": 46818119, "answer_count": 1, "score": -1, "last_activity_date": 1508364219, "creation_date": 1508355531, "last_edit_date": 1508364219, "question_id": 46817961, "link": "https://stackoverflow.com/questions/46817961/how-can-i-count-how-many-times-this-loop-has-been-ran-after-it-finishes", "closed_reason": "Needs details or clarity", "title": "How can I count how many times this loop has been ran after it finishes?", "body": "<p>Can someone tell me how can I calculate the times a loop has been run and the times it is generating a number prints it as an output?</p>\n\n<p>For example, this while has produced some numbers for 5 times and I want it to print out \"the loop been run for 5 times\". </p>\n\n<p>it is my homework and I am limited to while and anything before the while.</p>\n\n<pre><code>int x, y, m, n;\nint answer;\n\nsrand(time(NULL));\n\nx = rand() % (10);\ny = rand() % (10);\n\nanswer = x*y;\n\n\nwhile ((x*y &lt;= 100) &amp;&amp; (x*y!=0)) {\n\n    printf(\"The %d times %d is \", x, y);\n    scanf(\"%d\", &amp;answer);\n\n    m = x;\n    n = y;\n    printf(\"the correct answer is %d\\n\", n*m);\n    x = rand() % (10);\n    y = rand() % (10);\n    m = x;\n    n = y;\n\n    }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "assembly", "x86-64", "inline-assembly"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1508355516, "post_id": 46817800, "comment_id": 80583194, "body": "Is there a good reason for such a seemingly useless exercise?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 6, "creation_date": 1508356012, "post_id": 46817800, "comment_id": 80583451, "body": "There are tools that are really good for this: C compilers.  Many of them have options to emit assembly code, and those that don&#39;t can be paired with disassemblers."}, {"owner": {"reputation": 5, "user_id": 8572231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e67e75f23767665b43727528d4e4a0?s=128&d=identicon&r=PG&f=1", "display_name": "631", "link": "https://stackoverflow.com/users/8572231/631"}, "edited": false, "score": 0, "creation_date": 1508356013, "post_id": 46817800, "comment_id": 80583452, "body": "Glad someone agrees that this is a useless exercise. I need to get it done for a class assignment, but I&#39;ve been stuck the past few days."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508358320, "post_id": 46817800, "comment_id": 80584604, "body": "You didn&#39;t post your C code, but the first integer/pointer arg is passed in <code>rdi</code>, and the second in <code>rsi</code>.  What is &quot;offset&quot;?  A position into the linked list?  Your asm is hard to read; indent your instructions more than the labels.  Also, comments on the same line as the instructions make things more compact."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508358418, "post_id": 46817800, "comment_id": 80584657, "body": "Also, you don&#39;t need to save/restore rbx and r12.  You can use r8, r9, r10 and r11 as scratch regs, along with rax/rcx/rdx/rsi/rdi."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508358504, "post_id": 46817800, "comment_id": 80584706, "body": "Anyway, use a debugger to single-step your code and look at register values to make sure they match what you expect.  See the bottom of <a href=\"https://stackoverflow.com/tags/x86/info\">stackoverflow.com/tags/x86/info</a> for gdb tips."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1508383040, "post_id": 46817800, "comment_id": 80592058, "body": "I believe that John and Eugene&#39;s point was that it&#39;s &quot;useless&quot; to write this in assembler since C is likely to do a much better job. However, I wouldn&#39;t describe it as a &quot;useless exercise&quot; if the goal is to learn how to write assembler. It takes a concept programmers probably already know (linked lists) and performs a common and easily understood operation on it (reversing the list). This allows the newbie assembler student to use looping, comparing, offsets, reading input parameters, returning values, etc. As an intro to assembler exercise, I&#39;ve seen much worse. You&#39;d prefer something harder?"}], "answers": [{"tags": [], "owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "is_accepted": true, "score": 4, "last_activity_date": 1508384668, "creation_date": 1508384668, "answer_id": 46822499, "question_id": 46817800, "link": "https://stackoverflow.com/questions/46817800/converting-c-code-to-x86-64-assembly/46822499#46822499", "title": "Converting C code to x86-64 assembly", "body": "<p>I'm reluctant to just post the re-worked code I created as part of writing this answer.  You aren't going to learn anything that way.</p>\n\n<p>So, here are some things you might want to fix to start:</p>\n\n<p>1) Given that linux has ~7 registers you can use for scratch, there doesn't seem to be a need to push/pop rbx and r12.  Use other registers that don't need to be saved.</p>\n\n<p>2) It looks like you are putting the comments <em>after</em> the code they describe (<code>#headptr</code> et al).  This is <em>not</em> what people who read your code are going to expect.  Most common is either to put it on the line before, or (especially in assembler) on the same line.</p>\n\n<p>3) It is common practice in C to always zero out all the variables (especially pointers) before you use them.  However, less so in asm.  Especially when the next statement is going to assign a different value to that same register.  This isn't a problem in C since the compiler's optimizers will simply discard the redundant initializer.  But assembler doesn't have optimizers, so this is just a waste of space/cycles.  Only zero things that must be zeroed.</p>\n\n<p>4) When zeroing a register, use <code>xor eax, eax</code> instead of <code>mov</code>.  It smaller/faster.</p>\n\n<p>5) If your code is called with <code>head_ptr = reverse_asm_64(head_ptr, 16)</code>, you are going to want to check rdi to see if it is null before dereferencing it.</p>\n\n<p>6) In asm, you should use <code>test rdi, rdi</code> to see if rdi is zero rather than <code>cmp rdi, 0</code>.  It's smaller/faster.</p>\n\n<p>7) \"move offset into a register\" Say what?  The offset is already in a register: rsi.  Why make a copy in r12?</p>\n\n<p>8) The very first time you \"checks that next ptr isn't null\", you have just added the offset to the value.  Unless your offset is zero, this isn't going to do what you intend.  See also #6.</p>\n\n<p>9) The \"add offset to rax to get the next ptr\" is only done once (ie outside the loop).  Wouldn't each pointer in the list need to have this offset added?</p>\n\n<p>There's more, but that's 9 items.  Seems like enough for a start.</p>\n"}], "owner": {"reputation": 5, "user_id": 8572231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e67e75f23767665b43727528d4e4a0?s=128&d=identicon&r=PG&f=1", "display_name": "631", "link": "https://stackoverflow.com/users/8572231/631"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 0, "accepted_answer_id": 46822499, "answer_count": 1, "score": 0, "last_activity_date": 1508384668, "creation_date": 1508354957, "question_id": 46817800, "link": "https://stackoverflow.com/questions/46817800/converting-c-code-to-x86-64-assembly", "title": "Converting C code to x86-64 assembly", "body": "<p>I'm trying to convert my C code to x86-64. My goal is to reverse a linked list. The two parameters that are passed in are the head ptr and the offset to to get the address of the pointer field (i.e. the pointer to the next node in the list). </p>\n\n<p>From what I understand, the head ptr is passed in through the rdi register, and the offset is passed in through the rsi register. I keep getting a segmentation fault when it reaches the line \"mov rcx, [rbx].\" The segmentation fault goes away when it's just \"mov rcx, rbx\" and the line following is changed from \"mov [rbx], rdx\" to \"mov rbx, rdx.\" However, I end up in an infinite loop because it keeps simply assigning the same values over and over again. </p>\n\n<p>When I'm following along with my C code, all of the logic in the x86-64 makes sense to me, so I'm really at a standstill. Any ideas? This is my first time using x86-64.</p>\n\n<pre><code>.intel_syntax noprefix\n.text\n.global reverse_asm_64\n\nreverse_asm_64:\npush rbx\npush r12\n\nmov rax, 0x0\n#headptr\nmov rbx, rax\n#nextptr\nmov rcx, rax\n#new_headptr\nmov rdx, rax\n#head\nmov rax, [rdi]\n\n#checks if head is null\ncmp rax, 0\nje null_ret\n\n#move offset into a register\nmov r12, rsi\nadd rax, r12\n#add offset to rax to get the next ptr\nmov rbx, rax\n\nwhile_start:\n\n#checks that next ptr isn't null\ncmp rbx, 0x0\nje while_done\n\n#setting the next ptr\nmov rcx, [rbx]\n\n# *headptr = new_headptr\nmov [rbx], rdx\n\n#new_headptr = headptr\nmov rdx, rbx\n\n#sets headptr to nextptr\nmov rbx, rcx\n\njmp while_start\n\nwhile_done:\nmov rax, rdx\nsub rax, rsi\n\nnull_ret:\npop r12\npop rbx\nret\n</code></pre>\n"}, {"tags": ["c", "arrays", "c99"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508353627, "post_id": 46817413, "comment_id": 80582235, "body": "<code>strcpy(output[0], buff, BUFFER_SIZE-1);</code> but <code>strcpy</code> only takes <b>two</b> arguments."}, {"owner": {"reputation": 419, "user_id": 7520564, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5dbda10ea63a59366dba00693dc7cab0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Hackman", "link": "https://stackoverflow.com/users/7520564/michael-hackman"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508353688, "post_id": 46817413, "comment_id": 80582258, "body": "meant to make that a strncpy"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1508353707, "post_id": 46817413, "comment_id": 80582266, "body": "Function <code>driverFunc</code> does not change the value of the variable <code>outputs</code> passed to it. In <code>main</code> it remains an <i>unintialised variable</i>."}, {"owner": {"reputation": 419, "user_id": 7520564, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5dbda10ea63a59366dba00693dc7cab0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Hackman", "link": "https://stackoverflow.com/users/7520564/michael-hackman"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508353753, "post_id": 46817413, "comment_id": 80582292, "body": "How can I modify this to change the value within the function?"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1508353799, "post_id": 46817413, "comment_id": 80582316, "body": "Pass by pointer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1508353819, "post_id": 46817413, "comment_id": 80582334, "body": "By using 3 stars? Or rethinking what you are trying to do. You could <i>return</i> the <code>**</code> memory pointer."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508353923, "post_id": 46817413, "comment_id": 80582386, "body": "<i>How can I modify this to change the value within the function?</i> How does <code>malloc</code> manage to allocate memory and make it available to the caller? Do the same thing."}], "answers": [{"tags": [], "owner": {"reputation": 16680, "user_id": 745924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4420b9c31a477c2d7d9e9bf5f15394ce?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Praszmo", "link": "https://stackoverflow.com/users/745924/piotr-praszmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1508353853, "creation_date": 1508353853, "answer_id": 46817541, "question_id": 46817413, "link": "https://stackoverflow.com/questions/46817413/segmentation-fault-upon-reading-from-an-array/46817541#46817541", "title": "Segmentation fault upon reading from an array", "body": "<p>You are passing <code>outputs</code> into <code>driverFunc</code> as a value:</p>\n\n<pre><code>driverFunc(outputs, &amp;sizeOfOutput);\n</code></pre>\n\n<p>its value will be passed to function but not returned. So, when you use it in:</p>\n\n<pre><code>printf(\"Captured output: %s\\n\", outputs[0]);\n</code></pre>\n\n<p><code>outputs</code> is still uninitialized.</p>\n\n<p>You need to pass it as a reference (and change <code>driverFunc</code> accordingly):</p>\n\n<pre><code>driverFunc(&amp;outputs, &amp;sizeOfOutput);\n</code></pre>\n\n<p>or just return it:</p>\n\n<pre><code>outputs = driverFunc(&amp;sizeOfOutput);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1508354422, "creation_date": 1508354422, "answer_id": 46817681, "question_id": 46817413, "link": "https://stackoverflow.com/questions/46817413/segmentation-fault-upon-reading-from-an-array/46817681#46817681", "title": "Segmentation fault upon reading from an array", "body": "<p>If you are going to change the value of the pointer <code>outputs</code> declared in main</p>\n\n<pre><code>char ** outputs;\n</code></pre>\n\n<p>in a function then the function should except the pointer by reference that is indirectly through pointer.</p>\n\n<p>Thus the function should be declared at least like</p>\n\n<pre><code>int driverFunc(char *** output, int * sizeOfOutput);\n</code></pre>\n\n<p>and called like</p>\n\n<pre><code>driverFunc( &amp;outputs, &amp;sizeOfOutput);\n</code></pre>\n\n<p>Using the function <code>strncpy</code></p>\n\n<pre><code>strncpy(output[0], buff, BUFFER_SIZE-1);\n</code></pre>\n\n<p>does not make great sense. It is simpler to use <code>strcpy</code></p>\n\n<pre><code>strcpy( output[0], buff );\n</code></pre>\n\n<p>In case if the reallocation fails</p>\n\n<pre><code> output = realloc(output, (rows+1) * sizeof(char *));\n</code></pre>\n\n<p>the previous value of the pointer <code>output</code>  will be lost. So you need to use an intermediate variable to reallocate the memory and check whether its value after the call is equal to NULL or not.</p>\n\n<p>The variable <code>sizeOfOutput</code> should be set to</p>\n\n<pre><code>*sizeOfOutput = rows + 1;\n</code></pre>\n\n<p>In main you should free all allocated memory in the function.</p>\n"}], "owner": {"reputation": 419, "user_id": 7520564, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5dbda10ea63a59366dba00693dc7cab0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Hackman", "link": "https://stackoverflow.com/users/7520564/michael-hackman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 46817681, "answer_count": 2, "score": 1, "last_activity_date": 1508354422, "creation_date": 1508353404, "last_edit_date": 1508353710, "question_id": 46817413, "link": "https://stackoverflow.com/questions/46817413/segmentation-fault-upon-reading-from-an-array", "title": "Segmentation fault upon reading from an array", "body": "<p>I wrote a small program to illustrate a problem I'm running into.  This program should copy the contents of \"buff[200]\" into the first position of the array \"output\".  After performing the copy, I read the value out several times to see when it vanishes as I get a segmentation fault as soon as I try to access the data outside of the scope of driverFunc.  I'm aware that I'm creating an array with 6 positions in it but only adding data to the first position, this will eventually be inside a loop that populates the rest of the output array.  I also have the requirement for my use case that I need to be able to expand the size of this array.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define BUFFER_SIZE 1035\nint driverFunc(char ** output, int * sizeOfOutput) {\n  int rows = 5;\n  char buff[200] = \"hello world\";\n\n  output = malloc(rows * sizeof(char *));  //malloc row space\n  //malloc column space\n  for (int i = 0; i &lt; rows; i ++) {\n    output[i] = malloc(BUFFER_SIZE * sizeof(char));\n  }\n\n  //copy contents of buff into first position of output\n  strncpy(output[0], buff, BUFFER_SIZE-1);\n  printf(\"Output 1: %s\\n\", output[0]); //verify that it's there\n\n  //resize the array\n  output = realloc(output, (rows+1) * sizeof(char *));\n  //allocate space for the new entry\n  output[rows] = malloc(BUFFER_SIZE * sizeof(char));\n  *sizeOfOutput = rows;\n\n  //verify that it's still there\n  printf(\"Output 2: %s\\n\", output[0]);\n  return 0;\n}\nint main() {\n  char ** outputs;\n  int sizeOfOutput;\n  driverFunc(outputs, &amp;sizeOfOutput);\n  //verify that we can do useful things with our output\n  printf(\"Reported size: %d\\n\", sizeOfOutput);\n  printf(\"Captured output: %s\\n\", outputs[0]);  //segfault\n}\n</code></pre>\n\n<p>expected output:</p>\n\n<pre><code>Output 1: hello world\nOutput 2: hello world\nReported size: 5\nCaptured output: hello world\n</code></pre>\n\n<p>received output:</p>\n\n<pre><code>Output 1: hello world\nOutput 2: hello world\nReported size: 5\nSegmentation fault (core dumped)\n</code></pre>\n"}, {"tags": ["c", "algorithm", "data-structures", "depth-first-search", "maze"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1508354007, "post_id": 46817353, "comment_id": 80582443, "body": "What if there is a solution that contains a loop?  In that case there are infinitely many solutions, so no way to find or list all of them explicitly."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1508354035, "post_id": 46817353, "comment_id": 80582459, "body": "Please provide needed information as text directly here. Not as a scan of a handwritten scribble on paper. For formatting it, please refer to <a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1508355126, "post_id": 46817353, "comment_id": 80583017, "body": "For each point, keep a reference to its predecessor point.  To prevent cycles during the DFS, check the next point you are adding to the path is not already in the path -- (if your maze is small, you could use a bitfield)."}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1508410407, "post_id": 46817353, "comment_id": 80603679, "body": "I have posted a working solution to the question this was marked a dupe of."}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "reply_to_user": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1508411238, "post_id": 46817353, "comment_id": 80604165, "body": "@Stefan Haustein. Is there any possibility that the &quot;duplicate&quot; mark gets removed? I don&#39;t understand why people are so quick to mark questions as duplicate"}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "reply_to_user": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1508411323, "post_id": 46817353, "comment_id": 80604215, "body": "@StefanHaustein . I would prefer a purely &quot;stack-only&quot; solution. I do not want to use recursion (I want to try out with stacks)!"}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 1, "creation_date": 1508411749, "post_id": 46817353, "comment_id": 80604475, "body": "I think the standard procedure would be to post the question again with a link to the duplicate and clearly stating that you want an explicit stack. However, the duplicate mark doesn&#39;t seem to stop you from getting help, so I am not sure why it should be a big concern. I&#39;d recommend to update your code here using the suggestions you got so far, so it&#39;s simpler to  spot what&#39;s still missing"}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508412145, "post_id": 46817353, "comment_id": 80604688, "body": "Ya, sure I would do that in sometime!"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1508418375, "post_id": 46817353, "comment_id": 80608464, "body": "@Arshad-- FYI, there are currently 3 votes to reopen; you just need two more...."}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "reply_to_user": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1508420222, "post_id": 46817353, "comment_id": 80609816, "body": "@StefanHaustein - I have edited my code. Please guide me further."}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1508424544, "post_id": 46817353, "comment_id": 80612960, "body": "You still don&#39;t clear visited on pop() and you haven&#39;t added a previous pointer to be able to distinguish alternatives pushed earlier from the current path. When you have found a solution, you need to go back to the closest alternative, skipping nodes on the current path"}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 1, "creation_date": 1508425557, "post_id": 46817353, "comment_id": 80613641, "body": "p.s. I see that you are using two stacks instead of a &quot;previous_path_element&quot; pointer in the existing stack elements. I think that might turn out tricky to sync. An alternative to pushing alternatives on the stack might be to keep track of the direction you have taken (0..3) for each stack element, and when you backtrack, increment this number until you are out of options before you pop. This can avoid pushing alternatives, and you&#39;d need a path stack only."}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "reply_to_user": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1508483093, "post_id": 46817353, "comment_id": 80635338, "body": "@StefanHaustein - I have solved the question, but without explicitly using any prev pointer! Please suggest further improvements if any!"}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "reply_to_user": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1508483234, "post_id": 46817353, "comment_id": 80635406, "body": "@StefanHaustein -  I have solved this only with this very statement of yours - &quot;An alternative to pushing alternatives on the stack might be to keep track of the direction you have taken (0..3) for each stack element&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508374375, "post_id": 46817861, "comment_id": 80590084, "body": "If I clear the corresponding field in visited when I pop from the stack, then my code will run into an infinite loop. Take for instance &#39;a&#39; is a parent of &#39;b&#39;&amp;&#39;c&#39; and c has no further children. So, when &#39;c&#39; gets pushed after &#39;a&#39; and the program sees that c has no further way to go, it would pop out &#39;c&#39; and the front pointer would return to &#39;a&#39;. Now, if I clear the corresponding visited field of &#39;c&#39;, then &#39;a&#39; would again go back to c and so on. It would result in an infinite loop."}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "reply_to_user": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508403630, "post_id": 46817861, "comment_id": 80599947, "body": "This argument does not match your code: b and c are pushed from a before anything else is done and the exploration from b or c should never be able to reach a again because it&#39;s marked visited. However, there seems to be a different issue. b and c should be blocked when actually being visited, not when pushed"}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508406507, "post_id": 46817861, "comment_id": 80601631, "body": "The argument I posed was to your suggestion, not to my code. Nonetheless, I&#39;m getting a better hang of things right now. I&#39;m working upon @MFisherKDX answer and comments. It would be great if you could contribute over there? I have some doubts there.."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1508422642, "post_id": 46817861, "comment_id": 80611590, "body": "Using a global visited array is the way to do it when you just want one solution. You want all possible solutions -- so this won&#39;t work. You need to prevent cycles another manner -- as I suggested above -- by popping p from the stack and checking if each possible next point q is already in the partial path from start to p."}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1508424145, "post_id": 46817861, "comment_id": 80612647, "body": "@MFisherKDX There is absolutely no problem with a global visited array, just take a look at the working solution attached to the dupe"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1508425743, "post_id": 46817861, "comment_id": 80613755, "body": "@StefanHaustein nice trick!! :)"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1508426566, "post_id": 46817861, "comment_id": 80614360, "body": "Upvoting your answer due to how you explain the resetting the visited array"}], "tags": [], "owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "is_accepted": false, "score": 1, "last_activity_date": 1508427749, "last_edit_date": 1508427749, "creation_date": 1508355169, "answer_id": 46817861, "question_id": 46817353, "link": "https://stackoverflow.com/questions/46817353/find-all-paths-in-a-maze-using-dfs/46817861#46817861", "title": "Find all paths in a maze using DFS", "body": "<p>I think you need to clear the corresponding field in visited where you remove the point from the stack. </p>\n\n<p><strong>Edit</strong>: Another issue is that you need to backtrack when you have reached the goal. And on your stack, it's probably not obvious what unexplored alternatives are and what the current path is (you might be able to use the visited array to track this, but it seems more convoluted than \"just\" using recursion or adding the corresponding information to your Stack stuct)</p>\n\n<p>Also, subsequent nodes should be marked visited when they are actually investigated, not when they are pushed on the stack. </p>\n\n<p>Some remarks</p>\n\n<ul>\n<li><p>I think the code would be more readable using recursion instead of an explicit stack</p></li>\n<li><p>You don't really need visited, you could just change maze fields on the path to 1 temporarily (probably wouldn't do this in \"real\" code where the maze should be immutable though). Otherwise, I'd just structure it the same way as the maze.</p></li>\n<li><p>I'd change push to take a point for symmetry.</p></li>\n<li><p>Avoid redundancies bloating the code. For instance, the <code>front == NULL</code> branch in <code>push</code> is redundant with the default case -- the default case will do exactly the same thing in the NULL case.</p></li>\n</ul>\n\n<p><strong>Edit 2</strong>:</p>\n\n<p>If you really want to avoid recursion, I'd change the data structure to this:</p>\n\n<pre><code>typedef struct PathElement {\n  int x;\n  int y;\n  int direction_to_next;\n  struct PathElement* next;\n  struct PathElement* prev;\n} path;\n</code></pre>\n\n<p>This will allow you to easily go in any direction (for instance, you'll be at the end of a path when you want to print). When you backtrack to a PathElement, increment direction_to_next and continue there until you have exhausted all 4 possible directions. Don't \"push\" alternatives ahead of time.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508377533, "post_id": 46818092, "comment_id": 80590799, "body": "I&#39;m not able to understand you clearly. Reasons being:(i) I think each node in my stack already has a &quot;next&quot; pointer which points to its predecessor. (ii) If I don&#39;t break out of a loop prematurely upon the first available move, then how will a decide which &quot;move&quot; to select? In DFS we just select a random move and move on? Moreover, if I backtrack and select the move which hasn&#39;t already been exhausted for that node, then I would only get a partial solution right? That&#39;s because, I wouldn&#39;t get the paths where some nodes are repeating and others aren&#39;t."}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508378270, "post_id": 46818092, "comment_id": 80590970, "body": "It would be great if you could explain me more explicitly and be more ordered and clear."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "reply_to_user": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 1, "creation_date": 1508388576, "post_id": 46818092, "comment_id": 80593291, "body": "Your function is not a proper DFS, which is why you are running into trouble. At a given point in the search, a proper DFS pushes <i>every</i> valid next move onto the stack. Therefore you can&#39;t use the stack&#39;s next pointer to traverse a potential path. The stack&#39;s next pointer is simply to grow the stack. You need to explicitly save a predecessor pointer to backtrack the paths. While stack not empty&lt;br&gt;  pop stack&lt;br&gt;  check if finished&lt;br&gt;  for every next legal move, create new state and push on stack."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "reply_to_user": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508389941, "post_id": 46818092, "comment_id": 80593677, "body": "Since you want all paths without cycles the &quot;for every next legal move part&quot; needs to check the next candidate point is not in the current path -- either by traversing the predecessor pointers -- or by doing something faster like keeping a bitfield stored in your node struct that denotes the visited points on the partial path. Be warned this function may consume a lot of memory and running time."}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508402304, "post_id": 46818092, "comment_id": 80599086, "body": "Nice! That was quite well explained! I&#39;m getting a better feel of it now. What I have decided now is to add another stack for the &quot;path&quot; - which would consist of the nodes in the path. I would call it a &quot;path-stack&quot; from now on."}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508402974, "post_id": 46818092, "comment_id": 80599536, "body": "I have a doubt right here. I&#39;ll take two eg: (i) lets assume the first path is i-j-k-l(previous nodes have only 1 path, so I&#39;m neglecting that). My path-stack would now contain all the nodes till &#39;l&#39;. As soon as I encounter &#39;l&#39;, I&#39;ll pop out &#39;l&#39; from my path-stack. The front-pointer would then return to &#39;k&#39;. Now, a check for the next valid move from &#39;k&#39; would give me &#39;o&#39; and &#39;l&#39;. But, &#39;l&#39; would again get selected first and the program would run into an infinite loop? How would I prevent &#39;l&#39; from getting selected again?"}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508403005, "post_id": 46818092, "comment_id": 80599559, "body": "(ii) If however, you tell that I need to look into my &quot;original&quot; stack then I would add o-p-q to my path-stack, the original stack would then contain p-q and this would go on until p-q are emptied and the program would stop! No other way would be added?."}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508415304, "post_id": 46818092, "comment_id": 80606568, "body": "The part (ii) is what is happening in my above edited program!"}, {"owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "edited": false, "score": 0, "creation_date": 1508417379, "post_id": 46818092, "comment_id": 80607813, "body": "Moreover, in my current program, the visited array would do the same job as checking whether a node has been included in the path. Therefore, I haven&#39;t done that part for now."}], "tags": [], "owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "is_accepted": false, "score": 0, "last_activity_date": 1508356132, "creation_date": 1508356132, "answer_id": 46818092, "question_id": 46817353, "link": "https://stackoverflow.com/questions/46817353/find-all-paths-in-a-maze-using-dfs/46818092#46818092", "title": "Find all paths in a maze using DFS", "body": "<ul>\n<li><p>For each point in your search, keep a reference to the predecessor point.  Always pop the item off your stack after operating on it.  <strong>Note that if there is no solution, your code will infinite loop</strong>. And when you get to the end, you can use the predecessors to backtrack and find the full path.</p></li>\n<li><p>Get rid of your visited array, and to prevent cycles during the DFS, check to make sure the point you are adding to the path is not currently in the path.  Since you only have 30 possible points in your maze, you could use a bitfield to denote whether the a given point is in the path.  </p></li>\n<li><p>Also, don't break out of the loop prematurely (upon finding the first available move).</p></li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 8296644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206188019471417/picture?type=large", "display_name": "Arshad", "link": "https://stackoverflow.com/users/8296644/arshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1388, "favorite_count": 0, "closed_date": 1508357363, "answer_count": 2, "score": 2, "last_activity_date": 1508482994, "creation_date": 1508353215, "last_edit_date": 1508482994, "question_id": 46817353, "link": "https://stackoverflow.com/questions/46817353/find-all-paths-in-a-maze-using-dfs", "closed_reason": "Duplicate", "title": "Find all paths in a maze using DFS", "body": "<p>Given a source and a destination cell in a maze, I would like to find <strong>all</strong> possible solutions to a maze using DFS. 0 represents a wall in my maze.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ilXVe.jpg\" rel=\"nofollow noreferrer\">Visualise the maze</a></p>\n\n<p>I've successfully written a program, but that gives me only <strong>one</strong> path. I've thought of all the possibilities to extend it to <strong>all</strong> paths but sadly even after being hours(2 days to be precise) at it, I was unable to come up with a solution.</p>\n\n<p>I thought of keeping a \"visited\" array for <strong>each</strong> node so that when I backtrack I don't perform the same move for the previous node. However doing that would only produce a path that is completely distinct(if there is any) with no nodes being the same.</p>\n\n<p>I also thought of some other way but even that posed some problem.</p>\n\n<p>I've also checked out similar questions but none of them are <strong>specific</strong> to my context. There is a solution using explicit recursion. However, what I want is to use a stack and find all possible paths. Sadly, I couldn't find anything credible(at least in a way that I could understand).</p>\n\n<p>Here's my code for <strong>one</strong> path.</p>\n\n<p><strong>Edit</strong>: I've now implemented the \"proper\" DFS. I've also added a stack to keep track of the current path. The program then also checks for the unexplored nodes. However, its checking in some other order and therefore I still can get only one path!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct Point\n{\n    int x,y;\n}Point;\n\ntypedef struct stack\n{\n    struct Point pt;\n    struct stack* next;\n    void push(int, int);\n    Point pop();\n}stack, stack_path;\n\nstack*front =NULL;\nstack_path*front_path =NULL;\n\n\nvoid push(int x, int y)\n{\n    if(front==NULL)\n    {\n        front = (stack*)malloc(sizeof(stack));\n        front -&gt; pt.x = x; front -&gt; pt.y = y;\n        front -&gt; next = NULL;\n        return;\n    }\n    stack* temp = (stack*)malloc(sizeof(stack));\n    temp -&gt; pt.x = x; temp -&gt; pt.y = y;\n    temp -&gt; next = front;\n    front = temp;\n}\n\nPoint pop()\n{\n    if(front != NULL)\n    {\n        stack* temp = front;\n        Point pt = front -&gt; pt;\n        front = front -&gt; next;\n        free(temp);\n        return pt;  \n    }\n}\n\nvoid push_path(int x, int y)\n{\n    if(front_path==NULL)\n    {\n        front_path = (stack*)malloc(sizeof(stack_path));\n        front_path -&gt; pt.x = x; front_path -&gt; pt.y = y;\n        front_path -&gt; next = NULL;\n        return;\n    }\n    stack_path* temp = (stack*)malloc(sizeof(stack_path));\n    temp -&gt; pt.x = x; temp -&gt; pt.y = y;\n    temp -&gt; next = front_path;\n    front_path = temp;\n}\n\nPoint pop_path()\n{\n    if(front_path != NULL)\n    {\n        stack_path* temp = front_path;\n        Point pt = front_path -&gt; pt;\n        front_path = front_path -&gt; next;\n        free(temp);\n        return pt;  \n    }\n}\n\nbool inMaze(Point pt)\n{\n    return (pt.x&gt;=0 &amp;&amp; pt.y&gt;=0 &amp;&amp; pt.x&lt;5 &amp;&amp; pt.y&lt;6);\n}\n\n\nint main()\n{\n\n    struct Point pt1;\n\n    int visited[30]={0};\n    push(0,0);\n    push_path(0,0);\n\n    struct Point dest = {3,4};\n    int maze[5][6] = {{1,0,1,1,1,1},\n                      {1,0,1,0,1,1},\n                      {1,1,1,0,1,1},\n                      {0,0,0,0,1,0},\n                      {1,1,1,0,1,1}};\n    int paths[30]={0};\n    int dx[4]={-1, 0, 0, 1};\n    int dy[4]={0,-1, 1, 0};\n    while(front!=NULL)\n    {\n        Point pt = pop();\n\n        if(pt.x==dest.x &amp;&amp; pt.y==dest.y)\n        {\n            push_path(pt.x,pt.y);\n            int i;\n\n            visited[6*pt.x+pt.y] = 0;\n            stack_path *temp = front_path;\n            while(temp!=NULL)\n            {\n                printf(\"%d%d \",temp-&gt;pt.x, temp-&gt;pt.y);\n                temp = temp-&gt;next;\n            }\n            printf(\"\\n\");\n            pop_path();\n\n        }\n        else\n        {\n            if(!visited[6*pt.x+pt.y])\n            {\n                visited[6*pt.x+pt.y] = 1;\n                push_path(pt.x,pt.y);\n            }\n            int i;\n            int flag =0;\n            for(i=0; i&lt;4; i++)\n            {\n                pt1.x = dx[i] + pt.x;\n                pt1.y = dy[i] + pt.y;\n                if(inMaze(pt1) &amp;&amp; maze[pt1.x][pt1.y]==1 &amp;&amp; visited[6*pt1.x+ pt1.y]==0) \n                {\n                    push(pt1.x,pt1.y);\n                    flag = 1;\n                }\n            }\n            if(flag==0)\n                pop_path();\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Can someone please guide me to <strong>modify</strong> this code such that it finds <strong>all paths</strong>. Expecting the community's help!</p>\n\n<p>PS: SO currently doesn't allow me to embed images and therefore it has automatically created a link.</p>\n\n<p>PS: This question has been marked as duplicate relating to some other question. For your information, I had gone through that very question before posting my question! If anyone would have read the answer there, you could see it wasn't <em>\"accepted\"</em>! It just says you need to do <em>\"all\"</em> permutations! If only one would have bothered to go through the other answer(in the other question), they would have realised that it <strong>only applied</strong> to moving in north, northeast, or east directions! Moreover, I also had made it pretty clear that I <strong>don't</strong> want a <em>recursive</em> solution - that's what the other question was using!</p>\n\n<p><strong>Edit 2:</strong> Working solution</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct Point\n{\n    int x,y;\n}Point;\n\ntypedef struct stack\n{\n    struct Point pt;\n    struct stack* next;\n    int dir_count;\n}stack;\n\nstack*front =NULL;\n\n\n\nvoid push(int x, int y)\n{\n\n    stack* temp = (stack*)malloc(sizeof(stack));\n    temp -&gt; pt.x = x; temp -&gt; pt.y = y;\n    temp -&gt; next = front;\n    front = temp;\n}\n\nPoint pop()\n{\n    if(front != NULL)\n    {\n        stack* temp = front;\n        Point pt = front -&gt; pt;\n        front = front -&gt; next;\n        free(temp);\n        return pt;  \n    }\n}\n\nbool inMaze(Point pt)\n{\n    return (pt.x&gt;=0 &amp;&amp; pt.y&gt;=0 &amp;&amp; pt.x&lt;5 &amp;&amp; pt.y&lt;6);\n}\n\n\nint main()\n{\n\n    struct Point pt1,pt2;\n    struct Point pt = {0,0};\n\n    push(0,0);\n    front-&gt;dir_count = 0;\n\n    struct Point dest = {3,4};\n    int maze[5][6] = {{1,0,1,1,1,1},{1,0,1,0,1,1},{1,1,1,0,1,1},{0,0,0,0,1,0},{1,1,1,0,1,1}};\n\n    int dx[4]={-1, 0, 0, 1};\n    int dy[4]={0,-1, 1, 0};\n\n    int flag_pop = 0;\n    while(front != NULL)\n    {\n        if(front-&gt;pt.x==dest.x &amp;&amp; front-&gt;pt.y==dest.y)\n        {\n\n            stack* temp = front;\n            while(temp != NULL)\n            {\n                printf(\"%d%d \", temp-&gt;pt.x, temp-&gt;pt.y);\n                temp = temp-&gt;next;\n            }\n            printf(\"\\n\");\n            pt = pop();\n\n        }\n        else\n        {\n            int i,k;\n            int flag_push =0, count = 0, moves=0;\n            for(k=0;k&lt;4;k++)\n            {\n                pt2.x = dx[k] + front-&gt;pt.x;\n                pt2.y = dy[k] + front-&gt;pt.y;\n                if(maze[pt2.x][pt2.y]==0 || !inMaze(pt2) || !(pt.x != pt2.x || pt.y != pt2.y))\n                    count++;\n            }\n            // count of possible moves for each node\n            moves = 4-count;\n            for(i=0; i&lt;4; i++)\n            {\n                int flag=0;\n                pt1.x = dx[i] + front-&gt;pt.x;\n                pt1.y = dy[i] + front-&gt;pt.y;\n\n                // if moves are exhausted\n                if(!(front-&gt;dir_count&lt;moves))\n                    break;\n\n                if(inMaze(pt1) &amp;&amp; maze[pt1.x][pt1.y]==1 &amp;&amp; (pt.x != pt1.x || pt.y != pt1.y) )\n                {\n                    stack* temp = front;\n                    while(temp != NULL)\n                    {\n                        if(temp-&gt;pt.x == pt1.x &amp;&amp; temp-&gt;pt.y == pt1.y)\n                        {\n                            flag = 1;\n                            break;\n                        }\n                        temp = temp-&gt;next;\n                    }\n\n                    // if node is not there in the path\n                    if(flag==0)\n                    {\n                        front-&gt;dir_count++;\n                        push(pt1.x, pt1.y);\n                        front -&gt; dir_count = 0;\n                        flag_push = 1;\n                        break;\n                    }   \n                }\n            }\n            // if no move was done\n            if(flag_push==0)\n            {\n                pt = pop();\n\n            }\n        }   \n\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "time", "overflow", "unsigned", "multiplication"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1508351593, "post_id": 46816932, "comment_id": 80581115, "body": "By using <code>unsigned long long</code>? You are dividing by the max unsigned value so all results (except one) that are within range of <code>unsigned int</code> will be <code>0</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508352135, "post_id": 46816932, "comment_id": 80581405, "body": "There is no way to use order of operations alone to obtain the same result you would get if the computations were performed with arbitrary-size intermediates.  Possibly there are tricks you could play that are specific to the input values (simplest: <code>c = 7;</code>), but other than those, the best you can do is to explicitly promote to a wider type, such as <code>uintmax_t</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508352584, "post_id": 46816932, "comment_id": 80581646, "body": "I don&#39;t see why you expect the answer to be 7.  The full precision answer will have the five low-order bits all zero, and the 32 bits above that all one.  How do you get 7 out of that?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508357730, "post_id": 46816932, "comment_id": 80584318, "body": "&quot;... perform arithmetic operations on unsigned integers. ... <code>a</code> has a range from 0 to 4294967295&quot;.  Hmm, certainly for division it is &quot;`1 to 4294967295&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508357788, "post_id": 46816932, "comment_id": 80584333, "body": "<code>#define MAX_NS 1000000000</code> --&gt; <code>#define MAX_NS 1000000000ull</code>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "edited": false, "score": 0, "creation_date": 1508352708, "post_id": 46817012, "comment_id": 80581715, "body": "but even when I use a smaller &#39;a&#39; value(suppose 50000000) , I am not getting the correct answer.Should be 640 but i am getting 38.What could be the reason?"}, {"owner": {"reputation": 167, "user_id": 1320095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHs1.jpg?s=128&g=1", "display_name": "vlada", "link": "https://stackoverflow.com/users/1320095/vlada"}, "reply_to_user": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "edited": false, "score": 0, "creation_date": 1508352793, "post_id": 46817012, "comment_id": 80581760, "body": "Something else must be problem. I have checked this code and it prints 7."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "edited": false, "score": 1, "creation_date": 1508353409, "post_id": 46817012, "comment_id": 80582124, "body": "@GopalaKrishna in your example <code>b * MAX_NS</code> is <code>32000000000</code> which is too large to store in 32-bit <code>unsigned int</code>, no matter <i>what</i> you then divide by."}, {"owner": {"reputation": 167, "user_id": 1320095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHs1.jpg?s=128&g=1", "display_name": "vlada", "link": "https://stackoverflow.com/users/1320095/vlada"}, "edited": false, "score": 0, "creation_date": 1508354051, "post_id": 46817012, "comment_id": 80582467, "body": "Do you want to show you print screen? As I told you, something else is problem, not code."}, {"owner": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "edited": false, "score": 0, "creation_date": 1508355733, "post_id": 46817012, "comment_id": 80583301, "body": "I changed the main program: unsigned int a =  50000000;  \tunsigned int b =  32 ;  \t  \tunsigned int c = ((b * MAX_NS)/a);  \tprintf(&quot;%d&quot;,c);.I am getting 38 as the answer"}, {"owner": {"reputation": 167, "user_id": 1320095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHs1.jpg?s=128&g=1", "display_name": "vlada", "link": "https://stackoverflow.com/users/1320095/vlada"}, "edited": false, "score": 0, "creation_date": 1508357185, "post_id": 46817012, "comment_id": 80584049, "body": "Initial problem was that integer value is greater than max allowed for unsigned int types. If you divide initial number by 2, then problem is not initial anymore. You can use unsigned int if you decrease numbers. Otherwise, you must use long long"}], "tags": [], "owner": {"reputation": 167, "user_id": 1320095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHs1.jpg?s=128&g=1", "display_name": "vlada", "link": "https://stackoverflow.com/users/1320095/vlada"}, "is_accepted": false, "score": 2, "last_activity_date": 1508351880, "last_edit_date": 1508351880, "creation_date": 1508351795, "answer_id": 46817012, "question_id": 46816932, "link": "https://stackoverflow.com/questions/46816932/multiplication-and-division-unsigned-integers/46817012#46817012", "title": "Multiplication and Division unsigned integers", "body": "<p>Here is solution as  Weather Vane suggested</p>\n\n<pre><code>#include \"stdio.h\"\n\n#define MAX_NS 1000000000\n\nint main()\n{\n    unsigned long long a = 4294967295;\n    unsigned long long b = 32;\n\n    unsigned long long c = ((b * MAX_NS) / a);\n    printf(\"%llu\", c);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "edited": false, "score": 0, "creation_date": 1508408830, "post_id": 46820375, "comment_id": 80602853, "body": "thanks for the answer but our hardware supports only 32 bit,can&#39;t use unsigned long long.."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "edited": false, "score": 0, "creation_date": 1508417483, "post_id": 46820375, "comment_id": 80607881, "body": "@GopalaKrishna Even an 8-bit processor can support <code>unsigned long long</code>.  A compliant C compiler will form the necessary instructions to realize 64-bit types and math.  Unusual requirements like &quot;only use up to 32-bit math&quot; should be in the <i>original</i> post."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1508366754, "creation_date": 1508366754, "answer_id": 46820375, "question_id": 46816932, "link": "https://stackoverflow.com/questions/46816932/multiplication-and-division-unsigned-integers/46820375#46820375", "title": "Multiplication and Division unsigned integers", "body": "<p>The key is that the product <code>b * MAX_NS</code> must be computed using wide enough math.</p>\n\n<p>Make certain at least one of the <code>*</code> operands is <code>unsigned long long</code>.</p>\n\n<p>With large enough <code>b</code> and small enough <code>a</code>, the quotient will need a wider type to avoid overflow;</p>\n\n<pre><code>#include \"stdio.h\"\n// #define MAX_NS 1000000000\n#define MAX_NS 1000000000LLU\n\nint main(void) {\n  unsigned int a =  4294967295;  // type may remain unsigned \n  unsigned int b =  32 ;         // type may remain unsigned \n\n  unsigned long long c = ((b * MAX_NS)/a);\n  printf(\"%llu\",c);\n}\n</code></pre>\n\n<p>Alternatively, coax the multiplication gently by multiplying by <code>1ull</code>.  In general avoid casting as in <code>(unsigned long long) b * MAX_NS</code>.  Rampant practice of casting surprisingly sometimes <em>narrows</em> the math which could happen here at a later date with <code>uintmax_t b</code>.</p>\n\n<pre><code>#define MAX_NS 1000000000\n\nint main(void) {\n  unsigned int a =  4294967295;  // type may remain unsigned \n  unsigned int b =  32 ;         // type may remain unsigned \n\n  unsigned long long c = ((1ull * b * MAX_NS)/a);\n  printf(\"%llu\",c);\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8501936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fc504d51be2ed0a0e7791ca49e2b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gopala Krishna", "link": "https://stackoverflow.com/users/8501936/gopala-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1508424392, "creation_date": 1508351475, "last_edit_date": 1508424392, "question_id": 46816932, "link": "https://stackoverflow.com/questions/46816932/multiplication-and-division-unsigned-integers", "title": "Multiplication and Division unsigned integers", "body": "<p>In my program , I have to perform arithmetic operations on unsigned integers.</p>\n\n<ul>\n<li>The variable a has a range from 0 to 4294967295.</li>\n<li>The variable b has a range from 0 to 32.</li>\n</ul>\n\n<p>When I check the boundary condition by taking the maximun values for a and b,I am getting 0 as the answer since overflow occurs when I try to multiply <strong>a</strong> and <strong>MAX_NS</strong>.Ideally I should get 7 as the answer.How could I write the program such that overflow is taken care of and I get 7 as the answer and hopefully it works for other valid value range for a and b.Thanks.</p>\n\n<pre><code>#include \"stdio.h\"\n\n#define MAX_NS 1000000000\n\n int main()\n {\n    unsigned int a =  4294967295;\n    unsigned int b =  32 ;\n\n    unsigned int c = ((b * MAX_NS)/a);\n    printf(\"%d\",c);\n\n\n }\n</code></pre>\n\n<p>**Edit:**Please note that I can't use unsigned long long.I can use only unsigned int for the variables.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1508351126, "post_id": 46816810, "comment_id": 80580892, "body": "Your coding style and indentation (or your knowledge of StackOverflow formatting) needs work. Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1508351189, "post_id": 46816810, "comment_id": 80580925, "body": "What values do you consider correct and what does your program return?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508351200, "post_id": 46816810, "comment_id": 80580931, "body": "<code>printf(&quot;\\n%d&quot;,&amp;x);</code>  --&gt;  <code>printf(&quot;\\n%d&quot;,x);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1508351263, "post_id": 46816864, "comment_id": 80580965, "body": "I think the OP expects the address to be constant since <code>x</code> is a static variable."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1508351347, "post_id": 46816864, "comment_id": 80581000, "body": "@ForceBru that wouldn&#39;t matter, printf isn&#39;t going to accept the address of x when looking for a lvalue for %d."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 4, "last_activity_date": 1508351266, "last_edit_date": 1508351266, "creation_date": 1508351219, "answer_id": 46816864, "question_id": 46816810, "link": "https://stackoverflow.com/questions/46816810/prototypes-are-correct-but-garbage-values-are-displayed-in-the-output/46816864#46816864", "title": "prototypes are correct but garbage values are displayed in the output", "body": "<p>You are using an adress of a variable where printf wants just the value:</p>\n\n<pre><code>printf(\"\\n%d\",&amp;x);\n</code></pre>\n\n<p>-></p>\n\n<pre><code>printf(\"\\n%d\",x);\n</code></pre>\n\n<p>Your result might also be improved by using <code>\"%d\\n\"</code> instead.</p>\n"}], "owner": {"reputation": 3, "user_id": 8741668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d72106ffa3f132efb1785f542e216b?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick Tiacoon", "link": "https://stackoverflow.com/users/8741668/maverick-tiacoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "closed_date": 1508361644, "answer_count": 1, "score": 0, "last_activity_date": 1508351531, "creation_date": 1508351001, "last_edit_date": 1508351531, "question_id": 46816810, "link": "https://stackoverflow.com/questions/46816810/prototypes-are-correct-but-garbage-values-are-displayed-in-the-output", "closed_reason": "Not suitable for this site", "title": "prototypes are correct but garbage values are displayed in the output", "body": "<p>The prototype (<code>void example();</code>) I have mentioned for the program is correct, but the compiler is giving garbage value instead of correct values in the output.<br>\nWhat codes should be added or removed?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid example()\n{\n  static int x = 10;\n  x=x+10;\n  printf(\"\\n%d\",&amp;x);\n}\n\nint main()\n{\n  int i;\n  for(i=0;i&lt;=3;i++)\n  {\n    example();\n  }\n  getch();\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["objective-c", "c", "conditional-statements", "variable-assignment", "terminology"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 7, "creation_date": 1508350384, "post_id": 46816589, "comment_id": 80580498, "body": "If I see code like that I tend to call it a &quot;mistake&quot;. It usually was meant to be <code>a==b</code>. But it can be intentional, too."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1508351175, "post_id": 46816589, "comment_id": 80580919, "body": "@Yunnosch Haha, you beat me to it. If it&#39;s intentional, it&#39;s best to signify that with double parens as in <code>if ((a = b))</code>. GCC and Clang both have a <code>-Wparentheses</code> option that can warn you if you do assignment inside a conditional without the double parens."}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1508365424, "post_id": 46816589, "comment_id": 80587807, "body": "It&#39;s called &quot;optional unwrapping&quot; in Swift. ;)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8359330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b18be936dac09eb5396510310017fe8?s=128&d=identicon&r=PG&f=1", "display_name": "Jooseppi Luna", "link": "https://stackoverflow.com/users/8359330/jooseppi-luna"}, "edited": false, "score": 0, "creation_date": 1508358352, "post_id": 46816860, "comment_id": 80584623, "body": "if( a = b ) is a legitimate construct, although usually it&#39;s written as a mistake"}, {"owner": {"reputation": 50374, "user_id": 568283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120ceee2dc40d539b9983265a2e0a2f8?s=128&d=identicon&r=PG", "display_name": "CRD", "link": "https://stackoverflow.com/users/568283/crd"}, "reply_to_user": {"reputation": 13, "user_id": 8359330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b18be936dac09eb5396510310017fe8?s=128&d=identicon&r=PG&f=1", "display_name": "Jooseppi Luna", "link": "https://stackoverflow.com/users/8359330/jooseppi-luna"}, "edited": false, "score": 0, "creation_date": 1508358890, "post_id": 46816860, "comment_id": 80584921, "body": "@JooseppiLuna - exactly, it is valid code but is probably rarely what was intended hence why people often call it <i>bug</i>, <i>error</i>, or <i>mistake</i>..."}], "tags": [], "owner": {"reputation": 50374, "user_id": 568283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120ceee2dc40d539b9983265a2e0a2f8?s=128&d=identicon&r=PG", "display_name": "CRD", "link": "https://stackoverflow.com/users/568283/crd"}, "is_accepted": false, "score": 1, "last_activity_date": 1508351203, "creation_date": 1508351203, "answer_id": 46816860, "question_id": 46816589, "link": "https://stackoverflow.com/questions/46816589/what-do-you-call-doing-assignment-in-a-conditional/46816860#46816860", "title": "What do you call doing assignment in a conditional?", "body": "<p>It doesn\u2019t really have a name, though people do call it various things. If the code follows your question:</p>\n\n<pre><code>if( a = b )...\n</code></pre>\n\n<p>then common terms are: <em>bug</em>, <em>error</em>, etc. However if <code>b</code> is not a variable but an expression, e.g. as in the common C patterns:</p>\n\n<pre><code>if( (c = getchar()) != EOF )...\nwhile( *q++ = *p++ )...\n</code></pre>\n\n<p>then it might be called an <em>idiom</em>, <em>pattern</em>, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1508351209, "creation_date": 1508351209, "answer_id": 46816863, "question_id": 46816589, "link": "https://stackoverflow.com/questions/46816589/what-do-you-call-doing-assignment-in-a-conditional/46816863#46816863", "title": "What do you call doing assignment in a conditional?", "body": "<p>Assuming that an assignment is intentional, there is no special name for this. C language specification places a very weak requirement on the controlling expression of an <code>if</code> statement:</p>\n\n<blockquote>\n  <p><strong>6.8.4.1-1:</strong> The controlling expression of an if statement shall have scalar type.</p>\n</blockquote>\n\n<p>An assignment expression satisfies this requirement, as long as <code>a</code> and <code>b</code> are scalar. An implicit comparison to zero is performed on the result of this assignment:</p>\n\n<blockquote>\n  <p><strong>6.8.4.1-2:</strong> In both forms, the first substatement is executed if the expression compares unequal to 0. In the else form, the second substatement is executed if the expression compares equal to 0.</p>\n</blockquote>\n\n<p>Note that compilers would issue a warning when they see an assignment like that, because missing second <code>=</code> is a common source of errors. <a href=\"https://stackoverflow.com/q/15379730/335858\">You can prevent these warnings using parentheses, as described in this Q&amp;A</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1659, "user_id": 4767670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dda5bf53c264228a2cd807e9167dc9c?s=128&d=identicon&r=PG", "display_name": "NoImaginationGuy", "link": "https://stackoverflow.com/users/4767670/noimaginationguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1508358871, "creation_date": 1508358871, "answer_id": 46818795, "question_id": 46816589, "link": "https://stackoverflow.com/questions/46816589/what-do-you-call-doing-assignment-in-a-conditional/46818795#46818795", "title": "What do you call doing assignment in a conditional?", "body": "<p>I don\u2019t know if it has a name but I\u2019d call it \u201cuseful feature that nobody understands\u201d.\nIt is very useful indeed.\nWe can consider it a slang.</p>\n\n<p>In C++ for example you can use this by declaring a variable directly, and this is useful for safety checks:</p>\n\n<p>if (Object *a = takeObject()) {\n        // a is not nullptr\n   }</p>\n\n<p>Or when I don\u2019t want to repeat a statement in a loop:</p>\n\n<pre><code>while (a = next()) {\n\n}\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>a = next();\nwhile (a) {\n\n   a = next();\n}\n</code></pre>\n\n<p>But commonly these are just mistakes which compilers like gcc and clang give warnings about (and they force you to put an horrible double tuple to silence the warning ew!).</p>\n"}], "owner": {"reputation": 13, "user_id": 8359330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b18be936dac09eb5396510310017fe8?s=128&d=identicon&r=PG&f=1", "display_name": "Jooseppi Luna", "link": "https://stackoverflow.com/users/8359330/jooseppi-luna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 46816863, "answer_count": 3, "score": 1, "last_activity_date": 1508365511, "creation_date": 1508350270, "last_edit_date": 1508365511, "question_id": 46816589, "link": "https://stackoverflow.com/questions/46816589/what-do-you-call-doing-assignment-in-a-conditional", "title": "What do you call doing assignment in a conditional?", "body": "<p>Is there a special name for doing assignment in a conditional?  Here is an example of what I am asking about in C:</p>\n\n<pre><code>// Assume a and b have been previously defined and are compatible types\nif( (a = b) ) {  // &lt;- What do you call that?\n  //do something\n}\n</code></pre>\n\n<p>A couple friends of mine and I are convinced that there is a name for it, and some other people have agreed that there is one, but we can't find it anywhere. Has anyone here ever heard a term for it?</p>\n"}, {"tags": ["c", "pointers", "null", "char"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508352356, "post_id": 46816503, "comment_id": 80581541, "body": "Yes, you are confusing <code>NULL</code> and <code>&#39;\\0&#39;</code>. <code>NULL</code> makes no sense in this context."}], "answers": [{"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508352030, "post_id": 46816617, "comment_id": 80581349, "body": "<code>NULL</code> is a null pointer <i>constant</i>, which is not necessarily a pointer. It can be defined as a pointer though."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508352927, "post_id": 46816617, "comment_id": 80581832, "body": "@Ant : In general yes, but in this specific question NULL is a pointer - hence the error, so the answer remains valid."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508353140, "post_id": 46816617, "comment_id": 80581969, "body": "Yes, but the language itself makes a very clear distinction between <i>null pointer constant</i> and <i>null pointer</i>. These are two rather different concepts. For which reason referring to <code>NULL</code> as a <i>null pointer</i> sounds rather misleading."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508353602, "post_id": 46816617, "comment_id": 80582220, "body": "@Ant : I think I misunderstood your original point (I thout you were referring to the difference between <code>0</code> and <code>((void*)0)</code>. I have modified the text; feel free to make changes if you feel it improves it.  But let&#39;s be clear here the definition and meaning of NULL are largely irrelevant in this case since the error was the misconception that NULL defines the NUL character.  Language-lawyer &quot;noise&quot; about NULL is a side issue."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 4, "last_activity_date": 1508353353, "last_edit_date": 1508353353, "creation_date": 1508350345, "answer_id": 46816617, "question_id": 46816503, "link": "https://stackoverflow.com/questions/46816503/const-char-p-comparison-between-pointer-and-integer-if-p-null/46816617#46816617", "title": "const char **p comparison between pointer and integer if (**p == NULL)", "body": "<p>NULL is a macro defining a <em>null-pointer constant</em>, not the ASCII character NUL.  If you want to test for a character NUL, then:</p>\n\n<pre><code>if( **p == '\\0' )\n</code></pre>\n\n<p>or more simply:</p>\n\n<pre><code>if( **p == 0 )\n</code></pre>\n"}], "owner": {"reputation": 1689, "user_id": 3587282, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/56579efbf0b000eb9e51e41ca5550b65?s=128&d=identicon&r=PG&f=1", "display_name": "hi15", "link": "https://stackoverflow.com/users/3587282/hi15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 46816617, "answer_count": 1, "score": 1, "last_activity_date": 1508353353, "creation_date": 1508349971, "question_id": 46816503, "link": "https://stackoverflow.com/questions/46816503/const-char-p-comparison-between-pointer-and-integer-if-p-null", "title": "const char **p comparison between pointer and integer if (**p == NULL)", "body": "<p>I am defining a function where one of the argument is <code>const char **p</code>. I understand that it means 'declare p as pointer to pointer to const char'. Now I want to check if the const char is NULL character and thus check <code>(**p == NULL)</code> but it gives warning that <code>warning: comparison between pointer and integer</code>. Here is the code example  </p>\n\n<pre><code>   bool func(const char **p)\n     {   if (**p == NULL)\n             return false;}\n</code></pre>\n\n<p>I am not sure why it's complaining so. Isn't **p supposed to dereference the character value pointer *p points to? Or am I making confusion between <code>NULL</code> and <code>'\\0'</code>?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1508348073, "post_id": 46816005, "comment_id": 80579252, "body": "Unfortunately, there\u2019s no clean way to do this. What you\u2019d need here is essentially a C interpreter."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 6, "creation_date": 1508348139, "post_id": 46816005, "comment_id": 80579277, "body": "Neither C nor C++ are <i>scripting languages</i>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1508348233, "post_id": 46816005, "comment_id": 80579319, "body": "@user0042 - There&#39;s nothing in the standard the precludes an implementation from implementing C like a scripting language. It&#39;s just not common, and frankly the distinction is somewhat arbitrary."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1508348336, "post_id": 46816005, "comment_id": 80579376, "body": "@StoryTeller You mean something like emscripten does?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1508348370, "post_id": 46816005, "comment_id": 80579399, "body": "@user0042 - I mean something like <a href=\"http://www.drdobbs.com/cpp/ch-a-cc-interpreter-for-script-computing/184402054\" rel=\"nofollow noreferrer\">Ch</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5905796"}, "reply_to_user": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1508349160, "post_id": 46816005, "comment_id": 80579802, "body": "@user0042 - I didn&#39;t say C was a scripting language."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1508349264, "post_id": 46816005, "comment_id": 80579866, "body": "@MinoTaure Well, as you already know that, how do you imagine you can achieve what you&#39;re asking for in an easy way?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1508349332, "post_id": 46816005, "comment_id": 80579903, "body": "I don&#39;t think Mino is expecting it to be easy. They wouldn&#39;t have asked the question and probably would have already written the program if they did."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1508349410, "post_id": 46816005, "comment_id": 80579949, "body": "@user4581301 Then he&#39;s either asking for a 3rd party resource or a way too broad question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5905796"}, "edited": false, "score": 0, "creation_date": 1508349936, "post_id": 46816005, "comment_id": 80580240, "body": "Do not think that I did not seek, I preferred posed a question with a wide choice of answer for a greater opening to new possibilities"}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1508361551, "post_id": 46816005, "comment_id": 80586220, "body": "Have you considered plugins (delayed-load .so or .dll)s?  You compile them separately, and use your system&#39;s dynamic shared library features to use them later."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5905796"}, "edited": false, "score": 0, "creation_date": 1508349276, "post_id": 46816045, "comment_id": 80579872, "body": "Thank you very much ! This is what I need I things"}, {"owner": {"reputation": 1046, "user_id": 3464870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ef858158709a6e7e8b72ae9b699f6e2?s=128&d=identicon&r=PG", "display_name": "gyurix", "link": "https://stackoverflow.com/users/3464870/gyurix"}, "edited": false, "score": 0, "creation_date": 1508349418, "post_id": 46816045, "comment_id": 80579954, "body": "@user4581301 You are right, extended my answer a little bit. Mino Taure, if my answer helped you please leave an upvote and click to the accept answer button, thanks."}], "tags": [], "owner": {"reputation": 1046, "user_id": 3464870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ef858158709a6e7e8b72ae9b699f6e2?s=128&d=identicon&r=PG", "display_name": "gyurix", "link": "https://stackoverflow.com/users/3464870/gyurix"}, "is_accepted": true, "score": 0, "last_activity_date": 1508349279, "last_edit_date": 1508349279, "creation_date": 1508348170, "answer_id": 46816045, "question_id": 46816005, "link": "https://stackoverflow.com/questions/46816005/how-to-run-a-c-script-code-in-a-c-program/46816045#46816045", "title": "How to run a C script code in a C++ program", "body": "<p>The best way for reaching your goal, is to use a C interpreter library. </p>\n\n<p>For example you can use this one: <a href=\"https://github.com/jpoirier/picoc\" rel=\"nofollow noreferrer\">https://github.com/jpoirier/picoc</a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5905796"}, "edited": false, "score": 0, "creation_date": 1508430116, "post_id": 46818715, "comment_id": 80616642, "body": "Ok, I will see and will take precautions"}], "tags": [], "owner": {"reputation": 1202, "user_id": 4047084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-OTViRK_YA_U/AAAAAAAAAAI/AAAAAAAAFgI/WyZXUA4tFsg/photo.jpg?sz=128", "display_name": "Stuart Buckingham", "link": "https://stackoverflow.com/users/4047084/stuart-buckingham"}, "is_accepted": false, "score": 0, "last_activity_date": 1508358569, "creation_date": 1508358569, "answer_id": 46818715, "question_id": 46816005, "link": "https://stackoverflow.com/questions/46816005/how-to-run-a-c-script-code-in-a-c-program/46818715#46818715", "title": "How to run a C script code in a C++ program", "body": "<p>You could also do it with libjit. Because you are then running the system compiler, any ISO C/C++ code can be compiled (picoc is not fully ISO C complete)</p>\n\n<p><strong>Obligatory disclaimer: Running user supplied code at runtime is very dangerous unless it is properly sandboxed. Maybe consider doing it another way.</strong> </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5905796"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1508361774, "accepted_answer_id": 46816045, "answer_count": 2, "score": 0, "last_activity_date": 1508358569, "creation_date": 1508348017, "last_edit_date": 1508348219, "question_id": 46816005, "link": "https://stackoverflow.com/questions/46816005/how-to-run-a-c-script-code-in-a-c-program", "closed_reason": "Needs more focus", "title": "How to run a C script code in a C++ program", "body": "<p>I would like to run a what I called \"script C code\" from string in my C++ program, for exemple : </p>\n\n<pre><code>int main(){\n    // my string (from a file): printf(\"Hello, Stackoverflow!\")\n    RunScript(MyStringScript);\n    return 0;\n}\n</code></pre>\n\n<p>I could use clang or other, but I have no idea how to do that...</p>\n\n<p>PS: The goal is not to make a C interpreter, no, just run a C code to broaden my program.</p>\n"}, {"tags": ["c", "c99"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1508347776, "post_id": 46815865, "comment_id": 80579087, "body": "Lazy to write an answer, but it is here: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p15\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.7.2.1p15</a> .Read p15 and p17"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1508347812, "post_id": 46815865, "comment_id": 80579112, "body": "If there was &#39;padding at the beginning&#39;, would that not mean that the union was just not at that location?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1508347961, "post_id": 46815865, "comment_id": 80579190, "body": "Be sure to read paragraph 16 too. It explicitly mentions that there can be no padding at the start of a union."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1508347884, "creation_date": 1508347884, "answer_id": 46815972, "question_id": 46815865, "link": "https://stackoverflow.com/questions/46815865/are-c-unions-never-padded-at-the-beginning/46815972#46815972", "title": "Are C unions never padded at the beginning?", "body": "<ol>\n<li><p>Yes.  As you note, structures never have leading padding.  The address of a union always refers to the first element of any component of the union (with suitable casts), so there can't be any padding at the start of a union either.</p></li>\n<li><p>Yes.  Suitably cast, the address of a union is also a pointer to any of the elements within the union.</p></li>\n</ol>\n\n<blockquote>\n  <h1>ISO/IEC 9899:2011</h1>\n  \n  <h2>6.7.2.12 Structure and union specifiers</h2>\n  \n  <p>\u00b615 Within a structure object, the non-bit-field members and the units in which bit-fields\n  reside have addresses that increase in the order in which they are declared. A pointer to a\n  structure object, suitably converted, points to its initial member (or if that member is a\n  bit-field, then to the unit in which it resides), and vice versa. There may be unnamed\n  padding within a structure object, but not at its beginning.</p>\n  \n  <p>\u00b616 The size of a union is sufficient to contain the largest of its members. The value of at\n  most one of the members can be stored in a union object at any time. A pointer to a\n  union object, suitably converted, points to each of its members (or if a member is a bitfield,\n  then to the unit in which it resides), and vice versa.</p>\n  \n  <p>\u00b617 There may be unnamed padding at the end of a structure or union.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508348789, "post_id": 46816075, "comment_id": 80579616, "body": "Why? An implementation can introduce fixed padding at the beginning of each union type (say, 4 bytes) and then add/subtract this offset every time a pointer is converted from/to pointer-to-union type to some other type. That way the above requirement is satisfied."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1508349664, "post_id": 46816075, "comment_id": 80580076, "body": "@AnT I read it differently: since conversion of any pointer to <code>void*</code> is a suitable conversion, expressions <code>(void*)&amp;myUnion</code> and <code>(*void)&amp;myUnion.union_member</code> need to produce the same result, meaning that if there is an offset in front of all members of the union, then the address of the union itself must be padded by the same amount, which is the same as the address itself being adjusted by the amount of padding."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1508348282, "creation_date": 1508348282, "answer_id": 46816075, "question_id": 46815865, "link": "https://stackoverflow.com/questions/46815865/are-c-unions-never-padded-at-the-beginning/46816075#46816075", "title": "Are C unions never padded at the beginning?", "body": "<p>The standard makes the following guarantee:</p>\n\n<blockquote>\n  <p>6.7.2.11-4: A pointer to a union object, suitably converted, points to each of its members (or if a member is a bit-field, then to the unit in which it resides)</p>\n</blockquote>\n\n<p>This means that there can be no padding at the beginning of a union.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1508803346, "post_id": 46816157, "comment_id": 80747497, "body": "The authors of C89 made no effort to forbid every stupid thing compilers might do, and they note in the Rationale that it would be possible for an implementation to be conforming and yet be of such poor quality as to be useless.  Unfortunately, it has become fashionable to presume that if the Standard doesn&#39;t forbid compilers from doing something, any code that would rely upon compilers&#39; forbearance should be viewed as &quot;defective&quot; and compilers should be encouraged to do it if it might improve the behavior of code that doesn&#39;t rely upon such forbearance."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1508348634, "creation_date": 1508348634, "answer_id": 46816157, "question_id": 46815865, "link": "https://stackoverflow.com/questions/46815865/are-c-unions-never-padded-at-the-beginning/46816157#46816157", "title": "Are C unions never padded at the beginning?", "body": "<p>The language specification does not make a direct guarantee about it. However it says</p>\n\n<blockquote>\n  <p>A pointer to a union object, suitably converted, points to each of its members (or if a member is a bitfield, then to the unit in which it resides), and vice versa.</p>\n</blockquote>\n\n<p>Note that pointer conversion in C language never implies that the numeric value of the pointer (the actual address) is preserved during the conversion. This means that technically it is possible to satisfy this requirement and still have padding at the beginning of the union. </p>\n\n<p>However, there's no reason to have it there. And, quite obviously, there was no intent to introduce that possibility. Especially if you take into account that the language specification explicitly says that there's no padding at the beginning of structs.</p>\n"}], "owner": {"reputation": 43, "user_id": 8797071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069d10b87559eef537618e68dacb4b96?s=128&d=identicon&r=PG&f=1", "display_name": "user8797071", "link": "https://stackoverflow.com/users/8797071/user8797071"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 46815972, "answer_count": 3, "score": 4, "last_activity_date": 1508348712, "creation_date": 1508347418, "question_id": 46815865, "link": "https://stackoverflow.com/questions/46815865/are-c-unions-never-padded-at-the-beginning", "title": "Are C unions never padded at the beginning?", "body": "<p>Are there any guarantees in the C99 standard that unions will only ever be padded at the end like structs? And relatedly, will the address of the union always be equal to the address of any of its possible members?</p>\n"}, {"tags": ["c", "discrete-mathematics"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1508346690, "post_id": 46815618, "comment_id": 80578594, "body": "Hint: don&#39;t use the <code>pow</code> function. See <a href=\"http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">what every computer scientist should know about floating-point arithmetic</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 0, "last_activity_date": 1508787863, "last_edit_date": 1508787863, "creation_date": 1508346591, "answer_id": 46815641, "question_id": 46815618, "link": "https://stackoverflow.com/questions/46815618/finding-subsets-dicretely-c/46815641#46815641", "title": "finding subsets dicretely c", "body": "<p>Ah because you don't cover the LSB or the 0th element. <code>for (j = (n-1); j &gt;= 0; j--)</code> You missed the <code>=</code>.</p>\n\n<p>Also you have to know if <code>j</code>-th bit is set in <code>i</code> or not.</p>\n\n<p>And instead of pow you can simply use (<code>1&lt;&lt;n</code>)[Equivalent to <code>2^n</code>]</p>\n\n<p>Your code is not readable. I will post the pseudocode.</p>\n\n<pre><code>for ( int i = 0; i&lt;= (1&lt;&lt;numOfSetElmts)-1; i++)\n{\n     //print Subset-i\n     for(int pos = 0; pos&lt;=n-1;pos++)\n       if( i&amp;(1&lt;&lt;pos) )\n         print Set[pos]\n}\n</code></pre>\n\n<h3>Why am I not using <code>pow</code>?</h3>\n\n<p>The pow function is implemented by an algorithm and uses floating point functions and values to compute the power value.</p>\n\n<p>So power of floating point to the power <code>n</code> is not necessarily multiplying it repetitively n times. As a result you end up with some errors and execution is a bit slower too. </p>\n\n<h3>Bitwise is faster?</h3>\n\n<p>Yes it is. Even if modern implementation are making changes to the architecture as a whole but still you won't lose the performance by using bitwise. Most of them it will have better performance than addition operation, if not equal. </p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7753534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38d73a05865c925194b80931a61f8ea?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/7753534/beth"}, "edited": false, "score": 0, "creation_date": 1508353474, "post_id": 46816382, "comment_id": 80582155, "body": "wow, thank you . I usually write the first solution that i can think of , and then try to improve it. So that would be a great improvement, i hope i&#39;ll get faster someday. Thanks again!"}], "tags": [], "owner": {"reputation": 11, "user_id": 4181141, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001676410934/picture?type=large", "display_name": "Shihad Thayyil", "link": "https://stackoverflow.com/users/4181141/shihad-thayyil"}, "is_accepted": false, "score": 0, "last_activity_date": 1508349537, "creation_date": 1508349537, "answer_id": 46816382, "question_id": 46815618, "link": "https://stackoverflow.com/questions/46815618/finding-subsets-dicretely-c/46816382#46816382", "title": "finding subsets dicretely c", "body": "<p>Your program have worst complexity. There are better solutions for this problem with minimum complexity. Anyway the problem of your code is put '&lt;=' </p>\n\n<pre><code>i &lt;= pow(2,n)-1\n</code></pre>\n\n<p>Also you can use <code>i &lt; 1&lt;&lt;n</code> Both work same but second one is better and faster. The same problem happens in the inner loop where you didn't put '=' sign. ie, <code>j&gt;=0</code> . Else the program was good.</p>\n\n<p>The better solution for your problem may look like this.</p>\n\n<pre><code>void subsets(char A[], int N)\n{\n    int i,j;\n    for( i = 0;i &lt; (1 &lt;&lt; N); ++i)\n    {\n        for( j = 0;j &lt; N;++j)\n            if(i &amp; (1 &lt;&lt; j))\n                printf(\"%c  \",  A[j] );\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>In this there is no external binary conversion or matrix needed.</p>\n"}], "owner": {"reputation": 3, "user_id": 7753534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38d73a05865c925194b80931a61f8ea?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/7753534/beth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 46815641, "answer_count": 2, "score": 0, "last_activity_date": 1508787863, "creation_date": 1508346489, "question_id": 46815618, "link": "https://stackoverflow.com/questions/46815618/finding-subsets-dicretely-c", "title": "finding subsets dicretely c", "body": "<pre><code>for (i = 0; i &lt; (pow(2,n)-1); i++) {\n    x = binary_conversion(i);\n    for (j = (n-1); j &gt; 0; j--) {\n\n        if (x == 0) {\n            M[i][j] = 0;\n        }\n        else {\n            M[i][j] = x % 10;\n            x = x / 10;\n        }\n    }\n}\n</code></pre>\n\n<p>i want to print the subsets of a set, so for a set of n elements i get the value of 2^n. from 0 to 2^n, i'm converting the values to binary. and i am keeping the binary values in a matrice and as i go through the matrice, if the value is 1, i am printing the corresponding element of the original set.But while creating the matrice, it assigns the same binary value to two consecutive rows so at the end i can not even get half of the subsets. What do you think is wrong with the code?</p>\n"}, {"tags": ["python", "c", "macos", "ctypes"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1508346631, "post_id": 46815599, "comment_id": 80578562, "body": "You didn&#39;t set the restype."}, {"owner": {"reputation": 1390, "user_id": 1273987, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b3f583352439f5fd7d2787f7c7402c4d?s=128&d=identicon&r=PG", "display_name": "Ziofil", "link": "https://stackoverflow.com/users/1273987/ziofil"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1508346762, "post_id": 46815599, "comment_id": 80578632, "body": ":facepalm: Thank you."}], "owner": {"reputation": 1390, "user_id": 1273987, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b3f583352439f5fd7d2787f7c7402c4d?s=128&d=identicon&r=PG", "display_name": "Ziofil", "link": "https://stackoverflow.com/users/1273987/ziofil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 605, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508346386, "creation_date": 1508346386, "question_id": 46815599, "link": "https://stackoverflow.com/questions/46815599/calling-c-function-from-python-with-ctypes", "title": "Calling C function from Python with ctypes", "body": "<p>I'm trying to call C functions from a python script via <code>ctypes</code>, but I'm doing something wrong. I wrote a minimal example to show what I'm doing:</p>\n\n<h1>C code:</h1>\n\n<pre><code>#include &lt;stdio.h&gt;    \n\nfloat distance(float ab[]){\n return fabs(ab[0]-ab[1]);\n}\n</code></pre>\n\n<p>I save it as <code>c_library.c</code> and I compile it with <code>cc -fPIC -shared -o c_library.so c_library.c</code>.</p>\n\n<h1>Python code:</h1>\n\n<pre><code>import ctypes\n_c = ctypes.CDLL('c_library.so')\n_c.distance.argtypes = [ctypes.POINTER(ctypes.c_float)]\n\ndef distance(ab):\n    array_type = ctypes.c_float * 2\n    return float(_c.distance(array_type(*ab)))\n\nprint(distance(np.array([1.0,3.0])))\n</code></pre>\n\n<p>When I execute it, I get <code>0.0</code> as output. What am I doing wrong?</p>\n"}, {"tags": ["c#", "c", "algorithm"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1508346177, "post_id": 46815486, "comment_id": 80578342, "body": "What is your question?"}, {"owner": {"reputation": 7, "user_id": 5219545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f3c66e811eef1a3e21a80286a35e03?s=128&d=identicon&r=PG&f=1", "display_name": "Jheferson", "link": "https://stackoverflow.com/users/5219545/jheferson"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1508346667, "post_id": 46815486, "comment_id": 80578581, "body": "How to implement the code in the article in C#. There is a line where it describe an operation between integer and boolean, and that&#39;s not allowed in C#."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1508347148, "post_id": 46815486, "comment_id": 80578796, "body": "<code>|| x1</code> -&gt; <code>|| x1 != 0</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1508352037, "post_id": 46815486, "comment_id": 80581355, "body": "Please make an answer or delete the question."}], "owner": {"reputation": 7, "user_id": 5219545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f3c66e811eef1a3e21a80286a35e03?s=128&d=identicon&r=PG&f=1", "display_name": "Jheferson", "link": "https://stackoverflow.com/users/5219545/jheferson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508346319, "creation_date": 1508345970, "last_edit_date": 1508346319, "question_id": 46815486, "link": "https://stackoverflow.com/questions/46815486/rasterizing-curves-algorithms", "title": "Rasterizing curves algorithms", "body": "<p>My current application needs an algorithm to drawing lines, circles and rotated ellipses of a given image. I have searched on the internet and found this article <a href=\"http://members.chello.at/~easyfilter/Bresenham.pdf\" rel=\"nofollow noreferrer\">Algorithm for Drawing Curves</a> explain how to achieve it. I'm trying to implement a method describe in the Page 40 in C#, but in the Line 40 has an operation between Int and Bool.</p>\n\n<p>The operation in question is:</p>\n\n<pre><code>  x1 = 2 * err &gt; dy;          // &lt;- this\n  y1 = 2 * (err + yy) &lt; -dy); // &lt;- this\n\n  if (2 * err &lt; dx || y1)     // &lt;- this\n  { \n      y0 += sy; \n      dy += xy; \n      err += dx += xx; \n   }\n\n   if (2 * err &gt; dx || x1)    // &lt;- this\n   { \n       x0 += sx; \n       dx += xy; \n       err += dy += yy; \n   }\n</code></pre>\n\n<p>The variables x1, y1 are integers and err, yy and dy are double. I don't know which programming language the author used, but apparently seems to be in C.</p>\n\n<p>How to translated this operation in C#?</p>\n\n<p>The Complete method I tried to implemented in C#:</p>\n\n<pre><code>    private static Point[] plotQuadRationalBezierSeg(int x0, int y0, int x1, int y1, int x2, int y2, double w)\n    {                   \n        // plot a limited rational Bezier segment, squared weight \n        var points = new List&lt;Point&gt;();\n\n        int sx = x2 - x1, sy = y2 - y1;                   // relative values for checks \n        double dx = x0 - x2, dy = y0 - y2, xx = x0 - x1, yy = y0 - y1;\n        double xy = xx * sy + yy * sx, cur = xx * sy - yy * sx, err; // curvature \n\n        //assert(xx * sx &lt;= 0.0 &amp;&amp; yy * sy &lt;= 0.0);   // sign of gradient must not change \n\n        if (cur != 0.0 &amp;&amp; w &gt; 0.0)\n        {                            /* no straight line */\n            if (sx * (long)sx + sy * (long)sy &gt; xx * xx + yy * yy)\n            {   // begin with longer part \n                x2 = x0; \n                x0 -= (int)dx; \n                y2 = y0; \n                y0 -= (int)dy; \n                cur = -cur;         //swap P0 P2 \n            }\n\n            xx = 2.0 * (4.0 * w * sx * xx + dx * dx);                   //differences 2nd degree \n            yy = 2.0 * (4.0 * w * sy * yy + dy * dy);\n            sx = x0 &lt; x2 ? 1 : -1;                                // x step direction \n            sy = y0 &lt; y2 ? 1 : -1;                                // y step direction \n            xy = -2.0 * sx * sy * (2.0 * w * xy + dx * dy);\n\n            if (cur * sx * sy &lt; 0.0)\n            {                             \n                // negated curvature?\n                xx = -xx; \n                yy = -yy; \n                xy = -xy; \n                cur = -cur;\n            }\n\n            dx = 4.0 * w * (x1 - x0) * sy * cur + xx / 2.0 + xy;            //differences 1st degree\n            dy = 4.0 * w * (y0 - y1) * sx * cur + yy / 2.0 + xy;\n\n            if (w &lt; 0.5 &amp;&amp; (dy &gt; xy || dx &lt; xy))\n            {   \n                // flat ellipse, algorithm fails \n                cur = (w + 1.0) / 2.0; \n                w = Math.Sqrt(w); \n                xy = 1.0 / (w + 1.0);\n\n                sx = (int)Math.Floor((x0 + 2.0 * w * x1 + x2) * xy / 2.0 + 0.5); //subdivide curve in half \n                sy = (int)Math.Floor((y0 + 2.0 * w * y1 + y2) * xy / 2.0 + 0.5);\n                dx = (int)Math.Floor((w * x1 + x0) * xy + 0.5);\n                dy = (int)Math.Floor((y1 * w + y0) * xy + 0.5);\n\n                points.AddRange(plotQuadRationalBezierSeg(x0, y0, (int)dx, (int)dy, sx, sy, cur)); //plot separately \n\n                dx = Math.Floor((w * x1 + x2) * xy + 0.5); dy = Math.Floor((y1 * w + y2) * xy + 0.5);\n\n                points.AddRange(plotQuadRationalBezierSeg(sx, sy, (int)dx, (int)dy, x2, y2, cur));\n\n                return points.ToArray();\n            }\n\n            //error 1.step\n            err = dx + dy - xy;     \n\n            do\n            {\n                points.Add(new Point(x0, y0));  // plot curve \n\n                if (x0 == x2 &amp;&amp; y0 == y2) \n                    return points.ToArray(); // last pixel -&gt; curve finished\n\n                x1 = 2 * err &gt; dy; \n                y1 = 2 * (err + yy) &lt; -dy); // save value for test of x step\n\n                if (2 * err &lt; dx || y1) \n                { \n                    y0 += sy; \n                    dy += xy; \n                    err += dx += xx; \n                }/* y step */\n\n                if (2 * err &gt; dx || x1) \n                { \n                    x0 += sx; \n                    dx += xy; \n                    err += dy += yy; \n                }/* x step */\n\n            } while (dy &lt;= xy &amp;&amp; dx &gt;= xy);    // gradient negates -&gt; algorithm fails \n        }\n\n        // plot remaining needle to end\n        points.AddRange(\n                new Point[] { \n                        new Point(x0, y0), \n                        new Point(x2, y2),                  \n                });\n\n        return points.ToArray();\n    }\n</code></pre>\n"}, {"tags": ["c", "struct", "linked-list"], "comments": [{"owner": {"reputation": 2531, "user_id": 6084317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4295c9b1ada748080d7a123f7263ae69?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Minnix", "link": "https://stackoverflow.com/users/6084317/edward-minnix"}, "edited": false, "score": 4, "creation_date": 1508346044, "post_id": 46815457, "comment_id": 80578290, "body": "Shouldn&#39;t it be <code>sizeof</code> not <code>sizof</code>?"}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1508346055, "post_id": 46815457, "comment_id": 80578293, "body": "<code>sizof()</code> --&gt;&gt; <code>sizeof()</code>"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1508346257, "post_id": 46815457, "comment_id": 80578380, "body": "Also, you needn&#39;t cast the return value of <code>malloc()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8796953, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bPKpU6rebZI/AAAAAAAAAAI/AAAAAAAAA4o/j3Vd7_sM7Cc/photo.jpg?sz=128", "display_name": "Anthony", "link": "https://stackoverflow.com/users/8796953/anthony"}, "edited": false, "score": 0, "creation_date": 1508351588, "post_id": 46815565, "comment_id": 80581111, "body": "Yep, didn&#39;t notice the typo. Thank you!"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1508346248, "creation_date": 1508346248, "answer_id": 46815565, "question_id": 46815457, "link": "https://stackoverflow.com/questions/46815457/error-expected-expression-before-struct-when-making-a-linked-list/46815565#46815565", "title": "Error: Expected Expression Before &#39;struct&#39;, when making a linked list", "body": "<p>There is a typo in statements like this</p>\n\n<pre><code>struct List* head = (struct List*)malloc(sizof(struct List));\n                                         ^^^^^\n</code></pre>\n\n<p>There must be</p>\n\n<pre><code>struct List* head = (struct List*)malloc(sizeof(struct List));\n                                         ^^^^^^\n</code></pre>\n\n<p>Take into account that according to the C Standard the function main without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>And you should free all allocated memory for the list before exiting the program.</p>\n"}], "owner": {"reputation": 15, "user_id": 8796953, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bPKpU6rebZI/AAAAAAAAAAI/AAAAAAAAA4o/j3Vd7_sM7Cc/photo.jpg?sz=128", "display_name": "Anthony", "link": "https://stackoverflow.com/users/8796953/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3122, "favorite_count": 0, "accepted_answer_id": 46815565, "answer_count": 1, "score": 1, "last_activity_date": 1508355163, "creation_date": 1508345887, "last_edit_date": 1508355163, "question_id": 46815457, "link": "https://stackoverflow.com/questions/46815457/error-expected-expression-before-struct-when-making-a-linked-list", "title": "Error: Expected Expression Before &#39;struct&#39;, when making a linked list", "body": "<p>I keep getting an error when trying to make a linked list. The error is \"expected expression before 'struct'\" on both of the lines where I try to <code>malloc()</code> a new node. I've looked at similar questions and tried to fix my code but I can't get it to work. Any help would be very much appreciated. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct List {\n    int x;\n    struct List *next;\n};\n\nint main() {\n    struct List* head = (struct List*)malloc(sizof(struct List));\n    if (head == NULL) {\n        return 1;\n    }\n\n    head-&gt;x = 1;\n    head-&gt;next = (struct List*)malloc(sizof(struct List));\n    head-&gt;next-&gt;x = 2;\n    head-&gt;next-&gt;next = NULL;\n\n    struct List* current = head;\n    while(current != NULL) {\n        printf(\"%d\", current-&gt;x);\n        current = current-&gt;next;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "binary-search"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508346235, "post_id": 46815411, "comment_id": 80578367, "body": "If you want to declare an initial value for the array, then you must do so in its declaration.  Elsewhere, you can assign only to individual elements, not to the whole array.  Additionally, suppose control passes out of the <code>while</code> loop in your <code>binarySearch()</code> function.  If you can be certain that <code>array[first]&gt;array[last]</code> in that case, then you should <i>unconditionally</i> return <code>-1</code>.  Otherwise, you must specify a return value in the case that that condition does not hold."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508542998, "post_id": 46815411, "comment_id": 80664940, "body": "<code>array[size]={1,3,6,8,12,13,16};</code> makes no sense in C. What were you trying to do by this?"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 8762139, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-jNroW25bJNU/AAAAAAAAAAI/AAAAAAAAAHY/fRG0AeoWYAc/photo.jpg?sz=128", "display_name": "oxodo", "link": "https://stackoverflow.com/users/8762139/oxodo"}, "edited": false, "score": 0, "creation_date": 1508352590, "post_id": 46815581, "comment_id": 80581651, "body": "Thank you. it worked.  However, why am I not able to initlize the values for the array like:              &#39;int array[size]={1,3,6,8,12,13,16};&#39;"}, {"owner": {"reputation": 11, "user_id": 4181141, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001676410934/picture?type=large", "display_name": "Shihad Thayyil", "link": "https://stackoverflow.com/users/4181141/shihad-thayyil"}, "reply_to_user": {"reputation": 149, "user_id": 8762139, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-jNroW25bJNU/AAAAAAAAAAI/AAAAAAAAAHY/fRG0AeoWYAc/photo.jpg?sz=128", "display_name": "oxodo", "link": "https://stackoverflow.com/users/8762139/oxodo"}, "edited": false, "score": 0, "creation_date": 1508403548, "post_id": 46815581, "comment_id": 80599905, "body": "Because you are trying to assign set of values into a single variable array[size] or array[7].  That is why it shows an error. If this solutions helps please check answer as correct. Thanks"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 149, "user_id": 8762139, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-jNroW25bJNU/AAAAAAAAAAI/AAAAAAAAAHY/fRG0AeoWYAc/photo.jpg?sz=128", "display_name": "oxodo", "link": "https://stackoverflow.com/users/8762139/oxodo"}, "edited": false, "score": 0, "creation_date": 1508542327, "post_id": 46815581, "comment_id": 80664779, "body": "@oxodo: What do you mean by &quot;not able&quot;? If <code>size</code> is a constant, then you <i>are</i> able to do it. If <code>size</code> is not constant, then you won&#39;t be able to do it, since VLA do not accept initializers. What is <code>size</code> in your case?"}], "tags": [], "owner": {"reputation": 11, "user_id": 4181141, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001676410934/picture?type=large", "display_name": "Shihad Thayyil", "link": "https://stackoverflow.com/users/4181141/shihad-thayyil"}, "is_accepted": false, "score": 1, "last_activity_date": 1508346319, "creation_date": 1508346319, "answer_id": 46815581, "question_id": 46815411, "link": "https://stackoverflow.com/questions/46815411/error-defining-an-array/46815581#46815581", "title": "Error defining an array", "body": "<p>Remove the <code>array[size]={1,3,6,8,12,13,16};</code>. You cant initialize value to array after declaration. But only on the time of deceleration. The correct code is </p>\n\n<pre><code>int array[]={1,3,6,8,12,13,16};\n</code></pre>\n\n<p>Also declare size as macro constant. I think its better. It will look like </p>\n\n<pre><code>#define size 7\n</code></pre>\n\n<p>Everything else look fine!!</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1508542743, "creation_date": 1508542743, "answer_id": 46858656, "question_id": 46815411, "link": "https://stackoverflow.com/questions/46815411/error-defining-an-array/46858656#46858656", "title": "Error defining an array", "body": "<pre><code>int search, size=7, array[size], middle;\n</code></pre>\n\n<p>Here you've defined the array object <code>array</code>.  Note that the size is not a constant, so this is a VLA (variable-length array).  Not all compilers support VLAs, and you don't need one here.</p>\n\n<pre><code>array[size]={1,3,6,8,12,13,16};\n</code></pre>\n\n<p>This is several kinds of wrong.</p>\n\n<p><code>array[size]</code> would be element 7 of <code>array</code> -- but <code>array</code> only has elements 0 through 6.</p>\n\n<p>You obviously mean to assign the 7 values <code>{1,3,6,8,12,13,16}</code> to the 7 elements of <code>array</code>, but you can't do it this way. In fact, array objects can be initialized, but they can't be assigned to (for complicated historical reasons).</p>\n\n<p><code>{1,3,6,8,12,13,16}</code> is not an expression, so it can't appear on the right hand side of an assignment, regardless of what's on the left.  It is a valid initializer.</p>\n\n<p>Drop the definition of <code>size</code> and change the declaration of <code>array</code> to this:</p>\n\n<pre><code>int array[] = {1,3,6,8,12,13,16};\n</code></pre>\n\n<p>Since you've initialized <code>array</code> with 7 elements, you don't have to tell the compiler how many elements it has; the size is determined for you automatically. (That's one of the few things C will helpfully do for you.)</p>\n\n<p>Now you could define</p>\n\n<pre><code>const int size = 7;\n</code></pre>\n\n<p>but then you'd have to carefully update the initializers for <code>array</code> and <code>size</code> together, and make sure they're consistent.  Instead, you can compute the size:</p>\n\n<pre><code>const int size = sizeof array / sizeof array[0];\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 8762139, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-jNroW25bJNU/AAAAAAAAAAI/AAAAAAAAAHY/fRG0AeoWYAc/photo.jpg?sz=128", "display_name": "oxodo", "link": "https://stackoverflow.com/users/8762139/oxodo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1508542817, "creation_date": 1508345729, "last_edit_date": 1508542135, "question_id": 46815411, "link": "https://stackoverflow.com/questions/46815411/error-defining-an-array", "title": "Error defining an array", "body": "<p>I want to introduce as stated in the title, a binary search function to my program. But keep getting two errors which I have no clue how resolve.</p>\n\n<p>This is the compiling-error I get for my code:</p>\n\n<pre><code>: expected expression before '{' token\n array[size]={1,3,6,8,12,13,16};\n             ^\nupg10.8.c: In function 'binarySearch':\nupg10.8.c:55:7: warning: control reaches end of non-void function [-Wreturn-\n type]\n       }\n       ^\n</code></pre>\n\n<p>Any idea to what is causing the problem in both cases?<br>\nYou can find the code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint binarySearch(int n, int array[], int search);\n\nint main(void){\n\nint search, size=7, array[size], middle;\n\narray[size]={1,3,6,8,12,13,16};\n\n\n\nprintf(\"input search number:\\n\");\nscanf(\"%d\", &amp;search);\n\nmiddle  = binarySearch(size, array, search);\n\nif(middle ==-1){\nprintf(\"There is no index corresponding to that search number\");\n}\nelse{\nprintf(\"Index %d for Search%d\", middle, search);\n}\n\n  return 0;\n}\n\nint binarySearch(int n, int array[], int search){\n  int first =0;\n  int last = n-1;\n  int middle= (first+last)/2;\n\n\n  while(first&lt;=last){\n  if(array[middle]&lt;search)\n  first= middle +1;\n  else if(array[middle]==search){\n\n    return search;\n  }\n      else\n      last = middle -1;\n\n      middle = (first +last )/2;\n\n      return middle;\n      break;\n    }\n\nif(array[first]&gt;array[last])\nreturn -1;\n\n      }\n</code></pre>\n"}, {"tags": ["c", "string-parsing"], "comments": [{"owner": {"reputation": 1582, "user_id": 7795130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Inihh.gif?s=128&g=1", "display_name": "Davy M", "link": "https://stackoverflow.com/users/7795130/davy-m"}, "edited": false, "score": 2, "creation_date": 1508344139, "post_id": 46814924, "comment_id": 80577266, "body": "What have you tried so far? What do you already know about c string parsing that might be relevant? There are dozens of ways to solve your issue, but we want to be able to help you understand the solution, not just give you code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1508344161, "post_id": 46814924, "comment_id": 80577274, "body": "Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508344535, "post_id": 46814924, "comment_id": 80577476, "body": "I also recommend you get <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">a good beginners book or two</a> to read. If you already know the basics then concentrate on the chapters about input and output, and pointers and arrays. Besides that, read about the <a href=\"http://en.cppreference.com/w/c/string/byte/strtol\" rel=\"nofollow noreferrer\"><code>strtol</code></a> function. The books and the knowledge of the <a href=\"http://en.cppreference.com/w/c/string/byte/strtol\" rel=\"nofollow noreferrer\"><code>strtol</code></a> function is all you need for this assignment."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1508344846, "post_id": 46814924, "comment_id": 80577631, "body": "Note that the title asks about digits followed by a <code>!</code>, but the sample data shows the digits after the exclamation mark."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1508345017, "post_id": 46814924, "comment_id": 80577727, "body": "For the exclamation mark first, you can use <code>sscanf()</code> effectively. It is marginally harder if the exclamation mark comes second. Are spaces allowed between digits and the mark?"}, {"owner": {"reputation": 663, "user_id": 7044618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e44aa42ecf997aebf20b9a74b23e5446?s=128&d=identicon&r=PG&f=1", "display_name": "smriti", "link": "https://stackoverflow.com/users/7044618/smriti"}, "edited": false, "score": 0, "creation_date": 1508347769, "post_id": 46814924, "comment_id": 80579084, "body": "Sorry if my question was lame and not up to mark. I figured out the issue  I was having."}], "answers": [{"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 1, "last_activity_date": 1508344153, "creation_date": 1508344153, "answer_id": 46814974, "question_id": 46814924, "link": "https://stackoverflow.com/questions/46814924/parse-a-char-string-in-c-to-get-just-the-numeric-digits-after-the-exclamation-ma/46814974#46814974", "title": "Parse a char string in c to get just the numeric digits after the exclamation mark", "body": "<p>Some hints, but not going to write the code for you:</p>\n\n<p>Use the string library functions like <code>strchr</code> to find the '!'. Then use <code>strtod</code> to convert a string to a number. Look at <code>strtod</code>'s output to see if it had an error or if it was followed by letters.</p>\n\n<p>Or maybe you want <code>strtol</code> for integers instead.</p>\n"}], "owner": {"reputation": 663, "user_id": 7044618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e44aa42ecf997aebf20b9a74b23e5446?s=128&d=identicon&r=PG&f=1", "display_name": "smriti", "link": "https://stackoverflow.com/users/7044618/smriti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 46814974, "answer_count": 1, "score": -4, "last_activity_date": 1508347195, "creation_date": 1508343989, "last_edit_date": 1508347195, "question_id": 46814924, "link": "https://stackoverflow.com/questions/46814924/parse-a-char-string-in-c-to-get-just-the-numeric-digits-after-the-exclamation-ma", "title": "Parse a char string in c to get just the numeric digits after the exclamation mark", "body": "<p>If I have something like !23 How can I parse it to get just the number part? </p>\n\n<p>Input: !23\nOutput: 23</p>\n\n<p>Input: !\nOutput: Error</p>\n\n<p>Input: !23eds3\nOutput: Error</p>\n\n<p>This is my approach of getting the numeric digit. But for some reason strcpy is messing up my array where I am storing some data, its deleting the first element in my array.</p>\n\n<pre><code>if (args[0][0] == '!'){ \n  char str_index[1];\n  strcpy(str_index, &amp;args[0][1]);\n  int index = atoi(str_index);\n}\n</code></pre>\n\n<p>Also I haven't programmed in C a lot this is only my second program in C. </p>\n"}, {"tags": ["c", "stm32", "uart", "dma"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1508344756, "post_id": 46814882, "comment_id": 80577586, "body": "&#39;osDelay(100);&#39; what is that?  Looks like a fail to me:("}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1508346194, "post_id": 46814882, "comment_id": 80578351, "body": "<code>osKernelStart()</code> should be used after you create your task and this call never returns, so it is useless to put an infinite loop after that call."}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1508348151, "post_id": 46814882, "comment_id": 80579283, "body": "osDelay(100) makes task to execute as fast as 10 times per second, this is working for another task i have running that blinks a led. osKernelStart() is OK, I have other task moving leds and a LCD that are OK. I haven&#39;t copy all the freertos.c because is not useful for this question"}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1508348562, "post_id": 46814882, "comment_id": 80579498, "body": "the osDelay(100) is there because I don&#39;t think that I need to run this task more than 10 times per second, because is more or less the velocity of keyboard typing. I will change this number in order to not lose characters, but, dosen&#39;t DMA avoid loosing characters?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1508371375, "post_id": 46814882, "comment_id": 80589399, "body": "but it should not be archived by delays. What is the <b>hard</b>-real-time OS and what are differences between it and &quot;normal&quot; and <b>soft</b> real time OS-es?"}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1508392269, "post_id": 46814882, "comment_id": 80594349, "body": "Ok, delay is eliminated and continues not working. Hard-Real-Time is that i have to capture some signals and send other signals in very specific times, but this is not what I want to focus. What I want is to rx and tx uart using dma, disturbing the main functionality as much as possible."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1508397204, "post_id": 46814882, "comment_id": 80596298, "body": "DMA disturbing main functionality? Anyway. DMA for the echo (1 byte chunks) is an overkill. Just use the interrupts"}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1508398490, "post_id": 46814882, "comment_id": 80597046, "body": "But interrupts, can interrupt while acquiring, and add &quot;time variation&quot; to my data. The goal of doing with DMA( I&#39;m with you that is overkilling) is to never interrupt the main task and not loose any character."}, {"owner": {"reputation": 462, "user_id": 6537200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZtIQn.jpg?s=128&g=1", "display_name": "JMA", "link": "https://stackoverflow.com/users/6537200/jma"}, "edited": false, "score": 0, "creation_date": 1508400963, "post_id": 46814882, "comment_id": 80598388, "body": "Is the DMA&#39;s interrupt enabled? Wich priority does it have? I have the same priority for USART&#39;s interrupt and for DMA&#39;s interrupt."}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1508406454, "post_id": 46814882, "comment_id": 80601585, "body": "JMA, yes DMA interupt is enable or I think so, maybe I&#39;m missing something. I EDIT the question adding the DMA init, is this what you mean?"}, {"owner": {"reputation": 462, "user_id": 6537200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZtIQn.jpg?s=128&g=1", "display_name": "JMA", "link": "https://stackoverflow.com/users/6537200/jma"}, "edited": false, "score": 0, "creation_date": 1508410204, "post_id": 46814882, "comment_id": 80603569, "body": "we did not get DMA with interrupt worked either, we are using DMA with polling for RX."}], "owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3770, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514017216, "creation_date": 1508343879, "last_edit_date": 1508406393, "question_id": 46814882, "link": "https://stackoverflow.com/questions/46814882/stm32-freertos-uart-rx-and-tx-with-dma-echo-in-task", "title": "stm32 freeRTOS UART Rx and Tx with DMA echo in Task", "body": "<p>I'm trying to do a kind of \"terminal\" interaction with my STM32L476.\nFirst of all I want to do a direct echo, when I recive data send it back for the same UART.\nAfter, I want to put the echo in a task.</p>\n\n<p>Question:\nI'm implementing a hard-real time OS and want to leave UART operations to IDLE task, or very low priority task. \nIs this a good way of doing things? </p>\n\n<p>I can print using:</p>\n\n<p><code>void uartPrint(UART_HandleTypeDef *huart, char _out[]){\n    HAL_UART_Transmit_DMA(huart, (uint8_t *) _out, strlen(_out));\n}</code></p>\n\n<p>But I don't receive, or the <code>HAL_UART_RxCpltCallback</code>is not called never.</p>\n\n<p>main.c</p>\n\n<pre><code>/\n/* Includes ------------------------------------------------------------------*/\n#include \"main.h\"\n#include \"stm32l4xx_hal.h\"\n#include \"cmsis_os.h\"\n#include \"dma.h\"\n#include \"usart.h\"\n#include \"spi.h\"\n#include \"tim.h\"\n#include \"gpio.h\"\n\n#include \"display.h\"\n\nSPI_HandleTypeDef hspi1;\nUART_HandleTypeDef hlpuart1;\n\nuint8_t rxData;\n\nvoid SystemClock_Config(void);\nvoid MX_FREERTOS_Init(void);\n\nint main(void)\n{\n\n  HAL_Init();\n  SystemClock_Config();\n\n  MX_GPIO_Init();\n  MX_DMA_Init();\n  MX_LPUART1_UART_Init();\n  MX_SPI2_Init();\n  MX_TIM15_Init();\n\n  MX_FREERTOS_Init();\n\n  osKernelStart();\n\n    while (1){\n\n    }\n\n}\n\n/** System Clock Configuration*/\nvoid SystemClock_Config(void)\n{\n\n  RCC_OscInitTypeDef RCC_OscInitStruct;\n  RCC_ClkInitTypeDef RCC_ClkInitStruct;\n  RCC_PeriphCLKInitTypeDef PeriphClkInit;\n\n    /**Initializes the CPU, AHB and APB busses clocks \n    */\n  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;\n  RCC_OscInitStruct.HSEState = RCC_HSE_ON;\n  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;\n  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;\n  RCC_OscInitStruct.PLL.PLLN = 20;\n  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV7;\n  RCC_OscInitStruct.PLL.PLLQ = RCC_PLLQ_DIV2;\n  RCC_OscInitStruct.PLL.PLLR = RCC_PLLR_DIV2;\n  if (HAL_RCC_OscConfig(&amp;RCC_OscInitStruct) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n    /**Initializes the CPU, AHB and APB busses clocks \n    */\n  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK\n                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;\n  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;\n  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;\n  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;\n  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;\n\n  if (HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_3) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n  PeriphClkInit.PeriphClockSelection = RCC_PERIPHCLK_LPUART1;\n  PeriphClkInit.Lpuart1ClockSelection = RCC_LPUART1CLKSOURCE_PCLK1;\n  if (HAL_RCCEx_PeriphCLKConfig(&amp;PeriphClkInit) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n    /**Configure the main internal regulator output voltage \n    */\n  if (HAL_PWREx_ControlVoltageScaling(PWR_REGULATOR_VOLTAGE_SCALE1) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n    /**Configure the Systick interrupt time \n    */\n  HAL_SYSTICK_Config(HAL_RCC_GetHCLKFreq()/1000);\n\n    /**Configure the Systick \n    */\n  HAL_SYSTICK_CLKSourceConfig(SYSTICK_CLKSOURCE_HCLK);\n\n  /* SysTick_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(SysTick_IRQn, 15, 0);\n}\n\nvoid HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)\n{\n  if (htim-&gt;Instance == TIM1) {\n    HAL_IncTick();\n  }\n}\n\nvoid _Error_Handler(char * file, int line)\n{\n    while(1)\n    {\n    }\n}\n\n#ifdef USE_FULL_ASSERT\n\nvoid assert_failed(uint8_t* file, uint32_t line)\n{\n\n}\n\n#endif\n</code></pre>\n\n<p>usart.c</p>\n\n<pre><code>#include \"usart.h\"\n\n#include \"gpio.h\"\n#include \"dma.h\"\n\n/* USER CODE BEGIN 0 */\n#include \"cmsis_os.h\"\n#include \"string.h\"\n\nuint8_t Uart1RxBuf [UART3_RX_TRAMA_LONG];\nuint8_t RxBuffer;\nuint8_t rxData;\n/* USER CODE END 0 */\n\nUART_HandleTypeDef hlpuart1;\nDMA_HandleTypeDef hdma_lpuart_rx;\nDMA_HandleTypeDef hdma_lpuart_tx;\n\n/* LPUART1 init function */\n\nvoid MX_LPUART1_UART_Init(void)\n{\n\n  hlpuart1.Instance = LPUART1;\n  hlpuart1.Init.BaudRate = 115200;\n  hlpuart1.Init.WordLength = UART_WORDLENGTH_8B;\n  hlpuart1.Init.StopBits = UART_STOPBITS_1;\n  hlpuart1.Init.Parity = UART_PARITY_NONE;\n  hlpuart1.Init.Mode = UART_MODE_TX_RX;\n  hlpuart1.Init.HwFlowCtl = UART_HWCONTROL_NONE;\n  hlpuart1.Init.OneBitSampling = UART_ONE_BIT_SAMPLE_DISABLE;\n  hlpuart1.AdvancedInit.AdvFeatureInit = UART_ADVFEATURE_NO_INIT;\n  if (HAL_UART_Init(&amp;hlpuart1) != HAL_OK)\n  {\n    _Error_Handler(__FILE__, __LINE__);\n  }\n\n}\n\nvoid HAL_UART_MspInit(UART_HandleTypeDef* uartHandle)\n{\n\n  GPIO_InitTypeDef GPIO_InitStruct;\n  if(uartHandle-&gt;Instance==LPUART1)\n  {\n    __HAL_RCC_LPUART1_CLK_ENABLE();\n    GPIO_InitStruct.Pin = GPIO_PIN_0|GPIO_PIN_1;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_PULLUP;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF8_LPUART1;\n    HAL_GPIO_Init(GPIOC, &amp;GPIO_InitStruct);\n\n    hdma_lpuart_rx.Instance = DMA2_Channel7;\n    hdma_lpuart_rx.Init.Request = DMA_REQUEST_4;\n    hdma_lpuart_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;\n    hdma_lpuart_rx.Init.PeriphInc = DMA_PINC_DISABLE;\n    hdma_lpuart_rx.Init.MemInc = DMA_MINC_ENABLE;\n    hdma_lpuart_rx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;\n    hdma_lpuart_rx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;\n    hdma_lpuart_rx.Init.Mode = DMA_NORMAL;\n    hdma_lpuart_rx.Init.Priority = DMA_PRIORITY_LOW;\n    if (HAL_DMA_Init(&amp;hdma_lpuart_rx) != HAL_OK)\n    {\n      _Error_Handler(__FILE__, __LINE__);\n    }\n\n    __HAL_LINKDMA(uartHandle,hdmarx,hdma_lpuart_rx);\n\n    /* LPUART_TX Init */\n    hdma_lpuart_tx.Instance = DMA2_Channel6;\n    hdma_lpuart_tx.Init.Request = DMA_REQUEST_4;\n    hdma_lpuart_tx.Init.Direction = DMA_MEMORY_TO_PERIPH;\n    hdma_lpuart_tx.Init.PeriphInc = DMA_PINC_DISABLE;\n    hdma_lpuart_tx.Init.MemInc = DMA_MINC_ENABLE;\n    hdma_lpuart_tx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;\n    hdma_lpuart_tx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;\n    hdma_lpuart_tx.Init.Mode = DMA_NORMAL;\n    hdma_lpuart_tx.Init.Priority = DMA_PRIORITY_LOW;\n    if (HAL_DMA_Init(&amp;hdma_lpuart_tx) != HAL_OK)\n    {\n      _Error_Handler(__FILE__, __LINE__);\n    }\n\n    __HAL_LINKDMA(uartHandle,hdmatx,hdma_lpuart_tx);\n\n    /* LPUART1 interrupt Init */\n    HAL_NVIC_SetPriority(LPUART1_IRQn, 5, 0);\n    HAL_NVIC_EnableIRQ(LPUART1_IRQn);\n  /* USER CODE BEGIN LPUART1_MspInit 1 */\n        uartTaskStatus = INIT;\n\n        HAL_UART_Receive_DMA(&amp;hlpuart1,&amp;rxData,1);\n  /* USER CODE END LPUART1_MspInit 1 */\n  }\n}\n\nvoid HAL_UART_MspDeInit(UART_HandleTypeDef* uartHandle)\n{\n\n  if(uartHandle-&gt;Instance==LPUART1)\n  {\n    __HAL_RCC_LPUART1_CLK_DISABLE();\n    HAL_GPIO_DeInit(GPIOC, GPIO_PIN_0|GPIO_PIN_1);\n    HAL_DMA_DeInit(uartHandle-&gt;hdmarx);\n    HAL_DMA_DeInit(uartHandle-&gt;hdmatx);\n    HAL_NVIC_DisableIRQ(LPUART1_IRQn);\n\n  }\n} \n\nvoid HAL_UART_RxCpltCallback(UART_HandleTypeDef *UartHandle)\n{\n    if(UartHandle -&gt; Instance == hlpuart1.Instance){\n        HAL_UART_Transmit_DMA(&amp;hlpuart1,&amp;rxData,1);\n    }\n}\n\nvoid uartPrint(UART_HandleTypeDef *huart, char _out[]){\n    HAL_UART_Transmit_DMA(huart, (uint8_t *) _out, strlen(_out));\n}\n\nvoid UartTask(void const *argument){\n    char inBuffer[8];\n    for(;;){\n        switch(uartTaskStatus){\n        case ERR:\n            break;\n        case INIT:\n            uartPrint(&amp;hlpuart1,\"Uart Init: \\r\\n\");\n            uartTaskStatus = READ;\n            break;\n        case READ:\n            break;\n        }\n        osDelay(100);\n    }\n}\n</code></pre>\n\n<p>I'm not using yet the uart task, but here is where I create the task at freertos.c</p>\n\n<pre><code>osThreadDef(uartTask, UartTask, osPriorityNormal, 0, 128);\nuartTaskHandle = osThreadCreate(osThread(uartTask), NULL);\n</code></pre>\n\n<p>The <code>Uart Init:</code> appears on my terminal.</p>\n\n<p>When I debug, program never reaches the <code>HAL_UART_RxCpltCallback</code>.</p>\n\n<p>Thanks!</p>\n\n<p>EDIT 1: </p>\n\n<p>DMA init!</p>\n\n<pre><code>void MX_DMA_Init(void) \n{\n  /* DMA controller clock enable */\n  __HAL_RCC_DMA2_CLK_ENABLE();\n  __HAL_RCC_DMA1_CLK_ENABLE();\n\n  /* DMA interrupt init */\n  /* DMA1_Channel5_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(DMA1_Channel5_IRQn, 5, 0);\n  HAL_NVIC_EnableIRQ(DMA1_Channel5_IRQn);\n  /* DMA2_Channel6_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(DMA2_Channel6_IRQn, 5, 0);\n  HAL_NVIC_EnableIRQ(DMA2_Channel6_IRQn);\n  /* DMA2_Channel7_IRQn interrupt configuration */\n  HAL_NVIC_SetPriority(DMA2_Channel7_IRQn, 5, 0);\n  HAL_NVIC_EnableIRQ(DMA2_Channel7_IRQn);\n\n}\n</code></pre>\n"}, {"tags": ["c", "file", "file-handling", "tdm-gcc"], "comments": [{"owner": {"reputation": 995, "user_id": 2679327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9Gmc3.png?s=128&g=1", "display_name": "Milack27", "link": "https://stackoverflow.com/users/2679327/milack27"}, "edited": false, "score": 0, "creation_date": 1508344521, "post_id": 46814809, "comment_id": 80577469, "body": "I think you mean <code>printf(&quot;%c&quot;, c)</code>, that&#39;s why you&#39;re getting a lot of h&#39;s in the output."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1508344666, "post_id": 46814809, "comment_id": 80577541, "body": "The first problem is that you didn&#39;t post the full code. Don&#39;t make us guess if you want a good answer."}, {"owner": {"reputation": 189, "user_id": 5589613, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b66b33e107406846b8d989322b1ff42?s=128&d=identicon&r=PG&f=1", "display_name": "Sarthak Mehra", "link": "https://stackoverflow.com/users/5589613/sarthak-mehra"}, "edited": false, "score": 0, "creation_date": 1508345140, "post_id": 46814809, "comment_id": 80577791, "body": "I posted the part of the code which was relevant for the above problem.Posting the full code will just distract focus from the actual problem and mess things up."}, {"owner": {"reputation": 189, "user_id": 5589613, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b66b33e107406846b8d989322b1ff42?s=128&d=identicon&r=PG&f=1", "display_name": "Sarthak Mehra", "link": "https://stackoverflow.com/users/5589613/sarthak-mehra"}, "edited": false, "score": 0, "creation_date": 1508345609, "post_id": 46814809, "comment_id": 80578061, "body": "writing printf(&quot;%c&quot;,c) helped.It was my bad."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1508345434, "post_id": 46815073, "comment_id": 80577963, "body": "You must check the return value of <code>fgets()</code>. You should avoid infinite loops; test <code>fgets()</code> in the first loop condition, and the result of the assignment and comparison in the second."}, {"owner": {"reputation": 189, "user_id": 5589613, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b66b33e107406846b8d989322b1ff42?s=128&d=identicon&r=PG&f=1", "display_name": "Sarthak Mehra", "link": "https://stackoverflow.com/users/5589613/sarthak-mehra"}, "edited": false, "score": 0, "creation_date": 1508345782, "post_id": 46815073, "comment_id": 80578151, "body": "closing and opening the file helped.I had forgotten that writing to file moves pointer down till the last write location.This explains why I was getting so many &#39;h&#39;."}, {"owner": {"reputation": 189, "user_id": 5589613, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b66b33e107406846b8d989322b1ff42?s=128&d=identicon&r=PG&f=1", "display_name": "Sarthak Mehra", "link": "https://stackoverflow.com/users/5589613/sarthak-mehra"}, "edited": false, "score": 0, "creation_date": 1508346264, "post_id": 46815073, "comment_id": 80578384, "body": "Can you tell why you used int type in c?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 189, "user_id": 5589613, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b66b33e107406846b8d989322b1ff42?s=128&d=identicon&r=PG&f=1", "display_name": "Sarthak Mehra", "link": "https://stackoverflow.com/users/5589613/sarthak-mehra"}, "edited": false, "score": 0, "creation_date": 1508360380, "post_id": 46815073, "comment_id": 80585625, "body": "@SarthakMehra - <code>fgetc</code> returns an int - see <a href=\"http://man7.org/linux/man-pages/man3/fgetc.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/fgetc.3.html</a> - the reason is that EOF is a negative value."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1508344512, "creation_date": 1508344512, "answer_id": 46815073, "question_id": 46814809, "link": "https://stackoverflow.com/questions/46814809/incorrect-output-from-file/46815073#46815073", "title": "Incorrect output from file", "body": "<p>I see two problems</p>\n\n<p>1) Your <code>fgetc</code> assigns to a char point. That is wrong. It shall be an int</p>\n\n<p>2) After writing the file, you should close it and then open it for reading</p>\n\n<p>Something like:</p>\n\n<pre><code>  fp=fopen(\"user1\",\"w+\");\n  char line[1000];\n  int c;             // notice ......\n\n  //write on file    \n  while(1)\n  {\n      fgets(line,sizeof(line),stdin);\n      if(strcmp(line,\":wq\\n\")==0)   //input ends when user enters :wq\n          break;\n      fputs(line,fp);\n  }\n  fclose(fp);\n\n\n  //read from file\n  fp=fopen(\"user1\",\"r\");\n  while(1)\n  {\n      c=fgetc(fp);\n      if(c==EOF)\n          break;\n      printf(\"%ch\",c);\n  }\n  fclose(fp);\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 5589613, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4b66b33e107406846b8d989322b1ff42?s=128&d=identicon&r=PG&f=1", "display_name": "Sarthak Mehra", "link": "https://stackoverflow.com/users/5589613/sarthak-mehra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 46815073, "answer_count": 1, "score": -1, "last_activity_date": 1508344512, "creation_date": 1508343660, "last_edit_date": 1508344074, "question_id": 46814809, "link": "https://stackoverflow.com/questions/46814809/incorrect-output-from-file", "title": "Incorrect output from file", "body": "<p>I am trying to input some data into a file and then read and print it on the console.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>  fp=fopen(\"user1\",\"w+\");\n  char line[1000];\n  char *c;\n  //write on file\n\n  while(1)\n  {\n      fgets(line,sizeof(line),stdin);\n      if(strcmp(line,\":wq\\n\")==0)   //input ends when user enters :wq\n          break;\n      else\n          fputs(line,fp);\n  }\n  //read from file\n  fflush(stdin);\n\n  while(1)\n  {\n      c=fgetc(fp);\n      if(c==EOF)\n          break;\n      else\n          printf(\"%ch\",c);\n   }\n</code></pre>\n\n<p>I input the data as</p>\n\n<p>bjsa</p>\n\n<p>:wq</p>\n\n<p>The output:</p>\n\n<pre><code> h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h  h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h \n</code></pre>\n\n<p>What is the problem?</p>\n"}, {"tags": ["c++", "c", "printf", "format-specifiers"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1508341931, "post_id": 46814308, "comment_id": 80575890, "body": "Have you looked at <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">the documentation</a>?"}, {"owner": {"reputation": 159018, "user_id": 57428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e2cef525cef5d7b0078f33b707e30c69?s=128&d=identicon&r=PG", "display_name": "sharptooth", "link": "https://stackoverflow.com/users/57428/sharptooth"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 3, "creation_date": 1508342033, "post_id": 46814308, "comment_id": 80575963, "body": "@Kevin Yes, sure, and I&#39;m looking for a catch."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 4, "creation_date": 1508342200, "post_id": 46814308, "comment_id": 80576057, "body": "Well <code>x</code>/<code>X</code> and <code>u</code> (and <code>o</code>) all have the same types for each width specifier. Isn&#39;t that what you&#39;re asking?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1508342514, "post_id": 46814308, "comment_id": 80576298, "body": "There&#39;s no catch. (And the same is true of <code>e</code>, <code>f</code> and <code>g</code> format specifiers: a given datum can be presented in different ways.)"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1508342995, "post_id": 46814308, "comment_id": 80576597, "body": "<code>o</code>, <code>u</code>, <code>x</code>, and <code>X</code> all expect the same argument type for a given width specifier."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1508343405, "last_edit_date": 1508343405, "creation_date": 1508342988, "answer_id": 46814630, "question_id": 46814308, "link": "https://stackoverflow.com/questions/46814308/are-x-and-u-printf-scanf-conversion-specifiers-equally-applicable-to-the-sam/46814630#46814630", "title": "Are &quot;x&quot; and &quot;u&quot; printf/scanf conversion specifiers equally applicable to the same types?", "body": "<blockquote>\n  <p>Is it true than no matter if it ends in <code>x</code> or in <code>u</code> with the same width specifier in front I can pass values of the same time and it'll always be legal?</p>\n</blockquote>\n\n<p>Yes, if a width specifier is valid for use with one of those then it is valid for use with both, and also with <code>o</code> and <code>X</code>, and the resulting directives serve the same data type -- an unsigned integer of the specified width.  The only difference is the way the output is formatted (or for <code>scanf</code>, the format that is expected of the input).</p>\n\n<blockquote>\n  <p>There's a whole bunch of width specifiers (<code>h</code>, <code>hh</code>, <code>L</code>, <code>I</code>, etc) and looks\n  like each of them can be used with both u and x conversion specifier\n  but each time I'm allowed to pass values of unsigned type of the right\n  width.</p>\n</blockquote>\n\n<p>There indeed is a wide variety of width specifiers.  Most, but not all, of them are applicable to and intended for integer types, both the unsigned ones corresponding to <code>x</code>, <code>X</code>, <code>o</code>, and <code>u</code> and the signed ones corresponding to <code>d</code> and <code>i</code>.  The standard does not specify <code>L</code> among those, however, and it does not specify <code>I</code> at all.  Some implementations might nevertheless accept those as integer width specifiers, with implementation-specific behavior.</p>\n"}], "owner": {"reputation": 159018, "user_id": 57428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e2cef525cef5d7b0078f33b707e30c69?s=128&d=identicon&r=PG", "display_name": "sharptooth", "link": "https://stackoverflow.com/users/57428/sharptooth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 46814630, "answer_count": 1, "score": 3, "last_activity_date": 1508343405, "creation_date": 1508341866, "question_id": 46814308, "link": "https://stackoverflow.com/questions/46814308/are-x-and-u-printf-scanf-conversion-specifiers-equally-applicable-to-the-sam", "title": "Are &quot;x&quot; and &quot;u&quot; printf/scanf conversion specifiers equally applicable to the same types?", "body": "<p>Suppose I have</p>\n\n<pre><code>printf(\"%llu %llx\", one, two);\n</code></pre>\n\n<p>and then both <code>one</code> and <code>two</code> can be of type <code>unsigned long long</code> and the difference will be just that they are printed as decimal or hexadecimal respectively.</p>\n\n<p>There's a whole bunch of width specifiers (<code>h</code>, <code>hh</code>, <code>L</code>, <code>I</code>, etc) and looks like each of them can be used with both <code>u</code> and <code>x</code> conversion specifier but each time I'm allowed to pass values of unsigned type of the right width.</p>\n\n<p>Is it true than no matter if it ends in <code>x</code> or in <code>u</code> with the same width specifier in front I can pass values of the same time and it'll always be legal?</p>\n"}, {"tags": ["c", "strcpy"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 2, "creation_date": 1508341658, "post_id": 46814219, "comment_id": 80575682, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Not many people will want to look through all of your code to find your mistake."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1508341705, "post_id": 46814219, "comment_id": 80575714, "body": "tl;dr Are you sure you have enough space allocated for all the strings?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1508342465, "post_id": 46814219, "comment_id": 80576257, "body": "Not related to your problem, but using structs and arrays you can probably reduce the size of your program at least by a factor 4."}, {"owner": {"reputation": 3, "user_id": 8796409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c155f0eca9198eedc6f4bb8cd241357a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Ty", "link": "https://stackoverflow.com/users/8796409/adrian-ty"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1508364361, "post_id": 46814219, "comment_id": 80587461, "body": "@Kevin Noted, sorry for the trouble, it&#39;s my first time here, and my upperclassmen suggested this site to me. Thanks!"}, {"owner": {"reputation": 3, "user_id": 8796409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c155f0eca9198eedc6f4bb8cd241357a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Ty", "link": "https://stackoverflow.com/users/8796409/adrian-ty"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1508364566, "post_id": 46814219, "comment_id": 80587545, "body": "@Michael Walz  He&#39;s not covering structs in this term, so he probably knows we could make the machine project work without them :("}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8796409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c155f0eca9198eedc6f4bb8cd241357a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Ty", "link": "https://stackoverflow.com/users/8796409/adrian-ty"}, "edited": false, "score": 0, "creation_date": 1508364027, "post_id": 46814385, "comment_id": 80587336, "body": "Oh, that makes more sense. I&#39;ve ran past by that define string length but I didn&#39;t understand and realize and it&#39;s implications. Programming sure is a lot of work hahaha. Now I just need to figure out why 5 is printing out as 69."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1508342651, "last_edit_date": 1508342651, "creation_date": 1508342171, "answer_id": 46814385, "question_id": 46814219, "link": "https://stackoverflow.com/questions/46814219/multiple-consecutive-strcpy-display-contains-bits-of-every-next-strcpy/46814385#46814385", "title": "Multiple consecutive strcpy(), display contains bits of every next strcpy()", "body": "<p>These 2 lines show what's going wrong:</p>\n\n<p>Following line declares an array of char <code>cP1_Move2_Name</code> initialized with \"POUND\". The size of this array is exactly 6 bytes, that is the 5 characters from \"POUND\" plus one for the NUL terminator (strings are terminated by a NUL character, read the chapter dealing with string in your C textbook for more details):</p>\n\n<pre><code>char cP1_Move2_Name[] = \"POUND\";\n</code></pre>\n\n<p>Now in following line you copy \"EARTHQUAKE\" into the array <code>cP1_Move2_Name</code>. For \"EARTHQUAKE\" you need 11 bytes, but as mentioned before, the size of the <code>cP1_Move2_Name</code> array is only 6.</p>\n\n<pre><code>strcpy(cP1_Move2_Name,\"EARTHQUAKE\");\n</code></pre>\n\n<p>So what happens is that more bytes are copied than there is space, so some other memory will be overwritten and you may experience all sorts of problems.</p>\n\n<p>In order to correct the program you can declare your array with a predetermined maximum size in order to make sure that there will be always enough space.</p>\n\n<pre><code>#define MAXSTRINGLENGTH 100\n...\nchar cP1_Pokemon_Name[MAXSTRINGLENGTH] = \"POKEMON\";\nchar cP1_Move1_Name[MAXSTRINGLENGTH] = \"TACKLE\";\nchar cP1_Move2_Name[MAXSTRINGLENGTH] = \"POUND\";\n...\netc.\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8796409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c155f0eca9198eedc6f4bb8cd241357a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Ty", "link": "https://stackoverflow.com/users/8796409/adrian-ty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 46814385, "answer_count": 1, "score": -1, "last_activity_date": 1509254376, "creation_date": 1508341516, "last_edit_date": 1509254376, "question_id": 46814219, "link": "https://stackoverflow.com/questions/46814219/multiple-consecutive-strcpy-display-contains-bits-of-every-next-strcpy", "title": "Multiple consecutive strcpy(), display contains bits of every next strcpy()", "body": "<p>This has been answered, thanks for all the help.</p>\n"}, {"tags": ["c++", "c", "plugins", "opencl", "openfx"], "comments": [{"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1508345326, "post_id": 46813907, "comment_id": 80577906, "body": "cl::Context instance has a <code>.getInfo()</code> that can be useful to get necessary info (maybe with <code>CL_CONTEXT_DEVICES</code>) to rebuild a clone."}, {"owner": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1516645676, "post_id": 46813907, "comment_id": 83763649, "body": "Did you manage to figure this out? The retain function is protected so i cant use the approach below"}, {"owner": {"reputation": 299, "user_id": 350301, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/2Q58p.jpg?s=128&g=1", "display_name": "Nick C", "link": "https://stackoverflow.com/users/350301/nick-c"}, "edited": false, "score": 0, "creation_date": 1516701137, "post_id": 46813907, "comment_id": 83785141, "body": "Yes - as @Dithermaster says in his comment, you need to use clRetainContext()"}], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1516645572, "post_id": 46820535, "comment_id": 83763581, "body": "Hey you didn&#39;t answer the question. So how exactly do I do it, it cannot be done? For example Caffe uses the old API, but if we want to get a cl_context from caffe and use it in our API which uses cl::Context, its not possible? Retain is protected"}, {"owner": {"reputation": 5977, "user_id": 1745695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b932c5253c45af61dc443fbc1b9c935c?s=128&d=identicon&r=PG", "display_name": "Dithermaster", "link": "https://stackoverflow.com/users/1745695/dithermaster"}, "reply_to_user": {"reputation": 1843, "user_id": 1436508, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh3.googleusercontent.com/-p4GumfwGZus/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i9vW1oPm_00XtAVO06i_X9sWp2sA/mo/photo.jpg?sz=128", "display_name": "raaj", "link": "https://stackoverflow.com/users/1436508/raaj"}, "edited": false, "score": 0, "creation_date": 1516658965, "post_id": 46820535, "comment_id": 83770070, "body": "You can create a Context object from your <code>cl_context</code> handle (there&#39;s a constructor for that, enabled by __CL_EXPLICIT_CONSTRUCTORS), or you can use the assignment operator to assign your <code>cl_context</code> handle to a Context object. The Context object now &quot;owns&quot; that context and will release it when it goes out of scope. If you still want to use your cl_context handle, then after creating or assigning the Context object, also call <code>clRetainContext</code> on the handle (which offsets the release done in the object&#39;s destructor). It&#39;s all the same <code>cl_content</code> regardless of C or C++ API."}], "tags": [], "owner": {"reputation": 5977, "user_id": 1745695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b932c5253c45af61dc443fbc1b9c935c?s=128&d=identicon&r=PG", "display_name": "Dithermaster", "link": "https://stackoverflow.com/users/1745695/dithermaster"}, "is_accepted": true, "score": 3, "last_activity_date": 1508368080, "creation_date": 1508368080, "answer_id": 46820535, "question_id": 46813907, "link": "https://stackoverflow.com/questions/46813907/create-opencl-context-from-cl-context-without-taking-ownership/46820535#46820535", "title": "Create OpenCL Context from cl_context without taking ownership", "body": "<p>Fortunately you can inspect the OpenCL C++ header to see exactly what it does (at the bottom it just makes C API calls), and you can step into the code to verify it. When working with both C and C++ API, you must be careful about the OpenCL object retain/release counts, in particular if the C++ constructor doesn't retain but the destructor does release, then you have a problem (because you'd be releasing the host's context out from under them). However, it is easily fixed because you can just call retain yourself on the object after constructing to balance things out. I've mixed C API and C++ API in OpenCL and it was the retain/release philosophy of the C++ header that got me too, so I feel your pain. Curious, is the OpenFX host Resolve, Vegas, Catalyst, or something else? There's a unified OpenCL extension on the way for OpenFX.</p>\n"}], "owner": {"reputation": 299, "user_id": 350301, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/2Q58p.jpg?s=128&g=1", "display_name": "Nick C", "link": "https://stackoverflow.com/users/350301/nick-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 46820535, "answer_count": 1, "score": 2, "last_activity_date": 1508368080, "creation_date": 1508340609, "question_id": 46813907, "link": "https://stackoverflow.com/questions/46813907/create-opencl-context-from-cl-context-without-taking-ownership", "title": "Create OpenCL Context from cl_context without taking ownership", "body": "<p>I'm creating an OpenFX plugin to do some image processing for a VR system.</p>\n\n<p>As both our existing processing code, and the host the plugin is intended for, are based on OpenCL, the host developers have given me an extension to OFX to share the OpenCL environment.</p>\n\n<p>However - our code uses the C++ API (cl::Context), and the extension they've provided gives me a pointer to a C cl_context.</p>\n\n<p>Is there any way for me to create a cl::Context from a cl_context, without taking ownership of the latter? (and the same for the cl::CommandQueue from cl_command_queue). The API docs online suggest that both the copy constructor and assignment operator take ownership.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508339496, "post_id": 46813457, "comment_id": 80574120, "body": "What was your original thought process? How did you come to the conclusion that it would print <code>25</code>?"}, {"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 2, "creation_date": 1508340108, "post_id": 46813457, "comment_id": 80574542, "body": "@BenjiSzwimer It&#39;s nothing to do with the order things are done in - you were right, they&#39;re done top-bottom."}, {"owner": {"reputation": 86, "user_id": 6044264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2d52296c121703ff0ec78ea27c0dea?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Fighter", "link": "https://stackoverflow.com/users/6044264/phil-fighter"}, "edited": false, "score": 2, "creation_date": 1508340138, "post_id": 46813457, "comment_id": 80574567, "body": "It is executed from top to bottom. But with <code>p2 = p1</code> both pointers point to the same adress with the same value. It does not matter with which pointer do you change the memory. From that line on <code>p1</code> an <code>p2</code> always point to the same value."}, {"owner": {"reputation": 13, "user_id": 8777267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213186701718457/picture?type=large", "display_name": "Benji Szwimer", "link": "https://stackoverflow.com/users/8777267/benji-szwimer"}, "edited": false, "score": 0, "creation_date": 1508340195, "post_id": 46813457, "comment_id": 80574610, "body": "ya I understand now thanks Steve"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1508340569, "post_id": 46813457, "comment_id": 80574880, "body": "@Benji Szwimer: But it <i>does</i> execute top to bottom! Yet I don&#39;t understand how did top to bottom execution lead you to conclude that it would print <code>25</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8777267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213186701718457/picture?type=large", "display_name": "Benji Szwimer", "link": "https://stackoverflow.com/users/8777267/benji-szwimer"}, "edited": false, "score": 0, "creation_date": 1508339564, "post_id": 46813506, "comment_id": 80574168, "body": "thanks but when it is written *p1=25 doesn&#39;t p1 now point the 25 and no longer a?"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1508339839, "post_id": 46813506, "comment_id": 80574360, "body": "<code>*pi = 25</code> changes the value at the address <code>p1</code> points to (in this case <code>a</code>). It doesn&#39;t change the value of <code>p1</code>. That is, it doesn&#39;t change <code>p1</code> to point somewhere else. <code>25</code> is just a value and has no address, thus <i>point to 25</i> doesn&#39;t really make sense."}], "tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1508339376, "creation_date": 1508339376, "answer_id": 46813506, "question_id": 46813457, "link": "https://stackoverflow.com/questions/46813457/pointer-variables-in-c/46813506#46813506", "title": "Pointer Variables in C", "body": "<p>The output is 12 because <code>p1</code> and <code>p2</code> point to the same memory location (the variable <code>a</code>), so when you assign 12 to <code>*p2</code> it changes the value of <code>a</code>, which <code>p1</code> also happens to point to.</p>\n\n<p>I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "is_accepted": false, "score": 2, "last_activity_date": 1508339838, "last_edit_date": 1508339838, "creation_date": 1508339428, "answer_id": 46813524, "question_id": 46813457, "link": "https://stackoverflow.com/questions/46813457/pointer-variables-in-c/46813524#46813524", "title": "Pointer Variables in C", "body": "<p>Because both <code>p1</code> and <code>p2</code> are pointers, and you do this:</p>\n\n<pre><code>p2 = p1;\n</code></pre>\n\n<p>This means that <code>p2</code> points to the same place as <code>p1</code> and vice versa. You subsequently do this:</p>\n\n<pre><code>*p2 = 12;\n</code></pre>\n\n<p>This sets <code>*p2</code> to be 12, but because <code>p1</code> points to the same place as <code>p2</code>, <code>*p1</code> will also now equal 12;</p>\n\n<p>When the pointers are pointing at the same thing, you've created an <strong>alias</strong>. You can access the same data through two different names.</p>\n"}, {"tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": true, "score": 7, "last_activity_date": 1508342052, "last_edit_date": 1508342052, "creation_date": 1508339513, "answer_id": 46813553, "question_id": 46813457, "link": "https://stackoverflow.com/questions/46813457/pointer-variables-in-c/46813553#46813553", "title": "Pointer Variables in C", "body": "<p>Let's break it down:</p>\n\n<pre><code>int a = 10, *p1, *p2;  // nothing special\np1 = &amp;a;               // p1 now holds the address of a. printf(\"%d\", *p1) would print 10, as it is the current value of a.\n\n// in this point, printf(\"%d-%d\", *p1,a); would print 10-10 (printf(\"%d\",*p2); is UB as p2 is uninitialized)\n\n*p1 = 25;              // remember that p1 = &amp;a, meaning that now a = 25. Basically you changed (the variable) a, using a pointer instead of changing it directly.\np2 = p1;               // p2 now holds the value of p1, meaning it too points to a\n\n// in this point, printf(\"%d-%d-%d\", *p1,*p2,a); would print 25-25-25\n\n*p2 = 12;              // *p2 = 12, and so does *p1, and so does a\n\n// in this point, printf(\"%d-%d-%d\", *p1,*p2,a); would print 12-12-12\n\n printf(\"%d\", *p1);\n</code></pre>\n\n<p>You should remember that <code>a</code> is an <code>int</code> that holds an integer value, and <code>p1,p2</code> are <code>int *</code> that hold the address of an <code>int</code>. After <code>p1 = &amp;a</code>, every change to <code>a</code> would mean that <code>*p1</code> is changed too, since <code>*p1</code> is actually <code>*(&amp;a)</code> [<em>which is...</em><code>a</code>]. After <code>p2 = p1</code>, the same holds for <code>p2</code>.</p>\n\n<hr>\n\n<blockquote>\n  <p>I thought originally that code in general executes from top to bottom. </p>\n</blockquote>\n\n<p>Well, it does :)</p>\n"}, {"comments": [{"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1508340115, "post_id": 46813592, "comment_id": 80574552, "body": "This is in my opinion the best answer here. These memory diagrams make it clear! Maybe it would be better to remove the comments after <code>=&gt;</code> - the diagrams should be clear enough without the text (especially that the text is long-winded and has spelling errors)."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1508340377, "post_id": 46813592, "comment_id": 80574733, "body": "BTW when visualizing address values, it&#39;s customary to start the addresses at large numbers, like 1000, 1001, 1002 etc so their values won&#39;t be confused with data. It&#39;s less important here, since data values are large (10, 12 and 25)."}], "tags": [], "owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "is_accepted": false, "score": 5, "last_activity_date": 1508395097, "last_edit_date": 1508395097, "creation_date": 1508339668, "answer_id": 46813592, "question_id": 46813457, "link": "https://stackoverflow.com/questions/46813457/pointer-variables-in-c/46813592#46813592", "title": "Pointer Variables in C", "body": "<p><em>Address values used here is totally arbitrary, just for example</em></p>\n\n<pre><code>int a = 10, *p1, *p2;\n</code></pre>\n\n<p>the previous line declare one variable of type <code>int</code> (<code>a</code>) and two pointers to <code>int</code> (<code>p1</code> and <code>p2</code>)</p>\n\n<p>memory after the previous line </p>\n\n<pre><code>address | memory | variable\n1050    | 10     | a\n1054    | xxx    | p1\n1058    | xxx    | p2\n</code></pre>\n\n<hr>\n\n<pre><code>p1 = &amp;a; // &amp;a is address of a, ie here, 1050\n</code></pre>\n\n<p>memory after the previous line </p>\n\n<pre><code>address | memory | variable\n1050    | 10     | a\n1054    | 1050   | p1 \n1058    | xxx    | p2\n</code></pre>\n\n<ul>\n<li><code>p1</code> stores \"1050\"; <code>*p1</code>, ie value stored at address stored inside <code>p1</code>, is 10</li>\n</ul>\n\n<hr>\n\n<pre><code>*p1 = 25; // *p1 means value stored at address stored inside p1\n</code></pre>\n\n<p>memory after the previous line </p>\n\n<pre><code>address | memory | variable\n1050    | 25     | a\n1054    | 1050   | p1 \n1058    | xxx    | p2\n</code></pre>\n\n<ul>\n<li><code>p1</code> stores \"1050\"; <code>*p1</code>, ie value stored at address stored inside <code>p1</code>, is now 25</li>\n</ul>\n\n<hr>\n\n<pre><code>p2 = p1;\n</code></pre>\n\n<p>memory after the previous line </p>\n\n<pre><code>address | memory | variable\n1050    | 25     | a\n1054    | 1050   | p1 \n1058    | 1050   | p2\n</code></pre>\n\n<ul>\n<li><code>p1</code> stores \"1050\"; <code>*p1</code>, ie value stored at address stored inside <code>p1</code>, is 25</li>\n<li>copy values stored inside <code>p1</code> in <code>p2</code>; so <code>p2</code> points to <code>a</code>, ie stores address \"1050\"</li>\n</ul>\n\n<hr>\n\n<pre><code>*p2 = 12;\n</code></pre>\n\n<p>memory after the previous line </p>\n\n<pre><code>address | memory | variable\n1050    | 12     | a\n1054    | 1050   | p1  \n1058    | 1050   | p2\n</code></pre>\n\n<hr>\n\n<pre><code>printf(\"%d\", *p1); // Print value stored at address stored inside p1\n</code></pre>\n\n<hr>\n\n<p>What we can see here:</p>\n\n<ul>\n<li><code>p1</code> and <code>p2</code> are pointers: they store address of variable</li>\n<li><code>&amp;</code> (like in <code>&amp;a</code>): returns address of a variable</li>\n<li><code>*</code> in declaration (like in <code>int *p1</code>): declare pointer to a variable (here to a <code>int</code> variable)</li>\n<li><code>*</code> in expression (like in <code>*p1 = 25</code>): access to value stored at address stored in pointer</li>\n</ul>\n\n<p>You can see different addresses and values :</p>\n\n<pre><code>printf(\"address of a: %p\\n\", &amp;a);\nprintf(\"address of p1: %p\\n\", &amp;p1);\nprintf(\"address of p2: %p\\n\", &amp;p2);\n\n// address stored inside p1 (ie value stored inside p1)\nprintf(\"address stored inside p1: %p\\n\", p1);\n// address stored inside p2 (ie value stored inside p2)\nprintf(\"address stored inside p2: %p\\n\", p2);\n\nprintf(\"value of a: %d\\n\", a);\nprintf(\"value pointed by p1: %d\\n\", *p1);\nprintf(\"value pointed by p2: %d\\n\", *p2);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37828, "user_id": 1629821, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/861cfc0de6bf99a544b500eac16229eb?s=128&d=identicon&r=PG", "display_name": "Mr.C64", "link": "https://stackoverflow.com/users/1629821/mr-c64"}, "is_accepted": false, "score": 0, "last_activity_date": 1508339920, "creation_date": 1508339920, "answer_id": 46813679, "question_id": 46813457, "link": "https://stackoverflow.com/questions/46813457/pointer-variables-in-c/46813679#46813679", "title": "Pointer Variables in C", "body": "<blockquote>\n<pre><code>*p1 = 25;\n</code></pre>\n</blockquote>\n\n<p>If you printed <code>*p1</code> now, then you'd get 25.</p>\n\n<blockquote>\n<pre><code>p2 = p1;\n</code></pre>\n</blockquote>\n\n<p>Now p2 points to the <em>same</em> location of p1.</p>\n\n<blockquote>\n<pre><code>*p2 = 12;\n</code></pre>\n</blockquote>\n\n<p>Now you write 12 in the integer pointed by p2, which is the <em>same</em> pointed by p1, as per previous <code>p2 = p1</code> assignment.</p>\n\n<p>So, you modified the integer value pointed by p1. And this explains why printing <code>*p1</code> now gives you 12: </p>\n\n<blockquote>\n<pre><code>printf(\"%d\", *p1)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 8777267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213186701718457/picture?type=large", "display_name": "Benji Szwimer", "link": "https://stackoverflow.com/users/8777267/benji-szwimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 46813553, "answer_count": 5, "score": 0, "last_activity_date": 1508395097, "creation_date": 1508339223, "question_id": 46813457, "link": "https://stackoverflow.com/questions/46813457/pointer-variables-in-c", "title": "Pointer Variables in C", "body": "<p>so I just had a quick question, I thought originally that code in general executes from top to bottom. So below I have attached an example in C using pointers and would just like someone to explain to me why the output when printing *p1 is 12 my original thought process was that it would print 25. Thank you </p>\n\n<pre><code>int a = 10, *p1, *p2;\np1 = &amp;a;\n*p1 = 25;\np2 = p1;\n*p2 = 12;\nprintf(\"%d\", *p1);\n</code></pre>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 4, "creation_date": 1508339363, "post_id": 46813453, "comment_id": 80574026, "body": "<code>(user_type!=&#39;c&#39; || user_type!=&#39;a&#39;)</code> will <b>always</b> be true. If <code>user_type==&#39;c&#39;</code>, then it&#39;s true that <code>user_type!=&#39;a&#39;</code>. If <code>user_type==&#39;a&#39;</code>, then it&#39;s true that <code>user_type!=&#39;c&#39;</code>. Thus, one or the other branch of that OR will hold."}, {"owner": {"reputation": 9, "user_id": 8796114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d232b0b605104da7c51584b4e573954?s=128&d=identicon&r=PG&f=1", "display_name": "JakeDan", "link": "https://stackoverflow.com/users/8796114/jakedan"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 1, "creation_date": 1508339601, "post_id": 46813453, "comment_id": 80574200, "body": "@xing oh gosh that just solved everything! Thanks! so sorry for asking such a simple question"}, {"owner": {"reputation": 9, "user_id": 8796114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d232b0b605104da7c51584b4e573954?s=128&d=identicon&r=PG&f=1", "display_name": "JakeDan", "link": "https://stackoverflow.com/users/8796114/jakedan"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1508339703, "post_id": 46813453, "comment_id": 80574263, "body": "@CharlesDuffy yeah it was else before however I changed it, sorry for asking you to solve a flawed logic question, thanks!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1508339714, "post_id": 46813453, "comment_id": 80574271, "body": "Your program does not contain a loop -- though it should -- and in particular, <code>else if</code> does not constitute or create one.  It <i>does</i> call <code>main()</code> recursively, which is responsible for the repetition you see.  That&#39;s permitted, but it&#39;s rarely wise."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1508339917, "post_id": 46813453, "comment_id": 80574412, "body": "You could also  try making <code>main</code> call another function which does the work. You shouldn&#39;t be calling <code>main</code> yourself"}, {"owner": {"reputation": 9, "user_id": 8796114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d232b0b605104da7c51584b4e573954?s=128&d=identicon&r=PG&f=1", "display_name": "JakeDan", "link": "https://stackoverflow.com/users/8796114/jakedan"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1508340494, "post_id": 46813453, "comment_id": 80574821, "body": "@xing in this case do I use the while or do/while in the if?"}], "owner": {"reputation": 9, "user_id": 8796114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d232b0b605104da7c51584b4e573954?s=128&d=identicon&r=PG&f=1", "display_name": "JakeDan", "link": "https://stackoverflow.com/users/8796114/jakedan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1508339707, "answer_count": 0, "score": 0, "last_activity_date": 1508340043, "creation_date": 1508339214, "last_edit_date": 1508340043, "question_id": 46813453, "link": "https://stackoverflow.com/questions/46813453/how-to-exit-else-if-loop-in-c", "closed_reason": "Duplicate", "title": "How to exit else if loop in C", "body": "<p>I have been programming a C program for few days now, however I have met some problems that I am unable to solve.</p>\n\n<p>My code is:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;windows.h&gt;\n\nint main()\n{\n   char user_type;\n   printf(\"Welcome to XYZ Bank\\n\\n\\n\\n\");\n   printf(\"Hint: a for admin and c for customer\\n\");\n   printf(\"Please input your account type (c/a):\");\n   scanf(\"%c\",&amp;user_type);\n   system(\"cls\");\n   if (user_type=='c')\n   {\n       customer_login();\n   }\n   else if (user_type=='a')\n   {\n        admin_login();\n   }\n   else if (user_type!='c' || user_type!='a')\n   {\n       printf(\"Invalid selection is made, the program will restart\");\n       main();\n   }\n}\n</code></pre>\n\n<p>The problem that I faced is when the <code>user_type</code> is not <code>'a'</code> or <code>'c'</code>, the program is supposed to restart the <code>main()</code>, however all it does is to continue printing invalid selection.</p>\n\n<p>Is there some command that allows me to restart <code>main()</code>? or is there a better way to do things? I think that a do while loop can be applied but I am not sure about it.</p>\n\n<p>I am aware that the problem lies in the 3rd statement of my else-if loop, it would be helpful if somebody gave me tips on where to start.</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 77, "user_id": 5615419, "user_type": "registered", "profile_image": "https://graph.facebook.com/917415588327737/picture?type=large", "display_name": "marko", "link": "https://stackoverflow.com/users/5615419/marko"}, "edited": false, "score": 0, "creation_date": 1508338052, "post_id": 46812976, "comment_id": 80573087, "body": "<a href=\"https://stackoverflow.com/questions/10469643/value-returned-by-scanf-function-in-c\" title=\"value returned by scanf function in c\">stackoverflow.com/questions/10469643/&hellip;</a> Hope this can help."}, {"owner": {"reputation": 165, "user_id": 2867342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d371c33253d6bcf1e661d49ef47cd7?s=128&d=identicon&r=PG&f=1", "display_name": "user2867342", "link": "https://stackoverflow.com/users/2867342/user2867342"}, "edited": false, "score": 2, "creation_date": 1508338054, "post_id": 46812976, "comment_id": 80573089, "body": "Did you mean to call scanf twice?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508339985, "post_id": 46812976, "comment_id": 80574461, "body": "&quot;how many inputs were read in my scanf function?&quot; --&gt; How do you want to the user to indicate that input is complete? By entering text and then a <code>&#39;\\n&#39;</code>?  Should input <code>&quot;123\\n&quot;</code> report only 1 number was entered or wait for the next line of input like <code>&quot;456\\n&quot;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1508338346, "last_edit_date": 1508338346, "creation_date": 1508338156, "answer_id": 46813067, "question_id": 46812976, "link": "https://stackoverflow.com/questions/46812976/how-to-properly-validate-how-many-inputs-were-read-in-scanf/46813067#46813067", "title": "How to properly validate how many inputs were read in scanf", "body": "<p>You have two calls of <code>scanf</code> in your code. The result of the first call is ignored, while the result of the second one is checked.</p>\n\n<p>When you enter two numbers, the first <code>scanf</code> returns 2, which your code ignores. After that the call to second <code>scanf</code> tries to read two additional numbers.</p>\n\n<p>You can fix this by removing the first call to <code>scanf</code>:</p>\n\n<pre><code>float numberOne, numberTwo;\nif ( scanf(\"%f %f\", &amp;numberOne, &amp;numberTwo) == 2) {\n    float result = numberOne + numberTwo;\n    printf(\"%f\", result);\n} else {\n    printf(\"invalid input\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508338477, "post_id": 46813096, "comment_id": 80573375, "body": "thanks @melpomene, that makes three points, updated already. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": -1, "last_activity_date": 1508338444, "last_edit_date": 1508338444, "creation_date": 1508338239, "answer_id": 46813096, "question_id": 46812976, "link": "https://stackoverflow.com/questions/46812976/how-to-properly-validate-how-many-inputs-were-read-in-scanf/46813096#46813096", "title": "How to properly validate how many inputs were read in scanf", "body": "<p>You are not using the return value of <code>scanf()</code> in the expected way. It is there to indentify the success / failure in scanning and take a decision based on that.</p>\n\n<p>There are three things you need to do.</p>\n\n<ul>\n<li><p>Remove the two lines</p>\n\n<pre><code>scanf(\"%f %f\", &amp;numberOne, &amp;numberTwo); \nfloat result = numberOne + numberTwo;\n</code></pre>\n\n<p>This is because, without a check, if you try to use the destination variables, there values may be indeterminate in case <code>scanf()</code> fails. Also, there are repeated <code>scanf()</code>s which are plain wrong and not needed.</p></li>\n<li><p>Add the line <code>float result = numberOne + numberTwo;</code> inside the condition block <code>if ( howManyRead == 2)</code>.</p></li>\n<li><p>Remove the <code>&amp;</code> from the <code>printf</code> call: <code>printf(\"%f\", result);</code></p></li>\n</ul>\n"}], "owner": {"reputation": 51, "user_id": 7426918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26828a95df44195a10b6b27b421fff8?s=128&d=identicon&r=PG&f=1", "display_name": "Squidly ", "link": "https://stackoverflow.com/users/7426918/squidly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 46813067, "answer_count": 2, "score": 0, "last_activity_date": 1508338497, "creation_date": 1508337935, "last_edit_date": 1508338497, "question_id": 46812976, "link": "https://stackoverflow.com/questions/46812976/how-to-properly-validate-how-many-inputs-were-read-in-scanf", "title": "How to properly validate how many inputs were read in scanf", "body": "<p>How do i properly see how many inputs were read in my scanf function? when i run the below code it does not display the result, is this because i dont have 2 inputs read from scanf or some other reason\nhere is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n\nint main()\n{\nfloat numberOne;\nfloat numberTwo;\n\nscanf(\"%f %f\", &amp;numberOne, &amp;numberTwo);\nfloat result = numberOne + numberTwo;\n\nint howManyRead = scanf(\"%f %f\", &amp;numberOne, &amp;numberTwo);\n\nif ( howManyRead == 2)\n{\n    printf(\"%f\", &amp;result);\n}   \nelse\n{\n    printf(\"invalid input\");\n}\nsleep(10);\n\n}\n</code></pre>\n"}, {"tags": ["c", "macros", "pc-lint"], "comments": [{"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 3, "creation_date": 1508337794, "post_id": 46812844, "comment_id": 80572913, "body": "It&#39;s not expecting anything, it&#39;s just doing text substitution. If the macro expansion makes sense in the context of where you use it, great. If not, expect things to get confusing. If you want type safety, use a function. The preprocessor is far too dumb for that kind of thing."}, {"owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "reply_to_user": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 0, "creation_date": 1508337813, "post_id": 46812844, "comment_id": 80572925, "body": "@UnholySheep I have a lot of these types of macros. Would prefer to just have macros and was wondering if this was possible"}, {"owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "edited": false, "score": 1, "creation_date": 1508338023, "post_id": 46812844, "comment_id": 80573066, "body": "<code>#define RESULT(x) (((int)(x) &amp; 0x7) &lt;&lt; 11)</code>"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1508338103, "post_id": 46812844, "comment_id": 80573127, "body": "Or  <code>RESULT((int)values)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1508338990, "creation_date": 1508338990, "answer_id": 46813367, "question_id": 46812844, "link": "https://stackoverflow.com/questions/46812844/force-macro-argument-to-certain-type/46813367#46813367", "title": "Force Macro Argument to certain type", "body": "<blockquote>\n  <p>Can a macro like a function force the parameter to be a certain type or is it always just an int.</p>\n</blockquote>\n\n<p>You seem to be misunderstanding the nature of the issue.  It is not the macro invocation itself that pc lint is complaining about.  No conversion whatever is performed by that.  The problem, rather, is with the code to which the macro expands.  The resulting full statement is</p>\n\n<pre><code>    uint32_t temp = (((values) &amp; 0x7) &lt;&lt; 11);\n</code></pre>\n\n<p>, where <code>values</code> is of type <code>TEST_VALUE</code>, an enum.  Evaluating that expression involves converting <code>values</code> to type <code>int</code>, which pc lint considers questionable enough to warrant a warning.  It would issue the same warning if you used the above line directly, instead of generating it via a macro.</p>\n\n<p>Now, you could put an explicit cast into your macro; something like this might be appropriate:</p>\n\n<pre><code>#define RESULT(x)            (((uint32_t)(x) &amp; 0x7) &lt;&lt; 11)\n</code></pre>\n\n<p>That still involves an enum-to-integer conversion, however.  Perhaps pc lint would be satisfied if you express the conversion explicitly like that, but as far as I know, it might still complain.  The underlying reason for the warning is still there: it is questionable to use values of enum type for their integer values instead of for their identities.  If you want named integer constants then declare variables or define macros for them.</p>\n"}], "owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508338990, "creation_date": 1508337596, "question_id": 46812844, "link": "https://stackoverflow.com/questions/46812844/force-macro-argument-to-certain-type", "title": "Force Macro Argument to certain type", "body": "<p>I am running pc lint on my code and I am getting the following warning <code>Converting enum 'TEST_VALUE' to 'int</code>.</p>\n\n<p>Can a macro like a function force the parameter to be a certain type or is it always just an int. I know I could just have the function <code>configure</code> pass an int instead but then pc-lint also complains. </p>\n\n<pre><code>#define RESULT(x)            (((x) &amp; 0x7) &lt;&lt; 11)\n\ntypedef enum {\n    RES = 0x00,\n    RES_TWO,\n    RES_THREE,\n    RES_FOUR\n} TEST_VALUE;\n\nint configure(TEST_VALUE values)\n{\n    uint32_t temp = RESULT(values);\n\n    return temp;\n}\n</code></pre>\n"}, {"tags": ["c", "time"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 3, "creation_date": 1508337586, "post_id": 46812783, "comment_id": 80572758, "body": "That&#39;s because your list is so small that even a linear search complete in less than a milliseconds. Try a bigger list."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1508337691, "post_id": 46812783, "comment_id": 80572831, "body": "I\u2019d expect the call to <code>clock</code> to take much longer than the actual search, and all of those to be overwhelmed by the I/O."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508337862, "post_id": 46812783, "comment_id": 80572961, "body": "Note also that the performance difference between linear and binary search, considered as general algorithms, is a matter of asymptotic complexity (O(n) <i>vs</i>. O(log n)).  Thus, you may need a considerably larger problem to see it at all, regardless of the precision of and noise in your timing measurement."}, {"owner": {"reputation": 13, "user_id": 8377339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6DdlZ-ncC0c/AAAAAAAAAAI/AAAAAAAAAAk/Rl0LyIH1g9I/photo.jpg?sz=128", "display_name": "Mrityunjoy Nath", "link": "https://stackoverflow.com/users/8377339/mrityunjoy-nath"}, "edited": false, "score": 0, "creation_date": 1508338995, "post_id": 46812783, "comment_id": 80573762, "body": "int a[] =      {1,2,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,40,41,44,45&zwnj;&#8203;,48,32,39,72,73}; \tint size = sizeof(a)/sizeof(a[0]);"}, {"owner": {"reputation": 13, "user_id": 8377339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6DdlZ-ncC0c/AAAAAAAAAAI/AAAAAAAAAAk/Rl0LyIH1g9I/photo.jpg?sz=128", "display_name": "Mrityunjoy Nath", "link": "https://stackoverflow.com/users/8377339/mrityunjoy-nath"}, "edited": false, "score": 0, "creation_date": 1508339020, "post_id": 46812783, "comment_id": 80573783, "body": "I have used this but again 0.000."}, {"owner": {"reputation": 13, "user_id": 8377339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6DdlZ-ncC0c/AAAAAAAAAAI/AAAAAAAAAAk/Rl0LyIH1g9I/photo.jpg?sz=128", "display_name": "Mrityunjoy Nath", "link": "https://stackoverflow.com/users/8377339/mrityunjoy-nath"}, "edited": false, "score": 0, "creation_date": 1508339313, "post_id": 46812783, "comment_id": 80573986, "body": "I have also used numbers from 1 to 1000!!"}, {"owner": {"reputation": 13, "user_id": 8377339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6DdlZ-ncC0c/AAAAAAAAAAI/AAAAAAAAAAk/Rl0LyIH1g9I/photo.jpg?sz=128", "display_name": "Mrityunjoy Nath", "link": "https://stackoverflow.com/users/8377339/mrityunjoy-nath"}, "edited": false, "score": 0, "creation_date": 1508339350, "post_id": 46812783, "comment_id": 80574016, "body": "Again same I think problem may be somewhere in the algorithm not the input ?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1508339517, "post_id": 46812783, "comment_id": 80574139, "body": "@MrityunjoyNath 1000 is still quite small for modern machines. Have you tried something like 10000, 100000 or even a million? Also, try to test the worst case scenario and search of something that is not in your test array."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508339875, "post_id": 46812783, "comment_id": 80574379, "body": "You might also consider running each search many times, in a loop.  Not only will that help accumulate enough execution time to actually be observable, but it will also help average out timing variances in the individual runs."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1508340018, "post_id": 46812783, "comment_id": 80574482, "body": "Computers are really fast."}], "owner": {"reputation": 13, "user_id": 8377339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6DdlZ-ncC0c/AAAAAAAAAAI/AAAAAAAAAAk/Rl0LyIH1g9I/photo.jpg?sz=128", "display_name": "Mrityunjoy Nath", "link": "https://stackoverflow.com/users/8377339/mrityunjoy-nath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508337475, "creation_date": 1508337475, "question_id": 46812783, "link": "https://stackoverflow.com/questions/46812783/execution-time-comparison-of-binary-and-linear-search", "title": "Execution time comparison of binary and linear search", "body": "<p>I have written the two functions 'linearSearch' &amp; 'binarySearch' and now want to compare their execution time difference. I have used time.h library of C.\nBut problem is the time of execution is always getting printed 0.0000! I'm not getting it.     </p>\n\n<pre><code>int main()\n{\n    clock_t start,end;\n    float cpu_time_used;\n    int a[5] = {1,2,3,4,5};\n    start = clock();\n    printf(\"%d\",binarySearch(a,5,4));\n    end = clock();\n    cpu_time_used = ((float) (end - start)/ CLOCKS_PER_SEC)*1000;\n    printf(\"\\nTime binary : %f milliseconds\",cpu_time_used);\n\n    start = clock();\n    printf(\"\\n%d\",linearSearch(a,5,4));\n    end = clock();\n    cpu_time_used = ((float) (end - start) / CLOCKS_PER_SEC)*1000;\n    printf(\"\\nTime linear : %f milliseconds\",cpu_time_used);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "sorting", "pointers", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1508336209, "post_id": 46812293, "comment_id": 80571781, "body": "<a href=\"https://stackoverflow.com/a/41383540/2173917\"><b><i>DO NOT</i></b> use <code>gets()</code>, it is dangerous. use <code>fgets()</code> instead.</a>"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 6, "creation_date": 1508336217, "post_id": 46812293, "comment_id": 80571784, "body": "You have undefined behavior because the pointers in <code>a</code> aren&#39;t pointing anywhere."}, {"owner": {"reputation": 23, "user_id": 8555402, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919492631645974/picture?type=large", "display_name": "Dipesh Kumar Gupta", "link": "https://stackoverflow.com/users/8555402/dipesh-kumar-gupta"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1508336842, "post_id": 46812293, "comment_id": 80572193, "body": "@Kevin But how is it so ,Please explain properly"}, {"owner": {"reputation": 23, "user_id": 8555402, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919492631645974/picture?type=large", "display_name": "Dipesh Kumar Gupta", "link": "https://stackoverflow.com/users/8555402/dipesh-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1508337352, "post_id": 46812293, "comment_id": 80572579, "body": "@kelvin But if a is not pointing any where then ,How a+i is pointing some where else (1&lt;i&lt;any intezer)"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1508337394, "post_id": 46812293, "comment_id": 80572612, "body": "<code>char *a[n]</code> defines an array of <code>n</code> pointers to <code>char</code>. But those pointers are uninitialized and don&#39;t point to valid memory. You need to assign them to something (i.e. <code>a[i] = ...</code>) before you can write something to the memory they point to."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1508338719, "post_id": 46812293, "comment_id": 80573550, "body": "Can&#39;t reproduce... Are you sure that your code is <code>scanf(&quot;%d &quot;, &amp;n );</code> ? Your description sounds as if your code is <code>scanf(&quot;%d&quot;, &amp;n );</code>, i.e. without the space after <code>%d</code>"}, {"owner": {"reputation": 23, "user_id": 8555402, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919492631645974/picture?type=large", "display_name": "Dipesh Kumar Gupta", "link": "https://stackoverflow.com/users/8555402/dipesh-kumar-gupta"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1508340534, "post_id": 46812293, "comment_id": 80574846, "body": "@4386427 it doesn&#39;t matters .."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1508338334, "creation_date": 1508338334, "answer_id": 46813136, "question_id": 46812293, "link": "https://stackoverflow.com/questions/46812293/array-of-pointers-to-string-characters/46813136#46813136", "title": "array of pointers to string characters", "body": "<p>You probably want this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  int n;\n  printf(\"no of elements\\n\");\n  scanf(\"%d\", &amp;n);  // No space after the %d !\n\n  char dummy[2];            // these 2 lines are needed for absorbing the leftover\n  fgets(dummy, 2, stdin);  // \\n from scanf (mixing fgets and scanf is a bad idea)\n\n  char *a[n];       // here we'll have an array of n pointers to char. For the moment\n                    // the array is not initialized and the pointers point nowhere\n\n  puts(\"string\");\n\n  for (int i = 0; i &lt; n; ++i) {\n    a[i] = malloc(100);         // allocate memory for a string of a maximum length of 99.\n                                // + one char for the NUL terminator\n                                // Allocating a fixed size is awkward, but it will\n                                // do here for demonstration purposes\n\n    fgets(a[i], 100, stdin);    // limit the length of string to 100 in order\n                                // to avoid buffer overflow\n                                // it's basically the same as gets(buffer)\n  }\n\n  puts(\"-----\");\n  for (int j = 0; j &lt; n; ++j) {\n    puts(a[j]);\n  }\n\n  puts(\"-----\");\n  puts(a[0]);\n  puts(\"-----\");\n  puts(a[2]);\n\n  return 0;\n}\n</code></pre>\n\n<p>Input and output:</p>\n\n<pre><code>no of elements\n3\nstring\n11\n22\n33\n-----\n11\n\n22\n\n33\n\n-----\n11\n\n-----\n33\n</code></pre>\n\n<p>Error checking is avoided for brevity.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1508341237, "creation_date": 1508341237, "answer_id": 46814121, "question_id": 46812293, "link": "https://stackoverflow.com/questions/46812293/array-of-pointers-to-string-characters/46814121#46814121", "title": "array of pointers to string characters", "body": "<p>For starters according to the C Standard the function main without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>The declared variable in this declaration</p>\n\n<pre><code>char ch;\n</code></pre>\n\n<p>is not used in the program and should be removed.</p>\n\n<p>And neither declaration from the header <code>&lt;string.h&gt;</code> is used in your program. So the header could be removed.</p>\n\n<p>You declared a variable length array of pointers to the type <code>char</code></p>\n\n<pre><code>char *a[n];\n</code></pre>\n\n<p>However the elements of the array were not initialized and have indeterminate values. As result the program has undefined behavior due to this statement in the for loop</p>\n\n<pre><code>gets(a+i);\n</code></pre>\n\n<p>You have to allocate memory for each string you are going to enter.</p>\n\n<p>Also take into account that the function <code>gets</code> is unsafe and is not supported any more by the C Standard. Instead use the function <code>fgets</code>. Moreover the argument in the function call must be <code>*( a + i )</code> instead of <code>a + i</code> because the type of the last expression is <code>char **</code> instead of the required type <code>char *</code>.</p>\n\n<p>So a valid code can look for example the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main( void )\n{\n    size_t n;\n    const size_t SIZE = 20;\n\n    printf( \"no of elements: \" );\n\n    if ( scanf( \"%zu%*c\", &amp;n ) != 1 || n == 0 ) n = 1;\n\n    char * a[n];\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        *( a + i ) = malloc( SIZE );    \n    }\n\n    puts(\"string\");\n\n    for ( size_t i = 0; i &lt; n; ++i )\n    {\n        fgets( *( a + i ), SIZE, stdin );\n    }\n\n    puts(\"-----\");\n\n    for ( size_t i = 0; i &lt; n; ++i )\n    {\n        printf( \"%s\", *( a + i ) );\n    }\n\n    puts( \"-----\" );\n    printf( \"%s\", *a );\n\n    puts( \"-----\" );\n    printf( \"%s\", *( a + 2 ) );\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        free( *( a + i ) );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output might look like</p>\n\n<pre><code>no of elements: 5\nstring\nA\nB\nC\nD\nE\n-----\n\nA\nB\nC\nD\nE\n-----\nA\n-----\nC\n</code></pre>\n\n<p>Pay attention to this statement</p>\n\n<pre><code>    if ( scanf( \"%zu%*c\", &amp;n ) != 1 || n == 0 ) n = 1;\n</code></pre>\n\n<p>After reading the variable <code>n</code> using format specifier <code>&amp;zu</code> you need to remove from the input buffer the new line character  that corresponds to the pressed key Enter. Otherwise the next call of <code>fgets</code> will read an empty string.</p>\n"}], "owner": {"reputation": 23, "user_id": 8555402, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919492631645974/picture?type=large", "display_name": "Dipesh Kumar Gupta", "link": "https://stackoverflow.com/users/8555402/dipesh-kumar-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 46814121, "answer_count": 2, "score": -1, "last_activity_date": 1508344918, "creation_date": 1508335996, "last_edit_date": 1508344918, "question_id": 46812293, "link": "https://stackoverflow.com/questions/46812293/array-of-pointers-to-string-characters", "title": "array of pointers to string characters", "body": "<p><em>when input is given five ,instead of asking for 5 string it takes only four ,Why is it so ?</em>\n<em>why by default <code>*a+0 = '\\n'</code> is saved ?</em>\n<em>I have also tried <code>scanf(\"%d %c\", &amp;n &amp;ch )</code> at line 9,but the problem was same.</em> </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n\nint main()\n    {\n        int n;\n        char ch;\n        printf(\"no of elements\\n\");\n        scanf(\"%d \", &amp;n ); //line 9\n        //asking for number of pointer in array \n        char *a[n];\n        puts(\"string\");\n        for (int i = 0; i &lt; n; ++i){\n            gets(a+i);\n        }\n        puts(\"-----\");\n        for (int j = 0; j &lt; n; ++j){\n            puts(a+j);\n        }\n        puts(\"-----\");\n        puts(a);\n        puts(\"-----\");\n        puts(a+2);\n\n        return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "pthreads", "fork", "exec", "posix"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508336508, "post_id": 46811530, "comment_id": 80571980, "body": "The primary documented operational issue with <code>atfork</code> handlers involves the case in which <code>fork()</code> is called by a signal handler, and thus the <code>atfork</code> handlers are called in the signal handler&#39;s context.  Is this an issue you actually need to worry about?"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508342172, "post_id": 46811968, "comment_id": 80576040, "body": "You&#39;ll have to help me out there, @Albert.  Where did you read about that?  As far as I can determine, no such identifier is specified by POSIX for any entity whatever.  It looks like GLIBC may have an internal function with a name similar to that, but if so, it is not intended to be called directly, and it is not portable."}, {"owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508342630, "post_id": 46811968, "comment_id": 80576370, "body": "In the <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/generic/fork.h;h=623cae28dfa22d00ed09b8842ca36f44f733942c;hb=HEAD\" rel=\"nofollow noreferrer\">Glibc <code>fork.h</code></a>, it says UNREGISTER_ATFORK, If defined it must expand to a function call which takes one void* parameter which is the DSO handle for the DSO which gets unloaded. The function so called has to remove the atfork handlers registered  by this module. I saw that some C++ stdlib implementations use this."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508344490, "post_id": 46811968, "comment_id": 80577455, "body": "@Albert, (1) that&#39;s GLIBC-specific. (2) It is a macro, not a function, used internally in GLIBC&#39;s implementation. Defining it in your own code will have no effect on the already-compiled GLIBC code that uses it.  (3) It anyway does not address your problem. It allows GLIBC&#39;s component libraries to designate a function to call to remove their own atfork hooks, but what you asked for is a way to <i>implement</i> such a function."}, {"owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508346847, "post_id": 46811968, "comment_id": 80578666, "body": "I don&#39;t want to change already-compiled Glibc code. I just want to reset the handlers. And I think this symbol is exported. So if I know the DSO of all the libs, I can reset their handlers. Of course this covers only Glibc, but at least it partially does what I want, right?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508350183, "post_id": 46811968, "comment_id": 80580382, "body": "No, @Albert, the <code>UNREGISTER_ATFORK</code> symbol is <i>not</i> exported. As it is used by GLIBC, it must be defined -- I repeat -- as a macro, not a function.  Macros are expanded at compile time (<i>glibc</i> compile time, in this case); their identifiers do not become external symbols.  You are looking at an internal extension point in GLIBC, not an external interface."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508350621, "post_id": 46811968, "comment_id": 80580635, "body": "@Albert, supposing that you are using a DSO version of your library, and supposing further that it provides an unregistration-handling function with external linkage, yes, you could call that function.  Even if you can discover such a function, however, you cannot be certain that it is safe to call it outside the scope of unloading the DSO.  You also have no guarantee about the stability or continued existence of such a function across platforms or versions of the library.  Until and unless it is documented, it is an implementation detail."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1508336724, "last_edit_date": 1508336724, "creation_date": 1508335143, "answer_id": 46811968, "question_id": 46811530, "link": "https://stackoverflow.com/questions/46811530/how-to-reset-handlers-registered-by-pthread-atfork/46811968#46811968", "title": "how to reset handlers registered by pthread_atfork", "body": "<p>POSIX does not document any mechanism for fork handlers installed by <code>pthread_atfork()</code> to be removed, short of termination of the process or replacing the process image.  If you don't want them, then don't install them.  If they are installed by a third-party library, as you describe, then your options are to find a way to avoid that behavior of the library (possibly by avoiding the library altogether) or to live with it.</p>\n"}], "owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 46811968, "answer_count": 1, "score": 1, "last_activity_date": 1508336724, "creation_date": 1508333784, "question_id": 46811530, "link": "https://stackoverflow.com/questions/46811530/how-to-reset-handlers-registered-by-pthread-atfork", "title": "how to reset handlers registered by pthread_atfork", "body": "<p>Some libraries might register some handlers with <code>pthread_atfork()</code>. I don't need them as I only use <code>fork()</code> together with <code>exec()</code>. Also, they can cause trouble in some cases. So, is there a way to reset the registered handler list?</p>\n\n<p>Related: <a href=\"https://stackoverflow.com/questions/46810597/forkexec-without-atfork-handlers\">calling <code>fork()</code> without the <code>atfork</code> handlers</a>, <a href=\"https://stackoverflow.com/questions/4453822/is-fork-supposed-to-be-safe-from-signal-handlers-in-a-threaded-program\"><code>fork()</code> async signal safety</a>.</p>\n"}, {"tags": ["c", "windows", "encryption", "xor"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1508332997, "post_id": 46811136, "comment_id": 80569504, "body": "It has to be exposed in memory if you can pass it as in input to the function. It will also be exposed in memory (and in the executable file) if you use a string literal."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1508333018, "post_id": 46811136, "comment_id": 80569522, "body": "<code>sizeof(input)</code> is the size of a pointer, not of the array."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508333227, "post_id": 46811136, "comment_id": 80569656, "body": "Your function is broken: you cannot use <code>sizeof</code> inside a function to determine the length of an array passed to that function as an argument.  That&#39;s mainly because you <i>can&#39;t</i> pass an array -- wherever you think that&#39;s what you&#39;re doing, you are in fact passing a pointer to the first array element instead.  Such a pointer does not carry information about the number of elements in the array."}, {"owner": {"reputation": 78, "user_id": 7873270, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cbe9c84c599b08e20b3261fe3092065?s=128&d=identicon&r=PG&f=1", "display_name": "Junos", "link": "https://stackoverflow.com/users/7873270/junos"}, "edited": false, "score": 0, "creation_date": 1508333822, "post_id": 46811136, "comment_id": 80570086, "body": "Makes sense, thanks! guess i will be hardcoding the input length then!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1508334893, "post_id": 46811136, "comment_id": 80570894, "body": "To me this is unclear. Are you asking how to avoid that data is stored in memory but still can get into the CPU and be processed? If so... There is no general way to do that. But on some systems it may be possible depending on HW architecture. Also you may have to write assembly code instead of C. BTW - where do you get the input from?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1508487821, "post_id": 46811136, "comment_id": 80637637, "body": "I think you want to hardcode <code>&quot;MYSECRET&quot;</code> but you are concerned people will see it with hex editor? There is not much you can do except obfuscate. You could encrypt the secret with another secret to make it harder to crack."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1508333924, "creation_date": 1508333924, "answer_id": 46811577, "question_id": 46811136, "link": "https://stackoverflow.com/questions/46811136/xor-byte-array-shellcode/46811577#46811577", "title": "XOR BYTE Array (Shellcode)", "body": "<blockquote>\n  <p>The problem is that i dont want to save the BYTE array without encrypting it because it will be exposed in memory then.</p>\n  \n  <p>How could i directly pass the BYTE array into the function without defining it first?</p>\n</blockquote>\n\n<p>You cannot do so.  It doesn't even make sense.  <em>Passing</em> the bytes depends on having them in memory already, and so does performing the encryption operation on them.</p>\n\n<p>Moreover, if the program is supposed to provide the plaintext itself, then there is no avoiding that plaintext being stored, in some form, in the program image.  On the other hand, if the plaintext bytes are obtained from an external source then you could consider encrypting them at the point where you input them.  Depending on the details, that might avoid having all the plaintext in memory at the same time.</p>\n\n<p>You could also consider wiping the input array after encrypting its contents, instead of avoiding ever having such an array in the first place.  Just overwrite it with 0 or with random bytes.  That's really only useful for the case of plaintext coming from an external source, however; data provided by the program itself are accessible without even running the program.</p>\n"}], "owner": {"reputation": 78, "user_id": 7873270, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cbe9c84c599b08e20b3261fe3092065?s=128&d=identicon&r=PG&f=1", "display_name": "Junos", "link": "https://stackoverflow.com/users/7873270/junos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508333924, "creation_date": 1508332632, "question_id": 46811136, "link": "https://stackoverflow.com/questions/46811136/xor-byte-array-shellcode", "title": "XOR BYTE Array (Shellcode)", "body": "<p>Im trying to perform a XOR encryption on a BYTE (unsigned char) by trying to pass it directly into the function without defining it first.</p>\n\n<p>XOR function:</p>\n\n<pre><code>void xor(BYTE input[], BYTE output[]) {\nBYTE key[] = { 'T', 'A', 'M' }; //Can be any chars, and any size array\n\nint i;\nfor (i = 0; i &lt; sizeof(input); i++) {\n    output[i] = input[i] ^ key[i % (sizeof(key) / sizeof(BYTE))];\n}\n</code></pre>\n\n<p>BYTE array example:</p>\n\n<pre><code>BYTE Shellcode[] =\n{\n    0x48, 0x83, 0xEC, 0x08,                                     \n};\n</code></pre>\n\n<p>The problem is that i dont want to save the BYTE array without encrypting it because it will be exposed in memory then.</p>\n\n<p>How could i directly pass the BYTE array into the function without defining it first?</p>\n\n<p>With a simple char array that contains strings it would of course be easy but i cant find out how to pass the byte array with integer values instead of string literals.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 1, "creation_date": 1508336278, "post_id": 46811133, "comment_id": 80571827, "body": "Questions on SO are suppoused to be <b>specific</b> enough for us to answer them. Answering must never require intuition. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1508338829, "post_id": 46811133, "comment_id": 80573625, "body": "When creating a window, you are passing <i>window</i> coordinates, not client coordinates. 500x500 includes all the non-client areas. If you need to create a client area of a particular size, call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632667.aspx\" rel=\"nofollow noreferrer\">AdjustWindowRectEx</a>. I&#39;m not sure this is what you are asking for. Your question isn&#39;t clear enough to know."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1508349101, "post_id": 46811133, "comment_id": 80579774, "body": "If your functions are expecting width/height values instead of right/bottom coordinates, you should be using <code>right - left</code>, <code>bottom - top</code> instead. The left/top values may not always be 0 like you are expecting. As such, you might also consider passing the left/top values to <code>StretchDIBits()</code> instead of 0s"}, {"owner": {"reputation": 31, "user_id": 7516829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qWL54.png?s=128&g=1", "display_name": "kepler425b", "link": "https://stackoverflow.com/users/7516829/kepler425b"}, "edited": false, "score": 0, "creation_date": 1508352204, "post_id": 46811133, "comment_id": 80581451, "body": "After adjusting the DestX and DestY of destination rectangle origin point in StretchDIBits(), I got the image perfectly aligned with the desired window. (Also, it asks for destX, destY in logical units, these are pixels right?) BTW I did everything all of you mentioned, didn&#39;t do the trick. Apparently, the bitmap was offset in StretchDIBits() thus making it misaligned. <a href=\"https://i.imgur.com/uOPrTVv.png\" rel=\"nofollow noreferrer\">HAVE A LOOK</a>"}], "owner": {"reputation": 31, "user_id": 7516829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qWL54.png?s=128&g=1", "display_name": "kepler425b", "link": "https://stackoverflow.com/users/7516829/kepler425b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508338735, "creation_date": 1508332628, "last_edit_date": 1508338735, "question_id": 46811133, "link": "https://stackoverflow.com/questions/46811133/winapi-window-client-area-not-lining-up-with-the-window", "title": "WINAPI: Window client area not lining up with the window", "body": "<p>The client area of my window is not aligning properly with the outer non-client area. Take a look, this is when I am not touching the window, just after I launch it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/x61Yx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x61Yx.jpg\" alt=\"image\"></a></p>\n\n<p>It's not aligned, although all dimensions across all functions are ok, 500x500 to be exact.</p>\n\n<p>Now, when I resize it, it kind of aligns correctly:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dDThJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dDThJ.jpg\" alt=\"image\"></a></p>\n\n<pre><code>HWND Window = CreateWindowEx(\n            0,\n            WindowClass.lpszClassName,\n            \"Handmade Hero\",\n            WS_OVERLAPPED | WS_THICKFRAME | WS_MINIMIZEBOX | WS_MAXIMIZEBOX | WS_VISIBLE,\n            CW_USEDEFAULT,\n            CW_USEDEFAULT,\n            500,\n            500,\n            0,\n            0,\n            Instance,\n            0);\n\n\n        RECT rect;\n        GetClientRect(Window, &amp;rect);\n        Win32AllocateMemoryBuffer(&amp;GlobalBackBuffer, rect.right, rect.bottom);\n</code></pre>\n\n<p>Message handling:</p>\n\n<pre><code>case WM_PAINT:\n        {\n            PAINTSTRUCT Paint;\n            HDC DeviceContext = BeginPaint(Window, &amp;Paint);\n            Dimension rect;\n            GetClientRect(Window, &amp;rect);\n\n            Win32DisplayBufferInWindow(DeviceContext, &amp;GlobalBackBuffer, Dimension.right, Dimension.bottom);\n            EndPaint(Window, &amp;Paint);\n        } break;\n</code></pre>\n\n<p>The stretchdbits:</p>\n\n<pre><code>    StretchDIBits(DeviceContext,\n        0, 0, WindowWidth, WindowHeight,\n        0, 0, Buffer-&gt;BitmapWidth, Buffer-&gt;BitmapHeight,\n        Buffer-&gt;BitmapMemory,\n        &amp;Buffer-&gt;BitmapInfo,\n        DIB_RGB_COLORS, SRCCOPY);\n</code></pre>\n\n<p>I've been tracking the dimensions across all the program in VS debugger, but couldn't track the problem. Maybe your intuition would spot something?</p>\n"}, {"tags": ["c", "stack", "postfix"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1508332913, "post_id": 46811063, "comment_id": 80569457, "body": "First, rewrite your code so that the whole number is parsed inside the while loop and not char by char with the help of a global <code>flag</code>. You could use <code>strtod</code> for that, which read floating-point numbers and helpfully tells you the position after the parsing."}, {"owner": {"reputation": 1, "user_id": 8590919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7c3d4838d53733e9706741ad9fbc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoan Salim", "link": "https://stackoverflow.com/users/8590919/ayoan-salim"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1508333890, "post_id": 46811063, "comment_id": 80570133, "body": "Sorry sir, I did not exactly get your point. Also, I have not used strtod before so I am a bit confused."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1508334061, "post_id": 46811063, "comment_id": 80570272, "body": "There&#39;s always a time to learn new things. Reading floating-point numbers in decimal isn&#39;t trivial, so rolling your own might not work. Your current code works, but in my opinion would be improved by parsing number chunks in one go instead of assembling them piecemeal in the <code>push</code> function. Anyway, I have posted an answer which might be useful too you."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8590919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7c3d4838d53733e9706741ad9fbc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoan Salim", "link": "https://stackoverflow.com/users/8590919/ayoan-salim"}, "edited": false, "score": 0, "creation_date": 1508334235, "post_id": 46811579, "comment_id": 80570403, "body": "Thanks a lot, Sir."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508336391, "post_id": 46811579, "comment_id": 80571913, "body": "<code>if (p == end) {</code> is sufficient rather than <code>if (x == 0 &amp;&amp; p == end) {</code>.  The following ` while (isdigit((unsigned char) *p)) p++;` serves no purpose as <code>isdigit((unsigned char) *p)</code> would never be true here."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508336697, "post_id": 46811579, "comment_id": 80572102, "body": "@chux: As someone who doesn&#39;t sleep with the C standard under his pillow, I was being overcautious here, I guess."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 0, "last_activity_date": 1508345496, "last_edit_date": 1508345496, "creation_date": 1508333927, "answer_id": 46811579, "question_id": 46811063, "link": "https://stackoverflow.com/questions/46811063/how-do-i-evaluate-decimals-floating-point-numbers-in-scientific-e-notation-e/46811579#46811579", "title": "How do I evaluate decimals &amp; floating point numbers in scientific e notation - e.g. {1.23e4}. in postfix?", "body": "<p>The function <code>strtod</code> from <code>&lt;stdlib.h&gt;</code> will parse a <code>double</code> for you. It takes the string to parse and a pointer to a string, that will begin with the first unparsed character. (There's a similar function for long integers, <code>strtol</code>.)</p>\n\n<p>Here's an example of how this might work in your case. (The code just prints out the tokens and doesn't do any calculations.)</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint is_number(const char *p)\n{\n    if (*p == '-' || *p == '+') p++;\n    if (*p == '.') p++;\n\n    return isdigit((unsigned char) *p);\n}\n\nint main(void)\n{\n    const char *line = \" .1 20.1* 1.0e-3+2e+7 * -1.0*\";\n    const char *p = line;\n\n    while (isspace((unsigned char) *p)) p++;\n\n    while (*p) {\n        if (is_number(p, after_op)) {\n            char *end;\n            double x = strtod(p, &amp;end);\n\n            if (p == end) {\n                puts(\"Illegal number\");\n                p++;\n            } else {\n                printf(\"Number %g\\n\", x);\n                p = end;\n            }\n        } else {\n            int c = *p++;\n\n            switch (c) {\n            case '+':   puts(\"Operator add\"); break;\n            case '-':   puts(\"Operator sub\"); break;\n            case '*':   puts(\"Operator mult\"); break;\n            case '/':   puts(\"Operator div\"); break;\n            case '^':   puts(\"Operator pow\"); break;\n            default:    printf(\"Illegal char '%c'\\n\", c);\n            }\n        }\n\n        while (isspace((unsigned char) *p)) p++;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This is still very crude, mind you. Strings like <code>20x21</code> will be parsed as number 20, unknown character <code>x</code> and number 21. While this code is bad at detecting and reporting errors (which really should be done, but it's left as an exercise, yadda, yadda), it works for valid input.</p>\n\n<p>[<em>Edit</em>: I've incorporated chux's suggestions and also made the code compatible to read numbers with explicit signs, but that means that the binary operators <code>-</code> and <code>+</code> cannot immediately be followed by a digit. Pick your poison. I've also allowed the abridged version that leaves out a leading zero, e.g. <code>.12</code>, a format that I'm not very fond of.]</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8590919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7c3d4838d53733e9706741ad9fbc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoan Salim", "link": "https://stackoverflow.com/users/8590919/ayoan-salim"}, "edited": false, "score": 0, "creation_date": 1508401428, "post_id": 46813391, "comment_id": 80598615, "body": "Sir, if u could please have  a look at my code, I am not sure why it is not working after fitting in your adjustments. {link}: <a href=\"https://onlinegdb.com/BkATeJ8T-\" rel=\"nofollow noreferrer\">onlinegdb.com/BkATeJ8T-</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1, "user_id": 8590919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7c3d4838d53733e9706741ad9fbc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoan Salim", "link": "https://stackoverflow.com/users/8590919/ayoan-salim"}, "edited": false, "score": 0, "creation_date": 1508417853, "post_id": 46813391, "comment_id": 80608135, "body": "@AyoanSalim &quot;not working &quot; lacks description.  What what entered? What result did you see? What was expected?"}, {"owner": {"reputation": 1, "user_id": 8590919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7c3d4838d53733e9706741ad9fbc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoan Salim", "link": "https://stackoverflow.com/users/8590919/ayoan-salim"}, "edited": false, "score": 0, "creation_date": 1508419108, "post_id": 46813391, "comment_id": 80608973, "body": "I entered simple postfix like &#39;45 56 +&#39;. All it gives as output is input invalid operator: character code &quot;random huge number&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1, "user_id": 8590919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7c3d4838d53733e9706741ad9fbc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoan Salim", "link": "https://stackoverflow.com/users/8590919/ayoan-salim"}, "edited": false, "score": 0, "creation_date": 1508419604, "post_id": 46813391, "comment_id": 80609351, "body": "@AyoanSalim Post amended <code>if (end &gt; st) {</code> and <code>printf(&quot;Input invalid ... %d\\n&quot;, *st);</code>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1508419472, "last_edit_date": 1508419472, "creation_date": 1508339056, "answer_id": 46813391, "question_id": 46811063, "link": "https://stackoverflow.com/questions/46811063/how-do-i-evaluate-decimals-floating-point-numbers-in-scientific-e-notation-e/46813391#46813391", "title": "How do I evaluate decimals &amp; floating point numbers in scientific e notation - e.g. {1.23e4}. in postfix?", "body": "<blockquote>\n  <p>How do I evaluate decimals &amp; floating point numbers in scientific e notation ... (?)</p>\n</blockquote>\n\n<p>To convert  a string into FP value use <code>strtod()</code>  <a href=\"https://stackoverflow.com/questions/46811063/how-do-i-evaluate-decimals-floating-point-numbers-in-scientific-e-notation-e\">@M Oehm</a></p>\n\n<hr>\n\n<p>Yet code has other problems in that the operator symbols <code>'-'</code> and <code>'+'</code> may also begin valid value tokens like <code>-123.45</code>.</p>\n\n<pre><code>// insufficient test to determine if the next part of the string is a number or operator.\nif(isdigit(ch)) \n  push(ch-'0');\n</code></pre>\n\n<p>Use <code>strtod()</code> to convert text to <code>double</code> <strong>and</strong> determine if the next part of the string is a <code>double</code>.</p>\n\n<p>Alternative code:</p>\n\n<pre><code>  const char *st = pofx;\n  while (*st) {\n    char *end; //location to store end of FP parsing\n    double value = strtod(st, &amp;end);\n    if (end &gt; st) {\n      push(value);\n      st = end; \n    } else if (isspace((unsigned char) *st)) {\n      st++;\n    } else {\n      switch (*st) {\n        case '+':push(pop() + pop());break; // pop order irrelevant\n        case '-':{ double t = pop(); push(pop() - t);break; } // pop order relevant\n        case '*':push(pop() * pop());break;\n        ...\n        default: {\n          printf(\"Input invalid operator: character code %d\\n\", *st);\n          return 0;\n        } \n      }  // end switch\n      st++;\n    }\n  }\n</code></pre>\n\n<hr>\n\n<p>Re-write <code>push()</code> </p>\n\n<pre><code>void push(double elem) {\n  if (top + 1 &gt;= SIZE) {\n    printf(\"Stack overflow\\n\");\n    return;\n  }\n  s[++top] = elem;\n}\n</code></pre>\n\n<hr>\n\n<p>Wrong argument to <code>fgets()</code></p>\n\n<pre><code>char pofx[50];\n// fgets(pofx,100,stdin); // 100??\nfgets(pofx, sizeof pofx, stdin); // better\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8590919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7c3d4838d53733e9706741ad9fbc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Ayoan Salim", "link": "https://stackoverflow.com/users/8590919/ayoan-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508419472, "creation_date": 1508332442, "question_id": 46811063, "link": "https://stackoverflow.com/questions/46811063/how-do-i-evaluate-decimals-floating-point-numbers-in-scientific-e-notation-e", "title": "How do I evaluate decimals &amp; floating point numbers in scientific e notation - e.g. {1.23e4}. in postfix?", "body": "<p>I have written my code to evaluate from postfix to result. However, I am stuck at how to do it when the postfix is going to be in decimals &amp; floating point numbers in scientific e notation - e.g. {1.23e4}. Any specific suggestion would be highly appreciated. Thanks. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SIZE 50 /* Size of Stack */\n\ndouble s[SIZE];\nint top=-1; /* Global declarations */\nint flag=0;\ndouble pop()\n{                      /* Function for POP operation */\n  return(s[top--]);\n}\ndouble push(double elem)\n{ /* Function for PUSH operation */\n  if(flag==1){\n    int num;\n    num=pop();\n    s[++top]=elem+10*num;\n  }\n  else if(flag==0){\n    s[++top]=elem;\n    flag=1;\n  }\n}\n\n\nvoid main()\n{                         /* Main Program */\n  char pofx[50],ch;\n  int i=0;\n\n  double op1,op2;\n  printf(\"Enter the Postfix Expression:\");\n  fgets(pofx,100,stdin);\n  while( (ch=pofx[i++]) != '\\n')\n  {\n    if(isdigit(ch)) push(ch-'0'); /* Push the operand */\n    else if(ch==' ')\n      flag=0;\n    else\n    {        /* Operator,pop two  operands */\n      flag=0;\n      op2=pop();\n      op1=pop();\n      switch(ch)\n      {\n        case '+':push(op1+op2);break;\n        case '-':push(op1-op2);break;\n        case '*':push(op1*op2);break;\n        case '/':push(op1/op2);break;\n        case '^':push(pow(op1,op2));break;\n        default:\n                 printf(\"Input invalid ... give proper input\\n\");\n                 return 0;\n      }\n    }\n  }\n  printf(\"Result: %lf\\n\",s[top]);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "mutex"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1508332029, "post_id": 46810898, "comment_id": 80568905, "body": "Try passing <code>-fsanitize=undefined,address</code> to compiler and linker. If you are lucky you will get more helpful output."}, {"owner": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1508332488, "post_id": 46810898, "comment_id": 80569204, "body": "@nwp It either hangs totally or works correctly."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1508332566, "post_id": 46810898, "comment_id": 80569245, "body": "Having the <code>push</code> inside a <code>while</code>-loop could generate a huge amount of pushes. Also, the code in <code>push</code> and <code>pop</code> doesn&#39;t seem to be thread safe. What if you do <code>free(s-&gt;head)</code> just as the other thread adds a new <code>head</code>?"}, {"owner": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1508333163, "post_id": 46810898, "comment_id": 80569619, "body": "@BoPersson How can I make them thread safe?"}, {"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 0, "creation_date": 1508333378, "post_id": 46810898, "comment_id": 80569770, "body": "@AhmedBilal Learning how to do that was probably pretty much the whole point of that university course of yours."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1508333435, "post_id": 46810898, "comment_id": 80569809, "body": "Why is this marked as C++ when this is pure C? Please don&#39;t tag spam"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1508333444, "post_id": 46810898, "comment_id": 80569818, "body": "@Ahmed - You will likely have to use some kind of lock.  :-)"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "edited": false, "score": 0, "creation_date": 1508333105, "post_id": 46811116, "comment_id": 80569577, "body": "Actually, any data structure would work. I just want to keep track of threads that I paused to later wake them up."}, {"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "reply_to_user": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "edited": false, "score": 0, "creation_date": 1508333172, "post_id": 46811116, "comment_id": 80569624, "body": "@AhmedBilal The problem is not the data structure but the lack of synchronization. You would get similar crashes with any other (non-thread safe) data structure."}, {"owner": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "edited": false, "score": 0, "creation_date": 1508333346, "post_id": 46811116, "comment_id": 80569749, "body": "How can i fix this?"}, {"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "reply_to_user": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "edited": false, "score": 1, "creation_date": 1508333695, "post_id": 46811116, "comment_id": 80569999, "body": "@AhmedBilal By using a thread-safe data structure or inserting additional synchronization mechanisms. Honestly, there&#39;s a million different ways to fix this, but I don&#39;t know which of them is appropriate for your problem. I&#39;d suggest you visit the office hours of your course advisor and discuss the problem with them. If you can demonstrate that you understood where your solution is lacking, I&#39;m sure they will be more than happy to give you a hint on how to proceed."}, {"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "reply_to_user": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "edited": false, "score": 0, "creation_date": 1508334608, "post_id": 46811116, "comment_id": 80570661, "body": "@AhmedBilal The order of joins should not be of concern here, as all threads behave symmetrical (ie. execute the exact same <code>work</code> function). If order of threads <i>were</i> to be an issue (which it&#39;s not), you would be in big trouble: Since both threads execute the same function, they can &#39;switch places&#39; at will. If you <code>join</code>ed in the opposite order, they could simply rearrange their schedules in a way that the original problem manifests again."}, {"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "reply_to_user": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "edited": false, "score": 0, "creation_date": 1508335497, "post_id": 46811116, "comment_id": 80571335, "body": "@AhmedBilal Because gdb influences the scheduling of the individual threads, often hiding data races as a result. That is one of the reasons why multi-threaded programs have a reputation for being difficult to debug."}], "tags": [], "owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "is_accepted": false, "score": 0, "last_activity_date": 1508332980, "last_edit_date": 1508332980, "creation_date": 1508332587, "answer_id": 46811116, "question_id": 46810898, "link": "https://stackoverflow.com/questions/46810898/implementing-mutex-lock-without-busy-waiting/46811116#46811116", "title": "Implementing Mutex Lock Without Busy Waiting", "body": "<p>Access to your <code>Stack</code> data structure from the mutex implementation is not synchronized.</p>\n\n<p>Multiple threads could attempt to <code>acquire</code> the mutex at the same time, which will lead to them accessing <code>waiting_q</code> concurrently. Similarly, a releasing thread's <code>pop()</code> access to <code>waiting_q</code> is not synchronized with the <code>push()</code> access from the acquiring threads.</p>\n\n<p>This data race on the <code>Stack</code> is most likely what is causing the segfault.</p>\n"}], "owner": {"reputation": 133, "user_id": 1722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e07cf6fdcacc629e4b43e40377156f9?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal Khalid", "link": "https://stackoverflow.com/users/1722558/ahmad-bilal-khalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 798, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509286456, "creation_date": 1508331926, "last_edit_date": 1509286456, "question_id": 46810898, "link": "https://stackoverflow.com/questions/46810898/implementing-mutex-lock-without-busy-waiting", "title": "Implementing Mutex Lock Without Busy Waiting", "body": "<p>I got a university assignment to implement a Mutex lock without busy waiting. I am trying to implement it but without much success. Sometimes, it throws segmentation overflow other time it just keeps hanging however, when I run it in gdb it runs perfectly every time.</p>\n\n<p><strong>mutex.c</strong></p>\n\n<pre><code>#define _GNU_SOURCE \n\n#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include \"stack.h\"\n\n#define NUM_THREADS 2\n\n// shared data structure\nint sum = 0;\n\nstruct Stack waiting_q;\n\nbool mutex_locked = false;\n\nvoid * got_signal(int x) { return NULL; }\n\nvoid acquire()\n{\n    bool first_time = true;\n    while (!__sync_bool_compare_and_swap(&amp;mutex_locked, false, true))\n    {\n        if (first_time)\n        {\n            push(&amp;waiting_q, pthread_self());\n            first_time = false;\n        }\n        printf(\"%ld is waiting for mutex\\n\", syscall(SYS_gettid));\n        pause();\n    }\n    printf(\"Mutex acquired by %ld\\n\", syscall(SYS_gettid));\n}\n\nvoid release()\n{\n    int thread_r = pop(&amp;waiting_q);\n    if (waiting_q.size != 0 &amp;&amp; thread_r != INT_MIN)\n        pthread_kill(thread_r, SIGCONT);\n\n    mutex_locked = false;\n    printf(\"Mutex released by = %ld\\n\", syscall(SYS_gettid));\n}\n\nvoid * work()\n{\n    acquire();\n\n    for (int i = 0; i &lt; 10000; i++)\n    {\n        sum = sum + 1;\n    }\n    release();\n    return NULL;\n}\n\nint main()\n{\n    init_stack(&amp;waiting_q);\n    pthread_t threads[NUM_THREADS];\n    for (int i = 0; i &lt; NUM_THREADS; i++)\n    {\n        int rc = pthread_create(&amp;threads[i], NULL, work, NULL);\n        if (rc != 0)\n            printf(\"Error creating thread\\n\");\n    }\n\n    for (int i = 0; i &lt; NUM_THREADS; i++)\n    {\n        pthread_join(threads[i], NULL);\n    }\n\n    printf(\"Value of Sum = %d\\n\", sum);\n    return 0;\n}\n</code></pre>\n\n<p><strong>stack.h</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;pthread.h&gt;\n\nstruct Node{\n    struct Node * next;\n    pthread_t x;\n};\n\nstruct Stack{\n    struct Node * head;\n    int size;\n};\n\nvoid push(struct Stack * s, pthread_t n)\n{\n    struct Node * new_head = malloc(sizeof(struct Node));\n    new_head-&gt;next = s-&gt;head;\n    new_head-&gt;x = n;\n    s-&gt;head = new_head;\n    s-&gt;size++;\n}\n\npthread_t pop(struct Stack * s)\n{\n    pthread_t rc = INT_MIN;\n    if (s-&gt;head != NULL)\n    {\n        rc = s-&gt;head-&gt;x;\n        struct Node * next = s-&gt;head-&gt;next;\n        free(s-&gt;head);\n        s-&gt;head = next;\n        return rc;\n    }\n    s-&gt;size--;\n    return rc;\n}\n\nvoid init_stack(struct Stack * s)\n{\n    s-&gt;head = 0;\n    s-&gt;size = 0;\n}\n</code></pre>\n"}, {"tags": ["c", "stm32", "stm32f0", "stm32f3"], "comments": [{"owner": {"reputation": 2354, "user_id": 431725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75966c4771a6d4dacf775ad8012f66de?s=128&d=identicon&r=PG", "display_name": "DarkMukke", "link": "https://stackoverflow.com/users/431725/darkmukke"}, "edited": false, "score": 0, "creation_date": 1508331559, "post_id": 46810605, "comment_id": 80568625, "body": "too bad these kind of topics don&#39;t get a lot of views, i&#39;d help you if i knew anything about it."}, {"owner": {"reputation": 516, "user_id": 6490190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c28036f5e41e1db1ea8d989c9264820?s=128&d=identicon&r=PG", "display_name": "Yuriy", "link": "https://stackoverflow.com/users/6490190/yuriy"}, "edited": false, "score": 2, "creation_date": 1508335170, "post_id": 46810605, "comment_id": 80571116, "body": "This code looks more like CMSIS but not HAL. The possible reason is that you don&#39;t clean interrupt bit before exiting handler. This enforce handler to be called again and again."}, {"owner": {"reputation": 37, "user_id": 8795144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1666320970046403/picture?type=large", "display_name": "Heiko Thober", "link": "https://stackoverflow.com/users/8795144/heiko-thober"}, "edited": false, "score": 0, "creation_date": 1508354764, "post_id": 46810605, "comment_id": 80582821, "body": "I simply didn&#39;t copied the part were the interrupt bit is cleared into this post. The interrupt is triggered after tine pin is set low and the function change_rising is called. That&#39;s happening after a reset of the chip."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1508371558, "post_id": 46810605, "comment_id": 80589443, "body": "you do not clear the interrupt flag so the interrupt will be triggered &quot;ad infinitum&quot;. if clear the flag just before the exit from the interrupt there may be not enough time to this clear to propagate thorough the bus and the interrupt will be triggered again. To avoid it : clear it early enough, use barrier instructions or read the flag after clearing."}, {"owner": {"reputation": 37, "user_id": 8795144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1666320970046403/picture?type=large", "display_name": "Heiko Thober", "link": "https://stackoverflow.com/users/8795144/heiko-thober"}, "edited": false, "score": 0, "creation_date": 1508390335, "post_id": 46810605, "comment_id": 80593776, "body": "I&#39;d run my code in step-by-step mode and watched the Pending Interrupt Register. There is no Interrupt registered until I write into the BRR register. The Flag is cleared in the ISR, with the HAL function:  HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_0); Should I do this up front after enabling the Interrupt?"}, {"owner": {"reputation": 698, "user_id": 1981374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd547bb1f448490439e0093eba3a70?s=128&d=identicon&r=PG", "display_name": "pan-mroku", "link": "https://stackoverflow.com/users/1981374/pan-mroku"}, "edited": false, "score": 2, "creation_date": 1530880816, "post_id": 46810605, "comment_id": 89401963, "body": "Could you also paste part with EXTI/GPIO initialization? How is <code>GPIO_InitTypeDef.Mode</code> configured? Maybe it&#39;s <code>GPIO_MODE_IT_RISING_FALLING</code>? <a href=\"https://www.st.com/content/ccc/resource/technical/document/user_manual/2f/71/ba/b8/75/54/47/cf/DM00105879.pdf/files/DM00105879.pdf/jcr:content/translations/en.DM00105879.pdf\" rel=\"nofollow noreferrer\">page 57</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6672985, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122244501167676/picture?type=large", "display_name": "Oleksandr", "link": "https://stackoverflow.com/users/6672985/oleksandr"}, "is_accepted": false, "score": 0, "last_activity_date": 1605181671, "creation_date": 1605181671, "answer_id": 64803330, "question_id": 46810605, "link": "https://stackoverflow.com/questions/46810605/external-interrupt-triggered-after-setting-pin/64803330#64803330", "title": "External Interrupt triggered after setting pin", "body": "<p>if TEST_Pin is GPIO_PIN_0 or GPIO_PIN_1 pin, you will receive irq legally. EXTI0_1_IRQHandler catches irq from any port but from #0 or #1 pin.</p>\n"}], "owner": {"reputation": 37, "user_id": 8795144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1666320970046403/picture?type=large", "display_name": "Heiko Thober", "link": "https://stackoverflow.com/users/8795144/heiko-thober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1605181671, "creation_date": 1508330999, "last_edit_date": 1591012772, "question_id": 46810605, "link": "https://stackoverflow.com/questions/46810605/external-interrupt-triggered-after-setting-pin", "title": "External Interrupt triggered after setting pin", "body": "<p>I'm trying to get the external interrupt running on a \n<a href=\"https://www.st.com/content/st_com/en/products/evaluation-tools/product-evaluation-tools/mcu-mpu-eval-tools/stm32-mcu-mpu-eval-tools/stm32-nucleo-boards/nucleo-f030r8.html\" rel=\"nofollow noreferrer\">Nucleo-F030R8</a>\nand hit a wall.</p>\n\n<p>Everything is configured and runs just fine in step mode but when I'm connecting my board to another testboard with a simple jumper wire and run the same code, an External Interrupt is triggered even when that testboard (a second\n<a href=\"https://www.st.com/content/st_com/en/products/evaluation-tools/product-evaluation-tools/mcu-mpu-eval-tools/stm32-mcu-mpu-eval-tools/stm32-nucleo-boards/nucleo-f302r8.html\" rel=\"nofollow noreferrer\">Nucleo-F302R8</a>,\nwhich should only produce a single signal peak that I want to measure with the first) is not turned on. </p>\n\n<p>I'm using a mix of the HAL Library from STM and a bit code of my own. </p>\n\n<p>Has somebody eventually encountered a similar problem?\nI'm using the System Workbench for STM32. </p>\n\n<p>Part of the ISR, Interrupthandler is cut</p>\n\n<pre><code>void EXTI0_1_IRQHandler(void)\n{\n   /* USER CODE BEGIN EXTI0_1_IRQn 0 */\n   if ((EXTI-&gt;IMR &amp; EXTI_IMR_MR0) &amp;&amp; (EXTI-&gt;PR &amp; EXTI_PR_PR0))\n   {\n       int_flag_pin.copen = 1;\n   }\n   if ((EXTI-&gt;IMR &amp; EXTI_IMR_MR1) &amp;&amp; (EXTI-&gt;PR &amp; EXTI_PR_PR1))\n   {\n      int_flag_pin.ma1 = 1;\n   }\n\n   /* USER CODE END EXTI0_1_IRQn 0 */\n   HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_0);\n   HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_1);\n   /* USER CODE BEGIN EXTI0_1_IRQn 1 */\n\n   /* USER CODE END EXTI0_1_IRQn 1 */\n}\n</code></pre>\n\n<p>Between setting the Pin low and change rising, the Interrupt triggers.</p>\n\n<pre><code>TEST_GPIO_Port-&gt;BSRR = (uint32_t) TEST_Pin;\n//HAL_GPIO_WritePin(TEST_GPIO_Port, TEST_Pin, GPIO_PIN_RESET);      \nTEST_GPIO_Port-&gt;BRR = (uint32_t) TEST_Pin;\nchange_rising(0);\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>Could it be that resetting the Pin through <code>BSRR</code> or <code>BRR</code> generates an interrupt?\nI'm checking my code step-by-step and everytime the pin is getting resetted the interrupt is generated.</p>\n"}, {"tags": ["c", "linux", "fork", "exec", "posix"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508337312, "post_id": 46810597, "comment_id": 80572549, "body": "If OpenBlas registers an atfork handler that <i>in general</i> does not work reliably in multi-threaded programs, then OpenBlas is buggy in that regard.  <code>pthread_atfork()</code> has no other intended use case than that one.    If this is indeed an issue with OpenBlas, and you&#39;re not prepared to either fix it yourself or wait for the maintainers to fix it, then your best option may be to choose a different BLAS library."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508338163, "post_id": 46812415, "comment_id": 80573170, "body": "Note that this approach, if available to you in your implementation, is an alternative to calling <code>fork()</code> directly.  It does not address the case of calling <code>fork()</code> indirectly, such as via <code>system()</code> or <code>popen()</code>."}, {"owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508339738, "post_id": 46812415, "comment_id": 80574287, "body": "I guess there is no way to get the code be more platform independent, so e.g. for MacOSX, I would need other code? Another question: If I intend to call <code>exec()</code> right after the <code>fork()</code>, what possible reasons could there be to run any atfork-handlers?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "edited": false, "score": 0, "creation_date": 1508340518, "post_id": 46812415, "comment_id": 80574834, "body": "@Albert But your C library&#39;s fork doesn&#39;t know you are going to exec immediately ;-) Even if it did, it still can&#39;t skip fork handlers as it&#39;s required to run them per documentation. Perhaps, <code>posix_spawn</code> is your best bet if you are looking for portability."}, {"owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1508341077, "post_id": 46812415, "comment_id": 80575237, "body": "@usr: Of course it doesn&#39;t know. But e.g. <code>vfork()</code> seems to do that, like a <code>fork()</code> but without calling the atfork handlers. My question was whether there is any case at all, when I want to call <code>exec()</code> afterwards, that I call the atfork handlers in that case."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1508342108, "post_id": 46812415, "comment_id": 80575998, "body": "The most common use case for <code>pthread_atfork</code> to keep resources (mutexes, condtional vars etc) in a multi-threaded program  in a consistent state in the child process after fork. If you immediately exec, there&#39;s no need to worry about any such inconsistencies - you have totally replaced it with a new process image."}], "tags": [], "owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1508336361, "creation_date": 1508336361, "answer_id": 46812415, "question_id": 46810597, "link": "https://stackoverflow.com/questions/46810597/forkexec-without-atfork-handlers/46812415#46812415", "title": "fork+exec without atfork handlers", "body": "<p>Yes. The following should work on Linux (and, I think, all <code>glibc</code> based platforms):</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n\n...\n  syscall(SYS_fork);\n</code></pre>\n\n<p>This bypasses the library and directly calls the system call for <code>fork</code>. You might run into trouble if your platform does not implement <code>fork</code> as a single system call. For Linux, that simply means that you should use <code>clone</code> instead.</p>\n\n<p>With that in mind, I'm not sure I'd recomment doing that. Since you're a library, you have no idea <em>why</em> someone registered an <code>atfork</code>. Assuming it's irrelevant is bad programming practice.</p>\n\n<p>So you lose portability in order to do something that may or may not break stuff, all in the name of, what? Saving a few function calls? Personally, I'd just use <code>fork</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1508340286, "creation_date": 1508340286, "answer_id": 46813806, "question_id": 46810597, "link": "https://stackoverflow.com/questions/46810597/forkexec-without-atfork-handlers/46813806#46813806", "title": "fork+exec without atfork handlers", "body": "<p>You could use <a href=\"http://man7.org/linux/man-pages/man2/vfork.2.html\" rel=\"nofollow noreferrer\"><code>vfork()</code></a> (NPTL implementation doesn't call fork handlers). Although POSIX has removed <code>vfork</code> from the standard, it's likely available on your implementation.</p>\n\n<blockquote>\n  <p>Fork handlers established using pthread_atfork(3) are not called when\n      a multithreaded program employing the NPTL threading library calls\n      vfork().  Fork handlers are called in this case in a program using\n      the LinuxThreads threading library.  (See pthreads(7) for a\n      description of Linux threading libraries.)</p>\n</blockquote>\n\n<p>Or, <a href=\"http://man7.org/linux/man-pages/man3/posix_spawn.3.html\" rel=\"nofollow noreferrer\"><code>posix_spawn()</code></a>. This is similar to <code>vfork</code>. Man page says:</p>\n\n<blockquote>\n  <p>According to POSIX, it unspecified whether fork handlers established with pthread_atfork(3) are called when posix_spawn() is invoked.  On glibc, fork handlers are called only if the child  is created using fork(2).</p>\n</blockquote>\n\n<p>Or, <code>syscall</code> and directly use <code>SYS_clone</code>. <code>SYS_clone</code> is the system call number used to create threads and processes on Linux. So <code>syscall(SYS_clone, SIGCHLD, 0);</code> should work, provided you would exec immediately.</p>\n\n<p><code>syscall(SYS_fork);</code> (as answered by Shachar) would likely work too. But note that <code>SYS_fork</code> not available on some platforms (e.g., aarch64, ia64). <code>SYS_fork</code> is considered as obsolete in Linux and it's only there for backward compatibility and Linux kernel uses SYS_clone for creating all \"types\" of processes.</p>\n\n<p>(Note: These options are mostly limited to glibc/Linux).</p>\n"}], "owner": {"reputation": 56945, "user_id": 133374, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8337eb6c24313a1e0e81ecae24f20406?s=128&d=identicon&r=PG", "display_name": "Albert", "link": "https://stackoverflow.com/users/133374/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 46813806, "answer_count": 2, "score": 2, "last_activity_date": 1508340286, "creation_date": 1508330983, "last_edit_date": 1508332836, "question_id": 46810597, "link": "https://stackoverflow.com/questions/46810597/forkexec-without-atfork-handlers", "title": "fork+exec without atfork handlers", "body": "<p>I have a library which registers an <code>atfork</code> handler (via <code>pthread_atfork()</code>) which does not support multiple threads when <code>fork()</code> is called. In my case, I don't need the forked environment to be usable because all I want is to call <code>exec()</code> right after the <code>fork()</code>. So, I want the <code>fork()</code> but without any <code>atfork</code> handlers. Is that possible? Do I miss any important edge cases?</p>\n\n<p>For background info, the library is OpenBlas, the issue is described <a href=\"https://github.com/tensorflow/tensorflow/issues/13802\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://trac.sagemath.org/ticket/22021\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["c++", "c", "floating-point", "language-lawyer"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1508331050, "post_id": 46810474, "comment_id": 80568293, "body": "Why not use the <a href=\"http://en.cppreference.com/w/cpp/string/byte/strtof\" rel=\"nofollow noreferrer\">std::strtod</a> in the first place, because C++?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1508331085, "post_id": 46810474, "comment_id": 80568318, "body": "@ron yes, std::strtod could be used, but the question remains the same. And it applies to C and C++."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1508331134, "post_id": 46810474, "comment_id": 80568359, "body": "Try reading some of these (they will start to explain some the floating point and library issues): <a href=\"https://randomascii.wordpress.com/category/floating-point/\" rel=\"nofollow noreferrer\">randomascii.wordpress.com/category/floating-point</a>  especially: <a href=\"https://randomascii.wordpress.com/2013/07/16/floating-point-determinism/\" rel=\"nofollow noreferrer\">randomascii.wordpress.com/2013/07/16/floating-point-determin&zwnj;&#8203;ism</a>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1508331254, "post_id": 46810474, "comment_id": 80568434, "body": "For inf and NaN there are no literals, I suppose you want to exclude those?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 9, "creation_date": 1508331269, "post_id": 46810474, "comment_id": 80568445, "body": "Throwing <a href=\"https://stackoverflow.com/q/588004/4389800\">Is floating point math broken?</a> or <a href=\"http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a> in the face for any question on floating point math is like throwing the C standard for any C question."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1508331278, "post_id": 46810474, "comment_id": 80568450, "body": "@BaummitAugen yes <code>inf</code> and <code>NaN</code>  are excluded."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508331382, "post_id": 46810474, "comment_id": 80568511, "body": "@MichaelWalz&gt; did you try changing the floating point environment to see whether the test still succeeds? Most notably the rounding direction?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1508331399, "post_id": 46810474, "comment_id": 80568523, "body": "I don&#39;t think there&#39;s a definitive answer. This is a QOI issue IMO. I think it most likely will not result in the same binary representation <i>in general</i>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508331423, "post_id": 46810474, "comment_id": 80568542, "body": "@spectras I did a few tests on a few different platforms, the outcome was always the same."}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1508332231, "post_id": 46810474, "comment_id": 80569039, "body": "If you are <i>ever</i> testing two floating point numbers for exact equality, then you are doing something wrong. You should always at least be checking that the difference is less than some epsilon value..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508363632, "post_id": 46810474, "comment_id": 80587183, "body": "@MichaelWalz In your platform testing, consider reporting the value of <code>FLT_EVAL_METHOD</code>.  When 0 or 1, I expect code will report <code>value == 7.7</code>.  When 2, I expect <code>value != 7.7</code>."}], "answers": [{"comments": [{"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1508331817, "post_id": 46810797, "comment_id": 80568779, "body": "@YSC I&#39;m surprised cppreference mentions it. That site is improving every day."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1508331966, "post_id": 46810797, "comment_id": 80568860, "body": "You can actually join the effort: <a href=\"http://en.cppreference.com/w/Cppreference:FAQ#What.3F_This_is_a_wiki.3F_Can_I_change_stuff.3F\" rel=\"nofollow noreferrer\">cppreference is a wiki</a>!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1508332221, "post_id": 46810797, "comment_id": 80569035, "body": "@RichardHodges What is <i>[lex.fcon]</i>?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1508332292, "post_id": 46810797, "comment_id": 80569081, "body": "That certainly sounds like the safest assumption to make.  My experience has been that it&#39;s easy to get burned by things like this.  For one thing, I&#39;m not sure how much I trust the conversion done by <code>fscanf</code> to match the conversion done by the compiler at compile time.  Another is that values sometimes end up in registers, with higher precision than one might expect.  But if the representation is exact in a double, then it seems like it should be safe."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1508332679, "post_id": 46810797, "comment_id": 80569310, "body": "@MichaelWalz it&#39;s the name of a section in the c++ standard."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508352954, "post_id": 46810797, "comment_id": 80581846, "body": "@Tom Yeah relying on that seems incredibly, incredibly fragile. &quot;This code works because X can be represented perfectly by a IEEE-754 double which our compiler happens to guarantee is used for doubles&quot;.."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 18, "last_activity_date": 1508332724, "last_edit_date": 1592644375, "creation_date": 1508331621, "answer_id": 46810797, "question_id": 46810474, "link": "https://stackoverflow.com/questions/46810474/comparing-floating-point-values-converted-from-strings-with-literals/46810797#46810797", "title": "Comparing floating point values converted from strings with literals", "body": "<p>From the c++ standard:</p>\n<blockquote>\n<h3>[lex.fcon]</h3>\n<p>... If the scaled value is in the range\nof representable values for its type, the result is the scaled value if representable, else the larger or smaller\nrepresentable value nearest the scaled value, <strong>chosen in an implementation-defined manner</strong>...</p>\n</blockquote>\n<p>emphasis mine.</p>\n<p>So you can only rely on equality if the value is strictly representable by a double.</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1508332143, "post_id": 46810818, "comment_id": 80568982, "body": "This sounds convincing. So I&#39;ll replace the <code>==</code> with the call to some <code>AmostEqual</code> function."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1508333628, "post_id": 46810818, "comment_id": 80569945, "body": "@MichaelWalz&gt; you tagged both C and C++. I&#39;m wondering whether they agree on that one. In <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\">C99</a>, normative annex F, subsection 7.2 reads: \u201cDuring translation the IEC 60559 default modes are in effect: \u2014 The rounding direction mode is rounding to nearest [...]\u201d. So it would appear your sample code is guaranteed to work in C99, as long as you don&#39;t change the floating point environment of your code."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1508345729, "post_id": 46810818, "comment_id": 80578120, "body": "So, @YSC, your point with respect to C11 is that it is only a recommendation, not a requirement, that the translation-time and runtime conversions agree?"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508346262, "post_id": 46810818, "comment_id": 80578381, "body": "@YSC&gt; the recommendation is about the fact that they should match. However, annex F, which is normative gives the exact rules for translation-time, so by explicitly configuring the floating-point environment with those, the match should be guaranteed."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1508352648, "post_id": 46810818, "comment_id": 80581682, "body": "@Michael One simple reason how this could fail on x86 is that reading a value from memory will only get you 64bit precision, while a value could have 80-bit precision when in a register.Loading a constant might very well be done directly via registers, while the fscanf loaded value might have been stored in memory somewhere. For that reason alone it&#39;s pretty much never safe to assume equality between floats."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508398535, "post_id": 46810818, "comment_id": 80597073, "body": "@spectras a norme about translation-time rules and nothing about execution-time library&#39;s string functions does not guarantee a match ;)"}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": true, "score": 17, "last_activity_date": 1508398758, "last_edit_date": 1508398758, "creation_date": 1508331695, "answer_id": 46810818, "question_id": 46810474, "link": "https://stackoverflow.com/questions/46810474/comparing-floating-point-values-converted-from-strings-with-literals/46810818#46810818", "title": "Comparing floating point values converted from strings with literals", "body": "<p>About C++, <a href=\"http://en.cppreference.com/w/c/language/floating_constant\" rel=\"noreferrer\">from cppreference one can read</a>:</p>\n\n<p><strong><code>[lex.fcon]</code></strong> (\u00a76.4.4.2)</p>\n\n<blockquote>\n  <p>The result of evaluating a floating constant is either the nearest representable value or the larger or smaller representable value immediately adjacent to the nearest representable value, chosen in an implementation-defined manner (in other words, default rounding direction during translation is implementation-defined).</p>\n</blockquote>\n\n<p>Since the representation of a floating literal is unspecified, I guess you cannot conclude about its comparison with a <code>scanf</code> result.</p>\n\n<hr>\n\n<p>About C11 (standard ISO/IEC 9899:2011):</p>\n\n<p><strong><code>[lex.fcon]</code></strong> (\u00a76.4.4.2)</p>\n\n<blockquote>\n  <p><strong>Recommended practice</strong></p>\n  \n  <p>7 The  translation-time  conversion  of  floating  constants  should  match  the  execution-time conversion  of  character  strings  by  library functions,  such  as <code>strtod</code>,  given  matching inputs  suitable  for  both  conversions,  the  same  result  format,  and  default  execution-time\n  rounding.</p>\n</blockquote>\n\n<p>So clearly for C11, this is not guaranteed to match.</p>\n"}, {"comments": [{"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1508343876, "post_id": 46814017, "comment_id": 80577084, "body": "I&#39;d almost upvote, but the <code>union</code> type punning breaks C++ aliasing restrictions (which are a recurring topic also). A well-formed solution would e.g. use <code>memcpy</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1508344110, "post_id": 46814017, "comment_id": 80577249, "body": "@ArneVogel Fair enough about C++.  Yet post is also tagged C which this answer does not break aliasing restrictions.  Given <code>fscanf()</code>, OP code smells more like C than C++."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1508351715, "last_edit_date": 1508351715, "creation_date": 1508340902, "answer_id": 46814017, "question_id": 46810474, "link": "https://stackoverflow.com/questions/46810474/comparing-floating-point-values-converted-from-strings-with-literals/46814017#46814017", "title": "Comparing floating point values converted from strings with literals", "body": "<blockquote>\n  <p>If the string is the same as the literal, will the comparison using <code>==</code> be true in all cases?</p>\n</blockquote>\n\n<p>A common consideration not yet explored: <code>FLT_EVAL_METHOD</code></p>\n\n<pre><code>#include &lt;float.h&gt;\n...\nprintf(\"%d\\n\", FLT_EVAL_METHOD);\n</code></pre>\n\n<blockquote>\n  <p>2 evaluate all operations and constants to the range and precision of the\n  <code>long double</code> type.</p>\n</blockquote>\n\n<p>If this returns 2, then the math used in <code>value == 7.7</code> is <code>long double</code> and <code>7.7</code> treated as <code>7.7L</code>.  In OP's case, this may evaluate to false.</p>\n\n<p>To account for this wider precision, assign values which will removes all extra range and precision.</p>\n\n<pre><code>scanf(file, \"%lf\", &amp;value);\ndouble seven_seven = 7.7;\nif (value == seven_seven)\n  printf(\"strictly equal\\n\");\n</code></pre>\n\n<p>IMO, this is a more likely occurring problem than variant rounding modes or variations in library/compiler conversions.</p>\n\n<hr>\n\n<p>Note that this case is akin to the below, a well known issue.</p>\n\n<pre><code>float value;\nfscanf(file, \"%f\", &amp;value);\nif (value == 7.7)\n   printf(\"strictly equal\\n\");\n</code></pre>\n\n<hr>\n\n<p>Demonstration</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;float.h&gt;\nint main() {\n  printf(\"%d\\n\", FLT_EVAL_METHOD);\n  double value;\n  sscanf(\"7.7\", \"%lf\", &amp;value);\n  double seven_seven = 7.7;\n  if (value == seven_seven) {\n    printf(\"value == seven_seven\\n\");\n  } else {\n    printf(\"value != seven_seven\\n\");\n  }\n  if (value == 7.7) {\n    printf(\"value == 7.7\\n\");\n  } else {\n    printf(\"value != 7.7\\n\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>2\nvalue == seven_seven\nvalue != 7.7\n</code></pre>\n\n<hr>\n\n<p><strong>Alternative Compare</strong></p>\n\n<p>To compare 2 <code>double</code> that are \"near\" each other, we need a definition of \"near\".    A useful approach is to consider all the finite <code>double</code> values sorted into a ascending sequence and then compare their sequence numbers from each other.  <code>double_distance(x, nextafter(x, 2*x)</code> --> 1</p>\n\n<p>Following code makes various assumptions about <code>double</code> layout and size. </p>\n\n<pre><code>#include &lt;assert.h&gt;\n\nunsigned long long double_order(double x) {\n  union {\n    double d;\n    unsigned long long ull;\n  } u;\n  assert(sizeof(double) == sizeof(unsigned long long));\n  u.d = x;\n  if (u.ull &amp; 0x8000000000000000) {\n    u.ull ^= 0x8000000000000000;\n    return 0x8000000000000000 - u.ull;\n  }\n  return u.ull + 0x8000000000000000;\n}\n\nunsigned long long double_distance(double x, double y) {\n  unsigned long long ullx = double_order(x);\n  unsigned long long ully = double_order(y);\n  if (x &gt; y) return ullx - ully;\n  return ully - ullx;\n}\n\n....\nprintf(\"%llu\\n\", double_distance(value, 7.7));                       // 0\nprintf(\"%llu\\n\", double_distance(value, nextafter(value,value*2)));  // 1\nprintf(\"%llu\\n\", double_distance(value, nextafter(value,value/2)));  // 1\n</code></pre>\n\n<p>Or just use</p>\n\n<pre><code>if (nextafter(7.7, -INF) &lt;= value &amp;&amp; value &lt;= nextafter(7.7, +INF)) {\n  puts(\"Close enough\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 2, "last_activity_date": 1508361495, "creation_date": 1508361495, "answer_id": 46819416, "question_id": 46810474, "link": "https://stackoverflow.com/questions/46810474/comparing-floating-point-values-converted-from-strings-with-literals/46819416#46819416", "title": "Comparing floating point values converted from strings with literals", "body": "<p>There's no guarantee. </p>\n\n<p>You can hope that the compiler uses a high quality algorithm for the conversion of literals, and that the standard library implementation uses a high quality conversion as well, and two high quality algorithms should agree quite often. </p>\n\n<p>It's also possible that both use the exact same algorithm (for example, the compiler converts the literal by putting the characters into a char array and calling sscanf. </p>\n\n<p>BTW. I had one bug caused by the fact that a compiler didn't convert the literal 999999999.5 exactly. Replaced it with 9999999995 / 10.0 and everything was fine. </p>\n"}], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 3, "accepted_answer_id": 46810818, "answer_count": 4, "score": 24, "last_activity_date": 1508399055, "creation_date": 1508330607, "last_edit_date": 1508399055, "question_id": 46810474, "link": "https://stackoverflow.com/questions/46810474/comparing-floating-point-values-converted-from-strings-with-literals", "title": "Comparing floating point values converted from strings with literals", "body": "<p><strong>This is not a duplicate of the famous <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\"><em>Is floating point math broken</em></a>, even if it looks like one at first sight.</strong></p>\n\n<p>I'm reading a <code>double</code> from a text file using <code>fscanf(file, \"%lf\", &amp;value);</code> and comparing it with the <code>==</code> operator against a double literal. If the string is the same as the literal, will the comparision using <code>==</code> be <code>true</code> in all cases?</p>\n\n<p><strong>Example</strong></p>\n\n<p>Text file content:</p>\n\n<pre><code>7.7\n</code></pre>\n\n<p>Code snippet:</p>\n\n<pre><code>double value;\nfscanf(file, \"%lf\", &amp;value);     // reading \"7.7\" from file into value\n\nif (value == 7.7)\n   printf(\"strictly equal\\n\");\n</code></pre>\n\n<p>The expected and actual output is</p>\n\n<pre><code>strictly equal\n</code></pre>\n\n<p>But this supposes that the compiler converts the double literal <code>7.7</code> into a double exactly the same way as does the <code>fscanf</code> function, but the compiler may or may not use the same library for converting strings to double.</p>\n\n<p>Or asked otherwise: does the conversion from string to double result in a unique binary representation or may there be slight implementation dependent differences?</p>\n\n<p><strong><a href=\"https://www.ideone.com/HmSuGo\" rel=\"noreferrer\">Live demonstration</a></strong></p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1508330557, "post_id": 46810438, "comment_id": 80567972, "body": "<a href=\"https://stackoverflow.com/a/38325926/2173917\"><code>fflush(stdin);</code> is undefined behavior, don&#39;t do it.</a>"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1508330566, "post_id": 46810438, "comment_id": 80567976, "body": "one side note: Dont flush the stdin its UB."}, {"owner": {"reputation": 351, "user_id": 2635429, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/g9SHx.jpg?s=128&g=1", "display_name": "nattynerdy", "link": "https://stackoverflow.com/users/2635429/nattynerdy"}, "edited": false, "score": 0, "creation_date": 1508330988, "post_id": 46810438, "comment_id": 80568239, "body": "What&#39;s a better way to clear the input buffer between inputs? The answer on that other question, unfortunately, didn&#39;t provide an alternative for clearing the input buffer."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1508331056, "post_id": 46810438, "comment_id": 80568300, "body": "A <code>char array[10][20]</code> is a two dimensional array (with 200 elements). A <code>char **dyn_array</code> is a pointer to a pointer to <code>char</code>. The latter can be used like a two dimensional array as subscript operators work for pointers as well as for arrays. However, the <code>char **dyn_array</code> (if proper allocated) turns strictly speaking out as one-dim. array of one-dim arrays. The rows are not anymore necessarily stored consecutively (which may or may not be important but is at least a fact)."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1508331414, "post_id": 46810438, "comment_id": 80568535, "body": "Whether the rows of a two dimensional array have to be stored consecutively (according to standard; I mean, without padding) has been hardly discussed somewhere on this site. If I only could remember the subject..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1508331479, "post_id": 46810438, "comment_id": 80568578, "body": "The <code>char**</code> version is not an array, see <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>."}, {"owner": {"reputation": 351, "user_id": 2635429, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/g9SHx.jpg?s=128&g=1", "display_name": "nattynerdy", "link": "https://stackoverflow.com/users/2635429/nattynerdy"}, "edited": false, "score": 0, "creation_date": 1508331681, "post_id": 46810438, "comment_id": 80568703, "body": "It is a duplicate, I think. I&#39;ll delete the question"}], "answers": [{"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 3, "last_activity_date": 1508331092, "creation_date": 1508331092, "answer_id": 46810638, "question_id": 46810438, "link": "https://stackoverflow.com/questions/46810438/difference-between-accessing-members-in-char-and-char/46810638#46810638", "title": "Difference between accessing members in char[][] and char**", "body": "<pre><code>char array[10][20];\n</code></pre>\n\n<blockquote>\n  <p>then it is an array of 10 strings, each of length 20.</p>\n</blockquote>\n\n<p>No it is not. It is an array of 10 arrays of 20 chars each. Remind that a c-string is just a sequence of consecutive chars terminated by a <code>NUL</code> one. An array of char may contains a c-string but it is not required.</p>\n\n<blockquote>\n  <p>If I make a similar array with malloc:</p>\n</blockquote>\n\n<pre><code>char **dyn_array = (char **) malloc(10 * sizeof(char *));\n</code></pre>\n\n<p>No, it is not similar, as you just created an array of 10 pointers to chars (for which your stored its address to a pointer). But these pointers (those in the array) are not initialized to anything. To obtain something similar you could have wrote:</p>\n\n<pre><code>for (int i=0; i&lt;10; i++)\n    dyn_array[i] = malloc(20*sizeof(char));\n</code></pre>\n\n<p>Thus, in both cases you can write <code>array[count][index]</code> and <code>dyn_array[count][index]</code>.</p>\n\n<p>But alas you can't write <code>fget(dyn_array[count],sizeof(dyn_array[count],stdin);</code> because in that case <code>dyn_array[count]</code> is not an array but a pointer. Remind that an array can decay to pointer, but pointer is not an array.</p>\n\n<p>There is several questions about pointers vs arrays. Read.</p>\n"}], "owner": {"reputation": 351, "user_id": 2635429, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/g9SHx.jpg?s=128&g=1", "display_name": "nattynerdy", "link": "https://stackoverflow.com/users/2635429/nattynerdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "closed_date": 1508331697, "answer_count": 1, "score": 1, "last_activity_date": 1508331364, "creation_date": 1508330494, "question_id": 46810438, "link": "https://stackoverflow.com/questions/46810438/difference-between-accessing-members-in-char-and-char", "closed_reason": "Duplicate", "title": "Difference between accessing members in char[][] and char**", "body": "<p>If I have an array, like:</p>\n\n<pre><code>char array[10][20];\n</code></pre>\n\n<p>then it is an array of 10 strings, each of length 20. If I make a similar array with malloc:</p>\n\n<pre><code>char **dyn_array = (char **) malloc(10 * sizeof(char *));\n</code></pre>\n\n<p>then how do I access the members? For example, if I had a loop like:</p>\n\n<pre><code>int limit, count=0;\nprintf(\"Enter the limit (max 10): \");\nscanf(\"%d\", &amp;limit);\nfflush(stdin);\nwhile(count &lt; limit)\n{\n    int index = 0;\n    printf(\"\\nEnter characters: \");\n    fgets(array[count], sizeof(array[count]), stdin);\n    fflush(stdin);\n    printf(\"\\nYou typed: \");\n    while(array[count][index] != '\\n' &amp;&amp; \n        array[count][index] != '\\0')\n    {\n        printf(\"%c\", array[count][index]);\n        index += 1;\n    }\n    count += 1;\n}\n</code></pre>\n\n<p>could I replace array with dyn_array in every spot and have it be the same? What changes would I have to make? I know that the way these two kinds of arrays work is similar, but I just can't wrap my head around it.</p>\n"}, {"tags": ["c", "linux", "assembly", "shared-libraries"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508329637, "post_id": 46810114, "comment_id": 80567455, "body": "The linker will by default link with the shared library if there are both a shared and a static library. To force linking statically you need to use the <code>-static</code> option when linking."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508329804, "post_id": 46810114, "comment_id": 80567554, "body": "@Someprogrammerdude, I need to use shared library and as I said I am able to link with static library using mentioned command in post."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508329861, "post_id": 46810114, "comment_id": 80567573, "body": "(as a sidenote, you could declare AES_td as <code>extern const long AES_td[];</code>, it won&#39;t solve your problem, but that would make using it much more natural: <code>printf(&quot;%lu&quot;, AES_td[0])</code>)."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1508330182, "post_id": 46810114, "comment_id": 80567762, "body": "Hm, where exactly is the assembly code located you mention above?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508330235, "post_id": 46810114, "comment_id": 80567802, "body": "But the linker will link with the dynamic library even in that case.That&#39;s the default. It should only link with <code>libcrypto.a</code> if it&#39;s the <i>only</i> <code>crypto</code> library in <code>.&#47;</code>."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508330578, "post_id": 46810114, "comment_id": 80567981, "body": "I have copied the libcrypto.a and libcrypto.so.0.9.8 and libcrypto.so (symlink) in separate folder where test_glob.c is located. Although in original shared library creation time, assembly code is in different folder than .so or .a file ."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 1, "creation_date": 1508337282, "post_id": 46810114, "comment_id": 80572529, "body": "What platform is this? For me the linking simply fails: <code>relocation R_X86_64_PC32 against symbol &#39;AES_Td&#39; can not be used when making a shared object; recompile with -fPIC</code>"}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1508349731, "post_id": 46810114, "comment_id": 80580121, "body": "@bholanath If an answer works for you, don&#39;t copy it into the question. Instead, just accept the answer (with or without upvoting it). If the answer does not solve your problem, use the comments section to ask follow-ups. Only edit the question if the <b>question</b> is incomplete."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1508350378, "post_id": 46810114, "comment_id": 80580493, "body": "@Shachar Shemesh I have accepted your solution as answer as it solved my problem of accessing global label data using shared library. Thank you so much."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1508497520, "post_id": 46810114, "comment_id": 80642854, "body": "@ShacharShemesh, I don&#39;t know what happened, now it is again giving segmentation fault. Thus I deselect the answer."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1508498952, "post_id": 46810114, "comment_id": 80643590, "body": "@bholanath if it worked, it is the solution. If it stopped working, you have another problem, and the best way is to ask a new question."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1508502148, "post_id": 46810114, "comment_id": 80645251, "body": "@ShacharShemesh, I simply rebooted the system and now it is not working. Now I am more confused, do this command gcc -g -L$var -Wall -o dynamic test_glob_modified.c -lcrypto -ldl link to dynamic or static library ? If it linked to dynamic then deletion of libcrypto.a should also worked, but in my case it is not working anymore."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508342245, "post_id": 46812905, "comment_id": 80576089, "body": "I&#39;m pretty sure you don&#39;t need <code>dlsym</code> to access globals from a shared library.  The compiler emits code to get the address from the GOT when you use the value of a global.  <a href=\"https://godbolt.org/g/5M3xWt\" rel=\"nofollow noreferrer\">godbolt.org/g/5M3xWt</a>."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508345259, "post_id": 46812905, "comment_id": 80577859, "body": "@Shachar Shemesh, as I mentioned in my post I am able to access global label AES_Td with static library (libcrypto.a). I am asking for solution to access AES_Td with shared library libcrypto.so.0.9.8 or symlink libtomcrypt.so"}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508345487, "post_id": 46812905, "comment_id": 80577997, "body": "@Shachar Shemesh, do I need to pass -DSTATIC_CRYPTO parameter in ./config command?"}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1508348706, "post_id": 46812905, "comment_id": 80579570, "body": "@PeterCordes yes, but who initializes the GOT entry? For data, that happens by the dynamic linker. Notice, however, that the OP was about code (i.e. - text segment). The dynamic linker does not initialize those entries, instead relying on stubs that do, essentially, what my code does."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508348759, "post_id": 46812905, "comment_id": 80579593, "body": "@bholanath, I&#39;m not sure what <code>.&#47;config</code> is. <code>-DSTATIC_CRYPTO</code> needs to be passed to the compiler compiling the code where you are trying to access AES_Td."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508348969, "post_id": 46812905, "comment_id": 80579704, "body": "@ShacharShemesh: I think the right answer is to tell the OP to put their table in <code>section .rodata</code>, so the dynamic linker will do it for them.  That section (along with the <code>.text</code> section) goes into the text <i>segment</i> of the library.  (Linking, including dynamic linking, cares about sections, not just segments.)  Anyway, good point, I think you&#39;re right that with lazy dynamic linking, the GOT entries for <code>section .text</code> symbols aren&#39;t updated early.  Non-lazy dynamic linking would be another solution, which is supported.  (There&#39;s even <code>gcc -fno-plt</code>)"}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508349411, "post_id": 46812905, "comment_id": 80579950, "body": "@PeterCordes It&#39;s a good solution <i>if</i> OP can do it. I believe he can&#39;t. The numbers he put there disassemble into valid code. I believe the only reason the example looks this way is because he made an MVP, and the original problem is about actual code."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508350102, "post_id": 46812905, "comment_id": 80580330, "body": "I think it&#39;s just data.  It&#39;s definitely not sane x86-64 code; the disassembly includes <code>hlt</code> (halt the machine, privileged instruction) and just doesn&#39;t look sensible.  ARM32 <code>objdump</code> doesn&#39;t make any sense of it either.  Most bit-pattern disassemble to some x86 instructions but that&#39;s just because the coding space is mostly full and many instructions don&#39;t have any reserved bits.  (x86 is a mess after so many years of ISA extensions, but just being a variable-length ISA means it&#39;s natural to use up most of the coding space.)"}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508350114, "post_id": 46812905, "comment_id": 80580337, "body": "@Shachar Shemesh , when I try to compile the above code with -DSTATIC_CRYPTO as you said for static, I got error  AES_Td undeclared."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508350202, "post_id": 46812905, "comment_id": 80580395, "body": "@Shachar Shemesh, I am accepting this answer as It solved my problem of accessing global label using shared library."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508357512, "post_id": 46812905, "comment_id": 80584215, "body": "@bholanath as before, you still need to declare the variable. I&#39;ll amend the answer to incorporate it. It was not meant to be complete."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508496447, "post_id": 46812905, "comment_id": 80642316, "body": "@ShacharShemesh, after I delete the libcrypto.a , libcrypto.so and libcrypto.so.0.9.8 from local folder, I try to compile using  gcc -g -Wall -o dynamic test_.c -lcrypto -ldl -fPIC . Compilation is successful , it means it is able to locate libcrypto.so in /usr/lib folder and link with it (instead of local folder). However, it gives segmentation fault while trying to run. Any suggestion to resolve ?"}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508497614, "post_id": 46812905, "comment_id": 80642908, "body": "@ShacharShemesh, I tried to run again by copying libcrypto.a , libcrypto.so and libcrypto.so.0.9.8 into local folder. I am now getting segmentation fault although yesterday I was able to run and get result. No idea what happened."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1508498865, "post_id": 46812905, "comment_id": 80643553, "body": "This is a new question, but here&#39;s the answer anyways: You need to supply <code>LD_LIBRARY_PATH</code> if you want to load libraries not from the standard path. Next time, ask new questions if you want to solve different problems."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508502311, "post_id": 46812905, "comment_id": 80645337, "body": "@ShacharShemesh, I have supplied LD_LIBRARY_PATH and still I am getting segmentation fault. Also I think without LD_LIBRARY_PATH it shows different error like something not defined in present scope.  I used these, LD_LIBRARY_PATH=$var:$LD_LIBRARY_PATH export LD_LIBRARY_PATH=$var:$LD_LIBRARY_PATH"}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508514832, "post_id": 46812905, "comment_id": 80653048, "body": "@ShacharShemesh, dlsym(RTLD_NEXT,&quot;AES_Td&quot;) returns null. it means it is unable to find AES_Td symbol."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1508518994, "post_id": 46812905, "comment_id": 80655226, "body": "@bholanath thank you for approaching me. As I said above, this is a new question. Feel free to ask it as such, and hope that <i>someone</i> will answer it."}], "tags": [], "owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "is_accepted": false, "score": 2, "last_activity_date": 1508349592, "last_edit_date": 1508349592, "creation_date": 1508337750, "answer_id": 46812905, "question_id": 46810114, "link": "https://stackoverflow.com/questions/46810114/unable-to-access-global-assembly-label-data-from-c-program-linked-with-shared-li/46812905#46812905", "title": "unable to access global assembly label data from c program linked with shared library", "body": "<p>What you're trying to do is not possible in the way you are trying to do.</p>\n\n<p>You cannot try to reference <code>.text</code> area data by absolute value from a shared object. On some platforms it doesn't work, on others it fails the link. For example, on X86_64:</p>\n\n<pre><code>/usr/bin/ld: warning: type and size of dynamic symbol `AES_Td' are not defined\n/usr/bin/ld: /tmp/cc4xpr2u.o: relocation R_X86_64_PC32 against symbol `AES_Td' can not be used when making a shared object; recompile with -fPIC\n/usr/bin/ld: final link failed: Bad value\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>The reason is that text segment code is loaded through a stub that resolves the actual address upon first use. Your direct use of the symbol bypasses this mechanism.</p>\n\n<p>The solution I suggest is to compile the static version with <code>-DSTATIC_CRYPTO</code>. Change the code like so:</p>\n\n<pre><code>#ifdef STATIC_CRYPTO\nextern void* AES_Td;\nvoid** AES_Td_ptr = &amp;AES_Td;\n#else\nvoid** AES_Td_ptr;\n#endif\n\n...\n\n  // Somewhere near the start of the program\n#ifndef STATIC_CRYPTO\n  AES_Td_ptr = dlsym(RTLD_NEXT, \"AES_Td\");\n#endif\n</code></pre>\n\n<p>Access the actual code via the <code>AES_Td_ptr</code> pointer (which simply replaces <code>p</code> in your sample program). In essence, you are manually writing the same code the linker places as stub for regular function access.</p>\n\n<p>Also note that the two methods are exclusive. While <code>AES_Td_ptr = &amp;AES_Td</code> won't work for dynamic linking, it should also be noted that the <code>dlsym</code> method won't work for static linking. You need both if you want to support both.</p>\n\n<p><strong>EDITED TO ADD</strong></p>\n\n<p>If you can change the library you're linking, and the symbol you are looking for is not actually code, then moving it into the <code>.rodata</code> section instead of <code>.text</code> would work with the same code for both static and dynamic linking. If this is not your library, or the symbol actually contains code, then I'm afraid what I wrote is the best you can hope for.</p>\n"}], "owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508502497, "creation_date": 1508329402, "last_edit_date": 1508502497, "question_id": 46810114, "link": "https://stackoverflow.com/questions/46810114/unable-to-access-global-assembly-label-data-from-c-program-linked-with-shared-li", "title": "unable to access global assembly label data from c program linked with shared library", "body": "<p>In my system, I have both static library file (libcrypto.a) and shared library (libcrypto.so.0.9.8). </p>\n\n<p><strong>I am trying to access a global label AES_Td of an assembly file from inside a C program using static library and shared library.</strong> </p>\n\n<pre><code>   //assembly code\n.globl  AES_Td\n.text\n.align  64\nAES_Td:\n    .long   1353184337,1353184337\n    .long   1399144830,1399144830\n    .long   3282310938,3282310938\n    .long   2522752826,2522752826\n .....\n .....\n\n// test_glob.c\n#include &lt;stdio.h&gt; \nextern void* AES_Td ;\n\nint main()\n{\n    long *p;\n    int i;\n    p=(long *)(&amp;AES_Td);\n    printf(\"%p %lu\\n\",p,*p);\n}\n</code></pre>\n\n<p><strong>Success with Static library</strong> </p>\n\n<p>While trying to link with static library, I am able to access the global label.</p>\n\n<pre><code>gcc -L. test_glob.c -lcrypto\n</code></pre>\n\n<p><strong>Segmentation fault with shared library</strong></p>\n\n<p>I am getting following warning message while trying to link with shared library.</p>\n\n<p><strong>/usr/bin/ld: warning: type and size of dynamic symbol `AES_Td' are not defined</strong></p>\n\n<pre><code>var=`pwd` \ngcc -g -L$var -O0 -Wall -o dynamic test_glob.c -lcrypto\n/usr/bin/ld: warning: type and size of dynamic symbol `AES_Td' are not defined\n\nLD_LIBRARY_PATH=$var:$LD_LIBRARY_PATH\nexport LD_LIBRARY_PATH=$var:$LD_LIBRARY_PATH\n\n\n  ./dynamic \nsegmentation fault\n</code></pre>\n\n<p>some post in SO suggest to create symlink to correctly linked with correct version of shared library to resolve the above error/warning message.</p>\n\n<p>However in my case, although there exist symlink, </p>\n\n<pre><code>libcrypto.so -&gt; libcrypto.so.0.9.8\n</code></pre>\n\n<p><strong>still I am getting same warning message and same segmentation fault error with symlink.</strong></p>\n\n<p>I am using gcc in Debian OS.</p>\n\n<p>Any help/link to solve segmentation fault or access above global label with shared library will be highly appreciated.</p>\n\n<p>**EDIT-1: **</p>\n\n<p>As per suggestion of Shachar Shemesh, I have re-compiled the crypto library again as follows</p>\n\n<pre><code>./config -fPIC -shared -DSTATIC_CRYPTO\nmake\n</code></pre>\n\n<p>then copied the libcrypto.a , libcrypto.so and libtomcrypto.so.0.9.8 into local folder.</p>\n\n<p>Then I made changes the c code as follows,</p>\n\n<pre><code>// test_glob_modified.c\n#define _GNU_SOURCE\n#include &lt;dlfcn.h&gt;\n#include &lt;stdio.h&gt;\n#ifdef STATIC_CRYPTO\nextern void* AES_TD;\nvoid** AES_Td_ptr= &amp;AES_Td;\n#else\nvoid** AES_Td_ptr;\n#endif\n\nint main()\n{\n\n#ifndef STATIC_CRYPTO\nAES_Td_ptr=dlsym(RTLD_NEXT,\"AES_Td\");\n#endif\n\n        long *p;\n        int i;\n        p=(long *)(AES_Td_ptr);\n\n        printf(\" %p %lu\\n\", p,*p);\n\n        return 0;\n\n}\n\n\n\n    #Compile and run the source code as follows \n    var=`pwd`\n    gcc -g -L$var -Wall -o dynamic test_glob_modified.c -lcrypto -ldl\n\n   LD_LIBRARY_PATH=$var:$LD_LIBRARY_PATH\n   export LD_LIBRARY_PATH=$var:$LD_LIBRARY_PATH\n    ./dynamic\n</code></pre>\n\n<p>I am still getting Segmentation fault.</p>\n"}, {"tags": ["c", "loops", "mathematical-expressions"], "comments": [{"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 3, "creation_date": 1508328582, "post_id": 46809791, "comment_id": 80566754, "body": "From a superficial inspection, there seems to be no problem; what exactly is the question?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1508328814, "post_id": 46809791, "comment_id": 80566916, "body": "The strict equality comparision in <code>(x - y * sqrt(2016.0)) &#47; (y + sqrt(2016.0)) == 2016</code> looks fishy. See <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">this SO question</a>."}, {"owner": {"reputation": 735, "user_id": 8319826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8832f8f0e262c468180e18311ddd26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Diasiare", "link": "https://stackoverflow.com/users/8319826/diasiare"}, "edited": false, "score": 2, "creation_date": 1508328816, "post_id": 46809791, "comment_id": 80566917, "body": "The code looks good overall, but since sqrt (and floating point maths) isn&#39;t exact you might want to considder comparing with a small margin for error such as <code>fabs((x - y * sqrt(2016.0)) &#47; (y + sqrt(2016.0) ) - 2016) &lt; 0.000001</code> or some other arbitrary margin."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1508328871, "post_id": 46809791, "comment_id": 80566950, "body": "A few observations:  (1) This is floating point, so you are very unlikely to get an exact match.  Instead, you need to allow a margin for error, (2) If you can get close enough to a root, where the function is nearly linear, you can start dividing the search space into intervals, successively narrowing it down, (3) Another approach would be to use Newton&#39;s method.  In any case, you will need at least some understanding the mathematics involved."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1508328895, "post_id": 46809791, "comment_id": 80566963, "body": "Possibly the compiler will optimize this, but you can once calculate <code>sqrt(2016)</code> before starting the loops."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 8, "creation_date": 1508329058, "post_id": 46809791, "comment_id": 80567076, "body": "Why not solve it with math instead? There\u2019s a unique x for every y \u2260 \u2212\u221a2016, it\u2019s not a tough rearrangement."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1508329058, "post_id": 46809791, "comment_id": 80567077, "body": "If this is a real task, you should first solve the equation for one variable, i.e. <code>x = 2060.9*y+90518.2</code>. Now you can find your x and y pairs by simply inserting arbitrary values for y."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1508329082, "post_id": 46809791, "comment_id": 80567091, "body": "Another observation:  The function will probably be better behaved if you multiple both sides by the denominator, eliminating the division entirely and obtaining a linear equation.  In fact, once you do that, you could solve it analytically without the need for a computer at all."}, {"owner": {"reputation": 170, "user_id": 6142378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593e89e4256dd201a541c13e29abdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Dammer15", "link": "https://stackoverflow.com/users/6142378/dammer15"}, "edited": false, "score": 0, "creation_date": 1508329609, "post_id": 46809791, "comment_id": 80567438, "body": "Considering the square root of 2016 is 44.899 it might be pretty tough to find integers that solve that equation.   Its early but if you break that equation down I believe you get 0=sqrt(2016)y+y-x+2016"}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": -1, "last_activity_date": 1508840375, "last_edit_date": 1508840375, "creation_date": 1508329167, "answer_id": 46810039, "question_id": 46809791, "link": "https://stackoverflow.com/questions/46809791/how-to-find-the-numbers-that-satisfy-x-y-sqrt2016-0-y-sqrt2016-0/46810039#46810039", "title": "How to find the numbers that satisfy (x - y * sqrt(2016.0)) / (y + sqrt(2016.0)) = 2016 using loops in C", "body": "<p>The result from operations with floats are in general not exact. \nChange:</p>\n\n<pre><code>if( (x - y * sqrt(2016.0)) / (y + sqrt(2016.0) ) == 2016) \n</code></pre>\n\n<p>to something like</p>\n\n<pre><code>if( fabs((x - y * sqrt(2016.0)) / (y + sqrt(2016.0) ) - 2016) &lt; 0.00000001)\n</code></pre>\n\n<p>where <code>0.00000001</code> is a tolerance chosen by you.</p>\n\n<p>But as pointed out, you don't want to search through the domains of more variables than necessary. Solve the math first. Using Wolfram Alpha <a href=\"http://www.wolframalpha.com/input/?i=(x%20-%20y%20*%20%E2%88%9A%202016)%20%2F%20(y%20%2B%20%E2%88%9A%202016)%20%3D%202016\" rel=\"nofollow noreferrer\">like this</a>  we get y=(x-24192*\u221a14)/(12*(168+\u221a14)) </p>\n"}, {"comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508331395, "post_id": 46810384, "comment_id": 80568518, "body": "Note that both of these values lie well outside the bounds that OP is using for x and y (they&#39;re both negative, and the magnitude of x is far greater than the maximum magnitude OP is checking).  But it&#39;s not really clear from the question what the desired result is."}], "tags": [], "owner": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1508400964, "last_edit_date": 1508400964, "creation_date": 1508330301, "answer_id": 46810384, "question_id": 46809791, "link": "https://stackoverflow.com/questions/46809791/how-to-find-the-numbers-that-satisfy-x-y-sqrt2016-0-y-sqrt2016-0/46810384#46810384", "title": "How to find the numbers that satisfy (x - y * sqrt(2016.0)) / (y + sqrt(2016.0)) = 2016 using loops in C", "body": "<p>Using floating point math and brute force search to \"solve\" this problem is  conceptionally a bad idea. This is because with FP math round-off error propagates in a non-intuitive way, and hence many equations that are solvable in a mathematical sense have no (exact) solution with FP numbers. So using FP math to approximate solutions of mathematical equations is inherently difficult.</p>\n\n<p>I suggest a simplification of the problem before programming.</p>\n\n<p>If one does this and only searches for integer solutions one would find that the only solutions are</p>\n\n<pre><code>x = -2016^2 = -4064256\ny = -2016\n</code></pre>\n\n<p>Why: Just rearrange a bit and obtain</p>\n\n<pre><code>x = 2016*y + (2016 + y)*sqrt(2016)\n</code></pre>\n\n<p>Since sqrt(2016) is not an integer the term in the clause before the sqrt must be zero. Everything else follows from that.</p>\n\n<p>In case a non-integer solution is desired, the above can be used to find the x for every y. Which even enumerates all solutions.</p>\n\n<p>So this shows that simplification of a mathematical problem before attempted solution in a computer is usually mandatory (especially with FP math).</p>\n\n<p>EDIT: In case you look for rational numbers, the same argument can be applied as for the integer case. Since sqrt(2016) is not a rational number, y must also be -2016. So for the rational case, the only solutions are the same as for the integers, i.e,</p>\n\n<pre><code>x = -2016^2 = -4064256\ny = -2016\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1508330635, "post_id": 46810429, "comment_id": 80568011, "body": "Identification of the integer solutions is not so easy with this approach"}, {"owner": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1508330798, "post_id": 46810429, "comment_id": 80568113, "body": "Well he does not say explicitly, but <code>x</code> and <code>y</code> are declared as &#39;int&#39; in his code"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1508330882, "post_id": 46810429, "comment_id": 80568164, "body": "Actually, looking at it now, it&#39;s clear that the only possible integer solution is one in which the roots cancel, which can only occur when y is -2016, which gives x a value of -2016**2."}, {"owner": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1508331015, "post_id": 46810429, "comment_id": 80568265, "body": "I know :-), as I wrote in my answer. Also x is -2016^2 not +."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1508331039, "post_id": 46810429, "comment_id": 80568280, "body": "@AndreasH. Thanks, yes I just caught that myself and fixed my comment."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1508331260, "post_id": 46810429, "comment_id": 80568438, "body": "@AndreasH. Actually, if you look at the ranges OP is using for x and y, there&#39;s no way he could find the integer solution, since (a) both x and y are negative, and (b) the magnitude of x is well beyond the range op is checking."}, {"owner": {"reputation": 4246, "user_id": 1739884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ded6d75d54f7bcfafdd07a6301e2139?s=128&d=identicon&r=PG", "display_name": "Andreas H.", "link": "https://stackoverflow.com/users/1739884/andreas-h"}, "edited": false, "score": 0, "creation_date": 1508331418, "post_id": 46810429, "comment_id": 80568538, "body": "true, the question is very vague in the regard of the domain of the solution"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508345629, "post_id": 46810429, "comment_id": 80578067, "body": "@tom Note OP does say &quot;Number x and y can be rational numbers.&quot; and all finite <code>double</code> are rational."}], "tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": false, "score": 1, "last_activity_date": 1508330452, "creation_date": 1508330452, "answer_id": 46810429, "question_id": 46809791, "link": "https://stackoverflow.com/questions/46809791/how-to-find-the-numbers-that-satisfy-x-y-sqrt2016-0-y-sqrt2016-0/46810429#46810429", "title": "How to find the numbers that satisfy (x - y * sqrt(2016.0)) / (y + sqrt(2016.0)) = 2016 using loops in C", "body": "<p>This is just the equation for a line.  Here's an exact solution:</p>\n\n<pre><code>x = (sqrt(2016) + 2016)*y + 2016*sqrt(2016)\n</code></pre>\n\n<p>For any value of y, x is given by the above.  The x-intercept is:</p>\n\n<pre><code>x = 2016*sqrt(2016)\ny = 0\n</code></pre>\n\n<p>The y-intercept is:</p>\n\n<pre><code>x = 0\ny = -2016*sqrt(2016)/(sqrt(2016)+2016)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 8470819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I81LxVLJKhc/AAAAAAAAAAI/AAAAAAAAAIY/5UOnHNjCu7E/photo.jpg?sz=128", "display_name": "Co_Co", "link": "https://stackoverflow.com/users/8470819/co-co"}, "edited": false, "score": 0, "creation_date": 1508353580, "post_id": 46815861, "comment_id": 80582211, "body": "I forgot to say that x, y \u2208 Q (not just an int, but i thought it would be ok with an int number)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 73, "user_id": 8470819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I81LxVLJKhc/AAAAAAAAAAI/AAAAAAAAAIY/5UOnHNjCu7E/photo.jpg?sz=128", "display_name": "Co_Co", "link": "https://stackoverflow.com/users/8470819/co-co"}, "edited": false, "score": 0, "creation_date": 1508356597, "post_id": 46815861, "comment_id": 80583735, "body": "@Co_Co post said &quot;Number x and y can be rational numbers.&quot;  All integers and finite <code>double</code> are rational numbers.  There is only 1 rational solution to the math problem - it happens to be a pair of integers.."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 73, "user_id": 8470819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I81LxVLJKhc/AAAAAAAAAAI/AAAAAAAAAIY/5UOnHNjCu7E/photo.jpg?sz=128", "display_name": "Co_Co", "link": "https://stackoverflow.com/users/8470819/co-co"}, "edited": false, "score": 0, "creation_date": 1508380325, "post_id": 46815861, "comment_id": 80591431, "body": "@Tom Karzes What part of the answer do you find objectionable?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": -1, "last_activity_date": 1508348984, "last_edit_date": 1508348984, "creation_date": 1508347414, "answer_id": 46815861, "question_id": 46809791, "link": "https://stackoverflow.com/questions/46809791/how-to-find-the-numbers-that-satisfy-x-y-sqrt2016-0-y-sqrt2016-0/46815861#46815861", "title": "How to find the numbers that satisfy (x - y * sqrt(2016.0)) / (y + sqrt(2016.0)) = 2016 using loops in C", "body": "<blockquote>\n  <p>numbers that satisfy (x - y * sqrt(2016.0)) / (y + sqrt(2016.0)) = 2016 </p>\n</blockquote>\n\n<p>Starting with <a href=\"https://stackoverflow.com/a/46810429/2410359\">@Tom Karzes</a></p>\n\n<pre><code>x = (sqrt(2016) + 2016)*y + 2016*sqrt(2016)\n</code></pre>\n\n<p>Let y = -2016</p>\n\n<pre><code>x = (sqrt(2016) + 2016)*-2016 + 2016*sqrt(2016)\nx = 2016*-2016 = -4064256\n</code></pre>\n\n<p>So x,y = <strong>-4064256, -2016</strong> is one exact solution.</p>\n\n<p>With math, this is the only one.<br>\nWith <code>sqrt(x)</code> not being exactly \u221ax and peculiarities of <code>double</code> math, there may be other solutions that pass a C code simulation.</p>\n\n<hr>\n\n<p>As a C simulation like OP's, lets us \"guess\" the answer's <code>x,y</code> are both multiples of 2016 and may be negative.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\ndouble f(int x, int y) {\n  double z = (x - y * sqrt(2016.0)) / (y + sqrt(2016.0));\n  z = z - 2016;\n  return z * z;\n}\n\n#define M 3000\nint main() {\n  double best_diff = DBL_MAX;\n  int best_x = 0;\n  int best_y = 0;\n  int x, y;\n  for (x = -M; x &lt; M; x++) {\n    for (y = -M; y &lt; M; y++) {\n      double diff = f(x * 2016, y * 2016);\n      if (diff &lt; best_diff) {\n        best_diff = diff;\n        best_x = x;\n        best_y = y;\n      }\n      if (diff == 0) {\n        printf(\"Numbers are: %d and %d.\\n\",  best_x*2016, best_y*2016);\n      }\n    }\n  }\n  if (best_diff != 0.0) {\n    printf(\"Numbers are: %d and %d --&gt; %e.\", best_x*2016, best_y*2016, best_diff);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Numbers are: -4064256 and -2016.\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8470819, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I81LxVLJKhc/AAAAAAAAAAI/AAAAAAAAAIY/5UOnHNjCu7E/photo.jpg?sz=128", "display_name": "Co_Co", "link": "https://stackoverflow.com/users/8470819/co-co"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1508840375, "creation_date": 1508328342, "last_edit_date": 1508333288, "question_id": 46809791, "link": "https://stackoverflow.com/questions/46809791/how-to-find-the-numbers-that-satisfy-x-y-sqrt2016-0-y-sqrt2016-0", "title": "How to find the numbers that satisfy (x - y * sqrt(2016.0)) / (y + sqrt(2016.0)) = 2016 using loops in C", "body": "<p>I'm trying to find numbers that satisfy the clause (x - y * \u221a 2016) / (y + \u221a 2016) = 2016.\nNumber x and y  can be rational numbers.</p>\n\n<p>That's what I already tried:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\nint x, y;\n    for(x = 1; x &lt; 10000; x++) {\n        for(y = 1; y &lt; 10000; y++) {\n            if( (x - y * sqrt(2016.0)) / (y + sqrt(2016.0) ) == 2016) {\n                printf(\"Numbers are: %d and %d.\", x, y);\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "valgrind"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1508327764, "post_id": 46809561, "comment_id": 80566235, "body": "What compiler are you using? What options are you passing to it when compiling? Because e.g. GCC should be able to detect it and issue a warning (with suitable options)."}, {"owner": {"reputation": 758, "user_id": 1252095, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a940555421f72e7f364fca7604661161?s=128&d=identicon&r=PG", "display_name": "begemotv2718", "link": "https://stackoverflow.com/users/1252095/begemotv2718"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508327950, "post_id": 46809561, "comment_id": 80566355, "body": "mipsel gcc. It does produce warning, but of course I&#39;m trying to find problems in much larger program, not in the minimal example above."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1508328052, "post_id": 46809561, "comment_id": 80566418, "body": "And you don&#39;t get a warning for the larger program? Because if you <i>do</i> get a warning the compiler will tell you where so it should be easy to find such issues. It&#39;s also issues like this that makes many turn warnings into errors."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1508328235, "post_id": 46809561, "comment_id": 80566533, "body": "With <code>-Wall</code> option, gcc produces a warning : <a href=\"http://coliru.stacked-crooked.com/a/9102ff69d556e5b6\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/9102ff69d556e5b6</a> and with <code>-Werror</code> transforms warning in error, which forces you to correct it to compile"}, {"owner": {"reputation": 758, "user_id": 1252095, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a940555421f72e7f364fca7604661161?s=128&d=identicon&r=PG", "display_name": "begemotv2718", "link": "https://stackoverflow.com/users/1252095/begemotv2718"}, "edited": false, "score": 0, "creation_date": 1508328369, "post_id": 46809561, "comment_id": 80566619, "body": "Easy to say, difficult to follow;). No, the project will not build with -Werror, and this is not entirely my fault."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1508328571, "post_id": 46809561, "comment_id": 80566748, "body": "Absolutly not, I always realize professional project like that, and I avoid this kind of surprise. Warning aren&#39;t simple fancy of compiler, it&#39;s hint about bug prone software. And also, it answers your question, because it detects what you want to find (<code>-Werror</code> isn&#39;t mandatory, you can just parse output of compiler to find warning you want)"}, {"owner": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 2, "creation_date": 1508328622, "post_id": 46809561, "comment_id": 80566781, "body": "Most probably, compiler optimized out the return_stack_allocated_value function and main() is simply puts(&quot;Result: Test test test\\n&quot;). As valgrind operates on the binary produced, it does not report any problem, because it sees none..."}], "owner": {"reputation": 758, "user_id": 1252095, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a940555421f72e7f364fca7604661161?s=128&d=identicon&r=PG", "display_name": "begemotv2718", "link": "https://stackoverflow.com/users/1252095/begemotv2718"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508327654, "creation_date": 1508327654, "question_id": 46809561, "link": "https://stackoverflow.com/questions/46809561/valgrind-does-not-report-returning-pointer-to-stack-allocated-string", "title": "Valgrind does not report returning pointer to stack allocated string", "body": "<p>I'm working with valgrind 3.12 for mips (mipsel) platform. I found that in the following example: </p>\n\n<pre><code>static char * return_stack_allocated_value(void)\n{\n   char x[100];\n   snprintf(x,100,\"Test test test\");\n   return x;\n}\n\nint main()\n{\n   char *bad;\n   bad = return_stack_allocated_value();\n   printf(\"Result: %s\\n\",bad);\n}\n</code></pre>\n\n<p>valgrind does not report any error in this, although we can no longer use pointer to bad.</p>\n\n<p>I run valgrind with the following options</p>\n\n<pre><code>--10-- Valgrind options:                                                                                                                                                                                \n--10--    --main-stacksize=16777216                                                                                                                                                                     \n--10--    --malloc-fill=0xab                                                                                                                                                                            \n--10--    --free-fill=0x70                                                                                                                                                                              \n--10--    --leak-check=full                                                                                                                                                                             \n--10--    --leak-resolution=high                                                                                                                                                                        \n--10--    --num-callers=50                                                                                                                                                                              \n--10--    --trace-children=yes                                                                                                                                                                          \n--10--    --track-origins=yes                                                                                                                                                                           \n--10--    --log-file=/tmp/test_%p.log   \n</code></pre>\n\n<p>Is it possible to spot such problems with valgrind? What options should be used?</p>\n"}, {"tags": ["c", "linux", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1508325978, "post_id": 46808952, "comment_id": 80565122, "body": "You initialize one mutex which you never lock and then try to lock a different one that you never initialized."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1508326498, "post_id": 46809094, "comment_id": 80565424, "body": "Since you&#39;re using just one <code>task()</code> function, another option could be something like <code>void *task(void *arg)  {     static pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER; ...</code>  Note the modification to <code>static</code> and the use of an initializer."}], "tags": [], "owner": {"reputation": 39, "user_id": 7802035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e04e60f14efc0359628bdd651005e5?s=128&d=identicon&r=PG&f=1", "display_name": "LAXO", "link": "https://stackoverflow.com/users/7802035/laxo"}, "is_accepted": false, "score": 0, "last_activity_date": 1508328505, "last_edit_date": 1508328505, "creation_date": 1508326030, "answer_id": 46809094, "question_id": 46808952, "link": "https://stackoverflow.com/questions/46808952/error-pthread-mutex-lock-failed-invalid-argument/46809094#46809094", "title": "ERROR - pthread_mutex_lock() failed: Invalid argument", "body": "<p>Already found the answer, in the thread i needed to make a pointer, params->mutex because of my structure, and because of that i didn't need to declare the mutex again </p>\n\n<pre><code>void *task(void *arg) \n{\n    // cast para o tipo de dados enviado pela 'main thread'\n    thread_params_t *params = (thread_params_t *) arg;\n//inicio sec\u00e7\u00e3o critica \n\n    if ( (errno = pthread_mutex_lock(&amp;params-&gt;mutex)) != 0)\n        ERROR(C_ERRO_MUTEX, \"pthread_mutex_lock() failed\");\n\n    int cont = params-&gt;contador;\n    sched_yield();\n    params-&gt;contador = cont + 1000 ;\n\n//fim sec\u00e7\u00e3o critica\n    if ( (errno = pthread_mutex_unlock(&amp;params-&gt;mutex)) != 0) \n        ERROR(C_ERRO_MUTEX, \"pthread_mutex_unlock() failed\");\n\n\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7802035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e04e60f14efc0359628bdd651005e5?s=128&d=identicon&r=PG&f=1", "display_name": "LAXO", "link": "https://stackoverflow.com/users/7802035/laxo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1471, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508328505, "creation_date": 1508325486, "question_id": 46808952, "link": "https://stackoverflow.com/questions/46808952/error-pthread-mutex-lock-failed-invalid-argument", "title": "ERROR - pthread_mutex_lock() failed: Invalid argument", "body": "<p>I'm trying to make a program that runs 200 threads and increments 1000 times on each thread, therefore in the end the result must be 200000\nthis while using mutex</p>\n\n<p>I compile the code with no warnings but then when i run the program it gives me this error: ERROR - pthread_mutex_lock() failed: Invalid argument</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;pthread.h&gt;\n\n#include \"debug.h\"\n#include \"memory.h\"\n\n#define NUM_THREADS 200\n\n#define C_ERRO_PTHREAD_CREATE           1\n#define C_ERRO_PTHREAD_JOIN             2\n#define C_ERRO_MUTEX_INIT               3\n#define C_ERRO_MUTEX_DESTROY            4\n#define C_ERRO_MUTEX                    5\n\nvoid *task(void *arg);\n\ntypedef struct \n{\n    int contador;\n    pthread_mutex_t mutex;\n}thread_params_t;\n\n\nint main(int argc, char *argv[])\n{\n    pthread_t tids[NUM_THREADS];\n    thread_params_t thread_params;\n\n    /* Disable warnings */\n    (void)argc; (void)argv;\n\n    /*      Mutex   */\n    if ((errno = pthread_mutex_init(&amp;thread_params.mutex, NULL)) != 0)\n        ERROR(C_ERRO_MUTEX_INIT, \"pthread_mutex_init() failed!\");\n    /*      Contador    */\n    thread_params.contador = 0; \n\n    // Cria\u00e7\u00e3o das threads + passagem de parametro\n    for (int i = 0; i &lt; NUM_THREADS; i++){\n        if ((errno = pthread_create(&amp;tids[i], NULL, task, &amp;thread_params)) != 0)\n            ERROR(10, \"Erro no pthread_create()!\");\n    }\n\n    // Espera que todas as threads terminem\n    for (int i = 0; i &lt; NUM_THREADS; i++){\n        if ((errno = pthread_join(tids[i], NULL)) != 0)\n            ERROR(11, \"Erro no pthread_join()!\\n\");\n    }\n\n    /* Mostra valor do campo contador */\n    printf(\"Contador = %d\\n\", thread_params.contador);\n\n    /* Destroi o mutex */\n    if ((errno = pthread_mutex_destroy(&amp;thread_params.mutex)) != 0)\n        ERROR(C_ERRO_MUTEX_DESTROY, \"pthread_mutex_destroy() failed!\");         \n\n    return 0;\n}\n\n// Thread\nvoid *task(void *arg) \n{\n    pthread_mutex_t mutex;\n    // cast para o tipo de dados enviado pela 'main thread'\n    thread_params_t *params = (thread_params_t *) arg;\n\n    usleep(100*(random() % 2)); /* Adormece entre 0 a 100 usecs */\n\n//inicio sec\u00e7\u00e3o critica \n\n    if ( (errno = pthread_mutex_lock(&amp;mutex)) != 0)\n        ERROR(C_ERRO_MUTEX, \"pthread_mutex_lock() failed\");\n\n    int cont = params-&gt;contador;\n    sched_yield();\n    usleep(100*(random() % 2)); /* Adormece entre 0 a 100 usecs */\n    params-&gt;contador = cont + 1000 ;\n\n//fim sec\u00e7\u00e3o critica\n    if ( (errno = pthread_mutex_unlock(&amp;mutex)) != 0) \n        ERROR(C_ERRO_MUTEX, \"pthread_mutex_unlock() failed\");\n\n\n    return NULL;\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "binary-search-tree"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1508324905, "post_id": 46808751, "comment_id": 80564431, "body": "If you haven&#39;t yet, then this is the perfect time to learn how to use a <i>debugger</i> and how to use it (and other techniques) to <i>debug</i> your program. I suggest you take some time to read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> by Eric Lippert."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1508324972, "post_id": 46808751, "comment_id": 80564479, "body": "And also compile with warnings on. For example, you don&#39;t return anything from <code>getNewNode</code>, when you should return the new node."}, {"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "edited": false, "score": 0, "creation_date": 1508325602, "post_id": 46808751, "comment_id": 80564861, "body": "Try to work on fixing the indentation of your code - this will help both you and the future reader of your code."}], "answers": [{"tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 5, "last_activity_date": 1508329322, "last_edit_date": 1508329322, "creation_date": 1508325009, "answer_id": 46808822, "question_id": 46808751, "link": "https://stackoverflow.com/questions/46808751/binary-search-tree-does-not-recognize-values-properly/46808822#46808822", "title": "Binary Search Tree does not recognize values properly", "body": "<p>You are missing that</p>\n\n<pre><code>num =scanf(\"%d\");\n</code></pre>\n\n<p>doesn't do what you think it does (scanf returns the number of items successfully converted or -1 on <code>EOF</code>). You didn't crank your compiler's warning level high enough to tell you that you need</p>\n\n<pre><code>if (scanf (\"%d\", &amp;num) != 1) {\n    /* complain */\n}\n</code></pre>\n\n<p>In your broken program, scanf() happens to return 1 (because it converted 1 item and wrote it to random memory) and since there's a 1 in the tree, you always get true.</p>\n"}, {"comments": [{"owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "edited": false, "score": 0, "creation_date": 1508326214, "post_id": 46808916, "comment_id": 80565249, "body": "Please add <code>scanf(&quot;%d&quot;,&amp;num);</code> to your answer. Because it was also a problem after fixing <code>return newNode;</code>"}, {"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "reply_to_user": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "edited": false, "score": 0, "creation_date": 1508328522, "post_id": 46808916, "comment_id": 80566720, "body": "I have started my answer with <code>In addition to the error pointed out by @Jens</code> and I realize this is a problem, but that error was not spotted by me. Jens&#39; answer gives enough detail on that and I don&#39;t see value in duplicating his explanation in my answer"}], "tags": [], "owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "is_accepted": false, "score": 3, "last_activity_date": 1508325357, "creation_date": 1508325357, "answer_id": 46808916, "question_id": 46808751, "link": "https://stackoverflow.com/questions/46808751/binary-search-tree-does-not-recognize-values-properly/46808916#46808916", "title": "Binary Search Tree does not recognize values properly", "body": "<p>In addition to the error pointed out by @Jens you are not returning a value from <code>getNewNode</code>. Add a statement:</p>\n\n<pre><code>return newNode;\n</code></pre>\n\n<p>at the end of that function. Here is a <a href=\"https://ideone.com/mffptR\" rel=\"nofollow noreferrer\">fixed example on ideone</a></p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1508328396, "last_edit_date": 1508328396, "creation_date": 1508327577, "answer_id": 46809539, "question_id": 46808751, "link": "https://stackoverflow.com/questions/46808751/binary-search-tree-does-not-recognize-values-properly/46809539#46809539", "title": "Binary Search Tree does not recognize values properly", "body": "<p>For starters according to the C Standard the function <code>main</code> without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>The function <code>getNewNode</code></p>\n\n<pre><code>BSTnode *getNewNode(int data){\n    BSTnode *newNode = (BSTnode*)malloc(sizeof(BSTnode));\n    newNode-&gt;data=data;\n    newNode-&gt;left=newNode-&gt;right=NULL;\n    }\n</code></pre>\n\n<p>has undefined behavior because it returns nothing though has the return type <code>BSTnode *</code>.</p>\n\n<p>The function can be defined the following way</p>\n\n<pre><code>BSTnode * getNewNode( int data )\n{\n    BSTnode *newNode = ( BSTnode * )malloc( sizeof( BSTnode ) );\n\n    if ( newNode != NULL )\n    {\n        newNode-&gt;data = data;\n        newNode-&gt;left = newNode-&gt;right = NULL;\n    }\n\n    return newNode;\n}\n</code></pre>\n\n<p>The function <code>InsertNew</code> is wrong.Take into account that for binary search tree there is usually used the operator <code>&lt;</code> instead of the operator <code>&lt;=</code>. </p>\n\n<p>These statements</p>\n\n<pre><code>root-&gt;left = InsertNew(root-&gt;left,data);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>root-&gt;right = InsertNew(root-&gt;right,data); \n</code></pre>\n\n<p>do not make sense and overwrites the values of <code>root-&gt;left</code> and <code>root-&gt;right</code>  of nodes that shall not be actually changed. Also  the created node can be equal to NULL and in this case the original root node will be also overwritten by NULL.</p>\n\n<p>It is better to pass the original root node by reference through pointer.</p>\n\n<p>Also you should use <code>operator &lt;</code> instead of the <code>operator &lt;=</code>.</p>\n\n<p>The function definition can look the following way</p>\n\n<pre><code>BSTnode * InsertNew( BSTnode **root,int data )\n{\n    if ( *root == NULL )\n    {\n        *root = getNewNode( data );\n        return *root;\n    }\n    else if ( data &lt; ( *root )-&gt;data )\n    {\n        return InsertNew( &amp;( *root-&gt;left ), data );\n    } \n    else\n    {\n        return InsertNew( &amp;( *root-&gt;right ), data );\n    }\n}\n</code></pre>\n\n<p>and the function can be called like</p>\n\n<pre><code>InsertNew( &amp;root, 34 );\n</code></pre>\n\n<p>without assigning the return pointer to the root node. The return value can be checked in an if statement if it is needed.</p>\n\n<p>If you do not want to have duplicate values in the tree then the function can be written the following way</p>\n\n<pre><code>BSTnode * InsertNew( BSTnode **root,int data )\n{\n    if ( *root == NULL )\n    {\n        *root = getNewNode( data );\n        return *root;\n    }\n    else if ( data &lt; ( *root )-&gt;data )\n    {\n        return InsertNew( &amp;( *root-&gt;left ), data );\n    } \n    else if ( ( *root )-&gt;data &lt; data )\n    {\n        return InsertNew( &amp;( *root-&gt;right ), data );\n    }\n    else\n    {\n        return NULL;\n    }\n}\n</code></pre>\n\n<p>Correspondingly the function <code>search</code> should be defined like</p>\n\n<pre><code>bool search( BSTnode *root, int data )\n{\n    if ( root == NULL ) \n    {\n        return false;\n    }\n    else if ( data &lt; root-&gt;data ) \n    {\n        return search( root-&gt;left, data );\n    }\n    else if ( root-&gt;data &lt; data )\n    {\n        return search( root-&gt;right, data );\n    }\n    else\n    {\n        return true;\n    }\n}\n</code></pre>\n\n<p>The using of the function <code>scanf</code> in this statement</p>\n\n<pre><code>num =scanf(\"%d\");\n</code></pre>\n\n<p>is wrong.</p>\n\n<p>The correct call will look like</p>\n\n<pre><code>printf( \"enter a number : \" );\nscanf( \"%d\", &amp;num );\n</code></pre>\n\n<p>You can also check whether the call was successful by using the condition in an if statement</p>\n\n<pre><code>if ( scanf( \"%d\", &amp;num ) == 1 )\n{\n    //...\n}\n</code></pre>\n\n<p>And you should free all allocated memory for the tree before exiting the program.</p>\n\n<p>In general it is better to use the following condition</p>\n\n<pre><code>if(search(root,num) ){\n</code></pre>\n\n<p>instead of the strict comparison with true</p>\n\n<pre><code>if(search(root,num)==true){\n</code></pre>\n\n<p>because if the function will be rewritten such a way that in the case of success it will return any non-zero value then the strict comparison with <code>true</code> will not work.</p>\n"}], "owner": {"reputation": 2299, "user_id": 3760216, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gEcRI.jpg?s=128&g=1", "display_name": "Sachith Muhandiram", "link": "https://stackoverflow.com/users/3760216/sachith-muhandiram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1508329322, "creation_date": 1508324767, "question_id": 46808751, "link": "https://stackoverflow.com/questions/46808751/binary-search-tree-does-not-recognize-values-properly", "title": "Binary Search Tree does not recognize values properly", "body": "<p>I am trying to implement a Binary Serach Tree using C. Here in this code I added few values to the tree and then trying to check whether that values is in the tree. But my attempted code always return true.</p>\n\n<p>I have checked many times. I am still learning C programming.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\ntypedef struct BSTnode {\n    int data;\n    struct BSTnode *left;\n    struct BSTnode *right;\n    } BSTnode;\n\nBSTnode *getNewNode(int data){\n    BSTnode *newNode = (BSTnode*)malloc(sizeof(BSTnode));\n    newNode-&gt;data=data;\n    newNode-&gt;left=newNode-&gt;right=NULL;\n    }\nBSTnode* InsertNew(BSTnode *root,int data){\n    if(root == NULL){\n        root = getNewNode(data);\n                }\n        else if(data &lt;= root-&gt;data){\n            root-&gt;left = InsertNew(root-&gt;left,data);\n            } else{\n                root-&gt;right = InsertNew(root-&gt;right,data);\n                }\n        return root;\n        }\n\nbool search(BSTnode *root, int data){\n    if(root== NULL) return false;\n    else if(root-&gt;data == data) return true;\n    else if (data &lt;= root-&gt;data) return search(root-&gt;left,data);\n    else return search(root-&gt;right,data);\n\n    }\nint main()\n{\n//node to store root\n\nBSTnode *root = NULL;\n\nroot = InsertNew(root,34);\nroot = InsertNew(root,4);\nroot = InsertNew(root,3);\nroot = InsertNew(root,1);\n\nint num;\nprintf(\"enter a number : \\n\");\nnum =scanf(\"%d\");\n\nif(search(root,num)==true){\n    printf(\"found\");\n    }else{\n    printf(\"not found\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>What am I missing here?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "loops", "while-loop", "getchar"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 6, "creation_date": 1508324383, "post_id": 46808604, "comment_id": 80564136, "body": "<code>char *desired[100];</code> -&gt; <code>char desired[100];</code>. Also turn on compiler warnings  (<code>gcc -Wall ...</code>) and pay attention to them !"}, {"owner": {"reputation": 7, "user_id": 1621164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c21941b6ca3fe753c39c15125e9e4f51?s=128&d=identicon&r=PG", "display_name": "Adam Pl\u0161ek", "link": "https://stackoverflow.com/users/1621164/adam-pl%c5%a1ek"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1508324450, "post_id": 46808604, "comment_id": 80564175, "body": "thanks, i missed that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 4, "creation_date": 1508324461, "post_id": 46808604, "comment_id": 80564180, "body": "1.) <code>printf(&quot;%s&quot;, desired);</code> &lt;- you can&#39;t guarantee <code>desired</code> is a string here, it probably doesn&#39;t contain a terminating <code>\\0</code> byte! 2.) your inner loop will happily overflow <code>desired</code>, add a check!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1508324493, "post_id": 46808604, "comment_id": 80564198, "body": "And don&#39;t forget that <code>char</code> strings in C are really called <b><i>null-terminated</b> byte strings</i>. That <i>null-terminator</i> Is important to not forget."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1508325107, "creation_date": 1508325107, "answer_id": 46808857, "question_id": 46808604, "link": "https://stackoverflow.com/questions/46808604/c-using-getchar-in-double-while-loop-stuck-in-loop/46808857#46808857", "title": "C : using getchar() in double while loop - stuck in loop?", "body": "<p>Your outer loop ends when <code>crawler</code> is <code>EOF</code>.</p>\n\n<p>Your inner loop ends when <code>crawler</code> is <code>'\\n'</code> or <code>EOF</code>.</p>\n\n<p>Only the inner loop reads input (by calling <code>getchar</code>).</p>\n\n<p>Therefore: As soon as the first <code>'\\n'</code> is read, the inner loop is never re-entered (the condition rejects <code>'\\n'</code>), but the outer loop doesn't end, and it never changes the value of <code>crawler</code>.</p>\n\n<p>Result: The outer loop spins without reading any input.</p>\n"}], "owner": {"reputation": 7, "user_id": 1621164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c21941b6ca3fe753c39c15125e9e4f51?s=128&d=identicon&r=PG", "display_name": "Adam Pl\u0161ek", "link": "https://stackoverflow.com/users/1621164/adam-pl%c5%a1ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 46808857, "answer_count": 1, "score": 0, "last_activity_date": 1508325492, "creation_date": 1508324294, "last_edit_date": 1508325492, "question_id": 46808604, "link": "https://stackoverflow.com/questions/46808604/c-using-getchar-in-double-while-loop-stuck-in-loop", "title": "C : using getchar() in double while loop - stuck in loop?", "body": "<p>Im using this double while loop. Im new to C.</p>\n\n<pre><code>int crawler;\nchar *desired[100];\n\ncrawler = getchar();\n\nwhile(crawler != EOF) {\n\n    int i = 0;\n\n    while((crawler != '\\n') &amp;&amp; (crawler != EOF)) {\n        desired[i] = crawler;\n        i++;\n        crawler = getchar();\n    }\n\n    printf(\"%s\", desired);\n\n}\n</code></pre>\n\n<p>I just dont see why Im getting infinite loop in here (LLLLLLLLL..). Stdin looks like this:</p>\n\n<pre><code>Lorem(newline)\nIpsum(newline)\nBeach(newline)\nCrocodile(newline)\nCrox(newline)\nC(EOF)\n</code></pre>\n\n<p>Any idea? thanks.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1508324294, "post_id": 46808589, "comment_id": 80564093, "body": "Not in standard C."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508324363, "post_id": 46808589, "comment_id": 80564130, "body": "C doesn&#39;t have things like function expressions (also known as lambda functions)."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508326769, "post_id": 46808589, "comment_id": 80565581, "body": "You should post your update as an answer. Clever use of gcc extensions, by the way."}, {"owner": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "edited": false, "score": 0, "creation_date": 1508327400, "post_id": 46808589, "comment_id": 80565982, "body": "(for deleted comment) i&#39;m always wonder how people try to use specific solution for every tool... it is not about word  saving, but about less errors for code"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1508327972, "post_id": 46808589, "comment_id": 80566373, "body": "Overall, this sounds like a &quot;XY problem&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "edited": false, "score": 0, "creation_date": 1508333493, "post_id": 46809691, "comment_id": 80569846, "body": "can i make initialization in local static scope and make a global pointer to this local one?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "edited": false, "score": 0, "creation_date": 1508337910, "post_id": 46809691, "comment_id": 80572992, "body": "@VasilySukhoparov Not sure what you mean with &quot;local static scope&quot;. The above applies for any variable with <i>static storage duration</i>: that is, all variables declared at file scope (&quot;globals&quot;) and all variables declared as <code>static</code>. If you have a plain local variable (automatic storage duration), you can of course point to it from elsewhere, though the local variable will eventually go out of scope, and after that the pointer will point at garbage."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "edited": false, "score": 0, "creation_date": 1508338004, "post_id": 46809691, "comment_id": 80573056, "body": "@VasilySukhoparov What is the actual problem you are trying to solve? Why is the supposed input to your <code>const</code> variable in a weird format? Why can&#39;t you correct it?"}, {"owner": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "edited": false, "score": 0, "creation_date": 1508339376, "post_id": 46809691, "comment_id": 80574037, "body": "i wanted global &#39;const structure&#39;, where all system parameters described, smth like &#39;min, max, value address, check function&#39;. const coz all constants goes to flash of mcu and dont need ram. i wanted to implement &#39;check function&#39; with lambda coz some parameters have influence on each other, but i do not want to make separate function declaration and definition."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "edited": false, "score": 0, "creation_date": 1508339575, "post_id": 46809691, "comment_id": 80574177, "body": "@VasilySukhoparov Then the best solution that C provides, might be to declare each such constant as a <code>#define</code> numeric macro. These macros can be relative to each other and can include various arithmetic - as long as they are constant expressions they will still be evaluated at compile-time. And your actual struct initialization will become straight-forward, as it just uses the macro names."}, {"owner": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "edited": false, "score": 0, "creation_date": 1508340233, "post_id": 46809691, "comment_id": 80574628, "body": "this is also option, just thought there is an existin language feature. btw i have tested my code (UPD1) with assignment local varible to global. it works as i wanted. debug also shows where code executed. but this is quite not safe and maybe not clear"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1508328001, "creation_date": 1508328001, "answer_id": 46809691, "question_id": 46808589, "link": "https://stackoverflow.com/questions/46808589/initialize-struct-with-function-defined-in-initializer-in-c/46809691#46809691", "title": "Initialize struct with function defined in initializer in C", "body": "<p>To begin with, you can't even initialize a variable with static storage duration to anything but constant expressions. That won't compile, neither with or without your made-up \"lambda\" syntax. You'll have to place the variable declaration at local scope.</p>\n\n<p>Once at local scope, you can simply type <code>.check_value = value&gt;10?value:10</code> in the initializer list.</p>\n"}], "owner": {"reputation": 21, "user_id": 6324321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ySajum4RGv8/AAAAAAAAAAI/AAAAAAAABK0/mYtZjVEfxhU/photo.jpg?sz=128", "display_name": "Vasily Sukhoparov", "link": "https://stackoverflow.com/users/6324321/vasily-sukhoparov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1508331515, "creation_date": 1508324247, "last_edit_date": 1508331515, "question_id": 46808589, "link": "https://stackoverflow.com/questions/46808589/initialize-struct-with-function-defined-in-initializer-in-c", "title": "Initialize struct with function defined in initializer in C", "body": "<p>For example i have:</p>\n\n<pre><code>typedef struct {\n    uint32_t* param_ptr;\n    uint32_t (*check_value)(uint32_t);\n} Parameter;\n\nuint32_t a = 8;\nconst Parameter work = { .param_ptr = &amp;a, .check_value =  (uint32_t value) {return value&gt;10?value:10;} };\n\nint main1(void) {\n    //check\n    *work.param_ptr = work.check_value(*work.param_ptr);\n}\n</code></pre>\n\n<p>I want to declare 'mini' function inside struct initialization. As there a lot of 'parameters' i don't want to declare separate functions and their body, and pass it's name to initialization. Anyway to do so?</p>\n\n<hr>\n\n<p>UPD1:</p>\n\n<pre><code>#define lambda(return_type, function_body) \\\n({ \\\n      return_type __fn__ function_body \\\n          __fn__; \\\n})\n\ntypedef struct {\n    uint32_t* param_ptr;\n    uint32_t (*check_value)(uint32_t);\n} Parameter;\n\nuint32_t a = 8;\n\nvoid main(void) {\n    Parameter work = { .param_ptr = &amp;a, .check_value = lambda(uint32_t, (uint32_t value){return value &gt; 10 ? value : 10;}) };\n    *work.param_ptr = work.check_value(*work.param_ptr);\n}\n</code></pre>\n\n<p>Thanks for comments, i found familiar QA by keyword. Well, this way it works fine, but some cons - it is not global constant and thus saved in RAM, not FLASH of my mcu. (tool GNU C11)</p>\n"}, {"tags": ["python", "c", "windows", "subprocess", "ipc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1508324043, "post_id": 46808459, "comment_id": 80563974, "body": "&quot;<i>just shows when I close the program</i>&quot; &lt;- e.g. disable <code>stdio</code> buffering: <code>setvbuf(stdout, 0, _IONBF, 0);</code> -- or use lower-level OS functions for writing instead of <code>stdio</code> functions like <code>printf()</code>"}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "edited": false, "score": 0, "creation_date": 1508324211, "post_id": 46808459, "comment_id": 80564054, "body": "Message Queue would be the best option for this kind of requirement. You will get lots of open source MQ for windows. Get one and try."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "edited": false, "score": 1, "creation_date": 1508324646, "post_id": 46808459, "comment_id": 80564286, "body": "@Abhijit why? For just two processes exchanging byte streams, simple pipes do the job perfectly well."}, {"owner": {"reputation": 49793, "user_id": 4014959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdqQJ.jpg?s=128&g=1", "display_name": "PM 2Ring", "link": "https://stackoverflow.com/users/4014959/pm-2ring"}, "edited": false, "score": 1, "creation_date": 1508324656, "post_id": 46808459, "comment_id": 80564289, "body": "Does the manufacturer supplied C library compile a DLL library? If so, it should be possible to call the library functions directly from Python using the <code>ctypes</code> module. That should be more efficient than using subprocess and pipes to interact with a C program."}, {"owner": {"reputation": 41, "user_id": 8794977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63bb5aa2623ba0770755b4a64d6fe698?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas S.", "link": "https://stackoverflow.com/users/8794977/thomas-s"}, "edited": false, "score": 0, "creation_date": 1508325513, "post_id": 46808459, "comment_id": 80564808, "body": "Well, thank you all for these amazingly fast comments :) By using unbuffered output I am now able to continously stream data output to my python program and display it. But because the kbhit function in my C program fires everytime I hit the keyboard in any application, my C program returns an error because it actually has not recieved any input. So I just need a method to read nonblocking from stdin."}, {"owner": {"reputation": 41, "user_id": 8794977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63bb5aa2623ba0770755b4a64d6fe698?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas S.", "link": "https://stackoverflow.com/users/8794977/thomas-s"}, "reply_to_user": {"reputation": 49793, "user_id": 4014959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdqQJ.jpg?s=128&g=1", "display_name": "PM 2Ring", "link": "https://stackoverflow.com/users/4014959/pm-2ring"}, "edited": false, "score": 0, "creation_date": 1508325848, "post_id": 46808459, "comment_id": 80565047, "body": "@PM2Ring It actually is a DLL but it just seemed easier to write a self contained C program and communicate the results to a python program than to emulate all the C Datatypes and import the library with ctypes.. But I might be wrong here, just don&#39;t have any experience using the ctypes module"}, {"owner": {"reputation": 49793, "user_id": 4014959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdqQJ.jpg?s=128&g=1", "display_name": "PM 2Ring", "link": "https://stackoverflow.com/users/4014959/pm-2ring"}, "edited": false, "score": 0, "creation_date": 1508327002, "post_id": 46808459, "comment_id": 80565730, "body": "<code>ctypes</code> can be a little daunting at first, but since you can program in C you should have no trouble following the docs. How many different C <code>struct</code>s do you need to talk to that DLL? If there are lots of them it will be a little tedious to create Python versions, but the process is quite straight-forward. FWIW, <a href=\"https://stackoverflow.com/a/26878137/4014959\">here&#39;s an example</a> I wrote a few years ago which works on both Windows &amp; Linux that interfaces with the OpenSSL library."}], "owner": {"reputation": 41, "user_id": 8794977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63bb5aa2623ba0770755b4a64d6fe698?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas S.", "link": "https://stackoverflow.com/users/8794977/thomas-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 656, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508323828, "creation_date": 1508323828, "question_id": 46808459, "link": "https://stackoverflow.com/questions/46808459/ipc-between-python-and-c-on-windows", "title": "IPC between Python and C on Windows", "body": "<p>I'm trying to establish communication between a Python program and a C program.\nThe Python part of this project manages the application logic and the GUI, while I have written a C program to interface with a sensor that has a manufacturer supplied C library.\nNow I need an easy way of communicating between these two programs on a Windows machine. The C program will continously stream data to the Python program. The Python software should be able to send commands to the C software for changing settings etc.</p>\n\n<p>What I found so far is:</p>\n\n<ul>\n<li>the ZeroMQ library which seemed pretty promising, but I could not get it to run on windows and it seems to not be mantained anymore.</li>\n<li>the Python subprocess module which is able to pipe the stdin and stdout of the called process, but I don't seem to get it working like I want it to..</li>\n</ul>\n\n<p>The C code I have written now is just a dummy program that streams an output string and prints any commands that are given. The problem is, that the data from the C program does not continously stream to the output of the python program but just shows when I close the program. Also I'm not able to send a command back to the c program.</p>\n\n<p>-Python Code:</p>\n\n<pre><code>import subprocess as subp\n\npro = subp.Popen(\"C:/Users/schoenhofer/Documents/Programming/Py2C/simpleIO/bin/Debug/simpleIO.exe\",\n                 stdin=subp.PIPE, stdout=subp.PIPE, bufsize=-1, universal_newlines=True)\n\n\nwhile not pro.poll():\n    ln = pro.stdout.read()\n\n    if ln == '':\n        pro.kill()\n        break\n    else:\n        print(ln)\n</code></pre>\n\n<p>-C code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;memory.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;time.h&gt;\n\nvoid delay(unsigned int mseconds)\n{\n    clock_t goal = mseconds + clock();\n    while (goal &gt; clock());\n}\n\nint main()\n{\n    TCHAR buf[20] = {0};\n    DWORD dwLength, dwRead;\n    DWORD got = 0;\n    uint16_t i = 0;\n    LPDWORD mode = 0;\n    HANDLE h_in = GetStdHandle(STD_INPUT_HANDLE);\n\n    if(h_in == INVALID_HANDLE_VALUE){\n        printf(\"Error getting input handle\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    dwLength = sizeof(buf);\n\n    SetConsoleMode(h_in, ENABLE_PROCESSED_INPUT|ENABLE_LINE_INPUT|ENABLE_EXTENDED_FLAGS);\n    while(1){\n\n        if(kbhit()){\n            if(ReadConsole(h_in, buf, dwLength, &amp;got, NULL) == 0){\n                DWORD err = GetLastError();\n                printf(\"Error reading from console: %u\", err);\n                exit(EXIT_FAILURE);\n            }\n        }\n        if(got &gt; 0){\n            printf(\"Got: %s\", buf);\n             memset(buf, 0, 20);\n             got = 0;\n        }\n        else{\n            printf(\"Got nothing\\n\");\n        }\n        delay(300);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Any help would be greatly appreciated.\nThanks in advance, Thomas</p>\n"}, {"tags": ["c", "multithreading", "synchronization", "pthreads"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1508321184, "post_id": 46807586, "comment_id": 80562251, "body": "Shouldn&#39;t these <code>int a, b, c;</code> variables be volatile?"}, {"owner": {"reputation": 127, "user_id": 487618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/527349c700176f6b02efa50e4daa5767?s=128&d=identicon&r=PG", "display_name": "Juan M Rivas", "link": "https://stackoverflow.com/users/487618/juan-m-rivas"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1508321676, "post_id": 46807586, "comment_id": 80562543, "body": "@usr I simplified the code here, the real code has bigger chunks that execute in parallel"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508321792, "post_id": 46807586, "comment_id": 80562622, "body": "Without even looking in depth, 2 mutexes for one synchronisation job seem fishy."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1508322359, "post_id": 46807586, "comment_id": 80562941, "body": "The usual: a) serializing two threads is pointless b) Mutex is the wrong synchro for this, and I don&#39;t uderstand why so may peple keep trying it - it still doesn&#39;t work, every time.  c)  Use two semaphores.  Swap around one &#39;execution permit&#39; between the threads."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 1, "creation_date": 1508322450, "post_id": 46807586, "comment_id": 80563003, "body": "You might want to read wikipedia&#39;s <a href=\"https://en.wikipedia.org/wiki/Barrier_(computer_science)\" rel=\"nofollow noreferrer\">barrier</a> article."}, {"owner": {"reputation": 127, "user_id": 487618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/527349c700176f6b02efa50e4daa5767?s=128&d=identicon&r=PG", "display_name": "Juan M Rivas", "link": "https://stackoverflow.com/users/487618/juan-m-rivas"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1508322733, "post_id": 46807586, "comment_id": 80563150, "body": "@MartinJames thanks, the semaphores seems to be the solution"}, {"owner": {"reputation": 127, "user_id": 487618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/527349c700176f6b02efa50e4daa5767?s=128&d=identicon&r=PG", "display_name": "Juan M Rivas", "link": "https://stackoverflow.com/users/487618/juan-m-rivas"}, "reply_to_user": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508322795, "post_id": 46807586, "comment_id": 80563188, "body": "@spectras thanks, I considered using barriers, but they are not implemented in the OSX implementation of pthreads for example"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1508322988, "post_id": 46807586, "comment_id": 80563312, "body": "@JuanMRivas&gt; it&#39;s not something provided, it&#39;s a concept/algorithm that you can implement to block multiple threads until they have all reached a specific point. (be careful not to confuse with &quot;memory barrier&quot; by the way, they share nothing but the word itself)"}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1508337968, "post_id": 46807586, "comment_id": 80573033, "body": "@usr Thanks for the link. :-)"}], "answers": [{"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 0, "last_activity_date": 1508703023, "creation_date": 1508703023, "answer_id": 46878685, "question_id": 46807586, "link": "https://stackoverflow.com/questions/46807586/how-to-make-a-pthread-signal-another-that-it-can-continue-executing/46878685#46878685", "title": "How to make a pthread signal another that it can continue executing?", "body": "<pre><code>pthread_mutex_t mutex1, mutex2 = PTHREAD_MUTEX_INITIALIZER\n</code></pre>\n\n<p>Only initializes the second one; but that is a nit.  Depending upon the system you are running, you might not notice this, because mutex1 is uninitialized, thus the operations on it may be failing, or the initializer constant could be zero....</p>\n\n<p>The signal/wait problem is not a problem -- you wait upon a condition protected by a mutex, in this pattern:</p>\n\n<pre><code>lock();\nwhile (check() == false) {\n    wait();\n}\nfunc();\nsignal();\nunlock();\n</code></pre>\n\n<p>so thread1\u2019s check would be true, and func would be c = 7\nwhile thread2\u2019s check would be (c == 7) and func would be c += 10</p>\n"}], "owner": {"reputation": 127, "user_id": 487618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/527349c700176f6b02efa50e4daa5767?s=128&d=identicon&r=PG", "display_name": "Juan M Rivas", "link": "https://stackoverflow.com/users/487618/juan-m-rivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 46878685, "answer_count": 1, "score": 0, "last_activity_date": 1508703023, "creation_date": 1508320961, "question_id": 46807586, "link": "https://stackoverflow.com/questions/46807586/how-to-make-a-pthread-signal-another-that-it-can-continue-executing", "title": "How to make a pthread signal another that it can continue executing?", "body": "<p>I have three integers (a, b and c), and I'd like to create two threads (<strong>POSIX pthreads</strong>) to access them in this particular sequence to keep the results consistent:</p>\n\n<pre><code>Thread 1  |  Thread 2\n---------------------\na=1          b=5\nc=7\n             c=c+10\n             b=a+c*2\na=b+b*10\n</code></pre>\n\n<p>That is, c=c+10 in thread2 must wait until c=7 in thread1 finishes. Also a=b+b*10 in thread1 must wait until b=a+c*2 in thread2 finished.</p>\n\n<p>I have tried using mutexes, but it does not work as I intend (code below). If thread2 starts first, it can lock mutex1 before thread1 has locked it, so the sequencing is lost. Locking the mutex from the main thread is not an option, as it would yield an undefined behavior (mutex locked and then unlocked by a different thread). I've also tried using conditional variables, but a similar problem arises: a signal can happen before the associated wait.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\nint a, b, c;\npthread_mutex_t mutex1, mutex2 = PTHREAD_MUTEX_INITIALIZER;\n\nvoid *thread1(void *arg) {\n    pthread_mutex_lock(&amp;mutex1);\n    a = 1;\n    c = 7; \n    pthread_mutex_unlock(&amp;mutex1);\n    pthread_mutex_lock(&amp;mutex2);\n    a = b + b*10; \n    pthread_exit(NULL);\n}\n\nvoid *thread2(void *arg) {\n    pthread_mutex_lock(&amp;mutex2);\n    b = 5;\n    pthread_mutex_lock(&amp;mutex1);\n    c = c + 10;\n    b = a + c*2;\n    pthread_mutex_unlock(&amp;mutex2);\n    pthread_exit(NULL);\n}\n\nint main() {\n    pthread_t t1, t2;\n\n    if(pthread_create(&amp;t1, NULL, thread1, NULL)) {\n        fprintf(stderr, \"Error creating Thread 1\\n\");\n        return 0;\n    }\n    if(pthread_create(&amp;t2, NULL, thread2, NULL)) {\n        fprintf(stderr, \"Error creating Thread 2\\n\");\n        return 0;\n    }\n\n    pthread_join(t1, NULL);\n    pthread_join(t2, NULL);\n\n    return a;\n}\n</code></pre>\n\n<p>My question is, what is correct way to achieve the thread sequencing I want using pthreads? Thanks in advance.</p>\n"}, {"tags": ["c", "windows", "filesystems", "wildcard", "filenames"], "comments": [{"owner": {"reputation": 41796, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "edited": false, "score": 1, "creation_date": 1508320050, "post_id": 46807163, "comment_id": 80561569, "body": "AFAIK, the program that automatically loops over <i>.</i>, as code behind them. You can always achieve same behavior, by writing codes"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 6, "creation_date": 1508320111, "post_id": 46807163, "comment_id": 80561603, "body": "There is no standard in the C language. Argument expansion (if any) is done by the shell. Typically Unix/Linux shells do the expansion, but the Windows cmd doesn&#39;t. So the Windows programs where the expansion takes place do this themselves, they receive e.g. &quot;*.txt&quot; in <code>argv[1]</code> and then they do the directory listing themselves and process each file found."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1508320500, "post_id": 46807163, "comment_id": 80561848, "body": "... <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa364418(v=vs.85).aspx\" rel=\"nofollow noreferrer\">FindFirstFile</a> and friends do the job."}, {"owner": {"reputation": 5293, "user_id": 357313, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/46fea76226a83ce93a03efb491a4737d?s=128&d=identicon&r=PG", "display_name": "Michel de Ruiter", "link": "https://stackoverflow.com/users/357313/michel-de-ruiter"}, "edited": false, "score": 1, "creation_date": 1508320699, "post_id": 46807163, "comment_id": 80561963, "body": "Which compiler do you use? The library might include a way to do this for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 2, "creation_date": 1508321611, "post_id": 46807163, "comment_id": 80562511, "body": "<a href=\"https://docs.microsoft.com/en-us/cpp/cpp/wildcard-expansion\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/cpp/wildcard-expansion</a> provides some info and a link that shows how you can do this if you&#39;re using the MS Visual C++ compiler. For MinGW-w64, <a href=\"https://sourceforge.net/p/mingw-w64/mingw-w64/ci/master/tree/mingw-w64-crt/crt/crtexe.c#l52\" rel=\"nofollow noreferrer\">there appears to be an implementation-specific global variable <code>_dowildcard</code></a> that may allow you to do this; my guess is that it defaults to 0 as the internal <a href=\"https://sourceforge.net/p/mingw-w64/mingw-w64/ci/master/tree/mingw-w64-crt/crt/dll_argv.c\" rel=\"nofollow noreferrer\"><code>__setargv</code>/<code>__wsetargv</code> function in <code>dll_argv.c</code></a> sets it to 1."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1508321819, "post_id": 46807163, "comment_id": 80562629, "body": "That said, Michael Walz is correct: there is no standard for this behavior, and some of this may change at any time as it changes the ordinary behavior of a program on Windows. You&#39;re wandering into implementation-specific territory."}, {"owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 1, "creation_date": 1508330860, "post_id": 46807163, "comment_id": 80568147, "body": "Windows doesn&#39;t really need to provide a standardized way to do shell filename globbing, because it wasn&#39;t conceived of as a system with a strong command line. If you want to get more Unix-like shell globbing on Windows, you could work with Cygwin or Windows 10 Linux Subsystem (WSL). Although there is, as others have pointed out, no actual standards in C in this area, I suggest that there is enough commonality in behaviour that filename expansion can be relied on in Cygwin, WSL, Linux, BSD, etc. If you&#39;re writing a GUI app, you probably don&#39;t need it anyway."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1508339544, "post_id": 46807163, "comment_id": 80574153, "body": "<a href=\"https://unix.stackexchange.com/a/398464/50557\">unix.stackexchange.com/a/398464/50557</a> is a related answer (but focus on Unix like OSes mostly)"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 0, "creation_date": 1508371667, "post_id": 46807163, "comment_id": 80589485, "body": "@KevinBoone, NT can&#39;t reasonably support shell globbing anyway. The process command line is limited to 32766 characters, so shell globs that produce hundreds or thousands of files might get truncated. However, it&#39;s unnecessary for the shell to do this because NT filesystems reserve the 5 wildcard characters -- i.e. asterisk, question mark, less than (<code>DOS_STAR</code>), greater than (<code>DOS_QM</code>), and double quote (<code>DOS_DOT</code>) -- and <code>NtQueryDirectoryFile</code> (the low-level system call for listing a directory) passes the filesystem a <code>FileName</code> filter, for which it should support wildcard matching."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1508372014, "post_id": 46807163, "comment_id": 80589581, "body": "i.e. we want consistency between applications in how they handle globbing from the command line. In Unix the shell provides the consistent implementation, and there may be inconsistencies between shells. In Windows it&#39;s handled in the filesystem, and there may be inconsistencies between filesystems. Hopefully all filesystem implementations on Windows use common runtime library routines such as <a href=\"https://msdn.microsoft.com/en-us/library/ff546850\" rel=\"nofollow noreferrer\"><code>FsRtlIsNameInExpression</code></a>; certainly Microsoft&#39;s do."}, {"owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 0, "creation_date": 1508395017, "post_id": 46807163, "comment_id": 80595249, "body": "I agree entirely. I was only pointing out that, if you want to do command-line work on Windows, you aren&#39;t necessarily constrained to use the build-it shell these days. And if you&#39;re building a GUI app, you most likely aren&#39;t all that concerned with filename expansion."}], "answers": [{"tags": [], "owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "is_accepted": false, "score": 0, "last_activity_date": 1513636375, "creation_date": 1513636375, "answer_id": 47877396, "question_id": 46807163, "link": "https://stackoverflow.com/questions/46807163/in-argv1-in-c/47877396#47877396", "title": "*.* in argv[1] in C", "body": "<p>No, there is no standard way to do this. Something has to process '<em>.</em>' inside the main function. However, there may be some libraries derived outside of the main C library body, that are doing what you need to do. Also, you may write a batch file that will loop through the set of files and call the C written application as described in <a href=\"https://stackoverflow.com/questions/8397674/windows-batch-file-looping-through-directories-to-process-files\">Windows Batch File Looping Through Directories to Process Files?</a></p>\n"}], "owner": {"reputation": 28647, "user_id": 1422096, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/da3871bf5450fa726f20557fa3f18f51?s=128&d=identicon&r=PG", "display_name": "Basj", "link": "https://stackoverflow.com/users/1422096/basj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1513636375, "creation_date": 1508319648, "last_edit_date": 1508339348, "question_id": 46807163, "link": "https://stackoverflow.com/questions/46807163/in-argv1-in-c", "title": "*.* in argv[1] in C", "body": "<p>Background: Some Windows command-line programs allow to use <code>*.*</code> in their 1st argument:</p>\n\n<pre><code>myprogram *.*\n</code></pre>\n\n<p>and will automatically loop on all files of the directory. </p>\n\n<p>Some others don't, thus requiring a batch loop:</p>\n\n<pre><code>for %%c in (\"*.*\") do myprogram \"%%c\"\n</code></pre>\n\n<p>Question: <strong>Is there a standard way (defined in the C language or provided by OS?) to allow <code>*.*</code> or <code>*.txt</code> in the argument, so that it would do the processing automatically on the relevant files?</strong></p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    FILE *kf;\n\n    \"for fname in argv[1]\"    // pseudo code here meaning: \n                              // let's loop on all files described by the first argument\n    {\n        kf = fopen(fname, \"rb\");\n        ...\n    }\n}\n</code></pre>\n\n<p>I wanted to check if a solution for this exists, before rolling my own (reinventing the wheel of wildcard expansion, using FindFirstFile, etc.)</p>\n"}, {"tags": ["c", "arrays", "sizeof", "comma", "c11"], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1508319943, "post_id": 46807155, "comment_id": 80561505, "body": "Reference is C11 6.3.2.1/3: &quot;Except when it is the operand of the <code>sizeof</code> operator, the <code>_Alignof</code> operator, or the unary <code>&amp;</code> operator, or is a string literal used to initialize an array, an expression that has type \u2018\u2018array of type\u2019\u2019 is converted to an expression with type \u2018\u2018pointer to type\u2019\u2019 that points to the initial element of the array object and is not an lvalue.&quot;"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1508320526, "post_id": 46807155, "comment_id": 80561860, "body": "This is a wonky issue, but the fact that there is the comma operator and a sequence point between evaluation of <code>b</code> and <code>a</code> may cause conflict with that reference C11 6.5.17/2 Comma operator. I don&#39;t know the answer, but it seems that <code>a</code> would be converted to a pointer if <code>b</code> is evaluated as a void pointer injecting a sequence point."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1508320661, "post_id": 46807155, "comment_id": 80561941, "body": "@DavidC.Rankin neither b nor a is evaluated, since they are part of the operand of sizeof.  Sequence points have nothing to do with this"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1508320816, "post_id": 46807155, "comment_id": 80562029, "body": "C11 6.5.17/3 says a comma operator cannot appear as arguments to a function. Now <code>sizeof</code> isn&#39;t per se a function. I&#39;ll certainly defer to your interpretation here. I don&#39;t know, but want to make sure I clearly understand -- and with the competing comments and answer -- I do not :(  And all I can do is read, the standard says &quot;<i>The left operand of a comma operator is evaluated as a void expression</i>&quot;... &quot;<i>Then the right operand is evaluated;</i>&quot;"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1508323260, "post_id": 46807155, "comment_id": 80563491, "body": "<i>&quot;this explanation&quot;</i> is sitting on an exact duplicate. Why didn&#39;t you vote to close?"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 11, "last_activity_date": 1508321470, "last_edit_date": 1508321470, "creation_date": 1508319633, "answer_id": 46807155, "question_id": 46807113, "link": "https://stackoverflow.com/questions/46807113/behavior-of-comma-operator-in-sizeof-operator-in-c/46807155#46807155", "title": "Behavior of &quot;comma&quot; operator in sizeof() operator In C", "body": "<p>In most cases, arrays decay into pointers. So the type of <code>b,a</code>  with a comma operator is a <code>char*</code> (not a <code>char[20]</code> anymore). And pointers are 8 bytes on your machine.</p>\n\n<p>BTW, I think that using <code>sizeof</code> on some comma operator is really confusing to the reader. I recommend using <code>sizeof</code> on simple expressions or on types.</p>\n\n<p><sup>(and I just discovered this is one of the tricky differences between C and C++; see <a href=\"https://stackoverflow.com/a/5766397/841108\">this explanation</a>)</sup></p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 3, "creation_date": 1508321463, "post_id": 46807383, "comment_id": 80562423, "body": "<i><code>sizeof(b, a)</code> examines the complete expression <code>b, a</code></i>... Technically, <code>sizeof(b, a)</code> examines the complete expression <code>(b, a)</code>. But interestingly and confusingly enough, <code>sizeof((a))</code> would still produce a value of <code>20</code>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1508323041, "post_id": 46807383, "comment_id": 80563353, "body": "<code>sizeof(b, a) examines the complete expression b, a</code> I think the parenthesis are the first evaluated and then sizeof will evaluate the result. Isn&#39;t it ?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1508323270, "post_id": 46807383, "comment_id": 80563500, "body": "@Michi parentheses (in this context) are not an operator"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508323788, "post_id": 46807383, "comment_id": 80563820, "body": "@M.M I never said that :). I was speaking about what happens inside those parenthesis and this is first evaluated and only after SIZEOF evaluates the result. Or I&#39;m wrong."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508324386, "post_id": 46807383, "comment_id": 80564141, "body": "@M.M Any way <a href=\"https://ideone.com/ijUcKz\" rel=\"nofollow noreferrer\">this was my point</a>, when I said that first will be the content of those parenthesis evaluated and then <code>sizeof</code> evaluates the result."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1508329367, "post_id": 46807383, "comment_id": 80567278, "body": "True-   <code>sizeof(b,a)</code> evaluates the size of the result from the expression <code>(b,a)</code>.  Syntactically <code>sizeof(int)</code> requires the <code>()</code> around the type name (so <code>sizeof int</code> is invalid) while <code>sizeof expression</code> does not require <code>()</code> and the <code>()</code>, if used, are part of the expression.  I&#39;ll edit to reflect that shortly."}, {"owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "edited": false, "score": 0, "creation_date": 1508333912, "post_id": 46807383, "comment_id": 80570157, "body": "@Peter Thanks for answer."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": true, "score": 12, "last_activity_date": 1508329654, "last_edit_date": 1508329654, "creation_date": 1508320354, "answer_id": 46807383, "question_id": 46807113, "link": "https://stackoverflow.com/questions/46807113/behavior-of-comma-operator-in-sizeof-operator-in-c/46807383#46807383", "title": "Behavior of &quot;comma&quot; operator in sizeof() operator In C", "body": "<p>The comma operator has no special meaning to <code>sizeof</code>.</p>\n\n<p><code>sizeof(b, a)</code>  examines the complete expression <code>(b, a)</code>, works out the resultant type, and computes the size of that type without actually evaluating <code>(b , a)</code>.   As noted by chqrlie in comments, the <code>()</code> are part of the expression for which the size (of the result) is evaluated.</p>\n\n<p>In this case, <code>b</code> is a <code>char</code> and <code>a</code> is an array.    If the expression <code>b, a</code> was to be evaluated, <code>b</code> would be evaluated first, the result discarded.   Then <code>a</code> would converted to a pointer (<code>char *</code>) with value equal to <code>&amp;a[0]</code> which would be the result of the expression <code>(b, a)</code>.</p>\n\n<p>Since the result of <code>b, a</code> is of type <code>char *</code>,  <code>sizeof(b,a)</code> is equal to <code>sizeof (char *)</code>.   That is an implementation defined value but, for your compiler, has a value of <code>8</code>   (which probably means the code is being built as a 64-bit application).</p>\n"}, {"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508410358, "post_id": 46807887, "comment_id": 80603653, "body": "@chqrlie; Oops! Thanks for picking it out."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1508410333, "last_edit_date": 1508410333, "creation_date": 1508321993, "answer_id": 46807887, "question_id": 46807113, "link": "https://stackoverflow.com/questions/46807113/behavior-of-comma-operator-in-sizeof-operator-in-c/46807887#46807887", "title": "Behavior of &quot;comma&quot; operator in sizeof() operator In C", "body": "<p><code>sizeof</code> determines the size by the type of it's operand. In <code>sizeof(a)</code>, <code>a</code> will not decay to pointer to it's first element and the type of <code>a</code> will be <code>char[20]</code>. While in <code>sizeof(b, a)</code>, <code>a</code> is the right operand of comma operator and in this context it will decay to pointer to it's first element and the type of the expression <code>b , a</code> would be <code>char *</code>. Therefore, <code>sizeof(b, a)</code> will return size of <code>char *</code> data type.    </p>\n\n<p>In C++, result of <code>,</code> operator is an lvalue (unlike in C where it yields an rvalue). In that case <code>sizeof(b, a)</code> will return the size of array <code>a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1508322931, "post_id": 46808013, "comment_id": 80563265, "body": "The whole story here is because of those parenthesis and has nothing to do with sizeof operator. like I said in my comment, if you do <code>int a = (1,2,3);</code> it works but if you do <code>int a = 1,2,3;</code> it will not because of the missing of those parenthesis. I think you know way."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1508323351, "post_id": 46808013, "comment_id": 80563551, "body": "@Michi: It is true that &quot;parenthesis has nothing to do with sizeof operator&quot;. But I don&#39;t see the importance of this in this context. The code compiles - that&#39;s given."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1508323454, "post_id": 46808013, "comment_id": 80563608, "body": "the whole point here is that people should stop treating SIZEOF operator as a function and they can avoid a thing like this. They are concentrate only on SIZEOF and not what exactly is on the right side."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1508323566, "post_id": 46808013, "comment_id": 80563664, "body": "@Michi: &quot;Avoid&quot;? Avoid what exactly? I don&#39;t see anything in this topic intended to persuade anyone to &quot;avoid&quot; anything. The question is rather technical and neutral. The author is well-aware of the fact that <code>,</code> in this context is a <i>comma operator</i>, not function argument separator."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508411418, "post_id": 46808013, "comment_id": 80604267, "body": "Wow, didn&#39;t know about that difference between C and C++. Learned something today :-)"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 4, "last_activity_date": 1508323407, "last_edit_date": 1508323407, "creation_date": 1508322412, "answer_id": 46808013, "question_id": 46807113, "link": "https://stackoverflow.com/questions/46807113/behavior-of-comma-operator-in-sizeof-operator-in-c/46808013#46808013", "title": "Behavior of &quot;comma&quot; operator in sizeof() operator In C", "body": "<p>C language is an <em>lvalue-discarding</em> language. Comma operator in C does not yield an lvalue and does not preserve \"arrayness\" of arrays. This means that when right-hand side operand is an array, it is immediately subjected to array-to-pointer conversion. For this reason in C the result of your comma operator is an rvalue of type <code>char *</code>. This is what you apply your <code>sizeof</code> to. And this is why you get <code>8</code> as the result, which is pointer size on your platform.</p>\n\n<p>C++ language is an <em>lvalue-preserving</em> language. The right-hand operand of comma operator in C++ is <em>not</em> subjected to lvalue-to-rvalue conversion and, in case the operand is an array, it maintains its lvalueness and its array type. In C++ the result of your comma operator is an lvalue of type <code>char[20]</code>. This is what you apply your <code>sizeof</code> to. And this is why you get <code>20</code> as the result. </p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 5, "closed_date": 1508322771, "accepted_answer_id": 46807383, "answer_count": 4, "score": 12, "last_activity_date": 1508996229, "creation_date": 1508319505, "last_edit_date": 1508996229, "question_id": 46807113, "link": "https://stackoverflow.com/questions/46807113/behavior-of-comma-operator-in-sizeof-operator-in-c", "closed_reason": "Duplicate", "title": "Behavior of &quot;comma&quot; operator in sizeof() operator In C", "body": "<p>I wrote the code about <code>sizeof</code> operator. If I write something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char a[20];\n    printf(\"%zu\\n\", sizeof(a));\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>20 // Ok, it's fine\n</code></pre>\n\n<p>But, If I use the <strong>comma</strong> operator like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char a[20];\n    char b;\n    printf(\"%zu\\n\", sizeof(b, a));\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>8 // Why the output 8?\n</code></pre>\n\n<p>So, I have a questions:</p>\n\n<ul>\n<li>Why does compiler give an output <code>8</code> in second example?</li>\n<li>What is the behavior of <code>comma</code> operator into <code>sizeof()</code> operator?</li>\n</ul>\n"}, {"tags": ["c", "ffmpeg", "centos"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1508318851, "post_id": 46806726, "comment_id": 80560740, "body": "Missing libraries!! What is the location of <code>libxcb</code>, <code>libfreetype</code> etc."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1508318887, "post_id": 46806726, "comment_id": 80560770, "body": "Ok, and where is the error message?"}, {"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1508318952, "post_id": 46806726, "comment_id": 80560816, "body": "Where did you put your libraries ? Maybe you have to think about adding the full path usin -L"}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1508318994, "post_id": 46806726, "comment_id": 80560847, "body": "@Michi There is a very small link, you can barely notice in the very beginning of the post <a href=\"https://i.stack.imgur.com/1FZpO.png\" rel=\"nofollow noreferrer\">Errors</a>  :-D :-D"}, {"owner": {"reputation": 25733, "user_id": 4663670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w2HBf.png?s=128&g=1", "display_name": "aergistal", "link": "https://stackoverflow.com/users/4663670/aergistal"}, "edited": false, "score": 0, "creation_date": 1508319360, "post_id": 46806726, "comment_id": 80561086, "body": "For GCC the order of libraries is important. See <a href=\"https://stackoverflow.com/questions/11893996/why-does-the-order-of-l-option-in-gcc-matter\" title=\"why does the order of l option in gcc matter\">stackoverflow.com/questions/11893996/&hellip;</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1508319372, "post_id": 46806726, "comment_id": 80561100, "body": "Error messages are text messages. Do not post text as graphics link!."}, {"owner": {"reputation": 21, "user_id": 8785028, "user_type": "registered", "profile_image": "https://graph.facebook.com/1855812658080909/picture?type=large", "display_name": "Beka Tchitchinadze", "link": "https://stackoverflow.com/users/8785028/beka-tchitchinadze"}, "edited": false, "score": 0, "creation_date": 1508319621, "post_id": 46806726, "comment_id": 80561263, "body": "Thanks to everyone I corrected it"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1508322070, "post_id": 46806726, "comment_id": 80562773, "body": "@GauravPathak I was on the Phone and I did not noticed. Tnx :)"}, {"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1508362616, "post_id": 46806726, "comment_id": 80586765, "body": "If you got a fix, post it as an answer to your own question here."}], "owner": {"reputation": 21, "user_id": 8785028, "user_type": "registered", "profile_image": "https://graph.facebook.com/1855812658080909/picture?type=large", "display_name": "Beka Tchitchinadze", "link": "https://stackoverflow.com/users/8785028/beka-tchitchinadze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508325027, "creation_date": 1508318304, "last_edit_date": 1508325027, "question_id": 46806726, "link": "https://stackoverflow.com/questions/46806726/how-to-solve-this-error-in-c-ffmpeg", "title": "How to solve this error in C ffmpeg?", "body": "<p><a href=\"https://i.stack.imgur.com/1FZpO.png\" rel=\"nofollow noreferrer\">Errors</a></p>\n\n<hr>\n\n<p>Here are my linker options : </p>\n\n<pre><code>-lavformat\n-lavcodec\n-lswscale\n-lavutil\n-lavfilter\n-lswresample\n-lpostproc\n-lpthread\n-lz\n-lx264\n-lx265\n-lrt\n-ldl\n-lGL\n-lm\n-lavdevice\n-lvorbis\n-lxcb\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508315360, "post_id": 46805799, "comment_id": 80558670, "body": "Use a <code>switch</code> statement.  You can combine the shared cases.  They can handle any int."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1508315366, "post_id": 46805799, "comment_id": 80558673, "body": "do the case actions relate with refnum?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1508315389, "post_id": 46805799, "comment_id": 80558687, "body": "switch cases for only 8 bit ints? That&#39;s new to me. This would be very specific behavior of your compiler. Usually you can at least use the full range of use <code>int</code> (if not any enumerable)."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1508315510, "post_id": 46805799, "comment_id": 80558747, "body": "What is the range of possible values of <code>refnum</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1508315689, "post_id": 46805799, "comment_id": 80558826, "body": "<a href=\"https://i.imgur.com/5r143L6.png\" rel=\"nofollow noreferrer\">i.imgur.com/5r143L6.png</a>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1508315723, "post_id": 46805799, "comment_id": 80558854, "body": "According to <a href=\"http://en.cppreference.com/w/cpp/language/switch\" rel=\"nofollow noreferrer\">cppreference.com</a>: condition - any expression of integral or enumeration type, ...; case constant_expression - a constant expression of the same type as the type of condition"}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1508317128, "post_id": 46805799, "comment_id": 80559675, "body": "@Scheff This is embedded C, not C++. Are they the same in terms of <code>switch</code> ?"}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508317150, "post_id": 46805799, "comment_id": 80559697, "body": "@melpomene Done ;)"}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1508317310, "post_id": 46805799, "comment_id": 80559782, "body": "@Bathsheba Currently the biggest required number is 83100, but I don&#39;t know a theoretical maximum. But I suppose it&#39;s not bigger than a 32bit number :)"}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "reply_to_user": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1508317559, "post_id": 46805799, "comment_id": 80559937, "body": "@TahaPaksu Of course they are related but not in algorithmical way. These reference numbers are unique identifiers of real world products."}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508317658, "post_id": 46805799, "comment_id": 80560007, "body": "@TomKarzes No, it seems switch can&#39;t handle <b>any</b> int. That&#39;s why is turned to if-else."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1508317774, "post_id": 46805799, "comment_id": 80560078, "body": "@Greenberet, show us two cases with full code."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1508317836, "post_id": 46805799, "comment_id": 80560123, "body": "And please tag your question with the name of the weird compiler that you are using."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508317890, "post_id": 46805799, "comment_id": 80560159, "body": "@Greenberet Huh, that&#39;s really weird.  Sounds like you&#39;re dealing with a subset of C.  If the values form sufficiently dense clusters, it might be possible to do a few range checks, then adjust the values for switch statements with values in the range that works, e.g. <code>if (x &gt;= 10000 &amp;&amp; x &lt;= 10255) switch(x - 10000) {}</code>  Or you could just use the <code>if-else</code> tree that you have - whichever seems to work best."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508319566, "post_id": 46805799, "comment_id": 80561225, "body": "@melpomene deserves the &quot;Comment of the Year&quot; award for 2017."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1508322690, "post_id": 46805799, "comment_id": 80563133, "body": "Your problem is that your switch did not work, so you tried to solve the problem with if-else-if and then asked us about that - a classic X-Y problem.  Why not show us the switch code and let us suggest a solution.  A restriction to 8 bit values would be unusual, so what target/compiler are you using?  If that is truly a restriction of your compiler, then what you have coded is valid, so what is your question?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508323880, "post_id": 46805799, "comment_id": 80563873, "body": "@melpomene As our companies security policy blocks imgur.com I had to use my private phone to have look. But, it was worth the effort..."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1508324527, "post_id": 46805799, "comment_id": 80564215, "body": "@Greenberet I cannot imagine that C and C++ behave differently concerning the accepted types of condition expressions. I tried to google but couldn&#39;t find anything authoritative. If you&#39;re compiler doesn&#39;t support anything else except 8 bit ints then it&#39;s not a standard C compiler (what might be a fact). Btw. I would consider to sort the if-else cascades to form a binary search. The same applies to the alternative approach with the mapping table. (I assume that <code>switch</code> might be compiled in a similar way if the case constants are not dense enough for direct indexing.)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1508325060, "post_id": 46805799, "comment_id": 80564529, "body": "I just realized that the answer of chqrlie provided the info I wasn&#39;t able to find..."}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "edited": false, "score": 0, "creation_date": 1508316155, "post_id": 46805945, "comment_id": 80559074, "body": "I think you didn&#39;t get my point. My problem is that <code>switch</code> doesn&#39;t work with variables this big..."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "edited": false, "score": 0, "creation_date": 1508316201, "post_id": 46805945, "comment_id": 80559103, "body": "@Greenberet what?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1508318338, "post_id": 46805945, "comment_id": 80560421, "body": "The GCC version should be avoided since it results in the same machine code as the standard one anyway. Programmer laziness is not a valid rationale for writing non-standard code."}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 3, "last_activity_date": 1508315731, "creation_date": 1508315731, "answer_id": 46805945, "question_id": 46805799, "link": "https://stackoverflow.com/questions/46805799/better-solution-than-if-else-if/46805945#46805945", "title": "Better solution than if-else if?", "body": "<p>Switch statement can do the job for you in this case.</p>\n\n<pre><code>switch (refnum) {\n    case 0:\n    case 1:\n        //Do stuff when refnum is 0 or 1\n        break;\n    case 2:\n        //Do stuff when refnum is 2\n        break;\n    case 36371:\n    case 36372:\n    case 36373:\n    case 36374:\n        // if (refnum == 36371 || refnum == 36372 || refnum == 36373 || refnum == 36374)\n        break;\n    default: break;\n}\n</code></pre>\n\n<p>Beauty is that you can apply multiple case statements (like <code>case 0</code> and <code>case 1</code> in my case) which acts like <code>or</code> in your if statement.</p>\n\n<p>GCC extension also allows you to write your switch this way:</p>\n\n<pre><code>switch (refnum) {\n     case 36371 ... 36374:\n        //Do the job when refnum is &gt;= 36371 &amp;&amp; refnum &lt;= 36374\n        break;\n}\n</code></pre>\n\n<p>But remember! This is not available in all compilers.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1508318482, "post_id": 46806522, "comment_id": 80560515, "body": "<code>uint32_t for_padding;</code> Eeh? What&#39;s that supposed to be? Struct padding is handled by the compiler, not by the programmer."}, {"owner": {"reputation": 43, "user_id": 8632813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/82cd430c4b8dbd99e4e57f4b216f082e?s=128&d=identicon&r=PG&f=1", "display_name": "Clerisse Lucas", "link": "https://stackoverflow.com/users/8632813/clerisse-lucas"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1508318772, "post_id": 46806522, "comment_id": 80560689, "body": "Its a good practice when you create a struct, always have a padded struct. This let the control to the user over the memory."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1508324339, "post_id": 46806522, "comment_id": 80564120, "body": "@ClerisseLucas No, it doesn&#39;t. The compiler can still insert additional padding."}, {"owner": {"reputation": 43, "user_id": 8632813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/82cd430c4b8dbd99e4e57f4b216f082e?s=128&d=identicon&r=PG&f=1", "display_name": "Clerisse Lucas", "link": "https://stackoverflow.com/users/8632813/clerisse-lucas"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508324713, "post_id": 46806522, "comment_id": 80564324, "body": "@melpomene I&#39;ve edited the post so maybe someone will evaluate my answer intead of basics details."}], "tags": [], "owner": {"reputation": 43, "user_id": 8632813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/82cd430c4b8dbd99e4e57f4b216f082e?s=128&d=identicon&r=PG&f=1", "display_name": "Clerisse Lucas", "link": "https://stackoverflow.com/users/8632813/clerisse-lucas"}, "is_accepted": false, "score": -1, "last_activity_date": 1508324613, "last_edit_date": 1508324613, "creation_date": 1508317616, "answer_id": 46806522, "question_id": 46805799, "link": "https://stackoverflow.com/questions/46805799/better-solution-than-if-else-if/46806522#46806522", "title": "Better solution than if-else if?", "body": "<p>You could create a global array with all your values to check. And simply loop trought this array. If you need a specific behavior for each else if you could create an array of struct and use function pointer to set a different behavior.</p>\n\n<p>Here's an example :</p>\n\n<pre><code>// For int variables\n#include &lt;stdint.h&gt;\n// For printf\n#include &lt;stdio.h&gt;\n\n#define VALUE_TO_GUESS 3\n#define NB_VALUES 4\n#define MY_VALUE_1 1\n#define MY_VALUE_2 2\n#define MY_VALUE_3 3\n#define MY_VALUE_4 4\n\nvoid behavior_1(void) {\n  printf(\"Behavior 1 !\\n\");\n}\n\nvoid behavior_2(void) {\n  printf(\"Behavior 2 !\\n\");\n}\n\nvoid behavior_3(void) {\n  printf(\"Behavior 3 !\\n\");\n}\n\nvoid behavior_4(void) {\n  printf(\"Behavior 4 !\\n\");\n}\n\n// Definition of the struct using a function pointer\ntypedef struct s_compare {\n    uint32_t value_to_compare;\n    void (*ptr)(void);\n}t_compare;\n\n// Setting up my struct\nt_compare g_compare[] = {\n    {MY_VALUE_1, behavior_1},\n    {MY_VALUE_2, behavior_2},\n    {MY_VALUE_3, behavior_3},\n    {MY_VALUE_4, behavior_4}\n};\n\nint main(void) {\n\n  for (int i = 0; i &lt; NB_VALUES; i++) {\n      /* If your current value match the value set in the current struct\n      then call the function pointer associated, with these 2 lines i can \n      compare an infinite quantity of numbers  */\n      if (g_compare[i].value_to_compare == VALUE_TO_GUESS) {\n          g_compare[i].ptr();\n      }\n  }\n}\n</code></pre>\n\n<p>Feel free to tell me if you need some explanations about this one.\nThis need a bit of setup but its a powerful solution to your problem and a more elegant solution than a tree of if / else / else if.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 7, "last_activity_date": 1508318084, "creation_date": 1508318084, "answer_id": 46806670, "question_id": 46805799, "link": "https://stackoverflow.com/questions/46805799/better-solution-than-if-else-if/46806670#46806670", "title": "Better solution than if-else if?", "body": "<blockquote>\n  <p>have to do some things based on the value of a big number like 83025</p>\n</blockquote>\n\n<p>Then make sure that all variables involved use <code>uint32_t</code>. </p>\n\n<blockquote>\n  <p>For this I can't use switch-case since it uses only integral arguments of a max value of 255</p>\n</blockquote>\n\n<p>This is a misunderstanding, not sure where you got this idea from. The <code>switch</code> statement works on all integer constant expressions. There's no numerical limits in the switch statement itself. </p>\n\n<p>(In fact the controlling expression of a switch statement is implicitly promoted to type <code>int</code>, if it happens to be a smaller integer type.)</p>\n\n<blockquote>\n  <p>So I thought I would make an if-else if ladder like this below but it seems not too elegant. Can you confirm that this is the proper way to do this? Or do you have a better idea?</p>\n</blockquote>\n\n<p>The if-else will likley yield the very same machine code as a corresponding switch. The switch might increase readability a bit and is therefore perhaps a better choice:</p>\n\n<pre><code>switch (refnum)\n{\n  case 32120: do_this(); break;\n  case 61024: do_that(); break;\n  ...\n  default:    do_something();\n}\n</code></pre>\n\n<hr>\n\n<p>Alternative:</p>\n\n<p>I notice that these are integer values in sorted order. If there are lots of values or if fast look-up is required, you could also replace the whole thing with a binary search. This will possibly give faster code but also increase complexity. Preferably, use C standard <code>bsearch()</code>.</p>\n\n<p>However, if what you wish to achieve in the end is to return a pointer to a string, this solution might be ideal. You could then store the numbers and strings as key-value pairs:</p>\n\n<pre><code>typedef struct\n{\n  uint32_t key;\n  const char* str;\n} thingie_t;\n\nstatic const thingie_t things [] = \n{\n  { 32120, \"text string\" },\n  { 32075, \"another text string\" },\n  ...\n};\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>the big number comes from the middle of a string and strtol converts it to a DWORD</p>\n</blockquote>\n\n<p>Why are you using signed numbers? The data does not seem to be signed. What is <code>DWORD</code>? That's some smelly type from Windows programming, which should definitely be avoided in embedded systems. Use the types from stdint.h, not some ugly, home-made types.</p>\n"}, {"comments": [{"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "edited": false, "score": 0, "creation_date": 1508320231, "post_id": 46806698, "comment_id": 80561672, "body": "Thanks chqrlie, really! I will thoroughly think on all these!"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 4, "last_activity_date": 1508318533, "last_edit_date": 1592644375, "creation_date": 1508318201, "answer_id": 46806698, "question_id": 46805799, "link": "https://stackoverflow.com/questions/46805799/better-solution-than-if-else-if/46806698#46806698", "title": "Better solution than if-else if?", "body": "<blockquote>\n<p><em>I have to do some things based on the value of a big number like 83025 (which is &gt;65535). For this I can't use switch-case since it uses only integral arguments of a max value of 255. (Or at least this is how I know).</em></p>\n</blockquote>\n<p>Your understanding is incorrect: here is the wording of the C Standard:</p>\n<blockquote>\n<p><strong>6.8.4.2 The <code>switch</code> statement</strong></p>\n<p>The controlling expression of a switch statement shall have integer type.</p>\n<p>[...] The expression of each <code>case</code> label shall be an integer constant expression and no two of the <code>case</code> constant expressions in the same <code>switch</code> statement shall have the same value after conversion. [...]</p>\n<p>The integer promotions are performed on the controlling expression. The constant expression in each <code>case</code> label is converted to the promoted type of the controlling expression. If a converted value matches that of the promoted controlling expression, control jumps to the statement following the matched <code>case</code> label. [...]</p>\n</blockquote>\n<p>Thus there is no limit at <code>65535</code> for the case values in general, the maximum value is at least <code>18446744073709551615</code> if the <code>switch</code> expression has type <code>unsigned long long</code>. If your <code>switch</code> expression is an <code>unsigned int</code> and your target platform had 16-bit ints, then the maximum value for a case expression would be <code>65535</code> but given the values you want to test, <code>refnum</code>'s type must be a larger than that.</p>\n<blockquote>\n<p><em>I still tried however and it compiled but the switch-case did not work well.</em></p>\n</blockquote>\n<p>You did not post the offending code... Unless your compiler is ancient or seriously broken, the problem is not where you suspect, more likely a bug in your code.</p>\n<p><strong>EDIT</strong> from the extra information provided, the target platform indeed has 16-bit <code>int</code>, but <code>refnum</code> must be larger than <code>int</code> or <code>unsigned int</code> to accommodate for values larger than <code>65535</code>, either a <code>long</code> or an <code>unsigned long</code>. The compiler should then accept <code>case</code> values larger than <code>65535</code>. Ancient compilers may not be compliant with this... in this case, you will probably have many more problems to deal with.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1508324094, "creation_date": 1508324094, "answer_id": 46808548, "question_id": 46805799, "link": "https://stackoverflow.com/questions/46805799/better-solution-than-if-else-if/46808548#46808548", "title": "Better solution than if-else if?", "body": "<p>You appear to have a very restrictive non-standard compiler.</p>\n\n<p>You could create a function for each action then generate a lookup-table of refnum to function-pointer and scan that.  For example:</p>\n\n<pre><code>int action1( unsigned long refnum ) ;\nint action2( unsigned long refnum ) ;\nint action3( unsigned long refnum ) ;\nint action4( unsigned long refnum ) ;\nint action5( unsigned long refnum ) ;\n...\nint action8( (unsigned long ) ;\n\n\nint doRefnumAction( unsigned long refnum )\n{\n    typedef void(*refnumFn)(unsigned long ) ;\n\n    static const struct \n    {\n        unsigned long refnum,\n        refnumFn refnum_action\n    } refnum_lookup[] = { {32120, action1}, {32075, action1},\n                          {51036, action2},\n                          ...\n                          {82012, action7}, {82024, action7}, {82048, action7}, {82096, , action7},\n                          {83050, action8}, {83100, action8} } ;\n\n    // Find refnum in lookup and call action...\n    for( int i = 0 ; \n         i &lt; sizeof(refnum_lookup) / sizeof(*refnum_lookup) ;\n         i++ )\n    {\n        if( refnum == refnum_lookup[i].refnum )\n        {\n            return refnum_lookup[i].refnum_action( refnum ) ;\n        }\n    }\n}\n</code></pre>\n\n<p>Whether that is <em>better</em> in any way that the <code>if-else if</code> solution is perhaps a matter of opinion, probably larger in code-space terms, and slower in execution but arguably more easily maintained.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 8713143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b515663f5d70775ad31c7b8b426e932a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8713143/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1509625198, "creation_date": 1509625198, "answer_id": 47075155, "question_id": 46805799, "link": "https://stackoverflow.com/questions/46805799/better-solution-than-if-else-if/47075155#47075155", "title": "Better solution than if-else if?", "body": "<p>Once we know details of your compiler and your real code, we can find out why you feel you cannot use a switch statement.  Until then, everyone is just guessing.</p>\n\n<p>I have used a large number of C compilers over the years, and never heard of one that restricts switches in this way.  It sounds like the kind of pseudo-C compilers that existed for 8-bit microcontrollers in the 1990's - not something you would see today.</p>\n\n<p>If you are using a decent compiler, and have optimisation enabled, then a switch will be the fastest way.  Someone mentioned binary searches as a more complex but faster solution - a good compiler will generate a jump table or a binary search automatically from a switch statement to give you the most efficient code.</p>\n"}], "owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "answer_count": 6, "score": -3, "last_activity_date": 1509625198, "creation_date": 1508315221, "last_edit_date": 1508317387, "question_id": 46805799, "link": "https://stackoverflow.com/questions/46805799/better-solution-than-if-else-if", "title": "Better solution than if-else if?", "body": "<p>I have to do some things based on the value of a big number like 83025 (which is >65535). For this I can't use switch-case since it uses only integral arguments of a max value of 255. (Or at least this is how I know. I still tried however and it compiled but the switch-case did not work well.)</p>\n\n<p>So I thought I would make an <code>if-else if</code> ladder like this below but it seems not too elegant.</p>\n\n<pre><code>if      ((refnum == 32120) ||  \n         (refnum == 32075))   {\n\nelse if  (refnum == 51036)    {\n\nelse if ((refnum == 61024) ||  \n         (refnum == 61060))   {\n\nelse if ((refnum == 71030) ||  \n         (refnum == 71048))   {\n\nelse if ((refnum == 72012) ||  \n         (refnum == 72024) ||  \n         (refnum == 72048))   {\n\nelse if ((refnum == 81025) ||  \n         (refnum == 81050) ||  \n         (refnum == 81100))   {\n\nelse if ((refnum == 82012) ||  \n         (refnum == 82024) ||  \n         (refnum == 82048) ||  \n         (refnum == 82096))   {\n\nelse if ((refnum == 83050) ||  \n         (refnum == 83100))   {\n</code></pre>\n\n<p>Can you confirm that this is the proper way to do this? Or do you have a better idea?</p>\n\n<p>Additional info:</p>\n\n<ul>\n<li><p>refnum is a 32bit unsigned integer</p></li>\n<li><p>the big number comes from the middle of a string and <code>strtol</code> converts it to a DWORD</p></li>\n<li><p>the things i have to do in each case is to perform a <code>strcpy</code> and then <code>return</code> a certain value.</p></li>\n<li><p>the code is embedded and runs on a 16 bit microcontroller</p></li>\n</ul>\n"}, {"tags": ["python", "c", "go", "cgo"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1508315782, "post_id": 46805263, "comment_id": 80558885, "body": "In <code>myPyTest.c</code>, try to change the second arg of <code>PyArg_ParseTuple</code> from <code>&quot;S&quot;</code> to <code>&quot;sss&quot;</code>."}, {"owner": {"reputation": 53, "user_id": 7298459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25200941c14bd4d9d1191700787a6c77?s=128&d=identicon&r=PG&f=1", "display_name": "at S", "link": "https://stackoverflow.com/users/7298459/at-s"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1508325074, "post_id": 46805263, "comment_id": 80564538, "body": "@putu Yes it worked. Thanks."}], "owner": {"reputation": 53, "user_id": 7298459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25200941c14bd4d9d1191700787a6c77?s=128&d=identicon&r=PG&f=1", "display_name": "at S", "link": "https://stackoverflow.com/users/7298459/at-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 696, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1508313203, "creation_date": 1508313203, "question_id": 46805263, "link": "https://stackoverflow.com/questions/46805263/calling-golang-function-from-python-using-c", "title": "Calling golang function from python using C", "body": "<p>I have following code in my myPyTest.c file</p>\n\n<pre><code>#include&lt;python/Python.h&gt;\n#include \"libtest.h\"\n\nstatic PyObject * callThatFunc(PyObject *self, PyObject *args) {\n    const char *a, *b, *c;\n    if (!PyArg_ParseTuple(args, \"S\", &amp;a, &amp;b, &amp;c))\n        return NULL;\n    printf(\"%s\", returnThis(a));\n    return PyString_FromString(b);\n}\n\nstatic PyMethodDef BarMethods[] = {\n    {\"call_bar\",  callThatFunc, METH_VARARGS,\n        \"Execute a shell command.\"},\n   {NULL, NULL, 0, NULL}\n};\n\nPyMODINIT_FUNC\ninitbar(void)\n{\n    (void) Py_InitModule(\"bar\", BarMethods);\n}\n\nint main() {\n    printf(\"Hello\");\n    return 0;\n}\n</code></pre>\n\n<p>check <a href=\"https://docs.python.org/2/extending/extending.html\" rel=\"nofollow noreferrer\">this</a> for above code</p>\n\n<p>Now I have following golang code in my_go_call.go file.</p>\n\n<pre><code>package main\n\nimport \"C\"\n\n//export returnThis\nfunc returnThis(myString *C.char) *C.char {\n    var result *C.char\n    myStringGo := C.GoString(myString)\n   result = C.CString(\"Hello, \" + myStringGo)\n   return result\n}\n\nfunc main() {\n}\n</code></pre>\n\n<p>I have created shared library using command (MAC)\n    <code>go build -ldflags -s -buildmode=c-shared -o libtest.so my_go_call.go</code></p>\n\n<p>Then I have setup.py file to build c extension for python. Code of setup.py as follows</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nmodule1 = Extension('bar',\n                libraries = ['test'],\n                library_dirs = ['/path/to/lib'],\n                sources = ['myPyTest.c'])\nsetup (name = 'PackageName',version = '1.0',description = 'This is a demo package',ext_modules = [module1])\n</code></pre>\n\n<p>Now i am building and installing my extension using following commands</p>\n\n<pre><code>python setup.py build\npython setup.py install\n</code></pre>\n\n<p>whenever I call my function in python interpreter i get following error.</p>\n\n<pre><code>&gt;&gt;&gt; import bar\n&gt;&gt;&gt; dir(bar)\n['__doc__', '__file__', '__name__', '__package__', 'call_bar']\n&gt;&gt;&gt; bar.call_bar('a','b','c')\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: function takes exactly 1 argument (3 given)\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1508870681, "post_id": 46805181, "comment_id": 80783033, "body": "Optimizations aren&#39;t allowed to change the results of a well-defined operation."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1508883140, "post_id": 46805181, "comment_id": 80789196, "body": "Strongly suggest using: <code>x &gt;&gt;= 1;  x &lt;&lt;= 1;</code>"}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 5, "creation_date": 1508916986, "post_id": 46805181, "comment_id": 80799956, "body": "@user3629249 Why strongly suggest it? It less clearly expresses the intent than the code already in the question, it compiles to identical machine code so it&#39;s not any faster, and there&#39;s no analogue if you want to round to the nearest multiple of a different number than 2 (unless that number also happens to be a power of 2)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1508983959, "post_id": 46805181, "comment_id": 80836890, "body": "because it is faster, no multiply and divide.  a MUCH easier way is to simply use: <code>x &amp;=  ~(1)&#39;  Where the </code>1` could be a string of 1s of the desired length.  For instance: <code>x &amp;= ~(0x07);</code> for three bits, etc"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1508984035, "post_id": 46805181, "comment_id": 80836915, "body": "if both methods are resulting in the same machine instructions, they you must have the optimization set to the max."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1509453482, "post_id": 46805181, "comment_id": 81017418, "body": "@user3629249 &quot;optimization set to the max&quot; Nope, arithmetic optimisations like this are the most trivial possible. Besides, who even knows if performance is important in the use case of the questioner? Unless this function is going to be called quadrillions of times, the time to type one of these comments outweights the performance gains; see &quot;premature optimisation&quot;. So it&#39;s best to use the representation that most clearly expresses intent. By the way, use @ name when replying to a comment, otherwise the other person doesn&#39;t get notified (I only found your comment by chance)."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1508313279, "post_id": 46805207, "comment_id": 80557513, "body": "I like the note about this being idiomatic. It&#39;s also somewhat more intuitive than a mask IMO."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 29, "creation_date": 1508313945, "post_id": 46805207, "comment_id": 80557888, "body": "Of course, the compiler <i>is</i> allowed to properly optimize this, e.g. by replacing it with <code>(x&gt;&gt;1)&lt;&lt;1</code>. IIRC, there are compilers which will do this even if optimizations are technically turned off."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 2, "creation_date": 1508314032, "post_id": 46805207, "comment_id": 80557929, "body": "@MSalters: Yes it was a silly thing to say. I&#39;ve amended."}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 31, "creation_date": 1508330479, "post_id": 46805207, "comment_id": 80567930, "body": "@MSalters: Or, in the case of unsigned <code>(x &amp; 0xfffffffe)</code> :)"}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 2, "creation_date": 1508441368, "post_id": 46805207, "comment_id": 80622486, "body": "@MSalters While the compiler can do that, us humans aren&#39;t allowed to do that, since it invokes undefined behavior. Probably worth a mention."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 3, "creation_date": 1508483161, "post_id": 46805207, "comment_id": 80635374, "body": "@Voo: Why? It&#39;s an unsigned integer. The behavior is identical by definition."}, {"owner": {"reputation": 3045, "user_id": 956880, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8wevB.png?s=128&g=1", "display_name": "Anonymous Coward", "link": "https://stackoverflow.com/users/956880/anonymous-coward"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1508500922, "post_id": 46805207, "comment_id": 80644602, "body": "@MSalters What if the type of <code>x</code> is wider than <code>0xfffffffe</code>? C++ standard guarantees minimun size for unsigned integer but not a maximun size."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 3045, "user_id": 956880, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8wevB.png?s=128&g=1", "display_name": "Anonymous Coward", "link": "https://stackoverflow.com/users/956880/anonymous-coward"}, "edited": false, "score": 0, "creation_date": 1508501580, "post_id": 46805207, "comment_id": 80644940, "body": "@JoseAntonioDuraOlmos: We&#39;re talking compiler optimizations, they know the size of their own integers."}, {"owner": {"reputation": 3045, "user_id": 956880, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8wevB.png?s=128&g=1", "display_name": "Anonymous Coward", "link": "https://stackoverflow.com/users/956880/anonymous-coward"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1508503148, "post_id": 46805207, "comment_id": 80645804, "body": "@MSalters Hence why the compiler can do it but a human cannot. A human does not know if his code will ever be compiled by someone with some compiler where <code>x</code> is wider than <code>0xfffffffe</code>."}, {"owner": {"reputation": 535, "user_id": 2043622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b123ee07c99404356b2c78476c66c65?s=128&d=identicon&r=PG", "display_name": "Erroneous", "link": "https://stackoverflow.com/users/2043622/erroneous"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1508513203, "post_id": 46805207, "comment_id": 80652063, "body": "@MSalters It looks like clang and GCC like to optimize this with <code>and     eax, -2</code>. It&#39;ll do this for <code>x&#47;2*2</code>, <code>x &amp; ~1</code>, <code>(x &gt;&gt; 1 ) &lt;&lt; 1</code>, and <code>x ^ 1</code>."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1508534934, "post_id": 46805207, "comment_id": 80662810, "body": "@MSalters I missed the part where it said unsigned, you&#39;re right."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 86, "last_activity_date": 1508314022, "last_edit_date": 1508314022, "creation_date": 1508313051, "answer_id": 46805207, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte/46805207#46805207", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>The compiler is allowed to make any optimisiations it likes so long as it does not introduce any side effects into the program. In your case it can't cancel the '2's as then the expression will have a different value for odd numbers.</p>\n\n<p><code>x / 2 * 2</code> is evaluated <em>strictly</em> as <code>(x / 2) * 2</code>, and <code>x / 2</code> is performed in integer arithmetic if <code>x</code> is an integral type.</p>\n\n<p>This, in fact, is an idiomatic rounding technique.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1508313275, "post_id": 46805226, "comment_id": 80557508, "body": "Don&#39;t you need <code>x &amp; (~static_cast&lt;decltype(x)&gt;(1))</code> or do I need a coffee?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1508313277, "post_id": 46805226, "comment_id": 80557511, "body": "same or <i>wider</i>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1508313341, "post_id": 46805226, "comment_id": 80557559, "body": "@Bathsheba - Well, integral promotions will take care of that, unless <i>I</i> need a coffee."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1508313404, "post_id": 46805226, "comment_id": 80557586, "body": "I <i>thought</i> the parentheses would mean that the <i>result</i> of <code>~1u</code> is promoted, thus potentially introducing lots of zeros. Someone needs a coffee - that much is clear."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1508313522, "post_id": 46805226, "comment_id": 80557651, "body": "@Bathsheba - It&#39;s most definitely I who needs a coffee, than. Mmm... I didn&#39;t give it much though about working with any unsigned integer type."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1508313588, "post_id": 46805226, "comment_id": 80557687, "body": "When you&#39;re back, feel free to nick the <code>static_cast</code> from the comment."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1508313652, "post_id": 46805226, "comment_id": 80557723, "body": "@Bathsheba - I would, but that C tag...  I kinda want to think about it, and be all cool by producing a solution that works in both C and C++."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1508313836, "post_id": 46805226, "comment_id": 80557816, "body": "@Bathsheba - But only up to <code>UINT_MAX</code>, no? Wer&#39;e still in the same boat if <code>x</code> is <code>unsigned long</code>, I <i>think</i>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1508313905, "post_id": 46805226, "comment_id": 80557864, "body": "@StoryTeller: Yup, that -1u idea was hogwash. It&#39;s me who needs the coffee now. Then I thought of <code>-(x&#47;x)</code> but that breaks if x is 0."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 4, "creation_date": 1508319071, "post_id": 46805226, "comment_id": 80560897, "body": "I&#39;m afraid <code>x &amp; (~1u)</code> does not work if the type of <code>x</code> is larger than <code>unsigned int</code>.  Conversely, <code>x &amp; ~1</code> would behave as expected for all types. This is a counter-intuitive pitfall. If you insist on using an unsigned constant, you must write <code>x &amp; ~(uintmax_t)1</code> as even <code>x &amp; ~1ULL</code> would fail if <code>x</code> has a larger type than <code>unsigned long long</code>. To make matters worse, many platforms now have larger integer types than <code>uintmax_t</code>, such as <code>__uint128_t</code>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508319161, "post_id": 46805226, "comment_id": 80560947, "body": "@chqrlie - Umm, I did cover all of this in my answer (other than <code>x &amp; ~1</code>)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1508319973, "post_id": 46805226, "comment_id": 80561525, "body": "Re-reading your answer, you did mention <i>if the type of <code>x</code> is no wider than <code>unsigned int</code></i>, but why use the <code>u</code> suffix at all? It is just about as obscure why it does not work with <code>1u</code> and why it does with just <code>1</code>, even for overly large types."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508320138, "post_id": 46805226, "comment_id": 80561621, "body": "@chqrlie - For the same reason that <code>~1</code> and <code>-2</code> would raise eyebrows, despite being correct. What <i>everyone</i> knows is that bitwise operations are most well defined for unsigned types. Understanding the minutia of standardese for signed types is less common. This is simply to reduce the rate of WTF per minute (a well known metric of code readability)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508320569, "post_id": 46805226, "comment_id": 80561888, "body": "I agree and this is an excellent example of <i>simplicity is better</i>, albeit for non obvious reasons,"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508320688, "post_id": 46805226, "comment_id": 80561959, "body": "@chqrlie - I must also say, that I think the bind I got into with widening the unsigned constant should serve as another valuable lesson to the OP (or I hope it would). Anyway, your answer gives a neat summary of the whole thing. So +1 to that."}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1508338233, "post_id": 46805226, "comment_id": 80573221, "body": "So much extra code just to avoid a feature of the language... And even with <code>uintmax_t</code> this may not work if <code>x</code> has a third-party extended integer type, when conversion of signed to unsigned would."}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1508339275, "post_id": 46805226, "comment_id": 80573956, "body": "Actually see <a href=\"http://coliru.stacked-crooked.com/a/187ca1e3fc5e9205\" rel=\"nofollow noreferrer\">this example</a>, which demonstrates that your attempts to avoid signed-to-unsigned conversion still don&#39;t work."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508343494, "post_id": 46805226, "comment_id": 80576895, "body": "@chqrlie: If <code>x</code> is an unsigned type at least as large as <code>unsigned</code>, <code>x &amp; ~1u</code> will yield <code>x &amp; (UINT_MAX-1)</code> on any conforming implementation.  On a ones&#39;-complement C89 system (or a hypothetical ones&#39;-complement C99 or C11 system), <code>x &amp; ~1</code> would yield <code>x</code>.  The form <code>x &amp; -2</code> will yield <code>x | 1 ^ 1</code> on any conforming implementation regardless of how it represents signed values."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1508347447, "post_id": 46805226, "comment_id": 80578926, "body": "@Ruslan - My <b>original</b> attempt does work, albeit inelegantly. The fact <code>uintmax_t</code> and <code>__uint128_t</code> are not synonyms is a quality of implementation issue, <a href=\"https://stackoverflow.com/questions/21265462/why-in-g-stdintmax-t-is-not-a-int128-t\">one that can be debated at length</a>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1508356341, "post_id": 46805226, "comment_id": 80583620, "body": "@supercat: You are correct about one&#39;s complement. The code fails too on conforming sign/magnitude architectures: <code>~1</code> has the value <code>-INT_MAX+1</code>. Converting this to type <code>unsigned int</code> by repeatedly adding <code>UINT_MAX+1</code> gives either <code>1</code> if <code>UINT_MAX==INT_MAX</code> or <code>INT_MAX+2</code> if <code>UINT_MAX == INT_MAX*2 + 1</code>.  In the first case <code>x &amp; ~1</code> evaluates to the same as <code>x &amp; 1</code> and in the second case <code>x &amp; ~1</code> evaluates to <code>x &amp; 0x8001</code> (on 16 bits, adjust for the number of bits in the type). Neither is the expected value."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1508356555, "post_id": 46805226, "comment_id": 80583713, "body": "@supercat: operator precedence is such a nightmare: <code>x | 1 ^ 1</code> parses as <code>x | (1 ^ 1)</code>... With the appropriate parentheses, your proposal is a valid alternative, portable to all integer representations and for which <code>gcc -O1</code> produces the same code."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508358420, "post_id": 46805226, "comment_id": 80584660, "body": "@chqrlie: Have any sign-magnitude implementations conforming to any standard been produced or even updated since the publication of C99?  I&#39;ve read documentation for a one&#39;s-complement implementation that was updated in 2005 but isn&#39;t fully C99 conforming.  From what I can tell, sign-magnitude was obsolete even before C99 was published."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1508366155, "post_id": 46805226, "comment_id": 80588027, "body": "@supercat: I haven&#39;t any more than you have, and I would welcome both sign/magnitude and one&#39;s complement being removed from the C Standard. Keeping them there seems solely motivated by extreme conservatism and idolatry."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1508366619, "post_id": 46805226, "comment_id": 80588150, "body": "@chqrlie: I think one issue is that it would be sensible to have some actions (e.g. -1&lt;&lt;1) invoke Undefined Behavior in non-TC implementations, but there&#39;s no sensible reason not to define them on TC ones.  Some people, however, are of the opinion that it&#39;s somehow &quot;better&quot; to leave such things as UB to facilitate &quot;optimization&quot;.  Removing any justification for such behaviors to remain undefined would remove any justification for such &quot;optimizations&quot;."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 1, "creation_date": 1508409238, "post_id": 46805226, "comment_id": 80603068, "body": "@Mehrdad: I added your proposed alternative, same code generation.  Thank you."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1508450469, "post_id": 46805226, "comment_id": 80626901, "body": "(x | 1) ^ 1 is less ugly than the other form of forcing the type."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 53, "last_activity_date": 1508316124, "last_edit_date": 1508316124, "creation_date": 1508313105, "answer_id": 46805226, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte/46805226#46805226", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>Since you specified the integers are unsigned, you can do it with a simple mask:</p>\n\n<pre><code>x &amp; (~1u)\n</code></pre>\n\n<p>Which will set the LSB to zero, thus producing the immediate even number that is no larger than <code>x</code>. That is, if <code>x</code> has a type that is no wider than an <code>unsigned int</code>. </p>\n\n<p>You can of course force the <code>1</code> to be of the same type as a wider <code>x</code>, like this:</p>\n\n<pre><code>x &amp; ~((x &amp; 1u) | 1u)\n</code></pre>\n\n<p>But at this point, you really ought to look at this approach as an exercise in obfuscation, and accept Bathsheba's answer.</p>\n\n<hr>\n\n<p>I of course forgot about the standard library. If you include <code>stdint.h</code> (or <code>cstdint</code>, as you should in C++ code). You can let the implementation take care of the details:</p>\n\n<pre><code>uintmax_t const lsb = 1;\nx &amp; ~lsb;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>x &amp; ~UINTMAX_C(1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 11, "creation_date": 1508315871, "post_id": 46805673, "comment_id": 80558925, "body": "<a href=\"https://godbolt.org/g/CR4q3v\" rel=\"nofollow noreferrer\">Case and point</a>. This is what GCC produces with <code>-O1</code>. All the approaches are distilled to the same machine code."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1508316117, "post_id": 46805673, "comment_id": 80559057, "body": "And as I suspected, for all 3 variants GCC will use the <code>and RAX, -2</code> method even on <code>-O0</code>."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1508316397, "post_id": 46805673, "comment_id": 80559229, "body": "... and GCC on ARM knows to use the <code>bic</code> (Bit Clear) instruction. Checking further, MSVC and ICC generate the same <code>and &lt;Reg&gt;, -2</code> code as GCC."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 7, "creation_date": 1508327149, "post_id": 46805673, "comment_id": 80565820, "body": "GCC is highly unusual in that it applies these sorts of mathematical/bit-twiddling peephole optimizations even when optimizations are disabled. That&#39;s kind of an interesting and notable design quirk. Other compilers perform a much more literal translation of the C code into machine instructions with optimization disabled, but once you enable the optimizer, the output is all the same, which is why you should write the code for readability unless you know for sure that your compiler is brain-dead."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1508343892, "post_id": 46805673, "comment_id": 80577100, "body": "@CodyGray: Having <code>uintVal&#47;=2</code> evaluated as equivalent to <code>uintVal&gt;&gt;=1</code> is really no different from having <code>x&gt;&gt;=2</code> be evaluated with code equivalent to <code>x&gt;&gt;=1; x&gt;&gt;=1;</code> or <code>x=((x&gt;&gt;1)&gt;&gt;1)</code> instead of code equivalent to <code>for(int i=0; i&lt;2; i++) x&gt;&gt;=1;</code>.  It&#39;s not really an &quot;optimization&quot;--it&#39;s simply a straightforward piece of code generation."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1508344028, "post_id": 46805673, "comment_id": 80577191, "body": "Transforming a division to a shift is a standard optimization technique known as &quot;strength reduction&quot;. Yes, it&#39;s very standard, and extremely straightforward, but I disagree that makes it not an optimization. @supercat"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1508348581, "post_id": 46805673, "comment_id": 80579505, "body": "@CodyGray: If a code generator works by traversing an expression tree, having different expansions for different combinations of operands isn&#39;t usually called an &quot;optimization&quot;.  Processing &quot;x=y+1;&quot; in using a completely context-independent code generator would yield something like <code>mov ax,&amp;x &#47; push ax</code> <code>mov ax,&amp;y &#47; push ax</code> <code>pop bx &#47; mov ax,[bx]</code> / <code>push ax</code> <code>mov ax,1 &#47; push ax</code> <code>pop ax &#47; pop bx &#47; add ax,bx &#47; push ax</code> <code>pop ax &#47; pop bx &#47; mov [bx],ax</code>.  Would having a compiler produce <code>mov ax,[y] &#47; inc ax &#47; mov [x],ax</code> really be called &quot;optimizing&quot;?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1508358151, "post_id": 46805673, "comment_id": 80584512, "body": "@CodyGray the standard defines <code>x &gt;&gt; 1</code> as <code>x &#47; 2</code> , for unsigned integers"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1508397225, "post_id": 46805673, "comment_id": 80596312, "body": "@supercat: I mostly agree with Cody Gray here. It&#39;s not so much the strength reduction; it&#39;s the fact that GCC does not generate code for individual expressions. <code>x&#47;2*2</code> compiles to a single statement. In general, compiling without optimizations is done for debugging purposes, and then you want a 1:N correspondence between source code and assembly."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 36, "last_activity_date": 1508314775, "creation_date": 1508314775, "answer_id": 46805673, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte/46805673#46805673", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>C and C++ generally use the \"as if\" rule in optimization. The computation result must be <em>as if</em> the compiler didn't optimize your code.  </p>\n\n<p>In this case, <code>9/2*2=8</code>. The compiler may use any method to achieve the result 8. This includes bitmasks, bit shifts, or any CPU-specific hack that produces the same results (x86 has quite a few tricks that rely on the fact that it doesn't differentiate between pointers and integers, unlike C and C++).</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 4, "creation_date": 1508343341, "post_id": 46806695, "comment_id": 80576811, "body": "It may be worth noting, just to preempt any confusion, that converting -2 to &quot;unsigned&quot; will yield the &quot;unsigned value&quot; which, when added to 2, will yield 0, <i>regardless of whether a system uses two&#39;s-complement signed math</i>.  By contrast, if one had a ones`-complement system, ~1 would equal -1, which when converted to unsigned would yield a value with all bits set."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1508401690, "post_id": 46806695, "comment_id": 80598762, "body": "@supercat, thanks, yes exactly. I tried to integrate these ideas in my answer."}, {"owner": {"reputation": 7116, "user_id": 5083516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2aeeefc1a95ddb2f19612150ccd7ba?s=128&d=identicon&r=PG&f=1", "display_name": "plugwash", "link": "https://stackoverflow.com/users/5083516/plugwash"}, "edited": false, "score": 0, "creation_date": 1508434644, "post_id": 46806695, "comment_id": 80619056, "body": "To make this safe for unsigned types smaller than unsigned int you can use (1u * x) &amp; -2"}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 7, "last_activity_date": 1508401640, "last_edit_date": 1508401640, "creation_date": 1508318194, "answer_id": 46806695, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte/46806695#46806695", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>If your values are of any unsigned type as you say, the easiest is</p>\n\n<pre><code>x &amp; -2;\n</code></pre>\n\n<p>The wonders of unsigned arithmetic make it that <code>-2</code> is converted to the type of <code>x</code>, and has a bit pattern that has all ones, but for the least significant bit which is <code>0</code>.</p>\n\n<p>In contrary to some of the other proposed solutions, this should work with any unsigned integer type that is at least as wide as <code>unsigned</code>. (And you shouldn't do arithmetic with narrower types, anyhow.)</p>\n\n<p>Extra bonus, as remarked by supercat, this only uses conversion of a signed type to an unsigned type. This is well-defined by the standard as being modulo arithmetic. So the result is always <code>UTYPE_MAX-1</code> for <code>UTYPE</code> the unsigned type of <code>x</code>.\nIn particular, it is independent of the sign representation of the platform for signed types.</p>\n"}, {"comments": [{"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1508330971, "post_id": 46807065, "comment_id": 80568233, "body": "Here&#39;s an example of what GCC does with <code>x&#47;2*2</code> for unsigned <code>x</code>: <a href=\"https://godbolt.org/g/Nee7cJ\" rel=\"nofollow noreferrer\">godbolt.org/g/Nee7cJ</a>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1508335550, "post_id": 46807065, "comment_id": 80571368, "body": "@Ruslan: Thanks for your comment, gcc indeed produces the same code for all proposed alternatives."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508365747, "post_id": 46807065, "comment_id": 80587901, "body": "@M.M: I believe it works for all integer types and representations, but only for positive values of <code>x</code>. Can you demonstrate for what value it would not work?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1508397510, "post_id": 46807065, "comment_id": 80596463, "body": "@M.M: How so? <code>1</code> is positive, and always is represented as <code>00...01</code>. <code>|1</code> sets the LSB. <code>^1</code> toggles that same bit. One&#39;s complement affects the value of the MSB c.q. the value of <code>INT_MIN</code> but we&#39;re not touching the MSB. IOW, number representations start to matter when you mix arithmetic and numerical operations, and we don&#39;t do that. (But the question leaves open how to round negative numbers, round down or round to zero)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508398358, "post_id": 46807065, "comment_id": 80596958, "body": "@chqrlie all positive numbers have the same representation; the only reason to mention &quot;all representations&quot; is if you&#39;re talking about negative numbers. (The question was originally about positive and negative but was later edited). All of the examples here work for positive numbers"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508409751, "post_id": 46807065, "comment_id": 80603321, "body": "@M.M: I&#39;m afraid some of the examples produce negative numbers as intermediary results, such as <code>-2</code> and <code>~1</code>, which are converted to the type of <code>x</code> before evaluating the binary operators. The value of <code>~1</code> does depend on the representation and size of signed integers, and the value of <code>(unsigned int)~1</code> depends both on the representation of signed integers and the sizes of <code>int</code> and <code>unsigned int</code>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1508425054, "post_id": 46807065, "comment_id": 80613271, "body": "While the OP&#39;s question is about unsigned, testing the code with signed will also be illuminating.  <code>x - (x%2)?1:0</code> would be an example of a case that leads to a different result for signed and unsigned values and whose behavior is fully defined with signed <code>x</code>.  An answer whose behavior is well specified for signed x is superior to one which isn&#39;t, all things being equal, as you never know when someone is going to refactor.  As an aside, <code>x&amp;~decltype(x)1</code> solves your large unsigned type problem."}, {"owner": {"reputation": 76644, "user_id": 330057, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/i6yM6.png?s=128&g=1", "display_name": "corsiKa", "link": "https://stackoverflow.com/users/330057/corsika"}, "edited": false, "score": 1, "creation_date": 1508471051, "post_id": 46807065, "comment_id": 80631888, "body": "What good is a puzzle of bit manipulation without everyone&#39;s favorite, modulo! <code>x = x - (x%2)</code>? This has the advantage of scaling to any <code>n</code> where <code>roundToMultiple(int x, int n) { return x - (x % n); }</code>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 21, "last_activity_date": 1508532349, "last_edit_date": 1508532349, "creation_date": 1508319364, "answer_id": 46807065, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte/46807065#46807065", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>You can write <code>x / 2 * 2</code> and the compiler will produce very efficient code to clear the least significant bit if <code>x</code> has an unsigned type.</p>\n\n<p>Conversely, you could write:</p>\n\n<pre><code>x = x &amp; ~1;\n</code></pre>\n\n<p>Or probably less readably:</p>\n\n<pre><code>x = x &amp; -2;\n</code></pre>\n\n<p>Or even</p>\n\n<pre><code>x = (x &gt;&gt; 1) &lt;&lt; 1;\n</code></pre>\n\n<p>Or this too:</p>\n\n<pre><code>x = x - (x &amp; 1);\n</code></pre>\n\n<p>Or this last one, suggested by supercat, that works for positive values of all integer types and representations:</p>\n\n<pre><code>x = (x | 1) ^ 1;\n</code></pre>\n\n<p>All of the above proposals work correctly for all unsigned integer types on 2's complement architectures. Whether the compiler will produce optimal code is a question of configuration and quality of implementation.</p>\n\n<p>Note however that <code>x &amp; (~1u)</code> does not work if the type of <code>x</code> is larger than <code>unsigned int</code>. This is a counter-intuitive pitfall. If you insist on using an unsigned constant, you must write <code>x &amp; ~(uintmax_t)1</code> as even <code>x &amp; ~1ULL</code> would fail if <code>x</code> has a larger type than <code>unsigned long long</code>. To make matters worse, many platforms now have integer types larger than <code>uintmax_t</code>, such as <code>__uint128_t</code>.</p>\n\n<p>Here is a little benchmark:</p>\n\n<pre><code>typedef unsigned int T;\n\nT test1(T x) {\n    return x / 2 * 2;\n}\n\nT test2(T x) {\n    return x &amp; ~1;\n}\n\nT test3(T x) {\n    return x &amp; -2;\n}\n\nT test4(T x) {\n    return (x &gt;&gt; 1) &lt;&lt; 1;\n}\n\nT test5(T x) {\n    return x - (x &amp; 1);\n}\n\nT test6(T x) {  // suggested by supercat\n    return (x | 1) ^ 1;\n}\n\nT test7(T x) {  // suggested by Mehrdad\n    return ~(~x | 1);\n}\n\nT test1u(T x) {\n    return x &amp; ~1u;\n}\n</code></pre>\n\n<p>As suggested by Ruslan, testing on <a href=\"https://godbolt.org/g/DwGXJL\" rel=\"nofollow noreferrer\">Godbolt's Compiler Explorer</a> shows that for all the above alternatives <code>gcc -O1</code> produces the same exact code for <code>unsigned int</code>, but changing the type <code>T</code> to <code>unsigned long long</code> shows differing code for <code>test1u</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1508418251, "post_id": 46826630, "comment_id": 80608392, "body": "Yes, compiler&#39;s optimizers are smart enough: <a href=\"https://godbolt.org/g/U9zsiL\" rel=\"nofollow noreferrer\">godbolt.org/g/U9zsiL</a>"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1508421091, "post_id": 46826630, "comment_id": 80610465, "body": "While the OP did specify unsigned, it should be noted that the above produces possibly surprising results when you feed it a signed integer."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1508424244, "post_id": 46826630, "comment_id": 80612729, "body": "@Yakk In C, modulo is defined to be <code>x % d = x - x &#47; d * d</code>, so my snippet is guaranteed to give identical results to the <code>x = x&#47;2*2</code> mentioned in the question. Assuming it&#39;s <code>x</code> you&#39;re worried about being negative (rather than a negative replacement for <code>2</code>), this gives what OP probably wants: if <code>x=-7</code> then <code>x&#47;2*2 == x - x%2 == -6</code>."}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "edited": false, "score": 0, "creation_date": 1508424345, "post_id": 46826630, "comment_id": 80612807, "body": "But the fact that you had that worry, and I wasn&#39;t sure until I checked it, does throw out my argument about it being easier to read (in the case of negative numbers)."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1508424971, "post_id": 46826630, "comment_id": 80613224, "body": "@ArthurTacca I&#39;d argue even the OP&#39;s <code>x&#47;2*2</code> is also surprising with negative integers.  So not sure how to avoid having code that behaves surprising to someone with negative integers!"}, {"owner": {"reputation": 889, "user_id": 5127698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f9fa2e9d5310e3cae38a4ef3552b4?s=128&d=identicon&r=PG&f=1", "display_name": "JonatanE", "link": "https://stackoverflow.com/users/5127698/jonatane"}, "edited": false, "score": 0, "creation_date": 1508432721, "post_id": 46826630, "comment_id": 80618048, "body": "Why not make it even more obvious and instead write <code>const unsigned int floored = ((x % 2) == 0) ? x : x - 1;</code>"}, {"owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "reply_to_user": {"reputation": 889, "user_id": 5127698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f9fa2e9d5310e3cae38a4ef3552b4?s=128&d=identicon&r=PG&f=1", "display_name": "JonatanE", "link": "https://stackoverflow.com/users/5127698/jonatane"}, "edited": false, "score": 0, "creation_date": 1508450473, "post_id": 46826630, "comment_id": 80626903, "body": "@JonatanE The way I wrote it seems more natural to me, and works for other dividends by just replacing the 2 with the new number."}], "tags": [], "owner": {"reputation": 6475, "user_id": 7008416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aa92fca6ba297f9420e519fd789ac64?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Tacca", "link": "https://stackoverflow.com/users/7008416/arthur-tacca"}, "is_accepted": false, "score": 6, "last_activity_date": 1508404957, "creation_date": 1508404957, "answer_id": 46826630, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte/46826630#46826630", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>One option that I'm surprised hasn't been mentioned so far is to use the modulo operator. I would argue this represents your intent at least as well as your original snippet, and perhaps even better.</p>\n\n<pre><code>x = x - x % 2\n</code></pre>\n\n<p>As others have said, the compiler's optimiser will deal with any reasonable expression equivalently, so worry about what's clearer rather than what you think is fastest. All the bit-tweaking answers are interesting, but you should definitely not use any of them in place of arithmetic operators (assuming the motivation is arithmetic rather than bit tweaking).</p>\n"}, {"tags": [], "owner": {"reputation": 2007, "user_id": 1540501, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JcHkg.jpg?s=128&g=1", "display_name": "ivan.ukr", "link": "https://stackoverflow.com/users/1540501/ivan-ukr"}, "is_accepted": false, "score": -2, "last_activity_date": 1508424742, "creation_date": 1508424742, "answer_id": 46832784, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte/46832784#46832784", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>just use following:</p>\n\n<pre><code>template&lt;class T&gt;\ninline T f(T v)\n{\n    return v &amp; (~static_cast&lt;T&gt;(1));\n}\n</code></pre>\n\n<p>Do not afraid that this is function, compiler should finally optimize this into just\n    v &amp; (~1)\nwith appropriate type of 1.</p>\n"}], "owner": {"reputation": 1253, "user_id": 2370139, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/63df3407bc990fd0162a1556e783f1ef?s=128&d=identicon&r=PG", "display_name": "user2370139", "link": "https://stackoverflow.com/users/2370139/user2370139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6923, "favorite_count": 4, "answer_count": 7, "score": 68, "last_activity_date": 1508532349, "creation_date": 1508312941, "last_edit_date": 1508475926, "question_id": 46805181, "link": "https://stackoverflow.com/questions/46805181/if-i-want-to-round-an-unsigned-integer-to-the-closest-smaller-or-equal-even-inte", "title": "If I want to round an unsigned integer to the closest smaller or equal even integer, can I divide by 2 then multiply by 2?", "body": "<p>For example : </p>\n\n<pre><code>f(8)=8\nf(9)=8\n</code></pre>\n\n<p>Can I do <code>x = x/2*2;</code> ?\nIs there a risk that the compiler will optimize away such expression ?</p>\n"}, {"tags": ["c", "image-processing", "optimization", "graphics", "cairo"], "comments": [{"owner": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "edited": false, "score": 1, "creation_date": 1508311855, "post_id": 46804751, "comment_id": 80556632, "body": "Could you show the definition of image_data&#39;s and alpha_factor&#39;s types?"}, {"owner": {"reputation": 382, "user_id": 2956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfc0afc453967c0fa233235661e6f9f?s=128&d=identicon&r=PG&f=1", "display_name": "phenompbg", "link": "https://stackoverflow.com/users/2956424/phenompbg"}, "reply_to_user": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "edited": false, "score": 0, "creation_date": 1508316086, "post_id": 46804751, "comment_id": 80559039, "body": "added to definition, alpha_factor is a double."}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 2956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfc0afc453967c0fa233235661e6f9f?s=128&d=identicon&r=PG&f=1", "display_name": "phenompbg", "link": "https://stackoverflow.com/users/2956424/phenompbg"}, "edited": false, "score": 0, "creation_date": 1508315779, "post_id": 46805240, "comment_id": 80558883, "body": "Thanks a lot, I&#39;ll give this a shot"}, {"owner": {"reputation": 382, "user_id": 2956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfc0afc453967c0fa233235661e6f9f?s=128&d=identicon&r=PG&f=1", "display_name": "phenompbg", "link": "https://stackoverflow.com/users/2956424/phenompbg"}, "edited": false, "score": 0, "creation_date": 1508316166, "post_id": 46805240, "comment_id": 80559081, "body": "The else if is to avoid doing anything if the alpha is 255, ie. alpha_factor will be 1.0"}, {"owner": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "reply_to_user": {"reputation": 382, "user_id": 2956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfc0afc453967c0fa233235661e6f9f?s=128&d=identicon&r=PG&f=1", "display_name": "phenompbg", "link": "https://stackoverflow.com/users/2956424/phenompbg"}, "edited": false, "score": 0, "creation_date": 1508322661, "post_id": 46805240, "comment_id": 80563112, "body": "Oh yes, my mistake. Also I added few additional thoughts."}], "tags": [], "owner": {"reputation": 1206, "user_id": 2830225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6812bca0f44a9c23dd9ab00ef70deccf?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Angelov", "link": "https://stackoverflow.com/users/2830225/anton-angelov"}, "is_accepted": true, "score": 3, "last_activity_date": 1508323369, "last_edit_date": 1508323369, "creation_date": 1508313139, "answer_id": 46805240, "question_id": 46804751, "link": "https://stackoverflow.com/questions/46804751/premultiplying-image-alpha-efficiently/46805240#46805240", "title": "Premultiplying image alpha efficiently", "body": "<p>Given that your <code>a</code>, <code>r</code>, <code>g</code> and <code>b</code> components are <code>unsigned char</code>, you can improve performance by turning floating point multiplication to integer multiplication and use <code>shr 8</code> (division by 256) instead of dividing by 255:</p>\n\n<pre><code>for ( i = 0; i &lt; length; i++ )\n{\n    if ( image_data[i].a == 0 )\n        image_data[i].r = image_data[i].g = image_data[i].b = 0;\n    else if ( image_data[i].a &lt; 255 ) \n    {\n        image_data[i].r = (unsigned short)image_data[i].r * image_data[i].a &gt;&gt; 8;\n        image_data[i].g = (unsigned short)image_data[i].g * image_data[i].a &gt;&gt; 8;\n        image_data[i].b = (unsigned short)image_data[i].b * image_data[i].a &gt;&gt; 8;\n    }\n}\n</code></pre>\n\n<p>This will convert 1 fp division and 3 fp multiplications into 3 integer multiplications and 3 bit shifts.</p>\n\n<p>Another improvement which can be done is using union struct for the pixel data:</p>\n\n<pre><code>typedef union rgba_pixel\n{\n    struct {\n        uint8_t r;\n        uint8_t g;\n        uint8_t b;\n        uint8_t a;\n    };\n\n    uint32_t u32;\n} rgba_pixel;\n</code></pre>\n\n<p>And then assigning zero to r, g and b at once:</p>\n\n<pre><code>//image_data[i].r = image_data[i].g = image_data[i].b = 0; \nimage_data[i].u32 = 0; //use this instead\n</code></pre>\n\n<p>According to <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">https://godbolt.org/</a> with <code>x86-64 gcc 7.2</code>, the latter generates less instructions at <code>-O3</code>. Which of course may or may not be faster in practice.</p>\n\n<p>Another thing to be considered is partial loop unrolling, i.e. processing multiple (for example 4) pixels per loop iteration. If you are guaranteed that your rows are multiples of 4 in width, you do it even without additional checks.</p>\n"}], "owner": {"reputation": 382, "user_id": 2956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfc0afc453967c0fa233235661e6f9f?s=128&d=identicon&r=PG&f=1", "display_name": "phenompbg", "link": "https://stackoverflow.com/users/2956424/phenompbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 46805240, "answer_count": 1, "score": 2, "last_activity_date": 1508323369, "creation_date": 1508311302, "last_edit_date": 1508316060, "question_id": 46804751, "link": "https://stackoverflow.com/questions/46804751/premultiplying-image-alpha-efficiently", "title": "Premultiplying image alpha efficiently", "body": "<p>Load a 32bit image into a buffer and I then premultiply the color values with the corresponding alpha to use for blending.</p>\n\n<p>The following works but I am wondering if there is a more efficient way of doing this, even if it only results in a good-enough approximation?</p>\n\n<p>image data is a pointer of this type:</p>\n\n<pre><code>typedef struct rgba_pixel\n{\n    uint8_t r;\n    uint8_t g;\n    uint8_t b;\n    uint8_t a;\n} rgba_pixel;\n\nrgba_pixel * image_data;\n\nfor ( i = 0; i &lt; length; i++ )\n{\n    if ( image_data[i].a == 0 )\n        image_data[i].r = image_data[i].g = image_data[i].b = 0;\n    else if ( image_data[i].a &lt; 255 )\n    {\n        alpha_factor = image_data[i].a / 255.0;\n        image_data[i].r = image_data[i].r * alpha_factor;\n        image_data[i].g = image_data[i].g * alpha_factor;\n        image_data[i].b = image_data[i].b * alpha_factor;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 7, "creation_date": 1508310088, "post_id": 46804410, "comment_id": 80555705, "body": "<code>%lld</code>s should be <code>%llu</code>s"}, {"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "edited": false, "score": 1, "creation_date": 1508310682, "post_id": 46804410, "comment_id": 80556018, "body": "Cannot reproduce:  <a href=\"https://ideone.com/aJCFKc\" rel=\"nofollow noreferrer\">ideone.com/aJCFKc</a> Although as noted the format specified for unsigned long long is not lld, the code still works as expected"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1508311986, "post_id": 46804410, "comment_id": 80556714, "body": "The maximal value of some <code>unsigned long long</code>  is only 2**64 - 1 on my machine since they have 64 bits."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1508312118, "post_id": 46804410, "comment_id": 80556803, "body": "You may want to use <a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow noreferrer\">arbitrary precision arithmetic</a> with <a href=\"http://gmplib.org/\" rel=\"nofollow noreferrer\">GMPlib</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1508312151, "post_id": 46804410, "comment_id": 80556822, "body": "The sum modulo N is equal to the (sum of each of its components modulo N) modulo N.  So, simply keep <code>a</code> and <code>b</code> valid modulo 1000000007 (did I count the zeros correctly?) and add them and take the result modulo 100000007.  Those values won&#39;t exceed 2^31-1 when added, so 32-bit arithmetic should be OK."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1508312560, "post_id": 46804410, "comment_id": 80557072, "body": "<code>62429712</code> <b>is</b> <code>1062429719 % 1000000007</code>. You&#39;ve commented the remainder operation out but that is not the code you&#39;re running. Voting to close as &quot;unable to reproduce&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5565993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iS4sV.jpg?s=128&g=1", "display_name": "ch15", "link": "https://stackoverflow.com/users/5565993/ch15"}, "edited": false, "score": 1, "creation_date": 1508312891, "post_id": 46804848, "comment_id": 80557261, "body": "Thanks! This solved it, but apparently I have to find a more efficient algorithm now, only executes half of the subtasks. But thanks anyways ;)"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 81, "user_id": 5565993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iS4sV.jpg?s=128&g=1", "display_name": "ch15", "link": "https://stackoverflow.com/users/5565993/ch15"}, "edited": false, "score": 0, "creation_date": 1508312931, "post_id": 46804848, "comment_id": 80557290, "body": "First you need to get it right, then optimize @ch15, you are welcome!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1508312685, "last_edit_date": 1508312685, "creation_date": 1508311697, "answer_id": 46804848, "question_id": 46804410, "link": "https://stackoverflow.com/questions/46804410/general-fibonacci-why-is-it-overflowing/46804848#46804848", "title": "General Fibonacci, why is it overflowing?", "body": "<p>Change this:</p>\n\n<pre><code>scanf(\"%lld%lld%lld\", &amp;a, &amp;b, &amp;hn);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>scanf(\"%llu%llu%llu\", &amp;a, &amp;b, &amp;hn);\n</code></pre>\n\n<p>Change this:</p>\n\n<pre><code>printf(\"%lld\\n\", value);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>printf(\"%llu\\n\", value);\n</code></pre>\n\n<p>since these variables are of type <code>unsigned long long</code>.</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>It seems like (from your edit) you need to change this:</p>\n\n<pre><code>value = a + b;\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>value = (a + b) % 1000000007; \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1508312867, "post_id": 46805083, "comment_id": 80557248, "body": "Right, I figured that out after the edit of the OP. Nice catch."}], "tags": [], "owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "is_accepted": false, "score": 2, "last_activity_date": 1508312576, "creation_date": 1508312576, "answer_id": 46805083, "question_id": 46804410, "link": "https://stackoverflow.com/questions/46804410/general-fibonacci-why-is-it-overflowing/46805083#46805083", "title": "General Fibonacci, why is it overflowing?", "body": "<p>You misinterpreted the point where you should calculate the modulo according to your exercise.</p>\n\n<p>You don't compute the end sum before doing modulo, but you apply modulo to the intermediate results:</p>\n\n<pre><code>for (int j = 3; j &lt;= hn; j++)\n{\n    value = (a + b) % 1000000007; // there\n    a = b;\n    b = value;\n}\n</code></pre>\n\n<p>Also, change your scan/print format to <code>'%llu'</code>, as @gsamaras suggested.</p>\n"}], "owner": {"reputation": 81, "user_id": 5565993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iS4sV.jpg?s=128&g=1", "display_name": "ch15", "link": "https://stackoverflow.com/users/5565993/ch15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 46804848, "answer_count": 2, "score": 1, "last_activity_date": 1508312685, "creation_date": 1508309950, "last_edit_date": 1508312024, "question_id": 46804410, "link": "https://stackoverflow.com/questions/46804410/general-fibonacci-why-is-it-overflowing", "title": "General Fibonacci, why is it overflowing?", "body": "<p>I am trying to create a general fibonacci series where the starting values can be variable, depending on what the user wants. For example, instead of starting with values 0, 1, or 1, 1, as it usually does, it can start with 3, 6, or 10, 21, or whatever the user wants. We then want to get the nth value of that series.</p>\n\n<p>I tried my code for a = 10 and b = 21, and I wanted a big value, however it didn't work. So I started checking where the problem was. With those starting values: for n = 37, 38, 39, the output should be 405812042, 656617677, 1062429719 respectively. When I run my code for values n = 37 and n = 38, both answers are correct. However when I try 39, this is the value I get: 62429712.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n  unsigned long long a, b, hn, value;\n  int scenarios;\n\n  scanf(\"%d\", &amp;scenarios);\n\n  for (int i = 0; i &lt; scenarios; i++){\n    scanf(\"%lld%lld%lld\", &amp;a, &amp;b, &amp;hn);\n    if (hn == 1)\n      value = a;\n    else if (hn == 2)\n      value = b;\n    else{\n      for (int j = 3; j &lt;= hn; j++){\n        value = a + b;\n        a = b;\n        b = value;\n      }\n    //value %= 1000000007;\n    }\n    printf(\"%lld\\n\", value);\n  }\n\n\n}\n</code></pre>\n\n<p>EDIT: According to the problem specification, the answer should be module 1000000007. The output I get if I get the 514th value is 2903631044495864380, and to be honest I don't know how to verify this value. If I do 2903631044495864380 mod 1000000007, my answer is 170447212, but according to the problem this answer should be 859861000. Any idea how to verify this?</p>\n"}, {"tags": ["c", "linux", "sockets"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1508308777, "post_id": 46804125, "comment_id": 80555038, "body": "&quot;in which case would one use a number other than 0?&quot; &gt;&gt; <i>However, it is possible that many protocols may exist, in which case a particular protocol must be specified in this manner.</i>"}, {"owner": {"reputation": 554, "user_id": 5464383, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WX28K.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/5464383/trey"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1508308982, "post_id": 46804125, "comment_id": 80555146, "body": "@SouravGhosh, I&#39;d like to see a real example, that&#39;s what I meant"}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 7920351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3facab1428b83f34f14c64222bd8d693?s=128&d=identicon&r=PG&f=1", "display_name": "oarcas", "link": "https://stackoverflow.com/users/7920351/oarcas"}, "is_accepted": false, "score": 1, "last_activity_date": 1519825779, "creation_date": 1519825779, "answer_id": 49031129, "question_id": 46804125, "link": "https://stackoverflow.com/questions/46804125/what-is-the-hopopt-protocol-and-how-does-socket-work/49031129#49031129", "title": "What is the HOPOPT protocol and how does socket() work?", "body": "<p>HOPOPT is the acronym of the <a href=\"https://en.wikipedia.org/wiki/IPv6_packet#Hop-by-hop_options_and_destination_options\" rel=\"nofollow noreferrer\">Hop-by-Hop IPv6 extension header</a>. It is a header that allows to add even more options to an IPv6 packet. It is normal that IPv6 packets include this header.</p>\n\n<p><code>socket()</code> is the system call that BSD and others (Linux et al.) provide to create a new socket, that is the internal representation of a network connection. When creating a new socket, the desired protocol must be specified: TCP, UDP, etc., which may go over IPv4, IPv6, etc.</p>\n\n<p>The paragraph that you are citing explains that one or many protocols may exist for each socket type.</p>\n\n<p>If only one exists, the <code>protocol</code> argument must be zero. For instance, <code>SOCK_STREAM</code> sockets are only implemented by TCP:</p>\n\n<pre><code>int sk = socket(AF_INET, SOCK_STREAM, 0);\n</code></pre>\n\n<p>If more exist, than you must specify which protocol in particular you want to use. For example, the <code>SOCK_SEQPACKET</code> type can be implemented with the SCTP protocol:</p>\n\n<pre><code>int sk = socket(AF_INET, SOCK_SEQPACKET, IPPROTO_SCTP);\n</code></pre>\n\n<p>So, in conclusion:</p>\n\n<ul>\n<li>If you want to create a socket, choose what protocol to use, for instance TCP over IPv4.</li>\n<li>HOPOPT is totally normal in an IPv6 packet. If you see it appear in your traces, because you created an IPv6 socket (using <code>AF_INET6</code>), it is OK.</li>\n</ul>\n"}], "owner": {"reputation": 554, "user_id": 5464383, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WX28K.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/5464383/trey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519825779, "creation_date": 1508308683, "question_id": 46804125, "link": "https://stackoverflow.com/questions/46804125/what-is-the-hopopt-protocol-and-how-does-socket-work", "title": "What is the HOPOPT protocol and how does socket() work?", "body": "<p>I'm messing with sockets in C and this protocol continues to show up, I couldn't find anything about it, so what is it used for? What's the difference between HOPOPT and IP?</p>\n\n<p>Also i'm don't get why the last argument of the socket() function should be 0. According to the man page:</p>\n\n<blockquote>\n  <p>The protocol specifies a particular protocol to be used with the socket. Normally only a single protocol exists to support a particular socket type within a given protocol family, in which case protocol can be specified as 0. However, it is possible that many protocols may exist, in which case a particular protocol must be specified in this manner. The protocol number to use is specific to the \u201ccommunication domain\u201d in which communication is to take place; see protocols(5). See getprotoent(3) on how to map protocol name strings to protocol numbers.</p>\n</blockquote>\n\n<p>As far as I understand setting the last argument to 0 will let the standard library to decide which protocol to use but in which case would one use a number other than 0?</p>\n"}, {"tags": ["c", "algorithm", "optimization"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1508307759, "post_id": 46803901, "comment_id": 80554572, "body": "How much is &quot;7kk kilobytes&quot;? Do you mean 7 gigabytes? 7 megabytes? Or just 7 kilobytes?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1508307828, "post_id": 46803901, "comment_id": 80554598, "body": "Doesn&#39;t really make a big difference, but you could have <code>x = abs(x);</code> right after the <code>scanf</code> and get rid of all subsequent calls to <code>abs</code>."}, {"owner": {"reputation": 47, "user_id": 8709475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e__bha-njak/AAAAAAAAAAI/AAAAAAAAACk/sMF-Ghw6eTQ/photo.jpg?sz=128", "display_name": "hOUSTANSTARx yolo", "link": "https://stackoverflow.com/users/8709475/houstanstarx-yolo"}, "edited": false, "score": 0, "creation_date": 1508307848, "post_id": 46803901, "comment_id": 80554608, "body": "7331840KB, if x=1874657754"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1508307852, "post_id": 46803901, "comment_id": 80554613, "body": "As for possible way to optimize it, there are quite literally several thousands (if not several tens of thousands) of different implementations of the Sieve of Eratosthenes everywhere on the Internet. You should really try to search more."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 3, "creation_date": 1508308652, "post_id": 46803901, "comment_id": 80554981, "body": "Because <code>a[n]</code> in your programm can only have the values <code>n</code> or <code>0</code>, you don&#39;t need to save them. A bit is enough. On a 32-bit implementation you can reduce the needed memory to 1/32."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1508312676, "post_id": 46803901, "comment_id": 80557132, "body": "If it works, go to codereview. Stack Overflow is more of a site is for <b>single most correct answer to a problem</b>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1508340568, "post_id": 46803901, "comment_id": 80574878, "body": "<a href=\"https://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4353842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e6db79c0abb2304e6344c6af70dc0bd?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Pag&#232;s", "link": "https://stackoverflow.com/users/4353842/guillaume-pag%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1508340018, "creation_date": 1508340018, "answer_id": 46813712, "question_id": 46803901, "link": "https://stackoverflow.com/questions/46803901/optimizing-an-algorithm-to-calculate-max-prime-div/46813712#46813712", "title": "Optimizing an algorithm to calculate max prime div", "body": "<p>You can do implementation optimizations (like using one bit instead of 32) but it will at most get you a 32 optimization factor.</p>\n\n<p>A more interesting thing would be to do algorithm optimisation (like not computing the full sieve but only to sqrt(x))</p>\n\n<pre><code>int x, p, i, q;\nscanf_s(\"%d\", &amp;x);\nx = abs(x);\nint size = sqrt(x); // there is at most one prime number that divide x bigger than sqrt(x)\nint *a = (int*)malloc((size + 1) * sizeof(int));\nfor (i = 0; i &lt;= size; i++)\n    a[i] = i;\na[1] = 0;\nfor (p = 2; p &lt;= size; p++) {\n    if (a[p] == 0) { // p is not prime you can skip p\n    }\n    else {\n        while (x % p == 0) { // if p div x, divide it as much as possible\n            x /= p;\n        }\n        if (x == 1) {\n            printf(\"%d\", p); \n            break;\n        }\n        for (q = p * p; q &lt;= size; q += p)\n            a[q] = 0;\n    }\n}\nif (x != 1)\n    printf(\"%d\", x);\n    free(a);\nreturn 0;\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8709475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e__bha-njak/AAAAAAAAAAI/AAAAAAAAACk/sMF-Ghw6eTQ/photo.jpg?sz=128", "display_name": "hOUSTANSTARx yolo", "link": "https://stackoverflow.com/users/8709475/houstanstarx-yolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508340018, "creation_date": 1508307499, "question_id": 46803901, "link": "https://stackoverflow.com/questions/46803901/optimizing-an-algorithm-to-calculate-max-prime-div", "title": "Optimizing an algorithm to calculate max prime div", "body": "<p>this algorithm calculates max prime div using sieve of Eratosthenes.\nit takes over 7kk kilobytes to calculate x over 1000000000 lol.</p>\n\n<p>some advice how can i optimize it?\nthanks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\nint x, p, i, q, max, min;\nscanf (\"%d\", &amp;x);\nint *a = (int*)malloc((abs(x)+1) * sizeof(int));\nfor (i=0; i&lt;=abs(x); i++)\n    a[i] = i;\na[1]=0;\nfor (p=2; p&lt;=abs(x); p++){\n        for (q=p*2; q&lt;=abs(x); q+=p)\n            a[q]=0;\n} \nmax=0;\nif (x&gt;=0){\n    for(i=0; i&lt;=abs(x); i++)\n        if((a[i]!=0) &amp;&amp; (abs(x)%a[i]==0))\n            if (a[i]&gt;max)\n                max=a[i];\nprintf(\"%d\", max);\nfree(a);\n}\nelse{\nmin=abs(x);\nfor(i=0; i&lt;=abs(x); i++)\n        if((a[i]!=0) &amp;&amp; (abs(x)%a[i]==0))\n            if (a[i]&lt;min)\n                min=a[i];\nprintf (\"%d\", -min);\nfree(a);\n}\n}\n</code></pre>\n"}, {"tags": ["c", "atmega"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1508309484, "post_id": 46803859, "comment_id": 80555400, "body": "What happens if you keep the button pressed? I guess you will get your desired output. If so, then you need to change the logic in <code>if</code> statement."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1508309597, "post_id": 46803859, "comment_id": 80555448, "body": "What is PIND? Does your program enter the if-blocks in the 2nd loop?"}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1508310175, "post_id": 46803859, "comment_id": 80555755, "body": "<code>PIND</code> is the hardware register to read the state of the port pins of microcontroller."}, {"owner": {"reputation": 3, "user_id": 7714671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a752efa066d70cb79cf6e72679fec5?s=128&d=identicon&r=PG&f=1", "display_name": "kakagor", "link": "https://stackoverflow.com/users/7714671/kakagor"}, "edited": false, "score": 0, "creation_date": 1508317634, "post_id": 46803859, "comment_id": 80559986, "body": "I can do it if I keep the button pressed, but my expected result is just press the button once and then change state."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1508438700, "post_id": 46803859, "comment_id": 80621134, "body": "Buttons cannot be read this way."}], "owner": {"reputation": 3, "user_id": 7714671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a752efa066d70cb79cf6e72679fec5?s=128&d=identicon&r=PG&f=1", "display_name": "kakagor", "link": "https://stackoverflow.com/users/7714671/kakagor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569511049, "creation_date": 1508307199, "last_edit_date": 1569511049, "question_id": 46803859, "link": "https://stackoverflow.com/questions/46803859/atmega328p-for-loop-coding", "title": "atmega328p for loop coding", "body": "<pre><code>#define F_CPU 16000000UL\n#include &lt;avr/io.h&gt;\n#include &lt;util/delay.h&gt;\n\n\nint main()\n{\n    DDRD = 0x05;\n    PORTD=0xFF;\n    DDRB = 0xFF;\n    PORTB = 0x00;\n\n    int state=0;\n\n    while(1)\n    {\n        if(!(PIND &amp;(1&lt;&lt;5)) &amp;&amp; (state==0))\n        {\n\n            state=1;\n\n                PORTB = 0x38;\n                for(int i=0;i&lt;=199;i++)\n                {\n                    T1Delay_1s();\n                }\n                PORTB=0x00;\n                for(int i=0;i&lt;=199;i++)\n                {\n                    T1Delay_1s();\n                }\n        }\n\n        if(!(PIND &amp;(1&lt;&lt;5)) &amp;&amp; (state==1))\n        {\n            state=0;\n            PORTB = 0x08;\n            for(int i=0;i&lt;=99;i++)\n            {\n                T1Delay_1s();\n            }\n            PORTB=0x30;\n            for(int i=0;i&lt;=99;i++)\n            {\n                T1Delay_1s();\n            }\n        }\n    }\n}\n\nvoid T1Delay_1s()\n{\n    TCNT0=156;\n    TCCR0B=0x05;\n    while((TIFR0&amp;(1&lt;&lt;TOV0))==0);\n    TCCR0B=0;\n    TIFR0=0x1&lt;&lt;TOV0;\n}\n</code></pre>\n\n<p>The question is required that the LEDs connected to <code>PB3</code>,<code>PB4</code>,<code>PB5</code> are turned on \nin <code>state0(PB3=1,PB4=1,PB5=1)</code> and then all turn off(000) every 2 seconds</p>\n\n<p>(<code>111-&gt;000</code> every 2 seconds)</p>\n\n<p>if the button is pressed, the LEDs connected to <code>PB3</code>,<code>PB4</code>,<code>PB5</code> are turned on in <code>state1</code>(100) and then change to(011) every second</p>\n\n<p>(<code>100-&gt;011</code> every second)</p>\n\n<p>The effect of switching is fine, but the blinking effect is missed, the LEDs will blink for one loop only and then stop,how should I to fix the problem?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1508306462, "post_id": 46803671, "comment_id": 80554046, "body": "<code>malloc(sizeof(data*))</code>? And what if <code>sizeof(data) != sizeof(data*)</code> (which seems quite likely considering your assignments later)?"}, {"owner": {"reputation": 303, "user_id": 3102749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9e91300016843f680fb248eed69ea49d?s=128&d=identicon&r=PG&f=1", "display_name": "Ohunter", "link": "https://stackoverflow.com/users/3102749/ohunter"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508306585, "post_id": 46803671, "comment_id": 80554100, "body": "why wouldn&#39;t it be? It is just a pointer to some place in memory. Data is a struct that is defined in the header file so I don&#39;t see how it can&#39;t be the size of data*"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1508306700, "post_id": 46803671, "comment_id": 80554156, "body": "@Ohunter Size of a pointer is fixed. But that of your structure may be greater than the size of a pointer. Size of a pointer of any type is same."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1508306878, "post_id": 46803671, "comment_id": 80554227, "body": "The size of a pointer is typically 4 or 8 bytes (depending on if you&#39;re on a 32 or 64 bit system). Now considering that your structure itself seems to have at least four pointers in itself, that means the structure will be at least 16 or 32 bytes large. Now think about what happens when you allocate only 8 bytes for a structure containing (at least) 32 bytes."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 3102749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9e91300016843f680fb248eed69ea49d?s=128&d=identicon&r=PG&f=1", "display_name": "Ohunter", "link": "https://stackoverflow.com/users/3102749/ohunter"}, "edited": false, "score": 0, "creation_date": 1508306728, "post_id": 46803724, "comment_id": 80554177, "body": "wouldn&#39;t sizeof(*D) be the same as sizeof(D) since *D is just a pointer to D?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 303, "user_id": 3102749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9e91300016843f680fb248eed69ea49d?s=128&d=identicon&r=PG&f=1", "display_name": "Ohunter", "link": "https://stackoverflow.com/users/3102749/ohunter"}, "edited": false, "score": 0, "creation_date": 1508307009, "post_id": 46803724, "comment_id": 80554275, "body": "@Ohunter <code>*D</code> is not a pointer at all. <code>D</code> is a pointer (to <code>*D</code>). And no, they&#39;re not the same size. On a 64-bit machine, <code>D</code> is 8 bytes (size of a pointer) whereas <code>*D</code> is 40 bytes (size of <code>data</code>: 4 pointers plus 1 <code>val</code>)."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1508306516, "creation_date": 1508306516, "answer_id": 46803724, "question_id": 46803671, "link": "https://stackoverflow.com/questions/46803671/sysmalloc-assertion/46803724#46803724", "title": "Sysmalloc: Assertion", "body": "<p>You're writing outside of your allocated buffer.</p>\n\n<p>That's because your malloc call passes the wrong size:</p>\n\n<pre><code>D = malloc(sizeof(data*));  // allocate memory for a single pointer\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>D = malloc(sizeof(data));  // allocate memory for a whole struct\n</code></pre>\n\n<p>But really,</p>\n\n<pre><code>D = malloc(sizeof *D);  // allocate memory for whatever D points to\n</code></pre>\n\n<p>is best because then you don't need to see the declaration of <code>D</code> to check that this line is correct.</p>\n"}, {"tags": [], "owner": {"reputation": 829, "user_id": 5569396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5Prh.jpg?s=128&g=1", "display_name": "Gor Asatryan", "link": "https://stackoverflow.com/users/5569396/gor-asatryan"}, "is_accepted": false, "score": 1, "last_activity_date": 1555673543, "last_edit_date": 1555673543, "creation_date": 1508306737, "answer_id": 46803762, "question_id": 46803671, "link": "https://stackoverflow.com/questions/46803671/sysmalloc-assertion/46803762#46803762", "title": "Sysmalloc: Assertion", "body": "<p>You are allocating memory for <code>data</code> pointer (<code>data*</code>), but you need memory to store <code>data</code>. You have to use <code>D = malloc(sizeof(data))</code>.</p>\n"}], "owner": {"reputation": 303, "user_id": 3102749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9e91300016843f680fb248eed69ea49d?s=128&d=identicon&r=PG&f=1", "display_name": "Ohunter", "link": "https://stackoverflow.com/users/3102749/ohunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5185, "favorite_count": 0, "accepted_answer_id": 46803724, "answer_count": 2, "score": 0, "last_activity_date": 1555673543, "creation_date": 1508306280, "last_edit_date": 1508310500, "question_id": 46803671, "link": "https://stackoverflow.com/questions/46803671/sysmalloc-assertion", "title": "Sysmalloc: Assertion", "body": "<blockquote>\n  <p>main: malloc.c:2405: sysmalloc: Assertion `(old_top == initial_top (av) &amp;&amp; old_size == 0) || ((unsigned long) (old_size) >= MINSIZE &amp;&amp; prev_inuse (old_top) &amp;&amp; ((unsigned long) old_end &amp; (pagesize - 1)) == 0)' failed.  </p>\n</blockquote>\n\n<p>When trying to produce a doubly linked list where the user can only add to the head or tail, I end up getting the lovely abortion message at the top. </p>\n\n<p>I have used gdb to narrow it down to what function it is that is causing this, but I really don't know what I'm doing wrong. It allocates the first node, then after that, it throws me the error.<br>\nThe function is as follows:</p>\n\n<pre><code>data* initD(){\n    data *D = NULL;\n\n    D = malloc(sizeof(data*));\n    if (!D){\n        printf(\"Error in allocation of data\\n\");\n        exit(0);\n    }\n\n    D-&gt;head = NULL;\n    D-&gt;tail = NULL;\n    D-&gt;next = NULL;\n    D-&gt;prev = NULL;\n    D-&gt;val = -1;\n\n    return D; \n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "hungarian-algorithm"], "comments": [{"owner": {"reputation": 1293, "user_id": 3878168, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/39TS0.jpg?s=128&g=1", "display_name": "Yay295", "link": "https://stackoverflow.com/users/3878168/yay295"}, "edited": false, "score": 0, "creation_date": 1508374457, "post_id": 46803600, "comment_id": 80590104, "body": "Prof. Srinivasan ( <a href=\"https://www.youtube.com/watch?v=BUGIhEecipE&amp;t=75\" rel=\"nofollow noreferrer\">youtube.com/watch?v=BUGIhEecipE&amp;t=75</a> ) does a pretty good job of explaining everything I think."}], "answers": [{"comments": [{"owner": {"reputation": 52627, "user_id": 1971805, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YBbqr.jpg?s=128&g=1", "display_name": "TerryA", "link": "https://stackoverflow.com/users/1971805/terrya"}, "edited": false, "score": 1, "creation_date": 1508320464, "post_id": 46805825, "comment_id": 80561828, "body": "Sorry, but this isn\u2019t what I was asking for. I\u2019m asking for \u201cStep 3\u201d I.E <i>how</i> you found out that those were the three lines to cover all zeroes. I\u2019m aware that (2,3) isn\u2019t being covered - that\u2019s my bug :P"}, {"owner": {"reputation": 747, "user_id": 4675404, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/101bf4435d0895eb39d67c93345b3805?s=128&d=identicon&r=PG&f=1", "display_name": "gia", "link": "https://stackoverflow.com/users/4675404/gia"}, "edited": false, "score": 0, "creation_date": 1519512547, "post_id": 46805825, "comment_id": 84942427, "body": "1 1 0 1 0 // 1 1 0 1 0 // 1 1 0 1 0 // 0 1 1 1 0 // 1 1 1 1 1 , the algorithm doesnt work"}], "tags": [], "owner": {"reputation": 12253, "user_id": 6671342, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/22063dc94e4bdcb1b6fb634e5865f5aa?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6671342/coder"}, "is_accepted": true, "score": 4, "last_activity_date": 1508437443, "last_edit_date": 1508437443, "creation_date": 1508315323, "answer_id": 46805825, "question_id": 46803600, "link": "https://stackoverflow.com/questions/46803600/hungarian-algorithm-wikipedia-method-doesnt-work-for-this-example/46805825#46805825", "title": "Hungarian Algorithm - Wikipedia method doesn&#39;t work for this example", "body": "<p>Wikipedia is lacking explanation on the algorithm, the assignments will be done in the last step!</p>\n\n<p>STEP 0</p>\n\n<pre><code>35  0  0  0\n 0 30  0  5\n55  5  0 10\n 0 45 30 45\n</code></pre>\n\n<p>STEP 1-2\nall rows-columns have at least one 0 so step 1 leaves array the same </p>\n\n<pre><code>35  0  0  0\n 0 30  0  5\n55  5  0 10\n 0 45 30 45\n</code></pre>\n\n<p>STEP 3<br>\nAll zeros in the matrix must be covered by marking as few rows and/or columns as possible</p>\n\n<pre><code>- - - -\n|   |\n|   |\n|   |\n</code></pre>\n\n<p>Note that <strong>no assignments are done thus far</strong> and you need to cover <code>all zeros</code>. Your cover left zero (2,3) uncovered!!</p>\n\n<p>Now take min element that is not covered e.g 5 (take the 5 at position (2,4))</p>\n\n<p>-Reduce (by 5) all elements that where not covered.<br>\n-Increase (by 5) all elements crossed by two lines.<br>\n-Rest remain same<br>\n So the array:</p>\n\n<pre><code>40  0  5  0\n 0 25  0  0\n55  0  0  5\n 0 40 30 40\n</code></pre>\n\n<p>Now check again for min required lines: now you need 4 lines (equal to size n=4 of rows of array, so we stop).</p>\n\n<p>Finally assignment:\nStart from lines with only one zero this  will surely be assigned:</p>\n\n<pre><code>40  0  5  _\n 0 25  _  0\n55  _  0  5\n _ 40 30 40\n</code></pre>\n\n<p>Multiple assignments exist (I use _ for assignment).</p>\n\n<p>More specifically two assignments we get: (one stated above with total cost 5) and:</p>\n\n<pre><code>40  _  5  0\n 0 25  0  _\n55  0  _  5\n _ 40 30 40\n</code></pre>\n\n<p>With also cost 5!</p>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>Based on comment it seems that I didn't get the exact part that op was asking so I will answer this specific part keeping the general description of the algorithm above.</p>\n\n<p>The mistake (due to bad Wikipedia description) is here:</p>\n\n<blockquote>\n  <p>Where zero prime is the assigned zero. Then, following Wikipedia's\n  instructions below, I mark row 4 (unassigned zero), column 1 (col with\n  the unassigned zero), then row 2 (row with a zero in a marked col).</p>\n</blockquote>\n\n<p><strong>Totally agree till now but...it's not complete!!!</strong></p>\n\n<blockquote>\n  <p>When correctly marking row2 you need to go to step 2 (of Wikipedia)\n  and check again for columns with zeros in this case column 3 should\n  also been marked, this also causes the row 3 to be marked as well (due to assigned zero in the newly marked column 3) and\n  there you stop (no other rows or columns should be marked)!!</p>\n</blockquote>\n\n<p>So overall the marked columns and rows:</p>\n\n<pre><code> +       +\n35   0'  0   0\n 0' 30   0   5  +\n55   5   0' 10  +\n 0  45  30  45  +\n</code></pre>\n\n<p>And the lines you get by choosing the marked columns and unmarked lines:</p>\n\n<pre><code>- - - -\n|   |\n|   |\n|   |\n</code></pre>\n\n<p>which is the right one as described in the first part of answer and leads to right results in next stages (also explained above).</p>\n\n<p>One very similar post that states literally same thing can be found on <strong>mathstackexchange</strong>:</p>\n\n<p><a href=\"https://math.stackexchange.com/questions/590305/finding-the-minimum-number-of-lines-to-cover-all-zeros-in-an-assignment-probem\">finding the minimum number of lines to cover all zeros in an assignment probem</a></p>\n"}], "owner": {"reputation": 52627, "user_id": 1971805, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YBbqr.jpg?s=128&g=1", "display_name": "TerryA", "link": "https://stackoverflow.com/users/1971805/terrya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 2, "accepted_answer_id": 46805825, "answer_count": 1, "score": 8, "last_activity_date": 1508437443, "creation_date": 1508305909, "last_edit_date": 1508324056, "question_id": 46803600, "link": "https://stackoverflow.com/questions/46803600/hungarian-algorithm-wikipedia-method-doesnt-work-for-this-example", "title": "Hungarian Algorithm - Wikipedia method doesn&#39;t work for this example", "body": "<p>I'm trying to implement a Hungarian Algorithm in C.</p>\n\n<p>I have the matrix:</p>\n\n<pre><code>35  0  0  0\n 0 30  0  5\n55  5  0 10\n 0 45 30 45\n</code></pre>\n\n<p>And I'm up to the stage where I have to find the minimum amount of lines to cover all zeroes (making as many assignments as possible). Obviously, by inspection this is columns 1 and 3 and row 1.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Hungarian_algorithm#Matrix_interpretation\" rel=\"nofollow noreferrer\">Wikipedia suggests the following method</a>:</p>\n\n<ul>\n<li>Row 1 has three zeroes: pick any (I pick the first one) and assign it</li>\n<li>Row 2: Assign the first zero</li>\n<li>Row 3: Assign the 3rd zero</li>\n<li>Row 4 is unassigned (since the only zero is in a col that already has an assigned zero)</li>\n</ul>\n\n<p>If I follow this for my matrix above, I get:</p>\n\n<pre><code>35   0'  0   0\n 0' 30   0   5\n55   5   0' 10\n 0  45  30  45\n</code></pre>\n\n<p>Where zero prime is the assigned zero. Then, following Wikipedia's instructions below, I mark row 4 (unassigned zero), column 1 (col with the unassigned zero), then row 2 (row with a zero in a marked col).</p>\n\n<p>So that would suggest that the min lines to hit all zeroes are:</p>\n\n<pre><code>+--------\n|\n+--------\n|\n</code></pre>\n\n<p>But this doesn't hit the zero at <code>(2, 3)</code>. Relevant C code:</p>\n\n<pre><code>for (i = 0; i &lt; M-&gt;size; i++) {\n    for (j = 0; j &lt; M-&gt;size; j++) {\n        if (M-&gt;values[i][j] == 0) {\n            if (assigned_cols[j] == 0) {\n                assigned_cols[j] = 1; // We've assigned something in this col\n                assigned_rows[i] = 1; // We've assigned something in this row.\n                marked_rows[i] = 0;\n                total--;\n                break; // Go to the next row\n            } else {\n                marked_cols[j] = 1; // Then there exists a zero in this col in an unassigned row\n                mark_col(M, j); // marks all elements in column j\n                total++;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>This code chooses which zeroes are zero prime (assigns zeroes).</p>\n\n<p>Then this code marks all rows having assignments in newly-marked columns:</p>\n\n<pre><code> for (i = 0; i &lt; M-&gt;size; i++) {\n    if (marked_cols[i] == 1) {\n        for (j = 0; j &lt; M-&gt;size; j++) {\n        //iterating through rows\n            if (M-&gt;values[j][i] == 0) {\n                // then (j,i) is a zero in a marked col\n                // mark the row\n                if (marked_rows[j] != 1) {\n                    total++;\n                    marked_rows[j] = 1;\n                }\n                break; // no need to continue more\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>But this (and the wikipedia explanation) fails for my matrix above. How come?</p>\n"}, {"tags": ["c", "arrays", "file-io"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1508305371, "post_id": 46803460, "comment_id": 80553617, "body": "<code>buf</code> is never initialized, so you&#39;re asking for explosions here when calling <code>strlen</code> on it."}, {"owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508305831, "post_id": 46803460, "comment_id": 80553818, "body": "okay i put 16 (size of buffer) in place of strlen(buf)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508305922, "post_id": 46803460, "comment_id": 80553852, "body": "It&#39;s probably better to avoid magical numbers like that and instead use <code>sizeof(buf)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 0, "creation_date": 1508305564, "post_id": 46803497, "comment_id": 80553703, "body": "i see, but what does this have to do with s1 and why is s1 overwritten?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 0, "creation_date": 1508305891, "post_id": 46803497, "comment_id": 80553843, "body": "@user3226932 After you make a mistake like this, you cannot reliably access anything. The compiler is free to optimize assuming you will never do this and once you violate that assumption, all bets are off. Maybe the <code>strcat</code> happened to scribble over the memory that <code>s2</code> happened to be using at that time. Maybe not."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1508305942, "post_id": 46803497, "comment_id": 80553858, "body": "Undefined behaviour.  &#39;what does this have to do with s1 and why is s1 overwritten?&#39; what?  s2 and s1 are next to each other, so it&#39;s not surprising that overrunning one would blast the other."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508305989, "post_id": 46803497, "comment_id": 80553868, "body": "A debugger which can show you the memory of where your <code>char*</code> pointers point to will make this problem <i>immediately</i> evident."}, {"owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 0, "creation_date": 1508306879, "post_id": 46803497, "comment_id": 80554228, "body": "ok i&#39;ve used sizeof(buf), is there a better approach than defining an empty string s2 and appending buf to it?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 0, "creation_date": 1508307524, "post_id": 46803497, "comment_id": 80554482, "body": "@user3226932 Maybe allocate a larger buffer."}, {"owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 0, "creation_date": 1508307851, "post_id": 46803497, "comment_id": 80554611, "body": "how would a larger buffer help? isn&#39;t the whole point of fread to read in certain number of bytes at a time? it gets overwritten on the next fread, i need to append buffer to my final string so I can get the full contents of the file"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1508308114, "post_id": 46803497, "comment_id": 80554714, "body": "Chuckling.... short, succinct, and dead on point. That&#39;s a good answer. <i>&quot;you&#39;re trying to append onto it -- but it doesn&#39;t have any extra space.&quot;</i> -- poetry <code>:)</code>"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "edited": false, "score": 1, "creation_date": 1508308532, "post_id": 46803497, "comment_id": 80554925, "body": "@user3226932 Right, so maybe allocate a larger buffer for that final string? <code>char s2[] = &quot;&quot;;</code> allocates only a very small array. You need a bigger one. (Or perhaps make your own <code>strcat</code> that reallocates if the buffer isn&#39;t large enough? It&#39;s up to you.)"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 4, "last_activity_date": 1508305365, "creation_date": 1508305365, "answer_id": 46803497, "question_id": 46803460, "link": "https://stackoverflow.com/questions/46803460/2nd-char-array-overwriting-1st-char-array-after-fread-from-file/46803497#46803497", "title": "2nd char array overwriting 1st char array after fread from file", "body": "<pre><code>readCounter = fread(buf, sizeof(char), strlen(buf), fp);\n</code></pre>\n\n<p>This is a problem. At this point, <code>buf</code> doesn't contain a string, so passing it to <code>strlen</code> is an error.</p>\n\n<p>Also:</p>\n\n<pre><code>char s2[] = \"\";\n...\nstrcat(s2, buf);\n</code></pre>\n\n<p>This is not good. When you alllocated <code>s2</code>, it pointed to an empty string. So the array was sized to hold an empty string. By passing <code>s2</code> to <code>strcat</code>, you're trying to append onto it -- but it doesn't have any extra space.</p>\n"}], "owner": {"reputation": 1383, "user_id": 3226932, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e05eac9c05a7aefcaa1ca3a27191fbb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3226932", "link": "https://stackoverflow.com/users/3226932/user3226932"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 46803497, "answer_count": 1, "score": 0, "last_activity_date": 1508305391, "creation_date": 1508305144, "last_edit_date": 1508305391, "question_id": 46803460, "link": "https://stackoverflow.com/questions/46803460/2nd-char-array-overwriting-1st-char-array-after-fread-from-file", "title": "2nd char array overwriting 1st char array after fread from file", "body": "<p>Goal is to use C to read data from file (could be text or binary) and then append to an existing string</p>\n\n<p>I have 2 char arrays, one an existing string (s1), and another a string (s2) I'll append the buffer char array (buf) to </p>\n\n<pre><code>size_t readCounter = 0;\nchar buf[16];\nchar s1[] = \"hello \";\nchar s2[] = \"\"\n\nwhile (1) {\n    readCounter = fread(buf, sizeof(char), strlen(buf), fp);\n\n    if (readCounter == 0) {\n        break;\n    }\n\n    strcat(s2, buf);    \n}\n\nprintf(\"%s\", s1);\nprintf(\"%s\", s2);\n</code></pre>\n\n<p>Problem:</p>\n\n<p>When I print out s1, it no longer is \"hello \", it includes the characters from the file so for some reason the first char array is being overwritten in memory. Why does this happen? How can I resolve this?</p>\n"}, {"tags": ["c", "linux", "function", "sockets", "ip-address"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508305311, "post_id": 46803345, "comment_id": 80553601, "body": "<a href=\"https://stackoverflow.com/questions/30597111/get-local-port-used-by-socket\" title=\"get local port used by socket\">stackoverflow.com/questions/30597111/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 4529810, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/qmPKC.png?s=128&g=1", "display_name": "Clive", "link": "https://stackoverflow.com/users/4529810/clive"}, "edited": false, "score": 0, "creation_date": 1508406129, "post_id": 46803551, "comment_id": 80601387, "body": "Martin - I don&#39;t think you&#39;re correct.  getsockname() requires the caller to supply a socket file descriptor (sockfd).  But we wouldn&#39;t know the local one.  We know the one we created with socket(), but when we used it with connect() it became associated with the REMOTE IP address, not the local one."}, {"owner": {"reputation": 265, "user_id": 4529810, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/qmPKC.png?s=128&g=1", "display_name": "Clive", "link": "https://stackoverflow.com/users/4529810/clive"}, "edited": false, "score": 0, "creation_date": 1508407753, "post_id": 46803551, "comment_id": 80602273, "body": "I think I may have worked out one answer, but it&#39;s still insufficient for what I want.  You could use gethostname() then getaddrinfo() on what it returns.  But I think you might only get 127.0.0.1 or an address beginning 192.168. etc which is what the gateway (router) may have alloted you in a DHCP operation.  It doesn&#39;t give you the (temporary) IP address you are alloted on the internet."}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "reply_to_user": {"reputation": 265, "user_id": 4529810, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/qmPKC.png?s=128&g=1", "display_name": "Clive", "link": "https://stackoverflow.com/users/4529810/clive"}, "edited": false, "score": 0, "creation_date": 1508480723, "post_id": 46803551, "comment_id": 80634302, "body": "@Clive Please see my edit: Sorry, but I think what you want to do is not possible."}, {"owner": {"reputation": 265, "user_id": 4529810, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/qmPKC.png?s=128&g=1", "display_name": "Clive", "link": "https://stackoverflow.com/users/4529810/clive"}, "edited": false, "score": 0, "creation_date": 1508550924, "post_id": 46803551, "comment_id": 80666323, "body": "Thank you Martin for your added message.  Yeah I guess you&#39;re right.  The info is not easily accessible (other than writing a specific program to access another server on the internet and ask it what IP it thinks I am.)  But then, that might only give the IP of the router?  Or the IP that the router injected into the packets as a way of knowing which of its computers should receive the response?  (Is that NAT?)  Or the IP of the ISP, or the IP the ISP allocated to my router?  Seems like it&#39;s a minefield of aliases."}], "tags": [], "owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "is_accepted": false, "score": 2, "last_activity_date": 1508480685, "last_edit_date": 1592644375, "creation_date": 1508305635, "answer_id": 46803551, "question_id": 46803345, "link": "https://stackoverflow.com/questions/46803345/which-function-tells-me-what-address-the-kernel-bound-the-local-socket-to/46803551#46803551", "title": "Which function tells me what address the kernel bound the local socket to?", "body": "<p>I'm not sure if I understand your question correctly. I understood it the following way:</p>\n<blockquote>\n<p>Computer &quot;A&quot; uses <code>socket()</code> and <code>connect()</code> to establish a TCP connection to computer &quot;B&quot; which is using <code>socket()</code>, <code>bind()</code>, <code>listen()</code> and <code>access()</code>.</p>\n<p>The IP address and the TCP port on computer &quot;B&quot; is well known (of course - you connect to a <strong>certain</strong> TCP port on a <strong>certain</strong> computer).</p>\n<p>But how is it possible to find out the IP address and the TCP port on computer &quot;A&quot; belonging to this connection?</p>\n</blockquote>\n<p>The function which will do that on computer &quot;A&quot; is <code>getsockname()</code>.</p>\n<p>On computer &quot;B&quot; <code>getpeername()</code> will return that information.</p>\n<p>If computer &quot;B&quot; has multiple IP addresses (e.g. multiple network cards) computer &quot;B&quot; may also use <code>getsockname()</code> to get its own IP address.</p>\n<p>Before calling <code>connect()</code> the socket has no port number and no IP address, yet. So calling <code>getsockname()</code> before calling <code>connect()</code> makes no sense.</p>\n<p>The reason for this is simple: If a computer has multiple network cards with different IP addresses the IP address on computer &quot;A&quot; side cannot be known before it is known which of the network cards must be used. (Note that <code>localhost</code> is seen as separate &quot;network card&quot; with the IP address 127.0.0.1 by the OS!)</p>\n<p><strong>EDIT</strong></p>\n<blockquote>\n<p>But I think you might only get ... 192.168. ... It doesn't give you the ... IP address you are alloted on the internet.\nYour problem can be explained the following way:</p>\n</blockquote>\n<p>The original idea of the internet was that every computer has its own global IP address (this is what you call: &quot;addresses you are allocated on the internet&quot;).</p>\n<p>There was never a change in this idea: Nearly any PC software (including the OS) is written for computers having a global IP address.</p>\n<p>Because your provider can only give you one IP address your router is &quot;fooling&quot; your computers by &quot;simulating&quot; an internet where the local computers have global addresses (e.g. in the range 192.168.).</p>\n<p>Because of this &quot;simulation&quot; the computer can behave exactly like 192.168.x.y is its global IP address in the internet. The computer does not even have any information about the fact that this is not a global IP address!</p>\n<p>So it's clear that these functions return 192.168.x.y because the operating system &quot;thinks&quot; that this is the global address on the internet!</p>\n<p>The only device that has information about the real global address (and about the real TCP port!!!) is the router!</p>\n<p>Many providers use CGNAT which means that even multiple internet connections share one IP address. In this case the only device having that information is the provider's router.</p>\n<p>If you need the real IP address and the real TCP port (as seen from the internet) you'll get that information from the router. Depending on the router model it will not be possible to get the information about the real addres.</p>\n<p>I doubt that there is any router on the market which allows you to read out the real TCP port.</p>\n<p>This was one reason why IPv6 was developed: With IPv6 any computer can have its own IP address again...</p>\n"}], "owner": {"reputation": 265, "user_id": 4529810, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/qmPKC.png?s=128&g=1", "display_name": "Clive", "link": "https://stackoverflow.com/users/4529810/clive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508480685, "creation_date": 1508304419, "last_edit_date": 1508305865, "question_id": 46803345, "link": "https://stackoverflow.com/questions/46803345/which-function-tells-me-what-address-the-kernel-bound-the-local-socket-to", "title": "Which function tells me what address the kernel bound the local socket to?", "body": "<p>As a client I do a <code>socket()</code>, it gives me a number I store in <code>sktnum</code>.  I then do a <code>connect()</code> with <code>sktnum</code> and the remote address.  Hey presto, it succeeds, and I am told the kernel has selected a local IP address and port number (so as the server will know where to send back to).  What function (linux C/C++) do I call to find out what port and IP address the kernel selected.  (And please don't be one of those people who say \"why do you want to know\")</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 1, "creation_date": 1508303884, "post_id": 46803223, "comment_id": 80553101, "body": "For the very first iteration i.e. for <code>x = 0</code>, <code>temp=array[x-1];</code> this will cause a UB."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1508492752, "post_id": 46803223, "comment_id": 80640386, "body": "what do you mean exactly with <i>to the right</i>  what is the right part of an array?"}], "answers": [{"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1508304560, "last_edit_date": 1508304560, "creation_date": 1508304040, "answer_id": 46803292, "question_id": 46803223, "link": "https://stackoverflow.com/questions/46803223/not-getting-all-results-shifting-my-array/46803292#46803292", "title": "Not getting all results shifting my array", "body": "<p>You could make a <code>for</code> loop like</p>\n\n<pre><code>for(i=0; i&lt;SIZE; ++i)\n{\n    scanf(\"%d\", &amp;arr[(i+1)%SIZE]);\n}\n</code></pre>\n\n<p>The <code>(i+1)%SIZE</code> would evaluate to <code>i+1</code> if <code>i+1</code> is less than <code>SIZE</code>. Otherwise, it would wrap around.</p>\n\n<p>Or you can</p>\n\n<pre><code>int t=arr[SIZE-1];\nfor(i=SIZE-1; i&gt;0; --i)\n{\n    arr[i]=arr[i-1];\n}\narr[0]=t;\n</code></pre>\n\n<p>save the last element into a temporary variable, shift other elements towards right and finally assign the first element the value in the temporary variable.</p>\n\n<p>As <a href=\"https://stackoverflow.com/users/2805824/gaurav-pathak\">Gourav</a> pointed out, in the first iteration of your first <code>for</code> loop, <code>arr[x-1]</code> would become <code>arr[-1]</code> as <code>x</code> is <code>0</code>. You are trying to access memory which is not part of that array. This invokes undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "is_accepted": true, "score": 0, "last_activity_date": 1508306880, "last_edit_date": 1508306880, "creation_date": 1508306517, "answer_id": 46803725, "question_id": 46803223, "link": "https://stackoverflow.com/questions/46803223/not-getting-all-results-shifting-my-array/46803725#46803725", "title": "Not getting all results shifting my array", "body": "<p>I will try to explain it with the very easiest algorithm and yes easy means not efficient as from performance perspective.\nFor example, let's say you have an array of six elements:<br>\n<code>1 2 3 4 5 6</code>  </p>\n\n<p>From the question, all I understood is that you want to reverse this array to have a final array to be:<br>\n<code>6 5 4 3 2 1</code>  </p>\n\n<p>A naive way of doing is to store the first element in a temporary variable, assign the second element to the first element and after that assign the temporary variable to the second element and repeat this until all elements are swapped as shown below:  </p>\n\n<pre><code>temp = arr[0]\narr[0] = arr[1]\narr[1] = temp\n</code></pre>\n\n<p>You will need two loops to do this, one decrementing and one incrementing</p>\n\n<pre><code>1 2 3 4 5 6  i=0; j=5\n2 1 3 4 5 6  i=1; j=5\n2 3 1 4 5 6  i=2; j=5\n2 3 4 1 5 6  i=3; j=5\n2 3 4 5 1 6  i=4; j=5\n2 3 4 5 6 1  i=5; j=5\n</code></pre>\n\n<p>Next, you have to execute the above loop with one less iteration:</p>\n\n<pre><code>2 3 4 5 6 1  i=0; j=4\n3 2 4 5 6 1  i=1; j=4\n3 4 2 5 6 1  i=2; j=4\n3 4 5 2 6 1  i=3; j=4\n3 4 5 6 2 1  i=4; j=4\n</code></pre>\n\n<p>So, the loops would be:  </p>\n\n<pre><code>for(i=5; i&gt;0; i--)\n{\n  for(j=0; j&lt;i; j++)\n  {\n    temp = arr[j];\n    arr[j] = arr[j+1];\n    arr[j+1] = temp;\n   }\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508313343, "last_edit_date": 1508313343, "creation_date": 1508312553, "answer_id": 46805078, "question_id": 46803223, "link": "https://stackoverflow.com/questions/46803223/not-getting-all-results-shifting-my-array/46805078#46805078", "title": "Not getting all results shifting my array", "body": "<p>You can make things a bit more generic by adding a direction to your shift routine and putting the shift code in a function that takes the array, the number of members and the direction to shift as arguments. Then its just a matter of iterating in the proper direction and shifting the elements in the correct direction and putting the final value in the proper place. For example, you could write a simple function as follows:</p>\n\n<pre><code>/** shift array index in in circular manner by 1 in the\n *  0 - left or 1 - right direction. \n */\nvoid arrayshift (int *a, size_t nmemb, int dir)\n{\n    if (dir) {  /* shift to RIGHT */\n        int tmp = a[nmemb - 1];\n        for (size_t i = nmemb - 1; i &gt; 0; i--)\n            a[i] = a[i - 1];\n        a[0] = tmp;\n    }\n    else {      /* shift to LEFT */\n        int tmp = a[0];\n        for (size_t i = 1; i &lt; nmemb; i++)\n            a[i - 1] = a[i];\n        a[nmemb - 1] = tmp;\n    }\n}\n</code></pre>\n\n<p>A simple test routine could be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nenum { LEFT, RIGHT };\n\nvoid arrayshift (int *a, size_t nmemb, int dir);\n\nint main (int argc, char **argv) {\n\n    int a[] = { 1, 2, 3, 4, 5, 6 },\n        dir = argc &gt; 1 ? LEFT : RIGHT;\n    size_t n = sizeof a / sizeof *a;\n\n    printf (\"original:\");\n    for (size_t i = 0; i &lt; n; i++)\n        printf (\" %d\", a[i]);\n    putchar ('\\n');\n\n    arrayshift (a, n, dir);\n\n    printf (\"shifted :\");\n    for (size_t i = 0; i &lt; n; i++)\n        printf (\" %d\", a[i]);\n    putchar ('\\n');\n\n    return 0;\n}\n\n/** shift array index in in circular manner by 1 in the\n *  0 - left or 1 - right direction. \n */\nvoid arrayshift (int *a, size_t nmemb, int dir)\n{\n    if (dir) {  /* shift to RIGHT */\n        int tmp = a[nmemb - 1];\n        for (size_t i = nmemb - 1; i &gt; 0; i--)\n            a[i] = a[i - 1];\n        a[0] = tmp;\n    }\n    else {      /* shift to LEFT */\n        int tmp = a[0];\n        for (size_t i = 1; i &lt; nmemb; i++)\n            a[i - 1] = a[i];\n        a[nmemb - 1] = tmp;\n    }\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/array_cir_shift_by_1\noriginal: 1 2 3 4 5 6\nshifted : 6 1 2 3 4 5\n\n$ ./bin/array_cir_shift_by_1 0\noriginal: 1 2 3 4 5 6\nshifted : 2 3 4 5 6 1\n</code></pre>\n\n<p>You can also pass the number of element to shift the array by and use the <em>modulo</em> operator to help with the indexing. (that is left for another day)</p>\n"}], "owner": {"reputation": 35, "user_id": 4788583, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2888df9a791f5e3fdd8031c7422fd9e?s=128&d=identicon&r=PG&f=1", "display_name": "mistylove98", "link": "https://stackoverflow.com/users/4788583/mistylove98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 46803725, "answer_count": 3, "score": 0, "last_activity_date": 1508313343, "creation_date": 1508303497, "last_edit_date": 1508308091, "question_id": 46803223, "link": "https://stackoverflow.com/questions/46803223/not-getting-all-results-shifting-my-array", "title": "Not getting all results shifting my array", "body": "<p>I'm trying to make a program that shifts all the elements of an array to the right by one and move the last element into the first position. My problem is when I run my code it's giving me the number <code>5</code> twice. Can someone help me, maybe my logic or my for loop is not right?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n    int array[6];\n    int x;\n    int temp;\n\n    printf(\"Enter six numbers.\\n\\n\");\n\n    for (x = 0; x &lt; 6; x++) {\n        printf(\"Enter a number : \", x + 1);\n        scanf(\"%d\", &amp;array[x]);\n\n        temp = array[x - 1];\n    }\n\n    for (x = 6 - 1; x &gt; 0; x--) {\n        array[x] = array[x - 1];\n    }\n\n    array[0] = temp;\n\n    for (x = 0; x &lt; 6; x++) {\n        printf(\"%d\\n\", array[x]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array", "rotation", "bmp"], "comments": [{"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1508304481, "post_id": 46803211, "comment_id": 80553303, "body": "It appears you are trying to modify an RGB BMP file, but you are not indexing pixels or RGB values correctly. Give some more careful thought to your indexing scheme. Handle pixel indices first, then use another loop to handle RGB values. Beware of scan line padding! (I also recommend you get the actual dimensions from the file header directly!)"}, {"owner": {"reputation": 358, "user_id": 7105409, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cTCYnuGzn1M/AAAAAAAAAAI/AAAAAAAAAw8/mNUReftTmbs/photo.jpg?sz=128", "display_name": "Eliad Cohen", "link": "https://stackoverflow.com/users/7105409/eliad-cohen"}, "edited": false, "score": 0, "creation_date": 1508309008, "post_id": 46803211, "comment_id": 80555158, "body": "Read <a href=\"https://stackoverflow.com/questions/1968561/getting-the-pixel-value-of-bmp-file\">this</a> for more info, hope this will help"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1508316232, "post_id": 46803211, "comment_id": 80559119, "body": "You are replacing the first pixel with last pixel, going through the whole loop, then replacing the last pixel with first pixel. So nothing changes. There are many more errors."}], "owner": {"reputation": 21, "user_id": 8234418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40cd10eee7f30931ddaeb2043dc55879?s=128&d=identicon&r=PG&f=1", "display_name": "Marishka33", "link": "https://stackoverflow.com/users/8234418/marishka33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508303435, "creation_date": 1508303435, "question_id": 46803211, "link": "https://stackoverflow.com/questions/46803211/rotation-of-the-bmp-file-as-a-2d-array", "title": "Rotation of the bmp file as a 2d array", "body": "<p>I have a bmp image and I am trying to rotate it by 180 degrees using c. </p>\n\n<p>Here is the code that I got so far, but it does not rotate the image for some reasons(it does nothing with the image). Here h is the height of a picture and w is a width. </p>\n\n<pre><code>int rotate(int h, int w)\n{\n    FILE *infile = fopen(\"in2.bmp\", \"rb\"); \n    FILE *outfile = fopen(\"copy3.bmp\", \"wb\");  \n\n    char header[HEADER_SIZE]; \n    unsigned char pixels[h][w * 3];\n\n\n    fread( header, 1 , HEADER_SIZE , infile);\n    fread( pixels, 1 , h * w * 3 , infile);\n\n    int r,c;\n\n\n    for( r = 0; r &lt; h; r++)\n     {\n\n         for ( c = 0; c &lt; w * 3; c+=1) \n         {\n            char temp = pixels[r][c];\n            pixels[r][c] = pixels[h-r-1][(w*3-1)-c];\n            pixels[h-r-1][(w*3-1)-c] = temp;\n\n\n\n         }\n    }\n\n    fwrite( header, sizeof(char)  , HEADER_SIZE  ,  outfile);\n    fwrite( pixels, sizeof(char)  , h * w * 3  ,  outfile);\n\n    fclose(infile);\n    fclose(outfile);\n\n    return 0;\n}\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "gcc", "assembly", "macros", "inline"], "comments": [{"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 1, "creation_date": 1508302313, "post_id": 46802894, "comment_id": 80552640, "body": "In addition to the answer that you already have, note that if you&#39;re using Raspbian on a Raspberry Pi, you should probably be using ARM opcodes, not x86 opcodes."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1508303169, "post_id": 46802894, "comment_id": 80552885, "body": "@zneak - oops, right, I missed the reference to Raspbian! The whole example would need to be modified in that case, since the whole approach is somewhat specific to x86 opcodes."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508303623, "post_id": 46802894, "comment_id": 80553017, "body": "You need to understand how C compiles to assembly language, and then look at what your specific version of gcc does, then you can figure out how you can add extra instructions to mess around with the compiler&#39;s data.  (see <a href=\"https://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output\" title=\"how to remove noise from gcc clang assembly output\">stackoverflow.com/questions/38552116/&hellip;</a> for example).  This is all <i>very</i> compiler-specific."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1508343799, "post_id": 46802894, "comment_id": 80577048, "body": "@PeterCordes - take a closer look. I doesn&#39;t seem very compiler-specific and it should mostly &quot;just work&quot; on x86. Basically it isn&#39;t modifying arbitrary code generated by the compiler, but rather searching for the <code>JUNK</code> sequences inserted verbatim by the <code>asm</code> macro. As long as the compiler emits those sequences faithfully, it should find them. It then rewrites those sequences in such a way that it is still effectively a no-op, but with new instructions. I don&#39;t see any big issues to making this work. There is a small chance of false positives: falsely finding the <code>JUNK</code> signature."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1508343862, "post_id": 46802894, "comment_id": 80577077, "body": "Futhermore, the OP reported that &quot;it works&quot; below, apparently with little changes other than replacing the <code>__emit__</code> with an <code>asm</code> block."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1508344388, "post_id": 46802894, "comment_id": 80577392, "body": "@BeeOnRope: Oh, yeah I just read the OP&#39;s link and found out that these extra instructions are always supposed to do nothing.  Just don&#39;t clobber the red-zone with push/pop.  (Although IIRC, gcc makes a stack frame and doesn&#39;t use the red-zone with <code>-O0</code>.)"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508344538, "post_id": 46802894, "comment_id": 80577480, "body": "@PeterCordes <code>push</code> and <code>pop</code> by definition don&#39;t &quot;use&quot; the red-zone since they adjust <code>rsp</code>. The red-zone is the 128-byte area below <code>rsp</code> that it is safe to use without adjusting the stack pointer, but <code>push</code> and <code>pop</code> do adjust it, so they are always safe in this respect."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1508344821, "post_id": 46802894, "comment_id": 80577620, "body": "@BeeOnRope: But gcc doesn&#39;t know about the push/pop!  It&#39;s the same problem as <a href=\"https://stackoverflow.com/questions/34520013/using-base-pointer-register-in-c-inline-asm/34522750#34522750\" title=\"using base pointer register in c inline asm\">stackoverflow.com/questions/34520013/&hellip;</a>, where inline-asm using <code>push %%rbp</code>/<code>pop %%rbp</code> clobbers something gcc spilled to <code>-8(%rsp)</code>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1508345820, "post_id": 46802894, "comment_id": 80578174, "body": "@PeterCordes - good point, that&#39;s a huge gotcha to manipulating the stack from  inline <code>asm</code>! I would have hoped that gcc wouldn&#39;t keep spilled stuff in the redzone across an <code>asm</code> call, but I guess that would hurt performance for the small number of inline blocks that want to do that. Perhaps they could add a clobber for it. It&#39;s a limitation of treating the asm totally opaquely - if they could only look into the block and see the <code>push</code>... (yes, I know that the <code>asm</code> blocks don&#39;t work that way, the text is basically emitted directly into the .S output)."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1508345897, "post_id": 46802894, "comment_id": 80578212, "body": "I guess to make this code safe, you could change <code>JUNK</code> to <code>sub rsp, 128; push rax; ...  pop rax; add rsp 128</code> so you are sure you are avoiding any clobber of the redzone."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1508346149, "post_id": 46802894, "comment_id": 80578330, "body": "@BeeOnRope: yeah, it would be nice if there was a way to declare a clobber on the red-zone.  But usually the answer is to either write your whole function in asm, or <a href=\"https://gcc.gnu.org/wiki/DontUseInlineAsm\" rel=\"nofollow noreferrer\">gcc.gnu.org/wiki/DontUseInlineAsm</a>.  It&#39;s mostly a problem when people want to use <code>call</code> from inline asm (which is highly questionable anyway; gcc or clang will sometimes optimize a <code>static</code> function definition to assume things that are true for the only visible call sites, e.g. not returning unused struct members.  Although I think by passing a function-pointer as an asm operand you guarantee a proper func def.)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508302752, "post_id": 46802983, "comment_id": 80552763, "body": "Would I then replace every instance of &quot;JUNK&quot; in the code with &quot;asm&quot;? Would the same functionality be preserved?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508302931, "post_id": 46802983, "comment_id": 80552814, "body": "You can keep the same JUNK macro but just redefine it in terms of <code>asm</code> with the <code>.byte</code> directive. With use of macro stringification you can keep the same <code>PUSH</code> <code>NOP</code> etc macros."}, {"owner": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508303045, "post_id": 46802983, "comment_id": 80552847, "body": "Like this? #define asm __volatile__(&quot;.byte 0x50, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x58\\n&quot;)?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508303207, "post_id": 46802983, "comment_id": 80552895, "body": "@Matt, yes - but as zneak pointed out in the comments and in the edit to my answer, this won&#39;t work on ARM. The example given is specific to x86."}, {"owner": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508304553, "post_id": 46802983, "comment_id": 80553330, "body": "What exactly would I have to change to get it to work on x86? I was planning on running it on my RPI but if its easier to run on my computer then I&#39;ll go that way."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508304629, "post_id": 46802983, "comment_id": 80553359, "body": "If you run it on your x86 computer it may very well work. @Matt"}, {"owner": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508305160, "post_id": 46802983, "comment_id": 80553545, "body": "So I updated the problem line to #define JUNK __volatile__(&quot;.byte 0x50, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x58\\n&quot;) and kept all the other inline JUNK usages the same. However, when I compile I get a whole mess of errors stating: &quot;Expected identified or &#39;(&#39; before string constant. Referring to #define JUNK __volatile__(&quot;.byte ...... yadayada&quot;). The error points to the period before byte"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508305380, "post_id": 46802983, "comment_id": 80553619, "body": "@Matt you need the <code>asm</code> keyword in there!  Here&#39;s <a href=\"https://godbolt.org/g/Pdyq4u\" rel=\"nofollow noreferrer\">a link</a> showing it working."}, {"owner": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "edited": false, "score": 0, "creation_date": 1508305959, "post_id": 46802983, "comment_id": 80553861, "body": "it works. :) Thank you so much for your help! I think I&#39;ll be working on getting everything ported to ARM next, with hopefully fewer problems."}], "tags": [], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "is_accepted": true, "score": 3, "last_activity_date": 1508305445, "last_edit_date": 1508305445, "creation_date": 1508301968, "answer_id": 46802983, "question_id": 46802894, "link": "https://stackoverflow.com/questions/46802894/metamorphic-example-code/46802983#46802983", "title": "Metamorphic Example Code", "body": "<p>You can put arbitrary bytes at the location of an <code>asm</code> block using the <code>.byte</code> directive like this:</p>\n\n<pre><code>asm __volatile__(\".byte 0x50, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x58\\n\");\n</code></pre>\n\n<p>Here's a <a href=\"https://godbolt.org/g/Pdyq4u\" rel=\"nofollow noreferrer\">live example on godbolt</a>, including the far right pane which shows that it decompiled fine into a <code>push rax</code>, eight <code>nop</code>s, and <code>pop rax</code>.</p>\n\n<p>See more about the <code>.byte</code> directive <a href=\"https://stackoverflow.com/a/32150850/149138\">here</a>. </p>\n\n<p>However, this will still not work on the Raspberry Pi because the opcodes appear to for x86.  You will have to change them to the corresponding ARM opcodes.  Furthermore, the GCC is a highly optimizing compiler, and you cannot manipulate the C stack in the way this code did with the old Borland C compiler.</p>\n"}], "owner": {"reputation": 13, "user_id": 8793591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756ac797a3179a2fe9fbb3cbb37677de?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8793591/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 1, "accepted_answer_id": 46802983, "answer_count": 1, "score": 1, "last_activity_date": 1508305445, "creation_date": 1508301354, "question_id": 46802894, "link": "https://stackoverflow.com/questions/46802894/metamorphic-example-code", "title": "Metamorphic Example Code", "body": "<p>So I've been working on implementing the metamorphic code example from James Holderness found here: <a href=\"https://stackoverflow.com/questions/10113254/metamorphic-code-examples\">Metamorphic Code Examples</a>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;time.h&gt;\n\n#define PUSH 0x50\n#define POP 0x58\n#define MOV 0xB8\n#define NOP 0x90\n\n#define ADD 0x01\n#define AND 0x21\n#define XOR 0x31\n#define OR  0x09\n#define SBB 0x19\n#define SUB 0x29\n\n#define JUNK asm __volatile__(PUSH,NOP,NOP,NOP,NOP,NOP,NOP,NOP,NOP,POP)\n#define JUNKLEN 8\n\nconst unsigned char prefixes[] = {ADD, AND, XOR, OR, SBB, SUB, 0};\nunsigned char *code;\nint codelen;\n\nvoid readCode(const char *filename)\n{\n    FILE *fp = fopen(filename, \"rb\");       JUNK;\n    fseek(fp, 0L, SEEK_END);            JUNK;\n    codelen = ftell(fp);\n    code = malloc(codelen);             JUNK;\n    fseek(fp, 0L, SEEK_SET);\n    fread(code, codelen, 1, fp);            JUNK;\n}\n\nvoid writeCode(const char *filename)\n{\n    FILE *fp;\n    int lastOffset = strlen(filename) - 1;\n    char lastChar = filename[lastOffset];\n    char *newFileName = strdup(filename);       JUNK;\n    lastChar = '0' + (isdigit(lastChar)?(lastChar - '0' + 1) %10:0);\n    newFileName[lastOffset] = lastChar;\n    fp = fopen(newFileName, \"wb\");          JUNK;\n    fwrite(code, codelen, 1, fp);           JUNK;\n    fclose(fp);\n    free(newFileName);\n}\n\nint writeInstruction(unsigned reg, int offset, int space)\n{\n    if (space &lt; 2) {\n        code[offset] = NOP;         JUNK;\n        return 1;\n    } else if (space &lt; 5 || rand() % 2 == 0) {\n        code[offset] = prefixes[rand() % 6];    JUNK;\n        code[offset + 1] = 0xC0 + rand() % 8 * 8 + reg; JUNK;\n        return 2;\n    } else {\n        code[offset] = MOV + reg;       JUNK;\n        *(short *)(code + offset + 1) = rand();\n        *(short *)(code + offset + 3) = rand(); JUNK;\n        return 5;\n    }\n}\n\nint readInstruction(unsigned reg, int offset)\n{\n    unsigned c1 = code[offset];\n    if (c1 == NOP)\n        return 1;               JUNK;\n    if (c1 == MOV + reg)\n        return 5;               JUNK;\n    if (strchr(prefixes, c1)) {\n        unsigned c2 = code[offset + 1];     JUNK;\n        if (c2 &gt;= 0xC0 &amp;&amp; c2 &lt;= 0xFF &amp;&amp; (c2 &amp; 7) == reg)\n            return 2;           JUNK;\n    }                       JUNK;\n    return 0;\n}\n\nvoid replaceJunk(void)\n{\n    int i, j, inc, space;\n    srand(time(NULL));              JUNK;\n\n    for (i = 0; i &lt; codelen - JUNKLEN - 2; i++) {\n        unsigned start = code[i];\n        unsigned end = code[i + JUNKLEN + 1];\n        unsigned reg = start - PUSH;\n\n        if (start &lt; PUSH || start &gt;= PUSH + 8)\n            continue;           JUNK;\n        if (end != POP + reg)\n            continue;           JUNK;\n        if (reg == 4)\n            continue;\n\n        j = 0;                  JUNK;\n        while (inc = readInstruction(reg, i + 1 + j))\n            j = j + inc;\n        if (j != JUNKLEN)\n            continue;           JUNK;\n\n        reg = rand() % 7;           JUNK;\n        reg += (reg &gt;= 4);\n        code[i] = PUSH + reg;           JUNK;\n        code[i + JUNKLEN + 1] = POP + reg;  JUNK;\n\n        space = JUNKLEN;\n        j = 0;\n        while (space) {\n            inc = writeInstruction(reg, i + 1 + j, space);  JUNK;\n            j = j + inc;\n            space = space - inc;        JUNK;\n        }\n        printf(\"%d\\n\", i);          JUNK;\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    readCode(argv[0]);              JUNK;\n    replaceJunk();                  JUNK;\n    writeCode(argv[0]);             JUNK;\n\n    return 0;\n}\n</code></pre>\n\n<p>I'm attempting to compile using GCC (version 6.3.0) on Raspbian 4.9 but the compile keeps failing and issuing errors \"undefined reference to <code>__emit__</code>. Now I know this is because <strong>emit</strong> is a Borland C Compiler macro and so I've consequently attempted to implement similar functionality using the asm <strong>volatile</strong> macro found here (<a href=\"https://stackoverflow.com/questions/35961563/implementing-borlands-emit-macro-in-gcc\">Implementing Borland&#39;s __emit__ macro in GCC</a>).</p>\n\n<p>How can I change the code to work with GCC? I've tried a number of different uses of asm <strong>volatile</strong> but nothing seems to work. I expect that most of the #defines will have to change, I just don't know the correct way to do it.</p>\n"}, {"tags": ["c", "gcc", "clang"], "comments": [{"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1508300665, "post_id": 46802747, "comment_id": 80552195, "body": "There&#39;s probably an optimization that prevents the copying from happening at all on gcc. It can detect it is never modified. So, in effect, it is just using &quot;first&quot; in both cases. Update another member of either first or second to defeat the optimization."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1508300711, "post_id": 46802747, "comment_id": 80552206, "body": "I think this is UB."}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508300752, "post_id": 46802747, "comment_id": 80552214, "body": "@BLUEPIXY I agree, I&#39;m just curious why the two compilers treat it differently."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508300845, "post_id": 46802747, "comment_id": 80552233, "body": "The behavior of UB is by the compiler. Because it is undefined behavior. The behavior may be different if the compiler is different."}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "reply_to_user": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1508300848, "post_id": 46802747, "comment_id": 80552234, "body": "@GarrGodfrey I tried adding <code>second._ = -1;</code>, but still get the same (different) behavior on the two compilers."}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508300909, "post_id": 46802747, "comment_id": 80552250, "body": "@BLUEPIXY I understand. Seriously, I get it, UB is taken to mean the compiler can do whatever it wants. I&#39;m asking <i>why</i> the compilers choose to do it the way they do."}, {"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1508300913, "post_id": 46802747, "comment_id": 80552251, "body": "compiler must be even smarter than I thought."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1508301106, "post_id": 46802747, "comment_id": 80552300, "body": "<i>why the compilers choose to do it the way they do</i> That is a meaningless question. That&#39;s because the compiler can choose whatever action she want."}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508301550, "post_id": 46802747, "comment_id": 80552432, "body": "@BLUEPIXY It is <i>not</i> a meaningless question. The compiler is a piece of code, which its authors wrote to produce machine code from a source file. I am curious why they made the decision to write it such that it produced this output. Was it an optimization choice? By-product of some other useful choice they made?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1508301784, "post_id": 46802747, "comment_id": 80552510, "body": "Turn up the warning level on clang and you get this <i>&quot;test.c:7:16: warning: flexible array initialization is a GNU extension [-Wgnu-flexible-array-initializer]&quot;</i>"}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1508301843, "post_id": 46802747, "comment_id": 80552529, "body": "@user3386109 Yep, that&#39;s about the <i>initialization</i> of the struct, not the behavior when &quot;copying&quot; it."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1508302171, "post_id": 46802747, "comment_id": 80552610, "body": "I think that it is meaningless again."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1508302488, "post_id": 46802747, "comment_id": 80552691, "body": "Point is that you aren&#39;t likely to get an authoritative answer based on the specification, since you&#39;ve already violated the specification with your initialization. Once you start playing outside the bounds of the specification, anything goes."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1508302714, "post_id": 46802747, "comment_id": 80552750, "body": "This is weird: change the length of the non-standard initializer for <code>first.str</code>, and the generated assembly for <code>main</code> changes. --- @bnaecker You&#39;re probably getting a lot of argument in the comments because you have both &quot;Which one is correct?&quot; and &quot;Why does GCC...?&quot;, which need entirely different approaches. I&#39;d edit the question to focus on one or the other."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1508302723, "post_id": 46802747, "comment_id": 80552754, "body": "I think <code>s second = first;</code> is well-defined to not copy the FAM; and the code causes UB by reading out of bounds in trying to print <code>second.str</code>"}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1508303812, "post_id": 46802747, "comment_id": 80553076, "body": "@aschepler You&#39;re right, neither is &quot;correct&quot;, that was not a good way to ask it."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1508304526, "post_id": 46802747, "comment_id": 80553320, "body": "I did some testing with gcc, and as far as I can tell, <code>s second = first;</code> copies <i>all</i> of first, even though it does <i>not</i> allocate enough space for it in <code>second</code>, resulting in a corrupted stack.  Seems like a bug to me."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508306634, "post_id": 46802747, "comment_id": 80554126, "body": "@M.M Actually it&#39;s the initialization of <code>second</code> which is causing the problem in gcc.  It&#39;s overwriting the stack.  See my answer which clearly demonstrates this."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1508306959, "post_id": 46802747, "comment_id": 80554257, "body": "@TomKarzes there can be multiple problems in a piece of code.  The biggest problem is that <code>s first = { 0, &quot;abcd&quot; };</code> is a constraint violation, therefore any executable generated has entirely undefined behaviour."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508307489, "post_id": 46802747, "comment_id": 80554467, "body": "@M.M Actually, gcc explicitly allows this as an extension.  This is straight from the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow noreferrer\">gcc documentation</a>  Look for the part that says &quot;GCC allows static initialization of flexible array members.&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508310130, "post_id": 46802747, "comment_id": 80555721, "body": "@TomKarzes I was talking from a Standard C perspective. Anyway, it seems that whoever designed this gcc extension didn&#39;t think to also design the behaviour for when such an extension-struct is copied by value"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508310464, "post_id": 46802747, "comment_id": 80555891, "body": "@M.M Yes, the behavior is bad.  I have concluded that the real problem is the assignment &quot;second = first&quot;.  It is copying all of first, but it should only copy sizeof(s) bytes.  In fact, if the declaration and initialization of first are moved to a separate file, then it copies the correct amount and no longer corrupts the stack.  I have submitted a gcc bugzilla report for this, so we&#39;ll see what they have to say about it."}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508340267, "post_id": 46802747, "comment_id": 80574648, "body": "@M.M What is a &quot;constraint violation&quot;? I&#39;ve never seen that term."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1508357511, "post_id": 46802747, "comment_id": 80584213, "body": "@bnaecker When a constraint is violated. See clauses 3 &amp; 4 of the current standard for definition of terms &amp; compliance"}], "answers": [{"comments": [{"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 1, "creation_date": 1508304343, "post_id": 46803239, "comment_id": 80553256, "body": "I like the points you made, especially about being lucky that the stack had a <code>\\0</code> after <code>second</code>, so that the <code>printf</code> call didn&#39;t break anything. But see my edit, updating <code>second</code> doesn&#39;t change GCC&#39;s output."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 0, "creation_date": 1508304614, "post_id": 46803239, "comment_id": 80553352, "body": "That also doesn\u2019t invalidate the optimization, since you never refer to <code>first</code> again. Remember, optimizations can be very aggressive, so long as they don\u2019t change the behavior of your program. Make it so that neither <code>first</code> nor <code>second</code> are expendable."}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 0, "creation_date": 1508304721, "post_id": 46803239, "comment_id": 80553390, "body": "Hmm, good point. Still, adding another line modifying <code>first</code> doesn&#39;t change the behavior."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 0, "creation_date": 1508305025, "post_id": 46803239, "comment_id": 80553497, "body": "You can modify things as much as you want, but until they are actually needed it means nothing. (Sometimes you have to work hard to overcome the optimizations!) Print the values, maybe?"}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 1, "creation_date": 1508305137, "post_id": 46803239, "comment_id": 80553537, "body": "Printing both struct members still nets me the same behavior: Clang prints nothing for <code>second.str</code>, GCC prints the same value as <code>first.str</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508305858, "post_id": 46803239, "comment_id": 80553831, "body": "This answer is incorrect.  <code>second</code> is not an alias for <code>first</code>.  You can easily verify this by looking at the addresses.  Furthermore, the initialization of <code>second</code> is corrupting the stack."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508352347, "post_id": 46803239, "comment_id": 80581535, "body": "@D&#250;thomhas That&#39;s not the code I&#39;m seeing with gcc.  But (1) I&#39;m invoking gcc directly, without going through godbolt, (2) I&#39;m not specifying -O2, (3) I&#39;m using gcc 5.4.0, (4) I&#39;m compiling for a 32-bit platform.  Try compiling it manually with <code>gcc -S file.c</code> and see what you get for <code>file.s</code>"}], "tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": false, "score": 0, "last_activity_date": 1508331872, "last_edit_date": 1508331872, "creation_date": 1508303607, "answer_id": 46803239, "question_id": 46802747, "link": "https://stackoverflow.com/questions/46802747/gcc-vs-clang-copying-struct-flexible-array-member/46803239#46803239", "title": "GCC vs Clang copying struct flexible array member", "body": "<p>So, for an answer, both compilers are behaving correctly, but the answers you are getting are undefined behavior.</p>\n\n<p>GCC<br>\nBecause you never modify <code>second</code> GCC is simply making <code>second</code> and alias of <code>first</code> in its lookup table. Modify second and GCC cannot make that optimization and you\u2019ll get the same answer/crash as Clang.</p>\n\n<p>Clang<br>\nClang does not automatically apply the same optimization, it seems. So when it copies the structure, it does so correctly: It copies the single <code>int</code> and nothing else. </p>\n\n<p>You were lucky that there was a zero value on the stack after your local <code>second</code> variable, terminating your unknown character string. Basically, you are using an uninitialized pointer. Were there no zero, you could have gotten a lot of garbage and a memory fault.</p>\n\n<p><strong>The purpose of this thing is to do low-level stuff</strong>, like implement a memory manager, etc, by casting some memory to your structure. The compiler is under no obligation to understand what you are doing; it is only under obligation to act as if you know what you are doing. If you fail to cast the structure type over memory that actually has data of that type in it, all bets are off.</p>\n\n<p><strong>edit</strong><br>\nSo, using <a href=\"https://godbolt.org/g/4k6Jbg\" rel=\"nofollow noreferrer\">godbolt.org</a> and looking at the assembly:</p>\n\n<pre><code>.LC0:\n        .string \"%s\\n%s\\n\"\nmain:\n        sub     rsp, 24\n        mov     eax, DWORD PTR first[rip]\n        mov     esi, OFFSET FLAT:first+4\n        lea     rdx, [rsp+16]\n        mov     edi, OFFSET FLAT:.LC0\n        mov     DWORD PTR [rsp+12], eax\n        xor     eax, eax\n        call    printf\n        xor     eax, eax\n        add     rsp, 24\n        ret\nfirst:\n        .long   0\n        .string \"abcd\"\n</code></pre>\n\n<p>We see that GCC is, actually, doing exactly what I said with the OP\u2019s original code: treating <code>second</code> as an alias of <code>first</code>.</p>\n\n<p><strong>Tom Karzes</strong> has significantly modified the code, and so is experiencing a <em>different</em> issue. What he reports does appear to be a bug; I haven\u2019t time ATM to figure out what is really happening with his stack-corrupting assignment.</p>\n"}, {"comments": [{"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 1, "creation_date": 1508339803, "post_id": 46803695, "comment_id": 80574334, "body": "This is a nice analysis, thank you. If this is indeed a bug, is the expected behavior that only the leading members of a struct like this should be copied, not the trailing array? Is that part of the standard somewhere, or is it UB or implementation-defined?"}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 1, "creation_date": 1508339952, "post_id": 46803695, "comment_id": 80574435, "body": "Nevermind, the answer I linked in my question has what I need! Section 6.7.2.1 says only the members whose sizes are known (everything but the trailing array) is copied. This really suggests you&#39;re right, this is a GCC bug."}], "tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": true, "score": 3, "last_activity_date": 1508308214, "last_edit_date": 1508308214, "creation_date": 1508306381, "answer_id": 46803695, "question_id": 46802747, "link": "https://stackoverflow.com/questions/46802747/gcc-vs-clang-copying-struct-flexible-array-member/46803695#46803695", "title": "GCC vs Clang copying struct flexible array member", "body": "<p>Here's the real answer of what's going on with gcc.  <code>second</code> is allocated on the stack, just as you'd expect.  It is not an alias for <code>first</code>.  This is easily verified by printing their addresses.</p>\n\n<p>Additionally, the declaration <code>s second = first;</code> is corrupting the stack, because (a) gcc is allocating the minimum amount of storage for <code>second</code> but (b) it is copying <em>all</em> of <code>first</code> into second, corrupting the stack.</p>\n\n<p>Here is a modified version of the original code which shows this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct s {\n    int _;\n    char str[];\n} s;\ns first = { 0, \"abcdefgh\" };\nint main(int argc, const char **argv) {\n    char v[] = \"xxxxxxxx\";\n    s second = first;\n    printf(\"%p %p %p\\n\", (void *) v, (void *) &amp;first, (void *) &amp;second);\n    printf(\"&lt;%s&gt; &lt;%s&gt; &lt;%s&gt;\\n\", v, first.str, second.str);\n}\n</code></pre>\n\n<p>On my 32-bit Linux machine, with gcc, I get the following output:</p>\n\n<pre><code>0xbf89a303 0x804a020 0xbf89a2fc\n&lt;defgh&gt; &lt;abcdefgh&gt; &lt;abcdefgh&gt;\n</code></pre>\n\n<p>As you can see from the addresses, <code>v</code> and <code>second</code> are on the stack, and <code>first</code> is in the data section.  Further, it is also clear that the initialization of <code>second</code> has overwritten <code>v</code> on the stack, with the result that instead of the expected <code>&lt;xxxxxxxx&gt;</code>, it is instead showing <code>&lt;defgh&gt;</code>.</p>\n\n<p>This seems like a gcc bug to me.  At the very least, it should warn that the initialization of <code>second</code> will corrupt the stack, since it clearly has enough information to know this at compile time.</p>\n\n<p>Edit:  I tested this some more, and obtained essentially equivalent results by splitting the declaration of <code>second</code> into:</p>\n\n<pre><code>s second;\nsecond = first;\n</code></pre>\n\n<p>The real problem is the assignment.  It's copying <em>all</em> of <code>first</code>, rather than the minimal common part of the structure type, which is what I believe it should do.  In fact, if you move the static initialization of <code>first</code> into a separate file, the assignment does what it should do, <code>v</code> prints correctly, and <code>second.str</code> is undefined garbage.  This is the behavior gcc should be producing, regardless of whether the initialization of <code>first</code> is visible in the same compilation unit or not.</p>\n"}], "owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 1, "accepted_answer_id": 46803695, "answer_count": 2, "score": 5, "last_activity_date": 1508331872, "creation_date": 1508300364, "last_edit_date": 1508304248, "question_id": 46802747, "link": "https://stackoverflow.com/questions/46802747/gcc-vs-clang-copying-struct-flexible-array-member", "title": "GCC vs Clang copying struct flexible array member", "body": "<p>Consider the following code snippet.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct s {\n    int _;\n    char str[];\n} s;\ns first = { 0, \"abcd\" };\n\nint main(int argc, const char **argv) {\n    s second = first;\n    printf(\"%s\\n%s\\n\", first.str, second.str);\n}\n</code></pre>\n\n<p>When I compile this with GCC 7.2, I get:</p>\n\n<pre><code>$ gcc-7 -o tmp tmp.c &amp;&amp; ./tmp\nabcd\nabcd\n</code></pre>\n\n<p>But when I compile this with Clang (Apple LLVM version 8.0.0 (clang-800.0.42.1)), I get the following:</p>\n\n<pre><code>$ clang -o tmp tmp.c &amp;&amp; ./tmp\nabcd\n# Nothing here\n</code></pre>\n\n<p>Why does the output differ between the compilers? I would expect the string not to be copied, as it's a flexible array member (similar to <a href=\"https://stackoverflow.com/questions/35423293/flexible-array-member-not-getting-copied-when-i-make-a-shallow-copy-of-a-struct\">this question</a>). Why does GCC actually copy it?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Some comments and an answer suggested this might be due to optimization. GCC may make <code>second</code> an alias of <code>first</code>, so updating <code>second</code> should disallow GCC from doing that optimization. I added the line:</p>\n\n<pre><code>second._ = 1;\n</code></pre>\n\n<p>But this doesn't change the output.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 7, "creation_date": 1508298883, "post_id": 46802511, "comment_id": 80551786, "body": "You&#39;ve declared <code>b</code> as <code>float</code>, which is smaller than the default floating point type (<code>double</code>), so you&#39;re comparing <code>(float) 0.7</code> to <code>(double) 0.7)</code>.  Since <code>0.7</code> cannot be exactly represented, they are not the same.  Try replacing all your <code>float</code> variables with <code>double</code>."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1508298934, "post_id": 46802511, "comment_id": 80551805, "body": "<a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\" title=\"is floating point math broken\">stackoverflow.com/questions/588004/&hellip;</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508300103, "post_id": 46802511, "comment_id": 80552072, "body": "Also <a href=\"https://stackoverflow.com/questions/1839422/strange-output-in-comparison-of-float-with-float-literal\" title=\"strange output in comparison of float with float literal\">stackoverflow.com/questions/1839422/&hellip;</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1508300157, "post_id": 46802511, "comment_id": 80552087, "body": "Another option <a href=\"https://stackoverflow.com/questions/32266864/make-c-floating-point-literals-float-rather-than-double\">Make C floating point literals float (rather than double)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 8649512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16f7a7f777c588ddd41330c6334fad96?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/8649512/user"}, "is_accepted": false, "score": 1, "last_activity_date": 1508300023, "last_edit_date": 1508300023, "creation_date": 1508299672, "answer_id": 46802644, "question_id": 46802511, "link": "https://stackoverflow.com/questions/46802511/one-float-variable-shows-expected-result-but-other-doesnt/46802644#46802644", "title": "One float variable shows expected result but other doesn&#39;t", "body": "<p>For <code>float</code> numbers you need to represent it as example: <code>0.5f</code> .Below example is tested and working fine.</p>\n\n<pre><code>float a = 0.5;\nfloat b = 0.7;\nprintf(\"%f\",a);\nprintf(\"\\n\");\nprintf(\"%f\",b);\n\nif(a == 0.5f &amp;&amp; b == 0.7f)\n{\n  printf(\"\\nOK\\n\");\n}\nelse\n{\n   printf(\"NOTOK\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 829, "user_id": 5569396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5Prh.jpg?s=128&g=1", "display_name": "Gor Asatryan", "link": "https://stackoverflow.com/users/5569396/gor-asatryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1508305054, "creation_date": 1508305054, "answer_id": 46803444, "question_id": 46802511, "link": "https://stackoverflow.com/questions/46802511/one-float-variable-shows-expected-result-but-other-doesnt/46803444#46803444", "title": "One float variable shows expected result but other doesn&#39;t", "body": "<p><code>.5</code> and <code>.7</code> are constants and they are translated to double. Add \"f\" symbol at the end to tell compiler that <code>.5f</code> and <code>.7f</code> are floats.</p>\n\n<pre><code>if(a == .5f)\n  printf(\"\\nOK\\n\");\nelse\n   printf(\"NOTOK\\n\");\n\nif(b == .7f)\n  printf(\"OK\");\nelse\n  printf(\"NOTOK\");\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8793505, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz5CvvqqIG4/AAAAAAAAAAI/AAAAAAAAABA/4sC0Ib31kSA/photo.jpg?sz=128", "display_name": "abcdxyzw", "link": "https://stackoverflow.com/users/8793505/abcdxyzw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1508306900, "answer_count": 2, "score": 0, "last_activity_date": 1508305054, "creation_date": 1508298707, "question_id": 46802511, "link": "https://stackoverflow.com/questions/46802511/one-float-variable-shows-expected-result-but-other-doesnt", "closed_reason": "Duplicate", "title": "One float variable shows expected result but other doesn&#39;t", "body": "<pre><code>float a = 0.5;\nfloat b = 0.7;\nprintf(\"%f\",a);\nprintf(\"\\n\");\nprintf(\"%f\",b);\nif(a == .5)\n  printf(\"\\nOK\\n\");\nelse\n   printf(\"NOTOK\\n\");\n\nif(b == .7)\n  printf(\"OK\");\nelse\n  printf(\"NOTOK\");\n</code></pre>\n\n<p>It seems that output should be OK for both a and b but the output is OK for a but NOTOK for b. Why?</p>\n"}, {"tags": ["c", "segmentation-fault", "strcpy"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 1, "creation_date": 1508298600, "post_id": 46802483, "comment_id": 80551702, "body": "You are doing <code>strcpy(NULL, line)</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508298707, "post_id": 46802483, "comment_id": 80551730, "body": "You forgot to assign storage to <code>history[0]</code>, so of course it blows up.  You can use <code>history[0] = strdup(line)</code> instead."}, {"owner": {"reputation": 154, "user_id": 7036039, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gzAIyOuIR6g/AAAAAAAAAAI/AAAAAAAAACY/KXvfwihuTWA/photo.jpg?sz=128", "display_name": "wt.cc", "link": "https://stackoverflow.com/users/7036039/wt-cc"}, "edited": false, "score": 0, "creation_date": 1508298783, "post_id": 46802483, "comment_id": 80551755, "body": "modify the definition of history by <code>char history[10]</code>, and use <code>strcpy(history, line)</code>, since <code>char *</code> declares that the element of history is a pointer, not a character."}], "answers": [{"tags": [], "owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "is_accepted": false, "score": 4, "last_activity_date": 1508300388, "last_edit_date": 1508300388, "creation_date": 1508298599, "answer_id": 46802495, "question_id": 46802483, "link": "https://stackoverflow.com/questions/46802483/strcpy-seg-fault-in-c/46802495#46802495", "title": "strcpy seg fault in C", "body": "<p>You've created an array of NULL pointers. You then tried to copy characters onto NULL.  That's a no-no.</p>\n\n<p>EDIT:\nYour program could be optimized to this:</p>\n\n<pre><code>void main() {\n   char line[80];\n   fgets(line,80,stdin); \n}\n</code></pre>\n\n<p>Your history array is never used to generate any output. So, while others have pointed out you need to allocate memory, technically, you could simply do this:</p>\n\n<pre><code>history[0] = line;\n</code></pre>\n\n<p>That will be a valid pointer up until the line goes out of scope, which is when history goes out of scope so it won't matter.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 7625751, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5177f87bca743bdac56318373425c958?s=128&d=identicon&r=PG&f=1", "display_name": "MoStack", "link": "https://stackoverflow.com/users/7625751/mostack"}, "edited": false, "score": 0, "creation_date": 1508298730, "post_id": 46802499, "comment_id": 80551737, "body": "What is the best thing to initialize the history to? Also thank you for the help"}, {"owner": {"reputation": 47440, "user_id": 229410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e0014fcc07d184018d3b8185a85a09?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/229410/rohan"}, "reply_to_user": {"reputation": 29, "user_id": 7625751, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5177f87bca743bdac56318373425c958?s=128&d=identicon&r=PG&f=1", "display_name": "MoStack", "link": "https://stackoverflow.com/users/7625751/mostack"}, "edited": false, "score": 0, "creation_date": 1508298834, "post_id": 46802499, "comment_id": 80551769, "body": "@MoStack, initialize to NULL is fine, but when you want to use it to store chars you should allocate memory to it."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1508300470, "post_id": 46802499, "comment_id": 80552148, "body": "This answer would be fantastic, if only you replaced &quot;will/may cause segfault&quot; to &quot;may behave erratically&quot;. The reason you can&#39;t say it &quot;will cause a segfault&quot; is that gives a definition; that defines the outcome, where-as in standard C the outcome is considered <i>undefined</i>. Other things could happen, too. Notable examples of <i>undefined behaviour</i> which often don&#39;t cause segfaults include: vulnerabilities such as buffer overflows and format string vulns, race conditions (multiple threads accessing the same resource at the same time), signed integer overflow and... this, if run on some devices."}], "tags": [], "owner": {"reputation": 47440, "user_id": 229410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e0014fcc07d184018d3b8185a85a09?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/229410/rohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1508298782, "last_edit_date": 1508298782, "creation_date": 1508298630, "answer_id": 46802499, "question_id": 46802483, "link": "https://stackoverflow.com/questions/46802483/strcpy-seg-fault-in-c/46802499#46802499", "title": "strcpy seg fault in C", "body": "<p>You need to allocate memory for <code>history[0]</code>. As <code>history[0]</code> is assigned NULL referencing it or writing to it will/may cause segfault.</p>\n\n<p>something like</p>\n\n<pre><code>//this will create memory for 100 chars\nhistory[0] = malloc(sizeof(char) * 100); \nstrcpy(history[0],line);\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>//shortcut for both - this allocate new memory and returns pointer.\nhistory[0] = strdup(line);\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7625751, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5177f87bca743bdac56318373425c958?s=128&d=identicon&r=PG&f=1", "display_name": "MoStack", "link": "https://stackoverflow.com/users/7625751/mostack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1508300388, "creation_date": 1508298494, "question_id": 46802483, "link": "https://stackoverflow.com/questions/46802483/strcpy-seg-fault-in-c", "title": "strcpy seg fault in C", "body": "<p>Curious about what is going wrong with this strcpy.</p>\n\n<pre><code>int main(void){\n    char *history[10];\n    for(int i = 0; i &lt; 10; i++){\n        history[i] = NULL;\n    }\n    char line[80];\n    fgets(line,80,stdin); \n    strcpy(history[0],line); //This line segfaults\n}\n</code></pre>\n"}, {"tags": ["c", "file", "infinite"], "comments": [{"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1508303213, "post_id": 46802450, "comment_id": 80552897, "body": "All I know is that you should be using <code>int main()</code> instead of <code>void main()</code>."}, {"owner": {"reputation": 852, "user_id": 1917004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e12a0abb82fac3b2293597967a7ec90d?s=128&d=identicon&r=PG", "display_name": "ctrl-shift-esc", "link": "https://stackoverflow.com/users/1917004/ctrl-shift-esc"}, "edited": false, "score": 0, "creation_date": 1508303976, "post_id": 46802450, "comment_id": 80553135, "body": "Have you tried debugging? Are the values in the variables what you expected them to be?"}, {"owner": {"reputation": 1, "user_id": 8793419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20b60ae22d36e2c94795b42c8a1cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/8793419/rahul"}, "edited": false, "score": 0, "creation_date": 1508306073, "post_id": 46802450, "comment_id": 80553906, "body": "Yes, I tried debugging using GDB (step by step) and it works fine as expected. But, direct execution of program isn&#39;t working."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1508307402, "post_id": 46802450, "comment_id": 80554434, "body": "Not using your file system change notification events could be one &#39;wrong&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1508321665, "post_id": 46804688, "comment_id": 80562539, "body": "No.  The call to <code>fclose()</code> in the posted code will flush the buffer."}], "tags": [], "owner": {"reputation": 358, "user_id": 7105409, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cTCYnuGzn1M/AAAAAAAAAAI/AAAAAAAAAw8/mNUReftTmbs/photo.jpg?sz=128", "display_name": "Eliad Cohen", "link": "https://stackoverflow.com/users/7105409/eliad-cohen"}, "is_accepted": false, "score": 0, "last_activity_date": 1508311072, "creation_date": 1508311072, "answer_id": 46804688, "question_id": 46802450, "link": "https://stackoverflow.com/questions/46802450/infinite-loop-to-poll-on-a-modified-file-and-write-its-contents-to-a-new-file-in/46804688#46804688", "title": "Infinite loop to poll on a modified file and write its contents to a new file in C", "body": "<p>You need to use <code>fflush</code> after the <code>fwrite</code>. \nThe <code>fwrite</code> does not write the data into the real file it write it to a buffer stream and after X time it will update the data or if the stream buffer is full.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1508323790, "creation_date": 1508323790, "answer_id": 46808448, "question_id": 46802450, "link": "https://stackoverflow.com/questions/46802450/infinite-loop-to-poll-on-a-modified-file-and-write-its-contents-to-a-new-file-in/46808448#46808448", "title": "Infinite loop to poll on a modified file and write its contents to a new file in C", "body": "<p>None of this is really going to answer your problem directly, since you don't really state anything other than your code isn't working.  What do you think a car mechanic would ask you if you told him, \"My car isn't working.\"</p>\n\n<p>For example, you're not telling us if the modification time reported by your call to <code>stat()</code> changes when you think the file contents change. </p>\n\n<ul>\n<li><p>First, the call to <code>access()</code> is worse than useless:</p>\n\n<pre><code>if(access( \"inpfile.txt\", F_OK ) != -1){\n   .\n   .\n   .\n</code></pre>\n\n<p>That call does you no good, and it introduces the possibility of <a href=\"https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use\" rel=\"nofollow noreferrer\">a TOCTOU bug</a>.  Just open the file - don't check if it exists first.  If it doesn't exist, opening the file will fail with an <code>ENOENT</code> or similar value in <code>errno</code>.</p>\n\n<p>Trying to somehow check if something you plan to do later will work is almost always a bad idea.  \"I want to check if the file exists before I try to open it.\" or \"I want to ping the server to make sure it's alive before I try to connect to it.\"  are <strong>BAD IDEAS</strong>.  They not only introduce a race condition if the situation changes between the check and the action (what happens if the file is deleted between your <code>access()</code> call and the <code>fopen()</code> call?), the <em>check</em> has to differ from your intended <em>action</em> in some way otherwise it would <em>be</em> the action.  And since it's different, different rules apply.  A fully-functional server may be configured to not respond to pings, for example.  So the check can fail in situations where the action itself would actually work.  And the other way around - the check can work and then the action can fail.</p>\n\n<p>Don't <em>check</em>.  Just <em>do</em>.  And then handle all errors.</p></li>\n<li><p>Second, since you're using <code>stat()</code> to get the file's modification time, there's no need to use <code>fseek()</code>/<code>ftell()</code> to get the size of the file as there's an <code>st_size</code> field in <code>struct stat</code> that tells you the file size.</p>\n\n<p>This will copy a file in one step (note that there's no error checking at all, and I used <code>open()</code>/<code>read()</code>/<code>write()</code> instead of <code>fopen()</code>/<code>fread()</code>/<code>fwrite()</code> since you're already using POSIX functions - that allows using <code>fstat()</code> on the file descriptor instead of <code>stat()</code> on the input file name, meaning that name only has to be used once:</p>\n\n<pre><code>struct stat sb;\nint fd = open( inputFileName, O_RDONLY );\nfstat( fd, &amp;sb );\nchar *data = malloc( sb.st_size );\nread( fd, data, sb.st_size );\nclose( fd );\nfd = open( outputFileName, O_WRONLY | O_CREAT | O_TRUNC, 0644 );\nwrite( fd, data, sb.st_size );\nclose( fd );\nfree( data );\n</code></pre>\n\n<p>Note that there is no error checking in that code - <code>open()</code> can fail, <code>malloc()</code> can fail, <code>read()</code> and <code>write()</code> can both be only partially successful (try to write 8 KB, and only 4 KB actually get written), so <strong>you have to check return values</strong>.  I also left out all the necessary header files.</p>\n\n<p>Adapting that code to a loop where you check for a change in the modification time shouldn't be hard.</p></li>\n<li><p>Third, technically <code>fseek()</code>/<code>ftell()</code> to get the size of the file is undefined behavior in C. (I have no idea why it's taught so much.  Bad teachers?  And if you use it on Windows on files > 2 GB you'll have issues as <code>long</code> is 32 bits even on 64-bit Windows.)  </p>\n\n<p>Streams open in binary mode are not required to support <code>fseek(..., SEEK_END)</code> - footnote 268 of <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">the C Standard</a> specifically states \"Setting  the  file  position  indicator  to  end-of-file,  as  with <code>fseek(file,  0,  SEEK_END)</code>,  has\nundefined behavior for a binary stream ...\".  And <code>ftell()</code> on a text stream does not represent how many bytes will be read from a file.  Per <strong>7.21.9.4  The <code>ftell</code> function</strong>, paragraph 2: </p>\n\n<blockquote>\n  <p>The <code>ftell</code> function obtains the current value of the file position\n  indicator for the stream pointed  to  by <code>stream</code>. For  a  binary \n  stream,  the  value  is  the  number  of  characters  from the\n  beginning of the file.  For a text stream, its file position indicator\n  contains unspecified information, usable by the <code>fseek</code> function for\n  returning the file position indicator for the stream  to  its \n  position  at  the  time  of  the <code>ftell</code> call;  the  difference \n  between  two  such return values is not necessarily a meaningful\n  measure of the number of characters written or read.</p>\n</blockquote></li>\n<li><p>Fourth, you state \"though the contents have been read\", but from the posted code you can't know that - you don't check <em>any</em> return values.  You just make calls and <em>hope</em> they actually work.</p></li>\n<li><p>You're also at risk of having this question closed as off-topic.  One of the reasons for that is:</p>\n\n<blockquote>\n  <p>Questions seeking debugging help (\"why isn't this code working?\") must\n  include the desired behavior, a specific problem or error and the\n  shortest code necessary to reproduce it in the question itself.\n  Questions without a clear problem statement are not useful to other\n  readers. See: How to create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable\n  example.</a></p>\n</blockquote>\n\n<p>As one of the comments already noted, you didn't mention your debugging efforts.</p></li>\n</ul>\n\n<p>And none of this answer gets into the difficulty of actually detecting file system changes and then processing the changed data.  It's not easy to do reliably and quickly, and it I'd say it indicates a bad design.</p>\n"}], "owner": {"reputation": 1, "user_id": 8793419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20b60ae22d36e2c94795b42c8a1cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/8793419/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508323790, "creation_date": 1508298294, "last_edit_date": 1508299333, "question_id": 46802450, "link": "https://stackoverflow.com/questions/46802450/infinite-loop-to-poll-on-a-modified-file-and-write-its-contents-to-a-new-file-in", "title": "Infinite loop to poll on a modified file and write its contents to a new file in C", "body": "<p>I am new to C programming and am trying to execute the code below. </p>\n\n<p>My objective is to create a program that continuously polls on an input file, reads it when it is modified and writes the contents to a new output file. </p>\n\n<p>The program writes to the output file if there is no 'while(1)' loop but it doesn't write to the output file (though the contents have been read) in the infinite loop. Could you please guide me where I am wrong?</p>\n\n<pre><code>void main(){\n    struct stat time_buf;\n    time_t input_timestamp=0;\n\n    while(1){\n        if(access( \"inpfile.txt\", F_OK ) != -1){\n            sleep(5);\n            stat(\"inpfile.txt\", &amp;time_buf);\n            if(time_buf.st_mtime &gt; input_timestamp){\n                FILE *fpi,*fpo;\n                long length;\n                char *buffer=0;           \n                fpi = fopen(\"inpfile.txt\",\"r\");\n                fseek(fpi,0,SEEK_END);\n                length=ftell(fpi);\n                fseek(fpi,0,SEEK_SET);\n                buffer=(char *)malloc(length);\n                fread(buffer,1,length,fpi);\n                fclose(fpi);      \n\n                fpo=fopen(\"outfile.txt\",\"w+\");\n                fwrite(buffer,sizeof(char),length,fpo);\n                fclose(fpo);\n                input_timestamp=time_buf.st_mtime;\n            }\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "variable-assignment"], "comments": [{"owner": {"reputation": 231, "user_id": 8666839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eb9B0.jpg?s=128&g=1", "display_name": "YaatSuka", "link": "https://stackoverflow.com/users/8666839/yaatsuka"}, "edited": false, "score": 0, "creation_date": 1508297760, "post_id": 46802280, "comment_id": 80551460, "body": "And please, <b>declare</b> and <b>set</b> the two struct variables <b>in</b> the <code>main()</code> function. It hurts the eyes.."}, {"owner": {"reputation": 123, "user_id": 1031438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9374a1283900cd2054943a0bf4312ec6?s=128&d=identicon&r=PG", "display_name": "Bahubali", "link": "https://stackoverflow.com/users/1031438/bahubali"}, "reply_to_user": {"reputation": 231, "user_id": 8666839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eb9B0.jpg?s=128&g=1", "display_name": "YaatSuka", "link": "https://stackoverflow.com/users/8666839/yaatsuka"}, "edited": false, "score": 0, "creation_date": 1508297866, "post_id": 46802280, "comment_id": 80551490, "body": "I tried below, #include&lt;stdio.h&gt;  struct Record { \tint ID; \tchar Name[10]; }R1={1234,&quot;King&quot;},*R2;  R2=&amp;R1;  int main() {      \tprintf(&quot;%d   %s \\n&quot;,R1.ID,R1.Name); \tprintf(&quot;%d   %s \\n&quot;,R2-&gt;ID,R2-&gt;Name); }  Still not working"}, {"owner": {"reputation": 123, "user_id": 1031438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9374a1283900cd2054943a0bf4312ec6?s=128&d=identicon&r=PG", "display_name": "Bahubali", "link": "https://stackoverflow.com/users/1031438/bahubali"}, "reply_to_user": {"reputation": 231, "user_id": 8666839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eb9B0.jpg?s=128&g=1", "display_name": "YaatSuka", "link": "https://stackoverflow.com/users/8666839/yaatsuka"}, "edited": false, "score": 0, "creation_date": 1508298043, "post_id": 46802280, "comment_id": 80551546, "body": "See my updated question.."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 1031438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9374a1283900cd2054943a0bf4312ec6?s=128&d=identicon&r=PG", "display_name": "Bahubali", "link": "https://stackoverflow.com/users/1031438/bahubali"}, "edited": false, "score": 0, "creation_date": 1508298077, "post_id": 46802386, "comment_id": 80551556, "body": "Hi Zian, thanks..But why my Code 1 and Code 2 are not working? Could you please explain?"}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 1, "creation_date": 1508298607, "post_id": 46802386, "comment_id": 80551705, "body": "Did you try your edited code? No, it will <i>not</i> work, you cannot assign to a <code>char[]</code>. Printing that will show you that <code>R2.name</code> is an empty string."}, {"owner": {"reputation": 366, "user_id": 8497267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/o8W1W.png?s=128&g=1", "display_name": "Nicolas Guerin", "link": "https://stackoverflow.com/users/8497267/nicolas-guerin"}, "reply_to_user": {"reputation": 123, "user_id": 1031438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9374a1283900cd2054943a0bf4312ec6?s=128&d=identicon&r=PG", "display_name": "Bahubali", "link": "https://stackoverflow.com/users/1031438/bahubali"}, "edited": false, "score": 0, "creation_date": 1508298658, "post_id": 46802386, "comment_id": 80551714, "body": "Hi @user1031438 your code isn&#39;t working  because u&#39;re not declaring the variable properly and inside a scope with the variable type. You&#39;re trying to use R1 &amp; R2 as if they were already declared somewhere in program as global variable."}, {"owner": {"reputation": 1600, "user_id": 2641038, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/VCnlL.png?s=128&g=1", "display_name": "Lion Lai", "link": "https://stackoverflow.com/users/2641038/lion-lai"}, "reply_to_user": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 0, "creation_date": 1508299232, "post_id": 46802386, "comment_id": 80551878, "body": "@bnaecker I fixed it. btw, can you explain why using <code>char Name[]</code> would not work here."}, {"owner": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 1, "creation_date": 1508299401, "post_id": 46802386, "comment_id": 80551918, "body": "@ZianLai That is an array. You cannot assign to an array, as far as I&#39;m aware. You must use <code>char *name</code>, which can be pointed anywhere, including at an existing <code>char[]</code> array."}, {"owner": {"reputation": 2068, "user_id": 1925996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/05256a041ac14a50a2054679fcc85a34?s=128&d=identicon&r=PG", "display_name": "piedar", "link": "https://stackoverflow.com/users/1925996/piedar"}, "edited": false, "score": 0, "creation_date": 1508300498, "post_id": 46802386, "comment_id": 80552159, "body": "It seems copying is automatic if the size is known; probably the compiler emits memcpy() or equivalent.  The <code>char*</code> is just an offset into rodata and can be copied (safely?) since it has static storage."}, {"owner": {"reputation": 123, "user_id": 1031438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9374a1283900cd2054943a0bf4312ec6?s=128&d=identicon&r=PG", "display_name": "Bahubali", "link": "https://stackoverflow.com/users/1031438/bahubali"}, "edited": false, "score": 0, "creation_date": 1508307160, "post_id": 46802386, "comment_id": 80554334, "body": "@ZianLai, The code is running after putting R2=R1; in main(). But as per C standards, is there any rule that, we can&#39;t assign structure variables outside any function? What is the concept working here?"}, {"owner": {"reputation": 1600, "user_id": 2641038, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/VCnlL.png?s=128&g=1", "display_name": "Lion Lai", "link": "https://stackoverflow.com/users/2641038/lion-lai"}, "reply_to_user": {"reputation": 123, "user_id": 1031438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9374a1283900cd2054943a0bf4312ec6?s=128&d=identicon&r=PG", "display_name": "Bahubali", "link": "https://stackoverflow.com/users/1031438/bahubali"}, "edited": false, "score": 0, "creation_date": 1508307759, "post_id": 46802386, "comment_id": 80554569, "body": "@user1031438 according to my experiences, you can&#39;t run code outside of function. You can only declare variables outside of functions. Hope it helps."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 5074, "user_id": 1354854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013458c49caa535da7af54d010a8a0b3?s=128&d=identicon&r=PG", "display_name": "bnaecker", "link": "https://stackoverflow.com/users/1354854/bnaecker"}, "edited": false, "score": 0, "creation_date": 1605080937, "post_id": 46802386, "comment_id": 114539968, "body": "@bnaecker that&#39;s not true. Arrays wrapped inside structs will be copied as normal. That&#39;s one trick when you want to pass arrays as values to functions. See <a href=\"https://stackoverflow.com/q/29989516/995714\">Deep copying structs with char arrays in C (How to copy the arrays?)</a>. The problem here is just about the empty <code>[]</code> when declaring the array"}], "tags": [], "owner": {"reputation": 1600, "user_id": 2641038, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/VCnlL.png?s=128&g=1", "display_name": "Lion Lai", "link": "https://stackoverflow.com/users/2641038/lion-lai"}, "is_accepted": true, "score": 3, "last_activity_date": 1508299541, "last_edit_date": 1508299541, "creation_date": 1508297817, "answer_id": 46802386, "question_id": 46802280, "link": "https://stackoverflow.com/questions/46802280/unable-to-assign-structure-variable-to-another-structure-variable/46802386#46802386", "title": "Unable to assign structure variable to another structure variable", "body": "<p>You can try this.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\ntypedef struct _Record\n{\n    int ID;\n    char Name[10];\n} Record;\n\nint main()\n{\n    Record R1, R2;\n    R1.ID = 1234;\n    strcpy(R1.Name, \"king\");\n    R2 = R1;\n    printf(\"%d   %s \\n\",R1.ID,R1.Name);\n    printf(\"%d   %s \\n\",R2.ID,R2.Name);\n}\n\n&gt;&gt;&gt;\n1234 king\n1234 king\n</code></pre>\n\n<p>As @piedar said, the following also works</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nstruct _Record\n{\n    int ID;\n    char *Name;\n} R1={1234,\"king\"}, R2;\n\nint main()\n{\n    R2 = R1;\n    printf(\"%d   %s \\n\",R1.ID,R1.Name);\n    printf(\"%d   %s \\n\",R2.ID,R2.Name);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 822, "user_id": 4112667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i1NaX.jpg?s=128&g=1", "display_name": "haolee", "link": "https://stackoverflow.com/users/4112667/haolee"}, "is_accepted": false, "score": 0, "last_activity_date": 1508298884, "last_edit_date": 1508298884, "creation_date": 1508298513, "answer_id": 46802485, "question_id": 46802280, "link": "https://stackoverflow.com/questions/46802280/unable-to-assign-structure-variable-to-another-structure-variable/46802485#46802485", "title": "Unable to assign structure variable to another structure variable", "body": "<p>In <code>Code1</code>, you can't use <code>R2=R1</code> outside C functions, otherwise GCC will report errors. Just move <code>R2=R1;</code> into the <code>main</code> function and then your program will work normally.</p>\n\n<p>Similarly, move <code>R2=&amp;R1;</code> into the <code>main</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1605080819, "last_edit_date": 1605080819, "creation_date": 1508298639, "answer_id": 46802501, "question_id": 46802280, "link": "https://stackoverflow.com/questions/46802280/unable-to-assign-structure-variable-to-another-structure-variable/46802501#46802501", "title": "Unable to assign structure variable to another structure variable", "body": "<p>You haven't reserved any space for the string. An array with <strong>no size</strong> at the end of a struct is called <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array member</a></p>\n<pre><code>struct Record\n{\n    int ID;\n    char Name[];\n}\n</code></pre>\n<p>You have to allocate some memory for the string <a href=\"https://stackoverflow.com/q/3047530/995714\">like this</a></p>\n<pre><code>struct Record R1 = malloc(sizeof(struct Record) + 10 * sizeof(char));\n</code></pre>\n<p>Alternatively declare <code>Name</code> as a <code>char*</code> then allocate memory and copy the string like normal. Remember to delete the pointer when you finished using it</p>\n<p>Or just avoid flexible array member and declare a fixed size for <code>Name</code></p>\n"}], "owner": {"reputation": 123, "user_id": 1031438, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9374a1283900cd2054943a0bf4312ec6?s=128&d=identicon&r=PG", "display_name": "Bahubali", "link": "https://stackoverflow.com/users/1031438/bahubali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "accepted_answer_id": 46802386, "answer_count": 3, "score": -1, "last_activity_date": 1605080819, "creation_date": 1508297110, "last_edit_date": 1555900240, "question_id": 46802280, "link": "https://stackoverflow.com/questions/46802280/unable-to-assign-structure-variable-to-another-structure-variable", "title": "Unable to assign structure variable to another structure variable", "body": "<p>I am unable to assign one structure variable (<code>R2 = R1</code>) to another structure variable. Please help me to understand, why the following program is not getting compiled and what is the best way to assign one structure variable to other? </p>\n\n<p>I'm tired with the pointers way. Still code is not getting compiled...</p>\n\n<p><strong>Code1</strong>:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstruct Record\n{\n    int ID;\n    char Name[];\n} R1 = {1234, \"King\"}, R2;\n\nR2 = R1;\n\nint main()\n{\n    printf(\"%d   %s \\n\", R1.ID, R1.Name);\n    printf(\"%d   %s \\n\", R2.ID, R2.Name);\n}\n</code></pre>\n\n<p><strong>Code2:</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstruct Record\n{\n    int ID;\n    char Name[];\n} R1 = {1234, \"King\"}, *R2;\n\nR2 = &amp;R1;\n\nint main()\n{\n\n    printf(\"%d   %s \\n\", R1.ID, R1.Name);\n    printf(\"%d   %s \\n\", R2-&gt;ID, R2-&gt;Name);\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "printf", "68hc12"], "comments": [{"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1508298545, "post_id": 46802189, "comment_id": 80551687, "body": "Does execution survive the call to sprintf() or does it run away in some sort of crash or fault handler?  Is your receiver going to promptly display something that doesn&#39;t end with a newline or carriage return?  What happens if you take out the receive check on which the transmission is conditional?"}, {"owner": {"reputation": 1, "user_id": 8793395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01189045881c91b98e50342cc4aaf8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8793395/joe"}, "reply_to_user": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1508299194, "post_id": 46802189, "comment_id": 80551869, "body": "Execution survives and it compiles properly with no crashes.  It would still show properly without a newline character, it would just show repeatedly on the same line.  Nothing is shown on the terminal screen when there is no transmission conditional."}, {"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1508300840, "post_id": 46802189, "comment_id": 80552232, "body": "Specs on your kit say it has a debug monitor, you should be able to follow this and see what happens."}, {"owner": {"reputation": 1, "user_id": 8793395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01189045881c91b98e50342cc4aaf8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8793395/joe"}, "reply_to_user": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1508302266, "post_id": 46802189, "comment_id": 80552626, "body": "The debug monitor is showing a bunch of random values for the buffer char array I&#39;m attempting to use sprintf with.  Value [0] = -69, [1] = -44, [2] = 0, [3] = 0... they all just appear to be random numbers."}, {"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1508305977, "post_id": 46802189, "comment_id": 80553865, "body": "Firs you probably want those in hex, but then as non-printable values with a zero far too early, these are presumably the values before the call - since it&#39;s a stack variable the memory is likely to have been used before."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1508325883, "post_id": 46802189, "comment_id": 80565066, "body": "Assuming it is not as simple as having forgotten to include stdio.h, nobody will be able to reproduce the bug. Which compiler are you using? Is this code running on top of the horrible bootloader &quot;dbug12&quot; or did you actually flash it yourself with a BDM? Is this code built as a flash project or some nonsense &quot;RAM project&quot;?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1508326076, "post_id": 46802189, "comment_id": 80565175, "body": "Oh! And what&#39;s the memory model? You can get really weird results if the PPAGE of the HCS12 is not set to the correct bank. Suppose for example that it reads address 0x8000 instead of address 0x388000. Various versions of various HCS12 compilers struggled with bugs related to PPAGE. Unless you really need a ton of program flash, I would advise to stay clear of the banked memory model."}], "owner": {"reputation": 1, "user_id": 8793395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01189045881c91b98e50342cc4aaf8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8793395/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508326370, "creation_date": 1508296259, "last_edit_date": 1508326370, "question_id": 46802189, "link": "https://stackoverflow.com/questions/46802189/sprintf-not-working-with-dragon12-light-boardc", "title": "Sprintf not working with dragon12-light board(C)", "body": "<p>I'm trying to program a Dragon12-Light board to display information to a PC through Cool Term terminal software, however I can't seem to get the sprintf function to work properly.  The goal is to send information from the temperature sensor and light sensor to the terminal, but I've even tried it with dummy values and it's not operating properly.  Here's the code:</p>\n\n<pre><code>void main(void) {\n  PLL_init();        // set system clock frequency to 24 MHz \n  DDRB  = 0xff;       // Port B is output\n  DDRJ  = 0xff;       // Port J is output\n  DDRP  = 0xff;       // Port P is output\n  PTJ = 0x00;         // enable LED\n  PTP = 0x00;         // enable all 7-segment displays\n  PORTB   = 0x55;     // turn on every other led and segment on 7-seg displays\n  initSCI0();\n\n\n  for(;;) {\n\n  unsigned char pot = '1';\n  unsigned char pot_out;\n  unsigned char temperature;\n  unsigned char light;\n  unsigned char receive;\n  char buffer[50];\n  int test = 10;\n\n  sprintf(buffer, \"test = %d\", test);\n\n  receive = SCI0_receiveByte();\n\n  if(receive == '1'){\n\n\n  SCI0_transmitString(buffer);\n\n  }\n\n\n  } /* wait forever */\n}\n</code></pre>\n\n<p>I've verified that all functions operate properly, and if  I put a char array with a defined value into the transmit string function, it will display properly on the terminal when '1' is pressed on the keyboard, but the sprintf command doesn't seem to be writing anything to the array.  Any help would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 1, "creation_date": 1508295697, "post_id": 46802123, "comment_id": 80550988, "body": "I think that underscore is just part of a naming convention."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1508295803, "post_id": 46802123, "comment_id": 80551011, "body": "C treats <code>_</code> as an alphabetic character, just like <code>a</code> or <code>x</code> for example.  Anything else is strictly a naming convention."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1508296667, "post_id": 46802123, "comment_id": 80551217, "body": "<code>_</code> is like a letter yet may also begin  various reserve identifiers."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1508297262, "post_id": 46802123, "comment_id": 80551343, "body": "Apart from the fact that some identifiers starting with <code>_</code> are reserved in certain contexts, <code>parm</code> and <code>_parm</code> are entirely distinct identifiers. There is no more relationship between them than between <code>parm</code> and <code>foo</code>, or between <code>parm</code> and <code>Parm</code>. (Obviously the author of the code meant them to appear similar.)"}], "owner": {"reputation": 347, "user_id": 3448721, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2024540f989f837555d936df9b8bf457?s=128&d=identicon&r=PG&f=1", "display_name": "4va1anch3", "link": "https://stackoverflow.com/users/3448721/4va1anch3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "closed_date": 1508297185, "answer_count": 0, "score": 2, "last_activity_date": 1508295582, "creation_date": 1508295582, "question_id": 46802123, "link": "https://stackoverflow.com/questions/46802123/what-does-mean-in-c-programming-language", "closed_reason": "Duplicate", "title": "What does &quot;_&quot; mean in C programming language?", "body": "<p>Recently I am reading linux kernel code and I read this:</p>\n\n<pre><code>#define MODULE_PARM_DESC(_parm, desc) \\\n    __MODULE_INFO(parm, _parm, #_parm \":\" desc)\n</code></pre>\n\n<p>I am very confused that why there is a \"parm\", what is the relationship between \"parm\" and \"_parm\"?</p>\n"}, {"tags": ["c", "gcc", "arm"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1508320462, "post_id": 46802033, "comment_id": 80561825, "body": "C11 draft standard n1570: <i>5.1.2.3 Program execution 5 When the processing of the abstract machine is interrupted by receipt of a signal, the values of objects that are neither lock-free atomic objects nor of type volatile sig_atomic_t are unspecified, as is the state of the floating-point environment. The value of any object modified by the handler that is neither a lock-free atomic object nor of type volatile sig_atomic_t becomes indeterminate when the handler exits[...]</i>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8776078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38319161ce301509426f483b565b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/8776078/ian"}, "edited": false, "score": 0, "creation_date": 1508313575, "post_id": 46803293, "comment_id": 80557681, "body": "Yes, i know what &#39;volatile&#39; mean. I use keil MDK which use ARM-CC before, and never use GCC, and i never use &#39;volatile&#39; qualifier for multi-access variables because it&#39;s no problem for ARM-CC, program works well.  Now, i use GCC, the problem appear, is ARM-CC not rigorous enough? I know use &#39;volatile&#39; qualifier is a better way, i just do not want use &#39;volatile&#39; qualifier for all global variables or members of global struct variable, because there will be lots of  [-Wdiscarded-qualifiers] warning, so i need to know when i must use &#39;volatile&#39; qualifier, and when don&#39;t."}, {"owner": {"reputation": 1, "user_id": 8776078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38319161ce301509426f483b565b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/8776078/ian"}, "edited": false, "score": 0, "creation_date": 1508314520, "post_id": 46803293, "comment_id": 80558183, "body": "When i access the variable in different threads(include ISR), i must use &#39;volatile&#39; qualifier for the variable, and if i access the variable in different functions in the same thread, i don&#39;t need use &#39;volatile&#39; qualifier for it, is that right? So, if the system do not use OS,  means there is only one tread except ISR, so i only need use &#39;volatile&#39; qualifier for the variables which multi-access by ISR and the main loop, is that so?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 1, "user_id": 8776078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38319161ce301509426f483b565b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/8776078/ian"}, "edited": false, "score": 0, "creation_date": 1508345455, "post_id": 46803293, "comment_id": 80577977, "body": "The question when it is safe to omit <code>volatile</code> is a separate one and complex."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 0, "last_activity_date": 1508304042, "creation_date": 1508304042, "answer_id": 46803293, "question_id": 46802033, "link": "https://stackoverflow.com/questions/46802033/volatile-variable-in-segger-embedded-studio-with-gcc/46803293#46803293", "title": "volatile variable in segger embedded studio with gcc", "body": "<p>You seem to know the meaning of <code>volatile</code>.<br>\nYour question is mainly whether you should consciously consider it for all your variables.<br>\nThe answer is: Yes.</p>\n\n<p>If that seems too difficult, or accidentally, just leave the <code>volatile</code> away and only start thinking about it when something does not work as desired.<br>\nYou might however finally find out that this solution is actually very hard.<br>\nMaybe your question was caused by this experience.</p>\n\n<p>The good news is that it will become easier, with experience.<br>\nAt some point, you will read code, or write it, and feel a shiver going down the back. With more experience you will be able to tell the difference between the \"volatile is missing\"-shiver and e.g. the \"variable is not initialised\"-shiver.  </p>\n"}], "owner": {"reputation": 1, "user_id": 8776078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38319161ce301509426f483b565b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/8776078/ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508304042, "creation_date": 1508294827, "question_id": 46802033, "link": "https://stackoverflow.com/questions/46802033/volatile-variable-in-segger-embedded-studio-with-gcc", "title": "volatile variable in segger embedded studio with gcc", "body": "<p>I use SES import my keil MDK project, and my keil project work well. With SES, i have a problem, that is, i have a global variable like this:</p>\n\n<pre><code>uint32_t               g_ulMainLoopCounter = 0;\n</code></pre>\n\n<p>and i decrease it in timmer isr:</p>\n\n<pre><code>if  (g_ulMainLoopCounter &gt; 0)\n{\n    g_ulMainLoopCounter--;\n}\n</code></pre>\n\n<p>in my main function, i wait until 'g_ulMainLoopCounter' decrease to 0:</p>\n\n<pre><code>int main(void)\n{   \n    system_init();                                      //init timer etc...\n\n    g_ulMainLoopCounter = 500;\n    while (g_ulMainLoopCounter)\n    {\n    }\n\n   ....\n}\n</code></pre>\n\n<p>now the problem is , my code after 'while' will never be executioned, even 'g_ulMainLoopCounter' decrease to 0. This work well in keil.</p>\n\n<p>Then, if i use 'volatile' qualifier for 'g_ulMainLoopCounter', it works, the code then like this:</p>\n\n<pre><code>volatile uint32_t g_ulMainLoopCounter = 0;\n</code></pre>\n\n<p>My optimization level set to none, means do not optimize my code.</p>\n\n<p>I know use 'volatile' qualifier is a better way, but 'g_ulMainLoopCounter' is just only a example, there are lots of variables which used like \"g_ulMainLoopCounter\" (means multi-access variable, change the value in a function or isr and comparison in other function)in my program, must i check every variable in my program and determine if the variable is needed use 'volatile' qualifier? If so, i think that's too difficult.Is there any easy solutions?</p>\n"}, {"tags": ["c", "sorting"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1508294712, "post_id": 46802005, "comment_id": 80550796, "body": "I suspect recursion is needed or save the data to a file - unless input is in the order needed."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1508295158, "post_id": 46802005, "comment_id": 80550888, "body": "What about a linked list?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1508295291, "post_id": 46802005, "comment_id": 80550914, "body": "@JerryJeremiah That&#39;s an approach that would be very welcomed at <a href=\"https://codegolf.stackexchange.com/\">codegolf.stackexchange.com</a> :)"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1508295487, "post_id": 46802005, "comment_id": 80550955, "body": "Pick a data structure that allows quick traversal in a sorted order.  Put the input in that data structure.  Output the data in order."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1508297334, "post_id": 46802005, "comment_id": 80551360, "body": "Use binary search tree."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1508299050, "post_id": 46802005, "comment_id": 80551837, "body": "like <a href=\"https://ideone.com/zSdwCG\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1508300460, "post_id": 46802005, "comment_id": 80552145, "body": "I was about to say the same thing with @BLUEPIXY . Binary Search Tree is the proper way."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "edited": false, "score": 1, "creation_date": 1508300819, "post_id": 46802005, "comment_id": 80552228, "body": "@GeorgeBou Get used to it, he is one of the fastest guns in the west (or on SO, so to speak). <i>Rumor has it, BLUEPIXY is actually a bot that scans incoming questions automating correct answers on the fly...</i>"}, {"owner": {"reputation": 563, "user_id": 5699882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-sPL4bZXU7W4/AAAAAAAAAAI/AAAAAAAAAWg/FOG3peQI48A/photo.jpg?sz=128", "display_name": "Mayank Verma", "link": "https://stackoverflow.com/users/5699882/mayank-verma"}, "edited": false, "score": 0, "creation_date": 1508302300, "post_id": 46802005, "comment_id": 80552637, "body": "Do you intend to sort a stream of integers using just 2 variables and no external storage? If yes, then I&#39;m sorry to say it&#39;s not possible, unless the user just enters 2 input numbers, in which case you might as well have used an array of 2 integers."}, {"owner": {"reputation": 111, "user_id": 7394522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-1hUzo2zgmnc/AAAAAAAAAAI/AAAAAAAAAGU/VN6vhvWWUY8/photo.jpg?sz=128", "display_name": "Ashutosh K Singh", "link": "https://stackoverflow.com/users/7394522/ashutosh-k-singh"}, "edited": false, "score": 0, "creation_date": 1508375306, "post_id": 46802005, "comment_id": 80590287, "body": "Thanks all for confirming what I believed, I also think it is not possible to do this without using any data structure like an array or a linked list. Initially I thought it might be possible recursively, but no ."}, {"owner": {"reputation": 111, "user_id": 7394522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-1hUzo2zgmnc/AAAAAAAAAAI/AAAAAAAAAGU/VN6vhvWWUY8/photo.jpg?sz=128", "display_name": "Ashutosh K Singh", "link": "https://stackoverflow.com/users/7394522/ashutosh-k-singh"}, "edited": false, "score": 0, "creation_date": 1508375737, "post_id": 46802005, "comment_id": 80590392, "body": "Binary search tree does solve it , thanks BLUEPIXY. But again it uses a data structure &#39;structs&#39;, also the output contains unwanted extra lines (which can be ignored , for practical purposes)."}], "answers": [{"comments": [{"owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "edited": false, "score": 0, "creation_date": 1508395849, "post_id": 46802902, "comment_id": 80595636, "body": "This would be a very time consuming program (regarding complexity etc.). And still, you would probably need to use an array."}], "tags": [], "owner": {"reputation": 103, "user_id": 6925258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f6c2c6da0f0e52f28633bbe118d238?s=128&d=identicon&r=PG&f=1", "display_name": "jatin agarwal", "link": "https://stackoverflow.com/users/6925258/jatin-agarwal"}, "is_accepted": false, "score": -3, "last_activity_date": 1508301434, "creation_date": 1508301434, "answer_id": 46802902, "question_id": 46802005, "link": "https://stackoverflow.com/questions/46802005/sort-and-print-integers-fed-from-keyboard-in-ascending-order-without-using-array/46802902#46802902", "title": "Sort and print integers fed from keyboard in ascending order without using arrays in C", "body": "<p>In this, we can enter each number one by one from keyboard then perform insertion sort on ech step, finally we get an sorted set of numbers. </p>\n"}], "owner": {"reputation": 111, "user_id": 7394522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-1hUzo2zgmnc/AAAAAAAAAAI/AAAAAAAAAGU/VN6vhvWWUY8/photo.jpg?sz=128", "display_name": "Ashutosh K Singh", "link": "https://stackoverflow.com/users/7394522/ashutosh-k-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508301434, "creation_date": 1508294564, "last_edit_date": 1508299557, "question_id": 46802005, "link": "https://stackoverflow.com/questions/46802005/sort-and-print-integers-fed-from-keyboard-in-ascending-order-without-using-array", "title": "Sort and print integers fed from keyboard in ascending order without using arrays in C", "body": "<p>The task is to sort and print the integers input from keyboard in ascending order, without using arrays in C . The end of inputs is marked by a '-1', which is not to be taken as an input. \nI have tried to solve this but could not succeed, can anyone help me solve this problem?</p>\n\n<p>Here is my attempt </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid smaller(int first,int second)\n{\n    int temp=0;\n    if(second&lt;first) {\n        temp=first;\n        first=second;\n        second=temp;\n        printf(\"%d %d\",first,second);\n        }\n}\n\nint main()\n{\n      int first=0,second=0;\n\n      printf(\"Kindly enter numbers to be arranged in ascending order followed by a -1\\n\\n\");\n      scanf(\"%d\",&amp;first);\n\n      while(second != -1) {\n          scanf(\"%d\",&amp;second);\n          smaller(first, second);\n      }\n      return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ruby", "inline"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508304365, "post_id": 46801990, "comment_id": 80553265, "body": "Ruby and C are two very different languages. If you&#39;re not familiar with how to use C effectively you&#39;ll need to at least understand the fundamentals. The good news is C is pretty simple as far as languages go, with a terse, minimal sort of syntax. The difficulty comes in applying concepts like pointers and pointer math effectively."}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508473831, "post_id": 46801990, "comment_id": 80632463, "body": "I am much more familiar with C (sorry for the obvious oversight of modifying a constant string). The problem is, I need to know how to modify a global ruby variable but don&#39;t know how.  Thx"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508517432, "post_id": 46801990, "comment_id": 80654452, "body": "Don&#39;t let Ruby&#39;s casual style confuse your C code then. A call to <code>sprintf</code> needs to be inside a function, but it&#39;s also baffling that you&#39;re using <code>sprintf</code> at all instead of something simple like <code>strncpy</code> or in this case, given how you&#39;ve failed to initialize <code>cstr</code>, <code>memcpy</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1508298766, "post_id": 46802256, "comment_id": 80551748, "body": "Thanks @mu-is-too-short, I changed cstr to be a buffer from a pointer to constant string, I got some compile error. Care to point out what went wrong? Thx."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1508300552, "post_id": 46802256, "comment_id": 80552166, "body": "You can&#39;t call <code>sprintf</code> outside a function like that."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 2, "last_activity_date": 1508296903, "creation_date": 1508296903, "answer_id": 46802256, "question_id": 46801990, "link": "https://stackoverflow.com/questions/46801990/inline-code-causes-ruby-interpreter-to-crash/46802256#46802256", "title": "Inline code causes ruby interpreter to crash", "body": "<p>Your problem is that you're trying to modify read-only memory. If you get all the clutter out of the way, you can show this with a small C program:</p>\n\n<pre><code>int\nmain(int argc, char **argv) {\n  char *cstr = \"hi you'all, welcome\";\n  cstr[1]++;\n  return 0;\n}\n</code></pre>\n\n<p>If you compile that and run it you should get a bus error (or similar) because <code>cstr</code> is in read-only memory and <code>cstr[1]++</code> is trying to modify that read-only memory. There is some discussion on this over in <a href=\"https://stackoverflow.com/q/1011455/479863\"><strong>Is it possible to modify a string of char in C?</strong></a> and probably hundreds of other questions in the <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> tag.</p>\n\n<p>The solution is to not modify <code>cstr</code>. I don't have enough details to offer more concrete advice.</p>\n"}, {"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1508672530, "last_edit_date": 1508672530, "creation_date": 1508610742, "answer_id": 46866646, "question_id": 46801990, "link": "https://stackoverflow.com/questions/46801990/inline-code-causes-ruby-interpreter-to-crash/46866646#46866646", "title": "Inline code causes ruby interpreter to crash", "body": "<p>Watch out for how RubyInline defines your Ruby methods. If you use <code>c_raw</code> or <code>c_raw_singleton</code> then it uses <code>-1</code> as the arity in the call to <code>rb_define_method</code> or <code>rb_define_singleton_method</code>, <a href=\"https://github.com/ruby/ruby/blob/trunk/doc/extension.rdoc#method-and-singleton-method-definition\" rel=\"nofollow noreferrer\">so the method is called as</a>:</p>\n\n<pre><code>VALUE func(int argc, VALUE *argv, VALUE obj)\n</code></pre>\n\n<p>So in your case your signature should be something like:</p>\n\n<pre><code>VALUE write_global(int argc, VALUE *argv, VALUE self)\n</code></pre>\n\n<p>Here\u2019s a version of your class with that change. I\u2019ve also moved the <code>cstr</code> declaration into the prefix to avoid a warning and used <code>StringValueCStr</code> instead of <code>rb_string_value_cstr</code> as it is <a href=\"https://github.com/ruby/ruby/blob/trunk/doc/extension.rdoc#data-type-conversion\" rel=\"nofollow noreferrer\">better documented</a>, but I\u2019ve omitted any error checking (which you should add as otherwise you could get further segfaults):</p>\n\n<pre><code>class Foo\n  inline :C  do |builder|\n\n    builder.prefix(\"static char cstr[] = \\\"hi you'all, welcome\\\";\")\n\n    builder.c_raw_singleton &lt;&lt;SRC\n      VALUE write_global(int argc, VALUE* argv, VALUE self){\n        rb_gv_set(StringValueCStr(argv[0]), rb_str_new_cstr(cstr));\n        cstr[1] ++;\n        return Qnil;\n      }\nSRC\n  end\nend\n</code></pre>\n\n<p>With this class, the output of your code is:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>hi you'all, welcome\nhj you'all, welcome\n</code></pre>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1508672530, "creation_date": 1508294459, "last_edit_date": 1508298715, "question_id": 46801990, "link": "https://stackoverflow.com/questions/46801990/inline-code-causes-ruby-interpreter-to-crash", "title": "Inline code causes ruby interpreter to crash", "body": "<p>My ruby based data analysis project needs high performance. I plan to create an inline C function that reads a piece of data and updates some global variables, which I can do more processing in ruby.</p>\n\n<p>The following toy code:</p>\n\n<pre><code>require 'inline'\nclass Foo\n  inline :C  do |builder|\n    builder.c_raw_singleton &lt;&lt;SRC\n     static char *cstr = \"hi you'all, welcome\";\n      void write_global(VALUE self, VALUE *name){\n        rb_gv_set(rb_string_value_cstr(name), rb_str_new_cstr(cstr));\n        cstr[1] ++;\n      }\nSRC\n  end\nend\n\n\n$bar = \"\"\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\n</code></pre>\n\n<p>will cause exception on ruby interpreter.</p>\n\n<p>I wonder what the problem is.</p>\n\n<p><strong>UPDATE 1</strong></p>\n\n<p>Thanks to @mu-is-too-short who pointed out the constant string can't be modified, I changed it to be a buffer (see the following), but got compile errors like</p>\n\n<pre><code>WARNING: '&amp;cstr[0]' not understood\nWARNING: '\"%s\"' not understood\nWARNING: '\"hi you'all' not understood\nWARNING: 'welcome\"' not understood\nWARNING: Can't find signature in \"\\t static char cstr[20];static int f(&amp;cstr[0], \\\"%s\\\", \\\"hi you'all, welcome\\\");\\n      void write_global(VALUE self, VALUE *name){\\n        rb_gv_set(rb_string_value_cstr(name), rb_str_new_cstr(cstr));\\n\\t\\tcstr[1] ++;\\n      }\\n\"\ninline1a.rb:5:37: error: expected declaration specifiers or \u2018...\u2019 before \u2018&amp;\u2019 token\n     builder.c_raw_singleton &lt;&lt;SRC\n</code></pre>\n\n<p>Here is the new code that doesn't try to modify constant string.</p>\n\n<pre><code>require 'inline'\nclass Foo\n  inline :C  do |builder|\n    builder.c_raw_singleton &lt;&lt;SRC\n     static char cstr[20];\n     sprintf(&amp;cstr[0], \"%s\", \"hi you'all, welcome\");\n      void write_global(VALUE self, VALUE *name){\n        rb_gv_set(rb_string_value_cstr(name), rb_str_new_cstr(cstr));\n        cstr[1] ++;\n      }\nSRC\n  end\nend\n\n\n$bar = \"\"\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\n</code></pre>\n"}, {"tags": ["android", "c++", "c", "android-ndk"], "comments": [{"owner": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "edited": false, "score": 0, "creation_date": 1508296545, "post_id": 46801979, "comment_id": 80551184, "body": "what other toolchain are you trying to use?"}, {"owner": {"reputation": 55, "user_id": 3932117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/278055152639c91835f69fcd51962fea?s=128&d=identicon&r=PG&f=1", "display_name": "sami", "link": "https://stackoverflow.com/users/3932117/sami"}, "reply_to_user": {"reputation": 8889, "user_id": 3493731, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0ccfa8c5c786e748c8cf4f1d3bae9694?s=128&d=identicon&r=PG&f=1", "display_name": "MuertoExcobito", "link": "https://stackoverflow.com/users/3493731/muertoexcobito"}, "edited": false, "score": 0, "creation_date": 1508297453, "post_id": 46801979, "comment_id": 80551389, "body": "The other tool-chain is built using crosstool for ARMv7 and used for none-android apps on the device."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1508370834, "post_id": 46801979, "comment_id": 80589254, "body": "Why do you want to do this? It&#39;s a lot of work to do so and in the end you&#39;ll just have a subset of the NDK."}], "answers": [{"comments": [{"owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 0, "creation_date": 1508311246, "post_id": 46802395, "comment_id": 80556343, "body": "While these are all valid points, I&#39;m not sure they tell the whole story. Bionic uses the same function names (where the functions exist) as most other C libraries, so that potential problem is something the linker should fix up. You&#39;ll certainly need position-independent code (PIC) with modern Android releases, but even with the Google NDK toolchain you still have to pass command-line arguments to enable that. I&#39;m not disagreeing with you, but I suspect other things are going on as well."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "reply_to_user": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 0, "creation_date": 1508315028, "post_id": 46802395, "comment_id": 80558493, "body": "@KevinBoone sure, the manual titled <a href=\"https://www.wikihow.com/Build-an-Android-JNI-Library-with-a-non-NDK-Toolchain\" rel=\"nofollow noreferrer\"><i>How to Build an Android JNI Library with a non-NDK Toolchain and Avoid Ending in a Mental Hospital</i></a> still begs to be written. Luckily, the OP only asked &#39;why?&#39;."}], "tags": [], "owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "is_accepted": false, "score": 3, "last_activity_date": 1508315287, "last_edit_date": 1508315287, "creation_date": 1508297885, "answer_id": 46802395, "question_id": 46801979, "link": "https://stackoverflow.com/questions/46801979/why-do-we-need-to-use-android-tool-chainor-ndk-for-compiling-c-c-code-runnin/46802395#46802395", "title": "why do we need to use android tool-chain(or NDK) for compiling c/c++ code running in the context of an android app?", "body": "<p>You can use other toolchains, but it requires special care.</p>\n\n<p>Maybe a good starter would be to learn the <a href=\"https://forum.xda-developers.com/android/software/toolchain-uber-toolchains-t3527997\" rel=\"nofollow noreferrer\">UBERTC</a> and <a href=\"https://wiki.linaro.org/Platform/Android/Toolchain\" rel=\"nofollow noreferrer\">Linaro Wiki</a>. </p>\n\n<p>The main difference is that NDK compilers are tuned for bionic (Android variant of C runtime libraries). Originally, bionic was a modest subset of Linux runtime. On latest platforms, most of the gap is closed, but now there are many extensions that you probably need.</p>\n\n<p>Also, Android dynamic linker may require (depending on target platform) a set of ELF flags that are automatically delivered by NDK binutils, like PIC, id, and others.</p>\n\n<p>It is quite possible to use arm-linux toolchain to build a statically linked executable that will run on Android, but for a library that must play well on the JNI environment the effort is probably not worth it. </p>\n\n<p>Note that NDK provides tools to create a standalone toolchain, which behaves very similar to other toolchains you may be familiar with. This approach makes it easy to adopt 3<sup>rd</sup>-party libraries with sophisticated build scripts. </p>\n"}], "owner": {"reputation": 55, "user_id": 3932117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/278055152639c91835f69fcd51962fea?s=128&d=identicon&r=PG&f=1", "display_name": "sami", "link": "https://stackoverflow.com/users/3932117/sami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508315287, "creation_date": 1508294331, "question_id": 46801979, "link": "https://stackoverflow.com/questions/46801979/why-do-we-need-to-use-android-tool-chainor-ndk-for-compiling-c-c-code-runnin", "title": "why do we need to use android tool-chain(or NDK) for compiling c/c++ code running in the context of an android app?", "body": "<p>I built a library(.so)  that is being called from JNI code in some android app. The JNI code is built using NDK.</p>\n\n<p>If I build the library using android tool-chain, the library works well when called from JNI code.    </p>\n\n<p>If I build the library using another tool-chain (used on the same ARM device for none android applications), the library crashes when called from JNI code. </p>\n\n<p>why do we need to use android tool-chain (or NDK) for compiling c/c++ code running in the context of an android app? why not use other tool-chains?</p>\n"}, {"tags": ["c++", "c", "memory-management", "arduino"], "comments": [{"owner": {"reputation": 183, "user_id": 8043030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df4b2bf1c597e7f0db144b69a4a1b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Toniolli", "link": "https://stackoverflow.com/users/8043030/matheus-toniolli"}, "reply_to_user": {"reputation": 231, "user_id": 8666839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eb9B0.jpg?s=128&g=1", "display_name": "YaatSuka", "link": "https://stackoverflow.com/users/8666839/yaatsuka"}, "edited": false, "score": 0, "creation_date": 1508294564, "post_id": 46801973, "comment_id": 80550766, "body": "my_string.c_str() not work in Arduino IDE"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1508295087, "post_id": 46801973, "comment_id": 80550872, "body": "Hint: What is the value of <code>y,z</code> the first time <code>int y;     int z;     while (x &gt; 16 || y * 16 == z)</code> is executed?"}, {"owner": {"reputation": 579, "user_id": 2084219, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/0KX8g.jpg?s=128&g=1", "display_name": "Joshua Waring", "link": "https://stackoverflow.com/users/2084219/joshua-waring"}, "edited": false, "score": 0, "creation_date": 1508295105, "post_id": 46801973, "comment_id": 80550877, "body": "my_string.data() or &amp;my_string[0] which will get the pointer to the internal char array."}, {"owner": {"reputation": 183, "user_id": 8043030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df4b2bf1c597e7f0db144b69a4a1b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Toniolli", "link": "https://stackoverflow.com/users/8043030/matheus-toniolli"}, "edited": false, "score": 0, "creation_date": 1508296535, "post_id": 46801973, "comment_id": 80551179, "body": "my_string.data() or &amp;my_string[0] not work, the problem continues"}, {"owner": {"reputation": 616, "user_id": 1068537, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5m13.jpg?s=128&g=1", "display_name": "Phillip Elm", "link": "https://stackoverflow.com/users/1068537/phillip-elm"}, "edited": false, "score": 0, "creation_date": 1508297726, "post_id": 46801973, "comment_id": 80551447, "body": "Have you confirmed that this works with a normal hard-coded String object? (ie. removed the <code>while</code> logic and just tried converting a hard-coded string)"}, {"owner": {"reputation": 616, "user_id": 1068537, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5m13.jpg?s=128&g=1", "display_name": "Phillip Elm", "link": "https://stackoverflow.com/users/1068537/phillip-elm"}, "edited": false, "score": 0, "creation_date": 1508300064, "post_id": 46801973, "comment_id": 80552057, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5702931/convert-integer-decimal-to-hex-on-an-arduino\">Convert integer/decimal to hex on an Arduino?</a>"}, {"owner": {"reputation": 183, "user_id": 8043030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df4b2bf1c597e7f0db144b69a4a1b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Toniolli", "link": "https://stackoverflow.com/users/8043030/matheus-toniolli"}, "edited": false, "score": 0, "creation_date": 1508301478, "post_id": 46801973, "comment_id": 80552411, "body": "The String works perfectly returning hexadecimal value, the problem is in converting from String to char *"}, {"owner": {"reputation": 616, "user_id": 1068537, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5m13.jpg?s=128&g=1", "display_name": "Phillip Elm", "link": "https://stackoverflow.com/users/1068537/phillip-elm"}, "edited": false, "score": 0, "creation_date": 1508309863, "post_id": 46801973, "comment_id": 80555579, "body": "@MatheusToniolli - See my updated answer."}, {"owner": {"reputation": 183, "user_id": 8043030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df4b2bf1c597e7f0db144b69a4a1b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Toniolli", "link": "https://stackoverflow.com/users/8043030/matheus-toniolli"}, "edited": false, "score": 0, "creation_date": 1508346918, "post_id": 46801973, "comment_id": 80578697, "body": "Read the title of the question."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 8043030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df4b2bf1c597e7f0db144b69a4a1b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Toniolli", "link": "https://stackoverflow.com/users/8043030/matheus-toniolli"}, "edited": false, "score": 1, "creation_date": 1508346607, "post_id": 46802621, "comment_id": 80578552, "body": "My God! I know how to convert int to Hexadecimal, the problem is not that. I WANT TO CONVERT A String IN A char *."}], "tags": [], "owner": {"reputation": 616, "user_id": 1068537, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5m13.jpg?s=128&g=1", "display_name": "Phillip Elm", "link": "https://stackoverflow.com/users/1068537/phillip-elm"}, "is_accepted": true, "score": 6, "last_activity_date": 1508311440, "last_edit_date": 1508311440, "creation_date": 1508299506, "answer_id": 46802621, "question_id": 46801973, "link": "https://stackoverflow.com/questions/46801973/how-to-convert-a-string-to-a-char-in-arduino/46802621#46802621", "title": "How to convert a String to a char * in Arduino?", "body": "<p><strong>Updated: Your Question re: <code>String -&gt; char*</code> conversion:</strong></p>\n\n<p><code>String.toCharArray(char* buffer, int length)</code> wants a character array  buffer and the size of the buffer.</p>\n\n<p>Specifically - your problems here are that:</p>\n\n<ol>\n<li><code>char* c</code> is a pointer that is never initialized.</li>\n<li><code>length</code> is supposed be be the size of the buffer. The string knows how long it is.</li>\n</ol>\n\n<p>So, a better way to run this would be:</p>\n\n<pre><code>char c[20];\ns.toCharArray(c, sizeof(c));\n</code></pre>\n\n<p>Alternatively, you could initialize <code>c</code> with <code>malloc</code>, but then you'd have to <code>free</code> it later. Using the stack for things like this saves you time and keeps things simple.</p>\n\n<p>Reference: <a href=\"https://www.arduino.cc/en/Reference/StringToCharArray\" rel=\"noreferrer\">https://www.arduino.cc/en/Reference/StringToCharArray</a></p>\n\n<hr>\n\n<p><strong>The intent in your code:</strong></p>\n\n<p>This is basically a duplicate question of: <a href=\"https://stackoverflow.com/a/5703349/1068537\">https://stackoverflow.com/a/5703349/1068537</a></p>\n\n<p>See Nathan's linked answer:</p>\n\n<pre><code>// using an int and a base (hexadecimal):\nstringOne =  String(45, HEX);   \n// prints \"2d\", which is the hexadecimal version of decimal 45:\nSerial.println(stringOne);  \n</code></pre>\n\n<p>Unless this code is needed for academic purposes, you should use the mechanisms provided by the standard libraries, and not reinvent the wheel.</p>\n\n<ul>\n<li><code>String(int, HEX)</code> returns the hex value of the integer you're looking to convert</li>\n<li><code>Serial.print</code> accepts <code>String</code> as an argument</li>\n</ul>\n"}], "owner": {"reputation": 183, "user_id": 8043030, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df4b2bf1c597e7f0db144b69a4a1b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Toniolli", "link": "https://stackoverflow.com/users/8043030/matheus-toniolli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16069, "favorite_count": 1, "accepted_answer_id": 46802621, "answer_count": 1, "score": 2, "last_activity_date": 1508311440, "creation_date": 1508294242, "last_edit_date": 1508301145, "question_id": 46801973, "link": "https://stackoverflow.com/questions/46801973/how-to-convert-a-string-to-a-char-in-arduino", "title": "How to convert a String to a char * in Arduino?", "body": "<p>I'm doing a function to convert an integer into a hexadecimal char * in Arduino, but I came across the problem of not being able to convert a String to a char *. Maybe if there is a way to allocate memory dynamically for char * I do not need a class String.</p>\n\n<pre><code>char *ToCharHEX(int x)\n{\n    String s;\n    int y = 0;\n    int z = 1;\n    do\n    {\n\n        if (x &gt; 16)\n        {\n            y = (x - (x % 16)) / 16;\n            z = (x - (x % 16));\n            x = x - (x - (x % 16));\n        }\n        else\n        {\n            y = x;\n        }\n        switch (y)\n        {\n        case 0:\n            s += \"0\";\n            continue;\n        case 1:\n            s += \"1\";\n            continue;\n        case 2:\n            s += \"2\";\n            continue;\n        case 3:\n            s += \"3\";\n            continue;\n        case 4:\n            s += \"4\";\n            continue;\n        case 5:\n            s += \"5\";\n            continue;\n        case 6:\n            s += \"6\";\n            continue;\n        case 7:\n            s += \"7\";\n            continue;\n        case 8:\n            s += \"8\";\n            continue;\n        case 9:\n            s += \"9\";\n            continue;\n        case 10:\n            s += \"A\";\n            continue;\n        case 11:\n            s += \"B\";\n            continue;\n        case 12:\n            s += \"C\";\n            continue;\n        case 13:\n            s += \"D\";\n            continue;\n        case 14:\n            s += \"E\";\n            continue;\n        case 15:\n            s += \"F\";\n            continue;\n        }\n    }while (x &gt; 16 || y * 16 == z);\n    char *c;\n    s.toCharArray(c, s.length());\n    Serial.print(c);\n    return c;\n}\n</code></pre>\n\n<p>The toCharArray () function is not converting the string to a char array. Serial.print (c) is returning empty printing. I do not know what I can do.</p>\n"}, {"tags": ["c", "gcc", "binary", "hex", "notation"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1508294043, "post_id": 46801881, "comment_id": 80550641, "body": "They&#39;re not the same file. Why would you expect the checksum to be the same? <a href=\"https://en.wikipedia.org/wiki/Md5sum\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Md5sum</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1508294993, "post_id": 46801881, "comment_id": 80550851, "body": "Note the <code>0b00000100;</code> is not standard C."}, {"owner": {"reputation": 353, "user_id": 5180005, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-M32Jfxg4qh4/AAAAAAAAAAI/AAAAAAAACbM/OcEns8RbTrc/photo.jpg?sz=128", "display_name": "oxagast", "link": "https://stackoverflow.com/users/5180005/oxagast"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1508296595, "post_id": 46801881, "comment_id": 80551194, "body": "@KenWhite I didn&#39;t remember it compiled original filenames in."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 5180005, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-M32Jfxg4qh4/AAAAAAAAAAI/AAAAAAAACbM/OcEns8RbTrc/photo.jpg?sz=128", "display_name": "oxagast", "link": "https://stackoverflow.com/users/5180005/oxagast"}, "edited": false, "score": 0, "creation_date": 1508296148, "post_id": 46801982, "comment_id": 80551094, "body": "You are right, I moved the files around so that I had the different things in the same filename at a time and the md5sum comes out the same.  Thank you.  I forgot it compiles the original in."}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": true, "score": 1, "last_activity_date": 1508294765, "last_edit_date": 1508294765, "creation_date": 1508294347, "answer_id": 46801982, "question_id": 46801881, "link": "https://stackoverflow.com/questions/46801881/why-does-gcc-produce-different-compiled-binaries-for-programs-that-use-different/46801982#46801982", "title": "Why does gcc produce different compiled binaries for programs that use different forms of integer literals?", "body": "<p>I think that the issue has nothing to do with the integer formats and everything to do with the filenames.</p>\n\n<p>I compiled the following program twice, first using the filename <code>FIRST_PROG.c</code> and executable name <code>COMPILED_1</code> and the second time using the filename <code>SECOND_PROC.c</code> and executable name <code>COMPILED_2</code> using <code>gcc</code> with no other flags set:</p>\n\n<pre><code>int main() {\n    return 0;\n}\n</code></pre>\n\n<p>If you <code>hd</code> the contents of the generated executable, at a certain offset you see this:</p>\n\n<pre><code>00001720  66 72 61 6d 65 5f 64 75  6d 6d 79 5f 69 6e 69 74  |frame_dummy_init|\n00001730  5f 61 72 72 61 79 5f 65  6e 74 72 79 00 46 49 52  |_array_entry.FIR|\n00001740  53 54 5f 50 52 4f 47 2e  63 00 5f 5f 46 52 41 4d  |ST_PROG.c.__FRAM|\n</code></pre>\n\n<p>Notice that the name of the source file, <code>FIRST_PROG.c</code>, is embedded into the generated executable. Looking at the same location in the second file shows this:</p>\n\n<pre><code>00001720  66 72 61 6d 65 5f 64 75  6d 6d 79 5f 69 6e 69 74  |frame_dummy_init|\n00001730  5f 61 72 72 61 79 5f 65  6e 74 72 79 00 53 45 43  |_array_entry.SEC|\n00001740  4f 4e 44 5f 50 52 4f 47  2e 63 00 5f 5f 46 52 41  |OND_PROG.c.__FRA|\n</code></pre>\n\n<p>You can see <code>SECOND_PROG.c</code> is embedded into the binary as well.</p>\n\n<p>Dumping both executables with <code>objdump -s</code> doesn't show this anywhere, which matches the clean <code>diff</code> you had from your programs. However, using <code>readelf -a</code> to list the contents of the executable that's generated <em>does</em> show this:</p>\n\n<pre><code>Symbol table '.symtab' contains 66 entries:\n   Num:    Value          Size Type    Bind   Vis      Ndx Name\n     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND \n     1: 0000000000400238     0 SECTION LOCAL  DEFAULT    1 \n     2: 0000000000400254     0 SECTION LOCAL  DEFAULT    2 \n     3: 0000000000400274     0 SECTION LOCAL  DEFAULT    3 \n     4: 0000000000400298     0 SECTION LOCAL  DEFAULT    4 \n     5: 00000000004002b8     0 SECTION LOCAL  DEFAULT    5 \n     6: 0000000000400300     0 SECTION LOCAL  DEFAULT    6 \n     7: 0000000000400338     0 SECTION LOCAL  DEFAULT    7 \n     8: 0000000000400340     0 SECTION LOCAL  DEFAULT    8 \n     9: 0000000000400360     0 SECTION LOCAL  DEFAULT    9 \n    10: 0000000000400378     0 SECTION LOCAL  DEFAULT   10 \n    11: 0000000000400390     0 SECTION LOCAL  DEFAULT   11 \n    12: 00000000004003b0     0 SECTION LOCAL  DEFAULT   12 \n    13: 00000000004003d0     0 SECTION LOCAL  DEFAULT   13 \n    14: 00000000004003e0     0 SECTION LOCAL  DEFAULT   14 \n    15: 0000000000400564     0 SECTION LOCAL  DEFAULT   15 \n    16: 0000000000400570     0 SECTION LOCAL  DEFAULT   16 \n    17: 0000000000400574     0 SECTION LOCAL  DEFAULT   17 \n    18: 00000000004005a8     0 SECTION LOCAL  DEFAULT   18 \n    19: 0000000000600e10     0 SECTION LOCAL  DEFAULT   19 \n    20: 0000000000600e18     0 SECTION LOCAL  DEFAULT   20 \n    21: 0000000000600e20     0 SECTION LOCAL  DEFAULT   21 \n    22: 0000000000600e28     0 SECTION LOCAL  DEFAULT   22 \n    23: 0000000000600ff8     0 SECTION LOCAL  DEFAULT   23 \n    24: 0000000000601000     0 SECTION LOCAL  DEFAULT   24 \n    25: 0000000000601020     0 SECTION LOCAL  DEFAULT   25 \n    26: 0000000000601030     0 SECTION LOCAL  DEFAULT   26 \n    27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27 \n    28: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c\n    29: 0000000000600e20     0 OBJECT  LOCAL  DEFAULT   21 __JCR_LIST__\n    30: 0000000000400410     0 FUNC    LOCAL  DEFAULT   14 deregister_tm_clones\n    31: 0000000000400450     0 FUNC    LOCAL  DEFAULT   14 register_tm_clones\n    32: 0000000000400490     0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux\n    33: 0000000000601030     1 OBJECT  LOCAL  DEFAULT   26 completed.7585\n    34: 0000000000600e18     0 OBJECT  LOCAL  DEFAULT   20 __do_global_dtors_aux_fin\n    35: 00000000004004b0     0 FUNC    LOCAL  DEFAULT   14 frame_dummy\n    36: 0000000000600e10     0 OBJECT  LOCAL  DEFAULT   19 __frame_dummy_init_array_\n    37: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS FIRST_PROG.c\n    38: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c\n    39: 0000000000400698     0 OBJECT  LOCAL  DEFAULT   18 __FRAME_END__\n    40: 0000000000600e20     0 OBJECT  LOCAL  DEFAULT   21 __JCR_END__\n    41: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS \n    42: 0000000000600e18     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_end\n    43: 0000000000600e28     0 OBJECT  LOCAL  DEFAULT   22 _DYNAMIC\n    44: 0000000000600e10     0 NOTYPE  LOCAL  DEFAULT   19 __init_array_start\n    45: 0000000000400574     0 NOTYPE  LOCAL  DEFAULT   17 __GNU_EH_FRAME_HDR\n    46: 0000000000601000     0 OBJECT  LOCAL  DEFAULT   24 _GLOBAL_OFFSET_TABLE_\n    47: 0000000000400560     2 FUNC    GLOBAL DEFAULT   14 __libc_csu_fini\n    48: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab\n    49: 0000000000601020     0 NOTYPE  WEAK   DEFAULT   25 data_start\n    50: 0000000000601030     0 NOTYPE  GLOBAL DEFAULT   25 _edata\n    51: 0000000000400564     0 FUNC    GLOBAL DEFAULT   15 _fini\n    52: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_\n    53: 0000000000601020     0 NOTYPE  GLOBAL DEFAULT   25 __data_start\n    54: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__\n    55: 0000000000601028     0 OBJECT  GLOBAL HIDDEN    25 __dso_handle\n    56: 0000000000400570     4 OBJECT  GLOBAL DEFAULT   16 _IO_stdin_used\n    57: 00000000004004f0   101 FUNC    GLOBAL DEFAULT   14 __libc_csu_init\n    58: 0000000000601038     0 NOTYPE  GLOBAL DEFAULT   26 _end\n    59: 00000000004003e0    42 FUNC    GLOBAL DEFAULT   14 _start\n    60: 0000000000601030     0 NOTYPE  GLOBAL DEFAULT   26 __bss_start\n    61: 00000000004004d6    11 FUNC    GLOBAL DEFAULT   14 main\n    62: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses\n    63: 0000000000601030     0 OBJECT  GLOBAL HIDDEN    25 __TMC_END__\n    64: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable\n    65: 0000000000400390     0 FUNC    GLOBAL DEFAULT   11 _init\n</code></pre>\n\n<p>Notice that entry 37 contains the name of the source file. If you try <code>diff</code>ing the output of <code>readelf -a</code>, you do get some pretty helpful information:</p>\n\n<pre><code>81c81\n&lt;   [28] .shstrtab         STRTAB           0000000000000000  0000189f\n---\n&gt;   [28] .shstrtab         STRTAB           0000000000000000  000018a0\n86c86\n&lt;        0000000000000207  0000000000000000           0     0     1\n---\n&gt;        0000000000000208  0000000000000000           0     0     1\n211c211\n&lt;     37: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS FIRST_PROG.c\n---\n&gt;     37: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS SECOND_PROG.c\n258c258\n&lt;     Build ID: 2c64961288049002e34a1f14e55d6c80dd96816c\n---\n&gt;     Build ID: 5425dec81aae53bd30e85fe94659d320bb774dcc\n</code></pre>\n\n<p>It seems like many of these differences boil down to just having a different name for the source file.</p>\n\n<p>So my official answer is \"this has nothing whatsoever to do with integer literals and is purely a function of compiling files with different names.\"</p>\n"}], "owner": {"reputation": 353, "user_id": 5180005, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-M32Jfxg4qh4/AAAAAAAAAAI/AAAAAAAACbM/OcEns8RbTrc/photo.jpg?sz=128", "display_name": "oxagast", "link": "https://stackoverflow.com/users/5180005/oxagast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 1, "accepted_answer_id": 46801982, "answer_count": 1, "score": 1, "last_activity_date": 1508294898, "creation_date": 1508293365, "last_edit_date": 1508294898, "question_id": 46801881, "link": "https://stackoverflow.com/questions/46801881/why-does-gcc-produce-different-compiled-binaries-for-programs-that-use-different", "title": "Why does gcc produce different compiled binaries for programs that use different forms of integer literals?", "body": "<p>I was wondering what the difference between:</p>\n\n<pre><code>int a = 0b00000100;\nint a = 0x04;\nint a = 4;\n</code></pre>\n\n<p>When compiled with gcc.</p>\n\n<p>I seem to get a different binary when compiling with what seems to be the same number, just in different notations.  When I run objdump on it however, there doesn't seem to be any differences.  Could somebody tell me what's going on?</p>\n\n<p>This is my output:</p>\n\n<pre><code>marshall@dont.even.try.to.h4ck.me:[~]: cat testbin.c &amp;&amp; echo &amp;&amp; cat testbin2.c\n#include \"stdio.h\"\nint main () {\n  int a = 0b00000100;\n  int b = 0x05;\n  int c = 6;\n  printf(\"%d - %d - %d\\n\", a, b, c);\n  return (0);\n}\n\n#include \"stdio.h\"\nint main () {\n  int a = 4;\n  int b = 5;\n  int c = 6;\n  printf(\"%d - %d - %d\\n\", a, b, c);\n  return (0);\n}\nmarshall@dont.even.try.to.h4ck.me:[~]: gcc testbin.c -o testbin\nmarshall@dont.even.try.to.h4ck.me:[~]: gcc testbin2.c -o testbin2\nmarshall@dont.even.try.to.h4ck.me:[~]: md5sum testbin testbin2\nfd6aaa31bdf685ea9444e1edc209565e  testbin\n3a3fc241bfc2917ee29999b5befecd2a  testbin2\nmarshall@dont.even.try.to.h4ck.me:[~]: objdump -d testbin &gt; testbin.obj &amp;&amp; objdump -d testbin2 &gt; testbin2.obj\nmarshall@dont.even.try.to.h4ck.me:[~]: diff testbin.obj testbin2.obj\n2c2\n&lt; testbin:     file format elf64-x86-64\n---\n&gt; testbin2:     file format elf64-x86-64\nmarshall@dont.even.try.to.h4ck.me:[~]: gcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/6/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Debian 6.3.0-18' --with-bugurl=file:///usr/share/doc/gcc-6/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-6 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-6-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-6-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-6-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 6.3.0 20170516 (Debian 6.3.0-18)\nmarshall@dont.even.try.to.h4ck.me:[~]:\n</code></pre>\n\n<p>Notice that the executables are different, they have different hashes, but <code>objdump -d</code> doesn't show anything different.</p>\n"}, {"tags": ["c", "pass-by-reference", "dynamic-memory-allocation", "pass-by-value", "c89"], "comments": [{"owner": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "edited": false, "score": 0, "creation_date": 1508291799, "post_id": 46801653, "comment_id": 80550098, "body": "Can you update your description to include what you have so far for initialize_node and describe which part specifically you are having a problem with?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508291864, "post_id": 46801653, "comment_id": 80550117, "body": "First, <code>Node *next;</code> --&gt; <code>struct Node *next;</code>. And With this signature, you can not set an object dynamically allocated to the caller&#39;s pointer."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508292090, "post_id": 46801653, "comment_id": 80550190, "body": "Please do not repeat the same <a href=\"https://stackoverflow.com/questions/46782361/setting-the-value-in-a-struct-pas-by-value-issue-c90\">question</a>."}, {"owner": {"reputation": 1, "user_id": 7983073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d8f1f7540c2365915b3213ca592c33?s=128&d=identicon&r=PG&f=1", "display_name": "CMonster", "link": "https://stackoverflow.com/users/7983073/cmonster"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508292462, "post_id": 46801653, "comment_id": 80550265, "body": "I&#39;ve updated the question, the missing &quot;struct&quot; was a typo @BLUEPIXY"}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508292535, "post_id": 46801653, "comment_id": 80550284, "body": "What are your issues? Please show us a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. In this specific case @BLUEPIXY has clearly pinned down what your issue is."}, {"owner": {"reputation": 476, "user_id": 6824359, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GCaZl8DeEJE/AAAAAAAAAAI/AAAAAAAAAqg/JLtHx2OuQE8/photo.jpg?sz=128", "display_name": "krpra", "link": "https://stackoverflow.com/users/6824359/krpra"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1508458416, "post_id": 46801653, "comment_id": 80629062, "body": "@BLUEPIXY my bad"}], "owner": {"reputation": 1, "user_id": 7983073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d8f1f7540c2365915b3213ca592c33?s=128&d=identicon&r=PG&f=1", "display_name": "CMonster", "link": "https://stackoverflow.com/users/7983073/cmonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1508292198, "answer_count": 0, "score": 0, "last_activity_date": 1508292354, "creation_date": 1508291525, "last_edit_date": 1508292354, "question_id": 46801653, "link": "https://stackoverflow.com/questions/46801653/dynamic-allocation-pass-by-value-c90", "closed_reason": "Duplicate", "title": "Dynamic allocation pass by value (C90)", "body": "<p>I have the following struct I would like to initialize:</p>\n\n<pre><code>typedef struct Node {\nstruct Node *next;\nint data;\n}Node;\n</code></pre>\n\n<p>And the following function prototype I need to use to initialize it(using dynamic memory allocation):</p>\n\n<pre><code>void initialize_node(Node *in){\n in= calloc(1, sizeof(Node));\n}\n</code></pre>\n\n<p>After the function call ends, in is still not initialized. How do i fix this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1508290551, "post_id": 46801507, "comment_id": 80549849, "body": "Remove the <code>i--</code> in the first loop.  <code>i</code> is the index of the next element, i.e. it&#39;s the number of elements already entered.  You don&#39;t want to subtract 1 from it."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1508290584, "post_id": 46801507, "comment_id": 80549857, "body": "<code>i</code> is the last index you successfully <code>scanf</code> into so the loop should be <code>for (j = 0; j &lt;= i; j++) {</code> Also, a better way to check for success from <code>scanf</code> is to check its return value."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1508291065, "post_id": 46801507, "comment_id": 80549942, "body": "@JohnnyMopp No, <code>i</code> needs to be the number of elements, not the index of the last element.  It&#39;s not only clearer, but it&#39;s needed for the mean.  The loop is fine.  OP just needs to delete the decrement of <code>i</code> in the first loop."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1508291868, "post_id": 46801507, "comment_id": 80550118, "body": "As @klutt points out, it&#39;s not safe to assume anything about the contents of <code>arr[i]</code> if <code>scanf</code> doesn&#39;t parse a <code>float</code>.  Instead, you need to check the return value from <code>scanf</code>, which is the number of items successfully matched.  Exit the loop when it&#39;s zero."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 1, "last_activity_date": 1508293863, "last_edit_date": 1508293863, "creation_date": 1508291342, "answer_id": 46801640, "question_id": 46801507, "link": "https://stackoverflow.com/questions/46801507/program-in-c-that-takes-an-array-and-prints-out-and-then-finds-its-mean-max-and/46801640#46801640", "title": "Program in c that takes an array and prints out and then finds its mean max and min. Not working properly", "body": "<p><code>scanf</code> does not work the way you think. Use this:</p>\n\n<pre><code>for(i=0;i&lt;20;i++) {\n    if(scanf(\"%f\", &amp;arr[i]) != 1)     \n        break;\n}\n</code></pre>\n\n<p>From documentation:</p>\n\n<blockquote>\n  <p>On success, the function returns the number of items of the argument list successfully filled.</p>\n</blockquote>\n\n<p>So if it returns 0, it did not successfully read a float, which is to be expected when you enter a character instead.</p>\n"}], "owner": {"reputation": 13, "user_id": 8793087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3c9a724ddaf435312e280c2add9e11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Medina", "link": "https://stackoverflow.com/users/8793087/miguel-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 46801640, "answer_count": 1, "score": 1, "last_activity_date": 1508297082, "creation_date": 1508290239, "last_edit_date": 1508293756, "question_id": 46801507, "link": "https://stackoverflow.com/questions/46801507/program-in-c-that-takes-an-array-and-prints-out-and-then-finds-its-mean-max-and", "title": "Program in c that takes an array and prints out and then finds its mean max and min. Not working properly", "body": "<p>The program below is supposed to output </p>\n\n<pre><code>$ ./a.out  \nEnter real numbers, up to 20, q to quit  \n10 37 15 21 18 q  \nYou entered the following values:  \n10.0 37.0 15.0 21.0 18.0  \nThe values have mean 20.2, max 37.0, and min 10.0  \n$ ./a.out  \nEnter real numbers, up to 20, q to quit  \nq  \nNo valid numbers entered  \n$ ./a.out  \nEnter real numbers, up to 20, q to quit  \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  \nYou entered the following values:  \n1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0  \n15.0 16.0 17.0 18.0 19.0 20.0  \nThe values have mean 10.5, max 20.0, and min 1.0\n</code></pre>\n\n<p>When i run my code i get </p>\n\n<pre><code>$ ./a.out  \nEnter real numbers, up to 20, q to quit  \n10 37 15 21 18 q  \nYou entered the following values:  \n10.0 37.0 15.0 21.0   \nThe values have mean 20.8, max 37.0, and min 10.0\n</code></pre>\n\n<p>so the code cuts a number out.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (){\n\n    float arr[20];\n    int i,j;\n    float mean, min,max,sum=0;\n\n    printf(\"Enter real numbers, upto 20, q to quit : \");\n    for(i=0;i&lt;20;i++){\n        scanf(\"%f\",&amp;arr[i]);\n            if(arr[i]==0){\n                    i--;\n            break;\n        }\n    }\n\n    if(i&gt;0){\n        printf(\"You entered the following values : \\n\");\n\n        for(j=0;j&lt;i;j++){\n            printf(\"%.1f \",arr[j]);//to print values upto 1 decimal\n        }\n\n        //finding mean = sum of numbers /no.of numbers\n        for(j=0;j&lt;i;j++){\n                sum = sum + arr[j];\n        }\n\n        mean = sum/i;//finding min and max :\n        min = arr[0];\n        max = arr[0];\n\n        for(j=1;j&lt;i;j++){\n            if(arr[j]&gt;max){\n                max = arr[j];\n            }\n\n            if(arr[j]&lt;min){\n                min = arr[j];\n            }\n        }\n        printf(\"\\n The values have mean %.1f, max %.1f, and min %.1f\",\n               mean,max,min);\n    }\n    else\n        printf(\"\\nNo valid numbers entered\");\n}\n</code></pre>\n"}, {"tags": ["c", "list", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1508290106, "post_id": 46801473, "comment_id": 80549748, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1508290376, "post_id": 46801473, "comment_id": 80549814, "body": "Suppose there is only one node in your list.  Then this is guaranteed to fail (hint:  how can <code>current-&gt;next-&gt;next</code> possibly work if <code>current-&gt;next</code> is <code>NULL</code>?)"}, {"owner": {"reputation": 358, "user_id": 7105409, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cTCYnuGzn1M/AAAAAAAAAAI/AAAAAAAAAw8/mNUReftTmbs/photo.jpg?sz=128", "display_name": "Eliad Cohen", "link": "https://stackoverflow.com/users/7105409/eliad-cohen"}, "edited": false, "score": 0, "creation_date": 1508312044, "post_id": 46801473, "comment_id": 80556753, "body": "You have several issues in the code, the <code>i</code> parameter need to be increment, you need to think about the next 4 scenarios: empty list, 1 node list, the node to delete is the last one, the node to delete is not the first and not the last"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7702177, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c-CODoWuRHo/AAAAAAAAAAI/AAAAAAAAAAo/CHJQIHDEt2c/photo.jpg?sz=128", "display_name": "Jerry", "link": "https://stackoverflow.com/users/7702177/jerry"}, "reply_to_user": {"reputation": 358, "user_id": 7105409, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cTCYnuGzn1M/AAAAAAAAAAI/AAAAAAAAAw8/mNUReftTmbs/photo.jpg?sz=128", "display_name": "Eliad Cohen", "link": "https://stackoverflow.com/users/7105409/eliad-cohen"}, "edited": false, "score": 0, "creation_date": 1508312684, "post_id": 46802999, "comment_id": 80557139, "body": "Yes, some edge cases need to be considered as well while I just simply point out the main issue"}], "tags": [], "owner": {"reputation": 3, "user_id": 7702177, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c-CODoWuRHo/AAAAAAAAAAI/AAAAAAAAAAo/CHJQIHDEt2c/photo.jpg?sz=128", "display_name": "Jerry", "link": "https://stackoverflow.com/users/7702177/jerry"}, "is_accepted": false, "score": 0, "last_activity_date": 1508320206, "last_edit_date": 1508320206, "creation_date": 1508302039, "answer_id": 46802999, "question_id": 46801473, "link": "https://stackoverflow.com/questions/46801473/deleting-a-certain-node-in-a-linked-list-c-programming/46802999#46802999", "title": "Deleting a certain node in a linked list C programming", "body": "<p>First, <code>i</code> and <code>n</code> neither are updated in the loop, so it will keep on moving to the next node and hence end up with a segmentation fault.</p>\n\n<p>You may try to change the original loop:</p>\n\n<pre><code>while (i &lt; n-1) {\n    current = current-&gt;next;    //node before deleted node.\n}\n</code></pre>\n\n<p>to the following:</p>\n\n<pre><code>while (i &lt; n-1) {\n    current = current-&gt;next;    //node before deleted node.\n    i++;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8520237, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/80dea88498ff2a23e2d10065321a1184?s=128&d=identicon&r=PG&f=1", "display_name": "lkal", "link": "https://stackoverflow.com/users/8520237/lkal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508320206, "creation_date": 1508289962, "last_edit_date": 1508318733, "question_id": 46801473, "link": "https://stackoverflow.com/questions/46801473/deleting-a-certain-node-in-a-linked-list-c-programming", "title": "Deleting a certain node in a linked list C programming", "body": "<p>I keep getting segmentation fault in my code but I don't know why. <code>int n</code> is the node that I will delete. so <code>listDeleteNth(new, 2)</code> would delete the 3 in the sequence.</p>\n\n<p>1->2->3->4</p>\n\n<p>1->2->4</p>\n\n<pre><code>typedef struct _node *Node;    \ntypedef struct _list *List;    \n\ntypedef struct _list {\n    Node head; \n} list;\n\ntypedef struct _node {\n    int value;\n    Node next;  \n} node;\n\nvoid listDeleteNth (List l, int n) {\n    Node current = l-&gt;head;\n\n    int i = 0;\n    while (i &lt; n-1) {\n        current = current-&gt;next;    //node before deleted node.\n    }\n    Node temp = current-&gt;next;      //make temp the one to be deleted.\n\n    if (current-&gt;next-&gt;next == NULL) {\n        printf(\"you deleted the last node!\\n\"); //check if dlting lastnode\n    } else {\n        current-&gt;next = current-&gt;next-&gt;next;    //connect prev to after\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c", "python-2.7", "cpython"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1508282431, "post_id": 46800479, "comment_id": 80548015, "body": "You&#39;re <i>absolutely nowhere</i> linking in the object file of <code>src&#47;test.c</code> into the <code>.so</code>. Add <code>src&#47;test.c</code> to the sources list."}, {"owner": {"reputation": 11, "user_id": 3459276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2df0c3281002130a7b7520a7806f714?s=128&d=identicon&r=PG&f=1", "display_name": "user3459276", "link": "https://stackoverflow.com/users/3459276/user3459276"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1508321639, "post_id": 46800479, "comment_id": 80562529, "body": "You&#39;re right, i thought that including <code>src&#47;*</code> files is enough, but no, as You said additional files should be listed in sources tuple, thanks. I added answer to my post"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1508325642, "post_id": 46800479, "comment_id": 80564896, "body": "no, you should <i>post</i> your answer as an <i>answer</i>. Then <i>accept it</i>!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1508325687, "post_id": 46800479, "comment_id": 80564929, "body": "Please read <a href=\"https://stackoverflow.com/help/self-answer\">stackoverflow.com/help/self-answer</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3459276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2df0c3281002130a7b7520a7806f714?s=128&d=identicon&r=PG&f=1", "display_name": "user3459276", "link": "https://stackoverflow.com/users/3459276/user3459276"}, "is_accepted": true, "score": 0, "last_activity_date": 1508329196, "creation_date": 1508329196, "answer_id": 46810052, "question_id": 46800479, "link": "https://stackoverflow.com/questions/46800479/custom-c-module-includes/46810052#46810052", "title": "Custom C module includes", "body": "<p>ok guys thanks <em>Antii</em> for clue as You said problem was that test.c should be included in sources tuple\nso i modified setup.py and everything works fine\nnow it look`s like this:</p>\n\n<pre><code>from setuptools import setup,Extension\n\nspam_module = Extension('spam',\n        sources = ['spammodule.c','src/test.c'],\n        include_dirs=['src/'])\n\nsetup ( name = 'Spam',\n    version = '1.0',\n    description = 'Sample module.',\n    ext_modules = [ spam_module ])\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3459276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2df0c3281002130a7b7520a7806f714?s=128&d=identicon&r=PG&f=1", "display_name": "user3459276", "link": "https://stackoverflow.com/users/3459276/user3459276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 46810052, "answer_count": 1, "score": 1, "last_activity_date": 1508329196, "creation_date": 1508281391, "last_edit_date": 1508329169, "question_id": 46800479, "link": "https://stackoverflow.com/questions/46800479/custom-c-module-includes", "title": "Custom C module includes", "body": "<p>I'm trying to build a Python module with C and stuck on an issue:</p>\n\n<p>When I include additional header file( <code>test.h</code>), module compile with no warnings, but later on <code>import</code> this module, Python complains about the undefined symbol <code>maketest</code>.</p>\n\n<p>My module structure looks like this (the module is named <code>spam</code>):</p>\n\n<pre><code>spam\\\n    \u251cspammodule.c\n    |setup.py\n    \u251c\u2500src\\\n         |\u2500\u2500 test.c\n         |\u2500\u2500 test.h\n</code></pre>\n\n<p>Content of <code>spammodule.c</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;Python.h&gt;\n#include \"test.h\"\n\nstatic PyObject * SpamError;\n\nstatic PyObject *\nspam_system(PyObject *self, PyObject *args)\n{\n    const char *command;\n    int sts;\n\n    maketest(); // &lt;---- calling function from additional file\n\n    if(!PyArg_ParseTuple(args, \"s\", &amp;command))\n        return NULL;\n\n    sts = system(command);\n    if ( sts &lt; 0 ) {\n        PyErr_SetString(SpamError, \"System command failed\");\n        return NULL;\n    }\n    return PyLong_FromLong(sts);\n}\n\nPyMODINIT_FUNC\ninitspam(void)\n{\n    PyObject *m;\n    static PyMethodDef SpamMethods[] = {\n        {\"system\", spam_system, METH_VARARGS, \"Execute a shell command.\"},\n        {NULL, NULL, 0, NULL}\n    };\n    m = Py_InitModule(\"spam\", SpamMethods);\n    if ( m == NULL )\n        return;\n\n    SpamError = PyErr_NewException(\"spam.error\", NULL, NULL);\n    Py_INCREF(SpamError);\n    PyModule_AddObject(m, \"error\", SpamError);\n}\n\nint\nmain(int argc, char *argv[])\n{\n    Py_SetProgramName(argv[0]);\n    Py_Initialize();\n    initspam();\n}\n</code></pre>\n\n<p>Contents of <code>setupy.py</code>:</p>\n\n<pre><code>from setuptools import setup,Extension\n\nspam_module = Extension('spam',\n        sources = ['spammodule.c'],\n        include_dirs=['src/'],)\n\nsetup ( name = 'Spam',\n    version = '1.0',\n    description = 'Sample module.',\n    ext_modules = [ spam_module ])\n</code></pre>\n\n<p>Contents of <code>src/test.h</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void maketest(void);\n</code></pre>\n\n<p>Contents of <code>src/test.c</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"test.h\"\n\nvoid maketest() {\n    printf(\"test passed\");\n}\n</code></pre>\n\n<p>I compile everything with <code>python setup.py build</code>, after running Python prompt I try to import my module and get the error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Python 2.7.10 (default, Oct 14 2015, 16:09:02)\n[GCC 5.2.1 20151010] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; import spam\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nImportError: ./spam.so: undefined symbol: maketest\n</code></pre>\n\n<p>Does someone have a clue what's going on?</p>\n"}, {"tags": ["c", "emacs", "cygwin", "posix", "newlib"], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1508280416, "creation_date": 1508280416, "question_id": 46800342, "link": "https://stackoverflow.com/questions/46800342/error-unknown-type-name-pthread-attr-t-in-signal-h", "title": "Error: unknown type name \u2018pthread_attr_t\u2019 in signal.h", "body": "<p>I'm trying to build Emacs on Cygwin. Cygwin is the latest and fully patched. I use the platform as a test bed because of Newlib. Emacs is failing with:</p>\n\n<pre><code>gcc -DHAVE_CONFIG_H -I. -I../lib -I../src -I../src\n-I/usr/local/include -DNDEBUG -pthread -D_XOPEN_SOURCE=600    -m64 -MT\nclose-stream.o -MD -MP -MF .deps/close-stream.Tpo -c -o close-stream.o\nclose-stream.c\nIn file included from /usr/include/sys/signal.h:22:0,\n                 from /usr/include/signal.h:6,\n                 from ./signal.h:52,\n                 from ./sys/select.h:107,\n                 from /usr/include/sys/time.h:47,\n                 from ./sys/time.h:39,\n                 from ./sys/select.h:86,\n                 from /usr/include/sys/types.h:68,\n                 from ./sys/types.h:28,\n                 from ./fcntl.h:50,\n                 from binary-io.h:23,\n                 from binary-io.c:3:\n/usr/include/cygwin/signal.h:175:3: error: unknown type name \u2018pthread_attr_t\u2019\n   pthread_attr_t *sigev_notify_attributes; /* notification attributes */\n   ^~~~~~~~~~~~~~\n</code></pre>\n\n<p>Examining <code>/usr/include/cygwin/signal.h</code> around 175, I see:</p>\n\n<pre><code>typedef struct sigevent\n{\n  sigval_t sigev_value;                 /* signal value */\n  int sigev_signo;                      /* signal number */\n  int sigev_notify;                     /* notification type */\n  void (*sigev_notify_function) (sigval_t); /* notification function */\n  pthread_attr_t *sigev_notify_attributes; /* notification attributes */\n} sigevent_t;\n</code></pre>\n\n<p>But I don't see an include for the pthread gear in the <code>signal.h</code> header file. I believe the header should be either <code>&lt;sys/types.h&gt;</code> or <code>&lt;pthread.h&gt;</code>.</p>\n\n<p>If I am parsing Open Group's <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/xsh_chap02_02.html\" rel=\"nofollow noreferrer\">2.2.1 POSIX.1 Symbols</a>\nand <a href=\"https://cygwin.com/ml/cygwin/2006-01/msg00642.html\" rel=\"nofollow noreferrer\">Define _POSIX_SOURCE in cygwin's features.h?</a> correctly, it should be sufficient to define <code>_XOPEN_SOURCE</code> to <code>600</code>. From the section <em>\"The _XOPEN_SOURCE Feature Test Macro\"</em> in the Open Group docs:</p>\n\n<blockquote>\n  <p>Since this volume of IEEE Std 1003.1-2001 is aligned with the ISO C\n  standard, and since all functionality enabled by _POSIX_C_SOURCE set\n  equal to 200112L is enabled by _XOPEN_SOURCE set equal to 600, there\n  should be no need to define _POSIX_C_SOURCE if _XOPEN_SOURCE is so\n  defined. Therefore, if _XOPEN_SOURCE is set equal to 600 and\n  _POSIX_C_SOURCE is set equal to 200112L, the behavior is the same as\n  if only _XOPEN_SOURCE is defined and set equal to 600...</p>\n</blockquote>\n\n<p>I found one past message that's similar at <a href=\"https://cygwin.com/ml/cygwin/2016-06/msg00458.html\" rel=\"nofollow noreferrer\">Errors when compiling gnutls-3.3.17 with gcc-5.4.0</a>, but its reported as an upstream bug and it appears its fixed. I don't think it applies here since the pthread data structure is used without an apparent declaration or definition.</p>\n\n<p>Can anyone confirm things are (not?) working as expected? If things\nare working as expected, then hints to work around the failure would\nbe appreciated.</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1508280490, "post_id": 46800325, "comment_id": 80547544, "body": "Google &quot;inter-process communication&quot; also read <a href=\"https://stackoverflow.com/tour\">tour</a> then <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> then <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> .  As written this question is not answerable -- OS?  &quot;terminal&quot;?  access to shared storage, memory?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1508280569, "post_id": 46800325, "comment_id": 80547562, "body": "I agree with Dave. The question is a very interesting one, but in it&#39;s present state it does not fit here. That&#39;s why I&#39;m flagging it for removal."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1508280574, "post_id": 46800325, "comment_id": 80547563, "body": "This is far too broad to answer. There are many ways to do what you want but we can&#39;t tell which is best in your case. Off the top of my head: use a database or use a shared memory segment."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1508280710, "post_id": 46800325, "comment_id": 80547600, "body": "Simplest way to do it is to store the value in a file and read it from the file whenever it&#39;s needed. Of course you need to solve the problems if both instances writes at the same time and such."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1508288383, "post_id": 46800325, "comment_id": 80549379, "body": "@klutt it depends on definition of a &#39;terminal&#39;. Might need sockets :-)"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1508288742, "post_id": 46800325, "comment_id": 80549451, "body": "@Serge True enough. As already stated, the question is far to broad."}, {"owner": {"reputation": 29, "user_id": 6837885, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10210934373343611/picture?type=large", "display_name": "Humberto Atondo", "link": "https://stackoverflow.com/users/6837885/humberto-atondo"}, "edited": false, "score": 0, "creation_date": 1508293601, "post_id": 46800325, "comment_id": 80550545, "body": "With terminal I refer to the command line window"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 8632813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/82cd430c4b8dbd99e4e57f4b216f082e?s=128&d=identicon&r=PG&f=1", "display_name": "Clerisse Lucas", "link": "https://stackoverflow.com/users/8632813/clerisse-lucas"}, "is_accepted": false, "score": 0, "last_activity_date": 1508324085, "creation_date": 1508324085, "answer_id": 46808544, "question_id": 46800325, "link": "https://stackoverflow.com/questions/46800325/how-can-i-make-a-c-program-run-it-in-2-terminals-and-change-a-shared-variable-s/46808544#46808544", "title": "How can I make a C program, run it in 2 terminals and change a shared variable simultaneously?", "body": "<h2>A fun solution (Only on Linux)</h2>\n\n<p>Using process signals ! On a Linux system you have some process signals which are called User Signals. </p>\n\n<p>Here is what you need to acomplish that : </p>\n\n<ol>\n<li>A function to translate an <strong>integrer to a binary sequence</strong>.</li>\n<li>A function to translate a <strong>binary sequence to an integrer</strong>.</li>\n<li>A function to send a binary sequence <strong>with process signals</strong> (huh).</li>\n<li>A function to read a binary sequence <strong>with process signals</strong>.</li>\n<li>Some basic knowledge like <strong>ping-pong</strong></li>\n</ol>\n\n<h2>Some explanations</h2>\n\n<p>Considering :</p>\n\n<ul>\n<li>85 (Random number) : The number used to tell the other process the number \n                    changed. The other process will wait for the new \n                    integrer binary sequence.</li>\n</ul>\n\n<p>Here is the process :</p>\n\n<ol>\n<li>Give to the process B <strong>the pid of the process A</strong> (This is done by \n<strong>user-input</strong>)</li>\n<li>process B : Detected integrer changed</li>\n<li>process B : Convert 85 to a <strong>binary sequence</strong> -> \"1010101\"  </li>\n<li>Process B : Send it to the process A</li>\n</ol>\n\n<p>Lets explain that using a sample of pseudo-code :</p>\n\n<pre><code>/* Lets stay simple, we will consider you are storing your\n   binary sequence in a char[20] for example */\n\n   int main(void) {\n     sendToProcess(PID, 12);\n   }\n\n   void sendBinarySequence(sequence, PID) {\n     loop through sequence {\n        /* The best way here is to always send 4 bytes, increment a value so \n           the process A don't have to tell you when the sending is done \n        */\n        if (bit == 1)\n          kill(PID, SIGUSR1);\n        else if (but == 0)\n          kill(PID, SIGUSR2); \n       /* Wait for the signal of the process A, we are using ping-pong \n       */\n     }\n   }\n\n   void sendToProcess(PID, NB_TO_SEND) {\n     // Send 85 to the process\n     char binary[20];\n\n     convertNbToBinary(&amp;binary[0], 85); /* This is the first integrer we \n     will send, then the process A will know we will send integrer. */\n     sendBinarySequence(binary, PID);\n   }\n</code></pre>\n\n<ol start=\"5\">\n<li>For both process (you want them to communicate) we will handle signal using\n<a href=\"http://man7.org/linux/man-pages/man2/signal.2.html\" rel=\"nofollow noreferrer\">signal()</a>, knowing you can handle received signals. Lets build a \nfunction which handle SIG_USR1 and SIG_USR2 signals, <strong>when the process\nreceive a SIG_URS1, add 1 to our binary sequence and 0 when we receive \nSIG_USR2</strong>. Yayyy, now the process A have the sequence you've send.</li>\n<li>Just convert your binary sequence to an integrer and replace his value.</li>\n</ol>\n\n<h1>An easy solution (Linux/Windows)</h1>\n\n<p>Use a file... When process A change write it to file.txt, at X frequency the process B check the file, if its different, change the value of his integrer.</p>\n"}], "owner": {"reputation": 29, "user_id": 6837885, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10210934373343611/picture?type=large", "display_name": "Humberto Atondo", "link": "https://stackoverflow.com/users/6837885/humberto-atondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508324085, "creation_date": 1508280331, "question_id": 46800325, "link": "https://stackoverflow.com/questions/46800325/how-can-i-make-a-c-program-run-it-in-2-terminals-and-change-a-shared-variable-s", "title": "How can I make a C program, run it in 2 terminals and change a shared variable simultaneously?", "body": "<p>I need to make a C program that is able to run simultaneously in two different terminals and modify a variable. If the variable is modified in one running program, for example to 4, then the variable should change to 4 in the other running program. I am guessing that this should be done with multiple processes but i can't figure out how to code it. I will appreciate any help.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 231, "user_id": 8666839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eb9B0.jpg?s=128&g=1", "display_name": "YaatSuka", "link": "https://stackoverflow.com/users/8666839/yaatsuka"}, "edited": false, "score": 2, "creation_date": 1508280707, "post_id": 46800322, "comment_id": 80547598, "body": "For the date, look at <code>fstat()</code> function"}, {"owner": {"reputation": 11, "user_id": 6445483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5904510c861f622999cd7f349d9fc3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Shuta", "link": "https://stackoverflow.com/users/6445483/shuta"}, "reply_to_user": {"reputation": 231, "user_id": 8666839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eb9B0.jpg?s=128&g=1", "display_name": "YaatSuka", "link": "https://stackoverflow.com/users/8666839/yaatsuka"}, "edited": false, "score": 0, "creation_date": 1508417367, "post_id": 46800322, "comment_id": 80607808, "body": "Thank you for this, I&#39;ll check it.  Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6445483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5904510c861f622999cd7f349d9fc3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Shuta", "link": "https://stackoverflow.com/users/6445483/shuta"}, "edited": false, "score": 0, "creation_date": 1508417397, "post_id": 46801381, "comment_id": 80607827, "body": "Is it possible only on visual studio?"}], "tags": [], "owner": {"reputation": 16, "user_id": 3424640, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001758491152/picture?type=large", "display_name": "isdsi", "link": "https://stackoverflow.com/users/3424640/isdsi"}, "is_accepted": false, "score": 0, "last_activity_date": 1508289242, "creation_date": 1508289242, "answer_id": 46801381, "question_id": 46800322, "link": "https://stackoverflow.com/questions/46800322/file-reading-and-printing-then-sort-by-added-date/46801381#46801381", "title": "File reading and printing then sort by added date", "body": "<ol>\n<li><p>you can get the file names. Refer to this, <a href=\"https://msdn.microsoft.com/en-us/library/kda16keh.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/kda16keh.aspx</a></p></li>\n<li><p>sort the string array.</p></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 6445483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5904510c861f622999cd7f349d9fc3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Shuta", "link": "https://stackoverflow.com/users/6445483/shuta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508289242, "creation_date": 1508280316, "question_id": 46800322, "link": "https://stackoverflow.com/questions/46800322/file-reading-and-printing-then-sort-by-added-date", "title": "File reading and printing then sort by added date", "body": "<p>I want to make program that read file name in current directory and sort file name by added date in C programming.\nI learned how to print file name by using DIR.\nBut I can't find any answer how to sort file name from it.(DIR) </p>\n\n<p>Could you please teach me how to solve?</p>\n\n<p>Best regards,</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1508282296, "post_id": 46800257, "comment_id": 80547982, "body": "What do you mean by &quot;call a class&quot;?"}, {"owner": {"reputation": 1, "user_id": 6599287, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-a7ILqgUF1jA/AAAAAAAAAAI/AAAAAAAAAPI/ho00paZfsRM/photo.jpg?sz=128", "display_name": "WateR", "link": "https://stackoverflow.com/users/6599287/water"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1508283422, "post_id": 46800257, "comment_id": 80548245, "body": "@duskwuff If I put something like class Start(): inside the main module within the pyd and then some code it will work. I also will have to put <code>import Python</code> (my pyd) then after that <code>Start()</code> in start.py. It won&#39;t import anything within the start class."}], "owner": {"reputation": 1, "user_id": 6599287, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-a7ILqgUF1jA/AAAAAAAAAAI/AAAAAAAAAPI/ho00paZfsRM/photo.jpg?sz=128", "display_name": "WateR", "link": "https://stackoverflow.com/users/6599287/water"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508279787, "creation_date": 1508279787, "question_id": 46800257, "link": "https://stackoverflow.com/questions/46800257/opening-a-shared-library", "title": "Opening a Shared Library", "body": "<p>I made a Shared Library for Python (.PYD). Nothing is wrong with the file but when I import it from my start.py nothing happens. No errors, nothing. Is there anyway to call a class without rewriting the entire code of the file? Or is there a way to call a class that imports the file? There isn't a class inside base.py. </p>\n\n<p>Start.py</p>\n\n<pre><code>import dw.base\n</code></pre>\n"}]