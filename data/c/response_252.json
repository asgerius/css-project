[{"tags": ["c", "pointers", "struct", "dynamic-arrays", "pgm"], "comments": [{"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1573084072, "post_id": 58739935, "comment_id": 103769955, "body": "The <code>max_value</code> (by current specification) must be &lt; 65536, so your <code>pixels</code> need only be either 8-bit or 16-bit integers.  If space is an issue, you may want to change that.  It&#39;s always a toss-up whether to allocate a 2D array, or just a 1D array, and use the <code>width</code> to traverse it.  But typically I use a 1D array + known-width if I can - it just makes the code simpler.  For example, this allows the code to just <code>fread()</code> and <code>fwrite()</code> of the whole pixel-data block (assuming exact size pixel-storage)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573084272, "post_id": 58739935, "comment_id": 103770000, "body": "Huh? <code>&quot;P2&quot; (plain format)</code>? See <a href=\"http://netpbm.sourceforge.net/doc/pgm.html\" rel=\"nofollow noreferrer\">pgm</a>. What makes you think <code>fscanf(inFile, &quot;%s&quot;, PGMcheck);</code> will read only 2-characters? There are a large number of similar errors. Further, you can&#39;t compare strings with equality operators (e.g. you can&#39;t <code>PGMcheck != &quot;P2&quot;</code>)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1573084712, "post_id": 58739935, "comment_id": 103770084, "body": "Is there a reason you can&#39;t use the official NetPBM libraries for reading and writing these files?  Those libraries are quite easy to use."}], "answers": [{"tags": [], "owner": {"reputation": 2507, "user_id": 769097, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ee769c59ea4469d8251105086b4b6cee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/769097/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1573088186, "creation_date": 1573088186, "answer_id": 58740499, "question_id": 58739935, "link": "https://stackoverflow.com/questions/58739935/reading-a-pgm-file-using-structures/58740499#58740499", "title": "Reading a PGM file using structures", "body": "<p>I don't know PGM specification, but you have three common mistakes that can make your code misbehave when compiled on platform distinct than yours:</p>\n\n<ol>\n<li><p>Endianess. You have to precisely define it for your data format.\nIn your case ints are likely little-endian, you have to account for that when porting your code to big-endian platform.\nSee also <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Endianness</a></p></li>\n<li><p>Structure packing. Depending on the platform, compiler can pad fields in structs for faster access. You likely want to use construct like pragma pack for your structs, otherwise, again, your code might have issues with the other compiler (even assuming the same platform).\nSee also <a href=\"http://www.catb.org/esr/structure-packing/#_structure_alignment_and_padding\" rel=\"nofollow noreferrer\">http://www.catb.org/esr/structure-packing/#_structure_alignment_and_padding</a></p></li>\n<li><p>Use fixed width types. E.g. use int64_t instead of long, etc.\nSee also <a href=\"https://en.wikipedia.org/wiki/C_data_types#Fixed-width_integer_types\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/C_data_types#Fixed-width_integer_types</a></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1573092000, "creation_date": 1573092000, "answer_id": 58740911, "question_id": 58739935, "link": "https://stackoverflow.com/questions/58739935/reading-a-pgm-file-using-structures/58740911#58740911", "title": "Reading a PGM file using structures", "body": "<p>Continuing from my earlier comment, you have several problems that have to do with handling the <a href=\"http://netpbm.sourceforge.net/doc/pgm.html\" rel=\"nofollow noreferrer\">Plain PGM File Format</a> that will prevent your successful read of the file.</p>\n\n<p>First, <code>fgets(PGMcheck, sizeof(PGMcheck), inFile);</code> is not guaranteed to read <code>PGMcheck</code> correctly. The <em>magic-number</em> may be followed by <code>\"(blanks, TABs, CRs, LFs)\"</code> so <code>fgets</code> will read more than just the <em>magic-number</em> unless it is followed by a single <code>'\\n'</code> -- not guaranteed by the format. While <code>fgets()</code> is generally the correct way to do line-oriented input, the PGM format isn't guaranteed to be formatted in lines, so you are left using a <em>formatted-input</em> function, or a character-by-character approach. </p>\n\n<p>(you can use <code>fgets()</code>, but that would require parsing the resulting buffer and saving whatever part of the buffer extended beyond the <em>magic-number</em> to include as the beginning part of your next read)</p>\n\n<p>You have corrected your attempt at the string comparison using <code>!=</code> instead of <code>strcmp</code>, but you still must compare the <em>magic-number</em> with <code>\"P2\"</code> for reading a Plain-PGM format file (as your question included originally) Go ahead and read the <em>magic-number</em> into a string, but use a formatted-input function (<code>fscanf</code>) to read only up until the first whitespace is encountered, regardless of what that whitespace is.</p>\n\n<p>Lastly, there is no need to store the <em>magic-number</em> as part of the <code>plain_pgm</code> struct. That is something your <em>validate</em> before you attempt to fill the struct. It either is <code>\"P2\"</code> or it isn't -- no need to store it.</p>\n\n<p>For portability, it is a good idea to use <em>exact-width</em> types for storage when reading image files. There are a number of benefits, but the primary being, your program will behave correctly whether run on your x86_64 or on your TI-MSP432 chip. The exact width types are defined in <code>stdint.h</code> and the macros from printing and reading the exact width types are provided in <code>inttypes.h</code>. Instead of <code>char</code> you have <code>int8_t</code>, instead of <code>unsigned char</code> you have <code>uint8_t</code>, and so on, where the numeric value specifies the exact number of bytes for the type.</p>\n\n<p>With that your pgm struct could look like:</p>\n\n<pre><code>typedef struct {            /* struct for plain pgm image */\n    uint32_t w, h;          /* use exact width types for portable code */\n    uint16_t max;           /* 16-bit max */\n    uint16_t **pixels;      /* pointer-to-pointer for pixel values */\n} plain_pgm;\n</code></pre>\n\n<p>Your allocation is largely correct, but rearranging to return a <em>pointer-to-pointer-to</em> <code>uint16_t</code> (adequate for the <code>maximum gray value</code> pixel values), you could do:</p>\n\n<pre><code>uint16_t **alloc_pgm_pixels (uint32_t w, uint32_t h)\n{\n    uint16_t **pixels = NULL;\n\n    /* allocate/validate height number of pointers */\n    if (!(pixels = malloc (h * sizeof *pixels))) {\n        perror (\"malloc-pixels\");\n        return NULL;\n    }\n    /* allocate/validate width number of values per-pointer */\n    for (uint32_t i = 0; i &lt; h; i++)\n        if (!(pixels[i] = malloc (w * sizeof *pixels[i]))) {\n            perror (\"malloc-pixels[i]\");\n            return NULL;\n        }\n\n    return pixels;  /* return allocated pointers &amp; storage */\n}\n</code></pre>\n\n<p>Your read function needs lots of help. First, you generally want to open and validate the file is open for reading in the calling function and pass the open <code>FILE *</code> pointer as a parameter to your read function rather than the filename. (if the file cannot be opened in the caller, there is no need to make the function call to begin with). With that change and passing a pointer to your struct, your read function could look like:</p>\n\n<pre><code>int read_pgm (FILE *fp, plain_pgm *pgm)\n{\n    char buf[RDBUF];            /* buffer for magic number */\n    uint32_t h = 0, w = 0;      /* height/width counters */\n\n    if (fscanf (fp, \"%s\", buf) != 1) {  /* read magic number */\n        fputs (\"error: invalid format - magic\\n\", stderr);\n        return 0;\n    }\n\n    if (strcmp (buf, MAGIC_PLN) != 0) { /* validate magic number */\n        fprintf (stderr, \"error: invalid magic number '%s'.\\n\", buf);\n        return 0;\n    }\n\n    /* read pgm width, height, max gray value */\n    if (fscanf (fp, \"%\" SCNu32 \" %\" SCNu32 \" %\" SCNu16, \n                &amp;pgm-&gt;w, &amp;pgm-&gt;h, &amp;pgm-&gt;max) != 3) {\n        fputs (\"error: invalid format, h, w, max or included comments.\\n\",\n                stderr);\n        return 0;\n    }\n\n    /* validate allocation of pointers and storage for pixel values */\n    if (!(pgm-&gt;pixels = alloc_pgm_pixels (pgm-&gt;w, pgm-&gt;h)))\n        return 0;\n\n    for (;;) {  /* loop continually until image read */\n        if (fscanf (fp, \"%\" SCNu16, &amp;pgm-&gt;pixels[h][w]) != 1) {\n            fputs (\"error: stream error or short-read.\\n\", stderr);\n            return 0;\n        }\n        if (++w == pgm-&gt;w)\n            w = 0, h++;\n        if (h == pgm-&gt;h)\n            break;\n    }\n\n    return 1;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> this read function does NOT consider <em>comment lines</em>, implementing ignoring of comment lines is left to you. You could either make an additional call to <code>fscanf</code> before and between reading each part of the magic-number, width, height, and max gray value with something similar to <code>\" # %[^\\n']\"</code> to skip any number of whitespace and read up to and including the next <code>'#'</code> character and to the end of line, or just use <code>fgetc</code> in a loop searching for the next non-whitespace character and checking if it is a <code>'#'</code> and if not use <code>ungetc</code>, if so, clear to the end of line.)</p>\n\n<p>Putting it altogether in an example, you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;inttypes.h&gt;\n\n#define RDBUF       32      /* if you need a constant, #define one (or more) */\n#define MAGIC_PLN  \"P2\"\n\ntypedef struct {            /* struct for plain pgm image */\n    uint32_t w, h;          /* use exact width types for portable code */\n    uint16_t max;           /* 16-bit max */\n    uint16_t **pixels;      /* pointer-to-pointer for pixel values */\n} plain_pgm;\n\nuint16_t **alloc_pgm_pixels (uint32_t w, uint32_t h)\n{\n    uint16_t **pixels = NULL;\n\n    /* allocate/validate height number of pointers */\n    if (!(pixels = malloc (h * sizeof *pixels))) {\n        perror (\"malloc-pixels\");\n        return NULL;\n    }\n    /* allocate/validate width number of values per-pointer */\n    for (uint32_t i = 0; i &lt; h; i++)\n        if (!(pixels[i] = malloc (w * sizeof *pixels[i]))) {\n            perror (\"malloc-pixels[i]\");\n            return NULL;\n        }\n\n    return pixels;  /* return allocated pointers &amp; storage */\n}\n\nint read_pgm (FILE *fp, plain_pgm *pgm)\n{\n    char buf[RDBUF];            /* buffer for magic number */\n    uint32_t h = 0, w = 0;      /* height/width counters */\n\n    if (fscanf (fp, \"%s\", buf) != 1) {  /* read magic number */\n        fputs (\"error: invalid format - magic\\n\", stderr);\n        return 0;\n    }\n\n    if (strcmp (buf, MAGIC_PLN) != 0) { /* validate magic number */\n        fprintf (stderr, \"error: invalid magic number '%s'.\\n\", buf);\n        return 0;\n    }\n\n    /* read pgm width, height, max gray value */\n    if (fscanf (fp, \"%\" SCNu32 \" %\" SCNu32 \" %\" SCNu16, \n                &amp;pgm-&gt;w, &amp;pgm-&gt;h, &amp;pgm-&gt;max) != 3) {\n        fputs (\"error: invalid format, h, w, max or included comments.\\n\",\n                stderr);\n        return 0;\n    }\n\n    /* validate allocation of pointers and storage for pixel values */\n    if (!(pgm-&gt;pixels = alloc_pgm_pixels (pgm-&gt;w, pgm-&gt;h)))\n        return 0;\n\n    for (;;) {  /* loop continually until image read */\n        if (fscanf (fp, \"%\" SCNu16, &amp;pgm-&gt;pixels[h][w]) != 1) {\n            fputs (\"error: stream error or short-read.\\n\", stderr);\n            return 0;\n        }\n        if (++w == pgm-&gt;w)\n            w = 0, h++;\n        if (h == pgm-&gt;h)\n            break;\n    }\n\n    return 1;\n}\n\nint main (int argc, char **argv) {\n\n    plain_pgm pgm = { .w = 0 }; /* plain_pgm struct instance */\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n\n    if (!read_pgm (fp, &amp;pgm)) { /* validate/allocate/read pgm file */\n        fputs (\"error: read_pgm failed.\\n\", stderr);\n        return 1;\n    }\n    if (fp != stdin)            /* close file if not stdin */\n        fclose (fp);\n\n    /* output success */\n    printf (\"successful read of '%s'\\n%\" PRIu32 \"x%\" PRIu32 \" pixel values.\\n\",\n            argc &gt; 1 ? argv[1] : \"stdin\", pgm.w, pgm.h);\n\n    for (uint32_t i = 0; i &lt; pgm.h; i++)    /* free pixel storage */\n        free (pgm.pixels[i]);\n    free (pgm.pixels);                      /* free pointers */\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Using an example <a href=\"https://people.sc.fsu.edu/~jburkardt/data/pgma/apollonian_gasket.ascii.pgm\" rel=\"nofollow noreferrer\">apollonian_gasket.ascii.pgm, a 600 wide by 600 high image of an Apollonian gasket</a> file as a test file, you would get:</p>\n\n<pre><code>$ ./bin/read_pgm_plain dat/apollonian_gasket.ascii.pgm\nsuccessful read of 'dat/apollonian_gasket.ascii.pgm'\n600x600 pixel values.\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to ensure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/read_pgm_plain dat/apollonian_gasket.ascii.pgm\n==8086== Memcheck, a memory error detector\n==8086== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==8086== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==8086== Command: ./bin/read_pgm_plain dat/apollonian_gasket.ascii.pgm\n==8086==\nsuccessful read of 'dat/apollonian_gasket.ascii.pgm'\n600x600 pixel values.\n==8086==\n==8086== HEAP SUMMARY:\n==8086==     in use at exit: 0 bytes in 0 blocks\n==8086==   total heap usage: 604 allocs, 604 frees, 730,472 bytes allocated\n==8086==\n==8086== All heap blocks were freed -- no leaks are possible\n==8086==\n==8086== For counts of detected and suppressed errors, rerun with: -v\n==8086== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look over the changes made and if you don't understand why something wast done, drop a comment asking and I'm happy to help further.</p>\n"}], "owner": {"reputation": 25, "user_id": 12240700, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XyXm5PFc6iU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdX0GCvFDgXWns51UMEzCj5dC0SIQ/photo.jpg?sz=128", "display_name": "Stephen Carson", "link": "https://stackoverflow.com/users/12240700/stephen-carson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 1, "accepted_answer_id": 58740911, "answer_count": 2, "score": 0, "last_activity_date": 1573092000, "creation_date": 1573083434, "last_edit_date": 1573085060, "question_id": 58739935, "link": "https://stackoverflow.com/questions/58739935/reading-a-pgm-file-using-structures", "title": "Reading a PGM file using structures", "body": "<p>I am doing a project that involves writing functions to read/write and encode/decode PGM files. Im using a structure with a function to read in the PGM file. I am quite new to structures and how they are syntaxed so I am just wondering if this bit of code would correctly read in the scanned data into my structure. </p>\n\n<p>Here is my code (C):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"image.h\"\n\nint **allocatePGM(int numCols, int numRows){\n        int ** = malloc(sizeof(int *) * numRows);\n        for (int i=0; i&lt;numRows; i++)\n            pixels[i] = malloc(sizeof(int) * numCols);\n        return pixels;\n\n}\n\nImagePGM *readPGM(char *filename, ImagePGM *pImagePGM){\n    FILE *inFile = NULL\n    char PGMcheck[5];\n    int max_value = 0;\n    unsigned int width = 0, height = 0;\n    unsigned int i = 0;\n    int pixeldata = 0;\n\n\n\n\n    inFile = fopen(filename, \"r\");\n    if (inFile == NULL)\n    printf(\"File could not be opened\\n\");\n    exit(1);\n\nfgets(PGMcheck, sizeof(PGMcheck), inFile);\nif (strcmp(version, \"P5\")) {\n    fprintf(stderr, \"Wrong file type!\\n\");\n    exit(1);\n}\n    printf(\"This file does not contain the PGM indicator \\\"P2\\\"\");\n    exit(1);\n    }\n\n\n\n\n    fscanf(inFile, \"%d\", &amp;width);\n    fscanf(inFile, \"%d\", &amp;height);\n    fscanf(inFile, \"%d\", max_value);\n\n    struct ImagePGM.pImagePGM\n    pImagePGM.magic = PGMcheck;\n    pImagePGM.width = width;\n    pImagePGM.height = height;\n    pImagePGM.max_value = max_value;\n\n    pImagePGM-&gt;pixels = allocatePGM(pImagePGM-&gt;width, pImagePGM-&gt;height);\n    if (pImagePGM-&gt;max_value &gt; 255) {\n        for (i = 0; i &lt; height; ++i) {\n            for (j = 0; j &lt; width; ++j) {\n                pImagePGM-&gt;pixels[i][j];\n            }\n        }\n    }\n    return pImagePGM;\n\n}\n</code></pre>\n\n<p>My header file contains the structure as follows...</p>\n\n<pre><code>typedef struct _imagePGM {\n char magic[3]; // magic identifier, \"P2\" for PGM\n int width; // number of columns\n int height; // number of rows\n int max_value; // maximum grayscale intensity\n int **pixels; // the actual grayscale pixel data, a 2D array\n} ImagePGM;\n</code></pre>\n\n<p>Seem okay to you guys?</p>\n"}, {"tags": ["c", "fgets"], "comments": [{"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1573081659, "post_id": 58739715, "comment_id": 103769358, "body": "There are no loops in your code. Where is the infinite loop?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1573081718, "post_id": 58739715, "comment_id": 103769384, "body": "first pass a char <i>array</i> not a char. Check the warnings. note that <code>scanf(&quot;%s&quot;, &amp;a);</code> is also incorrect."}, {"owner": {"reputation": 31, "user_id": 10534537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/763337c6a6dd8c2e741bfe028e9c3f32?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Keffel", "link": "https://stackoverflow.com/users/10534537/cole-keffel"}, "edited": false, "score": 0, "creation_date": 1573082113, "post_id": 58739715, "comment_id": 103769472, "body": "My mistake I meant to delete the infinite loops comment."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1573082239, "post_id": 58739715, "comment_id": 103769505, "body": "The last parameter should be <code>stdin</code> if you want to read from standard input."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1573085313, "post_id": 58739715, "comment_id": 103770213, "body": "Use <code>fgetc</code>. A one-character buffer can only hold the terminator... So you&#39;re testing ASCII NUL with these functions"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10534537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/763337c6a6dd8c2e741bfe028e9c3f32?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Keffel", "link": "https://stackoverflow.com/users/10534537/cole-keffel"}, "edited": false, "score": 0, "creation_date": 1573083548, "post_id": 58739815, "comment_id": 103769832, "body": "This helped me solve it! Thank you, appreciate it! Initially, I set line[1], but when entering any character each function would output &#39;0&#39;, but when setting line[2] everything output correctly. Why is that?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 31, "user_id": 10534537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/763337c6a6dd8c2e741bfe028e9c3f32?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Keffel", "link": "https://stackoverflow.com/users/10534537/cole-keffel"}, "edited": false, "score": 1, "creation_date": 1573085345, "post_id": 58739815, "comment_id": 103770227, "body": "@ColeKeffel That&#39;s because <code>fgets</code> always puts a NUL terminator at the end of the string. With <code>line[1]</code> there&#39;s only room for the NUL terminator, and nothing else. <code>line[2]</code> allows <code>fgets</code> to put one character into the buffer before the NUL terminator."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1573082416, "creation_date": 1573082416, "answer_id": 58739815, "question_id": 58739715, "link": "https://stackoverflow.com/questions/58739715/scanning-white-space-with-fgets/58739815#58739815", "title": "Scanning white space with fgets()", "body": "<p>The first argument to <code>fgets()</code> needs to be a buffer that can hold the entire line of input.</p>\n\n<pre><code>int main(void) {\n  char a;\n  char line[100];\n  puts(\"Enter a character:\");\n\n  fgets(line, sizeof line, stdin);\n  a = line[0];\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10534537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/763337c6a6dd8c2e741bfe028e9c3f32?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Keffel", "link": "https://stackoverflow.com/users/10534537/cole-keffel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58739815, "answer_count": 1, "score": -2, "last_activity_date": 1573082416, "creation_date": 1573081557, "last_edit_date": 1573082142, "question_id": 58739715, "link": "https://stackoverflow.com/questions/58739715/scanning-white-space-with-fgets", "title": "Scanning white space with fgets()", "body": "<p>I'm running user input through a series of functions provided by the ctype.h library, but scanf doesn't work for white space.</p>\n\n<p>Since I can't use scanf for whitespace I believe fgets() should be what I'm looking for, but am unsure about the last parameter I would use for it. Any advice would be appreciated!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(void) {\n  char a;\n\n  puts(\"Enter a character:\");\n\n  //scanf(\"%s\", &amp;a);\n  fgets(a, 1, ??);\n\n\n  printf(\"isblank('%c')  = %d \\n\", a ,isblank(a)); \n  printf(\"isdigit('%c')  = %d \\n\", a ,isdigit(a));\n  printf(\"isalpha('%c')  = %d \\n\", a ,isalpha(a));\n  printf(\"isalnum('%c')  = %d \\n\", a ,isalnum(a));\n  printf(\"isxdigit('%c') = %d \\n\", a ,isxdigit(a));\n  printf(\"islower('%c')  = %d \\n\", a ,islower(a));\n  printf(\"isupper('%c')  = %d \\n\", a ,isupper(a));\n  printf(\"tolower('%c')  = %d \\n\", a ,tolower(a));\n  printf(\"toupper('%c')  = %d \\n\", a ,toupper(a));\n  printf(\"isspace('%c')  = %d \\n\", a ,isspace(a));\n  printf(\"iscntrl('%c')  = %d \\n\", a ,iscntrl(a));\n  printf(\"ispunct('%c')  = %d \\n\", a ,ispunct(a));\n  printf(\"isprint('%c')  = %d \\n\", a ,isprint(a));\n  printf(\"isgraph('%c')  = %d \\n\", a ,isgraph(a));\n\n  return 0;\n}\n</code></pre>\n\n<p>Output should look like this </p>\n\n<pre><code>Enter a character:\n C\nisblank('C')  = 0 \nisdigit('C')  = 0 \nisalpha('C')  = 1024 \nisalnum('C')  = 8 \nisxdigit('C') = 4096 \nislower('C')  = 0 \nisupper('C')  = 256 \ntolower('C')  = 99 \ntoupper('C')  = 67 \nisspace('C')  = 0 \niscntrl('C')  = 0 \nispunct('C')  = 0 \nisprint('C')  = 16384 \nisgraph('C')  = 32768\n</code></pre>\n\n<p>Program should intake a single character and convert it to integer through a series of functions.</p>\n"}, {"tags": ["c", "arrays", "pointers", "search", "multidimensional-array"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1573080560, "post_id": 58739549, "comment_id": 103769053, "body": "Using pointer arithmetic for multi-dimensional arrays is practically unreadable and very error-prone. Are you really not allowed to write <code>arr[j+i][k]</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1573080607, "post_id": 58739549, "comment_id": 103769066, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">dont cast malloc</a>"}, {"owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1573080723, "post_id": 58739549, "comment_id": 103769096, "body": "I can&#39;t unfortunately. I&#39;m required to use only pointer notation at my university. I probably could&#39;ve written it that way first and then translated, but I&#39;m already this far"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1573080912, "post_id": 58739549, "comment_id": 103769144, "body": "Try printing <code>*(*(arr+(j+i))+k)</code> and <code>*(*(list+listPos)+i)</code> to make sure they&#39;re what you expect."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1573085392, "post_id": 58739549, "comment_id": 103770238, "body": "I, too, would  quit that university. Brackets <i>are</i> a pointer notation"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1573080756, "post_id": 58739587, "comment_id": 103769104, "body": "Huh? Now you&#39;re multiplying <code>wordlength</code> by the expression in parentheses."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1573080860, "post_id": 58739587, "comment_id": 103769132, "body": "Maybe you mean <code>&amp;&amp; wordlength &amp;&amp; ...</code>?"}], "tags": [], "owner": {"reputation": 437, "user_id": 11402587, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NMMkz494Zcw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGYlRD72vj8yR7_hYYl3Q3xUHJhg/mo/photo.jpg?sz=128", "display_name": "Wally", "link": "https://stackoverflow.com/users/11402587/wally"}, "is_accepted": false, "score": 0, "last_activity_date": 1573080637, "creation_date": 1573080637, "answer_id": 58739587, "question_id": 58739549, "link": "https://stackoverflow.com/questions/58739549/why-does-i-never-get-past-1/58739587#58739587", "title": "Why does i never get past 1?", "body": "<p>I think that you might need to declare Wordsearch again after the &amp;&amp; - </p>\n\n<pre><code>while(i &lt; wordlength &amp;&amp; wordlength *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            i++;\n        }\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573080637, "creation_date": 1573080303, "last_edit_date": 1573080603, "question_id": 58739549, "link": "https://stackoverflow.com/questions/58739549/why-does-i-never-get-past-1", "title": "Why does i never get past 1?", "body": "<p>I am trying to create a program to solve a wordsearch from a 2D array using only pointers. In my primary function for doing the actual search for the words I have a while loop that is supposed to keep going as long as i doesn't exceed the length of the word and as long as the letters from the word correspond to the letters on the grid. After finding the word it should make the letters on the grid lowercase and print out that it found the word. Here is my entire program right now.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nvoid printPuzzle(char** arr, int n);\nvoid searchPuzzle(char** arr, int n, char** list, int listSize);\nvoid searchWord(int j, int k, int gridsize, char** arr, char** list, int listPos);\n\nint main(int argc, char **argv) {\n    int bSize = 15;\n    if (argc != 2) {\n        fprintf(stderr, \"Usage: %s &lt;puzzle file name&gt;\\n\", argv[0]);\n        return 2;\n    }\n    int i, j;\n    FILE *fptr;\n    char **block = (char**)malloc(bSize * sizeof(char*));\n    char **words = (char**)malloc(50 * sizeof(char*));\n\n    fptr = fopen(argv[1], \"r\");\n    if (fptr == NULL) {\n        printf(\"Cannot Open Puzzle File!\\n\");\n        return 0;\n    }\n\n    for(i=0; i&lt;bSize; i++){\n        *(block+i) = (char*)malloc(bSize * sizeof(char));\n\n        fscanf(fptr, \"%c %c %c %c %c %c %c %c %c %c %c %c %c %c %c\\n\", *(block+i), *(block+i)+1, *(block+i)+2, *(block+i)+3, *(block+i)+4, *(block+i)+5, *(block+i)+6, *(block+i)+7, *(block+i)+8, *(block+i)+9, *(block+i)+10, *(block+i)+11, *(block+i)+12, *(block+i)+13, *(block+i)+14 );\n    }\n    fclose(fptr);\n\n    fptr = fopen(\"states.txt\", \"r\");\n    if (fptr == NULL) {\n        printf(\"Cannot Open Words File!\\n\");\n        return 0;\n    }\n\n    for(i=0; i&lt;50; i++){\n        *(words+i) = (char*)malloc(20 * sizeof(char));\n        fgets(*(words+i), 20, fptr);        \n    }\n\n    for(i=0; i&lt;49; i++){\n        *(*(words+i) + strlen(*(words+i))-2) = '\\0';    \n    }\n\n    printf(\"Printing list of words:\\n\");\n    for(i=0; i&lt;50; i++){\n        printf(\"%s\\n\", *(words + i));       \n    }\n    printf(\"\\n\");\n\n    printf(\"Printing puzzle before search:\\n\");\n    printPuzzle(block, bSize);\n    printf(\"\\n\");\n\n    searchPuzzle(block, bSize, words, 50);\n    printf(\"\\n\");\n\n    printf(\"Printing puzzle after search:\\n\");\n    printPuzzle(block, bSize);\n    printf(\"\\n\");\n\n    return 0;\n}\n\nvoid printPuzzle(char** arr, int n){\n    for(int i = 0; i &lt; n; i++){\n        printf(\"\\n\");\n        for(int j = 0; j &lt; 15; j++){\n            printf(\"%c \", *(*(arr+i)+j));\n        }\n    }\n\n}\n\nvoid searchPuzzle(char** arr, int n, char** list, int listSize){\n    for(int i = 0; i &lt; listSize; i++){\n        for(int j = 0; j &lt; 15; j++){\n            for(int k = 0; k &lt; 15; k++){\n                    searchWord(j, k, 15, arr, list, i);\n                }\n            }\n\n        }\n\n}\n\n\nvoid searchWord(int j, int k, int gridsize, char** arr, char** list, int listPos){\n    int wordlength = strlen(*(list+listPos));\n    if(j+wordlength &lt;= gridsize){ //Horizontal\n        int i = 0;\n        while(i &lt; wordlength &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            i++;\n        }\n        if(i == wordlength){\n            while(i &gt; 0 &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            *(*(arr+(j+i))+k) = tolower(*(*(arr+(j+i))+k));\n            i--;\n            }\n            printf(\"Word found: \");\n            for(i = 0; i &lt; wordlength; i++)\n                printf(\"%c\", *(*(list+listPos)+i));\n        }\n    }\n\n    if(k+wordlength &lt;= gridsize){ //Vertical\n        int i = 0;\n        while(i &lt; wordlength &amp;&amp; *(*(arr+j)+(k+i)) == *(*(list+listPos)+i)){\n            i++;\n        }\n        if(i == wordlength){\n            while(i &gt; 0 &amp;&amp; *(*(arr+j)+(k+i)) == *(*(list+listPos)+i)){\n            *(*(arr+(j+i))+k) = tolower(*(*(arr+(j+i))+k));\n            i--;\n            }\n            printf(\"Word found: \");\n            for(i = 0; i &lt; wordlength; i++){\n                printf(\"%c\", *(*(list+listPos)+i));\n            }\n        }\n    }\n\n    if(j+wordlength &lt;= gridsize &amp;&amp; k+wordlength &lt;= gridsize){ //Diagonal\n        int i = 0;\n        while(i &lt; wordlength &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            i++;\n        }\n        if(i == wordlength){\n            while(i &gt; 0 &amp;&amp; *(*(arr+(j+i))+(k+i)) == *(*(list+listPos)+i)){\n            *(*(arr+(j+i))+(k+i)) = tolower(*(*(arr+(j+i))+(k+i)));\n            i--;\n            }\n            printf(\"Word found: \");\n            for(i = 0; i &lt; wordlength; i++)\n                printf(\"%c\", *(*(list+listPos)+i));\n        }\n    }\n\n\n\n}\n</code></pre>\n\n<p>This is the part I believe there is a problem with.</p>\n\n<pre><code>while(i &lt; wordlength &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            i++;\n        }\n</code></pre>\n\n<p>If I print out the decimal value of i after this while loop it should at some point approach the length of one of the words as I know some words are horizontal, however every time it loops through and prints the value of i it never exceeds 1 which means the while loop never runs more than once which is impossible with the wordsearch files I am using to test this. What is causing this to happen? It is also 0 or 1 for every other direction when I try, the example above was just the while loop from the horizontal search.</p>\n\n<p>There may also be a problem with the function searchPuzzle and the amount it loops through. However, I think that may be just my imagination. </p>\n\n<p>Additional Info: The grid is 15x15 and there are 50 words in the list.</p>\n"}, {"tags": ["c++", "c", "language-lawyer"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573077827, "post_id": 58739126, "comment_id": 103768165, "body": "<code>std::numeric_limits</code> should give you all the information you need to know if the values are convertible (calculation will be required)."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573078577, "post_id": 58739126, "comment_id": 103768436, "body": "@NathanOliver-ReinstateMonica I am not sure what I should use for comparison. As I mentioned I don&#39;t think I can compare against <code>max</code>, because that would already require the operand to be converted to that type, which may not be possible. I could compare the log2 of the integer against <code>max_exponent</code>, but I am not sure that I can draw any conclusion when they compare equal."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 2, "creation_date": 1573079055, "post_id": 58739126, "comment_id": 103768583, "body": "<a href=\"https://stackoverflow.com/questions/51104995/can-a-conversion-from-double-to-int-be-written-in-portable-c\" title=\"can a conversion from double to int be written in portable c\">stackoverflow.com/questions/51104995/&hellip;</a> related or even a duplicate"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1573079341, "post_id": 58739126, "comment_id": 103768672, "body": "@GreenTree Thanks, I must have searched for the wrong terms. This and the other linked questions seem like duplicates. I still need to read through them in detail though."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573082816, "post_id": 58739126, "comment_id": 103769666, "body": "Is there anything wrong with just doing the conversion both directions and checking for equality? I have trouble thinking of a case where that would fail."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573083225, "post_id": 58739126, "comment_id": 103769749, "body": "@MarkRansom That might work, yet may need to do twice: FP--&gt;i-&gt;FP compare as FP and a i-&gt;FP-&gt;i compare as integer"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573083321, "post_id": 58739126, "comment_id": 103769774, "body": "@chux-ReinstateMonica I was thinking of two functions, one for each conversion direction. Each would only need a single check."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573083443, "post_id": 58739126, "comment_id": 103769802, "body": "@MarkRansom The conversion has undefined behavior if the value falls outside the representable range, so it may not be used without prior testing whether the function I am looking for returns <code>true</code>."}], "answers": [{"comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573083947, "post_id": 58739833, "comment_id": 103769924, "body": "Yes, I am not interested in the fractional part. The case where the range of <code>I</code> is potentially larger than that of <code>F</code> is what I considered problematic. The linked question doesn&#39;t completely answer the question, but I guess could be considered a duplicate. If someone wants to close it as duplicate, that would be fine by me."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573084395, "post_id": 58739833, "comment_id": 103770025, "body": "@uneven_mark Yes the &quot;I is larger than that of F&quot; is tricky - I&#39;ll add something later on that - real life is calling me away. <a href=\"https://stackoverflow.com/a/51310956/2410359\"><code>int double_to_int(double val, int *err)</code></a> does handle the &quot;not interested in the fractional part&quot;."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1573084463, "last_edit_date": 1573084463, "creation_date": 1573082595, "answer_id": 58739833, "question_id": 58739126, "link": "https://stackoverflow.com/questions/58739126/implementation-independent-floating-point-integer-conversions/58739833#58739833", "title": "Implementation-independent floating-point/integer conversions", "body": "<p><em>some float</em> to <em>some int</em> is fairly easy is we can assume <code>FLT_RADIX != 10</code> (2<sup>N</sup> floating point) and the range of FP exceeds the integer range.</p>\n\n<p>Form exact FP limits<br>\nTest if FP has a fraction part that is 0<sup>**</sup>.   (also handles NaN, inf)<br>\nTest if too positive.<br>\nTest if too negative.<br>\nTest if converted to integer value rounds. </p>\n\n<p>Pseudo code</p>\n\n<pre><code>// For now, assume 2's complement.\n// With some extra macro magic, could handle all integer encodings. \n\n// Use integer limits whose magnitudes are at or 1 away from a power-of-2  \n//   and form FP power-of-2 limits \n// The following will certainly not incur any rounding\n#define FLT_INT_MAXP1 ((INT_MAX/2 + 1)*2.0f)\n#define FLT_INT_MIN (INT_MIN*1.0f)\n\nstatus float_to_int_test(float f) {\n  float ipart;\n  if (modff(f, &amp;ipart) != 0.0) {\n    return not_a_whole_number;\n  }\n  if (f &gt;= FLT_INT_MAXP1) return too_big;\n  if (f &lt; FLT_INT_MIN) return too_negative;\n  if (f != (volatile float) f)) return rounding_occurred;\n  return success;\n}\n</code></pre>\n\n<hr>\n\n<p>Armed with the above float_to_int test....</p>\n\n<pre><code>status int_to_float_test(int i) { \n  volatile float f = (float) i;\n  if (float_to_int_test(f) != success) return fail\n  volatile int j = (int) f;\n  if (i != j) return fail;\n  return success;\n}\n</code></pre>\n\n<hr>\n\n<p>Simplifications possible, but something to get OP started.</p>\n\n<p>Extreme cases which need additional code include <code>int128_t</code> or wider having more range than <code>float</code> and <code>FLT_RADIX == 10</code>.</p>\n\n<hr>\n\n<p><sup>**</sup> Hmmm - appears OP does not cares about fractional part.  In that case <a href=\"https://stackoverflow.com/questions/51104995/can-a-conversion-from-double-to-int-be-written-in-portable-c\">conversion from double to int</a> appears as a good duplicate for half the problem.</p>\n"}], "owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1573084463, "creation_date": 1573077574, "question_id": 58739126, "link": "https://stackoverflow.com/questions/58739126/implementation-independent-floating-point-integer-conversions", "title": "Implementation-independent floating-point/integer conversions", "body": "<p>Suppose <code>I</code> is some integer type and <code>F</code> some (real) floating point type.</p>\n\n<p>I want to write two functions. The first function shall take a value <code>i</code> of type <code>I</code> and return a boolean indicating whether <code>i</code> converted to <code>F</code> falls into the representable range, i.e. whether <code>(F)i</code> will have defined behavior.</p>\n\n<p>The second function shall take a value <code>f</code> of type <code>F</code> and return a boolean indicating whether <code>f</code> converted to <code>I</code> falls into the representable range, i.e. whether <code>(I)f</code> will have defined behavior.</p>\n\n<p>Is it possible to write such a function that will be, on every implementation conforming to the standard, correct and not exhibit undefined behavior for any input? In particular I do not want to assume that the floating point types are IEEE 754 types.</p>\n\n<p>I am asking about both C and C++ and their respective standard versions separately, in case that changes the answer.</p>\n\n<p>Basically the intention of this question is to figure out whether (sensible) floating-point / integral conversions are possible without relying on IEEE 754 or other standards or hardware details at all. I ask out of curiosity.</p>\n\n<p>Comparing against e.g. <code>INT_MAX</code> or <code>FLT_MAX</code> does not seem to be possible, because it is not clear which type to do the comparison in without already knowing which of the types has wider range.</p>\n"}, {"tags": ["c", "bitwise-operators", "bit", "bit-shift"], "comments": [{"owner": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573078776, "post_id": 58739091, "comment_id": 103768502, "body": "&quot;get the least significant bit from an array and then combine it, and return as a byte&quot; Do you mean that you expect 8 unsigned chars, and the output is 1 unsigned char where each bit is taken from one of the input unsigned chars? As in, for {0000, 0001, 0010, 0011} you will get output 0101?"}, {"owner": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "reply_to_user": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573083112, "post_id": 58739091, "comment_id": 103769720, "body": "@Loduwijk c would be the combination of the least significant bits from p[10], for example. Then combine it all into c, for example, c9c8c7.....c0."}], "answers": [{"comments": [{"owner": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573078463, "post_id": 58739162, "comment_id": 103768386, "body": "You should, even after reading the answer Bill provided, note that the line in question has poor readability since it will force people to stop and think about the order of operations. If you are maintaining this code, you would be wise to make it obvious using parenthesis."}, {"owner": {"reputation": 59821, "user_id": 12943, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/d6a9924b767fe91c46def7edc7bce035?s=128&d=identicon&r=PG", "display_name": "Bill K", "link": "https://stackoverflow.com/users/12943/bill-k"}, "reply_to_user": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573079984, "post_id": 58739162, "comment_id": 103768891, "body": "Or just call an aptly named function or macro instead...  You&#39;d think we&#39;d be beyond dealing with stuff like this--but as with most overly dense code... it&#39;s kind of fun."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573082317, "post_id": 58739162, "comment_id": 103769533, "body": "@Loduwijk The line is completely clear to read and indeed a common ideom for bit manipulation. You always have to stop and think if you do not know; with this argument, you could also ask for parentheses with <code>a + b * c</code>."}, {"owner": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "edited": false, "score": 0, "creation_date": 1573082566, "post_id": 58739162, "comment_id": 103769596, "body": "@BillK I still don&#39;t get it. I know how the OR works, but how does this code take the least significant bits from the array p[10] and combine it into c? Because the way I see it, it only look for the value a for the if-statement, but it doesn&#39;t actually use those value and put it into c."}, {"owner": {"reputation": 59821, "user_id": 12943, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/d6a9924b767fe91c46def7edc7bce035?s=128&d=identicon&r=PG", "display_name": "Bill K", "link": "https://stackoverflow.com/users/12943/bill-k"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1573082747, "post_id": 58739162, "comment_id": 103769649, "body": "@Ctx I didn&#39;t think parentheses would help either, however if you ever see someone ask--someone is wasting time that could have been better spent if the language supported more readable code.  &quot;Set Bit 3 of c&quot; is easy to understand but not great to code--maybe setBit(3,c) would be more immediately understandable for people who hadn&#39;t seen the idiom before, and having that code in a setBit function/macro would stop you from having to guess what it was intended to do."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1573083206, "post_id": 58739162, "comment_id": 103769744, "body": "@BillK Yes, of course such a macro might be a good idea. But I wouldn&#39;t consider it &quot;bad readable code&quot; if you decide not to."}, {"owner": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "edited": false, "score": 0, "creation_date": 1573083725, "post_id": 58739162, "comment_id": 103769877, "body": "@BillK think you misunderstood my question. I&#39;m asking more specifically about this line of code c |= 1 &lt;&lt; i; I don&#39;t understand why it doesn&#39;t use the variable &#39;a&#39; (which is the least significant bit we need to use to combine into variable &#39;c&#39;) Instead, it only shift and do the OR operation."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "reply_to_user": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "edited": false, "score": 0, "creation_date": 1573084263, "post_id": 58739162, "comment_id": 103769997, "body": "@Siv, <code>if(a)</code> means that the <code>1 &lt;&lt; i</code> is only invoked at all when <code>a</code> is 1. If it&#39;s zero, we skip the whole line and don&#39;t run it for that value of <code>i</code> at all."}, {"owner": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1573085160, "post_id": 58739162, "comment_id": 103770192, "body": "@CharlesDuffy Ohhhhh, so the bit we skip over will be automatically 0?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1573085313, "post_id": 58739162, "comment_id": 103770214, "body": "Yes, exactly; the <code>if(a)</code> causes us to skip over bits that are 0."}, {"owner": {"reputation": 59821, "user_id": 12943, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/d6a9924b767fe91c46def7edc7bce035?s=128&d=identicon&r=PG", "display_name": "Bill K", "link": "https://stackoverflow.com/users/12943/bill-k"}, "reply_to_user": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "edited": false, "score": 0, "creation_date": 1573085626, "post_id": 58739162, "comment_id": 103770290, "body": "@Siv yeah, that&#39;s why c is initialized to 0."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1573087854, "post_id": 58739162, "comment_id": 103770769, "body": "...well, that would need to be the case regardless, as <code>c |= 0 &lt;&lt; i</code> does nothing at all regardless of what the initial bit in <code>c</code> is."}, {"owner": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1573144856, "post_id": 58739162, "comment_id": 103794529, "body": "@Ctx My wording &quot;poor readability&quot; was a bit much, but it is not &quot;completely clear to read&quot; either. Just because you can read it easily does not make something &quot;completely clear&quot;. I have seen many times bit manipulations are being done and people make operation order mistakes. Plenty of times I&#39;ve seen people stop and ask about order. No, it&#39;s not the same as &quot;a + b * c&quot; because they teach people that in 3rd grade and pound it into people for years; that is trivial (though parenthesis still wouldn&#39;t hurt). Ops |&amp;&gt;&gt;&lt;&lt; order are non-trivial and people forget them frequently."}, {"owner": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "edited": false, "score": 0, "creation_date": 1573146471, "post_id": 58739162, "comment_id": 103795423, "body": "@BillK I kept thinking in bits. I wasn&#39;t thinking too much about the part of c being initialized to 0. It all makes sense now. Thank you so much."}], "tags": [], "owner": {"reputation": 59821, "user_id": 12943, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/d6a9924b767fe91c46def7edc7bce035?s=128&d=identicon&r=PG", "display_name": "Bill K", "link": "https://stackoverflow.com/users/12943/bill-k"}, "is_accepted": true, "score": 3, "last_activity_date": 1573083245, "last_edit_date": 1573083245, "creation_date": 1573077810, "answer_id": 58739162, "question_id": 58739091, "link": "https://stackoverflow.com/questions/58739091/can-anyone-explain-me-this-line-c-1-i/58739162#58739162", "title": "Can anyone explain me this line? c |= 1 &lt;&lt; i;", "body": "<p>Well, </p>\n\n<pre><code>1&lt;&lt;i \n</code></pre>\n\n<p>should be 1 followed by i zeros (binary)--so</p>\n\n<pre><code>1&lt;&lt;0 = 0001\n1&lt;&lt;1 = 0010\n1&lt;&lt;2 = 0100\n</code></pre>\n\n<p>When that is ORed with what's in C it means to force-set that bit, so:</p>\n\n<pre><code>if you take 0000 | 0010 you'll get 0010\n\nc val| mask = result\n--------------------\n0010 | 0010 = 0010 as well\n1111 | 0010 = 1111 (No change if the bit is already 1)\n1101 | 0010 = 1111 (Just sets that one bit)\nxxxx | 0010 = xx1x (All the other bits remain the same)\n</code></pre>\n\n<p>Finally it stores the result back into c.</p>\n\n<p>So essentially it sets the ith bit in c (starting from the least significant as zero).</p>\n\n<p>Further detail:</p>\n\n<pre><code>// Loop through the first 8 characters in p\nfor(i = 0; i &lt; 8; i++)\n{\n    // Grab the least significant bit of the i'th character as an int (1 or 0)\n    int a = p[i] &amp; 1;\n    // If it happens to be set (was a 1)\n    if(a)\n    {\n        // Set the corresponding (i'th) bit in c\n        c |= 1 &lt;&lt; i;\n    }\n}\n</code></pre>\n\n<p>So if the first value of p has a lsb of 1, the lsb of c will be 1</p>\n\n<p>if the second byte in p has a lsb of 1, the second bit of c will be 1</p>\n\n<p>etc.</p>\n\n<p>the result is that each bit of C will take the value of least significant bit of each of the first 8 bytes of P</p>\n\n<p>I bet it could be coded more densely though if I really wanted to try, but this is probably targeting performance :)</p>\n"}], "owner": {"reputation": 43, "user_id": 11106263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HMYcIgbRueA/AAAAAAAAAAI/AAAAAAAAAAc/DSUagTdBwlo/photo.jpg?sz=128", "display_name": "Siv", "link": "https://stackoverflow.com/users/11106263/siv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58739162, "answer_count": 1, "score": 0, "last_activity_date": 1573083245, "creation_date": 1573077430, "question_id": 58739091, "link": "https://stackoverflow.com/questions/58739091/can-anyone-explain-me-this-line-c-1-i", "title": "Can anyone explain me this line? c |= 1 &lt;&lt; i;", "body": "<p>I recently started C and for some reasons I couldn't get this line c |= 1 &lt;&lt; i;</p>\n\n<p>the purpose of this function I found online is to get the least significant bit from an array and then combine it, and return as a byte. </p>\n\n<pre><code>unsigned char getlsbs(unsigned char* p)\n{\n        int i;\n        unsigned char c = 0;\n        for(i = 0; i &lt; 8; i++)\n        {\n                int a = p[i] &amp; 1;\n                if(a)\n                {\n                        c |= 1 &lt;&lt; i;\n                }\n        }\n        return c;\n}\n</code></pre>\n\n<p>c |= 1 &lt;&lt; i; would be the same as c = c | 1 &lt;&lt; i; correct?</p>\n\n<p>Could anyone explain with the example in 1s and 0s? I think it will be very helpful. Thanks!</p>\n"}, {"tags": ["c", "linux", "docker", "gcc", "nrf52"], "answers": [{"tags": [], "owner": {"reputation": 2593, "user_id": 1760405, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/02d79f5d94f5f8e25e4893b217e3baca?s=128&d=identicon&r=PG", "display_name": "Brad Grissom", "link": "https://stackoverflow.com/users/1760405/brad-grissom"}, "is_accepted": true, "score": -1, "last_activity_date": 1573077336, "creation_date": 1573077336, "answer_id": 58739063, "question_id": 58739062, "link": "https://stackoverflow.com/questions/58739062/how-can-i-setup-a-docker-container-for-developing-on-the-nordic-nrf5-sdk/58739063#58739063", "title": "How can I setup a docker container for developing on the Nordic nRF5 SDK?", "body": "<p>Note that this does not include saving the container as an image and uploading to DockerHub (search around for that part).  Its also worth noting that this set of instructions would be a good start for creating a \"dockerfile\" which would automatically run all of these commands to build up this container on-demand.</p>\n\n<pre><code>    docker pull ubuntu\n    docker run --privileged=true -it -e DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix:ro -v /dev/bus/usb:/dev/bus/usb ubuntu\n\n        // As root in the docker container:\n    apt-get update\n    apt-get install vim vifm ssh sshd iproute2 iputils-ping sshfs build-essential dos2unix git usbutils\n    adduser mydevuser\n    /etc/init.d/ssh start\n    ip a\n\n        // As mydevuser user in the docker container:\n    - Download and unzip gcc compilers from ARM (gcc-arm-none-eabi-8-2019-q3-update-linux.tar.bz2)\n    - Download and unzip nRF5SDK (nRF5SDK160098a08e2.zip)\n    - Download and unzip soft device (s113nrf52701.zip)\n    - Download and unzip command line tools (nRF-Command-Line-Tools_10_4_1_Linux-amd64.tar.gz)\n        // Configure for our compiler, here is my updated GNU_INSTALL_ROOT\n    ~/nRF5SDK/components/toolchain/gcc ..) head Makefile.posix\n                GNU_INSTALL_ROOT ?= /home/mydevuser/gcc/gcc-arm-none-eabi-8-2019-q3-update/bin/\n        // Now lets compile some examples\n    ~/nRF5SDK/external/micro-ecc/nrf52hf_armgcc/armgcc ..) make\n    ~/nRF5SDK/examples/dfu/secure_bootloader/pca10100_s113_ble_debug/armgcc ..) make\n    ~/nRF5SDK/examples/peripheral/spi/pca10056/blank/armgcc ..) make\n\n        // As root in the docker container:\n    mv /home/mydevuser/cli_nrf/mergehex /opt/\n    mv /home/mydevuser/cli_nrf/nrfjprog/ /opt/\n    ln -s /opt/nrfjprog/nrfjprog /usr/local/bin/nrfjprog\n    ln -s /opt/mergehex/mergehex /usr/local/bin/mergehex\n    cp -pv /home/mydevuser/cli_nrf/JLink_Linux_V650b_x86_64/libjlinkarm* /lib/x86_64-linux-gnu/\n\n        // As root in the docker container:\n        // Load the firmware over USB to the dev board:\n    nrfjprog -f NRF52 --program nrf52840_xxaa.hex --chiperase --log\n</code></pre>\n"}], "owner": {"reputation": 2593, "user_id": 1760405, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/02d79f5d94f5f8e25e4893b217e3baca?s=128&d=identicon&r=PG", "display_name": "Brad Grissom", "link": "https://stackoverflow.com/users/1760405/brad-grissom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 58739063, "answer_count": 1, "score": 0, "last_activity_date": 1573077336, "creation_date": 1573077336, "question_id": 58739062, "link": "https://stackoverflow.com/questions/58739062/how-can-i-setup-a-docker-container-for-developing-on-the-nordic-nrf5-sdk", "title": "How can I setup a docker container for developing on the Nordic nRF5 SDK?", "body": "<p>I'd like to setup a docker container and share it with my co-workers so we all don't have to setup development environments individually.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 12102460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf19e43a3f9def226141806d3d3b8f1?s=128&d=identicon&r=PG&f=1", "display_name": "miran80", "link": "https://stackoverflow.com/users/12102460/miran80"}, "edited": false, "score": 0, "creation_date": 1573080153, "post_id": 58739434, "comment_id": 103768939, "body": "Thank you! May I ask how did you go about finding this? I am interested in the mental process of your research:)"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 474, "user_id": 12102460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf19e43a3f9def226141806d3d3b8f1?s=128&d=identicon&r=PG&f=1", "display_name": "miran80", "link": "https://stackoverflow.com/users/12102460/miran80"}, "edited": false, "score": 0, "creation_date": 1573080251, "post_id": 58739434, "comment_id": 103768965, "body": "I used a disassembler (IDA Pro) on <code>netstat.exe</code> to find out how <i>it</i> did it.  The imports table showed some promising functions, so I then went to Bing. And there we have it."}, {"owner": {"reputation": 474, "user_id": 12102460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf19e43a3f9def226141806d3d3b8f1?s=128&d=identicon&r=PG&f=1", "display_name": "miran80", "link": "https://stackoverflow.com/users/12102460/miran80"}, "edited": false, "score": 0, "creation_date": 1573130971, "post_id": 58739434, "comment_id": 103786692, "body": "Your how-to comment is even more valuable than the solution, thank you! However I ran into a new problem with accessing array returned by <code>GetTcpTable2</code> taking too long so I opened anther question: <a href=\"https://stackoverflow.com/questions/58749053/how-to-subscribe-to-port-opening-or-port-closing-events-in-c\" title=\"how to subscribe to port opening or port closing events in c\">stackoverflow.com/questions/58749053/&hellip;</a>  I would like to find out PID of each network packet that passes through (1000 per second)."}], "tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": true, "score": 1, "last_activity_date": 1573079491, "creation_date": 1573079491, "answer_id": 58739434, "question_id": 58739009, "link": "https://stackoverflow.com/questions/58739009/how-do-i-get-pid-from-socket-port-on-windows/58739434#58739434", "title": "How do I get PID from socket port on Windows?", "body": "<p>How about there, it appears there's a way: the IP Helper library.</p>\n\n<p>Ref: <a href=\"https://docs.microsoft.com/en-us/windows/win32/iphlp/ip-helper-start-page\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/iphlp/ip-helper-start-page</a></p>\n\n<p>I haven't used it for this, but it's clearly going down the right road by providing everything you need to basically roll your own <code>netstat.exe</code>.</p>\n\n<p>The low-level object that contains all the info is <code>MIB_TCPROW2</code>, which has the local and remote address + port, plus <code>dwOwningPid</code>. So we know there's a way.</p>\n\n<p>Drilling down we ultimately need the <code>GetTcpTable2()</code> call, and Microsoft's web page helpfully has what appears to be fully-functional C code to do all this yourself.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/win32/api/iphlpapi/nf-iphlpapi-gettcptable2\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/api/iphlpapi/nf-iphlpapi-gettcptable2</a></p>\n\n<p>Finding this was the best surprise of my day!</p>\n"}], "owner": {"reputation": 474, "user_id": 12102460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf19e43a3f9def226141806d3d3b8f1?s=128&d=identicon&r=PG&f=1", "display_name": "miran80", "link": "https://stackoverflow.com/users/12102460/miran80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 1, "accepted_answer_id": 58739434, "answer_count": 1, "score": 1, "last_activity_date": 1573080040, "creation_date": 1573076995, "last_edit_date": 1573080040, "question_id": 58739009, "link": "https://stackoverflow.com/questions/58739009/how-do-i-get-pid-from-socket-port-on-windows", "title": "How do I get PID from socket port on Windows?", "body": "<p>Given a socket port how do you find the process ID (process name) of the process on Windows 10 that uses this port? I am aware of <code>netstat</code> command but I would like to do it with C code only. </p>\n"}, {"tags": ["c", "switch-statement", "fall-through"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1573075699, "post_id": 58738737, "comment_id": 103767424, "body": "First you should make the code <i>readable</i> by properly indenting it."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1573075784, "post_id": 58738737, "comment_id": 103767461, "body": "I don&#39;t see any output"}, {"owner": {"reputation": 68, "user_id": 8677093, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Es-N67KeRx4/AAAAAAAAAAI/AAAAAAAAAaY/cKYvVXBCqC4/photo.jpg?sz=128", "display_name": "MakeBugsNotWar", "link": "https://stackoverflow.com/users/8677093/makebugsnotwar"}, "edited": false, "score": 0, "creation_date": 1573075956, "post_id": 58738737, "comment_id": 103767503, "body": "You could use a nice code editor to properly format your code so that other people could read it easily. It is always said that code is more often read than executed."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1573076856, "post_id": 58738737, "comment_id": 103767807, "body": "You should notice that sme <code>case</code>s don&#39;t have <code>break</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1573086239, "last_edit_date": 1573086239, "creation_date": 1573076959, "answer_id": 58739005, "question_id": 58738737, "link": "https://stackoverflow.com/questions/58738737/dont-understand-the-output-of-program-with-a-switch-block/58739005#58739005", "title": "Don&#39;t understand the output of program with a switch block", "body": "<p>Without a break statement, the code at the end of one case will fall through into the code of the next case.</p>\n\n<p>So, when <code>x</code> reaches the value 6.1, since <code>x*x</code> is still less than 50, you hit <code>case 6</code>, and with no break statement, you also enter the <code>case 5</code> and <code>case 4</code> code. So, the value 5.1 (the result of decrementing <code>x</code>) is printed 3 times.</p>\n\n<p>This is a good opportunity to stress that you should compile your code with all warnings enabled. With <code>gcc -W -Wall</code>, your program will generate the following warnings:</p>\n\n<blockquote>\n<pre><code>.code.tio.c: In function \u2018main\u2019:\n.code.tio.c:12:17: warning: this statement may fall through [-Wimplicit-fallthrough=]\n                 printf(\"case 6, x= %f\\n \", x);\n                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n.code.tio.c:14:13: note: here\n             case 5:\n             ^~~~\n.code.tio.c:15:17: warning: this statement may fall through [-Wimplicit-fallthrough=]\n                 printf(\"case 5, x=%f\\n \", x);\n                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~\n.code.tio.c:17:13: note: here\n             case 4:\n             ^~~~\n</code></pre>\n</blockquote>\n\n<p>If your code is intentionally wanting to fall-through to the next case, <code>gcc</code> will honor a comment annotating that intent. The warning will then not be emitted.</p>\n\n<pre><code>    switch ((int) x) {\n        case 6:\n            x--;\n            printf(\"case 6, x= %f\\n \", x);\n            // FALLTHROUGH\n        case 5:\n            printf(\"case 5, x=%f\\n \", x);\n            // FALLTHROUGH\n        case 4:\n            printf(\"case 4, x=%f\\n \", x);\n            break;\n\n        default:\n            printf(\"something else, x=%f\\n \", x);\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 12292967, "user_type": "registered", "profile_image": "https://graph.facebook.com/832459576933540/picture?type=large", "display_name": "Omar Ashraf", "link": "https://stackoverflow.com/users/12292967/omar-ashraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1573086239, "creation_date": 1573075645, "last_edit_date": 1573077006, "question_id": 58738737, "link": "https://stackoverflow.com/questions/58738737/dont-understand-the-output-of-program-with-a-switch-block", "title": "Don&#39;t understand the output of program with a switch block", "body": "<p>I want to understand the output of this code, specifically the 2 last lines of the output (lines 4 and 5).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    double x = 2.1;\n\n    while (x * x &lt;= 50) {\n        switch ((int) x) {\n            case 6:\n                x--;\n                printf(\"case 6, x= %f\\n \", x);\n\n            case 5:\n                printf(\"case 5, x=%f\\n \", x);\n\n            case 4:\n                printf(\"case 4, x=%f\\n \", x);\n                break;\n\n            default:\n                printf(\"something else, x=%f\\n \", x);\n        }\n\n        x +=2;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "ffmpeg"], "comments": [{"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1573074948, "post_id": 58738057, "comment_id": 103767154, "body": "What happened when you e.g. switched out <code>ffmpeg</code> for <code>dd of=mydump</code> to inspect the data being written?"}, {"owner": {"reputation": 1102, "user_id": 5088796, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/19f4fd38736f571b96696b615af97266?s=128&d=identicon&r=PG&f=1", "display_name": "Yanick Salzmann", "link": "https://stackoverflow.com/users/5088796/yanick-salzmann"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1573077336, "post_id": 58738057, "comment_id": 103768001, "body": "While not actually showing the problem this pointed me into the right direction. My <code>launch_subprocess</code> was using <code>execvp</code> but did not replicate the file being executed (<code>ffmpeg</code>) as the first argument. Now it works!"}], "owner": {"reputation": 1102, "user_id": 5088796, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/19f4fd38736f571b96696b615af97266?s=128&d=identicon&r=PG&f=1", "display_name": "Yanick Salzmann", "link": "https://stackoverflow.com/users/5088796/yanick-salzmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573072285, "creation_date": 1573072285, "question_id": 58738057, "link": "https://stackoverflow.com/questions/58738057/piping-stream-to-ffmpeg-via-forked-process-stdin", "title": "Piping stream to ffmpeg via forked process stdin", "body": "<p>I am piping data from my raspberry pi camera to ffmpeg to convert them into an mp4 stream. I do so not with libavformat/libavformat but I call <code>ffmpeg</code> directly like this:</p>\n\n<pre><code>        context-&gt;ffmpeg_process = utils::launch_subprocess(\n                \"ffmpeg\",\n                {\"-f\", \"rawvideo\", \"-pix_fmt\", \"yuv420p\", \"-s\", \"1920x1080\", \"-r\", \"30\", \"-i\", \"-\", \"-c\", \"libx264\", \"-f\", \"mp4\", \"-movflags\", \"frag_keyframe+empty_moov\", \"-\", \"-loglevel\", \"trace\"}\n        );\n</code></pre>\n\n<p>This is my wrapper around fork and exec like this:</p>\n\n<pre><code>        const auto child = fork();\n        if(child == 0) {\n            if (dup2(stdin_pipe[PIPE_READ], STDIN_FILENO) == -1) {\n                exit(errno);\n            }\n\n            // same for stdout and sterr\n\n            execvp(command.c_str(), proc_args);\n            exit(errno);\n        } else if(child &gt; 0) {\n            // same for stdout and stderr\n            ret_process.stdin_pipe = stdin_pipe[PIPE_WRITE];\n        }\n</code></pre>\n\n<p>Now I have a callback that is called by the raspberry pi camera:</p>\n\n<pre><code>    void CameraHandler::handle_camera_frame(const std::vector&lt;uint8_t&gt; &amp;data, std::size_t size) {\n        FILE* f = fopen(\"output.yuv4\", \"ab\");\n        fwrite(data.data(), 1, size, f);\n        fclose(f);\n\n        std::lock_guard&lt;std::mutex&gt; l{_listener_lock};\n        for (const auto &amp;listener : _data_listeners) {\n            std::size_t written = 0;\n            while (written &lt; size) {\n                const auto num_written = write(listener-&gt;ffmpeg_process.stdin_pipe, data.data() + written, size - written);\n                written += num_written;\n                if(num_written &lt; 0) {\n                    log-&gt;error(\"Broken stdin pipe\");\n                    break;\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>I deliberately append every frame to a file because I am running the exact same command as above (with <code>cat output.yuv4 | ffmpeg ... &gt; output4.mp4</code> to cross check). </p>\n\n<p>Now I can see that I am reading some data from my camera and pushing it to the ffmpeg process. But already after the first read ffmpeg complains, that the input data is invalid:</p>\n\n<pre><code>[2019-11-06 20:08:04.010] [11872:11932] [carpi::data::CameraHandler] [info] Launched ffmpeg process. PID: 11933, error: 0\n[2019-11-06 20:08:04.014] [11872:11932] [carpi::video::RawCameraStream] [info] Camera dimension: 1920/1080\nffmpeg version 4.1.4-1+rpt1~deb10u1 Copyright (c) 2000-2019 the FFmpeg developers\n  built with gcc 8 (Raspbian 8.3.0-6+rpi1)\n  configuration: --prefix=/usr --extra-version='1+rpt1~deb10u1' --toolchain=hardened --libdir=/usr/lib/arm-linux-gnueabihf --incdir=/usr/include/arm-linux-gnueabihf --arch=arm --enable-gpl --disable-stripping --enable-avresample --disable-filter=resample --enable-avisynth --enable-gnutls --enable-ladspa --enable-libaom --enable-libass --enable-libbluray --enable-libbs2b --enable-libcaca --enable-libcdio --enable-libcodec2 --enable-libflite --enable-libfontconfig --enable-libfreetype --enable-libfribidi --enable-libgme --enable-libgsm --enable-libjack --enable-libmp3lame --enable-libmysofa --enable-libopenjpeg --enable-libopenmpt --enable-libopus --enable-libpulse --enable-librsvg --enable-librubberband --enable-libshine --enable-libsnappy --enable-libsoxr --enable-libspeex --enable-libssh --enable-libtheora --enable-libtwolame --enable-libvidstab --enable-libvorbis --enable-libvpx --enable-libwavpack --enable-libwebp --enable-libx265 --enable-libxml2 --enable-libxvid --enable-libzmq --enable-libzvbi --enable-lv2 --enable-omx --enable-openal --enable-opengl --enable-sdl2 --enable-omx-rpi --enable-mmal --enable-libdc1394 --enable-libdrm --enable-libiec61883 --enable-chromaprint --enable-frei0r --enable-libx264 --enable-shared\n  libavutil      56. 22.100 / 56. 22.100\n  libavcodec     58. 35.100 / 58. 35.100\n  libavformat    58. 20.100 / 58. 20.100\n  libavdevice    58.  5.100 / 58.  5.100\n  libavfilter     7. 40.101 /  7. 40.101\n  libavresample   4.  0.  0 /  4.  0.  0\n  libswscale      5.  3.100 /  5.  3.100\n  libswresample   3.  3.100 /  3.  3.100\n  libpostproc    55.  3.100 / 55.  3.100\nSuccessfully parsed a group of options.\nParsing a group of options: input url -.\nApplying option pix_fmt (set pixel format) with argument yuv420p.\nApplying option s (set frame size (WxH or abbreviation)) with argument 1920x1080.\nApplying option r (set frame rate (Hz value, fraction or abbreviation)) with argument 30.\nSuccessfully parsed a group of options.\nOpening an input file: -.\n[NULL @ 0xcd02d0] Opening 'pipe:' for reading\n[pipe @ 0xcd0b50] Setting default whitelist 'crypto'\n[AVIOContext @ 0xcd8d50] Statistics: 1048576 bytes read, 0 seeks\npipe:: Invalid data found when processing input\n</code></pre>\n\n<p>I am now confused. This is literally the same as I am <code>fwrite</code>ing and then piping from the file. Is there something wrong with my <code>write</code>?</p>\n"}, {"tags": ["c", "linux", "multithreading", "memory", "io"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1573072326, "post_id": 58738025, "comment_id": 103766117, "body": "Duplicated file descriptors share the same file position."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1573072351, "post_id": 58738025, "comment_id": 103766127, "body": "Each thread needs to open the file separately, you can&#39;t use <code>dup()</code> for this."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1573076425, "post_id": 58738025, "comment_id": 103767662, "body": "Depending on the size of the file, and depending on the number of threads, it might make sense to map the file into memory."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1573078238, "post_id": 58738025, "comment_id": 103768311, "body": "<i>Basically have each thread read the entire file. The software is only reading that file, no writing.</i> It&#39;d be a <i>lot</i> more efficient to just read the file once and pass that buffer to each thread than it is to have each thread read the same data into separate buffers."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1573104964, "post_id": 58738025, "comment_id": 103774217, "body": "Why don&#39;t you just <code>mmap()</code> the file and let each thread read from the same mapping?"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1573231848, "post_id": 58738025, "comment_id": 103827373, "body": "@AndrewHenle, Reading the whole file into a buffer using the ordinary <code>read(...)</code> system call is fine if the file is small, but allocating that buffer could be a problem if the file is huge. That&#39;s where memory-mapping comes in. If you map a multi-gigabyte file into the process address space, your heap allocator doesn&#39;t need to know about it."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1573232470, "post_id": 58738025, "comment_id": 103827722, "body": "@SolomonSlow I was just limiting my comment to the existing code already using <code>read()</code>.  <code>mmap()</code> works too, especially if the file is read many times, and has the advantage of much simpler code."}], "answers": [{"tags": [], "owner": {"reputation": 30588, "user_id": 8705432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e0f95975d80525786e419222821ff4?s=128&d=identicon&r=PG&f=1", "display_name": "bk2204", "link": "https://stackoverflow.com/users/8705432/bk2204"}, "is_accepted": false, "score": 0, "last_activity_date": 1573086886, "creation_date": 1573086886, "answer_id": 58740366, "question_id": 58738025, "link": "https://stackoverflow.com/questions/58738025/thread-safety-of-reading-a-file/58740366#58740366", "title": "Thread Safety of Reading a File", "body": "<p>As other folks have mentioned, it isn't possible to use a duplicated file descriptor here.  However, there is a thread-safe alternative, which is to use <code>pread</code>.  <code>pread</code> reads a file at an offset and doesn't change the implicit offset in the file description.</p>\n\n<p>This does mean that you have to manually manage the offset in each thread, but that shouldn't be too much of a problem with your proposed function.</p>\n"}], "owner": {"reputation": 583, "user_id": 3186274, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ad8f7e25543e81b995f62181895e1005?s=128&d=identicon&r=PG&f=1", "display_name": "billybob2", "link": "https://stackoverflow.com/users/3186274/billybob2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573086886, "creation_date": 1573072164, "question_id": 58738025, "link": "https://stackoverflow.com/questions/58738025/thread-safety-of-reading-a-file", "title": "Thread Safety of Reading a File", "body": "<p>So my end goal is to allow multiple threads to read the same file from start to finish. For example, if the file was 200 bytes:</p>\n\n<pre><code>Thread A  0-&gt; 200 bytes\nThread B  0-&gt; 200 bytes\nThread C  0-&gt; 200 bytes\n</code></pre>\n\n<p>etc.</p>\n\n<p>Basically have each thread read the entire file. The software is only reading that file, no writing.</p>\n\n<p>so I open the file:</p>\n\n<pre><code>fd = open(filename, O_RDWR|O_SYNC, 0);\n</code></pre>\n\n<p>and then in each thread simply loop the file. Because I only create one File Descriptor, are also create a create a clone of the file descriptor in each thread using dup</p>\n\n<p>Here is a minimual example of a thread function:</p>\n\n<pre><code>void ThreadFunction(){\n int file_desc= dup(fd);\n uint32_t nReadBuffer[1000];\n int numBytes = -1;\n while (numBytes != 0) {\n  numBytes = read(file_desc, &amp;nReadBuffer, sizeof(nReadBuffer));\n  //processing on the bytes goes here\n }\n}\n</code></pre>\n\n<p>However, I'm not sure this is correctly looping through the entire file and each thread is instead somehow daisy chaining through the file.</p>\n\n<p>Is this approach correct? I inherited this software for a project I am working on, the file descriptor gets used in an mmap call, so I am not entirely sure of O_RDWR or O_SYNC matter</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3, "user_id": 12334156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750aa07ee48a6c93edf80c5e5714bf6?s=128&d=identicon&r=PG&f=1", "display_name": "jocielyn", "link": "https://stackoverflow.com/users/12334156/jocielyn"}, "reply_to_user": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1573072970, "post_id": 58737960, "comment_id": 103766387, "body": "I think I&#39;ve fixed them now.."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573073196, "post_id": 58737960, "comment_id": 103766484, "body": "Your code is running through the entire array (up to MAX) even if the user doesn&#39;t enter that many items, and the initial value of every array element is going to be random junk from the stack.  Perhaps consider passing in to the analysis how many numbers it should look at?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12334156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750aa07ee48a6c93edf80c5e5714bf6?s=128&d=identicon&r=PG&f=1", "display_name": "jocielyn", "link": "https://stackoverflow.com/users/12334156/jocielyn"}, "edited": false, "score": 0, "creation_date": 1573074010, "post_id": 58738266, "comment_id": 103766794, "body": "Thanks, I&#39;ve been trying to figure out how to only use the entered values all day long. I knew it would be easy but I just couldn&#39;t do it."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 3, "user_id": 12334156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750aa07ee48a6c93edf80c5e5714bf6?s=128&d=identicon&r=PG&f=1", "display_name": "jocielyn", "link": "https://stackoverflow.com/users/12334156/jocielyn"}, "edited": false, "score": 0, "creation_date": 1573074102, "post_id": 58738266, "comment_id": 103766827, "body": "Also recommend that you use the result of <code>scanf()</code> to help you end the loop. It returns the number of items correctly converted, so if they type <code>abc</code> then that&#39;s bogus input that should end the loop as well.   <code>if (scanf(&quot;%d&quot;, &amp;array[i]) != 1  ||  array[i] &lt; 0) break;</code>"}, {"owner": {"reputation": 3, "user_id": 12334156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750aa07ee48a6c93edf80c5e5714bf6?s=128&d=identicon&r=PG&f=1", "display_name": "jocielyn", "link": "https://stackoverflow.com/users/12334156/jocielyn"}, "edited": false, "score": 0, "creation_date": 1573074667, "post_id": 58738266, "comment_id": 103767057, "body": "Thank you ever so much!"}], "tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": true, "score": 0, "last_activity_date": 1573073752, "last_edit_date": 1573073752, "creation_date": 1573073369, "answer_id": 58738266, "question_id": 58737960, "link": "https://stackoverflow.com/questions/58737960/problem-with-frequency-analysis-of-user-input-array-in-c/58738266#58738266", "title": "Problem with frequency analysis of user input array in C", "body": "<p>Addressing the first issue, pass in how many items the user actually entered so you're not running up to <code>MAX</code> (which would include all the unused cells). The key is <code>nitems</code>.</p>\n\n<pre><code>void frequencyAnalysis(int array[], int nitems, int *number, int *freq)\n{\n    for (int i = 0; i &lt; nitems; i++) {\n        ...\n        for (int j = 0; j &lt; nitems; j++)\n        {\n           // do stuff\n        }\n    }\n}\n\nint main(void)\n{\nint array[MAX],i, j, number = 0, freq = 0;\n\n    ...\n    frequencyAnalysis(array, i, &amp;number,&amp;freq);\n    ///\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12334156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4750aa07ee48a6c93edf80c5e5714bf6?s=128&d=identicon&r=PG&f=1", "display_name": "jocielyn", "link": "https://stackoverflow.com/users/12334156/jocielyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58738266, "answer_count": 1, "score": 0, "last_activity_date": 1573074826, "creation_date": 1573071874, "last_edit_date": 1573073421, "question_id": 58737960, "link": "https://stackoverflow.com/questions/58737960/problem-with-frequency-analysis-of-user-input-array-in-c", "title": "Problem with frequency analysis of user input array in C", "body": "<p>I'm supposed to do a freqency analysis of a user input array. User may enter as many numbers between 0-1000 as s/he wants and a maximum of 100 numbers can be entered, user ends input by entering a negative number. A void function will calculate which number appears the most times and those 2 variables should be sent to the function as pointers. </p>\n\n<p>My problem is that no matter what I do the analysis seems to calculate all the \"empty\" elements of the array and I can't figure out what I'm doing wrong. If i make the array smaller to lets say 10 elements it works fine. As I'm a complete novice when it comes to programming and I've changed the code about a million times so at this point I can't remeber what I've changed from my original code. When debugging I get stuck in the second for loop in the function.. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX 100\n#define INTERVAL 1000\n\nvoid frequencyAnalysis(int array[],int *number, int *freq)\n{\n    int element = 0, count = 0;\n\n    for (int i = 0; i &lt; MAX; i++) {\n        int tempElement = array[i];\n        int tempCount = 0;\n\n        for (int j = 0; j &lt; MAX; j++)\n            if (array[j] == tempElement)\n                tempCount++;\n\n        if (tempCount &gt; count) {\n            element = tempElement;\n            count = tempCount;\n        }\n    }\n\n    *number = element; \n    *freq = count;\n}\n\nint main(void)\n{\n    int array[MAX], i, j, number = 0, freq = 0;\n\n    printf(\"Hello.\\n\"\n        \"Please enter a number between 0-1000. \"\n        \"Enter as many number as you want (maximum 100).\\n\"\n        \"Exit by entering a negative number.\\n\\n\");\n    printf(\"Enter a number:\\n\");\n\n    for (i = 0; i &lt; MAX; i++) {\n        scanf(\"%d\", &amp;array[i]);\n        if (array[i] &lt; 0)\n            break;\n    }\n\n    frequencyAnalysis(array, &amp;number, &amp;freq);\n\n    printf(\"The number:%d is the most frequent number and appears %d times.\\n\", number, freq);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "fork", "posix", "pid"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1573068968, "post_id": 58737332, "comment_id": 103764707, "body": "<code>tar</code> writes to <code>stdout</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1573071222, "post_id": 58737332, "comment_id": 103765623, "body": "You aren&#39;t closing enough file descriptors in the child. <b>Rule of thumb</b>: If you <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a> one end of a pipe to standard input or standard output, close both of the original file descriptors from <code>pipe()</code> as soon as possible. In particular, that means before using any of the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execvp.html\" rel=\"nofollow noreferrer\"><code>exec*()</code></a> family of functions. The rule also applies with either <code>dup()</code> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html\" rel=\"nofollow noreferrer\"><code>fcntl()</code></a> with <code>F_DUPFD</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1573071348, "post_id": 58737332, "comment_id": 103765681, "body": "Also make sure you handle the error case when one of the <code>exec*()</code> family of functions returns.  It only returns on an error; there&#39;s no need to test the return value.  But you should normally at least exit with a non-zero status; often, you should write a message about the failure to standard error and then exit.  Whether to use <code>exit()</code> or <code>_exit()</code> can get fraught \u2014 using <code>_exit()</code> is often (usually) OK, and using <code>exit()</code> is sometimes a bad idea."}], "answers": [{"comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573071090, "post_id": 58737411, "comment_id": 103765558, "body": "I wrote a paper many years ago on getting pipes right, maybe this will help.  <a href=\"http://unixwiz.net/techtips/remap-pipe-fds.html\" rel=\"nofollow noreferrer\">unixwiz.net/techtips/remap-pipe-fds.html</a>"}], "tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": false, "score": 1, "last_activity_date": 1573071136, "last_edit_date": 1573071136, "creation_date": 1573069257, "answer_id": 58737411, "question_id": 58737332, "link": "https://stackoverflow.com/questions/58737332/read-output-from-execl-command-and-print-it-using-only-write-syscall/58737411#58737411", "title": "read() output from execl command and print it using only write() syscall", "body": "<p>EDIT: This needed a great deal of work, and it's still not really there, but this ought to get you started.</p>\n\n<p>I think you have your pipes a little confused: they are a one-way channel, and anything written on <code>pfd[1]</code> can be read on <code>pfd[0]</code>, so they're not using the pipe properly.</p>\n\n<p>Parent and child should always close the \"other\" end of the pipe they are not using, and you have to arrange so that the write-pipe is literally number 1 (stdout).</p>\n\n<pre><code>int show_tar(pid_t *pid, char *buffer, int *bytes_read, char **tar_name)\n{\n    int status = 0;\n    int buffer_size = *bytes_read;  // pass IN the buffer size\n    int pfd[2];\n    pipe(pfd);\n    if ((*pid = fork()) == 0) {\n        close(pfd[0]);  // child doesn't need read pipe\n        dup2(pfd[1], 1); // insure write pipe is at stdout (fd#1)\n        dup2(pfd[1], 2); // stderr goes to the pipe also (optional)\n        close(pfd[1]);  // child doesn't need write pipe any more\n        execl(\"/bin/tar\", \"tar\", \"-tf\", tar_name[1], (char *)NULL);\n        _exit(1);\n    } else {\n        close(pfd[1]);  // parent doesn't need write pipe\n        *bytes_read = read(pfd[0], buffer, buffer_size);\n\n        // insure NUL byte at the end\n        if (*bytes_read &gt;= 0) buffer[*bytes_read] = 0;\n\n        wait(NULL);\n    }\n//  _exit(status);    // we don't need this!\n    return status;\n}\n\nint main(int argc, char **argv)\n{\n    char buffer[1024];\n    int bytes_read = sizeof buffer;\n    pid_t pid;\n\n    int status = show_tar(&amp;pid, buffer, &amp;bytes_read, argv);\n    wait(&amp;status);\n\n    // print the value here\n    return 0;\n}\n</code></pre>\n\n<p>This somewhat oversimplifies the pipe descriptor management, because if this is being run in an environment where stdin/stdout are already closed, then the pipe might actually use fd#0 and fd#1.</p>\n\n<p>In the end you sometimes have to do tricky things by checking for file descriptors to see if they are already what you want, and <code>dup</code>ing around clashes. But if run from a terminal session, this is fine to get started.</p>\n\n<p>ALSO: be aware that the standard error stream (fd#2) is still connected to the original terminal, so things like error messages from <code>tar</code> will not be captured by this mechanism. Again, more tricky pipe descriptor management.</p>\n\n<p>EDIT: I just noticed that all paths in <code>show_tar()</code> flow through <code>_exit()</code>, so it will never return.</p>\n\n<p>EDIT: move the definition of <code>int pfd[2];</code> to <em>inside</em> <code>show_tar()</code> - it doesn't need to be at file scope.</p>\n\n<p>EDIT: just realized that <code>sizeof(buffer)</code> in <code>show_tar()</code> is not doing what you think; the size of the pointer is always 4 or 8 (depending on platform), not the number of bytes available - this would have to be passed as a parameter. I've overloaded the <code>*bytes_read</code> parameter to pass <em>in</em> the # of bytes available, and you already are using it to pass <em>back</em> the number read.</p>\n\n<p>The parent must also loop, reading bytes from the pipe until it gets end-of-file because it's unlikely that everything from <code>tar</code> will go in a single read.</p>\n"}], "owner": {"reputation": 19, "user_id": 12333904, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tzGtGq8tzOc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8plIXBGWii_2QZyjQZ_XSJbLWWA/photo.jpg?sz=128", "display_name": "tham mes", "link": "https://stackoverflow.com/users/12333904/tham-mes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573071136, "creation_date": 1573068811, "question_id": 58737332, "link": "https://stackoverflow.com/questions/58737332/read-output-from-execl-command-and-print-it-using-only-write-syscall", "title": "read() output from execl command and print it using only write() syscall", "body": "<p>I am trying to execute <code>/bin/tar -tf</code> on a tar file with <code>execl()</code>. I would like it to read its contents and only print it to the terminal screen in my <code>main()</code> function with the <code>write()</code> syscall.</p>\n\n<p>My code below somehow reads the contents and writes it to the terminal at the same time without having to resort to the write() syscall to do so.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint pfd[2];\n\n// Problem 1:\n// ERROR : read() function reads and writes to the terminal.\n// I would like to write the contents of the 'buffer' variable with the\n// write(fd, buffer, strlen(buffer)) syscall to the terminal preferably\n// in the main() function.\n// Problem 2:\n// is the 'status' variable along with the _exit function useful here?\n// I am not sure if a pipe is needed?\nint show_tar(pid_t *pid, char *buffer, int *bytes_read, char **tar_name)\n{\n    int status = 0;\n    pipe(pfd);\n    if ((*pid = fork()) == 0) {\n        dup2(0, pfd[0]);\n        execl(\"/bin/tar\", \"tar\", \"-tf\", tar_name[1], (char *)NULL);\n    } else {\n        close(pfd[1]);\n        *bytes_read = read(pfd[0], buffer, sizeof(buffer));\n        wait(NULL);\n    }\n    _exit(status);\n    return status;\n}\n\nint main(int argc, char **argv)\n{\n    char buffer[1024];\n    int bytes_read = 0;\n    pid_t pid;\n    int status = show_tar(&amp;pid, buffer, &amp;bytes_read, argv);\n    wait(&amp;status);\n    // write contents of 'buffer' to the terminal with the\n    // write(fd, buffer, strlen(buffer)) function like so:\n    // int ch;\n    // while (1) {\n    //     if ((ch = getchar()) == 27) // Press &lt;Escape&gt; to quit program\n    //         break;\n    //     else  \n    //         write(1, buffer, strlen(buffer));\n    // }\n    return 0;\n}\n</code></pre>\n\n<p>Compiled and executed on Linux with <code>argv[1]</code> being the tarball:</p>\n\n<pre><code>gcc buffer.c -o buffer &amp;&amp; ./buffer \"$HOME/&lt;your tarball&gt;.tar.gz\"\n</code></pre>\n\n<p>The output shows the entire contents of the tarball without having to resort to the <code>write()</code> syscall.</p>\n"}, {"tags": ["c", "assembly", "x86", "low-level", "avx2"], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573083328, "post_id": 58738036, "comment_id": 103769775, "body": "Yes, you need a shift or shuffle, and a shift is a good choice.  <code>vpmuludq</code> 32x32=&gt;64 is faster than an AVX512 64x64=&gt;64 <code>vpmullq</code> on current hardware (single uop).  If you had AVX512IFMA you could use <a href=\"https://www.felixcloutier.com/x86/vpmadd52huq\" rel=\"nofollow noreferrer\"><code>VPMADD52HUQ</code></a> but that&#39;s the upper 52 of 104 bits.  (It exists to expose the full power of the FP mantissa multipliers for whatever you want to use them for.)"}], "tags": [], "owner": {"reputation": 139, "user_id": 5613702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19700f0c35b58b6b5519ed0f9ec9ef78?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/5613702/damian"}, "is_accepted": true, "score": 3, "last_activity_date": 1573072191, "creation_date": 1573072191, "answer_id": 58738036, "question_id": 58737248, "link": "https://stackoverflow.com/questions/58737248/multiplying-2-32-bit-numbers-and-taking-the-top-32-bits-using-avx2/58738036#58738036", "title": "Multiplying 2 32-bit numbers and taking the top 32 bits using AVX2", "body": "<p>This can be done by doing the following:</p>\n\n<pre><code>__m256i t1 = _mm256_mul_epu32(m, n);\nt1 = _mm256_srli_epi64(t1, 32);\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 5613702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19700f0c35b58b6b5519ed0f9ec9ef78?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/5613702/damian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 58738036, "answer_count": 1, "score": 0, "last_activity_date": 1573072191, "creation_date": 1573068461, "question_id": 58737248, "link": "https://stackoverflow.com/questions/58737248/multiplying-2-32-bit-numbers-and-taking-the-top-32-bits-using-avx2", "title": "Multiplying 2 32-bit numbers and taking the top 32 bits using AVX2", "body": "<p>I am using multiplication (with the addition of other operations) as a substitution for integer division. My solution eventually requires me to multiply 2 32-bit numbers together and take the top 32 bits (just like the mulhi function), but AVX2 does not offer a 32-bit variant of _mm256_mulhi_epu16 (Ex: there's no '_mm256_mulhi_epu32' function).</p>\n\n<p>I have tried various methods such as checking the functions of AVX512, or even manipulating the 32-bit integers to be 2 hi/lo 16-bit integers. I'm very new to working with low-level programming, so I'm unaware what is optimal, or even just possible.</p>\n"}, {"tags": ["c", "bash", "macos", "vt100"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1573069812, "post_id": 58737219, "comment_id": 103765030, "body": "There were many dialects of VT100. Try to get your hands on an annotated copy of a termcap file to get a grip on them. (and I dont think that alt keys existed at the time)"}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 0, "creation_date": 1573078965, "post_id": 58737219, "comment_id": 103768556, "body": "<a href=\"https://invisible-island.net/xterm/ctlseqs/ctlseqs.html\" rel=\"nofollow noreferrer\">invisible-island.net/xterm/ctlseqs/ctlseqs.html</a> The code sent depends on the terminal emulator and the mode set by the application. As an example, you can try <code>tput smkx; cat</code> and press some keys to see the codes sent by your terminal emulator in application mode."}], "answers": [{"tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 0, "last_activity_date": 1575758726, "creation_date": 1575758726, "answer_id": 59230899, "question_id": 58737219, "link": "https://stackoverflow.com/questions/58737219/vt100-number-keypad-escape-codes-when-using-modifiers-ctrl-shift-alt/59230899#59230899", "title": "VT100 Number Keypad Escape codes when using modifiers (ctrl/shift/alt)", "body": "<p>The question is</p>\n\n<blockquote>\n  <p>how do I define escape codes in VT100 format for keypad combinations with modifier keys (shift, alt, ctrl)?</p>\n</blockquote>\n\n<p>The answer is that you probably can't, because terminals are unlikely to provide distinct escape codes for the numeric keypad:</p>\n\n<ul>\n<li>VT100s never did anything like that.</li>\n<li>xterm imitates <a href=\"https://invisible-island.net/xterm/ctlseqs/ctlseqs.html#h2-VT220-Style-Function-Keys\" rel=\"nofollow noreferrer\">VT100's keypad</a>, taking into account normal and application modes (application mode sends the escape sequences you listed)</li>\n<li><p>most other terminal emulators don't bother doing even that.</p></li>\n<li><p>xterm has a feature which lets you configure it to send modified keypad keys, the <a href=\"https://invisible-island.net/xterm/manpage/xterm.html#VT100-Widget-Resources:modifyKeyboard\" rel=\"nofollow noreferrer\"><strong><code>modifyKeyboard</code></strong></a> resource setting:\n   modifyKeyboard (class ModifyKeyboard)\n           Normally xterm makes a special case regarding modifiers (shift,\n           control, etc.)  to handle special keyboard layouts (legacy and\n           vt220).  This is done to provide compatible keyboards for DEC\n           VT220 and related terminals that implement user-defined keys\n           (UDK).</p>\n\n<pre><code>       The bits of the resource value selectively enable modification\n       of the given category when these keyboards are selected.  The\n       default is \"0\":\n\n       0    The legacy/vt220 keyboards interpret only the Control-\n            modifier when constructing numbered function-keys.  Other\n            special keys are not modified.\n\n       1    allows modification of the numeric keypad\n\n       2    allows modification of the editing keypad\n\n       4    allows modification of function-keys, overrides use of\n            Shift-modifier for UDK.\n\n       8    allows modification of other special keys\n</code></pre></li>\n<li>other terminals don't do that at all (a few may let you customize the keys sent, but none will have this predefined, which is what your mud client would need).</li>\n</ul>\n"}], "owner": {"reputation": 113, "user_id": 1045206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/029ae207487c87a9e2294235fe07de6a?s=128&d=identicon&r=PG", "display_name": "afansky", "link": "https://stackoverflow.com/users/1045206/afansky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575758726, "creation_date": 1573068291, "question_id": 58737219, "link": "https://stackoverflow.com/questions/58737219/vt100-number-keypad-escape-codes-when-using-modifiers-ctrl-shift-alt", "title": "VT100 Number Keypad Escape codes when using modifiers (ctrl/shift/alt)", "body": "<p>I'm trying to revive a pretty old MUD client to run under OS X Mojave (pretty much a telnet client that supports aliases, key bindings and triggers).\nThe code can be found here <a href=\"https://github.com/olostan/mmc\" rel=\"nofollow noreferrer\">https://github.com/olostan/mmc</a></p>\n\n<p>I was successfully able to run it, however it didn't correctly handle the numpad keys. As I figured out that happened because these keys weren't defined in <a href=\"https://github.com/olostan/mmc/blob/master/src/output.c\" rel=\"nofollow noreferrer\">https://github.com/olostan/mmc/blob/master/src/output.c</a>\nOnce I added the following block to \"keypad keys\" section, it started working properly.</p>\n\n<pre><code>  { \"k0\",   \"\\033Op\",   NULL    },\n  { \"k1\",   \"\\033Oq\",   NULL    },\n  { \"k2\",   \"\\033Or\",   NULL    },\n  { \"k3\",   \"\\033Os\",   NULL    },\n  { \"k4\",   \"\\033Ot\",   NULL    },\n  { \"k5\",   \"\\033Ou\",   NULL    },\n  { \"k6\",   \"\\033Ov\",   NULL    },\n  { \"k7\",   \"\\033Ow\",   NULL    },\n  { \"k8\",   \"\\033Ox\",   NULL    },\n  { \"k9\",   \"\\033Oy\",   NULL    },  \n</code></pre>\n\n<p>Now I want to do the same for numpad keys with different modifiers (ctrl, alt, shift), for example C-k1, M-k1, S-k1, but I can't find anywhere how to correctly define escape codes for such sequence. I got the codes above from this page - <a href=\"https://www.gnu.org/software/screen/manual/html_node/Input-Translation.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/screen/manual/html_node/Input-Translation.html</a> But unfortunately it doesn't describe any  combinations with modifiers.</p>\n\n<p>So the question - how do I define escape codes in VT100 format for keypad combinations with modifier keys (shift, alt, ctrl)? I tried setting something like this \"\\033[1;5Ot\" for S-k4 key combination, but none of that worked.</p>\n"}, {"tags": ["c", "pointers", "wordsearch"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573068011, "post_id": 58737022, "comment_id": 103764318, "body": "Unfortunately the program does not compile, due to missing function prototypes (and the consequent wrong assumptions by the compiler). One of them <code>tolower()</code> only gives a warning because <code>#include &lt;ctype.h&gt;</code> is missing but the assumption about types was correct."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573068611, "post_id": 58737022, "comment_id": 103764575, "body": "Once you have lowercased a word found in the grid, how will its letters match a search with a different direction? But the pointer approach seems perverse \u2013 I would get the program fully working with array notation and <i>then</i> convert it to pointer notation."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573069138, "post_id": 58737022, "comment_id": 103764767, "body": "Note too that <code>tolower(*(*(arr+(j+i))+k));</code> does not lowercase anything: function <code>tolower()</code>  <i>returns</i> the lowercase value (if any) of the character passed, since it is passed <code>int</code> and not a pointer to the character."}, {"owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573069474, "post_id": 58737022, "comment_id": 103764904, "body": "Why is it passing an int to tolower? Isn&#39;t it dereferencing into a char? arr is a grid of characters Also none of the words share the same characters on the grid so trying to match differing cases of letters shouldn&#39;t become a program for my purposes, and I&#39;m trying to only lower case after the word is confirmed to wholly match."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573069579, "post_id": 58737022, "comment_id": 103764946, "body": "It is passing <code>int</code> to <code>tolower</code> because the <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/tolower-tolower-towlower-tolower-l-towlower-l?view=vs-2019\" rel=\"nofollow noreferrer\">man page</a> says it does. Almost <b><i>no</i></b> library functions either take or return a <code>char</code> type, and this one certainly does not take a <code>char*</code> type which could modify the source."}, {"owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573069723, "post_id": 58737022, "comment_id": 103764997, "body": "If I don&#39;t use tolower what should I be doing to convert the characters to lowercase? Do I just have to typecast or is it just the wrong way of doing this?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573069773, "post_id": 58737022, "comment_id": 103765015, "body": "<code>myletter = tolower(myletter);</code>"}], "owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573068505, "creation_date": 1573067402, "question_id": 58737022, "link": "https://stackoverflow.com/questions/58737022/how-do-i-fix-this-wordsearch-program", "title": "How do I fix this wordsearch program?", "body": "<p>I am creating a program without the use of arrays, only pointers, that solves wordsearches. The logic behind my program seems solid, but I am not getting any result when I run it. After finding the word the program is supposed to make the word in the 2D array become lowercase and print out the found word. </p>\n\n<p>The problem I am seeing is that when it prints out the array again after the search is supposed to happen, it doesn't have the lowercase characters and it also isn't printing out the words that are found. I can't figure out why this is happening. </p>\n\n<p>This is my program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\n\nint main(int argc, char **argv) {\n    int bSize = 15;\n    if (argc != 2) {\n        fprintf(stderr, \"Usage: %s &lt;puzzle file name&gt;\\n\", argv[0]);\n        return 2;\n    }\n    int i, j;\n    FILE *fptr;\n    char **block = (char**)malloc(bSize * sizeof(char*));\n    char **words = (char**)malloc(50 * sizeof(char*));\n\n    fptr = fopen(argv[1], \"r\");\n    if (fptr == NULL) {\n        printf(\"Cannot Open Puzzle File!\\n\");\n        return 0;\n    }\n\n    for(i=0; i&lt;bSize; i++){\n        *(block+i) = (char*)malloc(bSize * sizeof(char));\n\n        fscanf(fptr, \"%c %c %c %c %c %c %c %c %c %c %c %c %c %c %c\\n\", *(block+i), *(block+i)+1, *(block+i)+2, *(block+i)+3, *(block+i)+4, *(block+i)+5, *(block+i)+6, *(block+i)+7, *(block+i)+8, *(block+i)+9, *(block+i)+10, *(block+i)+11, *(block+i)+12, *(block+i)+13, *(block+i)+14 );\n    }\n    fclose(fptr);\n\n    fptr = fopen(\"states.txt\", \"r\");\n    if (fptr == NULL) {\n        printf(\"Cannot Open Words File!\\n\");\n        return 0;\n    }\n\n    for(i=0; i&lt;50; i++){\n        *(words+i) = (char*)malloc(20 * sizeof(char));\n        fgets(*(words+i), 20, fptr);        \n    }\n\n    for(i=0; i&lt;49; i++){\n        *(*(words+i) + strlen(*(words+i))-2) = '\\0';    \n    }\n\n    printf(\"Printing list of words:\\n\");\n    for(i=0; i&lt;50; i++){\n        printf(\"%s\\n\", *(words + i));       \n    }\n    printf(\"\\n\");\n\n    printf(\"Printing puzzle before search:\\n\");\n    printPuzzle(block, bSize);\n    printf(\"\\n\");\n\n    searchPuzzle(block, bSize, words, 50);\n    printf(\"\\n\");\n\n    printf(\"Printing puzzle after search:\\n\");\n    printPuzzle(block, bSize);\n    printf(\"\\n\");\n\n    return 0;\n}\n\nvoid printPuzzle(char** arr, int n){\n    for(int i = 0; i &lt; n; i++){\n        printf(\"\\n\");\n        for(int j = 0; j &lt; 15; j++){\n            printf(\"%c \", *(*(arr+i)+j));\n        }\n    }\n\n}\n\nvoid searchPuzzle(char** arr, int n, char** list, int listSize){\n    for(int i = 0; i &lt; listSize; i++){\n        for(int j = 0; j &lt; n; j++){\n            for(int k = 0; k &lt; n; k++){\n                    searchWord(j, k, n, arr, list, i);\n                }\n            }\n\n        }\n\n}\n\n\nvoid searchWord(int j, int k, int gridsize, char** arr, char** list, int listPos){\n    int wordlength = strlen(*(list+listPos));\n    if(j+wordlength &lt;= gridsize){ //Horizontal\n        int i = 0;\n        while(i &lt; wordlength &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            i++;\n        }\n        if(i == wordlength){\n            while(i &gt; 0 &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            tolower(*(*(arr+(j+i))+k));\n            i--;\n            }\n            for(i = 0; i &lt; wordlength; i++)\n                printf(\"%c\", *(*(list+listPos)+i));\n        }\n    }\n\n    if(k+wordlength &lt;= gridsize){ //Vertical\n        int i = 0;\n        while(i &lt; wordlength &amp;&amp; *(*(arr+j)+(k+i)) == *(*(list+listPos)+i)){\n            i++;\n        }\n        if(i == wordlength){\n            while(i &gt; 0 &amp;&amp; *(*(arr+j)+(k+i)) == *(*(list+listPos)+i)){\n            tolower(*(*(arr+(j+i))+k));\n            i--;\n            }\n            for(i = 0; i &lt; wordlength; i++){\n                printf(\"%c\", *(*(list+listPos)+i));\n            }\n        }\n    }\n\n    if(j+wordlength &lt;= gridsize &amp;&amp; k+wordlength &lt;= gridsize){ //Diagonal\n        int i = 0;\n        while(i &lt; wordlength &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+listPos)+i)){\n            i++;\n        }\n        if(i == wordlength){\n            while(i &gt; 0 &amp;&amp; *(*(arr+(j+i))+(k+i)) == *(*(list+listPos)+i)){\n            tolower(*(*(arr+(j+i))+(k+i)));\n            i--;\n            }\n            for(i = 0; i &lt; wordlength; i++)\n                printf(\"%c\", *(*(list+listPos)+i));\n        }\n    }\n\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "sockets", "arp"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10744020, "user_type": "registered", "profile_image": "https://graph.facebook.com/2415480768466895/picture?type=large", "display_name": "Gal Kaptsenel", "link": "https://stackoverflow.com/users/10744020/gal-kaptsenel"}, "edited": false, "score": 0, "creation_date": 1573073788, "post_id": 58737775, "comment_id": 103766719, "body": "Thanks!!The reason I didn&#39;t use it was because it is an arp reply, hence it is layer 2 protocol, hence there os no IP addresses. So, is there no way to send arp reply without an IP address ?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 23, "user_id": 10744020, "user_type": "registered", "profile_image": "https://graph.facebook.com/2415480768466895/picture?type=large", "display_name": "Gal Kaptsenel", "link": "https://stackoverflow.com/users/10744020/gal-kaptsenel"}, "edited": false, "score": 0, "creation_date": 1573074999, "post_id": 58737775, "comment_id": 103767172, "body": "Sending ARP packets on other platforms requires <code>AF_PACKET</code> and <code>sockaddr_ll</code> to get to the Ethernet layer. WinSock does not support those. I don&#39;t think you can send raw Ethernet packets with WinSock at all, it seems WinSock&#39;s implementation of <code>SOCK_RAW</code> can&#39;t go below the IP layer. RAW sockets on WinSock&#39;s are simply more limited than on other platforms. If switching OSes is not an option then you will have to use a 3rd party packet library, <a href=\"https://www.winpcap.org/docs/docs_40_2/html/group__wpcap__tut8.html\" rel=\"nofollow noreferrer\">such as WinPCap</a>."}, {"owner": {"reputation": 23, "user_id": 10744020, "user_type": "registered", "profile_image": "https://graph.facebook.com/2415480768466895/picture?type=large", "display_name": "Gal Kaptsenel", "link": "https://stackoverflow.com/users/10744020/gal-kaptsenel"}, "edited": false, "score": 0, "creation_date": 1573075240, "post_id": 58737775, "comment_id": 103767281, "body": "Unfortunately it is not possible to switch OSes, thank you very much! I hope winpcap is similar to winsock so my work is not wasted"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1573071837, "last_edit_date": 1573071837, "creation_date": 1573070989, "answer_id": 58737775, "question_id": 58737016, "link": "https://stackoverflow.com/questions/58737016/send-raw-arp-reply-packet-in-windows/58737775#58737775", "title": "Send Raw arp reply packet in windows", "body": "<p>Winsock error 10047 is <code>WSAEAFNOSUPPORT</code>:</p>\n\n<blockquote>\n  <p>Address family not supported by protocol family.</p>\n  \n  <p>An address incompatible with the requested protocol was used. All sockets are created with an associated address family (that is, AF_INET for Internet Protocols) and a generic protocol type (that is, SOCK_STREAM). This error is returned if an incorrect protocol is explicitly requested in the <code>socket</code> call, or <strong>if an address of the wrong family is used for a socket, for example, in <code>sendto</code></strong>.</p>\n</blockquote>\n\n<p>You created an <code>AF_INET</code> (IPv4) socket, but you are not passing <code>sendto()</code> a valid <code>sockaddr_in</code> containing an IPv4 address and port, hence the error. You are passing it an empty <code>socketaddr</code> (what is that?) instead.</p>\n\n<p>Any <code>sockaddr_...</code> struct you use with a socket must match what the socket's address family expects, as set by the <code>socket()</code> call (in your case, <code>AF_INET</code>, which uses <code>sockaddr_in</code> addresses).</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>sockaddr_in sa;\nmemset(&amp;sa, 0, sizeof(sa));\nsa.sin_family = AF_INET;\nsa.sin_addr.s_addr = inet_addr(\"destination IP address\");\nsa.sin_port = htons(Destination port number);\n\nint SentBytesCount = sendto(s, (char*)&amp;arp_raw_msg, sizeof(Arp_Frame), 0, (struct sockaddr*)&amp;sa, sizeof(sa));\n</code></pre>\n\n<hr>\n\n<p>As for <code>IP_HDRINCL</code>, it is defined in <code>ws2tcpip.h</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 10744020, "user_type": "registered", "profile_image": "https://graph.facebook.com/2415480768466895/picture?type=large", "display_name": "Gal Kaptsenel", "link": "https://stackoverflow.com/users/10744020/gal-kaptsenel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 58737775, "answer_count": 1, "score": 2, "last_activity_date": 1573071837, "creation_date": 1573067383, "question_id": 58737016, "link": "https://stackoverflow.com/questions/58737016/send-raw-arp-reply-packet-in-windows", "title": "Send Raw arp reply packet in windows", "body": "<p>I am currently learning how to use the windows raw sockets.</p>\n\n<p>I created a raw arp reply frame(includes all headers (ethernet+arp headers)), and when I send it using sendto function,\nIt fails and return SOCKET_ERROR with error code 10047.</p>\n\n<p>The parameters I used to create the socket are as follows:</p>\n\n<pre><code>socket s = socket(AF_INET,SOCK_RAW,IPPROTO_RAW);\n</code></pre>\n\n<p>and also I changed the socket options as follows:</p>\n\n<pre><code>int on=1;\nsetsockopt(s,IPPROTO_IP, 2,(char*)&amp;on,sizeof(on));\n</code></pre>\n\n<p>(By the way, '2' is equal to IP_HDRINCL, for some reason, visual studio didn't recognize it..)</p>\n\n<p>I try to send the packet as follows:</p>\n\n<pre><code>socketaddr sa = { 0 };\nint SentBytesCount = sendto(s, (char*)&amp;arp_raw_msg,sizeof(Arp_Frame),0,&amp;sa,sizeof(sa));\n</code></pre>\n\n<p>Where Arp_Frame is a struct that includes ethernet header+arp header+18 Bytes for padding.</p>\n\n<p>After this call I get that SentBytesCount is equal to SOCKET_ERROR(-1), and no packet is sent.</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["c++", "c", "winapi", "disk"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1573067044, "post_id": 58736814, "comment_id": 103763923, "body": "Check <code>sizeof(long) == sizeof(DWORD)</code> as <code>moveToHigh</code> should be a <code>DWORD</code>.  Also <code>SetFilePointerEx</code> might be simpler to use."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573068598, "post_id": 58736814, "comment_id": 103764567, "body": "@RichardCritten also <code>SetFilePointer[Ex]</code> not need at all. need set offset in <code>ReadFile&#47;WriteFile</code> call direct"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1573069895, "post_id": 58736814, "comment_id": 103765074, "body": "RbMm is referring to using an <code>OVERLAPPED</code> struct to specify the offset when calling <code>ReadFile()</code>/<code>WriteFile()</code>, then there is no need to use <code>SetFilePointer&#47;Ex()</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1573069979, "post_id": 58736814, "comment_id": 103765101, "body": "@Deulis are you sure the sector size on the disk is 512 bytes? How is the disk formatted exactly?"}, {"owner": {"reputation": 406, "user_id": 1397307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9585055fa3e7817c9f46b29382e876c2?s=128&d=identicon&r=PG", "display_name": "Deulis", "link": "https://stackoverflow.com/users/1397307/deulis"}, "edited": false, "score": 0, "creation_date": 1573075229, "post_id": 58736814, "comment_id": 103767276, "body": "RbMm and Remy, I have the same result using an OVERLAPPED struct. And yes, the sector size on disk is 512 bytes, I am using WinHex and Disk Editor to double check that. Thanks!"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1573078009, "post_id": 58736814, "comment_id": 103768231, "body": "@Deulis - of course result will not change only because you change way how you set offset. i only try to say that api like <code>SetFilePointerEx</code> was atavism. about access denied (if it really was access denied - i be call <code>RtlGetLastNtStatus()</code> or <code>NtWriteFile</code>) - it can be from filesystem, but you dismount volume"}], "owner": {"reputation": 406, "user_id": 1397307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9585055fa3e7817c9f46b29382e876c2?s=128&d=identicon&r=PG", "display_name": "Deulis", "link": "https://stackoverflow.com/users/1397307/deulis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "closed_date": 1573070074, "answer_count": 0, "score": 0, "last_activity_date": 1573093793, "creation_date": 1573066517, "last_edit_date": 1573093793, "question_id": 58736814, "link": "https://stackoverflow.com/questions/58736814/windows-filewrite-fails-for-volume-sectors-bigger-than-0x1fff", "closed_reason": "Duplicate", "title": "Windows FileWrite fails for volume sectors bigger than 0x1FFF", "body": "<p>Why I can not write sector at position bigger than 0x1FFF?\nI am trying to write sector in a SD card. The following code work great for sectors number lower than 0x2000 but fail for any sector bigger than 0x1FFFF returning error code number 5. I don't know why?\nI don't think this is a duplicate question because I can write sectors in the disk but I can't write sector bigger than 0x1FFF. I am using WinHex and Disk Editor to verify that those sector exist.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    LPCWSTR device_name = L\"\\\\\\\\.\\\\PHYSICALDRIVE2\";\n\n\n    int sector = 0x2000;\n\n    //Open the volume\n    HANDLE hDisk = CreateFile(device_name, (GENERIC_READ | GENERIC_WRITE), 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n    if (hDisk != INVALID_HANDLE_VALUE) \n    {\n        DWORD ol = 0;\n        //Lock the volume\n        if (DeviceIoControl(hDisk, FSCTL_LOCK_VOLUME, NULL, 0, NULL, 0, &amp;ol, NULL))\n        {\n            ol = 0;\n            //Dismount the volume\n            if (DeviceIoControl(hDisk, FSCTL_DISMOUNT_VOLUME, NULL, 0, NULL, 0, &amp;ol, NULL))\n            {\n                unsigned char buff[512];\n\n                //Set position at desire sector\n                int position = sector * 512;\n                DWORD readBytes = 0;\n                long moveToHigh = 0;\n                SetFilePointer(hDisk, position, &amp;moveToHigh, FILE_BEGIN);\n\n                //Read the sector\n                if (ReadFile(hDisk, buff, 512, &amp;readBytes, NULL) &amp;&amp; readBytes == 512)\n                {\n                    //Set the write position\n                    DWORD writenBytes = 0;\n                    moveToHigh = 0;\n                    SetFilePointer(hDisk, position, &amp;moveToHigh, FILE_BEGIN);\n\n                    if (WriteFile(hDisk, buff, 512, &amp;writenBytes, NULL) &amp;&amp; writenBytes == 512)\n                    {\n                        printf(\"OK for Sector %d \\r\\n\", sector);\n                    }\n                    else\n                    {\n                        DWORD dwError = GetLastError();\n                        printf(\"Error Code: %d \\r\\n\", dwError);\n                    }\n                }\n            }\n        }\n\n        CloseHandle(hDisk);\n    }   \n}\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "stm32", "uart", "at-command"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1573066549, "post_id": 58736805, "comment_id": 103763715, "body": "Why are you going through all the trouble of creating this arbitrary-length character buffer, using <code>sprintf</code> to print to it(??) and then sending that? This is really bizarre."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1573111588, "post_id": 58736805, "comment_id": 103776569, "body": "Would you like to tell us more about what does not work? It is not clear from your question. What do you expect? And what do you get?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1573152193, "post_id": 58736805, "comment_id": 103797931, "body": "Do you have a link to the documentation of supported AT commands for this device? If so please provide it. Also according to this documentation, <a href=\"https://www.developershome.com/sms/atCommandsIntro2.asp\" rel=\"nofollow noreferrer\">developershome.com/sms/atCommandsIntro2.asp</a> I&#39;m not sure if your <code>AT</code> command is properly formatted. Should it be <code>char* data = &quot;AT+NAME=\\&quot;charles\\&quot;\\r&quot;;</code> ?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1573152607, "post_id": 58736805, "comment_id": 103798095, "body": "If you use char* data = &quot;AT+NAME?&quot;\\r&quot;;` do you get a response back with the current name of the device? I suggest you try using queries to check that you get a response back to double check that the connection to the device is working properly."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1573152811, "post_id": 58736805, "comment_id": 103798181, "body": "And what is the infinite loop after the <code>HAL_UART_Transmit(&amp;huart3, (uint8_t *)data, strlen(data), 2000);</code>? Is there a call back or interrupt routine that is handling the UART and its response?"}, {"owner": {"reputation": 3, "user_id": 10979821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45beaebd8b4d94ff8e91409abd2baf6d?s=128&d=identicon&r=PG&f=1", "display_name": "Hernan Crespo", "link": "https://stackoverflow.com/users/10979821/hernan-crespo"}, "edited": false, "score": 0, "creation_date": 1573157965, "post_id": 58736805, "comment_id": 103800366, "body": "Yes my command is properly formatted. I checked datasheet. No i cannot get a response. There is no any interrupt or callback."}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 0, "creation_date": 1573158133, "post_id": 58736805, "comment_id": 103800438, "body": "@HernanCrespo I see at least something wrong: terminator char for AT commands is &#39;\\r&#39; only, not &#39;\\n\\r&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1573111651, "post_id": 58736835, "comment_id": 103776609, "body": "This is clearly better code and saves RAM. But it does exactly the same to the module and I&#39;m afraid that it does <i>not</i> solve the questioners problem."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1573112276, "post_id": 58736835, "comment_id": 103776894, "body": "I think <code>data</code> (in the OP code) will be initialized to 0 before jumping to the main (CRT). So I agree with @thebusybee"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1573112442, "post_id": 58736835, "comment_id": 103776968, "body": "@GuillaumePetitjean What will changed if it is not initialized? The net effect is still the same."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 1, "creation_date": 1573115412, "post_id": 58736835, "comment_id": 103778357, "body": "I fully agree, I was just reacting to the remark about uninitialised array. Anyway we don&#39;t even know what the problem is... :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1573149764, "post_id": 58736835, "comment_id": 103796913, "body": "You&#39;re going to need to be more specific than &quot;didn&#39;t work&quot;. Does the <code>HAL_UART_Transmit()</code> function return a diagnostic value?"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1573066642, "creation_date": 1573066642, "answer_id": 58736835, "question_id": 58736805, "link": "https://stackoverflow.com/questions/58736805/how-to-send-at-commands-in-keil/58736835#58736835", "title": "How to send AT commands in Keil", "body": "<p>If you want to send a character buffer:</p>\n\n<pre><code>static void MX_USART3_UART_Init(void)\n{\n   char* data = \"AT+NAME=charles \\n\\r\";\n   HAL_UART_Transmit(&amp;huart3, (uint8_t *)data, strlen(data), 2000);\n}\n</code></pre>\n\n<p>That's all you need. You called <code>sprintf</code> as if it was <code>strcpy</code> and the first argument is an uninitialized character buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6861372, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mSihsX20z30/AAAAAAAAAAI/AAAAAAAAABo/rdMlEP936EA/photo.jpg?sz=128", "display_name": "ztluo", "link": "https://stackoverflow.com/users/6861372/ztluo"}, "is_accepted": false, "score": 0, "last_activity_date": 1573109494, "creation_date": 1573109494, "answer_id": 58743362, "question_id": 58736805, "link": "https://stackoverflow.com/questions/58736805/how-to-send-at-commands-in-keil/58743362#58743362", "title": "How to send AT commands in Keil", "body": "<p>as tadman said, you don't need this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>uint8_t data[50];\n</code></pre>\n\n<p>But this is not a <code>uninitialized character buffer</code> as tadman said.</p>\n"}], "owner": {"reputation": 3, "user_id": 10979821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45beaebd8b4d94ff8e91409abd2baf6d?s=128&d=identicon&r=PG&f=1", "display_name": "Hernan Crespo", "link": "https://stackoverflow.com/users/10979821/hernan-crespo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573156619, "creation_date": 1573066469, "last_edit_date": 1573156619, "question_id": 58736805, "link": "https://stackoverflow.com/questions/58736805/how-to-send-at-commands-in-keil", "title": "How to send AT commands in Keil", "body": "<p>I am using HC-05 bluetooth module and STM32F407. I am trying to change the name of the bluetooth module. I can enter AT Command Mode, but i can't send any AT Commands to module. I tried something in <code>main</code>. But it didn't work</p>\n\n<p>I see</p>\n\n<pre><code>huart-&gt;Instance-&gt;DR = (*pData++ &amp; (uint8_t)0xFF);\n</code></pre>\n\n<p>in my Transmit function. Also, i see ascii values of elements in <code>DR</code></p>\n\n<p>Here is my try. </p>\n\n<pre><code>\n/* Includes ------------------------------------------------------------------*/\n#include \"main.h\"\n#include \"string.h\"\n\n/* Private variables ---------------------------------------------------------*/\nUART_HandleTypeDef huart3;\n\n/* Private function prototypes -----------------------------------------------*/\nvoid SystemClock_Config(void);\nstatic void MX_GPIO_Init(void);\nstatic void MX_USART3_UART_Init(void);\n\nint main(void)\n{\n  HAL_Init();\n  SystemClock_Config();\n  MX_GPIO_Init();\n  MX_USART3_UART_Init();\n  /* USER CODE BEGIN 2 */\n  char* data = \"AT+NAME=charles \\n\\r\";\n  HAL_UART_Transmit(&amp;huart3, (uint8_t *)data, strlen(data), 2000);\n  /* USER CODE END 2 */\n  while (1)\n  {\n  }\n}\n\n\nvoid SystemClock_Config(void)\n{\n  RCC_OscInitTypeDef RCC_OscInitStruct = {0};\n  RCC_ClkInitTypeDef RCC_ClkInitStruct = {0};\n\n  /** Configure the main internal regulator output voltage \n  */\n  __HAL_RCC_PWR_CLK_ENABLE();\n  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);\n  /** Initializes the CPU, AHB and APB busses clocks \n  */\n  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;\n  RCC_OscInitStruct.HSIState = RCC_HSI_ON;\n  RCC_OscInitStruct.HSICalibrationValue = RCC_HSICALIBRATION_DEFAULT;\n  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_NONE;\n  if (HAL_RCC_OscConfig(&amp;RCC_OscInitStruct) != HAL_OK)\n  {\n    Error_Handler();\n  }\n  /** Initializes the CPU, AHB and APB busses clocks \n  */\n  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK\n                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;\n  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_HSI;\n  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;\n  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;\n  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;\n\n  if (HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_0) != HAL_OK)\n  {\n    Error_Handler();\n  }\n}\n\nstatic void MX_USART3_UART_Init(void)\n{\n\n  huart3.Instance = USART3;\n  huart3.Init.BaudRate = 38400;\n  huart3.Init.WordLength = UART_WORDLENGTH_8B;\n  huart3.Init.StopBits = UART_STOPBITS_1;\n  huart3.Init.Parity = UART_PARITY_NONE;\n  huart3.Init.Mode = UART_MODE_TX_RX;\n  huart3.Init.HwFlowCtl = UART_HWCONTROL_NONE;\n  huart3.Init.OverSampling = UART_OVERSAMPLING_16;\n  if (HAL_UART_Init(&amp;huart3) != HAL_OK)\n  {\n    Error_Handler();\n  }\n}\n\n\nstatic void MX_GPIO_Init(void)\n{\n  /* GPIO Ports Clock Enable */\n  __HAL_RCC_GPIOB_CLK_ENABLE();\n}\n\n\n  [1]: https://i.stack.imgur.com/pbxqx.png\n</code></pre>\n"}, {"tags": ["c", "gcc", "makefile"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1573064834, "post_id": 58736355, "comment_id": 103762959, "body": "You should add include guards to the <code>*.h</code> files and remove them from the dependencies in the makefile. Not that it is related to your problem though"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 5, "creation_date": 1573064845, "post_id": 58736355, "comment_id": 103762964, "body": "<code>gcc -o justify.o line.o word.o</code> -&gt; <code>gcc -o justify justify.o line.o word.o</code>"}, {"owner": {"reputation": 2633, "user_id": 27898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84028aac31ee14ca90aa08c2442e3a1e?s=128&d=identicon&r=PG", "display_name": "mpez0", "link": "https://stackoverflow.com/users/27898/mpez0"}, "edited": false, "score": 2, "creation_date": 1573064879, "post_id": 58736355, "comment_id": 103762979, "body": "check the <code>gcc -o</code> line. should that not be <code>gcc -o justify justify.o line.o word.o</code>"}, {"owner": {"reputation": 387, "user_id": 11736671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZzcK.jpg?s=128&g=1", "display_name": "Roberto Rocco", "link": "https://stackoverflow.com/users/11736671/roberto-rocco"}, "edited": false, "score": 0, "creation_date": 1573069285, "post_id": 58736355, "comment_id": 103764830, "body": "Thanks, everyone, including you Eugene Sh. The &#39;include guards&#39; are very interesting."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1573069399, "post_id": 58736355, "comment_id": 103764875, "body": "The issue that @tkausl pointed out, while valid, would not explain the message you&#39;re seeing, so something else is going on..   It looks like line.o was compiled for another architecture.   Do an <code>objdump -f line.o</code>.   Then delete the .o file, and recompile from the command line and check again.    If the makefile is producing different output than the command line, then try running <code>which gcc</code> from both your shell and a makefile recipe to see if there&#39;s an issue with the path."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "reply_to_user": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1573069779, "post_id": 58736355, "comment_id": 103765017, "body": "@HardcoreHenry <code>would not explain the message you&#39;re seeing</code> It does since neither <code>line.o</code> nor <code>word.o</code> contain the main function."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1573070101, "post_id": 58736355, "comment_id": 103765160, "body": "Ahh yes, I stand corrected."}, {"owner": {"reputation": 387, "user_id": 11736671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZzcK.jpg?s=128&g=1", "display_name": "Roberto Rocco", "link": "https://stackoverflow.com/users/11736671/roberto-rocco"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1573078979, "post_id": 58736355, "comment_id": 103768561, "body": "@tkausl Yours would be the solution to my problem, what should I do to confirm that it is the correct answer?"}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 11736671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZzcK.jpg?s=128&g=1", "display_name": "Roberto Rocco", "link": "https://stackoverflow.com/users/11736671/roberto-rocco"}, "edited": false, "score": 0, "creation_date": 1573071013, "post_id": 58736940, "comment_id": 103765524, "body": "difficult to find better explanation..."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1573067051, "creation_date": 1573067051, "answer_id": 58736940, "question_id": 58736355, "link": "https://stackoverflow.com/questions/58736355/how-to-use-makefile-from-a-very-simple-example/58736940#58736940", "title": "How to use Makefile from a very simple example", "body": "<p>No pun intended, but you are making make a bit harder than it needs to be. In your case with the source and headers all in the same directory, it is quite simple to use wildcards to allow make to handle the rest. For example with three simple variable declartions in your <code>Makefile</code>, you can tell make what your sources are, your includes and how to generate an object file for each of the source files that isn't the application name.</p>\n\n<p>For starters, specify your application name:</p>\n\n<pre><code># application name\nAPPNAME := justify\n</code></pre>\n\n<p>If needed, set your compiler variables, e.g.</p>\n\n<pre><code># compiler\nCC      := gcc\nCCLD    := $(CC)\n</code></pre>\n\n<p>Now make knows your application name is held in <code>APPNAME</code> which you access like any other variable in a <code>Makefile</code> as <code>$(APPNAME)</code>.</p>\n\n<p>Now just use <code>wildcard</code> to collect all sources and includes in variables as well, and let <code>make</code> associate the object file output:</p>\n\n<pre><code># source/include/object variables\nSOURCES := $(wildcard *.c)\nINCLUDES := $(wildcard *.h)\nOBJECTS := $(SOURCES:%.c=%.o)\n</code></pre>\n\n<p>Set your compiler/linker/library flags:</p>\n\n<pre><code># compiler and linker flags\nCFLAGS  := -Wall -Wextra -pedantic -finline-functions -std=c11 -Wshadow -Ofast\nLDFLAGS :=\n# libraries\nLIBS    :=\n</code></pre>\n\n<p>Now create your default target for <code>make</code> (<strong>note:</strong> there must be a <em>tab-character</em> <code>'\\t'</code> in front of each rule):</p>\n\n<pre><code>all:    $(OBJECTS)\n    $(CCLD) -o $(APPNAME) $(OBJECTS) $(CFLAGS) $(LDFLAGS) $(LIBS)\n</code></pre>\n\n<p>A rule to compile all sources to objects:</p>\n\n<pre><code>$(OBJECTS): %.o : %.c\n    $(CC) $(CFLAGS) -c -o $@ $&lt;\n</code></pre>\n\n<p>(see: <a href=\"https://stackoverflow.com/questions/3220277/what-do-the-makefile-symbols-and-mean\">What do the makefile symbols $@ and $&lt; mean?</a> for explanation of the automatic variables used)</p>\n\n<p>And finally a target for <code>clean:</code></p>\n\n<pre><code>clean:\n    rm -rf $(APPNAME) *.o\n</code></pre>\n\n<p>A complete example for your files would be:</p>\n\n<pre><code># application name\nAPPNAME := justify\n# compiler\nCC      := gcc\nCCLD    := $(CC)\n# compiler and linker flags\nCFLAGS  := -Wall -Wextra -pedantic -finline-functions -std=c11 -Wshadow -Ofast\nLDFLAGS :=\n# libraries\nLIBS    :=\n# source/include/object variables\nSOURCES := $(wildcard *.c)\nINCLUDES := $(wildcard *.h)\nOBJECTS := $(SOURCES:%.c=%.o)\n\n# target for all\nall:    $(OBJECTS)\n    $(CCLD) -o $(APPNAME) $(OBJECTS) $(CFLAGS) $(LDFLAGS) $(LIBS)\n# strip only if -DDEBUG not set\nifneq ($(debug),-DDEBUG)\n    strip -s $(APPNAME)\nendif\n\n$(OBJECTS): %.o : %.c\n    $(CC) $(CFLAGS) -c -o $@ $&lt;\n\nclean:\n    rm -rf $(APPNAME) *.o\n</code></pre>\n\n<p>(<strong>note:</strong> a rule to <code>strip</code> the executable was also added to the <code>all:</code> target)</p>\n\n<p><strong>Example Build</strong></p>\n\n<p>With your <code>Makefile</code> source and include files in a common directory, e.g.</p>\n\n<pre><code>$ ll\ntotal 24\n-rw-r--r-- 1 david david 668 Nov  6 12:38 Makefile\n-rw-r--r-- 1 david david 161 Nov  6 12:31 justify.c\n-rw-r--r-- 1 david david 106 Nov  6 12:32 line.c\n-rw-r--r-- 1 david david  37 Nov  6 12:31 line.h\n-rw-r--r-- 1 david david 104 Nov  6 12:32 word.c\n-rw-r--r-- 1 david david  36 Nov  6 12:32 word.h\n</code></pre>\n\n<p>Just type <code>make</code> to have your application built:</p>\n\n<pre><code>$ make\ngcc -Wall -Wextra -pedantic -finline-functions -std=c11 -Wshadow -Ofast -c -o word.o word.c\ngcc -Wall -Wextra -pedantic -finline-functions -std=c11 -Wshadow -Ofast -c -o line.o line.c\ngcc -Wall -Wextra -pedantic -finline-functions -std=c11 -Wshadow -Ofast -c -o justify.o justify.c\ngcc -o justify word.o line.o justify.o -Wall -Wextra -pedantic -finline-functions -std=c11 -Wshadow -Ofast\nstrip -s justify\n</code></pre>\n\n<p>No errors, you can check all files were created as expected:</p>\n\n<pre><code>$ ll\ntotal 44\n-rw-r--r-- 1 david david  668 Nov  6 12:38 Makefile\n-rwxr-xr-x 1 david david 6312 Nov  6 13:01 justify\n-rw-r--r-- 1 david david  161 Nov  6 12:31 justify.c\n-rw-r--r-- 1 david david 1760 Nov  6 13:01 justify.o\n-rw-r--r-- 1 david david  106 Nov  6 12:32 line.c\n-rw-r--r-- 1 david david   37 Nov  6 12:31 line.h\n-rw-r--r-- 1 david david 1496 Nov  6 13:01 line.o\n-rw-r--r-- 1 david david  104 Nov  6 12:32 word.c\n-rw-r--r-- 1 david david   36 Nov  6 12:32 word.h\n-rw-r--r-- 1 david david 1496 Nov  6 13:01 word.o\n</code></pre>\n\n<p>Test your executable:</p>\n\n<pre><code>$ ./justifiy\nI'm in the main.\nread_word\nwrite_line\n</code></pre>\n\n<p>Lastly, clean your build directory with <code>make clean</code>, e.g.</p>\n\n<pre><code>$ make clean\n</code></pre>\n\n<p>And confirm all build files are removed.</p>\n\n<p>That's about the easiest way to go about writing minimal make files. You can list each object individually and the required includes to support them, but why? the automatic variables will take care of that for you. There is much, much more you can do with Makefiles, but for getting started, this will make your life easier.</p>\n"}, {"tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 1, "last_activity_date": 1573068002, "last_edit_date": 1573068002, "creation_date": 1573067697, "answer_id": 58737087, "question_id": 58736355, "link": "https://stackoverflow.com/questions/58736355/how-to-use-makefile-from-a-very-simple-example/58737087#58737087", "title": "How to use Makefile from a very simple example", "body": "<p>You can heavily simplify the <code>Makefile</code> you have. Make provides lots of helpful variables.</p>\n\n<pre><code>$@ - target name\n$&lt; - first prequisite\n$^ - all prequsites\n</code></pre>\n\n<pre><code>justify: justify.o line.o word.o\n        gcc -o $@ $^    # this one will turn into\n                        # gcc -o justify justify.o line.o word.o \n\njustify.o: justify.c\n        gcc -c $&lt;       # this one will turn into\n                        # gcc -c justify.c\n\nline.o: line.c\n        gcc -c $&lt;\n\nword.o: word.c\n        gcc -c $&lt;\n</code></pre>\n\n<p>it's also a good idea to add <code>clean</code></p>\n\n<pre><code>clean:\n        -rm *.o justify\n</code></pre>\n\n<pre><code>-rm - minus sign at the beginning will not produce error if command fails;   \n      useful in case you expect that something might be missing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 374, "user_id": 1264830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a84fd83d4de659ff527d252d06b98d?s=128&d=identicon&r=PG&f=1", "display_name": "AliA", "link": "https://stackoverflow.com/users/1264830/alia"}, "is_accepted": false, "score": 0, "last_activity_date": 1573070434, "creation_date": 1573070434, "answer_id": 58737653, "question_id": 58736355, "link": "https://stackoverflow.com/questions/58736355/how-to-use-makefile-from-a-very-simple-example/58737653#58737653", "title": "How to use Makefile from a very simple example", "body": "<p>There is bug in your make file. The commands for the make target <code>justify:</code> are missing the output file name. It should be like this.</p>\n\n<pre><code>gcc -o justify justify.o line.o word.o\n</code></pre>\n\n<p>with your current command line the gcc will try to output justify.o by linking line.o and word.o and the it does not find <code>_main</code> which is not defined in line.o and word.o</p>\n\n<p>The make command already knows how to convert a <code>.c</code> file to <code>.o</code> so you do not need to tell this to make again in the make file. Keeping this in mind, the following make file is enough for your test case.</p>\n\n<pre><code># Makefile \njustify: justify.o line.o word.o\n    gcc -o justify justify.o line.o word.o\n</code></pre>\n\n<p>You can further simplify this by using make's built-in automatic variables. <code>$@</code> and <code>$^</code>. The <code>$@</code> variable contains the name of the target of rule. and <code>$^</code> contains the name of all the prerequisites of the rule. So using these two variables your make file will be.</p>\n\n<pre><code>justify: justify.o line.o word.o\n        gcc -o $@ $^\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 11736671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZzcK.jpg?s=128&g=1", "display_name": "Roberto Rocco", "link": "https://stackoverflow.com/users/11736671/roberto-rocco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "closed_date": 1573070818, "answer_count": 3, "score": -2, "last_activity_date": 1573070434, "creation_date": 1573064548, "question_id": 58736355, "link": "https://stackoverflow.com/questions/58736355/how-to-use-makefile-from-a-very-simple-example", "closed_reason": "Not suitable for this site", "title": "How to use Makefile from a very simple example", "body": "<p>I'm trying to learn how Makefile works, so I decided to try it with a very simple code. This is what I wrote:</p>\n\n<pre><code>/* justify.c */\n\n#include &lt;stdio.h&gt;\n#include \"line.h\"\n#include \"word.h\"\n\nint main(void) {\n    printf(\"I'm in the main.\\n\");\n    read_word();\n    write_line();\n}\n</code></pre>\n\n<pre><code>/* line.h */\n\nvoid write_line(void);\n</code></pre>\n\n<pre><code>/* line.c */\n\n#include &lt;stdio.h&gt;\n#include \"line.h\"\n\nvoid write_line(void) {\n    printf(\"write_line\\n\");\n}\n</code></pre>\n\n<pre><code>/* word.h */\n\nvoid read_word(void);\n</code></pre>\n\n<pre><code>/* word.c */\n\n#include &lt;stdio.h&gt;\n#include \"word.h\"\n\nvoid read_word(void) {\n    printf(\"read_word\\n\");\n}\n</code></pre>\n\n<p>now ... if I do everything from the terminal it works:</p>\n\n<pre><code>&gt; gcc -c justify.c\n&gt; gcc -c line.c\n&gt; gcc -c word.c\n&gt; gcc -o justify justify.c line.c word.c\n</code></pre>\n\n<p>but if I try to do everything with a Makefile it gives me an error:</p>\n\n<pre><code># Makefile \n\njustify: justify.o line.o word.o\n    gcc -o justify.o line.o word.o\n\njustify.o: justify.c line.h word.h\n    gcc -c justify.c\n\nline.o: line.c line.h\n    gcc -c line.c\n\nword.o: word.c word.h\n    gcc -c word.c\n</code></pre>\n\n<pre><code>&gt; make justify\n\nUndefined symbols for architecture x86_64:\n  \"_main\", referenced from:\n     implicit entry/start for main executable\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 6, "last_activity_date": 1573063978, "creation_date": 1573063978, "answer_id": 58736213, "question_id": 58736158, "link": "https://stackoverflow.com/questions/58736158/why-printf-is-not-printing-only-the-ini-string/58736213#58736213", "title": "why printf is not printing only the ini string?", "body": "<p>Strings require a null terminator.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main(){\n    char ini[11]={'a','b','c','d','e','f','g','h','i','j', 0};\n    char final[11];\n\n    for (int i = 0; i &lt; 10 ; i++) {\n        final[i]=ini[10-1-i];\n    }\n    final[10] = 0;\n    printf(\"%s\\n\\n\",ini);\n    printf(\"%s\",final);\n}\n</code></pre>\n\n<p>If you use a string literal as the initializer, it includes the terminator automatically. The following is equivalent:</p>\n\n<pre><code>char ini[] = \"abcdefghij\";\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12333628, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FE9T9MuKcls/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRZTg3ApUirO1VsGfOFLjFdLlBpA/photo.jpg?sz=128", "display_name": "Jorge Teixeira", "link": "https://stackoverflow.com/users/12333628/jorge-teixeira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1573064705, "accepted_answer_id": 58736213, "answer_count": 1, "score": -1, "last_activity_date": 1573064470, "creation_date": 1573063797, "last_edit_date": 1573063873, "question_id": 58736158, "link": "https://stackoverflow.com/questions/58736158/why-printf-is-not-printing-only-the-ini-string", "closed_reason": "Duplicate", "title": "why printf is not printing only the ini string?", "body": "<p>I need to copy the \"ini\" string to the \"final\" string inverting the character order, but when i print the string \"ini\" it appears to print \"ini\" and \"final\" together.</p>\n\n<p>Language: C</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main(){\n    char ini[10]={'a','b','c','d','e','f','g','h','i','j'};\n    char final[10];\n\n    for (int i = 0; i &lt; 10 ; i++) {\n        final[i]=ini[10-1-i];\n    }\n    printf(\"%s\\n\\n\",ini);\n    printf(\"%s\",final);\n}\n</code></pre>\n\n<p>My output is:</p>\n\n<pre><code>abcdefghijjihgfedcba\n\njihgfedcba\n</code></pre>\n\n<p>But it should be this:</p>\n\n<pre><code>abcdefghij\n\njihgfedcba\n</code></pre>\n"}, {"tags": ["c", "null", "rhel", "hp-ux", "strchr"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1573063570, "post_id": 58736028, "comment_id": 103762360, "body": "Depending on the way a process&#39;s address space is set up, a null pointer can <i>look like</i> an empty string. (And on such systems, it&#39;s easy to accidentally write code that depends on this.)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1573063577, "post_id": 58736028, "comment_id": 103762364, "body": "C functions are not <i>required</i> to be &quot;kind&quot; when you pass a <code>NULL</code> pointer, but some are, for example MSVC&#39;s <code>printf</code> will output <code>(null)</code> but its <code>puts</code> will fail."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1573063622, "post_id": 58736028, "comment_id": 103762388, "body": "Passing an invalid pointer to <code>strchr</code> or to <code>printf</code> is undefined behavior. (You increment a <code>NULL</code> pointer and pass this to <code>strchr</code>.) Maybe on HPUX <code>strchr</code> returns a <code>NULL</code> pointer in this case  and maybe <code>printf</code> prints nothing when you supply an invalid pointer. You should <a href=\"https://stackoverflow.com/posts/58736028/edit\">edit</a> your question and show the source code including the <code>printf</code>s. You should also print the pointer values with <code>printf(&quot;phrase=%p\\n&quot;, phrase);</code>"}, {"owner": {"reputation": 87, "user_id": 11907992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85518ed70c0df3b94509f9ca9778f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11907992/kyle"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1573068083, "post_id": 58736028, "comment_id": 103764348, "body": "@Bodo I&#39;ll edit now, but the point is that the strchr function itself is causing the segfault when asked to find a character in the null pointer (that has been incremented), but on HPUX it doesn&#39;t.  So it&#39;s either returning an empty string that is then passed strchr on the next loop, or strchr is handling the null pointer parameter differently by not segfaulting.  Or I misunderstand what&#39;s happening."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1573068482, "post_id": 58736028, "comment_id": 103764513, "body": "Check whether de-referencing NULL on HPUX causes a SIGSEGV?   Long ago, some BSD&#39;s would map a readonly page of zeroes at NULL, so that &quot;&quot; and NULL were effectively synonyms.   I thought it went out of style in the 1990s.   If you are stuck with a source-base that relies on this, you might find mapping a zero page to address zero with MAP_FIXED might help you sleep at night."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1573068514, "post_id": 58736028, "comment_id": 103764528, "body": "@Kyle (ec) My guess (alluded to in my first comment, and echoed by mevets above) is that it has nothing to do with the way <code>strchr</code> or <code>printf</code> is written.  My guess is that under HPUX, when you do the equivalent of <code>*(char *)0</code>, <code>*(char *)1</code>, etc., you get accesses to actual bytes in page 0 of your address space, not segmentation violations as you do under Linux.  So <code>strchr</code> can search there until it finds a null byte, and <code>printf</code> can print there until it finds a null byte.  (And if page 0 contains nothing but zeroes, both searches will always be satisfied quickly.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1573068626, "post_id": 58736028, "comment_id": 103764579, "body": "@Kyle And it&#39;s to answer this hypothesis that Bodo suggested printfing the pointer values <i>and</i> the substrings."}, {"owner": {"reputation": 87, "user_id": 11907992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85518ed70c0df3b94509f9ca9778f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11907992/kyle"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1573069264, "post_id": 58736028, "comment_id": 103764825, "body": "@SteveSummit mevets This sounds like something that would be happening with this project.  Thank you for suggesting it.  I just adjusted the code to dereference null for an int and it came back as 0 on HPUX but segfaulted on RHEL. mevets I should do this then? Map &quot;a zero page to address zero with MAP_FIXED&quot; (No idea what this means but I don&#39;t mind figuring it out if it&#39;s what I need to do).  Thanks."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1573069664, "post_id": 58736028, "comment_id": 103764973, "body": "Although I know what @mevets meant by it, I have no idea how to go about actually mapping in a page like that under Linux, so in this situation I would have no choice but to chase down and fix all the null pointer access bugs.  (The good news is that they&#39;re easy to find, because Linux points each one of them out to you with a nice, impossible-to-overlook Segmentation Fault.)"}, {"owner": {"reputation": 87, "user_id": 11907992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85518ed70c0df3b94509f9ca9778f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11907992/kyle"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1573069924, "post_id": 58736028, "comment_id": 103765085, "body": "@SteveSummit that would be a bummer, the program is huge... if that&#39;s the case is there anything I can add to the top of the c files that will mimic the behavior?"}, {"owner": {"reputation": 87, "user_id": 11907992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85518ed70c0df3b94509f9ca9778f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11907992/kyle"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1573070956, "post_id": 58736028, "comment_id": 103765487, "body": "@mevets is there a way to confirm on hpux if this is the case?  I pretty much know it is based on behavior but is there an actual command to see if a page of zeroes has been mapped to null?"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1573071794, "post_id": 58736028, "comment_id": 103765866, "body": "I put it in answer because code.   The root requirement is a hack, rather than fix the kernel to not jump to null occasionally, it inhibits the user from using this bit of her space."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1573118018, "post_id": 58736028, "comment_id": 103779616, "body": "@Kyle Your code contains undefined behavior (dereferencing a pointer of value 0 or 1). You should fix the code instead of trying to make this wrong code work on Linux. In general you should <b>check the return value of all function calls and handle all errors or special results</b>. In your example you should check for <code>NULL</code> result after <code>strchr</code>, e.g. add <code>if(!phrase) break;</code>. (This is a simple fix. I would rather re-write the loop.)"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 11907992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85518ed70c0df3b94509f9ca9778f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11907992/kyle"}, "edited": false, "score": 0, "creation_date": 1573072424, "post_id": 58737882, "comment_id": 103766160, "body": "I followed the instructions and it did not sigsegv.  Is that second part something that needs to run once?  Or every time the program runs?"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 87, "user_id": 11907992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85518ed70c0df3b94509f9ca9778f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11907992/kyle"}, "edited": false, "score": 0, "creation_date": 1573072606, "post_id": 58737882, "comment_id": 103766242, "body": "RHEL must have mmap; it is used for all sorts of things, including loading shared objects which are a little too common."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 1, "last_activity_date": 1573071500, "creation_date": 1573071500, "answer_id": 58737882, "question_id": 58736028, "link": "https://stackoverflow.com/questions/58736028/c-strchr-works-with-null-value-on-hpux-but-segfaults-on-rhel/58737882#58737882", "title": "C strchr works with NULL value on HPUX but segfaults on RHEL", "body": "<p>Make two files, r.c, main.c as such\nr.c:</p>\n\n<pre><code>int *r = 0;\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>extern int *r;\nint main(void) {\n     return *r;\n}\n</code></pre>\n\n<p>then cc main.c r.c; ./a.out\nif it doesn't sigsegv, your runtime is mapping a page of nulls for you.\nyou could do it yourself - main.c:</p>\n\n<pre><code>#include &lt;sys/mman.h&gt;\nint main(void) {\n    p = mmap(0, 1, PROT_READ, MAP_ANON|MAP_PRIVATE|MAP_FIXED, -1, 0);\n    if (p == MAP_FAILED) {\n        perror(\"mmap\");\n        exit(1);\n    }\n     ....\n}\n</code></pre>\n\n<p>but at least on ubuntu, you need to be root :(</p>\n"}], "owner": {"reputation": 87, "user_id": 11907992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85518ed70c0df3b94509f9ca9778f51?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11907992/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 58737882, "answer_count": 1, "score": 0, "last_activity_date": 1573071500, "creation_date": 1573063150, "last_edit_date": 1573068151, "question_id": 58736028, "link": "https://stackoverflow.com/questions/58736028/c-strchr-works-with-null-value-on-hpux-but-segfaults-on-rhel", "title": "C strchr works with NULL value on HPUX but segfaults on RHEL", "body": "<p>I'm moving some code from HPUX 11.11 to RHEL 7.5 and it includes a function that uses strchr.  On HPUX it runs fine, and on RHEL there is a segmentation fault.  I isolated the code and created the following simple test, with the subsequent results.  It looks like HPUX strchr is returning an empty string rather than NULL when the character is not found.  This is not what the man page says.  I have found it might not be the strchr function but the difference in how HPUX handles NULL values, or a difference in compiler from cc to gcc.  Does anyone actually know what's happening here?  Why is the code not segfaulting on HPUX?</p>\n\n<p>C Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[]) {\n    int i = 0;\n    char* phrase = \"Here is my phrase.\";\n    while (i &lt; 5){\n        phrase = strchr(phrase, ' ');\n        ++phrase;\n\n        ++i;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>HPUX makefile:</p>\n\n<pre><code>BIN=/path/to/bin/\nCFLAGS=-c\n\n#----------Targets----------#\ndefault: $(BIN)strchrtest\n\n#----------Objects----------#\nOBJS = strchrtest.o\n\n#----------------BUILD----------------#\n$(BIN)strchrtest: $(OBJS) \n    cc -o $@ $(OBJS) \n\nstrchrtest.o: strchrtest.c\n    cc $(CFLAGS) strchrtest.c\n</code></pre>\n\n<p>RHEL makefile:</p>\n\n<pre><code>CC=gcc\nBIN=/path/to/bin/\nCFLAGS=-c -g -Wall\n\n#----------Targets----------#\ndefault: $(BIN)strchrtest\n\n#----------Objects----------#\nOBJS = strchrtest.o\n\n#----------------BUILD----------------#\n$(BIN)strchrtest: $(OBJS) \n    $(CC) -o $@ $(OBJS) \n\nstrchrtest.o: strchrtest.c\n    $(CC) $(CFLAGS) strchrtest.c\n</code></pre>\n\n<p>HPUX is just a successful result.  No segmentation fault.</p>\n\n<p>RHEL results:</p>\n\n<pre><code>(gdb) run\nStarting program: ../strchrtest\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff7b4c5f4 in __strchr_sse42 () from /lib64/libc.so.6\n</code></pre>\n\n<p>Copied form my comment below:  The point is that the strchr function itself is causing the segfault when asked to find a character in the null pointer (that has been incremented), but on HPUX it doesn't. So it's either returning an empty string that is then passed strchr on the next loop, or strchr is handling the null pointer parameter differently by not segfaulting. Or I misunderstand what's happening. </p>\n"}, {"tags": ["c++", "c", "unions", "porting"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573061614, "post_id": 58735640, "comment_id": 103761465, "body": "C and C++ are two very different languages. Unions is one area where they differ a lot."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1573061714, "post_id": 58735640, "comment_id": 103761523, "body": "And type punning that way would be UB in C++"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573061834, "post_id": 58735640, "comment_id": 103761585, "body": "C and C++ are different languages.  It&#39;s useful to get into the habit that what works in one is not guaranteed to work in the other.  This only gets more true and time goes on and the languages diverge even more.  Pretend you are working with Python and Java instead and attack the problem from the different languages idioms."}], "answers": [{"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1573064289, "post_id": 58736032, "comment_id": 103762675, "body": "Writing to one union member and reading from another is UB in C++. Also,  <code>--std=c++14</code> can&#39;t be right? It looks like C++20. Edit: <a href=\"https://godbolt.org/z/hgfQjt\" rel=\"nofollow noreferrer\">godbolt.org/z/hgfQjt</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1573065270, "post_id": 58736032, "comment_id": 103763163, "body": "Compiles != valid."}, {"owner": {"reputation": 88, "user_id": 4868875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ76T.jpg?s=128&g=1", "display_name": "Berthin", "link": "https://stackoverflow.com/users/4868875/berthin"}, "edited": false, "score": 0, "creation_date": 1573115366, "post_id": 58736032, "comment_id": 103778335, "body": "@bodo Thanks for pointing out the initialization order! It compiles with no errors in my pc when I tested :). I am accepting Christophe&#39;s answer since he elaborates a little bit more though."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": -2, "last_activity_date": 1573116227, "last_edit_date": 1573116227, "creation_date": 1573063176, "answer_id": 58736032, "question_id": 58735640, "link": "https://stackoverflow.com/questions/58735640/initialize-union-with-nested-structs/58736032#58736032", "title": "Initialize union with nested structs", "body": "<p>This works in C and C++:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\ntypedef union Word_t\n{\n    uint32_t word32Bits;\n    struct\n    {\n        uint16_t leastSignificant16Bits;\n        uint16_t mostSignificant16Bits;\n    } _word16Bits;\n} Word_t;\n\nint main()\n{\n    Word_t w1 = {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    Word_t w2 = {._word16Bits={.leastSignificant16Bits = 0xABCD, .mostSignificant16Bits = 0x1234}};\n    printf(\"%x\\n\", w2.word32Bits);\n\n    return 0;\n}\n</code></pre>\n\n<p>Edit: <code>--std=c++2a</code> instead of <code>--std=c++14</code> is needed for designated initializers.</p>\n\n<pre><code>$ g++ -Wall -Wextra test.c --std=c++2a -pedantic -pedantic-errors -o a &amp;&amp; ./a\n1234abcd\n1234abcd\n$ gcc -Wall -Wextra test.c -pedantic -pedantic-errors -o a &amp;&amp; ./a\n1234abcd\n1234abcd\n</code></pre>\n\n<p>Note: In C++ you have to specify the tagged initializers in the same order as in the structure declaration.</p>\n\n<p>As mentioned in Ted Lyngmo's comment, writing to one union member and reading from another is undefined behavior in C++.</p>\n\n<p>In any case using a union to extract shorter parts from a longer data type or combine them is implementation-dependent. On a big-endian system, the order of <code>leastSignificant16Bits</code> and <code>mostSignificant16Bits</code> would be reversed.</p>\n"}, {"comments": [{"owner": {"reputation": 88, "user_id": 4868875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ76T.jpg?s=128&g=1", "display_name": "Berthin", "link": "https://stackoverflow.com/users/4868875/berthin"}, "edited": false, "score": 0, "creation_date": 1573115516, "post_id": 58737734, "comment_id": 103778394, "body": "Thanks for the detailed explanation!"}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 3, "last_activity_date": 1573073294, "last_edit_date": 1573073294, "creation_date": 1573070770, "answer_id": 58737734, "question_id": 58735640, "link": "https://stackoverflow.com/questions/58735640/initialize-union-with-nested-structs/58737734#58737734", "title": "Initialize union with nested structs", "body": "<h2>Syntactic issues</h2>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">Designated initializers</a> in aggregate initialization are formally part of the <a href=\"https://stackoverflow.com/a/29337570/3723423\">C++20 standard</a>. </p>\n\n<p>They come however with serious constraints compared to C99: </p>\n\n<ul>\n<li>They have to appear in the same order than the declaration;</li>\n<li>All the designated elements must be direct members of the aggregate;</li>\n<li>Nesting is possible only if initializer are nested</li>\n</ul>\n\n<p>In your case, the following would compile, but it would fail to provide the flexibility benefits that you expect from the explicit naming : </p>\n\n<pre><code>Word_t w2 = (Word_t) {._word16Bits  { .leastSignificant16Bits = 0xABCD, .mostSignificant16Bits = 0x1234} };\n</code></pre>\n\n<h2>More serious issues</h2>\n\n<p>First, this code, if it would work, is not portable: it assumes <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">little endianness</a> of the target architecture. </p>\n\n<p>Second, and this is crucial here, C++ has strong constraints on unions.  These are necessary in view of the consistency of the object lifecycle. In particular:  </p>\n\n<blockquote>\n  <p><strong>[class.union]/1</strong>: In a union, at most one of the non-static data members can be active at any time, that is, the value of at most one\n  of the non-static data members can be stored in a union at any time.</p>\n</blockquote>\n\n<p>So if you construct the union with one member active (the one used in your initializer), the other member is not active and you should not access it.  The only exception foreseen is not applicable to your case:  </p>\n\n<blockquote>\n  <p>[ Note: One special guarantee is made in order to simplify the use of\n  unions: If a standard-layout union contains several standard-layout\n  structs that share a common initial sequence, and if an object\n  of this standard-layout union type contains one of the standard-layout\n  structs, <strong>it is permitted to inspect</strong> the common initial sequence of any\n  of standard-layout struct members; \u2014 end note ]</p>\n</blockquote>\n\n<p>The standard also give hints about the way to change the active member of the union: </p>\n\n<blockquote>\n  <p>[ Note: In general, one must use explicit destructor calls and\n  placement new operators to change the active member of a union. \u2014 end\n  note ]</p>\n</blockquote>\n\n<p>This being said for simple scalar types, it may compile and work as you expect on most of the mainstream compilers. </p>\n\n<p>But the point is, that <strong>the usage you make of unions is incompatible with the standard</strong>.  It's UB, and even if it works on some implementations now, at every new compiler release, you'll have no guarantee that it will continue to work, putting all your investments at risks.</p>\n\n<h2>Why it is time to change approach ?</h2>\n\n<p>The C99 has less constraints on unions as C++.  But it gives no firm guarantee either about the value that might be read in one union member when another union member was set:  </p>\n\n<blockquote>\n  <p><strong>6.2.6.1/7</strong>: When a value is stored in a member of an object of union type, the bytes of the object representation that do not\n  correspond to that member but do correspond to other members take\n  unspecified values.</p>\n</blockquote>\n\n<p>It is mentioned in annex C99/J that this usage of unions is an unspecified behavior that can create portability issues.  </p>\n"}], "owner": {"reputation": 88, "user_id": 4868875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ76T.jpg?s=128&g=1", "display_name": "Berthin", "link": "https://stackoverflow.com/users/4868875/berthin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 58737734, "answer_count": 2, "score": 2, "last_activity_date": 1573918416, "creation_date": 1573061522, "last_edit_date": 1573918416, "question_id": 58735640, "link": "https://stackoverflow.com/questions/58735640/initialize-union-with-nested-structs", "title": "Initialize union with nested structs", "body": "<p>I am porting C99 code to C++(14 or 17), and in many places the list initializer is used. Now I am getting compilation errors and would like to know the simplest way to initalize a union nested by a struct. For instance, the following snippet in C works just fine:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ntypedef union Word_t\n{\n    uint32_t word32Bits;\n    struct\n    {\n        uint16_t leastSignificant16Bits;\n        uint16_t mostSignificant16Bits;\n    };\n} Word_t;\n\nint main()\n{\n    Word_t w1 = (Word_t) {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n    printf(\"%x\\n\", w2.word32Bits);\n\n    return 0;\n}\n\n\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ gcc test.c --std=c99 -o a &amp;&amp; ./a\n1234abcd\n1234abcd\n</code></pre>\n\n<p>However, in C++ it does not compile:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ntypedef union Word_t\n{\n    uint32_t word32Bits;\n    struct\n    {\n        uint16_t leastSignificant16Bits;\n        uint16_t mostSignificant16Bits;\n    } _word16Bits;\n} Word_t;\n\nint main()\n{\n    Word_t w1 = (Word_t) {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n    printf(\"%x\\n\", w2.word32Bits);\n\n    return 0;\n}\n\n\n```bash\n$ g++ test.c --std=c++14 -o a &amp;&amp; ./a\ntest.c: In function \u2018int main()\u2019:\ntest.c:57:92: error: \u2018Word_t\u2019 has no non-static data member named \u2018mostSignificant16Bits\u2019\n     Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n</code></pre>\n\n<p>The work-araound solution I found is to zero-initalize and then set the internal values of the struct as following:</p>\n\n<pre><code>\nint main()\n{\n    Word_t w1 = (Word_t) {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    <del>Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n</del>\n\n    Word_t w2 = {0};\n    w2._word16Bits = {0x1234, 0xABCD};\n\n    return 0;\n}\n</code></pre>\n\n<p>Which works, but it doesn't allow me to explicitly say <code>.mostSignificant16Bits = 0x1234</code> for instance -- which I think is kind of useful, specially when reading the code.</p>\n\n<p>I tried couple of things like defining static members, creating a user-defined constructor, but still no idea how to simplify the refactor that I am going to do. Ideally, I would like to leave the variable declaration as how it is <code>Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD}</code> while all the changes are done in the definition of <code>Word_t</code>.</p>\n"}, {"tags": ["c++", "c", "intellisense"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12333445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b172c6cd38e0469c7c8d4dad342b131?s=128&d=identicon&r=PG&f=1", "display_name": "Ebru", "link": "https://stackoverflow.com/users/12333445/ebru"}, "is_accepted": false, "score": 0, "last_activity_date": 1573061307, "creation_date": 1573061307, "answer_id": 58735592, "question_id": 58735409, "link": "https://stackoverflow.com/questions/58735409/c-c-intellisense-0-26-1-not-displaying-list-of-struct-members/58735592#58735592", "title": "C/C++ intellisense 0.26.1 not displaying list of struct members", "body": "<p>Edit: Just found out this only happens if i am trying to introduce a line between two finished lines of code (both ending with ;). Maybe intellisense does not work then because it sees a compile-time error?</p>\n"}], "owner": {"reputation": 11, "user_id": 12333445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b172c6cd38e0469c7c8d4dad342b131?s=128&d=identicon&r=PG&f=1", "display_name": "Ebru", "link": "https://stackoverflow.com/users/12333445/ebru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573061307, "creation_date": 1573060624, "question_id": 58735409, "link": "https://stackoverflow.com/questions/58735409/c-c-intellisense-0-26-1-not-displaying-list-of-struct-members", "title": "C/C++ intellisense 0.26.1 not displaying list of struct members", "body": "<p>C/C++ intellisense is only displaying suggestions of struct members after i type some letter that is in their names, then it suggests possible matches. However, i would like it to show every possible struct member as soon as . or -> is typed. Is this a setting i`m missing?</p>\n"}, {"tags": ["c", "gcc", "compiler-warnings"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1573062356, "post_id": 58735374, "comment_id": 103761820, "body": "If it turns out there is no well-defined way to disable these suggestions, I&#39;d say a bug report / feature request to the gcc maintainers is in order."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1573116223, "post_id": 58735374, "comment_id": 103778758, "body": "Just <code>-Werror=implicit-function-declaration</code>"}, {"owner": {"reputation": 326, "user_id": 10760539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e712e5f20edef2b255feb415d56d1?s=128&d=identicon&r=PG", "display_name": "Impudent Snob", "link": "https://stackoverflow.com/users/10760539/impudent-snob"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1573116389, "post_id": 58735374, "comment_id": 103778838, "body": "@KamilCuk that will turn that warning into an error, but it won&#39;t suppress the suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1573066661, "post_id": 58735554, "comment_id": 103763765, "body": "Consider <code>gcc ... 2&gt; &gt;(sed ... &gt;&amp;2)</code> to filter only stderr, and emit the filtered results <i>back</i> to the original program&#39;s stderr. (Not that the approach is unambiguously better -- sending stdout and stderr to different sinks means that there&#39;s no longer a well-defined ordering of writes between them)."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1573075212, "post_id": 58735554, "comment_id": 103767268, "body": "@SteveSummit Tbh, I have always used it without knowing what it&#39;s for. :D"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1573213351, "post_id": 58735554, "comment_id": 103817552, "body": "@SteveSummit I have removed the modifier now after testing it. Comment cleanup."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1573213326, "last_edit_date": 1573213326, "creation_date": 1573061196, "answer_id": 58735554, "question_id": 58735374, "link": "https://stackoverflow.com/questions/58735374/disabling-the-did-you-mean-suggestions-in-gcc/58735554#58735554", "title": "Disabling the &quot;did you mean...&quot; suggestions in GCC", "body": "<p>I don't think there is a solution within <code>gcc</code> except for making your own modification. A non-optimal solution is piping into <code>sed</code>.</p>\n\n<pre><code>gcc main.c 2&gt;&amp;1 | sed -E \"s/; did you mean .*\\?//\"\n</code></pre>\n\n<p>What I'm doing here is redirecting <code>stderr</code> (where the warnings are printed) to <code>stdout</code> with <code>2&gt;&amp;1</code> and then I made a simple replace script that removes that phrase.</p>\n\n<p>It adds some complexity, and you lose the colours, but it does what you asked for.</p>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 10760539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e712e5f20edef2b255feb415d56d1?s=128&d=identicon&r=PG", "display_name": "Impudent Snob", "link": "https://stackoverflow.com/users/10760539/impudent-snob"}, "is_accepted": true, "score": 4, "last_activity_date": 1573116043, "creation_date": 1573116043, "answer_id": 58744863, "question_id": 58735374, "link": "https://stackoverflow.com/questions/58735374/disabling-the-did-you-mean-suggestions-in-gcc/58744863#58744863", "title": "Disabling the &quot;did you mean...&quot; suggestions in GCC", "body": "<p>It turns out that it's simply hardcoded and there are <strong>no ways</strong> to turn that off.</p>\n\n<p>From the gcc <a href=\"https://gcc.gnu.org/git/?p=gcc.git;a=blob;f=gcc/c/c-decl.c;h=ae0ee3a9c9606a8009c2b60767c5227cd6671043;hb=0c0b297d68848fd6812aa59651fe7b039ed6f4ef#l3297\" rel=\"nofollow noreferrer\">source</a>:</p>\n\n<pre><code>3328       warned = warning_at\n3329         (&amp;richloc, OPT_Wimplicit_function_declaration,\n3330          G_(\"implicit declaration of function %qE; did you mean %qs?\"),\n3331          id, suggestion);\n</code></pre>\n\n<p>[And no, neither <code>lookup_name_fuzzy()</code> nor <code>hint.suggestion ()</code> will take any command line option into consideration when returning their results]</p>\n\n<p>Filtering the error output with some shell sorcery, eg. with</p>\n\n<pre><code>{ gcc ... 2&gt;&amp;1 &gt;&amp;3 | sed 's/; did you mean [^?]*[?]//' &gt;&amp;2; } 3&gt;&amp;1\n</code></pre>\n\n<p>is not really a solution, first because it cannot be used in makefiles (the error status of the command line will be that of the <code>sed</code> or whatever filter, not that of gcc), and second because it will still leave around things like:</p>\n\n<pre><code> void foo(char *b, size_t z){ readlink(\"/foo\", b, z); }\n                              ^~~~~~~~\n                              realloc\n</code></pre>\n\n<p>which will need some complicated logic to filter out.</p>\n\n<p>[using bash/kshisms like <code>2&gt; &gt;(...)</code> won't help with the 1st point either, because <code>make</code> will use <code>/bin/sh</code>, not the user's shell] </p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 4703008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/940fc5f5cddb26d6c6b61904c73d3470?s=128&d=identicon&r=PG&f=1", "display_name": "Gabor Simon", "link": "https://stackoverflow.com/users/4703008/gabor-simon"}, "is_accepted": false, "score": 1, "last_activity_date": 1583870956, "last_edit_date": 1583870956, "creation_date": 1582653873, "answer_id": 60400734, "question_id": 58735374, "link": "https://stackoverflow.com/questions/58735374/disabling-the-did-you-mean-suggestions-in-gcc/60400734#60400734", "title": "Disabling the &quot;did you mean...&quot; suggestions in GCC", "body": "<p>Just a little addition to the solution by @ImpudentSnob, to filter out those suggestion lines as well:</p>\n\n<ol>\n<li>Find your gcc, like in my case: <code>~/.espressif/.../xtensa-esp32-elf-gcc</code></li>\n<li>Rename it by adding '.didyoumean' to the end of the name, like <code>xtensa-esp32-elf-gcc.didyoumean</code></li>\n<li>Put this script there, with the original gcc name:</li>\n</ol>\n\n<pre><code>#!/bin/bash\n\nset -o pipefail\n{ $0.didyoumean \"$@\" 2&gt;&amp;1 &gt;&amp;3 | awk '{if (sub(\"; did you mean [^?]*[?]\", \"\")) cnt=4} (cnt!=1){print} (cnt&gt;0){cnt--}' &gt;&amp;2;} 3&gt;&amp;1\n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 10760539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e712e5f20edef2b255feb415d56d1?s=128&d=identicon&r=PG", "display_name": "Impudent Snob", "link": "https://stackoverflow.com/users/10760539/impudent-snob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 58744863, "answer_count": 3, "score": -1, "last_activity_date": 1583870956, "creation_date": 1573060503, "last_edit_date": 1573067635, "question_id": 58735374, "link": "https://stackoverflow.com/questions/58735374/disabling-the-did-you-mean-suggestions-in-gcc", "title": "Disabling the &quot;did you mean...&quot; suggestions in GCC", "body": "<p>Newer versions of GCC come with what I consider to be an irritating misfeature: they try to second-guess me, emitting useless \"did you mean?\" suggestions that drown out other warnings.</p>\n\n<p>For example:</p>\n\n<pre><code>$ gcc -Wall -c -o /dev/null -xc - &lt;&lt;'EOT'\n#include &lt;stdlib.h&gt;\n\nvoid foo(char *b, size_t z){ readlink(\"/foo\", b, z); }\nEOT\n&lt;stdin&gt;: In function \u2018foo\u2019:\n&lt;stdin&gt;:3:30: warning: implicit declaration of function \u2018readlink\u2019;\ndid you mean \u2018realloc\u2019? [-Wimplicit-function-declaration]\n</code></pre>\n\n<p>No, I did not mean <code>realloc</code>; I just forgot to include the <code>unistd.h</code> header.</p>\n\n<p>Is there any way to turn this off?</p>\n\n<p>I want to have it print just <code>implicit declaration of function \u2018readlink\u2019 [-Wimplicit-function-declaration]</code>, without the helpful suggestion.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1573059279, "post_id": 58735008, "comment_id": 103760229, "body": "If you can, it is easier to use string."}, {"owner": {"reputation": 11, "user_id": 12333301, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FBPK0FKjq7g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reZzsKmA_msHWzSDDLCfIHRIuM4MQ/photo.jpg?sz=128", "display_name": "robbert", "link": "https://stackoverflow.com/users/12333301/robbert"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1573059382, "post_id": 58735008, "comment_id": 103760286, "body": "Sorry should have told that we have to use long, and we&#39;re also not allowed to use arrays, which would have made things easier I believe."}, {"owner": {"reputation": 1383, "user_id": 3103067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73734922ce42fbe157ad4d5fa145915e?s=128&d=identicon&r=PG&f=1", "display_name": "Jannik", "link": "https://stackoverflow.com/users/3103067/jannik"}, "edited": false, "score": 1, "creation_date": 1573059604, "post_id": 58735008, "comment_id": 103760410, "body": "If you count the positions in your loop you can use <code>if (i % 2 == 0) { &#47;* do something with your number *&#47;}</code> to select every second digit. If you want to select the remaining numbers you can test for <code>1</code> instead of <code>1</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1573060065, "post_id": 58735008, "comment_id": 103760656, "body": "The first printf very likely outputs 0, but that is none of the 0s in the value in the first line. And the following printfs seem meaning-free to me. Please show the output of the shown code and explain it. Otherwise please make an honest attempt of approaching the homework assignment. Otherwise the question is too broad to be answered, as most questions which give the impression of being a homework copy. Credits to your attempt to provide a minimum of code. But the shown code amounts to nothing."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1573060904, "post_id": 58735008, "comment_id": 103761104, "body": "The next time I suggest to show a minimal complete program that can be compiled and tested. That means wrap your code snippet in a <code>main</code> function with all required <code>#include</code> directives. This will make it easier to reproduce the problem or to provide an improved version."}], "answers": [{"comments": [{"owner": {"reputation": 918, "user_id": 4916945, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QhGwD.jpg?s=128&g=1", "display_name": "ron_g", "link": "https://stackoverflow.com/users/4916945/ron-g"}, "edited": false, "score": 0, "creation_date": 1605520055, "post_id": 58735345, "comment_id": 114665441, "body": "Why&#39;s it printing out the digits in reverse?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 918, "user_id": 4916945, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QhGwD.jpg?s=128&g=1", "display_name": "ron_g", "link": "https://stackoverflow.com/users/4916945/ron-g"}, "edited": false, "score": 1, "creation_date": 1605524949, "post_id": 58735345, "comment_id": 114667371, "body": "@ron_g I added an explanation to the answer."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 2, "last_activity_date": 1605524926, "last_edit_date": 1605524926, "creation_date": 1573060389, "answer_id": 58735345, "question_id": 58735008, "link": "https://stackoverflow.com/questions/58735008/how-to-iterate-over-a-number-to-get-every-other-digit/58735345#58735345", "title": "how to iterate over a number to get every other digit", "body": "<p>Before your <code>while</code> loop you reversed the last digit and the remaining number.</p>\n<p><code>number % 10</code> is the last digit, <code>number / 10</code> is the remaining number.</p>\n<p>Adding to <code>digit</code> doesn't make sense if the variable is intended to contain a single digit. (You may need to add the digits for a validity check.)</p>\n<p>Example code to extract all digits and their positions:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    long number = 378282246310005;\n    int digit;\n    int position = 0;\n\n    printf(&quot;%li\\n&quot;, number);\n\n    while (number &gt; 0)\n    {\n        digit = number % 10;\n        number /= 10;\n        printf(&quot;(%i) %i &quot;, position, digit);\n        position++;\n    }\n    printf(&quot;\\n&quot;);\n\n    return 0;\n}\n</code></pre>\n<p>This prints</p>\n<pre class=\"lang-none prettyprint-override\"><code>378282246310005\n(0) 5 (1) 0 (2) 0 (3) 0 (4) 1 (5) 3 (6) 6 (7) 4 (8) 2 (9) 2 (10) 8 (11) 2 (12) 8 (13) 7 (14) 3 \n</code></pre>\n<p>To select every other digit you could check <code>position % 2</code> or toggle a variable between 0 and 1 in every loop cycle.</p>\n<p><strong>Edit:</strong><br />\nExplanation as requested in <a href=\"https://stackoverflow.com/users/4916945/ron-g\">ron_g</a>'s comment: &quot;Why's it printing out the digits in reverse?&quot;</p>\n<p>The loop separates the last digit from the remaining part of the number, so it prints the last digit first. Then it repeats the same with the remaining part as long as the remaining number is not 0.</p>\n<p>The answer keeps the original implementation from the question which is based on storing the number as a <code>long int</code>. In this case it is easier to start with the last digit. When the number would be stored as a string it would be easier to start with the first digit.</p>\n<pre><code>    /* number is initially the whole number or the remaining part */\n    while (number &gt; 0)\n    {\n        /* remainder of division by 10 is the last digit */\n        digit = number % 10;\n        /* division by 10 is the remaining part after cutting off the last digit */\n        number /= 10;\n        printf(&quot;(%i) %i &quot;, position, digit);\n        position++;\n    }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12333301, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FBPK0FKjq7g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reZzsKmA_msHWzSDDLCfIHRIuM4MQ/photo.jpg?sz=128", "display_name": "robbert", "link": "https://stackoverflow.com/users/12333301/robbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1605524926, "creation_date": 1573059152, "question_id": 58735008, "link": "https://stackoverflow.com/questions/58735008/how-to-iterate-over-a-number-to-get-every-other-digit", "title": "how to iterate over a number to get every other digit", "body": "<p>For a homework program we are asked to check if credit card numbers are valid.\nWhile I am fairly sure about how I want to solve this problem I am stuck with iterating over a creditcard number and getting every second digit. </p>\n\n<p>I already know that I need to use modulo and division and I do get the second to last number, but I am lost at how to iterate over the rest of the numbers.\nIn the code is the code I used to check that I did indeed get the second to last number, and after that some code I tried to use to iterate over the complete number. Hope somebody could show me in the right direction!</p>\n\n<pre><code>   long number = 378282246310005;\n    int digit;\n    int cc_number;\n    cc_number = number % 10;\n    digit = cc_number / 10;\n    printf(\"%i\\n\", digit);\n\nwhile (number &gt; 0)\n   {\n      digit += number % 10;\n      number /= 10;\n      printf(\"%li\", number);\n   }\n   printf(\"\\n\");\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1573059526, "post_id": 58735002, "comment_id": 103760367, "body": "You&#39;re freeing <code>familyName</code> as soon as you assign it to <code>house-&gt;name</code>. You&#39;re creating a dangling pointer. Don&#39;t free it until you&#39;re done using it."}, {"owner": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1573062667, "post_id": 58735002, "comment_id": 103761950, "body": "But when after assign it to <code>house-&gt;name</code> what <code>familyName</code> contains is not relevant anymore?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1573062969, "post_id": 58735002, "comment_id": 103762076, "body": "It&#39;s a pointer, so yes, it&#39;s relevant. What you&#39;re doing is equivalent to <code>house-&gt;name = familyName; free(house-&gt;name);</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573059739, "post_id": 58735139, "comment_id": 103760484, "body": "where the call to free(familyName) should be made?"}, {"owner": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573060109, "post_id": 58735139, "comment_id": 103760684, "body": "I put it in the code just after i print the whole array and it dose print all the data but the program ends with an error: ProgramingInC(7247,0x1000d1dc0) malloc: *** error for object 0x100507230: pointer being freed was not allocated."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573060351, "post_id": 58735139, "comment_id": 103760803, "body": "hard to say anything about that without seeing the whole code, but if you really assign either NULL or the result of an individual <code>calloc()</code> to <b>each</b> <code>house[i].name</code>  that error wouldn&#39;t occur"}, {"owner": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573060488, "post_id": 58735139, "comment_id": 103760883, "body": "This did work: &#39;for(int i = 0; i &lt; nHouses; i++ ) {         myHouse[i].name = NULL;     } &#39; free() didn&#39;t. thank you :)"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573060514, "post_id": 58735139, "comment_id": 103760903, "body": "But tha doesn&#39;t free the memory!"}, {"owner": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573062072, "post_id": 58735139, "comment_id": 103761690, "body": "it didn&#39;t free it and i tried moving the loop to other places in the &quot;free() loop&quot; but it keep getting the same error, maybe i don&#39;t understand something basic about it. but i was thinking that every time i call the function calloc() allocates different memory address for every myHouse.name[i]."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573063626, "post_id": 58735139, "comment_id": 103762391, "body": "yes, every <code>calloc()</code> will return a different address if you don&#39;t call <code>free()</code> in between. Otherwise, freed memory might be reused (but not neccessarily)"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "edited": false, "score": 0, "creation_date": 1573063908, "post_id": 58735139, "comment_id": 103762511, "body": "maybe you can call another question with the updated code including thre &#39;free() loop&#39; referring to this one."}], "tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": true, "score": 0, "last_activity_date": 1573059880, "last_edit_date": 1573059880, "creation_date": 1573059622, "answer_id": 58735139, "question_id": 58735002, "link": "https://stackoverflow.com/questions/58735002/structure-array-erases-data/58735139#58735139", "title": "Structure array erases data", "body": "<p>Here's the bug:</p>\n\n<pre><code>if(familyName != NULL) {\n    scanf(\"%s\", familyName);\n    house -&gt; name = familyName;\n    free(familyName);\n} else {\n    printf(\"Allocation faild\\n\");\n    house -&gt; name = NULL;\n}\n</code></pre>\n\n<p>You call <code>free(familyName)</code> directly after assigning the pointer to <code>house-&gt;name</code> so you have a pointer to an already freed piece of memory afterwards and accessing that invokes Undefined Behaviour</p>\n\n<p>Instead, you could create a loop like</p>\n\n<pre><code>for( i=0; i&lt;nHouses; i++ ) {\n    free( house[i].name );\n}\n</code></pre>\n\n<p>That you call when you don't need the whole array any more</p>\n"}], "owner": {"reputation": 21, "user_id": 12186769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03dc142ff78f404df0d34c28f422a91e?s=128&d=identicon&r=PG&f=1", "display_name": "orwebdev", "link": "https://stackoverflow.com/users/12186769/orwebdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58735139, "answer_count": 1, "score": 0, "last_activity_date": 1573059880, "creation_date": 1573059139, "question_id": 58735002, "link": "https://stackoverflow.com/questions/58735002/structure-array-erases-data", "title": "Structure array erases data", "body": "<p>I try to fill a structure array with a loop that call a function to do it.\nevery time i loop more than once the the first entry erases the the first entry from the last call, i suspect that its something with the CALLOC() function but not sure need help.\nHere is the function:</p>\n\n<pre><code>HOUSE setHouse(int count, HOUSE *house) {\n    int max = 20;\n    printf(\"Enter Family(%d) name (%d charecter max):\\n\", count + 1, max);\n    char *familyName = calloc(max, sizeof(char));\n    if(familyName != NULL) {\n        scanf(\"%s\", familyName);\n        house -&gt; name = familyName;\n        free(familyName);\n    } else {\n        printf(\"Allocation faild\\n\");\n        house -&gt; name = NULL;\n    }\n    printf(\"Enter house number:\\n\");\n    scanf(\"%d\", &amp;house -&gt; adress);  \n    printf(\"Enter number of rooms:\\n\");\n    scanf(\"%d\", &amp;house -&gt; rooms);    \n    printf(\"Enter size of house (in sqMt sss.ss format):\\n\");\n    scanf(\"%f\", &amp;house -&gt; sqMeters);\n    return *house;\n}\n</code></pre>\n\n<p>This is the call to the function:</p>\n\n<pre><code>int nHouses = 0;\n    printf(\"Number of houses in your street: ?\\n\");\n    scanf(\"%d\", &amp;nHouses);\n    HOUSE myHouse[nHouses];\n    for (int i = 0; i &lt; nHouses; i++) {\n        setHouse(i, &amp;myHouse[i]);\n    }\n</code></pre>\n\n<p>Here is example of the result with two iterations:\nin the first iteration give the family name of 'a', and the second the family name 'b'.</p>\n\n<pre><code>Family  Number  Rooms   Size\na       1       1       1.00\n        1       1       1.00\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1573059388, "post_id": 58735000, "comment_id": 103760292, "body": "get input with <code>fgets()</code>, parse with <code>strtoul()</code> or similar and/or <code>isalpha()</code> or similar."}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1573062242, "creation_date": 1573062242, "answer_id": 58735817, "question_id": 58735000, "link": "https://stackoverflow.com/questions/58735000/how-to-check-when-you-scanf-that-you-get-only-integer-like-2-and-not-integer-f/58735817#58735817", "title": "How to check when you scanf that you get only integer (like 2) and not integer followed by char (like 2c)", "body": "<p>If you enter \"only a character\" it does not \"automatically cast it to an integer\". It does not accept <em>any input at all</em>, as shown by scanf returning <code>0</code>, but that situation escapes your test.</p>\n\n<p>But the answer to your question is: <strong>with difficulty</strong> when using <code>scanf</code>.</p>\n\n<p>Here is a way to do it getting the input with <code>fgets</code>. It will tolerate any amount of whitespace before or after the number, but not any letters.</p>\n\n<p>The reason for the space before <code>%c</code> is to instruct it to filter any leading whitespace. This is automatic anyway for <code>%d</code>, but not for <code>%c</code>. Then if there are no readable characters, nothing will be read into <code>extra</code>. If there is at least one character (apart from whitespace) then the <code>sscanf</code> conversion count will be incorrect.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(void)\n{\n    int number_of_numbers = 0;\n    while(number_of_numbers &gt;= 0) {\n        bool success = false;\n        char str[100];\n        if(fgets(str, sizeof str, stdin) != NULL) {\n            char extra;\n            if(sscanf(str, \"%d %c\", &amp;number_of_numbers, &amp;extra) == 1) {\n                success = true;\n            }\n        }\n        if(success) {\n            printf(\"Success: %d\\n\\n\", number_of_numbers);\n        } else {\n            printf(\"Invalid size\\n\\n\");\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Program session:</p>\n\n<pre><code>123\nSuccess: 123\n\n123a\nInvalid size\n\n123 a\nInvalid size\n\n123 9\nInvalid size\n\na\nInvalid size\n\n-1\nSuccess: -1\n</code></pre>\n\n<p>The reasons for using <code>fgets</code> are</p>\n\n<ul>\n<li><p>it doesn't \"stall\" if there is invalid input: it has already been read.</p></li>\n<li><p>if there is a mistake, the string can easily be dumped and another one requested.</p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 12333165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77359f014d52911db8892f76a2489378?s=128&d=identicon&r=PG&f=1", "display_name": "Matans", "link": "https://stackoverflow.com/users/12333165/matans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573115449, "creation_date": 1573059126, "last_edit_date": 1573115449, "question_id": 58735000, "link": "https://stackoverflow.com/questions/58735000/how-to-check-when-you-scanf-that-you-get-only-integer-like-2-and-not-integer-f", "title": "How to check when you scanf that you get only integer (like 2) and not integer followed by char (like 2c)", "body": "<p>I'm trying to scanf an integer to see if it's legal in my program. However, if I input a number followed by a char it still treats it as legal number (my guess is that it only refers to the integer while saving the char in the buffer). Assume I can only use scanf and not something else (since that's what we've leraned). Also, if I input only a char it automatically casts it to an integer. This is what I have tried so far, with the help of what I saw here -</p>\n\n<pre><code> int number_of_numbers;\n char number='\\n';\n printf(\"Enter size of input:\");\n if (scanf(\"%d%c\",&amp;number_of_numbers, &amp;number)&gt;=1 &amp;&amp; number!='\\n')\n    {\n        printf(\"Invalid size\");\n        return 0;\n    }\n</code></pre>\n\n<p>How can I identify when I scanf only an integer or an integer followed by a char or just a char?\nThanks! </p>\n"}, {"tags": ["c", "shell", "awk"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1573058843, "post_id": 58734882, "comment_id": 103759994, "body": "It is unclear what you are asking."}, {"owner": {"reputation": 95946, "user_id": 5866580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1de2cd722d865edac1575102a48ecc0a?s=128&d=identicon&r=PG&f=1", "display_name": "RavinderSingh13", "link": "https://stackoverflow.com/users/5866580/ravindersingh13"}, "edited": false, "score": 0, "creation_date": 1573058871, "post_id": 58734882, "comment_id": 103760008, "body": "Welcome to SO, please do mention more clear samples of Input and expected output in your post along with your efforts which you have put in order to solve your own problem and let us know then."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1573059165, "post_id": 58734882, "comment_id": 103760166, "body": "Why isn&#39;t the <code>comm</code> command sufficient for this?  I don&#39;t see what you want to do that&#39;s different."}, {"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 1, "creation_date": 1573059169, "post_id": 58734882, "comment_id": 103760171, "body": "Read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and update your Q with 2 sample inputs that cover all cases you expect to encounter AND the required output from those inputs. Good luck."}], "answers": [{"tags": [], "owner": {"reputation": 20517, "user_id": 8344060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UbPk.png?s=128&g=1", "display_name": "kvantour", "link": "https://stackoverflow.com/users/8344060/kvantour"}, "is_accepted": true, "score": 1, "last_activity_date": 1573060206, "creation_date": 1573060206, "answer_id": 58735302, "question_id": 58734882, "link": "https://stackoverflow.com/questions/58734882/how-compare-too-similar-files/58735302#58735302", "title": "How compare too similar files", "body": "<p>Here is a possible way of doing this with traditional tools and pipelines. I use the terminology key and value as the file looks like</p>\n\n<pre><code>key = value\n</code></pre>\n\n<p>The following list of commands give you possible answers:</p>\n\n<pre><code># lines common between file1 and file2\ngrep -F -f file1 file2\n# lines in file2 not in file1\ngrep -v -F -f file1 file2\n# changed key values from file1 to file2\ncut -d'=' -f1 file1 | grep -F -f - &lt;(grep -v -F -f file1 file2)\n# keys in file1 but not in file2\ncut -d'=' -f1 file1 | grep -v -F -f - file2\n# keys in file2 but not in file1\ncut -d'=' -f1 file2 | grep -v -F -f - file1\n</code></pre>\n\n<p>Or you can just go for one simple awk, this is not the most optimised, but gives a clean output:</p>\n\n<pre><code>$ awk '\n    BEGIN{FS=\" *= *\"}\n    {key=$1;value=$2}\n    (NR==FNR){a[key]=value; next}\n    {b[key] = value }\n    END {\n       for (key in a) if (key in b) {\n           print (a[key] == b[key] ? \"COMM\" : \"DIFF\"), key,\"=\",a[key],\"&lt;=&gt;\",b[key]\n           delete a[key]\n           delete b[key] \n       }\n       for (key in a) {\n           print \"UNI1\", key,\"=\",a[key]\n       }\n       for (key in b) {\n           print \"UNI2\", key,\"=\",b[key]\n       }\n    }' file1 file2\n</code></pre>\n\n<p>This will produce some output looking like</p>\n\n<pre><code> COMM key1 = val1 &lt;=&gt; val1\n COMM key2 = val2 &lt;=&gt; val2\n DIFF key3 = val31 &lt;=&gt; val32      \n COMM key4 = val4 &lt;=&gt; val4\n UNI1 key5 = val5\n UNI2 key6 = val6      \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1573066318, "creation_date": 1573066318, "answer_id": 58736765, "question_id": 58734882, "link": "https://stackoverflow.com/questions/58734882/how-compare-too-similar-files/58736765#58736765", "title": "How compare too similar files", "body": "<p>something like this can be done with <code>join</code></p>\n\n<pre><code>$ join -a1 -a2 -e\"---\" -t= -o1.1,1.2,2.2,2.1 file1 file2 | column -ts=\n\nCPM-NOMINAL.WAC10.SAR_PARI_SUJET_A_COTES         \"1:0:1:1:0:0:0:0:0\"             \"1:0:1:1:0:0:0:1:0\"  CPM-NOMINAL.WAC10.SAR_PARI_SUJET_A_COTES\nCPM-NOMINAL.WAC12.CHRONO_SANSREPONSE_KEEPALIVE   1                               0                    CPM-NOMINAL.WAC12.CHRONO_SANSREPONSE_KEEPALIVE\nCPM-NOMINAL.WAC12.PARIS_SANSREPONSE_KEEPALIVE    1                               0                    CPM-NOMINAL.WAC12.PARIS_SANSREPONSE_KEEPALIVE\nCPM-NOMINAL.WAC12.PARIS_SANS_EMISSION_KEEPALIVE  1                               0                    CPM-NOMINAL.WAC12.PARIS_SANS_EMISSION_KEEPALIVE\nCPM-NOMINAL.WAC12.PROTOCOLE_PDD                  2                               3                    CPM-NOMINAL.WAC12.PROTOCOLE_PDD\n---                                              ---                             \"p_initialiser\"      CPM-NOMINAL.WAC7.SQL_PROC_INIT_XAPDD_MBN_TEST\nCPM-NOMINAL.WAC8.FAIRE_VERIF_CHAINAGE            FALSE                           TRUE                 CPM-NOMINAL.WAC8.FAIRE_VERIF_CHAINAGE\nDEMO-WEB.WAC7.XN_TCP_SERVICE_PDD_PORT            3201                            32099                DEMO-WEB.WAC7.XN_TCP_SERVICE_PDD_PORT\nDEMO-WEB.WAC7.XN_TCP_SERVICE_SAR_PORT            3201                            3204                 DEMO-WEB.WAC7.XN_TCP_SERVICE_SAR_PORT\n</code></pre>\n\n<p>common values can be eliminated with piping to <code>awk '$2!=$3'</code> </p>\n"}], "owner": {"reputation": 13, "user_id": 12333014, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213944717432409/picture?type=large", "display_name": "Merlin Bonato", "link": "https://stackoverflow.com/users/12333014/merlin-bonato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58735302, "answer_count": 2, "score": 1, "last_activity_date": 1573066318, "creation_date": 1573058647, "last_edit_date": 1573059472, "question_id": 58734882, "link": "https://stackoverflow.com/questions/58734882/how-compare-too-similar-files", "title": "How compare too similar files", "body": "<p>I have two text files like this:</p>\n\n<p>line are like => SITE.MACHINE.VARIABLE_NAME=VARIABLE_VALUE</p>\n\n<pre><code>CPM-NOMINAL.WAC12.CHRONO_SANSREPONSE_KEEPALIVE=0\nCPM-NOMINAL.WAC13.CHRONO_SANSREPONSE_KEEPALIVE=0\nDEMO-WEB.WAC7.XN_TCP_SERVICE_PDD_PORT=32099\n...\n</code></pre>\n\n<p>They are already sort -u</p>\n\n<p>I have to find out which lines are in one file or in another or have been modified (I do not care about the common ones), like <strong>sdiff</strong> command.\nBut the files are have too similar lines that create the diff error.</p>\n\n<p>I'm thinking of diff on the left side of \"=\" and, if ok, check for the right side.\nI am looking for a solution that prints an output like sdiff or kind of.</p>\n\n<p>output wanted exemple :</p>\n\n<pre><code>File1                                                         | File2\nCPM-NOMINAL.WAC10.SAR_PARI_SUJET_A_COTES=\"1:0:1:1:0:0:0:0:0\"  | CPM-NOMINAL.WAC10.SAR_PARI_SUJET_A_COTES=\"1:0:1:1:0:0:0:1:0\"\nCPM-NOMINAL.WAC12.CHRONO_SANSREPONSE_KEEPALIVE=1              | CPM-NOMINAL.WAC12.CHRONO_SANSREPONSE_KEEPALIVE=0\nCPM-NOMINAL.WAC12.PARIS_SANSREPONSE_KEEPALIVE=1               | CPM-NOMINAL.WAC12.PARIS_SANSREPONSE_KEEPALIVE=0\nCPM-NOMINAL.WAC12.PARIS_SANS_EMISSION_KEEPALIVE=1             | CPM-NOMINAL.WAC12.PARIS_SANS_EMISSION_KEEPALIVE=0\nCPM-NOMINAL.WAC12.PROTOCOLE_PDD=2                             | CPM-NOMINAL.WAC12.PROTOCOLE_PDD=3\n                                                              &gt; CPM-NOMINAL.WAC7.SQL_PROC_INIT_XAPDD_MBN_TEST=\"p_initialiser\"\nCPM-NOMINAL.WAC8.FAIRE_VERIF_CHAINAGE=FALSE                   | CPM-NOMINAL.WAC8.FAIRE_VERIF_CHAINAGE=TRUE\nDEMO-WEB.WAC7.XN_TCP_SERVICE_PDD_PORT=3201                    | DEMO-WEB.WAC7.XN_TCP_SERVICE_PDD_PORT=32099\nDEMO-WEB.WAC7.XN_TCP_SERVICE_SAR_PORT=3201                    | DEMO-WEB.WAC7.XN_TCP_SERVICE_SAR_PORT=3204\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "mergesort", "data-files"], "comments": [{"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1573057242, "post_id": 58734392, "comment_id": 103759036, "body": "Please format your code before you post here. If your IDE/editor doesn&#39;t support code formatting you can use <a href=\"http://format.krzaq.cc/\" rel=\"nofollow noreferrer\">format.krzaq.cc</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1573057609, "post_id": 58734392, "comment_id": 103759235, "body": "Watch out for <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>. You&#39;ve avoided the most common problem, but not some of the subtler things. On third thought, you didn&#39;t successfully avoid the common problem."}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1573058368, "post_id": 58734392, "comment_id": 103759658, "body": "Variable-length arrays like <code>int L[n1], R[n2];</code> are not allowed in C++. Also your code looks much more like C so I changed the tag."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12333157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2e7f06606b993bd69ea5cd10a1a4ea?s=128&d=identicon&r=PG&f=1", "display_name": "maya", "link": "https://stackoverflow.com/users/12333157/maya"}, "edited": false, "score": 0, "creation_date": 1573057861, "post_id": 58734594, "comment_id": 103759369, "body": "I have changed  &quot;%d&quot; to &quot;%lf&quot; but it gives me Given array is                                                                                                                 43.720000 60.300000  27.370000                                                                                                                                                                               Sorted array Using MERGE SORT is                                                                                               27.000000 30.000000     it&#39;s printing out 0&#39;s and not showing numbers after decimals."}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "reply_to_user": {"reputation": 1, "user_id": 12333157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2e7f06606b993bd69ea5cd10a1a4ea?s=128&d=identicon&r=PG&f=1", "display_name": "maya", "link": "https://stackoverflow.com/users/12333157/maya"}, "edited": false, "score": 0, "creation_date": 1573058087, "post_id": 58734594, "comment_id": 103759493, "body": "@maya Then you have to use <code>double</code> everywhere in your code. Why do you read a file containing floating point values with <code>%d</code> and store the values in an integer array?"}, {"owner": {"reputation": 1, "user_id": 12333157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2e7f06606b993bd69ea5cd10a1a4ea?s=128&d=identicon&r=PG&f=1", "display_name": "maya", "link": "https://stackoverflow.com/users/12333157/maya"}, "edited": false, "score": 0, "creation_date": 1573058409, "post_id": 58734594, "comment_id": 103759703, "body": "Okay thanks, sorting works fine. But the extra zeroes after decimal still there. Any advice."}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "reply_to_user": {"reputation": 1, "user_id": 12333157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2e7f06606b993bd69ea5cd10a1a4ea?s=128&d=identicon&r=PG&f=1", "display_name": "maya", "link": "https://stackoverflow.com/users/12333157/maya"}, "edited": false, "score": 0, "creation_date": 1573058491, "post_id": 58734594, "comment_id": 103759761, "body": "@maya you define <code>arr</code> as an array of <code>int</code> but then in the functions you say that it should be a <code>double[]</code>. Please be consistent with your types, either use all <code>int</code> or all <code>double</code>"}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "reply_to_user": {"reputation": 1, "user_id": 12333157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2e7f06606b993bd69ea5cd10a1a4ea?s=128&d=identicon&r=PG&f=1", "display_name": "maya", "link": "https://stackoverflow.com/users/12333157/maya"}, "edited": false, "score": 0, "creation_date": 1573058731, "post_id": 58734594, "comment_id": 103759904, "body": "@maya You should read <a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/io/fprintf</a> about formatting your output. You can try <code>printf(&quot;%lf.0 &quot;, A[i]);</code>"}], "tags": [], "owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "is_accepted": false, "score": 1, "last_activity_date": 1573057579, "creation_date": 1573057579, "answer_id": 58734594, "question_id": 58734392, "link": "https://stackoverflow.com/questions/58734392/cannot-print-out-the-array-of-double-numbers-after-mergesort/58734594#58734594", "title": "Cannot print out the array of double numbers after mergesort", "body": "<p>Your array is of type <code>int</code>. Your functions expect a pointer to <code>double</code>. Use either <code>int</code> or <code>double</code> for the array and the functions. Don't mix it. The line</p>\n\n<pre><code>fscanf(fp, \"%d\", &amp;data);\n</code></pre>\n\n<p>reads integers so probably you should use the data type <code>int</code> everywhere in your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 12333157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2e7f06606b993bd69ea5cd10a1a4ea?s=128&d=identicon&r=PG&f=1", "display_name": "maya", "link": "https://stackoverflow.com/users/12333157/maya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573058227, "creation_date": 1573056871, "last_edit_date": 1573058227, "question_id": 58734392, "link": "https://stackoverflow.com/questions/58734392/cannot-print-out-the-array-of-double-numbers-after-mergesort", "title": "Cannot print out the array of double numbers after mergesort", "body": "<p>Please help, keeps getting these errors. </p>\n\n<pre><code>main.cpp: In function \u2018int main()\u2019:\n\n\nmain.cpp:177:25: error: cannot convert \u2018int*\u2019 to \u2018double*\u2019 for argument \u20181\u2019 to \u2018void printArray(double*, double)\u2019\n printArray(arr, arr_size);\n\n\nmain.cpp:179:31: error: cannot convert \u2018int*\u2019 to \u2018double*\u2019 for argument \u20181\u2019 to \u2018void mergeSort(double*, int, int)\u2019\n mergeSort(arr, 0, arr_size - 1);\n                               ^\n\n\nmain.cpp:183:25: error: cannot convert \u2018int*\u2019 to \u2018double*\u2019 for argument \u20181\u2019 to \u2018void printArray(double*, double)\u2019\n printArray(arr, arr_size);\n\n\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid merge(double arr[], int l, int m, int r)\n{\n    int i, j, k;\n    int n1 = m - l + 1;\n    int n2 = r - m;\n    int L[n1], R[n2];\n    for (i = 0; i &lt; n1; i++)\n        L[i] = arr[l + i];\n    for (j = 0; j &lt; n2; j++)\n        R[j] = arr[m + 1 + j];\n    i = 0;\n    j = 0;\n    k = l;\n\n    while (i &lt; n1 &amp;&amp; j &lt; n2)\n    {\n        if (L[i] &lt;= R[j])\n        {\n            arr[k] = L[i];\n            i++;\n        }\n        else\n        {\n            arr[k] = R[j];\n            j++;\n        }\n        k++;\n    }\n\n    while (i &lt; n1)\n    {\n        arr[k] = L[i];\n        i++;\n        k++;\n    }\n\n    while (j &lt; n2)\n    {\n        arr[k] = R[j];\n        j++;\n        k++;\n    }\n}\n\nvoid mergeSort(double arr[], int l, int r)\n{\n    if (l &lt; r)\n    {\n        int m = l + (r - l) / 2;\n        mergeSort(arr, l, m);\n        mergeSort(arr, m + 1, r);\n        merge(arr, l, m, r);\n    }\n}\n\nvoid printArray(double A[], int size)\n{\n    int i;\n    for (i = 0; i &lt; size; i++)\n        printf(\"%lf \", A[i]);\n    printf(\"\\n\");\n}\n\nint main()\n{\n    int arr[1000] = { 0 };\n    int arr_size = 0;\n    int data;\n    char file1[20];\n    strcpy(file1, \"random.data\");\n    FILE* fp;\n    fp = fopen(file1, \"r+\");\n\n    if (fp == NULL) // if file not opened return error\n    {\n        perror(\"Unable to open file\");\n        return -1;\n    }\n    else\n    {\n        fscanf(fp, \"%d\", &amp;data);\n        arr[arr_size] = data;\n        arr_size++;\n        while (!feof(fp))\n        {\n            fscanf(fp, \"%d\", &amp;data);\n            arr[arr_size] = data;\n            arr_size++;\n        }\n    }\n\n    printf(\"Given array is \\n\");\n    printArray(arr, arr_size);\n    mergeSort(arr, 0, arr_size - 1);\n    printf(\"\\nSorted array Using MERGE SORT is \\n\");\n    printArray(arr, arr_size);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "boolean"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1573072651, "post_id": 58734365, "comment_id": 103766264, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/201970/discussion-on-question-by-don-draper-why-do-i-get-two-different-results-issue\">moved to chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 2, "last_activity_date": 1573087995, "creation_date": 1573087995, "answer_id": 58740484, "question_id": 58734365, "link": "https://stackoverflow.com/questions/58734365/why-do-i-get-two-different-results-issue-with-booleans/58740484#58740484", "title": "Why do I get two different results? (issue with booleans)", "body": "<p>One obvious problem is that of implicit function declarations. </p>\n\n<p>Neither </p>\n\n<pre><code>bool calc_angle_sum(struct Point p1, struct Point points[], int size)\n</code></pre>\n\n<p>and </p>\n\n<pre><code>bool check_border(struct Point p, struct Point points[], int size)\n</code></pre>\n\n<p>are not declared in the translation unit <code>source.c</code>. Therefore the compiler assumes that the functions are of type</p>\n\n<pre><code>int calc_angle_sum()\nint check_border()\n</code></pre>\n\n<p>Were the return type of the functions <code>int</code>, they could be called compatibly in this manner - with these arguments. But because the actual return type of the functions is <code>bool</code>, the behaviour of the function calls is <em>undefined</em>.</p>\n\n<p>C99 removed implicit function definitions. A compliant C99, C11, C17 compiler must complain about these function calls in your <code>source.c</code>.But the substandard MSVC compiler barely meets the long obsolete C89 specification...</p>\n\n<p>Thus, try <em>declaring</em></p>\n\n<pre><code>bool calc_angle_sum(struct Point p1, struct Point points[], int size);\nbool check_border(struct Point p, struct Point points[], int size);\n</code></pre>\n\n<p>in Point.h.</p>\n"}], "owner": {"reputation": 318, "user_id": 5757418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ef3924d3d4ae25ac11efc58646139e?s=128&d=identicon&r=PG&f=1", "display_name": "Don Draper", "link": "https://stackoverflow.com/users/5757418/don-draper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 58740484, "answer_count": 1, "score": 0, "last_activity_date": 1573087995, "creation_date": 1573056765, "last_edit_date": 1573062268, "question_id": 58734365, "link": "https://stackoverflow.com/questions/58734365/why-do-i-get-two-different-results-issue-with-booleans", "title": "Why do I get two different results? (issue with booleans)", "body": "<p>I am a Python developer for the most part, but recently I have needed to solve a few problems using C and, honestly, it makes me suffer. </p>\n\n<p><strong>func.c</strong></p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n\n#define M_PI 3.1415926535897932384626433832795028841971693993751058209\n\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include \"Point.h\"\n\nbool point_on_line(struct Point p1, struct Point p2, struct Point point) {\n\n    double min_x = min(p1.x, p2.x);\n    double max_x = max(p1.x, p2.x);\n    double min_y = min(p1.y, p2.y);\n    double max_y = max(p1.y, p2.y);\n\n    if (p2.y - p1.y == 0) {\n        return point.y == p2.y &amp;&amp; point.x &gt;= min_x &amp;&amp; point.x &lt;= max_x &amp;&amp; point.y &gt;= min_y &amp;&amp; point.y &lt;= max_y;\n    }\n\n    if (p2.x - p1.x == 0) {\n        return point.x == p2.x &amp;&amp; point.x &lt;= max_x &amp;&amp; point.x &gt;= min_x &amp;&amp; point.y &gt;= min_y &amp;&amp; point.y &lt;= max_y;\n    }\n\n    double k = (p2.y - p1.y) / (p2.x - p1.x);\n    double b = (p2.x * p1.y - p1.x * p2.y) / (p2.x - p1.x);\n\n    return point.y == (k * point.x + b) &amp;&amp; point.x &gt;= min_x &amp;&amp; point.x &lt;= max_x &amp;&amp; point.y &gt;= min_y &amp;&amp; point.y &lt;= max_y;\n}\n\ndouble calculate_angle(struct Point p1, struct Point p2) {\n\n    double dot_product = p1.x * p2.x + p1.y * p2.y;\n\n    double lenp1 = sqrt(p1.x * p1.x + p1.y * p1.y);\n\n    double lenp2 = sqrt(p2.x * p2.x + p2.y * p2.y);\n\n    double orientation = p1.x * p2.y - p1.y * p2.x;\n\n    int sign;\n\n    if (orientation &gt; 0) {\n        sign = 1;\n    }\n    else {\n        sign = -1;\n    }\n\n    return sign * acos(dot_product / (lenp1 * lenp2));\n}\n\nbool check_border(struct Point p, struct Point points[], int size) {\n\n    for (int i = 0; i &lt; size - 1; i++) {\n\n        if (point_on_line(points[i], points[i + 1], p)) {\n\n            return true;\n        }\n    }\n\n    return false;\n}\n\nbool calc_angle_sum(struct Point p1, struct Point points[], int size) {\n\n    struct Point* vectors = malloc(size * sizeof(struct Point));\n\n    for (int i = 0; i &lt; size; i++) {\n\n        struct Point temp = { points[i].x - p1.x,points[i].y - p1.y };\n        vectors[i] = temp;\n    }\n\n    double total_sum = 0;\n\n    for (int i = 0; i &lt; size - 1; i++) {\n        total_sum += calculate_angle(vectors[i], vectors[i + 1]);\n    }\n\n    bool res = (fabs(total_sum - 2 * M_PI)) &lt; 0.00005;\n\n    printf(\"TOTAL SUM %.100f\\n\", total_sum);\n\n    printf(\"DIFFERENCE SMALL %d\\n\", fabs(total_sum - 2 * M_PI) &lt; 0.00005);\n\n    return fabs(total_sum - 2 * M_PI) &lt; 0.00005;\n\n    //return res;\n}\n</code></pre>\n\n<p><strong>Source.c</strong></p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include \"Point.h\"\n\nint main() {\n\n    int length = 5;\n\n    struct Point p1 = { 1,2 };\n    struct Point p2 = { 5,0 };\n    struct Point p3 = { 7,4 };\n    struct Point p4 = { 5,6 };\n    struct Point p5 = { 2,5 };\n    struct Point p6 = { 1,2 };\n\n    struct Point points_test[6] = {p1,p2,p3,p4,p5,p6};\n\n    struct Point point_test = {7,3};\n\n    //bool result = calc_angle_sum(point, points, length + 1);\n\n    //printf(\"%s\", result ? \"true\\n\" : \"false\\n\");\n\n    if (check_border(point_test, points_test, length + 1)) {\n\n        printf(\"BORDER\");\n        return 0;\n    }\n\n    else if (calc_angle_sum(point_test, points_test, length + 1)) {\n\n        printf(\"INSIDE\");\n        return 0;\n    }\n\n    else {\n        printf(\"OUTSIDE\");\n        return 0;\n    }\n\n}\n\n</code></pre>\n\n<p><strong>Point.h</strong></p>\n\n<pre><code>\n#pragma once\n\nstruct Point {\n    double x, y;\n};\n</code></pre>\n\n<p><strong>coordinates.txt</strong></p>\n\n<pre><code>1 2 5 0 7 4 5 6 2 5\n</code></pre>\n\n<p><strong>lap.txt</strong> (the first number is the number of rectangle vertices, the second and third - the coordinates of the point. </p>\n\n<pre><code>5 7 3\n</code></pre>\n\n<p>This algorithm determines whether a point is inside/outside/on an edge of a given polygon using the winding number method. </p>\n\n<p>The point <code>(7,3)</code> (the second and third numbers inside <code>lap.txt</code>) lies outside the polygon so the correct answer is \"OUTSIDE/FALSE\". Nevertheless, the output differs depending on Debug/Release and the way I return from <code>calc_angle_sum</code> function. </p>\n\n<p>When I return this way:</p>\n\n<p><code>return fabs(total_sum - 2 * M_PI) &lt; 0.00005;</code></p>\n\n<p>I get inconsistent results depending on debug/release mode. </p>\n\n<p>The following way, however, seems to work fine:</p>\n\n<pre><code>bool res = (fabs(total_sum - 2 * M_PI)) &lt; 0.00005\nreturn res\n</code></pre>\n\n<p>Below is the part inside <code>Source.c</code> that calls the method:</p>\n\n<pre><code>else if (calc_angle_sum(point, points, length + 1)) {\n\n        printf(\"INSIDE\");\n        return 0;\n    }\n</code></pre>\n\n<p>There is something I cannot understand about how expressions are evaluated in C. </p>\n\n<p>In Python, I am used to returning like <code>return &lt;some_expression&gt;</code> and expect it to get converted to <code>True/False</code>. In C, however, this doesn't seem to be true, or else there is some other error. </p>\n"}, {"tags": ["c", "typedef", "null-pointer"], "comments": [{"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1573058037, "post_id": 58733808, "comment_id": 103759461, "body": "Using inexact datatypes like <code>float</code> and <code>double</code> are not suitable for holding monetary values, they may give you &quot;weird&quot; results when doing calculations. And using global variables for passing function parameters  or return values is typically not recommended either. It makes the functions non threadsafe, non reentrant, wastes memory, and most important, hard to read, especially when you use non-descriptive names like <code>number</code>."}, {"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1573058491, "post_id": 58733808, "comment_id": 103759762, "body": "Did you get any compile-warnings when compiling your program? If not, turn on warnings with <code>-Wall</code>. Then try to understand and fix the warnings. If you have any problems with that, I recommend to post a new question where you include the warning messages."}], "answers": [{"tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": true, "score": 2, "last_activity_date": 1573055401, "creation_date": 1573055401, "answer_id": 58733956, "question_id": 58733808, "link": "https://stackoverflow.com/questions/58733808/undefinedbehaviorsanitizer-becouse-of-nullpointer/58733956#58733956", "title": "UndefinedBehaviorSanitizer becouse of nullpointer", "body": "<p>I can't tell why your compiler is not warning about this, but your <code>chech_out</code> function is declared up top as <code>chech_out()</code> - with no parameters - but the <em>definition</em> includes one: <code>chech_out(struct Product *product)</code>.  When the function is called, it's treating garbage on the stack as a pointer to a product, and failing.</p>\n\n<p>Edit: the reason the compiler is not warning is because declaring functions up top with just open+close parentheses means the parameter list is undefined (to be compatible with older versions of C): if a function truly takes no parameters, defined them as <code>int myfunction(void)</code> where the <code>void</code> says \"I take no parameters\"</p>\n\n<p>To fix this</p>\n\n<pre><code>// define struct Product here\nvoid get_number (void);\nvoid show_menu (void);\nint get_input (struct Product *);\nvoid chech_out (struct Product *);\n</code></pre>\n\n<p>and now let your compiler tell you what you've missed.</p>\n"}, {"comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573076065, "post_id": 58738753, "comment_id": 103767543, "body": "The compiler is telling you what the problem is.  The <b>definition</b> (where you provide the body of the code) says it expects a pointer to a <code>Product</code>, but when you call the function, you&#39;re not passing a parameter."}, {"owner": {"reputation": 3, "user_id": 12332948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3d1ecf93c0e9e094dd43a648249a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Rokkj&#230;r", "link": "https://stackoverflow.com/users/12332948/nick-rokkj%c3%a6r"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573077124, "post_id": 58738753, "comment_id": 103767912, "body": "sorry to be blond, but how do I do that? I did try to put passing parameters ind the function like this;  if (get_input (struct Product)), but didnt work"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573077408, "post_id": 58738753, "comment_id": 103768032, "body": "My wife is blond, so I&#39;m sympathetic :-)  Look at your <code>get_input</code> function, where it prompts the user for a character and does a lot of other thing. This function expects <code>struct Product *product</code> as a parameter, where the caller is saying &quot;Pass your data here&quot;.  It is <i>expecting</i> to get a pointer.  But when you <i>call</i> the function earlier in the code, you&#39;re not passing a pointer: where do you expect <code>get_input</code> to pass your data to?   My guess is you want to call using the <code>product</code> var inside of <code>main()</code>, so it would be <code>get_input(&amp;product)</code>"}], "tags": [], "owner": {"reputation": 3, "user_id": 12332948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3d1ecf93c0e9e094dd43a648249a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Rokkj&#230;r", "link": "https://stackoverflow.com/users/12332948/nick-rokkj%c3%a6r"}, "is_accepted": false, "score": 0, "last_activity_date": 1573075709, "creation_date": 1573075709, "answer_id": 58738753, "question_id": 58733808, "link": "https://stackoverflow.com/questions/58733808/undefinedbehaviorsanitizer-becouse-of-nullpointer/58738753#58738753", "title": "UndefinedBehaviorSanitizer becouse of nullpointer", "body": "<p>Thanks all, I tried the code from Steve and now i am getting a compiling problem i dont understand. \nThe only changes in code is:</p>\n\n<pre><code>void get_number (void);\nvoid show_menu (void);\nint get_input (struct Product *);\nvoid chech_out (struct Product *);\nint number;\n</code></pre>\n\n<p>I and get the error:</p>\n\n<pre><code>hj4.c:35:18: error: too few arguments to function call, expected 1, have 0\n                if (get_input ()) // end on \"a\"\n                    ~~~~~~~~~  ^\nhj4.c:21:1: note: 'get_input' declared here\nint get_input (struct Product *);\n^\nhj4.c:73:14: error: too few arguments to function call, expected 1, have 0\n                        chech_out();\n                        ~~~~~~~~~ ^\nhj4.c:22:1: note: 'chech_out' declared here\nvoid chech_out (struct Product *);\n^\n2 errors generated.\n</code></pre>\n\n<p>I did try to change the code to </p>\n\n<pre><code>void get_number (void);\nvoid show_menu (void);\nint get_input (struct Product *product);\nvoid chech_out (struct Product *product);\nint number;\n</code></pre>\n\n<p>But the same problem came.</p>\n"}], "owner": {"reputation": 3, "user_id": 12332948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3d1ecf93c0e9e094dd43a648249a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Rokkj&#230;r", "link": "https://stackoverflow.com/users/12332948/nick-rokkj%c3%a6r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58733956, "answer_count": 2, "score": 0, "last_activity_date": 1573075709, "creation_date": 1573054952, "last_edit_date": 1573055419, "question_id": 58733808, "link": "https://stackoverflow.com/questions/58733808/undefinedbehaviorsanitizer-becouse-of-nullpointer", "title": "UndefinedBehaviorSanitizer becouse of nullpointer", "body": "<p>Hej, I have some code in C, that dosent work. I am just trying to get a price from typedef potatoes to my check-out fuction. I \"//\" the code which is not in use. I there are needed more info please just ask, though I have no clue how to get pas this problem. So any help is much appreciated.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;string.h&gt;   \n\n    int number;\n\n    void get_number ( );\n    void show_menu ( );\n    int get_input ( );\n    void chech_out ();\n\n    struct Product \n    {\n            float potatoes;\n    };\n    typedef struct Product product;\n\n    int main (void)\n    {\n        struct Product product;\n\n        while (1)\n        {\n            //show_product1 ();\n            show_menu ();\n            if (get_input ()) // end on \"a\"\n                break;\n        }\n        printf (\"Bye!\");\n        return 0;\n    }\n\n\n\n    void show_menu (void)\n    {\n        printf (\"Type what you wanne do\");\n        printf (\"f)change amount    h)chech out    s)Strawberry\");\n        printf (\"c)carrots    p)potatoes  o)Onion\");\n        printf (\"a)quit\");\n    }\n\n    void get_number ( )\n    {\n\n        printf (\"Enter number in kg: \");\n        scanf (\"%d\", &amp;number);\n    }\n\n\n\n    int get_input (struct Product *product )\n    {\n        char letter;\n\n        scanf (\"%c\", &amp;letter);\n        switch (letter)\n        {\n            case 'f':\n                printf(\"\\n\\n\\nWhenever you enter a new amount it will reset the old one!\\n\\n\");\n\n                break;\n            case 'h':\n                chech_out();\n\n\n                break;\n            case 'c':\n\n                break;\n            case 'p':\n\n\n                get_number();           \n                float P_freightPrice = number*12;\n                float P_kgPrice = number*25;\n                float P_totalprice=P_freightPrice+P_kgPrice;\n                product-&gt;potatoes = P_totalprice;\n           printf(\"\\n%f\\n\",P_totalprice);     \n\n         if (P_totalprice &lt;= 100)\n         {\n           printf(\"%f\\n\",P_totalprice);    \n         }\n         if (P_totalprice&gt;=101 &amp;&amp; number&lt;=350)\n         {\n             float New=(P_totalprice/100)*5;\n             float total=P_totalprice-New;\n             printf(\"%f\\n\",total);    \n         }\n         if(P_totalprice&gt;=351 &amp;&amp; P_totalprice&lt;=600)\n         {\n             float New=(P_totalprice/100)*10;\n             float total=P_totalprice-New;\n             printf(\"%f\\n\",total); \n\n         }\n        if(P_totalprice&gt;=601)\n        {\n             float New=(P_totalprice/100)*15;\n             float total=P_totalprice-New;\n             printf(\"%f\\n\",total);    \n        }  \n\n                break;\n            case 'a':\n                return 1;\n            default:\n                ;\n        }\n        return 0;\n    }\n\n    void chech_out (struct Product *product)\n    {\n        printf(\"%2.f\",product-&gt;potatoes);\n    }\n</code></pre>\n\n<p>I get the error message:</p>\n\n<pre><code>hj4.c:181:28: runtime error: member access within null pointer of type 'struct Product'\nhj4.c:181:28: runtime error: load of null pointer of type 'float'\nUndefinedBehaviorSanitizer:DEADLYSIGNAL\n==1476==ERROR: UndefinedBehaviorSanitizer: SEGV on unknown address 0x000000000000 (pc 0x000000422814 bp 0x7ffd19c2f280 sp 0x7ffd19c2f260 T1476)\n==1476==The signal is caused by a READ memory access.\n==1476==Hint: address points to the zero page.\n    #0 0x422813  (/root/sandbox/hj4+0x422813)\n    #1 0x42246e  (/root/sandbox/hj4+0x42246e)\n    #2 0x42232a  (/root/sandbox/hj4+0x42232a)\n    #3 0x7f11cd86fb96  (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #4 0x402ae9  (/root/sandbox/hj4+0x402ae9)\n\nUndefinedBehaviorSanitizer can not provide additional info.\n==1476==ABORTING\n</code></pre>\n\n<p>I guess I just need some pointers to solve this problem;) </p>\n"}, {"tags": ["c", "loops", "for-loop", "primes"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573054342, "post_id": 58733553, "comment_id": 103757366, "body": "The loop stops at the first iteration, both sides of the <code>if&#47;else</code> return. Does that match the logic you intended?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1573054346, "post_id": 58733553, "comment_id": 103757370, "body": "Remove <code>else return 1</code> and place a <code>return 1</code> at the end of the function."}, {"owner": {"reputation": 39, "user_id": 11054839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4021fe70cad3d0da205459bb4af08a76?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/11054839/new-learner"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573054428, "post_id": 58733553, "comment_id": 103757440, "body": "@harold: yes I want it to return 0 if not a prime and a 1 if a prime."}, {"owner": {"reputation": 39, "user_id": 11054839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4021fe70cad3d0da205459bb4af08a76?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/11054839/new-learner"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1573054441, "post_id": 58733553, "comment_id": 103757445, "body": "@Paul ogilvie: Thank you, that worked."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573054513, "post_id": 58733553, "comment_id": 103757477, "body": "@KhaledYassen does <code>number%loop_counter != 0</code> prove that <code>number</code> is a prime?"}, {"owner": {"reputation": 39, "user_id": 11054839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4021fe70cad3d0da205459bb4af08a76?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/11054839/new-learner"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573054683, "post_id": 58733553, "comment_id": 103757575, "body": "@harold yes, am I mistaken?"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573054817, "post_id": 58733553, "comment_id": 103757674, "body": "@KhaledYassen yes, consider 9, it&#39;s not divisible by 2 but also not a prime. Not being divible by a single number is not enough. Actually it looks like you know that because you wrote a loop, but this loop doesn&#39;t loop, it exits immediately."}, {"owner": {"reputation": 39, "user_id": 11054839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4021fe70cad3d0da205459bb4af08a76?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/11054839/new-learner"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573054929, "post_id": 58733553, "comment_id": 103757738, "body": "@harold Oh wait.. I should have started from 3 and then incremented 2 each loop? That would correct. Am I mistaken?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1573055101, "post_id": 58733553, "comment_id": 103757838, "body": "The first few prime numbers are 2, 3, 5, 7, 11, 13, 17, 19, 23  Notice that 3 doesn&#39;t cover everything."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573055294, "post_id": 58733553, "comment_id": 103757936, "body": "@KhaledYassen you can do that if you first test whether the number is even, Vlad&#39;s answer does that. Of course, it is still important that the loop <i>continues</i> if a divisibility test fails"}, {"owner": {"reputation": 39, "user_id": 11054839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4021fe70cad3d0da205459bb4af08a76?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/11054839/new-learner"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1573055580, "post_id": 58733553, "comment_id": 103758100, "body": "@harold I saw this other implementation that I do not understand the logic of. the bounds of the loop are loop_counter &lt;=number/2. Would that approach be better? if yes, why?"}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1573055656, "post_id": 58733646, "comment_id": 103758149, "body": "@VladfromMoscow,  What is wrong with the function definition?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1573055697, "post_id": 58733646, "comment_id": 103758176, "body": "For example for number equal to 1 the function returns 1."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1573055876, "post_id": 58733646, "comment_id": 103758261, "body": "1 is not a prime number.  Here is the definition of a prime number:  <i>A prime number is a whole number greater than 1 whose only factors are 1 and itself. A factor is a whole numbers that can be divided evenly into another number</i>  see <a href=\"https://whatis.techtarget.com/definition/prime-number\" rel=\"nofollow noreferrer\">define prime number</a>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1573055960, "post_id": 58733646, "comment_id": 103758308, "body": "But your function returns 1 for the number equal to 1 or for example 0."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1573056085, "post_id": 58733646, "comment_id": 103758376, "body": "@VladfromMoscow,   I did not include error checking in the proposed code.  I expect the OP to handle error checking before calling the function."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1573055516, "last_edit_date": 1573055516, "creation_date": 1573054408, "answer_id": 58733646, "question_id": 58733553, "link": "https://stackoverflow.com/questions/58733553/my-prime-number-checker-function-not-working-properly/58733646#58733646", "title": "my prime number checker function not working properly", "body": "<p>regarding:</p>\n\n<pre><code>for(loop_counter ; loop_counter &lt; number ; loop_counter++){\n</code></pre>\n\n<p>the variable: <code>loop_counter</code> is not initialized (nor even declared)</p>\n\n<p>Perhaps you meant:</p>\n\n<pre><code>for( int loop_counter = 0; loop_counter &lt; number ; loop_counter++){\n</code></pre>\n\n<p>The following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>is NOT the fastest/best way to check if a number is prime.  Rather it is a brute force method</li>\n</ol>\n\n<p>The OPs posted code has several problems as discussed in comments to the OPs question, so will not be repeated here.</p>\n\n<p>Now, the proposed code:</p>\n\n<pre><code>int is_prime(int number)\n{\n    for( int loop_counter = 2 ; loop_counter &lt; number ; loop_counter++)\n    {\n        if(number%loop_counter == 0)\n        {\n            return 0;\n        }\n    }\n\n    return 1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 11054839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4021fe70cad3d0da205459bb4af08a76?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/11054839/new-learner"}, "edited": false, "score": 0, "creation_date": 1573055115, "post_id": 58733699, "comment_id": 103757844, "body": "I do not fully understand the body of your function. Would it be okay if you clarify a bit?"}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "edited": false, "score": 0, "creation_date": 1573056031, "post_id": 58733699, "comment_id": 103758344, "body": "Suboptimal. Loop should be broken on the first occurrence of <code>n % i == 0</code>"}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "reply_to_user": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "edited": false, "score": 0, "creation_date": 1573056112, "post_id": 58733699, "comment_id": 103758393, "body": "@SomeWittyUsername it does, when <code>n % i != 0 </code> returns <code>false</code> the condition of the <code>for</code> becomes false and the loop finishes"}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1573056113, "post_id": 58733699, "comment_id": 103758395, "body": "I love when you learn something new from simplest questions. Your use of <code>i &lt;= n &#47; i</code> is fantastic. I normally use <code>i &lt;= sqrt(n)</code>, But I noticed that your method converges to same result without <code>sqrt()</code>. Great!!! But maybe <code>i*i &lt;=n</code>, since I think calculating <code>*</code> is easier <code>&#47;</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1573058720, "post_id": 58733699, "comment_id": 103759897, "body": "@Afshin <code>i*i &lt;= n</code> could give the wrong answer due to arithmetic overflow if <code>n</code> is greater than the largest square number that fits in an <code>unsigned int</code>, so <code>i &lt;= n &#47; i</code> is safer. <code>i &lt;= sqrt(n)</code> might be faster if the compiler realizes that <code>sqrt(n)</code> is loop-invariant and doesn&#39;t call it each iteration. But it can be calculated before the loop to make sure. <code>sqrt(n)</code> could also be replaced with an integer square root function to avoid introducing floating point math."}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1573059303, "post_id": 58733699, "comment_id": 103760243, "body": "@IanAbbott You are right about overflow, my mistake."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1573056227, "last_edit_date": 1573056227, "creation_date": 1573054620, "answer_id": 58733699, "question_id": 58733553, "link": "https://stackoverflow.com/questions/58733553/my-prime-number-checker-function-not-working-properly/58733699#58733699", "title": "my prime number checker function not working properly", "body": "<p>In this loop</p>\n\n<pre><code>for(loop_counter ; loop_counter &lt; number ; loop_counter++){\n</code></pre>\n\n<p>there is used an undeclared variable <code>loop_counter</code>. If it is a global variable then it shall not be used in the function because at least it is unclear what is its value.</p>\n\n<p>Also within the loop you are interrupting its iterations as soon as <code>number%loop_counter != 0</code>. But this does not mean that the number is prime.</p>\n\n<p>And if the user will pass a negative number or zero then the function will have undefined behavior.</p>\n\n<p>The function can be defined the following way</p>\n\n<pre><code>int is_prime( unsigned int n )\n{\n    int prime = n % 2 == 0 ? n == 2 : n != 1;\n\n    for ( unsigned int i = 3; prime &amp;&amp; i &lt;= n / i; i += 2 )\n    {\n        prime = n % i != 0;\n    }\n\n    return prime;\n}\n</code></pre>\n\n<p>The function at first excludes all even numbers except <code>2</code> because even numbers are not prime numbers. And it also excludes the number <code>1</code> because the number <code>1</code> is not prime by the definition.</p>\n\n<pre><code>int prime = n % 2 == 0 ? n == 2 : n != 1;\n</code></pre>\n\n<p>So within the loop there is no sense to consider divisors that are even.</p>\n\n<pre><code>    for ( unsigned int i = 3; prime &amp;&amp; i &lt;= n / i; i += 2 )\n                                                   ^^^^^^\n</code></pre>\n\n<p>Then within the loop there is a check whether the given odd number <code>n</code> is divisible by an odd divisor</p>\n\n<pre><code>        prime = n % i != 0;\n</code></pre>\n\n<p>If <code>n % i</code> is equal to 0 then the variable prime gets the value 0 and the loop stops its iterations due to the condition in the loop.</p>\n\n<pre><code>for ( unsigned int i = 3; prime &amp;&amp; i &lt;= n / i; i += 2 )\n                          ^^^^^\n</code></pre>\n\n<p>that can be rewritten also like</p>\n\n<pre><code>for ( unsigned int i = 3; prime != 0 &amp;&amp; i &lt;= n / i; i += 2 )\n                          ^^^^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11054839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4021fe70cad3d0da205459bb4af08a76?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/11054839/new-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 58733699, "answer_count": 2, "score": 1, "last_activity_date": 1573056227, "creation_date": 1573054156, "last_edit_date": 1573055481, "question_id": 58733553, "link": "https://stackoverflow.com/questions/58733553/my-prime-number-checker-function-not-working-properly", "title": "my prime number checker function not working properly", "body": "<p>So this function is just supposed to return 0 if not prime and 1 if prime. Am I seeing something wrong? for example, when I give it 39, it says it returns 1 although 39 is not a prime. </p>\n\n<pre><code>int is_prime(int number){\n    if (number == 2) {\n        return 1;\n    }\n\n    else{\n        for(loop_counter ; loop_counter &lt; number ; loop_counter++){\n\n            if(number%loop_counter == 0){\n                return 0;\n\n            }\n            else{\n                return 1;\n            }\n\n    }\n    }\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "while-loop", "getchar"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573054306, "post_id": 58733474, "comment_id": 103757345, "body": "<code>stdin</code> is usually line buffered.  <i>Nothing</i> is available to <code>getchar()</code> until <code>&#39;\\n&#39;</code> is entered - even the first call.  Perhaps a non-standard function?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1573054332, "post_id": 58733474, "comment_id": 103757360, "body": "Only the getchar() part needs to be in a loop."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1573058388, "post_id": 58733474, "comment_id": 103759681, "body": "See also <a href=\"https://stackoverflow.com/a/423643/204883\">stackoverflow.com/a/423643/204883</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1573057901, "creation_date": 1573057901, "answer_id": 58734673, "question_id": 58733474, "link": "https://stackoverflow.com/questions/58733474/repeat-until-user-presses-enter/58734673#58734673", "title": "Repeat until user presses enter", "body": "<p>the following code is from <a href=\"https://cboard.cprogramming.com/c-programming/63166-kbhit-linux.html\" rel=\"nofollow noreferrer\">kbhit for linux</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint kbhit(void)\n{\n  struct termios oldt, newt;\n  int ch;\n  int oldf;\n\n  tcgetattr(STDIN_FILENO, &amp;oldt);\n  newt = oldt;\n  newt.c_lflag &amp;= ~(ICANON | ECHO);\n  tcsetattr(STDIN_FILENO, TCSANOW, &amp;newt);\n  oldf = fcntl(STDIN_FILENO, F_GETFL, 0);\n  fcntl(STDIN_FILENO, F_SETFL, oldf | O_NONBLOCK);\n\n  ch = getchar();\n\n  tcsetattr(STDIN_FILENO, TCSANOW, &amp;oldt);\n  fcntl(STDIN_FILENO, F_SETFL, oldf);\n\n  if(ch != EOF)\n  {\n    ungetc(ch, stdin);\n    return 1;\n  }\n\n  return 0;\n}\n\nint main(void)\n{\n  while(!kbhit())\n    puts(\"Press a key!\");\n  printf(\"You pressed '%c'!\\n\", getchar());\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 12332881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91f0bffb1f409a1525194e3c3a20f77a?s=128&d=identicon&r=PG&f=1", "display_name": "hallo545401", "link": "https://stackoverflow.com/users/12332881/hallo545401"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58734673, "answer_count": 1, "score": 1, "last_activity_date": 1573057901, "creation_date": 1573053893, "last_edit_date": 1573056598, "question_id": 58733474, "link": "https://stackoverflow.com/questions/58733474/repeat-until-user-presses-enter", "title": "Repeat until user presses enter", "body": "<p>I want to have a loop, that repeats until the user presses enter.</p>\n\n<p>I tried with <code>while(getchar != '\\n'){}</code> but this waitet on a input every single time. Right now i dont know how to do this.</p>\n\n<pre><code>do {\n        clear;//system(\"cls\");\n        printf(\"\\nPress [enter] to continue\");\n        printf(\".\");\n        Sleep(500);\n        printf(\".\");//should give a output with press enter to continue... and wait after every point.\n        Sleep(500);\n        printf(\".\");\n        Sleep(500);\n    }while(getchar() != '\\n');\n</code></pre>\n"}, {"tags": ["c", "switch-statement"], "comments": [{"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 3, "creation_date": 1573053456, "post_id": 58733298, "comment_id": 103756796, "body": "Always check a returned value of <code>scanf</code>."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1573053626, "post_id": 58733298, "comment_id": 103756927, "body": "You could set <code>nDisplaySchedule_Choice</code> to a &#39;wrong&#39; value (say, -1) before the <code>scanf</code> call - it would then remain at this value if invalid input is given."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1573053639, "post_id": 58733298, "comment_id": 103756939, "body": "You might also initialize <code>nDisplaySchedule_Choice</code> to an invalid value (like <code>-1</code>)."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1573053699, "post_id": 58733298, "comment_id": 103756980, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13324793/scanf-for-digits\">Scanf for digits</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1573053815, "post_id": 58733298, "comment_id": 103757050, "body": "@anatolyg Yeah it&#39;s a duplicate but the answers there were pretty low quality. I&#39;d expect a good answer to either deal with result of <code>scanf</code> or show a <code>fgets</code> alternative."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1573054198, "last_edit_date": 1573054198, "creation_date": 1573053887, "answer_id": 58733469, "question_id": 58733298, "link": "https://stackoverflow.com/questions/58733298/switch-case-0-entering-0-and-entering-a-letter/58733469#58733469", "title": "Switch case 0: entering 0 and entering a letter", "body": "<p>If <code>scanf</code> fails to read a value (for instance because you told it to read an <code>int</code> and gave it a letter) it won't change your variable. So <code>nDisplaySchedule_Choice</code> won't change in a way that you can check in your <code>switch</code>. At least not if you don't initialize it - you can however set it to a value that is not covered by your <code>switch</code>, and if it didn't change, you know that <code>scanf</code> failed to read a value.</p>\n\n<p>Or you could check the <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\">return value of <code>scanf</code></a> to see if it managed to read a value:</p>\n\n<pre><code>int result = scanf(\"%d\", &amp;nDisplaySchedule_Choice);\nif (result == 0) {\n    int c;\n    while ((c = getchar()) != '\\n' &amp;&amp; c != EOF); // flush the invalid input\n    printf(\"ERROR. INPUT A VALID RESPONSE.\\n\\n\");\n    DisplaySchedule();\n}\nelse switch ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1573054064, "creation_date": 1573054064, "answer_id": 58733517, "question_id": 58733298, "link": "https://stackoverflow.com/questions/58733298/switch-case-0-entering-0-and-entering-a-letter/58733517#58733517", "title": "Switch case 0: entering 0 and entering a letter", "body": "<p>You have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a> here.</p>\n\n<p><code>scanf</code>, when scanning for int (<code>%d</code>), fails because you input a character - due to <em>matching failure</em>. Thus not reading anything into <code>nDisplaySchedule_Choice</code> at all.</p>\n\n<p>Since <code>nDisplaySchedule_Choice</code> is uninitialized to start with, it just happens to have <code>0</code> and thus goes to <code>case 0</code>.</p>\n\n<p>The solution is to check the <code>scanf</code> return value before proceeding to use <code>nDisplaySchedule_Choice</code>. <code>scanf</code> returns the number of items successfully scanned.</p>\n"}], "owner": {"reputation": 41, "user_id": 12332831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCp3F3eo2ttENOyloD7jTsJXp9QhxCELcG_K95bJA=k-s128", "display_name": "meksun", "link": "https://stackoverflow.com/users/12332831/meksun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573054198, "creation_date": 1573053357, "last_edit_date": 1573053524, "question_id": 58733298, "link": "https://stackoverflow.com/questions/58733298/switch-case-0-entering-0-and-entering-a-letter", "title": "Switch case 0: entering 0 and entering a letter", "body": "<pre><code>int DisplaySchedule()\n{\n    int nDisplaySchedule_Choice;\n\n    system(\"cls\");\n    printf(\"----- DISPLAY SCHEDULE -----\\n\");\n    printf(\"Pick departure station\\n\\t\");\n    printf(\"[1] San Pedro\\n\\t\");\n    printf(\"[2] Santa Rosa\\n\\t\");\n    printf(\"[3] Calamba\\n\\n\\t\");\n    printf(\"[9] Go Back\\n\\t\");\n    printf(\"[0] Exit\\n\\n\");\n    printf(\"Choice: \");\n    scanf(\"%d\", &amp;nDisplaySchedule_Choice);\n    printf(\"\\n\");\n\n    switch (nDisplaySchedule_Choice) {\n        case 1: SanPedro(); break;\n        case 2: SantaRosa(); break;\n        case 3: Calamba(); break;\n        case 9: OpeningScreen(); break;\n        case 0: printf(\"Summary()\"); break;\n        default:\n            printf(\"ERROR. INPUT A VALID RESPONSE.\\n\\n\");\n            DisplaySchedule();\n            break;\n    }\n    return;\n}\n</code></pre>\n\n<p>I have this code in which when I enter a letter, instead of printing the error message, it prints <code>case 0:</code> instead. Is there any way for me to make it so that <code>case 0:</code> will only function if and only if I enter \"0\" in the <code>scanf</code> statement?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1573053093, "post_id": 58733176, "comment_id": 103756541, "body": "You might want to learn about <a href=\"https://en.cppreference.com/w/c/language/operator_other#Comma_operator\" rel=\"nofollow noreferrer\">the comma operator</a> and how it works."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1573053551, "creation_date": 1573053551, "answer_id": 58733370, "question_id": 58733176, "link": "https://stackoverflow.com/questions/58733176/what-is-happening-in-the-if-condition/58733370#58733370", "title": "What is happening in the if condition?", "body": "<p>In the expression,</p>\n\n<pre><code>i=(1,2,0)\n</code></pre>\n\n<p>you're using the <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.17\" rel=\"nofollow noreferrer\">comma operator</a>, which evaluates all its operands and yields the result of its rightmost operand - which is 0 here.\nSo 0 is assigned to <code>i</code>.</p>\n\n<p>So it's equivalent to <code>if (i = 0)</code>, which assigns <code>0</code> to <code>i</code> and yields the value of <code>i</code> which is false and thus it prints the string in the else branch.</p>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "is_accepted": true, "score": 3, "last_activity_date": 1573056045, "last_edit_date": 1573056045, "creation_date": 1573053621, "answer_id": 58733393, "question_id": 58733176, "link": "https://stackoverflow.com/questions/58733176/what-is-happening-in-the-if-condition/58733393#58733393", "title": "What is happening in the if condition?", "body": "<p>First, formatting as the compiler sees the code we get:</p>\n\n<pre><code>int main(void)\n{\n   int i;\n   if(i=(1,2,0))\n      printf(\"Mehrose\");\n   else \n      printf(\"Hello\");\n   printf(\"%d\\n\",i);\n   return 0;\n}\n</code></pre>\n\n<p>The if statement can be broken down:</p>\n\n<ol>\n<li><p><a href=\"https://en.cppreference.com/w/c/language/operator_other#Comma_operator\" rel=\"nofollow noreferrer\">Comma operator</a> <code>,</code> is evaluated first, left-hand side of the operator is discarded. This repeats for each operator:</p>\n\n<p><code>if(i=(1,2,0))</code></p>\n\n<p><code>if(i=(2,0))</code></p>\n\n<p><code>if(i=0)</code></p></li>\n<li><p>The <a href=\"https://en.cppreference.com/w/c/language/operator_assignment\" rel=\"nofollow noreferrer\">assignment operator</a> <code>=</code> assigns a value of <code>0</code> to <code>i</code>, and returns the right-hand side of the expression:</p>\n\n<p><code>if(0)</code></p></li>\n<li><p>Recall that <code>0</code> is evaluated as false (is \"falsy\") and <code>1</code> is evaluated as true (is \"truthy\"). Thus the first condition fails and the second block is executed. \"Hello\" is printed to the standard output stream, followed by \"0\".</p></li>\n</ol>\n"}], "owner": {"reputation": 59, "user_id": 11725130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b514002eb9fd47984b587804983c3512?s=128&d=identicon&r=PG&f=1", "display_name": "Rose", "link": "https://stackoverflow.com/users/11725130/rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1573053638, "accepted_answer_id": 58733393, "answer_count": 2, "score": 1, "last_activity_date": 1573056045, "creation_date": 1573053009, "last_edit_date": 1573053419, "question_id": 58733176, "link": "https://stackoverflow.com/questions/58733176/what-is-happening-in-the-if-condition", "closed_reason": "Duplicate", "title": "What is happening in the if condition?", "body": "<p>One of my friends ask me about this code and I and he are unable to find out, what is happening in the if condition. Can you guys explain how this condition works?</p>\n\n<pre><code>int main()\n{\n   int i;\n\n   if (i = (1, 2, 0))\n       printf(\"Mehrose\");\n   else\n       printf(\"Hello \");\n\n   printf(\"%d\\n\", i);\n\n   return 0;\n}\n</code></pre>\n\n<p>The output for this code is Hello 0</p>\n"}, {"tags": ["c", "gcc", "floating-point", "compiler-optimization"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573052827, "post_id": 58733033, "comment_id": 103756365, "body": "Unrelated, but why do you pass a pointer for the <code>pNextState_scaled</code> argument?"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573053213, "post_id": 58733033, "comment_id": 103756631, "body": "FWIW, gcc 4.8.5 for x86 produces the expected result in all cases."}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 0, "creation_date": 1573057485, "post_id": 58733033, "comment_id": 103759173, "body": "I think this is <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=323\" rel=\"nofollow noreferrer\">gcc bug 323</a> where gcc is using excess precision is a place not sanctioned by the standard. See also <a href=\"https://gcc.gnu.org/wiki/FAQ#PR323\" rel=\"nofollow noreferrer\">gcc faq on the subject</a>."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 1, "creation_date": 1573057898, "post_id": 58733033, "comment_id": 103759389, "body": "@AProgrammer Even given a compiler bug, the code is still relying excessively on exact floating-point equality, and this is squarely in asking-for-trouble territory"}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573061223, "post_id": 58733033, "comment_id": 103761274, "body": "@SteveFriedl, there are cases where equality of floating point is sound and not well though introduction of additional fudge factor make it unsound, especially when it is combined with inequalities like here."}, {"owner": {"reputation": 33, "user_id": 12331997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a06955d5396b58b43aec45da5d9df33?s=128&d=identicon&r=PG&f=1", "display_name": "trudakar", "link": "https://stackoverflow.com/users/12331997/trudakar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573107522, "post_id": 58733033, "comment_id": 103774989, "body": "@Someprogrammerdude This is a stripped down version of the original code, where a structure of state variables, input variables and output variables are processed. I have not tested if using call by value would affect optimization and test result."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 5, "last_activity_date": 1573133618, "last_edit_date": 1573133618, "creation_date": 1573057015, "answer_id": 58734432, "question_id": 58733033, "link": "https://stackoverflow.com/questions/58733033/gcc-compiler-optimization-influences-result-of-floating-point-comparison/58734432#58734432", "title": "gcc compiler optimization influences result of floating point comparison", "body": "<p>[Disclaimer: This is a generic, shoot-from-the-hip answer.  Floating-point issues can be subtle, and I have not analyzed this one carefully.  Once in a while, suspicious-looking code like this <em>can</em> be made to work portably and reliably after all, and per the accepted answer, that appears to be the case here.  Nevertheless, the general-purpose answer stands in the, well, general case.]</p>\n\n<p>I would consider this a bug in the test case, not in gcc. This sounds like a classic example of code that's unnecessarily brittle with respect to exact floating-point equality.</p>\n\n<p>I would recommend either:</p>\n\n<ul>\n<li>rewriting the test case, or perhaps</li>\n<li>removing the test case.</li>\n</ul>\n\n<p>I would <em>not</em> recommend:</p>\n\n<ul>\n<li>working around it by switching compilers</li>\n<li>working around it by using different optimization levels or other compiler options</li>\n<li>submitting compiler bug reports [although in this case, it appears there <em>was</em> a compiler bug, although it needn't be submitted as it has been submitted already]</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 1, "creation_date": 1573058576, "post_id": 58734543, "comment_id": 103759813, "body": "This allows for crossing the threshold without the event being detected.  That is probably worse for the OP than variation on the precise moment when the crossing is detected."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 0, "creation_date": 1573058817, "post_id": 58734543, "comment_id": 103759974, "body": "@AProgrammer I don&#39;t believe it allows <i>crossing</i> the threshold without being detected, because we&#39;ve defined that reaching 0.0299999999 or 0.0300000001 (or whatever) is too close to count as a crossing, but if the OP&#39;s application is about <i>reaching</i> the threshold, then somewhat different logic would be required."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 1, "creation_date": 1573059192, "post_id": 58734543, "comment_id": 103760182, "body": "@AProgrammer As I think I think about this, you&#39;re probably right. If it&#39;s 0.0300000001 then it for sure has crossed if from below, though we might define 0.029999999 as having crossed as well.  This depends on the OP&#39;s application, but the general notion of not doing direct floating point equality is still mostly the guiding principle."}], "tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": false, "score": 0, "last_activity_date": 1573057755, "last_edit_date": 1573057755, "creation_date": 1573057410, "answer_id": 58734543, "question_id": 58733033, "link": "https://stackoverflow.com/questions/58733033/gcc-compiler-optimization-influences-result-of-floating-point-comparison/58734543#58734543", "title": "gcc compiler optimization influences result of floating point comparison", "body": "<p>I am putting this as an answer because I don't think I can do real code in a comment, but @SteveSummit should get the credit - I would not have likely found this without their comment above.</p>\n\n<p>The general advice is: don't do exact comparisons with floating point values, and it seems like that's what this is doing. If a computed value is almost exactly <code>0.03</code> but due to internal representations or optimizations, it's ever so slightly off and not <em>exactly</em>, then it's going to look like a threshold crossing.</p>\n\n<p>So one can resolve this by adding an epsilon for how close one can be to the threshold without having considered to cross it yet.</p>\n\n<pre><code>int update(double * pState, double * pNextState_scaled) {\n    static const double threshold    = 0.03;\n    static const double close_enough = 0.0000001f; // or whatever\n    double oldState = *pState;\n    *pState = *pNextState_scaled * 1e-6;\n\n    // if either value is too close to the threshold, it's not a crossing\n    if (fabs(oldState - threshold) &lt; close_enough) return 0;\n    if (fabs(*pState  - threshold) &lt; close_enough) return 0;\n\n    return oldState &lt; threshold &amp;&amp; *pState &gt;= threshold;\n}\n</code></pre>\n\n<p>I imagine you'd have to know your application in order to know how to tune this value appropriately, but a coupla orders of magnitude smaller than the value you're comparing with seems in the neighborhood.</p>\n"}, {"comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573064514, "post_id": 58735812, "comment_id": 103762802, "body": "I like this a lot, though I still wonder about really close calls.  One nit and one tidbit.   Nit: <code>int const wasBelow = *pWasBelow;</code> missing the <code>*</code> ptr dereference, and the tidbit simplifies the return to <code>return wasBelow != *pWasBelow;</code>"}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 1, "creation_date": 1573064748, "post_id": 58735812, "comment_id": 103762918, "body": "@SteveFriedl, fixed the dereference.  I did not change the tidbit as it will detect threshold pass in both direction instead of just upward."}, {"owner": {"reputation": 33, "user_id": 12331997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a06955d5396b58b43aec45da5d9df33?s=128&d=identicon&r=PG&f=1", "display_name": "trudakar", "link": "https://stackoverflow.com/users/12331997/trudakar"}, "edited": false, "score": 0, "creation_date": 1573109382, "post_id": 58735812, "comment_id": 103775678, "body": "I found the gcc bug mentioned in research, but I was not sure if it is the same. The bug report compares the result of the same calculation, but my example really compares the same value, just stored in an intermediate variable. However the over precision issue is probably the same."}], "tags": [], "owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "is_accepted": true, "score": 4, "last_activity_date": 1573064614, "last_edit_date": 1573064614, "creation_date": 1573062225, "answer_id": 58735812, "question_id": 58733033, "link": "https://stackoverflow.com/questions/58733033/gcc-compiler-optimization-influences-result-of-floating-point-comparison/58735812#58735812", "title": "gcc compiler optimization influences result of floating point comparison", "body": "<p>I've analysed your code and my take is that it is sound according the standard but you are hit by <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=323\" rel=\"nofollow noreferrer\">gcc bug 323</a> about which you may find more accessible information in <a href=\"https://gcc.gnu.org/wiki/FAQ#PR323\" rel=\"nofollow noreferrer\">gcc FAQ</a>.</p>\n\n<p>A way to modify your function and render it robust in presence of gcc bug is to store the fact that the previous state was below the threshold instead (or in addition) of storing that state.  Something like this:</p>\n\n<pre><code>int update(int* pWasBelow, double* pNextState_scaled) {\n    static double const threshold = 0.03;\n    double const nextState = *pNextState_scaled * 1e-6;\n    int const wasBelow = *pWasBelow;\n    *pWasBelow = nextState &lt; threshold;\n    return wasBelow &amp;&amp; !*pWasBelow;\n}\n</code></pre>\n\n<p>Note that this does not guarantee reproductibility.  You may get <code>0 1 0</code> in one set-up and <code>0 0 1</code> in another, but you'll detect the transition sooner or later.</p>\n"}], "owner": {"reputation": 33, "user_id": 12331997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a06955d5396b58b43aec45da5d9df33?s=128&d=identicon&r=PG&f=1", "display_name": "trudakar", "link": "https://stackoverflow.com/users/12331997/trudakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 58735812, "answer_count": 3, "score": 3, "last_activity_date": 1573133618, "creation_date": 1573052588, "last_edit_date": 1592644375, "question_id": 58733033, "link": "https://stackoverflow.com/questions/58733033/gcc-compiler-optimization-influences-result-of-floating-point-comparison", "title": "gcc compiler optimization influences result of floating point comparison", "body": "<h2>Problem</h2>\n<p>In using automated CI tests I found some code, which breaks if optimization of gcc is set to -O2. The code should increment a counter if a double value crosses a threshold in either direction.</p>\n<h3>Workaround</h3>\n<p>Going down to -O1 or using -ffloat-store option works around the problem.</p>\n<h2>Example</h2>\n<p>Here is a small example which shows the same problem.\nThe <code>update()</code> function should return true whenever a sequence of <code>*pNextState * 1e-6</code> crosses a threshold of 0.03.\nI used call by reference because the values are part of a large struct in the full code.</p>\n<p>The idea behind using <code>&lt;</code> and <code>&gt;=</code> is that if a sequence hits the value exactly, the function should return 1 this time and return 0 the next cycle.</p>\n<p>test.h:</p>\n<pre><code>extern int update(double * pState, double * pNextState);\n</code></pre>\n<p>test.c:</p>\n<pre><code>#include &quot;test.h&quot;\n\nint update(double * pState, double * pNextState_scaled) {\n    static double threshold = 0.03;\n    double oldState = *pState;\n    *pState = *pNextState_scaled * 1e-6;\n\n    return oldState &lt; threshold &amp;&amp; *pState &gt;= threshold;\n}\n</code></pre>\n<p>main.c:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &quot;test.h&quot;\n\nint main(void) {\n\n    double state = 0.01;\n    double nextState1 = 20000.0;\n    double nextState2 = 30000.0;\n    double nextState3 = 40000.0;\n\n    printf(&quot;%d\\n&quot;, update(&amp;state, &amp;nextState1));\n    printf(&quot;%d\\n&quot;, update(&amp;state, &amp;nextState2));\n    printf(&quot;%d\\n&quot;, update(&amp;state, &amp;nextState3));\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n<p>Using gcc with at least -O2 the output is:</p>\n<pre><code>0\n0\n0\n</code></pre>\n<p>Using gcc with -O1, -O0 or -ffloat-store produces the desired output</p>\n<pre><code>0\n1\n0\n</code></pre>\n<p>As i understand the problem from debugging a problem arises if the compiler optimizes out the local variable oldstate on stack and instead compares against an intermediate result in an floting point register with higher precision (80bit) and the value <code>*pState</code> is a tiny bit smaller than the threshold.\nIf the value for comparison is stored in 64bit precision, the logic can't miss crossing the threshold. Because of the multiplication by 1e-6 the result is probably stored in an floating point register.</p>\n<p>Would you consider this a gcc bug?\nclang does not show the problem.</p>\n<p>I am using gcc version 9.2.0 on an Intel Core i5, Windows and msys2.</p>\n<h3>Update</h3>\n<p>It is clear to me that floating point comparison is not exact and i would consider the following result as valid:</p>\n<pre><code>0\n0\n1\n</code></pre>\n<p>The idea was that, if <code>(*pState &gt;= threshold) == false</code> in one cycle then comparing the same value (<code>oldstate = *pState</code>) against the same threshold in a subsequent call <code>(*pState &lt; threshold)</code> has to be true.</p>\n"}, {"tags": ["c", "printing", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1573052552, "post_id": 58732960, "comment_id": 103756208, "body": "You are allocating <b>one</b> character for the student name, but you treat it as a string. A string has a <i>terminating null character</i> so a name of <code>&quot;1&quot;</code> still needs <i>two</i> characters."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1573052682, "post_id": 58732960, "comment_id": 103756287, "body": "With <code>studentOne = newStudent();</code> you <b>overwrite</b> <code>studentOne</code>. But you had just allocated memory to it with <code>malloc</code>. That memory is now <i>lost</i>."}, {"owner": {"reputation": 1, "user_id": 10923884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1542dd7fe441c818ddbee1a9f40ed785?s=128&d=identicon&r=PG&f=1", "display_name": "tiescut", "link": "https://stackoverflow.com/users/10923884/tiescut"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1573052967, "post_id": 58732960, "comment_id": 103756452, "body": "In that case, could I leave out all the mallocs in main since in the method newStudent() it allocated memory?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1573053061, "post_id": 58732960, "comment_id": 103756522, "body": "Yes, you can leave them all out in <code>main</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10923884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1542dd7fe441c818ddbee1a9f40ed785?s=128&d=identicon&r=PG&f=1", "display_name": "tiescut", "link": "https://stackoverflow.com/users/10923884/tiescut"}, "edited": false, "score": 0, "creation_date": 1573053565, "post_id": 58733169, "comment_id": 103756882, "body": "Thank you! This makes perfect sense. I&#39;ve made the necessary changes but unfortunately I still get the segmentation fault.. It reads through the whole list and then boots out. Thanks a lot for your help!"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 1, "user_id": 10923884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1542dd7fe441c818ddbee1a9f40ed785?s=128&d=identicon&r=PG&f=1", "display_name": "tiescut", "link": "https://stackoverflow.com/users/10923884/tiescut"}, "edited": false, "score": 0, "creation_date": 1573055155, "post_id": 58733169, "comment_id": 103757870, "body": "That&#39;s strange. I posted my version that works fine when I run it."}, {"owner": {"reputation": 1, "user_id": 10923884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1542dd7fe441c818ddbee1a9f40ed785?s=128&d=identicon&r=PG&f=1", "display_name": "tiescut", "link": "https://stackoverflow.com/users/10923884/tiescut"}, "edited": false, "score": 0, "creation_date": 1573142611, "post_id": 58733169, "comment_id": 103793277, "body": "yes, actually when I compiled it for the second time, it worked! Thanks!"}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1573055125, "last_edit_date": 1573055125, "creation_date": 1573052985, "answer_id": 58733169, "question_id": 58732960, "link": "https://stackoverflow.com/questions/58732960/how-to-fix-segmentation-fault-when-printing-linked-list/58733169#58733169", "title": "How to fix segmentation fault when printing linked list?", "body": "<p>The way you have this code, the last node on the list will point to what you have your <code>head</code> variable as when you first do the <code>addToStart</code>. But <code>head</code> is not  initialized:</p>\n\n<pre><code>node_t *head;\n</code></pre>\n\n<p>Properly initialize it so the loop will terminate correctly:</p>\n\n<pre><code>node_t *head = NULL;\n</code></pre>\n\n<p>You also only have 1 <code>char</code> worth of memory for your strings. That's not enough for anything else than an empty string. Try this instead:</p>\n\n<pre><code>new-&gt;first = malloc(32); // memory for 31 chars plus null terminator\nnew-&gt;last = malloc(32);\n\nprintf(\"Enter first name of student: \");\nscanf(\"%31s\", new-&gt;first); // read a maximum of 31 chars\nprintf(\"Enter last name of student: \");\nscanf(\"%31s\", new-&gt;last);\n</code></pre>\n\n<p>Furthermore, you're allocating memory for the students and strings twice, leaking memory in the process. Remove those redundancies and do this instead:</p>\n\n<pre><code>student_t *studentOne = newStudent();\nstudent_t *studentTwo = newStudent();\nstudent_t *studentThree = newStudent();\n\naddToStart(&amp;head, studentOne);\naddToStart(&amp;head, studentTwo);\naddToStart(&amp;head, studentThree);\n</code></pre>\n\n<p>You're also not freeing any memory anywhere, so I assume you're going to write a function to clean up the list later. With these changes, the program looks like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\ntypedef struct student {\n    char *first;\n    char *last;\n} student_t;\n\ntypedef struct node {\n    student_t *pStudent;\n    struct node *next;\n} node_t;\n\nvoid addToStart(node_t ** head, student_t *student);\nvoid print_list(node_t * head);\nstudent_t *newStudent();\n\nint main() {\n    node_t *head = NULL;\n    student_t *studentOne = newStudent();\n    student_t *studentTwo = newStudent();\n    student_t *studentThree = newStudent();\n\n    addToStart(&amp;head, studentOne);\n    addToStart(&amp;head, studentTwo);\n    addToStart(&amp;head, studentThree);\n\n    print_list(head);\n\n    printf(\"Then you will enter 3 students names that will be added to the end of the list\\n\");\n\n    return 0;\n}\n\nvoid addToStart(node_t ** head, student_t *student) {\n    node_t *new = (node_t *)malloc(sizeof(node_t));\n\n    new-&gt;pStudent = student;\n\n    new-&gt;next = *(head);\n    *(head) = new;\n}\n\nvoid print_list(node_t * head) {\n    while (head != NULL) {\n        printf(\"%s, %s\\n\", head-&gt;pStudent-&gt;last, head-&gt;pStudent-&gt;first);\n\n        head = head-&gt;next;\n    }\n\n}\n\nstudent_t *newStudent() {\n    student_t *new = (student_t *)malloc(sizeof(student_t));\n    new-&gt;first = (char *)malloc(32);\n    new-&gt;last = (char *)malloc(32);\n\n    printf(\"Enter first name of student: \");\n    scanf(\"%31s\", new-&gt;first);\n    printf(\"Enter last name of student: \");\n    scanf(\"%31s\", new-&gt;last);\n\n    return new;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10923884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1542dd7fe441c818ddbee1a9f40ed785?s=128&d=identicon&r=PG&f=1", "display_name": "tiescut", "link": "https://stackoverflow.com/users/10923884/tiescut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573055125, "creation_date": 1573052376, "question_id": 58732960, "link": "https://stackoverflow.com/questions/58732960/how-to-fix-segmentation-fault-when-printing-linked-list", "title": "How to fix segmentation fault when printing linked list?", "body": "<p>When attempting to print my linked list of students, I am given a \"Segmentation fault (core dumped)\". When I print the list by hard coding:</p>\n\n<p>`</p>\n\n<pre><code>for (i = 0; i &lt; 3; i++){\n    printf(\"%s, %s\\n\", head-&gt;pStudent-&gt;last, head-&gt;pStudent-&gt;first);\n    head = head-&gt;next;\n}\n</code></pre>\n\n<p>`</p>\n\n<p>(3 nodes were created.) It works! When I try to print it like this: </p>\n\n<p>`</p>\n\n<pre><code>while (head != NULL){\n    printf(\"%s, %s\\n\", head-&gt;pStudent-&gt;last, head-&gt;pStudent-&gt;first);\n    head = head-&gt;next;\n}\n</code></pre>\n\n<p>`</p>\n\n<p>It gives me the segmentation error.</p>\n\n<p>I've tried <code>while (head-&gt;next != NULL){...}</code></p>\n\n<p>I've tried doing it in main instead of calling <code>print_list(head);</code></p>\n\n<pre><code>\n    #include&lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n\n    typedef struct student{\n        char *first;\n        char *last;\n    } student_t;\n\n    typedef struct node{\n        student_t *pStudent;\n        struct node *next;\n    } node_t;\n\n    void addToStart(node_t ** head, student_t *student);\n    void print_list (node_t * head);\n    student_t *newStudent();\n\n    int main(){\n        node_t *head;\n        student_t *studentOne = (student_t *) malloc(sizeof(student_t));\n        student_t *studentTwo = (student_t *) malloc(sizeof(student_t));\n        student_t *studentThree = (student_t *) malloc(sizeof(student_t));\n\n        studentOne-&gt;first = (char *) malloc(sizeof(char));\n        studentOne-&gt;last = (char *) malloc(sizeof(char));\n\n        studentTwo-&gt;first = (char *) malloc(sizeof(char));\n        studentTwo-&gt;last = (char *) malloc(sizeof(char));\n\n        studentThree-&gt;first = (char *) malloc(sizeof(char));\n        studentThree-&gt;last = (char *) malloc(sizeof(char));\n\n        studentOne = newStudent();\n        addToStart(&amp;head, studentOne);\n\n        studentTwo = newStudent();\n        addToStart(&amp;head, studentTwo);\n\n        studentThree = newStudent();\n        addToStart(&amp;head, studentThree);\n\n        print_list(head);\n\n        printf(\"Then you will enter 3 students names that will be added to the end of the list\\n\");\n\n        return 0;\n    }\n\n    void addToStart(node_t ** head, student_t *student){\n        node_t *new = (node_t *) malloc(sizeof(node_t));\n\n        new-&gt;pStudent = student;\n\n        new-&gt;next = *(head);\n        *(head) = new;\n    }\n\n    void print_list (node_t * head){\n        while (head != NULL){\n            printf(\"%s, %s\\n\", head-&gt;pStudent-&gt;last, head-&gt;pStudent-&gt;first);\n\n            head = head-&gt;next;\n        }\n\n    }\n\n    student_t *newStudent(){\n        student_t *new = (student_t *) malloc(sizeof(student_t));\n        new-&gt;first = (char *) malloc(sizeof(char));\n        new-&gt;last = (char *) malloc(sizeof(char));\n\n        printf(\"Enter first name of student: \");\n        scanf(\"%s\", new-&gt;first);\n        printf(\"Enter last name of student: \");\n        scanf(\"%s\", new-&gt;last);\n\n        return new;\n    }\n\n</code></pre>\n\n<p>Expected results:</p>\n\n<pre><code>\n    Enter first name of student: 1\n    Enter last name of student: 1\n    Enter first name of student: 2\n    Enter last name of student: 2\n    Enter first name of student: 3\n    Enter last name of student: 3\n    3, 3\n    2, 2\n    1, 1\n\n</code></pre>\n\n<p>Actual results:</p>\n\n<pre><code>\n    Enter first name of student: 1\n    Enter last name of student: 1\n    Enter first name of student: 2\n    Enter last name of student: 2\n    Enter first name of student: 3\n    Enter last name of student: 3\n    3, 3\n    2, 2\n    1, 1\n    Segmentation fault (core dumped)\n\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5736, "user_id": 1198067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BP0zJ.jpg?s=128&g=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/1198067/andrea"}, "edited": false, "score": 2, "creation_date": 1573052240, "post_id": 58732847, "comment_id": 103756037, "body": "Usually, these kind of algorithms do not stop at the last one, but an element before. In fact, at that point, the nth-1 element is already sorted with respect of the nth one. So, both works, but the &quot;-1&quot; is more efficient because you skip a useless iteration."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 1, "last_activity_date": 1573053950, "last_edit_date": 1573053950, "creation_date": 1573052353, "answer_id": 58732951, "question_id": 58732847, "link": "https://stackoverflow.com/questions/58732847/specific-for-loop-for-a-simple-sort-algorithm/58732951#58732951", "title": "Specific for-loop for a simple sort algorithm", "body": "<p>Your professor is correct, although your way does work too; it's just clumsier:</p>\n\n<p>Given that the starting value of <code>j</code> is <code>i + 1</code>, in order to avoid a out of bounds access to the array <code>a</code> (the behaviour of which is <em>undefined</em>), you need to constrain <code>i</code> to be less than 9 and <code>i + 1</code> to be less than 10. Essentially your professor constrains the former, but you constrain the latter.</p>\n\n<p>The <em>bubble sort</em> works this way as sortedness is established once the outer loop has processed the penultimate element.</p>\n"}, {"tags": [], "owner": {"reputation": 5736, "user_id": 1198067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BP0zJ.jpg?s=128&g=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/1198067/andrea"}, "is_accepted": false, "score": 1, "last_activity_date": 1573052594, "creation_date": 1573052594, "answer_id": 58733035, "question_id": 58732847, "link": "https://stackoverflow.com/questions/58732847/specific-for-loop-for-a-simple-sort-algorithm/58733035#58733035", "title": "Specific for-loop for a simple sort algorithm", "body": "<p>Converting my comment:</p>\n\n<p>Usually, these kind of algorithms do not stop at the last one, but an element before. In fact, at that point, the nth-1 element is already sorted with respect of the nth one. So, both works, but the \"-1\" is more efficient because you skip a useless iteration.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1573053974, "post_id": 58733345, "comment_id": 103757144, "body": "Have an upvote. You got the answer correct first time (unlike me)."}], "tags": [], "owner": {"reputation": 147, "user_id": 7732775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eea2cbd162d4cfeec14119208c9eba6?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantin Murugov", "link": "https://stackoverflow.com/users/7732775/konstantin-murugov"}, "is_accepted": false, "score": 1, "last_activity_date": 1573053487, "creation_date": 1573053487, "answer_id": 58733345, "question_id": 58732847, "link": "https://stackoverflow.com/questions/58732847/specific-for-loop-for-a-simple-sort-algorithm/58733345#58733345", "title": "Specific for-loop for a simple sort algorithm", "body": "<p>In case of <code>for(i=0; i&lt;10; i++)</code> you get one additional iteration of the external loop, in wich <code>i</code> is equal <code>9</code>. But then in the internal loop <code>j</code> is equal <code>10</code> at once, condition <code>j &lt; 10</code> isn't met, and the internal loop terminates without executing its body.</p>\n"}], "owner": {"reputation": 69, "user_id": 10835719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78c234c3471cb5f2e5d57c6791a9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10835719/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58732951, "answer_count": 3, "score": 2, "last_activity_date": 1573054273, "creation_date": 1573052027, "last_edit_date": 1573052315, "question_id": 58732847, "link": "https://stackoverflow.com/questions/58732847/specific-for-loop-for-a-simple-sort-algorithm", "title": "Specific for-loop for a simple sort algorithm", "body": "<p>this is a simple code for sorting a table from max to min. I am confused because my professor used <code>for(i=0; i&lt;10-1; i++)</code> and I saw that it works fine with <code>for(i=0; i&lt;10; i++)</code>. Can please someone tell me the difference?\nThanks for your time, appreciate your help.</p>\n\n<pre><code>int a[10];\nint i, j, t;\n\nfor(i=0; i&lt;10; i++)\n{\n    scanf(\"%d\", &amp;a[i]);\n}\n\n\nfor(i=0; i&lt;10-1; i++)   \n{\n    for(j=i+1; j&lt;10; j++)\n    {\n        if (a[i]&gt;a[j])\n        {\n            t=a[i];\n            a[i]=a[j];\n            a[j]=t;\n        }\n    }\n}\n\nfor(i=0; i&lt;10; i++)\n{\n    printf(\"%d\\n\", a[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "encoding", "file-io", "format"], "comments": [{"owner": {"reputation": 23, "user_id": 9744323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa770e6a5442730bf6d88b44da44421b?s=128&d=identicon&r=PG&f=1", "display_name": "Optic_Ray", "link": "https://stackoverflow.com/users/9744323/optic-ray"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1573052777, "post_id": 58732404, "comment_id": 103756337, "body": "@user3121023 What about double digit integers? Like 10 gives 12337, 11 gives 12593, 12 gives 12849...?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1573053099, "post_id": 58732404, "comment_id": 103756544, "body": "The characters &#39;1&#39;, &#39;0&#39; have ASCII values 0x31 and 0x30. If you read this as a little-endian, 2 byte integer, the value will be 0x3031, which is 12337. By the way, <code>int</code> is often 4 bytes in size, and if the variable is on the stack and hasn&#39;t been initialized, the other 2 bytes of the <code>int</code> will be indeterminate."}, {"owner": {"reputation": 23, "user_id": 9744323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa770e6a5442730bf6d88b44da44421b?s=128&d=identicon&r=PG&f=1", "display_name": "Optic_Ray", "link": "https://stackoverflow.com/users/9744323/optic-ray"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1573059241, "post_id": 58732404, "comment_id": 103760215, "body": "@IanAbbott Does it not capture LF for double digit like for single digit 1 0x0A31 (&#39;1&#39;,LF)? why is it not 0x0A3031 (&#39;1&#39;,&#39;0&#39;,LF) for 10?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1573122786, "post_id": 58732404, "comment_id": 103782259, "body": "@Optic_Ray If is not 0x0A3031 because you are only reading 2 bytes."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9744323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa770e6a5442730bf6d88b44da44421b?s=128&d=identicon&r=PG&f=1", "display_name": "Optic_Ray", "link": "https://stackoverflow.com/users/9744323/optic-ray"}, "edited": false, "score": 0, "creation_date": 1573383876, "post_id": 58733644, "comment_id": 103858099, "body": "After calling your function with data value 10, buff isn&#39;t 12337 like read&#39;s buffer would be when I call read(0, &amp;buff, 2) and stdin 10."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 23, "user_id": 9744323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa770e6a5442730bf6d88b44da44421b?s=128&d=identicon&r=PG&f=1", "display_name": "Optic_Ray", "link": "https://stackoverflow.com/users/9744323/optic-ray"}, "edited": false, "score": 0, "creation_date": 1573476450, "post_id": 58733644, "comment_id": 103883298, "body": "@Optic_Ray Well, it depends on <code>sizeof(int)</code>, the values of <code>data</code> and <code>nbytes</code>, and whether your system stores integers in little-endian or big-endian format. It is basically doing a <code>memcpy</code> from the address of the <code>data</code> variable to the buffer. On a little-endian system (such as a PC) where <code>sizeof(int)</code> is 4, setting <code>data</code> to 10 and <code>nbytes</code> to 2 will set the first two bytes pointed to by <code>buff</code> to 10, 0. Changing <code>data</code> to 12337 will set the first two bytes of <code>buff</code> to 49, 48, which are the ASCII codes for the characters &#39;1&#39; and &#39;0&#39;. I&#39;m not really sure what you&#39;re trying to achieve."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 23, "user_id": 9744323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa770e6a5442730bf6d88b44da44421b?s=128&d=identicon&r=PG&f=1", "display_name": "Optic_Ray", "link": "https://stackoverflow.com/users/9744323/optic-ray"}, "edited": false, "score": 0, "creation_date": 1573479237, "post_id": 58733644, "comment_id": 103884724, "body": "@Optic_Ray See second version of the function in my edited answer. Perhaps that is more like what you are looking for?"}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 1, "last_activity_date": 1573479057, "last_edit_date": 1573479057, "creation_date": 1573054400, "answer_id": 58733644, "question_id": 58732404, "link": "https://stackoverflow.com/questions/58732404/need-a-function-like-read-that-reads-integer-data-into-buffer-and-obtains-same/58733644#58733644", "title": "Need a function like read() that reads integer data into buffer and obtains same buffer value as read()", "body": "<p>I'm not really sure what you are trying to achieve, but my interpretation is that you are trying to copy the bytes of an <code>int</code> into a buffer. That could be implemented something like this:</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nvoid like_read(int data, void *buff, size_t nbytes)\n{\n    size_t n;\n\n    /* Limit number of bytes to copy from data variable. */\n    n = sizeof(data);\n    if (n &lt; nbytes)\n        n = nbytes;\n    /* Copy bytes from data variable to the buffer. */\n    memcpy(buff, &amp;data, n);\n    /* If destination buffer is larger than data variable, ... */\n    if (n &lt; nbytes) {\n        /* ... set the remaining bytes in the destination to all zero. */\n        memset((char *)buff + n, 0, nbytes - n);\n    }\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>what encoding is read() using to convert integer values and how can I do that conversion without read()?</p>\n</blockquote>\n\n<p><code>read()</code> just reads raw data bytes from the file descriptor, without any conversion, at least on POSIX type systems such as Unix and Linux. Some other operating systems such as Microsoft Windows allow files to be opened with special flags that do some conversion on the raw data bytes, mostly for handling text files with different encodings.</p>\n\n<p>The <code>memcpy()</code> call in the <code>like_read</code> function above copies raw data bytes from one memory location to another without any conversion.</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am still not sure what you (OP) are trying to achieve, but based on your comments below, perhaps you are after a function that \"prints\" the integer value as decimal ASCII characters to the buffer with a newline, but truncates to a specified number of bytes. This can nearly be done by <code>snprintf()</code> but that function always writes a terminating null byte to the buffer (if the buffer size is at least 1), so isn't quite what I think you want. Therefore, <code>snprintf()</code> can be used to print the integer value to an intermediate buffer of sufficient size and then <code>memcpy</code> the result to the specified buffer. Here is an implementation of that:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid like_read(int data, void *buff, size_t nbytes)\n{\n    char tempbuf[24]; /* ought to be large enough... */\n    size_t n;\n\n    /* Print data value to temporary buffer. */\n    n = snprintf(tempbuf, sizeof(tempbuf), \"%d\\n\", data);\n    /* n is number of bytes that would be printed to tempbuf if room. */\n    /* Limit number of bytes to copy to size of temporary buffer. */\n    if (n &gt; sizeof(tempbuf))\n        n = sizeof(tempbuf);\n    /* Limit number of bytes to copy to nbytes. */\n    if (n &gt; nbytes)\n        n = nbytes;\n    /* Copy bytes from tempbuf to the buffer. */\n    memcpy(buff, tempbuf, n);\n    /* If destination buffer is larger than n, ... */\n    if (n &lt; nbytes) {\n        /* ... set the remaining bytes in the destination to all zero. */\n        memset((char *)buff + n, 0, nbytes - n);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9744323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa770e6a5442730bf6d88b44da44421b?s=128&d=identicon&r=PG&f=1", "display_name": "Optic_Ray", "link": "https://stackoverflow.com/users/9744323/optic-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58733644, "answer_count": 1, "score": 0, "last_activity_date": 1573479057, "creation_date": 1573050586, "question_id": 58732404, "link": "https://stackoverflow.com/questions/58732404/need-a-function-like-read-that-reads-integer-data-into-buffer-and-obtains-same", "title": "Need a function like read() that reads integer data into buffer and obtains same buffer value as read()", "body": "<p>How can I convert integer into value/encoded character same as the buffer obtained with read(0,buff,nbytes) when I stdin same integer? Am attempting to write something similar like read() but with integer data in place of file descriptor argument that gets read into buffer. </p>\n\n<pre><code>like_read(int data,void *buff,size_t nbytes);\n</code></pre>\n\n<p>It should be similar to read() in the sense that it should read into buffer same value that read(0,buff,nbytes) would from stdin into its buffer. when I provide integer address directly as buffer without first using read(0,buff,nbytes), for example</p>\n\n<pre><code>int Integer=25\nint nbytes=2;\nint rlen,wlen,wlen1;\nint fd = open(\"ttyusb.txt\", O_RDWR | O_CREAT,0777);\nwlen = write(fd, &amp;Integer, nbytes);\nwlen1 = write(1, &amp;Integer, nbytes);//for stdout\nclose(fd);\n</code></pre>\n\n<p><em>Expected output</em></p>\n\n<blockquote>\n  <p>25</p>\n</blockquote>\n\n<p><em>Actual output/file content is some encoded character</em></p>\n\n<p>\n,its not giving me the desired result as first using read() to read integer into buffer from stdin and then writing that buffer into file using write() like:</p>\n\n<pre><code>int Integer;\nint nbytes=2;\nint rlen,wlen;\nint fd = open(\"ttyusb.txt\", O_RDWR | O_CREAT,0777);\nrlen = read(0, &amp;Integer, nbytes);\nwlen = write(fd, &amp;Integer, nbytes);\nwlen1 = write(1, &amp;Integer, nbytes);//for stdout\nclose(fd);\n</code></pre>\n\n<p><em>Stdin</em></p>\n\n<blockquote>\n  <p>25</p>\n</blockquote>\n\n<p><em>Expected output</em></p>\n\n<blockquote>\n  <p>25</p>\n</blockquote>\n\n<p><em>Actual output/file content</em></p>\n\n<blockquote>\n  <p>25</p>\n</blockquote>\n\n<p>when I print buffer value after read(0, buffer, nbytes), it gives some encoded value:</p>\n\n<pre><code>int Integer, nbytes=2;\nint fd = open(\"ttyusb.txt\", O_RDWR | O_CREAT,0777);\nrlen = read(0, &amp;Integer, nbytes);\nwlen = write(fd, &amp;Integer, nbytes);\nwlen1 = write(1, &amp;Integer, nbytes);\nprintf(\"\\nInteger buffer value %d\\n\",Integer);\nclose(fd);\n</code></pre>\n\n<blockquote>\n  <p>stdin 0 prints \"Integer buffer value 2608\", stdin 1 prints \"Integer buffer value 2609\", stdin 2 prints \"Integer buffer value 2610\",.....stdin 9 prints \"Integer buffer value 2617\"...</p>\n</blockquote>\n\n<p>what encoding is read() using to convert integer values and how can I do that conversion without read()?</p>\n"}, {"tags": ["c", "series"], "comments": [{"owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "edited": false, "score": 0, "creation_date": 1573050450, "post_id": 58732346, "comment_id": 103754990, "body": "Your desire output is?"}, {"owner": {"reputation": 319, "user_id": 4246164, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b302a6348d5859bad773a03af0880c25?s=128&d=identicon&r=PG&f=1", "display_name": "Penachia", "link": "https://stackoverflow.com/users/4246164/penachia"}, "edited": false, "score": 1, "creation_date": 1573050676, "post_id": 58732346, "comment_id": 103755133, "body": "<code>j &lt;= n</code>will always be false when <code>n=-8</code>, <b>sum</b> will never be added."}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "is_accepted": false, "score": 3, "last_activity_date": 1573050618, "creation_date": 1573050618, "answer_id": 58732414, "question_id": 58732346, "link": "https://stackoverflow.com/questions/58732346/calculate-series-in-c/58732414#58732414", "title": "Calculate Series in C", "body": "<pre><code>for (int j = 1; j &lt;= n; j++)\n        {\n            sum += (pow((i + j), 3) / pow(j,2) );\n        }\n</code></pre>\n\n<p>when you are trying to input n=-8 this loop won't work coz <code>j=1</code> and condition is set to work until <code>j&lt;=n</code></p>\n"}, {"tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": true, "score": 0, "last_activity_date": 1573052631, "creation_date": 1573052631, "answer_id": 58733045, "question_id": 58732346, "link": "https://stackoverflow.com/questions/58732346/calculate-series-in-c/58733045#58733045", "title": "Calculate Series in C", "body": "<p>In your code, the only expression that modifies the variable named <code>sum</code> is inside the inner loop. The loop will execute only if its controlling expression <code>j &lt;= n</code> is true.</p>\n\n<p>You initialize <code>j</code> with the value of <code>1</code>. If you give <code>n</code> any value less than <code>1</code>, the loop will not execute because <code>j &lt;= n</code> would be false.</p>\n\n<p>Since the initial value of the variable <code>sum</code> is <code>0</code> and the expression that modifies <code>sum</code> is not executed, the output is <code>0</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 12276916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa7baa20283d37aa9936e7f0d3304ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hadi", "link": "https://stackoverflow.com/users/12276916/hadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58733045, "answer_count": 2, "score": 0, "last_activity_date": 1573052631, "creation_date": 1573050402, "question_id": 58732346, "link": "https://stackoverflow.com/questions/58732346/calculate-series-in-c", "title": "Calculate Series in C", "body": "<p>I wrote a program in C for this series.  but when I enter n = -8 and m = 2 the result is zero. </p>\n\n<p>Why and how can I fix it?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ifKcE.jpg\" rel=\"nofollow noreferrer\">Series here</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    int n,m;\n    double sum = 0;\n    printf(\"Enter n:\\n\");\n    scanf_s(\"%d\",&amp;n);\n\n    printf(\"Enter m:\\n\");\n    scanf_s(\"%d\", &amp;m);\n\n    for (int i = -10; i &lt;= m; i++)\n    {\n        for (int j = 1; j &lt;= n; j++)\n        {\n            sum += (pow((i + j), 3) / pow(j,2) );\n        }\n    }\n    printf_s(\"%f\",sum);\n}\n</code></pre>\n"}, {"tags": ["c", "sum-of-digits"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1573049225, "post_id": 58731906, "comment_id": 103754288, "body": "This seems like the perfect time to learn how to use a debugger to step through your code statement by statement, while monitoring variables and their values."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12332483, "user_type": "registered", "profile_image": "https://graph.facebook.com/2900142733331900/picture?type=large", "display_name": "obdaniels", "link": "https://stackoverflow.com/users/12332483/obdaniels"}, "edited": false, "score": 0, "creation_date": 1573049603, "post_id": 58732033, "comment_id": 103754481, "body": "Oh my god, thank you so much for your help! It worked! &lt;3"}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 1, "last_activity_date": 1573049447, "creation_date": 1573049447, "answer_id": 58732033, "question_id": 58731906, "link": "https://stackoverflow.com/questions/58731906/additive-persistence-and-additive-root-program-not-responding-after-inputting-nu/58732033#58732033", "title": "Additive Persistence and Additive Root Program Not Responding After Inputting Number", "body": "<p>Consider this line:</p>\n\n<pre><code>res = num / 10;\n</code></pre>\n\n<p>What's the value of <code>res</code> after the first run through the loop? And after the second run? If you put a print there to debug your program, you'll see that <code>res</code> always has the same value and doesn't change. It's an infinite loop and will probably go on until you have undefined behavior when <code>sum</code> overflows. You probably wanted this instead:</p>\n\n<pre><code>res = res / 10;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12332483, "user_type": "registered", "profile_image": "https://graph.facebook.com/2900142733331900/picture?type=large", "display_name": "obdaniels", "link": "https://stackoverflow.com/users/12332483/obdaniels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 58732033, "answer_count": 1, "score": 0, "last_activity_date": 1573110661, "creation_date": 1573048982, "last_edit_date": 1573110661, "question_id": 58731906, "link": "https://stackoverflow.com/questions/58731906/additive-persistence-and-additive-root-program-not-responding-after-inputting-nu", "title": "Additive Persistence and Additive Root Program Not Responding After Inputting Number", "body": "<p>I have a homework assignment for my beginner's C programming class:</p>\n\n<p>Additive persistence is a property of the sum of the digits of an integer. The sum of the digits is found, and then the summation of digits is performed on the sum, repeating until a single integer digit is reached. The number of such cycles is that integer\u2019s additive persistence. Consider the\nfollowing example:</p>\n\n<p>\u25cf   The beginning integer is 1234</p>\n\n<p>\u25cf   Sum its digits is 1+2+3+4 = 10</p>\n\n<p>\u25cf   The integer is now 10</p>\n\n<p>\u25cf   The sum of its digits is 1 + 0 = 1</p>\n\n<p>\u25cf   The integer is 1. When the value reaches a single digit, we are finished. This final integer is the additive root</p>\n\n<p>The number of cycles is the additive persistence. The integer 1234 has an additive persistence of 2 (first sum was 10, then the second sum was 1). The final digit reached is called the integer\u2019s additive digital root. The additive digital root of 1234 is 1.\nWrite a program that:</p>\n\n<p>\u25cf   Ask the user for a positive integer.</p>\n\n<p>\u25cf   If the given integer is a single digit, report it\u2019s additive persistence and multiplicative persistence as 0 and both its additive root as itself.</p>\n\n<p>\u25cf   If the integer is less than 0, that is a signal to quit the program.</p>\n\n<p>\u25cf   Otherwise, find the additive persistence and additive root of the given integer and report the results to the user</p>\n\n<p>\u25cf   Continue by prompting the user until they quit</p>\n\n<p>This is the code I came up with:</p>\n\n<pre><code>\n\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    int num;\n    int pers = 0;\n    int res = 0;\n    int sig = 0;\n    int sum = 0;\n    int sum1 = 0;\n\n    for (sig = 0;sig &gt;= 0;) {\n        printf(\"Please enter a positive integer to find the additive persistence, and the integer's additive digital root: \");\n        scanf_s(\"%d\", &amp;num);\n        if (num &lt; 0) {\n            sig--;\n            break;\n        }\n        res = num;\n        sum = 0;\n        while((res&gt;0)){\n\n            sum = sum + (res % 10);\n            res = num / 10;\n            if (res == 0) {\n                if (sum &gt;= 10) {\n                    res = sum;\n                    sum = 0;\n\n                }\n                if (sum &lt; 10)\n                    pers++;\n\n\n            }\n\n        }\n\n\n        printf(\"\\nThe additive persistence is %d and the additive root is %d\\n\", pers, sum);\n\n\n\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Whenever I (successfully) compile and run the code, after the scanf statement the program does nothing. Why is this happening? And any advice for successfully completing this assignment?\nThank you so much for your help </p>\n"}, {"tags": ["c", "struct", "shared-memory", "memcpy"], "comments": [{"owner": {"reputation": 4756, "user_id": 1364149, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y25ip.jpg?s=128&g=1", "display_name": "Shloim", "link": "https://stackoverflow.com/users/1364149/shloim"}, "edited": false, "score": 2, "creation_date": 1573048187, "post_id": 58731625, "comment_id": 103753747, "body": "Hello and welcome to StackOverflow. Please take some time to learn about <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Examples</a>."}, {"owner": {"reputation": 848, "user_id": 9815377, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_ix-HrP8dks/AAAAAAAAAAI/AAAAAAAAAGQ/EsjH8FtkC2k/photo.jpg?sz=128", "display_name": "sephiroth", "link": "https://stackoverflow.com/users/9815377/sephiroth"}, "edited": false, "score": 0, "creation_date": 1573048349, "post_id": 58731625, "comment_id": 103753831, "body": "<code>sizeof(input)</code> is likely 4 (or 8)"}, {"owner": {"reputation": 53, "user_id": 12213305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCMeX.png?s=128&g=1", "display_name": "Guillaume Lemer", "link": "https://stackoverflow.com/users/12213305/guillaume-lemer"}, "edited": false, "score": 0, "creation_date": 1573048757, "post_id": 58731625, "comment_id": 103754077, "body": "@Someprogrammerdude i would like to copy all the values (data) from input to the carList, so my error should be there"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1573048864, "post_id": 58731625, "comment_id": 103754136, "body": "You already have the answer (check the sizes!): <code>memcpy(carList, input, sizeof *input);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1573048852, "creation_date": 1573048852, "answer_id": 58731872, "question_id": 58731625, "link": "https://stackoverflow.com/questions/58731625/copy-of-a-struct-in-c/58731872#58731872", "title": "copy of a struct in C", "body": "<p>There are two major problems with the <code>memcpy</code> call you show, and one minor problem:</p>\n\n<ol>\n<li><p>You pass <code>&amp;input</code> as the source pointer. The problem here is that <code>&amp;input</code> is a pointer to the variable <code>input</code> and not a pointer to the shared memory where <code>input</code> is pointing. That means you copy the <em>pointer</em> and not the data being pointed to. To solve this problem use plain <code>input</code>.</p></li>\n<li><p>As the size you use <code>sizeof(input)</code>, which is the size of the <em>pointer itself</em>, not the size of what it points to. The size you probably want to copy is <code>sizeof carList</code>, which is the size of the destination array (in bytes).</p></li>\n<li><p>The minor problem is the destination, where you use <code>&amp;carList</code>. This is a pointer to the array, and have the type <code>f1 (*)[20]</code>. What you need is a pointer to the first element of the array, which is <code>&amp;carList[0]</code>, or plain <code>carList</code> (which is the same).</p></li>\n</ol>\n\n<p>So the call should probably look like</p>\n\n<pre><code>memcpy(carList, input, sizeof carList);  // Copy from the shared memory into our local array\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 12213305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCMeX.png?s=128&g=1", "display_name": "Guillaume Lemer", "link": "https://stackoverflow.com/users/12213305/guillaume-lemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 58731872, "answer_count": 1, "score": 0, "last_activity_date": 1573048852, "creation_date": 1573047992, "question_id": 58731625, "link": "https://stackoverflow.com/questions/58731625/copy-of-a-struct-in-c", "title": "copy of a struct in C", "body": "<p>in a project in c I have to copy an array of struct from a sharedMemory</p>\n\n<p>i'm doing :</p>\n\n<pre><code>int status = 0;\npid_t wpid;\nf1 *input = (f1*) shmat(shmid,0,0);\nwhile ((wpid = wait(&amp;status)) &gt; 0){\n    memcpy(&amp;carList, &amp;input, sizeof(input));\n}\n</code></pre>\n\n<p>f1 is my structure of a car.</p>\n\n<p>but nothing is copied in the carList, but the values are in input from the son Process\ni think the problem is on this part of the code, i tried multiples others possibilities but i don't find any where else.</p>\n\n<p>I have to use the shared memory to create 20 son and make them generate random times for a race like car.</p>\n\n<p>So i created 20 son that i linked to a entry of an array of they struct, and make them write in it the time they generate.</p>\n\n<p>Then, from time to time, the father copy the array of struct to make a dynamic table of all the time from the cars. I know that using the cpu-scheduler is not the best idea but that's what we have to do in the lecture so we have no choices.</p>\n\n<blockquote>\n  <p>full code but it's a bit long (and i'm french so the notes are in french)</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt; // bool\n#include &lt;unistd.h&gt; //fork\n#include &lt;string.h&gt; //strcat\n#include &lt;sys/wait.h&gt; //wait\n#include &lt;sys/types.h&gt;\n#include &lt;sys/shm.h&gt;\n\n#define TURN 3\n#define SECTION 3\n#define CAR 20\n#define KEY 666\n#define STANDPOURCENT 10\n\ntypedef struct {\n    int number;\n    int stands;\n    bool out;\n    int totalTime;\n\n    int circuit[TURN][SECTION];\n} f1;\n\nint carListNumber[CAR] = {7, 99, 5, 16, 8, 20, 4, 55, 10, 26, 44, 77, 11, 18, 23, 33, 3, 27, 63, 88};\nf1 carList[CAR];\n/***********************************************************************************************************************\n *                               fonctions\n **********************************************************************************************************************/\n\n/**\n * renvois un nombre compris entre 40 et 45 secondes pour le\n * clacul du temps des tours de circuits\n * @return integer between 40 and 45\n */\nint genSection(){\n    int time = 45 - (rand() % 9);\n    sleep(time/20);\n    return time; // gestion du random et du temps perdu\n}\n\n/**\n * g\u00e9n\u00e9ration du temps d'arret au stand\n * @return integer between 2 and 5\n */\nint genRandomStand(){\n    return  5 - (rand() % 3);\n}\n\n/**\n * g\u00e9n\u00e9ration nombre entre 1 et 100\n * @return int between 1 and 100\n */\nint genRandom(){\n    return 100 - (rand() % 100);\n}\n\n/**\n * clear de la console\n */\nvoid clrscr(){\n    system(\"clear\");\n}\n\n/**\n * affichage du tableau de r\u00e9sultat de tout les tours pour toutes les voitures et sections\n */\nvoid showRun(){\n    clrscr();\n    for (int turn = 0; turn &lt; TURN; turn++){\n        for(int car = 0; car &lt; CAR; car++){\n            printf(\"Voiture %3d || turn : %3d ||S1 : %1d | S2 : %2d | S3 : %2d  || Total Turn : %3d \\n\",carList[car].number,\n                   turn+1,\n                   carList[car].circuit[turn][0],\n                   carList[car].circuit[turn][1],\n                   carList[car].circuit[turn][2],\n                   carList[car].circuit[turn][0]+carList[car].circuit[turn][1]+carList[car].circuit[turn][2]);\n        }\n        printf(\"---------------------------------------------------------------------------------------------------------------\\n\");\n    }\n}\n\n/**\n* generation de la liste des structur voitrure sur base de la liste des numero de voitures\n* @return void\n*/\nvoid init_car_list(int *carListNumber){\n    for(int i = 0; i &lt; CAR; i++){\n        carList[i].number = carListNumber[i];\n        carList[i].stands = 0;\n        carList[i].out = false;\n        carList[i].totalTime = 0;\n        memset(carList[i].circuit, 0, sizeof(carList[i].circuit));\n    }\n}\n\n/**\n * initalistation de la voiture pass\u00e9 en param\n * @param carNumber\n */\nf1 init_car(int carNumber){\n    f1 tmp;\n    tmp.number = carNumber;\n    tmp.stands = 0;\n    tmp.out = false;\n    tmp.totalTime = 0;\n    memset(tmp.circuit, 0, sizeof(tmp.circuit));\n    return tmp;\n}\n\n/**\n * fonction du code du fils (voiture)\n */\nvoid circuit_son(int shmid,int carPosition){\n    int carNumber = carListNumber[carPosition];\n    //printf(\"in son %d : car number %d\\n\",carPosition,carNumber);\n    f1 *output = (f1 *) shmat(shmid, 0, 0);\n    printf(\"D\u00e9part de la voiture %d\\n\",carNumber);\n    f1 *currentCar;\n    srand(time()+getpid()); // g\u00e9n\u00e9ration du nouveau random pour chaque fils\n    //printf(\"r\u00e9cup\u00e9ration de la strcuct voiture %d \\n\",carNumber);\n    for(int i = 0; i &lt; CAR; i++){\n        if(output[i].number == carNumber){\n            currentCar = &amp;output[i];\n            //printf(\"R\u00e9cup\u00e9ration de :: output %d || carNumber %d || current car %d \\n\",output[i].number,carNumber,currentCar-&gt;number);\n            break;\n        }\n    }\n    for(int i = 0; i &lt; TURN; i++){ // pour chaque tour\n        for(int j = 0; j &lt; SECTION; j++){ // pour chaque section du tour\n            currentCar-&gt;circuit[i][j] = genSection();\n            printf(\"car %d , %d \\n\",currentCar-&gt;number,currentCar-&gt;circuit[i][j]);\n        }\n        if (genRandom() &gt; STANDPOURCENT || (i == (TURN-1) &amp;&amp; currentCar-&gt;stands == 0)){ // 50% de s'arreter ou si jamais arr\u00eater pendant la course\n            currentCar-&gt;circuit[i][SECTION-1] += genRandomStand();\n            printf(\"arret de la voiture %d au stand , temps total de la section 3 : %d \\n\",currentCar-&gt;number,currentCar-&gt;circuit[i][SECTION-1]);\n            currentCar-&gt;stands++;\n        }\n    }\n    exit(EXIT_SUCCESS);\n}\n\n/**\n * fonction du p\u00e8re\n * @return\n */\nvoid circuit_father(int shmid){\n    int status = 0;\n    pid_t wpid;\n    // r\u00e9cup\u00e9ration des donn\u00e9es de la SM\n    f1 *input = (f1*) shmat(shmid,0,0);\n    while ((wpid = wait(&amp;status)) &gt; 0){ // temps que un processus est en cours\n        memcpy(&amp;carList, &amp;input, sizeof(input));\n        printf(\"input %d %d %d \\n\",input[4].circuit[1][0],input[4].circuit[1][1],input[4].circuit[1][2]);\n        //showRun();\n        printf(\"show run here in father || %d %d %d\\n\",carList[4].circuit[1][0],carList[4].circuit[1][1],carList[4].circuit[1][2]);\n    }\n}\n\n/**\n * gestion des tours d essais des voitures\n * @param shmid id de la memoire partag\u00e9e\n * @return -1 if error else 0\n */\nint gen_circuit(int shmid) {\n    for (int car = 0; car &lt; CAR; car++) {\n        int pid = fork();\n        if (pid &lt; 0) {\n            perror(\"error on creation of car\");\n            printf(\"\\n\");\n            return -1;\n        }\n            /* Son */\n        else if (pid == 0) {\n            circuit_son(shmid,car);\n        }\n    }\n    /* Parent */\n    circuit_father(shmid);\n    return 0;\n}\n\n/**\n * initalisation de la shared memory\n */\nvoid init_mem(shmid){\n    f1 *mem = (f1 *) shmat(shmid, 0, 0);\n    for(int i = 0; i &lt; CAR; i++){\n        mem[i] = init_car(carListNumber[i]);\n    }\n}\n\n/**\n *\n * @return\n */\nint main(){\n    // initalisation des voitures\n    init_car_list(carListNumber);\n    // allocation de la mem partag\u00e9e\n    int shmid = shmget(KEY, (20 * sizeof(f1)),0666 | IPC_CREAT); // 0775 || user = 7 | groupe = 7 | other = 5\n    if (shmid == -1){\n        perror(\"ERROR in creation of the Shared Memory\");\n        printf(\"\\n\");\n        shmctl(shmid,IPC_RMID,NULL); // suppression de la memoire partag\u00e9e\n        return 1;\n    }\n    init_mem(shmid);\n    // gestion du circuit\n\n    gen_circuit(shmid);\n    printf(\"tout les tours sont termin\u00e9 \\n\");\n    printf(\"affichage des R\u00e9sultats : \\n\");\n    //showRun();\n\n    // fin de la course\n    printf(\"fin des tours \\n\");\n    shmctl(shmid,IPC_RMID,NULL); // suppression de la memoire partag\u00e9e\n    return 0; // fin du programme\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "printf", "clone"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1573051165, "post_id": 58731945, "comment_id": 103755401, "body": "<code>&amp;(stack[4095])</code> is probably misaligned for use as a stack pointer. Try it with <code>&amp;(stack[4096])</code> instead."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1573051288, "post_id": 58731945, "comment_id": 103755463, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/38067026/segfault-with-clone-and-printf\">segfault with clone() and printf</a>"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1573051435, "post_id": 58731945, "comment_id": 103755552, "body": "Are you sure you need <code>clone</code> ? Why not <code>pthread_create</code> or <code>fork</code> ?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1573051582, "post_id": 58731945, "comment_id": 103755652, "body": "Also : the signature should be <code>int func(void*)</code>, not <code>void func()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12291786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63addb15543bf7c157ff8ef66abda889?s=128&d=identicon&r=PG&f=1", "display_name": "qiu", "link": "https://stackoverflow.com/users/12291786/qiu"}, "edited": false, "score": 0, "creation_date": 1573114672, "post_id": 58732686, "comment_id": 103777991, "body": "It works when l enlarge the stack&#39;s size.But go back to the question,why does the child process&#39;s printf will in the stack range when the calling process don&#39;t printf?"}, {"owner": {"reputation": 141, "user_id": 4228744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QUYgD.png?s=128&g=1", "display_name": "JigglyNaga", "link": "https://stackoverflow.com/users/4228744/jigglynaga"}, "reply_to_user": {"reputation": 11, "user_id": 12291786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63addb15543bf7c157ff8ef66abda889?s=128&d=identicon&r=PG&f=1", "display_name": "qiu", "link": "https://stackoverflow.com/users/12291786/qiu"}, "edited": false, "score": 0, "creation_date": 1573132304, "post_id": 58732686, "comment_id": 103787369, "body": "When I tried without the early <code>printf</code>, I got inconsistent results -- it would still sometimes give incomplete output.  So the early <code>printf</code> isn&#39;t what&#39;s causing the problem, it just makes it more likely."}], "tags": [], "owner": {"reputation": 141, "user_id": 4228744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QUYgD.png?s=128&g=1", "display_name": "JigglyNaga", "link": "https://stackoverflow.com/users/4228744/jigglynaga"}, "is_accepted": false, "score": 4, "last_activity_date": 1573132182, "last_edit_date": 1573132182, "creation_date": 1573051614, "answer_id": 58732686, "question_id": 58731945, "link": "https://stackoverflow.com/questions/58731945/what-did-printf-do-in-the-shared-memory/58732686#58732686", "title": "what did printf do in the shared memory", "body": "<p>Your call to <code>printf</code> is overflowing the available stack.  4096 bytes isn't enough for all it needs to do.  To confirm, here's a sample gdb session:</p>\n\n<pre><code>Reading symbols from ./a.out...done.\n(gdb) break 14\nBreakpoint 1 at 0x400624: file source.c, line 14.\n(gdb) break 16\nBreakpoint 2 at 0x400659: file source.c, line 16.\n(gdb) break func\nBreakpoint 3 at 0x40068b: file source.c, line 21.\n(gdb) run\nStarting program: a.out \ni am main\n\nBreakpoint 1, main (argc=1, argv=0x7fffffffe3a8) at source.c:14\n14      retval=clone((void*)func,&amp;(stack[4095]),clone_flag,NULL);\n(gdb) print/x stack\n$1 = 0x602420\n(gdb) cont\nContinuing.\n[New LWP 25381]\n[Switching to LWP 25381]\n\nThread 2 hit Breakpoint 3, func () at source.c:21\n21      for(i=0;i&lt;3;i++)\n(gdb) print/x &amp;i\n$2 = 0x60340b\n(gdb) watch $rsp &lt; 0x602420 \nWatchpoint 4: $rsp &lt; 0x602420\n</code></pre>\n\n<p>I've asked <code>gdb</code> to stop when the stack pointer (<code>$rsp</code> on x86-64 machines; you may need a different register according to your CPU) falls below the start of the allocated stack range.</p>\n\n<pre><code>(gdb) cont\nContinuing.\n[Switching to LWP 25375]\n\nThread 1 \"a.out\" hit Breakpoint 2, main (argc=1, argv=0x7fffffffe3a8) at source.c:16\n16      retval=clone((void*)func,&amp;(stack[4095]),clone_flag,NULL);\n(gdb) print/x stack\n$3 = 0x603430\n(gdb) cont\nContinuing.\n[New LWP 25383]\n[Switching to LWP 25383]\n\nThread 3 hit Breakpoint 3, func () at source.c:21\n21      for(i=0;i&lt;3;i++)\n(gdb) cont\nContinuing.\n[Switching to LWP 25381]\n\nThread 2 hit Watchpoint 4: $rsp &lt; 0x602420\n\nOld value = 0 \nNew value = 1\nbuffered_vfprintf (s=0x7ffff7dd2620 &lt;_IO_2_1_stdout_&gt;, format=0x40074e \"i: %d\\n \", args=0x603327) at vfprintf.c:2295\n2295        vfprintf.c: No such file or directory.\n(gdb) where\n#0  buffered_vfprintf (s=0x7ffff7dd2620 &lt;_IO_2_1_stdout_&gt;, format=0x40074e \"i: %d\\n \", args=0x603327) at vfprintf.c:2295\n#1  0x00007ffff7a5a32d in _IO_vfprintf_internal (s=0x7ffff7dd2620 &lt;_IO_2_1_stdout_&gt;, format=0x40074e \"i: %d\\n \",\n    ap=ap@entry=0x603327) at vfprintf.c:1293\n#2  0x00007ffff7a62899 in __printf (format=&lt;optimised out&gt;) at printf.c:33\n#3  0x00000000004006a8 in func () at source.c:23\n#4  0x00007ffff7b1441d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109\n</code></pre>\n\n<p>We can now see that the stack pointer has gone well below the stack range allocated.</p>\n\n<pre><code>(gdb) print/x $rsp\n$4 = 0x600c4f\n</code></pre>\n\n<p>Regarding what difference the <code>printf</code> makes, you could compare execution traces (generated using <a href=\"https://stackoverflow.com/a/2999457/4228744\">a simple <code>si</code> loop</a>).  I found that they <em>first</em> diverge at <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=stdio-common/vfprintf-internal.c;h=547a3a868b4668bf615cf3f39a92e3c11cbb98ad;hb=HEAD#l1343\" rel=\"nofollow noreferrer\">this test</a>:</p>\n\n<pre><code>   if (UNBUFFERED_P (s))\n     /* Use a helper function which will allocate a local temporary buffer\n        for the stream and then call us again.  */\n     return buffered_vfprintf (s, format, ap, mode_flags);\n</code></pre>\n\n<p>It appears that the earlier call to <code>printf</code> has changed the mode of <code>stdout</code> to \"unbuffered\", so the later <code>printf</code> needs to go deeper to work with it.  You could reproduce this by replacing the first <code>printf</code> with <code>setbuf(stdout,NULL)</code>.</p>\n\n<p>However, the real question isn't why <code>printf</code> makes a difference, it's \"How Did That Ever Work?\".  There are three processes, two of which are being careless with the memory space they all share, so if and when they break is down to timing.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1573049140, "question_id": 550680}, "owner": {"reputation": 11, "user_id": 12291786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63addb15543bf7c157ff8ef66abda889?s=128&d=identicon&r=PG&f=1", "display_name": "qiu", "link": "https://stackoverflow.com/users/12291786/qiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1573132182, "creation_date": 1573046805, "last_edit_date": 1573069889, "question_id": 58731945, "link": "https://stackoverflow.com/questions/58731945/what-did-printf-do-in-the-shared-memory", "title": "what did printf do in the shared memory", "body": "<pre><code>#define _GNU_SOURCE  \n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\nvoid func();\nvoid main(int argc,char **argv)\n{\n    printf(\"i am main\\n\");\n    int clone_flag,arg,retval;\n    char *stack;\n    clone_flag=CLONE_VM|CLONE_SIGHAND;\n    stack=(char*)malloc(4096);\n    retval=clone((void*)func,&amp;(stack[4095]),clone_flag,NULL);\n    stack=(char*)malloc(4096);\n    retval=clone((void*)func,&amp;(stack[4095]),clone_flag,NULL); \n}\nvoid func()\n{\n    int i;\n    for(i=0;i&lt;3;i++)\n    {\n    printf(\"i: %d\\n \",i);\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>i am main\ni: 0   \ni: 1\n</code></pre>\n\n<p>strace -f </p>\n\n<pre><code>5915  fstat(1, {st_mode=S_IFCHR|0600, st_rdev=makedev(4, 1), ...}) = 0\n5915  ioctl(1, TCGETS, {B38400 opost isig icanon echo ...}) = 0\n5915  brk(NULL)                         = 0xaf2000\n5915  brk(0xb14000)                     = 0xb14000\n5915  write(1, \"i am main\\n\", 10)       = 10\n5915  clone(child_stack=0xaf400f, flags=CLONE_VM|CLONE_SIGHAND) = 5916\n5915  clone(child_stack=0xaf501f, flags=CLONE_VM|CLONE_SIGHAND) = 5917\n5915  exit_group(5917)                  = ?\n5915  +++ exited with 29 +++\n5917  write(1, \"i\", 1)                  = 1\n5917  write(1, \": 0\\n \", 5)             = 5\n5917  write(1, \"i\", 1)                  = 1\n5917  write(1, \": 1\\n \", 5)             = 5\n5916  --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0xaf194f} ---\n5916  +++ killed by SIGSEGV (core dumped) +++\n5917  +++ killed by SIGSEGV +++\n\n</code></pre>\n\n<p>gdb ./a.out core</p>\n\n<pre><code>Core was generated by `./a.out'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  buffered_vfprintf (s=0x7f737fd43620 &lt;_IO_2_1_stdout_&gt;, \n    format=0x40074e \"i: %d\\n \", args=0x1f49f27) at vfprintf.c:2299\n2299    vfprintf.c: No such file or directory.\n[Current thread is 1 (LWP 6280)]\n(gdb) where\n#0  buffered_vfprintf (s=0x7f737fd43620 &lt;_IO_2_1_stdout_&gt;, \n    format=0x40074e \"i: %d\\n \", args=0x1f49f27) at vfprintf.c:2299\n#1  0x00007f737f9cb32d in _IO_vfprintf_internal (\n    s=0x7f737fd43620 &lt;_IO_2_1_stdout_&gt;, format=0x40074e \"i: %d\\n \", \n    ap=ap@entry=0x1f49f27) at vfprintf.c:1293\n#2  0x00007f737f9d3899 in __printf (format=&lt;optimized out&gt;) at printf.c:33\n#3  0x00000000004006a8 in func () at code.c:23\n#4  0x00007f737fa8541d in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109\n\n</code></pre>\n\n<p><strong>it is confusing if I remove the\"printf(\"i am main\\n\");\"\nthe code will run well</strong>   </p>\n\n<p>strace</p>\n\n<pre><code>5937  brk(NULL)                         = 0x1f75000\n5937  brk(0x1f97000)                    = 0x1f97000\n5937  clone(child_stack=0x1f75fff, flags=CLONE_VM|CLONE_SIGHAND) = 5938\n5937  clone(child_stack=0x1f7700f, flags=CLONE_VM|CLONE_SIGHAND) = 5939\n5937  exit_group(5939)                  = ?\n5937  +++ exited with 51 +++\n5939  fstat(1, {st_mode=S_IFCHR|0600, st_rdev=makedev(4, 1), ...}) = 0\n5939  ioctl(1, TCGETS, {B38400 opost isig icanon echo ...}) = 0\n5939  write(1, \"i: 0\\n\", 5)             = 5\n5939  write(1, \" i: 1\\n\", 6)            = 6\n5939  write(1, \" i: 2\\n\", 6)            = 6\n5938  write(1, \" i: 2\\ni: 0\\n\", 11)     = 11\n5939  exit_group(6)                     = ?\n5939  +++ exited with 6 +++\n5938  write(1, \" i: 1\\n\", 6)            = 6\n5938  write(1, \" i: 2\\n\", 6)            = 6\n5938  exit_group(6)                     = ?\n5938  +++ exited with 6 +++\n\n</code></pre>\n\n<p>why the \"printf\" makes such a big difference?(by the way,why the SIGSEGV killed another process?)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 3, "creation_date": 1573046315, "post_id": 58731062, "comment_id": 103752598, "body": "Links to code are not optimal here.  Post the code you have a question about.  It should be a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, with clearly stated problem."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1573046332, "post_id": 58731062, "comment_id": 103752611, "body": "Multiple threads, asynchronous IO, non-blocking IO...."}, {"owner": {"reputation": 366, "user_id": 2372963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ed0138024f09030d02fdae6e2980fc8?s=128&d=identicon&r=PG", "display_name": "David Wright", "link": "https://stackoverflow.com/users/2372963/david-wright"}, "edited": false, "score": 0, "creation_date": 1573048010, "post_id": 58731062, "comment_id": 103753653, "body": "This example does not compile, the problem is not reproducible."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1573048557, "post_id": 58731062, "comment_id": 103753958, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5616092/non-blocking-call-for-reading-descriptor\">Non-blocking call for reading descriptor</a> Just set <code>O_NONBLOCK</code>."}, {"owner": {"reputation": 83, "user_id": 9575098, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Seth", "link": "https://stackoverflow.com/users/9575098/seth"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1573048755, "post_id": 58731062, "comment_id": 103754076, "body": "@KamilCuk where i have to add O_NONBLOCK?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1573048811, "post_id": 58731062, "comment_id": 103754107, "body": "Follow the link. The example usage of <code>fcntl</code> is right there."}, {"owner": {"reputation": 83, "user_id": 9575098, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Seth", "link": "https://stackoverflow.com/users/9575098/seth"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1573049305, "post_id": 58731062, "comment_id": 103754324, "body": "@KamilCuk it worked, thanks"}], "owner": {"reputation": 83, "user_id": 9575098, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Seth", "link": "https://stackoverflow.com/users/9575098/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573048558, "creation_date": 1573046120, "last_edit_date": 1573048558, "question_id": 58731062, "link": "https://stackoverflow.com/questions/58731062/can-i-avoid-read-to-wait-for-input", "title": "Can I avoid read to wait for input", "body": "<p>I'm trying to make a C version of Snake.\nThis is the situation: <code>set_input_mode()</code> is used to change the terminal behaviour to not echo character and take it one at time, when i press a key i want the snake to turn in that direction and continue, but he keeps waiting for the read() to give him something. How can I avoid this behaviour?\n(The full code is avaiable <a href=\"https://github.com/TheManInTheMirror/snake-C-version\" rel=\"nofollow noreferrer\">here</a>)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(){\nchar c;\nset_input_mode();\nwhile(1){\n  read(0, &amp;c, 1);\n\nswitch(mv)\nall the cases..\n}\n}\n\n\nvoid set_input_mode (){\nstruct termios tattr;\nchar *name;\n\n/* Make sure stdin is a terminal. */\nif (!isatty (STDIN_FILENO))\n  {\n    fprintf (stderr, \"Not a terminal.\\n\");\n    exit (EXIT_FAILURE);\n  }\n\n/* Save the terminal attributes so we can restore them later. */\ntcgetattr (STDIN_FILENO, &amp;saved_attributes);\natexit (reset_input_mode);\n\n/* Set the terminal modes. */\ntcgetattr (STDIN_FILENO, &amp;tattr);\ntattr.c_lflag &amp;= ~(ICANON|ECHO); /* Clear ICANON and ECHO. */\ntattr.c_cc[VMIN] = 1;\ntattr.c_cc[VTIME] = 0;\ntcsetattr (STDIN_FILENO, TCSAFLUSH, &amp;tattr);\n}\n\n\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "char"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1573045839, "post_id": 58730902, "comment_id": 103752326, "body": "Activate compiler warnings and read them. They would have warned you about this."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 1, "last_activity_date": 1573046014, "creation_date": 1573046014, "answer_id": 58731029, "question_id": 58730902, "link": "https://stackoverflow.com/questions/58730902/c-finding-a-specific-character-in-a-string/58731029#58731029", "title": "C: Finding a specific character in a string", "body": "<p>The problem is that this here</p>\n\n<pre><code>scanf(\"%s\", letter);\n</code></pre>\n\n<p>Is undefined behavior because it's expecting a pointer to a character, but you give it a character. The <code>%s</code> specifier is for reading strings, not single characters. Your compiler should warn you about a type mismatch here.</p>\n\n<p>Instead, change it to this:</p>\n\n<pre><code>scanf(\" %c\", &amp;letter);\n</code></pre>\n\n<p><code>%c</code> is for reading in single characters, and with the leading space you make it ignore any leading whitespace in the input (such as the newline entered after you word).</p>\n\n<p>You should also change <code>scanf(\"%s\", word);</code> to <code>scanf(\"%79s\", word);</code> in order to avoid undefined behavior when the user enters a very long word (this limits the word's length to your buffer's size).</p>\n"}], "owner": {"reputation": 23, "user_id": 12332182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d95f2af79c8cb7db031ef7e6fb7aa3?s=128&d=identicon&r=PG&f=1", "display_name": "SurgeryOnAGrape", "link": "https://stackoverflow.com/users/12332182/surgeryonagrape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 58731029, "answer_count": 1, "score": 0, "last_activity_date": 1573046014, "creation_date": 1573045630, "question_id": 58730902, "link": "https://stackoverflow.com/questions/58730902/c-finding-a-specific-character-in-a-string", "title": "C: Finding a specific character in a string", "body": "<p>I am trying to write a program that searches for the first occurance of a specific character in a string. But no matter what character i type in the number the program gives back is the number of the last character.</p>\n\n<pre><code>int where (char *str, char ltr);\n\nint main () {\n    char word [80];\n    char letter;\n    printf(\"Type in a word: \");\n    scanf(\"%s\", word);\n    printf(\"Type in a character: \");\n    scanf(\"%s\", letter);\n    printf(\"%d\", where(word, letter));\n}\n\nint where (char *str, char ltr){\n    int i = 0;\n    while(i &lt; strlen(str)){\n        if(ltr == str[i]){\n            break;\n        }\n        i++;\n    }\n    return i;\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "crc"], "comments": [{"owner": {"reputation": 148466, "user_id": 2319407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98O16.jpg?s=128&g=1", "display_name": "Dmitry Bychenko", "link": "https://stackoverflow.com/users/2319407/dmitry-bychenko"}, "edited": false, "score": 3, "creation_date": 1573045670, "post_id": 58730848, "comment_id": 103752229, "body": "Could you provide some <i>test examples</i>, please?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 4, "creation_date": 1573045691, "post_id": 58730848, "comment_id": 103752241, "body": "Wouldn&#39;t it be easier to just look at a specification and reeimplement it without looking at the C code?"}, {"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 4, "creation_date": 1573045722, "post_id": 58730848, "comment_id": 103752256, "body": "I might be wrong, but <code>while (count--)</code> in C should be <code>while (count-- &gt; 0)</code> in c#, instead of <code>while (count-- &gt;= 0)</code>"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 8, "creation_date": 1573046043, "post_id": 58730848, "comment_id": 103752433, "body": "The C code line <code>u32Word = *((uint32_t*)pData)++;</code> re-interprets the <code>uint8_t *pData</code> as a <code>uint32_t *</code>, so it takes 4 bytes each. This probably depends on the byte order of the system and may require correct alignment of the data. I guess in C# you would have to combine 4 subsequent bytes to a 32-bit unsigned integer. The C implementation seems to require that <code>count</code> is a multiple of 4."}, {"owner": {"reputation": 366, "user_id": 2298776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g9EAF.jpg?s=128&g=1", "display_name": "Ribeiro", "link": "https://stackoverflow.com/users/2298776/ribeiro"}, "reply_to_user": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1573052592, "post_id": 58730848, "comment_id": 103756231, "body": "@Cid you are absolutely right on that one. Using the equals ended up in an exception."}, {"owner": {"reputation": 366, "user_id": 2298776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g9EAF.jpg?s=128&g=1", "display_name": "Ribeiro", "link": "https://stackoverflow.com/users/2298776/ribeiro"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1573052692, "post_id": 58730848, "comment_id": 103756291, "body": "@Bodo absolutely. the accepted answer has this considered with the line: <code>u32Word = BitConverter.ToUInt32(blockImage,i*sizeof(uint));</code>"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1573054893, "post_id": 58730848, "comment_id": 103757719, "body": "Following up on @Bodo&#39;s comment, if this is a little endian processor, such as X86, then it&#39;s not a proper CRC since it&#39;s effectively reversing the order of every 4 byte group."}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 2298776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g9EAF.jpg?s=128&g=1", "display_name": "Ribeiro", "link": "https://stackoverflow.com/users/2298776/ribeiro"}, "edited": false, "score": 0, "creation_date": 1573052544, "post_id": 58731339, "comment_id": 103756203, "body": "Works perfectly if I remove the equal comparison on the while loop condition! Marked as accepted"}, {"owner": {"reputation": 90105, "user_id": 106159, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Qfp6z.png?s=128&g=1", "display_name": "Matthew Watson", "link": "https://stackoverflow.com/users/106159/matthew-watson"}, "edited": false, "score": 2, "creation_date": 1573052841, "post_id": 58731339, "comment_id": 103756368, "body": "I took the liberty of editing the answer to fix the <code>while (count-- &gt; 0)</code> as mentioned  by the OP above."}], "tags": [], "owner": {"reputation": 176, "user_id": 9943210, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RyFvgSjS2ds/AAAAAAAAAAI/AAAAAAAAAJ4/-a8BfIXp4Y4/photo.jpg?sz=128", "display_name": "hiral2", "link": "https://stackoverflow.com/users/9943210/hiral2"}, "is_accepted": true, "score": 5, "last_activity_date": 1573052807, "last_edit_date": 1573052807, "creation_date": 1573047077, "answer_id": 58731339, "question_id": 58730848, "link": "https://stackoverflow.com/questions/58730848/porting-a-crc-c-algorithm-to-c/58731339#58731339", "title": "Porting a CRC C algorithm to C#", "body": "<p>You only have to change the line when you move in the next value of you block of data:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private uint CalculateBlockCheckSum(uint u32Sum, byte[] blockImage)\n{\n    uint u32Word;\n    ulong u64Sum = u32Sum;\n    ulong comparisonValue = 0x100000000;\n    int count = blockImage.Length / sizeof(uint);\n    int i = 0;\n    while (count-- &gt; 0)\n    {\n        u32Word = BitConverter.ToUInt32(blockImage,i*sizeof(uint));\n        u64Sum ^= u32Word;\n\n        for (byte iCounter = 0; iCounter &lt; (8 * 4); ++iCounter)\n        {\n            u64Sum &lt;&lt;= 1;\n\n            if ((u64Sum &amp; comparisonValue) != 0)\n            {\n                u64Sum ^= 0x04C11DB7uL;\n            }\n        }\n        i++;\n    }\n    return (uint)u64Sum;\n}\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 2298776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g9EAF.jpg?s=128&g=1", "display_name": "Ribeiro", "link": "https://stackoverflow.com/users/2298776/ribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 58731339, "answer_count": 1, "score": 4, "last_activity_date": 1573052807, "creation_date": 1573045443, "question_id": 58730848, "link": "https://stackoverflow.com/questions/58730848/porting-a-crc-c-algorithm-to-c", "title": "Porting a CRC C algorithm to C#", "body": "<p>I have this function in C that I need to port to C#. I've made a few attempts but can't figure out what I'm doing wrong. </p>\n\n<p>The polynomial is 0x04C11DB7uL.</p>\n\n<p>It doesn't have to include a while loop, i've also attempted with a For loop.</p>\n\n<pre><code>static uint32_t APPL_CalcCRC32(uint32_t u32Sum, uint8_t *pData, uint32_t count)\n{\n\n    uint8_t iCounter;\n    uint32_t u32Word;\n    uint64_t u64Sum;\n\n    u64Sum = u32Sum;\n\n    count = count / 4;  // number of bytes --&gt; number of words\n\n    // algorithm according to AN4187 (Figure 2)\n    while (count--)\n    {\n        u32Word = *((uint32_t*)pData)++;\n\n        u64Sum ^= u32Word;\n\n        for (iCounter = 0; iCounter &lt; (8 * 4); ++iCounter)\n        {\n            u64Sum &lt;&lt;= 1;\n\n            if (u64Sum &amp; 0x100000000)\n            {\n                u64Sum ^= 0x04C11DB7uL;\n            }\n        }\n    }\n\n    return (uint32_t)u64Sum;\n}\n</code></pre>\n\n<p>This is my attempt:</p>\n\n<pre><code>private uint CalculateBlockCheckSum( uint u32Sum, byte[] blockImage )\n        {\n            uint u32Word;\n            ulong u64Sum = u32Sum;\n            ulong comparisonValue = 0x100000000;\n            int count = blockImage.Length / 4;\n            int i = 0;\n            while ( count-- &gt;= 0 )\n            {\n\n                u32Word = blockImage[i++];\n                u64Sum ^= u32Word;\n\n                for ( byte iCounter = 0; iCounter &lt; ( 8 * 4 ); ++iCounter )\n                {\n                    u64Sum &lt;&lt;= 1;\n\n                    if ( ( u64Sum &amp; comparisonValue ) != 0 )\n                    {\n                        u64Sum ^= 0x04C11DB7uL;\n                    }\n                }\n            }\n            return (uint)u64Sum;\n        }\n</code></pre>\n\n<p>My main doubts are the u32Word assignment in my C# function and the loop criteria, are those right?</p>\n\n<p>My test setup are 58 arrays (blocks) with each block 1024 bytes each.\nBut the output of both functions is not the same. So is my function wrong or it is something else?</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1573044196, "post_id": 58730394, "comment_id": 103751420, "body": "Why do you desperately want to input a backspace?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573044214, "post_id": 58730394, "comment_id": 103751428, "body": "Very likely your application doesn&#39;t get the backspace, as the console program is handling it itself."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1573044260, "post_id": 58730394, "comment_id": 103751454, "body": "On another (and unrelated) note, your code could be cleaner with a <code>switch</code> statement, where last nested <code>if</code> would be the <code>default</code> case."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573044655, "post_id": 58730394, "comment_id": 103751661, "body": "@Someprogrammerdude Doesn\u2019t even need to be a <code>switch</code>, a simple <code>else if</code> would suffice."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1573044709, "post_id": 58730394, "comment_id": 103751698, "body": "How are you launching the application? In particular, how are you feeding it input, and what\u2019s the input?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1573044773, "post_id": 58730394, "comment_id": 103751733, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/4363309/how-to-check-for-the-backspace-character-in-c\">how to check for the &quot;backspace&quot; character in C</a>"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1573045468, "post_id": 58730394, "comment_id": 103752119, "body": "If you want to get unprocessed keyboard input you could use function <code>getch</code> from <code>ncurses</code> or (non-portable, DOS/Windows only) <code>getch</code>/<code>_getch</code> from <code>conio.h</code> See also <a href=\"https://stackoverflow.com/a/4028974/10622916\">stackoverflow.com/a/4028974/10622916</a>"}], "owner": {"reputation": 41, "user_id": 12332021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBrGYe1nBzqF4yZRxjYHNcdRyTRjg4NbWdmLY6ifQ=k-s128", "display_name": "Leonid Ivanov", "link": "https://stackoverflow.com/users/12332021/leonid-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1573044553, "creation_date": 1573043928, "last_edit_date": 1573044553, "question_id": 58730394, "link": "https://stackoverflow.com/questions/58730394/not-being-able-to-get-backspace-character-b-in-the-output", "title": "Not being able to get backspace character (\\b) in the output", "body": "<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n    int c;\n    while ((c = getchar()) != EOF) {\n        if (c == '\\t') {\n            putchar('\\\\');\n            putchar('t');\n        }\n        if (c == '\\b') {\n            putchar('\\\\');\n            putchar('b');\n        }\n        if (c == '\\\\') {\n            putchar('\\\\');\n            putchar('\\\\');\n        }\n        if (c != '\\t')\n            if (c != '\\b')\n                if (c != '\\t')\n                    putchar(c);\n    }\n}\n</code></pre>\n\n<p>My question is - why can't i see the <code>\\b</code> output? I'm currently learning K&amp;R C and using Windows 10. I can't get a <code>\\b</code> symbol in the Windows command line, while on Ubuntu it works pretty much ok. I've tried CTRL + H, but still no <code>\\b</code>. Is there a way to fix this?</p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 4, "creation_date": 1573042531, "post_id": 58729913, "comment_id": 103750525, "body": "you need to use <code>free</code> to deallocate the memory not <code>realloc</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1573042669, "post_id": 58729913, "comment_id": 103750603, "body": "Memory allocated by <code>malloc</code> is not initialized, its contents is <i>indeterminate</i> and could be seen as random or garbage. And considering that there are many invalid bit combinations for floating point types in C, you could have <i>undefined behavior</i> accessing such a value."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1573042744, "post_id": 58729913, "comment_id": 103750638, "body": "And don&#39;t forget that <code>*num</code> is equal to <code>num[0]</code>. You check if an allocation was successful or not by checking the pointer that <code>malloc</code> returned to see if it&#39;s <code>NULL</code> or not, as in <code>if (num == NULL)</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573042795, "post_id": 58729913, "comment_id": 103750673, "body": "And talking about <code>malloc</code> and returns, in C you <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t need to cast the result of <code>malloc</code></a>, and actually you <i>shouldn&#39;t</i> do that."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 4, "creation_date": 1573042797, "post_id": 58729913, "comment_id": 103750674, "body": "@kiran <code>realloc(ptr, 0);</code> and <code>free(ptr);</code> are equivalent. Like you, I prefer the later :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573042935, "post_id": 58729913, "comment_id": 103750732, "body": "As for the warning, the <a href=\"https://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\"><code>realloc</code></a> function does what it name implies, it <i>reallocates</i> memory, and returns a pointer to the new memory. You don&#39;t do anything with the pointer <code>realloc</code> returns, so the compiler will (correctly) warn you about that."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1573043103, "post_id": 58729913, "comment_id": 103750816, "body": "&quot;<i>... then deallocate it. After that I&#39;d like to use the original allocated space</i>&quot; you cannot use the memory any more, as you deallocated it already."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1573043261, "post_id": 58729913, "comment_id": 103750901, "body": "In standard C, don&#39;t cast the return type of <code>malloc()</code>.   If you need it, it means either that you have forgotten <code>&lt;stdlib.h&gt;</code> or that you are using a C++ compiler.  It is not required with standard C, and is actively discouraged as bad practice.    Also, if you deallocate memory (that was previously dynamlcally allocated) any usage of it gives undefined behaviour - it is necessary to reallocate it AND there is no guarantee the reallocation will give the same memory.   ALWAYS check the return value from <code>malloc()</code> or <code>realloc()</code> - don&#39;t just assume they succeed."}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 3, "creation_date": 1573043177, "post_id": 58730109, "comment_id": 103750850, "body": "This &quot;<i><code>printf(&quot;%lf&quot;, *num);</code></i>&quot; might very well still invoke undefined behaviour be reading out uninitialised memory. And if <code>malloc()</code> did fail then this line definitely invoked UB: <code>num[i] = rand();</code> by writing to invalid memory."}, {"owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1573043356, "post_id": 58730109, "comment_id": 103750941, "body": "@alk you are absolutely right. Already edited the code. Thank you."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 3, "creation_date": 1573043408, "post_id": 58730109, "comment_id": 103750971, "body": "Now push the <code>for</code>-loop inside the <code>if</code>-section and you are fine."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1573043449, "post_id": 58730109, "comment_id": 103750997, "body": "@EduardoFernandes  - you need to do more.   If <code>malloc()</code> fails (i.e. returns <code>NULL</code>) then the loop will give undefined behaviour, and your code doesn&#39;t (as yet) prevent that."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1573043617, "post_id": 58730109, "comment_id": 103751097, "body": "The <code>free()</code> could have stayed out side the <code>if</code> as doing <code>free(NULL)</code> simply does nothing (if not using a super super old compiler)."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 3, "creation_date": 1573043873, "post_id": 58730109, "comment_id": 103751258, "body": "To finally make this nice change <code>double *num = (double*) malloc(sizeof(double) * 100);</code> to be <code>double *num = malloc(100 * sizeof *num);</code>. :)"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1573046797, "post_id": 58730109, "comment_id": 103752916, "body": "@alk: it&#39;s even cooler when you add a space before the variable name, <code>malloc(100 * sizeof * num)</code>. On a more serious note though, I believe a good practice is to always put <code>sizeof</code> first, since in cases like <code>sizeof *x * rows * cols</code> it ensures that all multiplication is done with <code>size_t</code> width. Not important in this case, but many times working effectively with C is a matter of sticking to best practices."}], "tags": [], "owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "is_accepted": false, "score": 3, "last_activity_date": 1573043754, "last_edit_date": 1573043754, "creation_date": 1573042958, "answer_id": 58730109, "question_id": 58729913, "link": "https://stackoverflow.com/questions/58729913/allocating-and-deallocating-memory-writing-100-numbers-into-an-array-qsort-to/58730109#58730109", "title": "Allocating and deallocating memory, writing 100 numbers into an array, qsort to sort them in C", "body": "<p>I think you are trying to do this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    double *num = (double*) malloc(sizeof(double) * 100);\n\n    if (num) {\n        printf(\"SUCCESS!\\n\");\n\n        for (int i = 0; i &lt; 100; i++) {\n            num[i] = rand();\n        }\n\n        /* sort here */\n\n        free(num);\n    } else {\n        printf(\"FAILURE!\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1573045118, "creation_date": 1573045118, "answer_id": 58730749, "question_id": 58729913, "link": "https://stackoverflow.com/questions/58729913/allocating-and-deallocating-memory-writing-100-numbers-into-an-array-qsort-to/58730749#58730749", "title": "Allocating and deallocating memory, writing 100 numbers into an array, qsort to sort them in C", "body": "<p>It is bad practice to pass the value zero to the malloc family of functions. What happens then is implementation-defined, meaning that different compilers might give different results.</p>\n\n<p>C17 7.22.3</p>\n\n<blockquote>\n  <p>If the size of\n  the space requested is zero, the behavior is implementation-defined: either a null pointer\n  is returned, or the behavior is as if the size were some nonzero value, except that the\n  returned pointer shall not be used to access an object.</p>\n</blockquote>\n\n<p>This isn't normal use of <code>realloc</code> - normally the compiler expects you to use the return value. Hence the warning.</p>\n\n<p>Forget about <code>realloc(num, 0);</code> and use <code>free()</code> instead.</p>\n"}], "owner": {"reputation": 37, "user_id": 12278933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b03a22cda1c131cdb00c0a4714d743?s=128&d=identicon&r=PG&f=1", "display_name": "icantprogram", "link": "https://stackoverflow.com/users/12278933/icantprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1573045118, "creation_date": 1573042394, "last_edit_date": 1573044445, "question_id": 58729913, "link": "https://stackoverflow.com/questions/58729913/allocating-and-deallocating-memory-writing-100-numbers-into-an-array-qsort-to", "title": "Allocating and deallocating memory, writing 100 numbers into an array, qsort to sort them in C", "body": "<p>I'm attempting to allocate space for 100 doubles, check if the allocation was successful, and then deallocate the space. After that I'd like to use the original allocated space to write 100 random numbers to it and then sort them using <code>qsort</code>.</p>\n\n<p>Here's the code I have to far</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    double *num = (double*) malloc(sizeof(double) * 100);\n\n    printf(\"%lf\", *num);\n\n    realloc(num, 0);\n\n    return 0;\n}\n</code></pre>\n\n<p>When I attempt to print <code>*num</code>, it gives me <code>0.00000</code> which seems wrong. I get the warning </p>\n\n<pre><code> warning: ignoring return value of function declared with\n 'warn_unused_result' attribute [Wunused-result] realloc(num, 0);\n</code></pre>\n\n<p>when compiling the program. I'm still unsure on how to make this work with an array.</p>\n"}, {"tags": ["c", "arrays", "char", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1573041736, "post_id": 58729697, "comment_id": 103750104, "body": "You can also do <code>foo[1000000000] = 1</code>. I am saying that i&#39;ts programmers job to check the validity of the program. <a href=\"https://stackoverflow.com/questions/671703/array-index-out-of-bound-in-c\">Array index out of bound in C</a> <a href=\"https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior\">Undefined, unspecified and implementation-defined behavior</a>"}, {"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1573041784, "post_id": 58729697, "comment_id": 103750122, "body": "Are you saying I don&#39;t even understand arrays?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1573041807, "post_id": 58729697, "comment_id": 103750133, "body": "There is no bound checks in <code>C</code>."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1573041896, "post_id": 58729697, "comment_id": 103750182, "body": "<code>Did I misunderstand malloc()</code> No, you misunderstood the <code>C</code>."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 3, "creation_date": 1573041908, "post_id": 58729697, "comment_id": 103750192, "body": "Congratulations! You have discovered <b>undefined behaviour</b>."}, {"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "edited": false, "score": 0, "creation_date": 1573041943, "post_id": 58729697, "comment_id": 103750216, "body": "What does that mean?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1573042040, "post_id": 58729697, "comment_id": 103750272, "body": "@MuhammadUsman What were you expecting?"}, {"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "edited": false, "score": 0, "creation_date": 1573042048, "post_id": 58729697, "comment_id": 103750277, "body": "I am using online ide from repl.it. Thought that might be relevant."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1573042139, "post_id": 58729697, "comment_id": 103750340, "body": "<a href=\"https://stackoverflow.com/questions/9137157/no-out-of-bounds-error\">No out of bounds error</a> <a href=\"https://stackoverflow.com/questions/1655971/what-happens-if-i-try-to-access-memory-beyond-a-mallocd-region\">What happens if I try to access memory beyond a malloc()&#39;d region?</a>"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1573042173, "post_id": 58729697, "comment_id": 103750355, "body": "It&#39;s not relevant which IDE you are using. You are allocating 20 bytes, and then writing those 20 bytes + 10 extra bytes after allocated memory block, which will lead to undefined behavior."}, {"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1573042571, "post_id": 58729697, "comment_id": 103750549, "body": "@AndrejsCainikovs I suppose. Then is there even a point of the <code>x</code> in <code>char p[x];</code> or is it just stupid?"}, {"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1573042664, "post_id": 58729697, "comment_id": 103750597, "body": "@AndrejsCainikovs or does it behave correctly with <code>char p[x];</code> but not <code>char* p[x];</code>?"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1573043347, "post_id": 58729697, "comment_id": 103750935, "body": "Answers: 1. Please read about differences in memory allocation on stack and heap. 2. <code>char* p[x];</code> will allocate array of pointers."}, {"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1573043440, "post_id": 58729697, "comment_id": 103750992, "body": "@AndrejsCainikovs ok thanks I just got a little confused for a while is all, but before I can proceed I need to know if there was anything else wrong with my code. Have I used pointer variables and malloc() correctly?"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1573043918, "post_id": 58729697, "comment_id": 103751279, "body": "You used the memory allocation and pointers correctly, but: 1) malloc might return NULL if failed to allocate memory; 2) do not write out of allocated memory bounds; 3) always free allocated memory"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "edited": false, "score": 0, "creation_date": 1573043000, "post_id": 58730036, "comment_id": 103750765, "body": "I am sorry I don&#39;t have enough reputation to upvote. This is what I needed -&gt; <code>So the fact that it seems you can write more than you allocated, does not mean your program is correct. In fact, it is hopelesly wrong and will lead to an error somewhere else.</code>"}, {"owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "edited": false, "score": 0, "creation_date": 1573043219, "post_id": 58730036, "comment_id": 103750873, "body": "May I just ask one more question (answer in comments)? Say I had never attempted to write beyond the area allocated in the first place. Have I used pointers and malloc() correctly here?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "edited": false, "score": 0, "creation_date": 1573043422, "post_id": 58730036, "comment_id": 103750985, "body": "Yes, you have. To be completely correct, you should free the memory before you end the program: <code>free(foo);</code> After you freed the memory, you may no longer use it (it isn&#39;t yours anymore)."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1573043641, "last_edit_date": 1573043641, "creation_date": 1573042768, "answer_id": 58730036, "question_id": 58729697, "link": "https://stackoverflow.com/questions/58729697/why-am-i-able-to-store-more-bytes-in-this-char-array-than-i-gave-it-using-malloc/58730036#58730036", "title": "Why am I able to store more bytes in this char array than I gave it using malloc()?", "body": "<p>The comments tell you what is wrong, but I will consolidate those comments.</p>\n\n<p>You allocate storage with <code>malloc</code>. This returns you the address of where you may store your data. However, neither C, nor <code>malloc</code> or the heap will check if you store <em>only</em> in the area given to you. If you write beyond the area allocated, you are writing in an area that is \"not yours\". This can lead to various types of undefined behavior.</p>\n\n<p>Some memory managers will intercept your attempt and will abort your program. Other memory managers don't do that, but since you write to an area that is not yours, you may be overwriting data from the memory manager and any next attempt to allocate memory may fail because the memory manager's data is corrupt. Or you are overwriting memory that belongs to someone else.</p>\n\n<p>So the fact that it seems you can write more than you allocated, does not mean your program is correct. In fact, it is hopelesly wrong and will lead to an error somewhere else. So your program could make for example invalid calculations and your airplane crashes... This is called <em>undefined behavior</em> and you as a programmer must take care you always allocate what you need and that you never go out of the bounds of what you allocated.</p>\n"}], "owner": {"reputation": 13, "user_id": 12331769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6ad05baf3d54ee0fab82b5a9d6d9d2?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/12331769/muhammad-usman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1573043273, "accepted_answer_id": 58730036, "answer_count": 1, "score": 1, "last_activity_date": 1573044477, "creation_date": 1573041610, "last_edit_date": 1573041881, "question_id": 58729697, "link": "https://stackoverflow.com/questions/58729697/why-am-i-able-to-store-more-bytes-in-this-char-array-than-i-gave-it-using-malloc", "closed_reason": "Duplicate", "title": "Why am I able to store more bytes in this char array than I gave it using malloc()?", "body": "<p>I learned about <b>Dynamic Memory Allocation</b> in C today. I learned how memory can be allocated to a char array with the <code>malloc()</code> from <code>stdlib.h</code> when I need to print a sentence. But then I saw I was able to store more bytes then I assigned. Here is my entire code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n  int i;\n  char *foo;\n  foo = (char*)malloc(20);\n  for (i=0;i&lt;30;i++)\n  {\n    foo[i]='a';\n    printf(\"\\n%d) %c\",i+1,foo[i]);\n  }\n  return 0;\n}\n</code></pre>\n\n<p><b>Output</b></p>\n\n<pre><code>1) a\n2) a\n3) a\n4) a\n5) a\n6) a\n7) a\n8) a\n9) a\n10) a\n11) a\n12) a\n13) a\n14) a\n15) a\n16) a\n17) a\n18) a\n19) a\n20) a\n21) a\n22) a\n23) a\n24) a\n25) a\n26) a\n27) a\n28) a\n29) a\n30) a\n</code></pre>\n\n<p>As you can see I gave <code>foo</code> 20 bytes but was able to store 30 bytes in it. What is going on? Did I misunderstand <code>malloc()</code>?</p>\n"}, {"tags": ["c", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1573041412, "post_id": 58729584, "comment_id": 103749935, "body": "Welcome to the world of undefined behavior :D"}, {"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1573041672, "post_id": 58729584, "comment_id": 103750073, "body": "it&#39;s a compiler quirk. Because memo isn&#39;t referenced until all the recursive calls have returned, new space for it isn&#39;t made on the stack until after the calls. But I suspect it isn&#39;t working all that well even if it may look like it. The initial values in the array will be junk."}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 1, "creation_date": 1573041809, "post_id": 58729584, "comment_id": 103750134, "body": "<b>Undefined behavior</b> --&gt; here it doesn&#39;t work: <a href=\"https://ideone.com/zeiHUM\" rel=\"nofollow noreferrer\">ideone.com/zeiHUM</a>"}, {"owner": {"reputation": 1315, "user_id": 1300177, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4996dd0400f07c6dd5776f5498c04aea?s=128&d=identicon&r=PG", "display_name": "screwnut", "link": "https://stackoverflow.com/users/1300177/screwnut"}, "reply_to_user": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1573043564, "post_id": 58729584, "comment_id": 103751075, "body": "@GarrGodfrey Is <code>memo</code> not referenced in the first <code>if</code>, before any further calls?"}, {"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1573043852, "post_id": 58729584, "comment_id": 103751239, "body": "It&#39;s interesting the compiler doesn&#39;t complain about uninitialized memory being read. It likely would not allocate the space until it is written to"}], "answers": [{"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1573042266, "post_id": 58729810, "comment_id": 103750396, "body": "Nitpicking, but the initialization is not needed."}, {"owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1573042506, "post_id": 58729810, "comment_id": 103750512, "body": "that is true. I added it to the example for clarifying that content is zeroes."}], "tags": [], "owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "is_accepted": false, "score": 1, "last_activity_date": 1573041977, "creation_date": 1573041977, "answer_id": 58729810, "question_id": 58729584, "link": "https://stackoverflow.com/questions/58729584/why-does-this-incorrect-memoized-fibonacci-function-work/58729810#58729810", "title": "Why does this incorrect memoized fibonacci function work?", "body": "<p>It is UB, but if we assume that stack of a fresh thread contains only zeroes,\nthen all values in memo[100] can be zeroes or remains of previous call of the function.</p>\n\n<p>The effective algorithm might work like the following:</p>\n\n<pre><code>long int memo[100] = {0};\n\nlong int fib(int n) {\n    if(n&lt;2) {\n        return n;\n    }\n    if(memo[n] != 0) {\n        return memo[n];\n    }\n    else {\n        memo[n] = fib(n - 1) + fib(n - 2);\n        return memo[n];\n    }\n}\n</code></pre>\n\n<p>Except each layer of recursion have own 'memo[100]'.</p>\n"}], "owner": {"reputation": 1315, "user_id": 1300177, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4996dd0400f07c6dd5776f5498c04aea?s=128&d=identicon&r=PG", "display_name": "screwnut", "link": "https://stackoverflow.com/users/1300177/screwnut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573041977, "creation_date": 1573041270, "last_edit_date": 1573041414, "question_id": 58729584, "link": "https://stackoverflow.com/questions/58729584/why-does-this-incorrect-memoized-fibonacci-function-work", "title": "Why does this incorrect memoized fibonacci function work?", "body": "<p>Here's an incorrect implementation of memoized fibonacci:</p>\n\n<pre><code>long int fib(int n) {\n    long int memo[100];\n    if(n&lt;2) {\n        return n;\n    }\n    if(memo[n] != 0) {\n        return memo[n];\n    }\n    else {\n        memo[n] = fib(n - 1) + fib(n - 2);\n        return memo[n];\n    }\n}\n</code></pre>\n\n<p>It is incorrect because the array <code>memo</code> is a brand new array each call and no memoization is occuring. The easiest fix is to make <code>memo</code> <code>static</code>. But, lo and behold, the code works!</p>\n\n<p>I stepped through it in the debugger and <code>memo</code> is behaving as if it was static! It appears that the compiler generated code that is placing <code>memo</code> in the same memory space at every call as opposed to new fresh memory. Why is that?</p>\n\n<p>Compiler used is Apple clang version 11.0.0 (clang-1100.0.33.12).</p>\n"}, {"tags": ["c", "u-boot"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11054271, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uBrAdoQUuNc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP9ymp28tg68gM0Hfphkn9Ke78kNg/mo/photo.jpg?sz=128", "display_name": "Rock Shawn", "link": "https://stackoverflow.com/users/11054271/rock-shawn"}, "is_accepted": false, "score": 0, "last_activity_date": 1573047268, "creation_date": 1573047268, "answer_id": 58731411, "question_id": 58729582, "link": "https://stackoverflow.com/questions/58729582/input-in-flex-scanner-failed-error-occur-when-compile-uboot/58731411#58731411", "title": "&#39;input in flex scanner failed&#39; error occur when compile uboot", "body": "<p>Never mind. It's all because a mistake.</p>\n\n<p>As i add a new foler for a custom board, i add the corresponding source Kconfig line in some where.\nBy mistake, i added the new board folder path instead the new Kconfig file path.</p>\n\n<p>Damn carelessness</p>\n"}], "owner": {"reputation": 1, "user_id": 11054271, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uBrAdoQUuNc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP9ymp28tg68gM0Hfphkn9Ke78kNg/mo/photo.jpg?sz=128", "display_name": "Rock Shawn", "link": "https://stackoverflow.com/users/11054271/rock-shawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 770, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573047268, "creation_date": 1573041266, "last_edit_date": 1573041696, "question_id": 58729582, "link": "https://stackoverflow.com/questions/58729582/input-in-flex-scanner-failed-error-occur-when-compile-uboot", "title": "&#39;input in flex scanner failed&#39; error occur when compile uboot", "body": "<p>I encounter the 'input in flex scanner failed' error when i try to build the uboot code.\n    This is the whole console log:</p>\n\n<pre><code>gan.liu@ubuntu:~/work/PROCESSOR_SDK_VISION_03_06_00_00/ti_components/os_tools/linux/u-boot/u-boot$ make ARCH=mips CROSS_COMPILE=/opt/tda/gcc-linaro-5.3-2016.02-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf- dra7xx_evm_vision_config V=1\nmake -f ./scripts/Makefile.build obj=scripts/basic\nrm -f .tmp_quiet_recordmcount\nmake -f ./scripts/Makefile.build obj=scripts/kconfig dra7xx_evm_vision_config\nscripts/kconfig/conf  --defconfig=arch/../configs/dra7xx_evm_vision_defconfig Kconfig\ninput in flex scanner failed\nmake[1]: *** [dra7xx_evm_vision_defconfig] Error 2\nmake: *** [dra7xx_evm_vision_config] Error 2\ngan.liu@ubuntu:~/work/PROCESSOR_SDK_VISION_03_06_00_00/ti_components/os_tools/linux/u-boot/u-boot$ make ARCH=mips CROSS_COMPILE=/opt/tda/gcc-linaro-5.3-2016.02-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf- dra7xx_evm_vision_config V=1\nmake -f ./scripts/Makefile.build obj=scripts/basic\nrm -f .tmp_quiet_recordmcount\nmake -f ./scripts/Makefile.build obj=scripts/kconfig dra7xx_evm_vision_config\n  cc -Wp,-MD,scripts/kconfig/.zconf.tab.o.d -Wall -Wstrict-prototypes -O2 -fomit-frame-pointer   -I/usr/include/ncursesw   -DCURSES_LOC=\"&lt;ncurses.h&gt;\" -DLOCALE  -Iscripts/kconfig -c -o scripts/kconfig/zconf.tab.o scripts/kconfig/zconf.tab.c\n  cc  -o scripts/kconfig/conf scripts/kconfig/conf.o scripts/kconfig/zconf.tab.o\nscripts/kconfig/conf  --defconfig=arch/../configs/dra7xx_evm_vision_defconfig Kconfig\n**errno: 21.**\ninput in flex scanner failed\nmake[1]: *** [dra7xx_evm_vision_defconfig] Error 2\nmake: *** [dra7xx_evm_vision_config] Error 2\ngan.liu@ubuntu:~/work/PROCESSOR_SDK_VISION_03_06_00_00/ti_components/os_tools/linux/u-boot/u-boot$\n</code></pre>\n\n<p>I get the \"errno:21\" info by adding printf in the following snippet:</p>\n\n<pre><code>/* Gets input and stuffs it into \"buf\".  number of characters read, or YY_NULL,\n * is returned in \"result\".\n */\n#ifndef YY_INPUT\n#define YY_INPUT(buf,result,max_size) \\\n    errno=0; \\\n    while ( (result = read( fileno(zconfin), (char *) buf, max_size )) &lt; 0 ) \\\n    { \\\n        if( errno != EINTR) \\\n        { \\\n            printf(\"errno: %d.\\n\", errno); \\\n            YY_FATAL_ERROR( \"input in flex scanner failed\" ); \\\n            break; \\\n        } \\\n        errno=0; \\\n        clearerr(zconfin); \\\n    }\\\n\\\n\n#endif\n</code></pre>\n\n<p>The error code '21' stands for </p>\n\n<pre><code>#define EISDIR      21  /* Is a directory */\n</code></pre>\n\n<p>Please kindly help me solving this.</p>\n"}, {"tags": ["c", "char", "c-strings", "strcmp", "toupper"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1573044891, "post_id": 58729014, "comment_id": 103751807, "body": "OT: <code>strcmp()</code> expects two <i>pointers</i> to a <code>0</code>-terminated <code>char</code>-array, that is two <code>char*</code>. The code passes two <code>char</code>. Take the compiler&#39;s warnings serious."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1573044934, "post_id": 58729014, "comment_id": 103751823, "body": "To compare two characters just to <code>opt1 == &#39;Y&#39; </code>."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 1, "last_activity_date": 1573039430, "creation_date": 1573039430, "answer_id": 58729031, "question_id": 58729014, "link": "https://stackoverflow.com/questions/58729014/c-process-keeps-exiting-before-being-able-to-input-anything/58729031#58729031", "title": "C : Process keeps exiting before being able to input anything", "body": "<p><code>strcmp</code> takes null terminated <code>char *</code>, but you are passing <code>char</code> as arguments.</p>\n\n<p>You can directly compare two <code>char</code> using <code>==</code> operator.</p>\n\n<p>Change.</p>\n\n<pre><code>if (strcmp(opt1, 'Y') == 0){\n</code></pre>\n\n<p>to </p>\n\n<pre><code>if (opt1 == 'Y'){\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 213, "user_id": 5483401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e241a0c8e79e6ea96728029ed9fc0ab?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Anonymous", "link": "https://stackoverflow.com/users/5483401/anonymous-anonymous"}, "edited": false, "score": 0, "creation_date": 1573040494, "post_id": 58729071, "comment_id": 103749409, "body": "Out of curiousity: Why would the cast of <code>opt1</code> prevent undefined behaviour? <code>opt1</code> is of type <code>char</code> already and will implicitely be promoted to <code>int</code>, so why the cast?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 213, "user_id": 5483401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e241a0c8e79e6ea96728029ed9fc0ab?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Anonymous", "link": "https://stackoverflow.com/users/5483401/anonymous-anonymous"}, "edited": false, "score": 1, "creation_date": 1573040724, "post_id": 58729071, "comment_id": 103749547, "body": "@AnonymousAnonymous If the type char behaves as the type signed char then due to the integer promotions the integer value in general can be negative and the call of toupper results in undefined behavior."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1573039567, "creation_date": 1573039567, "answer_id": 58729071, "question_id": 58729014, "link": "https://stackoverflow.com/questions/58729014/c-process-keeps-exiting-before-being-able-to-input-anything/58729071#58729071", "title": "C : Process keeps exiting before being able to input anything", "body": "<p>Instead of this statement</p>\n\n<pre><code>scanf(\"%c\", &amp;opt1);\n</code></pre>\n\n<p>use</p>\n\n<pre><code>scanf(\" %c\", &amp;opt1);\n       ^^^\n</code></pre>\n\n<p>In general instead of</p>\n\n<pre><code>opt1 = toupper(opt1);\n</code></pre>\n\n<p>it would be correctly to write</p>\n\n<pre><code>opt1 = toupper( ( unsigned char )opt1);\n</code></pre>\n\n<p>Otherwise the function call can have undefined behavior.</p>\n\n<p>The variable <code>opt1</code> has the type char. It can not contain a string. So you may not apply the standard function <code>strcmp</code> that deals with strings. Just write</p>\n\n<pre><code>if ( opt1 == 'Y' ){\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12286031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a69dc28d7db674b45f4fab0612b9f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Leila K.", "link": "https://stackoverflow.com/users/12286031/leila-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573039752, "creation_date": 1573039360, "last_edit_date": 1573039752, "question_id": 58729014, "link": "https://stackoverflow.com/questions/58729014/c-process-keeps-exiting-before-being-able-to-input-anything", "title": "C : Process keeps exiting before being able to input anything", "body": "<p>I'm having trouble with my code below. Before I could input a response [y/n], it just exits the program. I don't see any errors in my compiler so I'm having a hard time fixing this. </p>\n\n<pre><code>   srand(time(NULL));  \n    int nGid; //guest id\n    char opt1;\n    printf(\" Hello Guest! do you have an id number [Y/N]?\");\n    scanf(\"%c\", &amp;opt1);\n\n    opt1 = toupper(opt1);\n  //asks for guest id\n    if (strcmp(opt1, 'Y') == 0){\n        printf(\"Please enter id: \\n\");\n        scanf(\"%d\", &amp;nGid);\n    }\n  //generates random id number\n    else {\n        nGid = rand()%100;\n        printf(\"Your guest id is : %d\", nGid);\n  return 0;\n}\n</code></pre>\n\n<p>thanks for any help!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1573039086, "post_id": 58728700, "comment_id": 103748680, "body": "<code>index</code> is never defined nor initialized. please post the real code."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1573039287, "post_id": 58728700, "comment_id": 103748772, "body": "Show a fully compilable code example, it is very unclear what you mean with those small snippets. The maximum stack size for most operating systems is 4kilobytes, so big variable length arrays fail on you system. Use dynamic allocation. <code>expression must have pointer-</code> - please post an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MCVE</a> - a minimal complete verificable example of your code that would let others reproduce the problem. I want to test your errors - what code should I copy into my intellisense to get the same error?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1573039552, "post_id": 58728700, "comment_id": 103748926, "body": "Remove all parts of &quot;real code&quot; until you are left with the smallest code that reproduces the problem."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1573039634, "post_id": 58728700, "comment_id": 103748954, "body": "<i>Program is too large</i> is not a reason. A single field CSV file can be read in with a 10-line demonstration program."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1573040671, "post_id": 58728700, "comment_id": 103749515, "body": "@KamilCuk \u2014 the default stack size on Windows is normally 1 MiB and on Unix-like platforms, it is normally 8 MiB.  I don\u2019t know of a system where it is only 4 KiB. The rest of your comment is valid, though."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1573040991, "post_id": 58728700, "comment_id": 103749712, "body": "<code>char *token_vector[filesize]; </code> is not the same as <code>const char* token_vector = ...</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1573041814, "post_id": 58728700, "comment_id": 103750138, "body": "@JonathanLeffler IIRC, the stacksize in the Linux kernel is only 4 KiB - a single page of memory.  So such small stacks do exist in some contexts. I know when I was writing Linux kernel modules the available stack was very small, and the results from overflowing the stack were not good..."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1573044395, "post_id": 58728700, "comment_id": 103751518, "body": "Note: there is a <code>)</code> missing in: <code>while(index&lt;(file_npdws-1)</code> Or: the second <code>(</code> is not needed, anyway)"}, {"owner": {"reputation": 11, "user_id": 12331481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7b54c2736c889f87e019af1df89aff?s=128&d=identicon&r=PG&f=1", "display_name": "Tehseen1996", "link": "https://stackoverflow.com/users/12331481/tehseen1996"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1573096212, "post_id": 58728700, "comment_id": 103772484, "body": "@wildplasser ) was missed while copying the code here. I got your point though."}, {"owner": {"reputation": 11, "user_id": 12331481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7b54c2736c889f87e019af1df89aff?s=128&d=identicon&r=PG&f=1", "display_name": "Tehseen1996", "link": "https://stackoverflow.com/users/12331481/tehseen1996"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1573102674, "post_id": 58728700, "comment_id": 103773702, "body": "@KamilCuk here is my MCVE <a href=\"https://drive.google.com/file/d/1l9JdT8Lo46UpkO5KM070woNUnC15-uio/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1l9JdT8Lo46UpkO5KM070woNUnC15-uio/&hellip;</a>"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1573113800, "post_id": 58728700, "comment_id": 103777596, "body": "No, PLEASE don&#39;t put source code or screenshots somewhere in the web. Instead <a href=\"https://stackoverflow.com/posts/58728700/edit\">edit</a> your question so that it is instantly readable, and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> like KamilCuk suggested already."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12331481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7b54c2736c889f87e019af1df89aff?s=128&d=identicon&r=PG&f=1", "display_name": "Tehseen1996", "link": "https://stackoverflow.com/users/12331481/tehseen1996"}, "is_accepted": false, "score": 0, "last_activity_date": 1573126287, "creation_date": 1573126287, "answer_id": 58747869, "question_id": 58728700, "link": "https://stackoverflow.com/questions/58728700/why-i-am-getting-access-violation-error-for-my-large-1d-array-in-c/58747869#58747869", "title": "Why I am getting access violation error for my large 1D array in C?", "body": "<p>My issue has been resolved. The issue was in the following line</p>\n\n<pre><code> token_vector[index] = strdup(token);\n</code></pre>\n\n<p>\"strdup\" <a href=\"https://www.geeksforgeeks.org/strdup-strdndup-functions-c/\" rel=\"nofollow noreferrer\">duplicates the string</a> and is never freed which is why the heap memory is being consumed incrementally as I saw it reached around 1.6GB in the task manager by this application. I have removed this line as it was not quite doing anything and my code is working fine. But thank you all for responding to my query.</p>\n"}], "owner": {"reputation": 11, "user_id": 12331481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7b54c2736c889f87e019af1df89aff?s=128&d=identicon&r=PG&f=1", "display_name": "Tehseen1996", "link": "https://stackoverflow.com/users/12331481/tehseen1996"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573126287, "creation_date": 1573038360, "last_edit_date": 1573039275, "question_id": 58728700, "link": "https://stackoverflow.com/questions/58728700/why-i-am-getting-access-violation-error-for-my-large-1d-array-in-c", "title": "Why I am getting access violation error for my large 1D array in C?", "body": "<p>I am reading a csv file (having data in the first column but multiple rows). For that I have to initialize a vector to store data in. This works fine for small files but for large files such that this one with no. of rows as 10210672, it gives memory access violation error. I have initialized the array as following.</p>\n\n<pre><code>char *token_vector[filesize]; \n</code></pre>\n\n<p>This is where i am reading csv file.</p>\n\n<pre><code>while(index&lt;(file_npdws-1)\n    {\n        pick = abs(pick-1);\n        (pointer = fgets(byte_temp,sizeof(byte_temp)*2,file));\n        if(pointer!=NULL)\n        {\n            token= strtok(pointer,\",\");\n            token_vector[index] = strdup(token);\n        }\n\n            noofpulses++;\n        index++;\n\n        //printf(\"\\n Total Pulses : %d\", noofpulses);\n    }\n</code></pre>\n\n<p>And this is where the error comes i.e. where I read &amp; translate this array to decimal</p>\n\n<pre><code>for(j = 0;j&lt;file_npdws-1;j++)\n{\n OV[i] =  (hex2dec(token_vector[j][20])*16+hex2dec(token_vector[j][21])*1);\n i++;\n}\n</code></pre>\n\n<p>The error comes at around 9millionth value of i and j whereas max value should go to 10210672.\nP.S: My pc is 64 bit with RAM 32GB. And I am using visual studio 2010 with C language. <a href=\"https://i.stack.imgur.com/vPfOA.png\" rel=\"nofollow noreferrer\">My error screenshot is attached</a></p>\n\n<p>Also I have tried allocating memory on heap due to limitation of stack but the same issue continues.\nThis is how I initialized heap array <code>const char** token_vector = (char**)malloc((filesize)*sizeof( char*) );</code> It was not accepting single * aster-stick.\nWhen I declare it a heap array as below</p>\n\n<pre><code>const char* token_vector = (char*)malloc((filesize/2)*sizeof( char*) );\n</code></pre>\n\n<p>I get error in building the code which says : intellisense: expression must have pointer-to-object type. I get this error at the line\n <code>OV[i] =  (hex2dec(token_vector2[k][20])*16+hex2dec(token_vector2[k][21])*1);</code>\n<a href=\"https://i.stack.imgur.com/dTd4V.png\" rel=\"nofollow noreferrer\">See my error screenshot</a></p>\n\n<p>Any help would really be appreciated. Thank you in advance.</p>\n"}, {"tags": ["c", "scope", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1573038259, "post_id": 58728620, "comment_id": 103748270, "body": "<code>newNode-&gt;s = s;</code> does <b>not</b> make a copy of <code>s</code>!"}, {"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1573038581, "post_id": 58728620, "comment_id": 103748429, "body": "If you can use POSIX features this could be useful: <a href=\"https://linux.die.net/man/3/strdup\" rel=\"nofollow noreferrer\">linux.die.net/man/3/strdup</a>"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1573038389, "creation_date": 1573038389, "answer_id": 58728709, "question_id": 58728620, "link": "https://stackoverflow.com/questions/58728620/linked-list-c-does-not-store-the-values-i-am-looking-for/58728709#58728709", "title": "linked List: C: does not store the values I am looking for", "body": "<p>In this statement</p>\n\n<pre><code>n = createNode(path); \n</code></pre>\n\n<p>you are storing a pointer to the same local array <code>path</code> in each node. See the definition of the function <code>createNode</code>. </p>\n\n<pre><code>Node *createNode(char *s) {\n    Node *newNode = (Node *)malloc(sizeof(Node));\n    newNode-&gt;s = s;\n    newNode-&gt;next = NULL;\n    return newNode;\n}\n</code></pre>\n\n<p>So the program at least due to this mistake has undefined behavior.</p>\n\n<p>You should make a copy of the passed string instead of just assigning a pointer to it to the data member <code>s</code>.</p>\n"}], "owner": {"reputation": 376, "user_id": 9377932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3jKf9.jpg?s=128&g=1", "display_name": "Roger Almengor", "link": "https://stackoverflow.com/users/9377932/roger-almengor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58728709, "answer_count": 1, "score": 0, "last_activity_date": 1573038701, "creation_date": 1573038122, "last_edit_date": 1573038701, "question_id": 58728620, "link": "https://stackoverflow.com/questions/58728620/linked-list-c-does-not-store-the-values-i-am-looking-for", "title": "linked List: C: does not store the values I am looking for", "body": "<p>I have the following code:</p>\n\n<pre><code>#include &lt;dirent.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct stringData {\n    char *s;\n    struct stringData *next;\n} Node;\n\nNode *createNode(char *s) {\n    Node *newNode = (Node *)malloc(sizeof(Node));\n    newNode-&gt;s = s;\n    newNode-&gt;next = NULL;\n    return newNode;\n}\n\n\nvoid insert(Node **link, Node *newNode) {\n    newNode-&gt;next = *link;\n    *link = newNode;\n}\n\nvoid printList(Node *head) {\n    while (head != NULL) {\n        printf(\"%s\\n\", head-&gt;s);\n        head = head-&gt;next;\n    }\n}\n\n\nvoid listFilesRecursively(char *path, char *suffix);\n\n\nint main()\n{\n    // Directory path to list files\n    char path[100];\n    char suffix[100];\n\n    // Suffix Band Sentinel-2 of Type B02_10m.tif\n\n    // Input path from user\n    printf(\"Enter path to list files: \");\n    scanf(\"%s\", path);\n    printf(\"Enter the bands ending: \");\n    scanf(\"%s\", suffix);\n\n    listFilesRecursively(path, suffix);\n\n    return 0;\n}\n\nint string_ends_with(const char * str, const char * suffix)\n{\n    int str_len = strlen(str);\n    int suffix_len = strlen(suffix);\n\n    return \n        (str_len &gt;= suffix_len) &amp;&amp;\n        (0 == strcmp(str + (str_len-suffix_len), suffix));\n}\n\n/**\n * Lists all files and sub-directories recursively \n * considering path as base path.\n */\n\n\nvoid listFilesRecursively(char *basePath, char *suffix)\n{\n    char path[1000];\n    struct dirent *dp;\n    DIR *dir = opendir(basePath);\n    //node_s *head, *first, *temp=0;\n    //head = malloc(sizeof(node_s));\n    Node *head = NULL;\n    Node *tail = NULL;\n    Node *n;\n\n\n    // Unable to open directory stream\n    if (!dir)\n        return;\n\n    while ((dp = readdir(dir)) != NULL)\n    {\n\n\n        if (strcmp(dp-&gt;d_name, \".\") != 0 &amp;&amp; strcmp(dp-&gt;d_name, \"..\") != 0)\n        {\n            //printf(\"%s\\n\", dp-&gt;d_name);\n\n            // Construct new path from our base path\n            strcpy(path, basePath);\n            strcat(path, \"/\");\n            strcat(path, dp-&gt;d_name);\n\n            if (string_ends_with(path, suffix))\n            {\n                n = createNode(path);\n                insert(&amp;head, n);\n                tail = n;   \n                printf(\"%s\\n\", path);\n            }\n            listFilesRecursively(path, suffix);\n        }\n    }\n\n    //printList(head);\n\n    closedir(dir);\n}\n</code></pre>\n\n<p>And the aim is to store the values of a recursive search in a directory, in a linked list. I created the structure for a Node for string Data that points to the next element of the linked list. I also added some functions to insert the new data and point to the next one. And finally I am able to print out the values of the linked list by invoking printLIst function. However when I deactivate line 109 where the printList function is called, the values printed in line 103 are the correct ones. If I comment the line 103, and call the printLIst function with the values stored in my linked list, then a list of files comes, with values that are completely different from the ones printed in line 103. </p>\n\n<p>Is a sort of black magic in C? or why is this strange behaviour? </p>\n"}, {"tags": ["c", "gcc", "makefile", "vpath"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1573038802, "post_id": 58728118, "comment_id": 103748532, "body": "Make won&#39;t work if you lie to it; <code>%.o: %.c grille.h</code> says that the objects will be in the current directory when the commands succeed, but the <code>mv</code> makes that untrue."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1573046493, "post_id": 58728118, "comment_id": 103752724, "body": "In addition to the other correct answers, you cannot successfully use vpath/VPATH to find constructed files.  It only works to find source files.  See <a href=\"http://make.mad-scientist.net/papers/how-not-to-use-vpath/\" rel=\"nofollow noreferrer\">make.mad-scientist.net/papers/how-not-to-use-vpath</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": true, "score": 0, "last_activity_date": 1573042557, "creation_date": 1573042557, "answer_id": 58729958, "question_id": 58728118, "link": "https://stackoverflow.com/questions/58728118/use-vpath-to-find-generated-files/58729958#58729958", "title": "Use vpath to find generated files", "body": "<p>Consider changing the compile rule to refer to the object folder:</p>\n\n<pre><code>obj/%.o: %.c \n    [ -d obj ] || mkdir -p obj\n    gcc -o $@ $&lt;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10886530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ccad85ed4662458dbdb86093d0d9f6?s=128&d=identicon&r=PG&f=1", "display_name": "tomoshimi", "link": "https://stackoverflow.com/users/10886530/tomoshimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 58729958, "answer_count": 1, "score": 0, "last_activity_date": 1573042557, "creation_date": 1573036448, "question_id": 58728118, "link": "https://stackoverflow.com/questions/58728118/use-vpath-to-find-generated-files", "title": "Use vpath to find generated files", "body": "<p>I'm trying to write a Makefile that compiles a <code>*.c</code> into an <code>*.o</code> and then move it to <code>obj/</code>. However when I try to link all the <code>*.o</code> files in <code>main</code> I get an error as if the generated files were not found. I tried to prefix the code with the right path but it wouldn't find it anyway.\nDoes anyone have an idea on what I need to change to my code so that it does find the <code>*.o</code> files.\nThis is my Makefile:</p>\n\n<pre><code>EXEC = main\nCFLAGS = -c -Wall -g -I include -std=c99\nOBJECTS = main.o jeu.o grille.o io.o\nEXEC = main\nDOCGEN = doxygen\n\nvpath %.c src/\nvpath %.h include/\nvpath %.o obj/\nvpath main bin/\n\nall: main\n\nmain: $(OBJECTS)\n    @echo \"\\n==== Linking $@ $^ ====\"\n    @gcc -o $@ $(OBJECTS)\n    @mkdir -p bin\n    @mv $@ bin/\n    #@mkdir -p obj\n    #@mv *.o obj/\n\nmain.o: io.h jeu.h\n\nio.o: io.h \n\njeu.o: jeu.h\n\n%.o: %.c grille.h\n    @echo \"\\n---- Rule \" $@  $&lt; \"----\"\n    @gcc $(CFLAGS) $&lt;\n    @mkdir -p obj\n    @mv $@ obj/\n\n\ndoc:\n    @mkdir -p doc\n    @$(DOCGEN)\n\nclean: \n    @rm -rf doc/\n    @rm -rf bin/\n    @rm -rf obj/\n    @rm -f *.xz\n</code></pre>\n\n<p>Any suggestions are welcome. I have read that vpath is not recommended for finding generated files. But this is an assignment and I have to use it this way. \nIf I uncomment the two lines and comment the last two lines from the <code>%.o</code> rule, the code works great, but I cannot do that.\nThis is the error at execution:</p>\n\n<pre><code>---- Rule  main.o src/main.c ----\n\n---- Rule  jeu.o src/jeu.c ----\n\n---- Rule  grille.o src/grille.c ----\n\n---- Rule  io.o src/io.c ----\n\n==== Linking main main.o jeu.o grille.o io.o ====\ngcc: error: main.o: No such file or directory\ngcc: error: jeu.o: No such file or directory\ngcc: error: grille.o: No such file or directory\ngcc: error: io.o: No such file or directory\ngcc: fatal error: no input files\ncompilation terminated.\nMakefile:15: recipe for target 'main' failed\nmake: *** [main] Error 1\n</code></pre>\n"}, {"tags": ["c", "loops", "for-loop", "compilation", "primes"], "comments": [{"owner": {"reputation": 394, "user_id": 3516859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BQems.jpg?s=128&g=1", "display_name": "Piters", "link": "https://stackoverflow.com/users/3516859/piters"}, "edited": false, "score": 0, "creation_date": 1573036174, "post_id": 58727994, "comment_id": 103747091, "body": "1 is not prime."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1573036452, "post_id": 58727994, "comment_id": 103747275, "body": "What&#39;s a pair of primes? Aren&#39;t (3 5) a pair?"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1573036702, "post_id": 58727994, "comment_id": 103747390, "body": "If you want to output all primes in groups of two, you could just output the primes as they are detected and then think about logic to have parenthesis output in the right places. - To control that, one state variable, <code>bool inPair</code>, should do."}, {"owner": {"reputation": 394, "user_id": 3516859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BQems.jpg?s=128&g=1", "display_name": "Piters", "link": "https://stackoverflow.com/users/3516859/piters"}, "edited": false, "score": 0, "creation_date": 1573036706, "post_id": 58727994, "comment_id": 103747392, "body": "I think something like (3,5) (5,7) (11,13) (17,19) would be a valid output. So actually a pair of primes with a difference of 2"}], "answers": [{"tags": [], "owner": {"reputation": 1605, "user_id": 11723965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ygAu.jpg?s=128&g=1", "display_name": "nivpeled", "link": "https://stackoverflow.com/users/11723965/nivpeled"}, "is_accepted": false, "score": 1, "last_activity_date": 1573036734, "creation_date": 1573036734, "answer_id": 58728196, "question_id": 58727994, "link": "https://stackoverflow.com/questions/58727994/how-to-print-out-more-than-one-pair-of-prime-numbers/58728196#58728196", "title": "How to print out more than one Pair of prime numbers", "body": "<pre><code>#include \"stdio.h\"\n\nint is_prime(int num)\n{\n    if (num &lt;= 1) return 0;\n    if (num % 2 == 0 &amp;&amp; num &gt; 2) return 0;\n    for (int i = 3; i &lt; num / 2; i += 2)\n    {\n        if (num % i == 0)\n            return 0;\n    }\n    return 1;\n}\n\n\n\n\nint main()\n\n{\n\nint prim_arry[10000];\nint p = 0;\n\nfor (int max = 2; max &lt; 10000; max++) \n{\n    if (is_prime(max)) \n    {\n\n        prim_arry[p++] =max;\n    }\n}\n\nfor (int i = 0; i &lt; p; i+=2)\n{\n    if (i == p - 1)\n    {\n        printf(\"(%d)\", prim_arry[i]);\n    }\n    else\n    {\n        printf(\"(%d,%d)\", prim_arry[i], prim_arry[i + 1]);\n    }\n\n}\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1573037973, "creation_date": 1573037973, "answer_id": 58728576, "question_id": 58727994, "link": "https://stackoverflow.com/questions/58727994/how-to-print-out-more-than-one-pair-of-prime-numbers/58728576#58728576", "title": "How to print out more than one Pair of prime numbers", "body": "<p>It seems what you need is something like the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint is_prime( unsigned long long int n )\n{\n    int prime = n % 2 == 0 ? n == 2 : n != 1;\n\n    for ( unsigned long long int i = 3; prime &amp;&amp; i &lt;= n / i; i+= 2 )\n    {\n        prime = n % i != 0;\n    }\n\n    return prime;\n}\n\nint main(void) \n{\n    const unsigned int UPPER_VALUE = 1000;\n\n    for ( unsigned int i = 2, prev = 0, first = 0; i &lt; UPPER_VALUE; i++ )\n    {\n        if ( is_prime( i ) )\n        {\n            if ( first ^= 1 )\n            {\n                prev = i;\n            }\n            else if ( i - prev &lt;= 2 )\n            {\n                printf( \"(%u, %u) \", prev, i );\n            }\n            else\n            {\n                first = 1;\n                prev = i;\n            }\n        }\n    }\n\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>(2, 3) (5, 7) (11, 13) (17, 19) (29, 31) (41, 43) (59, 61) (71, 73) (101, 103) \n(107, 109) (137, 139) (149, 151) (179, 181) (191, 193) (197, 199) (227, 229) \n(239, 241) (269, 271) (281, 283) (311, 313) (347, 349) (419, 421) (431, 433) \n(461, 463) (521, 523) (569, 571) (599, 601) (617, 619) (641, 643) (659, 661) \n(809, 811) (821, 823) (827, 829) (857, 859) (881, 883) \n</code></pre>\n\n<p>In the program I used the constant <code>UPPER_VALUE</code> equal to <code>1000</code> instead of <code>10000</code> to restrict the output.:) Of course you may use the constant equal to <code>10000</code> or to any other value.</p>\n\n<p>Also you can optimize the loop moving the output of the first pair <code>(2, 3)</code> outside the loop and defining the loop itself like</p>\n\n<pre><code>    for ( unsigned int i = 5, prev = 0, first = 0; i &lt; UPPER_VALUE; i += 2 )\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10813205, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BLvTm9fs5o8/AAAAAAAAAAI/AAAAAAAAAJE/-6xe9TS1CPE/photo.jpg?sz=128", "display_name": "user10813205", "link": "https://stackoverflow.com/users/10813205/user10813205"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576019828, "creation_date": 1573036051, "last_edit_date": 1576019828, "question_id": 58727994, "link": "https://stackoverflow.com/questions/58727994/how-to-print-out-more-than-one-pair-of-prime-numbers", "title": "How to print out more than one Pair of prime numbers", "body": "<p>This is a part of a code which only prints out one pair of prime number <strong>(1 3)</strong>. How do I print out all pairs until 10000? <strong>(1 3) (5 7)...until 10000</strong></p>\n\n<pre><code>    int paarPrim = -1;\nfor(int max = 2; max &lt; 10000; max++) {\n    if(isPrim(max)) {\n        if(max - paarPrim &lt;= 2) {\n            printf(\"(%i %i)\", paarPrim, max);\n        }\n            paarPrim = 1;\n\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c", "arrays", "pointers", "ctypes"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "edited": false, "score": 1, "creation_date": 1573076591, "post_id": 58735157, "comment_id": 103767719, "body": "oh man, What you did there is insane and it works, thanks alot. But lets say instead of returning an uint16, I want to return an uint8 array allocated in C and access it through python as a numpy array? The array is uint8 but the pointer to the start of the array is 32bit"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "edited": false, "score": 1, "creation_date": 1573078550, "post_id": 58735157, "comment_id": 103768425, "body": "If using <i>CTypes</i> as a layer between <i>Python</i> and <i>C</i>, you have be consistent. Any <i>NumPy</i>  array you might need, will be constructed (in <i>Python</i>) out of <i>CTypes</i> array (or buffer). I&#39;m going to repeat myself, but if you know the length of the array you need from <i>C</i>, make it an additional (output) parameter of the function instead of a return value (as you won&#39;t  have to worry about memory leaks). Remark: the 2 <i>URL</i>s at the end of my answer contain the exact piece of information you need. If something isn&#39;t clear, feel free to ask another question :)"}, {"owner": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "edited": false, "score": 0, "creation_date": 1573110089, "post_id": 58735157, "comment_id": 103775946, "body": "ye i got you, thanks alot, allocating the memory in python and passing the array as a parameter is a good idea"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "edited": false, "score": 0, "creation_date": 1573229255, "post_id": 58735157, "comment_id": 103825990, "body": "You&#39;re welcome! If it answered your question, please accept the answer, so that others are able to acknowledge it as well  (<a href=\"https://stackoverflow.com/help/someone-answers\">&#91;SO&#93;: What should I do when someone answers my question?</a>)."}, {"owner": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "edited": false, "score": 1, "creation_date": 1573313912, "post_id": 58735157, "comment_id": 103845552, "body": "How can i cast ct_ptr back to numpy 2d array?"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "edited": false, "score": 0, "creation_date": 1573346522, "post_id": 58735157, "comment_id": 103852931, "body": "Noticed you already asked another question: <a href=\"https://stackoverflow.com/questions/58781199/how-can-i-cast-a-double-pointer-ctype-to-numpy-array\" title=\"how can i cast a double pointer ctype to numpy array\">stackoverflow.com/questions/58781199/&hellip;</a>."}, {"owner": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "edited": false, "score": 0, "creation_date": 1573505252, "post_id": 58735157, "comment_id": 103896271, "body": "Hey man, Im having trouble creating a ctPointer for a 3D numpy array, I have some code but i dont know how to post code block, the code doesn&#39;t work tho"}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 3, "last_activity_date": 1606635720, "last_edit_date": 1606635720, "creation_date": 1573059688, "answer_id": 58735157, "question_id": 58727931, "link": "https://stackoverflow.com/questions/58727931/how-to-pass-a-2d-array-from-python-to-c/58735157#58735157", "title": "How to pass a 2d array from Python to C?", "body": "<p>Listing <a href=\"https://docs.scipy.org/doc/numpy/reference/routines.ctypeslib.html\" rel=\"nofollow noreferrer\">[SciPy.Docs]: C-Types Foreign Function Interface (numpy.ctypeslib)</a> (and <a href=\"https://docs.python.org/3/library/ctypes.html#module-ctypes\" rel=\"nofollow noreferrer\">[Python 3.Docs]: ctypes - A foreign function library for Python</a> just in case).</p>\n<p>This is a exactly like <a href=\"https://stackoverflow.com/questions/58610333/calling-c-function-in-python-through-ctypes-but-function-returns-incorrect-valu/58611011#58611011\">[SO]: Calling C function in Python through ctypes, but function returns incorrect value (@CristiFati's answer)</a> (a duplicate), it just happens to also involve <em>NumPy</em>. <br>In other words, you have <em><strong>Undefined Behavior</strong></em>, as <em>argtypes</em> must be <em>CTypes</em> types (<strong>not</strong> <em>NumPy</em>).</p>\n<p>Below is a modified version of the your code, that works.</p>\n<p><em>dll00.c</em>:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdint.h&gt;\n\n#if defined(_WIN32)\n#  define DLL00_EXPORT_API __declspec(dllexport)\n#else\n#  define DLL00_EXPORT_API\n#endif\n\n\n#if defined(__cplusplus)\nextern &quot;C&quot; {\n#endif\n\nDLL00_EXPORT_API uint16_t dll00Func00(uint16_t **ppArr);\n\n#if defined(__cplusplus)\n}\n#endif\n\n\nuint16_t dll00Func00(uint16_t **ppArr) {\n    return ppArr[5][5];\n}\n</code></pre>\n<p><em>code00.py</em>:</p>\n<pre class=\"lang-py prettyprint-override\"><code>#!/usr/bin/env python3\n\nimport sys\nimport ctypes as ct\nimport numpy as np\n\n\nDLL_NAME = &quot;./dll00.dll&quot;\n\n\ndef main():\n    UI16Ptr = ct.POINTER(ct.c_uint16)\n    UI16PtrPtr = ct.POINTER(UI16Ptr)\n\n    dll00 = ct.CDLL(DLL_NAME)\n    dll00Func00 = dll00.dll00Func00\n    dll00Func00.argtypes = [UI16PtrPtr]\n    dll00Func00.restype = ct.c_uint16\n\n\n    dim0 = 10\n    dim1 = 10\n    np_arr_2d = np.empty([dim0, dim1], dtype=np.uint16)\n\n    np_arr_2d[5][5] = 5\n    print(np_arr_2d)\n\n    # The &quot;magic&quot; happens in the following (3) lines of code\n    ct_arr = np.ctypeslib.as_ctypes(np_arr_2d)\n    UI16PtrArr = UI16Ptr * ct_arr._length_\n    ct_ptr = ct.cast(UI16PtrArr(*(ct.cast(row, UI16Ptr) for row in ct_arr)), UI16PtrPtr)\n    res = dll00Func00(ct_ptr)\n\n    print(&quot;\\n{0:s} returned: {1:d}&quot;.format(dll00Func00.__name__, res))\n\n\nif __name__ == &quot;__main__&quot;:\n    print(&quot;Python {0:s} {1:d}bit on {2:s}\\n&quot;.format(&quot; &quot;.join(item.strip() for item in sys.version.split(&quot;\\n&quot;)), 64 if sys.maxsize &gt; 0x100000000 else 32, sys.platform))\n    print(&quot;NumPy: {0:s}\\n&quot;.format(np.version.version))\n    main()\n    print(&quot;\\nDone.&quot;)\n</code></pre>\n<p><strong>Output</strong>:</p>\n\n<blockquote>\n<pre class=\"lang-bat prettyprint-override\"><code>[cfati@CFATI-5510-0:e:\\Work\\Dev\\StackOverflow\\q058727931]&gt; sopr.bat\n*** Set shorter prompt to better fit when pasted in StackOverflow (or other) pages ***\n\n[prompt]&gt; &quot;c:\\Install\\x86\\Microsoft\\Visual Studio Community\\2017\\VC\\Auxiliary\\Build\\vcvarsall.bat&quot; x64\n**********************************************************************\n** Visual Studio 2017 Developer Command Prompt v15.9.17\n** Copyright (c) 2017 Microsoft Corporation\n**********************************************************************\n[vcvarsall.bat] Environment initialized for: 'x64'\n\n[prompt]&gt; dir /b\ncode00.py\ndll00.c\n\n[prompt]&gt; cl /nologo /DDLL dll00.c  /link /NOLOGO /DLL /OUT:dll00.dll\ndll00.c\n   Creating library dll00.lib and object dll00.exp\n\n[prompt]&gt; dir /b\ncode00.py\ndll00.c\ndll00.dll\ndll00.exp\ndll00.lib\ndll00.obj\n\n[prompt]&gt; &quot;e:\\Work\\Dev\\VEnvs\\py_064_03.07.03_test0\\Scripts\\python.exe&quot; code00.py\nPython 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 22:22:05) [MSC v.1916 64 bit (AMD64)] 64bit on win32\n\nNumPy: 1.16.2\n\n[[19760  5277   632     0 32464  5280   632     0   111   114]\n [  107    92    68   101   118    92    86    69   110   118]\n [  115    92   112   121    95    48    54    52    95    48]\n [   51    46    48    55    46    48    51    95   116   101]\n [  115   116    48    92   108   105    98    92   115   105]\n [  116   101    45   112    97     5   107    97   103   101]\n [  115    92   110   117   109   112   121    92   116   101]\n [  115   116   105   110   103    92    95   112   114   105]\n [  118    97   116   101    92   110   111   115   101   116]\n [  101   115   116   101   114    46   112   121     0     0]]\n\ndll00Func00 returned: 5\n\nDone.\n</code></pre>\n</blockquote>\n<p>The explanation for all those funky conversions can be found at <a href=\"https://stackoverflow.com/questions/58226790/c-python-pass-and-return-a-2d-double-pointer-array-from-python-to-c/58262388#58262388\">[SO]: C++ &amp; Python: Pass and return a 2D double pointer array from python to c++ (@CristiFati's answer)</a> (and the referenced <a href=\"https://stackoverflow.com/questions/57295045/problems-with-passing-and-getting-arrays-for-a-c-function-using-ctypes/57299823#57299823\">[SO]: Problems with passing and getting arrays for a C function using ctypes (@CristiFati's answer)</a>).</p>\n"}], "owner": {"reputation": 115, "user_id": 9383163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208612711194716/picture?type=large", "display_name": "Dan Shorla Ki", "link": "https://stackoverflow.com/users/9383163/dan-shorla-ki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 3, "accepted_answer_id": 58735157, "answer_count": 1, "score": 5, "last_activity_date": 1606635720, "creation_date": 1573035834, "question_id": 58727931, "link": "https://stackoverflow.com/questions/58727931/how-to-pass-a-2d-array-from-python-to-c", "title": "How to pass a 2d array from Python to C?", "body": "<p>I'm trying to pass a 2d array from Python to C, using ctypes.\nThe array dtype is uint16.\nI wrote a simple code just to understand how it works:</p>\n\n<p>C:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\n__declspec(dllexport) uint16_t Test(uint16_t **arr)\n{\n     return (arr[5][5]);\n}\n\n</code></pre>\n\n<p>Python:</p>\n\n<pre><code>import numpy as np\nfrom ctypes import cdll\nimport ctypes\nfrom numpy.ctypeslib import ndpointer\n\n_p = ndpointer(dtype=np.uint16, ndim=2, shape=(10, 10), flags='C')\nmydll = cdll.LoadLibrary(\"mydll.dll\")\n_func = mydll.Test\n_func.argtypes = [_p]\n_func.restypes = ctypes.c_uint16\n\ndata = np.empty([10, 10], dtype=np.uint16)\ndata[5, 5] = 5\nprint(_func(data))\n</code></pre>\n\n<p>I get OSError: access violation reading 0xFFFFFFFFFFFFFFFFFFFFFFF\nwhat am I doing wrong and how do I fix it?</p>\n"}, {"tags": ["c", "gcc", "gcc-warning"], "comments": [{"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573037336, "post_id": 58727227, "comment_id": 103747722, "body": "Just a little note: why do you use a prototype, if the definition follows just in the line below?"}, {"owner": {"reputation": 565, "user_id": 3412158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73164b39342aff045b6293ae30541e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Koning", "link": "https://stackoverflow.com/users/3412158/aris-koning"}, "reply_to_user": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573043036, "post_id": 58727227, "comment_id": 103750782, "body": "Oh it was just a remnant of my compiler complaining about missing declaration. I&#39;ll remove it."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 3412158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73164b39342aff045b6293ae30541e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Koning", "link": "https://stackoverflow.com/users/3412158/aris-koning"}, "edited": false, "score": 0, "creation_date": 1573034240, "post_id": 58727329, "comment_id": 103746052, "body": "Ah thanks for the quick answers! So instead of <code>~((uint16_t) 0)</code> I should use <code>uint16_t (-1)</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 565, "user_id": 3412158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73164b39342aff045b6293ae30541e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Koning", "link": "https://stackoverflow.com/users/3412158/aris-koning"}, "edited": false, "score": 2, "creation_date": 1573034426, "post_id": 58727329, "comment_id": 103746155, "body": "@ArisKoning Won&#39;t work as integer promotion will also be done to both operands of the bitwise shift operators."}, {"owner": {"reputation": 565, "user_id": 3412158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73164b39342aff045b6293ae30541e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Koning", "link": "https://stackoverflow.com/users/3412158/aris-koning"}, "edited": false, "score": 0, "creation_date": 1573034769, "post_id": 58727329, "comment_id": 103746342, "body": "Ok, well at least I now understand that the problem is with rules of integer promotion. I&#39;ll see if I can rewrite this somehow."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 3, "last_activity_date": 1573035137, "last_edit_date": 1573035137, "creation_date": 1573034035, "answer_id": 58727329, "question_id": 58727227, "link": "https://stackoverflow.com/questions/58727227/compiler-warning-left-shift-of-negative-value/58727329#58727329", "title": "compiler warning: left shift of negative value", "body": "<p>Warning is correct.</p>\n\n<p><code>~((uint16_t) 0)</code> results in negative value, because result of <code>(uint16_t) 0</code> is promoted to <code>int</code> before bitwise complement is performed.</p>\n\n<p>In general you should prefer unsigned integers (wide enough to avoid type promotion) when using bit shifting. My suggestion would be to use <code>unsigned int</code> zero instead:</p>\n\n<pre><code>return (~(~0U &lt;&lt; shift));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 5, "last_activity_date": 1573034064, "creation_date": 1573034064, "answer_id": 58727344, "question_id": 58727227, "link": "https://stackoverflow.com/questions/58727227/compiler-warning-left-shift-of-negative-value/58727344#58727344", "title": "compiler warning: left shift of negative value", "body": "<p>When variables smaller than <code>int</code> (like e.g. <code>uint16_t</code>) are used with the bitwise complement operator <code>~</code> they are <a href=\"https://en.cppreference.com/w/c/language/conversion#Integer_promotions\" rel=\"noreferrer\">promoted to <code>int</code></a>.</p>\n\n<p>The type <code>int</code> is signed, and will not work well with shifting. Especially considering that <code>~0</code> will be <code>-1</code> with two's complement notation (which is the most common notation for representing negative numbers on binary systems).</p>\n\n<p>A possible solution is to use larger unsigned types (like <code>unsigned int</code>) and then use masking to get the relevant bits for the smaller type when done.</p>\n"}], "owner": {"reputation": 565, "user_id": 3412158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73164b39342aff045b6293ae30541e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Koning", "link": "https://stackoverflow.com/users/3412158/aris-koning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 58727329, "answer_count": 2, "score": 0, "last_activity_date": 1573043055, "creation_date": 1573033714, "last_edit_date": 1573043055, "question_id": 58727227, "link": "https://stackoverflow.com/questions/58727227/compiler-warning-left-shift-of-negative-value", "title": "compiler warning: left shift of negative value", "body": "<p>I think GCC is wrongfully producing a [-Wshift-negative-value] warning.</p>\n\n<p>I have a function that should produce a suffix mask of a certain length provided by its single input argument:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nuint16_t get_suffix_mask_sht(uint8_t shift) {\n    return (~(~((uint16_t) 0) &lt;&lt; shift));\n}\n</code></pre>\n\n<p>I have tried to compile this function with the following compiler options on different versions of gcc</p>\n\n<pre><code>-Werror -Wextra\n</code></pre>\n\n<p>This warning also occurs if I change the output from <code>uint16_t</code> to <code>uint8_t</code>. Bigger output types, i.e. <code>uint32_t</code> don't produce this warning.</p>\n\n<p>I am using an older version of GCC: 7.4. But I have tried this out on <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt</a> using the latest GCC 9.x versions and they all produce the same warning. Clang versions however do not produce this error.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1573032772, "post_id": 58726924, "comment_id": 103745183, "body": "<code>(num1 = !num2)</code> should be <code>(num1 != num2)</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1573033707, "post_id": 58726924, "comment_id": 103745746, "body": "<code>num1 = !num2</code>  ---   if <code>num2</code> is not zero, then <code>!num2</code> is zero.   So the result is setting <code>num1</code> to zero.     If <code>num2</code> had a value zero, then <code>num1</code> would be assigned to <code>1</code>.     This is different from <code>num1 != num2</code> which tests if th values are equal, but changes neither."}, {"owner": {"reputation": 33, "user_id": 12330964, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAaD8TOc8VGc4XH0uDNiH7Z5BhWb_lCx9tmQXgk=k-s128", "display_name": "milad naderi", "link": "https://stackoverflow.com/users/12330964/milad-naderi"}, "edited": false, "score": 0, "creation_date": 1573041394, "post_id": 58726924, "comment_id": 103749921, "body": "thank you mate. i am the king of noobs in programming right now"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1573230982, "post_id": 58726924, "comment_id": 103826940, "body": "when posting about a run-time problem, as this question is doing, Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it.  This includes posting which header files are being <code>#included</code>d"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1573231119, "post_id": 58726924, "comment_id": 103827013, "body": "regarding: <code>if (num1 = !num2)</code>  This is an assignment statement, not a comparison.  Perhaps you meant: <code>if (num1 != num2)</code>"}, {"owner": {"reputation": 33, "user_id": 12330964, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAaD8TOc8VGc4XH0uDNiH7Z5BhWb_lCx9tmQXgk=k-s128", "display_name": "milad naderi", "link": "https://stackoverflow.com/users/12330964/milad-naderi"}, "edited": false, "score": 0, "creation_date": 1573242557, "post_id": 58726924, "comment_id": 103831783, "body": "yes thank you that was the problem"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 2, "last_activity_date": 1573032781, "creation_date": 1573032781, "answer_id": 58726948, "question_id": 58726924, "link": "https://stackoverflow.com/questions/58726924/why-first-integer-value-turns-zero-after-an-if/58726948#58726948", "title": "why first integer value turns zero after an if", "body": "<p><code>num1 = !num2</code> is grouped as <code>num1 = (!num2)</code>. In other words <code>num1</code> is assigned to <code>!num2</code>, which is either 1 or 0.</p>\n\n<p><code>num1 != num2</code> is the fix.</p>\n"}], "owner": {"reputation": 33, "user_id": 12330964, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAaD8TOc8VGc4XH0uDNiH7Z5BhWb_lCx9tmQXgk=k-s128", "display_name": "milad naderi", "link": "https://stackoverflow.com/users/12330964/milad-naderi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58726948, "answer_count": 1, "score": 1, "last_activity_date": 1573032781, "creation_date": 1573032712, "question_id": 58726924, "link": "https://stackoverflow.com/questions/58726924/why-first-integer-value-turns-zero-after-an-if", "title": "why first integer value turns zero after an if", "body": "<p>after if triggers int1 value turns to 0\ni had this problem alot even a simple sum function gives wrong answer and i dont know why help me please</p>\n\n<pre><code>int main(void)\n{\n    int num1;\n    int num2;\n    printf(\"Enter the first Numver:\\n\");\n    scanf_s(\"%d\", &amp;num1);\n    printf(\"Enter the scond Numver:\\n\");\n    scanf_s(\"%d\", &amp;num2);\n\n    if (num1 == num2)\n    {\n        printf(\"%d is equal to %d\\n\",num1,num2);\n    }\n    if (num1 = !num2)\n    {\n        printf(\"%d not equal to %d\\n\",num1,num2);\n    }\n    if (num1&lt;num2)\n    {\n        printf(\"%d is greater than %d\\n\",num2,num1);\n    }\n    if (num1&gt;num2)\n    {\n        printf(\"%d greater than %d\\n\",num1,num2);\n    }\n    if (num1 &gt;= num2)\n    {\n        printf(\"%d greater or equal to %d\\n\", num1, num2);\n    }\n    if (num1 &lt;= num2)\n    {\n        printf(\"%d greater or equal to %d\\n\", num2, num1);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>when i put 4 and 3 it says 3 is greater than 0</p>\n"}, {"tags": ["c", "arrays", "for-loop", "character", "getchar"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 12289709, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CknAnjA5SCQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwORuPZ_ulLUDH_WXo7BT-rJuOYw/photo.jpg?sz=128", "display_name": "Grasshelicopter", "link": "https://stackoverflow.com/users/12289709/grasshelicopter"}, "edited": false, "score": 0, "creation_date": 1573127933, "post_id": 58726902, "comment_id": 103784977, "body": "So does that even means that getchar() will read the next character every times that i used no matter where? It this the only way to write it?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 17, "user_id": 12289709, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CknAnjA5SCQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwORuPZ_ulLUDH_WXo7BT-rJuOYw/photo.jpg?sz=128", "display_name": "Grasshelicopter", "link": "https://stackoverflow.com/users/12289709/grasshelicopter"}, "edited": false, "score": 0, "creation_date": 1573128044, "post_id": 58726902, "comment_id": 103785050, "body": "@Grasshelicopter Yes, getchar will read the next character if you will not even assign its result."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1573032621, "creation_date": 1573032621, "answer_id": 58726902, "question_id": 58726816, "link": "https://stackoverflow.com/questions/58726816/input-and-output-a-set-of-character-with-an-array-by-using-getchar-and-putchar/58726902#58726902", "title": "Input and output a set of character with an array by using getchar() and putchar()", "body": "<p>Instead use the following</p>\n\n<pre><code>int value;\n\nfor ( i = 0; i &lt; MAX_SIZE &amp;&amp; ( value = getchar() ) != EOF &amp;&amp; value != '\\n'; i++ )\n{\n    c[i] = value;\n}\n\nfor ( int j = 0; j &lt; i; j++ )\n{\n    putchar( c[j] );\n}\n\nputchar( '\\n' );\n</code></pre>\n\n<p>Otherwise at least in this loop</p>\n\n<pre><code>for(i=0;getchar()!='\\n';i++){\n        ^^^^^^^^   \n</code></pre>\n\n<p>you are skipping each even character </p>\n\n<p>And the header <code>&lt;ctype.h&gt;</code> may be removed because neither declaration from the header is used in the program.</p>\n"}], "owner": {"reputation": 17, "user_id": 12289709, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CknAnjA5SCQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwORuPZ_ulLUDH_WXo7BT-rJuOYw/photo.jpg?sz=128", "display_name": "Grasshelicopter", "link": "https://stackoverflow.com/users/12289709/grasshelicopter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58726902, "answer_count": 1, "score": 1, "last_activity_date": 1573032621, "creation_date": 1573032281, "question_id": 58726816, "link": "https://stackoverflow.com/questions/58726816/input-and-output-a-set-of-character-with-an-array-by-using-getchar-and-putchar", "title": "Input and output a set of character with an array by using getchar() and putchar()", "body": "<p>I am newbie to the world of C programming language and not so familiar with the function putchar() and getchar().I try to write a code that read a set of character inputted and store it in an array.\nHere is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;ctype.h&gt;\n#define MAX_SIZE 100\n\nint main(){\n    int i;\n    char c[MAX_SIZE]={0};\n    printf(\"Enter message:\");\n\n    for(i=0;getchar()!='\\n';i++){\n        c[i] = getchar();    /*looks like some error here that the compiler didn't found out.....*/\n    }\n\n    for(i=0;c[i]!='\\n';i++){\n        putchar(c[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The program runs successfully but didn't work well. The result outputted is chaotic and totally have no meaning.\nI wonder what's wrong with my code as it looks no error for me(so does the compiler seen correct to it). I wish i can get an explanation besides getting a correct way to write it.</p>\n"}, {"tags": ["c", "linux-kernel", "signals", "linux-device-driver", "kernel-module"], "comments": [{"owner": {"reputation": 3561, "user_id": 1149797, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cVBtb.png?s=128&g=1", "display_name": "Alex Hoppus", "link": "https://stackoverflow.com/users/1149797/alex-hoppus"}, "edited": false, "score": 0, "creation_date": 1573048132, "post_id": 58726809, "comment_id": 103753719, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/58690083/use-signals-to-notify-about-an-input-hardware-event-for-a-push-button-in-c\">Use signals to notify about an input hardware event for a push button in C?</a>"}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "reply_to_user": {"reputation": 3561, "user_id": 1149797, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cVBtb.png?s=128&g=1", "display_name": "Alex Hoppus", "link": "https://stackoverflow.com/users/1149797/alex-hoppus"}, "edited": false, "score": 0, "creation_date": 1573048512, "post_id": 58726809, "comment_id": 103753934, "body": "@AlexHoppus No it does not help"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 2, "creation_date": 1573072348, "post_id": 58726809, "comment_id": 103766126, "body": "IIRC your Device Tree configures a GPIO pin as a <code>gpio-keys</code> and another GPIO pin as <code>gpio-leds</code>, and there&#39;s a <i>&quot;requirement&quot;</i> that these configurations cannot be modified. As long as you use these DT configurations for userspace APIs but  insist on using a loadable kernel module, then you will forced into constructing contorted, ill-advised kernel code. IOW you&#39;re trying to fit square pegs into round holes, and ignoring the idea of using round pegs. You can&#39;t reuse a DT configuration intended for a different implementation."}], "owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1573808338, "creation_date": 1573032268, "last_edit_date": 1573808338, "question_id": 58726809, "link": "https://stackoverflow.com/questions/58726809/problem-in-sending-signals-from-my-linux-kernel-module-to-user-space-application", "title": "Problem In sending signals from my Linux kernel module to user space application", "body": "<p>I am using an embedded board with a Linux operating system.</p>\n\n<p>This board has a push button and Led.</p>\n\n<ul>\n<li><p>Button file path is : <em>/dev/input/event0</em> , and has a code <strong>260</strong> .</p></li>\n<li><p>Led file Path is : <em>/sys/class/leds</em> .</p></li>\n</ul>\n\n<p>I want to control Led, switch on and off, through the button. Besides, I want to use signals to notify about Pushing button event occurring. The signal will be sent to user space when the event has occurred.</p>\n\n<p>For that, I developed Linux kernel loadable module and principal user space application.</p>\n\n<p>This is the module :</p>\n\n<pre><code>#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;asm/siginfo.h&gt;    //siginfo\n#include &lt;linux/rcupdate.h&gt;    //rcu_read_lock\n#include &lt;linux/sched/signal.h&gt;    //find_task_by_pid_type\n#include &lt;linux/debugfs.h&gt;\n#include &lt;linux/uaccess.h&gt;\n#include&lt;linux/slab.h&gt;\n#include &lt;linux/input.h&gt;\n#include &lt;linux/device.h&gt;\n#include &lt;linux/fs.h&gt; \n\n\n#define SIG_TEST 44    // we choose 44 as our signal number (real-time signals are in the range of 33 to 64)\n#define BTN_FILE_PATH \"/dev/input/event0\"\n\n\nchar *str = BTN_FILE_PATH;\nint file;\n\nstruct file *f;\n\n\nstatic ssize_t write_pid(struct file *pfile, const char __user *buffer,\n                                size_t length, loff_t *offset)\n{\n    return 0;\n}\n\n\n\nstatic ssize_t read_pid(struct file *pfile, char __user *buffer,\n                                size_t length, loff_t *offset)\n{\n\n\n     char mybuf[10];\n    enum { MAX_BUF_SIZE = 4096 };\n    size_t buf_size = 0;\n    char *buf = NULL;\n    ssize_t total = 0;\n    ssize_t rc = 0;\n    struct task_struct *t;\n    struct input_event  *ev;\n    int yalv;\n\n    int ret;\n    struct siginfo info;\n    int pid =0; \n\n    /* Allocate temporary buffer. */\n    if (length) {\n        buf_size = min_t(size_t, MAX_BUF_SIZE, length);\n        ev = kmalloc(buf_size, GFP_KERNEL);\n        if (ev == NULL) {\n            return -ENOMEM;\n        }\n    }\n\n    /* read the value from user space */\n    if(length &gt; 10)\n        return -EINVAL;\n    copy_from_user(mybuf, buffer, length);\n    sscanf(mybuf, \"%d\", &amp;pid);\n    printk(\"pid = %d\\n\", pid);\n\n    rcu_read_lock();\n    t = pid_task(find_vpid(pid), PIDTYPE_PID);  //find the task_struct associated with this pid\n    if(t == NULL){\n        printk(\"no such pid\\n\");\n        rcu_read_unlock();\n        return -ENODEV;\n    }\n    rcu_read_unlock();\n\n /* Read file to buffer in chunks. */\n\n        size_t amount = min_t(size_t, length, buf_size);\n\n        rc = kernel_read(f, ev, amount, offset);\n        if (rc &gt; 0) {\n            /* Have read some data from file. */\n            if (copy_to_user(buffer, ev, rc) != 0) {\n                /* Bad user memory! */\n                rc = -EFAULT;\n            } else {\n                /* Update totals. */\n                total += rc;\n                buffer += rc;\n                *offset += rc;\n                length -= rc;\n\n        for (yalv = 0; yalv &lt; (int) (rc / sizeof(struct input_event)); yalv++) {\n            if (ev[yalv].type == EV_KEY) {\n                printk(\"signal was send\\n\");\n                if (ev[yalv].value == 0)\n                     ret = send_sig_info(SIG_TEST, &amp;info, t);    //send the signal\n                         if (ret &lt; 0) {\n                            printk(\"error sending signal\\n\");\n                        kfree(buf);\n                            return ret;\n                         }\n\n            }\n        }\n                if (rc &lt; amount) {\n                    /* Didn't read the full amount, so terminate early. */\n                    rc = 0;\n                }\n            }\n\n    } \n\n\n    /* Free temporary buffer. */\n\n    kfree(buf);\n\n}\n\n\nstatic const struct file_operations my_fops = {\n    .owner = THIS_MODULE,\n    .write = write_pid,\n    .read = read_pid,\n};\n\nstatic int __init signalexample_module_init(void)\n{\n\n    /* we need to know the PID of the user space process\n      * -&gt; we use debugfs for this. As soon as a pid is written to \n      * this file, a signal is sent to that pid\n      */\n    /* only root can write to this file (no read) */\n    register_chrdev(240, \"Simple Char Drv\", &amp;my_fops);\n    file = debugfs_create_file(\"signalconfpid\", 0200, NULL, NULL, &amp;my_fops);\n    f = filp_open(str, 0 , O_RDONLY);\n\n    return 0;\n}\nstatic void __exit signalexample_module_exit(void)\n{\n    unregister_chrdev(240, \"Simple Char Drv\");\n    debugfs_remove(file);\n\n}\n</code></pre>\n\n<p>This is the principal user-space application :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;errno.h&gt;\n\n#include &lt;linux/input.h&gt;\n\n#define BTN_FILE_PATH \"/dev/input/event0\"\n#define LED_PATH \"/sys/class/leds\"\n#define red \"red\"\n#define SIG_TEST 44\n#define BUFFER_LENGTH 256\n\nvoid change_led_state(char *led_path, int led_value)\n{\n    char    lpath[64];\n    FILE    *led_fd;\n\n    strncpy(lpath, led_path, sizeof(lpath) - 1);\n    lpath[sizeof(lpath) - 1] = '\\0';\n\n    led_fd = fopen(lpath, \"w\");\n\n    if (led_fd == NULL) {\n        fprintf(stderr, \"simplekey: unable to access led\\n\");\n        return;\n    }\n\n    fprintf(led_fd, \"%d\\n\", led_value);\n\n    fclose(led_fd);\n}\n\nvoid reset_leds(void)\n{\n    change_led_state(LED_PATH \"/\" red \"/brightness\", 0);\n}\n\nint configure_leds(void)\n{\n    FILE    *r_fd;\n    char    *none_str = \"none\";\n\n    /* Configure leds for hand control */\n    l_fd = fopen(LED_PATH \"/\" red \"/trigger\", \"w\");\n\n    if ( r_fd == NULL) {\n        perror(\"simplekey: unable to configure led\");\n        return -EACCES;\n    }\n\n    fprintf(r_fd, \"%s\\n\", none_str);\n\n    fclose(r_fd);\n\n    /* Switch off leds */\n    reset_leds();\n\n    return 0;\n}\n\nvoid eval_keycode(int code)\n{\n    static int red_state = 0;\n\n    switch (code) {\n    case 260:\n        printf(\"BTN left pressed\\n\");\n\n        /* figure out red state */\n        red_state = red_state ? 0 : 1;\n\n        change_led_state(LED_PATH \"/\" red \"/brightness\", red_state);\n        break;\n\n    }\n}\n\n\nvoid receiveData(int n, siginfo_t *info, void *unused) \n{\n    printf(\"received value %i\\n\", info-&gt;si_int);   \n}\n\nint main ( int argc, char **argv )\n{\n    int ret;\n    int nc;\n    int fd;\n    int configfd;\n    char buf[10];\n    char buffer[BUFFER_LENGTH];\n    /* setup the signal handler for SIG_TEST \n      * SA_SIGINFO -&gt; we want the signal handler function with 3 arguments\n      */\n    struct sigaction sig;\n    sig.sa_sigaction = receiveData;\n    sig.sa_flags = SA_SIGINFO;\n    sigaction(SIG_TEST, &amp;sig, NULL);\n\n    fd = open(\"/dev/char_device\", O_RDONLY);             // Open the device with read access   \n    if (fd &lt; 0)\n    {\n            perror(\"Failed to open the device...\");\n            return errno;\n    }\n     sprintf(buffer, \"%i\", getpid());   \n    nc = read(fd,buffer,strlen(buffer));\n    if (nc &lt; 0)\n    {\n            perror(\"Failed to read the message from the device.\");\n            return errno;\n    }\n\n    ret = configure_leds();\n    if (ret &lt; 0)\n    exit(1);\n\n    reset_leds();\n    getchar();\n\n    return 0;\n}\n</code></pre>\n\n<p>After inserting the module and running the application, this returns to me only the <strong>PID</strong> of my user code, but when I push the button, nothing happens. The signal is not sent as I guess. </p>\n\n<p>If anyone would help me, I will be grateful. Thank you!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 0, "creation_date": 1573036174, "post_id": 58726657, "comment_id": 103747090, "body": "How are you running the program and what <code>#include</code>s do you have? E.G. to use printf i guess you included <code>stdio.h</code> right?"}, {"owner": {"reputation": 11, "user_id": 12330469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RsQWWjDjpQs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3liDs6cHiE95xzx-CTdkLEpf6EQ/photo.jpg?sz=128", "display_name": "DZnake", "link": "https://stackoverflow.com/users/12330469/dznake"}, "reply_to_user": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 0, "creation_date": 1573051400, "post_id": 58726657, "comment_id": 103755526, "body": "yes i included the <code>stdio.h</code> so the program can run but it still the same program that run @JohnSmith"}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 0, "creation_date": 1573054770, "post_id": 58726657, "comment_id": 103757645, "body": "how are you running your program? command line? IDE? something else?"}, {"owner": {"reputation": 11, "user_id": 12330469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RsQWWjDjpQs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3liDs6cHiE95xzx-CTdkLEpf6EQ/photo.jpg?sz=128", "display_name": "DZnake", "link": "https://stackoverflow.com/users/12330469/dznake"}, "reply_to_user": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 0, "creation_date": 1573055670, "post_id": 58726657, "comment_id": 103758155, "body": "i,m running it with devc++ compiler and the devc++ after compile and it run in cmd after that it give me the option of to insert a string or something as the answer -1 every time u type a char or if a number it will give a random number value?  After that it will close and don&#39;t even run <code>printf(&quot;Hello world&quot;)</code> it&#39;s so confusing why my program like that? @JohnSmith"}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 0, "creation_date": 1573056380, "post_id": 58726657, "comment_id": 103758544, "body": "I never used devc++ but i&#39;m guessing you are compiling and executing the wrong code. See if there is an option to choose the project or something like that and  check that it&#39;s the right one"}, {"owner": {"reputation": 11, "user_id": 12330469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RsQWWjDjpQs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3liDs6cHiE95xzx-CTdkLEpf6EQ/photo.jpg?sz=128", "display_name": "DZnake", "link": "https://stackoverflow.com/users/12330469/dznake"}, "reply_to_user": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 0, "creation_date": 1573088389, "post_id": 58726657, "comment_id": 103770884, "body": "it,s the right code i,m compiling and it also says i,m compiling that file not another but the exe is tell me to type a string and the result is -1 @JohnSmith"}, {"owner": {"reputation": 11, "user_id": 12330469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RsQWWjDjpQs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3liDs6cHiE95xzx-CTdkLEpf6EQ/photo.jpg?sz=128", "display_name": "DZnake", "link": "https://stackoverflow.com/users/12330469/dznake"}, "reply_to_user": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 0, "creation_date": 1573096276, "post_id": 58726657, "comment_id": 103772493, "body": "i,m done with this sorry @JohnSmith. so i found the problem is i forgot to save the name of file with _ so i just give it a space not _ so the file wont run or running the same file that have _ And also thank you for helping"}], "owner": {"reputation": 11, "user_id": 12330469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RsQWWjDjpQs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3liDs6cHiE95xzx-CTdkLEpf6EQ/photo.jpg?sz=128", "display_name": "DZnake", "link": "https://stackoverflow.com/users/12330469/dznake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573031750, "creation_date": 1573031750, "question_id": 58726657, "link": "https://stackoverflow.com/questions/58726657/getting-error-cmd-or-running-another-program-that-don-t-connected-with-the-file", "title": "Getting error cmd or running another program that don,t connected with the file", "body": "<pre><code>\nint main()\n{\n    printf(\"hello world\");\n\n    return 0;\n}\n</code></pre>\n\n<p>My code is like that but everytime i run it always get another code that like this</p>\n\n<p>blinking strip that use to be scanf and the output is -1 if i enter random answer or another answer\nit is don,t reconnected with the code</p>\n\n<p>Anyone can help me why everytime i run the program always like that?</p>\n"}, {"tags": ["c", "char", "scanf", "newline"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1573032326, "post_id": 58726329, "comment_id": 103744906, "body": "Hint:  hitting the &quot;Enter&quot; key produces a character that has ASCII value of 10.  More generally,  check the value of the character <code>&#39;\\n&#39;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1573032131, "last_edit_date": 1573032131, "creation_date": 1573030819, "answer_id": 58726382, "question_id": 58726329, "link": "https://stackoverflow.com/questions/58726329/why-is-the-first-value-of-my-char-array-10/58726382#58726382", "title": "Why is the first value of my char array 10?", "body": "<p>Use</p>\n\n<pre><code>scanf(\" %c\", &amp;matrix[i]);\n      ^^^^\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>scanf(\"%c\", &amp;matrix[i]);\n       ^^\n</code></pre>\n\n<p>When the format starts with a blank all white spaces are skipped.</p>\n\n<p>From the C Standard (7.21.6.2 The fscanf function)</p>\n\n<blockquote>\n  <p>5 A directive composed of white-space character(s) is executed by\n  reading input up to the first non-white-space character (which remains\n  unread), or until no more characters can be read.</p>\n</blockquote>\n\n<p>10 is the ASCII code of the (white space) new line character <code>'\\n'</code> that was present in the input buffer after you entered the length of the array. </p>\n"}, {"tags": [], "owner": {"reputation": 5543, "user_id": 6372809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11k5.jpg?s=128&g=1", "display_name": "ilkkachu", "link": "https://stackoverflow.com/users/6372809/ilkkachu"}, "is_accepted": false, "score": 0, "last_activity_date": 1573033437, "creation_date": 1573033437, "answer_id": 58727144, "question_id": 58726329, "link": "https://stackoverflow.com/questions/58726329/why-is-the-first-value-of-my-char-array-10/58727144#58727144", "title": "Why is the first value of my char array 10?", "body": "<p>The first <code>scanf()</code> with the format string <code>%d</code> leaves a newline in the input buffer. </p>\n\n<p>What happens here, is that your terminal collects input one full line at a time, passing it to the program, and then the <code>scanf()</code> only reads the digits from the buffer, leaving the newline character there for the next <code>scanf()</code> to see. The same would happen if you entered <code>10 abc</code>: the space, <code>abc</code> and the newline would be left there.</p>\n\n<p>This mismatch is not something people usually expect, and it's one of the things that makes <code>scanf()</code> annoying. I would suggest using <code>fgets()</code> instead to first read a full line, matching what the terminal gives, and then parse the number from it with <code>sscanf()</code> or <code>strtol()</code> (or <code>atoi()</code>).</p>\n\n<p>This cleans up the issue at the point where the first line is read, instead of passing it on to the next input function to handle. Otherwise all your input functions are tied together, if the next input would be for a whole line with possible white space, you'd need to know if you expect to clear a pre-existing newline or not. (You could also replace the later <code>scanf(\"%c\")</code> with <code>getchar()</code>, not that that matters with buffering though.)</p>\n\n<p>That said, the <code>scanf(\"%c\")</code>/<code>getchar()</code> loop may still see newlines if you enter lines that don't have as many characters as the loop expects, so if you don't want to see them at all, filter them out.</p>\n\n<p>So, something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int length;\n    char linebuf[100];\n    fgets(linebuf, 100, stdin);\n    length = strtol(linebuf, NULL, 10);\n    char *matrix = malloc(length + 1);\n\n    for (int i = 0; i &lt; length; i++)\n    {\n        matrix[i] = getchar();\n    }\n\n    for (int i = 0; i &lt; length; i++)\n    {\n        printf(\"\\n%d\", matrix[i]);\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>(The obvious downside of <code>fgets()</code> is that you have to decide on a maximum length for the input line, allocate a buffer and call another function in addition to it.)</p>\n"}], "owner": {"reputation": 13, "user_id": 12330679, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD9IoZL-84aEncc5upy0xVS5D9FXyiYXjjQvtel=k-s128", "display_name": "turkishelehant", "link": "https://stackoverflow.com/users/12330679/turkishelehant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58726382, "answer_count": 2, "score": 1, "last_activity_date": 1573033437, "creation_date": 1573030632, "last_edit_date": 1573031005, "question_id": 58726329, "link": "https://stackoverflow.com/questions/58726329/why-is-the-first-value-of-my-char-array-10", "title": "Why is the first value of my char array 10?", "body": "<p>I'm new to programming but I wanted to make a program that gets as input a number, (length) and then stores a series of a's and b's of said length. Finally it should output the numbers as the ascii numbers. (so 97 and 98)\nI thought I should malloc a char array of the size length and then do a for-loop over it and print everything as an integer.</p>\n\n<p>The problem is however that I get a value 10 as the value of the first letter.\nThanks a lot for any help!</p>\n\n<pre><code>int main()\n{\n    int length;\n    scanf(\"%d\", &amp;length);\n    char *matrix = malloc((length + 1 ) * sizeof(char));\n\n    for (int i = 0; i &lt; length; i++)\n    {\n            scanf(\"%c\", &amp;matrix[i]);\n    }\n\n    for (int i = 0; i &lt; length; i++)\n    {\n            printf(\"\\n%d\", matrix[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>When inputting 3 on the first line and aba on the next line, I get 10 97 98.\nHowever I expected it to be 97 98 97. Why do I get a value of 10 in the first place of the array?</p>\n"}, {"tags": ["c", "pthreads", "c11"], "answers": [{"comments": [{"owner": {"reputation": 1400, "user_id": 3287591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec170ce77ff19649edf457377421bb8?s=128&d=identicon&r=PG", "display_name": "Giovanni Cerretani", "link": "https://stackoverflow.com/users/3287591/giovanni-cerretani"}, "edited": false, "score": 0, "creation_date": 1573037163, "post_id": 58727984, "comment_id": 103747619, "body": "Since C11 and C++11 implementation are very similar, actually is not clear why the C versions <code>thrd_*</code>,  <code>mtx_*</code> and  <code>cnd_*</code> are missing a <code>*_native_handle</code> function, provided by all the C++ couterparts."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 1400, "user_id": 3287591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec170ce77ff19649edf457377421bb8?s=128&d=identicon&r=PG", "display_name": "Giovanni Cerretani", "link": "https://stackoverflow.com/users/3287591/giovanni-cerretani"}, "edited": false, "score": 0, "creation_date": 1573037657, "post_id": 58727984, "comment_id": 103747915, "body": "Even the existing interfaces were not that well specified in C11, <a href=\"https://gustedt.wordpress.com/2012/10/14/c11-defects-c-threads-are-not-realizable-with-posix-threads/\" rel=\"nofollow noreferrer\">Jen wrote about it</a> and there&#39;s been <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2244.htm\" rel=\"nofollow noreferrer\">improvements in C17</a>. But we&#39;re just speculating here.. Personally, I&#39;d prefer new interfaces could be wrappers on pthreads) rather than getting a pthread_t and then using pthreads intefaces."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1573036019, "creation_date": 1573036019, "answer_id": 58727984, "question_id": 58725949, "link": "https://stackoverflow.com/questions/58725949/is-it-legal-to-call-pthread-functions-on-thrd-t/58727984#58727984", "title": "Is it legal to call pthread functions on thrd_t?", "body": "<p>It's not valid - they have different interfaces and that could change without you knowing.</p>\n\n<p>Even if <code>thrd_t</code> and <code>thread_t</code> happen to have same aliases, that's not necessarily true on all platforms and more so, they don't necessarily have same\ndata structure to represent threads.</p>\n\n<p>In practice, this might work on Linux because most C11 and C++11 thread implementations are built on top of pthreads library. But that's not guaranteed to be the same in the future even on Linux (e.g., your system might use a different C library that provides its own thread implementation).</p>\n\n<p>I'd suggest you use either C11 or pthreads but not assume that there's any interoperability whether or not it works <em>right now</em>. This could change of course if C standard in the future provides such guarantees. But at the moment, it doesn't.</p>\n"}], "owner": {"reputation": 1400, "user_id": 3287591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec170ce77ff19649edf457377421bb8?s=128&d=identicon&r=PG", "display_name": "Giovanni Cerretani", "link": "https://stackoverflow.com/users/3287591/giovanni-cerretani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 58727984, "answer_count": 1, "score": 3, "last_activity_date": 1573037436, "creation_date": 1573029244, "last_edit_date": 1573037436, "question_id": 58725949, "link": "https://stackoverflow.com/questions/58725949/is-it-legal-to-call-pthread-functions-on-thrd-t", "title": "Is it legal to call pthread functions on thrd_t?", "body": "<p>The C11 support to thread is fine but not exaustive. In case I need to use pthread functions, I would like to understand if it is legal to cast <code>thrd_t</code> to <code>pthread_t</code>. For example:</p>\n\n<pre><code>#include &lt;threads.h&gt;\n#define_GNU_SOURCE\n#include &lt;pthread.h&gt;\n#include &lt;sched.h&gt;\n\nint main(void) {\n    thrd_t t;\n    cpu_set_t cpuset;\n    // some initialization code here...\n    pthread_setaffinity_np((pthread_t)t, sizeof(cpuset), &amp;cpuset) // Is the cast valid?\n    // other code here...\n}\n</code></pre>\n\n<p>C++11 provides <a href=\"https://en.cppreference.com/w/cpp/thread/thread/native_handle\" rel=\"nofollow noreferrer\">std::thread::native_handle</a> to get the <code>pthread_t</code> value to be in pthread functions, but C11 does not provide such function. Since, both <code>thrd_t</code> and <code>pthread_t</code> are typedefs to <code>unsigned long int</code>, I suppose they are compatible. What does the standard say about it?</p>\n\n<hr>\n\n<p><strong>Edit</strong>: the same question applies also for the other two types provided by <code>threads.h</code>, i.e. <code>mtx_t</code> and <code>cnd_t</code>.</p>\n"}, {"tags": ["c", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573027328, "post_id": 58725477, "comment_id": 103742548, "body": "Please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us. What is <code>list</code>? What is<code>listPos</code>? What is <code>arr</code>? And note that if you have pointers, then the size of a pointer is the size of the pointer itself, not what it points to."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573028185, "post_id": 58725623, "comment_id": 103742890, "body": "<code>*arr = ...</code> directly followed by <code>*arr = ...</code> is making the first assignment moot. You probably want <code>strcpy</code> instead of the second assignment."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573028284, "post_id": 58725623, "comment_id": 103742928, "body": "Also please don&#39;t use pointer arithmetic for what is essentially arrays. Instead of <code>*arr</code> use <code>arr[0]</code>. And <code>*arr+0</code> doesn&#39;t do anything useful."}, {"owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573028539, "post_id": 58725623, "comment_id": 103743045, "body": "Unfortunately I get used to it coz at my Uni they excluded [ ] from codes when we gives our assignments and I needed to use only pointers arithmetics even when we got ****arr :&#39;)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573028678, "post_id": 58725623, "comment_id": 103743104, "body": "That&#39;s academics for you... :) Using &quot;array&quot; like syntax with <code>[]</code> generally makes the code easier to read and understand, and therefore also to maintain."}], "tags": [], "owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1573028317, "last_edit_date": 1573028317, "creation_date": 1573027880, "answer_id": 58725623, "question_id": 58725477, "link": "https://stackoverflow.com/questions/58725477/how-do-you-find-the-length-of-columns-in-a-2d-array-using-double-pointers/58725623#58725623", "title": "How do you find the length of columns in a 2D array using double pointers?", "body": "<p>Here you got a sample:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main(void) {\n  char **arr;\n  arr=malloc(2*sizeof(char*));\n  *arr=malloc(20*sizeof(char));\n  strcpy(*arr,\"Hello World\");\n  int len=strlen((*arr+0));\n  printf(\"%s %d\",*arr,len); //output Hello World 11\n  return 0;\n}\n</code></pre>\n\n<p>When you wrote it like this:</p>\n\n<pre><code>strlen(*(list+listPos));\n</code></pre>\n\n<p>You tried to acces value from array of strings and just adress from string not its value.</p>\n"}], "owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573028317, "creation_date": 1573027118, "question_id": 58725477, "link": "https://stackoverflow.com/questions/58725477/how-do-you-find-the-length-of-columns-in-a-2d-array-using-double-pointers", "title": "How do you find the length of columns in a 2D array using double pointers?", "body": "<p>Hello for my program I need to find the length of words stored using double char pointers to make a sort of 2D array. Whenever I try to use <code>strlen</code> or <code>sizeof(arr)/sizeof(arr[0])</code> it returns a massive number instead of the amount of characters that each column has stored(the size of the strings). I think that this may have something to do with null pointers but I'm not sure how I would go about fixing that if it were the case. </p>\n\n<p>These are the two lines of code I am using to try and determine the sizes of the strings. The first one also forces me to restart my terminal as ctrl+c won't even stop it. The second just returns a very very large number when I print it.</p>\n\n<pre><code>int wordlength = sizeof(*(list+listPos))/sizeof(*(*(list+listPos)));\n\nint wordlength = strlen(*(list+listPos));\n</code></pre>\n"}, {"tags": ["ios", "c", "objective-c", "crash"], "comments": [{"owner": {"reputation": 20658, "user_id": 344733, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5edfaa616df6d3cef8581b317f6b0aa0?s=128&d=identicon&r=PG", "display_name": "Andrew Madsen", "link": "https://stackoverflow.com/users/344733/andrew-madsen"}, "edited": false, "score": 0, "creation_date": 1573066103, "post_id": 58725164, "comment_id": 103763524, "body": "Can you provide more detail about what exactly you&#39;re trying to accomplish? For example: what specific kind of crash are you expecting to catch? Are you expecting to recover from the crash, or is this just for crash reporting?"}, {"owner": {"reputation": 50374, "user_id": 568283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120ceee2dc40d539b9983265a2e0a2f8?s=128&d=identicon&r=PG", "display_name": "CRD", "link": "https://stackoverflow.com/users/568283/crd"}, "edited": false, "score": 0, "creation_date": 1573071686, "post_id": 58725164, "comment_id": 103765819, "body": "For anybody to be able to help you will need to provide more details, you can edit your question to do that (or delete this one and start a new one). Consider adding code fragments showing how you use <code>NSSetUncaughtExceptionHandler</code> and <code>signal()</code>, make it clear what signals you are catching. Provide details on the actual &quot;C function&quot; crash you are getting that you can&#39;t catch. Say what happens when you run your code under the debugger, does it also fail to catch the crash?  Etc. With those details someone might be able to help you."}], "answers": [{"tags": [], "owner": {"reputation": 2445, "user_id": 288405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acea97b0bc1f223b24db816ab3dd8e46?s=128&d=identicon&r=PG", "display_name": "Mattie", "link": "https://stackoverflow.com/users/288405/mattie"}, "is_accepted": false, "score": 1, "last_activity_date": 1573485651, "creation_date": 1573485651, "answer_id": 58804126, "question_id": 58725164, "link": "https://stackoverflow.com/questions/58725164/how-can-i-get-a-c-function-crash-in-ios/58804126#58804126", "title": "How can I get a C function crash in iOS\uff1f", "body": "<p>Intercepting crashing events on Apple platforms is not straight-forward. <code>signal</code> can be used to capture many event types, but there are some kinds of terminations that will be missed when using just signals. The mach exception facility (non to be confused with runtime exceptions) can be used to capture more types of events. Technically, <code>NSSetUncaughtExceptionHandler</code> does not capture crashes, just the details of uncaught Objective-C exceptions. It does not capture uncaught C++ exceptions, even though under the hood ObjC exceptions are built on top of C++.</p>\n\n<p>Annoyingly, you really cannot rely on just one system. I've found the POSIX signal facilities on Apple platforms to be problematic. But, because of some limitations in how mach exceptions work, using both will get you the most coverage.</p>\n\n<p>Now, C functions are not really special or distinct from ObjC methods. If you are missing a crash, it's likely due to the nature of the crash itself, or how you are instrumenting your process. I'd need to see details about both to give you better information. If you can, please update your question with more details.</p>\n\n<p>You might also be interested in an open source project I work on that is specifically designed to be the core of a crash reporting system. Feel free to consult the code and/or try it out. <a href=\"https://github.com/ChimeHQ/Impact\" rel=\"nofollow noreferrer\">https://github.com/ChimeHQ/Impact</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12302391, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t1etzdjhYTs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSyimawqnAV1Y7-U5CeQeGSkMMBg/photo.jpg?sz=128", "display_name": "user12302391", "link": "https://stackoverflow.com/users/12302391/user12302391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573485651, "creation_date": 1573025686, "last_edit_date": 1573030744, "question_id": 58725164, "link": "https://stackoverflow.com/questions/58725164/how-can-i-get-a-c-function-crash-in-ios", "title": "How can I get a C function crash in iOS\uff1f", "body": "<p>We usually use <code>NSSetUncaughtExceptionHandler</code> or <code>signal</code> to catch an Objective-C crash, but I find it can't catch a C function crash. So how can I catch a C function crash?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1573024554, "post_id": 58724860, "comment_id": 103741360, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Once you&#39;ve done that, then please edit your question to include information about the program you show, how it works, how it doesn&#39;t work, what input you have, what output you get and what you expected."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573024577, "post_id": 58724860, "comment_id": 103741376, "body": "Also please read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1573024676, "post_id": 58724860, "comment_id": 103741423, "body": "Read the documentation of <code>printf</code> and <code>fprintf</code>. You also need to check if <code>fopen</code> returns <code>NULL</code> which means that the file could not be opened. And you need to indent your code properly so it is readable."}], "answers": [{"tags": [], "owner": {"reputation": 219, "user_id": 8198361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6261d06afb1d50c3759e956bf36438f?s=128&d=identicon&r=PG", "display_name": "Lily AB", "link": "https://stackoverflow.com/users/8198361/lily-ab"}, "is_accepted": false, "score": 0, "last_activity_date": 1573066045, "creation_date": 1573066045, "answer_id": 58736688, "question_id": 58724860, "link": "https://stackoverflow.com/questions/58724860/reading-from-text-file-and-using-data-in-c/58736688#58736688", "title": "reading from text file and using data in c", "body": "<ul>\n<li><code>array1</code> and <code>array2</code>are declared to hold 12 elements each\ni.e.elements numbered from 0 to 11(total 12).The <code>for</code> loops need to\naccommodate this fact.`</li>\n<li><code>fprintf</code> requires three arguments <code>int fprintf(FILE *fptr, const\nchar *str, ...);</code></li>\n</ul>\n\n<p>Please take notice of the comments posted by @Some programmer dude and @Jabberwocky</p>\n\n<p>Implementing the corrections your code should look like this......have placed comments where I made changes.....hope they are helpful....</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{   \n  FILE *file1;\n  FILE *file2;\n\n  file1=fopen(\"data.txt\",\"w\"); \n  int array1[12],i;\n\n  if(file1 != NULL){\n    for(i=0;i&lt;12;i++){//i needs to be less than 12\n      scanf(\"%d\",&amp;array1[i]);\n      fprintf(file1,\"%d\\n\",array1[i]);//fprintf needs three arguments\n    }\n  }\n\n  fclose(file1);\n\n  file2=fopen(\"data.txt\",\"r\");\n  int array2[12]; \n  if(file2 != NULL){ //to get all the values inthe text file\n    for(i=0;i&lt;12;i++){//i needs to be less than 12\n      fscanf(file2,\"%d\",&amp;array2[i]);\n      printf(\"%d\\n\",array2[i]);\n    }\n  }\n  fclose(file2);\n}\n</code></pre>\n\n<p>I will leave error handling (if the file fails to open) as an exercise for you.</p>\n"}], "owner": {"reputation": 1, "user_id": 12330218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7064376b900ec262530a36c395194f95?s=128&d=identicon&r=PG&f=1", "display_name": "shakiiir", "link": "https://stackoverflow.com/users/12330218/shakiiir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573066045, "creation_date": 1573024426, "last_edit_date": 1573024489, "question_id": 58724860, "link": "https://stackoverflow.com/questions/58724860/reading-from-text-file-and-using-data-in-c", "title": "reading from text file and using data in c", "body": "<p>to write arrray and structures in a given text file and retrieving it to us in calculation\ncan somebody help me with a sample code\nthis is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{   FILE *file1;\n    FILE *file2;//declaring two file pointers file1 to read,and file2 to read\n\n    file1=fopen(\"data.txt\",\"w\"); //creating a new text file in writing mode\n    int array1[12],i;//declared array1 which we will input the data in \n\n\n    for(i=0;i&lt;=12;i++){\n     scanf(\"%d\",&amp;array1[i]);//i am trying to use a for loop to input elements into arrar\n      fprintf(file1,array1);//am trying to write the gotten values into file1\n    }\n\n    fclose(file1);\n\n    file2=fopen(\"data.txt\",\"r\");//in read mode a file2 poninter\n    int array2[12]; //another array of same number of elements to store the data read from file\n    while(!feof(file2)){ //to get all the values inthe text file\n    for(i=1;1&lt;=12;i++){\n    fscanf(file2,\"%d\",&amp;array2[i]);//from here i am just confused\n    printf(\"%d\",array2[12]);\n    }\n\n    }\n    fclose(file2);\n\n}\n</code></pre>\n"}, {"tags": ["c", "type-conversion"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1573023333, "post_id": 58724535, "comment_id": 103740862, "body": "This warning should almost always be considered as an error."}, {"owner": {"reputation": 19, "user_id": 11935263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g1FWfg51_4E/AAAAAAAAAAI/AAAAAAAAAAU/PGRmpXIePMg/photo.jpg?sz=128", "display_name": "Hema Krish", "link": "https://stackoverflow.com/users/11935263/hema-krish"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1573023814, "post_id": 58724535, "comment_id": 103741060, "body": "can you please tell what is error and what is warning? how you say warning is consider to be error."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1573024047, "post_id": 58724535, "comment_id": 103741147, "body": "Error: you did something completely wrong and the program cannot be compiled. Warning: you did something wrong but you might get away with it if you know exactly what you&#39;re doing."}, {"owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "edited": false, "score": 0, "creation_date": 1573024402, "post_id": 58724535, "comment_id": 103741295, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19088153/addresses-of-two-char-pointers-to-different-string-literals-are-same\">Addresses of two char pointers to different string literals are same</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1573025429, "post_id": 58724535, "comment_id": 103741751, "body": "&#39;KP Creations&#39; asked the same, an hour or so ago."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11935263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g1FWfg51_4E/AAAAAAAAAAI/AAAAAAAAAAU/PGRmpXIePMg/photo.jpg?sz=128", "display_name": "Hema Krish", "link": "https://stackoverflow.com/users/11935263/hema-krish"}, "edited": false, "score": 0, "creation_date": 1573023448, "post_id": 58724567, "comment_id": 103740899, "body": "both   a and b variables print the same address  .How it is possible?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 19, "user_id": 11935263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g1FWfg51_4E/AAAAAAAAAAI/AAAAAAAAAAU/PGRmpXIePMg/photo.jpg?sz=128", "display_name": "Hema Krish", "link": "https://stackoverflow.com/users/11935263/hema-krish"}, "edited": false, "score": 0, "creation_date": 1573023514, "post_id": 58724567, "comment_id": 103740929, "body": "@HemaKrish Only one copy of <code>aa</code> is stored as part of read-only section."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1573023478, "last_edit_date": 1573023478, "creation_date": 1573023097, "answer_id": 58724567, "question_id": 58724535, "link": "https://stackoverflow.com/questions/58724535/what-happed-whene-aa-string-assign-to-a-integer-variable/58724567#58724567", "title": "what happed whene &quot;aa&quot; string assign to a integer variable?", "body": "<blockquote>\n  <p>the value is 134513904 from both variables what is this</p>\n</blockquote>\n\n<p>It is the address of location where string <code>aa</code> is stored. That is only one copy of <code>aa</code> is stored into 'ready-only' section and its address is stored in <code>a</code> and <code>b</code> variables.</p>\n\n<p>Since <code>int</code> are not supposed to hold the address, compiler is throwing warning.</p>\n"}], "owner": {"reputation": 19, "user_id": 11935263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g1FWfg51_4E/AAAAAAAAAAI/AAAAAAAAAAU/PGRmpXIePMg/photo.jpg?sz=128", "display_name": "Hema Krish", "link": "https://stackoverflow.com/users/11935263/hema-krish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573023478, "creation_date": 1573022962, "last_edit_date": 1573023338, "question_id": 58724535, "link": "https://stackoverflow.com/questions/58724535/what-happed-whene-aa-string-assign-to-a-integer-variable", "title": "what happed whene &quot;aa&quot; string assign to a integer variable?", "body": "<p>i got below code , i got same value from both variable but assignment b is throw a error and what is the value is it after print ,the  value is 134513904 from both variables what is this   </p>\n\n<pre><code>int a=(int)\"aa\",b=\"aa\";\nprintf(\"%d,%d\",a,b);\n\nif.c: In function \u2018main\u2019:\nif.c:6:19: warning: initialization makes integer from pointer without a cast [enabled by default]\n cast [enabled by default]\n int a=(int)\"aa\",b=\"aa\";\n                   ^\n134513904,134513904\n shell returned 19\n</code></pre>\n\n<p>Then:\n  printf(\"%s:%s\",a,b);\n  it print string =>aa:aa</p>\n"}, {"tags": ["c++", "c", "libevent"], "answers": [{"tags": [], "owner": {"reputation": 3425, "user_id": 328260, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/544572df2af15994f8a616b08bb73015?s=128&d=identicon&r=PG", "display_name": "azat", "link": "https://stackoverflow.com/users/328260/azat"}, "is_accepted": true, "score": 2, "last_activity_date": 1573035905, "creation_date": 1573035905, "answer_id": 58727952, "question_id": 58724399, "link": "https://stackoverflow.com/questions/58724399/does-libevent-allow-to-run-callback-for-timer-io-in-a-different-thread/58727952#58727952", "title": "Does libevent allow to run callback for timer/io in a different thread?", "body": "<blockquote>\n  <p>Is it legal for libevent to use such approach?</p>\n</blockquote>\n\n<p>So access to event/event_base can be done from multiple threads, in this case you need to enable threading support for libevent:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>evthread_use_pthreads(); // or similar\n</code></pre>\n\n<p>And later use <code>BEV_OPT_THREADSAFE</code> for <code>bufferevent</code> thread-safety.</p>\n\n<p>For more details take a look <a href=\"http://www.wangafu.net/~nickm/libevent-book/Ref1_libsetup.html#_locks_and_threading\" rel=\"nofollow noreferrer\">in the book</a>.</p>\n\n<p>And even though your approach should work after this modifications, it is not a good design choice. It will be way more better to create event workers (separate <code>event_base</code> + thread) and schedule your event (<code>event_add</code>) in the <code>event_base</code> of the background thread.</p>\n\n<blockquote>\n  <p>Android my test application just closes without any reasons.</p>\n</blockquote>\n\n<p>Need details.</p>\n"}], "owner": {"reputation": 915, "user_id": 1554370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df7c8e8dd040b0e89c1d97a7464c77e6?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1554370/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 58727952, "answer_count": 1, "score": 0, "last_activity_date": 1573035905, "creation_date": 1573022429, "last_edit_date": 1573022766, "question_id": 58724399, "link": "https://stackoverflow.com/questions/58724399/does-libevent-allow-to-run-callback-for-timer-io-in-a-different-thread", "title": "Does libevent allow to run callback for timer/io in a different thread?", "body": "<p>Due to some application reasons I need to run callback for timer/io events in a different thread. </p>\n\n<p>Example:</p>\n\n<pre><code>void EventLoop::createIOEvent(int fd, short kind, event_cb originalCallback, void* originalUserData) \n{\n    ...\n    const auto data{std::make_shared&lt;UserData&gt;(originalUserData, originalCallback, callbackExecutor)};\n    event* event{event_new(_eventBase, fd, kind, EventLoop::asyncCall, data.get())};\n    event_add(event, nullptr);\n    ...\n}\n\nvoid EventLoop::asyncCall(int fd, short kind, void* data)\n{\n    const auto userData{*(reinterpret_cast&lt;UserData*&gt;(data))};\n    ExecutorWrapper(userData._callbackExecutor)\n        .addRunnable([=]() {\n            userData._originalCallback(fd, kind, userData._originalUserData);\n    })\n    .exec();\n }\n</code></pre>\n\n<p>Is it legal for libevent to use such approach?</p>\n\n<p>Note: it seems that all works fine on Macos and iOS but on Android my test application just closes without any reasons.</p>\n"}, {"tags": ["c", "function", "pointers", "multidimensional-array", "pointer-to-pointer"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1573022667, "post_id": 58724236, "comment_id": 103740596, "body": "<code>int *arr[]</code> is not a 2D array, it is an <i>array-of-pointers-to-int</i>. <code>int arr[x][y]</code> with <code>x &amp; y</code> are integer literals creates a 2D array. (which on access will be converted to a pointer to the first element (which is a pointer the first 1D array, e.g. <i>a pointer to array of int[y]</i>) which is not the same as <code>int**</code> (which is simply <i>a pointer to pointer to int</i>)."}, {"owner": {"reputation": 43, "user_id": 6628054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LNUbX.jpg?s=128&g=1", "display_name": "Alonso", "link": "https://stackoverflow.com/users/6628054/alonso"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573023628, "post_id": 58724236, "comment_id": 103740976, "body": "@David Rankin so int *arr[] is not 2D but char array is?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1573023814, "post_id": 58724236, "comment_id": 103741061, "body": "<code>type *arr[]</code> is an <i>array of pointers</i>. What follows, e.g. <code>char *arr[] = {&quot;one&quot;, &quot;two&quot;};</code> must be pointers. For <code>int *arr[];</code> you would need for instance <code>int a[] = {1, 2, 3);</code> and <code>int b[] = {3, 4, 5};</code>, then <code>int *arr[] = {a, b};</code> as both <code>a</code> and <code>b</code> will be converted to pointers on access. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a>. Also a 2D array is actually an array of 1D arrays. You can represent as <code>int arr[x][y];</code> or <code>int (*arr)[y];</code> So <code>type (*arr)[y];</code> is a <i>pointer to array</i>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1573024218, "post_id": 58724236, "comment_id": 103741222, "body": "This answer may help further <a href=\"https://stackoverflow.com/questions/57839278/converting-array-of-pointers-to-double-pointer/57839593#57839593\">Converting array of pointers to double pointer</a>. There are many more duplicates, some better than others, unfortunately the SO &quot;Related&quot; links on the right side of the page do not do a good job finding them."}, {"owner": {"reputation": 43, "user_id": 6628054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LNUbX.jpg?s=128&g=1", "display_name": "Alonso", "link": "https://stackoverflow.com/users/6628054/alonso"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573024563, "post_id": 58724236, "comment_id": 103741368, "body": "@DavidRankin-ReinstateMonica That makes more sense, but in the case of an array of pointers int *arr[] what happens with the numbers inside {1,2} and {3, 4}? They are not referenced at all it seems."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1573024626, "post_id": 58724236, "comment_id": 103741399, "body": "Have a look at <a href=\"https://stackoverflow.com/questions/58151924/what-is-the-difference-between-pt-in-int-pt2-and-pt-in-int-pt\">what is the difference between *pt in int (*pt)[2&#93; and pt in int *pt?</a>, the answers there may be more instructive. There are still more complete answers I&#39;m looking for, but that question is good."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1573026303, "post_id": 58724236, "comment_id": 103742121, "body": "Here is one more that will help (read the comments too) <a href=\"https://stackoverflow.com/questions/58497885/processing-the-columns-of-a-multidimensional-array-in-c\">Processing the columns of a multidimensional array in C</a>. You can find many more questions and answers, but there isn&#39;t one specific search likely to find them all given how different problems are described in the original title of the question. The problems all boil down to understanding how <i>array / pointer</i> conversion works.  That&#39;s section 6.3.2.1 linked earlier. It&#39;s worth getting a handle on now, it will save you hours later."}, {"owner": {"reputation": 43, "user_id": 6628054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LNUbX.jpg?s=128&g=1", "display_name": "Alonso", "link": "https://stackoverflow.com/users/6628054/alonso"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573044353, "post_id": 58724236, "comment_id": 103751491, "body": "@DavidRankin-ReinstateMonica thanks for all the links will make sure to check them all. The main confusion for me was between 2D array initialization and the array of pointers. Another thing that I don&#39;t understand and maybe the links you provided have it, why is the <code>char</code> array converting directly into pointers vs the <code>int</code> array which needs variables <code>a</code> and <code>b</code> to point to the two integer arrays?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1573057605, "post_id": 58724236, "comment_id": 103759234, "body": "<code>int *arr[] = {{1,3},{4,5,6}};</code> does not initialize an array of pointers. e.g. <code>{1, 2}</code> on its own is not a pointer. You can make it a pointer using a <i>compound literal</i>, (c99+) e.g. <code>int *arr[] = { (int[]){1,2}, (int[]){3,4,5} };</code> and it you want an exercise using the various pointer/array notations to access all elements, you can do <code>printf (&quot;%d %d %d %d %d\\n&quot;, **arr, (*arr)[1], *arr[1], *(*(arr + 1) + 1), arr[1][2]);</code>See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.2.5\" rel=\"nofollow noreferrer\">6.5.2.5 Compound literals</a> for further information on that type of initialization."}], "owner": {"reputation": 43, "user_id": 6628054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LNUbX.jpg?s=128&g=1", "display_name": "Alonso", "link": "https://stackoverflow.com/users/6628054/alonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "closed_date": 1573023475, "answer_count": 0, "score": 1, "last_activity_date": 1573024797, "creation_date": 1573021597, "question_id": 58724236, "link": "https://stackoverflow.com/questions/58724236/passing-2d-integer-array-as-double-pointer-to-a-function-vs-2d-string-array-as-d", "closed_reason": "Duplicate", "title": "Passing 2D Integer Array as double-pointer to a function VS 2D String Array as double-pointer doesn&#39;t behave the same?", "body": "<p>Hi I am trying to understand the difference between passing a 2d array of type <code>char</code> VS type <code>int</code> to a function as a double-pointer <code>func(int **ptr)</code> parameter. The problem is that it behaves differently. Below I will show two examples for type <code>char</code> and <code>int</code> using PythonTutor for C.</p>\n\n<p>I looked at the whole internet and asked some friends but couldn't find an answer to the behavior.</p>\n\n<p>Example with type char:\nint func(char **arr)</p>\n\n<pre><code>{\n  printf(\"%d\", **arr);  \n}\nint main() \n{\n  char *arr[] = {\"char1\",\"char2\"};\n  return 0;\n}\n</code></pre>\n\n<p>Example with type int:</p>\n\n<pre><code>int func(int **arr)\n{\n  printf(\"%d\", **arr);  \n}\nint main() \n{\n  int *arr[] = {{1,3},{4,5,6}};\n  return 0;\n}\n</code></pre>\n\n<p>One thing to note is that is not important what the func body is doing with the double-pointer passed to it, the problem i am trying to understand is why the double-pointer in the case of 2D char array is pointing to a pointer to integer while the 2D int array is not pointing to the integers within the arrays? </p>\n\n<p>Below is the visualization from pythontutor for both cases.</p>\n\n<p>Example with type char 2D array: <a href=\"http://pythontutor.com/c.html#mode=display\" rel=\"nofollow noreferrer\">http://pythontutor.com/c.html#mode=display</a></p>\n\n<p>Example with type int 2D array: <a href=\"http://pythontutor.com/c.html#mode=display\" rel=\"nofollow noreferrer\">http://pythontutor.com/c.html#mode=display</a></p>\n\n<p>Also provide snapshot of the final result:</p>\n\n<p>Example with type char 2D array:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5CKNr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5CKNr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Example with type int 2D array:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hjk0y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hjk0y.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1573040792, "post_id": 58724049, "comment_id": 103749608, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/201938/discussion-on-question-by-pranay-katyal-how-to-fix-structuredfunctions-not-call\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1573040617, "post_id": 58729333, "comment_id": 103749480, "body": "The formatting in your answer has it&#39;s own living. It&#39;s better to just ` or indent with 4 spaces rather then <code>&lt;pre&gt;&lt;code&gt;</code> <code>&lt;\\pre&gt;&lt;\\code&gt;</code>, because you can miss one <code>&lt;\\pre&gt;</code> as you just did. I typically after enumeration insert empty <code>[]()</code> and then code, because in enumeration code blocks should be indented with 8 spaces (not intuitive at first). I can try to edit the post. Och, and I don&#39;t agree with point 2."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1573042101, "post_id": 58729333, "comment_id": 103750317, "body": "Re 2.: What extra type checks should a <code>typedef</code> allow that is not possible without?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1573042284, "post_id": 58729333, "comment_id": 103750407, "body": "These are general programming hints. How are they related to the question and which one addresses the problem?"}, {"owner": {"reputation": 7801, "user_id": 102238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0650f481b609a9de7f93ea4dc676fdf5?s=128&d=identicon&r=PG", "display_name": "ChrisBD", "link": "https://stackoverflow.com/users/102238/chrisbd"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1573043850, "post_id": 58729333, "comment_id": 103751238, "body": "@KamilCuk - thanks for your input, for some reason the copy and paste of code into a code block didn&#39;t work and only the first line of the code appeared in the preview. If you can edit it correctly then be my guest."}, {"owner": {"reputation": 7801, "user_id": 102238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0650f481b609a9de7f93ea4dc676fdf5?s=128&d=identicon&r=PG", "display_name": "ChrisBD", "link": "https://stackoverflow.com/users/102238/chrisbd"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1573044288, "post_id": 58729333, "comment_id": 103751465, "body": "@Gerhardh - yes they are general points, but should be learned or in this case taught at an early stage. I would like Pranay to actually learn something here rather than just copy paste a solution. Quite a few of these points cause issues here - mixing data types, relying on compiler decisions and not capturing unexpected values in a switch statement are just a start."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1573044516, "post_id": 58729333, "comment_id": 103751584, "body": "I agree that the authour should not get a drop in solution but also learn something. What I am missing is the part actually answering the question. Or at least it should not be hidden in a comment in the code."}, {"owner": {"reputation": 33, "user_id": 12309475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BbI4CpGgC1s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbuhP-zoDl87VS8tWXksHwkOUPSQ/photo.jpg?sz=128", "display_name": "Pranay Katyal", "link": "https://stackoverflow.com/users/12309475/pranay-katyal"}, "edited": false, "score": 0, "creation_date": 1573053479, "post_id": 58729333, "comment_id": 103756820, "body": "@ChrisBD thanks a lot for this informative answer, also yes i think our teachers aren&#39;t great, i am actually one of the best students and even the teacher herself couldn&#39;t solve this question when i asked her,  i thought to remove switch case and let the code run first and yes i will definately look into the (year == s[i]yoj code),,  also we werent taught about anything like typedef or the #define keywords that you used , i will try to learn about them and apply and see if i get my desired answer  ,  thankss"}, {"owner": {"reputation": 33, "user_id": 12309475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BbI4CpGgC1s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbuhP-zoDl87VS8tWXksHwkOUPSQ/photo.jpg?sz=128", "display_name": "Pranay Katyal", "link": "https://stackoverflow.com/users/12309475/pranay-katyal"}, "edited": false, "score": 0, "creation_date": 1573055208, "post_id": 58729333, "comment_id": 103757894, "body": "@ChrisBD i editted the code just as you suggested , and it worked , thanks a lot"}], "tags": [], "owner": {"reputation": 7801, "user_id": 102238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0650f481b609a9de7f93ea4dc676fdf5?s=128&d=identicon&r=PG", "display_name": "ChrisBD", "link": "https://stackoverflow.com/users/102238/chrisbd"}, "is_accepted": true, "score": 0, "last_activity_date": 1573045482, "last_edit_date": 1573045482, "creation_date": 1573040350, "answer_id": 58729333, "question_id": 58724049, "link": "https://stackoverflow.com/questions/58724049/how-to-fix-structuredfunctions-not-calling/58729333#58729333", "title": "How to fix &#39;structuredfunctions not calling&#39;", "body": "<p>As you're learning C code I think that you should start off by taking on board a few standard working practices.\nIt's very evident that either your teacher hasn't really coded in a working environment or they are expecting you to spot the mistakes.\nI realise that there may be issues or restrictions due to your compiler, but here are some pointers that will help in future.</p>\n\n<p>Here are some pointers based on your code.</p>\n\n<ol>\n<li>Always initialise variables before use. If a variable can be null and that is not a valid value, check for null before use e.g. `char[] or pointer types. </li>\n<li>Use <code>typedef</code> for structure declarations, this will allow the compiler to determine incorrect use through type checking during compilation.  </li>\n<li>Use long, meaningful variable and function names as an aid to understand the code. </li>\n<li>Indentation with brackets e.g. <code>{</code> <code>}</code>, to make code easy to understand. </li>\n<li>Refrain from using literal values in code as this can lead to introduction of bugs at a later stage if a value is not changed in all cases through the code.</li>\n<li>Function parameters should be definitive in type - this makes code portable between compilers, environments and easier to understand.</li>\n<li>In for loops try to only use less than <code>&lt;</code> and greater than <code>&gt;</code> comparisons. </li>\n<li>In 'if' statements try to place non-assignable values on the left side as this will raise a compiler warning if you type <code>=</code> instead of <code>==</code>.</li>\n<li>Try and make functions re-entrant i.e. not reliant on global variables to determine their behaviour if possible, <code>void func(void)</code> should ring alarm bells. </li>\n<li>Be careful when using signed values such as <code>int</code> use <code>unsigned int</code> in preference UNLESS you know that a variable will be assigned values of less than 0. </li>\n<li>Declaring function parameters as <code>const</code> and then using local function variables as copies (if you wish to change their value) will make code easier to debug. </li>\n<li>Switch statements should always include a <code>default:</code> to handle undetermined values.</li>\n</ol>\n\n<p></p>\n\n<pre><code>struct stdnt /* REVIEW COMMENT: use typedef */\n{\n    char stName[100]; /* REVIEW COMMENT: non-literal value for 100 */\n    char stRNo[100]; /* REVIEW COMMENT: Based upon later usage should this be unsigned int rather than char[] type */\n    char Dept[50];\n    char crse[50];\n    int YoJ[4]; /* REVIEW COMMENT: this is an array of int. Either use int or char[4] */\n}s[2];          /* REVIEW COMMENT: separate out declaration for clarity and use a meaningful name */\n</code></pre>\n\n<p>I'd suggest that you change it to this</p>\n\n<pre><code>#define TEXT_LENGTH_LONG 100\n#define TEXT_LENGTH_SHORT 50\n#define NUMBER_OF_STUDENTS 2\n\ntypedef struct\n{\n    char Name[NAME_LENGTH];\n    unsigned int RollNumber;\n    char Department[TEXT_LENGTH_SHORT];\n    char Course[TEXT_LENGTH_SHORT];\n    unsigned int YearOfJoining;\n}student_t;\n\nstudent_t students[NUMBER_OF_STUDENTS];\n</code></pre>\n\n<p>This function code has some issues.</p>\n\n<pre><code>void stRNm(q)/* REVIEW COMMENT: non-definitive declaration can cause confusion. Unclear function name and parameter */\n{\n  int i;\n\n    for(i=0;i&lt;=1;i++)       /* REVIEW COMMENT: use of literal value  makes maintenance more difficult and can introduce bugs if the array size is changed but this is missed */\n    {if(q == s[i].stRNo)    /* REVIEW COMMENT: possible type mismatch in comparison - comparing int or char[] ?*/\n        {\n        printf(\"Student Name = %s\\t\",s[i].stName); \n        printf(\"Student Year of Joining = %d\\t\",s[i].YoJ);\n        printf(\"Student Department = %s\\t\",s[i].Dept);\n        printf(\"Student Course = %s\\n\",s[i].crse);\n        }\n    }\n}\n</code></pre>\n\n<p>becomes </p>\n\n<pre><code>void PrintStudentInfo(const unsigned int rollNumOfStudent)/* Declaring rollNumOfStudent as const will give it compiler protection against being assigned to */\n{\n    int i;\n\n    for(i=0;i&lt;NUMBER_OF_STUDENTS;i++)\n    {\n        if(rollNumOfStudent == students[i].RollNumber) \n        {\n            printf(\"Student Name = %s\\t\",students[i].Name);\n            printf(\"Student Year of Joining = %d\\t\",students[i].YearOfJoining);\n            printf(\"Student Department = %s\\t\",students[i].Department);\n            printf(\"Student Course = %s\\n\",students[i].Course);\n        }\n    }\n}\n</code></pre>\n\n<p>Okay this is just a start.\nThere are issues in your main function relating to what I've mentioned already that are causing the odd behaviour.</p>\n\n<p>C is a language that is so loosely defined that it is very easy to introduce bugs due to shortcuts taken in coding. \nBe pedantic.\nDon't let the compiler make the decisions.\nBe sure that the data types of variables are what you want rather than what the compiler determines. </p>\n\n<p><strong>Edit</strong>\nTaking into account my comments about data types. \nThis line <code>if(year == s[i].YoJ)</code> is performing the following <code>if(int == int[4])</code></p>\n"}], "owner": {"reputation": 33, "user_id": 12309475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BbI4CpGgC1s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbuhP-zoDl87VS8tWXksHwkOUPSQ/photo.jpg?sz=128", "display_name": "Pranay Katyal", "link": "https://stackoverflow.com/users/12309475/pranay-katyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 58729333, "answer_count": 1, "score": -2, "last_activity_date": 1573045482, "creation_date": 1573020642, "last_edit_date": 1573025191, "question_id": 58724049, "link": "https://stackoverflow.com/questions/58724049/how-to-fix-structuredfunctions-not-calling", "title": "How to fix &#39;structuredfunctions not calling&#39;", "body": "<p>So I wrote this code as a part of my assignment like so, we are still learning C language and I am just unable to correct this one. We have to make a code on writing a function to print the names of all the students that joined in a particular year.</p>\n\n<p>It runs the code till <code>switch case</code>, but doesn't work further.  </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstruct stdnt\n{\n    char stName[100];\n    char stRNo[100];\n    char Dept[50];\n    char crse[50];\n    int YoJ[4];\n}s[2];\n\nvoid stYr(p)\n{\n   printf(\"Student Name = %s\\t\",s[p].stName);\n}\n\nvoid stRNm(q)// q RNm\n{\n  int i;\n\n    for(i=0;i&lt;=1;i++)\n    {if(q == s[i].stRNo)\n        {\n        printf(\"Student Name = %s\\t\",s[i].stName);\n        printf(\"Student Year of Joining = %d\\t\",s[i].YoJ);\n        printf(\"Student Department = %s\\t\",s[i].Dept);\n        printf(\"Student Course = %s\\n\",s[i].crse);\n        }\n    }\n}\nint main()\n{\n    int i;\n    int year;\n    int RNm;\n    int ch;\n    printf(\"Please Enter the details of 2 Students.\\n\");\n    for(i=0;i&lt;=1;i++)\n    {\n        printf(\"Enter Name of Student %d:\\n\",i+1);\n        scanf(\"%s\",s[i].stName);\n        printf(\"Enter Department of Student %d:\\n\",i+1);\n        scanf(\"%s\",s[i].Dept);\n        printf(\"Enter Year of Joining of Student %d:\\n\",i+1);\n        scanf(\"%d\",s[i].YoJ);\n        printf(\"Enter Roll Number of Student %d:\\n\",i+1);\n        scanf(\"%s\",s[i].stRNo);\n        printf(\"Enter Course of Student %d:\\n\",i+1);\n        scanf(\"%s\",s[i].crse);\n    }\n\n\n    printf(\"Enter 1 to Print the List of Student using Year.\\nEnter 2 to Search the details of student using Roll no.\\n\");\n    scanf(\"%d\",&amp;ch);\n    switch(ch)\n    {\n    case 1:\n\n        printf(\"Enter the Year:\\n\");\n        scanf(\"%d\",&amp;year);\n        for(i=0;i&lt;=1;i++)\n        {\n            if(year == s[i].YoJ)\n            {\n                stYr(i);\n            }\n        }\n      break;\n    case 2:\n\n        printf(\"Enter the roll number you want to search:\\n\");\n        scanf(\"%d\",&amp;RNm);\n        stRNm(RNm);\n        break;\n\n    }\n    return 0;\n\n}\n</code></pre>\n\n<p>the question is</p>\n\n<p>Create a structure to specify data on student given below : Roll number, Name, Department, Course, Year of Joining.</p>\n\n<p>Assume that there are not more than 450 students (i am trying to code for 2 firstly will make it for 450 once it works) </p>\n\n<p>also `</p>\n\n<ol>\n<li>write a function to print name of all the students who joined in a particular year.</li>\n<li>write another function to print the data of a student whose roll number is entered</li>\n</ol>\n\n<p>make switch cases .</p>\n\n<p><strong>OUTPUT i am getting :</strong></p>\n\n<p>Please enter the details of 2 students .<br>\nEnter Name of Student 1:<br>\nkatyal<br>\nEnter department :<br>\nMech<br>\nEnter Year of joining:<br>\n2019<br>\nEnter roll number:<br>\n1<br>\nEnter Course :<br>\nC<br>\nEnter Name of Student 2:<br>\nPranay<br>\nEnter department :<br>\nMech<br>\nEnter Year of joining:<br>\n2019<br>\nEnter roll number:<br>\n2<br>\nEnter Course :<br>\nC<br>\nEnter 1 to Print the List of student using year<br>\nEnter 2 to print details of student using roll number<br>\n1<br>\nEnter the year:<br>\n2019<br>\nProcess returned 0&lt;0x0> execution time 30.600s<br>\nPress any key to continue.  </p>\n\n<p><strong>Expected Output :</strong></p>\n\n<p>after the Year is entered after switch case, i expect the Function `stYr to get called and print the list of student with that Year as their Year of Joining</p>\n\n<p>similarly if roll number is entered i want the details of that student printed.</p>\n"}, {"tags": ["c", "linux", "sockets", "linux-kernel", "netlink"], "comments": [{"owner": {"reputation": 820, "user_id": 1735458, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45ad4e19f178f150d44ef1e74189daa7?s=128&d=identicon&r=PG", "display_name": "Yd Ahhrk", "link": "https://stackoverflow.com/users/1735458/yd-ahhrk"}, "edited": false, "score": 0, "creation_date": 1573082785, "post_id": 58723684, "comment_id": 103769660, "body": "I do believe that&#39;s the maximum. If you want to send more data, you can always fragment it."}, {"owner": {"reputation": 61, "user_id": 6290840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d2e9bb5a41be92b503c638ecd6836b7?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas Vijayan", "link": "https://stackoverflow.com/users/6290840/vikas-vijayan"}, "reply_to_user": {"reputation": 820, "user_id": 1735458, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45ad4e19f178f150d44ef1e74189daa7?s=128&d=identicon&r=PG", "display_name": "Yd Ahhrk", "link": "https://stackoverflow.com/users/1735458/yd-ahhrk"}, "edited": false, "score": 0, "creation_date": 1573456014, "post_id": 58723684, "comment_id": 103874627, "body": "Hi Yd Ahhrk, Thanks for the response. I have gone through some links but didn&#39;t find any relevant link that describes how we can fragment the big buffer into small ones. So can u please guide me through the relevant link? Or if u don&#39;t mind can u please explain. Thanks in advance"}], "owner": {"reputation": 61, "user_id": 6290840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d2e9bb5a41be92b503c638ecd6836b7?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas Vijayan", "link": "https://stackoverflow.com/users/6290840/vikas-vijayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1573035245, "creation_date": 1573018533, "last_edit_date": 1573035245, "question_id": 58723684, "link": "https://stackoverflow.com/questions/58723684/the-maximum-buffer-size-that-we-can-pass-using-netlink-and-page-size-influence-o", "title": "The maximum buffer size that we can pass using netlink and PAGE_SIZE influence on it", "body": "<p>I am working on an application (ARM platform) that uses netlink messages to pass a buffer of size 8k to kernel space driver to fetch some data from the driver.  I have allocated the required memory for the nl message using function <code>nlmsg_alloc_size()</code>, but when the buffer size <strong>exceeds size of 4k</strong>, we are not getting data from driver, even though the driver is able to receive the netlink command with buffer.</p>\n\n<p>So we checked the kernel source and found that the buffer size is limited to <strong>4096</strong> for <strong>ARM</strong> in kernel.</p>\n\n<p>So is it possible to send netlink message with more than 4k buffer? If so, please suggest a solution.</p>\n"}, {"tags": ["c", "if-statement", "casting"], "comments": [{"owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 2, "creation_date": 1573017336, "post_id": 58723491, "comment_id": 103738916, "body": "string in an integer variable?"}, {"owner": {"reputation": 1, "user_id": 11479321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EX7yVgWyKaE/AAAAAAAAAAI/AAAAAAAAJkM/nlpF-uhWfFY/photo.jpg?sz=128", "display_name": "MP Creations", "link": "https://stackoverflow.com/users/11479321/mp-creations"}, "reply_to_user": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 0, "creation_date": 1573017692, "post_id": 58723491, "comment_id": 103739016, "body": "@Inian yes string stored in integer variable"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1573017744, "post_id": 58723491, "comment_id": 103739030, "body": "it isn&#39;t. You have undefined behaviour. Everything your program does is meaningless."}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1573017860, "creation_date": 1573017860, "answer_id": 58723582, "question_id": 58723491, "link": "https://stackoverflow.com/questions/58723491/while-giving-string-value-to-integer-what-is-happening/58723582#58723582", "title": "while giving string value to integer what is happening?", "body": "<p>The following assigns a <em>pointer</em> (not a string) to <code>s</code>:</p>\n\n<pre><code>const char *s = \"navven\";\n</code></pre>\n\n<p>That means the following assigns a <em>pointer</em> (not a string) to <code>a</code>:</p>\n\n<pre><code>int a = \"naveen\";\n</code></pre>\n\n<p>Computers don't really see a difference between a pointer and number. They're both things that fit in their registers. And some people take advantage of that fact. So while the compiler warns you that you are doing something wrong, it still lets you treat the pointer as a number.</p>\n\n<p>So <code>a</code> is ends up with the value of the pointer if it were an <code>int</code>. That's not safe to do. Not quite. While you can't use an <code>int</code> safely, you can use an <code>intptr_t</code> safely.</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void) {\n    const char *p1 = \"naveen\";\n    printf(\"%p %s\\n\", p1, p1);\n\n    intptr_t i = (intptr_t)p1;\n    printf(\"0x%\" PRIxPTR \"\\n\", i);\n\n    const char *p2 = (const char*)i;\n    printf(\"%p %s\\n\", p2, p2);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0x51ee878764 naveen\n0x51ee878764\n0x51ee878764 naveen\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11479321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EX7yVgWyKaE/AAAAAAAAAAI/AAAAAAAAJkM/nlpF-uhWfFY/photo.jpg?sz=128", "display_name": "MP Creations", "link": "https://stackoverflow.com/users/11479321/mp-creations"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573017860, "creation_date": 1573017210, "last_edit_date": 1573017594, "question_id": 58723491, "link": "https://stackoverflow.com/questions/58723491/while-giving-string-value-to-integer-what-is-happening", "title": "while giving string value to integer what is happening?", "body": "<p>In my C program i assign a string in one integer variable and i print with percentage %s it will print that string with warning integer to pointer without cast and print with %d it print 134513904 then i change my string value and print with %d \"134513904\" is printing what is this value and how integer variable storing a string value in int variable?</p>\n\n<pre><code>enter code here\n         #include&lt;stdio.h&gt;\n            main()\n{\n        int a=\"naveen\";\n        printf(\"%d\\n\",a);\n        printf(\"\\n%s\\n\",a);\n        if(\"naveen\")\n        {\n                printf(\"hi\");\n       }\nint_point.c: In function \u2018main\u2019:\n</code></pre>\n\n<p>int_point.c:22:8: warning: initialization makes integer from pointer without a cast [enabled by default]\n  int a=\"naveen\";\n        ^\nint_point.c:24:2: warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 2 has type \u2018int\u2019 [-Wformat=]\n  printf(\"\\n%s\\n\",a);\n  ^\n134513920</p>\n\n<p>naveen\nhi</p>\n"}, {"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": true, "score": 3, "last_activity_date": 1573018403, "last_edit_date": 1573018403, "creation_date": 1573018024, "answer_id": 58723606, "question_id": 58723455, "link": "https://stackoverflow.com/questions/58723455/is-there-any-benefit-to-this-combination-of-pointers-and-loops/58723606#58723606", "title": "Is there any benefit to this combination of pointers and loops?", "body": "<p>The simplest approach, is always the best approach:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for (int i=0; i&lt;ny*nx; i++) {\n    C[i] = A[i] + B[i];\n}\n</code></pre>\n\n<p>This will be faster than the first solution. The problem with splitting the matrix up by row, is that the vectoriser will do:</p>\n\n<ul>\n<li>process line in batches of 32bytes (size of YMM)</li>\n<li>Process the remaining handful of values at the end of the line.</li>\n<li>Now repeat for each line!</li>\n</ul>\n\n<p>If however you do it with a single loop, the code generated will be:</p>\n\n<ul>\n<li>process all data in batches of 32bytes (size of YMM)</li>\n<li>Process the remaining handful of values at the end of the matrix that don't align to 32byte blocks.</li>\n</ul>\n\n<p>The first version just adds pointless code to process the inner loop. None of that code is needed, it just breaks the ability to vectorise the entire matrix. </p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 8426753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52016e6141fe5f3d3f23be3c21668b12?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie", "link": "https://stackoverflow.com/users/8426753/jamie"}, "edited": false, "score": 0, "creation_date": 1573078947, "post_id": 58727608, "comment_id": 103768552, "body": "Thanks for the response, good point about the repeated multiplication - would the compiler optimise it to that? I.e. <a href=\"https://stackoverflow.com/questions/1242185/loop-condition-evaluation\">this answer</a> When you say `do the operation on matrix blocks&#39; do you mean say do the operation on only a select number of rows? It doesn&#39;t seem that we would want that often because this is specifically for matrix addition, which is of the whole matrix?"}, {"owner": {"reputation": 21, "user_id": 8505049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5PsR8Eayjl0/AAAAAAAAAAI/AAAAAAAAAUc/pAwCh7iWMsM/photo.jpg?sz=128", "display_name": "Alon Levkovitch", "link": "https://stackoverflow.com/users/8505049/alon-levkovitch"}, "reply_to_user": {"reputation": 143, "user_id": 8426753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52016e6141fe5f3d3f23be3c21668b12?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie", "link": "https://stackoverflow.com/users/8426753/jamie"}, "edited": false, "score": 0, "creation_date": 1573634352, "post_id": 58727608, "comment_id": 103941484, "body": "The optimization depends on the compiler, I know that if you run &#39;gcc -o&#39; it will probably optimize that, but not all compilers will. I guess that whoever wrote that code wanted to be sure it will optimized correctly on every compiler, which is very important if this is going to be a c library and not a specific program. About the matrix blocks, somtimes in linear algebra you don&#39;t want to do the operation on the whole matrix because maybe one matrix is smaller, maybe it just a vector, maybe you already know that half of the matrix is just zeros (and so on)."}], "tags": [], "owner": {"reputation": 21, "user_id": 8505049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5PsR8Eayjl0/AAAAAAAAAAI/AAAAAAAAAUc/pAwCh7iWMsM/photo.jpg?sz=128", "display_name": "Alon Levkovitch", "link": "https://stackoverflow.com/users/8505049/alon-levkovitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1573035776, "last_edit_date": 1573035776, "creation_date": 1573034847, "answer_id": 58727608, "question_id": 58723455, "link": "https://stackoverflow.com/questions/58723455/is-there-any-benefit-to-this-combination-of-pointers-and-loops/58727608#58727608", "title": "Is there any benefit to this combination of pointers and loops?", "body": "<p>The approach on sumMatrixOnHost is better for optimization, and it should execute faster (generally) then the two approach you have suggested. </p>\n\n<p>For the alu multiplication takes more time than addition. \nSo in sumMatrixOnHost there is no multipicaion, in</p>\n\n<pre><code>for (int i=0; i&lt;ny*nx; i++) {\n    ic[i] = ia[i] + ib[i];\n }\n</code></pre>\n\n<p>there is multiplication in each iteration of the loop.\nin </p>\n\n<pre><code>for (int iy=0; iy&lt;ny; iy++) {\n    for (int ix=0; ix&lt;nx; ix++) {\n        ic[iy*nx+ix] = ia[iy*nx+ix] + ib[iy*nx+ix];\n    }\n}\n</code></pre>\n\n<p>there are 3 multipication in each iteration of the loop. </p>\n\n<p>A simpler approach can be </p>\n\n<pre><code> int n = ny*nx;\n for (int i=0; i&lt;n; i++) {\n    ic[i] = ia[i] + ib[i];\n }\n</code></pre>\n\n<p>but in the last approach we lose another thing that is good in sumMatrixOnHost, and that is the ability to do the operation on matrix blocks and not the whole matrix. </p>\n"}], "owner": {"reputation": 143, "user_id": 8426753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52016e6141fe5f3d3f23be3c21668b12?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie", "link": "https://stackoverflow.com/users/8426753/jamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 58723606, "answer_count": 2, "score": 1, "last_activity_date": 1573035776, "creation_date": 1573016968, "question_id": 58723455, "link": "https://stackoverflow.com/questions/58723455/is-there-any-benefit-to-this-combination-of-pointers-and-loops", "title": "Is there any benefit to this combination of pointers and loops?", "body": "<p>I'm working through CUDA C Programming by Cheng, and came across this piece of code:</p>\n\n<pre><code>void sumMatrixOnHost (float *A, float *B, float *C, const int nx, const int ny) {\n    float *ia = A;\n    float *ib = B;\n    float *ic = C;\n    for (int iy=0; iy&lt;ny; iy++) {\n        for (int ix=0; ix&lt;nx; ix++) {\n            ic[ix] = ia[ix] + ib[ix];\n        }\n        ia += nx; ib += nx; ic += nx;\n    }\n}\n</code></pre>\n\n<p>This is for matrix addition whereby the matrices are stored in a row-major format.</p>\n\n<p>As I understand, the inner for loop is iterating over a row and performing element addition, and the outer for loop is then used to increment the pointers to the start of the next row.</p>\n\n<p>Why is this approach better than using pointers over the whole matrix, i.e.</p>\n\n<pre><code>for (int i=0; i&lt;ny*nx; i++) {\n    ic[i] = ia[i] + ib[i];\n}\n</code></pre>\n\n<p>or dual for loops, i.e.</p>\n\n<pre><code>for (int iy=0; iy&lt;ny; iy++) {\n    for (int ix=0; ix&lt;nx; ix++) {\n        ic[iy*nx+ix] = ia[iy*nx+ix] + ib[iy*nx+ix];\n    }\n}\n</code></pre>\n\n<p>Is this something to do with how it is optimized by the compiler?</p>\n"}, {"tags": ["c", "file", "io"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574300822, "post_id": 58723134, "comment_id": 104186999, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><b>Why is \u201cwhile ( !feof (file) )\u201d always wrong?</b></a>"}, {"owner": {"reputation": 315, "user_id": 10254215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e01735f5148b32d131961ed39f69e?s=128&d=identicon&r=PG&f=1", "display_name": "Chien", "link": "https://stackoverflow.com/users/10254215/chien"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574786376, "post_id": 58723134, "comment_id": 104350738, "body": "Hi Andrew, I&#39;m not quite sure what your question means... whether it means the way me doing it is wrong or you got wrong results. In the latter case, this might result from that the file pointer cannot move forward. If so you may also ask a question, I&#39;m sure you could receive better answers."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 10254215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e01735f5148b32d131961ed39f69e?s=128&d=identicon&r=PG&f=1", "display_name": "Chien", "link": "https://stackoverflow.com/users/10254215/chien"}, "edited": false, "score": 0, "creation_date": 1573064316, "post_id": 58723177, "comment_id": 103762692, "body": "Thank you so much, this really helps me out!  And your assumption was correct, I indeed planned to do so. After correcting my current bug I&#39;d try to implement your better solution."}, {"owner": {"reputation": 315, "user_id": 10254215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e01735f5148b32d131961ed39f69e?s=128&d=identicon&r=PG&f=1", "display_name": "Chien", "link": "https://stackoverflow.com/users/10254215/chien"}, "edited": false, "score": 0, "creation_date": 1574292928, "post_id": 58723177, "comment_id": 104185148, "body": "I have solved this problem, your answer showed me a direction! And I was truly learning, but this is somewhat my homework for myself, and my intent was just to learn more about file io, so... no need to worry XD"}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1574300618, "last_edit_date": 1574300618, "creation_date": 1573014962, "answer_id": 58723177, "question_id": 58723134, "link": "https://stackoverflow.com/questions/58723134/problems-when-trying-to-skip-n-in-reading-txt-files/58723177#58723177", "title": "Problems when trying to skip &#39;\\n&#39; in reading txt files", "body": "<p>Think of the flow of your code (lines numbered below):</p>\n\n<pre><code> 1:  while (!feof(fp1)) {\n 2:      ch = fgetc(fp1);\n 3:      if (ch != '\\n') {\n 4:          printf(\"%c\",ch);\n 5:      }\n 6:      else {\n 7:          ch = fgetc(fp1); // move to the next character\n 8:          if (ch == '\\n') {\n 9:              printf(\"%c\",ch);\n10:          }\n11:      }\n12:  }\n</code></pre>\n\n<p>When you get a newline followed by non-newline, the flow is (starting at the <code>else</code> line): <code>6, 7, 8, 10, 11, 12, 1, 2</code>.</p>\n\n<p>It's that execution of the final <code>2</code> in that sequence that effectively throws away the non-newline character that you had read at <code>7</code>.</p>\n\n<hr>\n\n<p>If your intent is to basically throw away single newlines and convert sequences of newlines (two or more) to a single one<sup>(a)</sup>, you can use something like the following pseudo-code:</p>\n\n<pre><code>set numNewlines to zero\nwhile not end-file:\n    get thisChar\n    if numNewlines is one or thisChar is not newline:\n        output thisChar\n    if thisChar is newline:\n        increment numNewlines\n    else:\n        set numNewlines to zero\n</code></pre>\n\n<p>This reads the character in <em>one</em> place, making it less likely that you'll inadvertently skip one due to confused flow.</p>\n\n<p>It also uses the newline <em>history</em> to decide what gets printed. It only outputs a newline on the <em>second</em> occurrence in a sequence of newlines, ignoring the first and any after the second.</p>\n\n<p>That means taht a <em>single</em> newline will never be echoed and any group of two or more will be transformed into one.</p>\n\n<hr>\n\n<p>Some <em>actual</em> C code that demonstrates this<sup>(b)</sup> follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(void) {\n    // Open file.\n\n    FILE *fp = fopen(\"testprog.in\", \"r\");\n    if (fp == NULL) {\n        fprintf(stderr, \"Cannot open input file\\n\");\n        return 1;\n    }\n\n    // Process character by character.\n\n    int numNewlines = 0;\n    while (true) {\n        // Get next character, stop if none left.\n\n        int ch = fgetc(fp);\n        if (ch == EOF) break;\n\n        // Output only second newline in a sequence of newlines,\n        // or any non-nwline.\n\n        if (numNewlines  == 1 || ch != '\\n') {\n            putchar(ch);\n        }\n\n        // Manage sequence information.\n\n        if (ch == '\\n') {\n            ++numNewlines;\n        } else {\n            numNewlines = 0;\n        }\n    }\n\n    // Finish up cleanly.\n\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p><sup>(a)</sup> It's unclear from your question how you want to handle sequences of three or more newlines so I've had to make an assumption.</p>\n\n<hr>\n\n<p><sup>(b)</sup> Of course, you shouldn't <em>use</em> this if your intent is to learn, because:</p>\n\n<ol>\n<li>You'll learn more if you try yourself and have to fix any issues.</li>\n<li>Educational institutions will almost certainly check submitted code against a web search, and you'll probably be pinged for plagiarism.</li>\n</ol>\n\n<p>I'm just providing it for completeness.</p>\n"}], "owner": {"reputation": 315, "user_id": 10254215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/521e01735f5148b32d131961ed39f69e?s=128&d=identicon&r=PG&f=1", "display_name": "Chien", "link": "https://stackoverflow.com/users/10254215/chien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58723177, "answer_count": 1, "score": 0, "last_activity_date": 1574300618, "creation_date": 1573014625, "question_id": 58723134, "link": "https://stackoverflow.com/questions/58723134/problems-when-trying-to-skip-n-in-reading-txt-files", "title": "Problems when trying to skip &#39;\\n&#39; in reading txt files", "body": "<p>I wrote a fiarly small program to help with txt files formatting, but when I tried to read from the input files and skip unwanted '\\n' I actually skipped the next character after '\\n' instead.</p>\n\n<p>The characters I work on in the sample file is like this:</p>\n\n<pre><code>abcde\nabc\n\n   ab\nabcd\n</code></pre>\n\n<p>And my code looks like this:</p>\n\n<pre><code>while (!feof(fp1)) {\n    ch = fgetc(fp1);\n    if (ch != '\\n') {\n        printf(\"%c\",ch);\n    }\n    else {\n        ch = fgetc(fp1); // move to the next character\n        if (ch == '\\n') {\n            printf(\"%c\",ch);\n        }\n    }\n}\n</code></pre>\n\n<p>The expected result is</p>\n\n<pre><code>abcdeabc\n  ababcd\n</code></pre>\n\n<p>But I actually got</p>\n\n<pre><code>abcdebc\n   abbcd\n</code></pre>\n\n<p>I guess the problem is in <code>ch = fgetc(fp1); // move to the next character</code>\n, but I just can't find a correct way to implement this idea.</p>\n"}, {"tags": ["c", "linked-list", "malloc"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1573013775, "post_id": 58722963, "comment_id": 103738169, "body": "You only need to malloc space that is pointed to by a pointer, not every variable. Turning on your compiler warnings will tell you A LOT of mistakes in your code."}], "answers": [{"tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 0, "last_activity_date": 1573014560, "creation_date": 1573014560, "answer_id": 58723123, "question_id": 58722963, "link": "https://stackoverflow.com/questions/58722963/in-linked-list-program-shuts-down-when-entering-the-structs-member/58723123#58723123", "title": "In linked list, program shuts down when entering the struct&#39;s member", "body": "<p>You only need to allocate space for the structure itself, and not the member variables in this case. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>ptr = (struct player*)malloc(sizeof(struct player));\nif (ptr == NULL) {\n    printf(\"Error!\");\n    return 0;\n}\n</code></pre>\n\n<p>You should also specify the address of the variable in the calls to scanf. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    scanf(\"%d\", &amp;ptrW-&gt;num);\n    scanf(\"%d\", &amp;ptrW-&gt;age);\n    scanf(\"%d\", &amp;ptrW-&gt;Amatch);\n    scanf(\"%d\", &amp;ptrW-&gt;goals);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 12313191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDelPS5VpuVOfMYXPwWBTLBvilRRWDWFzYm4WiPJA=k-s128", "display_name": "Yoni Melki", "link": "https://stackoverflow.com/users/12313191/yoni-melki"}, "is_accepted": false, "score": 0, "last_activity_date": 1573014816, "creation_date": 1573014816, "answer_id": 58723169, "question_id": 58722963, "link": "https://stackoverflow.com/questions/58722963/in-linked-list-program-shuts-down-when-entering-the-structs-member/58723169#58723169", "title": "In linked list, program shuts down when entering the struct&#39;s member", "body": "<p>First of all:\nI think that you should use realloc when j!=0.\nYou won\u2019t lose the data of you string.\nSecondly: malloc/realloc/calloc are function that we use to allocate a block of memory and you can use them only on pointer (after the allocation the pointer will point at the first case of the block)\nThird: function strcpy() need to copy from a string - when you use malloc into strcpy() -> the compiler doesn\u2019t know what to copy (no value into the block of the allocation).\nHope that it helped</p>\n"}], "owner": {"reputation": 11, "user_id": 12214495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wu6HxZBZ5Ps/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd6ZnWadGhwFgrxSG3o9LOBhBnLSg/photo.jpg?sz=128", "display_name": "YSuho", "link": "https://stackoverflow.com/users/12214495/ysuho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1573014816, "creation_date": 1573013367, "question_id": 58722963, "link": "https://stackoverflow.com/questions/58722963/in-linked-list-program-shuts-down-when-entering-the-structs-member", "title": "In linked list, program shuts down when entering the struct&#39;s member", "body": "<p>Though I changed malloc to every struct's members, it shuts down before entering members. I think it is a memory problem, but I don't know where I made a mistake.   </p>\n\n<pre><code>struct player {\n    int num;\n    char name[40];\n    int age;\n    int Amatch;\n    int goals;\n    struct player* next;\n};\n</code></pre>\n\n<p>This is struct code.</p>\n\n<pre><code>printf(\"Enter the number of players: \");\nscanf(\"%d\", &amp;player_num);\n\nptr = (struct player*)malloc(sizeof(struct player));\nif (ptr == NULL) {\n    printf(\"Error!\");\n    return 0;\n}\n\nptrW = ptr;\nptrWW = ptr;\n\nfor (int j = 0; j &lt; player_num; j++) {\n    if (j != 0) {\n        ptr = (struct player*)malloc(sizeof(struct player));\n        if (ptr == NULL) {\n            printf(\"Error!\");\n            return 0;\n        }\n    }\n    ptr-&gt;num = (int*)malloc(sizeof(int));\n    if (ptr-&gt;num == NULL) {\n        printf(\"Error!\");\n        return 0;\n    }\n    strcpy(ptr-&gt;name ,(char*)malloc(sizeof(char) * 40));\n    if (ptr == NULL) {\n        printf(\"Error!\");\n        return 0;\n    }\n    ptr-&gt;age = (int*)malloc(sizeof(int));\n    if (ptr-&gt;age == NULL) {\n        printf(\"Error!\");\n        return 0;\n    }\n    ptr-&gt;goals = (int*)malloc(sizeof(int));\n    if (ptr-&gt;goals == NULL) {\n        printf(\"Error!\");\n        return 0;\n    }\n    ptr-&gt;Amatch = (int*)malloc(sizeof(int));\n    if (ptr-&gt;Amatch == NULL) {\n        printf(\"Error!\");\n        return 0;\n    }\n    if (j == player_num - 1) {\n        ptr-&gt;next = NULL;\n    }\n    ptr = ptr-&gt;next;\n}\n</code></pre>\n\n<p>This is how I get malloc. I'm also curious there is simpler way to get malloc.</p>\n\n<pre><code>while (ptrW != NULL) {\n    printf(\"**Player%d**\\n\", i);\n    printf(\"Number : \");\n    scanf(\"%d\", ptrW-&gt;num);\n    printf(\"Name : \");\n    scanf(\" \");\n    gets_s(ptrW-&gt;name, sizeof(ptrW-&gt;name));\n    printf(\"Age: \");\n    scanf(\"%d\", ptrW-&gt;age);\n    printf(\"A-matches : \");\n    scanf(\"%d\", ptrW-&gt;Amatch);\n    printf(\"Goals : \");\n    scanf(\"%d\", ptrW-&gt;goals);\n    printf(\"\\n\");\n    i++;\n    ptrW = ptrW-&gt;next;\n}\n</code></pre>\n\n<p>Here's the problem. It executes well when entering the player1's members, but before the entering the player2's num, the program shuts down.</p>\n"}, {"tags": ["c", "assembly", "bit-manipulation", "bit"], "comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573010343, "post_id": 58722453, "comment_id": 103737481, "body": "This looks like assembler. Care to say which processor?"}], "answers": [{"tags": [], "owner": {"reputation": 490, "user_id": 11007599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b1707b45871b01fad3b72064098440?s=128&d=identicon&r=PG", "display_name": "KagurazakaKotori", "link": "https://stackoverflow.com/users/11007599/kagurazakakotori"}, "is_accepted": true, "score": 1, "last_activity_date": 1573011164, "creation_date": 1573011164, "answer_id": 58722700, "question_id": 58722453, "link": "https://stackoverflow.com/questions/58722453/difference-between-sarq-and-shrq/58722700#58722700", "title": "Difference between sarq and shrq", "body": "<p><code>sarq</code> is arithmetic right shift for quadword, and <code>shrq</code> is logical right shift for quadword. The difference is that arithmetic shift will fill the vacant bits with the leftmost bit (aka the sign bit) while the logical right shift will just fill them with 0.</p>\n\n<p>For positive numbers, their behavior is the same. For negative numbers, their behavior is totally different.</p>\n\n<p>For example, assume <code>%rax = 16 (0x0000 0000 0000 0010)</code>. Both <code>sar $4, %rax</code> and <code>shrq $4, %rax</code> will set the <code>%rax</code> to 1 (<code>0x0000 0000 0000 0001</code>).</p>\n\n<p>Now if <code>%rax = -16 (0xffff ffff ffff fff0)</code>. <code>sar $4, %rax</code> will set <code>%rax</code> to -1 (<code>0xffff ffff ffff ffff</code>) while <code>shr $4, %rax</code> will set <code>%rax</code> to 1152921504606846975 (<code>0x0fff ffff ffff ffff</code>).</p>\n\n<p>To use which instruction depends on the data type and what you want to do. The C <code>&gt;&gt;</code> operator uses <code>sar</code> for signed data types and <code>shr</code> for unsigned ones.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573019570, "post_id": 58722728, "comment_id": 103739558, "body": "Fun fact: it&#39;s actually implementation-defined whether <code>int &gt;&gt;</code> is arithmetic or logical.  Actually just that the &quot;result is implementation-defined&quot; for right shifts of negative values.  But all sane C implementations use arithmetic (<a href=\"//stackoverflow.com/q/6487918\">Signed right shift: which compiler use logical shift</a>); e.g. the GNU C dialect of C even guarantees arithmetic 2&#39;s complement right shift = sign-extension.  (<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html</a>)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573019628, "post_id": 58722728, "comment_id": 103739576, "body": "But anyway, an x86 DeathStation 9000 could compile your code to use logical right shift in both cases without violating the ISO C standard.  Of course you meant using a sane compiler that would actually emit <code>sar</code> and <code>shr</code> when expected."}], "tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 0, "last_activity_date": 1573011746, "last_edit_date": 1573011746, "creation_date": 1573011413, "answer_id": 58722728, "question_id": 58722453, "link": "https://stackoverflow.com/questions/58722453/difference-between-sarq-and-shrq/58722728#58722728", "title": "Difference between sarq and shrq", "body": "<p>The difference is that sarq works on signed integers, shrq works on unsigned. Basically if the highest bit in the integer is set, sarq will shift in 1's (otherwise zeros). shrq will only ever shift in zeros. You can easily see what they do with some simple C. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int main()\n{\n  int val = -4;\n\n  // signed arithmetic shift\n  int rval = val &gt;&gt; 1;\n\n  // will print -2\n  std::cout &lt;&lt; rval &lt;&lt; std::endl;\n\n  unsigned uval = -4;\n\n  // unsigned logical shift\n  unsigned ruval = uval &gt;&gt; 1;\n\n  // will print 0x7FFFFFFE\n  std::cout &lt;&lt; rval &lt;&lt; std::endl;\n\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11760831"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1759, "favorite_count": 0, "closed_date": 1573019786, "accepted_answer_id": 58722700, "answer_count": 2, "score": 0, "last_activity_date": 1573011746, "creation_date": 1573008989, "question_id": 58722453, "link": "https://stackoverflow.com/questions/58722453/difference-between-sarq-and-shrq", "closed_reason": "Duplicate", "title": "Difference between sarq and shrq", "body": "<p>Name: Value</p>\n\n<p>%rdi: 0x6</p>\n\n<p>%rax: 0x4</p>\n\n<p>What is the difference between sarq and shrq?</p>\n\n<p>If I had sarq $1, %rdi how would this value look?\nWhat does shrq %rdi do?</p>\n"}, {"tags": ["c", "gcc", "ld", "dynamic-linking", "dynamic-loading"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573011801, "post_id": 58722368, "comment_id": 103737755, "body": "@DavidRankin-ReinstateMonica of course you have no issue there, you just linked the library (<code>-lzip</code>) :), the whold point of my question is that I <i>do not</i> want to link it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573012289, "post_id": 58722368, "comment_id": 103737844, "body": "Yikes my bad, I through that in out of habit -- and of course it worked."}], "answers": [{"comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1573012175, "post_id": 58722776, "comment_id": 103737830, "body": "Why does it &quot;almost never do what you want&quot;? Why shouldn&#39;t the loader just make the symbols available for global resolution without the need to manually call dlsym? That&#39;s basically what RTLD_GLOBAL is there for, isn&#39;t it? Also, this requires hardcoding the signature of all the functions I&#39;m going to use (which seems quite unfeasible, the actual program is way larger), isn&#39;t there any other method that I could use?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1573012451, "post_id": 58722776, "comment_id": 103737877, "body": "Another problem about hardcoding the signatures is that if the library has different signatures on different architectures (the ultimate goal would be to make this compatible with every Linux system supporting libzip) this just breaks everything because it assumes the wrong signature. I&#39;m not 100% sure about this though. Does what I&#39;m saying make sense? I would prefer a simpler/more portable/more automated option."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573012872, "post_id": 58722776, "comment_id": 103737965, "body": "Why would the signature be different? It&#39;s a documented part of the library&#39;s API."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573012973, "post_id": 58722776, "comment_id": 103737984, "body": "<code>RTLD_GLOBAL</code> makes the symbols of the loaded library available for use in resolving symbols for future <code>dlopen</code> calls, or <code>dlsym</code> calls on the global namespace (as opposed to a particular library). It <b>does not</b> redefine existing symbols or magically make unresolved ones in already-relocated code/data now resolve to the new definitions."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573013166, "post_id": 58722776, "comment_id": 103738041, "body": "In theory, the link-time linker and the dynamic linker, working together, <i>could</i> make these calls work, if they go through the PLT, but that&#39;d highly target-dependent. It fundamentally couldn&#39;t make the calls work if they went through function pointers in initialized global data, since it can&#39;t tell if the program has already seen the old (unresolved) value of the data or written something else over top of it already. And since this kind of hack can&#39;t work in general, it doesn&#39;t make sense to &quot;support it for the cases it happens to work on, for implementation-detail reasons&quot;."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573013233, "post_id": 58722776, "comment_id": 103738060, "body": "@R.. well I guess you&#39;re right about the signatures. My concern is that even if they are part of the API, the API itself could change and the explicit cast would just hide the problem and generate a faulty executable. Should I not be concerned about this? -- As per <code>RTLD_GLOBAL</code>, I just re-read the man page, you&#39;re right, that&#39;s its only purpose indeed."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573018667, "post_id": 58722776, "comment_id": 103739269, "body": "Even if you don&#39;t use <code>dlopen</code> but link directly to the shared library, a future version of the library <i>could</i> change the signature. This would be ABI-breaking, but nothing can automatically detect it. As a responsible library provider, you don&#39;t do that. You either introduce new function names for the incompatible interface, or introduce a new major library version or name, or use some kind of versioning (ideally <i>not</i> ELF symbol versioning since that wrongly binds to the version seen at link time rather than to the version whose headers you compiled against)."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573018712, "post_id": 58722776, "comment_id": 103739284, "body": "So anyway, regardless of whether you <code>dlopen</code> or link directly, there are still the same risks of dangerous mismatch if the library author does something irresponsible and changes it out from under you."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573035759, "post_id": 58722776, "comment_id": 103746861, "body": "@R.. Of course, but if I don&#39;t dlopen and the API changes then I will get a compilation error, that&#39;s what I&#39;m saying. I guess what you&#39;re saying makes a lot of sense though, and it&#39;s basically a non-problem, I&#39;m worrying to much. Thank you for the great explanations."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1573043600, "post_id": 58722776, "comment_id": 103751091, "body": "You&#39;ll get a compilation error at the time you compile, if it mismatches at the time you compile. You won&#39;t get one at runtime (or even link-time, if that&#39;s later than compile-time, e.g. if the affected code is in an archive (.a) library) if the shared library gets changed later."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574072677, "post_id": 58722776, "comment_id": 104086797, "body": "@R.. &quot;the link-time linker and the dynamic linker, working together, could make these calls work&quot; - check the other answer for a variation of this approach which does not require changes in tools."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 4, "last_activity_date": 1573013707, "last_edit_date": 1573013707, "creation_date": 1573011820, "answer_id": 58722776, "question_id": 58722368, "link": "https://stackoverflow.com/questions/58722368/loading-a-dynamic-library-at-run-time-yields-inconsistent-and-unexpected-results/58722776#58722776", "title": "Loading a dynamic library at run-time yields inconsistent and unexpected results, missing symbols and empty PLT entries. Why?", "body": "<blockquote>\n  <p>The above Should Just Work\u2122, and indeed it does seem to...</p>\n</blockquote>\n\n<p>No, it should not, and if it appears to, that's more of an accident. In general, using <code>--unresolved-symbols=...</code> is a really bad idea\u2122, and will almost never do what you want.</p>\n\n<p>The solution is trivial: you just need to look up <code>zip_open</code> and <code>zip_close</code>, like so:</p>\n\n<pre><code>int main(void) {\n    void *lib;\n    zip_t *p_open(const char *, int, int *);\n    void *p_close(zip_t*);\n    int err;\n    zip_t *myzip;\n\n    lib = dlopen(\"libzip.so\", RTLD_LAZY | RTLD_GLOBAL);\n    if (lib == NULL)\n        return 1;\n\n    p_open = (zip_t(*)(const char *, int, int *))dlsym(lib, \"zip_open\");\n    if (p_open == NULL)\n        return 1;\n    p_close = (void(*)(zip_t*))dlsym(lib, \"zip_close\");\n    if (p_close == NULL)\n        return 1;\n\n    myzip = p_open(\"myzip.zip\", ZIP_CREATE | ZIP_TRUNCATE, &amp;err);\n    if (myzip == NULL)\n        return 1;\n\n    p_close(myzip);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": false, "score": 2, "last_activity_date": 1574069900, "creation_date": 1574069900, "answer_id": 58911619, "question_id": 58722368, "link": "https://stackoverflow.com/questions/58722368/loading-a-dynamic-library-at-run-time-yields-inconsistent-and-unexpected-results/58911619#58911619", "title": "Loading a dynamic library at run-time yields inconsistent and unexpected results, missing symbols and empty PLT entries. Why?", "body": "<p>To add to EmployedRussian's answer, you can achieve what you need with the help of <a href=\"https://github.com/yugr/Implib.so\" rel=\"nofollow noreferrer\">Implib.so</a> tool. It would generate stubs for all library symbols (e.g. <code>zip_open</code>) which would call <code>dlopen</code>/<code>dlsym</code> internally and forward calls from your program to shared library:</p>\n\n<pre><code>$ gcc -c prog.c\n$ implib-gen.py path/to/libzip.so\n$ gcc -o prog prog.o libzip.tramp.S libzip.init.c -ldl\n</code></pre>\n\n<p>(note that you no longer need fancy linker flags and linker dry runs).</p>\n\n<p>As a side note what you are trying to do is called delayed loading and is a <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/linker-support-for-delay-loaded-dlls?view=vs-2019\" rel=\"nofollow noreferrer\">standard feature</a> of Windows DLLS.</p>\n"}], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 58722776, "answer_count": 2, "score": 3, "last_activity_date": 1574069900, "creation_date": 1573008335, "last_edit_date": 1573009193, "question_id": 58722368, "link": "https://stackoverflow.com/questions/58722368/loading-a-dynamic-library-at-run-time-yields-inconsistent-and-unexpected-results", "title": "Loading a dynamic library at run-time yields inconsistent and unexpected results, missing symbols and empty PLT entries. Why?", "body": "<p>I've been fighting with this problem for quite some time, and I've been unable to find a solution or even an explanation for it. So sorry if the question is long, but bear with me as I just want to make it 100% clear in the hopes that someone more experienced than me will be able to figure it out.</p>\n\n<p><sup>I'm keeping the C syntax highlight on for all snippets because it makes them a little bit clearer even if not really correct.</sup></p>\n\n<h2>What I want to do</h2>\n\n<p>I have a C program which uses some functions from a dynamic library (<code>libzip</code>). Here it is boiled down to a minimal reproducible example (it basically does nothing, but it works just fine):</p>\n\n<pre><code>#include &lt;zip.h&gt;\n\nint main(void) {\n    int err;\n    zip_t *myzip;\n\n    myzip = zip_open(\"myzip.zip\", ZIP_CREATE | ZIP_TRUNCATE, &amp;err);\n    if (myzip == NULL)\n        return 1;\n\n    zip_close(myzip);\n\n    return 0;\n}\n</code></pre>\n\n<p>Normally, to compile it, I would simply do:</p>\n\n<pre><code>gcc -c prog.c\ngcc -o prog prog.o -lzip\n</code></pre>\n\n<p>This creates, as expected, an ELF which requires <code>libzip</code> to run:</p>\n\n<pre><code>$ ldd prog\nlinux-vdso.so.1 (0x00007ffdafb53000)\nlibc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f81eedc7000)\n/lib64/ld-linux-x86-64.so.2 (0x00007f81ef780000)\nlibzip.so.4 =&gt; /usr/lib/x86_64-linux-gnu/libzip.so.4 (0x00007f81ef166000)\nlibz.so.1 =&gt; /lib/x86_64-linux-gnu/libz.so.1 (0x00007f81eebad000)\n</code></pre>\n\n<p><sup>(<code>libz</code> is just a dependency of <code>libzip</code>)</sup></p>\n\n<p>What I <em>really</em> want to do though, is to <strong>load the library myself using <code>dlopen()</code></strong>. Pretty simple task, no? Well yes, or at least I thought.</p>\n\n<p>To achieve this, I should just need to call <code>dlopen</code> and let the loader do its job:</p>\n\n<pre><code>#include &lt;zip.h&gt;\n#include &lt;dlfcn.h&gt;\n\nint main(void) {\n    void *lib;\n    int err;\n    zip_t *myzip;\n\n    lib = dlopen(\"libzip.so\", RTLD_LAZY | RTLD_GLOBAL);\n    if (lib == NULL)\n        return 1;\n\n    myzip = zip_open(\"myzip.zip\", ZIP_CREATE | ZIP_TRUNCATE, &amp;err);\n    if (myzip == NULL)\n        return 1;\n\n    zip_close(myzip);\n\n    return 0;\n}\n</code></pre>\n\n<p>Of course, since I want to <em>manually</em> load the library myself, I will not link it this time:</p>\n\n<pre><code># Create prog.o\ngcc -c prog.c\n\n# Do a dry-run just to make sure all symbols are resolved\ngcc -o /dev/null prog.o -ldl -lzip\n\n# Now recompile only with libdl\ngcc -o prog prog.o -ldl -Wl,--unresolved-symbols=ignore-in-object-files\n</code></pre>\n\n<p>The flag <code>--unresolved-symbols=ignore-in-object-files</code> tells <code>ld</code> to not worry about my <code>prog.o</code> having unresolved symbols at link time (I want to take care of that myself at runtime).</p>\n\n<h2>The problem</h2>\n\n<p>The above <em>Should Just Work\u2122</em>, and indeed it does seem to... but I have two machines, and being the pedantic nerd I am I just thought \"well, better make sure and compile it on both of them\".</p>\n\n<h3>First machine</h3>\n\n<p>x86-64, Linux 4.9, Debian 9, <code>gcc</code> 6.3.0, <code>ld</code> 2.28. Here <strong>everything works as expected</strong>.</p>\n\n<p>I can clearly see that the symbols are there:</p>\n\n<pre><code>$ readelf --dyn-syms prog\n\nSymbol table '.dynsym' contains 15 entries:\n   Num:    Value          Size Type    Bind   Vis      Ndx Name\n     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND\n     1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab\n     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)\n     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__\n===&gt; 4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND zip_close\n     5: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND dlopen@GLIBC_2.2.5 (3)\n===&gt; 6: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND zip_open\n     7: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses\n     8: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable\n     9: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)\n    10: 0000000000201040     0 NOTYPE  GLOBAL DEFAULT   25 _edata\n    11: 0000000000201048     0 NOTYPE  GLOBAL DEFAULT   26 _end\n    12: 0000000000201040     0 NOTYPE  GLOBAL DEFAULT   26 __bss_start\n    13: 00000000000006a0     0 FUNC    GLOBAL DEFAULT   11 _init\n    14: 0000000000000924     0 FUNC    GLOBAL DEFAULT   15 _fini\n</code></pre>\n\n<p>The PLT entries are also there as expected and look fine:</p>\n\n<pre><code>$ objdump -j .plt -M intel -d prog\n\nDisassembly of section .plt:\n\n00000000000006c0 &lt;.plt&gt;:\n 6c0:   ff 35 42 09 20 00       push   QWORD PTR [rip+0x200942]        # 201008 &lt;_GLOBAL_OFFSET_TABLE_+0x8&gt;\n 6c6:   ff 25 44 09 20 00       jmp    QWORD PTR [rip+0x200944]        # 201010 &lt;_GLOBAL_OFFSET_TABLE_+0x10&gt;\n 6cc:   0f 1f 40 00             nop    DWORD PTR [rax+0x0]\n\n00000000000006d0 &lt;zip_close@plt&gt;:\n 6d0:   ff 25 42 09 20 00       jmp    QWORD PTR [rip+0x200942]        # 201018 &lt;zip_close&gt;\n 6d6:   68 00 00 00 00          push   0x0\n 6db:   e9 e0 ff ff ff          jmp    6c0 &lt;.plt&gt;\n\n00000000000006e0 &lt;dlopen@plt&gt;:\n 6e0:   ff 25 3a 09 20 00       jmp    QWORD PTR [rip+0x20093a]        # 201020 &lt;dlopen@GLIBC_2.2.5&gt;\n 6e6:   68 01 00 00 00          push   0x1\n 6eb:   e9 d0 ff ff ff          jmp    6c0 &lt;.plt&gt;\n\n00000000000006f0 &lt;zip_open@plt&gt;:\n 6f0:   ff 25 32 09 20 00       jmp    QWORD PTR [rip+0x200932]        # 201028 &lt;zip_open&gt;\n 6f6:   68 02 00 00 00          push   0x2\n 6fb:   e9 c0 ff ff ff          jmp    6c0 &lt;.plt&gt;\n</code></pre>\n\n<p>And the program runs without any problem:</p>\n\n<pre><code>$ ./prog\n$ echo $?\n0\n</code></pre>\n\n<p>Even looking inside it with a debugger I can clearly see the symbols getting correctly resolved like any normal dynamic symbol:</p>\n\n<pre><code>0x55555555479b &lt;main+43&gt;                       lea    rax, [rbp - 0x14]\n0x55555555479f &lt;main+47&gt;                       mov    rdx, rax\n0x5555555547a2 &lt;main+50&gt;                       mov    esi, 9\n0x5555555547a7 &lt;main+55&gt;                       lea    rdi, [rip + 0xc0] &lt;0x7ffff7ffd948&gt;\n0x5555555547ae &lt;main+62&gt;                       call   zip_open@plt &lt;0x555555554620&gt;\n |\n v ### PLT entry:\n0x555555554620 &lt;zip_open@plt&gt;                  jmp    qword ptr [rip + 0x200a02] &lt;0x555555755028&gt;\n |\n v \n0x555555554626 &lt;zip_open@plt+6&gt;                push   2\n0x55555555462b &lt;zip_open@plt+11&gt;               jmp    0x5555555545f0\n |\n v ### PLT stub:\n0x5555555545f0                                 push   qword ptr [rip + 0x200a12] &lt;0x555555755008&gt;\n0x5555555545f6                                 jmp    qword ptr [rip + 0x200a14] &lt;0x7ffff7def0d0&gt;\n |\n v ### Symbol gets correctly resolved\n0x7ffff7def0d0 &lt;_dl_runtime_resolve_fxsave&gt;    push   rbx\n0x7ffff7def0d1 &lt;_dl_runtime_resolve_fxsave+1&gt;  mov    rbx, rsp\n0x7ffff7def0d4 &lt;_dl_runtime_resolve_fxsave+4&gt;  and    rsp, 0xfffffffffffffff0\n0x7ffff7def0d8 &lt;_dl_runtime_resolve_fxsave+8&gt;  sub    rsp, 0x240\n</code></pre>\n\n<h2>Second machine</h2>\n\n<p>x86-64, Linux 4.15, Ubuntu 18.04, <code>gcc</code> 7.4, <code>ld</code> 2.30. Here, <strong>something really strange is going on</strong>.</p>\n\n<p>Compilation doesn't yield any warning or error, <em>but</em> I do not see the symbols:</p>\n\n<pre><code>$ readelf --dyn-syms prog\n\nSymbol table '.dynsym' contains 7 entries:\n   Num:    Value          Size Type    Bind   Vis      Ndx Name\n     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND\n     1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab\n     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)\n     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__\n     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND dlopen@GLIBC_2.2.5 (3)\n     5: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable\n     6: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)\n</code></pre>\n\n<p>The PLT entries <em>are there</em>, but they are filled with zeroes, and aren't even recognized by <code>objdump</code>:</p>\n\n<pre><code>$ objdump -j .plt -M intel -d prog\n\nDisassembly of section .plt:\n\n0000000000000560 &lt;.plt&gt;:\n 560:   ff 35 4a 0a 20 00       push   QWORD PTR [rip+0x200a4a]        # 200fb0 &lt;_GLOBAL_OFFSET_TABLE_+0x8&gt;\n 566:   ff 25 4c 0a 20 00       jmp    QWORD PTR [rip+0x200a4c]        # 200fb8 &lt;_GLOBAL_OFFSET_TABLE_+0x10&gt;\n 56c:   0f 1f 40 00             nop    DWORD PTR [rax+0x0]\n    ...\n\n#   ^^^\n# Here, these three dots are actually hiding another 0x10+ bytes filled of 0x0\n# zip_close@plt should be here instead...\n\n0000000000000580 &lt;dlopen@plt&gt;:\n 580:   ff 25 42 0a 20 00       jmp    QWORD PTR [rip+0x200a42]        # 200fc8 &lt;dlopen@GLIBC_2.2.5&gt;\n 586:   68 00 00 00 00          push   0x0\n 58b:   e9 d0 ff ff ff          jmp    560 &lt;.plt&gt;\n    ...\n\n#   ^^^\n# Here, these three dots are actually hiding another 0x10+ bytes filled of 0x0\n# zip_open@plt should be here instead...\n</code></pre>\n\n<p>When the program is run, <code>dlopen()</code> works fine and loads <code>libzip</code> into memory, but then when <code>zip_open()</code> gets called, it just generates a segmentation fault:</p>\n\n<pre><code>$ ./prog\nSegmentation fault (code dumped)\n</code></pre>\n\n<p>Taking a look with a debugger, the issue is even more obvious (in case it wasn't already obvious enough). The PLT entries filled with zeroes just end up decoding to a bunch of <code>add</code> instructions dereferencing <code>rax</code>, which contains an invalid address and makes the program segfault and die:</p>\n\n<pre><code>0x5555555546e5 &lt;main+43&gt;               lea    rax, [rbp - 0x14]\n0x5555555546e9 &lt;main+47&gt;               mov    rdx, rax\n0x5555555546ec &lt;main+50&gt;               mov    esi, 9\n0x5555555546f1 &lt;main+55&gt;               lea    rdi, [rip + 0xc6]\n0x5555555546f8 &lt;main+62&gt;               call   dlopen@plt+16 &lt;0x555555554590&gt;\n |\n v ### Broken PLT enrty (all 0x0, will cause a segfault):\n0x555555554590 &lt;dlopen@plt+16&gt;         add    byte ptr [rax], al\n0x555555554592 &lt;dlopen@plt+18&gt;         add    byte ptr [rax], al\n0x555555554594 &lt;dlopen@plt+20&gt;         add    byte ptr [rax], al\n0x555555554596 &lt;dlopen@plt+22&gt;         add    byte ptr [rax], al\n0x555555554598 &lt;dlopen@plt+24&gt;         add    byte ptr [rax], al\n0x55555555459a &lt;dlopen@plt+26&gt;         add    byte ptr [rax], al\n0x55555555459c &lt;dlopen@plt+28&gt;         add    byte ptr [rax], al\n0x55555555459e &lt;dlopen@plt+30&gt;         add    byte ptr [rax], al\n   ### Next PLT entry...\n0x5555555545a0 &lt;__cxa_finalize@plt&gt;    jmp    qword ptr [rip + 0x200a52] &lt;0x7ffff7823520&gt;\n |\n v\n0x7ffff7823520 &lt;__cxa_finalize&gt;        push   r15\n0x7ffff7823522 &lt;__cxa_finalize+2&gt;      push   r14\n</code></pre>\n\n<h2>Questions</h2>\n\n<ol>\n<li>So, first of all... why is this happening?</li>\n<li>I thought that this was supposed to work, isn't it? If not, why? And why only on one of the two machines?</li>\n<li>But most importantly: <strong>how can I fix this</strong>?</li>\n</ol>\n\n<p>For question 3 I want to emphasize that the whole point of this is that I want to load the library myself, without linking it, so please refrain from just commenting that this is bad practice, or whatever else.</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1573007997, "post_id": 58722310, "comment_id": 103737054, "body": "The two ways are almost perfectly equivalent, and both should work, more or less.  You just need to keep a handle on the <i>original</i> value of <code>p</code> in your first try, as the next comment explains."}, {"owner": {"reputation": 2682, "user_id": 7602551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81b7fabc768e5360e25c5875f757883?s=128&d=identicon&r=PG&f=1", "display_name": "unlut", "link": "https://stackoverflow.com/users/7602551/unlut"}, "edited": false, "score": 2, "creation_date": 1573008050, "post_id": 58722310, "comment_id": 103737070, "body": "In first way, you increment p pointer while copying but you did not reset it back to starting point."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1573008273, "post_id": 58722310, "comment_id": 103737106, "body": "You could add <code>char *orig_p = p;</code> after the <code>malloc</code> call, and then  use <code>printf(&quot;%s\\n&quot;, orig_p);</code> at the end.  (Also, you should get in the habit of <i>always</i> checking the return value of <code>malloc</code> to make sure it succeeded.)"}], "answers": [{"tags": [], "owner": {"reputation": 3895, "user_id": 1382828, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/TnrmQ.jpg?s=128&g=1", "display_name": "CXJ", "link": "https://stackoverflow.com/users/1382828/cxj"}, "is_accepted": true, "score": 1, "last_activity_date": 1573037494, "last_edit_date": 1573037494, "creation_date": 1573008555, "answer_id": 58722389, "question_id": 58722310, "link": "https://stackoverflow.com/questions/58722310/what-is-the-difference-between-two-ways-to-manipulate-strings-in-c/58722389#58722389", "title": "What is the difference between two ways to manipulate strings in C?", "body": "<p>Both methods work to copy the string.  The error in the first method is in printing the copied string out when the loop is complete:</p>\n\n<pre><code>printf(\"%s\\n\", p);\n</code></pre>\n\n<p>At this point, <code>p</code> is pointing to the last character inserted into the copy, the null character, not the beginning of the string.  So the <code>printf()</code> correctly prints nothing.</p>\n"}], "owner": {"reputation": 47, "user_id": 11127412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b4c759240ffc7f42d9dd2d7fb897343?s=128&d=identicon&r=PG&f=1", "display_name": "XJZ", "link": "https://stackoverflow.com/users/11127412/xjz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58722389, "answer_count": 1, "score": 2, "last_activity_date": 1573037494, "creation_date": 1573007876, "last_edit_date": 1573008154, "question_id": 58722310, "link": "https://stackoverflow.com/questions/58722310/what-is-the-difference-between-two-ways-to-manipulate-strings-in-c", "title": "What is the difference between two ways to manipulate strings in C?", "body": "<p>I want to copy a string \"str\" to p . First I used the code I commented out, but the output was empty. So I tried the code that is below the commented area, and it worked. What is the difference between the two methods to manipulate strings in C? Thanks in advance.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    int main(void)\n    {\n        char *str = \"laekfja\";\n        char *p = (char*)malloc(51 * sizeof(char));\n\n        //First try.\n        /*  while(*str)             \n                {                   \n                    *p++ = *str++;  \n                }                   \n            *p = '\\0';\n            printf(\"%s\\n\", p);    \n        */\n\n        //Second try.\n        int i = 0;\n        while(i &lt; strlen(str))\n            {\n              p[i] = str[i];\n              i++;\n            }\n        p[i] = '\\0';\n        printf(\"%s\\n\", p);\n        return 0;  \n    }\n</code></pre>\n"}, {"tags": ["c", "function", "declaration"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1573007590, "post_id": 58722234, "comment_id": 103736973, "body": "Explain what you understand. These declarations all serve a purpose. They will appear whenever there is a use case for them."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1573007774, "post_id": 58722234, "comment_id": 103737011, "body": "I wouldn&#39;t say they&#39;re common, but the ability to read them is a useful skill, because if you know how to read them, you&#39;ll be able to properly understand the declarations that <i>are</i> common and that you do use."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1573007923, "post_id": 58722234, "comment_id": 103737036, "body": "See <a href=\"https://stackoverflow.com/questions/89056/how-do-you-read-c-declarations\">How do you read C declarations?</a>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1573008015, "post_id": 58722234, "comment_id": 103737061, "body": "If your assignment asks you to <i>describe the type of x as it is specified in the following declarations</i>, what difference does it make how common those declarations are? You&#39;re still being asked to solve the same problem whether they&#39;re common or not."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 2, "creation_date": 1573008739, "post_id": 58722234, "comment_id": 103737206, "body": "@paddy: Asking questions about homework is suitable for Stack Overflow. One should not ask for an entire homework problem to be done, but asking about particular points is accepted and proper. And this question does not ask about the homework, it asks about information the poster was inspired to ponder by the homework assignment."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1573009789, "post_id": 58722234, "comment_id": 103737386, "body": "These declarations may appear complicated, but they are all built up using a small number of rules.  Just strip off one layer at a time to understand them, like peeling an onion."}], "answers": [{"tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1573008980, "creation_date": 1573008980, "answer_id": 58722450, "question_id": 58722234, "link": "https://stackoverflow.com/questions/58722234/how-common-are-these-sort-of-declarations-in-c/58722450#58722450", "title": "How common are these sort of declarations in C?", "body": "<p>Declaration (a) (array of function pointers, probably serving as some kind of dispatch table) is not unheard of. The others are not very common and if anything like them occurs, it will likely use <code>typedef</code> names.</p>\n\n<p>I wrote some code long ago in which there were some character arrays defined as typedef names, and these were passed into and returned from functions:</p>\n\n<pre><code>typedef char fixed_string[256];\n\nfixed_string *fun(fixed_string *);\n</code></pre>\n\n<p>If we don't use a <code>typedef</code> for the function declaration, it looks like:</p>\n\n<pre><code>char (*fun(char (*)[256]))[256];\n</code></pre>\n\n<p>Using arrays this way is inadvisable; the non-<code>typedef</code> version is hard to read and the <code>typedefs</code> are a leaky abstraction, because the arrays still undergo conversion to pointers. I wouldn't write that today.</p>\n\n<p>Fixed arrays that are passed around are best wrapped up into a <code>struct</code>:</p>\n\n<pre><code>struct fixed_string { char s[256]; };\n</code></pre>\n\n<p>we can pass and return that by value, or using pointers.</p>\n\n<p>The (d) case:</p>\n\n<pre><code>void (*x(int, void (*y) (int))) (int);\n</code></pre>\n\n<p>can be rewritten with <code>typedefs</code> like this:</p>\n\n<pre><code>typedef void (*action)(int);\n\naction x(int, action);\n</code></pre>\n\n<p>This hints at pattern that can occur in some kinds of state machines. Maybe <code>x</code> calls that <code>action</code>, passing it the <code>int</code> parameter, and then returns a pointer to another function that serves as the next <code>action</code>.</p>\n"}], "owner": {"reputation": 381, "user_id": 11352579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f766d9ac410a6ecf7559b6300e2a28dc?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/11352579/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573008980, "creation_date": 1573007277, "question_id": 58722234, "link": "https://stackoverflow.com/questions/58722234/how-common-are-these-sort-of-declarations-in-c", "title": "How common are these sort of declarations in C?", "body": "<p>This is one of the problems in my homework. I'm asked to describe the type of x as it is specified by the following declarations:</p>\n\n<pre><code> a) char (*x[10]) (int);\n b) int (*x(int)) [5];\n c) float *(*x(void)) (int);\n d) void (*x(int, void (*y) (int))) (int);\n</code></pre>\n\n<p>I understand A) and can kinda make out what B) is , but C) and D) just look completely too cryptic for me.</p>\n\n<p>Are these sort of declarations common in C?</p>\n"}, {"tags": ["c", "input"], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 0, "last_activity_date": 1573008731, "last_edit_date": 1573008731, "creation_date": 1573008075, "answer_id": 58722339, "question_id": 58722047, "link": "https://stackoverflow.com/questions/58722047/how-do-i-separate-strings-from-uncertain-user-input-in-c/58722339#58722339", "title": "How do I separate strings from uncertain user input in C?", "body": "<pre><code>int extract(const char s, char **key_ptr, char **rest_ptr) {\n   *key_ptr  = NULL;\n   *rest_ptr = NULL;\n\n   const char *start_key;\n   const char *end_key;\n   const char *start_rest;\n\n   // Skip leading spaces.\n   while (*s == ' ')\n      ++s;\n\n   // Incorrect format.\n   if (!*s)\n      goto ERROR;\n\n   start_key = s;\n\n   // Find end of word.\n   while (*s &amp;&amp; *s != ' ')\n      ++s;\n\n   // Incorrect format.\n   if (!*s)\n      goto ERROR;\n\n   end_key = s;\n\n   // Skip spaces.\n   while (*s == ' ')\n      ++s;\n\n   /* Uncomment if you want to disallow zero-length \"rest\".\n   ** // Incorrect format.\n   ** if (!*s)\n   **    goto ERROR;\n   */\n\n   start_rest = s;\n\n   const size_t len_key = end_key-start_key;\n   *key_ptr = malloc(len_key+1);\n   if (*key_ptr == NULL)\n      goto ERROR;\n\n   memcpy(*key_ptr, start_key, len_key);\n   (*key_ptr)[len_key] = 0;\n\n   *rest_ptr = strdup(start_rest);\n   if (*rest_ptr == NULL)\n      goto ERROR;\n\n   return 1;\n\nERROR:\n   free(*key_ptr);  *key_ptr  = NULL;\n   free(*rest_ptr); *rest_ptr = NULL;\n   return 0;\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>char *key;\nchar *rest;\nif (extract(s, &amp;key, &amp;rest)) {\n   printf(\"Found [%s] [%s]\\n\", key, rest);\n   free(key);\n   free(rest);\n} else {\n   printf(\"No match.\\n\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573019967, "post_id": 58723814, "comment_id": 103739696, "body": "<i>note:</i> the <code>&#39;m&#39;</code> modifier is non-portable Linux only (and <code>m</code> was <code>a</code> in earlier versions of glibc)"}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1573035095, "post_id": 58723814, "comment_id": 103746506, "body": "@DavidRankin-ReinstateMonica The &#39;m&#39; modifier was introduced into POSIX as standard. See <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799</a>"}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": true, "score": 1, "last_activity_date": 1573019363, "creation_date": 1573019363, "answer_id": 58723814, "question_id": 58722047, "link": "https://stackoverflow.com/questions/58722047/how-do-i-separate-strings-from-uncertain-user-input-in-c/58723814#58723814", "title": "How do I separate strings from uncertain user input in C?", "body": "<p>You can use scanf to do the heavy lifting. The '%s' will read the first token (foo/bar), and the '%[^\\n]' will read everything else, up to new line, into word2. Length are arbitrary.</p>\n\n<pre><code>   char word1[10], word2[100] ;\n   if ( scanf(\"%9s %99[^\\n]\", word1, word2) == 2 ) {\n      // Do something with word1, word2\n   } ;\n\n</code></pre>\n\n<p>If you need unlimited length, consider using 'm' length modifier for malloced strings</p>\n"}], "owner": {"reputation": 3, "user_id": 12243223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d37efd8930ae15a0881b88bfb0878fa?s=128&d=identicon&r=PG&f=1", "display_name": "js_hammer08", "link": "https://stackoverflow.com/users/12243223/js-hammer08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58723814, "answer_count": 2, "score": -1, "last_activity_date": 1573019363, "creation_date": 1573005625, "question_id": 58722047, "link": "https://stackoverflow.com/questions/58722047/how-do-i-separate-strings-from-uncertain-user-input-in-c", "title": "How do I separate strings from uncertain user input in C?", "body": "<p>I'm trying to take input from the user for a program and the input has the following conditions :</p>\n\n<p>the user will enter a string - either \"foo\" or \"bar\" but the strings can have as many spaces before or after.</p>\n\n<p>followed by that the user will enter another string ( that can be anything )- for eg - \"Jacob McQueen\" or \"Random string with 4 words\"</p>\n\n<p>So if the user enters - ______foo___Jacob McQueen</p>\n\n<p>('_' signifies a space character)</p>\n\n<p>I need to separate out the strings \"foo\" and \"Jacob McQueen\".</p>\n\n<p>How should I do this in C?</p>\n"}, {"tags": ["c", "arrays"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8050155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4bfdc159e68f489e8d58ba1ab82e7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Adin ", "link": "https://stackoverflow.com/users/8050155/adin"}, "is_accepted": false, "score": 0, "last_activity_date": 1573006258, "creation_date": 1573006258, "answer_id": 58722124, "question_id": 58721911, "link": "https://stackoverflow.com/questions/58721911/how-to-print-two-1-d-arrays-next-to-on-another-in-c/58722124#58722124", "title": "How to print two 1-D arrays next to on another in C", "body": "<p>If you want two pieces of text to be side by side, you should print them without a new line in between.  This can get pretty annoying with formatting, especially because the averages are unlikely to be the same number of digits.  </p>\n\n<p>Do you mean you want the order to go <code>row_avg[i]</code>, <code>col_avg[i]</code>, <code>row_avg[i+1]</code>, <code>col_avg[i+1]</code>, etc?  </p>\n\n<p>If so, here's how to do that.  The key is incrementing <code>i</code> and <code>j</code> <em>in the same loop</em>.  What you're doing is initializing <code>j</code> to <code>0</code> for each row <code>i</code>.</p>\n\n<pre><code>j=0; \nfor(i=0; i&lt;nrows; i++)\n{ \n    printf(\"\\nAverage for row %i\", i); \n    printf(\"\\n %5.2lf\", row_avg[i]); \n    fprintf(fileavg, \"\\nAverage for row %i\", i);\n    fprintf(fileavg, \"\\n %5.2lf\", row_avg[i]);\n    if (j &lt; ncols) {\n        printf(\"\\nAverage for column %i\", j);  \n        printf(\"\\n %5.2lf\", col_avg[j]); \n        fprintf(fileavg, \"\\nAverage for column %i\", j); \n        fprintf(fileavg, \"\\n %5.2lf\", col_avg[j]); \n    }\n    jj++\n\n}\n</code></pre>\n\n<p>I think this is the basic structure you want.  If <code>nrows == ncols</code>, you don't have to worry about that <code>j &lt; ncols</code> clause, and you can just print it out.</p>\n\n<p>You can rearrange the print statements, including and excluding <code>\\n</code> and <code>\\t</code> to get the result that you like.  Also, in general, it's better to put your new lines <em>after</em> your line rather than before, but I'm not sure how codified that is.</p>\n"}], "owner": {"reputation": 21, "user_id": 12329380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211825227986594/picture?type=large", "display_name": "captainhindsight816", "link": "https://stackoverflow.com/users/12329380/captainhindsight816"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573016349, "creation_date": 1573004623, "last_edit_date": 1573016349, "question_id": 58721911, "link": "https://stackoverflow.com/questions/58721911/how-to-print-two-1-d-arrays-next-to-on-another-in-c", "title": "How to print two 1-D arrays next to on another in C", "body": "<p>I am working on an assignment that involves writing a program in C that reads data from a .txt file and saving it in a 2-D array. I then calculate the averages of each row and column. I have the program written and it works fine but I would like to be able to have the output display the row averages and column averages side by side instead of just all in a single row going down the screen. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>for (i = 0; i &lt; nrows; i++)\n{\n    j = 0;\n    if (j &lt; ncols)\n    {\n        printf(\"\\nAverage for row %i\", i);\n        fprintf(fileavg, \"\\nAverage for row %i\", i);\n        j++;\n    }\n    printf(\"\\n %5.2lf\\t\", row_avg[i]);\n    fprintf(fileavg, \"\\n %5.2lf\\t\", row_avg[i]);\n}\nfor (j = 0; j &lt; ncols; j++)\n{\n    i = 0;\n    if (i &lt; nrows)\n    {\n        printf(\"\\nAverage for column %i\", j);\n        fprintf(fileavg, \"\\nAverage for column %i\", j);\n        i++;\n    }\n    printf(\"\\n %5.2lf\\t\", col_avg[j]);\n    fprintf(fileavg, \"\\n %5.2lf\\t\", col_avg[j]);\n}\n</code></pre>\n"}, {"tags": ["c", "memory-leaks", "address-sanitizer"], "comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573005401, "post_id": 58721775, "comment_id": 103736536, "body": "FWIW, when I try this on my CentOS 7.7 system with clang 3.4.2, it reports no memory issues for either one."}, {"owner": {"reputation": 41, "user_id": 7138981, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101927728473740/picture?type=large", "display_name": "Matt Bryan", "link": "https://stackoverflow.com/users/7138981/matt-bryan"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573005664, "post_id": 58721775, "comment_id": 103736577, "body": "@Steve Did you set ASAN_OPTIONS=detect_leaks=1? Apparently lsan is off by default. <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerLeakSanitizer\" rel=\"nofollow noreferrer\">github.com/google/sanitizers/wiki/AddressSanitizerLeakSaniti&zwnj;&#8203;zer</a>"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573005808, "post_id": 58721775, "comment_id": 103736608, "body": "This is the first time I&#39;ve ever used clang, but trying it again as you suggested reveals the same behavior."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7138981, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101927728473740/picture?type=large", "display_name": "Matt Bryan", "link": "https://stackoverflow.com/users/7138981/matt-bryan"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1573158354, "post_id": 58756113, "comment_id": 103800530, "body": "Yeah; SO makes me wait at least 5 hours to do it, hehe. I don&#39;t know why."}], "tags": [], "owner": {"reputation": 41, "user_id": 7138981, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101927728473740/picture?type=large", "display_name": "Matt Bryan", "link": "https://stackoverflow.com/users/7138981/matt-bryan"}, "is_accepted": true, "score": 2, "last_activity_date": 1573156781, "creation_date": 1573156781, "answer_id": 58756113, "question_id": 58721775, "link": "https://stackoverflow.com/questions/58721775/addresssanitizer-not-finding-an-obvious-leak-after-changing-printf/58756113#58756113", "title": "AddressSanitizer not finding an obvious leak after changing printf", "body": "<p>I've been informed from the ASAN folks that this is a known bug:\n<a href=\"https://github.com/google/sanitizers/issues/937\" rel=\"nofollow noreferrer\">https://github.com/google/sanitizers/issues/937</a></p>\n\n<p>LeakSanitizer: false negative when functions stack frames overlay #937</p>\n"}], "owner": {"reputation": 41, "user_id": 7138981, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101927728473740/picture?type=large", "display_name": "Matt Bryan", "link": "https://stackoverflow.com/users/7138981/matt-bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 2, "accepted_answer_id": 58756113, "answer_count": 1, "score": 2, "last_activity_date": 1573156781, "creation_date": 1573003281, "question_id": 58721775, "link": "https://stackoverflow.com/questions/58721775/addresssanitizer-not-finding-an-obvious-leak-after-changing-printf", "title": "AddressSanitizer not finding an obvious leak after changing printf", "body": "<p>I'm scratching my head trying to figure out why ASAN isn't picking up on a simple memory leak. valgrind finds it just fine. Help?</p>\n\n<p>Example that ASAN <em>does</em> find.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid blah(void)\n{\n        int *some_int = malloc(sizeof(int));\n        *some_int = 1;\n        printf(\"hello %p\\n\", some_int);\n        // some_int is lost here\n}\n\nint main()\n{\n        blah();\n        return 0;\n}\n\nmbryan@remotedev-mbryan:~/git/mbryan/onefs$ clang -fsanitize=address -O0 q.c\nmbryan@remotedev-mbryan:~/git/mbryan/onefs$ ./a.out\nhello 0x602000000010\n\n=================================================================\n==10751==ERROR: LeakSanitizer: detected memory leaks\n\nDirect leak of 4 byte(s) in 1 object(s) allocated from:\n    #0 0x4d9bd0 in malloc (/ifs/home/mbryan/git/mbryan/onefs/a.out+0x4d9bd0)\n    #1 0x5120f3 in blah (/ifs/home/mbryan/git/mbryan/onefs/a.out+0x5120f3)\n    #2 0x512183 in main (/ifs/home/mbryan/git/mbryan/onefs/a.out+0x512183)\n    #3 0x7f3515000b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310\n\nSUMMARY: AddressSanitizer: 4 byte(s) leaked in 1 allocation(s).\n</code></pre>\n\n<p>So far so good. Now print the value instead of the pointer:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid blah(void)\n{\n        int *some_int = malloc(sizeof(int));\n        *some_int = 1;\n        printf(\"hello %d\\n\", *some_int);  // &lt;---------------\n}\n\nint main()\n{\n        blah();\n        return 0;\n}\n\nmbryan@remotedev-mbryan:~/git/mbryan/onefs$ clang -fsanitize=address -O0 q.c\nmbryan@remotedev-mbryan:~/git/mbryan/onefs$ ./a.out\nhello 1\n</code></pre>\n\n<p>...now the leak doesn't show up.</p>\n\n<p>On the latter if I recompile without the sanitizer and run valgrind, valgrind does indeed show a leak:\n==10782==    definitely lost: 4 bytes in 1 blocks</p>\n\n<p>Looking at the assembly: I see the optimimzer hasn't made my malloc'd variable a local or some other trickery. So: why isn't AddressSanitizer picking up this one?  Am I missing something obvious?</p>\n\n<p>This is on Ubuntu18.04 using clang 6.0.0-1ubuntu2.</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572999644, "post_id": 58721243, "comment_id": 103735363, "body": "It will make the code easier to read to use <code>x[y]</code> notation rather than <code>*(x+y)</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1572999679, "post_id": 58721243, "comment_id": 103735369, "body": "<code>tolower(X)</code> has no effect, <code>tolower</code> is a macro/function that reads the input and returns its output"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1572999769, "post_id": 58721243, "comment_id": 103735382, "body": "You probably access out of bounds of <code>arr</code> or <code>list</code> but it is impossible to say without seeing the whole program  , please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "is_accepted": false, "score": 0, "last_activity_date": 1573000390, "creation_date": 1573000390, "answer_id": 58721440, "question_id": 58721243, "link": "https://stackoverflow.com/questions/58721243/what-is-causing-the-segmentation-fault-in-this-function/58721440#58721440", "title": "What is causing the segmentation fault in this function?", "body": "<p>I fixed the segmentation fault. I was accessing the word in the list instead of the letter in the words. </p>\n\n<pre><code>*(*(list+(listPos+i)))\n</code></pre>\n\n<p>Needed to be</p>\n\n<pre><code>*(*(list+listPos)+i)\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573000390, "creation_date": 1572998667, "question_id": 58721243, "link": "https://stackoverflow.com/questions/58721243/what-is-causing-the-segmentation-fault-in-this-function", "title": "What is causing the segmentation fault in this function?", "body": "<p>I am writing a function to search through a 2D array of characters for words from a list. I am encountering a segmentation fault,probably because of the while loop I have set up according to the backtrace, but I can't see what is causing it.</p>\n\n<p>Here is the code for the function that I believe the error is in. Note: This is just the part for the horizontal search.</p>\n\n<pre><code>void searchWord(int j, int k, int gridsize, char** arr, char** list, int listPos){\nif(j+strlen(*(list+listPos)) &lt;= gridsize){ //Horizontal\n    int i = 0;\n    while(i &lt; strlen(*(list+listPos)) &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+(listPos+i)))){\n        i++;\n    }\n    if(i == strlen(*(list+listPos))){\n        while(i &gt; 0 &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+(listPos+i)))){\n        tolower(*(*(arr+(j+i))+k));\n        i--;\n        }\n        for(i = 0; i &lt; strlen(*(list+listPos)); i++)\n            printf(\"%c\", *(*(list+listPos)+i));\n    }\n}\n</code></pre>\n\n<p>This is what the backtrace is telling me.</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x0000000008000fd2 in searchWord (j=0, k=0, gridsize=15, arr=0x8403260, list=0x84032e0, listPos=49)\n    at arraysearch.c:110\n110                     while(i &lt; strlen(*(list+listPos)) &amp;&amp; *(*(arr+(j+i))+k) == *(*(list+(listPos+i)))){\n(gdb) bt\n#0  0x0000000008000fd2 in searchWord (j=0, k=0, gridsize=15, arr=0x8403260, list=0x84032e0, listPos=49)\n    at arraysearch.c:110\n#1  0x0000000008000ed4 in searchPuzzle (arr=0x8403260, n=15, list=0x84032e0, listSize=50) at arraysearch.c:96\n#2  0x0000000008000d70 in main (argc=2, argv=0x7ffffffee048) at arraysearch.c:68\n</code></pre>\n"}, {"tags": ["c", "openmp", "codeblocks"], "answers": [{"tags": [], "owner": {"reputation": 280, "user_id": 9938686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AJ5oC.jpg?s=128&g=1", "display_name": "2b-t", "link": "https://stackoverflow.com/users/9938686/2b-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1573726303, "creation_date": 1573726303, "answer_id": 58854215, "question_id": 58721061, "link": "https://stackoverflow.com/questions/58721061/openmp-at-codeblocks/58854215#58854215", "title": "Openmp at Codeblocks", "body": "<p>You are running <strong>Windows</strong>. As a consequence you do not have to add <em>-lgomp</em> but instead <a href=\"https://stackoverflow.com/a/58546530/9938686\"><strong>libgomp-1.dll</strong></a> (32-bit) or <em>libgomp_64-1.dll</em> (64-bit).</p>\n"}], "owner": {"reputation": 43, "user_id": 12308324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6701f63c39da3366e0d94599d860f00b?s=128&d=identicon&r=PG&f=1", "display_name": "glo", "link": "https://stackoverflow.com/users/12308324/glo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573726303, "creation_date": 1572997245, "question_id": 58721061, "link": "https://stackoverflow.com/questions/58721061/openmp-at-codeblocks", "title": "Openmp at Codeblocks", "body": "<p>I will try to enable openmp at codeblocks 17.12. I added to <strong>linker settings> other linker options> -lgomp -pthread</strong> but when i build the program shows the errors:\n<em>ld.exe    cannot find -lgomp\n          error: ld returned 1 exit status</em>\nWhat 's wrong? Do you have any ideas?</p>\n"}, {"tags": ["c", "linux", "cygwin"], "comments": [{"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 0, "creation_date": 1573003362, "post_id": 58720808, "comment_id": 103736138, "body": "<b>DO NOT post images of code, data, error messages, etc.</b> - copy or type the text into the question. <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 606, "user_id": 4257143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q195EKev0qQ/AAAAAAAAAAI/AAAAAAAAAxM/R2bEEt98Yrc/photo.jpg?sz=128", "display_name": "Doug Henderson", "link": "https://stackoverflow.com/users/4257143/doug-henderson"}, "edited": false, "score": 0, "creation_date": 1573010190, "post_id": 58720808, "comment_id": 103737451, "body": "1) your <code>DS4rd.exe</code> may have more options that allows it to open a device that is already open by another app, or 2) You are running something that your exe does not expect to be running, perhaps a game or a controller test or setup app."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12356848, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/28d43706697abdc81f57cfa7de4063ce?s=128&d=identicon&r=PG", "display_name": "Anon", "link": "https://stackoverflow.com/users/12356848/anon"}, "is_accepted": false, "score": 0, "last_activity_date": 1573493944, "creation_date": 1573493944, "answer_id": 58806159, "question_id": 58720808, "link": "https://stackoverflow.com/questions/58720808/reading-data-from-ds4-controller-for-school-project-keep-receiving-hid-open-er/58806159#58806159", "title": "Reading data from DS4 Controller for school project - keep receiving hid_open error", "body": "<p>You need to download the cygwin folder from the schools computer and transfer it to yours. Your cygwin folder should be replaced with theirs.</p>\n"}], "owner": {"reputation": 1, "user_id": 12329019, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFrKsbsaGJw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdz66VPBLxVGIAtnaUe-gz69KUN7w/photo.jpg?sz=128", "display_name": "Z-M", "link": "https://stackoverflow.com/users/12329019/z-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573493944, "creation_date": 1572995299, "last_edit_date": 1572999415, "question_id": 58720808, "link": "https://stackoverflow.com/questions/58720808/reading-data-from-ds4-controller-for-school-project-keep-receiving-hid-open-er", "title": "Reading data from DS4 Controller for school project - keep receiving hid_open error", "body": "<p>I am doing a school project where we have to read in data from a PS4 controller by running a school provided <code>DS4rd.exe</code> in cygwin.</p>\n\n<p>I am trying to get it set up on my personal computer, but I cannot for the life of me get it to work.</p>\n\n<p>I am running the command:</p>\n\n<pre><code>./ds4rd.exe\n</code></pre>\n\n<p>which does device enumeration and lists the PS4 controller and the VID/PID. </p>\n\n<p>I am then running the <code>./ds4rd.exe</code> command with the given arguments to read data off the controller but I keep receiving:</p>\n\n<blockquote>\n  <p>hid_open, try device enumeration and check vendor id and product id values</p>\n</blockquote>\n\n<p>I am not familiar with how these packages really work. Does anyone have an idea of what could be giving me this error?</p>\n\n<p><img src=\"https://i.stack.imgur.com/OEQNs.png\" alt=\"Console Output\"></p>\n"}, {"tags": ["c", "object", "pointers", "struct"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1572995360, "post_id": 58720786, "comment_id": 103734325, "body": "This is not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Where does <code>ppObjects</code> get its value from?  How is that table of pointers initialized and assigned to?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1572995577, "post_id": 58720786, "comment_id": 103734381, "body": "This is not enough to demonstrate the crash"}], "owner": {"reputation": 65, "user_id": 11371944, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D_VQ-eXGmbg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reNh6QO4oHlDL5EqGrLiyDxe7Wfsw/mo/photo.jpg?sz=128", "display_name": "Frode", "link": "https://stackoverflow.com/users/11371944/frode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572995080, "creation_date": 1572995080, "question_id": 58720786, "link": "https://stackoverflow.com/questions/58720786/how-to-gain-access-to-objects-locked-behind-doublepointer-c", "title": "How to gain access to objects locked behind doublepointer? (C)", "body": "<p>In a homework task I must gain access to object specifics (i.e pID, Code), which are located in a structure. However, I need to link my function with the objects first (**ppObjects), but since I am dealing with a doublepointer, I seem to be having an issue.\nIt is worth noting that when I tried the same commands but function was PrintNewObject(HeaderC* pStruct4) it worked fine - so I am guessing it is an issue with me having to use doublepointer when dealing with pStruct4.</p>\n\n<p>I have provided the code that I have tried below. While compiling it shows no error, but upon trying to print something from it, it says that obj is a nullpointer.</p>\n\n<p>The function that I would like to link with ppObjects.</p>\n\n<pre><code>int InsertNewObject(HeaderC** pStruct4){\n    HeaderC* testinH;\n    for (testinH = *pStruct4; testinH != NULL; testinH = testinH-&gt;pNext)\n    {\n        int count = 0;\n            while (count &lt; 26) //one for every letter in the alphabet, as ppObjects is an array\n            {\n                Object9* obj;\n                obj = (Object9*)testinH-&gt;ppObjects[count]; //the line that does not seem to properly define\n                printf(\"%lu\", obj-&gt;Code); //running this line crashes my program\n                count++;\n            }\n    }\n</code></pre>\n\n<p>Header, where we can see that ppObjects is a doublepointer.</p>\n\n<pre><code>typedef struct headc\n{\n    void **ppObjects; // Pointer to the array of pointers to objects. \n                      // Objects may be of types Object1-10 \n    char cBegin;      // The first letter of ID of objects related to\n                      // header is cBegin.\n    struct headc *pNext;\n} HeaderC;\n</code></pre>\n\n<p>The object I was provided in the hometask is below. This is what I would get access to after defining</p>\n\n<pre><code>typedef struct ob9\n{\n    char *pID;\n    unsigned long int Code;\n    Date3 *pDate3; \n    struct ob9 *pNext;\n} Object9;\n</code></pre>\n\n<p>I get an error saying that obj is nullpointer when I try to print anything from obj.</p>\n\n<p>If this is poorly worded, I am sorry. I tried my best to make this understandable yet not too long. Any help is appreciated!</p>\n"}, {"tags": ["c", "file", "fopen"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1572994841, "post_id": 58720709, "comment_id": 103734162, "body": "How are you running your program? Can you give an example of what you type on the command line? Also, can you fix the errors in your code. I cannot compile and run it as it is in this question, primarily because you have no <code>main()</code>."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1572995034, "post_id": 58720709, "comment_id": 103734240, "body": "Is this message coming because <code>fInput</code> is NULL or because <code>fp</code> is NULL?"}, {"owner": {"reputation": 319, "user_id": 1496823, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/81a8aee051d4aaa10dc846cc64587b7f?s=128&d=identicon&r=PG", "display_name": "Akshay G Bhardwaj", "link": "https://stackoverflow.com/users/1496823/akshay-g-bhardwaj"}, "edited": false, "score": 0, "creation_date": 1572995075, "post_id": 58720709, "comment_id": 103734246, "body": "Also, change the error message. In that way, we know where the error occurred."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1572995198, "post_id": 58720709, "comment_id": 103734278, "body": "Are you reading the paths in a <code>while (!feof(Input))</code> loop?  Don&#39;t do that.<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1572995284, "post_id": 58720709, "comment_id": 103734299, "body": "In the error message, don&#39;t just say &quot;Cannot open file&quot;.  Give the reason.  <code>man perror</code> and <code>man strerror</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": true, "score": 3, "last_activity_date": 1572995571, "creation_date": 1572995571, "answer_id": 58720851, "question_id": 58720709, "link": "https://stackoverflow.com/questions/58720709/problem-while-opening-a-file-because-of-weird-characters-on-the-file-path/58720851#58720851", "title": "Problem while opening a file because of weird characters on the file path", "body": "<p>You read the file names character by character into <code>fPath[k].path[i]</code>, then set <code>path[i]</code> to nul after the loop.\nBut <code>fPath[k].path</code> and <code>path</code> are not the same variable, so you haven't null-terminated <code>fPath[k].path[i]</code></p>\n"}], "owner": {"reputation": 129, "user_id": 11751428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16aa58cd5273171b1343d9363f08e701?s=128&d=identicon&r=PG&f=1", "display_name": "YPD", "link": "https://stackoverflow.com/users/11751428/ypd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58720851, "answer_count": 1, "score": 1, "last_activity_date": 1573551574, "creation_date": 1572994655, "last_edit_date": 1573551574, "question_id": 58720709, "link": "https://stackoverflow.com/questions/58720709/problem-while-opening-a-file-because-of-weird-characters-on-the-file-path", "title": "Problem while opening a file because of weird characters on the file path", "body": "<p>I'm reading the path of some file from a file given as arguments to my application. \nEach path is written on a line. I have problem with the last path which give me this error:</p>\n\n<pre><code>Cannot open C:\\Users\\Utente\\Desktop\\find\\try1.txtl\u00b9v\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>    struct filePath{\n        char path[255];\n        int fileOccurences;\n    };\n\n    struct filePath fPath[2];\n    char currentLine[255];\n    char path[255];\n    char word[30];\n    int i, ch;\n    int k = 0;\n    FILE * fInput = fopen(argv[1], \"r\"); \n    if(fInput == NULL){ //check sull'apertura del file\n        fprintf(stderr, \"Cannot open %s, exiting. . .\\n\", argv[1]);\n       exit(1);\n    }\n\n    while(!feof(fInput)){\n        for (i = 0; (i &lt; (sizeof(path)-1) &amp;&amp; ((ch = fgetc(fInput)) != EOF) &amp;&amp; (ch != '\\n')); i++){\n            fPath[k].path[i] = ch;\n        }\n        FPath[k].path[i] = '\\0';\n        k = k + 1;\n    }\n    fclose(fInput);\n    for(int j = 0; j&lt;2; j++){\n        FILE * fp = fopen(fPath[j].path, \"r\"); \n        if(fp == NULL){ \n            fprintf(stderr, \"Cannot open %s, exiting. . .\\n\", fPath[j].path);\n            exit(1);\n        }\n    }\n</code></pre>\n\n<p>I have upload only the interested part of the program, this isn't how i exactly wrote my code. So, someone know how can i solve this problem and cancel these character \"l\u00b9v\". Thank you.</p>\n"}, {"tags": ["c", "arrays", "stack"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572994360, "post_id": 58720630, "comment_id": 103734029, "body": "Because the indexing <code>*(array + index)</code> won&#39;t work."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1572994414, "post_id": 58720630, "comment_id": 103734048, "body": "Really interesting question I must say. Bravo!"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572994600, "post_id": 58720630, "comment_id": 103734105, "body": "@WeatherVane Don&#39;t know if I buy that explanation. It would be easy to define pointer arithmetics so it just subtract instead. Or am I missing something there?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1572994642, "post_id": 58720630, "comment_id": 103734112, "body": "Mainly because any decent sized array can&#39;t be fit on the stack. So you would use the heap, so why make things complicated. You could equally ask &quot;why do stacks grow down in memory?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1572994775, "post_id": 58720630, "comment_id": 103734140, "body": "@klutt you would have to rewrite the processor&#39;s indexing instructions too."}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 5, "last_activity_date": 1572994647, "creation_date": 1572994647, "answer_id": 58720707, "question_id": 58720630, "link": "https://stackoverflow.com/questions/58720630/why-do-arrays-not-grow-in-stack-direction-when-used-in-functions-as-local-variab/58720707#58720707", "title": "Why do arrays not grow in stack direction when used in functions as local variables?", "body": "<p>You can't do this with a stack that grows down without completely swapping the addressing model for all arrays. That's a viable implementation choice, but not compatible with existing ABIs.</p>\n\n<p>What you have noticed is that, in some ways, having a stack that grows up (where up is the direction of positive array index) is in some ways safer than having a stack that grows down. However, it's not all that much safer. Consider what happens when you pass the address of an array with automatic storage to another function. The callee will appear higher on the stack than the array, so any overflow of the array will overflow into the callee's stack frame, possibly including its return address. For example:</p>\n\n<pre><code>void foo()\n{\n    char s[4];\n    strcpy(s, \"hello world\");\n}\n</code></pre>\n\n<p>When <code>strcpy</code> returns, its return address may have been clobbered by storing past the end of the array whose address was passed to it.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572996390, "post_id": 58720839, "comment_id": 103734577, "body": "The specification does allow for compilers to do array bounds checking ...  it&#39;s just uncommon for compilers to actually implement it"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1573055136, "post_id": 58720839, "comment_id": 103757851, "body": "@M.M: Changed wording to &quot;require&quot;."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1573055112, "last_edit_date": 1573055112, "creation_date": 1572995500, "answer_id": 58720839, "question_id": 58720630, "link": "https://stackoverflow.com/questions/58720630/why-do-arrays-not-grow-in-stack-direction-when-used-in-functions-as-local-variab/58720839#58720839", "title": "Why do arrays not grow in stack direction when used in functions as local variables?", "body": "<p>\"The direction of the stack\" is a function of the implementation, not the language - the language specification doesn't even assume the presence of a stack.  </p>\n\n<p>Array indexing works by adding a non-negative offset to a base address and dereferencing the result - arrays must always grow \"up\" towards increasing addresses, irrespective of the stack growth direction.  </p>\n\n<p>The only thing that will truly make array operations <em>safe</em>(r) is for the C language specification to require bounds checking on all array accesses and to throw an exception on an out-of-bounds access.  Of course, the C language specification would also have to add structured exception handling as well (the current signal-handling method would be woefully inadequate).  </p>\n\n<p>Such an addition is...<em>unlikely</em>.   </p>\n"}], "owner": {"reputation": 73, "user_id": 12328871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293a3baeb76b9d6a1001da6ade6a0635?s=128&d=identicon&r=PG&f=1", "display_name": "rexor", "link": "https://stackoverflow.com/users/12328871/rexor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "answer_count": 2, "score": 7, "last_activity_date": 1573055112, "creation_date": 1572994191, "question_id": 58720630, "link": "https://stackoverflow.com/questions/58720630/why-do-arrays-not-grow-in-stack-direction-when-used-in-functions-as-local-variab", "title": "Why do arrays not grow in stack direction when used in functions as local variables?", "body": "<p>This might be a stupid question but I was wondering what if the array was filled with values in a way of it grows in the direction of the stack (so in case of the array being the only one local variable such that the first element of the array is adressed one byte after the stackframe pointer/base pointer, the second element adressed two bytes after stackframe pointer/base pointer, ...), wouldn't it make stack overflow in C much safer since the return adress cannot be overwritten that easy (the array would have to fill nearly the entire RAM and thus the program would crash instead of execute some malicious code)?</p>\n"}, {"tags": ["c", "math", "language-lawyer"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1572993983, "post_id": 58720505, "comment_id": 103733919, "body": "Have you seen these posts: <a href=\"https://stackoverflow.com/questions/2633661/how-to-check-for-signed-integer-overflow-in-c-without-undefined-behaviour\" title=\"how to check for signed integer overflow in c without undefined behaviour\">stackoverflow.com/questions/2633661/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/199333/how-do-i-detect-unsigned-integer-multiply-overflow\" title=\"how do i detect unsigned integer multiply overflow\">stackoverflow.com/questions/199333/&hellip;</a> ?"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1572994141, "post_id": 58720505, "comment_id": 103733957, "body": "@Dai The question in the first link you posted asks about adding or subtracting signed integers, so how is it relevant? I am starting with unsigned integers. And your second link is asking about overflow on the unsigned integers, which doesn&#39;t exist in my case, by definition."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1572994288, "post_id": 58720505, "comment_id": 103734003, "body": "I mentioned it because it discusses how to detect integer overflow in general, which you&#39;re asking about. Other replies and comments in that thread also discuss unsigned integer &quot;overflow&quot; (in-quotes because unsigned integers don&#39;t overflow the same way that signed integers do)."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1572994589, "post_id": 58720505, "comment_id": 103734104, "body": "On a system that doesn&#39;t use 2&#39;s complement, there&#39;s no guarantee that an unsigned value will fit in a signed integer modulo 2^n. For example, a 1&#39;s complement <code>int8_t</code> can only hold values -127 to 127, so cannot hold 128 modulo 256."}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1572994704, "post_id": 58720505, "comment_id": 103734126, "body": "@interjay Yes, I understand that some range can be lost. That is why I updated the title of the question to say &quot;with minimal loss of result range&quot;. So, in your example, I want code that only loses 1 of the 256 values. I will accept code that is UB in the case that is unrepresentable as <code>int</code>. Bonus if you can catch it with an assertion."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572996877, "post_id": 58720505, "comment_id": 103734710, "body": "The text you quoted is wrong  (out-of-range assignment is implementation-defined, not undefined)."}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997015, "post_id": 58720505, "comment_id": 103734739, "body": "@M.M By &quot;modulo-2^32 conversion&quot;, I mean that the input and output of the conversion should have the same value modulo 2^32. I&#39;ve edited the first paragraph, to hopefully leave no doubts about the behavior I want in all cases."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997394, "post_id": 58720505, "comment_id": 103734828, "body": "<code>delta&gt;=0</code> is always true because delta is an unsigned variable"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997562, "post_id": 58720505, "comment_id": 103734870, "body": "@M.M. Right, <code>delta&gt;=0</code> always. The problem is when <code>delta &gt; INT_MAX</code>... how do you do the conversion in a way that does not change the value modulo 2^32."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997639, "post_id": 58720505, "comment_id": 103734893, "body": "&quot;Assume the difference is in the range of a normal int&quot; is also unclear  , as if <code>delta &gt; INT_MAX</code> then it is not in range of an int . Can you give an example of what you had in mind for an out-of-range answer?"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997863, "post_id": 58720505, "comment_id": 103734947, "body": "@M.M. OK, to be pedantic, the underlying counters are unbounded integers, and these unbounded integers have a difference in the range of a normal <code>int</code> before they get reduced modulo 2^32. It should be clear enough from the fact that I am using TCP sequence numbers as an example."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572998192, "post_id": 58720505, "comment_id": 103735025, "body": "Are you saying that you might call the function with arguments that are not <code>uint32_t</code> values?"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572998334, "post_id": 58720505, "comment_id": 103735065, "body": "@M.M No, I didn&#39;t say that. I&#39;ve edited the question; now I think it&#39;s blood-curdlingly precise what the inputs and outputs are."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572998549, "post_id": 58720505, "comment_id": 103735134, "body": "Also can you return <code>int32_t</code> instead? Or are you intending to support systems with 16-bit int?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572999046, "post_id": 58720505, "comment_id": 103735244, "body": "Is <a href=\"https://stackoverflow.com/a/56854468/1505939\">this answer</a> suitable?"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1573000811, "post_id": 58720505, "comment_id": 103735614, "body": "@M.M I don&#39;t think the type pun given in that answer is correct. As interjay has noted, the system might not use 2&#39;s complement representation for signed integers."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1573001766, "post_id": 58720505, "comment_id": 103735820, "body": "@personal_cloud <code>int32_t</code> is guaranteed to use 2&#39;s complement representation (this is covered on that answer)"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1573005944, "post_id": 58720505, "comment_id": 103736647, "body": "@M.M The OP on that question replied to that answer, stating that there is no documentation to support that <code>int32_t</code> has to be two&#39;s complement, nor that a type pun is any more portable than a regular typecast."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1573014360, "post_id": 58720505, "comment_id": 103738302, "body": "@personal_cloud The OP comment was incorrect (the fact that OP could not see documentation does not mean that there is none).  See the comment by user2162550 (Jul 10 2019)"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1573085575, "post_id": 58720505, "comment_id": 103770278, "body": "@M.M. Ah, yes! I see it now, he&#39;s got the 7.20.1.1 reference right there. Sorry I missed it before. So yes, you&#39;re right, I would accept a solution based on <code>int32_t</code> with some form of type pun, as it meets my stricter criteria at the end of my question (no conditionals). This should safely weed out (non-existent) one&#39;s complement systems, and therefore be safe. And yes, returning <code>int32_t</code> from <code>sub_tcp_sn</code> is a great idea too. Thank you."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1573090324, "post_id": 58720505, "comment_id": 103771278, "body": "@personal_cloud ok, would you agree with linking (duplicate) this question to the other one? It seems substantially the same,  the range limit on the other question is a small detail"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "edited": false, "score": 0, "creation_date": 1573156145, "post_id": 58720505, "comment_id": 103799620, "body": "@ M.M Sure, if you can remove the range limit from the other question, and include my examples about wrapping around 0, and basically rewrite the other question so that it is not full of examples that fail when wrapping around 0. Note that I have previously had difficulties broadening a question on SO. But maybe OK in this case, since I don&#39;t (presently) see any <i>answers</i> to that question that break around 0."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1572997215, "post_id": 58721029, "comment_id": 103734788, "body": "This seems worse in every respect than <code>return delta;</code>"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997288, "post_id": 58721029, "comment_id": 103734805, "body": "@M.M If delta &gt; INT_MAX, then <code>return delta</code> is implementation dependent. The code in this answer works in all C implementations so long as the result is representable."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997703, "post_id": 58721029, "comment_id": 103734907, "body": "where does the question say it&#39;s OK if the result is not representable?"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572997734, "post_id": 58721029, "comment_id": 103734915, "body": "@M.M Third sentence of the question: &quot;Assume the difference is in the range of a normal int.&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572998304, "post_id": 58721029, "comment_id": 103735056, "body": "This code causes undefined behaviour on normal systems for  <code>sub_tcp_sn(2147483648, 4294967296)</code>. The difference between the two is INT_MIN which is in range of a normal int, presumably"}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1572998773, "post_id": 58721029, "comment_id": 103735199, "body": "@M.M Good catch. I guess it is impossible to directly convert either <code>delta</code> or <code>-delta</code> to <code>int</code> in that case...  I&#39;ve updated the answer to upcast to <code>int64_t</code> and check range first."}, {"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 1, "creation_date": 1573159918, "post_id": 58721029, "comment_id": 103801171, "body": "I think you use <code>int</code> directly with <code>-(int)(-delta-1)-1</code> or <code>-(int)~delta-1</code>."}, {"owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "reply_to_user": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 0, "creation_date": 1573193041, "post_id": 58721029, "comment_id": 103809230, "body": "@nwellnhof. Yes, I like that simplification. That way we don&#39;t need a 64-bit type unless we want to check that the result is representable. I have updated the answer."}], "tags": [], "owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "is_accepted": true, "score": 0, "last_activity_date": 1573193337, "last_edit_date": 1573193337, "creation_date": 1572996951, "answer_id": 58721029, "question_id": 58720505, "link": "https://stackoverflow.com/questions/58720505/how-to-convert-uint-to-int-in-c-with-minimal-loss-of-result-range/58721029#58721029", "title": "How to convert uint to int in C with minimal loss of result range", "body": "<p>There must be a standard function that does this... but in the meantime:</p>\n\n<pre><code>#include &lt;stdint.h&gt;  // uint32_t\n#include &lt;limits.h&gt;  // INT_MAX\n#include &lt;assert.h&gt;  // assert\n\nstatic inline int sub_tcp_sn(uint32_t a, uint32_t b)\n{\n    uint32_t delta = a - b;\n    return delta &lt;= INT_MAX ? delta : -(int)~delta - 1;\n}\n</code></pre>\n\n<p>Note that it is UB in the case that the result is not representable, but the question said that was OK.</p>\n\n<p>If the system has a 64-bit <code>long long</code> type, then the range can easily be customized and checked as well:</p>\n\n<pre><code>typedef long long sint64_t;\n\nstatic inline sint64_t sub_tcp_sn_custom_range(uint32_t a, uint32_t b,\n                             sint64_t out_min, sint64_t out_max)\n{\n    assert(sizeof(sint64_t) == 8);\n    uint32_t delta = a - b;\n    sint64_t result = delta &lt;= out_max ? delta : -(sint64_t)-delta;\n    assert(result &gt;= out_min &amp;&amp; result &lt;= out_max);\n    return result;\n}\n</code></pre>\n\n<p>For example, <code>sub_tcp_sn_custom_range(0x10000000, 0, -0xf0000000LL, 0x0fffffffLL) == -0xf00000000</code>.</p>\n\n<p>With the range customization, this solution minimizes range loss in all  situations, assuming timestamps behave linearly (for example, no special meaning to wrapping around 0) and a singed 64-bit type is available.</p>\n"}], "owner": {"reputation": 2726, "user_id": 5896591, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71a43ee15bbb5a512cf554b430416e33?s=128&d=identicon&r=PG&f=1", "display_name": "personal_cloud", "link": "https://stackoverflow.com/users/5896591/personal-cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 58721029, "answer_count": 1, "score": 6, "last_activity_date": 1573193337, "creation_date": 1572993423, "last_edit_date": 1573085178, "question_id": 58720505, "link": "https://stackoverflow.com/questions/58720505/how-to-convert-uint-to-int-in-c-with-minimal-loss-of-result-range", "title": "How to convert uint to int in C with minimal loss of result range", "body": "<p>I want the difference between two unbounded integers, each represented by a <code>uint32_t</code> value which is the unbounded integer taken modulo 2^32. As in, for example, TCP sequence numbers. Note that the <em>modulo 2^32</em> representation can wrap around 0, unlike <a href=\"https://stackoverflow.com/questions/56854354/\">more restricted questions that do not allow wrapping around 0</a>.</p>\n\n<p>Assume that the difference between the underlying unbounded integers are in the range of a normal <code>int</code>. I want this signed difference value. In other words, return a value within the normal <code>int</code> range that is equivalent to the difference of the two uint32_t inputs modulo 2^32.</p>\n\n<p>For example, <code>0 - 0xffffffff = 1</code> because we assume that the underlying unbounded integers are in <code>int</code> range. Proof: if A mod 2^32 = 0 and B mod 2^32 = 0xffffffff, then (A=0, B=-1) (mod 2^32) and therefore (A-B=1) (mod 2^32) and in the <code>int</code> range this modulo class has the single representative <code>1</code>.</p>\n\n<p>I have used the following code:</p>\n\n<pre><code>static inline int sub_tcp_sn(uint32_t a, uint32_t b)\n{\n    uint32_t delta = a - b;\n\n    // this would work on most systems\n    return delta;\n\n    // what is the language-safe way to do this?\n}\n</code></pre>\n\n<p>This works on most systems because they use modulo-2^32 representations for both <code>uint</code> and <code>int</code>, and a normal modulo-2^32 subtraction is the only reasonable assembly code to generate here.</p>\n\n<p>However, I believe that the C standard only defines the result of the above code if <code>delta&gt;=0</code>. For example on <a href=\"https://stackoverflow.com/questions/5129498/how-to-cast-or-convert-an-unsigned-int-to-int-in-c\">this question</a> one answer says:</p>\n\n<blockquote>\n  <p>If we assign an out-of-range value to an object of signed type, the\n  result is undefined. The program might appear to work, it might crash,\n  or it might produce garbage values.</p>\n</blockquote>\n\n<p>How should a modulo-2^32 conversion from <code>uint</code> to <code>int</code> be done according to the C standard?</p>\n\n<p>Note: I would prefer the answer code not to involve conditional expressions, unless you can prove it's required. (case analysis in the explanation of the code is OK).</p>\n"}, {"tags": ["c", "arrays", "dynamic-memory-allocation"], "answers": [{"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": true, "score": 0, "last_activity_date": 1572991541, "creation_date": 1572991541, "answer_id": 58720189, "question_id": 58720126, "link": "https://stackoverflow.com/questions/58720126/c-style-coding-and-dynamic-arrays/58720189#58720189", "title": "C style coding and dynamic arrays", "body": "<p>In C++ you need to do the <code>(char*)</code> cast, but when compiled for C, void* will freely convert to any other pointer type. </p>\n\n<p>If the code is potentially shared between the languages, then putting the cast in costs nothing.</p>\n"}, {"tags": [], "owner": {"reputation": 2416, "user_id": 12188799, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x2Us7lDjK_k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbvJBo6jnFH2eAReBMTWM_XkFHSw/photo.jpg?sz=128", "display_name": "Javier Silva Ort&#237;z", "link": "https://stackoverflow.com/users/12188799/javier-silva-ort%c3%adz"}, "is_accepted": false, "score": 0, "last_activity_date": 1572992030, "creation_date": 1572992030, "answer_id": 58720285, "question_id": 58720126, "link": "https://stackoverflow.com/questions/58720126/c-style-coding-and-dynamic-arrays/58720285#58720285", "title": "C style coding and dynamic arrays", "body": "<p>The function <a href=\"https://en.cppreference.com/w/c/memory/malloc\" rel=\"nofollow noreferrer\">malloc</a> returns a void pointer to the beginning of the allocated memory block. In C, void pointers can be implicitly and explicitly casted to any type, that's why those two lines of code are essentially identical in C.</p>\n"}], "owner": {"reputation": 5, "user_id": 12222913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3d6da402ddbb7089ed2e5a35e96a06?s=128&d=identicon&r=PG&f=1", "display_name": "T-Bone", "link": "https://stackoverflow.com/users/12222913/t-bone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1572991769, "accepted_answer_id": 58720189, "answer_count": 2, "score": 0, "last_activity_date": 1572992030, "creation_date": 1572991176, "last_edit_date": 1572991450, "question_id": 58720126, "link": "https://stackoverflow.com/questions/58720126/c-style-coding-and-dynamic-arrays", "closed_reason": "Duplicate", "title": "C style coding and dynamic arrays", "body": "<p>This question is regarding <code>malloc</code> in C associated with structs or arrays.  I noticed there are 2 ways to allocate memory and I cannot tell the difference between them.</p>\n\n<pre><code>char* arr = (char*) malloc(capacity * sizeof(char));\n</code></pre>\n\n<p>versus</p>\n\n<pre><code>char* arr =  malloc(capacity * sizeof(char));\n</code></pre>\n\n<p>What is with the extra <code>(char*)</code>?  The code compiles fine without it and executes the same results.</p>\n"}, {"tags": ["c++", "c", "multithreading", "thread-safety", "data-race"], "comments": [{"owner": {"reputation": 741, "user_id": 3706723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w17DE.jpg?s=128&g=1", "display_name": "prhmma", "link": "https://stackoverflow.com/users/3706723/prhmma"}, "edited": false, "score": 0, "creation_date": 1572990201, "post_id": 58719811, "comment_id": 103732646, "body": "what is your expected output? how do you know notification=1 is not happening?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1572990891, "post_id": 58719811, "comment_id": 103732923, "body": "<code>t1</code> will loop at its first line until <code>notification == 1</code>, which only happens at the end of <code>t2</code>. Then they join, reset and start over. So there is no way that the execution could happen in any other sequence."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1572993138, "post_id": 58719811, "comment_id": 103733704, "body": "Theres no synchronization so the assignments are UB. And any kind of reordering has to have no visible side effects so you can&#39;t observe it. At least not without external tools."}, {"owner": {"reputation": 11, "user_id": 12328548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PV6ph9zwCJk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdqP21lrn_r6LXgpTI3AqnGNi-umw/photo.jpg?sz=128", "display_name": "Przemek No", "link": "https://stackoverflow.com/users/12328548/przemek-no"}, "edited": false, "score": 0, "creation_date": 1572994360, "post_id": 58719811, "comment_id": 103734028, "body": "If there reordering have no visible side effects why things like std::atomic_thread_fence exist? ActuallyI looking for some simple example of program where i should use memory bariers, and becous i don&#39;t use them some bad things occur."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1573268300, "post_id": 58719811, "comment_id": 103837669, "body": "@PrzemekNo <code>atomic_thread_fence</code> exists in the context of proper inter thread signaling, for which normal variables by definition can&#39;t be used, as <b>data races are UB</b>"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1573268397, "post_id": 58719811, "comment_id": 103837684, "body": "@Fran&#231;oisAndrieux &quot;<i>At least not without external tools</i>&quot; Tools like <code>ptrace</code>, or the local equivalent."}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1573268598, "post_id": 58720953, "comment_id": 103837708, "body": "&quot;<i>can reorder instructions if they are independent of each other</i>&quot; and if their execution is either certain (barring CPU exceptions?) or don&#39;t produce effect visible outside the execution unit"}], "tags": [], "owner": {"reputation": 11, "user_id": 7776176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1853f65b37c8f0c659ee8c3821425449?s=128&d=identicon&r=PG&f=1", "display_name": "Zagrosss", "link": "https://stackoverflow.com/users/7776176/zagrosss"}, "is_accepted": false, "score": 0, "last_activity_date": 1572996393, "creation_date": 1572996393, "answer_id": 58720953, "question_id": 58719811, "link": "https://stackoverflow.com/questions/58719811/trivial-example-of-reordering-memory-operations/58720953#58720953", "title": "Trivial example of reordering memory operations", "body": "<p>The compiler can indeed reorder your assignments in the function <code>set_values</code>. However, it is not required to do so. In this case it has no reason to reorder anything, since you are assigning constants to all four variables.</p>\n\n<blockquote>\n  <p>Now the program is stuck in infinited loop.</p>\n</blockquote>\n\n<p>This is probably because <code>while(notification != 1);</code> will be optimized to an infinite loop.</p>\n\n<p>With a bit of work, we can find a way to make the compiler reorder the assignment <code>notify = 1</code> before the other statements, see <a href=\"https://godbolt.org/z/GY-pAw\" rel=\"nofollow noreferrer\">https://godbolt.org/z/GY-pAw</a>.\nNotice that the program reads <code>x</code> from the standard input, this is done to force the compiler to read from a memory location. </p>\n\n<p>I've also made the variable <code>notification</code> volatile, so that <code>while(notification != 1);</code> doesn't get optimised away.</p>\n\n<p>You can try this example on your machine, I've been able to consistently fail the assertion using g++9.2 and -O3 running on an Intel Sandy Bridge cpu.</p>\n\n<p>Be aware that the cpu itself can reorder instructions if they are independent of each other, see <a href=\"https://en.wikipedia.org/wiki/Out-of-order_execution\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Out-of-order_execution</a>. This is, however, a bit tricky to test and reproduce consistently.</p>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1573268463, "post_id": 58730905, "comment_id": 103837691, "body": "&quot;<i>access a memory location</i>&quot; ...location of a normal variable, not a synchronization tool (mutex, atomic, semaphore...)"}], "tags": [], "owner": {"reputation": 299, "user_id": 10213726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6d63bca35c340c218268418210be75?s=128&d=identicon&r=PG&f=1", "display_name": "Tootsie", "link": "https://stackoverflow.com/users/10213726/tootsie"}, "is_accepted": false, "score": 0, "last_activity_date": 1573045643, "creation_date": 1573045643, "answer_id": 58730905, "question_id": 58719811, "link": "https://stackoverflow.com/questions/58719811/trivial-example-of-reordering-memory-operations/58730905#58730905", "title": "Trivial example of reordering memory operations", "body": "<p>Your compiler optimizes in unexpected ways but is allowed to do so because you are violating a fundamental rule of the C++ memory model.  </p>\n\n<p>You cannot access a memory location from multiple threads if at least one of them is a writer.</p>\n\n<p>To synchronize, either use a <code>std:mutex</code> or use <code>std:atomic&lt;int&gt;</code> instead of <code>int</code> for your variables</p>\n"}], "owner": {"reputation": 11, "user_id": 12328548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PV6ph9zwCJk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdqP21lrn_r6LXgpTI3AqnGNi-umw/photo.jpg?sz=128", "display_name": "Przemek No", "link": "https://stackoverflow.com/users/12328548/przemek-no"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1573268334, "creation_date": 1572989706, "last_edit_date": 1573268334, "question_id": 58719811, "link": "https://stackoverflow.com/questions/58719811/trivial-example-of-reordering-memory-operations", "title": "Trivial example of reordering memory operations", "body": "<p>I was trying to write some code that allow me to observe reordering of memory operations.</p>\n\n<p>In the fallowing example I expected that on some executions of set_values() order of  assigning values could change. Especialy notification = 1 may  occur before the rest of operations, but in dosn't happend even after thousens of iterations. \nI've compiled code with -O3 optimization.\nHere is youtube material that i'm refering to : <a href=\"https://youtu.be/qlkMbxUbKfw?t=200\" rel=\"nofollow noreferrer\">https://youtu.be/qlkMbxUbKfw?t=200</a></p>\n\n<pre><code>int a{0};\nint b{0};\nint c{0};\nint notification{0};\n\nvoid set_values()\n{\n    a = 1;\n    b = 2;\n    c = 3;\n    notification = 1;\n}\n\nvoid calculate()\n{\n   while(notification != 1);\n   a += b + c;\n}\n\nvoid reset()\n{\n    a = 0;\n    b = 0;\n    c = 0;\n    notification = 0;\n}\n\nint main()\n{\n    a=6; //just to allow first iteration\n\n    for(int i = 0 ; a == 6 ; i++)\n    {\n        reset();\n        std::thread t1(calculate);\n        std::thread t2(set_values);\n\n        t1.join();\n        t2.join();\n        std::cout &lt;&lt; \"Iteration: \" &lt;&lt; i &lt;&lt; \", \" \"a = \" &lt;&lt; a &lt;&lt; std::endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Now the program is stuck in infinited loop. I expect that in some iterations order of instructions in set_values() function can change (due to optimalization on cash memory). For example notification = 1 will be executed before c = 3 what will trigger execution of calculate() function and gives a==3 what satisfies the condition of terminating the loop and prove reordering</p>\n\n<p>Or maybe someone can provide other trivial example of code that help observe reordering of memory operations?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572989289, "post_id": 58719686, "comment_id": 103732262, "body": "<code>fread()</code> doesn&#39;t add a null terminator, you need to do that yourself."}, {"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "edited": false, "score": 2, "creation_date": 1572989433, "post_id": 58719686, "comment_id": 103732323, "body": "You try to display int values width %s format; it should be %d. And don&#39;t display the pointer itself but the value it points to (<code>*version</code>, <code>*instructionCount</code> ...)"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1572989496, "post_id": 58719686, "comment_id": 103732346, "body": "What do you <i>think</i> <code>printf(&quot;version: %ls\\n&quot;, version);</code> does?   I think this is wrong."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572989729, "post_id": 58719686, "comment_id": 103732448, "body": "Your code assumes 32-bit ints. You should use <code>uint32_t</code> instead of <code>int</code> for the version. You also have the problem that your code only works on little-endian machines."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1572989548, "creation_date": 1572989548, "answer_id": 58719779, "question_id": 58719686, "link": "https://stackoverflow.com/questions/58719686/read-bin-file-in-c-not-working-as-expected/58719779#58719779", "title": "Read bin file in C not working as expected", "body": "<p>The version number is an <code>int</code>, not a string. You need to use <code>%d</code> format, and dereference the pointer.</p>\n\n<pre><code>printf(\"version: %d\\n\", *intBuffer);\n</code></pre>\n\n<p>You also need to add a null terminator to <code>charBuffer</code> before using <code>%s</code> to print.</p>\n\n<pre><code>fread(charBuffer, sizeof(char), 4, inputFile);\ncharBuffer[4] = 0;\nprintf(\"Format: %s\\n\", charBuffer);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1496, "user_id": 3590673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5278d6e84901ade37bd33e1bdc2ce8?s=128&d=identicon&r=PG&f=1", "display_name": "csknk", "link": "https://stackoverflow.com/users/3590673/csknk"}, "is_accepted": false, "score": 1, "last_activity_date": 1572989801, "creation_date": 1572989801, "answer_id": 58719830, "question_id": 58719686, "link": "https://stackoverflow.com/questions/58719686/read-bin-file-in-c-not-working-as-expected/58719830#58719830", "title": "Read bin file in C not working as expected", "body": "<p>It looks like you're trying to print integer data as a char with this line:</p>\n\n<pre><code>printf(\"version: %ls\\n\", version);\n</code></pre>\n\n<p>Because the data (an integer) can't be represented as an ASCII character, your terminal outputs the weird cube.</p>\n\n<p>Try:</p>\n\n<pre><code>printf(\"version: %d\\n\", *version);\n</code></pre>\n\n<p>This should de-reference your integer pointer, and print it as a \"raw\" integer.</p>\n"}, {"tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": false, "score": 1, "last_activity_date": 1572992058, "creation_date": 1572992058, "answer_id": 58720288, "question_id": 58719686, "link": "https://stackoverflow.com/questions/58719686/read-bin-file-in-c-not-working-as-expected/58720288#58720288", "title": "Read bin file in C not working as expected", "body": "<p>I would probably start with something like this</p>\n\n<pre><code>\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct\n{\n  char format[5];\n  uint32_t version;\n  uint32_t instruction_count;\n  uint32_t variable_count;\n  uint32_t *instructions;\n} VmInfo;\n\nuint32_t\nu32_from_LE_bytes(const uint8_t *bytes)\n{\n  return (((uint32_t)bytes[0])&lt;&lt; 0)|\n         (((uint32_t)bytes[1])&lt;&lt; 8)|\n         (((uint32_t)bytes[2])&lt;&lt;16)|\n         (((uint32_t)bytes[3])&lt;&lt;24);\n}\n\nbool // success\nload_VmInfo(VmInfo *out_info,\n            const char *filename)\n{\n  FILE *input=fopen(filename, \"rb\");\n  if(!input)\n  {\n    return false;\n  }\n  uint8_t raw_header[16];\n  if(fread(raw_header, sizeof(raw_header), 1, input)!=1)\n  {\n    fclose(input);\n    return false;\n  }\n  memcpy(out_info-&gt;format, raw_header, 4);\n  out_info-&gt;format[4]='\\0';\n  out_info-&gt;version=u32_from_LE_bytes(raw_header+4);\n  out_info-&gt;instruction_count=u32_from_LE_bytes(raw_header+8);\n  out_info-&gt;variable_count=u32_from_LE_bytes(raw_header+12);\n  const size_t amount=out_info-&gt;instruction_count*sizeof(uint32_t);\n  out_info-&gt;instructions=(uint32_t *)malloc(amount);\n  if(!out_info-&gt;instructions)\n  {\n    abort();\n  }\n  if(fread(out_info-&gt;instructions, amount, 1, input)!=1)\n  {\n    fclose(input);\n    free(out_info-&gt;instructions);\n    return false;\n  }\n  for(uint32_t i=0; i&lt;out_info-&gt;instruction_count; ++i)\n  {\n    const uint8_t *bytes=(const uint8_t *)out_info-&gt;instructions+i;\n    out_info-&gt;instructions[i]=u32_from_LE_bytes(bytes);\n  }\n  fclose(input);\n  return true;\n}\n\nint\nmain(void)\n{\n  VmInfo info;\n  if(!load_VmInfo(&amp;info, \"test1.bin\"))\n  {\n    fprintf(stderr,\"bad VM file\\n\");\n    return 1;\n  }\n  printf(\"format: %s\\n\", info.format);\n  printf(\"version: %u\\n\", info.version);\n  printf(\"instruction_count: %u\\n\", info.instruction_count);\n  printf(\"variable_count: %u\\n\", info.variable_count);\n  for(uint32_t i=0; i&lt;info.instruction_count; ++i)\n  {\n    printf(\"  %u\\n\", info.instructions[i]);\n  }\n  free(info.instructions);\n  return 0;\n}\n</code></pre>\n\n<p>Oops, sorry I'm a bit late, I didn't see the accepted answer while I was writing.</p>\n"}], "owner": {"reputation": 827, "user_id": 8524732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uzdr.jpg?s=128&g=1", "display_name": "xDrago", "link": "https://stackoverflow.com/users/8524732/xdrago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58719779, "answer_count": 3, "score": 1, "last_activity_date": 1572992058, "creation_date": 1572989054, "last_edit_date": 1572989220, "question_id": 58719686, "link": "https://stackoverflow.com/questions/58719686/read-bin-file-in-c-not-working-as-expected", "title": "Read bin file in C not working as expected", "body": "<p>Hey currently i have to do some exercises for a class but I am stuck. I am a bloody beginner in C and have to write a vm.</p>\n\n<p>I am trying to read a .bin file to get information like format, version, amount of instructions ...</p>\n\n<p>thats my code</p>\n\n<pre><code>FILE *inputFile;\nchar *charBuffer;\nint *intBuffer;\nlong filelen;\nchar *inputPath = argv[i + 1];\ninputFile = fopen(inputPath, \"r\");\nfseek(inputFile, 0, SEEK_END);         \nfilelen = ftell(inputFile);             \nrewind(inputFile);\ncharBuffer = (char *)malloc((filelen+1)*sizeof(char));\nintBuffer = (int *)malloc((filelen+1)*sizeof(int));\n\nfread(charBuffer, sizeof(char), 4, inputFile);\n\nchar *format = charBuffer;\nprintf(\"format: %s\\n\", format);\n\nfread(intBuffer, sizeof(int), 1, inputFile);\nint *version = intBuffer;\nprintf(\"version: %ls\\n\", version);\n\nfread(intBuffer, sizeof(int), 1, inputFile);\nint *instructionCount = intBuffer;\nprintf(\"instruction Count: %ls\\n\", instructionCount);\n\nfread(intBuffer, sizeof(int), 1, inputFile);\nint *variables = intBuffer;\nprintf(\"variable Count: %ls\\n\", variables);\n</code></pre>\n\n<p>and that is the output: </p>\n\n<p><a href=\"https://i.stack.imgur.com/vlvlO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vlvlO.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>NJBF is correct but I was expected a 2 for version. Why is that such a weird cube with numbers in it? Why are Instructions and variables empty? </p>\n\n<p>Unfortunately the class is only once per week and I cannot ask the instructor.</p>\n\n<p>Thats what is in the <code>test1.bin</code> opened with <code>hexdump</code></p>\n\n<pre><code>00000000  4e 4a 42 46 02 00 00 00  0b 00 00 00 00 00 00 00  |NJBF............|\n00000010  03 00 00 01 04 00 00 01  00 00 00 02 0a 00 00 01  |................|\n00000020  06 00 00 01 00 00 00 03  00 00 00 04 00 00 00 08  |................|\n00000030  0a 00 00 01 00 00 00 0a  00 00 00 00              |............|\n0000003c\n</code></pre>\n\n<p>These are the rules:</p>\n\n<pre><code>  4 bytes        'N', 'J', 'B', 'F' (identifies the format)\n  4 bytes        version number (must match the VM's version number)\n  4 bytes        number of instructions contained in the file\n  4 bytes        number of variables in the static data area\n  n * 4 bytes    instructions (the program to be executed)\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "stack", "strtok"], "answers": [{"comments": [{"owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "edited": false, "score": 0, "creation_date": 1572989446, "post_id": 58719515, "comment_id": 103732326, "body": "Thanks a lot, that worked! Do you perhaps know why it worked if I allocated <code>req</code> dynamically?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "edited": false, "score": 1, "creation_date": 1572989606, "post_id": 58719515, "comment_id": 103732393, "body": "Anything can happen when you cause undefined behavior, including the appearance of working correctly."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1572988227, "creation_date": 1572988227, "answer_id": 58719515, "question_id": 58719432, "link": "https://stackoverflow.com/questions/58719432/segmentation-fault-in-strtok-r-on-stack-string/58719515#58719515", "title": "Segmentation fault in strtok_r on stack string", "body": "<p>From the <a href=\"https://linux.die.net/man/3/strtok_r\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>The <code>saveptr</code> argument is a pointer to a <code>char *</code> variable that is used internally by s<code>trtok_r()</code> in order to maintain context between successive calls that parse the same string.</p>\n</blockquote>\n\n<p>You've provided an uninitialized pointer, not a pointer to a <code>char *</code> variable. When it tries to dereference the pointer, undefined behavior occurs.</p>\n\n<p>Declare the variable as <code>char *</code>, and pass a pointer to the variable using <code>&amp;</code>.</p>\n\n<pre><code>int main() {\n    char req[256];\n    //char* req = malloc(256 * sizeof(char));\n    strcpy(req, \"hello\\r\\nversion 1.0\\r\\n\\r\\n\");\n    char* lineSavePtr;\n    char* line = strtok_r(req, \"\\r\\n\", &amp;lineSavePtr);\n}\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 5495101, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1b048d0ab898b4ef2a40fbac49b7f35?s=128&d=identicon&r=PG&f=1", "display_name": "altermetax", "link": "https://stackoverflow.com/users/5495101/altermetax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58719515, "answer_count": 1, "score": 0, "last_activity_date": 1572988227, "creation_date": 1572987775, "question_id": 58719432, "link": "https://stackoverflow.com/questions/58719432/segmentation-fault-in-strtok-r-on-stack-string", "title": "Segmentation fault in strtok_r on stack string", "body": "<p>I'm getting a segmentation fault in <code>strtok_r</code> in the following piece of code and I've spent a few hours trying to figure out why. Answers on other pages say you can't modify a string literal, but (as far as I know) I'm not.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char req[256];\n    //char* req = malloc(256 * sizeof(char));\n    strcpy(req, \"hello\\r\\nversion 1.0\\r\\n\\r\\n\");\n    char** lineSavePtr;\n    char* line = strtok_r(req, \"\\r\\n\", lineSavePtr);\n}\n</code></pre>\n\n<p>If I switch the declaration of <code>req</code> to the dynamic one, it works. It also works if I use <code>strtok</code> instead of <code>strtok_r</code>, so I'm guessing it might have something to do with <code>lineSavePtr</code>?</p>\n\n<p>Thanks a lot for any answers.</p>\n"}, {"tags": ["c", "quicksort"], "comments": [{"owner": {"reputation": 352, "user_id": 10330277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gtvew.png?s=128&g=1", "display_name": "sushibossftw", "link": "https://stackoverflow.com/users/10330277/sushibossftw"}, "edited": false, "score": 0, "creation_date": 1572988743, "post_id": 58719381, "comment_id": 103732093, "body": "Please fix your indentation."}, {"owner": {"reputation": 57, "user_id": 12293801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ed0kCJi2KkY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqDolv03gZmm932OjCOeevCKYw_A/photo.jpg?sz=128", "display_name": "sushiwithoutsushi", "link": "https://stackoverflow.com/users/12293801/sushiwithoutsushi"}, "reply_to_user": {"reputation": 352, "user_id": 10330277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gtvew.png?s=128&g=1", "display_name": "sushibossftw", "link": "https://stackoverflow.com/users/10330277/sushibossftw"}, "edited": false, "score": 0, "creation_date": 1572989522, "post_id": 58719381, "comment_id": 103732355, "body": "Sorry, it is now done"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1572999980, "post_id": 58719381, "comment_id": 103735431, "body": "<code>char[MAX*N][MAX];</code> does not declare an array. Post your actual code. Also a VLA is not initialized. If you iterate beyond where you have assigned values, you invoke <i>Undefined Behavior</i>."}, {"owner": {"reputation": 57, "user_id": 12293801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ed0kCJi2KkY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqDolv03gZmm932OjCOeevCKYw_A/photo.jpg?sz=128", "display_name": "sushiwithoutsushi", "link": "https://stackoverflow.com/users/12293801/sushiwithoutsushi"}, "edited": false, "score": 0, "creation_date": 1573040443, "post_id": 58719381, "comment_id": 103749382, "body": "Even with the declared array it does not work. What is  VLA? And should I write the rest of the code?"}, {"owner": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "edited": false, "score": 0, "creation_date": 1573041112, "post_id": 58719381, "comment_id": 103749761, "body": "Whats is defined by <code>MAX</code> and <code>N</code>, are they related to size of <code>target</code> array and limits of maximum value across all elements in <code>target</code> array?"}, {"owner": {"reputation": 57, "user_id": 12293801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ed0kCJi2KkY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqDolv03gZmm932OjCOeevCKYw_A/photo.jpg?sz=128", "display_name": "sushiwithoutsushi", "link": "https://stackoverflow.com/users/12293801/sushiwithoutsushi"}, "edited": false, "score": 0, "creation_date": 1573047694, "post_id": 58719381, "comment_id": 103753483, "body": "Yes, MAX is the size of the original vector. Then it is duplicated, added to itself and you have an array size MAX<i>N. i.e.:MAX=5, vector={2,4,5,1,3}, target[MAX</i>N]={2,4,1,3,3,5,4,5,1,2}, for N=2."}], "owner": {"reputation": 57, "user_id": 12293801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ed0kCJi2KkY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqDolv03gZmm932OjCOeevCKYw_A/photo.jpg?sz=128", "display_name": "sushiwithoutsushi", "link": "https://stackoverflow.com/users/12293801/sushiwithoutsushi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1573040500, "creation_date": 1572987530, "last_edit_date": 1573040500, "question_id": 58719381, "link": "https://stackoverflow.com/questions/58719381/can-not-print-properly-a-quicksort-arranged-matrix", "title": "Can not print properly a quicksort arranged matrix", "body": "<p>I can not properly print the steps given by the quicksort algorithm. This function works when N=1, which means that the values in the matrix only repeat once, but for N>1 it does not print it properly.</p>\n\n<p>This is for a program I am writing to represent the different sorting algorithms steps with the console.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void quicksort(int *target, int left, int right) {\n\n   char charac[MAX*N][MAX]; // this is the array I am going to print on screen\n\n    if(left &gt;= right)\n        return;\n\n    int i = left, j = right;     \n    int tmp, pivot = target[i];\n    for(;;) {\n\n        while(target[i] &lt; pivot)\n            i++;\n        while(pivot &lt; target[j])\n            j--;\n\n        if(i &gt;= j)\n            break;\n\n        tmp = target[i]; \n        target[i] = target[j]; \n        target[j] = tmp;\n\n        i++; j--; //normal quicksort until here\n\n        for(int k=0;k&lt;MAX*N;k++){ /*Here begin two loops that put the cursor on a certain point on the screen and then gives values to char[][]*/\n\n            GotoXY(k+30,5);\n            for(int l=0;l&lt;MAX;l++){\n                If(l&lt;target[k]) // if the value of the given vector is lower than l writes a space\n                    charac[k][l]=32;\n                 else\n                     charac [k][l]=219; // else a block\n                 printf(\"%c \",charac[k][l]); // print the block or space\n                 GotoXY(k+35,5+l); // go to the next point of the column\n            }\n            printf(\"\\n\");\n        }\n        system(\"cls\"); // clear the screen for the next graph\n    }\n    quicksort(target, left, i-1);\n    quicksort(target, j+1, right);\n}\n</code></pre>\n\n<p>I expect to sort the values properly even if they are repeated but the result are not even close to that. </p>\n\n<p>Here it is for N=1 at the beginning:</p>\n\n<p><a href=\"https://i.imgur.com/uQyj5vq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/uQyj5vqm.png\" alt=\"alt text\" title=\"N=1\"></a></p>\n\n<p>At the end:</p>\n\n<p><a href=\"https://i.imgur.com/r6fE8di.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/r6fE8dim.png\" alt=\"alt text\" title=\"N=1 End\"></a></p>\n\n<p>With N=2 it is generated properly:</p>\n\n<p><a href=\"https://i.imgur.com/3wV1VtE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/3wV1VtEm.png\" alt=\"alt text\" title=\"N=2\"></a></p>\n\n<p>But this is the result:</p>\n\n<p><a href=\"https://i.imgur.com/cd10TVX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/cd10TVXm.png\" alt=\"alt text\" title=\"N=2 End\"></a></p>\n\n<p>It is not even close to something fine.</p>\n\n<p>Thanks for your time.</p>\n"}, {"tags": ["c", "libretro"], "answers": [{"tags": [], "owner": {"reputation": 801, "user_id": 1710519, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c970b786c30c592724d179c312dc097b?s=128&d=identicon&r=PG", "display_name": "stewbasic", "link": "https://stackoverflow.com/users/1710519/stewbasic"}, "is_accepted": true, "score": 0, "last_activity_date": 1574195947, "creation_date": 1574195947, "answer_id": 58942450, "question_id": 58719319, "link": "https://stackoverflow.com/questions/58719319/how-to-trigger-creation-of-savefile/58942450#58942450", "title": "How to trigger creation of savefile", "body": "<p>It is undocumented but intended that auto save does not trigger for a core without content.</p>\n\n<p>Moreover auto save was not triggering for cores which had content but could support no content. This was unintended and recently fixed.</p>\n\n<p>Reference: <a href=\"https://github.com/libretro/RetroArch/issues/9300\" rel=\"nofollow noreferrer\">https://github.com/libretro/RetroArch/issues/9300</a></p>\n"}], "owner": {"reputation": 801, "user_id": 1710519, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c970b786c30c592724d179c312dc097b?s=128&d=identicon&r=PG", "display_name": "stewbasic", "link": "https://stackoverflow.com/users/1710519/stewbasic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58942450, "answer_count": 1, "score": 0, "last_activity_date": 1574195947, "creation_date": 1572987204, "question_id": 58719319, "link": "https://stackoverflow.com/questions/58719319/how-to-trigger-creation-of-savefile", "title": "How to trigger creation of savefile", "body": "<p>I'm trying to create a libretro core. It will be a standalone game, so I'm setting <code>RETRO_ENVIRONMENT_SET_SUPPORT_NO_GAME</code> to <code>true</code>. The <a href=\"https://github.com/libretro/libretro-common/blob/master/include/libretro.h#L791\" rel=\"nofollow noreferrer\">documentation</a> suggests that <code>retro_get_memory_*</code> can be used to have data saved without needing to explicitly query <code>RETRO_ENVIRONMENT_GET_SAVE_DIRECTORY</code>:</p>\n\n<blockquote>\n  <p>The save directory should be used to\n  store SRAM, memory cards, high scores, etc, if the libretro core\n  cannot use the regular memory interface (retro_get_memory_data()).</p>\n</blockquote>\n\n<p><strong>How should the core trigger the saving of data using this interface? Or am I misunderstanding the documentation?</strong></p>\n\n<p>I would expect the frontend to call <code>retro_get_memory_{data,size}</code>, read from the exposed buffer when stopping the core, persist the data to disk, and write it back to the exposed buffer the next time the core starts. Instead I observe:</p>\n\n<ul>\n<li>If I don't provide a content file, the frontend never calls <code>retro_get_memory_{data,size}</code>.</li>\n<li>If I provide a content file (which is unused), the frontend calls <code>retro_get_memory_{data,size}</code> after <code>retro_load_game</code> but doesn't write to disk.</li>\n</ul>\n\n<hr>\n\n<p>Note that this question is about <em>save files</em> (automatically persisted data, usually capturing the player's progress), not <em>save states</em> (snapshots of the game state triggered by the user) which are implemented by the <code>*serialize*</code> methods.</p>\n\n<hr>\n\n<p>Here is a simple example to reproduce the issue (based on <a href=\"https://github.com/libretro/libretro-samples/blob/master/video/software/rendering/libretro-test.c\" rel=\"nofollow noreferrer\">this sample</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"libretro.h\"\n\nstatic unsigned char c = 0;\n\nvoid* retro_get_memory_data(unsigned id) {\n  fprintf(stderr, \"retro_get_memory_data(%d)\\n\", id);\n  return (id == RETRO_MEMORY_SAVE_RAM) ? &amp;c : NULL;\n}\n\nsize_t retro_get_memory_size(unsigned id) {\n  fprintf(stderr, \"retro_get_memory_size(%d)\\n\", id);\n  return (id == RETRO_MEMORY_SAVE_RAM) ? 1 : 0;\n}\n\n#define WIDTH 320\n#define HEIGHT 240\n\nstatic uint32_t* frame_buf;\n\nvoid retro_init(void) { frame_buf = calloc(WIDTH * HEIGHT, sizeof(uint32_t)); }\n\nvoid retro_deinit(void) {\n  free(frame_buf);\n  frame_buf = NULL;\n}\n\nunsigned retro_api_version(void) { return RETRO_API_VERSION; }\n\nvoid retro_get_system_info(struct retro_system_info* info) {\n  memset(info, 0, sizeof(*info));\n  info-&gt;library_name = \"SaveTest\";\n  info-&gt;library_version = \"v1\";\n  info-&gt;need_fullpath = false;\n  info-&gt;valid_extensions = NULL;  // Anything is fine, we don't care.\n}\n\nstatic retro_video_refresh_t video_cb;\nstatic retro_environment_t environ_cb;\nstatic retro_input_poll_t input_poll_cb;\nstatic retro_input_state_t input_state_cb;\n\nvoid retro_set_input_poll(retro_input_poll_t cb) { input_poll_cb = cb; }\nvoid retro_set_input_state(retro_input_state_t cb) { input_state_cb = cb; }\nvoid retro_set_video_refresh(retro_video_refresh_t cb) { video_cb = cb; }\nvoid retro_set_environment(retro_environment_t cb) {\n  environ_cb = cb;\n  bool no_content = true;\n  cb(RETRO_ENVIRONMENT_SET_SUPPORT_NO_GAME, &amp;no_content);\n}\n\nvoid retro_get_system_av_info(struct retro_system_av_info* info) {\n  float aspect = (float)WIDTH / HEIGHT;\n\n  info-&gt;timing = (struct retro_system_timing){\n      .fps = 60.0,\n      .sample_rate = 0.0,\n  };\n\n  info-&gt;geometry = (struct retro_game_geometry){\n      .base_width = WIDTH,\n      .base_height = HEIGHT,\n      .max_width = WIDTH,\n      .max_height = HEIGHT,\n      .aspect_ratio = aspect,\n  };\n}\n\nunsigned retro_get_region(void) { return RETRO_REGION_NTSC; }\n\nbool retro_load_game(const struct retro_game_info* info) {\n  enum retro_pixel_format fmt = RETRO_PIXEL_FORMAT_XRGB8888;\n  if (!environ_cb(RETRO_ENVIRONMENT_SET_PIXEL_FORMAT, &amp;fmt)) {\n    fprintf(stderr, \"XRGB8888 is not supported.\\n\");\n    return false;\n  }\n  (void)info;\n  return true;\n}\n\nbool button(unsigned id) {\n  return input_state_cb(0, RETRO_DEVICE_JOYPAD, 0, id);\n}\n\nvoid retro_run(void) {\n  input_poll_cb();\n  if (button(RETRO_DEVICE_ID_JOYPAD_LEFT) &amp;&amp; c &gt; 0) --c;\n  if (button(RETRO_DEVICE_ID_JOYPAD_RIGHT) &amp;&amp; c &lt; 255) ++c;\n  uint32_t color = (255 - c) | (c &lt;&lt; 8);\n  uint32_t* buf = frame_buf;\n  for (unsigned i = WIDTH * HEIGHT; i &gt; 0; --i) {\n    *buf = color;\n    ++buf;\n  }\n  video_cb(frame_buf, WIDTH, HEIGHT, WIDTH * sizeof(uint32_t));\n}\n\nvoid retro_unload_game(void) {}\n\nsize_t retro_serialize_size(void) { return 1; }\nbool retro_serialize(void* data, size_t size) {\n  fprintf(stderr, \"serialize(%p, %lu) &lt;= %u\\n\", data, size, c);\n  *(char*)data = c;\n  return true;\n}\nbool retro_unserialize(const void* data, size_t size) {\n  c = *(char*)data;\n  fprintf(stderr, \"unserialize(%p, %lu) =&gt; %u\\n\", data, size, c);\n  return true;\n}\n\nvoid retro_set_controller_port_device(unsigned port, unsigned device) {}\nvoid retro_set_audio_sample(retro_audio_sample_t cb) {}\nvoid retro_set_audio_sample_batch(retro_audio_sample_batch_t cb) {}\nvoid retro_reset(void) {}\nbool retro_load_game_special(unsigned type, const struct retro_game_info* info,\n                             size_t num) {\n  return false;\n}\nvoid retro_cheat_reset(void) {}\nvoid retro_cheat_set(unsigned index, bool enabled, const char* code) {}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1572986755, "post_id": 58719116, "comment_id": 103731294, "body": "\u27fcThis code could benefit greatly if you adopted an <a href=\"https://en.wikipedia.org/wiki/Indentation_style\" rel=\"nofollow noreferrer\">indentation style</a> and apply it consistently. Indentation conveys structure and intent which makes it easier for us to understand your code without having to invest a lot of time deciphering it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572986793, "post_id": 58719116, "comment_id": 103731309, "body": "You&#39;d also have an easier time here if you had <code>int input[6]</code> instead of six otherwise unrelated variables. This makes loops possible, and from there, all manner of coding possibilities."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572986850, "post_id": 58719116, "comment_id": 103731335, "body": "I think the invalidity tests such as <code>input1 + input2 == input3</code> etc, should be <code>input1 + input2 &lt;= input3</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1572986893, "post_id": 58719116, "comment_id": 103731356, "body": "<code>max1&#47;max2</code> performs integer division with an integer result. Same for mid and min."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1572986982, "post_id": 58719116, "comment_id": 103731389, "body": "Note that <code>a&#47;b == c&#47;d</code> when <code>a*d == b*c</code>. This eliminates the need for division, and floating point numbers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572986984, "post_id": 58719116, "comment_id": 103731390, "body": "...and beware of comparing floating point values. It would be safer to cross-multiply and compare integer values for perfect accuracy (as above)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572993842, "post_id": 58719116, "comment_id": 103733885, "body": "@AntoineMathys the test <code>input1 + input2 == input3</code> checks for a <i>degenerate triangle</i>, i.e one that is flat with area 0. The test <code>input1 + input2 &lt;= input3</code> checks the sides are <i>possible</i>. Sides of 1, 2, and 4 cannot make a triangle."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1573992195, "post_id": 58719116, "comment_id": 104064112, "body": "<code>ratio1 == ratio2 == ratio3</code> should be <code>ratio1 == ratio2 &amp;&amp; ratio1 == ratio3</code>"}], "owner": {"reputation": 11, "user_id": 12328432, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aq9qKDEQUJI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd0RfklfZEe2tgMlybTKHpm30HemA/photo.jpg?sz=128", "display_name": "Baturalp Ince", "link": "https://stackoverflow.com/users/12328432/baturalp-ince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573991825, "creation_date": 1572986300, "last_edit_date": 1573991825, "question_id": 58719116, "link": "https://stackoverflow.com/questions/58719116/how-to-understand-if-two-triangles-are-not-identical-but-similar", "title": "How to understand if two triangles are not identical but similar?", "body": "<p>I'm doing a homework. The aim is comparing two triangles according to the input of 3+3 sides by the user. But I got stuck on : \"The triangles are not identical, however, they are similar.\" step. So my code can find the max, mid and min sides of the input however even I set some ratio values. It can't print what I want.</p>\n\n<p>I checked few places about usage of if with doubles and comparing them but can't figure out this one.</p>\n\n<pre><code>int main() {\nint input1, input2, input3, input4, input5, input6;\nprintf(\"Triangle #1:\\n\");\nscanf(\"%d %d %d\", &amp;input1, &amp;input2, &amp;input3);\n\nif(input1 &lt; 0 || input2 &lt; 0 || input3 &lt; 0 ) {\nprintf(\"Invalid input.\\n\");  \nreturn 0;\n}\n\nif(input1 + input2 == input3 || input1 + input3 == input2 || input2 + \ninput3 == input1 )\n{\nprintf(\"The sides do not form a triangle.\\n\");\nreturn 0;\n}\n\nprintf(\"Triangle #2:\\n\");\nscanf(\"%d %d %d\", &amp;input4, &amp;input5, &amp;input6);\n\nint max1, max2, min1, min2, mid1, mid2;\n\nif (input1 &gt; input2 &amp;&amp; input1 &gt; input3) {\nmax1 = input1;\nif (input2 &gt; input3) {\nmid1 = input2;\nmin1 = input3;\n}\nelse {\nmid1 = input3;\nmin1 = input2;\n}\n}  \n//five more similar if blocks after this one: because there would be \n//3 different max value each triangle so 6 different block.\n\ndouble ratio1 = max1/max2;\ndouble ratio2 = mid1/mid2;\ndouble ratio3 = min1/min2;\n\nif (max1 == max2 || mid1 == mid2 || min1 == min2) {\nprintf(\"The triangles are identical.\\n\");\n}\nelse if (ratio1 == ratio2 == ratio3) {\nprintf(\"The triangles are not identical, however, they are \nsimilar.\\n\");\n}\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>I expected the code to prinout this last with the else statement including ratio1, ratio2, ratio3 section which I enter two triangle inputs like \"3-4-5\" and \"6-8-10\".    </p>\n\n<p>Also, if I can fix this. I might need to input \" 3 4 abcd\" kind of stuff and I need to give invalid input output message again, so it would be great if you can also help me about that.</p>\n"}, {"tags": ["c", "gcc", "makefile"], "comments": [{"owner": {"reputation": 1820, "user_id": 6797552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196e325077d7a6e974c49ccaea2681c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shmuel H.", "link": "https://stackoverflow.com/users/6797552/shmuel-h"}, "edited": false, "score": 1, "creation_date": 1572983153, "post_id": 58718362, "comment_id": 103729805, "body": "What are dependency files?"}, {"owner": {"reputation": 22660, "user_id": 360899, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/aed1b37bc11c126adfcfb028d8bd9916?s=128&d=identicon&r=PG", "display_name": "lesmana", "link": "https://stackoverflow.com/users/360899/lesmana"}, "edited": false, "score": 0, "creation_date": 1572983256, "post_id": 58718362, "comment_id": 103729842, "body": "don&#39;t you mean to include the dependency files? please explain more what you mean with dependency file and/or post content of one dependency file as example."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 6, "creation_date": 1572983336, "post_id": 58718362, "comment_id": 103729872, "body": "Don&#39;t add the <code>.d</code> files to your link line.  They are for make, not for the linker.  You don&#39;t need this to be a prerequisite of your link line anyway: it tells how to rebuild <i>object</i> files."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1572983415, "post_id": 58718362, "comment_id": 103729900, "body": "If you don&#39;t follow conventions, you will find yourself experiencing these issues. <code>.d</code> files aren&#39;t, by convention, C files. In C you get <code>.h</code> files (headers), and <code>.c</code> files (source files). Some people use <code>.inc</code> for files they include that include source / data later included in a <code>.c</code> file."}], "owner": {"reputation": 1, "user_id": 12328245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86648e3f7ea1a857150e10d1f75eda4d?s=128&d=identicon&r=PG&f=1", "display_name": "chicxulub", "link": "https://stackoverflow.com/users/12328245/chicxulub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572982918, "creation_date": 1572982918, "question_id": 58718362, "link": "https://stackoverflow.com/questions/58718362/gcc-appears-to-be-confusing-c-d-dependency-files-with-d-language-source-code", "title": "GCC appears to be confusing C *.d dependency files with D language source code", "body": "<p>When I compile my code, gcc appears to be confusing the .d files in my gcc options with D programming language source, and complains that it can't find the \"cc1d\" compiler. In summary, I get the following output when I run 'make':</p>\n\n<pre><code>gcc -c -I. -IUnity/src/ -Isrc/ -Ilib/ -DTEST test/Testworker.c -o build/objs/Testworker.o\ngcc -c -I. -IUnity/src/ -Isrc/ -Ilib/ -DTEST src/worker.c -o build/objs/worker.o\ngcc -o build/Testworker.out build/objs/Testworker.o build/objs/worker.o Unity/src/unity.o build/depends/Testworker.d\ngcc: error trying to exec 'cc1d': execvp: No such file or directory\nMakefile:56: recipe for target 'build/Testworker.out' failed\nmake: *** [build/Testworker.out] Error 1\n</code></pre>\n\n<p>How can I tell gcc that I really mean that my *.d files are dependencies, rather than more source files? </p>\n\n<p>I tried renaming my intermediate *.d files to *.dep in my Makefile, but gcc doesn't recognize these, either...</p>\n\n<p>My Makefile rule that is causing problems is this one:</p>\n\n<pre><code>$(PATHB)Test%.$(TARGET_EXTENSION): $(PATHO)Test%.o $(PATHO)%.o $(PATHU)unity.o $(PATHD)Test%.d\n    $(LINK) -o $@ $^\n</code></pre>\n\n<p>The dependent Makefile rule to build the .d files is working fine:</p>\n\n<pre><code>    $(DEPEND) $@ $&lt;\n</code></pre>\n\n<p>and I know that my .d files are being made. My one issue is when the</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5818, "user_id": 978558, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d023acf70b927cb813b48631195e346e?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/978558/fredrik"}, "edited": false, "score": 2, "creation_date": 1572982607, "post_id": 58718244, "comment_id": 103729560, "body": "This is not <code>alias</code> - this is pointers. <code>&amp;alias</code> gives you a pointer to the memory location where <code>alias</code> is - which in turn points to a memory location where <code>struct T</code> is located"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1572982747, "post_id": 58718244, "comment_id": 103729636, "body": "Your definition is most misleading. Two <i>pointers</i> can <i>point</i> to the same location. I don&#39;t like the wording &quot;have the same location associated&quot;. They literally <i>store</i> the location of other variables."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572982986, "post_id": 58718244, "comment_id": 103729729, "body": "&quot;Alias&quot; has a very specific meaning and this is not one of them. These are independent pointers that happen to share the same value, not aliases. In other languages (e.g. C++) there are more alias-like features such as references where two things can be considered the same, modifying one reference modifies all other references to the same thing since they&#39;re one and the same."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 11923505, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-C6rwhQ11j2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9jkyB24w3AUZ5sNzK1lOdvZn_Uw/photo.jpg?sz=128", "display_name": "C. R. Ward", "link": "https://stackoverflow.com/users/11923505/c-r-ward"}, "is_accepted": false, "score": -1, "last_activity_date": 1572983265, "creation_date": 1572983265, "answer_id": 58718436, "question_id": 58718244, "link": "https://stackoverflow.com/questions/58718244/understanding-alias-in-c/58718436#58718436", "title": "understanding alias in C", "body": "<p>There is a simple rule that usually holds for <code>block-statement</code> (e.g., <code>{...}</code>): <code>(a)</code> Considering automatic allocation (or the allocation that occurs <em>because of</em> a function call <em>upon the stack</em>) and <code>(b)</code> Considering user allocation (or the allocation that occurs <em>because of</em> the size of a <code>struct</code> or <code>union</code>):</p>\n\n<p>In the case of <code>(a)</code>, the <code>sizeof operator</code> is <code>summed</code> to determine the amount of <code>stack allocation</code>.</p>\n\n<p>In the case of <code>(b)</code>, the <code>sizeof operator</code> is <code>multiplied</code> to determine the location of <code>array offset</code>.</p>\n\n<p><em>The caveat is that other storage classes can have different outcomes, but these are typically the ones you will have the most experience with when programming in C.</em></p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1582135519, "last_edit_date": 1582135519, "creation_date": 1572983385, "answer_id": 58718464, "question_id": 58718244, "link": "https://stackoverflow.com/questions/58718244/understanding-alias-in-c/58718464#58718464", "title": "understanding alias in C", "body": "<p>\u201cAlias\u201d simply means an alternative name. In C, what we mean by \u201cname\u201d in the meaning of \u201calias\u201d is an lvalue. According to C 2018 6.3.2.1 1, \u201cAn lvalue is an expression\u2026 that potentially designates an object\u2026\u201d If you have two lvalues for same thing, you have two aliases for the that thing (or you might designate one as the primary name and the other as an alias).</p>\n\n<p>Most simply, after <code>int b;</code>, <code>b</code> is an lvalue for the object named by <code>b</code>. And, after <code>int *p = &amp;b;</code>, <code>*p</code> is an lvalue for the same object. Then <code>b</code> and <code>*p</code> are aliases of the same object.</p>\n\n<p>The meanings of the diagrams you show are unclear. Part of it shows <code>a</code> and <code>b</code> as simple scalar objects. Another part shows them as arrays. Without more context and explanation, it is not possible to interpret it reliably.</p>\n\n<p>If we have an <code>int a[1]</code> and an <code>int b[1]</code>, and the compiler happens to put <code>b</code> in memory immediately after <code>a</code>, then <code>a[1]</code> is in some sense an alias for <code>b[0]</code>, but it is improper to use it, because the rules in the C standard do not define the behavior of accessing an array out of bounds, even if we somehow know what follows it in memory.</p>\n"}], "owner": {"reputation": 1447, "user_id": 6020034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/20fc6f63f649759b7b7c10ca5e7adef0?s=128&d=identicon&r=PG&f=1", "display_name": "mdo123", "link": "https://stackoverflow.com/users/6020034/mdo123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1582135519, "creation_date": 1572982428, "last_edit_date": 1572982839, "question_id": 58718244, "link": "https://stackoverflow.com/questions/58718244/understanding-alias-in-c", "title": "understanding alias in C", "body": "<p>I'm trying to understand how to correctly create an alias.</p>\n\n<p>I'm going off a definition of</p>\n\n<blockquote>\n  <p>Two expressions are aliases of each other if they have the same\n  location associated with them.</p>\n</blockquote>\n\n<p>Below is an image of a box diagram showing memory allocations</p>\n\n<p><a href=\"https://i.stack.imgur.com/KFpNZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KFpNZ.jpg\" alt=\"\"></a></p>\n\n<p>The goal is to create an alias for <code>a[1]</code></p>\n\n<p>The edge of a box is refers to the location and the circle inside refers to the value stored.</p>\n\n<p>I recognized that <code>b[1]</code> has a value which is the address of <code>a[1]</code>.  So</p>\n\n<p><strong>I <em>think</em> in order to create an alias all I have to do is create some variable and assign it the value of <code>b[1]</code>.</strong></p>\n\n<p>To test if my assumption is correct I tried the following:</p>\n\n<pre><code>struct T *alias = *b[2];\n\nprintf(\"alias location is: %p\\n\", alias);\nprintf(\"a[2] location is: %p\\n\", a[2]);\n</code></pre>\n\n<p>Which produces:</p>\n\n<pre><code>alias location is: 0x561936c62320\na[2] location is: 0x561936c62320\n</code></pre>\n\n<p>The addresses match but I'm confused if I did it right. Don't I need to use the <code>&amp;</code> operator in the <code>printf()</code> function in order to print the actual address? When I do that:</p>\n\n<pre><code>struct T *alias = *b[2];\n\nprintf(\"alias location is: %p\\n\", &amp;alias);\nprintf(\"a[2] location is: %p\\n\", &amp;a[2]);\n</code></pre>\n\n<p>I get incorrect addresses:</p>\n\n<pre><code>alias location is: 0x7ffdee2cd320\na[2] location is: 0x7ffdee2cd340\n</code></pre>\n\n<p>Can someone please explain if I'm doing it correctly and if not how to do it correctly?</p>\n"}, {"tags": ["c", "performance", "assembly"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1572986618, "post_id": 58717925, "comment_id": 103731248, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/201907/discussion-on-question-by-dsblizzard-why-is-c-so-much-slower-than-assembly\">moved to chat</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573003875, "post_id": 58717925, "comment_id": 103736255, "body": "Are you sure your GCC is making a 64-bit executable?  7.6x slower might be explained by doing 64-bit math in 32-bit mode."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573013637, "post_id": 58717925, "comment_id": 103738143, "body": "You&#39;re using such a ridiculous amount of memory for your array that I can&#39;t even get FASM to build this on Linux (<code>-m 1024000</code> isn&#39;t large enough, anything larger fails with &quot;failed to allocate memory within 32-bit addressing range&quot; because FASM wants to allocate with <code>MAP_32BIT</code>).  Are you sure you&#39;re not just testing the difference in page-fault throughput between C <code>malloc</code> (after writing it first, even) vs. whatever happens on Windows for that <code>.data</code> section?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573013701, "post_id": 58717925, "comment_id": 103738155, "body": "If this effectively uses the BSS (not storing all those zeros in the executable file), do they end up all mapped to the same physical page of zeros, leading to data cache hits even though you still get TLB misses?  Does the C version also speed up if you don&#39;t write it for initialization, so it stays copy-on-write mapped to a zero page?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573014120, "post_id": 58717925, "comment_id": 103738247, "body": "Also, what CPU are you testing on?  With what GCC version?  GCC&#39;s asm for the loop is not worse than what you wrote by hand (<a href=\"https://godbolt.org/z/3_El_b\" rel=\"nofollow noreferrer\">godbolt.org/z/3_El_b</a>). <i>I heard hundreds of times that hand-written assembly cannot beat c compilers</i>  This is not true.  You certain <i>can</i> when compilers don&#39;t do a perfect job (<a href=\"//stackoverflow.com/a/40356449\">example</a>), it&#39;s just not usually worth the effort, and you have to know <i>exactly</i> what you&#39;re doing.  <b>The difference in your results is probably from how you allocated memory, not from different loop bodies.</b> On my Skylake, <code>gcc -m32</code> is only 2x slower"}, {"owner": {"reputation": 3557, "user_id": 263485, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8a215bd208f603197c8777579b5a4940?s=128&d=identicon&r=PG", "display_name": "DSblizzard", "link": "https://stackoverflow.com/users/263485/dsblizzard"}, "edited": false, "score": 0, "creation_date": 1573022776, "post_id": 58717925, "comment_id": 103740644, "body": "CPU - Athlon II X3 445. gcc - (MinGW.org GCC-6.3.0-1) 6.3.0"}], "owner": {"reputation": 3557, "user_id": 263485, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8a215bd208f603197c8777579b5a4940?s=128&d=identicon&r=PG", "display_name": "DSblizzard", "link": "https://stackoverflow.com/users/263485/dsblizzard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572980888, "creation_date": 1572980888, "question_id": 58717925, "link": "https://stackoverflow.com/questions/58717925/why-is-c-so-much-slower-than-assembly", "title": "Why is C so much slower than assembly?", "body": "<p>Calculations are inspired by scalar product.\nC version:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\n\nint main() {\n    clock_t t0, t1;\n    int64_t n = 10000000; // 10 million\n    int64_t *m = (int64_t*) malloc ((20*n) * sizeof(int64_t));\n    for (int64_t i = 0; i &lt; n; i++) {\n        m[i] = rand() % 1000;\n    }\n    int64_t sum = 0;\n    int64_t k = 0;\n    t0 = clock();\n    for (int64_t i = 0; i &lt; n; i++) {\n        sum += m[k]*m[k+1] + m[k+2]*m[k+3] + m[k+4]*m[k+5] + m[k+6]*m[k+7] + m[k+8]*m[k+9] + m[k+10]*m[k+11] + m[k+12]*m[k+13] + m[k+14]*m[k+15] + m[k+16]*m[k+17] + m[k+18]*m[k+19];\n        k += 20;\n    }\n    t1 = clock();\n    printf(\"%\" PRId64 \"\\n\", sum);\n    float diff = ((float) (t1 - t0) / 1000000.0F ) * 1000;\n    printf(\"%f\", (float) diff);\n}\n</code></pre>\n\n<p>Fasm version:</p>\n\n<p>main file:</p>\n\n<pre><code>format PE64 console\nentry prog\n\ninclude \"win64ax.inc\"\n\n\nsection '.idata' import data readable writeable\n\nlibrary kernel32, 'kernel32.dll', msvcrt, 'msvcrt.dll'\n\nimport kernel32, ExitProcess, 'ExitProcess', GetTickCount, 'GetTickCount'\nimport msvcrt, printf, 'printf'\n\n\nsection '.text' code readable executable\n\nmacro now\n{\n    cinvoke GetTickCount\n    cinvoke printf, &lt;\"%lld\", 13, 10&gt;, rax\n}\n\nprog:\n\nmov r14, temp\nmov r15, 10000000 ; 10 million\nnow\nlbl:\ndec r15\n\ninclude \"temp_code.asm\"\nadd r14, 80\n\ncmp r15, 0\njne lbl\nnow\n\nend_prog:\n    invoke ExitProcess, 0\n\n\nsection '.data' data readable writeable\n    align 8\n    temp dq 100000200 dup(0)\n</code></pre>\n\n<p>temp_code.asm:</p>\n\n<pre><code>mov rbx, 0\nmov rax, [r14 + 0 * 8]\nmov rcx, [r14 + 1 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 2 * 8]\nmov rcx, [r14 + 3 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 4 * 8]\nmov rcx, [r14 + 5 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 6 * 8]\nmov rcx, [r14 + 7 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 8 * 8]\nmov rcx, [r14 + 9 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 10 * 8]\nmov rcx, [r14 + 11 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 12 * 8]\nmov rcx, [r14 + 13 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 14 * 8]\nmov rcx, [r14 + 15 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 16 * 8]\nmov rcx, [r14 + 17 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, [r14 + 18 * 8]\nmov rcx, [r14 + 19 * 8]\nimul rax, rcx\nadd rbx, rax\nmov rax, rbx\n</code></pre>\n\n<p>Best time for fasm is 93 ms, best time for c with compilation options \"gcc.exe -std=c99 -g 1.c -O3 -o 1.exe\" is 710 ms. This is 7.63 times slower.\nI heard hundreds of times that hand-written assembly cannot beat c compilers, and now this... This is speed of supercar to speed of runner. Your explanations?</p>\n"}]