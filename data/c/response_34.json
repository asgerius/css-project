[{"tags": ["c", "assembly", "x86", "nasm", "shellcode"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1441238306, "post_id": 32364974, "comment_id": 52602340, "body": "At least three problems: 1) you didn&#39;t include the data in your shellcode 2) said data contains zero bytes 3) your code is not position independent."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1441239032, "post_id": 32364974, "comment_id": 52602525, "body": "@Jester (2) may or may not actually be a problem depending on what the OP is trying to learn here."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1441240147, "post_id": 32364974, "comment_id": 52602803, "body": "@immibis true, apparently the C standard allows embedded zero bytes in literals."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1441246566, "post_id": 32364974, "comment_id": 52604116, "body": "You can&#39;t use a <code>.data</code> section when trying to generate shell code. As Jester points out that doesn&#39;t allow it to be position independent. Shell code needs to run entirely from the stack to work as expected. To embed strings in shell code and make it available on the stack can usually be done via the jump/call/pop method. You can see this <a href=\"http://www.pentesteracademy.com/video?id=275&amp;utm_source=HT&amp;utm_medium=facebook&amp;utm_campaign=DSM\" rel=\"nofollow noreferrer\">video</a> to get an idea how that technique works."}, {"owner": {"reputation": 245, "user_id": 2395769, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/13da7423003df5f8b49b129bcc96090f?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/2395769/paul"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1441246792, "post_id": 32364974, "comment_id": 52604176, "body": "@MichaelPetch I have switched to that method, but now I have a new set of problems :-) Upon examination of memory, everything looks goods but execve does nothing. I will update my post in a moment."}], "owner": {"reputation": 245, "user_id": 2395769, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/13da7423003df5f8b49b129bcc96090f?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/2395769/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461298377, "creation_date": 1441238166, "last_edit_date": 1441238534, "question_id": 32364974, "link": "https://stackoverflow.com/questions/32364974/nasm-assembled-binary-works-but-shellcode-in-c-causes-segmentation-fault", "title": "NASM assembled binary works, but shellcode in C causes segmentation fault", "body": "<p>I am trying to learn about assembly and shellcode. I am having a problem that has been driving me nuts for days. I have written some assembly to make a system call to execve. The assembled file works, but when I convert it to shellcode and try to run it from a C program, I get a segmentation fault. I have tried all sorts of variations, but nothing works. Currently, the nasm code is as follows:</p>\n\n<pre><code>global _start\n\nsection .data\n    cmd: db '/bin/netcat', 0\n    argv0: db 'netcat', 0\n    argv1: db '127.0.0.1', 0\n    argv2: db '3333', 0\n    argv: dd argv0, argv1, argv2, 0\n\nsection .text\n_start:\n    mov ebx, cmd ; filename parameter\n    mov ecx, argv ; argv parameter\n    xor edx, edx ; envp parameter\n    mov al, 11 ; execve system call number. Moving to al rather than eax to prevent null bytes in shellcode.\n    int 0x80\n\n    ; exit\n    xor ebx, ebx ; status code 0\n    mov al, 1 ; sys_exit\n    int 0x80\n</code></pre>\n\n<p>I assembled this with the following command:</p>\n\n<pre><code>nasm -f elf32 test.asm -o test.o &amp;&amp; ld -m elf_i386 test.o -o test\n</code></pre>\n\n<p>Running test works fine. I obtained the shellcode from test using the command from <a href=\"http://www.commandlinefu.com/commands/view/6051/get-all-shellcode-on-binary-file-from-objdump\" rel=\"nofollow\">this page</a> and of course, replacing ./PROGRAM with ./test.</p>\n\n<p>Finally, I have the following C code:</p>\n\n<pre><code>unsigned char[] = \"\\xbb\\x98\\x90\\x04\\x08\\xb9\\xba\\x90\\x04\\x08\\x31\\xd2\\xb0\\x0b\\xcd\\x80\\xb0\\x01\\x31\\xdb\\xcd\\x80\";\n\nmain()\n{\n    int (*ret)() = (int(*)())code;\n    ret();\n}\n</code></pre>\n\n<p>Compiled with:</p>\n\n<pre><code>gcc -g -m32 -fno-stack-protector -z execstack testshellcode.c -o testshellcode\n</code></pre>\n\n<p>Running testshellcode results in a Segmentation fault. I have tried various things like making code a const, compiling with different flags, and about 1,000 variations of the nasm code. I have successfully run other shellcode that calls execve, but argv was simple in those cases.</p>\n\n<p>Using gdb, I can see it crashes when ret() is called. Looking at the registers after the segmentation fault:</p>\n\n<pre><code>eax 0xffffffda -38\necx 0x80490ba 134516922\nedx 0x0 0\nebx 0x0 0\nesp 0xbffff14c 0xbffff14c\nebp 0xbffff178 0xbffff178\neip 0x804a03a 0x804a03a &lt;code+22&gt;\neflags 0x10246 [ PF ZF IF RF ]\n</code></pre>\n\n<p>Any help would be highly appreciated.</p>\n"}, {"tags": ["c", "implicit-conversion"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1441242148, "post_id": 32364817, "comment_id": 52603195, "body": "There&#39;s no such thing as an &quot;implicit cast&quot; in C. A <i>cast</i> is an operator, consisting of a type name in parentheses; it specifies a conversion. C has implicit conversions and explicit conversions; casts are by definition explicit."}], "answers": [{"comments": [{"owner": {"reputation": 3561, "user_id": 2698605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1a4bdcb1834ce1c98c4b6a7cadc6b04c?s=128&d=identicon&r=PG&f=1", "display_name": "pablo1977", "link": "https://stackoverflow.com/users/2698605/pablo1977"}, "edited": false, "score": 0, "creation_date": 1441238241, "post_id": 32364889, "comment_id": 52602316, "body": "Be careful: &quot;unsigned int otherwise&quot;. Your own cite contradicts your answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 1, "creation_date": 1441238917, "post_id": 32364889, "comment_id": 52602499, "body": "You should use <a href=\"http://en.cppreference.com/w/c/language/conversion\" rel=\"nofollow noreferrer\">this link instead</a> for C (yours is for C++)."}, {"owner": {"reputation": 18827, "user_id": 1413133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hqUmk.jpg?s=128&g=1", "display_name": "Manos Nikolaidis", "link": "https://stackoverflow.com/users/1413133/manos-nikolaidis"}, "reply_to_user": {"reputation": 3561, "user_id": 2698605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1a4bdcb1834ce1c98c4b6a7cadc6b04c?s=128&d=identicon&r=PG&f=1", "display_name": "pablo1977", "link": "https://stackoverflow.com/users/2698605/pablo1977"}, "edited": false, "score": 0, "creation_date": 1441239141, "post_id": 32364889, "comment_id": 52602547, "body": "@pablo1977 It is indeed possible to have a promotion to <code>unsigned int</code> in some (obscure) systems. For example both <code>char</code> and <code>int</code> could have a size of 16bits. Although I am not sure if such a system actually exists!"}, {"owner": {"reputation": 18827, "user_id": 1413133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hqUmk.jpg?s=128&g=1", "display_name": "Manos Nikolaidis", "link": "https://stackoverflow.com/users/1413133/manos-nikolaidis"}, "edited": false, "score": 0, "creation_date": 1441239314, "post_id": 32364889, "comment_id": 52602601, "body": "Thanks Chrono Kitsune. I modified the link."}, {"owner": {"reputation": 3561, "user_id": 2698605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1a4bdcb1834ce1c98c4b6a7cadc6b04c?s=128&d=identicon&r=PG&f=1", "display_name": "pablo1977", "link": "https://stackoverflow.com/users/2698605/pablo1977"}, "edited": false, "score": 0, "creation_date": 1441249089, "post_id": 32364889, "comment_id": 52604644, "body": "@Manos Nikolaidis: Yes, there exists. The topic was ilustrated a few montths ago here in SO, but I don&#39;t remember exactly where the post is."}, {"owner": {"reputation": 472, "user_id": 1723006, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2VUdU.jpg?s=128&g=1", "display_name": "Matthew Oakley", "link": "https://stackoverflow.com/users/1723006/matthew-oakley"}, "edited": false, "score": 0, "creation_date": 1501810072, "post_id": 32364889, "comment_id": 77955059, "body": "A singed int results from a call to the function toastInt()"}], "tags": [], "owner": {"reputation": 18827, "user_id": 1413133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hqUmk.jpg?s=128&g=1", "display_name": "Manos Nikolaidis", "link": "https://stackoverflow.com/users/1413133/manos-nikolaidis"}, "is_accepted": false, "score": 1, "last_activity_date": 1555428346, "last_edit_date": 1555428346, "creation_date": 1441237578, "answer_id": 32364889, "question_id": 32364817, "link": "https://stackoverflow.com/questions/32364817/implicit-integer-type-conversion-in-c/32364889#32364889", "title": "Implicit integer type conversion in C", "body": "<p>It will almost certainly be a <code>signed int</code> and it depends on the system where the code runs. Check the paragraph <em>Integral promotion</em> <a href=\"http://en.cppreference.com/w/c/language/conversion\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<blockquote>\n  <p><code>unsigned char</code> or <code>unsigned short</code> can be converted to <code>int</code> if it can hold\n  its entire value range, and <code>unsigned int</code> otherwise.</p>\n</blockquote>\n\n<p>On a POSIX system for example it will definitely be a <code>signed int</code> as a <code>char</code> is always 8bits and an <code>int</code> is at least 16bits. Therefore an <code>int</code> can represent every possible value of an <code>unsigned char</code>. There are apparently <a href=\"https://stackoverflow.com/questions/2098149/what-platforms-have-something-other-than-8-bit-char\">systems</a> where <code>char</code> is more that 8bits.</p>\n"}, {"tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 7, "last_activity_date": 1441238217, "creation_date": 1441238217, "answer_id": 32364981, "question_id": 32364817, "link": "https://stackoverflow.com/questions/32364817/implicit-integer-type-conversion-in-c/32364981#32364981", "title": "Implicit integer type conversion in C", "body": "<p>In C99, the reference is 6.3.1.8 \"Usual arithmetic conversions\".</p>\n\n<blockquote>\n  <p>Many operators that expect operands of arithmetic type cause conversions and yield result\n  types in a similar way. The purpose is to determine a <em>common real type</em> for the operands\n  and result. For the specified operands, each operand is converted, without change of type\n  domain, to a type whose corresponding real type is the common real type. Unless\n  explicitly stated otherwise, the common real type is also the corresponding real type of\n  the result, whose type domain is the type domain of the operands if they are the same,\n  and complex otherwise. This pattern is called the <em>usual arithmetic conversions:</em></p>\n  \n  <ul>\n  <li>First, if the corresponding real type of either operand is <code>long double</code>, the other\n  operand is converted, without change of type domain, to a type whose\n  corresponding real type is <code>long double</code>.</li>\n  <li>Otherwise, if the corresponding real type of either operand is <code>double</code>, the other\n  operand is converted, without change of type domain, to a type whose\n  corresponding real type is <code>double</code>.</li>\n  <li>Otherwise, if the corresponding real type of either operand is <code>float</code>, the other\n  operand is converted, without change of type domain, to a type whose\n  corresponding real type is <code>float</code>. 51)</li>\n  <li>Otherwise, the integer promotions are performed on both operands. Then the\n  following rules are applied to the promoted operands:\n  \n  <ul>\n  <li>If both operands have the same type, then no further conversion is needed.</li>\n  <li>Otherwise, if both operands have signed integer types or both have unsigned\n  integer types, the operand with the type of lesser integer conversion rank is\n  converted to the type of the operand with greater rank.</li>\n  <li>Otherwise, if the operand that has unsigned integer type has rank greater or\n  equal to the rank of the type of the other operand, then the operand with\n  signed integer type is converted to the type of the operand with unsigned\n  integer type.</li>\n  <li>Otherwise, if the type of the operand with signed integer type can represent\n  all of the values of the type of the operand with unsigned integer type, then\n  the operand with unsigned integer type is converted to the type of the\n  operand with signed integer type.</li>\n  <li>Otherwise, both operands are converted to the unsigned integer type\n  corresponding to the type of the operand with signed integer type.</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>Addition performs the usual arithmetic conversions, so, when adding <code>unsigned char</code> and <code>signed int</code>, either:</p>\n\n<ul>\n<li>first the <code>unsigned char</code> is promoted to <code>int</code>, and then both types are the same, so the result has type <code>int</code>, or</li>\n<li>(uncommon) <code>int</code> cannot represent all possible <code>unsigned char</code> values. In this case, <code>unsigned char</code> is promoted to <code>unsigned int</code>, and the third sub-bullet applies: <code>unsigned int</code> has equal rank to <code>int</code>, so the <code>int</code> operand is converted to <code>unsigned int</code>, and the result has type <code>unsigned int</code>.</li>\n</ul>\n"}], "owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5574, "favorite_count": 2, "accepted_answer_id": 32364981, "answer_count": 2, "score": 4, "last_activity_date": 1555428346, "creation_date": 1441237029, "last_edit_date": 1445203611, "question_id": 32364817, "link": "https://stackoverflow.com/questions/32364817/implicit-integer-type-conversion-in-c", "title": "Implicit integer type conversion in C", "body": "<p>I understand the implicit conversions of the C language between integer and floating point types, but I have a question for signed/unsigned implicit type conversions.</p>\n\n<p>If you add, for example, an <code>unsigned char</code>  and a <code>signed int</code>, what will be the resulting type? Would it be an <code>unsigned int</code>, a <code>signed int</code>, or something else?</p>\n\n<p>I don't see anything specific in the C99 ANSI standard about this, so any help is appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1441234969, "post_id": 32364521, "comment_id": 52601453, "body": "Use a variable-length array (assuming your compiler supports C99; most if not all do by this time). E.g. <code>scanf(&quot;%d&quot;, &amp;i); int a[i];</code>."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1441235149, "post_id": 32364521, "comment_id": 52601510, "body": "@SirPython not allowed in C++"}, {"owner": {"reputation": 197, "user_id": 4309963, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1131037943/picture?type=large", "display_name": "phantom", "link": "https://stackoverflow.com/users/4309963/phantom"}, "edited": false, "score": 0, "creation_date": 1441236904, "post_id": 32364521, "comment_id": 52601987, "body": "You need to allocate, using malloc, realloc etc."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 197, "user_id": 4309963, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1131037943/picture?type=large", "display_name": "phantom", "link": "https://stackoverflow.com/users/4309963/phantom"}, "edited": false, "score": 0, "creation_date": 1441249100, "post_id": 32364521, "comment_id": 52604645, "body": "@phantom <code>realloc</code> doesn&#39;t make a ton of sense in this situation, but they won&#39;t even have to use <code>malloc</code> and friends if the compiler supports variable-length arrays."}], "answers": [{"comments": [{"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 3, "creation_date": 1441235017, "post_id": 32364541, "comment_id": 52601466, "body": "This will only work if the compiler supports variable length arrays."}, {"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 2, "creation_date": 1441235045, "post_id": 32364541, "comment_id": 52601473, "body": "The leading whitespace in <code>scanf(3)</code>&#39;s format string is not really necessary, <code>%d</code> already consumes leading blanks."}, {"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "reply_to_user": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 2, "creation_date": 1441235119, "post_id": 32364541, "comment_id": 52601498, "body": "@PCLuddite It&#39;s a reasonable assumption. Most, if not all, C compilers support VLAs these days."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1441248775, "post_id": 32364541, "comment_id": 52604580, "body": "@FilipeGon&#231;alves C11 made VLAs optional. Support for it is definitely smaller on embedded systems, but yes, I&#39;d say most mainstream implementations support it."}], "tags": [], "owner": {"reputation": 2598, "user_id": 2766650, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ef36288df96290326b6849710377d07e?s=128&d=identicon&r=PG&f=1", "display_name": "asdf", "link": "https://stackoverflow.com/users/2766650/asdf"}, "is_accepted": false, "score": 4, "last_activity_date": 1441234957, "creation_date": 1441234957, "answer_id": 32364541, "question_id": 32364521, "link": "https://stackoverflow.com/questions/32364521/size-of-an-array-by-user/32364541#32364541", "title": "Size of an Array by user", "body": "<p>You need to define the array <em>after</em> you ask the user for input.</p>\n\n<pre><code>int size;\nprintf(\"Please enter the size of the array\");\nscanf(\" %d\", &amp;size);\nint array[size];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 0, "creation_date": 1441280203, "post_id": 32364630, "comment_id": 52619860, "body": "To be more correct: <code>array=(int *) malloc(size*sizeof(int));</code>.. you can read about it here: <a href=\"http://www.cplusplus.com/forum/articles/416/\" rel=\"nofollow noreferrer\">cplusplus.com/forum/articles/416</a>"}, {"owner": {"reputation": 27478, "user_id": 183120, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc147f814e1473bb6105db3d924fb590?s=128&d=identicon&r=PG", "display_name": "legends2k", "link": "https://stackoverflow.com/users/183120/legends2k"}, "reply_to_user": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 1, "creation_date": 1441281411, "post_id": 32364630, "comment_id": 52620678, "body": "@Paulinho That is more wrong: you <a href=\"http://stackoverflow.com/q/605845/183120\">don&#39;t cast the result of <code>malloc</code></a>. Do you use the type or the pointee is a matter of taste, but this isn&#39;t."}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 0, "creation_date": 1441283731, "post_id": 32364630, "comment_id": 52622354, "body": "It&#39;s wrong you said it&#39;s wrong because it&#39;s not a rule that you mustn&#39;t cast the result of malloc(). You can cast, but you don&#39;t need to do it. I&#39;ve just tested now and it compiled and run properly (with or without casting)."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 0, "creation_date": 1441306945, "post_id": 32364630, "comment_id": 52637549, "body": "@Paulinho The vast majority of C programmers will disagree with you. The cast is required in C++, but you shouldn&#39;t do it in C. Stop linking C++ websites. C++ is not C. They are separate languages."}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 0, "creation_date": 1441311305, "post_id": 32364630, "comment_id": 52639966, "body": "@PCLuddite I&#39;ll consider what you said. I&#39;m gonna search about it. Thanks for the tip."}, {"owner": {"reputation": 161, "user_id": 5260895, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/276c9536f95e8818475875e703bb4ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5260895/daniel"}, "edited": false, "score": 0, "creation_date": 1441670048, "post_id": 32364630, "comment_id": 52757920, "body": "i tried to use a variable length array, but it didnt work.   i use VS 2013, and thought it would support C99.. i guess not?..   which one does?.."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 161, "user_id": 5260895, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/276c9536f95e8818475875e703bb4ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5260895/daniel"}, "edited": false, "score": 0, "creation_date": 1441682828, "post_id": 32364630, "comment_id": 52760601, "body": "@daniel Unfortunately, I don&#39;t think VS 2013 supports C99. It focuses more on C++."}], "tags": [], "owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "is_accepted": true, "score": 5, "last_activity_date": 1441235555, "creation_date": 1441235555, "answer_id": 32364630, "question_id": 32364521, "link": "https://stackoverflow.com/questions/32364521/size-of-an-array-by-user/32364630#32364630", "title": "Size of an Array by user", "body": "<p>Assuming your compiler supports C99 and <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"noreferrer\">variable-length arrays</a>, then the following code will work:</p>\n\n<pre><code>int size;\nfputs(\"Array size? \", stdout);\nscanf(\"%d\", &amp;size);\nint array[size];\n</code></pre>\n\n<p>If your compiler does not, you'll have to use <code>malloc</code>.</p>\n\n<pre><code>int size;\nint* array;\nfputs(\"Array size? \", stdout);\nscanf(\"%d\", &amp;size);\narray = malloc(size * sizeof(*array));\n/* do stuff with array */\nfree(array); /* don't forget to free() when finished */\n</code></pre>\n\n<p>Some implementations support <code>alloca</code>, which allocates on the stack like a variable-length array would, but this is non-standard.</p>\n"}, {"comments": [{"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 2, "creation_date": 1441249195, "post_id": 32364976, "comment_id": 52604665, "body": "How could using <code>malloc</code> ever be cleaner than a variable length array?"}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "reply_to_user": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1441280051, "post_id": 32364976, "comment_id": 52619764, "body": "Because <code>int array[size]</code> is not the C standard. It won&#39;t work on every single system. You can read about here: <a href=\"http://www.cplusplus.com/forum/articles/416/\" rel=\"nofollow noreferrer\">cplusplus.com/forum/articles/416</a>  &quot;Assume you have variable size as a variable (it is NOT defined as constant). The compiler will give you an error if you try this: <code>int array[size];</code>&quot;"}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1441307350, "post_id": 32364976, "comment_id": 52637781, "body": "No, variable-length arrays <i>are</i> standard, and have been since C99. Most C compilers support them. <code>int array[size]</code> will not give you an error if you are using a <b>C</b> compiler."}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "reply_to_user": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1441311001, "post_id": 32364976, "comment_id": 52639823, "body": "My mistake: C99 standard supports it. ;)"}], "tags": [], "owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "is_accepted": false, "score": 2, "last_activity_date": 1441280227, "last_edit_date": 1441280227, "creation_date": 1441238182, "answer_id": 32364976, "question_id": 32364521, "link": "https://stackoverflow.com/questions/32364521/size-of-an-array-by-user/32364976#32364976", "title": "Size of an Array by user", "body": "<p>For a clean solution, use malloc() function, instead of <code>int array[size];</code></p>\n\n<pre><code>int size;\nprintf(\"What's the array size?\\n\");\nscanf(\"%d\", &amp;size);\narray=(int *) malloc(size*sizeof(int));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 4653725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rumu0.jpg?s=128&g=1", "display_name": "Sandeep Kumar", "link": "https://stackoverflow.com/users/4653725/sandeep-kumar"}, "is_accepted": false, "score": 3, "last_activity_date": 1441423363, "last_edit_date": 1495541311, "creation_date": 1441261313, "answer_id": 32368287, "question_id": 32364521, "link": "https://stackoverflow.com/questions/32364521/size-of-an-array-by-user/32368287#32368287", "title": "Size of an Array by user", "body": "<p>As mentioned in above malloc is best way as it won't depend on compiler. Also because realloc can be done when you find that u need to increase of decrease the size of array.</p>\n\n<pre><code>int size;\nprintf(\"What's the array size?\\n\");\nscanf(\"%d\", &amp;size);\narray = (int *)malloc(size * sizeof(*array));\n.\n. \n. \n.some stuff on array\narray = (int *)realloc(array, 1024); // changing size of array according to user.\n</code></pre>\n\n<p>more details regarding realloc is here <a href=\"https://stackoverflow.com/questions/789413/resizing-buffer-using-realloc\">resizing buffer using realloc</a></p>\n"}], "owner": {"reputation": 161, "user_id": 5260895, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/276c9536f95e8818475875e703bb4ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5260895/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 32364630, "answer_count": 4, "score": 0, "last_activity_date": 1441423363, "creation_date": 1441234814, "question_id": 32364521, "link": "https://stackoverflow.com/questions/32364521/size-of-an-array-by-user", "title": "Size of an Array by user", "body": "<p>I want the user to decide the size of my array<br>\nCan i do it?<br>\nI tried: </p>\n\n<pre><code>#define max 8  \nint a[max]; \n</code></pre>\n\n<p>But then, user cant change a constant<br>\nI tried:</p>\n\n<pre><code>int i, a[i];  \n</code></pre>\n\n<p>But it gives an error<br>\nHelp?</p>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1441234751, "post_id": 32364458, "comment_id": 52601386, "body": "How do you know the address of <code>sam</code> in your first example if you do not print it because you add the <code>printf(&quot;%p \\t %s \\t %p&quot;, &amp;pSam, &quot;sam&quot;, pSam)</code> only in the second example?"}, {"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 1, "creation_date": 1441234763, "post_id": 32364458, "comment_id": 52601392, "body": "May be in the first case the compiler optimizes away <code>int *pSam= &amp;sam;</code> so there&#39;s one less variable on the stack."}, {"owner": {"reputation": 399, "user_id": 5240812, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/6026913dffc8fdb128ce57e27089a1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fahad Saleem", "link": "https://stackoverflow.com/users/5240812/fahad-saleem"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1441234864, "post_id": 32364458, "comment_id": 52601422, "body": "@ouah I included pSam which essentially prints out the memory address sam."}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "reply_to_user": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1441238408, "post_id": 32364458, "comment_id": 52602375, "body": "@mustaccio when you say optimize what you mean? The address is 4 bytes larger than the original: (from 0028FF18 to 0028FF1C ) The stack addressing <b>grows</b> from small to large."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "reply_to_user": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "edited": false, "score": 0, "creation_date": 1441238656, "post_id": 32364458, "comment_id": 52602443, "body": "@simplicisveritatis: Could be it allocates stack frames in 8 byte increments. In the first case, <code>sam</code> is the only 32 bit variable in that block. In the second case, it&#39;s the second 32 variable in that block, so it&#39;s at a higher address than before. Could also be an upward growing stack, for all we know - <code>0x0028FF1C</code> isn&#39;t all that high in a 32 bit address space."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1441241652, "post_id": 32364458, "comment_id": 52603096, "body": "You do need to cast the pointers you pass to <code>printf</code> to <code>(void *)</code> -&gt; check the standard (says something about <i>&quot;the pointer shall be of type <code>void *</code>&quot;</i>"}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "edited": false, "score": 0, "creation_date": 1441281469, "post_id": 32364458, "comment_id": 52620719, "body": "Could this translation in address be caused by the fact that you are passing a variable by value, so it&#39;s copied."}], "answers": [{"comments": [{"owner": {"reputation": 7515, "user_id": 5249858, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/900942861bfbfdd27433e3ccbf7d6d0f?s=128&d=identicon&r=PG&f=1", "display_name": "3442", "link": "https://stackoverflow.com/users/5249858/3442"}, "edited": false, "score": 0, "creation_date": 1441239449, "post_id": 32364986, "comment_id": 52602647, "body": "Why the downvote? I think your answer is more expressive than mine&#39;s :)."}], "tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1441238228, "creation_date": 1441238228, "answer_id": 32364986, "question_id": 32364458, "link": "https://stackoverflow.com/questions/32364458/adding-a-line-of-code-changes-the-memory-address-of-a-variable/32364986#32364986", "title": "Adding a line of code changes the memory address of a variable", "body": "<p>As mentioned in the comments, this is almost certainly about optimization. </p>\n\n<p>This:</p>\n\n<pre><code>int main() {\n   int sam = 19;\n   int *pSam = &amp;sam;\n   printf(\"Address \\t name \\t value\\n\");\n   printf(\"%p \\t %s \\t %d\\n\", pSam, \"sam\", sam);\n\n   return 0;\n}\n</code></pre>\n\n<p>is essentially equivalent to this:</p>\n\n<pre><code>int main() {\n   int sam = 19;\n   /* int *pSam = &amp;sam; */\n   printf(\"Address \\t name \\t value\\n\");\n   /* printf(\"%p \\t %s \\t %d\\n\", pSam, \"sam\", sam); */\n   printf(\"%p \\t %s \\t %d\\n\", &amp;sam, \"sam\", sam);\n\n   return 0;\n}\n</code></pre>\n\n<p>In other words, it can be done without the variable <code>pSam</code> at all, and accordingly, a smart compiler will optimize that variable away. Depending on the processor, even without optimizing it away it may be able to store everything in registers rather than allocate storage on the stack.</p>\n\n<p>But, if you want to take the <em>address</em> of <code>pSam</code>, then obviously it cannot be optimized away or put in a register, because if you do either of these things then it's not going to have an address. So when you do this you force the compiler to allocate memory for it, almost certainly on the stack, here. And, in this case, it looks like when you do that the address of <code>sam</code> - also by necessity allocated on the stack, since you also take its address and output it - is changing as a result, probably because your compiler is allocating <code>pSam</code> on the stack before <code>sam</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 7515, "user_id": 5249858, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/900942861bfbfdd27433e3ccbf7d6d0f?s=128&d=identicon&r=PG&f=1", "display_name": "3442", "link": "https://stackoverflow.com/users/5249858/3442"}, "is_accepted": false, "score": 0, "last_activity_date": 1441239226, "last_edit_date": 1441239226, "creation_date": 1441238442, "answer_id": 32365015, "question_id": 32364458, "link": "https://stackoverflow.com/questions/32364458/adding-a-line-of-code-changes-the-memory-address-of-a-variable/32365015#32365015", "title": "Adding a line of code changes the memory address of a variable", "body": "<p>Although it's not so obvious, what <em>may</em> cause this is a compiler optimization being invalidated.</p>\n\n<p>In your original code</p>\n\n<pre><code>int main() {\n    int sam = 19;\n    int *pSam= &amp;sam;\n\n    printf(\"Address \\t name \\t value\\n\");\n    printf(\"%p \\t %s \\t %d\\n\", pSam, \"sam\", sam);\n\n    return 0;\n}\n</code></pre>\n\n<p>You may notice that the address of the <code>pSam</code> variable is <em>never</em> needed, so the compiler may perfectly optimize that variable away, resulting in a smaller (by a few bytes...) stack.</p>\n\n<p>Now, when you add in the other line in the mix.</p>\n\n<pre><code>printf(\"%p \\t %s \\t %p\", &amp;pSam, \"sam\", pSam);\n</code></pre>\n\n<p>The compiler optimization <em>gets invalidated</em>, that is, its assertion (the address of <code>pSam</code> is never used) is no longer valid, so the optimization is not perfomable. This implies that the variable <code>pSam</code> is now not optimized away, and is now actually present in stack space, thus pushing, shifting, or otherwise modifying the addresses of other stack variables in the process.</p>\n"}], "owner": {"reputation": 399, "user_id": 5240812, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/6026913dffc8fdb128ce57e27089a1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fahad Saleem", "link": "https://stackoverflow.com/users/5240812/fahad-saleem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1441239226, "creation_date": 1441234455, "question_id": 32364458, "link": "https://stackoverflow.com/questions/32364458/adding-a-line-of-code-changes-the-memory-address-of-a-variable", "title": "Adding a line of code changes the memory address of a variable", "body": "<p>The original code is :</p>\n\n<pre><code>int main(){\nint sam= 19;\nint *pSam= &amp;sam;\nprintf(\"Address \\t name \\t value\\n\");\nprintf(\"%p \\t %s \\t %d\\n\", pSam, \"sam\", sam);\n\nreturn 0;\n</code></pre>\n\n<p>The memory address of sam is shown as= 0028FF18.</p>\n\n<p>However If I change nothing about the variable, and just add another line of code above the 'return 0;' which is: </p>\n\n<pre><code> printf(\"%p \\t %s \\t %p\", &amp;pSam, \"sam\", pSam);\n</code></pre>\n\n<p>And then run the program, the memory address of sam changes to 0028FF1C, even though I just printed out some basic stuff.</p>\n\n<p>Why is that? </p>\n"}, {"tags": ["c", "string", "loops", "substring"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1441234151, "post_id": 32364277, "comment_id": 52601210, "body": "You should at least add what it is doing wrong \u2013 after all, you tried to run this code, didn&#39;t you? If you find a non-matching character, you should reset <code>dataIndex</code> back to <code>0</code>, and also <code>strIndex</code> to the position where you started matching. As it is, you are always ending up at the first <code>i</code>. (At a passing glance, you have a similar problem in the replacement routine.)"}, {"owner": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1441234291, "post_id": 32364277, "comment_id": 52601258, "body": "Oh my bad, what is happening is that when I try to print the last loop, nothing shows up. So basically, I should return 0; after each loop?"}, {"owner": {"reputation": 9377, "user_id": 349415, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ODdzp.png?s=128&g=1", "display_name": "Jesse Jashinsky", "link": "https://stackoverflow.com/users/349415/jesse-jashinsky"}, "edited": false, "score": 0, "creation_date": 1441236249, "post_id": 32364277, "comment_id": 52601817, "body": "You didn&#39;t reset strIndex, which means the first thing it finds is &#39;\\0&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441297093, "post_id": 32371184, "comment_id": 52631946, "body": "Thank you so much! Your explanation was very thorough and helpful. The only part I am slightly confused is the &quot;unsigned e = 5&quot;. So basically, you are using this e to track each letter of the two substrings to make sure they are different? And you are decreasing e by 1 each time, because if you increment it - it would hit the max character count of the substring, right?  Also, If I were to write a generalized code to fetch any substrings from the string, I would need to use pointers and malloc right?"}, {"owner": {"reputation": 101, "user_id": 5291056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec3c9c01c3f08fea9c45cdfa0b28bfb?s=128&d=identicon&r=PG&f=1", "display_name": "zwarrior", "link": "https://stackoverflow.com/users/5291056/zwarrior"}, "reply_to_user": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441306772, "post_id": 32371184, "comment_id": 52637441, "body": "Usage of &#39;e&#39;- Assume APPLE and APPLICATION are in string. APPLICATION is substring you want to replace. Here first three letters are same. So, if I check only first letter, I might be confused and replace the APPLE. But I want APPLICATION to be replaced. Here, I would use &#39;e&#39;=5(or anything, like 4,6) and check 1st letter and 5th letter.  If I increment, there is possibility that increment will happen above size of substring. So, I decrement and check whether 5th,4th,3rd,2nd,1st letter are matching. It&#39;s normally better if you choose &#39;e&#39; as large as substring size. I dunno whether u got it?"}, {"owner": {"reputation": 101, "user_id": 5291056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec3c9c01c3f08fea9c45cdfa0b28bfb?s=128&d=identicon&r=PG&f=1", "display_name": "zwarrior", "link": "https://stackoverflow.com/users/5291056/zwarrior"}, "reply_to_user": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441307201, "post_id": 32371184, "comment_id": 52637697, "body": "Ya.You can use malloc. Also, u can write a separate function to get the number of characters in the string and return that function variable.For example-in the line: for(k=0;k&lt;114;k++). Instead of using 114, you can use that variable. Similarly, you can do it for the substring. I didn&#39;t do it because, I didn&#39;t want to make the code complicated. If you still didn&#39;t understand &#39;e&#39; part, let me know. I will try to explain more clearly. And I used &#39;unsigned int&#39; because the &#39;e&#39; wont go below 0 so that, the index &#39;e&#39; will be in the range of size of substring. You can verify this by incrementing &#39;e&#39;"}, {"owner": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441315031, "post_id": 32371184, "comment_id": 52641803, "body": "Excellent! I completely understand why you used &#39;e = 5&#39; and &#39;e--&#39; now!  As for the other question. Let&#39;s say I have to make this code dynamic so that it can replace any substring within the string. Would I basically have to replace the variables within the first code?"}, {"owner": {"reputation": 101, "user_id": 5291056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec3c9c01c3f08fea9c45cdfa0b28bfb?s=128&d=identicon&r=PG&f=1", "display_name": "zwarrior", "link": "https://stackoverflow.com/users/5291056/zwarrior"}, "reply_to_user": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441360136, "post_id": 32371184, "comment_id": 52658489, "body": "I have edited the main answer. In the below(at the end, after explanation), I have mentioned a small piece of code. Just make that piece of code as a separate function and call that function to find the number of characters of whichever sub string you want. The returned variable &#39;n&#39; can be used with proper arguments in place of, for example- 114 in the for loop, and in place of 10 in j&lt;10 and j&gt;=10. Also, you can use that &#39;n&#39; variable and use it as unsigned int e=n-2. Try to figure out why I used n-2. Important point is, you have to pass the correct variables and call the function properly."}, {"owner": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441383100, "post_id": 32371184, "comment_id": 52673032, "body": "When I replace the 114 or 10 in the main function with n, it says that I am using an undeclared variable. So, does that mean that I need to declare &#39;n&#39; in the main function as well? And should the function call be placed right before the printf in the main body - or at the very beginning of main?"}, {"owner": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441384139, "post_id": 32371184, "comment_id": 52673620, "body": "Also, I edited my original code to show what I have so far."}, {"owner": {"reputation": 101, "user_id": 5291056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec3c9c01c3f08fea9c45cdfa0b28bfb?s=128&d=identicon&r=PG&f=1", "display_name": "zwarrior", "link": "https://stackoverflow.com/users/5291056/zwarrior"}, "reply_to_user": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441387107, "post_id": 32371184, "comment_id": 52675064, "body": "You should create a new function and return the value of &#39;n&#39;. Then assign a new variable and collect that passed data in main function. I edited the main code. You should place the function call before using the returned value in the main code. As you see I have used 3 function calls before &#39;for loop&#39; and then used those returned values(r,r1,r2) inside the loop. And I have used last function call after the for loop and stored it in &#39;r3&#39; because I will get the length of newstr only after executing the for loop.See the code and reply whether u understood? Just see step by step slowly and analyze"}, {"owner": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441391152, "post_id": 32371184, "comment_id": 52677082, "body": "Thanks for commenting the code so clearly. I definitely have a better grasp on what&#39;s going on. One question: So now, are you saying that I have to add in the returned value in the main code, and then apply the function call before it?"}, {"owner": {"reputation": 101, "user_id": 5291056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec3c9c01c3f08fea9c45cdfa0b28bfb?s=128&d=identicon&r=PG&f=1", "display_name": "zwarrior", "link": "https://stackoverflow.com/users/5291056/zwarrior"}, "reply_to_user": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "edited": false, "score": 0, "creation_date": 1441434254, "post_id": 32371184, "comment_id": 52688028, "body": "I think you are not clear with the concepts of functions. I suggest you go through it once. Whenever you use the returned value in the main function, you will be calling it eventually. There are 3 parts in function. Function declaration(before main function), calling function(r,r1,r2), called function(after main function). You can change few variables and check the output. You will get more idea on what&#39;s going on."}], "tags": [], "owner": {"reputation": 101, "user_id": 5291056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec3c9c01c3f08fea9c45cdfa0b28bfb?s=128&d=identicon&r=PG&f=1", "display_name": "zwarrior", "link": "https://stackoverflow.com/users/5291056/zwarrior"}, "is_accepted": true, "score": 1, "last_activity_date": 1441388060, "last_edit_date": 1441388060, "creation_date": 1441270587, "answer_id": 32371184, "question_id": 32364277, "link": "https://stackoverflow.com/questions/32364277/c-replacing-a-substring-within-a-string-using-loops/32371184#32371184", "title": "C: Replacing a substring within a string using loops", "body": "<p>I tried your problem and got output for my code. Here is the code- \n<strong>EDIT- THIS IS THE EDITED MAIN CODE</strong></p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint var(char *);  //function declaration. I am telling CPU that I will be using this function in the later stage with one argument of type char *\n\nint main()   //main function\n{\n\n    char *str=\"\\n\\\"Mr. Fay, is this going to be a battle of wits?\\\" \\n\\\"If it is,\\\" was the indifferent retort, \\\"you have come unarmed!\\\"\";\n    int i,j=0,k=0,l=0;\n    char data[] = \"indifferent\";\n    char newData[] = \"nonchalant\";\n    char newStr[150];\n    //here  'n' is returned from the 'var' function and is received in form of r,r1,r2,r3.\n    int r=var(str);  //getting the length of str from the function 'var' and storing in 'r'\n    int r1=var(data);  //getting the length of data from the function 'var' and storing in 'r1'\n    int r2=var(newData);  //getting the length of newData from the function and storing in 'r2'\n    unsigned int e=r1-2;  //r1-2 because r1 is the data to be replaced. and string index starts from 0. Here r1 is of length 12. but we dont need to check last\n    //character because it is null character and the index starts from 0. not from 1. so, it is 0 to 11 and 11th is '\\0'. so \"12-\"2\"=10\" characters to be compared.\n    for(i=0;str[i]!='\\0';i++)\n    {\n\n        if(str[i]!=data[j])\n        {\n            newStr[l]=str[i];\n            l++;\n        }\n        else if((str[i+e]==data[j+e]) &amp;&amp; (j&lt;r2))\n        {\n            newStr[l]=newData[j];\n            j++;\n            l++;\n            e--;\n\n        }\n        else if((str[i+e]==data[j+e]) &amp;&amp; (j&gt;=r2))\n        {\n            j++;\n            e--;\n        }\n        else\n        {\n            newStr[l]=str[i];\n            l++;    \n        }\n\n    }\n    int r3=var(newStr);  //getting the length of str from the function and storing in 'r'\n    printf(\"original string is-\");\n    for(k=0;k&lt;r;k++)\n    printf(\"%c\",str[k]);\n    printf(\"\\n\");\n    printf(\"modified string is-\");\n    for(k=0;k&lt;r3;k++)\n    printf(\"%c\",newStr[k]);\n    printf(\"\\n\");\n} // end of main function\n\n // Below is the new function called 'var' to get the character length\n//'var' is the function name and it has one parameter. I am returning integer. so, it is int var.\n\nint var(char *stri)//common function to get length of strings and substrings\n{\n    int i,n=0;\n    for(i=0;stri[i]!='\\0';i++)\n    {\n        n++; //n holds the length of a string.\n    }\n   // printf(\"the number of characters is %d\\n\",n);\n    return (n); //returning this 'n' wherever the function is called.\n}\n</code></pre>\n\n<p>Let me explain few parts of the code-</p>\n\n<ol>\n<li>I have used unsigned int e, because I don't want 'e' to go negative.(I will explain more about this later).</li>\n<li>In the first for loop, I am checking whether my string has reached the end.</li>\n<li>In first 'IF' condn, I am checking whether the first character of string is NOT-EQUAL to the first character of the word which needs to be replaced. If condition satisfies, print regularly thr original string.</li>\n<li>ELSE IF, i.e(first character of string is EQUAL to the first character of the word)then check the next few characters to make sure that the word matches. Here, I used 'e' because it will check the condition for str[i+e] and data[i+e]. example- ai notequalto ae. If I had not used 'e'in code,... after checking the first character itself, newdata would have been printed in newstr. I used 'e'=5 because the probabilty of 1st letter and 5th letter being the same in data and the str is less. You can use 'e'=4 also. No rule that you have to use 'e'=5 only.</li>\n<li>Now, I am decrementing 'e' and checking whether the letters in the string is same or no. I can't increment because, there is a certain limit of size of a string. As, I used unsigned int, 'e' won't go down below 0.</li>\n<li>ELSE, (this means that only first letter is matching, the 5th letter of str and data are not matching), print the str in newstr.</li>\n<li>In the last FOR loop, I have used k&lt;114 because, that much characters are there in the string. (You can write a code to find how many characters are there in a string. No need to manually count). </li>\n<li>And lastly, I have used conditions (j&lt;10) and (j>=10) along with ELSE-IF condition because, in first ELSE-IF, the new data is ofsize 10. So, even if the word to be replaced is more than 10,say 12 for example. I  don't need the extra 2 bits to be stored in new data. So, if the size is more than 10, just bypass that in the next ELSE-IF condition. Note that this 10 is the size of new word. So, it varies if your word is smaller or bigger. And , in second ELSE-IF, I am not incrementing 'l'(l++) because, here, I am not putting anything in newstr. I am just bypassing it. So, I didn't increment. </li>\n</ol>\n\n<p>I tried my best to put the code in words. If you have any doubt, you can ask again. I will be glad to help. And this code is NOT OPTIMAL. The numerical values used varies with the words/strings you use. Ofcourse, I can write a generalized code for that(to fetch the numerical values automatically from the strings). But, I didn't write that code here. This code works for your problem. You can change few variables like 'e' and ELSE-IF part and try to understand how the code works. Play with it.</p>\n\n<p>EDIT-</p>\n\n<h1>include </h1>\n\n<pre><code>int main()\n{\n    char str[]=\"\\n\\\"Mr. Fay, is this going to be a battle of wits?\\\" \\n\\\"If it is,\\\" was the indifferent retort, \\\"you have come unarmed!\\\"\";// I took this as string. The string which u need to calculate the length, You have to pass that as the function parameter.\n    int i,n=0;\n    for(i=0;str[i]!='\\0';i++)\n    {\n        n++;\n    }\n    printf(\"the number of characters is %d\\n\",n);\n    return (n);\n}// If you execute this as a separate program, you will get the number of characters in the string. Basically, you just have to modify this code to act as a separate function and when calling the function, you have to pass correct arguments.\n</code></pre>\n\n<p>//Use Pointers in the function to pass arguments.</p>\n"}], "owner": {"reputation": 7, "user_id": 5294313, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153070073802647/picture?type=large", "display_name": "Benjamin Song", "link": "https://stackoverflow.com/users/5294313/benjamin-song"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 0, "accepted_answer_id": 32371184, "answer_count": 1, "score": -3, "last_activity_date": 1441388060, "creation_date": 1441233489, "last_edit_date": 1441387462, "question_id": 32364277, "link": "https://stackoverflow.com/questions/32364277/c-replacing-a-substring-within-a-string-using-loops", "title": "C: Replacing a substring within a string using loops", "body": "<p>I am struggling with the concept of replacing substrings within strings. This particular exercise does not want you to use built in functions from <code>&lt;string.h&gt;</code> or <code>&lt;strings.h&gt;</code>.</p>\n\n<p>Given the string made up of two lines below:</p>\n\n<pre><code>\"Mr. Fay, is this going to be a battle of wits?\" \n\"If it is,\" was the indifferent retort, \"you have come unarmed!\"\n</code></pre>\n\n<p>I have to replace a substring with another string.</p>\n\n<p>This is what I have so far, and I'm having trouble copying the substring to a new array, and replacing the substring with the new string:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint dynamic();\n\nint main()\n{\n    char str[]=\"\\n\\\"Mr. Fay, is this going to be a battle of wits?\\\" \\n\\\"If it is,\\\" was the indifferent retort, \\\"you have come unarmed!\\\"\";\n\n    int i, j=0, k=0, l=0, n=0;\n    unsigned int e = n-2;\n\n    char data[150];\n    char newData[150];\n    char newStr[150];\n\n    printf(\"Give me a substring from the string\");\n    gets(data);\n\n    printf(\"Give me a substring to replace it with\");\n    gets(newData);\n\n    dynamic();\n\n    for (i=0; str[i] != '\\0'; i++)\n    {\n        if (str[i] != data[j])\n        {\n            newStr[l] = str[i];\n            l++;\n        }\n        else if ((str[i+e] == data[j+e]) &amp;&amp; (j&lt;n))\n        {\n            newStr[l] = newData[j];\n            j++;\n            l++;\n            e--;\n        }\n        else if ((str[i+e] == data[j+e]) &amp;&amp; (j&gt;=n))\n        {\n            j++;\n            e--;\n        }\n        else\n        {\n            newStr[l] = str[i];\n            l++;\n        }\n    }\n\n    printf(\"original string is-\");\n\n    for (k=0; k&lt;n; k++)\n        printf(\"%c\",str[k]);\n    printf(\"\\n\");\n\n    printf(\"modified string is-\");\n\n    for(k=0; k&lt;n; k++)\n        printf(\"%c\",newStr[k]);\n    printf(\"\\n\");\n}\n\nint dynamic()\n{\n    char str[]=\"\\n\\\"Mr. Fay, is this going to be a battle of wits?\\\" \\n\\\"If it is,\\\" was the indifferent retort, \\\"you have come unarmed!\\\"\";\n\n    int i, n=0;\n\n    for (i=0; str[i] != '\\0'; i++)\n    {\n        n++;\n    }\n    printf(\"the number of characters is %d\\n\",n);\n\n    return (n);\n}\n</code></pre>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1441233968, "post_id": 32364268, "comment_id": 52601142, "body": "The defines should <i>at least</i> add an axtra pair of parentheses: <code>#define CLOCK_REALTIME (clockid_t)1</code> --&gt;&gt; <code>#define CLOCK_REALTIME ((clockid_t)1)</code>"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1441235310, "post_id": 32364268, "comment_id": 52601554, "body": "As such these macros are not conforming, they have to be usable inside <code>#if</code> expression in the way you have tried. A common strategy to ensure this would be to add <code>+</code> signs such as <code>#define CLOCK_REALTIME ((clockid_t)+1)</code>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1441237055, "post_id": 32364268, "comment_id": 52602016, "body": "Inspired by: <a href=\"https://lwn.net/Articles/64207/\" rel=\"nofollow noreferrer\">lwn.net/Articles/64207</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 1, "last_activity_date": 1441233689, "creation_date": 1441233689, "answer_id": 32364312, "question_id": 32364268, "link": "https://stackoverflow.com/questions/32364268/compare-macros-containing-parentheses/32364312#32364312", "title": "Compare macros containing parentheses", "body": "<p>In this case you can just change:</p>\n\n<pre><code>#if CUSTOM_CLOCK_MONOTONIC != CLOCK_REALTIME\n    if (clock_gettime(CUSTOM_CLOCK_MONOTONIC,tp) == 0) {\n        return;\n    }\n#endif\n</code></pre>\n\n<p>with</p>\n\n<pre><code>if (CUSTOM_CLOCK_MONOTONIC != CLOCK_REALTIME) {\n     if (clock_gettime(CUSTOM_CLOCK_MONOTONIC,tp) == 0) {\n         return;\n     }\n}\n</code></pre>\n\n<p>If the inequality is false in all modern compilers the code will also be optimized out.</p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1441258803, "creation_date": 1441258803, "answer_id": 32367735, "question_id": 32364268, "link": "https://stackoverflow.com/questions/32364268/compare-macros-containing-parentheses/32367735#32367735", "title": "Compare macros containing parentheses", "body": "<p>It's not possible to test if a macro is defined to some other particular macro. If you need this functionality you will have to 'remember' using another macro. For example:</p>\n\n<pre><code>#if defined(CLOCK_MONOTONIC)\n#define CUSTOM_CLOCK_MONOTONIC CLOCK_MONOTONIC\n#define CUSTOM_CLOCK_IS_MONOTONIC\n#elif defined(CLOCK_HIGHRES)\n#define CUSTOM_CLOCK_MONOTONIC CLOCK_HIGHRES\n#define CUSTOM_CLOCK_IS_HIGHRES\n#else\n#define CUSTOM_CLOCK_MONOTONIC CLOCK_REALTIME\n#define CUSTOM_CLOCK_IS_REALTIME\n#endif\n</code></pre>\n\n<p>and later on you can test</p>\n\n<pre><code>#ifndef CUSTOM_CLOCK_IS_REALTIME\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 2392291, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/RIE8R.png?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2392291/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1441258803, "creation_date": 1441233430, "question_id": 32364268, "link": "https://stackoverflow.com/questions/32364268/compare-macros-containing-parentheses", "title": "Compare macros containing parentheses", "body": "<p>In cygwin's <code>sys/time.c</code> file, it defines the following:</p>\n\n<pre><code>#define CLOCK_REALTIME (clockid_t)1\n#define CLOCK_PROCESS_CPUTIME_ID (clockid_t)2\n#define CLOCK_THREAD_CPUTIME_ID (clockid_t)3\n#define CLOCK_MONOTONIC (clockid_t)4\n</code></pre>\n\n<p>A program that I am trying to compile defines a macro from the above macros...</p>\n\n<pre><code>/* make sure we have a best effort CUSTOM_CLOCK_MONOTONIC we can rely on */\n#if defined(CLOCK_MONOTONIC)\n#define CUSTOM_CLOCK_MONOTONIC CLOCK_MONOTONIC\n#elif defined(CLOCK_HIGHRES)\n#define CUSTOM_CLOCK_MONOTONIC CLOCK_HIGHRES\n#else\n#define CUSTOM_CLOCK_MONOTONIC CLOCK_REALTIME\n#endif\n</code></pre>\n\n<p>And later checks to see if the custom macro equals another macro...</p>\n\n<pre><code>#if CUSTOM_CLOCK_MONOTONIC != CLOCK_REALTIME\n    if (clock_gettime(CUSTOM_CLOCK_MONOTONIC,tp) == 0) {\n        return;\n    }\n#endif\n</code></pre>\n\n<p>However, since the macros are defined with parentheses in them, the GCC compiler fails to successfully process them, yielding the error:</p>\n\n<pre><code>test.c: In function 'main':\ntest.c:4:36: error: missing binary operator before token \"4\"\n #define CLOCK_MONOTONIC (clockid_t)4\n                                    ^\ntest.c:7:32: note: in expansion of macro 'CLOCK_MONOTONIC'\n #define CUSTOM_CLOCK_MONOTONIC CLOCK_MONOTONIC\n                                ^\ntest.c:16:5: note: in expansion of macro 'CUSTOM_CLOCK_MONOTONIC'\n #if CUSTOM_CLOCK_MONOTONIC != CLOCK_REALTIME\n     ^\n</code></pre>\n\n<p>Is there some way to compare the two macros without generating an error?</p>\n"}, {"tags": ["c", "valgrind", "getaddrinfo"], "comments": [{"owner": {"reputation": 849, "user_id": 2674572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ac98e0d627ba6399371ceea60fa7225?s=128&d=identicon&r=PG", "display_name": "or1426", "link": "https://stackoverflow.com/users/2674572/or1426"}, "edited": false, "score": 1, "creation_date": 1441232473, "post_id": 32364031, "comment_id": 52600675, "body": "I can&#39;t reproduce the issue on my computer (linux 4.1 with gcc 5.2.0). Valgrind reports no leaks at all with the code sample you provided (<code>All heap blocks were freed -- no leaks are possible</code>). So I suggest there might be a leak in the implementation of <code>getaddrinfo</code> you are using."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3007578"}, "reply_to_user": {"reputation": 849, "user_id": 2674572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ac98e0d627ba6399371ceea60fa7225?s=128&d=identicon&r=PG", "display_name": "or1426", "link": "https://stackoverflow.com/users/2674572/or1426"}, "edited": false, "score": 0, "creation_date": 1441233425, "post_id": 32364031, "comment_id": 52600981, "body": "Yup, looks like an error in the implementation. Switched over to an Ubuntu VM and the leaks are gone. That&#39;s a good hour wasted... but I won&#39;t be making that mistake again! :)"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1441235518, "post_id": 32364031, "comment_id": 52601624, "body": "Usually these are known issues, e.g a free of some memory is done after <code>valgrind</code> can detect it. The difference that you observe between different systems is in fact an exception list for <code>valgrind</code> of errors that it should suppress. So not the reality changes between the two, just your knowledge about it."}, {"owner": {"reputation": 974, "user_id": 4206728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F8TpP.jpg?s=128&g=1", "display_name": "e76d587d9", "link": "https://stackoverflow.com/users/4206728/e76d587d9"}, "edited": false, "score": 1, "creation_date": 1441259481, "post_id": 32364031, "comment_id": 52607608, "body": "Valgrind has preliminary support only for modern OS X. This situation will be significantly improved in the next Valgrind release, but for now there are a number of known leaks reported in system libraries (i.e. outside your  control)."}], "owner": {"user_type": "does_not_exist", "display_name": "user3007578"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 921, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1441232079, "creation_date": 1441232079, "last_edit_date": 1495540682, "question_id": 32364031, "link": "https://stackoverflow.com/questions/32364031/valgrind-reporting-memory-leak-on-getaddrinfo", "title": "Valgrind reporting memory leak on getaddrinfo", "body": "<p>I've stripped down my code to the bare minimum and, despite setting servinfo to NULL and excessively calling freeaddrinfo, I'm still seeing a memory leak with valgrind --leak-check=yes. I found <a href=\"https://stackoverflow.com/questions/6712740/valgrind-reporting-that-getaddrinfo-is-leaking-memory\">this thread</a> but I wasn't able to resolve the issue. </p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n\nint main() {\n  /* Declare connection variables */\n  struct addrinfo hints, *servinfo;\n  char port[6];\n  servinfo = NULL;\n\n  /* Set address attributes */\n  memset(&amp;hints, 0, sizeof hints);\n  hints.ai_family = AF_UNSPEC;\n  hints.ai_socktype = SOCK_STREAM;\n  sprintf(port, \"%d\", 8888);\n  if (getaddrinfo(NULL, port, &amp;hints, &amp;servinfo) != 0) {\n    freeaddrinfo(servinfo);\n    fprintf(stderr, \"&gt; Error: getaddrinfo() failed.\\n\");\n    exit(EXIT_FAILURE);\n  }\n  freeaddrinfo(servinfo);\n\n  return 0;\n}\n</code></pre>\n\n<p>And here's the valgrind output:</p>\n\n<pre><code>==5199== 640 (320 direct, 320 indirect) bytes in 1 blocks are definitely lost in loss record 104 of 122\n==5199==    at 0x100007351: malloc (vg_replace_malloc.c:303)\n==5199==    by 0x10038EA3D: sa_dst_lookup (in /usr/lib/system/libsystem_network.dylib)\n==5199==    by 0x10038E1F6: sa_dst_compare_internal (in /usr/lib/system/libsystem_network.dylib)\n==5199==    by 0x1002144DE: _qsort (in /usr/lib/system/libsystem_c.dylib)\n==5199==    by 0x1002B5F68: _gai_sort_list (in /usr/lib/system/libsystem_info.dylib)\n==5199==    by 0x1002ADD30: si_addrinfo (in /usr/lib/system/libsystem_info.dylib)\n==5199==    by 0x1002AD966: getaddrinfo (in /usr/lib/system/libsystem_info.dylib)\n==5199==    by 0x100000EBC: main (test.c:19)\n</code></pre>\n\n<p>Any ideas? Could it be an OS X Yosemite issue? Thanks for your help...</p>\n"}, {"tags": ["c", "ubuntu", "operating-system"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1441232269, "post_id": 32364014, "comment_id": 52600603, "body": "Cheap and easy: <a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\"><code>system(3)</code></a>.  Full control: <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\"><code>fork(2)</code></a>, then the child calls <a href=\"http://man7.org/linux/man-pages/man2/execve.2.html\" rel=\"nofollow noreferrer\"><code>execve(2)</code></a> (or another function from the <code>exec*</code> family), while the parent calls <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\"><code>waitpid(2)</code></a>."}, {"owner": {"reputation": 307, "user_id": 4539113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-Z6jMTzSI5iE/AAAAAAAAAAI/AAAAAAAAAGI/0Y6fTsDZCwk/photo.jpg?sz=128", "display_name": "Smreks", "link": "https://stackoverflow.com/users/4539113/smreks"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1441235913, "post_id": 32364014, "comment_id": 52601730, "body": "@JonathonReinhart I understand how to use fork and watpid for the parent, but could you elaborate more on how to use execve() to execute the command"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1441238093, "post_id": 32364014, "comment_id": 52602281, "body": "Can you tell me what, specifically, you don&#39;t understand after reading the man pages?"}, {"owner": {"reputation": 307, "user_id": 4539113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-Z6jMTzSI5iE/AAAAAAAAAAI/AAAAAAAAAGI/0Y6fTsDZCwk/photo.jpg?sz=128", "display_name": "Smreks", "link": "https://stackoverflow.com/users/4539113/smreks"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1441238995, "post_id": 32364014, "comment_id": 52602517, "body": "@JonathonReinhart For example, if i do <code>.&#47;func1 cat foo.txt</code> and I have <code>main(int argc, char *argv[])</code> what would be put in <code>execvp(?,?)</code> to execute the command? I understand that it should be <code>execvp(command, parameters)</code> so does that mean it would be <code>execvp(argv[1],argv[])</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 617, "user_id": 3424096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GDbie.jpg?s=128&g=1", "display_name": "SirPython", "link": "https://stackoverflow.com/users/3424096/sirpython"}, "is_accepted": false, "score": 1, "last_activity_date": 1441232289, "creation_date": 1441232289, "answer_id": 32364068, "question_id": 32364014, "link": "https://stackoverflow.com/questions/32364014/c-function-that-executes-a-command/32364068#32364068", "title": "C - Function that executes a command", "body": "<p>Use you can use the <code>system</code> function.</p>\n\n<hr>\n\n<p>Example:</p>\n\n<pre><code>system(\"cat foo.txt\");\n</code></pre>\n\n<p>Will run this:</p>\n\n<pre><code>cat foo.txt\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 4539113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-Z6jMTzSI5iE/AAAAAAAAAAI/AAAAAAAAAGI/0Y6fTsDZCwk/photo.jpg?sz=128", "display_name": "Smreks", "link": "https://stackoverflow.com/users/4539113/smreks"}, "edited": false, "score": 0, "creation_date": 1441235680, "post_id": 32364570, "comment_id": 52601677, "body": "I like that you you got the command line, I can&#39;t use system(command), would you happen to know how to use execve() to execute the command?"}, {"owner": {"reputation": 301, "user_id": 5223868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8667384f7b81ea5c4933bb1af91000b7?s=128&d=identicon&r=PG&f=1", "display_name": "splotz90", "link": "https://stackoverflow.com/users/5223868/splotz90"}, "reply_to_user": {"reputation": 307, "user_id": 4539113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-Z6jMTzSI5iE/AAAAAAAAAAI/AAAAAAAAAGI/0Y6fTsDZCwk/photo.jpg?sz=128", "display_name": "Smreks", "link": "https://stackoverflow.com/users/4539113/smreks"}, "edited": false, "score": 0, "creation_date": 1441239747, "post_id": 32364570, "comment_id": 52602713, "body": "I added an example that uses <code>execve()</code>."}], "tags": [], "owner": {"reputation": 301, "user_id": 5223868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8667384f7b81ea5c4933bb1af91000b7?s=128&d=identicon&r=PG&f=1", "display_name": "splotz90", "link": "https://stackoverflow.com/users/5223868/splotz90"}, "is_accepted": false, "score": 0, "last_activity_date": 1441239714, "last_edit_date": 1441239714, "creation_date": 1441235153, "answer_id": 32364570, "question_id": 32364014, "link": "https://stackoverflow.com/questions/32364014/c-function-that-executes-a-command/32364570#32364570", "title": "C - Function that executes a command", "body": "<p>You could do something like that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[]) {\n    size_t command_length = 0;\n\n    if(argc &lt; 2)\n        return 0;\n\n    for(int i = 1; i &lt; argc; i++)\n        command_length += strlen(argv[i]);\n\n    command_length += argc - 2; // spaces between words\n    command_length++;       // terminator '\\0'\n\n    char command[command_length];\n    memset(command, 0, sizeof(command));\n\n    for(int i = 1; i &lt; argc; i++) {\n        strcat(command, argv[i]);\n\n        if(i &lt; argc - 1)\n            command[strlen(command)] = ' ';\n    }\n\n    system(command);\n}\n</code></pre>\n\n<p>It first determines the length of all command line parameters. After that it concatenates all command line parameters and inserts a space between each. Last but not least it calls the <code>system()</code> function with this string.</p>\n\n<p>You need to use a C11 compiler with <a href=\"https://de.wikipedia.org/wiki/Variable_Length_Array\" rel=\"nofollow\">VLA</a> support.</p>\n\n<hr>\n\n<p>Here is a version without <code>system()</code>:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#define MAX 1024\n\nint main(int argc, char *argv[]) {\n    char buf[MAX] = \"/usr/bin/\";\n    size_t len = MAX - strlen(buf) + 1;\n\n    if(argc &lt; 2)\n        return 0;\n\n    strncat(buf, argv[1], len);\n    execve(buf, argv + 1, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p>This program only works under Linux. Unfortunately the <code>execve()</code> expects an absolute path. I assumed that the executable is located under /usr/bin. Additional work is necessary if that's not the case. For example you would have to examine the <code>$PATH</code> environment variable.</p>\n"}], "owner": {"reputation": 307, "user_id": 4539113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-Z6jMTzSI5iE/AAAAAAAAAAI/AAAAAAAAAGI/0Y6fTsDZCwk/photo.jpg?sz=128", "display_name": "Smreks", "link": "https://stackoverflow.com/users/4539113/smreks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1441239714, "creation_date": 1441232007, "last_edit_date": 1441235220, "question_id": 32364014, "link": "https://stackoverflow.com/questions/32364014/c-function-that-executes-a-command", "title": "C - Function that executes a command", "body": "<p>How does one create a function that takes another command as an argument and executes that command. For example say I wanted to do</p>\n\n<pre><code>./func1 cat /etc/motd\n</code></pre>\n\n<p>and have it execute the <em>cat</em> command on the file /etc/motd so that it would print the message of the day. If someone could show me that would be much appreciated!</p>\n\n<p>EDIT: I cannot use the system() call as later on I have to program a basic command shell. I just need to know how to execute commands so that when a user types in cat foo.txt it executes the command and displays the file. I guess what I'm trying to say is, how do you use execve()? What arguments go inside it?</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 39811, "user_id": 1322401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JlaPg.jpg?s=128&g=1", "display_name": "Steven Rumbalski", "link": "https://stackoverflow.com/users/1322401/steven-rumbalski"}, "edited": false, "score": 0, "creation_date": 1441232444, "post_id": 32363988, "comment_id": 52600665, "body": "This question is open-ended and will lead to subjective answers and as such is a poor fit for stackoverflow.  You may wish to ask your question at <a href=\"https://groups.google.com/forum/#!forum/comp.lang.python\" rel=\"nofollow noreferrer\">comp.lang.python</a>."}, {"owner": {"reputation": 5782, "user_id": 1560599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b91099d549ba464204a4b80d3ef01c9a?s=128&d=identicon&r=PG", "display_name": "seaotternerd", "link": "https://stackoverflow.com/users/1560599/seaotternerd"}, "edited": false, "score": 0, "creation_date": 1441429536, "post_id": 32363988, "comment_id": 52687171, "body": "Take a look at cython"}], "answers": [{"comments": [{"owner": {"reputation": 39811, "user_id": 1322401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JlaPg.jpg?s=128&g=1", "display_name": "Steven Rumbalski", "link": "https://stackoverflow.com/users/1322401/steven-rumbalski"}, "edited": false, "score": 1, "creation_date": 1441233027, "post_id": 32364083, "comment_id": 52600867, "body": "Your two sentences are true, but they have no logical relation to each other.  Your answer does not help the OP solve his problem."}], "tags": [], "owner": {"reputation": 148, "user_id": 4736122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3229bab7d65621c71a0e231c07802c23?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro J", "link": "https://stackoverflow.com/users/4736122/pedro-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1450844551, "last_edit_date": 1450844551, "creation_date": 1441232445, "answer_id": 32364083, "question_id": 32363988, "link": "https://stackoverflow.com/questions/32363988/best-method-to-call-a-c-function-from-python-code/32364083#32364083", "title": "Best method to call a C function from python code", "body": "<p>You can use a shared library using the C compiler and make the calls of the functions that are defined in the library, to this, you can use the module CPython.</p>\n"}, {"comments": [{"owner": {"reputation": 39811, "user_id": 1322401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JlaPg.jpg?s=128&g=1", "display_name": "Steven Rumbalski", "link": "https://stackoverflow.com/users/1322401/steven-rumbalski"}, "edited": false, "score": 0, "creation_date": 1441232817, "post_id": 32364085, "comment_id": 52600800, "body": "This isn&#39;t really integration with C in any meaningful sense.  This is just calling a compiled program with command line arguments.  Everything must be converted to and from strings for this to work.  This <i>may</i> be a viable option depending on the OP&#39;s needs, but I think you are missing the mark."}, {"owner": {"reputation": 4230, "user_id": 1912128, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YyM8r.png?s=128&g=1", "display_name": "taesu", "link": "https://stackoverflow.com/users/1912128/taesu"}, "reply_to_user": {"reputation": 39811, "user_id": 1322401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JlaPg.jpg?s=128&g=1", "display_name": "Steven Rumbalski", "link": "https://stackoverflow.com/users/1322401/steven-rumbalski"}, "edited": false, "score": 0, "creation_date": 1441232889, "post_id": 32364085, "comment_id": 52600824, "body": "I wrote this method because OP doesn&#39;t seem to be knowledgeable enough to import c code into python and run it."}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "edited": false, "score": 0, "creation_date": 1441233026, "post_id": 32364085, "comment_id": 52600864, "body": "@taesu that&#39;s why he asked the question - hope you&#39;re not implying he can&#39;t learn new things ;)"}, {"owner": {"reputation": 4230, "user_id": 1912128, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YyM8r.png?s=128&g=1", "display_name": "taesu", "link": "https://stackoverflow.com/users/1912128/taesu"}, "reply_to_user": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "edited": false, "score": 0, "creation_date": 1441233172, "post_id": 32364085, "comment_id": 52600900, "body": "So I don&#39;t expect him to import c into python, thus this way seemed relatively eaiser. @viraptor I wasn&#39;t and I certainly hope you weren&#39;t"}], "tags": [], "owner": {"reputation": 4230, "user_id": 1912128, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YyM8r.png?s=128&g=1", "display_name": "taesu", "link": "https://stackoverflow.com/users/1912128/taesu"}, "is_accepted": false, "score": -1, "last_activity_date": 1441232463, "creation_date": 1441232463, "answer_id": 32364085, "question_id": 32363988, "link": "https://stackoverflow.com/questions/32363988/best-method-to-call-a-c-function-from-python-code/32364085#32364085", "title": "Best method to call a C function from python code", "body": "<p>Let's say your c code sends email, and the code accept args like this</p>\n\n<pre><code>./sendemail email title body\n</code></pre>\n\n<p>Then from python , you can do something like:</p>\n\n<pre><code>from subprocess import call\ncall([\"./sendemail\", \"email@email.com\", \"subject\", \"body\"])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3172, "user_id": 128548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc96d2a02d9113edb992eb96c205c5a?s=128&d=identicon&r=PG", "display_name": "fijal", "link": "https://stackoverflow.com/users/128548/fijal"}, "edited": false, "score": 0, "creation_date": 1441815261, "post_id": 32364157, "comment_id": 52830086, "body": "you&#39;re linking to a bad part of the docs, ABI level is really dangerous and should be avoided (unless you have no other choice). You don&#39;t know the library nor operating system of the author of the question"}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "reply_to_user": {"reputation": 3172, "user_id": 128548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc96d2a02d9113edb992eb96c205c5a?s=128&d=identicon&r=PG", "display_name": "fijal", "link": "https://stackoverflow.com/users/128548/fijal"}, "edited": false, "score": 0, "creation_date": 1441841684, "post_id": 32364157, "comment_id": 52842029, "body": "It may be dangerous, it may be ok. The document lists all kinds of ways to access the library. I stripped the specific anchor to abi, but exactly because the author didn&#39;t specify it, it&#39;s as valid answer as any other way. (I mean, they will have to make the choice in the end since we lack details.)"}], "tags": [], "owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "is_accepted": false, "score": 2, "last_activity_date": 1441841627, "last_edit_date": 1441841627, "creation_date": 1441232809, "answer_id": 32364157, "question_id": 32363988, "link": "https://stackoverflow.com/questions/32363988/best-method-to-call-a-c-function-from-python-code/32364157#32364157", "title": "Best method to call a C function from python code", "body": "<p>Cffi library is a fairly modern approach to this. It also works across python and pypy.</p>\n\n<p>Provided you have your functions contained in a shared library, you can just import them as python methods. Have a look at examples here: <a href=\"http://cffi.readthedocs.org/en/latest/overview.html\" rel=\"nofollow\">http://cffi.readthedocs.org/en/latest/overview.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 2898, "user_id": 1385931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70e182175b70bc54af9183fdc8d9a27b?s=128&d=identicon&r=PG", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/1385931/helloworld"}, "is_accepted": false, "score": 0, "last_activity_date": 1441233191, "last_edit_date": 1441233191, "creation_date": 1441232886, "answer_id": 32364170, "question_id": 32363988, "link": "https://stackoverflow.com/questions/32363988/best-method-to-call-a-c-function-from-python-code/32364170#32364170", "title": "Best method to call a C function from python code", "body": "<p>When you want to extend Python with some C functions you can check out the following example. What you need is a module which registers wrapper functions for your own functions.</p>\n\n<p>For more information check out the <a href=\"https://docs.python.org/2/extending/extending.html#keyword-parameters-for-extension-functions\" rel=\"nofollow\">Python docs</a>.</p>\n\n<pre><code>#include &lt;Python.h&gt;\n\nstatic PyObject *\nyourfunction(PyObject *self, PyObject *args, PyObject *keywds)\n{\n    int voltage;\n    char *state = \"a stiff\";\n    char *action = \"voom\";\n    char *type = \"Norwegian Blue\";\n\n    static char *kwlist[] = {\"voltage\", \"state\", \"action\", \"type\", NULL};\n\n    if (!PyArg_ParseTupleAndKeywords(args, keywds, \"i|sss\", kwlist,\n                                     &amp;voltage, &amp;state, &amp;action, &amp;type))\n        return NULL;\n\n    printf(\"-- This parrot wouldn't %s if you put %i Volts through it.\\n\",\n           action, voltage);\n    printf(\"-- Lovely plumage, the %s -- It's %s!\\n\", type, state);\n\n    Py_INCREF(Py_None);\n\n    return Py_None;\n}\n\nstatic PyMethodDef keywdarg_methods[] = {\n    {\"yourfunction\", (PyCFunction)yourfunction, METH_VARARGS | METH_KEYWORDS,\n     \"the doc of your function\"},\n    {NULL, NULL, 0, NULL}   /* sentinel */\n};\n\n\n// in Python 2.x the function name initmodulename is executed when imported\nvoid initkeywdarg(void)\n{\n  /* Create the module and add the functions */\n  Py_InitModule(\"keywdarg\", keywdarg_methods);\n}\n</code></pre>\n\n<p>To compile the file you can use clang. Keep in mind that you have to correct the include path if the Python headers are located somewhere else. The created binary <code>keywdarg.so</code> can be created by using <code>import keywdarg</code>.</p>\n\n<blockquote>\n  <p>clang++ -shared -I/usr/include/python2.7 -fPIC keywdarg.cpp -o keywdarg.so -lpython</p>\n</blockquote>\n"}], "owner": {"reputation": 55, "user_id": 4188635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/46f8046613e3a3531d3c2e4451202ac8?s=128&d=identicon&r=PG&f=1", "display_name": "bhuvan", "link": "https://stackoverflow.com/users/4188635/bhuvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1615, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1450844551, "creation_date": 1441231839, "question_id": 32363988, "link": "https://stackoverflow.com/questions/32363988/best-method-to-call-a-c-function-from-python-code", "title": "Best method to call a C function from python code", "body": "<p>I have some C code which has some basic functions. I want to be able to call these C functions from my python code. There seem to be a lot f methods to do this as I search online, but they look a bit complicated. Can anyone suggest which is the simplest and best method to call C functions from python without any issues ?</p>\n"}, {"tags": ["c", "pointers", "multidimensional-array", "segmentation-fault", "sudoku"], "comments": [{"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "edited": false, "score": 0, "creation_date": 1441230162, "post_id": 32363600, "comment_id": 52599864, "body": "Do you have access to a debugger (maybe gdb, lldb, etc..)? Try running a backtrace and posting what pops up here so we have more information."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1441230341, "post_id": 32363600, "comment_id": 52599939, "body": "change to <code>int (*sudoArr)[SIZE];  sudoArr = malloc(sizeof(*sudoArr) * SIZE );</code> or <code>int (*sudoArr)[SIZE]  = malloc(sizeof(int) * SIZE * SIZE);</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441232080, "post_id": 32363600, "comment_id": 52600549, "body": "For this code it&#39;s silly to do dynamic allocation at all.  Since the array dimensions are statically known, and it is used only inside the function where it is declared, <code>int sudoArr[SIZE][SIZE];</code> (and no <code>malloc()</code>) would be better.  If it needed to be shared among functions then it could be declared that way as a global, or it could be declared that way in <code>main()</code> and passed as an argument to the other functions."}, {"owner": {"reputation": 339, "user_id": 4076958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fc1f23a7b481e629e92b57e0e066ec88?s=128&d=identicon&r=PG&f=1", "display_name": "Jude", "link": "https://stackoverflow.com/users/4076958/jude"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441232179, "post_id": 32363600, "comment_id": 52600581, "body": "@JohnBollinger I see, I was just trying to practice dyn arrays but I guess I&#39;ll try a fixed array."}], "answers": [{"tags": [], "owner": {"reputation": 456, "user_id": 5195032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8bdbf3441f787e76b72f80b6609e475?s=128&d=identicon&r=PG", "display_name": "Denis Babarykin", "link": "https://stackoverflow.com/users/5195032/denis-babarykin"}, "is_accepted": true, "score": 1, "last_activity_date": 1441233082, "last_edit_date": 1441233082, "creation_date": 1441230648, "answer_id": 32363731, "question_id": 32363600, "link": "https://stackoverflow.com/questions/32363600/segmentation-fault-first-time-with-2d-arrays/32363731#32363731", "title": "Segmentation fault, first time with 2D arrays", "body": "<p>First of all, you allocate memory for the matrix wrong way. Correct will be:</p>\n\n<pre><code>int** sudoArr = (int**)malloc(SIZE * sizeof(int*));\n\nfor (int index=0; index &lt; SIZE; ++index)\n{\n    sudoArr[index] = (int*)malloc(SIZE * sizeof(int));\n}\n</code></pre>\n\n<p>Link to online compiler with correct version of your code: <a href=\"http://ideone.com/wAmzAc\" rel=\"nofollow\">correct sources</a></p>\n"}], "owner": {"reputation": 339, "user_id": 4076958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fc1f23a7b481e629e92b57e0e066ec88?s=128&d=identicon&r=PG&f=1", "display_name": "Jude", "link": "https://stackoverflow.com/users/4076958/jude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 32363731, "answer_count": 1, "score": 2, "last_activity_date": 1441233082, "creation_date": 1441230080, "last_edit_date": 1441231845, "question_id": 32363600, "link": "https://stackoverflow.com/questions/32363600/segmentation-fault-first-time-with-2d-arrays", "title": "Segmentation fault, first time with 2D arrays", "body": "<p>I am working with 2D arrays for the first time for a sudoku checker program; below is my code. </p>\n\n<p>My program compiles without error, but when I run it, it gives me a segmentation fault.</p>\n\n<p>It has been a while since I last coded, so I am unsure what I'm missing. I've also never had to deal with this error before.</p>\n\n<p><strong><em>My Code:</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint sudokuCheck();\nint arrayMake();\n#define SIZE 9\n\nint main(){\n    int sudokAmount;\n\n    printf(\"Please Enter the amount of solutions to solve:\\n\");\n    scanf(\"%d\",&amp;sudokAmount);\n    arrayMake();\n    //sudokuCheck(sudokAmount);\n    return 0;\n}\n\nint arrayMake(){\n    int j;\n    int i;\n    int** sudoArr;\n\n    sudoArr = malloc(sizeof(int*) * SIZE * SIZE);\n    printf(\"Please Enter Sudoku Solutions(By rows)\\n\");\n    for(i = 0; i &lt; SIZE; i++){\n        for(j=0; j &lt; SIZE; j++){\n            scanf(\"%d\\n\", &amp;sudoArr[i][j]);\n        }\n    }\n    for(i = 0; i &lt; SIZE; i++){\n        for(j=0; j &lt; SIZE; j++){\n            printf(\"%d \\n\", sudoArr[i][j]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "xml", "unit-testing", "cmocka"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3338599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1B5s.jpg?s=128&g=1", "display_name": "Divya Y", "link": "https://stackoverflow.com/users/3338599/divya-y"}, "edited": false, "score": 0, "creation_date": 1441306055, "post_id": 32372205, "comment_id": 52637018, "body": "Hello Andreas, thanks for the reply. I am using CMocka 1.0.1 and have added cmocka_set_message_output(CM_OUTPUT_XML); to the main() in the unit test. But the result that i see on the stdout is in the below format... 0x3 == 0x3 cmockatest.c:8: error: Failure! [  PASSED  ] 0 test(s). [  FAILED  ] 1 test(s), listed below: [  FAILED  ] test"}, {"owner": {"reputation": 742, "user_id": 577774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2f1e3c638391229f288e9449c387f3?s=128&d=identicon&r=PG", "display_name": "asn", "link": "https://stackoverflow.com/users/577774/asn"}, "reply_to_user": {"reputation": 173, "user_id": 3338599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1B5s.jpg?s=128&g=1", "display_name": "Divya Y", "link": "https://stackoverflow.com/users/3338599/divya-y"}, "edited": false, "score": 0, "creation_date": 1441404137, "post_id": 32372205, "comment_id": 52682478, "body": "<code>asn@magrathea:~&#47;workspace&#47;projects&#47;cmocka&#47;obj&gt; CMOCKA_MESSAGE_OUTPUT=XML .&#47;example&#47;simple_test  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;testsuites&gt;   &lt;testsuite name=&quot;tests&quot; time=&quot;0.009&quot; tests=&quot;1&quot; failures=&quot;0&quot; errors=&quot;0&quot; skipped=&quot;0&quot; &gt;     &lt;testcase name=&quot;null_test_success&quot; time=&quot;0.009&quot; &gt;     &lt;&#47;testcase&gt;   &lt;&#47;testsuite&gt; &lt;&#47;testsuites&gt;</code> Works just fine for me .."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1445608043, "post_id": 32372205, "comment_id": 54406579, "body": "Hmm, if @asn <i>is</i> the author, then I am surprised that he did not mention what I found by code reading. You can set the name of a XML output file in the environment variable CMOCKA_XML_FILE - see cmocka.c, line 1913"}, {"owner": {"reputation": 6336, "user_id": 4023446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Orest Hera", "link": "https://stackoverflow.com/users/4023446/orest-hera"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1445713834, "post_id": 32372205, "comment_id": 54442228, "body": "@Mawg You are using deprecated test runner <code>run_tests()</code>, see my answer post."}, {"owner": {"reputation": 742, "user_id": 577774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2f1e3c638391229f288e9449c387f3?s=128&d=identicon&r=PG", "display_name": "asn", "link": "https://stackoverflow.com/users/577774/asn"}, "edited": false, "score": 0, "creation_date": 1486631689, "post_id": 32372205, "comment_id": 71431678, "body": "cmocka-1.1.0 has improved XML output. You can now create a XML file for each group. See <a href=\"https://api.cmocka.org/\" rel=\"nofollow noreferrer\">api.cmocka.org</a> -&gt; Output formats"}], "tags": [], "owner": {"reputation": 742, "user_id": 577774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2f1e3c638391229f288e9449c387f3?s=128&d=identicon&r=PG", "display_name": "asn", "link": "https://stackoverflow.com/users/577774/asn"}, "is_accepted": false, "score": 1, "last_activity_date": 1441273478, "creation_date": 1441273478, "answer_id": 32372205, "question_id": 32363479, "link": "https://stackoverflow.com/questions/32363479/how-to-get-cmocka-report-in-junit-format/32372205#32372205", "title": "How to get CMocka report in JUnit format?", "body": "<p>The XML is printed to stdout, you need to redirect it to a file ...</p>\n"}, {"comments": [{"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1445848121, "post_id": 33322021, "comment_id": 54478390, "body": "Thanks, Orest. That answer is certainly worth the bonus. In fact, it is the best single piece of documentation and only example of cmcoka on the internet, as far as I can find. @asn am I worng?"}, {"owner": {"reputation": 6336, "user_id": 4023446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Orest Hera", "link": "https://stackoverflow.com/users/4023446/orest-hera"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1445859790, "post_id": 33322021, "comment_id": 54485271, "body": "For completeness I updated the post by usage of <code>cmocka_run_group_tests_name</code>"}], "tags": [], "owner": {"reputation": 6336, "user_id": 4023446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Orest Hera", "link": "https://stackoverflow.com/users/4023446/orest-hera"}, "is_accepted": false, "score": 6, "last_activity_date": 1445860101, "last_edit_date": 1445860101, "creation_date": 1445712602, "answer_id": 33322021, "question_id": 32363479, "link": "https://stackoverflow.com/questions/32363479/how-to-get-cmocka-report-in-junit-format/33322021#33322021", "title": "How to get CMocka report in JUnit format?", "body": "<p>The most credible source is actually the <code>cmocka.c</code> source file that contains entire implementation of the framework. This file is not too large, so I will cite something from the source file version 1.0.1.</p>\n\n<p>There are two conditions to generate XML output by cmocka and the third condition is needed to store output in file.</p>\n\n<p><strong>1. XML output can be generated only if tests are called by <code>cmocka_run_group_tests()</code></strong></p>\n\n<p>The customizable output format can be obtained only from the test runner <code>cmocka_run_group_tests()</code> or from its full variation <code>cmocka_run_group_tests_name()</code>.</p>\n\n<p>There is no other route that can lead to XML output. If a singe test is started by <code>run_test()</code> the output cannot be XML.</p>\n\n<p>The summary format</p>\n\n<pre><code>[  PASSED  ] 0 test(s).\n[  FAILED  ] 1 test(s), listed below:\n</code></pre>\n\n<p>can be generated in one of the following possible cases:</p>\n\n<ul>\n<li>the test is started by one of the deprecated test runners: <code>run_tests()</code>, <code>_run_tests()</code> or <code>run_group_tests()</code>, <code>_run_group_tests()</code>; in that case it is even possible to see compilation warning about usage of a deprecated function;</li>\n<li>the test is started by <code>cmocka_run_group_tests()</code> and the output format is <code>CM_OUTPUT_STDOUT</code>.</li>\n</ul>\n\n<p><strong>2. cmocka message output should be set to <code>CM_OUTPUT_XML</code></strong></p>\n\n<p>The default output format can be set by calling <code>cmocka_set_message_output(CM_OUTPUT_XML)</code> before running tests. However, even if such default is set in the test source it can be overwritten by the environment variable <code>CMOCKA_MESSAGE_OUTPUT</code>. That variable has higher priority than the default set by <code>cmocka_set_message_output()</code>.</p>\n\n<p>The value of <code>CMOCKA_MESSAGE_OUTPUT</code> is <em>case insensitive</em>. The variable is taken into account if it is equal to one of the following values: <code>stdout</code>, <code>subunit</code>, <code>tab</code> or <code>xml</code>.</p>\n\n<p>So, if the environment variable has value <code>stdout</code> the function <code>mocka_set_message_output()</code> has no effect.</p>\n\n<p>That variable can be used to force different output formats of already compiled binary:</p>\n\n<pre><code>CMOCKA_MESSAGE_OUTPUT=stdout ./nulltest\nCMOCKA_MESSAGE_OUTPUT=subunit ./nulltest\nCMOCKA_MESSAGE_OUTPUT=tap ./nulltest\nCMOCKA_MESSAGE_OUTPUT=xml ./nulltest\n</code></pre>\n\n<p>Thus, if the test is started by <code>cmocka_run_group_tests()</code> but the output is not affected by <code>mocka_set_message_output()</code> it means that there is set variable <code>CMOCKA_MESSAGE_OUTPUT=stdout</code> in the shell.</p>\n\n<p><strong>3. It should be possible to create a new file by cmocka to write its XML output directly to that file</strong></p>\n\n<p>If both previous conditions are satisfied, it is possible to ask cmocka to write its XML output directly to a file. If the environment variable <code>CMOCKA_XML_FILE</code> is set, then cmocka will try to write XML to file with name of that variable value.</p>\n\n<p>Usage example:</p>\n\n<pre><code>CMOCKA_XML_FILE='./out.xml' CMOCKA_MESSAGE_OUTPUT=xml ./nulltest\n</code></pre>\n\n<p>The file is written if:</p>\n\n<ul>\n<li>file with such name does not exist;</li>\n<li>such file can be created.</li>\n</ul>\n\n<p>Thus if there are more than one test runners in one compiled binary test application, only the first runner can write its output to that file.</p>\n\n<p>The output is written to the shell even if <code>CMOCKA_XML_FILE</code> is set, but the file already exists or it cannot be created.</p>\n\n<p>Of course, it is possible just to redirect shell output to a file overwriting existent file or appending to existent file if such file exists.</p>\n\n<p>The example bellow can be used to check different options for output. It can be built by the command</p>\n\n<pre><code>gcc -g nulltest.c -o nulltest -Ipath_to_cmocka_headers -Lpath_to_cmocka_library_binary -lcmocka\n</code></pre>\n\n<p><em>nulltest.c</em></p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;setjmp.h&gt;\n#include &lt;cmocka.h&gt;\n\n/* A test case that fails. */\nstatic void null_test_failed(void **state) {\n    (void) state; /* unused */\n    assert_int_equal(0, 1);\n}\n\nint main(void) {\n    const struct CMUnitTest tests[] = {\n        cmocka_unit_test(null_test_failed),\n    };\n    const struct UnitTest tests_deprecated[] = {\n        unit_test(null_test_failed),\n    };\n\n    cmocka_set_message_output(CM_OUTPUT_XML);\n\n    /* group test functions that use customizable output format */\n    cmocka_run_group_tests(tests, NULL, NULL);\n    cmocka_run_group_tests_name(\"custom group name\", tests, NULL, NULL);\n\n    /* run single test with standard output */\n    run_test(null_test_failed);\n\n    /* DEPRECATED TEST RUNNER functions that can give only standard output */\n    run_tests(tests_deprecated);\n    _run_tests(tests_deprecated, 1);\n    run_group_tests(tests_deprecated);\n    _run_group_tests(tests_deprecated, 1);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 3338599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1B5s.jpg?s=128&g=1", "display_name": "Divya Y", "link": "https://stackoverflow.com/users/3338599/divya-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2630, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1445860101, "creation_date": 1441229529, "last_edit_date": 1445714425, "question_id": 32363479, "link": "https://stackoverflow.com/questions/32363479/how-to-get-cmocka-report-in-junit-format", "title": "How to get CMocka report in JUnit format?", "body": "<p>I am able to use cmocka and getting default results on the screen. I want to get the results for the unit test in JUnit format.</p>\n\n<p>CMocka supports JUnit format by using the env variable <code>CMOCKA_MESSAGE_OUTPUT</code> or using API <code>cmocka_set_message_output(CM_OUTPUT_XML);</code></p>\n\n<p>But still no xml file gets generated. Can anyone help out in obtaining results in JUnit format?</p>\n"}, {"tags": ["c", "assembly", "nasm"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 4241116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1607c6cde39172eee62cdc205b1e2550?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Roberts", "link": "https://stackoverflow.com/users/4241116/sam-roberts"}, "edited": false, "score": 0, "creation_date": 1441243173, "post_id": 32364038, "comment_id": 52603378, "body": "I&#39;m looking at it in gdb, I&#39;m watching ecx, but that doesn&#39;t seem to say much What else should I be looking at in gdb?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 199, "user_id": 4241116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1607c6cde39172eee62cdc205b1e2550?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Roberts", "link": "https://stackoverflow.com/users/4241116/sam-roberts"}, "edited": false, "score": 0, "creation_date": 1441274540, "post_id": 32364038, "comment_id": 52616412, "body": "The address of your shellcode, so you can see it is looking at the wrong place."}], "tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": false, "score": 1, "last_activity_date": 1441232129, "creation_date": 1441232129, "answer_id": 32364038, "question_id": 32363318, "link": "https://stackoverflow.com/questions/32363318/egghunter-not-finding-the-egg-causing-infinite-loop/32364038#32364038", "title": "EggHunter not finding the egg, causing infinite loop", "body": "<p>Your <code>egghunter</code> is a global variable which lives in the data section. Your <code>shellcode</code> is a local variable which lives on the stack. You search for the mark from <code>egghunter</code> downwards, however the usual layout on linux (which I assume you use due to the <code>int 0x80</code>) places the stack above the data section. As such, you are searching in the wrong direction, and whatever you are finding is not your <code>shellcode</code>. In fact, it is part of the code that does the <code>strcpy(egghunter, literal)</code>:</p>\n\n<pre><code>   0x80494fe:   movl   $0x90f890f9,0x80497d0\n   0x8049508:   movl   $0xe1fff8e0,0x80497d4\n   0x8049512:   movl   $0xffffede8,0x80497d8\n   0x804951c:   movw   $0xff,0x80497dc\n   0x8049525:   movl   $0x80497c8,(%esp)\n</code></pre>\n\n<p>Learn to use a debugger so you can step through the code and see what it is doing.</p>\n"}], "owner": {"reputation": 199, "user_id": 4241116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1607c6cde39172eee62cdc205b1e2550?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Roberts", "link": "https://stackoverflow.com/users/4241116/sam-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441232129, "creation_date": 1441228860, "question_id": 32363318, "link": "https://stackoverflow.com/questions/32363318/egghunter-not-finding-the-egg-causing-infinite-loop", "title": "EggHunter not finding the egg, causing infinite loop", "body": "<p>EggHunter not finding the egg (32bit), causing infinite loop\nI have 1 example, that prints We found the egg! which works, and another the prints Hello egg! that isn't working.</p>\n\n<p>Both use the same egg 0x90f890f9</p>\n\n<p>I think the problem may be here:\ncmp     dword [ecx], 0x90f890f9  ; marker</p>\n\n<p>Here is the c code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nunsigned char egghunter[21];\n\nvoid main()\n{\n\n/* works OK (We found the egg!)\n\n\"\\x90\\xf9\\x90\\xf8\\x90\\x68\\x21\\x0a\\x0a\\x0a\\x68\\x20\\x65\\x67\\x67\\x68\\x20\\x74\\x68\"\n\"\\x65\\x68\\x6f\\x75\\x6e\\x64\\x68\\x57\\x65\\x20\\x66\\x31\\xc9\\xb1\\x12\\x51\\xb8\"\n\"\\x11\\x11\\x51\\x08\\x50\\x31\\xc0\\x50\\x54\\x51\\x89\\xe6\\x83\\xc6\\x14\\x03\\x74\"\n\"\\x24\\x10\\x2b\\x34\\x24\\x56\\x89\\xf1\\xeb\\x1c\\xeb\\x0c\\x59\\x59\\xe2\\xe8\\x31\"\n\"\\xdb\\x31\\xc0\\xb0\\x01\\xcd\\x80\\x31\\xc0\\xb0\\xa2\\x8d\\x5c\\x24\\x0c\\x31\\xc9\"\n\"\\xcd\\x80\\xeb\\xe6\\x31\\xd2\\xb2\\x01\\x31\\xdb\\xb3\\x01\\x31\\xc0\\xb0\\x04\\xcd\"\n\"\\x80\\xeb\\xd4\";\n\n*/\n\n/* gives an infinite loop (suppose to print Hello egg!)\n\n\"\\x90\\xf9\\x90\\xf8\\x90\\xeb\\x17\\x31\\xc0\\xb0\\x04\\x31\\xdb\\xb3\\x01\\x59\\x31\\xd2\\xb2\\x0b\\xcd\\x80\"\n\"\\x31\\xc0\\xb0\\x01\\x31\\xdb\\xcd\\x80\\xe8\\xe4\\xff\\xff\\xff\\x48\\x65\\x6c\\x6c\"\n\"\\x6f\\x20\\x65\\x67\\x67\\x21\\x0a\";\n\n*/\n\nunsigned char shellcode[256] = \\\n\"\\x90\\xf9\\x90\\xf8\\x90\\xeb\\x17\\x31\\xc0\\xb0\\x04\\x31\\xdb\\xb3\\x01\\x59\\x31\\xd2\\xb2\\x0b\\xcd\\x80\"\n\"\\x31\\xc0\\xb0\\x01\\x31\\xdb\\xcd\\x80\\xe8\\xe4\\xff\\xff\\xff\\x48\\x65\\x6c\\x6c\"\n\"\\x6f\\x20\\x65\\x67\\x67\\x21\\x0a\";\n\n\nprintf(\"Shellcode: %d bytes\\n\", strlen(shellcode));\n\nstrcpy(egghunter,\"\\xeb\\x0e\\x59\\x83\\xe9\\x17\\x81\\x39\\xf9\\x90\\xf8\\x90\\xe0\\xf8\\xff\\xe1\\xe8\\xed\\xff\\xff\\xff\");\n\nprintf(\"Egghunter: %d bytes\\n\", strlen(egghunter));\n\nint (*ret)() = (int(*)())egghunter;\n\nret();\n}\n</code></pre>\n\n<p>Here is the egghunter code:</p>\n\n<pre><code>global _start\nsection .text\n_start:\n  jmp     call_egghunter\negghunter:\n  pop     ecx                 ; save addr ptr\n  sub     ecx, 23             ; move addr ptr back\nnext:\n  cmp     dword [ecx], 0x90f890f9  ; marker\n  loopnz  next                ; dec ecx, jump\n  jmp ecx                     ; jump to shellcode\ncall_egghunter:\n  call    egghunter\n</code></pre>\n\n<p>And the hello egg code that isn't working is:\n    global _start</p>\n\n<pre><code>section .text\n\n_start:\n\n    jmp short call_shellcode \n\n\nshellcode: \n\n    ; print hello world on the screen\n\n    xor eax, eax\n    mov al, 0x4\n\n    xor ebx, ebx\n    mov bl, 0x1\n\n    pop ecx\n\n    xor edx, edx\n    mov dl, 11\n\n    int 0x80\n\n\n    ; exit the program gracefully\n\n    xor eax, eax\n    mov al, 0x1\n\n    xor ebx, ebx\n\n    int 0x80\n\ncall_shellcode:\n\n    call shellcode\n    message: db \"Hello egg!\", 0xA\n</code></pre>\n"}, {"tags": ["c", "rounding", "math.h", "cs50"], "comments": [{"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1441227756, "post_id": 32363024, "comment_id": 52598815, "body": "Do you know what a MCVE is?"}, {"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1441227990, "post_id": 32363024, "comment_id": 52598914, "body": "Hi, Amit I didn&#39;t know what it is. I have Googled it and found the page on this site. I appreciate you pointing it out and I will be editing my post accordingly. A"}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 2, "creation_date": 1441228203, "post_id": 32363024, "comment_id": 52598993, "body": "Good, you&#39;re a model citizen :-)"}, {"owner": {"reputation": 2366, "user_id": 3160967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1d5285da7116b41a824dd9cf0e77e4ea?s=128&d=identicon&r=PG", "display_name": "mwag", "link": "https://stackoverflow.com/users/3160967/mwag"}, "edited": false, "score": 0, "creation_date": 1441228313, "post_id": 32363024, "comment_id": 52599039, "body": "why not just parse the input string by hand so that you don&#39;t have to use any math functions to do something as simple as reading a string such as &quot;2.10&quot; and converting it to the number 210?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441229022, "post_id": 32363024, "comment_id": 52599353, "body": "Guidance: 1) If code is to use money in floating point, use <code>double</code>.  2) whenever converting floating point money to <code>int</code>, use <code>round()</code> as in <code>cents = round(changeDue * 100);</code>"}, {"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "reply_to_user": {"reputation": 2366, "user_id": 3160967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1d5285da7116b41a824dd9cf0e77e4ea?s=128&d=identicon&r=PG", "display_name": "mwag", "link": "https://stackoverflow.com/users/3160967/mwag"}, "edited": false, "score": 0, "creation_date": 1441229280, "post_id": 32363024, "comment_id": 52599454, "body": "@mwag - That isn&#39;t the aim of the program, it needs to get it as int first to do some more work."}, {"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441229315, "post_id": 32363024, "comment_id": 52599464, "body": "@chux - This is another function plagued with the same misfortune as ceilf."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441229465, "post_id": 32363024, "comment_id": 52599529, "body": "@Adam Disagree.  What is an example misfortune caused by <code>round()</code> usage?"}, {"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441229788, "post_id": 32363024, "comment_id": 52599711, "body": "@chux - Basically I am doing this pset - <a href=\"http://cdn.cs50.net/2015/x/psets/1/pset1/pset1.html#time_for_change\" rel=\"nofollow noreferrer\">cdn.cs50.net/2015/x/psets/1/pset1/pset1.html#time_for_change</a>&zwnj;&#8203;. Now when an input of say &#39;1.00&#39; is multiplied by &#39;100&#39; I get &#39;100&#39; as an answer correct I know. Say I enter &#39;2.10&#39; and do the same I get &#39;209.xxxxxxx&#39; rather than the actual &#39;210&#39;. This is why I went for &#39;MATH.H&#39; and wherein the issue lies. I Have it narrowed down as answer 1 will show."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441230193, "post_id": 32363024, "comment_id": 52599875, "body": "Your reference say &quot;And be careful to round and not truncate your pennies!&quot;.  When you get  &#39;209.xxxxxxx&#39; you are more like getting <code>209.9xxxxxx&#39;</code>.  <code>double round(double x)</code> from <code>&lt;math.h&gt;</code> solves this issue as it returns <code>210.0</code>.    Still maintain it is not &quot;plagued with the same misfortune as ceilf&quot; and looking for your example of how <code>round(double)</code> is an issue.   OTOH - I do see <code>round()</code> in <code>&lt;math.h&gt;</code> has the same problem in that you need to link the math library.  Agree on that.  My guidance was for your next issues as you requested &quot;just guidance in improving&quot;"}, {"owner": {"reputation": 2366, "user_id": 3160967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1d5285da7116b41a824dd9cf0e77e4ea?s=128&d=identicon&r=PG", "display_name": "mwag", "link": "https://stackoverflow.com/users/3160967/mwag"}, "edited": false, "score": 0, "creation_date": 1441230807, "post_id": 32363024, "comment_id": 52600108, "body": "@Adam&#39;Sacki&#39;Sackfield uh yea, I get it-- it seems you either didn&#39;t read or didn&#39;t understand my comment, which implicitly means that you would use scanf() to scan a STRING, not a float, and then convert that string to int."}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "edited": false, "score": 0, "creation_date": 1441228204, "post_id": 32363118, "comment_id": 52598994, "body": "Hi, This is where I get stuck, I guess &#39;gcc&#39; is like &#39;cc&#39; that is used when I use the &#39;make&#39; command to compile my &#39;c&#39;. I literally don&#39;t have a clue what the -lm does and what an equivalent would be with the make command. Perhaps I can set up GCC."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "edited": false, "score": 1, "creation_date": 1441228265, "post_id": 32363118, "comment_id": 52599015, "body": "Adding <code>-lm</code> says &quot;please link against a library called libm &quot;. If you are using a Makefile, find the command used to generate the final binary and add <code>-lm</code> to it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "edited": false, "score": 1, "creation_date": 1441228581, "post_id": 32363118, "comment_id": 52599161, "body": "@Adam&#39;Sacki&#39;Sackfield Since you&#39;re using a makefile, you probably want to add it to <code>LDFLAGS</code> at the beginning of your makefile or just use <code>make LDFLAGS=-lm greedy</code>, assuming your <code>cc</code> line in the makefile has <code>$(LDFLAGS)</code> listed at the end of the line. If it isn&#39;t listed on the <code>cc</code> line, you can either add <code>$(LDFLAGS)</code> at the end of the <code>cc</code> line, or you can just hardcode <code>-lm</code> itself at the end of the line in place of <code>$(LDFLAGS)</code>. <code>$(LDFLAGS)</code> is more flexible, however, since it lets you list more than one library, e.g. <code>make LDFLAGS=&#39;-lmylib -lXt -lX11 -lm</code>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1441228691, "post_id": 32363118, "comment_id": 52599213, "body": "You can use the following mysterious invocation: <code>make myprog LDLIBS=-lm</code> (substitute <code>myprog</code> for whatever you usually make)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1441228737, "post_id": 32363118, "comment_id": 52599235, "body": "@ChronoKitsune: LDLIBS, not LDFLAGS. LDFLAGS comes too early in the command line."}, {"owner": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1441228804, "post_id": 32363118, "comment_id": 52599260, "body": "@rici <code>LDFLAGS</code> is more common - many skeleton makefiles (and default build rules) use e.g. <code>$(CPPFLAGS)</code>, <code>$(CFLAGS)</code> and <code>$(LDFLAGS)</code>.  I don&#39;t think I&#39;ve ever seen one use <code>LDLIBS</code>."}, {"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "edited": false, "score": 0, "creation_date": 1441229075, "post_id": 32363118, "comment_id": 52599373, "body": "Wow thanks peeps. I will try these suggestions shortly and see how it goes. Just for reference I tried what @ouah said and went and compiled it with GCC after some Googling but I got the same error. I will update my post with the command I used. I will also come back once I have tried all other suggestions."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1441229170, "post_id": 32363118, "comment_id": 52599415, "body": "@alnitak the default rules for both gmake and bsdmake use LDLIBS. It is very standard."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "edited": false, "score": 1, "creation_date": 1441229760, "post_id": 32363118, "comment_id": 52599693, "body": "@Adam&#39;Sacki&#39;Sackfield <code>-lm</code> has to be added at the end of the compilation/linking line, not in the middle as you did in your edit."}, {"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "edited": false, "score": 1, "creation_date": 1441229965, "post_id": 32363118, "comment_id": 52599774, "body": "@ouah - Oh man that is awesome, it now compiles. Still wrong but that&#39;s on me to tinker with the math functions that now work. Much appreciated."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 311848, "user_id": 6782, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=128&d=identicon&r=PG", "display_name": "Alnitak", "link": "https://stackoverflow.com/users/6782/alnitak"}, "edited": false, "score": 0, "creation_date": 1441236320, "post_id": 32363118, "comment_id": 52601832, "body": "@Alnitak: Yep, it was added to FreeBSD&#39;s <code>sys.mk</code> file 19 years and 10 months ago (<a href=\"https://svnweb.freebsd.org/base/head/share/mk/sys.mk?r1=10028&amp;r2=11613\" rel=\"nofollow noreferrer\">svnweb.freebsd.org/base/head/share/mk/&hellip;</a>), so if you haven&#39;t looked in 20 years, you could have missed it. With all due respect though, that does rather condition your statement: &quot;I don&#39;t think I&#39;ve ever seen one.&quot; :)"}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 2, "last_activity_date": 1441228038, "creation_date": 1441228038, "answer_id": 32363118, "question_id": 32363024, "link": "https://stackoverflow.com/questions/32363024/c-rounding-issues-cs50/32363118#32363118", "title": "C - Rounding issues (CS50)", "body": "<blockquote>\n  <p>I have seen the posts about -lm and a certain file but if I am honest I don't understand what it means.</p>\n</blockquote>\n\n<p>You have to link to the math library to fix the error. Math functions implementations are usually put as a separate library, the math library. If you use <code>gcc</code> add <code>-lm</code> to the linker command.</p>\n"}, {"comments": [{"owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "edited": false, "score": 0, "creation_date": 1441229374, "post_id": 32363229, "comment_id": 52599491, "body": "I want to round up to 2 decimal places."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1441230725, "post_id": 32363229, "comment_id": 52600082, "body": "Note: <code>round(double)</code> from &lt;math.h&gt; does a better job than this define.  The define has trouble with cases like the number before 0.5 and whole numbers exactly representably as <code>long</code>, but not <code>double</code>, and some others near there.  It <i>does</i> have the advantage that the math library is not needed, which OP has trouble linking."}], "tags": [], "owner": {"reputation": 18827, "user_id": 1413133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hqUmk.jpg?s=128&g=1", "display_name": "Manos Nikolaidis", "link": "https://stackoverflow.com/users/1413133/manos-nikolaidis"}, "is_accepted": false, "score": 0, "last_activity_date": 1446158608, "last_edit_date": 1446158608, "creation_date": 1441228511, "answer_id": 32363229, "question_id": 32363024, "link": "https://stackoverflow.com/questions/32363024/c-rounding-issues-cs50/32363229#32363229", "title": "C - Rounding issues (CS50)", "body": "<p>I presume you want to round floating numbers to the nearest integer. <code>ceilf</code> is not doing that, it is rounding up. You can use this macro for rounding to nearest long when possible:</p>\n\n<pre><code>#define round(x) ((x)&gt;=0?(long)((x)+0.5):(long)((x)-0.5))\n</code></pre>\n\n<p>Also, you get a linking error because you don't link with the math library. For example use :</p>\n\n<pre><code>gcc greedy.c -lm -o greedy\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 2823149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/678216902/picture?type=large", "display_name": "Adam &#39;Sacki&#39; Sackfield", "link": "https://stackoverflow.com/users/2823149/adam-sacki-sackfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1215, "favorite_count": 0, "accepted_answer_id": 32363118, "answer_count": 2, "score": 0, "last_activity_date": 1469847135, "creation_date": 1441227626, "last_edit_date": 1469847135, "question_id": 32363024, "link": "https://stackoverflow.com/questions/32363024/c-rounding-issues-cs50", "title": "C - Rounding issues (CS50)", "body": "<p>I have been Googling this for days now and I am lost. So doing CS50 online and can't seem to get a handle on this rounding of numbers. My program is messing up multiplying floats like <strong>2.10</strong> with integers like <strong>100</strong> it would output <strong>209.xxxxxxxx</strong></p>\n\n<p>Now like I say I have read countless posts on that I should use <strong>ceilf</strong> and include <strong></strong> but I am getting an error</p>\n\n<blockquote>\n  <p>greedy.c:(.text+0x74): undefined reference to `ceilf'\n  collect2: error: ld returned 1 exit status make: *** [greedy] Error 1\n  adam@beethoven:~/projects/atom/edx/pSet1/greedy$</p>\n</blockquote>\n\n<p>I have seen the posts about -lm and a certain file but if I am honest I don't understand what it means.</p>\n\n<p>I am in no way looking for an outright solution, just guidance in improving.</p>\n\n<p>Here is my code, probably not as streamlined as some would like but I am back to basics here ;)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\n  // Initialize Variables\n  int coinsTotal = 0,\n      quarter = 25,\n      dime = 10,\n      nickel = 5,\n      penny = 1,\n      cents;\n  float changeDue;\n\n  do {\n    printf(\"How much change are you owed? (Format = 0.00)($): \");\n    scanf(\"%f\", &amp;changeDue );\n    // Convert to cents\n    cents = changeDue * 100;\n  } while(cents &lt;= 0);\n\n  while (cents &gt;= quarter) {\n    cents = cents - quarter;\n    coinsTotal = coinsTotal + 1;\n  } if (cents == 0) {\n      printf(\"The miminum number of coins is: %d\\n\", coinsTotal);\n  } else {\n      while (cents &gt;= dime) {\n        cents - dime;\n        coinsTotal = coinsTotal + 1;\n      } if (cents == 0) {\n          printf(\"The minimum number of coins is: %d\\n\", coinsTotal);\n      } else {\n          while (cents &gt;= nickel) {\n            cents = cents - nickel;\n            coinsTotal = coinsTotal + 1;\n          } if (cents == 0) {\n              printf(\"The minimum number of coins is: %d\\n\", coinsTotal);\n          } else {\n              while (cents &gt;= penny) {\n                cents = cents - penny;\n                coinsTotal = coinsTotal + 1;\n              } if (cents == 0) {\n                  printf(\"The minimum number of coins is: %d\\n\", coinsTotal);\n                }\n        }\n      }\n    }\n}\n</code></pre>\n\n<p>Basically it should work out the minimum number of coins needed to make a given amount. It works in most cases until the floats mess up. Excuse the notes I like to write what I did so I learn better.</p>\n\n<blockquote>\n  <p>Update Tried to compile with GCC using -lm but still failed.\n  adam@beethoven:~/projects/atom/edx/pSet1/greedy$ gcc -o foo -lm\n  greedy.c /tmp/cc3qHAK7.o: In function <code>main': greedy.c:(.text+0x6e):\n  undefined reference to</code>ceilf' collect2: error: ld returned 1 exit\n  status adam@beethoven:~/projects/atom/edx/pSet1/greedy$</p>\n  \n  <p>SOLUTION Instead of using the <strong>make</strong> command I used gcc and added\n  the -lm flag <strong>At the end of the command</strong> <code>gcc -o foo  greedy.c -lm</code></p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "heapsort"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4197811, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-iqh7uDcli9g/AAAAAAAAAAI/AAAAAAAAAMU/92e_PjDPrEE/photo.jpg?sz=128", "display_name": "Ankit Gupta", "link": "https://stackoverflow.com/users/4197811/ankit-gupta"}, "edited": false, "score": 0, "creation_date": 1441227947, "post_id": 32362990, "comment_id": 52598891, "body": "Thanks a lot! it helped, and it was worth knowing!"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 99, "user_id": 4197811, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-iqh7uDcli9g/AAAAAAAAAAI/AAAAAAAAAMU/92e_PjDPrEE/photo.jpg?sz=128", "display_name": "Ankit Gupta", "link": "https://stackoverflow.com/users/4197811/ankit-gupta"}, "edited": false, "score": 0, "creation_date": 1441228173, "post_id": 32362990, "comment_id": 52598983, "body": "You&#39;re welcome - I recommend you get a <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">good introductory book on C</a> and study it so that you can become familiar with the basics of the language - that way you&#39;ll be more productive and learn faster."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 3, "last_activity_date": 1441227489, "creation_date": 1441227489, "answer_id": 32362990, "question_id": 32362925, "link": "https://stackoverflow.com/questions/32362925/invalid-types-int-complex-int-for-array-subscript/32362990#32362990", "title": "invalid types &#39;int*[__complex__ int]&#39; for array subscript", "body": "<p>In C <code>2i</code> is a complex (imaginary) number (the compiler error message is actually telling you exactly this). You need to use the <code>*</code> operator for multiplication. Change all occurrences of <code>arr[2i]</code> to <code>arr[2*i]</code>, e.g.</p>\n\n<pre><code>    arr[2i] = arr[i];\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>    arr[2*i] = arr[i];\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4197811, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-iqh7uDcli9g/AAAAAAAAAAI/AAAAAAAAAMU/92e_PjDPrEE/photo.jpg?sz=128", "display_name": "Ankit Gupta", "link": "https://stackoverflow.com/users/4197811/ankit-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441227653, "creation_date": 1441227266, "last_edit_date": 1441227653, "question_id": 32362925, "link": "https://stackoverflow.com/questions/32362925/invalid-types-int-complex-int-for-array-subscript", "title": "invalid types &#39;int*[__complex__ int]&#39; for array subscript", "body": "<p>This is my code, and I am not able to find out where am I going wrong.</p>\n\n<pre><code>void heapify(int arr[], int n)\n{\nint i=n/2 , j, temp;\nfor(i=n/2; i&gt;0; i--)\n{\n    if(arr[2i]&lt;arr[i])\n    {\n        temp = arr[2i];\n        arr[2i]= arr[i];\n        arr[i]= temp;\n    }\n    if(arr[2i+1]&lt;arr[i])\n    {\n        temp = arr[2i];\n        arr[2i]= arr[i];\n        arr[i]= temp;\n    }\n}\nprintf(\"Output:\\n\");\nfor(j=1; j&lt;=n; j++)\n{\n    printf(\"%d \", arr[j]);\n}\n}\n\nint main()\n{\nint arr[11]={0,12,54,21,74,1,46,91,13,76,22}, n=10;\nheapify(arr, n);\nreturn 0;\n}\n</code></pre>\n\n<p>It throws up the following error:</p>\n\n<pre><code>[Error] invalid types 'int*[__complex__ int]' for array subscript\n</code></pre>\n\n<p>Please help..Am struggling to implement heapsort here. Thanks in advance</p>\n"}, {"tags": ["c", "string", "gcc"], "comments": [{"owner": {"reputation": 30138, "user_id": 71141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e1f5d1bd28627ad2f5a9b47ef63a2dc8?s=128&d=identicon&r=PG", "display_name": "Etienne de Martel", "link": "https://stackoverflow.com/users/71141/etienne-de-martel"}, "edited": false, "score": 0, "creation_date": 1441227346, "post_id": 32362918, "comment_id": 52598616, "body": "The message tells you exactly what&#39;s going on. What don&#39;t you understand in it?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441228363, "post_id": 32362918, "comment_id": 52599066, "body": "&quot;1 warning generated.&quot; != &quot;a compilation error&quot;."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1441228675, "post_id": 32362918, "comment_id": 52599205, "body": "A warning is not the same thing as an error."}], "answers": [{"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 22, "last_activity_date": 1441227710, "last_edit_date": 1441227710, "creation_date": 1441227406, "answer_id": 32362969, "question_id": 32362918, "link": "https://stackoverflow.com/questions/32362918/error-format-string-is-not-a-string-literal/32362969#32362969", "title": "Error: format string is not a string literal", "body": "<p>Use:</p>\n\n<pre><code>printf(\"%s\", str_a);\n</code></pre>\n\n<p>to get rid of the warning when <code>-Wformat-security</code> is enabled. </p>\n\n<p>The diagnostic is informative to avoid <a href=\"https://www.owasp.org/index.php/Format_string_attack\" rel=\"noreferrer\">format string vulnerability</a>. For example:</p>\n\n<pre><code>strcpy(str_a, \"%x%x%x%x\");\nprintf(str_a);\n</code></pre>\n\n<p>would be equivalent to:</p>\n\n<pre><code>printf(\"%x%x%x%x\");\n</code></pre>\n\n<p>which is missing the required arguments and can be used by an attacker to dump the stack (assuming <code>str_a</code> is under user control, which is not the case in your program, but <code>gcc</code> is not smart enough to figure).</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "is_accepted": false, "score": 3, "last_activity_date": 1441227452, "creation_date": 1441227452, "answer_id": 32362980, "question_id": 32362918, "link": "https://stackoverflow.com/questions/32362918/error-format-string-is-not-a-string-literal/32362980#32362980", "title": "Error: format string is not a string literal", "body": "<p>This is not an error but a warning. When using printf to print a string you want something like <code>printf(\"%s\", str_a)</code>. Whenever you have a string in quotes (\" \") it's a string literal this is what the warning means when it says not a string literal. I am not completely sure why you need to have a string literal but it is usually best to follow the compiler; someone else can probabally clarify the need for a string literal. </p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1441230170, "last_edit_date": 1441230170, "creation_date": 1441227663, "answer_id": 32363031, "question_id": 32362918, "link": "https://stackoverflow.com/questions/32362918/error-format-string-is-not-a-string-literal/32363031#32363031", "title": "Error: format string is not a string literal", "body": "<p>If you were to do something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char str_a[20];\n\n    fgets(str_a, 20, stdin);\n    printf(str_a);\n}\n</code></pre>\n\n<p>And the user entered in <code>A %s bad %n string</code>, the user will be able to crash your program, and perhaps start a shell.</p>\n\n<p>With this input, the user can effectively do this:</p>\n\n<pre><code>printf(\"A %s bad %n string\");\n</code></pre>\n\n<p>The <code>%s</code> specifier causes the function to read from an invalid address, while the <code>%n</code> specifier causes it to <em>write</em> to an invalid address.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 9, "last_activity_date": 1441620337, "last_edit_date": 1441620337, "creation_date": 1441228728, "answer_id": 32363278, "question_id": 32362918, "link": "https://stackoverflow.com/questions/32362918/error-format-string-is-not-a-string-literal/32363278#32363278", "title": "Error: format string is not a string literal", "body": "<p>Consider 3 <code>printf()</code> statements.  Which can the compiler detect if a format mis-match exists?</p>\n\n<pre><code>void foo(const char *str_a,int x) {\n  printf(\"Hello %d\\n\", x);  // Compiler sees this is good\n  printf(\"Hello %d\\n\");     // Compiler sees this is bad --&gt; warning/error\n  printf(str_a, x);         // Compiler cannot tell - thus the warning\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 0, "last_activity_date": 1441229463, "creation_date": 1441229463, "answer_id": 32363460, "question_id": 32362918, "link": "https://stackoverflow.com/questions/32362918/error-format-string-is-not-a-string-literal/32363460#32363460", "title": "Error: format string is not a string literal", "body": "<p>The warning is issued because good compilers compare the format specifiers like <code>%d</code> in the format string against the types (here an <code>int</code>) following the format. This obviously only works for string literals that the compiler can analyze for specifiers. A pointer-to-char in a variable defeats this sanity check of types.</p>\n\n<p>Note that non-matching format specifiers (or argument types) cause <strong>undefined behavior</strong> and often lead to garbage values being converted or crashes. Think about what happens when a <code>%s</code> is associated with an integral value.</p>\n"}], "owner": {"reputation": 12258, "user_id": 4596596, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b00c839c9e28eb73aeb299bf3ef69a76?s=128&d=identicon&r=PG&f=1", "display_name": "ShanZhengYang", "link": "https://stackoverflow.com/users/4596596/shanzhengyang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21210, "favorite_count": 3, "accepted_answer_id": 32362969, "answer_count": 5, "score": 10, "last_activity_date": 1492901635, "creation_date": 1441227241, "last_edit_date": 1492901635, "question_id": 32362918, "link": "https://stackoverflow.com/questions/32362918/error-format-string-is-not-a-string-literal", "title": "Error: format string is not a string literal", "body": "<p>I have written a simple program in C, which allocates memory for a string vector and then prints this. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char str_a[20];\n\n    strcpy(str_a, \"Hello, world!\\n\");\n    printf(str_a);\n}\n</code></pre>\n\n<p>Using compiler <code>gcc</code>, this gives a compilation error:</p>\n\n<pre><code>char_array2.c:8:12: warning: format string is not a string literal\n      (potentially insecure) [-Wformat-security]\n    printf(str_a);\n\n1 warning generated.\n</code></pre>\n\n<p>I do not understand why I am getting a warning. Can someone explain it to me? </p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 14, "creation_date": 1441227081, "post_id": 32362846, "comment_id": 52598492, "body": "have a look at the definition of this site&#39;s name...."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1441227093, "post_id": 32362846, "comment_id": 52598506, "body": "You have used more stack for the recursive calls than you have available to you."}, {"owner": {"reputation": 14316, "user_id": 1012936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eXQaP.png?s=128&g=1", "display_name": "milleniumbug", "link": "https://stackoverflow.com/users/1012936/milleniumbug"}, "edited": false, "score": 0, "creation_date": 1441227179, "post_id": 32362846, "comment_id": 52598551, "body": "Try running it with the debugger and follow the program step-by-step"}, {"owner": {"reputation": 2102, "user_id": 4261176, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qbFxl4sLRVc/AAAAAAAAAAI/AAAAAAAAEl4/KJa6x8OokiY/photo.jpg?sz=128", "display_name": "Paulo Avelar", "link": "https://stackoverflow.com/users/4261176/paulo-avelar"}, "edited": false, "score": 1, "creation_date": 1441228198, "post_id": 32362846, "comment_id": 52598990, "body": "You <b>missed a semi-colon</b> in your rec(n-1) line."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1441227849, "post_id": 32363006, "comment_id": 52598857, "body": "Ths missing semicolon is obviously a copying error, otherwise the code won&#39;t even compile."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1441227947, "post_id": 32363006, "comment_id": 52598893, "body": "Each call creates a stack <b>frame</b>, not an entire stack."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1441228016, "post_id": 32363006, "comment_id": 52598924, "body": "@DietmarK&#252;hl While there may not be a need to create new stack frames for tail-calls, many implementations will do so anyway. It may depend on compiler options, such as optimization setting."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1441228459, "post_id": 32363006, "comment_id": 52599112, "body": "<i>&quot; have the problem that each call creates a new stack.&quot;</i> Huh?? If so, there wouldn&#39;t be a problem."}], "tags": [], "owner": {"reputation": 1, "user_id": 5087004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQ325.jpg?s=128&g=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5087004/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1441227568, "creation_date": 1441227568, "answer_id": 32363006, "question_id": 32362846, "link": "https://stackoverflow.com/questions/32362846/recursive-function-core-dumped/32363006#32363006", "title": "recursive function core dumped", "body": "<p>You missed a semicolon and i guess that you want to print the number n and not\nn times the letter n. Here is your fixed code.</p>\n\n<pre><code>void rec(int n){\n    if(n&gt;0){\n        rec(n-1);\n        printf(\"%d\\n\",n);\n    }\n}\n</code></pre>\n\n<p>To get back to your problem. Recursive function have the problem that each call creates a new stack. You can imagine that with each call you go deeper and deeper and are only climbing back up at the very end.\nThe number of stacks is limited, so the program will eventually crash if you increase the number of recursive calls.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 5294255, "user_type": "registered", "profile_image": "https://graph.facebook.com/686889531446201/picture?type=large", "display_name": "sunil", "link": "https://stackoverflow.com/users/5294255/sunil"}, "edited": false, "score": 0, "creation_date": 1441229185, "post_id": 32363291, "comment_id": 52599420, "body": "thanks for info.. can we increase the stack size for GCC compiler ?"}, {"owner": {"reputation": 456, "user_id": 5195032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8bdbf3441f787e76b72f80b6609e475?s=128&d=identicon&r=PG", "display_name": "Denis Babarykin", "link": "https://stackoverflow.com/users/5195032/denis-babarykin"}, "reply_to_user": {"reputation": 61, "user_id": 5294255, "user_type": "registered", "profile_image": "https://graph.facebook.com/686889531446201/picture?type=large", "display_name": "sunil", "link": "https://stackoverflow.com/users/5294255/sunil"}, "edited": false, "score": 0, "creation_date": 1441229415, "post_id": 32363291, "comment_id": 52599509, "body": "Yes of course. But you must use special compiler&#39;s option, for example: <code>gcc -Wl,--stack,16777216 -o file.exe file.c</code> This option increases stack size for current program to 16 MiB."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1441230761, "post_id": 32363291, "comment_id": 52600097, "body": "pthread utilities (of posix) can report and modify the stack size on linux."}], "tags": [], "owner": {"reputation": 456, "user_id": 5195032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8bdbf3441f787e76b72f80b6609e475?s=128&d=identicon&r=PG", "display_name": "Denis Babarykin", "link": "https://stackoverflow.com/users/5195032/denis-babarykin"}, "is_accepted": true, "score": 2, "last_activity_date": 1441228786, "creation_date": 1441228786, "answer_id": 32363291, "question_id": 32362846, "link": "https://stackoverflow.com/questions/32362846/recursive-function-core-dumped/32363291#32363291", "title": "recursive function core dumped", "body": "<p>For programs compiled with GCC with default settings stack size is about 2 megabytes. So you are limited in recursive calls by your stack size, because every not-tail recursion function call reduces free stack memory. Thats why you will get stack overflow when <code>n</code> is big number.</p>\n"}], "owner": {"reputation": 61, "user_id": 5294255, "user_type": "registered", "profile_image": "https://graph.facebook.com/686889531446201/picture?type=large", "display_name": "sunil", "link": "https://stackoverflow.com/users/5294255/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "closed_date": 1441249133, "accepted_answer_id": 32363291, "answer_count": 2, "score": 0, "last_activity_date": 1441228786, "creation_date": 1441226936, "last_edit_date": 1441227915, "question_id": 32362846, "link": "https://stackoverflow.com/questions/32362846/recursive-function-core-dumped", "closed_reason": "Not suitable for this site", "title": "recursive function core dumped", "body": "<p>I tried to compile the following program </p>\n\n<pre><code>void rec(int n)\n{\n    if(n&gt;0)\n   {\n        rec(n-1)\n        print (\"n\");\n\n   }\n}\n</code></pre>\n\n<p>Here <code>n</code> value is a big no. like <code>1000000</code>.</p>\n\n<p>o/p is : <code>segmentation fault (core dumped)</code></p>\n\n<p>Can anyone explain what exactly happens here ?\nThanks.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1441226329, "post_id": 32362560, "comment_id": 52598081, "body": "In both the &quot;average&quot; and the &quot;max&quot; code you need a line like <code>value=a[i][j];</code> to get a value from the array. In the &quot;max&quot; code the first line should be <code>int variableP = a[0][0];</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441226487, "post_id": 32362560, "comment_id": 52598171, "body": "Declare <code>int GetRand(int min, int max);</code> before <code>main()</code> calls it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441226832, "post_id": 32362560, "comment_id": 52598354, "body": "Suspicious that &quot;Average&quot; code does <code>&#47;&#47;For the average for(i=0; i&lt;1; i++){</code> and not <code>for(i=0; i&lt;21; i++) {</code>  (1 vs.21)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441304257, "post_id": 32362560, "comment_id": 52635948, "body": "What are your trying got do with <code>value = a[i][j];</code>?  What does this code mean to you?"}, {"owner": {"reputation": 87, "user_id": 5294174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f385c2abe41f20999a6a0da081b0e0?s=128&d=identicon&r=PG", "display_name": "Mimic01", "link": "https://stackoverflow.com/users/5294174/mimic01"}, "edited": false, "score": 0, "creation_date": 1441305229, "post_id": 32362560, "comment_id": 52636519, "body": "Would that be the actual value that is being read?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5294174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f385c2abe41f20999a6a0da081b0e0?s=128&d=identicon&r=PG", "display_name": "Mimic01", "link": "https://stackoverflow.com/users/5294174/mimic01"}, "edited": false, "score": 0, "creation_date": 1441303262, "post_id": 32362622, "comment_id": 52635432, "body": "it&#39;s not working but i think i&#39;m close, is it that i wrote wrong the actions after the conditions in the if&#39;s statements?"}], "tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": false, "score": 1, "last_activity_date": 1441226196, "creation_date": 1441226196, "answer_id": 32362622, "question_id": 32362560, "link": "https://stackoverflow.com/questions/32362560/finding-max-value-and-average-of-all-elemements-in-2d-array-in-c/32362622#32362622", "title": "Finding Max value and Average Of All elemements in 2D array in C", "body": "<p>Sum is as you say.\nAverage requires you count number of >-1 values.\nMax looks right lines.  Finish off your ideas and ask again if it doesn't work</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1441226749, "post_id": 32362665, "comment_id": 52598312, "body": "Note: <code>max=INT_MIN</code> is more idiomatic than <code>max=-999999</code>"}], "tags": [], "owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "is_accepted": true, "score": 0, "last_activity_date": 1441226354, "creation_date": 1441226354, "answer_id": 32362665, "question_id": 32362560, "link": "https://stackoverflow.com/questions/32362560/finding-max-value-and-average-of-all-elemements-in-2d-array-in-c/32362665#32362665", "title": "Finding Max value and Average Of All elemements in 2D array in C", "body": "<p>You can do both max and avg in one loop. </p>\n\n<p>Declare three variables: max=-999999, sum=0, count=0.</p>\n\n<p>Each time when current cell is not -1 increase sum by it's value and count by 1.</p>\n\n<p>Each time check if current value is bigger than max, then set max to current value.</p>\n\n<p>After the loop is done, avg = sum/count.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1441356965, "creation_date": 1441356965, "answer_id": 32394009, "question_id": 32362560, "link": "https://stackoverflow.com/questions/32362560/finding-max-value-and-average-of-all-elemements-in-2d-array-in-c/32394009#32394009", "title": "Finding Max value and Average Of All elemements in 2D array in C", "body": "<p>Consider you are doing all your arithmetic using integers, and integer division is integer.  Perhaps you have better to do a <code>double</code> result with:</p>\n\n<pre><code>/* you don't actually need to cast to double in both operators, as the\n * one not casted will be automagically casted to double to operate on.\n */\ndouble average = (double) sum_of_samples / (double) number_of_samples;\n</code></pre>\n\n<p>You have to cast at least one of the operators, because if you don't you'll get the result as before (a <code>0</code> integer result) converted to <code>double</code> to assign to the variable.</p>\n"}], "owner": {"reputation": 87, "user_id": 5294174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f385c2abe41f20999a6a0da081b0e0?s=128&d=identicon&r=PG", "display_name": "Mimic01", "link": "https://stackoverflow.com/users/5294174/mimic01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 32362665, "answer_count": 3, "score": 0, "last_activity_date": 1441356965, "creation_date": 1441225918, "last_edit_date": 1441325310, "question_id": 32362560, "link": "https://stackoverflow.com/questions/32362560/finding-max-value-and-average-of-all-elemements-in-2d-array-in-c", "title": "Finding Max value and Average Of All elemements in 2D array in C", "body": "<p><strong>EDIT II</strong></p>\n\n<p>I'm finally getting somewhere, now i get my random values with a return from the maxavg() function.</p>\n\n<p>My only question now is, when i run the program i always get:</p>\n\n<p>average: 0\nmaximum: 33</p>\n\n<p>why? it does not make much sense.</p>\n\n<p>Here is the new code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt; \n#include &lt;limits.h&gt;\n\nint GetRand(int min, int max);\nstruct maxavg;\n\nint main ()\n{\nint a[21][21], i , j, average, maximum, ret;\n\n\nfor (i = 0; i &lt; 21; i++)\n{\n    for ( j = 0; j &lt; 21; j++)\n    {\n        a[i][j] = GetRand(0, 100);\n\n        printf(\"%3d\" , a[i][j]);\n    }\n\n        a[2][15] = -1;\n        a[10][6] = -1;\n        a[13][5] = -1;\n        a[15][17] = -1;\n        a[17][17] = -1;\n        a[19][6] = -1;\n\n    printf(\"\\n\");\n\n}\n\n\n\n\nprintf(\"average = %d \\n maximum = %d\", average, maximum);\n\n\n\n\nreturn 0;\n\n}\n\n\n\n// random seed\nint GetRand(int min, int max);\nint get () \n{\nint i, r;\nfor (i = 0; i &lt; 21; i++)\n {\n    r = GetRand(0, 100);\n    printf(\"Your number is %d \\n\", r);\n}\n return(0);\n }\n\nint GetRand(int min, int max)\n{\nstatic int Init = 0;\nint rc;             \n\nif (Init == 0)\n{\n    srand(time(NULL));\n    Init = 1;\n}\n\nrc = (rand() % (max - min +1) +min);\n\nreturn (rc);\n}\n\n\nstruct pair\n{\nint max;\nint avg;\n};\n\n\n\n\n\n// max and average\n\nstruct pair maxavg()\n{\nstruct pair p;\nint max=INT_MIN, sum=0, count=0, avg, i, j, current;\n\nfor(i = 0; i &lt; 21; i++){\n    for(j =0; j &lt; 21; j++){\n        if(current &gt; -1){\n            sum = sum + current;\n            count = count + 1\n            ;if(current &gt; max){\n                max = current;\n            }\n        }\n\n    }\n}\navg = sum/count;\nprintf(\"Max is %d \\n\", max);\nprintf(\"Average is %d \\n\", avg);\np.max = max;\np.avg = avg;\n\nreturn p;\n</code></pre>\n\n<p>}</p>\n\n<p>EDIT:</p>\n\n<p>So here is what i'm doing, i get error messages:</p>\n\n<p>Average:</p>\n\n<pre><code>// Average Code\n\nvalue = a[i][j];\nint actualvalue, suma = 0, quant;\n\n\nfor(i=0; i&lt;21; i++){\nfor(j=0; j&lt;21; j++){\n    if (actualvalue &gt; -1){\n        a[i][j] = actualvalue;\n        suma = suma + actualvalue;\n        // sum actual value + nextvalue (sum of all &gt; -1) //\n    }\n    else if {\n        quant = quant + 1;\n    //(sum the quantity of times a value has been greater than -1)//\n    }\n}\n}\nprintf(\"The average value is:\", suma/quant); ///(sun of all values &gt; -1)/(sum of  quantity value was &gt; -1)/\n</code></pre>\n\n<p>Find Maximum:</p>\n\n<pre><code>// Max\n\nint variableP = a[0][0];\nvalue = a[i][j];\n\nint variableP = a[i][j]\nfor(i=0; i&lt;21; i++){\n    for(j=0; j&lt;21; j++){\n        if(variableP &lt; newvalue){\n            variableP = newvalue\n        }\n    }\n}\nprintf(\"The max value of the 2D array is\", %d);\n</code></pre>\n\n<p>Average and Maximum:</p>\n\n<pre><code>// max and average\n\nint maxvg();\nint max=INT_MIN, sum=0, count=0, avg;\n\nfor(i = 0; i &lt; 21; i++){\n    for(j =0; j &lt; 21; j++){\n        if(current &gt; -1){\n            sum = sum + current;\n            count = count + 1\n            if(current &gt; max){\n                max = current;\n            }\n        }\n\n    }\n}\navg = sum/count;\nprintf(\"Max is %d \\n\", max);\nprintf(\"Average is %d \\n\", avg);\n</code></pre>\n\n<p>So how right or wrong is this? what am i missing.\ni mostly get:</p>\n\n<pre><code>[Error] expected '=', ',', ';', 'asm' or '__attribute__' before '&lt;' token\n[Warning] data definition has no type or storage class\n[Error] initializer element is not constant\n[Error] expected declaration specifiers or '...' before string constant\n</code></pre>\n\n<p>Am i at least close to it?</p>\n\n<p>Thanks in advance.</p>\n\n<p>END OF EDIT</p>\n\n<p>I created a 2D array with random numbers from 0 to 100 (and a couple of -1) values with this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n\nint main ()\n{\n\n    int a[21][21], i, j;\n\n    for (i = 0; i &lt; 21; i++) {\n        for (j = 0; j &lt; 21; j++) {\n            a[i][j] = GetRand (0, 100);\n            a[7][15] = -1;\n            a[10][6] = -1;\n            a[13][5] = -1;\n            a[15][17] = -1;\n            a[17][17] = -1;\n            a[19][6] = -1;\n            printf (\"%3d\", a[i][j]);\n        }\n        printf (\"\\n\");\n    }\n    return 0;\n}\n\n\n\n// random seed\nint GetRand (int min, int max);\nint get ()\n{\n    int i, r;\n    for (i = 0; i &lt; 21; i++) {\n        r = GetRand (0, 100);\n        printf (\"Your number is %d \\n\", r);\n    }\n    return (0);\n}\n\nint GetRand (int min, int max)\n{\n    static int Init = 0;\n    int rc;\n\n    if (Init == 0) {\n        srand (time (NULL));\n        Init = 1;\n    }\n\n    rc = (rand () % (max - min + 1) + min);\n\n    return (rc);\n}\n</code></pre>\n\n<p>This prints the array created. Now I want to calculate the maximum value of all  values inside the array and the total average of all values in the array, all while ignoring all -1 values, so only from 0 to 100. Since I'm a total beginner I'm having problems creating these functions. So here are my ideas.</p>\n\n<pre><code>//For the average\nfor(i=0; i&lt;1; i++){\n   for(j=0; j&lt;21; j++){\n\n  if (actualvalue &gt; -1){\n  //sum actualvalue + nextvalue (sum of all the values greater than -1)//\n }\n else if (actualvalue &gt; -1){\n //(sum the quantity of times a value has been greater than -1)//\n }\n  }\n   }\n    }\nprintf(\"The average value is\", //(sum of all values&gt;-1)/(sum of quantity value was &gt;-1) //);\n</code></pre>\n\n<p>I'm representing the thing i don't know how to write in code in words so you get my idea.</p>\n\n<p>Now for finding the maximum: what i think i should do is initialize the array and make a variable adopt the first value it finds that's > -1, then rewind and initialize again, if the actualvalue &lt; newvalue then make variableP adopt the newvalue:</p>\n\n<pre><code>//max\nint variableP = a[i][j]\nfor(i=0; i&lt;21; i++){\nfor(j=0;j&lt;21;j++){\n  if(variableP &lt; newvalue){\n variableP = newvalue\n}\nprintf(\"The max value of the 2D array is\", %d);\n }\n</code></pre>\n\n<p>I know it's evident i'm not sure what i'm writing here, but i think my idea of it is correct, i hope i'm explaining it well enough.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 861, "user_id": 743414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4865c7841b624ea4f967e6d1806bbbb0?s=128&d=identicon&r=PG", "display_name": "user743414", "link": "https://stackoverflow.com/users/743414/user743414"}, "edited": false, "score": 4, "creation_date": 1441226288, "post_id": 32362540, "comment_id": 52598057, "body": "Using a macro than typing the code doesn&#39;t slow down your program. Because your preprocessor will replace your macro with it&#39;s contents. The resulting code should be the same."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1441229809, "post_id": 32362540, "comment_id": 52599720, "body": "The macro may waste more time during debugging and maintenance.  It is a <i>false function</i>; it looks like a function but is a macro.  I strongly recommend banning this kind of practice.  Are you really saving a great amount of type (hint: copy and paste is a better technique), or take a keyboarding class."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1441234527, "post_id": 32362540, "comment_id": 52601324, "body": "What you are doing is one of those things that look like a great idea, but are not. In six months, %d in a format string will look absolutely fine to you."}], "answers": [{"comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1441229603, "post_id": 32362703, "comment_id": 52599607, "body": "The macro only saves typing time; which could be wasted by a trip to the coffee machine or restroom.  Take a keyboarding class."}], "tags": [], "owner": {"reputation": 51, "user_id": 5294284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9008f8d4dc9b75b240701ca0ef633d?s=128&d=identicon&r=PG&f=1", "display_name": "walwart", "link": "https://stackoverflow.com/users/5294284/walwart"}, "is_accepted": false, "score": 5, "last_activity_date": 1441229607, "last_edit_date": 1441229607, "creation_date": 1441226466, "answer_id": 32362703, "question_id": 32362540, "link": "https://stackoverflow.com/questions/32362540/using-define-for-printf-does-it-effect-on-speed/32362703#32362703", "title": "Using #define for printf, does it effect on speed", "body": "<p>No this will not effect the speed. The macro is expanded during pre-processing so that in every instance that you use <code>printInt(myInt)</code> what is actually passed to the compiler will be <code>printf(\"%d\", myInt)</code>. So I think the binary output would be identical either way.</p>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 5223868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8667384f7b81ea5c4933bb1af91000b7?s=128&d=identicon&r=PG&f=1", "display_name": "splotz90", "link": "https://stackoverflow.com/users/5223868/splotz90"}, "is_accepted": false, "score": 3, "last_activity_date": 1441230418, "last_edit_date": 1441230418, "creation_date": 1441227284, "answer_id": 32362931, "question_id": 32362540, "link": "https://stackoverflow.com/questions/32362540/using-define-for-printf-does-it-effect-on-speed/32362931#32362931", "title": "Using #define for printf, does it effect on speed", "body": "<p>No, it doesn't affect the speed of your program.</p>\n\n<p>The <code>#define</code> instructions are processed by the preprocessor before your program is compiled.</p>\n\n<p>For example the call </p>\n\n<pre><code>printInt(var);\n</code></pre>\n\n<p>is replaced with</p>\n\n<pre><code>printf (\"%d\",var);\n</code></pre>\n\n<p>by the preprocessor.</p>\n\n<p>Therefore the compiler can't determine if a <code>#define</code> was used or not. In both cases it leads to the <strong>same</strong> code (and the same program). Thats the reason why it isn't possible that both programs differ in their speed.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> If you use a lot of <code>#defines</code> in your program, it is possible that the speed of the proprocessing step decreases. But in most cases this should be no problem.</p>\n"}], "owner": {"reputation": 3, "user_id": 5128714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61581ccab2dff641b883d2510b97ae5d?s=128&d=identicon&r=PG", "display_name": "Kartik Sethi", "link": "https://stackoverflow.com/users/5128714/kartik-sethi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441230418, "creation_date": 1441225856, "last_edit_date": 1441229582, "question_id": 32362540, "link": "https://stackoverflow.com/questions/32362540/using-define-for-printf-does-it-effect-on-speed", "title": "Using #define for printf, does it effect on speed", "body": "<p>I am using </p>\n\n<pre><code>#define printInt(x)  printf (\"%d\",x)\n</code></pre>\n\n<p>In <code>main()</code></p>\n\n<p>I can use it like this:</p>\n\n<pre><code>int var=10;\nprintInt (var);\n</code></pre>\n\n<p>Which is easier to use than typing </p>\n\n<pre><code>printf (\"%d\",var);\n</code></pre>\n\n<p>Will using my own <code>#define</code> for printing an <code>int</code>, <code>float</code> etc make my program slower?</p>\n"}, {"tags": ["c", "eclipse", "linker"], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 3837185, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0287ad5b226567054f9b6214381954d?s=128&d=identicon&r=PG&f=1", "display_name": "TolkienWASP", "link": "https://stackoverflow.com/users/3837185/tolkienwasp"}, "edited": false, "score": 0, "creation_date": 1441226861, "post_id": 32362383, "comment_id": 52598372, "body": "Right, and thanks for the answer. I came to the same conclusion as to you what you advised. Perhaps interface is too OOD of a concept, however the logic in separation still holds.   So if the <b>why</b> of it really is just an issue of global variables -- what are the technicals of how a wrapper solves this issue? Would this not also imply the function being wrapped would still be indistinguishably visible from the linker&#39;s perspective?"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1441225661, "last_edit_date": 1441225661, "creation_date": 1441225161, "answer_id": 32362383, "question_id": 32362237, "link": "https://stackoverflow.com/questions/32362237/why-wont-c-compile-if-two-separate-source-files-in-the-same-workspace-share-fun/32362383#32362383", "title": "Why won&#39;t C compile if two separate source files in the same workspace share function names?", "body": "<blockquote>\n  <p>remember reading at some point that every function not declared static is global</p>\n</blockquote>\n\n<p>Having understood this you got the main point and reason for the behaviour observed.</p>\n\n<p>.h files are not known to the linker, after pre-processing there are only translation units left (typically a .c file with all includes merged in), from which .o files are compiled.</p>\n\n<p>There are no interfaces on language level in C.</p>\n\n<blockquote>\n  <p>Neither of these source files are being included anywhere in the project, so they shouldn't be sharing any compilation units. </p>\n</blockquote>\n\n<p>Declare those functions as <code>static</code>. This is the only way to \"hide\" a function from the linker \"inside\" a translation unit.</p>\n"}, {"comments": [{"owner": {"reputation": 300, "user_id": 3837185, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0287ad5b226567054f9b6214381954d?s=128&d=identicon&r=PG&f=1", "display_name": "TolkienWASP", "link": "https://stackoverflow.com/users/3837185/tolkienwasp"}, "edited": false, "score": 0, "creation_date": 1441226019, "post_id": 32362441, "comment_id": 52597908, "body": "I&#39;m well aware of these tenants. This does not address my question as to what occurs during the compilation/linker process that would give rise to an issue."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 300, "user_id": 3837185, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0287ad5b226567054f9b6214381954d?s=128&d=identicon&r=PG&f=1", "display_name": "TolkienWASP", "link": "https://stackoverflow.com/users/3837185/tolkienwasp"}, "edited": false, "score": 0, "creation_date": 1441226550, "post_id": 32362441, "comment_id": 52598205, "body": "@TolkienWASP I wouldn&#39;t exactly call it an issue.  That&#39;s the way the linker works, and that&#39;s the restriction you need to work with when programming in C."}, {"owner": {"reputation": 300, "user_id": 3837185, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0287ad5b226567054f9b6214381954d?s=128&d=identicon&r=PG&f=1", "display_name": "TolkienWASP", "link": "https://stackoverflow.com/users/3837185/tolkienwasp"}, "edited": false, "score": 0, "creation_date": 1441227118, "post_id": 32362441, "comment_id": 52598520, "body": "There is no explanation in your answer as to <b>how</b> it works. My question was not coming from an inability to distinguish the rules."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1441225426, "creation_date": 1441225426, "answer_id": 32362441, "question_id": 32362237, "link": "https://stackoverflow.com/questions/32362237/why-wont-c-compile-if-two-separate-source-files-in-the-same-workspace-share-fun/32362441#32362441", "title": "Why won&#39;t C compile if two separate source files in the same workspace share function names?", "body": "<p>It doesn't matter whether one source module includes headers for another.  Header files only contain declarations for the purpose of local functions being able to find functions in other modules.  It doesn't mean that functions not declared don't exist from the perspective of that module.</p>\n\n<p>When everything gets linked together, anything not specifically defined to be local to one source module (i.e. <code>static</code>) has to have a unique name across all linked components.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1441227529, "last_edit_date": 1441227529, "creation_date": 1441226646, "answer_id": 32362760, "question_id": 32362237, "link": "https://stackoverflow.com/questions/32362237/why-wont-c-compile-if-two-separate-source-files-in-the-same-workspace-share-fun/32362760#32362760", "title": "Why won&#39;t C compile if two separate source files in the same workspace share function names?", "body": "<p>This is the concept of \"linkage\".  Every function and variable in C has a linkage type, one of \"external\", \"internal\", and \"none\".  (Only variables can have no linkage.)</p>\n\n<p>Functions have external linkage by default, which means that they can be called by name from any compilation unit (where \"compilation unit\" roughly means one source file and all the headers it includes).  This can be expressed explicitly by declaring them <code>extern</code>, or it can be overridden by declaring them <code>static</code>.  Functions declared <code>static</code> have internal linkage, meaning they can be referenced by name only from other functions in the same compilation unit.</p>\n\n<p>No two external functions anywhere in the same program can have the same name, regardless of header files, but static functions in different compilation units may have the same name.  A static function may have the same name as an external function, too -- then the name resolves to the static function within its compilation unit, and to the external function elsewhere.  These restrictions make sense, for otherwise it would be possible for a function call to be ambiguous. </p>\n\n<p>Header files don't factor into the linkage equation at all.  They are primarily a vehicle for sharing declarations, but a function's linkage depends only on <em>how</em> it is declared, not on <em>where</em>.</p>\n\n<p>I leave discussion of variables' linkage for another time.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1441228630, "creation_date": 1441228630, "answer_id": 32363255, "question_id": 32362237, "link": "https://stackoverflow.com/questions/32362237/why-wont-c-compile-if-two-separate-source-files-in-the-same-workspace-share-fun/32363255#32363255", "title": "Why won&#39;t C compile if two separate source files in the same workspace share function names?", "body": "<p>C doesn't \"mangle\" function names the way C++ or Java do (since C doesn't support function polymorphism). </p>\n\n<p>For example, in C++, the functions</p>\n\n<pre><code>void foo( void );\nvoid foo( int x );\nvoid foo( int x, double y );\n</code></pre>\n\n<p>have their names \"mangled\" into the unique symbols<sup>1</sup></p>\n\n<pre><code>_Z3fooid\n_Z3fooi \n_Z3foov\n</code></pre>\n\n<p>which is how overloaded function/method calls are disambiguated at the machine level.</p>\n\n<p>C doesn't do that; instead, the linker sees two different function definitions using the same symbol and yaks because it has no way to disambiguate the two.</p>\n\n<p><hr>\n<sup>1. This is what happens on my system, anyway</sup></p>\n"}], "owner": {"reputation": 300, "user_id": 3837185, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0287ad5b226567054f9b6214381954d?s=128&d=identicon&r=PG&f=1", "display_name": "TolkienWASP", "link": "https://stackoverflow.com/users/3837185/tolkienwasp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 32362760, "answer_count": 4, "score": 0, "last_activity_date": 1441228630, "creation_date": 1441224641, "last_edit_date": 1441227274, "question_id": 32362237, "link": "https://stackoverflow.com/questions/32362237/why-wont-c-compile-if-two-separate-source-files-in-the-same-workspace-share-fun", "title": "Why won&#39;t C compile if two separate source files in the same workspace share function names?", "body": "<p>I'm using eclipse indigo, gcc and cdt in a project. If two functions in separate source files share names (regardless of return type or parameters), eclipse flags a redefinition error. This isn't a huge issue regarding this project given I can easily rename these functions, and I'm well aware of wrappers if it were. Although this isn't a critical issue, it does make me think I'm not understanding the c build process. What occurs during the build process in which a program structure like this would cause issue?</p>\n\n<p><strong>Here's some more info. on the situation, and where my understanding is so far -- not necessary to answer the question, although there must be a hole in my understanding.</strong> </p>\n\n<p>In this case, the two functions are intended to be used only locally, as such their prototypes are not given in the .h interface, and for the sake of my point, neither are defined 'static'. </p>\n\n<p>Neither of these source files are being included anywhere in the project, so they shouldn't be sharing any compilation units. With that in consideration, I would have assumed that the neither source file is aware of the presence of the other, and the compiler would have no problem indexing the two functions, as the separate files would allow for proper distinguishing between the two during linking -- so long as they weren't included in the same compilation unit.</p>\n\n<p>I noticed that statically defining either instance of the function declaration removes the error. I remember reading at some point that every function not declared static is global -- although given these functions are not a part of the .h interface, the practical example in which including the .h interface doesn't allow for the including program to reference all .c functions would indicate \"hiding\" these functions would be of no issue.</p>\n\n<p>What am I overlooking? </p>\n\n<p>Some insight would be greatly appreciated, thanks! </p>\n"}, {"tags": ["c", "ruby", "mri"], "answers": [{"comments": [{"owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "edited": false, "score": 0, "creation_date": 1441274579, "post_id": 32361813, "comment_id": 52616446, "body": "Credits to you man :) <a href=\"https://github.com/ruby/ruby/commit/e26ba49bd15079b5567048ef1714c2b6d1719eee\" rel=\"nofollow noreferrer\">github.com/ruby/ruby/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": true, "score": 2, "last_activity_date": 1441223879, "last_edit_date": 1441223879, "creation_date": 1441223076, "answer_id": 32361813, "question_id": 32361688, "link": "https://stackoverflow.com/questions/32361688/where-error-message-argumenterror-no-id-given-comes-from-when-calling-method-mi/32361813#32361813", "title": "Where error message ArgumentError: no id given comes from when calling method_missing", "body": "<p><a href=\"https://www.omniref.com/ruby/2.2.0/files/vm_eval.c#line=683\" rel=\"nofollow\"><code>raise_method_missing()</code></a> does raise that argument error:</p>\n\n<pre><code>static void\nraise_method_missing(rb_thread_t *th, int argc, const VALUE *argv, VALUE obj,\n                     int last_call_status)\n{\n    // ...\n    if (argc == 0 || !SYMBOL_P(argv[0])) {\n        rb_raise(rb_eArgError, \"no id given\");\n    }\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 32361813, "answer_count": 1, "score": -1, "last_activity_date": 1441223879, "creation_date": 1441222578, "last_edit_date": 1592644375, "question_id": 32361688, "link": "https://stackoverflow.com/questions/32361688/where-error-message-argumenterror-no-id-given-comes-from-when-calling-method-mi", "title": "Where error message ArgumentError: no id given comes from when calling method_missing", "body": "<p>When you call <code>method_missing</code> with first parameter as <code>'string'</code> instead of <code>:symbol</code> you get this cryptic error message:</p>\n<pre><code>BasicObject.send(:method_missing, 'any-method')\nArgumentError: no id given\nfrom (pry):3:in `method_missing'\n</code></pre>\n<p>When you look at the <a href=\"https://www.omniref.com/ruby/2.2.0/symbols/BasicObject/method_missing?#annotation=4439641&amp;line=650\" rel=\"nofollow noreferrer\">source code</a> for method_missing</p>\n<pre><code>static VALUE\nrb_method_missing(int argc, const VALUE *argv, VALUE obj)\n{\n    rb_thread_t *th = GET_THREAD();\n    raise_method_missing(th, argc, argv, obj, th-&gt;method_missing_reason);\n    UNREACHABLE;\n}\n</code></pre>\n<p>there is nothing with error message <code>ArgumentError: no id given</code>.\nWhere it comes from?</p>\n"}, {"tags": ["c", "struct", "concurrency"], "answers": [{"tags": [], "owner": {"reputation": 2085, "user_id": 3787736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083a38739359a3cb689c5be4cd7a1985?s=128&d=identicon&r=PG", "display_name": "dho", "link": "https://stackoverflow.com/users/3787736/dho"}, "is_accepted": false, "score": 0, "last_activity_date": 1442107539, "last_edit_date": 1442107539, "creation_date": 1442079061, "answer_id": 32541719, "question_id": 32361619, "link": "https://stackoverflow.com/questions/32361619/how-to-share-ck-list-across-processes/32541719#32541719", "title": "How to share ck_list across processes?", "body": "<p>Fortunately, this has nothing to do with CK and just to do with where your memory is coming from.</p>\n\n<p>Your allocation in the child comes from malloc and lives in the child's address space. The child and parent do not share the same address space (being separate processes), so your malloc(3)-obtained storage for the node and data are not at addresses within the parent's address space.</p>\n\n<p>You need to allocate the memory for the <code>node</code> and <code>node-&gt;data</code> from some shared space as well. I made a minimal set of changes to the code to get it to work for demonstration purposes. Hopefully obviously, you'd want your API to be less fragile in terms of magic numbers to mmap.</p>\n\n<pre><code>#include &lt;sys/mman.h&gt;\n\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;ck_queue.h&gt;\n\nstruct shared_map {\n    CK_LIST_HEAD(list, list_node) list;\n};\n\nstruct list_node {\n    void *data;\n    CK_LIST_ENTRY(list_node) list_entry;\n};\n\nstatic int\ncreate_shared(void **pointer, int size)\n{\n\n    *pointer = mmap(NULL, size, PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, -1, 0);\n    if (*pointer == MAP_FAILED) {\n        perror(\"mmap:\");\n        return -1;\n    }\n\n    return 0;\n}\n\nint\nmain(void)\n{\n    struct list_node *node, *node2;\n    struct shared_map mapping = { .list = CK_LIST_HEAD_INITIALIZER(mapping-&gt;list) };\n    struct shared_map *map = &amp;mapping;\n\n    int rtrn = create_shared((void **)&amp;map, sizeof(struct shared_map) + sizeof(struct list_node) + 5);\n    if (rtrn &lt; 0) {\n        printf(\"Can't create shared mapping\\n\");\n        return -1;\n    }\n\n    CK_LIST_INIT(&amp;map-&gt;list);\n\n    pid_t pid;\n\n    pid = fork();\n    if (pid == 0) {\n        /* Child. */\n        node = (struct list_node *)(map + 1);\n        node-&gt;data = node + 1;\n        memcpy(node-&gt;data, \"test\", 5);\n        CK_LIST_INSERT_HEAD(&amp;map-&gt;list, node, list_entry);\n    } else if (pid &gt; 0) {\n        /* Parent. */\n        sleep(1); // Make sure child runs first.\n\n        CK_LIST_FOREACH(node2, &amp;map-&gt;list, list_entry) {\n            printf(\"out: %s\\n\", (char *)node2-&gt;data);\n        }\n    } else {\n        perror(\"fork\");\n        return -1;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Fundamentally, I just changed the size of the mmap to include space for the list_node and the C string attached to node->data and made the child set that up.</p>\n"}], "owner": {"reputation": 1054, "user_id": 2930456, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/2Etu5.jpg?s=128&g=1", "display_name": "2trill2spill", "link": "https://stackoverflow.com/users/2930456/2trill2spill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442107539, "creation_date": 1441222324, "question_id": 32361619, "link": "https://stackoverflow.com/questions/32361619/how-to-share-ck-list-across-processes", "title": "How to share ck_list across processes?", "body": "<p>I'm trying to use <code>CK_LIST</code> from <a href=\"http://concurrencykit.org/\" rel=\"nofollow\">http://concurrencykit.org/</a> across multiple processes but when I do, the values inside the list nodes are garbage. But the list values are correct when I use the list only from one process.</p>\n\n<p>Here is an example of using <code>CK_LIST</code> in a struct with in a single process.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ck_queue.h&gt;\n\nstruct shared_map\n{\n    CK_LIST_HEAD(list, list_node) list;\n};\n\nstruct list_node\n{\n    void *data;\n\n    CK_LIST_ENTRY(list_node) list_entry;\n\n};\n\nint main(void)\n{\n    struct list_node *node, *node2;\n    struct shared_map mapping = { .list = CK_LIST_HEAD_INITIALIZER(mapping-&gt;list) };\n    struct shared_map *map = &amp;mapping;\n\n    node = malloc(sizeof(struct list_node));\n    if(node == NULL)\n    {\n        perror(\"malloc\");\n        return -1;\n    }\n\n    CK_LIST_INIT(&amp;map-&gt;list);\n\n    int rtrn = asprintf((char **)&amp;node-&gt;data, \"test\");\n    if(rtrn &lt; 0)\n    {\n        perror(\"asprintf\");\n        return -1;\n    }\n\n    CK_LIST_INSERT_HEAD(&amp;map-&gt;list, node, list_entry);\n\n    CK_LIST_FOREACH(node2, &amp;map-&gt;list, list_entry)\n    {\n        printf(\"out: %s\\n\", node2-&gt;data);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>But when I try to use the list between two separate processes the value of <code>node-&gt;data</code> is garbage and causes the process using it to crash. Below is an example.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ck_queue.h&gt;\n\nstruct shared_map\n{\n    CK_LIST_HEAD(list, list_node) list;\n};\n\nstruct list_node\n{\n    void *data;\n\n    CK_LIST_ENTRY(list_node) list_entry;\n\n};\n\nstatic int create_shared(void **pointer, int size)\n{\n    *pointer = mmap(NULL, size, PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, -1, 0);\n    if(*pointer == MAP_FAILED)\n    {\n        perror(\"mmap:\");\n        return -1;\n    }\n\n    return 0;\n}\n\nint main(void)\n{\n    struct list_node *node, *node2;\n    struct shared_map mapping = { .list = CK_LIST_HEAD_INITIALIZER(mapping-&gt;list) };\n    struct shared_map *map = &amp;mapping;\n\n    int rtrn = create_shared((void **)&amp;map, sizeof(struct shared_map));\n    if(rtrn &lt; 0)\n    {\n        printf(\"Can't create shared mapping\\n\");\n        return -1;\n    }\n\n    CK_LIST_INIT(&amp;map-&gt;list);\n\n    pid_t pid;\n\n    pid = fork();\n    if(pid == 0)\n    {\n        /* Child. */\n\n        node = malloc(sizeof(struct list_node));\n        if(node == NULL)\n        {\n            perror(\"malloc\");\n            return -1;\n        }\n\n        int rtrn = asprintf((char **)&amp;node-&gt;data, \"test\");\n        if(rtrn &lt; 0)\n        {\n            perror(\"asprintf\");\n            return -1;\n        }\n\n        CK_LIST_INSERT_HEAD(&amp;map-&gt;list, node, list_entry);\n    }\n    else if(pid &gt; 0)\n    {\n        /* Parent. */\n\n        sleep(1); // Make sure child runs first.\n\n        CK_LIST_FOREACH(node2, &amp;map-&gt;list, list_entry)\n        {\n            printf(\"out: %s\\n\", node2-&gt;data);\n        }\n    }\n    else\n    {\n        perror(\"fork\");\n        return -1;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><code>CK_LIST</code> is listed as a multi-reader single-writer linked list so I thought I only had to lock on writes not reads. So why does <code>node-&gt;data</code> become garbage when using it between processes as opposed to when used by a single process?</p>\n"}, {"tags": ["c", "opengl"], "comments": [{"owner": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "edited": false, "score": 0, "creation_date": 1441221998, "post_id": 32361344, "comment_id": 52595753, "body": "The unpack alignment is the boundary that each row begins on in memory. You have 8 pixels per row, with type <code>GL_BITMAP</code>, so each row begins on an 1-byte boundary (1-bit per-pixel). It shouldn&#39;t really work with unpack alignment set to 2 as best I can tell. I think you&#39;re just getting very lucky in that you have padded the array with 00&#39;s."}, {"owner": {"reputation": 45, "user_id": 4056688, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6898c1dd57868faac1b9dc0b55a9ef19?s=128&d=identicon&r=PG&f=1", "display_name": "I hate stackoverflow", "link": "https://stackoverflow.com/users/4056688/i-hate-stackoverflow"}, "reply_to_user": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "edited": false, "score": 0, "creation_date": 1441222505, "post_id": 32361344, "comment_id": 52596027, "body": "I guess that makes sense. Thanks"}, {"owner": {"reputation": 45, "user_id": 4056688, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6898c1dd57868faac1b9dc0b55a9ef19?s=128&d=identicon&r=PG&f=1", "display_name": "I hate stackoverflow", "link": "https://stackoverflow.com/users/4056688/i-hate-stackoverflow"}, "edited": false, "score": 0, "creation_date": 1441223295, "post_id": 32361344, "comment_id": 52596484, "body": "I copied my code from <a href=\"http://www.glprogramming.com/red/chapter08.html#name1\" rel=\"nofollow noreferrer\">glprogramming.com/red/chapter08.html#name1</a>                        I&#39;m sorry but I don&#39;t really know what you&#39;re talking about...did I do something wrong?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1441224411, "post_id": 32361344, "comment_id": 52597076, "body": "@BDL thanks I deleted that, but I still don&#39;t understand how a bitmap width 8 can be expected to work by passing a width of 10. <code>glPixelStorei(GL_UNPACK_ALIGNMENT, 1)</code> is about about row alignement, so perhaps that makes it magically work."}, {"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1441225055, "post_id": 32361344, "comment_id": 52597412, "body": "@WeatherVane The data is 2bytes per row. In the working example, 8bits are drawn to screen, and another 8bits are skipped due to the alignment. Theoretically all values up to 16 should work (since there are 16bit per row). But I also cannot explain why 10 with alignment=2 is not working."}, {"owner": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "reply_to_user": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 1, "creation_date": 1441230579, "post_id": 32361344, "comment_id": 52600030, "body": "@BDL: That may be down to endian issues. I can&#39;t really say because &quot;doesn&#39;t work&quot; is such a vague way of describing a problem :-\\"}, {"owner": {"reputation": 45, "user_id": 4056688, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6898c1dd57868faac1b9dc0b55a9ef19?s=128&d=identicon&r=PG&f=1", "display_name": "I hate stackoverflow", "link": "https://stackoverflow.com/users/4056688/i-hate-stackoverflow"}, "edited": false, "score": 0, "creation_date": 1441254951, "post_id": 32361344, "comment_id": 52606027, "body": "So basically <code>GL_ALIGNMENT, 2</code> skips all my 0x00 because <code>2</code> means to skip the next address? if so, then that means <code>4</code> means skip 4 times, right?"}, {"owner": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "edited": false, "score": 0, "creation_date": 1441261166, "post_id": 32361344, "comment_id": 52608368, "body": "@Ihatestackoverflow: No, that would be stride. Alignment boundaries and stride are two different things. One is a constant that is added to some element to figure out the address of the next element, the other is a rule that establishes where those addresses are allowed to begin. It&#39;s possible to have strides and alignments that are incompatible (as you have seen). An alignment requirement of 1 machine unit is compatible with any stride; it&#39;s the exception rather than the rule. It&#39;s the rows that have alignment requirements here, and the stride is the number of bits per-row."}, {"owner": {"reputation": 45, "user_id": 4056688, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6898c1dd57868faac1b9dc0b55a9ef19?s=128&d=identicon&r=PG&f=1", "display_name": "I hate stackoverflow", "link": "https://stackoverflow.com/users/4056688/i-hate-stackoverflow"}, "reply_to_user": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "edited": false, "score": 0, "creation_date": 1441261779, "post_id": 32361344, "comment_id": 52608659, "body": "@AndonM.Coleman <code>One is a constant that is added to some element to figure out the address of the next element</code>     that would be Alignment and <code>a rule that establishes where those addresses are allowed to begin</code>  is stride, am I right?"}, {"owner": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "edited": false, "score": 0, "creation_date": 1441261981, "post_id": 32361344, "comment_id": 52608756, "body": "@Ihatestackoverflow: No, you have that backwards."}], "answers": [{"tags": [], "owner": {"reputation": 49036, "user_id": 3530129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IYkz8.jpg?s=128&g=1", "display_name": "Reto Koradi", "link": "https://stackoverflow.com/users/3530129/reto-koradi"}, "is_accepted": true, "score": 1, "last_activity_date": 1441253570, "creation_date": 1441253570, "answer_id": 32366825, "question_id": 32361344, "link": "https://stackoverflow.com/questions/32361344/questions-about-glpixelstorei-alignment/32366825#32366825", "title": "Questions about glPixelStorei() alignment", "body": "<p>After going back to some historical spec documents (<code>glBitmap()</code> is a <strong>very</strong> obsolete call), the alignment rule for bitmaps is (page 136 of the OpenGL 2.1 spec):</p>\n\n<pre><code>k = a * ceiling(w / (8 * a))\n</code></pre>\n\n<p>Where:</p>\n\n<ul>\n<li><code>w</code> is the width, under the assumption that <code>GL_UNPACK_ROW_LENGTH</code> is not set.</li>\n<li><code>a</code> is the value of <code>GL_UNPACK_ALIGNMENT</code>.</li>\n<li><code>k</code> is the number of bytes used per row. Note that each row will always start on at least a byte boundary, no matter how the parameters are set.</li>\n</ul>\n\n<p>Substituting the values from your example, for <code>w = 8</code>, we get:</p>\n\n<ul>\n<li>1 byte per row with <code>GL_UNPACK_ALIGNMENT</code> of 1.</li>\n<li>2 bytes per row with <code>GL_UNPACK_ALIGNMENT</code> of 2.</li>\n</ul>\n\n<p>and for <code>w = 10</code>, we get:</p>\n\n<ul>\n<li>2 bytes per row with <code>GL_UNPACK_ALIGNMENT</code> of 1.</li>\n<li>2 bytes per row with <code>GL_UNPACK_ALIGNMENT</code> of 2.</li>\n</ul>\n\n<p>Based on this, unless you also have other <code>GL_UNPACK_*</code> parameters set, you should get the same output for width 10 no matter if <code>GL_UNPACK_ALIGNMENT</code> is 1 or 2. If this is not the case, this looks like a bug in the OpenGL implementation.</p>\n"}], "owner": {"reputation": 45, "user_id": 4056688, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6898c1dd57868faac1b9dc0b55a9ef19?s=128&d=identicon&r=PG&f=1", "display_name": "I hate stackoverflow", "link": "https://stackoverflow.com/users/4056688/i-hate-stackoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 32366825, "answer_count": 1, "score": 0, "last_activity_date": 1441253570, "creation_date": 1441221273, "last_edit_date": 1441237322, "question_id": 32361344, "link": "https://stackoverflow.com/questions/32361344/questions-about-glpixelstorei-alignment", "title": "Questions about glPixelStorei() alignment", "body": "<p>Every 2 values in this array represent 16 pixels. (8 binary values per element)</p>\n\n<pre><code>GLubyte character[24] = {\n    0xc0, 0x00, 0xc0, 0x00, 0xc0, 0x00, 0xc0, 0x00, 0xc0, 0x00,\n    0xff, 0x00, 0xff, 0x00, 0xc0, 0x00, 0xc0, 0x00, 0xc0, 0x00,\n    0xff, 0xc0, 0xff, 0xc0\n};\n</code></pre>\n\n<p>and this is my code to render my bitmap.</p>\n\n<pre><code>void init(){\n    glPixelStorei(GL_UNPACK_ALIGNMENT, 2);\n}\n\nvoid render(){\n    glBitmap(8, 12, 0.0, 11.0, 0.0, 0.0, character);\n}\n</code></pre>\n\n<p>but when I change glBitmap(8, etc.) to glBitmap(10, etc.) , it doesn't work.</p>\n\n<p>to make it work, I need to change,</p>\n\n<pre><code>glPixelStorei(GL_UNPACK_ALIGNMENT, 2);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>glPixelStorei(GL_UNPACK_ALIGNMENT, 1);\n</code></pre>\n\n<p>My problem is, I have no idea why this works...</p>\n\n<p>I just know that </p>\n\n<pre><code>GL_UNPACK_ALIGNMENT, 1\n</code></pre>\n\n<p>tells OpenGL to just go to next address without alignment.</p>\n\n<p>I don't see any relationship between setting ALGINMENT to 1 and my bitmap's length.</p>\n\n<p>Could somebody explain what's going on?</p>\n"}, {"tags": ["c", "http", "curl", "libcurl"], "comments": [{"owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "edited": false, "score": 0, "creation_date": 1441221803, "post_id": 32361276, "comment_id": 52595641, "body": "This isn&#39;t an answer, but printf will only print up to the first null (0) byte. Is it possible that the file you&#39;re trying to download has a null byte as its fifth byte?"}, {"owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "reply_to_user": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "edited": false, "score": 0, "creation_date": 1441222077, "post_id": 32361276, "comment_id": 52595808, "body": "I didn&#39;t checked that, because I verified with several and different files, I&#39;ll check right now"}], "answers": [{"comments": [{"owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "edited": false, "score": 0, "creation_date": 1441239352, "post_id": 32363058, "comment_id": 52602615, "body": "In my case I wanted to print the file content just for debug purposes, what I&#39;m trying to achieve is base64 it, then append it to email to be sent as attachment"}], "tags": [], "owner": {"reputation": 1326, "user_id": 638752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5bb18f2c79784069a3d72408266b4?s=128&d=identicon&r=PG", "display_name": "theamk", "link": "https://stackoverflow.com/users/638752/theamk"}, "is_accepted": true, "score": 1, "last_activity_date": 1441227788, "creation_date": 1441227788, "answer_id": 32363058, "question_id": 32361276, "link": "https://stackoverflow.com/questions/32361276/c-getting-a-file-using-curl/32363058#32363058", "title": "C getting a file using CURL", "body": "<p>You are getting the file properly, you simply cannot print out PDFs and JPEGs to screen -- you will get random characters like you have seen. </p>\n\n<p>Specifically, your 4-character example seems to be from a JPEG file -- many of these start with ff:d8:ff:e0:00 characters, which would be printed as string below (four invalid characters, and then the 'printf' would stop printing because it would have encountered character with code 0)</p>\n\n<p>To make sure you are downloading the files properly, save the data to file and then open the file with JPEG/PDF viewer. Make sure to use fwrite() when writing data (printf() or fputs() would not work because of the embedded binary zeros)</p>\n"}], "owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 32363058, "answer_count": 1, "score": 2, "last_activity_date": 1441311264, "creation_date": 1441221036, "last_edit_date": 1441311264, "question_id": 32361276, "link": "https://stackoverflow.com/questions/32361276/c-getting-a-file-using-curl", "title": "C getting a file using CURL", "body": "<p>I'm trying to get Images and PDF files from my Amazon S3 via a C wrapper using CURL Lib, currently I can get like txt files, HTTP HTML response like error, but when I try to GET PDF and JPEG files I get as response :</p>\n\n<pre><code>(DEBUG) Size : 90343\n(DEBUG) Response : \ufffd\ufffd\ufffd\ufffd\n</code></pre>\n\n<p>I don't know where the weird characters came from, but I doubt that I need to add CURLOPT_BINARYTRANSFER </p>\n\n<p>Bellow the HTTP GET function and definitions using CURL :</p>\n\n<pre><code>const char *url = \"http://bucket.s3.amazonaws.com/file.pdf\";\n            long rc;\n            struct buf_string response = {0};\n            rc = http_get(url, &amp;response, (const char *[]){\"Accept: */*\", \"Accept-Encoding: gzip, deflate\", \"User-Agent: web-service/0.1\", NULL});\n            if (rc != 200) { /* error */ }\n\n            logprintf(ts, D_DEBUG, \"Size : %d\", response.pos);\n            logprintf(ts, D_ERROR, \"Response : %s\", response.buf);\n\n\nlong\nhttp_get(const char *url, struct buf_string *response, const char *headers[]) {\n    struct http *h = http_create();\n    long rc;\n\n    h-&gt;method = \"GET\";\n    h-&gt;url = url;\n    h-&gt;headers = headers;\n\n    if (response) {\n        memset(response, 0, sizeof(*response));\n        h-&gt;response_body = response;\n        h-&gt;write_function = default_write_data;\n    }\n\n    rc = http_perform(h);\n\n    http_free(h);\n    return rc;\n}\n\nstruct http *\nhttp_create() {\n    struct http *h;\n\n    h = zmalloc(sizeof(struct http));\n    h-&gt;write_function = null_write_data;\n    h-&gt;header_write_function = null_write_data;\n\n    return h;\n}\n\nvoid\nhttp_free(struct http *h) {\n    curl_easy_cleanup(h-&gt;ch);\n    free(h);\n}\n\nlong\nhttp_perform(struct http *h) {\n    long response_code;\n    struct curl_slist *header_list = NULL;\n\n    if (h-&gt;response_body &amp;&amp; (h-&gt;write_function == NULL || h-&gt;write_function == null_write_data)) \n        h-&gt;write_function = default_write_data;\n\n    if (h-&gt;response_header &amp;&amp; (h-&gt;header_write_function == NULL || h-&gt;header_write_function == null_write_data)) \n        h-&gt;header_write_function = default_write_data;\n\n    h-&gt;curl_status = CURLE_OK;\n\n    if ((h-&gt;ch = curl_easy_init()) == NULL) {\n        return -1;\n    }\n\n    curl_easy_setopt(h-&gt;ch, CURLOPT_URL, h-&gt;url);\n    curl_easy_setopt(h-&gt;ch, CURLOPT_CUSTOMREQUEST, h-&gt;method);\n\n    curl_easy_setopt(h-&gt;ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);\n    curl_easy_setopt(h-&gt;ch, CURLOPT_FOLLOWLOCATION, 1);\n    curl_easy_setopt(h-&gt;ch, CURLOPT_REDIR_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);\n\n    curl_easy_setopt(h-&gt;ch, CURLOPT_WRITEFUNCTION, h-&gt;write_function);\n    curl_easy_setopt(h-&gt;ch, CURLOPT_WRITEDATA, h-&gt;response_body);\n\n    curl_easy_setopt(h-&gt;ch, CURLOPT_HEADERFUNCTION, h-&gt;header_write_function);\n    curl_easy_setopt(h-&gt;ch, CURLOPT_HEADERDATA, h-&gt;response_header);\n\n    curl_easy_setopt(h-&gt;ch, CURLOPT_ERRORBUFFER, h-&gt;error);\n\n    curl_easy_setopt(h-&gt;ch, CURLOPT_NOSIGNAL, 1);\n\n    if (h-&gt;body) {\n        curl_easy_setopt(h-&gt;ch, CURLOPT_POSTFIELDS, (const char *) h-&gt;body);\n        curl_easy_setopt(h-&gt;ch, CURLOPT_POSTFIELDSIZE_LARGE, (curl_off_t)h-&gt;body_length);\n    }\n\n    if (h-&gt;headers) {\n        while (*(h-&gt;headers)) {\n            header_list = curl_slist_append(header_list, *h-&gt;headers++);\n        }\n        curl_easy_setopt(h-&gt;ch, CURLOPT_HTTPHEADER, header_list);\n    }\n\n    if (h-&gt;extra_config_function &amp;&amp; h-&gt;extra_config_function(h-&gt;ch, h-&gt;extra_config_data) != 0) {\n        response_code = -1;\n        goto out;\n    }\n\n    if ((h-&gt;curl_status = curl_easy_perform(h-&gt;ch)) != CURLE_OK) {\n        response_code = -1;\n        goto out;\n    }\n\n    curl_easy_getinfo(h-&gt;ch, CURLINFO_RESPONSE_CODE, &amp;response_code);\n\nout:\n    curl_slist_free_all(header_list);\n    return response_code;\n}\n</code></pre>\n\n<p><strong>Solved :</strong>\nBased to theamk answer, I managed to resolve the issue by base64 directly the file then pass it to the template engine I have, and it works, the file is successfully returned when HTTP response code is 200, just printf escape it.</p>\n\n<pre><code>   long rc;\n    struct buf_string response = {0};\n    rc = http_get(url, &amp;response, (const char *[]){\"Accept: */*\", \"Accept-Encoding: gzip, deflate\", \"User-Agent: micro-service/0.1\", NULL});\n\n    /* If the file is not found, abort */\n    if (rc != 200) {\n        cs-&gt;error = \"ATTACHMENT_FILE_NOT_FOUND\";\n        continue;\n    }\n\n    /* Convert the file payload to Base64, then pass it to the email params */\n    int len = response.pos;\n    size_t sz =  BASE64_NEEDED(len);\n    char *b64 = zmalloc(sz);\n    base64_encode(b64, response.buf, len);\n\n    template_parse(\"send_reply.tmpl\", \"attachment_data\", b64);\n    free(b64);\n</code></pre>\n"}, {"tags": ["c", "input", "menu", "integer", "switch-statement"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1441220814, "post_id": 32361167, "comment_id": 52595150, "body": "Second line <code>int check;</code> third line <code>while(check!=1)</code> - uninitialised variable. Please take note of your compiler warnings, at the very least."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1441220874, "post_id": 32361167, "comment_id": 52595182, "body": "Your <code>return 0;</code> is in the wrong place - move it to the last line of <code>main()</code>."}, {"owner": {"reputation": 41, "user_id": 5293957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aa2db0a7dc2ddc4b0ed83fb27183a4?s=128&d=identicon&r=PG&f=1", "display_name": "sage b.", "link": "https://stackoverflow.com/users/5293957/sage-b"}, "edited": false, "score": 0, "creation_date": 1441220914, "post_id": 32361167, "comment_id": 52595200, "body": "My compilar doesnt display any warnings/errors with this code.using Codeblocks"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1441220944, "post_id": 32361167, "comment_id": 52595218, "body": "Time to enable them?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1441222122, "post_id": 32361167, "comment_id": 52595834, "body": "I just reformatted the code to make @PaulR&#39;s comment stand out better. Watch your indentation. If you follow a regular pattern of indentation it will make it easier for you to spot little mistakes like the return inside the loop. And definitely <a href=\"http://www.codeblocks.org/docs/main_codeblocks_en3.html#x3-270001.11.6\" rel=\"nofollow noreferrer\">visit the compiler options to turn up</a> the compiler&#39;s reporting. Warnings allow the code to compile and run, but are marking something that has consequences you should be aware of. Maybe you really wanted to do something odd, that&#39;s why they are only warnings, but if you didn&#39;t..."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1441222260, "post_id": 32361167, "comment_id": 52595903, "body": "Good question by the way. It provided what you wanted, what you got, and all the code needed to find the errors."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5293957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aa2db0a7dc2ddc4b0ed83fb27183a4?s=128&d=identicon&r=PG&f=1", "display_name": "sage b.", "link": "https://stackoverflow.com/users/5293957/sage-b"}, "edited": false, "score": 0, "creation_date": 1441221087, "post_id": 32361265, "comment_id": 52595303, "body": "thank you,however now when I enter a wrong input my menu is displaying millions of times without waiting for the user input(infinite loop)?"}, {"owner": {"reputation": 301, "user_id": 5223868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8667384f7b81ea5c4933bb1af91000b7?s=128&d=identicon&r=PG&f=1", "display_name": "splotz90", "link": "https://stackoverflow.com/users/5223868/splotz90"}, "reply_to_user": {"reputation": 41, "user_id": 5293957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aa2db0a7dc2ddc4b0ed83fb27183a4?s=128&d=identicon&r=PG&f=1", "display_name": "sage b.", "link": "https://stackoverflow.com/users/5293957/sage-b"}, "edited": false, "score": 0, "creation_date": 1441222327, "post_id": 32361265, "comment_id": 52595938, "body": "@sageb. Insert the following code after calling <code>scanf()</code> to flush the input buffer: <code>int c; while ((c = getchar()) != EOF &amp;&amp; c != &#39;\\n&#39;);</code>"}, {"owner": {"reputation": 41, "user_id": 5293957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aa2db0a7dc2ddc4b0ed83fb27183a4?s=128&d=identicon&r=PG&f=1", "display_name": "sage b.", "link": "https://stackoverflow.com/users/5293957/sage-b"}, "edited": false, "score": 0, "creation_date": 1441233960, "post_id": 32361265, "comment_id": 52601138, "body": "thank you! solved my two problems! But I am not sure of what is EOF and I dont understand the statement &quot; c  !=&quot; it checks if getchar is not equal to..nothing?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 41, "user_id": 5293957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aa2db0a7dc2ddc4b0ed83fb27183a4?s=128&d=identicon&r=PG&f=1", "display_name": "sage b.", "link": "https://stackoverflow.com/users/5293957/sage-b"}, "edited": false, "score": 0, "creation_date": 1441240940, "post_id": 32361265, "comment_id": 52602952, "body": "@sageb.  EOF is -1.  It&#39;s a special value that gets returned at the end on a stream.  The <code>while</code> loop keeps reading until <code>getchar</code> returns either a newline or the special EOF value."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1441222762, "last_edit_date": 1441222762, "creation_date": 1441221005, "answer_id": 32361265, "question_id": 32361167, "link": "https://stackoverflow.com/questions/32361167/make-default-statement-not-exit-c/32361265#32361265", "title": "Make default statement not exit (C)", "body": "<p>Your <code>return 0</code> statement is inside of your <code>while</code> loop.  Move it down one line, outside of the loop.</p>\n\n<p>This is one reason why proper indentation is important.</p>\n\n<p>At this point, entering in non-numeric input results in an infinite loop because <code>scanf</code> isn't reading in anything.  To remedy this, you call <code>getchar</code> in a loop after calling <code>scanf</code> to flush the buffer:</p>\n\n<pre><code>int c;\nscanf(\" %d\", &amp;choose);\nwhile ((c=getchar()) != EOF &amp;&amp; c != '\\n');\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1441222580, "creation_date": 1441222580, "answer_id": 32361690, "question_id": 32361167, "link": "https://stackoverflow.com/questions/32361167/make-default-statement-not-exit-c/32361690#32361690", "title": "Make default statement not exit (C)", "body": "<p>This is correct and close to what you want</p>\n\n<pre><code>// Use a proper formatting standard to improve readability\nint disp() {\n    int check = 0;    // Initialize the loop variable\n    while (check != 1) {\n        int choose;\n        printf(\"1 \\n\");\n        printf(\"5quit\\n\");\n        scanf(\"%d\\n\", &amp;choose);    // Ask the scanf to swallow the newline\n\n        switch(choose) {\n        case 1:\n            func1();\n            break;\n        case 5:\n            check = 1;\n            break;\n        default:\n            printf(\"wrong input\");\n        }\n    }\n    return 0;    // Pull the statement out of the loop\n}\n</code></pre>\n\n<p><strong>EDIT</strong>: Since you are providing invalid input intentionally, it's better to check the return value of <code>scanf</code> to avoid errors.</p>\n"}], "owner": {"reputation": 41, "user_id": 5293957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aa2db0a7dc2ddc4b0ed83fb27183a4?s=128&d=identicon&r=PG&f=1", "display_name": "sage b.", "link": "https://stackoverflow.com/users/5293957/sage-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 32361265, "answer_count": 2, "score": 1, "last_activity_date": 1441230587, "creation_date": 1441220630, "last_edit_date": 1441230587, "question_id": 32361167, "link": "https://stackoverflow.com/questions/32361167/make-default-statement-not-exit-c", "title": "Make default statement not exit (C)", "body": "<p>I am a beginner in C programming and I'm trying to do basic stuff. I'm trying to create a simple menu using a <code>switch</code> statement like this:</p>\n\n<pre><code>int disp(){\n    int check;\n    while(check!=1){\n        int choose;\n        printf(\"1 \\n\");\n        printf(\"5quit\\n\");\n        scanf(\"%d\", &amp;choose);\n\n        switch(choose)\n        {\n            case 1:func1();\n            break;\n\n            case 5: check = 1;\n            break;\n\n            default:\n                printf(\"wrong input\");\n        }\n        return 0;\n    }\n}\n</code></pre>\n\n<p>However, when either <code>default</code> or <code>case 1</code> happen, I want to make it still loop the menu until a good input is made. For example, if I enter random stuff like \"asdf\", the program should say \"wrong input\" and then display the menu again and wait for user input. And if user enters \"1\", the program will run <code>func1</code> and then go back to the menu and wait for the user to input a choice. </p>\n\n<p>Currently, when a wrong input happens it just shuts down the program instead of displaying the menu again, and I don't know how to solve that.</p>\n"}, {"tags": ["c", "coding-style", "return", "logic"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1441218041, "post_id": 32360442, "comment_id": 52593591, "body": "That looks to me like saying using <code>&amp;&amp;</code> in an if-clause is bad practice or using the ternary operator is evil. Depends on readability, personal preference, etc."}, {"owner": {"reputation": 25508, "user_id": 847269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/564ffe2e3f1ffe82696cd1ac01ac035e?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick87", "link": "https://stackoverflow.com/users/847269/patrick87"}, "edited": false, "score": 0, "creation_date": 1441218289, "post_id": 32360442, "comment_id": 52593742, "body": "Define <i>good coding practice</i>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1441219058, "post_id": 32360442, "comment_id": 52594168, "body": "One could argue having only <i>one</i> exit point to function is even &quot;better&quot; coding style."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1441220217, "post_id": 32360442, "comment_id": 52594849, "body": "You don&#39;t need <code>else</code> if the first condition executes a <code>return</code>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1441223561, "post_id": 32360442, "comment_id": 52596627, "body": "Return is not a function, don&#39;t treat return(); as a function."}], "answers": [{"comments": [{"owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1441222725, "post_id": 32360503, "comment_id": 52596136, "body": "I think that the correct term is <code>short-circuiting</code>"}, {"owner": {"reputation": 18827, "user_id": 1413133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hqUmk.jpg?s=128&g=1", "display_name": "Manos Nikolaidis", "link": "https://stackoverflow.com/users/1413133/manos-nikolaidis"}, "reply_to_user": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 2, "creation_date": 1441226740, "post_id": 32360503, "comment_id": 52598307, "body": "<code>short-circuiting</code> is more common apparently but I defend <code>lazy evaluation</code> as equally correct in this case. <a href=\"https://en.wikipedia.org/wiki/Lazy_evaluation\" rel=\"nofollow noreferrer\">Wikipedia</a> says &quot;Short-circuit evaluation of Boolean control structures is sometimes called lazy&quot;."}], "tags": [], "owner": {"reputation": 18827, "user_id": 1413133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hqUmk.jpg?s=128&g=1", "display_name": "Manos Nikolaidis", "link": "https://stackoverflow.com/users/1413133/manos-nikolaidis"}, "is_accepted": true, "score": 10, "last_activity_date": 1441219471, "last_edit_date": 1441219471, "creation_date": 1441218143, "answer_id": 32360503, "question_id": 32360442, "link": "https://stackoverflow.com/questions/32360442/logic-operators-in-return-statement-in-c/32360503#32360503", "title": "Logic operators in return statement in C", "body": "<p>There is nothing wrong with this coding practice and actually you don't need the parentheses. Beware of lazy evaluation.</p>\n\n<p><code>return foo1() &amp;&amp; foo2()</code></p>\n\n<p>If the return value of the call to <code>foo1</code> is false <code>foo2</code> never gets called.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5293838, "user_type": "registered", "profile_image": "https://graph.facebook.com/915127371888227/picture?type=large", "display_name": "Selvam", "link": "https://stackoverflow.com/users/5293838/selvam"}, "is_accepted": false, "score": 0, "last_activity_date": 1441218492, "last_edit_date": 1441218492, "creation_date": 1441218200, "answer_id": 32360520, "question_id": 32360442, "link": "https://stackoverflow.com/questions/32360442/logic-operators-in-return-statement-in-c/32360520#32360520", "title": "Logic operators in return statement in C", "body": "<p>It just depends on the programmer. Few feel comfortable to use a logical operator and either return a 0 or 1, while others may feel that a bit off. </p>\n\n<p>Practically speaking, both doesn't have any difference at all in the way it works; and also I don't exactly think it's a bad programming practice.</p>\n\n<p>But yes, <code>if</code> and <code>else</code> may have more readability and hence helps readers.</p>\n"}, {"tags": [], "owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "is_accepted": false, "score": 4, "last_activity_date": 1441218293, "creation_date": 1441218293, "answer_id": 32360541, "question_id": 32360442, "link": "https://stackoverflow.com/questions/32360442/logic-operators-in-return-statement-in-c/32360541#32360541", "title": "Logic operators in return statement in C", "body": "<p>Omitting the if is good coding style. Using <code>if cond return true else return false</code> is overly long and redundant.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1441220522, "post_id": 32360591, "comment_id": 52594999, "body": "Shouldn&#39;t that be <code>for(ch=mystring; *ch; ch++)</code>?"}], "tags": [], "owner": {"reputation": 305, "user_id": 5065946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f08dbf0f748e3292e87f6f71a86fd44?s=128&d=identicon&r=PG&f=1", "display_name": "powersource97", "link": "https://stackoverflow.com/users/5065946/powersource97"}, "is_accepted": false, "score": 0, "last_activity_date": 1441282555, "last_edit_date": 1441282555, "creation_date": 1441218486, "answer_id": 32360591, "question_id": 32360442, "link": "https://stackoverflow.com/questions/32360442/logic-operators-in-return-statement-in-c/32360591#32360591", "title": "Logic operators in return statement in C", "body": "<p>It is your preference that matters. But, looking at complex solutions and implementing them often helps you understand intricate details on C. A simple demonstration being :</p>\n\n<pre><code> char mystring[10];\n //assume you take the input\n //to print it:\n int i;\n for(i=0;mystring[i]!='\\0';i++)\n printf(\"%c\",mystring[i]);\n</code></pre>\n\n<p>The above can be re-written in a complex way:</p>\n\n<pre><code>char *ch;\nfor(ch=mystring; *ch; ch++)\nprintf(\"%c\",*ch);\n</code></pre>\n\n<p>This beautifully shows the intricate details of how pointers get evaluated. And understanding this and using this definitely shows and helps you understand C better.</p>\n\n<p>So, do not neglect the complex representation thinking I am going to use my own simplified version.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 5, "last_activity_date": 1441221674, "creation_date": 1441221674, "answer_id": 32361442, "question_id": 32360442, "link": "https://stackoverflow.com/questions/32360442/logic-operators-in-return-statement-in-c/32361442#32361442", "title": "Logic operators in return statement in C", "body": "<p>I'd rather do</p>\n\n<pre><code>return a &amp;&amp; b;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int result = a &amp;&amp; b;\nreturn result;\n</code></pre>\n\n<p>just because there's less opportunity to screw up.  If you write</p>\n\n<pre><code>if ( a &amp;&amp; b )\n  return true;\nelse\n  return false;\n</code></pre>\n\n<p>you always run the risk of getting the sense of the test wrong (i.e., returning <code>false</code> when you meant to return <code>true</code> and vice-versa).  It's not a <em>significant</em> risk, but it's there.  </p>\n\n<p>Back before C99 introduced built-in symbolic constants for <code>true</code> and <code>false</code>, people typically defined their own <code>TRUE</code> and <code>FALSE</code> macros.  Problem is, some of those people would occasionally mis-spell <code>0</code> and <code>1</code>.  I once spent an afternoon chasing my tail because someone dropped a header where <code>TRUE</code> and <code>FALSE</code> expanded to the <em>same value</em>.  </p>\n\n<p>Not coincidentally, that's when I started using <code>return expr</code> instead of <code>return TRUE</code> or <code>return FALSE</code>.  </p>\n"}], "owner": {"reputation": 73, "user_id": 5290231, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57b60bfde0b9a23923d1ad6b4dc076b2?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJ", "link": "https://stackoverflow.com/users/5290231/danielj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3173, "favorite_count": 0, "accepted_answer_id": 32360503, "answer_count": 5, "score": 3, "last_activity_date": 1441282555, "creation_date": 1441217938, "last_edit_date": 1441219201, "question_id": 32360442, "link": "https://stackoverflow.com/questions/32360442/logic-operators-in-return-statement-in-c", "title": "Logic operators in return statement in C", "body": "<p>I have recently been learning C, and have come across a few return statements with logical operators in them, ie</p>\n\n<pre><code>return(statement LOGIC statement);\n</code></pre>\n\n<p>Where the statements evaluate to True or false (ie 1 or 0), and LOGIC is a logical operator like &amp;&amp;, || etc.</p>\n\n<p>Is this good coding practice, as it seems a bit off to me, would it not be better to use if/else if statements?</p>\n"}, {"tags": ["c#", "c", "optimization"], "comments": [{"owner": {"reputation": 29640, "user_id": 1123123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c4f71e418588524bba4c9c0b3a7d393?s=128&d=identicon&r=PG", "display_name": "Sam I am says Reinstate Monica", "link": "https://stackoverflow.com/users/1123123/sam-i-am-says-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1441217936, "post_id": 32360399, "comment_id": 52593533, "body": "Just curious: What&#39;s so counter-intuitive about it?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1441218067, "post_id": 32360399, "comment_id": 52593608, "body": "Because the majority of the content of the C# functionality is contained in the .NET framework, and the unmanaged code is linked into the executable instead."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1441218276, "post_id": 32360399, "comment_id": 52593734, "body": "The .exe format has several non-optional sections with alignment requirements in the order of one or more kB. The &quot;wasted&quot; space is likely just wasted. On the other hand - I bet both files will use the same amount of disk space, a whole cluster."}], "answers": [{"comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1441225382, "post_id": 32360513, "comment_id": 52597570, "body": "Good answer, but I think you meant &#39;unmanaged&#39; in your last sentence :-)"}], "tags": [], "owner": {"reputation": 15523, "user_id": 60020, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/ZIU6u.jpg?s=128&g=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/60020/samuel"}, "is_accepted": true, "score": 1, "last_activity_date": 1441226661, "last_edit_date": 1441226661, "creation_date": 1441218182, "answer_id": 32360513, "question_id": 32360399, "link": "https://stackoverflow.com/questions/32360399/why-is-a-program-using-the-net-framework-smaller-than-the-same-program-in-unman/32360513#32360513", "title": "Why is a program using the .NET framework smaller than the same program in unmanaged code?", "body": "<p>The majority of the functionality of your programs are contained in the libraries that you're linking to. These libraries don't impact the size of your program unless for example they take more function calls to do the same behavior. That's the case in your example. The windows library requires a lot of setup and calls into the API to produce a dialog box compared to the .NET app which takes a single function call, and no config. The size of the compiled program has to do with the number of instructions to link and call the external API of the library. The unmanaged program has more instructions than the program using .NET.</p>\n"}, {"tags": [], "owner": {"reputation": 8645, "user_id": 5235574, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wEodm.jpg?s=128&g=1", "display_name": "Fruchtzwerg", "link": "https://stackoverflow.com/users/5235574/fruchtzwerg"}, "is_accepted": false, "score": 1, "last_activity_date": 1441218191, "creation_date": 1441218191, "answer_id": 32360516, "question_id": 32360399, "link": "https://stackoverflow.com/questions/32360399/why-is-a-program-using-the-net-framework-smaller-than-the-same-program-in-unman/32360516#32360516", "title": "Why is a program using the .NET framework smaller than the same program in unmanaged code?", "body": "<p>The compiling to the machine code is in runtime. Funcionalities of your code (libaries) are the installed with your .NET. So your application is smaller because it uses the installed libaries of your pc.</p>\n"}], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 32360513, "answer_count": 2, "score": 0, "last_activity_date": 1441226661, "creation_date": 1441217793, "question_id": 32360399, "link": "https://stackoverflow.com/questions/32360399/why-is-a-program-using-the-net-framework-smaller-than-the-same-program-in-unman", "title": "Why is a program using the .NET framework smaller than the same program in unmanaged code?", "body": "<p>I have the following program written in unmanaged C code:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;tchar.h&gt;\n\nconst TCHAR g_szClassName[] = _T(\"SkeletonAppWindowClass\");\n\nLRESULT CALLBACK WindowProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);\nBOOL CALLBACK EnumChildProc(HWND hWnd, LPARAM lParam);\nATOM RegisterWCEX(HINSTANCE hInstance);\nint APIENTRY _tWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPTSTR lpCmdLine, int nShowCmd);\n\nATOM RegisterWCEX(HINSTANCE hInstance)\n{\n    WNDCLASSEX wcex;\n    ZeroMemory(&amp;wcex, sizeof(WNDCLASSEX));\n\n    wcex.cbSize = sizeof(WNDCLASSEX);\n    wcex.hbrBackground = (HBRUSH)COLOR_WINDOW;\n    wcex.hCursor = LoadCursor(NULL, IDC_ARROW);\n    wcex.hIcon =\n    wcex.hIconSm = LoadIcon(NULL, IDI_APPLICATION);\n    wcex.hInstance = hInstance;\n    wcex.lpfnWndProc = WindowProc;\n    wcex.lpszClassName = g_szClassName;\n\n    return RegisterClassEx(&amp;wcex);\n}\n\nBOOL CALLBACK EnumChildProc(HWND hWnd, LPARAM lParam)\n{\n    HFONT hfDefault = (HFONT)GetStockObject(DEFAULT_GUI_FONT);\n    SendMessage(hWnd, WM_SETFONT, (WPARAM)hfDefault, 0L);\n    return TRUE;\n}\n\nLRESULT CALLBACK WindowProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)\n{\n    static HWND hButton;\n    switch (Msg)\n    {\n    case WM_CREATE:\n        hButton = CreateWindow(_T(\"BUTTON\"), _T(\"Say Hi\"), WS_VISIBLE | WS_CHILD, 130, 230, 70, 20, hWnd, NULL, GetModuleHandle(NULL), NULL);\n        break;\n    case WM_COMMAND:\n        if ((HWND)lParam == hButton)\n        {\n            MessageBox(0, _T(\"Hello World!\"), _T(\"Information\"), MB_OK | MB_ICONINFORMATION);\n        }\n        break;\n    case WM_CLOSE:\n        DestroyWindow(hWnd);\n        break;\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n    default:\n        return DefWindowProc(hWnd, Msg, wParam, lParam);\n    }\n    return 0;\n}\n\nint APIENTRY _tWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPTSTR lpCmdLine, int nShowCmd)\n{\n    HWND hWnd;\n    MSG Msg;\n\n    RegisterWCEX(hInstance);\n\n    hWnd = CreateWindowEx(WS_EX_OVERLAPPEDWINDOW, g_szClassName, _T(\"Simple Window\"), WS_VISIBLE | WS_SYSMENU, 100, 100, 350, 370, NULL, NULL, hInstance, NULL);\n\n    ShowWindow(hWnd, SW_SHOW);\n    EnumChildWindows(hWnd, EnumChildProc, 0L);\n    UpdateWindow(hWnd);\n\n    while (GetMessage(&amp;Msg, NULL, 0, 0) &gt; 0)\n    {\n        TranslateMessage(&amp;Msg);\n        DispatchMessage(&amp;Msg);\n    }\n    return Msg.wParam;\n}\n</code></pre>\n\n<p>All it does is create a simple window, which, when clicked, pops up a Message Box that says \"Hello World!\"</p>\n\n<p>This program is 10KB in size in Release mode with the <code>/O1</code> (minimize space) optimization.</p>\n\n<p>Then, when I create a \"Windows Forms Application\" in C# and create a button on the form whose event handler is this:</p>\n\n<pre><code>    private void button1_Click(object sender, EventArgs e)\n    {\n        MessageBox.Show(\"Hello World\", \"Information\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n    }\n</code></pre>\n\n<p>When compiled in Release mode, the C# executable is only 8KB in size.  This is counterintuitive; I would have expected the unmanaged program to be more compact.</p>\n\n<p>Is the problem the way I coded the C program, or is there something else that I have not taken into account?</p>\n"}, {"tags": ["c", "performance", "memory"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 7, "creation_date": 1441217376, "post_id": 32360200, "comment_id": 52593264, "body": "Are you sure they mean the lowest 64 bits by &quot;last&quot;? That would make it a trivial problem (just multiply the low parts as <code>uint64_t</code>). I would consider that the &quot;first&quot; part most of the time."}, {"owner": {"reputation": 18262, "user_id": 97754, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/49d678618a22b1ae47b4395554eea6a9?s=128&d=identicon&r=PG", "display_name": "Margus", "link": "https://stackoverflow.com/users/97754/margus"}, "edited": false, "score": 0, "creation_date": 1441217489, "post_id": 32360200, "comment_id": 52593326, "body": "In real world case you would use <a href=\"https://en.wikipedia.org/wiki/GNU_Multiple_Precision_Arithmetic_Library\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/GNU_Multiple_Precision_Arithmetic_Libr&zwnj;&#8203;ary</a>. However this is homework, so you need to do it yourself - cheating gets you expelled."}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "edited": false, "score": 0, "creation_date": 1441217828, "post_id": 32360200, "comment_id": 52593487, "body": "This might or might not work, try creating an array of 128 bytes (two long longs), store the sum in the first index and if there is overflow the extra bits should go over into the second index. But this might not work since the registers in most computers only store a max of 64 bits but the compiler might handle this somehow, worth a test."}, {"owner": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "reply_to_user": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "edited": false, "score": 0, "creation_date": 1441217899, "post_id": 32360200, "comment_id": 52593519, "body": "@Yashwanth That is NOT how it works. Multiplication operations don&#39;t simply overflow into random memory that happen to be nearby. It they did that would be bad."}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "edited": false, "score": 0, "creation_date": 1441218047, "post_id": 32360200, "comment_id": 52593595, "body": "Yeah I was just throwing ideas around thinking it might overflow if it was an array, but yeah it sounds stupid and have plenty of issues. But would it work if you malloc 128 bytes and try the same thing?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1441218105, "post_id": 32360200, "comment_id": 52593632, "body": "If you are dumping all but the l.s. then you need to use unsigned."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1441218349, "post_id": 32360200, "comment_id": 52593781, "body": "If you are defining a mask, your code will be more readable with <code>long long int cutter = 0x7fffffffffffffffLL</code>"}, {"owner": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "reply_to_user": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "edited": false, "score": 0, "creation_date": 1441218377, "post_id": 32360200, "comment_id": 52593797, "body": "@Yashwanth You can&#39;t actually multiply numbers directly in memory, on most machines. What will happen is that the CPU will (1) load the numbers into registers (2) do the multiplication and (3) store the result back into memory."}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "reply_to_user": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "edited": false, "score": 0, "creation_date": 1441218822, "post_id": 32360200, "comment_id": 52594053, "body": "@jforberg Yeah that was my initial misgiving with my way, see initial comment, thanks for clarifying"}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 1, "creation_date": 1441220029, "post_id": 32360200, "comment_id": 52594745, "body": "Maybe you&#39;re supposed to break up each of the 64-bit multiplicands into two 32-bit pieces (after discarding the high 64-bits of the 128-bit inputs, which seem like an irrelevance), and then do the long multiplication &quot;by hand&quot;.  That is, compute four 32-by-32 to 64-bit products, and figure out how to reassemble them into the result you need.  (Hint: one of those products can just be thrown away.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441389372, "post_id": 32360200, "comment_id": 52676189, "body": "<code>product</code> in <code>char *mult()</code> is not null character terminated."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1441219588, "post_id": 32360800, "comment_id": 52594487, "body": "<code>long</code> is not a 64 bit type, though it might be. It is guaranteed to be a minimum of 32 bits, which it is on my MSVC compiler. Your MS link says 4 bytes."}, {"owner": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1441220051, "post_id": 32360800, "comment_id": 52594764, "body": "Also, type widths are not dependent upon the compiler, this is a myth. Type widths are defined in the system ABI. Otherwise libraries and programs comiled with different tools would not be able to interoperate."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441225048, "post_id": 32360800, "comment_id": 52597406, "body": "Code could use the more portable portable <code>printf(&quot;%&quot; PRIu64, high);</code> or <code>printf(&quot;%llu\\n&quot;, (unsigned long long) high);</code>  OTOH, this solution does depend on<code>__uint128_t</code> existing."}], "tags": [], "owner": {"reputation": 5748, "user_id": 767442, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d26ad3fe7caf43447e39cd2307b515d7?s=128&d=identicon&r=PG&f=1", "display_name": "jforberg", "link": "https://stackoverflow.com/users/767442/jforberg"}, "is_accepted": false, "score": 4, "last_activity_date": 1441219786, "last_edit_date": 1441219786, "creation_date": 1441219273, "answer_id": 32360800, "question_id": 32360200, "link": "https://stackoverflow.com/questions/32360200/128-bit-integer-multiplication/32360800#32360800", "title": "128-bit integer multiplication", "body": "<p><strong>long long</strong> is not a 128-bit type on any computer I've worked with. See below for references. I'm also assuming that by \"last bits\" you mean \"high bits\". This code will work to get unsigned 128-bit arithmetic going on GCC (adjust the type names for your compiler):</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nint main () {\n        __uint128_t x = 9223372036146775308;\n        __uint128_t y = 9223372036854709503;\n        __uint128_t prod = x * y;\n        uint64_t high = prod &gt;&gt; 64;\n\n        printf(\"%lu\\n\", high);\n}\n</code></pre>\n\n<p>How long are the types on my machine?</p>\n\n<p>Windows: \n<a href=\"https://msdn.microsoft.com/en-us/library/94z15h2c.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/94z15h2c.aspx</a></p>\n\n<p>Linux, Mac OSX, \"all other systems\":\npage 13, <a href=\"http://www.x86-64.org/documentation/abi.pdf\" rel=\"nofollow\">http://www.x86-64.org/documentation/abi.pdf</a></p>\n"}], "owner": {"reputation": 51, "user_id": 3526974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccae58d818b87b452c69a7b45b5e0bb?s=128&d=identicon&r=PG&f=1", "display_name": "goodmove", "link": "https://stackoverflow.com/users/3526974/goodmove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1534, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1441388929, "creation_date": 1441217152, "last_edit_date": 1441388929, "question_id": 32360200, "link": "https://stackoverflow.com/questions/32360200/128-bit-integer-multiplication", "title": "128-bit integer multiplication", "body": "<p>I was given a task at university to calculate the product of 2 128-bit integer numbers in C language and return the older 64 bits. Feel free to use the code below to print out the lower 128 bits of 128-bit integer product.</p>\n\n<p>UPDATED!!!</p>\n\n<p>My teacher suddenly said he'd meant to print the older 64 bits. I decided to use <code>char *</code> to store all the 128 bits and print out the multiplication result as 128 lower bits. The code below works:</p>\n\n<pre><code>        #include &lt;stdio.h&gt;\n        #include &lt;stdlib.h&gt;\n\n        char *moveBit(char *s){ // moves the binary string one bit to the left (like s&lt;&lt;1 operation)\n            char bit='0';\n            char temp='0';\n            for(int i=127;i&gt;=0;i--){\n                temp = s[i];\n                s[i]=bit;\n                bit=temp;\n            }\n            return s;\n        }\n\n        char *bitSum(char *a, char *b){ // figures out the sum of two numbers bit by bit\n\n            char rem = '0';\n            char* sum = (char *) malloc(129);\n\n            for(int i=127;i&gt;=0;i--){\n\n                int s = (a[i]=='1') + (b[i]=='1') + (rem=='1');\n\n                if (s==3){\n                    sum[i]='1';\n                    rem='1';\n                }else if(s==2){\n                    sum[i]='0';\n                    rem='1';\n                }else{\n                    sum[i] = s? '1':'0';\n                    rem='0';\n                }\n            }\n\n            return sum; \n        }\n\n        char *mult(char *a, char *b){\n\n            char* product = (char *) malloc(129);\n\n            for(int i=127;i&gt;=0;i--){\n\n                if(b[i]=='1')\n                    product = bitSum(product,a);\n                a=moveBit(a);\n\n            }\n            return product; \n        }\n\n        int main(){\n\n            char *a = (char *) malloc(129);\n            char *b = (char *) malloc(129);\n\n            a=\"01111111111111111111111111111111101010001101100110100000011111111111111111111111111111111111111111111111111110111111001111111111\";\n            b=\"01111111111111111111111111111111111111111111110111111001111111111111111111111111111111111111111111111111111111011111100111111111\";\n\n            printf(\"%s\", mult(a,b));\n            return 0;\n        }\n</code></pre>\n"}, {"tags": ["c", "pointers", "function-pointers"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 2, "creation_date": 1441215635, "post_id": 32359736, "comment_id": 52592302, "body": "Undefined behavior because you return an address to a local variable."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1441215821, "post_id": 32359736, "comment_id": 52592403, "body": "Are you just asking about the &quot;algorithm&quot;, or do you have any specific code that causes trouble? Because if you have code you should show it to us so we can help you solve the problem you&#39;re having with it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1441217272, "post_id": 32359736, "comment_id": 52593219, "body": "Show some code so we don&#39;t need to guess what your problem is."}, {"owner": {"reputation": 91, "user_id": 4515354, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6bf4d4e7d1d6126e6d0da69cf9c6e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eman", "link": "https://stackoverflow.com/users/4515354/eman"}, "edited": false, "score": 0, "creation_date": 1441288720, "post_id": 32359736, "comment_id": 52626103, "body": "int* sum(int x, int y){ int z;  z=x+y;  int *p=&amp;z;  return p;  }  what is the expected problems from that code?"}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1441293279, "post_id": 32359736, "comment_id": 52629477, "body": "@Eman:I have covered that in my answer."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 1745307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noICu.jpg?s=128&g=1", "display_name": "eddyfice", "link": "https://stackoverflow.com/users/1745307/eddyfice"}, "is_accepted": false, "score": 1, "last_activity_date": 1441215727, "creation_date": 1441215727, "answer_id": 32359801, "question_id": 32359736, "link": "https://stackoverflow.com/questions/32359736/pointers-as-a-return-value/32359801#32359801", "title": "Pointers as a return value", "body": "<p>If the result is on the stack (i.e. declared locally in your function), then the pointer will be pointing to a variable that will be overwritten once further function calls are made.</p>\n\n<p>It might appear to work in some circumstances (i.e. immediately returning from the function and grabbing the value before further stack frames are pushed) - but generally speaking that's buggy / erroneous.</p>\n"}, {"tags": [], "owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "is_accepted": true, "score": 1, "last_activity_date": 1441219640, "last_edit_date": 1441219640, "creation_date": 1441215782, "answer_id": 32359821, "question_id": 32359736, "link": "https://stackoverflow.com/questions/32359736/pointers-as-a-return-value/32359821#32359821", "title": "Pointers as a return value", "body": "<p>No problem if you do it like this:</p>\n\n<pre><code>void sum(int a, int b, int *res)\n{\n  *res = a+b;  \n}\n</code></pre>\n\n<p>and for example call like:</p>\n\n<pre><code> int x;\n sum(5, 6, &amp;x);\n</code></pre>\n\n<p>But following is not correct:</p>\n\n<pre><code>int* sum(int a, int b)\n{\n  int *res;\n  int x = a+b;\n  res = &amp;x;\n  return res;// returning address of x - but x is not alive when function ends; don't do it\n}\n</code></pre>\n\n<p>PS. you could also use <code>malloc</code>, store the result (<code>a+b</code>) in that memory (by assigning <code>a+b</code> to <code>*res</code>), and then return that pointer, but then the caller would need to free it.</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 2, "last_activity_date": 1441218782, "last_edit_date": 1441218782, "creation_date": 1441218260, "answer_id": 32360533, "question_id": 32359736, "link": "https://stackoverflow.com/questions/32359736/pointers-as-a-return-value/32360533#32360533", "title": "Pointers as a return value", "body": "<blockquote>\n  <p>the expected problems</p>\n</blockquote>\n\n<ul>\n<li><p>uninitialised pointer(s)</p>\n\n<pre><code>void add(int a, int b, int * pc)\n{\n  *pc = a + b;\n}\n\nint main(void)\n{\n  int a = 1;\n  int b = 2;\n  int * pc;\n\n  add(a, b, pc);\n\n  ...\n</code></pre>\n\n<p>Issue: <code>pc</code> points \"nowhere\".</p></li>\n<li><p>badly aligned memory</p>\n\n<pre><code>void add(int a, int b, int * pc)\n{\n  *pc = a + b;\n}\n\nint main(void)\n{\n  int a = 1;\n  int b = 2;\n  char c[sizeof (int)];\n\n  add(a, b, c); /* or even add(a, b (int*) c); */\n\n  ...\n</code></pre>\n\n<p>Issue: Although large enough, the memory for <code>c</code> might not be aligned correctly to hold an <code>int</code>.</p></li>\n<li><p>invalid memory</p>\n\n<pre><code>void add(int a, int b, int * pc)\n{\n  int c = a + b;\n  pc = &amp;c;\n}\n\nint main(void)\n{\n  int a = 1;\n  int b = 2;\n  int * pc;\n\n  add(a, b, pc);\n\n  ...\n</code></pre>\n\n<p>Issue: On returning from <code>add()</code> <code>pc</code> points to invalid memory, as already deallocated, namely to <code>c</code> which lived on <code>add()</code>'s stack.</p></li>\n</ul>\n"}], "owner": {"reputation": 91, "user_id": 4515354, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6bf4d4e7d1d6126e6d0da69cf9c6e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eman", "link": "https://stackoverflow.com/users/4515354/eman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1441222748, "accepted_answer_id": 32359821, "answer_count": 3, "score": 0, "last_activity_date": 1441219640, "creation_date": 1441215513, "question_id": 32359736, "link": "https://stackoverflow.com/questions/32359736/pointers-as-a-return-value", "closed_reason": "Needs details or clarity", "title": "Pointers as a return value", "body": "<p>If I made function that sums two variables and return the summing result through pointer.</p>\n\n<p>What are the expected problems could happen from that algorithm ?</p>\n"}, {"tags": ["c", "functional-programming", "sicp"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441215626, "post_id": 32359621, "comment_id": 52592297, "body": "Instead of <code>void* (*f_ptr)(void*);</code> define <code>int (*f_ptr)(int);</code>."}, {"owner": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441215772, "post_id": 32359621, "comment_id": 52592383, "body": "@alk As I indicated above, the reason I want to use void* is so I can allow functions of different types."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441216094, "post_id": 32359621, "comment_id": 52592547, "body": "Using <code>void*(*)(void*)</code> only allows you to use functions taking <i>one pointer value</i> and returning a pointer value."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1441215592, "post_id": 32359696, "comment_id": 52592273, "body": "Comparing the pointers of string literals <i>might</i> work, but they are not guaranteed to have only one instance of the same string."}, {"owner": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "edited": false, "score": 0, "creation_date": 1441215867, "post_id": 32359696, "comment_id": 52592426, "body": "Thanks, I&#39;ll keep that in mind, but that doesn&#39;t change the output or the error messages."}], "tags": [], "owner": {"reputation": 49834, "user_id": 25507, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/DqZPI.png?s=128&g=1", "display_name": "Josh Kelley", "link": "https://stackoverflow.com/users/25507/josh-kelley"}, "is_accepted": true, "score": 5, "last_activity_date": 1441216045, "last_edit_date": 1592644375, "creation_date": 1441215389, "answer_id": 32359696, "question_id": 32359621, "link": "https://stackoverflow.com/questions/32359621/how-to-implement-map-that-associates-a-name-with-void-function-in-c/32359696#32359696", "title": "How to implement map that associates a name with void function in C?", "body": "<h2>String comparisons</h2>\n<p>This is not how you do string comparison in C.</p>\n<pre><code>if (map.name == str)\n</code></pre>\n<p>This is how you do string comparison in C.</p>\n<pre><code>if (0 == strcmp(map.name, str))\n</code></pre>\n<p>Because strings in C are just pointers to characters, <code>map.name == str</code> checks if <code>map.name</code> and <code>str</code> are identical pointers (point to the same block of memory), not whether what they point to is the same.</p>\n<h2>for loops</h2>\n<p>Your code is probably reporting <code>fib(7) = 0</code> because it's failing to find fib. One possible culprit is the string comparison issue I mentioned. However, your <code>for</code> loop syntax is also odd:</p>\n<pre><code>for (i; i &lt; (sizeof(maps)/sizeof(maps[0])); i++) {\n</code></pre>\n<p>You don't set <code>i</code> to anything, so this means, &quot;Starting from wherever i happens to be, do the following...&quot;</p>\n<p>To loop over all of maps, use this:</p>\n<pre><code>for (i = 0; i &lt; (sizeof(maps)/sizeof(maps[0])); i++) {\n</code></pre>\n<h2>type warnings</h2>\n<p>As @alk said in a comment, the reason you're getting all of those warnings is because you've declared a function type of <code>void* (*f_ptr)(void*);</code>, even though your functions are <code>int (*)(int)</code>. If you want to keep using <code>void*</code> to allow different types, and you're careful enough with your types to make this work, then you can add casts to silence the warnings.</p>\n<pre><code>maps[0].f_ptr = (void *(*)(void*)) &amp;fact;\nans2 = (int) maps[i].f_ptr((void*) num);\n</code></pre>\n<p>Etc.</p>\n<h2>Better implementations?</h2>\n<p>A &quot;real&quot; implementation of mapping functions to names would use a hash table, instead of linearly searching for matching names.  Implementing a hash table in C would add complexity and may not be worth it for this exercise.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1441216056, "post_id": 32359853, "comment_id": 52592522, "body": "Yes don&#39;t be lazy with a <code>for</code> loop. If you want to continue a previous loop you can write <code>(for i=i; ...)</code> and the compiler will do the right thing."}, {"owner": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "edited": false, "score": 0, "creation_date": 1441216062, "post_id": 32359853, "comment_id": 52592530, "body": "Thanks, that&#39;s it.  As for the void* is there a way to avoid all these warnings if I want to allow functions of different types?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "edited": false, "score": 0, "creation_date": 1441216164, "post_id": 32359853, "comment_id": 52592596, "body": "@TarBall: &quot;<i>avoid all these warnings</i>&quot; Only by (dirty) casting, probably invoking undefined behaviour."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441216251, "post_id": 32359853, "comment_id": 52592640, "body": "Better use C++ for such approaches."}, {"owner": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "edited": false, "score": 0, "creation_date": 1441216305, "post_id": 32359853, "comment_id": 52592678, "body": "@alk I&#39;m sorry if this is a silly question but I am not familiar with the term dirty casting, would you care to elaborate?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "edited": false, "score": 0, "creation_date": 1441216409, "post_id": 32359853, "comment_id": 52592737, "body": "The &quot;dirty&quot; is just a hint to not do it. @TarBall"}, {"owner": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "edited": false, "score": 0, "creation_date": 1441216488, "post_id": 32359853, "comment_id": 52592787, "body": "Thank you alk, you got an eye like a hawk."}, {"owner": {"reputation": 49834, "user_id": 25507, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/DqZPI.png?s=128&g=1", "display_name": "Josh Kelley", "link": "https://stackoverflow.com/users/25507/josh-kelley"}, "reply_to_user": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "edited": false, "score": 0, "creation_date": 1441216513, "post_id": 32359853, "comment_id": 52592810, "body": "@TarBall - You can create arbitrarily complicated data structures in C, so you technically can allow functions of different types and different numbers of arguments. See <a href=\"https://developer.gnome.org/glib/\" rel=\"nofollow noreferrer\">GLib&#39;s</a> variants and tuples for an example. It would be very ugly, though; like alk says, a higher-level language like C++ would be much easier."}, {"owner": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "reply_to_user": {"reputation": 49834, "user_id": 25507, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/DqZPI.png?s=128&g=1", "display_name": "Josh Kelley", "link": "https://stackoverflow.com/users/25507/josh-kelley"}, "edited": false, "score": 0, "creation_date": 1441216770, "post_id": 32359853, "comment_id": 52592952, "body": "@JoshKelley The reason I chose C is because I haven&#39;t used it in a while and wanted to write a couple of simple programs as a refresher, but thanks for the GLib&#39;s variants link, it looks interesting."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 2, "last_activity_date": 1441215899, "creation_date": 1441215899, "answer_id": 32359853, "question_id": 32359621, "link": "https://stackoverflow.com/questions/32359621/how-to-implement-map-that-associates-a-name-with-void-function-in-c/32359853#32359853", "title": "How to implement map that associates a name with void function in C?", "body": "<blockquote>\n  <p>but instead I am getting</p>\n  \n  <p>[...]</p>\n\n<pre><code>fib(7) = 0\n</code></pre>\n</blockquote>\n\n<p>The code misses to initialise <code>i</code> to <code>0</code> for the 2nd  <code>for</code>-loop.</p>\n"}], "owner": {"reputation": 135, "user_id": 1229862, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1597dc1dab4a51eb5c4b207daa50b2c?s=128&d=identicon&r=PG", "display_name": "Napalidon", "link": "https://stackoverflow.com/users/1229862/napalidon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 32359696, "answer_count": 2, "score": 1, "last_activity_date": 1441216045, "creation_date": 1441215134, "question_id": 32359621, "link": "https://stackoverflow.com/questions/32359621/how-to-implement-map-that-associates-a-name-with-void-function-in-c", "title": "How to implement map that associates a name with void function in C?", "body": "<p>After reading Structure and Interpretation of Computer Programs (SICP) I decided to find a way to implement some of these functional programming techniques using C.  I tried to write a program that makes a pair whose first argument is a name of the function and second arg is any function that takes one arg and returns one arg.  Using implementation below I was expecting to see\nan output like:</p>\n\n<pre><code>fact(7) = 5040\nfib(7) = 13\n</code></pre>\n\n<p>but instead I am getting</p>\n\n<pre><code>fact(7) = 5040\nfib(7) = 0\n</code></pre>\n\n<p>along with warnings</p>\n\n<pre><code>$ cc map.c\nmap.c: In function \u2018main\u2019:\nmap.c:41:17: warning: assignment from incompatible pointer type [enabled by default]\n   maps[0].f_ptr = &amp;fact;\n                 ^\nmap.c:43:17: warning: assignment from incompatible pointer type [enabled by default]\n   maps[1].f_ptr = &amp;fib;\n                 ^\nmap.c:47:7: warning: passing argument 1 of \u2018maps[i].f_ptr\u2019 makes pointer from integer without a cast [enabled by default]\n       ans = (int) maps[i].f_ptr((int) num);\n       ^\nmap.c:47:7: note: expected \u2018void *\u2019 but argument is of type \u2018int\u2019\nmap.c:47:13: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]\n       ans = (int) maps[i].f_ptr((int) num);\n             ^\nmap.c:52:7: warning: passing argument 1 of \u2018maps[i].f_ptr\u2019 makes pointer from integer without a cast [enabled by default]\n       ans2 = (int) maps[i].f_ptr((int) num);\n       ^\nmap.c:52:7: note: expected \u2018void *\u2019 but argument is of type \u2018int\u2019\nmap.c:52:14: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]\n       ans2 = (int) maps[i].f_ptr((int) num);\n</code></pre>\n\n<p>during compilation. Looking at the code I don't see the problem but then again I haven't used C in quite some time. Is there a better way to implement such a construct and why is fib(7) printing a 0 instead of 13?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>struct Map\n{\n  char* name;\n  void* (*f_ptr)(void*);\n};\n\nint fact(int a) {\n    if (a == 0)\n      return 0;\n    if (a == 1)\n      return 1;\n    return a * fact (a-1);\n}\n\nint fib(int a) {\n  if (a == 0)\n    return 0;\n  if (a == 1)\n    return 1;\n  return fib(a-1) + fib(a-2);\n}\n\nint findFunc (char* str, struct Map map)\n{\n  if (map.name == str)\n    return 1;\n  return 0;\n}\n\nint main()\n{\n  int i = 0;\n  int ans = 0;\n  int ans2 = 0;\n  int num = 7;\n\n  struct Map maps[2];\n  maps[0].name = \"fact\";\n  maps[0].f_ptr = &amp;fact;\n  maps[1].name = \"fib\";\n  maps[1].f_ptr = &amp;fib;\n\n  for (i; i &lt; (sizeof(maps)/sizeof(maps[0])); i++) {\n    if (findFunc(\"fact\", maps[i]))\n      ans = (int) maps[i].f_ptr((int) num);\n  }\n\n  for (i; i &lt; (sizeof(maps)/sizeof(maps[0])); i++) {\n    if (findFunc(\"fib\", maps[i]))\n      ans2 = (int) maps[i].f_ptr((int) num);\n  }\n\n  printf(\"fact(%d) = %d\\n\", num, ans);\n  printf(\"fib(%d) = %d\", num, ans2);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2947402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c1b0abb5d01e81862be91d0469e33b?s=128&d=identicon&r=PG&f=1", "display_name": "Razib Hossain Shuvo", "link": "https://stackoverflow.com/users/2947402/razib-hossain-shuvo"}, "edited": false, "score": 1, "creation_date": 1441214367, "post_id": 32359351, "comment_id": 52591596, "body": "ah... that semicolon ... enemy of programmers. thanks btw"}, {"owner": {"reputation": 62282, "user_id": 1652962, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cf5a0741f183379686fe0995ffc27ae?s=128&d=identicon&r=PG", "display_name": "cimmanon", "link": "https://stackoverflow.com/users/1652962/cimmanon"}, "edited": false, "score": 1, "creation_date": 1441214802, "post_id": 32359351, "comment_id": 52591829, "body": "For future reference, problems caused by a simple typographical error should be closed, not answered."}], "tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": true, "score": 4, "last_activity_date": 1441214419, "last_edit_date": 1441214419, "creation_date": 1441214284, "answer_id": 32359351, "question_id": 32359321, "link": "https://stackoverflow.com/questions/32359321/declaring-integer-in-for-loop-of-a-function-giving-error/32359351#32359351", "title": "declaring integer in for loop of a function giving error", "body": "<p>Remove the semicolon from the end of the <code>for</code> statement, that is, replace</p>\n\n<pre><code> for(int i = 0; i &lt;= 10000; i++);\n</code></pre>\n\n<p>with</p>\n\n<pre><code> for(int i = 0; i &lt;= 10000; i++)\n</code></pre>\n\n<p>Nevertheless, bear in mind that loops without a body (i.e. not followed by curly braces) are also possible C language constructs. These <strong>are</strong> followed by a semicolon.</p>\n"}], "owner": {"reputation": 11, "user_id": 2947402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c1b0abb5d01e81862be91d0469e33b?s=128&d=identicon&r=PG&f=1", "display_name": "Razib Hossain Shuvo", "link": "https://stackoverflow.com/users/2947402/razib-hossain-shuvo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1441217930, "accepted_answer_id": 32359351, "answer_count": 1, "score": 0, "last_activity_date": 1595497790, "creation_date": 1441214191, "last_edit_date": 1595497790, "question_id": 32359321, "link": "https://stackoverflow.com/questions/32359321/declaring-integer-in-for-loop-of-a-function-giving-error", "closed_reason": "Not suitable for this site", "title": "declaring integer in for loop of a function giving error", "body": "<p>I cannot find out what's wrong in this code:</p>\n<pre><code>    using namespace std;\n\n    const int sz = 10000+100;\n    int sqr[sz];\n    int digit;\n\n    void findSqr()\n    {\n\n        for(int i = 0; i &lt;= 10000; i++);\n        {\n            cout&lt;&lt;sqr[i]&lt;&lt;endl;\n        }\n    }\n\n    int main()\n    {\n        findSqr();\n        return 0;\n    }\n\n</code></pre>\n<p>When I'm initializing int I in for loop in findsqr function and trying to build the code then an error appears</p>\n<p>name lookup of 'i' changed for ISO 'for' scoping [-fpermissive]|\nHow should I fix it?</p>\n"}, {"tags": ["c", "mingw", "function-pointers", "case-sensitive", "strstr"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441219825, "post_id": 32359287, "comment_id": 52594637, "body": "What is the <i>full</i> error message?"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 1, "creation_date": 1441220128, "post_id": 32359287, "comment_id": 52594803, "body": "<code>strstr()</code> and <code>StrStrIA()</code> probably have different calling conventions."}], "answers": [{"comments": [{"owner": {"reputation": 576, "user_id": 2770573, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Gd9LV.png?s=128&g=1", "display_name": "Max R.", "link": "https://stackoverflow.com/users/2770573/max-r"}, "edited": false, "score": 0, "creation_date": 1441353083, "post_id": 32361777, "comment_id": 52654290, "body": "Thank you very much alk! This was the solution. p.s.: also thanks for the side note. I didn&#39;t knew that."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 1, "last_activity_date": 1441223580, "last_edit_date": 1441223580, "creation_date": 1441222955, "answer_id": 32361777, "question_id": 32359287, "link": "https://stackoverflow.com/questions/32359287/strstr-and-strstri-in-mingw-and-with-function-as-parameter-in-c/32361777#32361777", "title": "strstr and StrStrI in MinGW and with function as parameter in C", "body": "<p>The <code>StrStrI*()</code>-functions do not use the <code>cdecl</code> but the <code>stdcall</code> calling convention.</p>\n\n<p>To ship around this you might want to introduce a wrapper around the <code>StrStrI*()</code>-function like this</p>\n\n<pre><code>char * strstri(const char * s1, const char * s2) \n{\n  return StrStrIA(s1, s2);\n}\n</code></pre>\n\n<p>and to initialise the the pointer to the compare function use </p>\n\n<pre><code>void findDataTest(findData *tFindData) \n{\n  if (tFindData-&gt;fCaseSensitve)\n    tFindData-&gt;__strstr = strstr; //if case sensitive use strstr\n  else\n    tFindData-&gt;__strstr = strstri;\n\n  findDataTest2(tFindData); //and here we test it\n}\n</code></pre>\n\n<hr>\n\n<p>As a side note: Do not use <code>__</code> to prefix anything in your C code as (in most cases) this is not allowed by the C-Standard.</p>\n\n<p>For example replace <code>__StrStr</code> by <code>StrStrFunc</code> and <code>__strstr</code> by <code>pfstrstr</code> or <code>strstrfunc</code>.</p>\n"}], "owner": {"reputation": 576, "user_id": 2770573, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Gd9LV.png?s=128&g=1", "display_name": "Max R.", "link": "https://stackoverflow.com/users/2770573/max-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 32361777, "answer_count": 1, "score": 2, "last_activity_date": 1441223745, "creation_date": 1441214100, "last_edit_date": 1441223745, "question_id": 32359287, "link": "https://stackoverflow.com/questions/32359287/strstr-and-strstri-in-mingw-and-with-function-as-parameter-in-c", "title": "strstr and StrStrI in MinGW and with function as parameter in C", "body": "<h2>What I have</h2>\n\n<p>I have a weird problem. I have a big program which reads a PCAP File. Now I want to do a search in this pcap file. As I mentioned this program is really big, so I have a lot of functions and a lot of parameters etc.  It's a Win32 Application and I use MinGW.</p>\n\n<h2>What I want</h2>\n\n<p>Now I want to perform a case sensitive search (<code>strstr</code>) or a case insensitive search (<code>StrStrI</code> from <code>Shlwapi</code>) depends on what the user has selected in the GUI. The search is quite huge and a lot of parameters can be set. So I don't want always to ask <code>if (caseSensitve) then strstr(...) else StrStrI(...)</code> , I want to make the decision at the beginning and I write it in a structure and the <code>struct</code> goes through the different functions.</p>\n\n<h2>What's the Problem:</h2>\n\n<p>When I do it like shown below my program stops working after using 3 times <code>__strstr</code> when case insensitive is chosen (So it will run <code>StrStrI</code>). When Case sensitive is chosen <code>__strstr</code> (<code>strstr</code>) works perfect. But when I use <code>StrStrI</code> directly it works perfect, too ...</p>\n\n<p>I always get a warning from Eclipse: </p>\n\n<blockquote>\n  <p>assignment from incompatible pointer type [enabled by default]</p>\n</blockquote>\n\n<p>But why? <code>LPSTR</code> is the same as <code>char*</code>, isn't it? And the <code>typedef</code> return of the function is <code>char*</code>?!</p>\n\n<p>This sounds all quite complicated, eh? Here is a example code. This is exactly the way programmed as it is in my big program. To test it you need to add the <code>Shlwapi</code> library.</p>\n\n<pre><code>/*\n * pcap.c\n *\n *  Created on: 05.01.2015\n *      Author: Max\n */\n\n#include &lt;windef.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;shlwapi.h&gt;//need to add library shlwapi!\n\ntypedef char* (*__StrStr)(const char* str1, const char* str2);\n\ntypedef struct _findData {\n    __StrStr               __strstr; //string in string function (either strstr (cs) or StrStrI (ci))\n    char fCaseSensitve :1;\n} findData;\n\nvoid findDataTest(findData *tFindData);\nvoid findDataTest2(findData *tFindData);\n\nchar * Test1 = \"HELLO\";\nchar * Test2 = \"lo\";\n\nint main() {\n    findData *tFindData = malloc(sizeof(findData));\n\n    setbuf(stdout, NULL); //do not buffer stdout\n\n    tFindData-&gt;fCaseSensitve = 1; //set case sensitve\n\n    findDataTest(tFindData); //works perfect!\n\n    tFindData-&gt;fCaseSensitve = 0; //set case insensitve\n\n    findDataTest(tFindData); //abort after 3 times\n    return 0;\n}\n\nvoid findDataTest(findData *tFindData) {\n    if (tFindData-&gt;fCaseSensitve)\n        tFindData-&gt;__strstr = strstr; //if case sensitive use strstr\n    else\n        tFindData-&gt;__strstr = StrStrIA; //Warning from Eclipse: assignment from incompatible pointer type [enabled by default], but why? LPSTR == char*\n\n    findDataTest2(tFindData); //and here we test it\n}\n\nvoid findDataTest2(findData *tFindData) {\n    __StrStr  __strstr;\n    int i = 0;\n\n    __strstr = tFindData-&gt;__strstr;\n\n    for (; i &lt; 10; i++) {\n        printf(\"Test %d:\\t\", i);\n\n        //if (StrStrI(Test1, Test2)) //this works like a charm!\n        if (__strstr(Test1, Test2)) //this abborts after 3 times on case insenstive\n            printf(\"str is in str!\\n\");\n        else\n            printf(\"nope! str isn't in str!\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441213740, "post_id": 32358586, "comment_id": 52591169, "body": "this line: <code>typedef char Word[ WORD_LEN + 1 ];</code> is probably wrong.  What you seem to be trying to generate is a 2D (2 dimensional) array of character)  so you might use: <code>typedef char Word;</code>  then in the source code: <code>Word wordlist[WORD_LEN+1][MAX_WORDS];</code>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441214103, "post_id": 32358586, "comment_id": 52591437, "body": "@user3629249: &quot;<i><code>typedef char Word[ WORD_LEN + 1 ];</code> is legal syntax for creating an alias for a <code>char</code> array</i>&quot;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441214223, "post_id": 32358586, "comment_id": 52591505, "body": "@alk, but not legal syntax for an array of pointers to character arrays."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441214349, "post_id": 32358586, "comment_id": 52591587, "body": "Ok, I see what your idea is ... @user3629249 However this &quot;<i><code>typedef char Word; Word wordlist[WORD_LEN+1][MAX_WORDS];</code></i>&quot; also does <i>not</i> define an &quot;<i>array of pointers to character arrays</i>&quot;m but exactly what the OP currently has, as <code>wordList</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441214529, "post_id": 32358586, "comment_id": 52591674, "body": "regarding these two lines: <code>*wordList[ 0 ] = malloc ( sizeof( char ) * ( strlen( message ) + 1 ) );   *wordList[ 0 ] = *message;</code>  1) *wordList[0] is treating the first entry as a valid pointer, however it is actually a simple char array. 2) the expression <code>sizeof(char)</code> is defined as 1, so has absolutely no effect on the parameter passed to malloc and it does clutter the code.  Suggest removing that expression.  3) always check (!=NULL) the returned value from malloc to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441214806, "post_id": 32358586, "comment_id": 52591833, "body": "@alk, no malloc and no pointers needed.   However, if wanting to use malloc and pointers: <code>typedef char * Word;</code>  and <code>Word wordList[MAX_WORDS]</code> and <code>wordList[0] = malloc(strlen(message)+1);  if( NULL == wordList[0] ) { &#47;&#47; handle error }</code>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441214876, "post_id": 32358586, "comment_id": 52591875, "body": "@user3629249: I know, and also never proposed any (C-)pointers ... ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1441213239, "post_id": 32359003, "comment_id": 52590819, "body": "... or even better <code>strncpy()</code> to svoid overflowing the target."}], "tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": true, "score": 4, "last_activity_date": 1441214134, "last_edit_date": 1441214134, "creation_date": 1441213176, "answer_id": 32359003, "question_id": 32358586, "link": "https://stackoverflow.com/questions/32358586/printing-char-arrays-from-a-list/32359003#32359003", "title": "Printing char arrays from a list", "body": "<p><a href=\"http://coliru.stacked-crooked.com/a/1e07908c137af183\" rel=\"nofollow\">Use good ol' <code>strcpy</code></a>, no need for playing around with pointers.</p>\n\n<pre><code>Word message = \"HEllO\";\nstrcpy(wordList[0], message);\n\nprintf(\"%s\\n\", wordList[0]);\n</code></pre>\n\n<p>Or even <code>strncpy</code> as @alk pointed out</p>\n\n<pre><code>strncpy(wordList[0], message, sizeof(wordList[0]) - 1);\nwordList[0][WORD_LEN] = '\\0'; \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441213378, "post_id": 32359028, "comment_id": 52590926, "body": "Why the complicate way using <code>memcpy()</code> <i>and</i> <code>strlen()</code>. There is <code>strcpy()</code>/<code>strncpy()</code> for this Also your code does not protect the target from getting overflowed."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441214050, "post_id": 32359028, "comment_id": 52591389, "body": "This posted answer has lots of problems,  lets&#39; just simply say: &quot;it does not compile&quot;.  I would hardly call it a &#39;working implementation&#39;"}, {"owner": {"reputation": 2015, "user_id": 1772300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf3ce9930bc8b2c6dff0c933eaea849?s=128&d=identicon&r=PG", "display_name": "Cole Cameron", "link": "https://stackoverflow.com/users/1772300/cole-cameron"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1441214273, "post_id": 32359028, "comment_id": 52591540, "body": "@user3629249 It compiles without even a warning for me (on two different operating systems no less). What environment are you working in? Tried Linux/gcc and OpenVMS."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441214720, "post_id": 32359028, "comment_id": 52591786, "body": "The address-of applied to the agruments to the <code>printf()</code>s is wrong, indeed. The rest is okay."}, {"owner": {"reputation": 2015, "user_id": 1772300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf3ce9930bc8b2c6dff0c933eaea849?s=128&d=identicon&r=PG", "display_name": "Cole Cameron", "link": "https://stackoverflow.com/users/1772300/cole-cameron"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441214853, "post_id": 32359028, "comment_id": 52591860, "body": "@alk ahh, copied from OP, didn&#39;t even notice that. Fixed now. I compiled without <code>-Wall</code> it appears."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1441214927, "post_id": 32359028, "comment_id": 52591908, "body": "<code>-Wall -Wextra -pedantic</code> are your friends! ;-)"}, {"owner": {"reputation": 2015, "user_id": 1772300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf3ce9930bc8b2c6dff0c933eaea849?s=128&d=identicon&r=PG", "display_name": "Cole Cameron", "link": "https://stackoverflow.com/users/1772300/cole-cameron"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441214957, "post_id": 32359028, "comment_id": 52591930, "body": "@alk yes, I was too hasty in my compilation :)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441215085, "post_id": 32359028, "comment_id": 52592006, "body": "the latest posted answer does correct the problems I saw."}], "tags": [], "owner": {"reputation": 2015, "user_id": 1772300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf3ce9930bc8b2c6dff0c933eaea849?s=128&d=identicon&r=PG", "display_name": "Cole Cameron", "link": "https://stackoverflow.com/users/1772300/cole-cameron"}, "is_accepted": false, "score": 0, "last_activity_date": 1441214798, "last_edit_date": 1441214798, "creation_date": 1441213243, "answer_id": 32359028, "question_id": 32358586, "link": "https://stackoverflow.com/questions/32358586/printing-char-arrays-from-a-list/32359028#32359028", "title": "Printing char arrays from a list", "body": "<p>Since a <code>Word</code> is already typedef'd as a char array (C string), there's no need to use <code>malloc</code> to allocate memory  in your array. Essentially, wordList is an array of arrays and you can just copy the contents of your strings (Words) into it at the desired indices. See the below code for a working implementation.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n// some magic numbers\n#define WORD_LEN 50\n#define MAX_WORDS 20\n\ntypedef char Word[ WORD_LEN + 1 ];\nWord wordList[ MAX_WORDS ];\n\nint main () {\n    Word message = \"HEllO\";\n    Word message2 = \"OHHO\";\n\n    //wordList[ 0 ] = malloc ( sizeof( char ) * ( strlen( message ) + 1 ) );\n    //*wordList[ 0 ] = *message;\n    strncpy(wordList[0], message, sizeof(Word));\n\n    //wordList[ 1 ] = malloc ( sizeof( char ) * ( strlen( message2 ) + 1 ) );\n    //*wordList[ 1 ] = *message2;\n    strncpy(wordList[1], message2, sizeof(Word));\n\n    printf( \"%s\\n\", wordList[0]);\n    printf( \"%s\\n\", wordList[1]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441213726, "post_id": 32359102, "comment_id": 52591157, "body": "Why the casts, please?"}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441213821, "post_id": 32359102, "comment_id": 52591233, "body": "I thought they were required but guess not. Does strcpy internally cast them, or is it never needed to cast since though they are of type Word they are just char arrays."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1441214028, "post_id": 32359102, "comment_id": 52591372, "body": "What does you compiler with all warnings on tells you? ;-) The moment <code>wordList[0]</code> is passed to a function it decays to the address of its 1st element, which is a  <code>char</code>, so <code>char*</code> is received by the function."}], "tags": [], "owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "is_accepted": false, "score": 0, "last_activity_date": 1441213855, "last_edit_date": 1441213855, "creation_date": 1441213457, "answer_id": 32359102, "question_id": 32358586, "link": "https://stackoverflow.com/questions/32358586/printing-char-arrays-from-a-list/32359102#32359102", "title": "Printing char arrays from a list", "body": "<p>Right now wordList is an array of Word, and each word is an array of chars. When you defined  <code>Word wordList[ MAX_WORDS ]</code> the space for MAX_WORDS number of Words of size WORD_LEN+1 has already been allocated in the global section, so you don't need to malloc more space for this. </p>\n\n<p>To insert the message into the word you would use strcpy (<a href=\"http://www.cplusplus.com/reference/cstring/strcpy/\" rel=\"nofollow\">http://www.cplusplus.com/reference/cstring/strcpy/</a>) rather than mallocing space and assigning the message. So to insert message into wordList[0] would look like <code>strcpy(  wordList[0], message)</code>. Strcpy takes in two char * with the first being the destination of the copy and and second being the source. </p>\n\n<p>Here is some example code of what you should try to do:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef char Word[ 10 ];\nWord wordList[ 10 ];\nint main(){\n    Word message = \"Hello\";\n    strcpy( wordList[0], message);\n    printf(\"%s\", wordList[0]);\n    return 0;\n}\n</code></pre>\n\n<p>** To be safer you can use strncpy (<a href=\"http://www.cplusplus.com/reference/cstring/strncpy/\" rel=\"nofollow\">http://www.cplusplus.com/reference/cstring/strncpy/</a>) instead of strcpy. Here you can specify the number of characters you want to copy as a parameter. All the code would look the same except you would change strcpy to strncpy and add in a third parameter of how many character to copy.</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1441214236, "last_edit_date": 1441214236, "creation_date": 1441213533, "answer_id": 32359127, "question_id": 32358586, "link": "https://stackoverflow.com/questions/32358586/printing-char-arrays-from-a-list/32359127#32359127", "title": "Printing char arrays from a list", "body": "<p><code>wordList</code> is an array of C-\"string\"s. So use them like this:</p>\n\n<pre><code>Word message = \"HEllO\";\n\nsize_t size_max = sizeof wordList[0] - 1;\n\nstrncpy(wordList[0], message, size_max);\nwordList[0][size_max] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5293492, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/915632518508415/picture?type=large", "display_name": "TheBuffED", "link": "https://stackoverflow.com/users/5293492/thebuffed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 0, "accepted_answer_id": 32359003, "answer_count": 4, "score": 4, "last_activity_date": 1441214798, "creation_date": 1441211983, "question_id": 32358586, "link": "https://stackoverflow.com/questions/32358586/printing-char-arrays-from-a-list", "title": "Printing char arrays from a list", "body": "<p>It's been awhile since I had to deal with C pointers, and I'm having trouble with a project. Here's some example code I made to highlight my problem. I Just need to be able to add strings to the \"wordList\" and be able to retrieve them later. </p>\n\n<pre><code>// This typedef is in the header file\n// typedef char Word[ WORD_LEN + 1 ];\n\nWord wordList[ MAX_WORDS ];\n\nint main () {\n  Word message = \"HEllO\";\n  Word message2 = \"OHHO\";\n\n  *wordList[ 0 ] = malloc ( sizeof( char ) * ( strlen( message ) + 1 ) );\n  *wordList[ 0 ] = *message;\n\n  *wordList[ 1 ] = malloc ( sizeof( char ) * ( strlen( message2 ) + 1 ) );\n  *wordList[ 1 ] = *message2;\n\n  printf( \"%s\\n\", &amp;wordList[0]);\n  printf( \"%s\\n\", &amp;wordList[1]);\n}\n</code></pre>\n\n<p>Currently the words are not printing, it will only print the first letter. Any tips on where I might be messing up would be incredible. Thanks!</p>\n"}, {"tags": ["c", "printf", "output", "stdio", "puts"], "comments": [{"owner": {"reputation": 191202, "user_id": 147356, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b9506717d24256a090524dd5505d3207?s=128&d=identicon&r=PG", "display_name": "larsks", "link": "https://stackoverflow.com/users/147356/larsks"}, "edited": false, "score": 4, "creation_date": 1441211092, "post_id": 32358262, "comment_id": 52589562, "body": "Because maybe next you&#39;ll want to write <code>printf(&quot;Hello, %s\\n&quot;, name)</code>?"}, {"owner": {"reputation": 1143, "user_id": 3858885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a19704d80920c1f9e628c0d6463abe?s=128&d=identicon&r=PG", "display_name": "michaelrccurtis", "link": "https://stackoverflow.com/users/3858885/michaelrccurtis"}, "edited": false, "score": 1, "creation_date": 1441211124, "post_id": 32358262, "comment_id": 52589587, "body": "See <a href=\"http://stackoverflow.com/questions/2454474/what-is-the-difference-between-printf-and-puts-in-c\" title=\"what is the difference between printf and puts in c\">stackoverflow.com/questions/2454474/&hellip;</a>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 5, "creation_date": 1441211212, "post_id": 32358262, "comment_id": 52589641, "body": "Because people don\u2019t know about <code>puts</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441219583, "post_id": 32358262, "comment_id": 52594483, "body": "The <code>puts()</code> variant use one byte fewer memory."}, {"owner": {"reputation": 1554, "user_id": 4499919, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n2u5L.jpg?s=128&g=1", "display_name": "udit043", "link": "https://stackoverflow.com/users/4499919/udit043"}, "edited": false, "score": 0, "creation_date": 1441246700, "post_id": 32358262, "comment_id": 52604147, "body": "<a href=\"http://bytes.com/topic/c/answers/527094-puts-vs-printf\" rel=\"nofollow noreferrer\">bytes.com/topic/c/answers/527094-puts-vs-printf</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1580923275, "post_id": 32358262, "comment_id": 106260278, "body": "Compilers optimize this for you anyway, and having the <code>\\n</code> explicit instead of implicit is not a bad thing."}], "answers": [{"tags": [], "owner": {"reputation": 3878, "user_id": 5019769, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AZIN5bdpPvY/AAAAAAAAAAI/AAAAAAAACXQ/W8jFHU8QlO8/photo.jpg?sz=128", "display_name": "F. Stephen Q", "link": "https://stackoverflow.com/users/5019769/f-stephen-q"}, "is_accepted": false, "score": 0, "last_activity_date": 1441211180, "creation_date": 1441211180, "answer_id": 32358327, "question_id": 32358262, "link": "https://stackoverflow.com/questions/32358262/why-use-printfmystring-n-instead-of-just-putsmystring/32358327#32358327", "title": "Why use printf(&quot;mystring\\n&quot;) instead of just puts(&quot;mystring&quot;)?", "body": "<p><code>printf()</code> is generally the preferred alternative, simply because it's more powerful and gives a programmer more control over their output. </p>\n"}, {"comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1441211384, "post_id": 32358373, "comment_id": 52589744, "body": "It\u2019s not that hard to change <code>puts</code> to <code>printf</code>."}, {"owner": {"reputation": 1017, "user_id": 3158736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b931bb87356d211adad0f88458cb92b?s=128&d=identicon&r=PG&f=1", "display_name": "ShiningLight", "link": "https://stackoverflow.com/users/3158736/shininglight"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1441211428, "post_id": 32358373, "comment_id": 52589773, "body": "When you&#39;re maintaining thousands of lines of legacy code and multiple files, it becomes more complicated."}], "tags": [], "owner": {"reputation": 1017, "user_id": 3158736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5b931bb87356d211adad0f88458cb92b?s=128&d=identicon&r=PG&f=1", "display_name": "ShiningLight", "link": "https://stackoverflow.com/users/3158736/shininglight"}, "is_accepted": false, "score": 0, "last_activity_date": 1441211314, "creation_date": 1441211314, "answer_id": 32358373, "question_id": 32358262, "link": "https://stackoverflow.com/questions/32358262/why-use-printfmystring-n-instead-of-just-putsmystring/32358373#32358373", "title": "Why use printf(&quot;mystring\\n&quot;) instead of just puts(&quot;mystring&quot;)?", "body": "<p>When you want to update your code later down the road, you might be using variables. <code>puts()</code> doesn't format variables, but <code>printf()</code> does. Also, <code>puts()</code> always adds the new line, so if you ever don't want a newline, then you'll want to switch to <code>printf()</code>. Basically, <code>printf()</code> allows you to maintain the code longer.</p>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1441211707, "last_edit_date": 1441211707, "creation_date": 1441211356, "answer_id": 32358385, "question_id": 32358262, "link": "https://stackoverflow.com/questions/32358262/why-use-printfmystring-n-instead-of-just-putsmystring/32358385#32358385", "title": "Why use printf(&quot;mystring\\n&quot;) instead of just puts(&quot;mystring&quot;)?", "body": "<p><code>puts</code> or <code>fputs</code> should be used whenever no variables must be formatted/printed. The following would give a problem:</p>\n\n<pre><code> printf(\"How many %s is the interest?\\n\");\n</code></pre>\n\n<p>Especially when the string to print is passed as a variable, it can be hard to find the error.</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 5293354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da4d2b92466fa6c5b277a995b8588e76?s=128&d=identicon&r=PG&f=1", "display_name": "boxHiccup", "link": "https://stackoverflow.com/users/5293354/boxhiccup"}, "is_accepted": false, "score": 1, "last_activity_date": 1441211506, "creation_date": 1441211506, "answer_id": 32358429, "question_id": 32358262, "link": "https://stackoverflow.com/questions/32358262/why-use-printfmystring-n-instead-of-just-putsmystring/32358429#32358429", "title": "Why use printf(&quot;mystring\\n&quot;) instead of just puts(&quot;mystring&quot;)?", "body": "<p>Also if you want to print something that has \"%\" it's recommended to use <code>puts</code></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1441212341, "creation_date": 1441212341, "answer_id": 32358712, "question_id": 32358262, "link": "https://stackoverflow.com/questions/32358262/why-use-printfmystring-n-instead-of-just-putsmystring/32358712#32358712", "title": "Why use printf(&quot;mystring\\n&quot;) instead of just puts(&quot;mystring&quot;)?", "body": "<blockquote>\n  <p>Why use <code>printf(\"mystring\\n\")</code> instead of just <code>puts(\"mystring\")</code>?</p>\n</blockquote>\n\n<p>Note: there are reasons <em>not</em> to use <code>printf()</code> like the apperance of the <code>'%'</code> character, but OP seems to want reasons <em>for</em> <code>printf(line_of_text)</code>.</p>\n\n<p>Example 1: in an embedded application (code space limited) that already uses <code>printf()</code>, <code>puts()</code> may cost additional program space.</p>\n\n<p>Example 2: The output of <code>puts()</code> appends a <code>'\\n'</code>. This behavior catches programmers who forget this and use <code>puts(\"mystring\\n\")</code>.  Using <code>printf(\"mystring\\n\")</code> is explicit.  Using <code>fputs(\"mystring\\n\", stdout)</code> is even better.</p>\n"}], "owner": {"reputation": 21, "user_id": 5293433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0854d21768877f61143400d27ce9f563?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Gates", "link": "https://stackoverflow.com/users/5293433/bill-gates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "closed_date": 1441228260, "answer_count": 5, "score": 2, "last_activity_date": 1441215235, "creation_date": 1441210980, "question_id": 32358262, "link": "https://stackoverflow.com/questions/32358262/why-use-printfmystring-n-instead-of-just-putsmystring", "closed_reason": "Opinion-based", "title": "Why use printf(&quot;mystring\\n&quot;) instead of just puts(&quot;mystring&quot;)?", "body": "<p>I've seen this in code where just a normal string without any formatting is displayed using printf (e.g. printf(\"Hello World!\\n\").\nWhy not just use puts(\"Hello World\") instead?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "filesystems", "ext4"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1441212608, "post_id": 32358218, "comment_id": 52590413, "body": "I&#39;m not sure about ext4, but it can well be that ext4 uses a ns precison higher that the resolution of the actual system time. This to be on the safe side for the future."}, {"owner": {"reputation": 2311, "user_id": 4566976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56346a6db33a8b54fe45d1516a8c82c8?s=128&d=identicon&r=PG&f=1", "display_name": "4566976", "link": "https://stackoverflow.com/users/4566976/4566976"}, "edited": false, "score": 4, "creation_date": 1441213169, "post_id": 32358218, "comment_id": 52590776, "body": "<a href=\"http://stackoverflow.com/questions/14392975/timestamp-accuracy-on-ext4-sub-millsecond\">http://stackoverflow.com/questions/14392975/timestamp-accura&zwnj;&#8203;cy-on-ext4-sub-mills&zwnj;&#8203;econd</a>"}], "owner": {"reputation": 58653, "user_id": 1131467, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6115f0a575cf85c444663504d5f1b3c3?s=128&d=identicon&r=PG", "display_name": "Andrew Tomazos", "link": "https://stackoverflow.com/users/1131467/andrew-tomazos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1441211490, "creation_date": 1441210822, "last_edit_date": 1441211490, "question_id": 32358218, "link": "https://stackoverflow.com/questions/32358218/linux-ext4-nanosecond-modified-timestamps", "title": "Linux ext4 nanosecond modified timestamps?", "body": "<p>I am running Ubuntu 15.04 with a linux kernel 3.19.0-26-generic, my filesystem is the default ext4.</p>\n\n<p>I run a test where I:</p>\n\n<ol>\n<li>Open/Write/Close a file.</li>\n<li>Get the modification time (from <code>stat</code> in nanoseconds)</li>\n<li>Sleep for 1 millisecond</li>\n<li>Open/Write/Close the file again with different content.</li>\n<li>Get the new modification time (from <code>stat</code> in nanoseconds)</li>\n<li>Compare the times from 2 and 5.</li>\n</ol>\n\n<p>What I observe in about 50% of cases is that the two times are identical.  I expected them to be always different (5 greater than 2).</p>\n\n<p>Is it the case that the resolution of the modification times on ext4 is lower than nanosecond (even though stat can report nanosecond-accuracy), or is their a bug in my test?  If ext4 stores lower than nanosecond accuracy, than what is the real resolution of the modification times? and where is this documented?</p>\n"}, {"tags": ["c", "linux", "macos", "perl", "travis-ci"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1441211246, "post_id": 32358197, "comment_id": 52589667, "body": "Check <a href=\"https://metacpan.org/pod/App::cpanminus#Installing-to-system-perl\" rel=\"nofollow noreferrer\">metacpan.org/pod/App::cpanminus#Installing-to-system-perl</a>"}], "answers": [{"comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 2, "creation_date": 1441265885, "post_id": 32358866, "comment_id": 52610850, "body": "Good job figuring out local::lib also! :)"}], "tags": [], "owner": {"reputation": 1898, "user_id": 431087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5MGz.jpg?s=128&g=1", "display_name": "Isaac Turner", "link": "https://stackoverflow.com/users/431087/isaac-turner"}, "is_accepted": true, "score": 4, "last_activity_date": 1441228194, "last_edit_date": 1441228194, "creation_date": 1441212790, "answer_id": 32358866, "question_id": 32358197, "link": "https://stackoverflow.com/questions/32358197/travis-ci-install-perl-module-with-non-perl-language/32358866#32358866", "title": "Travis CI Install perl module with non-perl language", "body": "<p>Thanks to @simbabque's comment I installed cpanm to the system perl, then used cpanm to install the perl module and it works:</p>\n\n<pre><code>curl -L https://cpanmin.us | sudo perl - --sudo App::cpanminus\nsudo cpanm JSON\n</code></pre>\n\n<p><strike>I've not yet figured out the easiest way to install locally without using sudo.</strike></p>\n\n<p><strong>Edit:</strong> Without requiring sudo, using <code>local::lib</code> to setup <code>$PERL5LIB</code> paths etc.:</p>\n\n<pre><code># Install modules into ~/perl5 using system perl\ncurl -L https://cpanmin.us | perl - App::cpanminus\n~/perl5/bin/cpanm local::lib\n~/perl5/bin/cpanm JSON\n\n# Add path to ~/perl5 modules to ~/.bashrc\necho '[ $SHLVL -eq 1 ] &amp;&amp; eval \"$(perl -I$HOME/perl5/lib/perl5 -Mlocal::lib)\"' &gt;&gt; ~/.bashrc\n</code></pre>\n"}], "owner": {"reputation": 1898, "user_id": 431087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5MGz.jpg?s=128&g=1", "display_name": "Isaac Turner", "link": "https://stackoverflow.com/users/431087/isaac-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 2, "accepted_answer_id": 32358866, "answer_count": 1, "score": 4, "last_activity_date": 1441228194, "creation_date": 1441210759, "question_id": 32358197, "link": "https://stackoverflow.com/questions/32358197/travis-ci-install-perl-module-with-non-perl-language", "title": "Travis CI Install perl module with non-perl language", "body": "<p>How do you install perl modules on linux and mac platforms on Travis CI when the language is <em>not</em> set to perl?  I'm compiling a C program with perl test scripts.</p>\n\n<p>If the language is perl, <code>cpanm</code> is available:</p>\n\n<pre><code>cpanm JSON\n</code></pre>\n\n<p>Otherwise if the platform is linux:</p>\n\n<pre><code>sudo apt-get install libjson-pp-perl\n</code></pre>\n\n<p>But when on mac <code>cpanm</code> and <code>apt-get</code> are not available. The mac platform has the <code>brew</code> command available to install programs but I can't figure out if I need to install a fresh version of perl instead of just a module for the system perl version. </p>\n\n<p>The mac version also has the <code>cpan JSON</code> command available, but it hangs to go through an interactive first-run configuration. </p>\n"}, {"tags": ["c", "string", "macros", "numbers"], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441210714, "post_id": 32358136, "comment_id": 52589341, "body": "&quot;<i>You don&#39;t need the (i) ...</i>&quot; as far as I understand the question the (value of) <code>i</code> is an explicit must."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1441210745, "post_id": 32358136, "comment_id": 52589360, "body": "Well no, he wants the value of <code>i</code> to appear in the macro expansion."}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "edited": false, "score": 0, "creation_date": 1441210825, "post_id": 32358136, "comment_id": 52589410, "body": "Ooo, my bad from his explanation I thought he just wanted the  &quot;^&quot; printed, ok lemme remove this answer then"}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "edited": false, "score": 0, "creation_date": 1441211237, "post_id": 32358136, "comment_id": 52589659, "body": "I think he has to move printing the i to the printf since leaving it in the macro would be a compile error, so I edited the answer. Sorry for the confusion"}], "tags": [], "owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "is_accepted": false, "score": -2, "last_activity_date": 1441211159, "last_edit_date": 1441211159, "creation_date": 1441210538, "answer_id": 32358136, "question_id": 32357952, "link": "https://stackoverflow.com/questions/32357952/mixture-of-string-and-number-in-macro/32358136#32358136", "title": "mixture of string and number in macro", "body": "<p>You don't need the (i) after the \"^\". Change your macro to this and it should work <code>#define ESP(i) ((i&gt;0) ? (\"^\") : (\"\"))</code>. Then in your printf statement if you want to print the value of i after the \"^\" then have something like this <code>printf(\"%s%d\", ESP(i), i);</code> As far as I know I don't think you can format a string to include an integer inside a macro since that would require calling other functions, so you have to bring the i into the string inside your printf. </p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441211705, "post_id": 32358370, "comment_id": 52589906, "body": "Note that <code>(i)</code> is not equivalent to <code>(i &gt; 0)</code> if <code>i</code> is of a signed type."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441211748, "post_id": 32358370, "comment_id": 52589939, "body": "Ahok, sure. But this a detail. Will correct this however. @JohnBollinger"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441212347, "post_id": 32358370, "comment_id": 52590259, "body": "I imagine your warning arises from this expression: <code>(i&gt;0) ?i :&quot;&quot;</code>.  You can avoid the warning and change that expression to plain <code>i</code> if you remove the trailing <code>%s</code> field descriptor from the second format string."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1441212389, "last_edit_date": 1441212389, "creation_date": 1441211295, "answer_id": 32358370, "question_id": 32357952, "link": "https://stackoverflow.com/questions/32357952/mixture-of-string-and-number-in-macro/32358370#32358370", "title": "mixture of string and number in macro", "body": "<p>Somewhat dirty but should work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define DYNFORMAT(n, i) (i&gt;0) ?\"%+d%s%d\\n\" :\"%+d%s%s\\n\", n, (i&gt;0) ?\"^\" :\"\", (i&gt;0) ?i :\"\"\n\nint main(void) \n{\n  int i = 0;\n  printf(DYNFORMAT(42, i));\n  i = 1;\n  printf(DYNFORMAT(42, i));\n}\n</code></pre>\n\n<p>This should print:</p>\n\n<pre><code>+42\n+42^1\n</code></pre>\n\n<p>Disclaimer: I am not sure whether this conforms to the Standard and how to get rid of the warning(s) it gives during compilation.</p>\n\n<hr>\n\n<p>The clean approach would be to use two calls to <code>printf()</code>. </p>\n\n<p>This can be implemented as a macro or a function.</p>\n\n<p>As I love the pre-processor, the macro version here:</p>\n\n<pre><code>#define PRINT_ESP(n, i) \\\ndo { \\\n  if (i = 0) \\\n    printf(\"%+d\", n); \\\n  else \\\n    printf(\"%+d^%d\", n, i); \\\n} while (0); \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441211871, "post_id": 32358426, "comment_id": 52590014, "body": "This won&#39;t work, at least because the <code>%s</code> expects a &quot;string&quot; which isn&#39;t around in the argument list."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441212158, "post_id": 32358426, "comment_id": 52590174, "body": "Much more straight forward, then my answer. Also cleaner, as it generates few warnings."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1441212595, "last_edit_date": 1441212595, "creation_date": 1441211502, "answer_id": 32358426, "question_id": 32357952, "link": "https://stackoverflow.com/questions/32357952/mixture-of-string-and-number-in-macro/32358426#32358426", "title": "mixture of string and number in macro", "body": "<p>Macros operate at compile time, not at run time.  They can perform a variety of text-mangling tricks, but they do not <em>evaluate</em> anything.  (They can certainly, however, expand to <em>code</em> that evaluates something.)  Putting the formatted value of variable <code>i</code> into a string involves evaluating <code>i</code>; no macro can do this.</p>\n\n<p>You could instead expand the scope of the macro to include the whole <code>printf()</code> call:</p>\n\n<pre><code>#define PRINT_ESP(n1, i) do { \\\n    printf(((i &gt; 0) ? \"%+d^%d\" : \"%+d\"), n1, i); \\\n} while (0)\n</code></pre>\n\n<p>Alternatively, you could use a macro to express just the format selection incorporated into the above macro definition, or you could just put the full <code>printf()</code> call above directly into your code.</p>\n\n<p>All of these variations are based on the fact that arguments in excess of those required by the given format are evaluated prior to the call, but ignored by <code>printf()</code> itself.</p>\n"}], "owner": {"reputation": 1264, "user_id": 4019207, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "StackUser", "link": "https://stackoverflow.com/users/4019207/stackuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1441212595, "creation_date": 1441209868, "question_id": 32357952, "link": "https://stackoverflow.com/questions/32357952/mixture-of-string-and-number-in-macro", "title": "mixture of string and number in macro", "body": "<p>I want to use this macro to put (if 'i' is greater than zero) the symbol '^' and the number I pass (i) to the macro</p>\n\n<pre><code>#define ESP(i) ((i&gt;0) ? (\"^\"(i)) : \"\")\n</code></pre>\n\n<p>I want to call it in this way</p>\n\n<pre><code>printf(\"%+d%s\", n1, ESP(i));\n</code></pre>\n\n<p>where 'i' is the index of a cycle, but the compilation reports me errors;\nhow can I modify the code to be right?</p>\n"}, {"tags": ["c++", "c", "linux", "x86", "intel"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1441208839, "post_id": 32357513, "comment_id": 52588179, "body": "A thought for you: will your code always be run on the same machine, or could it be run on different machines, some of which may have the RDTSCP instruction and others which may not have the RDTSCP instruction?"}, {"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 1, "creation_date": 1441209123, "post_id": 32357513, "comment_id": 52588355, "body": "I&#39;m skeptical there is a compiler macro, but <code>cpuid</code> would always return the correct value."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1441209367, "post_id": 32357513, "comment_id": 52588496, "body": "As Jonathan has pointed out, you need to compile both versions, and pick one when your program starts, because presence of RDTSCP is a feature of the runtime environment, not the compile environment."}, {"owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1441209419, "post_id": 32357513, "comment_id": 52588534, "body": "@JonathanLeffler: Yes, my code is expected to run on various machines (some with <code>RDTSCP</code> and others with <code>RDTSC</code> only). For machines with without <code>RDTSCP</code>, I am only depending on <code>RDTSC</code>. I feel this very time-consuming to check cpuinfo and edit it manually every-time."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1441209541, "post_id": 32357513, "comment_id": 52588622, "body": "Well, do it just once, use a function pointer."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1441209636, "post_id": 32357513, "comment_id": 52588690, "body": "If done at program startup, once, it won&#39;t be all that time consuming (you won&#39;t notice it compared to the cost of the dynamic loader loading the shared libraries, for example).  If it is done every time you need to do some timing (within a single run of the program), then it&#39;s a more serious problem \u2014 but it is a problem largely fixable by code design.  At worst, if you run the RDTSCP version and find that the CPU doesn&#39;t have the instruction, you re-execute the RDTSC version of the program instead (nasty, but doable).  More likely, you self-configure \u2014 a function pointer to the code or \u2026"}, {"owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "reply_to_user": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1441209895, "post_id": 32357513, "comment_id": 52588863, "body": "@Jason Can (and how) <code>cpuid</code> provide if the architecture has <code>RDTSCP</code> instruction? Does it set some specific bit in some register for <code>RDTSCP</code>?"}, {"owner": {"reputation": 1285, "user_id": 5003848, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12b681a7a5cab103fa1ea1165685555b?s=128&d=identicon&r=PG&f=1", "display_name": "tonysdg", "link": "https://stackoverflow.com/users/5003848/tonysdg"}, "edited": false, "score": 1, "creation_date": 1441210213, "post_id": 32357513, "comment_id": 52589059, "body": "@Junaid - according to <a href=\"http://www.intel.com/content/dam/www/public/us/en/documents/white-papers/ia-32-ia-64-benchmark-code-execution-paper.pdf\" rel=\"nofollow noreferrer\">this document</a> from Intel, it should be a flag listed in the <code>&#47;proc&#47;cpuinfo</code> (see Chap 2.1 - Introduction).  Doesn&#39;t answer your question exactly about how to use <code>cpuid</code> (I don&#39;t know that, unfortunately)."}, {"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 1, "creation_date": 1441210725, "post_id": 32357513, "comment_id": 52589347, "body": "Yes, there&#39;s a <code>cpuid</code> leaf (80000001H) for processor features you can use.  Normally, it&#39;s called using assembly, but I think there&#39;s a compiler intrinsic for it."}, {"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1441211371, "post_id": 32357513, "comment_id": 52589735, "body": "I&#39;m not sure what you&#39;re using both for though.  You can get the majority of the functionality of <code>rdtscp</code> using <code>rdtsc</code> and an <code>lfence</code>."}, {"owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "reply_to_user": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1441270213, "post_id": 32357513, "comment_id": 52613549, "body": "@Jason Thanks for your pointers. Yes, <a href=\"http://www.intel.com/content/dam/www/public/us/en/documents/white-papers/ia-32-ia-64-benchmark-code-execution-paper.pdf\" rel=\"nofollow noreferrer\">this document</a> (as pointed out by @tonysdg too) provides the exact reasoning behind me using the <code>RDTSCP</code>+ <code>RDSTC</code> instructions."}, {"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1441292525, "post_id": 32357513, "comment_id": 52628958, "body": "Just a heads up, <code>cpuid</code> is an expensive instruction so you may want to cache the value in a global at startup."}, {"owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "reply_to_user": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1441292927, "post_id": 32357513, "comment_id": 52629242, "body": "@Jason: Yes, you are right. I am putting this in a global after only calling at the start of the program."}, {"owner": {"reputation": 14722, "user_id": 823738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a13a6ed05bdce33d6bf0f01496b9a044?s=128&d=identicon&r=PG", "display_name": "Zaffy", "link": "https://stackoverflow.com/users/823738/zaffy"}, "edited": false, "score": 0, "creation_date": 1551125109, "post_id": 32357513, "comment_id": 96517700, "body": "@Junaid Hello, what build system do you use? Can&#39;t you just figure that out during configuration of the build and set the appropriate macro to the compiler flags?"}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "edited": false, "score": 0, "creation_date": 1441268811, "post_id": 32358416, "comment_id": 52612686, "body": "I know a dirty way to achieve what I want. I could write a function which could do <code>fopen(&quot;&#47;proc&#47;cpuinfo&quot;,&quot;r&quot;)</code> and then read and parse the data to find <code>RDTSCP</code>. But I was looking for something more generic and independent of underlying operating system ..."}, {"owner": {"reputation": 148, "user_id": 4235856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsZg8.jpg?s=128&g=1", "display_name": "stellarpower", "link": "https://stackoverflow.com/users/4235856/stellarpower"}, "reply_to_user": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "edited": false, "score": 0, "creation_date": 1441275662, "post_id": 32358416, "comment_id": 52617072, "body": "Well, I&#39;m getting somewhere with the SFINAE route, but I don&#39;t know if it will work in the end. g++ is allowing me to put non-existing instructions into an asm declaration in a lambda, as long as I don&#39;t call that lambda. However when I call it in the SFINAE class&#39; argument list as a default parameter, it compiles fine. If I can modify it somehow so that it fails properly, then you will be able to use a static const bool to control whether you include the extra processor instructions, and you can switch on it at compile-time or runtime (as long as you don&#39;t have anything that won&#39;t compile.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550694532, "post_id": 32358416, "comment_id": 96367481, "body": "This can&#39;t possibly work on G++.  It doesn&#39;t have a built-in assembler; it compiles to asm and <i>then</i> feeds that to the assembler.  Also, the assembler doesn&#39;t respect the <code>-march=</code> ISA extension filter.  Using the <code>__rdtscp()</code> intrinsic / builtin could have some chance of working, but GCC doesn&#39;t restrict <code>__rdtscp()</code> by <code>-march=</code> setting either."}], "tags": [], "owner": {"reputation": 148, "user_id": 4235856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsZg8.jpg?s=128&g=1", "display_name": "stellarpower", "link": "https://stackoverflow.com/users/4235856/stellarpower"}, "is_accepted": false, "score": -1, "last_activity_date": 1441211466, "creation_date": 1441211466, "answer_id": 32358416, "question_id": 32357513, "link": "https://stackoverflow.com/questions/32357513/detect-if-processor-has-rdtscp-at-compile-time/32358416#32358416", "title": "Detect if processor has RDTSCP at compile time", "body": "<p>I've been trying to get something to work and have so far been unsuccessful but you might want to try looking down the SFINAE route: <a href=\"https://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error</a></p>\n\n<p>I thought there might be a slim chance I could inject the assembly into a lambda and cause this to fail if the instruction doesn't exist on the platform, or succeed if it does, however lambdas can't be used with decltype. If you can somehow feed the assembly code into a template parameter then it can be done, but I don't know whether that would be possible. SFINAE is really cool but can get your head in a spin very quickly.</p>\n\n<p>If you're on *nix, another (possibly na\u00efve and reasonably inelegant) way to do it would be to write a program that runs that assembly instruction and then catches a SIGILL and executes the version of the program without the special instructions. </p>\n\n<p>But there must be a nicer way than this to do it, and I should think that looking at compiler-specific macros would be the way to do it. </p>\n\n<p>Good Luck!</p>\n"}, {"comments": [{"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 1, "creation_date": 1441293303, "post_id": 32374966, "comment_id": 52629492, "body": "You can actually simplify the code a bit.  With embedded assembly you can tie variables to specific registers.  In the input section, you can add <code>&quot;a&quot;(eax)</code>, and for output <code>&quot;=d&quot;(edx)</code>.  Then you can eliminate the <code>mov</code>s and the <code>ecx</code> variable if you want.  If you do get rid of the <code>ecx</code>, just make sure it&#39;s in the list of clobbered registers."}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1541106586, "post_id": 32374966, "comment_id": 93114032, "body": "This gives error <code>error: \u2018asm\u2019 operand has impossible constraints</code>. The pre-edit version doesn&#39;t give the error."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1550683911, "post_id": 32374966, "comment_id": 96362432, "body": "@haelix: that&#39;s because it uses <code>&quot;a&quot;</code> as an input and <code>&quot;rax&quot;</code> as a clobber.  You don&#39;t need inline asm, use <code>__get_cpuid()</code> instead.  <a href=\"//stackoverflow.com/q/14266772\">How do I call &quot;cpuid&quot; in Linux?</a>"}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550760925, "post_id": 32374966, "comment_id": 96396535, "body": "@PeterCordes thanks, but I&#39;m not seasoned with assembly and it would take a bit of effort to grasp the change I need to do. Would it be possible for someone to amend the present Answer into a ready-to-use solution?"}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1550765810, "post_id": 32374966, "comment_id": 96399995, "body": "I run into a very odd issue with this code. I put it inside the c-tor of a (C++) static variable and the program hangs at startup (keeps using more and more memory). I am unable to debug it. Never seem something quite like it. Any ideas of what could cause it?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1550768338, "post_id": 32374966, "comment_id": 96401552, "body": "@haelix: what&#39;s &quot;this&quot;?  The code in this answer doesn&#39;t compile.  Did you remove the &quot;rax&quot; clobber, making it unsafe by clobbering RAX without telling the compiler?  That could certainly lead to an infinite loop over init functions, maybe repeatedly calling a <code>std::vector</code> or something.  That&#39;s why you should call <code>__get_cpuid</code> instead of using inline asm at all."}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550770201, "post_id": 32374966, "comment_id": 96402612, "body": "@PeterCordes by &quot;this&quot; I mean I am using the pre-edit version (v1), because like you say, the latest version of the aswer (v2) doesn&#39;t compile. Please can you advise?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1550770279, "post_id": 32374966, "comment_id": 96402651, "body": "@haelix: never use that, it&#39;s broken and should be expected to cause exactly the kind of breakage you&#39;re seeing.  Oh, I just looked.  That and this are both missing an RBX clobber, not RAX.  That makes even more sense; RBX is call-preserved so it&#39;s normally used for loop variables in loops that call functions.  You should downvote this answer because it&#39;s broken.  It has the right CPUID feature bit, but the inline asm is dangerous."}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550770436, "post_id": 32374966, "comment_id": 96402730, "body": "@PeterCordes OK understood, but please can you instruct where/how exactly to &quot;call <code>__get_cpuid</code>&quot;? I&#39;m good with C++ but unfortunately I have no understanding of assembly or built-ins/intrinsics and such. I remember looking for <code>cpuid</code> once without success. Would you perhaps be able to post a corrected answer?"}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550770836, "post_id": 32374966, "comment_id": 96402949, "body": "@PeterCordes - I have actually started a bounty for this. Will happily award 50 rep if you fix the current answer."}, {"owner": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "edited": false, "score": 0, "creation_date": 1550851702, "post_id": 32374966, "comment_id": 96436789, "body": "While the above answer is not correct as is, it is a good start. 1. checking at <i>compile</i> time is not possible (no pre-processor macro, no gcc target() notation, etc). Of course, nothing hinders to have a cmake/configure logic checking the availability ahead of compilation. 2. As said as well, this only holds if it&#39;s ensured, that the program is run on the same cpu as compiled. 3. The edited answer works for gcc &amp; icc, and should work in ctors as well. 4. If there is a system-gcc, this will include the mentioned cpuid.h Header which does the ASM magic for you. Otherwise please see above."}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "reply_to_user": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "edited": false, "score": 1, "creation_date": 1550871714, "post_id": 32374966, "comment_id": 96445916, "body": "@RainerKeller <i>The edited answer works</i> - No, we have established that the edited answer doesn&#39;t compile."}, {"owner": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "reply_to_user": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 0, "creation_date": 1550902717, "post_id": 32374966, "comment_id": 96451686, "body": "@haelix -- sorry, i have re-edited the above code on Feb 22nd. The main issue is the missing clobber of rbx in 64-bit code (or ebx for 32-bit compilation). My edit will only appear after it has been peer-reviewed. Shall I include a completely new answer?"}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "reply_to_user": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "edited": false, "score": 0, "creation_date": 1551005524, "post_id": 32374966, "comment_id": 96474272, "body": "@rainer if you do that (while mentioning that you&#39;re building upon the existing answer), I&#39;ll award the bounty to you. It seems the original answerer is not around. Also the question itself is misleading, it says &quot;compile-time&quot; which should not ever be mentioned in this context - please say you&#39;re not proposing a solution to the compile-time problem, as one such solution cannot exist. Thanks"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "edited": false, "score": 0, "creation_date": 1551041383, "post_id": 32374966, "comment_id": 96484306, "body": "@RainerKeller: your edit doesn&#39;t show up as pending.  And that&#39;s not the only problem, it&#39;s that eax needs to be a <code>&quot;+a&quot;</code> input/output, because you can&#39;t declare a clobber on a reg used as an operand."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "edited": false, "score": 1, "creation_date": 1551153306, "post_id": 32374966, "comment_id": 96525998, "body": "@haelix: Hadi&#39;s answer now includes working code.  It was correct before my edit, but I polished it up some.  You should probably award it the bounty."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "edited": false, "score": 1, "creation_date": 1551154225, "post_id": 32374966, "comment_id": 96526170, "body": "@RainerKeller: I fixed the asm in this answer.  Tested on <a href=\"https://godbolt.org/z/jNhxZS\" rel=\"nofollow noreferrer\">godbolt.org/z/jNhxZS</a>.  (That doesn&#39;t prove the clobbers are safe, because I didn&#39;t include any surrounding code that would try to use RAX afterwards, for example.  But a <code>&quot;+a&quot;</code> read-write operand and then leaving the variable unused afterwards is IMO the best way to tell the compiler what&#39;s going on.)"}, {"owner": {"reputation": 3372, "user_id": 1088790, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/bN5qc.jpg?s=128&g=1", "display_name": "haelix", "link": "https://stackoverflow.com/users/1088790/haelix"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1551185322, "post_id": 32374966, "comment_id": 96540726, "body": "@PeterCordes Hadi&#39;s answer is working for me (might have worked before your edit too, I did not try; also I didn&#39;t try your edit on <i>this</i> anser). Awarding the bounty to Hadi&#39;s answer."}], "tags": [], "owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "is_accepted": false, "score": 2, "last_activity_date": 1551154427, "last_edit_date": 1551154427, "creation_date": 1441281431, "answer_id": 32374966, "question_id": 32357513, "link": "https://stackoverflow.com/questions/32357513/detect-if-processor-has-rdtscp-at-compile-time/32374966#32374966", "title": "Detect if processor has RDTSCP at compile time", "body": "<p>Editor's note: <strong><a href=\"https://gcc.gnu.org/wiki/DontUseInlineAsm\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/wiki/DontUseInlineAsm</a></strong>.  This answer for a long time was unsafe, and later edited to not even compile while still being unsafe (clobbering RAX making the <code>\"a\"</code> constraint unsatisfiable, while still missing clobbers on registers that CPUID writes).  Use the intrinsics in another answer.  (But I've fixed the inline asm in this to be safe and correct, in case anyone does copy/paste it, or wants to learn how to use constraints and clobbers properly.)</p>\n\n<hr>\n\n<p>After investigating a little more based on the suggestions made by @Jason, I have now a run-time solution (still not a compile-time one) to determine if <code>RDTSCP</code> exists by checking the 28th bit (see <a href=\"https://en.wikipedia.org/wiki/CPUID#EAX.3D80000001h:_Extended_Processor_Info_and_Feature_Bits\" rel=\"nofollow noreferrer\">output bitmap</a>) of the <code>cpuid</code> instruction with <code>0x80000001</code> as input in <code>EAX</code>.</p>\n\n<pre><code>int if_rdtscp() {\n    unsigned int edx;\n    unsigned int eax = 0x80000001;\n#ifdef __GNUC__              // GNU extended asm supported\n    __asm__ (     // doesn't need to be volatile: same EAX input -&gt; same outputs\n     \"CPUID\\n\\t\"\n    : \"+a\" (eax),         // CPUID writes EAX, but we can't declare a clobber on an input-only operand.\n      \"=d\" (edx)\n    : // no read-only inputs\n    : \"ecx\", \"ebx\");      // CPUID writes E[ABCD]X, declare clobbers\n\n    // a clobber on ECX covers the whole RCX, so this code is safe in 64-bit mode but is portable to either.\n\n#else // Non-gcc/g++ compilers.\n    // To-do when needed\n#endif\n    return (edx &gt;&gt; 27) &amp; 0x1;\n}\n</code></pre>\n\n<p>If this doesn't work in 32-bit PIC code because of the EBX clobber, then 1. stop using 32-bit PIC because it's inefficient vs. 64-bit PIC or vs. <code>-fno-pie -no-pie</code> executables.  2. get a newer GCC that allows EBX clobbers even in 32-bit PIC code, emitting extra instructions to save/restore EBX or whatever is needed.  3. use the intrinsics version (which should work around this for you).</p>\n\n<hr>\n\n<p>For now I am fine with GNU compilers, but if somebody need do this under MSVC, then is an intrinsic way to check this as explained <a href=\"https://msdn.microsoft.com/en-us/library/hskdteyh.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1550684170, "post_id": 54791799, "comment_id": 96362549, "body": "It would be nice if this worked, but none of gcc, clang, ICC, or MSVC define that macro.  <a href=\"https://godbolt.org/z/at5ALR\" rel=\"nofollow noreferrer\">godbolt.org/z/at5ALR</a> shows that all 4 compilers use the <code>#else</code> branch, with <code>-march=skylake</code>, <code>-march=znver1</code>, or <code>-march=knl</code>.  (Or for MSVC, x86-64 + AVX2 because it doesn&#39;t target specific CPUs.)"}, {"owner": {"reputation": 1, "user_id": 10990249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd0a4707743885c1855f508db27db97?s=128&d=identicon&r=PG&f=1", "display_name": "Mindkid ", "link": "https://stackoverflow.com/users/10990249/mindkid"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550772776, "post_id": 54791799, "comment_id": 96403834, "body": "Hello Peter I&#39;ved answered like that because it worked for me. I&#39;m doing a project that&#39;s must know if the processor has clflushopt function, if tit does use it, if it doesn&#39;t use clflush has the flush function..."}, {"owner": {"reputation": 1, "user_id": 10990249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd0a4707743885c1855f508db27db97?s=128&d=identicon&r=PG&f=1", "display_name": "Mindkid ", "link": "https://stackoverflow.com/users/10990249/mindkid"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550773085, "post_id": 54791799, "comment_id": 96403993, "body": "I don&#39;t have access to the make file right now and the code. When i got them I can post here so you can test it out on your machine. I&#39;ved tested it in 2 separated machines one having other doesn&#39;t having and it worked the CPUID checked out. If it has continues uses clflushopt has flush function, if it doesn&#39;t uses clflush. I&#39;ved answered this question because I had the same problem and because I found a solution that worked for me I&#39;ved shared so it can be helpful for you... I don&#39;t know the compiler site that emulates the compiler I&#39;ved checked the gcc man page and use like I&#39;ved mentioned."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550773409, "post_id": 54791799, "comment_id": 96404142, "body": "Godbolt doesn&#39;t &quot;emulate&quot; gcc, it literally runs an actual install of gcc.  Compilers do define <code>__CLFLUSHOPT__</code>, but not <code>__RDTSCP__</code>.  So yes, this solution works for CLFLUSHOPT, but not for RDTSCP.  Not all ISA extensions have their own CPP macro, in gcc/clang/ICC, unfortunately.  You can&#39;t just make up macro names without checking that the compiler actually does define it or not depending on <code>-march</code> options.  (Also, ICC19 <code>-march=skylake</code> or <code>-xHOST</code> doesn&#39;t define <code>__CLFLUSHOPT__</code>, so unfortunately even that&#39;s not fully portable :("}, {"owner": {"reputation": 1, "user_id": 10990249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd0a4707743885c1855f508db27db97?s=128&d=identicon&r=PG&f=1", "display_name": "Mindkid ", "link": "https://stackoverflow.com/users/10990249/mindkid"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1550777400, "post_id": 54791799, "comment_id": 96406072, "body": "Hello Peter you got a point, and i&#39;m sorry, i&#39;ved assume that it worked because if you search on the intel intrisics you see that RDTSCPT it&#39;s the flag as such CLFLUSHOPT it&#39;s for the given function, and for the clflushopt i searched in the immintrin.h / clflushoptintrin.h for the flag of it, and it was <b>CLFLUSHOP</b> so i&#39;ved assumed that for the given function it was <b>RDTSCPT</b>. That was my assumption sorry.."}], "tags": [], "owner": {"reputation": 1, "user_id": 10990249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd0a4707743885c1855f508db27db97?s=128&d=identicon&r=PG&f=1", "display_name": "Mindkid ", "link": "https://stackoverflow.com/users/10990249/mindkid"}, "is_accepted": false, "score": -2, "last_activity_date": 1550682375, "creation_date": 1550682375, "answer_id": 54791799, "question_id": 32357513, "link": "https://stackoverflow.com/questions/32357513/detect-if-processor-has-rdtscp-at-compile-time/54791799#54791799", "title": "Detect if processor has RDTSCP at compile time", "body": "<p>Hello you can use the CPUID flag to check if it exist at compile time, for that you have to use 2 things, first guards like:</p>\n\n<pre><code>#ifdef __RDTSCP__\n    // do things because it has the \n       function \n#else\n    // do things if it doesn't have \n#endif \n</code></pre>\n\n<p>For last you have to compile the code using a flag in the gcc  for example:</p>\n\n<pre><code>gcc x.c -o x.o -march=native\n</code></pre>\n\n<p>This gcc instruction will compile your code using the native functions of you cpu so it will define your CPUIDs. </p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1550803210, "post_id": 54817856, "comment_id": 96414025, "body": "If you&#39;re building with <code>-march=native</code>, you can detect whether the host supports RDTSCP by looking at <code>&#47;proc&#47;cpuinfo</code> if the host is Linux.  e.g. <code>grep -l &#39;^flags[[:space:]]*:.*rdtscp&#39; &#47;proc&#47;cpuinfo</code>  <a href=\"//stackoverflow.com/a/54817625\">CMake test for processor feature</a>"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1551153863, "post_id": 54817856, "comment_id": 96526100, "body": "@PeterCordes Note that the value of <code>EDX</code> is undefined if <code>__get_cpuid</code> returned zero (which indicates no support for the specified CPUID leaf). I think we should either initialize d to zero or include <code>__get_cpuid</code> in the if expression as it was before the edit."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1551154532, "post_id": 54817856, "comment_id": 96526224, "body": "I had already noticed that and changed the code back to how you had it in the Godbolt link, but forgot to copy the final version back into the answer!  Sorry about that."}], "tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": true, "score": 5, "last_activity_date": 1579353992, "last_edit_date": 1579353992, "creation_date": 1550791877, "answer_id": 54817856, "question_id": 32357513, "link": "https://stackoverflow.com/questions/32357513/detect-if-processor-has-rdtscp-at-compile-time/54817856#54817856", "title": "Detect if processor has RDTSCP at compile time", "body": "<p>GCC defines many macros to determine at compile-time whether a particular feature is supported by the microarchitecture specified using <code>-march</code>. You can find the full list in the source code <a href=\"https://github.com/gcc-mirror/gcc/blob/41d6b10e96a1de98e90a7c0378437c3255814b16/gcc/config/i386/i386-c.c#L391\" rel=\"nofollow noreferrer\">here</a>. It's clear that GCC does not define such a macro for <code>RDTSCP</code> (or even <code>RDTSC</code> for that matter). The processors that support <code>RDTSCP</code> are listed in: <a href=\"https://stackoverflow.com/questions/37682939/what-is-the-gcc-cpu-type-that-includes-support-for-rdtscp\">What is the gcc cpu-type that includes support for RDTSCP?</a>.</p>\n\n<p>So you can make your own (potentially incomplete) list microarchitectures that support <code>RDTSCP</code>. Then write a build script that checks the argument passed to <code>-march</code> and see if it is in the list. If it is, then define a macro such as <code>__RDTSCP__</code> and use it in your code. I presume that even if your list is incomplete, this should not compromise the correctness of your code.</p>\n\n<p>Unfortunately, the Intel datasheets do not seem to specify whether a particular processor supports <code>RDTSCP</code> even though they discuss other features such as AVX2.</p>\n\n<p>One potential problem here is that there is no guarantee that <em>every</em> single processor that implements a particular microarchitecture, such as Skylake, supports <code>RDTSCP</code>. I'm not aware of such exceptions though.</p>\n\n<p>Related: <a href=\"https://stackoverflow.com/questions/37682939/what-is-the-gcc-cpu-type-that-includes-support-for-rdtscp\">What is the gcc cpu-type that includes support for RDTSCP?</a>.</p>\n\n<hr>\n\n<p><strong>To determine RDTSCP support at run-time</strong>, the following code can be used on compilers supporting GNU extensions (GCC, clang, ICC), on any x86 OS.  <code>cpuid.h</code> comes with the compiler, not the OS.</p>\n\n<pre><code>#include &lt;cpuid.h&gt;\n\nint rdtscp_supported(void) {\n    unsigned a, b, c, d;\n    if (__get_cpuid(0x80000001, &amp;a, &amp;b, &amp;c, &amp;d) &amp;&amp; (d &amp; (1&lt;&lt;27)))\n    {\n        // RDTSCP is supported.\n        return 1;\n    }\n    else\n    {\n        // RDTSCP is not supported.\n        return 0;\n    }\n}\n</code></pre>\n\n<p><code>__get_cpuid()</code> runs CPUID twice: once to check max level, once with the specified leaf value.  It returns false if the requested level isn't even available, that's why it's part of a <code>&amp;&amp;</code> expression.  You probably don't want to use this every time before rdtscp, just as an initializer for a variable unless it's just a simple one-off program.  See it <a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Ccpuid.h%3E%0A%0Aint+rdtscp_supported(void)+%7B%0A++++unsigned+a,+b,+c,+d%3B%0A++++if+(__get_cpuid(0x80000001,+%26a,+%26b,+%26c,+%26d)+%26%26+(d+%26+(1%3C%3C27)))%0A++++%7B%0A++++++++//+RDTSCP+is+supported.%0A++++++++return+1%3B%0A++++%7D%0A++++else%0A++++%7B%0A++++++++//+RDTSCP+is+not+supported.%0A++++++++return+0%3B%0A++++%7D%0A%7D%0A%0A%0A//+unfortunately+no+equivalent+for+RDTSCP%0Aint+sse42_supported()+%7B%0A++++return+__builtin_cpu_supports(%22sse4.2%22)%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:34.57745932470406,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:g83,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3++-Wall+-std%3Dc99+-march%3Dskylake&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+8.3+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:26.111951963314816,l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:clang700,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3++-Wall+-std%3Dc99+-march%3Dskylake&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+7.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:34.37733492555975,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:icc191,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3++-Wall+-std%3Dc99+-march%3Dskylake&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+icc+19.0.1+(Editor+%231,+Compiler+%233)+C%2B%2B&#39;,t:&#39;0&#39;)),k:31.04520574973618,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">on the Godbolt compiler explorer</a>.</p>\n\n<p>For MSVC, see <a href=\"https://stackoverflow.com/questions/25149358/how-to-detect-rdtscp-support-in-visual-c\">How to detect rdtscp support in Visual C++?</a> for code using its intrinsic.</p>\n\n<hr>\n\n<p>For some CPU features that GCC does know about, you can use <code>__builtin_cpu_supports</code> to check a feature bitmap that's initialized early in startup.</p>\n\n<pre><code>// unfortunately no equivalent for RDTSCP\nint sse42_supported() {\n    return __builtin_cpu_supports(\"sse4.2\");\n}\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2413, "favorite_count": 2, "accepted_answer_id": 54817856, "answer_count": 4, "score": 6, "last_activity_date": 1579353992, "creation_date": 1441208556, "last_edit_date": 1551154889, "question_id": 32357513, "link": "https://stackoverflow.com/questions/32357513/detect-if-processor-has-rdtscp-at-compile-time", "title": "Detect if processor has RDTSCP at compile time", "body": "<p>Some new Intel processors have both <code>RDTSC</code>and <code>RDTSCP</code> instructions while most older processors have only <code>RDTSC</code> instruction.</p>\n\n<p>While coding in C/C++, how I can detect at compile time if the architecture being used have <code>RDTSCP</code> instruction or not? </p>\n\n<p>I know we can check this out manually by browsing CPU info (e.g., cat /proc/cpuinfo) and then adjusting our code. But getting this information at compile time (as a macro or flag value) would really omit the need to manually checking and editing the code.</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1441209160, "creation_date": 1441209160, "answer_id": 32357706, "question_id": 32357476, "link": "https://stackoverflow.com/questions/32357476/creating-an-array-of-struct-c/32357706#32357706", "title": "Creating an array of struct (c)", "body": "<p>You've got your declaration backward.  This:</p>\n\n<pre><code>typedef struct Employee{\n    char name[MAX_SIZE];\n    int s;\n    int e;\n} employee_s;\n</code></pre>\n\n<p>declares a type named <code>employee_s</code> to be equivalent to <code>struct Employee</code>, and furthermore declares <code>struct Employee</code>.  You appear to want this, instead:</p>\n\n<pre><code>typedef struct employee_s {\n    char name[MAX_SIZE];\n    int s;\n    int e;\n} Employee;\n</code></pre>\n\n<p>In this case you can omit <code>employee_s</code> from that if you wish; perhaps that would be less confusing.</p>\n\n<p>Moreover, you are going about your allocation in a very strange way, especially since you don't require dynamic allocation.  Why not just do this:</p>\n\n<pre><code>Employee e[3];\n</code></pre>\n\n<p>? Then you can (and should) skip <code>malloc()</code> altogether.  You will then refer to the members of the array elements via the form <code>e[0].name</code>, etc..</p>\n"}, {"comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1441211012, "post_id": 32357713, "comment_id": 52589516, "body": "<code>&amp;e[i].name</code> should be <code>e[i].name</code>. And those spaces before the format specifier are unnecessary."}, {"owner": {"reputation": 9174, "user_id": 4248342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMjPU.jpg?s=128&g=1", "display_name": "Hardik Modha", "link": "https://stackoverflow.com/users/4248342/hardik-modha"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1441211231, "post_id": 32357713, "comment_id": 52589652, "body": "@CoolGuy Although generally we don&#39;t use <code>&amp;</code> while reading in character array but I think there is not any problem in using <code>&amp;e[i].name</code> instead of <code>e[i].name</code>. Take a look at this <a href=\"http://stackoverflow.com/questions/5406935/reading-a-string-with-scanf\">question</a>"}, {"owner": {"reputation": 631, "user_id": 3142625, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/O1tDP.jpg?s=128&g=1", "display_name": "Coder123", "link": "https://stackoverflow.com/users/3142625/coder123"}, "edited": false, "score": 0, "creation_date": 1441211417, "post_id": 32357713, "comment_id": 52589765, "body": "thank you very much! one thing i did not understand is why not using fflush(stdin), if i want to recive string it will not take the garbage values in the buffer otherwise?"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 9174, "user_id": 4248342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMjPU.jpg?s=128&g=1", "display_name": "Hardik Modha", "link": "https://stackoverflow.com/users/4248342/hardik-modha"}, "edited": false, "score": 0, "creation_date": 1441211757, "post_id": 32357713, "comment_id": 52589945, "body": "@HardikModha Hmm. But as that answer you linked says, it is wrong and the standard doesn&#39;t say anything about it. Also, you get a warning. So it is better to avoid it."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 631, "user_id": 3142625, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/O1tDP.jpg?s=128&g=1", "display_name": "Coder123", "link": "https://stackoverflow.com/users/3142625/coder123"}, "edited": false, "score": 0, "creation_date": 1441211874, "post_id": 32357713, "comment_id": 52590016, "body": "@user3142625 What? Could you clarify? Your comment seems to be unclear for me."}, {"owner": {"reputation": 9174, "user_id": 4248342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMjPU.jpg?s=128&g=1", "display_name": "Hardik Modha", "link": "https://stackoverflow.com/users/4248342/hardik-modha"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1441211980, "post_id": 32357713, "comment_id": 52590074, "body": "@CoolGuy Yes..We should avoid it. I was just making clear that we can use <code>&amp;</code> also. (see my answer I haven&#39;t used it! ;) )"}, {"owner": {"reputation": 631, "user_id": 3142625, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/O1tDP.jpg?s=128&g=1", "display_name": "Coder123", "link": "https://stackoverflow.com/users/3142625/coder123"}, "edited": false, "score": 0, "creation_date": 1441212951, "post_id": 32357713, "comment_id": 52590629, "body": "hmm dbush wrote &quot;Never fflush(stdin). It&#39;s undefined behavior.&quot; i do not understand why :("}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 631, "user_id": 3142625, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/O1tDP.jpg?s=128&g=1", "display_name": "Coder123", "link": "https://stackoverflow.com/users/3142625/coder123"}, "edited": false, "score": 0, "creation_date": 1441213222, "post_id": 32357713, "comment_id": 52590810, "body": "@user3142625 The leading space in each <code>scanf</code> format string matches zero or more whitespace characters, so any newlines or spaces are skipped over.  Also, from the <code>fflush</code> manpage: &quot;The function fflush()  forces a write of all user-space buffered data for the given <i>output or update stream</i> via the stream\u2019s underlying write function.&quot;  <code>stdin</code> is not an output or update stream."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1441209173, "creation_date": 1441209173, "answer_id": 32357713, "question_id": 32357476, "link": "https://stackoverflow.com/questions/32357476/creating-an-array-of-struct-c/32357713#32357713", "title": "Creating an array of struct (c)", "body": "<p>There are several errors here:</p>\n\n<ul>\n<li><code>Employee</code> is not a valid type.  <code>struct Employee</code> is, and so is <code>employee_s</code>.</li>\n<li><code>e</code> is defined in multiple places</li>\n<li>When reading in <code>name</code>, use <code>%s</code> (for a string), not <code>%c</code> (for a char)</li>\n<li>Your employee array is defined as an array of pointers.  That's probably not what you want.  You just need an array.  No call to <code>malloc</code> either.</li>\n<li>Never <code>fflush(stdin)</code>.  It's undefined behavior.</li>\n<li>In your <code>scanf</code> calls, put a space as the first character in the string.  That will allow any newlines to be passed over.</li>\n</ul>\n\n<p>The result:</p>\n\n<pre><code>int main()\n{\n    int i;\n    employee_s e[3];\n\n    for(i=0; i &lt; 3; i++)\n    {\n        puts(\"Please enter Employee's name:\");\n        scanf(\" %s\",&amp;e[i].name);\n\n        puts(\"Please enter Employee's salary:\");\n        scanf(\" %d\",&amp;e[i].s);\n\n        puts(\"Please enter Employee's experience:\");\n        scanf(\" %d\",&amp;e[i].e);\n    }\n\n    for(i=0; i &lt; 3; i++) {\n        printf(\"emp %d: name=%s, sal=%d, exp=%d\\n\", i, e[i].name, e[i].s, e[i].e);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1441212258, "post_id": 32357819, "comment_id": 52590219, "body": "<code>char name[10];</code> is unused. So, Remove it"}], "tags": [], "owner": {"reputation": 9174, "user_id": 4248342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMjPU.jpg?s=128&g=1", "display_name": "Hardik Modha", "link": "https://stackoverflow.com/users/4248342/hardik-modha"}, "is_accepted": false, "score": 1, "last_activity_date": 1441212528, "last_edit_date": 1441212528, "creation_date": 1441209454, "answer_id": 32357819, "question_id": 32357476, "link": "https://stackoverflow.com/questions/32357476/creating-an-array-of-struct-c/32357819#32357819", "title": "Creating an array of struct (c)", "body": "<p>You can do this easily without dynamic memory allocation as follows.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAX_SIZE 20\ntypedef struct Employee{\n    char name[MAX_SIZE];\n    int s;\n    int e;\n} employee_alias;\nint main(void) {\n    int i;\n    employee_alias e[3];\n    for(i=0; i &lt; 3; i++)\n    {\n        puts(\"Please enter Employee's name:\");\n        scanf(\"%s\",e[i].name);\n        puts(\"Please enter Employee's salary:\");\n        scanf(\"%d\",&amp;e[i].s);\n        puts(\"Please enter Employee's experience:\");\n        scanf(\"%d\",&amp;e[i].e);\n\n        printf(\"Entered Data\\n\");\n        printf(\"Name : %s\\n\",e[i].name);\n        printf(\"Salary : %d\\n\",e[i].s);\n        printf(\"Experience : %d\\n\",e[i].e);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 631, "user_id": 3142625, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/O1tDP.jpg?s=128&g=1", "display_name": "Coder123", "link": "https://stackoverflow.com/users/3142625/coder123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 32357713, "answer_count": 3, "score": 0, "last_activity_date": 1441212528, "creation_date": 1441208445, "question_id": 32357476, "link": "https://stackoverflow.com/questions/32357476/creating-an-array-of-struct-c", "title": "Creating an array of struct (c)", "body": "<p>i've created a struct \"Employee\"</p>\n\n<pre><code>#define MAX_SIZE 20\n\ntypedef struct Employee{\n    char name[MAX_SIZE];\n    int s;\n    int e;\n} employee_s;\n</code></pre>\n\n<p>and i need to create an array of 2 employees and ask the user to initialize them, nothing i try seem to work,</p>\n\n<pre><code>void main()\n{\n    int i, s, e;\n    char name[10];\n    Employee* e[3];\n\n    *e = (Employee*)malloc(sizeof(Employee)*ARR_SIZE);\n\n    for(i=0; i &lt; 3; i++)\n    {\n        fflush(stdin);\n        puts(\"Please enter Employee's name:\");\n        scanf(\"%c\",&amp;name);\n        *e[i]-&gt;name = name;\n\n        puts(\"Please enter Employee's salary:\");\n        scanf(\"%d\",&amp;s);\n       *e[i]-&gt;s= s;\n\n        puts(\"Please enter Employee's experience:\");\n        scanf(\"%d\",&amp;e);\n       *e[i]-&gt;e=e;\n\n    }\n}\n</code></pre>\n\n<p>p.s: i dont have to use dynamic allocation, <br>\nwhat do i do wrong?</p>\n\n<p>thank you!</p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 3, "creation_date": 1441208293, "post_id": 32357328, "comment_id": 52587831, "body": "I&#39;m sure someone will give you more details in an answer, but the +0, +1, +14, and +15 are the standard function setup (prolog and epilog) on Intel, that set up a stack frame."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1441208414, "post_id": 32357328, "comment_id": 52587918, "body": "I suggest you do some reading on x86 assembly language. You can&#39;t expect to learn the basics by asking a question about every single assembly line you see."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1441208490, "post_id": 32357328, "comment_id": 52587971, "body": "Moreover, do be aware that there is no specified association between C code and any particular assembly or machine code.  That&#39;s <i>entirely</i> up to the chosen C implementation."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1441208524, "post_id": 32357328, "comment_id": 52587996, "body": "<a href=\"http://stackoverflow.com/q/204476/995714\"><code>main()</code> is wrong</a>, and <a href=\"http://stackoverflow.com/q/7423691/995714\"><code>gets()</code> is deprecated</a>"}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 0, "creation_date": 1441208543, "post_id": 32357328, "comment_id": 52588008, "body": "To add to what Max said: the instructions you see here are the saving of the location to return to, the loading of the location to move to where the function&#39;s code is; and the reverse of the same. i.e. it&#39;s the application of the calling convention."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1441208594, "post_id": 32357328, "comment_id": 52588038, "body": "literals with <code>$</code> prefix are constants, not address"}, {"owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1441208679, "post_id": 32357328, "comment_id": 52588088, "body": "@L\u01b0uV\u0129nhPh&#250;c This is not really the point of the question, I feel... OP wants to understand how precisely the exploit works; The name of the function <code>exploitableFunction()</code> is a dead giveaway that OP is aware of how grossly bad <code>gets()</code> is."}, {"owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "edited": false, "score": 2, "creation_date": 1441208807, "post_id": 32357328, "comment_id": 52588161, "body": "Also, see <a href=\"http://stackoverflow.com/questions/1395591/what-is-exactly-the-base-pointer-and-stack-pointer-to-what-do-they-point\" title=\"what is exactly the base pointer and stack pointer to what do they point\">stackoverflow.com/questions/1395591/&hellip;</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1441208848, "post_id": 32357328, "comment_id": 52588184, "body": "<code>push rbp; mov rbp, rsp</code> is the function prolog <a href=\"http://stackoverflow.com/q/14296088/995714\">stackoverflow.com/q/14296088/995714</a>"}, {"owner": {"reputation": 76689, "user_id": 240733, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/0b55ab48c85a40ac1960c1fc4d5e2f99?s=128&d=identicon&r=PG&f=1", "display_name": "stakx - no longer contributing", "link": "https://stackoverflow.com/users/240733/stakx-no-longer-contributing"}, "edited": false, "score": 1, "creation_date": 1441211009, "post_id": 32357328, "comment_id": 52589510, "body": "You appear to be asking about <a href=\"https://en.m.wikipedia.org/wiki/X86_calling_conventions\" rel=\"nofollow noreferrer\">calling conventions (cdecl, stdcall, etc.)</a>; you should find lots of articles on the &#39;net if you search for any of these terms."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1441240781, "post_id": 32357328, "comment_id": 52602922, "body": "Note that some compilers (like Microsoft) have an option to turn off frame pointers, eliminating the rbp / rsp stuff. Function parameters would be accessed via rsp instead of rbp."}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1441208937, "post_id": 32357596, "comment_id": 52588237, "body": "<a href=\"http://meta.stackexchange.com/q/8231/230282\">link only answers are discouraged</a>, as they will have no meaning when the link dies"}, {"owner": {"reputation": 90284, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "edited": false, "score": 0, "creation_date": 1441210193, "post_id": 32357596, "comment_id": 52589049, "body": "Although Link answers are discouraged, I&#39;m not sure why this got downvoted. The link was quite helpful so far (and I&#39;m not done with reading it by now). +1."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1441218385, "post_id": 32357596, "comment_id": 52593807, "body": "<code>%rbp</code> is pushed because it is the caller&#39;s stack-frame pointer, and the caller needs it upon return."}], "tags": [], "owner": {"reputation": 2078, "user_id": 4849973, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/908850892e643b32e894b01691590010?s=128&d=identicon&r=PG&f=1", "display_name": "Nasr", "link": "https://stackoverflow.com/users/4849973/nasr"}, "is_accepted": false, "score": 1, "last_activity_date": 1441210047, "last_edit_date": 1441210047, "creation_date": 1441208855, "answer_id": 32357596, "question_id": 32357328, "link": "https://stackoverflow.com/questions/32357328/what-exactly-happens-in-this-minimalistic-c-code-on-assembly-level/32357596#32357596", "title": "What exactly happens in this minimalistic C code on assembly level?", "body": "<p>I found a <a href=\"https://www.recurse.com/blog/7-understanding-c-by-learning-assembly\" rel=\"nofollow\">Link</a> which have similar code to your own with full explenation.</p>\n\n<ul>\n<li>40063b: push the old base pointer onto the stack to save it for later. It's pushed because this is not the only process in the code. some other process call it.</li>\n<li>40063c: copy the value of the stack pointer to the base pointer. After this, <code>%rbp</code> points to the base of <code>main</code>\u2019s stack frame.</li>\n<li>40063f: call the function in address <code>0x4005f6</code> which push the program counter into stack and load address <code>0x4005f6</code> into program conter, when the function returns, pop operation is happened to return the saved address in the stack to program counter which is <code>0x400644</code> here</li>\n<li>400644: This instruction copies <code>0</code> into <code>%eax</code>, The x86 calling convention dictates that a function\u2019s return value is stored in <code>%eax</code></li>\n<li>400649: We pop the old base pointer off the stack and store it back in <code>%rbp</code></li>\n<li>40064a: jumps back to return address, which is also stored in the stack frame. which specify the end of the program.</li>\n</ul>\n\n<p>Also you didn't mention the assembly code for the function <code>exploitableFunction</code>. here is only <code>main</code> function</p>\n"}, {"comments": [{"owner": {"reputation": 90284, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "edited": false, "score": 0, "creation_date": 1441209369, "post_id": 32357736, "comment_id": 52588498, "body": "&quot;You want to save the base pointer because it is probably used by the calling function.&quot; - what is the calling function of <code>main</code>? Or is that simply done because it is simpler not to treat <code>main</code> different from other functions?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 90284, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "edited": false, "score": 2, "creation_date": 1441209543, "post_id": 32357736, "comment_id": 52588623, "body": "@moose The <code>main</code> function in C is a function as all others, the only special property is that is called from CRT (C RunTime) at very start of user code. The CRT is where the OS starts the execution of your code. The whole sequence is standard and it&#39;s called prologue, it together with the epilogue, that is the reverse sequence actuated before to leave the function, define a standard <code>stack-frame</code>. For more info you can google."}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 2, "last_activity_date": 1441209241, "creation_date": 1441209241, "answer_id": 32357736, "question_id": 32357328, "link": "https://stackoverflow.com/questions/32357328/what-exactly-happens-in-this-minimalistic-c-code-on-assembly-level/32357736#32357736", "title": "What exactly happens in this minimalistic C code on assembly level?", "body": "<blockquote>\n  <p>40063b: Put the address which is currently in the base pointer register into the stack segment (How is this register initialized? Why is that done?)</p>\n</blockquote>\n\n<p>You want to save the base pointer because it is probably used by the calling function.</p>\n\n<blockquote>\n  <p>40063c: Copy the value from the stack pointer register into the base pointer register (why?)</p>\n</blockquote>\n\n<p>This gives you a fixed position into the stack, which might contain parameters for the function. It can also be used as a base address for any local variables.</p>\n\n<blockquote>\n  <p>40063f: Call exploitableFunction (What exactly does it mean to \"call\" a function in assembly? What happens here?)</p>\n</blockquote>\n\n<p>\"call\" means pushing the return address (address of the next instruction) onto the stack, and then jumping to the start of the called function.</p>\n\n<blockquote>\n  <p>400644: Copy the value from the address $0x0 to the EAX register</p>\n</blockquote>\n\n<p>It is actually the value 0 from the return statement.</p>\n\n<blockquote>\n  <p>400649: Copy the value from the top of the stack (determined by the value in %rsp) into the base pointer register (seems to be confirmed by Assembler: Push / pop registers?)</p>\n</blockquote>\n\n<p>This restores the base pointer we saved at the top. The calling function might assume that we do.</p>\n\n<blockquote>\n  <p>40064a: Return (the OS uses what is in %EAX as return code - so I guess the address $0x0 contains the constant 0? Or is that not an address but the constant?)</p>\n</blockquote>\n\n<p>It was the constant from <code>return 0</code>. Using EAX for a small return value is a common convention.</p>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1441218499, "last_edit_date": 1441218499, "creation_date": 1441216679, "answer_id": 32360074, "question_id": 32357328, "link": "https://stackoverflow.com/questions/32357328/what-exactly-happens-in-this-minimalistic-c-code-on-assembly-level/32360074#32360074", "title": "What exactly happens in this minimalistic C code on assembly level?", "body": "<p>The function entry saves bp and moves sp into bp. All parameters of the function will now be addressed using bp. This is a standard cdecl convention (in Intel assembler):</p>\n\n<pre><code>; int example(char *s, int i)\n    push        bp                    ; save the caller's value of bp\n    mov         bp,sp                 ; set-up our base pointer to the stack-frame\n    sub         sp, 16                ; room for automatic variables\n    mov         ax,dword ptr [bp+8]   ; ax has *s\n    mov         bx,dword ptr [bp+12]  ; bx has i\n    ...                               ; do your thing\n    mov         ax, dword ptr[result] ; function return in ax\n    pop         bp                    ; restore caller's base-pointer\n    ret\n</code></pre>\n\n<p>When calling this function, the compiler pushes the parameters onto the stack and then calls the function. Upon return, it cleans up the stack:</p>\n\n<pre><code>; i= example(myString, k);\n    mov         ax, [bp+16]        ; this gets a parameter of the curent function\n    push        ax                 ; this will be parameter i\n    mov         ax, [bp-16]        ; this gets a local variable\n    push        ax                 ; this is parameter s\n    call        example\n    add         sp,8               ; remove the pushed parameters from the stack\n    mov         dword ptr [i], ax  ; save return value - always in ax\n</code></pre>\n\n<p>Different compilers can use different conventions about passing parameters in registers, but I think the above is the basics of calls in C (using cdecl).</p>\n"}], "owner": {"reputation": 90284, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1441218499, "creation_date": 1441207998, "last_edit_date": 1495542254, "question_id": 32357328, "link": "https://stackoverflow.com/questions/32357328/what-exactly-happens-in-this-minimalistic-c-code-on-assembly-level", "title": "What exactly happens in this minimalistic C code on assembly level?", "body": "<p>I am currently trying to understand <a href=\"http://www.eecis.udel.edu/~bmiller/cis459/2007s/readings/buff-overflow.html\" rel=\"nofollow noreferrer\">Writing buffer overflow exploits - a tutorial for beginners</a>.</p>\n\n<p>The C code, compiled with <code>cc -ggdb exploitable.c -o exploitable</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid exploitableFunction (void) {\n    char small[30];\n    gets (small);\n    printf(\"%s\\n\", small);\n}\n\nmain() {\n    exploitableFunction();\n    return 0;\n}\n</code></pre>\n\n<p>seems to have the assembly code</p>\n\n<pre><code>0x000000000040063b &lt;+0&gt;:    push   %rbp\n0x000000000040063c &lt;+1&gt;:    mov    %rsp,%rbp\n0x000000000040063f &lt;+4&gt;:    callq  0x4005f6 &lt;exploitableFunction&gt;\n0x0000000000400644 &lt;+9&gt;:    mov    $0x0,%eax\n0x0000000000400649 &lt;+14&gt;:   pop    %rbp\n0x000000000040064a &lt;+15&gt;:   retq\n</code></pre>\n\n<p>I think it does the following, but I'm really not sure about it and I would like to hear from somebody who is experienced with assembly code if I'm right / what is right.</p>\n\n<ul>\n<li>40063b: Put the address which is currently in the base pointer register into the stack segment (How is this register initialized? Why is that done?)</li>\n<li>40063c: Copy the value from the stack pointer register into the base pointer register (why?)</li>\n<li>40063f: Call exploitableFunction (What exactly does it mean to \"call\" a function in assembly? What happens here?)</li>\n<li>400644: Copy the value from the address $0x0 to the EAX register</li>\n<li>400649: Copy the value from the top of the stack (determined by the value in %rsp) into the base pointer register (seems to be confirmed by <a href=\"https://stackoverflow.com/q/4584089/562769\">Assembler: Push / pop registers?</a>)</li>\n<li>40064a: Return (the OS uses what is in %EAX as return code - so I guess the address $0x0 contains the constant 0? Or is that not an address but the constant?)</li>\n</ul>\n"}, {"tags": ["c", "r", "word2vec"], "owner": {"reputation": 3999, "user_id": 2890590, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/exhvi.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/2890590/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1441207732, "creation_date": 1441207732, "question_id": 32357251, "link": "https://stackoverflow.com/questions/32357251/turn-c-code-intended-to-be-compiled-into-r-function", "title": "Turn C code intended to be compiled into R function", "body": "<p>I'm trying to learn how to leverage C code in R functions, specifically because I want to be able to use <a href=\"https://code.google.com/p/word2vec/\" rel=\"nofollow\">word2vec</a> in R.  word2vec is available as C code and, on a linux box, I can use <code>make</code> to compile it and then <code>./word2vec -options</code> to build the model and do fun things with it.  I would like to take the C code, as is, and essentially wrap it into an R function so I could call, <code>word2vec(words)</code> and have it return the calculated matrix.</p>\n\n<p>So, is there a way to include C code which is written to be compiled into an executable or alternatively, just call the compiled executable?</p>\n"}, {"tags": ["c", "validation", "input", "character", "ncurses"], "comments": [{"owner": {"reputation": 183, "user_id": 5036660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/63f06149f343389d067d2d93ce2a8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "Xcrowzz", "link": "https://stackoverflow.com/users/5036660/xcrowzz"}, "edited": false, "score": 0, "creation_date": 1441208129, "post_id": 32357244, "comment_id": 52587703, "body": "No code to show ? No output ?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1441360053, "post_id": 32357244, "comment_id": 52658448, "body": "just prepend <code>endwin();</code> before <code>exit(0);</code> in your code for <code>&#39;c&#39;</code>  char, so you wont get your output screen blurred.  Or do it with an <code>atexit(3)</code> call."}], "answers": [{"tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 0, "last_activity_date": 1441361070, "last_edit_date": 1441361070, "creation_date": 1441268975, "answer_id": 32370670, "question_id": 32357244, "link": "https://stackoverflow.com/questions/32357244/c-programming-ncurses-input-validate/32370670#32370670", "title": "C programming ncurses input validate", "body": "<p>You could try something like this.</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n\nint main()\n{\n    char choice = 0;\n    int player_number = -1;\n\n    initscr ( );\n    do {\n        mvprintw ( 1, 1,\"a. New name\");\n        mvprintw ( 2, 1,\"b. Input number\");\n        mvprintw ( 3, 1,\"c. Exit\");\n        mvprintw ( 4, 1,\" \");\n        if (( scanw(\"%c\", &amp;choice)) == 1) {//scanw succeeded\n            if ( ! ( choice == 'a' || choice == 'b' || choice == 'c')) {\n                mvprintw ( 5, 1,\"invalid input, should be a, b or c\");\n            }\n            else {\n                mvprintw ( 5, 1,\"                                  \");\n            }\n        }\n    } while ( ! ( choice == 'c' || choice == 'b'));\n    mvprintw ( 5, 1,\"                                  \");\n    if ( choice == 'b') {\n        do {\n            mvprintw ( 7, 1,\"Enter number 0-9\");\n            mvprintw ( 8, 1,\" \");\n            if (( scanw(\"%d\", &amp;player_number)) == 1) {//scanw succeeded\n                if ( player_number &lt; 0 || player_number &gt; 9) {\n                    mvprintw ( 9, 1,\"invalid input, should be 0-9\");\n                }\n            }\n            else {//scanw failed\n                mvprintw ( 9, 1,\"invalid input, should be 0-9\");\n            }\n        } while ( player_number &lt; 0 || player_number &gt; 9);\n\n    }\n    endwin ( );\n    return 0;\n}\n</code></pre>\n\n<p>Using a char array to contain input and <code>getnstr()</code> to read the input, it is possible to detect an input of <code>q</code> to quit the program. For numeric input, <code>strtol()</code> is used to convert the array to an int. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ncurses.h&gt;\n\nint main()\n{\n    char choice = 0;\n    char instr[128] = {0};\n    int player_number = -1;\n\n    initscr ( );\n    do {\n        mvprintw ( 1, 1,\"a. New name\");\n        mvprintw ( 2, 1,\"b. Input number\");\n        mvprintw ( 3, 1,\"c. Exit\");\n        mvprintw ( 4, 1,\" \");\n        if (( getnstr( instr, 1)) != ERR) {//succeeded\n            choice = instr[0];\n            if ( ! ( choice == 'a' || choice == 'b' || choice == 'c')) {\n                mvprintw ( 5, 1,\"invalid input, should be a, b or c\");\n                if ( choice == 'q') {//quit when q is entered\n                    endwin ( );\n                    return 0;\n                }\n            }\n            else {\n                mvprintw ( 5, 1,\"                                  \");\n            }\n        }\n    } while ( ! ( choice == 'c' || choice == 'b'));\n    mvprintw ( 5, 1,\"                                  \");\n    if ( choice == 'b') {\n        do {\n            mvprintw ( 7, 1,\"Enter number 0-9\");\n            mvprintw ( 8, 1,\" \");\n            if (( getnstr( instr, sizeof ( instr))) != ERR) {//succeeded\n                if ( instr[0] == 'q' &amp;&amp; instr[1] == '\\0') {//quit when q is entered\n                    endwin ( );\n                    return 0;\n                }\n                player_number = strtol ( instr, NULL, 10);\n                if ( player_number &lt; 0 || player_number &gt; 9) {\n                    mvprintw ( 9, 1,\"invalid input, should be 0-9\");\n                }\n            }\n            else {//failed\n                mvprintw ( 9, 1,\"invalid input, should be 0-9\");\n            }\n        } while ( player_number &lt; 0 || player_number &gt; 9);\n    }\n    endwin ( );\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 66, "user_id": 3820577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3054b8de4906c095746b192aa7fa3d?s=128&d=identicon&r=PG&f=1", "display_name": "chuongpham", "link": "https://stackoverflow.com/users/3820577/chuongpham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 32370670, "answer_count": 1, "score": 0, "last_activity_date": 1441361070, "creation_date": 1441207715, "last_edit_date": 1441291449, "question_id": 32357244, "link": "https://stackoverflow.com/questions/32357244/c-programming-ncurses-input-validate", "title": "C programming ncurses input validate", "body": "<p>I am doing a small project using ncurses and writing in C. Two problems come across me which are about validate input. \nFor example, case 1: I want to validate that input is a specified specific character e.g: a or b or c. </p>\n\n<pre><code>char choice;\nprintw(\"a. New name\\n\");\nprintw(\"b. Edit name\\n\");\nprintw(\"c. Exit\\n\");\n\nscanw(\"%c\", &amp;choice);\n\nif (choice == 'a')\n    //Do something\nelse if(choice =='b') {\n   //Do something\n}\nelse if(choice == 'c') {\n    exit(0);\n}    \n</code></pre>\n\n<p>Case 2: I want to validate input only within a range of integer numbers e.g: 1 to 5.</p>\n\n<pre><code>int player_number\nprintw(\"How many players ? (1 - 5): \");\nscanw(\"%i\", &amp;player_number);    \n</code></pre>\n\n<p>It's ironical I can find a solution to both of these 2 problem out of ncurses context. Plus, how can I quit my program with keystroke like 'q' whenever it prompts user input.\nThank you</p>\n"}, {"tags": ["c", "pointers", "syntax"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1441207046, "post_id": 32356957, "comment_id": 52586944, "body": "Please tyke the <a href=\"https://stackoverflow.com/tour\">tour</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You might also want to read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 3861548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G89Hn.jpg?s=128&g=1", "display_name": "jabujavi", "link": "https://stackoverflow.com/users/3861548/jabujavi"}, "edited": false, "score": 0, "creation_date": 1441207439, "post_id": 32357031, "comment_id": 52587226, "body": "In second example, &#180;b&#180; could be &#180;unsigned short b;&#180;, isn&#39;t? I think it compiles depending on C implementation... &#191;?"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 478, "user_id": 3861548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G89Hn.jpg?s=128&g=1", "display_name": "jabujavi", "link": "https://stackoverflow.com/users/3861548/jabujavi"}, "edited": false, "score": 1, "creation_date": 1441208276, "post_id": 32357031, "comment_id": 52587814, "body": "@jabujavi: Problem isn&#39;t the <code>&amp;b</code> cast to <code>unsigned short*</code> (well, it is, but it wouldn&#39;t be a compile-time error). The problem is calling a function that takes an <code>unsigned char*</code> parameter, with an <code>unsigned short*</code> argument."}, {"owner": {"reputation": 21, "user_id": 1756845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1550b007dd667786834819fbb2cd10?s=128&d=identicon&r=PG", "display_name": "user1756845", "link": "https://stackoverflow.com/users/1756845/user1756845"}, "edited": false, "score": 0, "creation_date": 1441212353, "post_id": 32357031, "comment_id": 52590265, "body": "@unwind .... Ya I thought the compiler should throw an error too but I I donot misremember it"}, {"owner": {"reputation": 21, "user_id": 1756845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1550b007dd667786834819fbb2cd10?s=128&d=identicon&r=PG", "display_name": "user1756845", "link": "https://stackoverflow.com/users/1756845/user1756845"}, "edited": false, "score": 0, "creation_date": 1441212686, "post_id": 32357031, "comment_id": 52590468, "body": "@unwind .... Ya I thought the compiler should throw an error too but I I donot misremember it     function definition: int func(unsigned char *ptr) and it is used as func((unsigned short *)&amp;a), where a is defined as a &quot;short&quot;. I assure you it compiles and works as this piece of code runs on a machine out in the field from last 15 years... As far as the use goes , when parsed a short type pointer does the definition typecast it to a char type pointer??"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1441215009, "post_id": 32357031, "comment_id": 52591960, "body": "since pointers to character type are allowed to access objects of any type, the second example is not necessarily undefined."}, {"owner": {"reputation": 21, "user_id": 1756845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1550b007dd667786834819fbb2cd10?s=128&d=identicon&r=PG", "display_name": "user1756845", "link": "https://stackoverflow.com/users/1756845/user1756845"}, "edited": false, "score": 0, "creation_date": 1441216409, "post_id": 32357031, "comment_id": 52592735, "body": "True , so a pointer of type char can hold a short...Its going to be all fine as long as we are dealing with references and not the actual value it is pointing to. But once we try to dereference that particular address, the program would give some kind of segmentation fault as on dereferencing a &quot;ptr&quot; it would be expecting a value which would fit in 1 byte of data but we have a value which would be needing 2 bytes of data................Is my logic sound about this????"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1441207123, "creation_date": 1441207123, "answer_id": 32357031, "question_id": 32356957, "link": "https://stackoverflow.com/questions/32356957/syntax-understanding-in-c-pointers/32357031#32357031", "title": "Syntax understanding in C: Pointers", "body": "<p>The first one simply casts <code>(a)</code> into a pointer to an unsigned 8-bit integer, then writes the result of evaluating <code>(b)</code> to the resulting address (as an 8-bit number).</p>\n\n<p>The second one isn't valid, it shouldn't compile. Perhaps you mis-remember, it's a bit sketchy-looking.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 1756845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1550b007dd667786834819fbb2cd10?s=128&d=identicon&r=PG", "display_name": "user1756845", "link": "https://stackoverflow.com/users/1756845/user1756845"}, "edited": false, "score": 0, "creation_date": 1441212824, "post_id": 32357514, "comment_id": 52590551, "body": "Thanks, I remember reading the right hand side rule from my school and that&#39;s how I read things if I donot understand, but the use of brackets always throws me off.. for instance in 1. I start from a go right see a bracket close and then I start moving left there is a bracket again arount uint8, how do you interpret that??"}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "reply_to_user": {"reputation": 21, "user_id": 1756845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1550b007dd667786834819fbb2cd10?s=128&d=identicon&r=PG", "display_name": "user1756845", "link": "https://stackoverflow.com/users/1756845/user1756845"}, "edited": false, "score": 0, "creation_date": 1441214157, "post_id": 32357514, "comment_id": 52591475, "body": "Well think of brackets like their own little worlds. You do everything inside the bracket first and then move one. For example if you   have int[] * a (int *). You would start with a then move right to the (int *). When you see () after the name it means that it is function taking in a parameter. So here we have a as a function taking in a pointer to an int as a parameter. After this you can&#39;t go right anymore so you go left to the *. So we get a is a function that takes in a pointer to an int as a parameter returning a pointer to... You can&#39;t go left so you go right again to the [] so we have"}, {"owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "reply_to_user": {"reputation": 21, "user_id": 1756845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1550b007dd667786834819fbb2cd10?s=128&d=identicon&r=PG", "display_name": "user1756845", "link": "https://stackoverflow.com/users/1756845/user1756845"}, "edited": false, "score": 0, "creation_date": 1441214361, "post_id": 32357514, "comment_id": 52591592, "body": "a as a function taking in a pointer to an int as a parameter returning a pointer to an array of.... Once more you can&#39;t go right since you already went right so you go left leading you to the &quot;int&quot; which leaves us with our final answer  &quot;a is a function taking in a pointer to an int as a parameter returning a pointer to an array of ints&quot;. I am probabally not to great at explaining this so read the link in the post which is pretty clear about it. Also check out this website which translates C declarations to English <a href=\"http://cdecl.org/\" rel=\"nofollow noreferrer\">cdecl.org</a>"}], "tags": [], "owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "is_accepted": true, "score": 0, "last_activity_date": 1441208561, "creation_date": 1441208561, "answer_id": 32357514, "question_id": 32356957, "link": "https://stackoverflow.com/questions/32356957/syntax-understanding-in-c-pointers/32357514#32357514", "title": "Syntax understanding in C: Pointers", "body": "<p>To understand what definitions mean in C take a look at the right-left rule, it's very simple and explains a lot <a href=\"http://ieng9.ucsd.edu/~cs30x/rt_lt.rule.html\" rel=\"nofollow\">http://ieng9.ucsd.edu/~cs30x/rt_lt.rule.html</a>. What it basically means is that you start out with the name and move right building up the definition then move left only when you can't move right. This might sound weird but let's take an example with number 1. </p>\n\n<ol>\n<li><p>*(uint8 *) (a) = (b)</p>\n\n<p>So step 1 what is a? Start with the name of the variable which in this case is a. Then look to see what is defined to the right of that, here it is nothing, so move to the part immediately to the right, which is (uint8 <em>). Which means that a is a pointer to a uint8. Ok now move right from the uint8</em> and you get back to a so that means you can't move right anymore, so go right then which gets you *, which is the dereferencing a. So for this line the uint8 stored at the address a is set to the value of b. </p></li>\n<li><p>Ok for the second part I think the <code>func((unsigned short *) &amp;b)</code> is where they begin defining the function body? If that is case then that means for the function body the passed in parameter is used as a pointer to an unsigned short, but if the function is called like this I think the compiler wouldn't be happy because of the type mismatch since the function is expecting an <code>unsigned char *</code> not an <code>unsigned short *</code>. </p></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 1756845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1550b007dd667786834819fbb2cd10?s=128&d=identicon&r=PG", "display_name": "user1756845", "link": "https://stackoverflow.com/users/1756845/user1756845"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 32357514, "answer_count": 2, "score": 0, "last_activity_date": 1441208561, "creation_date": 1441206926, "last_edit_date": 1441207460, "question_id": 32356957, "link": "https://stackoverflow.com/questions/32356957/syntax-understanding-in-c-pointers", "title": "Syntax understanding in C: Pointers", "body": "<p>I have medium knowledge working with pointers. Some of the syntax styles baffles me.</p>\n\n<p>Like:</p>\n\n<ol>\n<li><code>*(uint8 *) (a) = (b)</code></li>\n<li>typecasting the reference when parsing it in a function. The  function is prototyped as <code>func(unsigned char * a);</code> but it is used as <code>func((unsigned short *) &amp;b);</code> .... As far I understand they were casting a expected char type pointer into a short. </li>\n</ol>\n\n<p>Can anyone help me understand what these statements exactly mean in C?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18507, "user_id": 13317, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/47a9a5b4589057085336011863d2ee9a?s=128&d=identicon&r=PG", "display_name": "Kenster", "link": "https://stackoverflow.com/users/13317/kenster"}, "edited": false, "score": 0, "creation_date": 1441207038, "post_id": 32356945, "comment_id": 52586936, "body": "Please edit your question to contain the code that doesn&#39;t work, instead of the code that does work."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1441207124, "post_id": 32356945, "comment_id": 52586995, "body": "Your code isn&#39;t using <code>local_time_r</code> at all!"}, {"owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1441207290, "post_id": 32356945, "comment_id": 52587112, "body": "@Kerrek SB sorry it was a typo"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1441207684, "post_id": 32356945, "comment_id": 52587378, "body": "Please edit your post also for your typos. Then, this is a good opportunity to learn how to use a debugger. He will tell you where your code segfaults and why."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441209075, "post_id": 32356945, "comment_id": 52588322, "body": "Many compilers, when properly enabled, will provide useful warnings concerning incorrect function usage.  You can save time by insuring these warnings are enabled 1st and posting on SO 2nd."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1441207687, "creation_date": 1441207687, "answer_id": 32357233, "question_id": 32356945, "link": "https://stackoverflow.com/questions/32356945/using-thread-safe-local-time-r/32357233#32357233", "title": "using thread safe local_time_r", "body": "<p>The signature of <code>localtime_r</code> is as follows:</p>\n\n<pre><code>struct tm *localtime_r(const time_t *timep, struct tm *result);\n</code></pre>\n\n<p>You need to pass it the address of a <code>struct tm</code>.  You don't want to pass <code>info</code> since it doesn't point anywhere, so change it to a non-pointer and pass its address.</p>\n\n<pre><code>time_t rawtime = 1441194527;\nstruct tm info;   // not a pointer\nchar buffer[80];\n\ntime( &amp;rawtime );\n\nlocaltime_r( &amp;rawtime, &amp;info );   // added parameter\n\nstrftime(buffer,80,\"%Y-%m-%d %X\", &amp;info);   // changed parameter\nprintf(\"Formatted date &amp; time : |%s|\\n\", buffer );\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 32357233, "answer_count": 1, "score": -1, "last_activity_date": 1441207687, "creation_date": 1441206898, "last_edit_date": 1441207284, "question_id": 32356945, "link": "https://stackoverflow.com/questions/32356945/using-thread-safe-local-time-r", "title": "using thread safe local_time_r", "body": "<p>I have the following c code, I would like to use the local_time_r which is thread safe, I get Segmentation fault, I don't know why.</p>\n\n<pre><code>time_t rawtime = 1441194527;\n   struct tm *info;\n   char buffer[80];\n\n   time( &amp;rawtime );\n\n   info = localtime_r( &amp;rawtime );\n\n   strftime(buffer,80,\"%Y-%m-%d %X\", info);\n   printf(\"Formatted date &amp; time : |%s|\\n\", buffer );\n</code></pre>\n"}, {"tags": ["c", "arrays", "fgets"], "comments": [{"owner": {"reputation": 3595, "user_id": 1072647, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/weTJG.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/1072647/john"}, "edited": false, "score": 0, "creation_date": 1441206908, "post_id": 32356895, "comment_id": 52586838, "body": "Did you try running this through <code>gdb</code> or <code>valgrind</code>?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1441207071, "post_id": 32356895, "comment_id": 52586963, "body": "You have an array of <code>char*</code> (<code>oOne</code>), which is an array of pointers that have not been initialized. You need to allocate memory for them. You also need to double check what <code>sizeof *oOne</code> gives you."}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1441207272, "post_id": 32356895, "comment_id": 52587101, "body": "also, &quot;sizeof *oOne&quot; will return the size of the pointer (4 or 8 bytes), not the size of the buffer you pass in.  You need to pass the buffer size in as a parameter to the function."}], "answers": [{"comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1441207728, "post_id": 32357105, "comment_id": 52587415, "body": "<code>char *oOne[10];</code> is an array of pointers, not a pointer to an array. And <code>sizeof oOne</code> doesn&#39;t work here regardless of whether <code>oOne</code> was dynamically allocated or not."}, {"owner": {"reputation": 570, "user_id": 4959572, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2239309f5e549951012dbbeedc4cf811?s=128&d=identicon&r=PG&f=1", "display_name": "Derrick Rose", "link": "https://stackoverflow.com/users/4959572/derrick-rose"}, "edited": false, "score": 0, "creation_date": 1441208247, "post_id": 32357105, "comment_id": 52587788, "body": "Thanks for the explanation, +1 , I didn&#39;t know that about pointers, and arrays!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441217305, "post_id": 32357105, "comment_id": 52593230, "body": "&quot;A character string in C is of type pointer-to-character&quot; mis-leads in that a string is neither a pointer nor a type.  A C string is a character array ending with a null character."}], "tags": [], "owner": {"reputation": 191202, "user_id": 147356, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b9506717d24256a090524dd5505d3207?s=128&d=identicon&r=PG", "display_name": "larsks", "link": "https://stackoverflow.com/users/147356/larsks"}, "is_accepted": true, "score": 6, "last_activity_date": 1441207354, "creation_date": 1441207354, "answer_id": 32357105, "question_id": 32356895, "link": "https://stackoverflow.com/questions/32356895/segmentation-fault-using-fgets/32357105#32357105", "title": "Segmentation fault using fgets()", "body": "<p>A character string in C is of type pointer-to-character, e.g.,:</p>\n\n<pre><code>char *oOne;\n</code></pre>\n\n<p>Or an array-of-character, if you want to statically allocate your memory:</p>\n\n<pre><code>char oOne[10];\n</code></pre>\n\n<p>But <em>not</em> a pointer-to-array-of-character, which is what you have:</p>\n\n<pre><code>char *oOne[10];\n</code></pre>\n\n<p>You need:</p>\n\n<pre><code>char oOne[10];\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>one(oOne);\n</code></pre>\n\n<p>And then modify your <code>one</code> function with proper types:</p>\n\n<pre><code>char one(char *oOne)\n{\n    if (fgets(oOne, sizeof oOne, stdin) == NULL)\n    {\n            puts(\"EOF Occurred\");\n            return 1;\n    }\n\n    *(oOne + strcspn(oOne, \"\\n\")) = 0;\n\n    printf(\"%s\\n\", oOne);\n\n\n}\n</code></pre>\n\n<p>Although I would pass in an explicit length, rather than using\n<code>sizeof</code>, because this won't work with dynamically allocated strings:</p>\n\n<pre><code>car one(char *oOne, int len)\n{\n    if (fgets(oOne, len, stdin) == NULL)\n    {\n            puts(\"EOF Occurred\");\n            return 1;\n    }\n\n    // etc...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 5277929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5578040ae1a89eb0476b996f683f77?s=128&d=identicon&r=PG&f=1", "display_name": "Yashwanth", "link": "https://stackoverflow.com/users/5277929/yashwanth"}, "is_accepted": false, "score": 2, "last_activity_date": 1441207679, "creation_date": 1441207679, "answer_id": 32357230, "question_id": 32356895, "link": "https://stackoverflow.com/questions/32356895/segmentation-fault-using-fgets/32357230#32357230", "title": "Segmentation fault using fgets()", "body": "<p>I think you are getting a segfault because your are dereferencing oOne in <code>if (fgets(*oOne, sizeof *oOne, stdin) == NULL)</code>. Using the right left rule on <code>char *oOne[]</code> you get that oOne is an array of pointers to characters, so what you have is an array of Strings rather than a String. So to use fgets you want to have a single String in your case rather than an array of strings. So instead define oOne as <code>char oOne[BUFSIZ]</code>. This gives you a string that at max lets you take in bufsiz characters, which is the size of the buffer and you can't go over this. </p>\n\n<p>So to fix your code it would look something like this:</p>\n\n<p>change <code>char *oOne[10], oTwo[10], oThree[10]</code> to <code>char oOne[10], oTwo[10], oThree[10]</code></p>\n\n<p>change <code>char one(char *oOne[])</code> to <code>char one(char * oOne)</code></p>\n\n<p>change <code>fgets(*oOne, sizeof *oOne, stdin)</code> to <code>fgets(oOne, sizeof oOne, stdin)</code></p>\n\n<p>change <code>*oOne[strcspn(*oOne, \"\\n\")]</code> to <code>oOne[strcspn(oOne, \"\\n\")]</code></p>\n\n<p>This way you are interacting with oOne as a string (array of characters) rather than an array of character pointers. For more information on how defining variables in see works take a look at the right-left rule here <a href=\"http://ieng9.ucsd.edu/~cs30x/rt_lt.rule.html\" rel=\"nofollow\">http://ieng9.ucsd.edu/~cs30x/rt_lt.rule.html</a>. </p>\n"}], "owner": {"reputation": 570, "user_id": 4959572, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2239309f5e549951012dbbeedc4cf811?s=128&d=identicon&r=PG&f=1", "display_name": "Derrick Rose", "link": "https://stackoverflow.com/users/4959572/derrick-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3449, "favorite_count": 1, "accepted_answer_id": 32357105, "answer_count": 2, "score": 0, "last_activity_date": 1441212808, "creation_date": 1441206731, "last_edit_date": 1441212808, "question_id": 32356895, "link": "https://stackoverflow.com/questions/32356895/segmentation-fault-using-fgets", "title": "Segmentation fault using fgets()", "body": "<p>I am making a basic program, and decided to use functions, and pointers, in the first input I have the choice of typing either, \"kitchen\", or \"upstairs\", however when I use <code>fgets()</code> I am getting a segmentation fault, and have no idea why. I tried to print out the string to see if I was getting the correct output, of course due to the segmentation fault it's not happening.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nchar one(char *oOne[]);\nvoid two();\nvoid three();\n\nint main() {\n    char *oOne[10], oTwo[10], oThree[10]; // Options one, two, and three.\n    puts(\"WELCOME TO ASAD'S ADVENTURE\");\n    puts(\"\");\n    one(oOne);\n    return 0;\n}\n\nchar one(char *oOne[]) {\n    puts(\"You are in a creepy house! Would you like to go \\\"upstairs\\\", or into the \\\"kitchen\\\"?\");\n\n    printf(\"\\n&gt; \");\n\n    if (fgets(*oOne, sizeof *oOne, stdin) == NULL) { // Receiving the input from the user, and removing the \\n caused by fgets().\n        puts(\"EOF Occurred\");\n        return 1;\n    }\n\n    *oOne[strcspn(*oOne, \"\\n\")] = 0;\n    printf(\"%s\\n\", *oOne);\n    // puts(*oOne);\n}\n</code></pre>\n\n<p>Here is the output I am receiving:</p>\n\n<pre><code>WELCOME TO ASAD'S ADVENTURE\n\nYou are in a creepy house! Would you like to go \"upstairs\", or into the \"kitchen\"?\n\n&gt; kitchen\nSegmentation fault\n</code></pre>\n\n<p>How can I fix the segmentation fault?                                     </p>\n"}, {"tags": ["c", "linux", "ide", "intellisense"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1441206763, "post_id": 32356876, "comment_id": 52586732, "body": "Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it."}, {"owner": {"reputation": 52264, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441206841, "post_id": 32356876, "comment_id": 52586799, "body": "I have added what I have tried. You are so quick to reply. ;)"}, {"owner": {"reputation": 52264, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441207070, "post_id": 32356876, "comment_id": 52586962, "body": "@Olaf I did do a few searches. And seems KDevelop is promising. I posted this question while I am trying myself. And explain this to you."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441207117, "post_id": 32356876, "comment_id": 52586987, "body": "You should only ask if you are lost. This is not for parallel-processing."}], "answers": [{"comments": [{"owner": {"reputation": 52264, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 3, "creation_date": 1441207564, "post_id": 32357089, "comment_id": 52587301, "body": "I heard a joke that a programmer used vim for a very long time. Because he didn&#39;t know how to quit. ;)"}, {"owner": {"reputation": 52264, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "edited": false, "score": 1, "creation_date": 1441290414, "post_id": 32357089, "comment_id": 52627401, "body": "Another one: Q: How to generate a random string? A: Let a new programmer to quit vim."}], "tags": [], "owner": {"reputation": 380, "user_id": 4776786, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mUPI0.jpg?s=128&g=1", "display_name": "nanomader", "link": "https://stackoverflow.com/users/4776786/nanomader"}, "is_accepted": false, "score": 1, "last_activity_date": 1441207292, "last_edit_date": 1495540328, "creation_date": 1441207292, "answer_id": 32357089, "question_id": 32356876, "link": "https://stackoverflow.com/questions/32356876/is-there-a-linux-c-ide-that-supports-intellisense-for-c-library-function/32357089#32357089", "title": "Is there a Linux C IDE that supports intellisense for C library function?", "body": "<p><a href=\"https://netbeans.org/features/index.html\" rel=\"nofollow noreferrer\">Use NetBeans</a>. It supports c, c++ and can prompt library functions. Install, and press CTRL+SPACE to list library functions, class, etc.</p>\n\n<p>also:\n<a href=\"https://stackoverflow.com/questions/24109/c-ide-for-linux\">C++ IDE for Linux?</a></p>\n\n<p>Besides everything.. why you don't just type: </p>\n\n<pre><code>$: vim\n</code></pre>\n\n<p>in terminal to get best editor? ; ) </p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 2763057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HGS1W.png?s=128&g=1", "display_name": "fatihbozik", "link": "https://stackoverflow.com/users/2763057/fatihbozik"}, "is_accepted": false, "score": 1, "last_activity_date": 1441207638, "creation_date": 1441207638, "answer_id": 32357215, "question_id": 32356876, "link": "https://stackoverflow.com/questions/32356876/is-there-a-linux-c-ide-that-supports-intellisense-for-c-library-function/32357215#32357215", "title": "Is there a Linux C IDE that supports intellisense for C library function?", "body": "<p>Have you tried <a href=\"https://www.jetbrains.com/clion/\" rel=\"nofollow\">CLion</a>? It's powerful cross-platform IDE. It's <a href=\"https://www.jetbrains.com/student/\" rel=\"nofollow\">free</a> for students.</p>\n"}], "owner": {"reputation": 52264, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 0, "closed_date": 1441267644, "answer_count": 2, "score": -1, "last_activity_date": 1441207638, "creation_date": 1441206668, "last_edit_date": 1441206808, "question_id": 32356876, "link": "https://stackoverflow.com/questions/32356876/is-there-a-linux-c-ide-that-supports-intellisense-for-c-library-function", "closed_reason": "Not suitable for this site", "title": "Is there a Linux C IDE that supports intellisense for C library function?", "body": "<p>I am new to Linux C programming. And I am used to Visual Studio intellisense which can prompt function name and parameter list after I typing a few letters. Is there C IDE that can do similar things for <code>library functions</code>? Suppose I have composed the include paths properly.</p>\n\n<p>I tried <code>KDevelop</code>. But it failed to identify the <code>printf</code> and similar functions.\n(And some UI bugs also - the <code>Solve</code> button I guess).</p>\n\n<p><a href=\"https://i.stack.imgur.com/0PpaT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0PpaT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "quine"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1441206331, "post_id": 32356392, "comment_id": 52586386, "body": "Guess why the original code used %c and 34 instead of just escaping the quotes."}, {"owner": {"reputation": 181, "user_id": 2896349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/1040915833/picture?type=large", "display_name": "Jacob Stinson", "link": "https://stackoverflow.com/users/2896349/jacob-stinson"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1441207285, "post_id": 32356392, "comment_id": 52587111, "body": "Yes, thank you immibis, I did realize that I should be using %c along with the character code instead of using literal quotation marks."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1441353374, "post_id": 32392820, "comment_id": 52654451, "body": "I didn&#39;t include my solution in my answer to not unveil the solution to the problem.  My apologies for that."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1441353024, "creation_date": 1441353024, "answer_id": 32392820, "question_id": 32356392, "link": "https://stackoverflow.com/questions/32356392/printing-out-backslash-in-c-quine-program/32392820#32392820", "title": "Printing out backslash in C quine program", "body": "<p>As the compiler interprets escape sequences in only one direction (deescaping them) I think there's no possibility to include an escape sequence in the code and make it appear as such in the listing. The compiler will always eliminate one of the backslashes on input of the source file, making it appear different on output.  The <code>printf</code> uses <code>%s</code> format to allow for the recursive part of the problem and allow you to shelf print, and, as you have guessed correctly, you have to use integer versions of delimiting chars for the <code>\"</code> delimiting chars.  Why to use <code>%c</code> to be able to delimit the strings in your program if there's an alternative method to include escape sequences? By the same reason, I was not able to include any end of line delimiter, so I wrote the same problem in one line (without using the <code>#include &lt;stdio.h&gt;</code> line)  My solution was a one line (without the final end of line.)</p>\n"}], "owner": {"reputation": 181, "user_id": 2896349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/1040915833/picture?type=large", "display_name": "Jacob Stinson", "link": "https://stackoverflow.com/users/2896349/jacob-stinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441353024, "creation_date": 1441205361, "last_edit_date": 1441206942, "question_id": 32356392, "link": "https://stackoverflow.com/questions/32356392/printing-out-backslash-in-c-quine-program", "title": "Printing out backslash in C quine program", "body": "<p>I'm trying to write a quine program for the follow <strong>C</strong> source code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nchar name[] = \"Jacob Stinson\";\nint main(){\n    char *c=\"#include&lt;stdio.h&gt; char name[] = \\\"Jacob Stinson\\\"; int main(){char *c=%c%s%c; prinf(c,34,c,34);}\";\nprintf(c,34,c,34);\n}\n</code></pre>\n\n<p>I need to include the backslash before the <code>\"</code> in the string in order to properly print out line 3, however, when I print out <code>*c</code>, <strong>I want those backslashes to be present</strong>, as to correctly copy the source code. Currently it omits the backslashes from the output.</p>\n\n<p>Wanted to see if anyone knows how to go about doing this. </p>\n"}, {"tags": ["c++", "c", "linux", "embedded", "esp8266"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1441205857, "post_id": 32356326, "comment_id": 52586016, "body": "You could replace repeatedly grepping with a one-line shell script."}], "answers": [{"comments": [{"owner": {"reputation": 1536, "user_id": 688916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/182b56917b81c25cafc910718e0500a0?s=128&d=identicon&r=PG", "display_name": "supergiox", "link": "https://stackoverflow.com/users/688916/supergiox"}, "edited": false, "score": 1, "creation_date": 1441275564, "post_id": 32356402, "comment_id": 52617008, "body": "Very handy! Just to know, what is the use of <code>&#47;dev&#47;null</code> ?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 1536, "user_id": 688916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/182b56917b81c25cafc910718e0500a0?s=128&d=identicon&r=PG", "display_name": "supergiox", "link": "https://stackoverflow.com/users/688916/supergiox"}, "edited": false, "score": 1, "creation_date": 1441276320, "post_id": 32356402, "comment_id": 52617474, "body": "If you don&#39;t add the <code>&#47;dev&#47;null</code> then <code>grep</code> thinks it&#39;s just grepping a single file and doesn&#39;t list the file name for any matches. I think you can also achieve the same effect by passing the <code>-l</code> switch to <code>grep</code>, but old habits die hard."}, {"owner": {"reputation": 10306, "user_id": 1142045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d781e8275bc700f0d69b790c9352d68?s=128&d=identicon&r=PG", "display_name": "TerryE", "link": "https://stackoverflow.com/users/1142045/terrye"}, "edited": false, "score": 1, "creation_date": 1441368137, "post_id": 32356402, "comment_id": 52663281, "body": "Or even just <code>grep foo $(find &#47;path&#47;to&#47;SDK -name \\*.h)</code>"}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1441205391, "creation_date": 1441205391, "answer_id": 32356402, "question_id": 32356326, "link": "https://stackoverflow.com/questions/32356326/find-needed-header-file/32356402#32356402", "title": "Find needed header file", "body": "<p>I would normally just use <code>find</code> + <code>grep</code> for this, e.g. to find the definition of <code>foo</code>:</p>\n\n<pre><code>$ find /path/to/SDK -name \\*.h -exec grep foo {} /dev/null \\;\n</code></pre>\n"}], "owner": {"reputation": 1536, "user_id": 688916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/182b56917b81c25cafc910718e0500a0?s=128&d=identicon&r=PG", "display_name": "supergiox", "link": "https://stackoverflow.com/users/688916/supergiox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 32356402, "answer_count": 1, "score": 0, "last_activity_date": 1473704885, "creation_date": 1441205180, "last_edit_date": 1473704885, "question_id": 32356326, "link": "https://stackoverflow.com/questions/32356326/find-needed-header-file", "title": "Find needed header file", "body": "<p>I'm programming in <code>C</code> a device (<code>ESP8266</code>) whose documentation explains each function or data structure of the SDK, but doesn't tell where to locate the corresponding header file, so every time I need to search them using <code>grep</code> and annoying regex.</p>\n\n<p>Which is in these cases the best/common practice to \"browse\" the SDK and find headers?\nI usually use <code>nano</code> and <code>Sublime Text</code> as editor (on GNU/Linux and Mac OS X) but any other solution are appreciated.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 5858, "user_id": 1530549, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9acb42e69fdeeaf6474022411fe61725?s=128&d=identicon&r=PG", "display_name": "Scooter", "link": "https://stackoverflow.com/users/1530549/scooter"}, "edited": false, "score": 6, "creation_date": 1441204753, "post_id": 32356022, "comment_id": 52585159, "body": "You function says it returns a char *, but you are returning an integer."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1441204965, "post_id": 32356022, "comment_id": 52585318, "body": "The difference between two pointers has the type <code>ptrdiff_t</code> and the correct length modifier for that is <code>t</code>, as in <code>%td</code>.  See POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/printf.html\" rel=\"nofollow noreferrer\"><code>printf()</code></a>, although that aspect of it is common with the C99 standard (and C11)."}, {"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 1, "creation_date": 1441207050, "post_id": 32356022, "comment_id": 52586945, "body": "For what it&#39;s worth... post-college assignment, you should almost never write your own <code>&lt;string.h&gt;</code> functions.  The versions in any <code>libc</code> worth using are optimized very well, and the only way you&#39;re likely to do better is if you know something special about your input."}], "answers": [{"comments": [{"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1441205608, "post_id": 32356092, "comment_id": 52585829, "body": "Looking at the code, this is not enough. Hint: consider what happens if <code>c</code> does not occur in the string."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "reply_to_user": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 0, "creation_date": 1441214285, "post_id": 32356092, "comment_id": 52591551, "body": "Initialization <code>int position = -1</code> which means &quot;no such char&quot;."}], "tags": [], "owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": false, "score": 0, "last_activity_date": 1441204544, "creation_date": 1441204544, "answer_id": 32356092, "question_id": 32356022, "link": "https://stackoverflow.com/questions/32356022/how-pointers-work-in-a-function-in-c-pointer-to-integer-without-a-cast/32356092#32356092", "title": "How pointers work in a function in C - Pointer to integer without a cast", "body": "<p>Define <code>mystrrchr</code> as <code>int mystrrchr</code> and call <code>int foundAt = mystrrchr(</code>. Then <code>printf(\"%d\\n\", foundAt)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": false, "score": 1, "last_activity_date": 1441206076, "last_edit_date": 1441206076, "creation_date": 1441204929, "answer_id": 32356233, "question_id": 32356022, "link": "https://stackoverflow.com/questions/32356022/how-pointers-work-in-a-function-in-c-pointer-to-integer-without-a-cast/32356233#32356233", "title": "How pointers work in a function in C - Pointer to integer without a cast", "body": "<p>First you could change</p>\n\n<pre><code>char*mystrrchr(char*s, int c) { \n    ...\n    return position; \n}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>char*mystrrchr(char*s, int c) { \n    ...\n    return s + position; \n}\n</code></pre>\n\n<p>because the first version returns the <em>relative</em> position.</p>\n\n<p>Then you also need to initialize <code>position</code>:</p>\n\n<pre><code>char*mystrrchr(char*s, int c) { \n    int position = -1;\n    ...\n}\n</code></pre>\n\n<p>And then return <code>NULL</code> if nothing was found:</p>\n\n<pre><code>char*mystrrchr(char*s, int c) { \n    int position = -1;\n    ...\n    if(position == -1) return NULL;\n    else return s + position;\n}\n</code></pre>\n\n<p>At this point the function works correctly.<br>\nBut you could improve the performance by using</p>\n\n<pre><code>while (s[i] != '\\0')\n</code></pre>\n\n<p>instead of using <code>strlen</code>, as Jonathan Leffler pointed out in a comment.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1441205208, "post_id": 32356314, "comment_id": 52585518, "body": "Using <code>strlen()</code> scans the string twice.  In this context, you should not use <code>strlen()</code> and should have <code>while (s[i] != &#39;\\0&#39;)</code> as the loop condition."}, {"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 2, "creation_date": 1441205516, "post_id": 32356314, "comment_id": 52585760, "body": "You never look at <code>s[0]</code>. The loop condition should be <code>i &gt;= 0</code>."}], "tags": [], "owner": {"reputation": 5858, "user_id": 1530549, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9acb42e69fdeeaf6474022411fe61725?s=128&d=identicon&r=PG", "display_name": "Scooter", "link": "https://stackoverflow.com/users/1530549/scooter"}, "is_accepted": false, "score": 0, "last_activity_date": 1441205899, "last_edit_date": 1441205899, "creation_date": 1441205150, "answer_id": 32356314, "question_id": 32356022, "link": "https://stackoverflow.com/questions/32356022/how-pointers-work-in-a-function-in-c-pointer-to-integer-without-a-cast/32356314#32356314", "title": "How pointers work in a function in C - Pointer to integer without a cast", "body": "<pre><code>char* mystrrchr(char*s, int c) {\n   if ( s == NULL ) return NULL;\n    char *position = NULL;\n    int i = 0;\n    while (s[i] != '\\0' ) { \n        if (c == s[i]) { \n            position = &amp;s[i];\n        } \n        i++;\n    } \n    return position; \n}\n</code></pre>\n\n<p>You can also go backwards:</p>\n\n<pre><code>char* mystrrchr2(char*s, int c) {\n    if ( s == NULL ) return NULL; \n    char *position = NULL;\n    int i = strlen(s) - 1;\n    while (i &gt; -1) { \n        if (c == s[i]) { \n            position = &amp;s[i];\n        break;\n        } \n        i--;\n    } \n    return position; \n}\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 2318390, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0812a2bfc16d04bce2313be46ec5b9f3?s=128&d=identicon&r=PG", "display_name": "James Pinson", "link": "https://stackoverflow.com/users/2318390/james-pinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1441206076, "creation_date": 1441204361, "last_edit_date": 1441204845, "question_id": 32356022, "link": "https://stackoverflow.com/questions/32356022/how-pointers-work-in-a-function-in-c-pointer-to-integer-without-a-cast", "title": "How pointers work in a function in C - Pointer to integer without a cast", "body": "<p>I am currently practicing using pointers for an upcoming exam and am running through a few practice questions to brush up on them. I want to make my own version of the strrchr function with the given function signature:     </p>\n\n<pre><code>char* mystrrchr(char*s, int c) {\n</code></pre>\n\n<p>And the main field: </p>\n\n<pre><code>int main(void) { \n    char* s = \"ENCE260\"; \n    char* foundAt = mystrrchr(s, 'E'); \n    if (foundAt == NULL) { \n        puts(\"Not found\"); \n    } \n    else { \n        printf(\"%zd\\n\", foundAt - s); \n    } \n}\n</code></pre>\n\n<p>And I want the code to work without any changes to the main and function signature.</p>\n\n<p>I want to return the index of the last time the character c appears in a string s as an integer. The jist of the code is fine, I just am unsure how to use the pointers correctly in this situation to return the desired output. For reference the error I am receiving is that I am making a pointer from integer without a cast.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;assert.h&gt;\n\nchar* mystrrchr(char*s, int c) { \n    int position;\n    int len = strlen(s);\n    int i = 0;\n    while (i &lt; len) { \n        if (c == s[i]) { \n            position = i;\n            i++; \n        } \n        else {\n            i++;\n        }\n    } \n    return position; \n}\n\nint main(void) { \n    char* s = \"ENCE260\"; \n    char* foundAt = mystrrchr(s, 'E'); \n    if (foundAt == NULL) { \n        puts(\"Not found\"); \n    } \n    else { \n        printf(\"%zd\\n\", foundAt - s); \n    } \n}\n</code></pre>\n\n<p>That is my code thus far.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1441203104, "post_id": 32355492, "comment_id": 52583932, "body": "You can&#39;t. You <i>can</i>, however, have a struct with <i>pointers</i> to structs with flexible array members."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 2, "creation_date": 1441203115, "post_id": 32355492, "comment_id": 52583940, "body": "Can you give the full declaration for <code>A_t</code> and <code>B_t</code>"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 3, "creation_date": 1441203117, "post_id": 32355492, "comment_id": 52583945, "body": "Only the last field of a struct can have a variable size. You will like need to use a pointer to another object for one or both of the structs you want to &#39;hold&#39;."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441203151, "post_id": 32355492, "comment_id": 52583973, "body": "What are members of A_t and B_t?"}, {"owner": {"reputation": 8043, "user_id": 491687, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2174f845b769ea2ad2242047f3118128?s=128&d=identicon&r=PG", "display_name": "Wesley Bland", "link": "https://stackoverflow.com/users/491687/wesley-bland"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441203252, "post_id": 32355492, "comment_id": 52584054, "body": "@LPs, I&#39;ve fleshed out structs A_t and B_t a little more if it helps."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1441203350, "post_id": 32355492, "comment_id": 52584117, "body": "The compiler diagnostic you presented does not correspond to the code you presented.  The types <code>A_t</code> and <code>B_t</code> are not variable-size.  With those declarations, there should not be any problem with the declaration of type <code>C_t</code>.  If <code>clang</code> really barfs on that, as you presented it, then it would constitute a bug.  I think it more likely, however, that you have simplified the real problem right out of your example."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1441203359, "post_id": 32355492, "comment_id": 52584122, "body": "@MichaelBurr Could you elaborate? I used to use the same &quot;technic&quot; for packet (header, payload) to cast buffer, but gcc never give me warnings? Is that a clang &quot;feature?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441203468, "post_id": 32355492, "comment_id": 52584199, "body": "@WesleyBland Is the edited code the real code?"}, {"owner": {"reputation": 8043, "user_id": 491687, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2174f845b769ea2ad2242047f3118128?s=128&d=identicon&r=PG", "display_name": "Wesley Bland", "link": "https://stackoverflow.com/users/491687/wesley-bland"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441203599, "post_id": 32355492, "comment_id": 52584295, "body": "@JohnBollinger Sorry, I see how my example didn&#39;t provide the same problem. Now I&#39;ve updated to include the real code (with simplified variable names)."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441203620, "post_id": 32355492, "comment_id": 52584310, "body": "You could use a union to store different size, instead of use f[]."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1441203718, "post_id": 32355492, "comment_id": 52584361, "body": "@LPs It&#39;s a feature, not a &quot;feature&quot;."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1441204522, "post_id": 32355492, "comment_id": 52584957, "body": "@n.m. When I wrote the code posted was different. The <code>f[]</code> there wasn&#39;t and I didn&#39;t understand why clang could warn on a struct with some fields like <code>uint8_t</code>, <code>uint16_t</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1441204579, "post_id": 32355492, "comment_id": 52585012, "body": "What do you want <code>offsetof(msg_t, pyld)</code> to be?"}, {"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1441236700, "post_id": 32355492, "comment_id": 52601929, "body": "Why do you want to have an header with an unknown size?"}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1441204159, "creation_date": 1441204159, "answer_id": 32355935, "question_id": 32355492, "link": "https://stackoverflow.com/questions/32355492/how-do-i-safely-put-two-variable-sized-datatypes-structs-in-a-single-struct/32355935#32355935", "title": "How do I safely put two variable sized datatypes (structs) in a single struct?", "body": "<p>You could use an union:</p>\n\n<pre><code>typedef struct {\n    ..stuff\n}type_f1;\n\ntypedef struct {\n    ..stuff\n}type_f2;\n\ntypedef struct {\n    ..stuff\n}type_f3;\n\ntypedef union {\n    type_f1 f1;\n    type_f2 f2;\n    type_f3 f3;\n    uint8_t rawdata[MAX_RAWDATA];\n}type_f;\n\ntypedef struct hdr_t {\n    uint16_t a;\n    uint16_t b;\n    uint8_t c;\n    uint8_t d[3];\n    uint64_t e;\n    type_f f;\n} hdr_t;\n\ntypedef struct {\n    uint64_t data;\n} pyld_t;\n\ntypedef struct {\n    hdr_t hdr;\n    pyld_t pyld;\n} msg_t;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1441207728, "post_id": 32356904, "comment_id": 52587413, "body": "If you are mapping your struct layout directly to the packet format, e.g. you are doing <code>read</code> or <code>write</code> with the entire struct, then the array <i>is</i> necessary. If you are doing I/O with individual members, then it&#39;s not."}], "tags": [], "owner": {"reputation": 8043, "user_id": 491687, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2174f845b769ea2ad2242047f3118128?s=128&d=identicon&r=PG", "display_name": "Wesley Bland", "link": "https://stackoverflow.com/users/491687/wesley-bland"}, "is_accepted": false, "score": 0, "last_activity_date": 1441206766, "creation_date": 1441206766, "answer_id": 32356904, "question_id": 32355492, "link": "https://stackoverflow.com/questions/32355492/how-do-i-safely-put-two-variable-sized-datatypes-structs-in-a-single-struct/32356904#32356904", "title": "How do I safely put two variable sized datatypes (structs) in a single struct?", "body": "<p>There's lots of solutions that will fix the issue. For my specific problem, just changing the declaration of <code>hdr_t</code> from this:</p>\n\n<pre><code>typedef struct hdr_t {\n    uint16_t a;\n    uint16_t b;\n    uint8_t c;\n    uint8_t d[3];\n    uint64_t e;\n    uint8_t f[];\n} hdr_t;\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>typedef struct hdr_t {\n    uint16_t a;\n    uint16_t b;\n    uint8_t c;\n    uint8_t d[3];\n    uint64_t e;\n    uint8_t *f; //Use pointer instead of variable sized array\n} hdr_t;\n</code></pre>\n\n<p>I'm not sure why the original code was using the array, but it wasn't necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441209585, "post_id": 32357217, "comment_id": 52588659, "body": "@chux, read a bit further.  Both C11 and C99 forbid a structure containing a flexible array member from being an array element or a member of another structure.  In C11 this is at the end of 6.7.2.1/3.  C11 is in fact more restrictive than C99 in this regard, as it applies the same prohibition to unions containing a such a structure, possibly recursively, as it does directly to such structures."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441209818, "post_id": 32357217, "comment_id": 52588809, "body": "Excuse my incorrect reading of this fine answer.  Taking down previous comment."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1441208087, "last_edit_date": 1441208087, "creation_date": 1441207646, "answer_id": 32357217, "question_id": 32355492, "link": "https://stackoverflow.com/questions/32355492/how-do-i-safely-put-two-variable-sized-datatypes-structs-in-a-single-struct/32357217#32357217", "title": "How do I safely put two variable sized datatypes (structs) in a single struct?", "body": "<p>A C structure can be variable-size only in the sense that it may contain a \"flexible array member\" as its last member.  C forbids such a structure type from being the type of <em>any</em> structure member or array element, though GCC permits that as an extension.</p>\n\n<p>Even if GCC (or clang) accepted your declaration, I doubt it would mean what you think it means.  Every member of a structure has a fixed offset relative to the beginning of the structure, determined statically at compile time.  As a result, your <code>msg_t</code> cannot provide sufficient space for arbitrary <code>hdr.f</code>, and quite possibly it provides no space at all, especially if you enable structure packing.  Thus, accessing <code>hdr.f</code> of a <code>msg_t</code> could easily access the message <code>data</code>, which I suppose is not what you expect.</p>\n\n<p>I guess the whole point is to map a structure to a byte buffer, but if the underlying data format has variable-length elements in the middle then you just can't directly map a single C structure to it.  You could, however, create and use an index structure:</p>\n\n<pre><code>typedef struct {\n    hdr_t *hdr;\n    pyld_t *pyld;\n} msg_index_t;\n</code></pre>\n\n<p>That would make it easier to handle mapping a <em>pair</em> of structures to your buffer.</p>\n"}], "owner": {"reputation": 8043, "user_id": 491687, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2174f845b769ea2ad2242047f3118128?s=128&d=identicon&r=PG", "display_name": "Wesley Bland", "link": "https://stackoverflow.com/users/491687/wesley-bland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1441232122, "creation_date": 1441202985, "last_edit_date": 1441203724, "question_id": 32355492, "link": "https://stackoverflow.com/questions/32355492/how-do-i-safely-put-two-variable-sized-datatypes-structs-in-a-single-struct", "title": "How do I safely put two variable sized datatypes (structs) in a single struct?", "body": "<p>I'm trying to construct some C structs that themselves need to hold multiple structs. It looks something like this:</p>\n\n<pre><code>typedef struct hdr_t {\n    uint16_t a;\n    uint16_t b;\n    uint8_t c;\n    uint8_t d[3];\n    uint64_t e;\n    uint8_t f[];\n} hdr_t;\n\ntypedef struct {\n    uint64_t data;\n} pyld_t;\n\ntypedef struct {\n    hdr_t hdr;\n    pyld_t pyld;\n} msg_t;\n</code></pre>\n\n<p>When I compile this, depending on the compiler and settings, I get warnings.</p>\n\n<pre><code>./file.h:55:24: warning: field 'hdr' with variable sized type 'hdr_t'\n      (aka 'struct hdr_t') not at the end of a struct or class is a GNU extension\n      [-Wgnu-variable-sized-type-not-at-end]\n    hdr_t hdr;\n</code></pre>\n\n<p>For this example, I'm using clang 6.1.0:</p>\n\n<blockquote>\n  <p>$ clang --version<br>\n  Apple LLVM version 6.1.0 (clang-602.0.53) (based on LLVM 3.6.0svn)<br>\n  Target: x86_64-apple-darwin14.5.0<br>\n  Thread model: posix  </p>\n</blockquote>\n\n<p>The warning complain that what I'm doing is a non-portable GNU extension, which I'd rather avoid. What can I do to solve this? Is there not a safe way to put multiple structs in a struct? Surely that's not the case.</p>\n"}, {"tags": ["c", "list", "api", "directory"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1441203131, "post_id": 32355416, "comment_id": 52583959, "body": "<code>da</code> is a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365740%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\"><code>WIN32_FIND_DATA</code></a> structure (I assume), why do you try to add a pointer to it as a string to the libsbox? Wouldn&#39;t it make more sense in passing <code>da.cFileName</code>? Also, you&#39;re are passing the same pointer each time you try to add the structure so all the entries would be the same anyway."}, {"owner": {"reputation": 823, "user_id": 2128797, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dacdb96daa34c81dbc949b2fe7bea470?s=128&d=identicon&r=PG", "display_name": "Laurie Stearn", "link": "https://stackoverflow.com/users/2128797/laurie-stearn"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1441204191, "post_id": 32355416, "comment_id": 52584704, "body": "Oops, thanks- [face-palm] put those in. I guess with something like a Listindex would be more apropos. A FOR loop perhaps?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1441204502, "post_id": 32355416, "comment_id": 52584943, "body": "@Joachim-Pileborg, Windows copies the string from SendMessage to an internal string so the entries in the listbox will not be the same."}, {"owner": {"reputation": 823, "user_id": 2128797, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dacdb96daa34c81dbc949b2fe7bea470?s=128&d=identicon&r=PG", "display_name": "Laurie Stearn", "link": "https://stackoverflow.com/users/2128797/laurie-stearn"}, "edited": false, "score": 0, "creation_date": 1441205176, "post_id": 32355416, "comment_id": 52585494, "body": "It builds fine now, but the pacman exe is an avid memory cruncher. The listbox never shows. Something will have to change here."}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 2128797, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dacdb96daa34c81dbc949b2fe7bea470?s=128&d=identicon&r=PG", "display_name": "Laurie Stearn", "link": "https://stackoverflow.com/users/2128797/laurie-stearn"}, "is_accepted": true, "score": 0, "last_activity_date": 1441637312, "last_edit_date": 1441637312, "creation_date": 1441555614, "answer_id": 32425540, "question_id": 32355416, "link": "https://stackoverflow.com/questions/32355416/something-wrong-with-this-loop/32425540#32425540", "title": "Something wrong with this Loop?", "body": "<p>FWIW the question had so many errors, no wonder it was marked down. The biggest problem was testing for ERROR_NO_MORE_ITEMS on the entire da record and not da.cFileName, thus the infinite loop:.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;winnt.h&gt;\n#include \"resource.h\" //Listbox data\n\nWIN32_FIND_DATA da;   // directory data this will use stack memory as opposed to LPWIN32_FIND_DATA\nTCHAR *driveIDptr;  \nchar driveID;\nHANDLE ds;     // directory handle\n\nBOOL CALLBACK DlgProc(HWND hwnd, UINT Msg, WPARAM wParam, LPARAM lParam)\n{\nswitch(Msg)\n{\n        case WM_INITDIALOG:\n\n{       \n    int listindex = 0;\n\n    //Populate List\n    driveIDptr = \"C:\\\\*\";\n    memset(&amp;da, 0, sizeof(WIN32_FIND_DATA));\n\n    ds = FindFirstFile(driveIDptr, &amp;da);\n    driveIDptr = \"C:\\\\\"; //Shocking, but costs less than a strcat in above find function\n\n    if (ds == INVALID_HANDLE_VALUE)\n    {\n     StringCchPrintf (pszDest, cbDest, TEXT(\"No directories found.\"));\n    return FALSE;\n    }\n\n    while (ds != INVALID_HANDLE_VALUE &amp;&amp; ds)\n    {\n\n        if (FindNextFile(ds, &amp;da) == FALSE) break;\n\n    if((da.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY) &amp;&amp; !(da.dwFileAttributes &amp; FILE_ATTRIBUTE_SYSTEM\n|| da.dwFileAttributes &amp; FILE_ATTRIBUTE_REPARSE_POINT || da.dwFileAttributes &amp; FILE_ATTRIBUTE_ARCHIVE || da.dwFileAttributes &amp; FILE_ATTRIBUTE_HIDDEN )) {\n\n    strcpy (&amp;driveID, (char *) driveIDptr);\n    strcat (&amp;driveID,  da.cFileName);\n    SendDlgItemMessage(hwnd, IDC_LIST, LB_ADDSTRING, (WPARAM)listindex, (LPARAM)&amp;driveID);\n\n        SendDlgItemMessage(hwnd, IDC_LIST, LB_SETITEMDATA, (WPARAM)listindex, (LPARAM)listindex);\n        listindex+=1;\n    }\n\n    } \n        FindClose(ds);\n\n        //other Msg cases...\n</code></pre>\n"}], "owner": {"reputation": 823, "user_id": 2128797, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dacdb96daa34c81dbc949b2fe7bea470?s=128&d=identicon&r=PG", "display_name": "Laurie Stearn", "link": "https://stackoverflow.com/users/2128797/laurie-stearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 32425540, "answer_count": 1, "score": -1, "last_activity_date": 1441637312, "creation_date": 1441202781, "last_edit_date": 1495540333, "question_id": 32355416, "link": "https://stackoverflow.com/questions/32355416/something-wrong-with-this-loop", "title": "Something wrong with this Loop?", "body": "<p>The code that embeds the loop builds and runs fine. Attempting to build it (VS10 in MBCS) with it in fails at the LinkEmbedManifest step with the <a href=\"https://stackoverflow.com/questions/12124146/vc-fatal-error-lnk1168-cannot-open-filename-exe-for-writing\">link 1168</a> error.</p>\n\n<pre><code>    WIN32_FIND_DATA da;   // directory data\n    TCHAR *Path;    // directory Pointer\n    HANDLE ds;     // directory handle  \n    int Listindex=0;\n    Path = \"C:\\\\\";\n    SetCurrentDirectory(Path);     \n    Listindex=0\n    ds = FindFirstFile(TEXT(\"*\"),&amp;da);\n        do       {\n            int index = SendDlgItemMessage(hwnd, IDC_LIST, LB_ADDSTRING, (WPARAM)Listindex, (LPARAM)&amp;da);\n\n            SendDlgItemMessage(hwnd, IDC_LIST, LB_SETITEMDATA, (WPARAM)index, (LPARAM)Listindex);\n            Listindex+=1;\n            } \n            while( FindNextFile(ds,&amp;da) != ERROR_NO_MORE_ITEMS);\n\n\n    FindClose(ds);\n</code></pre>\n\n<p>The aim is to list the directories in the root of C. There is implicit casting from  LONG_PTR LRESULT to int with index, and further casting with LPARAM and WPARAM. Would it make any difference if these were replaced with module-wide decs?\nOr would changing the type of loop altogether be any better?</p>\n"}, {"tags": ["c", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1441202503, "post_id": 32354994, "comment_id": 52583496, "body": "The only place where you actually change the structure of the linked list is <code>prev-&gt;ptr = 0;</code>, so obviously that is not enough to reverse the list, all it does is remove a link."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1441202533, "post_id": 32354994, "comment_id": 52583515, "body": "Take a pen and a paper, and trace your code line by line. Also <code>prev = temp-&gt;ptr; prev = temp;</code> these two lines one after the other makes no sense, the first one is completely redundant."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1528161988, "post_id": 32354994, "comment_id": 88391378, "body": "A more complete discussion on this problem, <a href=\"https://stackoverflow.com/q/1801549/2472827\">stackoverflow.com/q/1801549/2472827</a>."}], "answers": [{"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": false, "score": 0, "last_activity_date": 1441202829, "creation_date": 1441202829, "answer_id": 32355431, "question_id": 32354994, "link": "https://stackoverflow.com/questions/32354994/what-is-the-logical-error-in-my-attempt-to-reverse-a-linked-list/32355431#32355431", "title": "What is the logical error in my attempt to reverse a linked list?", "body": "<pre><code>    ...\n         prev-&gt;ptr = 0;\n         break; \n     }\n }\n</code></pre>\n\n<p>This <code>break</code> stops inner loop, but not the outer one. For that happen: <code>first-&gt;ptr == 0</code>, use a <code>return</code>, other variable to keep control (some flag, like a <code>int x = 0, if(!x)..</code>) or even a <code>goto</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 378, "user_id": 3715862, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/de57c38b305cc2d7c211758631f71eab?s=128&d=identicon&r=PG&f=1", "display_name": "Echo", "link": "https://stackoverflow.com/users/3715862/echo"}, "edited": false, "score": 0, "creation_date": 1441207643, "post_id": 32355491, "comment_id": 52587348, "body": "I have made the necessary changes. Sorry for the inconvenience."}, {"owner": {"reputation": 378, "user_id": 3715862, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/de57c38b305cc2d7c211758631f71eab?s=128&d=identicon&r=PG&f=1", "display_name": "Echo", "link": "https://stackoverflow.com/users/3715862/echo"}, "edited": false, "score": 0, "creation_date": 1441261717, "post_id": 32355491, "comment_id": 52608634, "body": "My logic for the outer while loop termination is that , in the inner while loop the last node is deleted. So when the second node becomes the last node (after a number of iteration), it will get deleted. Hence, first-&gt;ptr will point to 0. Thus leading to the termination by break. I am not sure if it is working. Can you suggest some change which will lead to it working. I know I am asking a lot. Thank you for the help."}, {"owner": {"reputation": 642, "user_id": 4519018, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6a1a91080a51d21ca9ba9f261913ac2a?s=128&d=identicon&r=PG&f=1", "display_name": "vvs14", "link": "https://stackoverflow.com/users/4519018/vvs14"}, "reply_to_user": {"reputation": 378, "user_id": 3715862, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/de57c38b305cc2d7c211758631f71eab?s=128&d=identicon&r=PG&f=1", "display_name": "Echo", "link": "https://stackoverflow.com/users/3715862/echo"}, "edited": false, "score": 0, "creation_date": 1441270543, "post_id": 32355491, "comment_id": 52613799, "body": "You will need only one iteration over List and few pointers (2 or 3). You also need to take care of condition that after reversing the List, <code>first</code> should point to original last node."}], "tags": [], "owner": {"reputation": 642, "user_id": 4519018, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6a1a91080a51d21ca9ba9f261913ac2a?s=128&d=identicon&r=PG&f=1", "display_name": "vvs14", "link": "https://stackoverflow.com/users/4519018/vvs14"}, "is_accepted": false, "score": 0, "last_activity_date": 1441202979, "creation_date": 1441202979, "answer_id": 32355491, "question_id": 32354994, "link": "https://stackoverflow.com/questions/32354994/what-is-the-logical-error-in-my-attempt-to-reverse-a-linked-list/32355491#32355491", "title": "What is the logical error in my attempt to reverse a linked list?", "body": "<p>Your code is quite ambiguous.</p>\n\n<p>1) You have not given your structure definition here and that is why, <code>first-&gt;ptr</code> seems quite ambiguous to me. What does \"ptr\" refer to?</p>\n\n<p>2)  <code>temp = prev = first-&gt;ptr;</code> </p>\n\n<p><code>first</code> is a pointer to ListNode (I am assuming), then what does  <code>first-&gt;ptr</code>  mean? Tell about <code>first-&gt;num</code> too?</p>\n\n<p>2) You have two while loops. You are breaking out of inner <code>while</code>, with some logic, but not out of outer while ,because to break out of outer <code>while</code>, you should have modified <code>first-&gt;ptr</code> in subsequent lines, which you are not doing.In no way, you will break out of outer <code>while</code>.</p>\n"}], "owner": {"reputation": 378, "user_id": 3715862, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/de57c38b305cc2d7c211758631f71eab?s=128&d=identicon&r=PG&f=1", "display_name": "Echo", "link": "https://stackoverflow.com/users/3715862/echo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1441249637, "creation_date": 1441201656, "last_edit_date": 1441249637, "question_id": 32354994, "link": "https://stackoverflow.com/questions/32354994/what-is-the-logical-error-in-my-attempt-to-reverse-a-linked-list", "title": "What is the logical error in my attempt to reverse a linked list?", "body": "<p>The following is my reverse linked list code.\nIt is running in endless loop(on the second node i.e it continuously prints 2-> if the list is 1->2->3->4). \nAny help will be appreciated.</p>\n\n<p><code>first</code> is the head node pointer. <code>Temp</code> is the temporary node. <code>Prev</code> is the previous node.</p>\n\n<p>The structure of the node is </p>\n\n<pre><code>struct node {\n\n     int num;\n     struct node *ptr;\n } ;\n</code></pre>\n\n<p>The idea behind this approach is :- \nI will iteratively find the last node and print it. The prev node points to the node just before the temp node , which is the node that finally points to the last node before deleting it. The outer while loop terminates as soon as the first , which is the pointer to the first node of the list is the last node .\nEvery time the else block of the outer while loop is executed. The prev and temp points to the next node after the first node.</p>\n\n<p>The insertion of the linked list is working properly. I have already checked that part. I have also run through the entire code a couple of times and tried predicting each step but to no avail.</p>\n\n<pre><code>while (1)\n{\n    if (first-&gt;ptr == 0)\n    {\n        printf(\"%d\\n\",first-&gt;num);\n        break;\n    }\n    else\n    {\n        temp = prev = first-&gt;ptr;\n        while (1)\n        {\n            if (temp-&gt;ptr == 0)\n            {\n\n                printf(\"%d-&gt;\", temp-&gt;num);\n                temp = 0;\n                prev-&gt;ptr = 0;\n                break;\n            }\n            else\n            {\n                prev = temp-&gt;ptr;\n                prev = temp;\n                temp = temp-&gt;ptr; \n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "xcode", "macos", "osx-yosemite"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 6, "creation_date": 1441201559, "post_id": 32354924, "comment_id": 52582809, "body": "Please provide a <b><i><a href=\"http://stackoverflow.com/help/mcve\">MCVE</a></i></b>"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1441201987, "post_id": 32354924, "comment_id": 52583138, "body": "Debugging: breakpoints, single stepping, examining variable values. Same as the other essentially same <a href=\"http://stackoverflow.com/questions/32343335/while-command-activating-twice-c-language\">question</a> on the essentially same code."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1441202247, "post_id": 32354924, "comment_id": 52583311, "body": "It wil lmake debugging and understanding of the code easier if it is refactored (broken-up) into several functions, each function handling a small portion of the problem."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1441218716, "creation_date": 1441218716, "answer_id": 32360650, "question_id": 32354924, "link": "https://stackoverflow.com/questions/32354924/if-else-while-bug-not-activating-activating-twice/32360650#32360650", "title": "If, else &amp; while bug (not activating / activating twice)", "body": "<p>the posted code does not compile, so it certainly does not run.</p>\n\n<p>here are a few of the many listed problems with the code</p>\n\n<p>Always enable all warnings when compiling.  </p>\n\n<p>For gcc, at a minimum use: <code>-Wall -Wextra -pedantic</code></p>\n\n<pre><code>line:column: message\n\n35:5:  warning implicit declaration of function `fpurge`\n224:5: error: expected declaration or statement at end of input\n27:9:  warning: unused variable `kingATKC`\n26:9:  warning: unused variable `kingHP`\n15:10: warning: unused variable `pARMOR`\n</code></pre>\n\n<p>BTW: <code>fpurge</code> is not a supported function in the stdio.h header file</p>\n\n<p>Suggest, rather than calling <code>fpurge()</code>, use:</p>\n\n<pre><code>while( '\\n' != getchar() );\n</code></pre>\n\n<p>when calling scanf(), always check the returned value, not the parameter value, to assure the operation was successful</p>\n\n<p>when inputting the 'gender', apply <code>tolower</code> to the value so user could enter either upper or lower case</p>\n\n<p>this code: around line 232 is killing the hero when it should be killing the knight</p>\n\n<pre><code>            if (knightHP == 0 || knightHP &lt;0)\n            {\n                printf(\"\\nYou fell to the ground heavily damages, while the knight lungs at your for the final hit\\n\");\n                printf(\"\\nYou are dead, thanks for playing.\\n\");\n            }\n</code></pre>\n\n<p>upon any death, the resulting HP can be less than 0 however this line: </p>\n\n<pre><code>while (pHP != 0 &amp;&amp; knightHP != 0) // Combat starts\n</code></pre>\n\n<p>only terminates the loop if HP == 0  it should be:</p>\n\n<pre><code>while (pHP &gt; 0 &amp;&amp; knightHP &gt; 0) // Combat starts\n</code></pre>\n\n<p>Suggest, for a combat sequence, that there is only one place where the hero can input a decision about what they want to do next.  </p>\n\n<p>Suggest, make each combat activity a separate sub function.  </p>\n\n<p>The above two suggestions will greatly increase the simplicity of each function and make the code much easier to debug.</p>\n"}], "owner": {"reputation": 11, "user_id": 5275504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7270e998a1f7c18a96d83364055aeb?s=128&d=identicon&r=PG&f=1", "display_name": "S.P.", "link": "https://stackoverflow.com/users/5275504/s-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1441218716, "creation_date": 1441201481, "last_edit_date": 1441202813, "question_id": 32354924, "link": "https://stackoverflow.com/questions/32354924/if-else-while-bug-not-activating-activating-twice", "title": "If, else &amp; while bug (not activating / activating twice)", "body": "<p>I'm having this problem in where when the player choose to attack. It won't print anything at first but will only print when the player hits the knight. Something else is also if the player chooses an invalid choice in gender, the first mistake will print once but if the mistake happen again it will print twice. I would appreciate any help, just doing my lil' project.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\n    char enter = 0;\n    char pNAME[30];\n    char pGENDER;\n    char pWEAPON[20];\n    char pARMOR [10];\n    int  pWEAPONID;\n    int choice1,choice2 = 0,choice3;\n    int pAGE;\n    int pATK = 0;\n    int pHP = 30;\n    int pATKS = 10;\n    int pATKC = 0;\n    int knightHP = 25;\n    int knightATKS = 20;\n    int knightATKC;\n    int kingHP = 30;\n    int kingATKC;\n    srand((unsigned)time(NULL));\n\n\n    printf(\"While you are enjoying your breakfast at your house, suddenly you get teleported to a different dimension and no one to be seen except an old man.\\n\");\n\n    printf(\"\\nOld Man: What is your name warrior?\\n\");\n    printf(\"\\nInsert name:\");\n    scanf(\"%s\",pNAME);\n    fpurge( stdin );\n\n    printf(\"\\nInsert gender (m/f):\");\n    scanf(\"%c\",&amp;pGENDER);\n    fpurge( stdin );\n    while ( pGENDER != 'f' &amp;&amp;pGENDER != 'm' )\n    {\n        printf(\"\\nInvalid entry, please try again.\\n\");\n        printf(\"\\nInsert gender (m/f):\");\n        scanf(\"%c\",&amp;pGENDER);\n    }\n\n    printf(\"\\nOld Man: Now how old are you warrior?\\n\");\n    printf(\"\\nInsert Age:\");\n    scanf(\"%d\",&amp;pAGE);\n    fpurge( stdin );\n    if ( pAGE &lt; 18)\n    {\n        printf(\"\\nOy mate! No stalker!\\n\");\n        printf(\"\\nTeleporting back to reality...\\n\");\n\n        return 0;\n    }\n\n    if ( pAGE &gt; 80)\n    {\n        printf(\"\\nNo oldies allowed!\\n\");\n        printf(\"\\nTeleporting back to reality...\\n\");\n\n        return 0;\n    }\n\n    printf(\"\\nOld Man: Welcome warrior I fear the knights has taken over our kingdom, and you, %s, are the only one who can save us.\\n\",pNAME);\n    printf(\"\\n%s: How am I suppose to do that?[Enter]\\n\",pNAME);\n    while (enter != '\\r' &amp;&amp; enter != '\\n') { enter = getchar(); }\n\n\n    printf(\"Old Man: Pick one of these three items\\n\");\n    printf(\"\\n[1] Axe : Damage = 7\\t   Accuracy = 70%%  Critical = 7%%\\n\");   //\n    printf(\"\\n[2] Sword : Damage = 5\\t Accuracy = 77%%  Critical = 8%%\\n\");\n    printf(\"\\n[3] Knife : Damage = 3\\t Accuracy = 83%%  Critical = 9%%\\n\");\n    printf(\"\\nYou choose: \");\n    scanf(\"%d\",&amp;pWEAPONID);\n\n    if (pWEAPONID == 1)\n    {\n        pATK = 8;\n        pATKS = 14;     // 10/14 chance\n        strcpy(pWEAPON, \"Axe\");\n    }\n    if (pWEAPONID == 2)\n    {\n        pATK = 6;\n        pATKS = 14;     // 10/13 chance\n        strcpy(pWEAPON, \"Sword\");\n    }\n    if (pWEAPONID == 3)\n    {\n        pATK = 4;\n        pATKS = 12;     // 10/12 chance\n        strcpy(pWEAPON, \"Knife\");\n    }\n    if (pWEAPONID &gt; 3)\n    {\n        printf(\"\\nYou are gonna be fighting with your bare fist\");\n        pATK = 2;\n        pATKS = 11;      // 10/11 chance\n        strcpy(pWEAPON, \"Fist\");\n    }\n\n    printf(\"\\nOld Man: Good choice, you chose the %s, now continue foward to destroy The Evil King\\n\",pWEAPON);\n    printf(\"\\nWhile you are continuing your journey to destroy The Evil King, you come face to face with a knight\\n\");\n    printf(\"\\nWhat do you want to do?\\n\");\n    printf(\"\\n[1] Run [2] Battle:\");\n    scanf(\"%d\",&amp;choice1);\n\n    if (choice1 == 1) //Dead\n    {\n        printf(\"\\nYou attempted to run, but the knight chases you with his horse and a spear.\\n\");\n        printf(\"\\nThe knight stabs you right through your body.\\n\");\n        printf(\"\\nYou are dead, thanks for playing.\\n\");\n        return 0;\n    }\n\n\n    while (pHP != 0 &amp;&amp; knightHP != 0) // Combat starts\n    {   \n        knightATKC = rand()%knightATKS;     // 15/20 chance\n        sleep(1);\n        // Knight's turn\n        if ( knightATKC == 1 || knightATKC == 2 || knightATKC == 3 || knightATKC == 4 || knightATKC == 5 || knightATKC == 6 || knightATKC == 7 || knightATKC == 8 || knightATKC == 9 || knightATKC == 10 || knightATKC == 11 || knightATKC == 0 )\n        {\n            printf(\"\\nThe knight swings his spear at %s\\n\",pNAME);\n            printf(\"The knight hits %s for 4 HP\\n\",pNAME);\n            pHP = pHP - 4;\n            printf(\"%s has %d/30 HP\\n\",pNAME,pHP);\n            if (pHP == 0 || pHP &lt;0)\n            {\n                printf(\"\\nYou fell to the ground heavily damages, while the knight lungs at your for the final hit\\n\");\n                printf(\"\\nYou are dead, thanks for playing.\\n\");\n                return 0;\n            }\n            printf(\"\\nWhat do you want to do?\\n\");\n            printf(\"[1] Attack [2] Charge your attack [3] Heal:\"); // Charge and Heal not activated yet\n            scanf(\"%d\",&amp;choice1);\n\n        }\n        else if (knightATKC == 12 || knightATKC == 13 )\n        {\n            printf(\"\\nThe knight slashes his spear at %s\\n\",pNAME);\n            printf(\"The knight critically hit %s for 6 HP\\n\",pNAME);\n            pHP = pHP - 6;\n            printf(\"%s has %d/30 HP\\n\",pNAME,pHP);\n            if (pHP == 0 || pHP &lt;0)\n            {\n                printf(\"\\nYou fell to the ground heavily damages, while the knight lungs at your for the final hit\\n\");\n                printf(\"\\nYou are dead, thanks for playing.\\n\");\n                return 0;\n            }\n            printf(\"\\nWhat do you want to do?\\n\");\n            printf(\"[1] Attack [2] Charge your attack [3] Heal:\"); // Charge and Heal not activated yet\n            scanf(\"%d\",&amp;choice2);\n        }\n        else if (knightATKC == 14)\n        {\n            printf(\"\\nThe knight's horse kicks %s\\n\",pNAME);\n            printf(\"The knight's horse hit %s for 8 HP\\n\",pNAME);\n            pHP = pHP - 8;\n            printf(\"%s has %d/30 HP\\n\",pNAME,pHP);\n            if (pHP == 0 || pHP &lt;0)\n            {\n                printf(\"\\nYou fell to the ground heavily damages, while the knight lungs at your for the final hit\\n\");\n                printf(\"\\nYou are dead, thanks for playing.\\n\");\n                return 0;\n            }\n            printf(\"\\nWhat do you want to do?\\n\");\n            printf(\"[1] Attack [2] Charge your attack [3] Heal:\");\n            scanf(\"%d\",&amp;choice2);\n        }\n        else\n        {\n            printf(\"\\nThe knight swings his spear at %s\\n\",pNAME);\n            printf(\"You blocked his spear with your %s\\n\",pWEAPON);\n            printf(\"%s has %d/30 HP\\n\",pNAME,pHP);\n            printf(\"\\nWhat do you want to do?\\n\");\n            printf(\"[1] Attack [2] Charge your attack [3] Heal:\"); // Charge and Heal not activated yet\n            scanf(\"%d\",&amp;choice2);\n        }\n\n        // Player's turns\n        if (choice2 == 1)\n        {\n            pATKC = rand()%pATKS;\n            if (pATKC == 0 || pATKC == 1 || pATKC == 2 || pATKC == 3 || pATKC == 4 || pATKC == 5 || pATKC == 6 || pATKC == 7 || pATKC == 8 || pATKC == 9)\n            {\n                printf(\"\\nYou swing your %s at the knight\\n\",pWEAPON);\n                printf(\"You hit the knight with your %d\\n\",pATK);\n                knightHP = knightHP - pATK;\n                printf(\"The knight has %d/25\\n\",knightHP);\n                if (knightHP == 0 || knightHP &lt;0)\n                {\n                    printf(\"\\nYou fell to the ground heavily damages, while the knight lungs at your for the final hit\\n\");\n                    printf(\"\\nYou are dead, thanks for playing.\\n\");\n                }\n                printf(\"\\nWhat do you want to do?\\n\");\n                printf(\"[1] Run [2] Attempt to block\\n\");\n                scanf(\"%d\",&amp;choice3);\n            }\n            else if (pATKC == 10)\n            {\n                printf(\"\\nYou swing your %s at the knight\\n\",pWEAPON);\n                printf(\"You critically hit the knight for %f\\n\",pATK * 1.5);\n                knightHP = knightHP - (pATK * 1.5);\n                printf(\"The knight has %d/25\\n\",knightHP);\n                printf(\"\\nWhat do you want to do?\\n\");\n                printf(\"[1] Run [2] Attempt to block\\n\");\n                scanf(\"%d\",&amp;choice3);\n            }\n            else\n            {\n                printf(\"\\nYou swing your %s at the knight\\n\",pWEAPON);\n                printf(\"The knight intercept your %s with his spear\\n\",pWEAPON);\n                printf(\"The knight has %d/25\\n\",knightHP);\n                printf(\"\\nWhat do you want to do?\\n\");\n                printf(\"[1] Run [2] Attempt to block\\n\"); // Not activated yet\n                scanf(\"%d\",&amp;choice3);\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["python", "c++", "c", "gcc", "cython"], "comments": [{"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441202566, "post_id": 32354762, "comment_id": 52583532, "body": "The easiest thing is probably to use one of the Python distributions that come with a compiler already set up e.g. <a href=\"https://winpython.github.io/\" rel=\"nofollow noreferrer\">WinPython</a> or <a href=\"https://store.continuum.io/cshop/anaconda/\" rel=\"nofollow noreferrer\">Anaconda</a>. You&#39;ll probably find the 32 bit versions much easier to get working than the 64 bit versions."}, {"owner": {"reputation": 773, "user_id": 3763498, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b61239d14a111f13f5ed5a51ce4407bb?s=128&d=identicon&r=PG&f=1", "display_name": "Debasish Kanhar", "link": "https://stackoverflow.com/users/3763498/debasish-kanhar"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441225366, "post_id": 32354762, "comment_id": 52597565, "body": "Hi. Thanks for the quick reply. I followed <a href=\"https://github.com/cython/cython/wiki/InstallingOnWindows\" rel=\"nofollow noreferrer\">github.com/cython/cython/wiki/InstallingOnWindows</a> to install Cython on Anaconda, Configured by PyCharm to use Anaconda Interpreter. And <a href=\"http://docs.cython.org/src/tutorial/cython_tutorial.html#cython-hello-world\" rel=\"nofollow noreferrer\">docs.cython.org/src/tutorial/&hellip;</a> to build a simple program. I&#39;m able to create .c file. When I compile it using MS VC++ Command Prompt using &quot;cl /EHsc test.c&quot; it says &quot;Fatal Error : No Python.h&quot;. Also followed <a href=\"https://github.com/cython/cython/wiki/CythonExtensionsOnWindows\" rel=\"nofollow noreferrer\">github.com/cython/cython/wiki/CythonExtensionsOnWindows</a> this to setup variables."}, {"owner": {"reputation": 773, "user_id": 3763498, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b61239d14a111f13f5ed5a51ce4407bb?s=128&d=identicon&r=PG&f=1", "display_name": "Debasish Kanhar", "link": "https://stackoverflow.com/users/3763498/debasish-kanhar"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441225529, "post_id": 32354762, "comment_id": 52597625, "body": "Also, if I try doing import test from iPython notebook (Of Anaconda) I dont get any output of test.pyx file. When I try to do import, does it import .c file or .pyx? So how do I make my python script faster? Sorry for deviating from topic. Is &quot;Import filename&quot; enough to make faster version of script or compiling and running the executable from .c file is faster method?"}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441265568, "post_id": 32354762, "comment_id": 52610679, "body": "I don&#39;t know why it isn&#39;t working - I think you have to compile from the Anaconda command line with a correctly set up environment? (but I don&#39;t actually use Anaconda myself...) These type of problems are often very difficult to solve, so I&#39;m reluctant to get involved too much further. [For your second question: when you type import filename it loads filename.dll, which it builds from the .c file. Any functions in that should run faster]"}, {"owner": {"reputation": 773, "user_id": 3763498, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b61239d14a111f13f5ed5a51ce4407bb?s=128&d=identicon&r=PG&f=1", "display_name": "Debasish Kanhar", "link": "https://stackoverflow.com/users/3763498/debasish-kanhar"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441266558, "post_id": 32354762, "comment_id": 52611259, "body": "Hi, I did proceed in the error I was facing, and somehow resolved the issue of include but now facing with new error. Kindly see my edit to question."}, {"owner": {"reputation": 773, "user_id": 3763498, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b61239d14a111f13f5ed5a51ce4407bb?s=128&d=identicon&r=PG&f=1", "display_name": "Debasish Kanhar", "link": "https://stackoverflow.com/users/3763498/debasish-kanhar"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441267015, "post_id": 32354762, "comment_id": 52611550, "body": "Have edited the question. Kindly have a look."}], "owner": {"reputation": 773, "user_id": 3763498, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b61239d14a111f13f5ed5a51ce4407bb?s=128&d=identicon&r=PG&f=1", "display_name": "Debasish Kanhar", "link": "https://stackoverflow.com/users/3763498/debasish-kanhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 901, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441266957, "creation_date": 1441201078, "last_edit_date": 1495541704, "question_id": 32354762, "link": "https://stackoverflow.com/questions/32354762/unable-to-compile-cython-generated-c-file", "title": "Unable to compile cython generated .c file", "body": "<p>I'm pretty new to python and newer to cython. Since I realized cython is better for me as it is pretty fast, I decided to switch to cython by creating .c files of each .pyx files and I try to compile them manually using the following various techniques:</p>\n\n<p>I create .c file from .pyx using following :\nI create setup.py file </p>\n\n<pre><code>from distutils.core import setup\nfrom Cython.Build import cythonize\n\n    setup(\n        name = \"My hello app\",\n        ext_modules = cythonize(\"test.pyx\"),\n    )\n</code></pre>\n\n<p>It creates a test.c file in same directory. When I try to compile the file using Dev C++, I get following error :</p>\n\n<p><strong>18        C:\\crossdev\\src\\mingw-w64-v3-git\\mingw-w64-crt\\crt\\crt0_c.c undefined reference to `WinMain'</strong></p>\n\n<p>I also tried building .pyx into .c from command prompt using following command :</p>\n\n<pre><code>cython test.pyx\n</code></pre>\n\n<p>and then doing the following from command prompt to compile using gcc:</p>\n\n<pre><code>python setup.py build_ext --inplace\n</code></pre>\n\n<p>to create .c file which again fail to compile.</p>\n\n<p>If I try <a href=\"https://stackoverflow.com/questions/6985109/how-to-compile-c-code-from-cython-with-gcc\">following this link</a> to compile .c file generated by manually including path for Python Includes, <a href=\"https://i.stack.imgur.com/75jKf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/75jKf.png\" alt=\"I get following error\"></a>. </p>\n\n<p>I get following error.</p>\n\n<p>PS : I used the <strong>gcc -c -IC:\\Python27\\include -o test.o test.c</strong> comand from command line to compile the .c file</p>\n\n<p>PS2 : If I tried manually compiling from cygwin's gcc, it said <strong>Fatal Error : No file named Python.h</strong></p>\n\n<p>PS3 : I've manually entered paths for include dirs and libraries in Dev C++ compiler options but the issue persists. The exact error message is as follows :</p>\n\n<p><a href=\"https://i.stack.imgur.com/8I1Bs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8I1Bs.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried everything I can find on internet but unable to get any proper solution and I've been facing this issue this since almost a month for which I'm kinda missing deadlines. So It would be very helpful if anyone can guide me in correct path on how to compile .c files generated from Cython.</p>\n\n<p>Thanks in advance</p>\n\n<p><strong>EDIT 1 :</strong> I tried the following command to compile my .c file : (In VC++ 2008)\nE:\\My Proj Dir>cl /EHsc test.c /I C:\\Python27\\include /link C:\\Python27\\libs\\libpython27.a /MACHINE:AMD64 </p>\n\n<p>Also tried E:\\My Proj Dir>cl /EHsc test.c /I C:\\Python27\\include /LIBPATH C:\\Python27\\libs\\libpython27.a /MACHINE:AMD64 </p>\n\n<p>I get following error : \nlibpython27.a(dmmeh.o) : fatal error LNK1112: module machine type 'x64' conflicts with target machine type 'X86'</p>\n\n<p>When I tried using /MACHINE:x64, I face the following<br>\ntest.obj : fatal error LNK1112: module machine type 'X86' conflicts with target machine type 'x64'</p>\n\n<p>PS : I got AMD64 by importing <strong>platform</strong> module in my itnterpreter and running platform.machine()</p>\n"}, {"tags": ["c", "arrays", "function", "multidimensional-array"], "comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 1, "creation_date": 1441201038, "post_id": 32354670, "comment_id": 52582428, "body": "Did you try to compile with, eg for gcc, <code>-Wall</code>?"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1441201100, "post_id": 32354670, "comment_id": 52582492, "body": "That gave a warning .Compile and see ."}, {"owner": {"reputation": 839, "user_id": 2706918, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wDDMU.jpg?s=128&g=1", "display_name": "Nitinkumar Ambekar", "link": "https://stackoverflow.com/users/2706918/nitinkumar-ambekar"}, "edited": false, "score": 0, "creation_date": 1441202003, "post_id": 32354670, "comment_id": 52583148, "body": "Have you go through <a href=\"http://stackoverflow.com/q/7784758/2706918\">this question</a>? You should! :)"}, {"owner": {"reputation": 108, "user_id": 5192037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/902699c776a375c8cfae2cce628d00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Luna", "link": "https://stackoverflow.com/users/5192037/luna"}, "edited": false, "score": 0, "creation_date": 1441277240, "post_id": 32354670, "comment_id": 52618015, "body": "Thank you NTN. That was a really nice page in helping understanding multidimensional arrays!"}], "answers": [{"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": false, "score": 0, "last_activity_date": 1441202029, "creation_date": 1441202029, "answer_id": 32355130, "question_id": 32354670, "link": "https://stackoverflow.com/questions/32354670/multidimensional-arrays-understanding-for-c/32355130#32355130", "title": "Multidimensional arrays understanding for c", "body": "<p>Your code is probably not doing what you want. Compile with <code>Wall</code> and you will see some warnings.</p>\n\n<p>You need to change <code>print</code> argument to accept a 2D array (now you are passing <code>int (*)[2]</code> but the function is expecting <code>int *</code>), and then you can print the values correctly.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid print (int ar[][2]);\n\nint main () {\n    int array[2][2] = {\n        {1,2},\n        {3,4}\n    };\n    print(array);\n    return 0;\n}\n\nvoid print (int ar[][2]) {\n    printf(\"%d\\n\", ar[0][0]); // 1\n    printf(\"%d\\n\", ar[1][0]); // 4\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11196, "user_id": 1079907, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a7c69e39fbec2c781db5f27b40f63023?s=128&d=identicon&r=PG", "display_name": "Sunil Bojanapally", "link": "https://stackoverflow.com/users/1079907/sunil-bojanapally"}, "is_accepted": false, "score": 2, "last_activity_date": 1441202058, "creation_date": 1441202058, "answer_id": 32355145, "question_id": 32354670, "link": "https://stackoverflow.com/questions/32354670/multidimensional-arrays-understanding-for-c/32355145#32355145", "title": "Multidimensional arrays understanding for c", "body": "<p>If you are passing a two-dimensional array to a function:</p>\n\n<pre><code>int array[NROWS][NCOLUMNS];\nprint(array);\n</code></pre>\n\n<p>the function's declaration must match:</p>\n\n<pre><code>void print(int array[][NCOLUMNS])\n{ ... }\n</code></pre>\n\n<p>or</p>\n\n<pre><code>void print(int (*ap)[NCOLUMNS]) /* ap is a pointer to an array */\n{ ... }\n</code></pre>\n\n<p>The 2D arrays which is array of arrays decays a pointer to an array rather than a pointer to a pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1441203306, "post_id": 32355158, "comment_id": 52584084, "body": "<code>void print(int (*)[*])</code>?"}, {"owner": {"reputation": 1676, "user_id": 1637737, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/609f5145b41cadbe3e68a4f3f24d822f?s=128&d=identicon&r=PG", "display_name": "Mic1780", "link": "https://stackoverflow.com/users/1637737/mic1780"}, "edited": false, "score": 0, "creation_date": 1441203308, "post_id": 32355158, "comment_id": 52584087, "body": "Well done actaully answering the question instead of just telling the op the mistake in their code. +1"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1441203714, "post_id": 32355158, "comment_id": 52584357, "body": "@EOF, yes, that should work too, provided you&#39;re not limited by a requirement for C90 compliance.  I imagine that&#39;s not an issue for most people."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1441204087, "post_id": 32355158, "comment_id": 52584627, "body": "@EOF, or at least it works for argument agreement.  It does not work if you want to be able to evaluate <code>ar + 1</code>, because that requires <code>*ar</code> to have fixed, statically-known size."}, {"owner": {"reputation": 108, "user_id": 5192037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/902699c776a375c8cfae2cce628d00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Luna", "link": "https://stackoverflow.com/users/5192037/luna"}, "edited": false, "score": 0, "creation_date": 1441278556, "post_id": 32355158, "comment_id": 52618773, "body": "Thank you @JohnBollinger for the help. So essentially, I am passing the wrong type to the print function."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 108, "user_id": 5192037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/902699c776a375c8cfae2cce628d00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Luna", "link": "https://stackoverflow.com/users/5192037/luna"}, "edited": false, "score": 0, "creation_date": 1441292008, "post_id": 32355158, "comment_id": 52628608, "body": "@Luna, the type of your actual argument does not match the declared type of the function parameter, yes.  This is a problem with your code, yes -- its behavior is formally undefined, though in practice it can pretty reliably be expected to behave consistently, as described.  If you make one of the latter two changes, then the (updated) second <code>printf()</code> call will print the value that can be accessed in <code>main()</code> as <code>array[1][0]</code>.  If that all is what you mean by &quot;essentially&quot;, then overall, yes."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1441203982, "last_edit_date": 1441203982, "creation_date": 1441202096, "answer_id": 32355158, "question_id": 32354670, "link": "https://stackoverflow.com/questions/32354670/multidimensional-arrays-understanding-for-c/32355158#32355158", "title": "Multidimensional arrays understanding for c", "body": "<blockquote>\n  <p>So let's say if [I]'m passing <code>array</code> to function <code>print</code>. Am I passing address of the first 1-D array (<code>array[0]</code>) or am [I] just passing the address of the very first variable (<code>array[0][0]</code>).</p>\n</blockquote>\n\n<p>You are passing a pointer to the first element of <code>array</code>, <code>array[0]</code>, which is itself an array.  That pointer has the same value as a pointer to <code>array[0][0]</code>, but different type.  In fact, your code is incorrect in that the argument's type and the function parameter's type do not agree, but as long as the types <code>int(*)[]</code> and <code>int *</code> have the same representation, the reinterpretation will work in practice.</p>\n\n<blockquote>\n  <p>And as for the <code>print</code> function, in this case, am I correct to say that by printing <code>ar[0]</code>, I am printing <code>array[0][0]</code>?</p>\n</blockquote>\n\n<p>Yes, when you call <code>print()</code> as you do in your example, provided that type representations agree as described above.</p>\n\n<blockquote>\n  <p>But why is it that for the case of printing <code>*(ar+1)</code>, I am actually printing <code>array[0][1]</code> instead of <code>array[1][0]</code>?</p>\n</blockquote>\n\n<p>Because <code>ar</code> is a pointer to the first element of <code>array</code>, i.e. the 1D array <code>array[0]</code>.  Its elements are <code>array[0][0]</code>, <code>array[0][1]</code>, etc..  <code>ar + 1</code> is therefore a pointer to the second element of <code>array[0]</code>, which is <code>array[0][1]</code>.</p>\n\n<p>You have two options to make your code correct, both of which might help clarify the issues involved.  You could change the argument you pass to <code>print()</code> to agree with the function:</p>\n\n<pre><code>print(array[0]);\n</code></pre>\n\n<p>Alternatively, you could change the declared type of <code>print()</code>'s argument, whith a corresponding alteration to its use:</p>\n\n<pre><code>void print(int (*ar)[2]) {\n    printf(\"%d\\n\", ar[0][0]);\n    printf(\"%d\\n\", *(ar+1)[0]);\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>void print(int ar[][2]) {\n    printf(\"%d\\n\", ar[0][0]);\n    printf(\"%d\\n\", *(ar+1)[0]);\n}\n</code></pre>\n\n<p>The latter two change the meaning of <code>*(ar + 1)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1676, "user_id": 1637737, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/609f5145b41cadbe3e68a4f3f24d822f?s=128&d=identicon&r=PG", "display_name": "Mic1780", "link": "https://stackoverflow.com/users/1637737/mic1780"}, "is_accepted": false, "score": 0, "last_activity_date": 1441202652, "creation_date": 1441202652, "answer_id": 32355368, "question_id": 32354670, "link": "https://stackoverflow.com/questions/32354670/multidimensional-arrays-understanding-for-c/32355368#32355368", "title": "Multidimensional arrays understanding for c", "body": "<p>When you pass an array to a function, you are using \"pass-by-reference\" meaning you pass the address of the array.</p>\n\n<ul>\n<li>Am I passing address of the first 1-D array (array[0]) or am i just passing the address of the very first variable (array[0][0]).</li>\n</ul>\n\n<p>No. The way you are passing array currently you are giving the function the 2-D array.</p>\n\n<ul>\n<li>And as for the print function, in this case, am I correct to say that by printing ar[0], I am printing array[0][0]?</li>\n</ul>\n\n<p>No. You still need to specify the number you want to print from ar[0]</p>\n\n<ul>\n<li>But why is it that for the case of printing *(ar+1), I am actually printing array[0][1] instead of array[1][0]?</li>\n</ul>\n\n<p>This is because you are telling the program to go to array in memory and use pointer arithmetic to traverse the array. For example, if you have a <code>char * str</code> variable that contains characters <code>abcde\\0</code> and want to get the character at position 2 you can either do <code>str[2]</code> or <code>*(str+2)</code> which means the same thing and both give the character <code>'c'</code>.</p>\n"}], "owner": {"reputation": 108, "user_id": 5192037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/902699c776a375c8cfae2cce628d00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Luna", "link": "https://stackoverflow.com/users/5192037/luna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 32355158, "answer_count": 4, "score": 0, "last_activity_date": 1441206262, "creation_date": 1441200842, "question_id": 32354670, "link": "https://stackoverflow.com/questions/32354670/multidimensional-arrays-understanding-for-c", "title": "Multidimensional arrays understanding for c", "body": "<p>I have a question regarding passing an array to another function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid print (int ar[]);\n\nmain () {\n    int array[2][2] = {1,2,3,4};\n    print(array);\n}\n\nvoid print (int ar[]) {\n    printf(\"%d\\n\", ar[0]);\n    printf(\"%d\\n\", *(ar+1));\n}\n</code></pre>\n\n<p>So let's say if i'm passing array to function print. Am I passing address of the first 1-D array (array[0]) or am i just passing the address of the very first variable (array[0][0]). </p>\n\n<p>And as for the print function, in this case, am I correct to say that by printing ar[0], I am printing array[0][0]? </p>\n\n<p>But why is it that for the case of printing *(ar+1), I am actually printing array[0][1] instead of array[1][0]?</p>\n\n<p>Thank you everyone in advance!</p>\n"}, {"tags": ["c", "gcc", "linker-errors"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441200827, "post_id": 32354466, "comment_id": 52582256, "body": "You are using <code>clang</code>, not <code>gcc</code>.  The Makefile explicitly specifies it, and the error message clearly indicates it.  If you want good help then do get your story (and tags) straight."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441201218, "post_id": 32354466, "comment_id": 52582570, "body": "Though the error message is a bit unclear, it could well be caused by the absence of a <code>main()</code> function in <code>snake.c</code>.  The <code>main()</code> function is your program&#39;s entry point; every program must have exactly one, defined somewhere among its source files."}, {"owner": {"reputation": 17, "user_id": 5288257, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c187be454fb9d10bd5429c987d5a541?s=128&d=identicon&r=PG&f=1", "display_name": "Philip94", "link": "https://stackoverflow.com/users/5288257/philip94"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441204265, "post_id": 32354466, "comment_id": 52584761, "body": "Hi John, thanks for your help"}, {"owner": {"reputation": 17, "user_id": 5288257, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c187be454fb9d10bd5429c987d5a541?s=128&d=identicon&r=PG&f=1", "display_name": "Philip94", "link": "https://stackoverflow.com/users/5288257/philip94"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441204339, "post_id": 32354466, "comment_id": 52584821, "body": "the snake.c file has an empty main-function Do I have to type &quot;gcc&quot; instead of &quot;clang&quot; in the Makefile?"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 2481131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354fc735a3fd8891770b73ea86c9e2fc?s=128&d=identicon&r=PG", "display_name": "Rajavelu Prabhu", "link": "https://stackoverflow.com/users/2481131/rajavelu-prabhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1441200922, "creation_date": 1441200922, "answer_id": 32354700, "question_id": 32354466, "link": "https://stackoverflow.com/questions/32354466/gcc-compiler-error-linker-command-failed/32354700#32354700", "title": "GCC Compiler error linker command failed", "body": "<p>check the Architecture based on that the cflags shoule be updated to set to -m32 or -m64 ,\nfor successful compilation in 64 bit machine this has to set to -m64.</p>\n\n<p>CFLAGS+= -m64</p>\n"}], "owner": {"reputation": 17, "user_id": 5288257, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c187be454fb9d10bd5429c987d5a541?s=128&d=identicon&r=PG&f=1", "display_name": "Philip94", "link": "https://stackoverflow.com/users/5288257/philip94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 463, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1526210581, "creation_date": 1441200280, "last_edit_date": 1526210581, "question_id": 32354466, "link": "https://stackoverflow.com/questions/32354466/gcc-compiler-error-linker-command-failed", "title": "GCC Compiler error linker command failed", "body": "<p>I have the following C File and I am using Mac OS X GCC Compiler.\nYou find the error below.</p>\n\n<pre><code>#include \"support.h\"\n\n#ifdef _WIN32\n\n#include &lt;conio.h&gt;\n\nvoid support_init() {\n    // not needed\n}\n\nvoid support_clear() {\n    system(\"CLS\");\n}\n\nint support_readkey(int timeout_ms) {\n    Sleep(timeout_ms);\n    if (!kbhit()) return 0;\n    return getch();\n}\n\n#else\n\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;sys/select.h&gt;\n\nvoid support_init() {\n    struct termios tio;\n    tcgetattr(STDIN_FILENO, &amp;tio);\n    tio.c_lflag &amp;= (~ICANON &amp; ~ECHO);\n    tcsetattr(STDIN_FILENO, TCSANOW, &amp;tio);\n}\n\nvoid support_clear() {\n    printf(\"\\x1B[2J\\x1B[0;0f\");\n}\n\nint support_readkey(int timeout_ms) {\n    struct timeval tv = { 0L, timeout_ms * 1000L };\n    fd_set fds;\n    FD_ZERO(&amp;fds);\n    FD_SET(0, &amp;fds);\n    int r = select(1, &amp;fds, NULL, NULL, &amp;tv);\n    if (!r) return 0;\n\n    return getchar();\n}\n\n#endif\n</code></pre>\n\n<p>And this is my Makefile:</p>\n\n<pre><code>CFLAGS=-std=c11 -Wall -g\nCC=clang\n\nall: snake\n\n.PHONY: all clean\n\nsnake: snake.o support.o\n\nsnake.o: snake.c support.h\n\nclean:\n    rm -f snake\n    rm -f snake.o support.o\n</code></pre>\n\n<p>When I try to compile with the command \"make all\" I get the following error:</p>\n\n<pre><code>ld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see         \ninvocation)\n</code></pre>\n\n<p>Please help. I am new to C :-)</p>\n"}, {"tags": ["c++", "c", "linux"], "comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 15, "creation_date": 1441199719, "post_id": 32354233, "comment_id": 52581447, "body": "Easy solution: slice it off: <code>argv++; argc--;</code>"}, {"owner": {"reputation": 432, "user_id": 2732564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wccrq.jpg?s=128&g=1", "display_name": "Asim", "link": "https://stackoverflow.com/users/2732564/asim"}, "edited": false, "score": 0, "creation_date": 1441200853, "post_id": 32354233, "comment_id": 52582274, "body": "Trick: You cannot modify the strings belonging to read only memory, just stop pointing to them."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1441248889, "post_id": 32354233, "comment_id": 52604601, "body": "<i>&quot;usually done by <code>getopt_long()</code>&quot;</i>. What did you mean by that. Are you going to use <code>getopt_long()</code> or not?"}, {"owner": {"reputation": 7035, "user_id": 2945958, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/K4Ig3.jpg?s=128&g=1", "display_name": "Mostafa Talebi", "link": "https://stackoverflow.com/users/2945958/mostafa-talebi"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1441286816, "post_id": 32354233, "comment_id": 52624720, "body": "@user3386109 I am going to use it. What I have done is using a loop and simply creating a new array."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1441301895, "post_id": 32354233, "comment_id": 52634659, "body": "If you&#39;re going to use <code>getopt_long</code>, then the correct answer is, &quot;You don&#39;t have to do anything, <code>getopt_long</code> automatically skips the first argument.&quot;"}, {"owner": {"reputation": 7035, "user_id": 2945958, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/K4Ig3.jpg?s=128&g=1", "display_name": "Mostafa Talebi", "link": "https://stackoverflow.com/users/2945958/mostafa-talebi"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1441430264, "post_id": 32354233, "comment_id": 52687286, "body": "@user3386109 I know that buddy, I want it to escape the second argument, too."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1441431257, "post_id": 32354233, "comment_id": 52687465, "body": "Yes, and there is a correct way to do that, buddy. What you want to do is ignore the &quot;get&quot; in the command line, which is easily done, and the answer you accepted is not the right way to do it."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "reply_to_user": {"reputation": 432, "user_id": 2732564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wccrq.jpg?s=128&g=1", "display_name": "Asim", "link": "https://stackoverflow.com/users/2732564/asim"}, "edited": false, "score": 0, "creation_date": 1562882863, "post_id": 32354233, "comment_id": 100529586, "body": "@Asim, there is no read-only memory involved here. Neither <code>argc</code>, <code>argv</code> or <i>the characters pointed by it</i> are read-only, and this by design, so that the program can erase the data if it wants."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4677917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea37ed56d2c80b91890d64568e7943d?s=128&d=identicon&r=PG", "display_name": "AntumDeluge", "link": "https://stackoverflow.com/users/4677917/antumdeluge"}, "edited": false, "score": 0, "creation_date": 1568234757, "post_id": 32354522, "comment_id": 102214269, "body": "Wow! Such a simple solution. Thank you so much!"}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": true, "score": 13, "last_activity_date": 1562882579, "last_edit_date": 1562882579, "creation_date": 1441200405, "answer_id": 32354522, "question_id": 32354233, "link": "https://stackoverflow.com/questions/32354233/c-editing-the-elements-of-char-argv/32354522#32354522", "title": "C++ editing the elements of char* argv[]", "body": "<p>Increment the <code>argv</code> pointer, and decrement the <code>argc</code>.\nExample:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    argc--;\n    argv++;\n\n    return 0;\n}\n</code></pre>\n\n<p>This works, because when you increment <code>argv</code>, you still have the previous data in memory, it's just that the base address of the <code>argv</code> has increased. And you decrement <code>argc</code>, because you now have one less argument.</p>\n"}], "owner": {"reputation": 7035, "user_id": 2945958, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/K4Ig3.jpg?s=128&g=1", "display_name": "Mostafa Talebi", "link": "https://stackoverflow.com/users/2945958/mostafa-talebi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 0, "accepted_answer_id": 32354522, "answer_count": 1, "score": 5, "last_activity_date": 1562882579, "creation_date": 1441199655, "question_id": 32354233, "link": "https://stackoverflow.com/questions/32354233/c-editing-the-elements-of-char-argv", "title": "C++ editing the elements of char* argv[]", "body": "<p>All of you know this function:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n\n}\n</code></pre>\n\n<p>I want to write a command line interface in Linux for my program, which is usually done by <code>getopt_long()</code></p>\n\n<p>My program would be executed from command line like this:</p>\n\n<pre><code>pop3 get --limit 25 --recent \n</code></pre>\n\n<p>Hence, the <code>argv[]</code> would include <code>pop3</code> as its program name, and the rest are treated as options.\nI want to delete <code>pop3</code> from my string and set the first token after it as the first element of the array. Is there a way to do that other than looping through?</p>\n"}, {"tags": ["c", "xively", "sim900"], "owner": {"reputation": 11, "user_id": 4550209, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3syK2IOp7aI/AAAAAAAAAAI/AAAAAAAAAgs/p_KtUaiNG8Y/photo.jpg?sz=128", "display_name": " Shanu", "link": "https://stackoverflow.com/users/4550209/shanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441199466, "creation_date": 1441199298, "last_edit_date": 1441199466, "question_id": 32354085, "link": "https://stackoverflow.com/questions/32354085/sending-data-to-xively-using-arduino-mega-gsm-shield-sim-900", "title": "Sending data to Xively using Arduino mega + GSM shield sim 900", "body": "<p>I want to send my sensor data to xively using GSM shield SIM900. After running my code i am getting 0 as a response from server. Please help me to figure out what's the issue? I am using rhydolabz's GSM SIM900 module with adriuno</p>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\n//#include \"tmp102.h\"\n//Please fetch tmp102.h and tmp102.cpp from \"Stlker logger AM06 Serial.zip\"\n//available from Seeeduino Stalker v2.0's Wiki Page\n#include &lt;Wire.h&gt;\nfloat temp=23.65; // We then need to multiply our two bytes by a scaling factor, mentioned in the datasheet.\n//int tmp102_val; // an int is capable of storing two bytes, this is where we    \"chuck\" the two bytes together.\nSoftwareSerial GPRS_Serial(7, 8);\nvoid setup()\n{\nGPRS_Serial.begin(19200); //GPRS Shield baud rate\nSerial.begin(19200);\n//tmp102_init();\nsetup_start:\nSerial.println(\"Turn on GPRS Modem and wait for 1 minute.\");\nSerial.println(\"and then press a key\");\nSerial.println(\"Press c for power on configuration\");\nSerial.println(\"press any other key for uploading\");\nSerial.flush();\nwhile(Serial.available() == 0);\nif(Serial.read()=='c')\n{\nSerial.println(\"Executing AT Commands for one time power on configuration\");\nGPRS_Serial.flush();\nGPRS_Serial.println(\"ATE0\"); //Command echo off\nSerial.println(\"ATE0 Sent\");\nif(GPRS_Serial_wait_for_bytes(4,10) == 0)\n{\nSerial.println(\"Timeout\");\ngoto setup_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.println(\"AT+CIPMUX=0\"); //We only want a single IP Connection at a time.\nSerial.println(\"AT+CIPMUX=0 Sent\");\nif(GPRS_Serial_wait_for_bytes(4,10) == 0)\n{\nSerial.println(\"Timeout\");\ngoto setup_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.println(\"AT+CIPMODE=0\"); //Selecting \"Normal Mode\" and NOT \"Transparent Mode\" as the TCP/IP Application Mode\nSerial.println(\"AT+CIPMODE=0 Sent!\");\nif(GPRS_Serial_wait_for_bytes(4,10) == 0)\n{\nSerial.println(\"Timeout\");\ngoto setup_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.println(\"AT+CSTT=\\\"portalnmms\\\",\\\"\\\"\");\nGPRS_Serial.println(\"AT+CIFSR\");//Defining the Packet Data\n//Protocol Context - i.e. the Protocol Type, Access Point Name and IP Address\n//Serial.println(\"AT+CGDCONT=1,\\\"IP\\\",\\\"TATA.DOCOMO.INTERNET\\\",\\\"10.6.6.6\\\",0,0 Sent!\");\nif(GPRS_Serial_wait_for_bytes(4,10) == 0)\n{\nSerial.println(\"Timeout\");\ngoto setup_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.println(\"AT+CSTT=\\\"portalnmms\\\",\\\"\\\"\"); //Start Task and set Access Point Name (and username and password if any)\nSerial.println(\"AT+CSTT=\\\"portalnmms\\\" Sent!\");\nif(GPRS_Serial_wait_for_bytes(4,10) == 0)\n{\nSerial.println(\"Timeout\");\ngoto setup_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.println(\"AT+CIPSHUT\"); //Close any GPRS Connection if open\nSerial.println(\"AT+CIPSHUT Sent!\");\nif(GPRS_Serial_wait_for_bytes(7,10) == 0)\n{\nSerial.println(\"Timeout\");\ngoto setup_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\n}\n}\nvoid loop()\n{\nloop_start:\nSerial.println(\"Press a key to read temperature and upload it\");\nSerial.flush();\nwhile(Serial.available()==0);\nSerial.read();\n//getTemp102();\nSerial.print(\"Temperature = \");\nSerial.println(temp);\nGPRS_Serial.println(\"AT+CIPSTART=\\\"TCP\\\",\\\"api.xively.com\\\",\\\"80\\\"\"); //Open a connection to Pachube.com\nSerial.println(\"AT+CIPSTART=\\\"TCP\\\",\\\"api.xively.com\\\",\\\"80\\\" Sent!\");\nif(GPRS_Serial_wait_for_bytes(12,255) == 0)\n{\nSerial.println(\"Timeout\");\ngoto loop_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.flush();\nGPRS_Serial.println(\"AT+CIPSEND\"); //Start data through TCP connection\nSerial.println(\"AT+CIPSEND Sent!\");\nif(GPRS_Serial_wait_for_bytes(1,100) == 0)\n{\nSerial.println(\"Timeout\");\ngoto loop_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.flush();\n//Emulate HTTP and use PUT command to upload temperature datapoint using Comma Seperate Value Method\nGPRS_Serial.print(\"PUT /v2/feeds/974506916 / HTTP/1.1\\r\\n\");\nSerial.println(\"PUT /v2/feeds/974506916 HTTP/1.1 Sent!\");\ndelay(300);\nGPRS_Serial.print(\"Host: api.xively.com\\r\\n\");\nSerial.println(\"Host: api.xively.com Sent!\");\ndelay(300);\nGPRS_Serial.print(\"X-xivelyKey: pzjRnAI2EANrdQwaJmOUCIRJkcaKSUG7Q5xpWCAw39DAD\\r\\n\"); //REPLACE THIS KEY WITH YOUR OWN PACHUBE API KEY\nSerial.println(\"X-xivelyApiKey: pzjRnAI2EANrdQwaJmOUCIRJkcaKSUG7Q5xpWCAw39DAD Sent!\"); //REPLACE THIS KEY WITH YOUR OWN PACHUBE API KEY\ndelay(300);\nGPRS_Serial.print(\"Content-Length: 12\\r\\n\");\nSerial.print(\"Content-Length: 12 Sent!\");\ndelay(300);\nGPRS_Serial.print(\"Connection: close\\r\\n\\r\\n\");\nSerial.print(\"Connection: close Sent!\");\ndelay(300);\nGPRS_Serial.print(\"Temperature,\"); //You may replace the stream name \"TMP102\" to any other string that you have choosen.\ndelay(300);\nGPRS_Serial.print(temp);\ndelay(300);\nGPRS_Serial.print(\"\\r\\n\");\ndelay(300);\nGPRS_Serial.print(\"\\r\\n\");\ndelay(300);\nGPRS_Serial.print(Serial.write(0x1A));\ndelay(300); //Send End Of Line Character to send all the data and close connection\nif(GPRS_Serial_wait_for_bytes(20,255) == 0)\n{\nSerial.println(\"Timeout\");\ngoto loop_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\nGPRS_Serial.flush();\nGPRS_Serial.println(\"AT+CIPSHUT\"); //Close the GPRS Connection\nSerial.println(\"AT+CIPSHUT Sent!\");\nif(GPRS_Serial_wait_for_bytes(4,100) == 0)\n{\nSerial.println(\"Timeout\");\ngoto loop_start;\n}\nelse\n{\nSerial.print(\"Received:\");\nwhile(GPRS_Serial.available()!=0)\n{\nSerial.print((unsigned char)GPRS_Serial.read());\nSerial.print(\"\\n\");\n}\n}\n}\nchar GPRS_Serial_wait_for_bytes(char no_of_bytes, int timeout)\n{\nwhile(GPRS_Serial.available() &lt; no_of_bytes)\n{\ndelay(200);\ntimeout-=1;\nif(timeout == 0)\n{\nreturn 0;\n}\n}\nreturn 1;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1441199163, "post_id": 32353930, "comment_id": 52581027, "body": "My advice: don&#39;t write code that executes undefined behavior, like reading <code>s[i]</code> does while the array&#39;s contents are uninitialized."}, {"owner": {"reputation": 1377, "user_id": 4562921, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O8Bzx03gva0/AAAAAAAAAAI/AAAAAAAAADg/xEC18jxce6g/photo.jpg?sz=128", "display_name": "Stepan Novikov", "link": "https://stackoverflow.com/users/4562921/stepan-novikov"}, "edited": false, "score": 0, "creation_date": 1441199390, "post_id": 32353930, "comment_id": 52581207, "body": "Looks like you missed  space for &quot;-&quot;. Try if(k==3 || k == 7)   {   k++;   } instead of if(k==3)  {  k++;  }"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1441199406, "post_id": 32353930, "comment_id": 52581222, "body": "Sure you can, @ameyCU.  <i>Reading</i> array elements before they have been initialized produces undefined behavior, but you can <i>write</i> to any subset of the array elements, in any order."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1441199721, "post_id": 32353930, "comment_id": 52581449, "body": "You never use the characters you read. Looks like you either intended to store the characters you read in <code>s</code>, or intended to read a whole string into <code>s</code>."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441199759, "post_id": 32353930, "comment_id": 52581479, "body": "@JohnBollinger  Ohh  sorry then ,never really gave it a thought . Thanks for correcting me !! :)"}, {"owner": {"reputation": 21, "user_id": 5290421, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vN7DNDs5Y7U/AAAAAAAAAAI/AAAAAAAAACo/KvtpDgm8dBg/photo.jpg?sz=128", "display_name": "Horlic Vince", "link": "https://stackoverflow.com/users/5290421/horlic-vince"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1441200190, "post_id": 32353930, "comment_id": 52581781, "body": "@molbdnilo what do you mean?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441200584, "post_id": 32353930, "comment_id": 52582074, "body": "@HorlicVince, molbdnilo is pointing out that although you declare array <code>s</code>, you never initialize it with anything.  You are reading data from your file a character at a time, into variable <code>ch</code>.  That is the variable that contains the next character to analyze, not <code>s[i]</code>.  Moreover, your inner <code>for</code> loop is therefore bogus.  The outer <code>while</code> loop covers all the iteration you need -- at least for handling a single line, which is all your code is set up to do."}, {"owner": {"reputation": 21, "user_id": 5290421, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vN7DNDs5Y7U/AAAAAAAAAAI/AAAAAAAAACo/KvtpDgm8dBg/photo.jpg?sz=128", "display_name": "Horlic Vince", "link": "https://stackoverflow.com/users/5290421/horlic-vince"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441200705, "post_id": 32353930, "comment_id": 52582165, "body": "@JohnBollinger please bear with me, i just learned file handling yesterday. Can you please help me with this? Sorry, im just a beginner."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1441200722, "post_id": 32353930, "comment_id": 52582181, "body": "Also you try to print a <code>int array</code> with specifier <code>%s</code> ."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1441211602, "post_id": 32353930, "comment_id": 52589853, "body": "What happens if your input is <code>123456789</code> or <code>12345678901</code> or <code>123cat7890</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1441201558, "post_id": 32354634, "comment_id": 52582808, "body": "There is little room for different schools of thought when it comes to the expected types of <code>printf()</code> arguments.  An argument corresponding to a <code>%s</code> field descriptor will be interpreted as a <code>char *</code>, and <code>printf()</code> exhibits undefined behavior if the actual type is incompatible, as the <code>int *</code> in the OP&#39;s code is."}], "tags": [], "owner": {"reputation": 3478, "user_id": 796647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89859e413cdf94615d3856da17dce6c3?s=128&d=identicon&r=PG", "display_name": "Prof Von Lemongargle", "link": "https://stackoverflow.com/users/796647/prof-von-lemongargle"}, "is_accepted": false, "score": 2, "last_activity_date": 1441200740, "creation_date": 1441200740, "answer_id": 32354634, "question_id": 32353930, "link": "https://stackoverflow.com/questions/32353930/file-handling-character-manipulation/32354634#32354634", "title": "File Handling + character manipulation", "body": "<p>This looks like an assignment from a first year course in CS.  If so, I would say find a TA during office hours and discuss.</p>\n\n<p>There are several issues with the code:</p>\n\n<ol>\n<li>Your outer loop is intending to read a line at a time from a file and populate the s array.  It is instead reading a character at a time and populating the ch variable.</li>\n<li>As mentioned in the comments, you are not accounting for the \"-\" when putting characters into the a array.</li>\n<li>You are not terminating your string in the a array.</li>\n<li>There may be different schools of thought on this in c, but I would make s and a char[] instead of int[].</li>\n</ol>\n\n<p>My advice would be to get out a piece of paper and make spaces for each of your variables.  Then read your code line by line and manipulate your variables the way you expect the computer to execute what is written.  If you can read what is written, rather than what you expect the code to do, then the issues will become apparent.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5290421, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vN7DNDs5Y7U/AAAAAAAAAAI/AAAAAAAAACo/KvtpDgm8dBg/photo.jpg?sz=128", "display_name": "Horlic Vince", "link": "https://stackoverflow.com/users/5290421/horlic-vince"}, "edited": false, "score": 0, "creation_date": 1441206170, "post_id": 32355223, "comment_id": 52586266, "body": "^ Where is the file handling setting here?"}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 0, "last_activity_date": 1441223459, "last_edit_date": 1441223459, "creation_date": 1441202284, "answer_id": 32355223, "question_id": 32353930, "link": "https://stackoverflow.com/questions/32353930/file-handling-character-manipulation/32355223#32355223", "title": "File Handling + character manipulation", "body": "<pre><code>/* ugly: The old phone #\n   nice: The formatted phone #\n*/\n#include &lt;stdio.h&gt;\nvoid fmtpn(const char *ugly, char *nice)\n{\n    int i, j;\n    /* add one to allocate space for null terminator */\n    char first3[3 + 1], next3[3 + 1], last4[4 + 1];\n\n    if (strlen(ugly) != 10 || containsalpha(ugly)) {\n        strcpy(nice, \"Invalid pn!\");\n        return;\n    }\n    for (i = 0; i &lt; 3; ++i)\n        first3[i] = ugly[i];\n    first3[i] = 0;           /* null terminate the string */\n\n    for (j = 0; j &lt; 3; ++i, ++j)\n        next3[j] = ugly[i];\n    next3[j] = 0;            /* null terminate */\n\n    for (j = 0; j &lt; 4; ++i, ++j)\n        last4[j] = ugly[i];\n    last4[j] = 0;            /* null terminate */\n\n    sprintf(nice, \"(%s) %s-%s\", first3, next3, last4);\n}\n</code></pre>\n\n<p>To read from the file:</p>\n\n<pre><code>FILE *fp;\nchar ugly[32], good[32];\nif (fp = fopen(\"file\", \"r\")) {\n    fgets(ugly, 32, fp);\n    fmtpn(ugly, good);\n    puts(good);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1441292094, "last_edit_date": 1441292094, "creation_date": 1441214640, "answer_id": 32359476, "question_id": 32353930, "link": "https://stackoverflow.com/questions/32353930/file-handling-character-manipulation/32359476#32359476", "title": "File Handling + character manipulation", "body": "<p>You have other options aside from looping through your sting to build the phone number. Sometimes, when dealing with fixed strings or known quantities, a straight forward packing of the characters into a fixed format is a lot simpler than picking the characters out of loops.</p>\n\n<p>For example, here you know you are dealing with a <code>10 char</code> string of digits. In your code you can read/parse each line into a string of 10 digits. Then your only task is to format those 10 digits into the phone number. Using a pointer for each string and then <code>strncpy</code> is about as easy as anything else:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main (void) {\n\n    char *digits = \"1234567890\";\n    char *p = digits;\n\n    char phonenum[15] = {0};\n    char *pf = phonenum;\n\n    /* build formatted phone number */\n    *pf++ = '(';\n    strncpy (pf, p, 3);\n    pf += 3, p += 3;\n    *pf++ = ')';\n    *pf++ = ' ';        /* note: included space, remove line if unwanted */\n    strncpy (pf, p, 3);\n    pf += 3, p += 3;\n    *pf++ = '-';\n    strncpy (pf, p, 4);\n    pf += 4;\n    *pf = 0;\n\n    printf (\"\\n digits : %s\\n phone  : %s\\n\\n\", digits, phonenum);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>$ ./bin/phnumbld\n\n digits : 1234567890\n phone  : (123) 456-7890\n</code></pre>\n\n<p>You can easily turn the code above into a simple function that creates a formatted phone number given any 10-digit string. Breaking your code down into functional pieces not only makes your code easier to read and write, but it also builds flexibility and ease of maintenance into your code. Here were you dealing with an actual dial-string that included the international dialing prefix and country code, you could easily format the last 10 digits of the longer string by using a pointer to the appropriate beginning character.</p>\n\n<p><strong>With File Handling</strong></p>\n\n<p>Writing anything in C is no different. You simply break the problem down into discrete operations and then write small bits of code to handle each part of the problem. As you get more experience, you will build a collection of routines to handle most situations. </p>\n\n<p>Below the code declare three constants. <code>ACPN</code> (area code phone number length), <code>MAXC</code> (maximum digits in dial string including country code and international dialing prefix), and <code>MAXS</code> (maximum number of chars in line to read from file)</p>\n\n<p>You options for reading lines of data in C are broken into two broad categories, <strong>character oriented input</strong> and <strong>line oriented input</strong>. When reading lines from a file, in most cases <strong>line oriented input</strong> is the proper choice. You read a line of data at a time into a buffer, then you parse the information you need from the buffer. Your primary choices for line oriented input in C are <code>fgets</code> and <code>getline</code>. We use the standard <code>fgets</code> below.</p>\n\n<p>Below, the code will read a line of data, then call <code>get_n_digits</code> to extract up to <code>MAXC</code> digits in the line into a separate buffer holding the digits (<code>numstr</code>). The number string is then passed to <code>fmt_phone</code> which takes the last 10 digits in the string (discarding any initial country-code or int'l dialing prefix) and formatting those digits into a telephone number format. You can adjust any part as needed to meet your input file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define ACPN 10\n#define MAXC 16\n#define MAXS 256\n\nsize_t strip_newline (char *s);\nchar *get_n_digits (char *numstr, char *s, size_t n);\nchar *fmt_phone (char *fmts, char *s, size_t n);\n\nint main (int argc, char **argv) {\n\n    /* open file or read from stdin */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n    if (!fp) {\n        fprintf (stderr, \"error: failed to open file for reading\\n\");\n        return 1;\n    }\n\n    char numstr[MAXC] = {0};    /* string of digits (max MAXC - 1)  */\n    char fmtstr[MAXC] = {0};    /* formatted phone number string    */\n    char line[MAXS] = {0};      /* line buffer holding full line    */\n\n    /* read each line from fp (up to MAXS chars) */\n    while (fgets (line, MAXS, fp))\n    {\n        size_t len = strip_newline (line);  /* strip trailing newline       */\n        get_n_digits (numstr, line, MAXC);  /* get MAXC digits from line    */\n        printf (\"\\n read  : %s  (%zu chars), taking last 10 of : %s\\n\",\n                line, len, numstr);\n\n        /* format last 10 digits into phone number */\n        fmt_phone (fmtstr, numstr, ACPN);\n        printf (\" phone : %s\\n\", fmtstr);\n    }\n\n    if (fp != stdin) fclose (fp);\n\n    return 0;\n}\n\nsize_t strip_newline (char *s)\n{\n    size_t len = strlen (s);\n    s [--len] = 0;\n\n    return len;\n}\n\n/* extract upto n digits from string s, copy to numstr */\n   char *get_n_digits (char *numstr, char *s, size_t n)\n{\n    char *p = s;\n    size_t idx = 0;\n    while (*p &amp;&amp; idx &lt; n - 1) {\n        if (*p &gt;= '0' &amp;&amp; *p &lt;= '9')\n            numstr[idx++] = *p;\n        p++;\n    }\n    numstr[idx] = 0;\n\n    return numstr;\n}\n\n/* format last n (10) digits in s into a formatted\n   telephone number: (xxx) yyy-zzzz, copy to fmts.\n   'last 10' accounts for country code and international\n   dialing prefix at beginning of dial string.\n*/\nchar *fmt_phone (char *fmts, char *s, size_t n)\n{\n    /* validate strings */\n    if (!fmts || !s) {\n        fprintf (stderr, \"%s() error: invalid string parameter.\\n\", __func__);\n        *fmts = 0;\n        return fmts;\n    }\n\n    /* validate length of n */\n    if (n &lt; ACPN) {\n        fprintf (stderr, \"%s() error: insufficient size 'n' for format.\\n\", __func__);\n        *fmts = 0;\n        return fmts;\n    }\n\n    /* validate length of s */\n    size_t len = strlen (s);\n    if (len &lt; n) {\n        fprintf (stderr, \"%s() error: insufficient digits in string.\\n\", __func__);\n        *fmts = 0;\n        return fmts;\n    }\n\n    /* set start pointer to last 10 digits */\n    char *p = len &gt; n ? s + len - n : s;\n    char *pf = fmts;\n\n    /* build formatted phone number */\n    *pf++ = '(';\n    strncpy (pf, p, 3);\n    pf += 3, p += 3;\n    *pf++ = ')';\n    *pf++ = ' ';\n    strncpy (pf, p, 3);\n    pf += 3, p += 3;\n    *pf++ = '-';\n    strncpy (pf, p, 4);\n    pf += 4;\n    *pf = 0;\n\n    return fmts;\n}\n</code></pre>\n\n<p>Compile with <code>gcc -Wall -Wextra -o progname sourcename.c</code></p>\n\n<p><strong>Example Input</strong></p>\n\n<pre><code>$ cat dat/pnumtest.txt\n123456789012345\n12345678901234\n1234567890123\n123456789012\n12345678901\n1234567890\n123456789\n</code></pre>\n\n<p><strong>Example Output</strong></p>\n\n<pre><code>$ ./bin/phnum dat/pnumtest.txt\n\n read  : 123456789012345  (15 chars), taking last 10 of : 123456789012345\n phone : (678) 901-2345\n\n read  : 12345678901234  (14 chars), taking last 10 of : 12345678901234\n phone : (567) 890-1234\n\n read  : 1234567890123  (13 chars), taking last 10 of : 1234567890123\n phone : (456) 789-0123\n\n read  : 123456789012  (12 chars), taking last 10 of : 123456789012\n phone : (345) 678-9012\n\n read  : 12345678901  (11 chars), taking last 10 of : 12345678901\n phone : (234) 567-8901\n\n read  : 1234567890  (10 chars), taking last 10 of : 1234567890\n phone : (123) 456-7890\n\n read  : 123456789  (9 chars), taking last 10 of : 123456789\nfmt_phone() error: insufficient digits in string.\n phone :\n</code></pre>\n\n<p><strong>Note:</strong> there are many, many different ways to approach this problem, this is but one.</p>\n\n<p><strong>Note2:</strong> while not required for this code, I included a function showing how to strip the trailing <code>newline</code> (<code>'\\n'</code>) from the input read by <code>fgets</code>. It is never a good idea to leave <code>newlines</code> dangling from strings in your code. While here they would not have caused a problem, in most cases they will bite you if your are not aware of them. So get in the practice of handling/removing the trailing newlines when using <code>fgets</code> or <code>getline</code> to read from a file. (note: <code>getline</code> provides the number of characters actually read as its return, so you can avoid calling <code>strlen</code> and simply use the return of <code>getline</code> to remove the newline in that case.)</p>\n"}, {"comments": [{"owner": {"reputation": 4724, "user_id": 1024740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1037d544b43c71c34225fac55e0c7750?s=128&d=identicon&r=PG", "display_name": "Rob Latham", "link": "https://stackoverflow.com/users/1024740/rob-latham"}, "reply_to_user": {"reputation": 21, "user_id": 5290421, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vN7DNDs5Y7U/AAAAAAAAAAI/AAAAAAAAACo/KvtpDgm8dBg/photo.jpg?sz=128", "display_name": "Horlic Vince", "link": "https://stackoverflow.com/users/5290421/horlic-vince"}, "edited": false, "score": 0, "creation_date": 1441278167, "post_id": 32362342, "comment_id": 52618530, "body": "No, you can figure out that part of your homework on your own."}], "tags": [], "owner": {"reputation": 4724, "user_id": 1024740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1037d544b43c71c34225fac55e0c7750?s=128&d=identicon&r=PG", "display_name": "Rob Latham", "link": "https://stackoverflow.com/users/1024740/rob-latham"}, "is_accepted": false, "score": 0, "last_activity_date": 1441225005, "creation_date": 1441225005, "answer_id": 32362342, "question_id": 32353930, "link": "https://stackoverflow.com/questions/32353930/file-handling-character-manipulation/32362342#32362342", "title": "File Handling + character manipulation", "body": "<p>No love for sscanf?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint prettyprint(char *input, char *output)\n{\n    int n[10], ret;\n    ret = sscanf(input, \"%1d%1d%1d%1d%1d%1d%1d%1d%1d%1d\", &amp;(n[0]), &amp;(n[1]),\n    &amp;(n[2]), &amp;(n[3]), &amp;(n[4]), &amp;(n[5]), &amp;(n[6]),\n    &amp;(n[7]), &amp;(n[8]), &amp;(n[9]));\n    if (ret != 10)\n        fprintf(stderr, \"invalid input\\n\");\n\n    sprintf(output, \"(%1d%1d%1d) %1d%1d%1d-%1d%1d%1d%1d\",\n    n[0], n[1], n[2],\n    n[3],n[4], n[5],\n    n[6], n[7], n[8], n[9]);\n    return 0;\n}\nint main(int argc, char **argv)\n{\n    char digits[] = \"0123456789\";\n    char output[256];\n    prettyprint(digits, output);\n    printf(\"%s\\n\", output);\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5290421, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vN7DNDs5Y7U/AAAAAAAAAAI/AAAAAAAAACo/KvtpDgm8dBg/photo.jpg?sz=128", "display_name": "Horlic Vince", "link": "https://stackoverflow.com/users/5290421/horlic-vince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1441292094, "creation_date": 1441198880, "last_edit_date": 1441199265, "question_id": 32353930, "link": "https://stackoverflow.com/questions/32353930/file-handling-character-manipulation", "title": "File Handling + character manipulation", "body": "<p>this is my code.</p>\n\n<p>the input numbers are</p>\n\n<p>1234567890</p>\n\n<p>the output of this code should be</p>\n\n<p>(123)456-7890</p>\n\n<p>but the output is different. Any advice or error fixes in my code?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\n    char ch;\n    int a[100], s[100], str, k, i;\n    FILE *fp;\n\n    fp = fopen(\"number.c\", \"r\");\n    while ( ( ch = fgetc(fp) ) != EOF )\n    {\n        k = 0;\n        a[k] = '(';\n        a[k+4] = ')';\n        a[k+8] = '-';\n        for (i = 0; s[i] != '\\0'; i++)\n        {\n            if (isdigit(s[i]))\n            {\n                a[k++] = s[i];\n                if (k == 3)\n                {\n                    k++;\n                }\n            }\n            printf(\"%s\", a);\n        }\n        fclose(fp);\n        return 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "network-programming", "pcap", "libpcap"], "comments": [{"owner": {"reputation": 764, "user_id": 2899478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juuUm.jpg?s=128&g=1", "display_name": "o_weisman", "link": "https://stackoverflow.com/users/2899478/o-weisman"}, "edited": false, "score": 0, "creation_date": 1441198695, "post_id": 32353794, "comment_id": 52580664, "body": "What error are you getting and where?"}, {"owner": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "reply_to_user": {"reputation": 764, "user_id": 2899478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juuUm.jpg?s=128&g=1", "display_name": "o_weisman", "link": "https://stackoverflow.com/users/2899478/o-weisman"}, "edited": false, "score": 0, "creation_date": 1441199091, "post_id": 32353794, "comment_id": 52580974, "body": "I am not getting an error, any errors I am getting such as monitor mode and filters are because my wireless device is being reported to have an Ethernet link layer (which is the title of this question) ... where monitor mode is impossible."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1441200212, "post_id": 32353794, "comment_id": 52581800, "body": "<code>en0</code> should be the name of an Ethernet interface, not a wireless interface.  In that case, if you ask PCAP for its link type, then <code>LINKTYPE_ETHERNET</code> (== 1) is an utterly reasonable result.  These days almost every machine has an ethernet interface, including those that also have wireless interfaces.  Are you sure you&#39;re looking at the interface you intend to look at?"}, {"owner": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "edited": false, "score": 0, "creation_date": 1441201314, "post_id": 32353794, "comment_id": 52582640, "body": "<code>en0</code> on my mac is the wireless interface. I do not have an Ethernet connection on my macbook. When compiled and ran on my Linux machine I use <code>wlan1</code> (have also tried <code>mon1</code> when set with <code>airmon-ng start wlan1</code>). <code>wlan1</code> is my Alpha card which supports monitor mode and packet injection. I can get the intended results when using <code>tcpdump</code> on my macbook, which is why I&#39;m puzzled."}, {"owner": {"reputation": 2689, "user_id": 5257515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e1VeT.png?s=128&g=1", "display_name": "jbm", "link": "https://stackoverflow.com/users/5257515/jbm"}, "edited": false, "score": 0, "creation_date": 1441202733, "post_id": 32353794, "comment_id": 52583663, "body": "In your call to pcap_compile(), the last parameter is 0. Whereas, see the man page: &quot;If the netmask of the network on which packets are being captured isn&#39;t known  to  the  program,  or  if  packets are being captured on the Linux &quot;any&quot; pseudo-interface that can capture on more than one network, a value of  PCAP_NETMASK_UNKNOWN  can  be  supplied&quot;. And this value is not 0: in /usr/include/pcap/pcap.h:272:#define PCAP_NETMASK_UNKNOWN 0xffffffff"}, {"owner": {"reputation": 2689, "user_id": 5257515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e1VeT.png?s=128&g=1", "display_name": "jbm", "link": "https://stackoverflow.com/users/5257515/jbm"}, "edited": false, "score": 0, "creation_date": 1441202906, "post_id": 32353794, "comment_id": 52583793, "body": "Minor: as soon as you have done pcap_setfilter(), you should do a pcap_freecode(&amp;fp)"}, {"owner": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "reply_to_user": {"reputation": 2689, "user_id": 5257515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e1VeT.png?s=128&g=1", "display_name": "jbm", "link": "https://stackoverflow.com/users/5257515/jbm"}, "edited": false, "score": 0, "creation_date": 1441202955, "post_id": 32353794, "comment_id": 52583832, "body": "@jbm but if device is in monitor mode it can&#39;t be connected to an access point so there would be no netmask."}, {"owner": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "reply_to_user": {"reputation": 2689, "user_id": 5257515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e1VeT.png?s=128&g=1", "display_name": "jbm", "link": "https://stackoverflow.com/users/5257515/jbm"}, "edited": false, "score": 0, "creation_date": 1441202971, "post_id": 32353794, "comment_id": 52583848, "body": "@jbm ah thanks for that :) Noted about <code>PCAP_NETMASK_UNKNOWN</code> too. Just realised what you meant."}, {"owner": {"user_type": "does_not_exist", "display_name": "user862787"}, "edited": false, "score": 0, "creation_date": 1441226642, "post_id": 32353794, "comment_id": 52598256, "body": "&quot;<code>en0</code> should be the name of an Ethernet interface, not a wireless interface.&quot; One could argue that it should be, but, for better or worse, that&#39;s not how OS X works; it calls Ethernet and Wi-Fi interfaces &quot;enN&quot;.  (I think Linux also used to do that at one point.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user862787"}, "edited": false, "score": 0, "creation_date": 1441226698, "post_id": 32353794, "comment_id": 52598291, "body": "&quot;but if device is in monitor mode it can&#39;t be connected to an access point&quot;  Not true for the AirPort interface on my MacBook Pro; I can capture in monitor mode and remain associated with a wireless network."}], "answers": [{"comments": [{"owner": {"reputation": 2689, "user_id": 5257515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e1VeT.png?s=128&g=1", "display_name": "jbm", "link": "https://stackoverflow.com/users/5257515/jbm"}, "reply_to_user": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "edited": false, "score": 0, "creation_date": 1441202469, "post_id": 32354185, "comment_id": 52583474, "body": "Interesting. But I don&#39;t get how you call pcap_set_rfmon(pcap_h, 0). From the man page, I&#39;d rather do pcap_set_rfmon(pcap_h, 1): man page says &quot;If rfmon (second parameter) is non-zero, monitor mode will be set, otherwise it will not be set.&quot; Also, at this point in chasing the issue, I&#39;d try the pcap_can_set_rfmon() before that."}, {"owner": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "edited": false, "score": 0, "creation_date": 1441202677, "post_id": 32354185, "comment_id": 52583618, "body": "I tried <code>pcap_can_set_rfmon()</code>. Will update code to show it in there, and yeah probably best I keep it in there too :). I have tried with <code>1</code> and still had the same issue."}, {"owner": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "edited": false, "score": 0, "creation_date": 1441202830, "post_id": 32354185, "comment_id": 52583732, "body": "This is odd. I added <code>pcap_can_set_rfmon()</code> before <code>pcap_set_rfmon()</code> and it works. Or maybe I didn&#39;t compile when I set it to <code>1</code> the first time. Either way, this answer solved it :)"}, {"owner": {"reputation": 2689, "user_id": 5257515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e1VeT.png?s=128&g=1", "display_name": "jbm", "link": "https://stackoverflow.com/users/5257515/jbm"}, "reply_to_user": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "edited": false, "score": 0, "creation_date": 1441203073, "post_id": 32354185, "comment_id": 52583911, "body": "Your welcome. I&#39;m doing &quot;wired&quot; pcap right now, but may have to do 802.11 too in a not to distant future. So I learn from the troubles you get in :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user862787"}, "edited": false, "score": 0, "creation_date": 1441226545, "post_id": 32354185, "comment_id": 52598203, "body": "&quot;I added pcap_can_set_rfmon() before pcap_set_rfmon() and it works. Or maybe I didn&#39;t compile when I set it to 1 the first time. Either way, this answer solved it :)&quot;  Try removing <code>pcap_can_set_rfmon()</code> and recompiling and see if it works.  That&#39;ll indicate which of those is the answer."}], "tags": [], "owner": {"reputation": 2689, "user_id": 5257515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e1VeT.png?s=128&g=1", "display_name": "jbm", "link": "https://stackoverflow.com/users/5257515/jbm"}, "is_accepted": true, "score": 3, "last_activity_date": 1441201087, "last_edit_date": 1441201087, "creation_date": 1441199557, "answer_id": 32354185, "question_id": 32353794, "link": "https://stackoverflow.com/questions/32353794/why-is-pcap-datalink-always-returning-1-ethernet-even-on-wireless-device/32354185#32354185", "title": "Why is pcap_datalink() always returning 1 (Ethernet), even on wireless device?", "body": "<p>Are you <em>shure</em> this is what's is stopping you from putting the card into monitor mode, and stopping your WLAN filters from working, or do you do this call to pcap_datalink() as a check trying to pinpoint the issue?</p>\n\n<p>Be aware that, from PCAP-LINKTYPE(7):</p>\n\n<blockquote>\n  <p>For  a  live  capture  or ``savefile'', libpcap supplies, as the\n  return value of the pcap_datalink(3PCAP) routine, a value that \n  indicates  the type  of link-layer header at the beginning of the\n  packets it provides. This is not necessarily the type of link-layer\n  header that the  packets being  captured  have on the network from\n  which they're being captured; for example, packets from an IEEE 802.11\n  network might be  provided  by libpcap  with  Ethernet headers that\n  the network adapter or the network adapter driver generates from the\n  802.11 headers.</p>\n</blockquote>\n\n<p>So I would not take this LINKTYPE_ETHERNET / DLT_EN10MB return value as the sure indication of a problem here.</p>\n\n<p><strong>EDIT:</strong>\nAlso, pcap_set_rfmon() is supposed to be call <em>before</em> the handle is activated, which is not visible in your code.</p>\n\n<p>pcap is rather touchy about the order things should be done. Have a look at the man pages for <code>pcap_can_set_rfmon</code> and <code>pcap_set_rfmon</code>.</p>\n\n<p>The order should be:</p>\n\n<ul>\n<li>pcap_create</li>\n<li>pcap_can_set_rfmon</li>\n<li>pcap_set_rfmon (if so far so good)</li>\n<li>then and only then, pcap_activate</li>\n</ul>\n"}], "owner": {"reputation": 10241, "user_id": 256409, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eee48dc66910d0791c43f1486bf0fb2e?s=128&d=identicon&r=PG&f=1", "display_name": "James Jeffery", "link": "https://stackoverflow.com/users/256409/james-jeffery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1734, "favorite_count": 1, "accepted_answer_id": 32354185, "answer_count": 1, "score": 4, "last_activity_date": 1441203342, "creation_date": 1441198546, "last_edit_date": 1441203342, "question_id": 32353794, "link": "https://stackoverflow.com/questions/32353794/why-is-pcap-datalink-always-returning-1-ethernet-even-on-wireless-device", "title": "Why is pcap_datalink() always returning 1 (Ethernet), even on wireless device?", "body": "<p>I'm having an issue where by <code>pcap_datalink()</code> is always returning <code>1</code>. To my understanding this is <code>LINKTYPE_ETHERNET</code>. But, the device I am using is a wireless card and in my case <code>en0</code>.</p>\n\n<p>This is stopping me from putting the card into monitor mode, and stopping my WLAN filters from working. I've tried to run this on both OSX and Linux with the same results. I also run as root.</p>\n\n<p>Here's the part of my code that's causing the problem. For the example, assume <code>dev</code> is set to <code>en0</code> (wireless device on Mac).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pcap.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[])\n{\n    pcap_t *pcap_h;\n    char *dev, errbuf[PCAP_ERRBUF_SIZE];\n    struct bpf_program fp;\n    struct pcap_pkthdr header;\n    const u_char *packet;\n\n    if(argc &lt; 2)\n    {\n        printf(\"Usage: %s device\\n\", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n\n    dev = argv[1];\n\n    if((pcap_h = pcap_create(dev, errbuf)) == NULL)\n    {\n        printf(\"pcap_create() failed: %s\\n\", errbuf);\n        exit(EXIT_FAILURE);\n    }\n\n    if(pcap_can_set_rfmon(pcap_h) == 0)\n    {\n        printf(\"Monitor mode can not be set.\\n\");\n    }\n\n    if(pcap_set_rfmon(pcap_h, 1) != 0)\n    {\n        printf(\"Failed to set monitor mode.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    if(pcap_activate(pcap_h) != 0)\n    {\n        printf(\"pcap_activate() failed\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    /*\n     * Compile a filter to sniff 802.11 probe requests\n     * Filter: type mgt subtype probe-req\n     */ \n    if(pcap_compile(pcap_h, &amp;fp, \"type mgt subtype probe-req\", 0, PCAP_NETMASK_UNKNOWN) == -1)\n    {\n        printf(\"pcap_compile() failed: %s\\n\", pcap_geterr(pcap_h));\n        exit(EXIT_FAILURE);\n    }\n\n    /*\n     * Set the compiled filter\n     */ \n    if(pcap_setfilter(pcap_h, &amp;fp) == -1)\n    {\n        printf(\"pcap_setfilter() failed: %s\\n\", pcap_geterr(pcap_h));\n        exit(EXIT_FAILURE);\n    }\n\n    pcap_freecode(&amp;fp);\n\n    packet = pcap_next(pcap_h, &amp;header);\n\n    printf(\"Header: %d\\n\", header.len); \n    pcap_close(pcap_h);\n    return 0;\n}\n</code></pre>\n\n<p>Any idea's why <code>pcap_datalink()</code> is always returning <code>1</code>?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Updated code, and added <code>pcap_set_rfmon()</code> before the call to <code>pcap_activate()</code>. I get an error:</p>\n\n<pre><code>pcap_compile() failed: 802.11 link-layer types supported only on 802.11\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 6920, "user_id": 4394169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aETL5.jpg?s=128&g=1", "display_name": "Vlad Feinstein", "link": "https://stackoverflow.com/users/4394169/vlad-feinstein"}, "edited": false, "score": 0, "creation_date": 1441199350, "post_id": 32353753, "comment_id": 52581177, "body": "<a href=\"http://stackoverflow.com/questions/10017301/mpi-blocking-vs-non-blocking\" title=\"mpi blocking vs non blocking\">stackoverflow.com/questions/10017301/&hellip;</a> ?"}, {"owner": {"reputation": 1185, "user_id": 5148276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebc785eb0111296ebf6624e47360a18f?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja Nilangekar", "link": "https://stackoverflow.com/users/5148276/pooja-nilangekar"}, "edited": false, "score": 4, "creation_date": 1441202785, "post_id": 32353753, "comment_id": 52583697, "body": "You could use <code>MPI_Scatter()</code> instead of splitting the array and using <code>MPI_Send()</code> to each process. Similarly, you could also use <code>MPI_Gather()</code> to collect all results."}, {"owner": {"reputation": 4652, "user_id": 2189128, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/P19VP.jpg?s=128&g=1", "display_name": "Jeff Hammond", "link": "https://stackoverflow.com/users/2189128/jeff-hammond"}, "edited": false, "score": 2, "creation_date": 1441220734, "post_id": 32353753, "comment_id": 52595109, "body": "Look at MAX/MIN/MAXLOC/MINLOC reductions."}, {"owner": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "reply_to_user": {"reputation": 6920, "user_id": 4394169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aETL5.jpg?s=128&g=1", "display_name": "Vlad Feinstein", "link": "https://stackoverflow.com/users/4394169/vlad-feinstein"}, "edited": false, "score": 0, "creation_date": 1441269463, "post_id": 32353753, "comment_id": 52613086, "body": "@VladFeinstein thanks, I have already read that topic. But as I mentioned, I need some help on my exercise to understand it better."}, {"owner": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "reply_to_user": {"reputation": 1185, "user_id": 5148276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebc785eb0111296ebf6624e47360a18f?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja Nilangekar", "link": "https://stackoverflow.com/users/5148276/pooja-nilangekar"}, "edited": false, "score": 0, "creation_date": 1441269509, "post_id": 32353753, "comment_id": 52613114, "body": "@PoojaNilangekar thanks, I will study on those functions and give a feedback :)"}, {"owner": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "reply_to_user": {"reputation": 4652, "user_id": 2189128, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/P19VP.jpg?s=128&g=1", "display_name": "Jeff Hammond", "link": "https://stackoverflow.com/users/2189128/jeff-hammond"}, "edited": false, "score": 0, "creation_date": 1441269565, "post_id": 32353753, "comment_id": 52613149, "body": "@Jeff thanks, I didn&#39;t know much about REDUCTIONs. I will work on it :)"}], "answers": [{"comments": [{"owner": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "edited": false, "score": 0, "creation_date": 1441269323, "post_id": 32363056, "comment_id": 52612995, "body": "Thanks for this clear answer. It really helped me to understand the logic. The only error in your code is the that the <code>tempArray</code> should be <code>localArray</code> in <code>else</code> statement (you have forgotten to update the variable name). And everything works fine. Also thanks for the homework, I will work on it :)"}, {"owner": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "edited": false, "score": 0, "creation_date": 1441908875, "post_id": 32363056, "comment_id": 52876873, "body": "I think I got the point in homework :) <code>rank == ROOT</code> is doing nothing! So it would be better to use ROOT more efficiently. Maybe <code>MPI_Scatter</code> is better to use in this case."}, {"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "reply_to_user": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "edited": false, "score": 1, "creation_date": 1441909916, "post_id": 32363056, "comment_id": 52877430, "body": "Correct! An alternative implementation that would look very similar to what you already have but with better load balancing would be: split up the problem into <code>size</code> pieces as opposed to <code>size-1</code> pieces. Then <code>rank == ROOT</code> would have its own little chunk that it could work on after sending, just like the other ranks work on their little chunks just after receiving."}, {"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "reply_to_user": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "edited": false, "score": 1, "creation_date": 1441910079, "post_id": 32363056, "comment_id": 52877524, "body": "But yes, essentially you&#39;re recreating <code>MPI_Scatter</code> as-is."}], "tags": [], "owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "is_accepted": true, "score": 3, "last_activity_date": 1441295095, "last_edit_date": 1441295095, "creation_date": 1441227780, "answer_id": 32363056, "question_id": 32353753, "link": "https://stackoverflow.com/questions/32353753/splitting-and-passing-array-blocks-in-mpi/32363056#32363056", "title": "Splitting and Passing Array Blocks in MPI", "body": "<p>There are several problems with the code you have (as you've already pointed out), and as some commenters have already mentioned, there are alternative ways to perform what you are trying to do using MPI calls.</p>\n\n<p>However, I am going to repurpose your code and try not to change too much in order to show you what's going on.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;mpi.h&gt;\n\n#define N 9 // array size\nint A[N] = {0,2,1,5,4,3,7,6,8}; // this is a dummy array that should only be initialized on rank == ROOT\n\nint main(int argc, char *argv[]) {\n\n    int size;\n    int rank;\n    const int VERY_LARGE_INT = 999999;\n    const int ROOT = 0; // the master rank that holds A to begin with\n    int tag = 1234;\n\n    MPI_Init(&amp;argc, &amp;argv);\n\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size); // think size = 4 for this example\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n    /* \n       How many numbers you send from ROOT to each other rank. \n       Note that for this implementation to work, (size-1) must divide N.\n    */\n    int count = N/(size-1);\n\n    int *localArray = (int *)malloc(count * sizeof(int));\n    int localMin;  // minimum computed on rank i\n    int globalMin; // will only be valid on rank == ROOT\n\n    /* rank == ROOT sends portion of A to every other rank */\n    if (rank == ROOT) {\n\n        for(int dest = 1; dest &lt; size; ++dest) \n        {\n            // If you are sending information from one rank to another, you use MPI_Send or MPI_Isend.\n            // If you are sending information from one rank to ALL others, then every rank must call MPI_Bcast (similar to MPI_Reduce below)\n            MPI_Send(&amp;A[(dest-1)*count], count, MPI_INT, dest, tag, MPI_COMM_WORLD);\n            printf(\"P0 sent a %d elements to P%d.\\n\", count, dest);\n        }\n        localMin = VERY_LARGE_INT; // needed for MPI_Reduce below\n    }\n\n    /* Every other rank is receiving one message: from ROOT into local array */\n    else {\n        MPI_Recv(localArray, count, MPI_INT, ROOT, tag, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n        localMin = findMin(localArray, count);\n        printf(\"Min for P%d is %d.\\n\", rank, localMin);\n    }\n\n    /* \n       At this point, every rank in communicator has valid information stored in localMin. \n       Use MPI_Reduce in order to find the global min among all ranks.\n       Store this single globalMin on rank == ROOT.\n    */\n    MPI_Reduce(&amp;localMin, &amp;globalMin, 1, MPI_INT, MPI_MIN, ROOT, MPI_COMM_WORLD);\n\n    if (rank == ROOT)\n        printf(\"Global min: %d\\n\", globalMin);\n\n    /* The last thing you do is Finalize MPI. Nothing should come after. */\n    MPI_Finalize();\n    return 0;\n}\n</code></pre>\n\n<p>Full disclosure: I have not tested this code, but besides minor typos, it should work.</p>\n\n<p>Look over this code and see if you can understand why I moved your <code>MPI_Send</code> and <code>MPI_Recv</code> calls around. To understand this, note that every rank is reading every line of code you give it. Thus, inside your <code>else</code> statement, there should not be a <code>for</code> loop of receives.</p>\n\n<p>Furthermore, the MPI collectives (such as <code>MPI_Reduce</code> and <code>MPI_Bcast</code>), must be called by every rank in a communicator. The \"source\" and \"destination\" ranks for these calls are part of the function input parameters or implied by the collective itself.</p>\n\n<p>Lastly, a little bit of homework for you: can you see why this is NOT a good implementation of finding the global min of the array <code>A</code>? HINT: what is <code>rank == ROOT</code> doing after it finishes its <code>MPI_Send</code>s? How would you better split up this problem so that every rank is more evenly performing work?</p>\n"}], "owner": {"reputation": 468, "user_id": 2948098, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mDgWN.png?s=128&g=1", "display_name": "samet", "link": "https://stackoverflow.com/users/2948098/samet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4724, "favorite_count": 0, "accepted_answer_id": 32363056, "answer_count": 1, "score": 0, "last_activity_date": 1441295095, "creation_date": 1441198447, "last_edit_date": 1441198963, "question_id": 32353753, "link": "https://stackoverflow.com/questions/32353753/splitting-and-passing-array-blocks-in-mpi", "title": "Splitting and Passing Array Blocks in MPI", "body": "<p>I am pretty new in MPI and trying to get understand the sense by writing a simple C program. All I want to do is <strong>to split an array and send blocks to N processors</strong>. So, each processor will find local mins in their blocks. Then the program (in root or somewhere else) finds the global min. </p>\n\n<p>I studied on <code>MPI_Send</code>, <code>MPI_Isend</code>, or <code>MPI_Bcast</code> functions but a little bit confused in where to use one instead of another. I need some tips for the general structure of my program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;mpi.h&gt;\n\n#define N 9 // array size\n\nint A[N] = {0,2,1,5,4,3,7,6,8}; // this is a dummy array\n\nint main(int argc, char *argv[]) {\n\n    int i, k = 0, size, rank, source = 0, dest = 1, count;\n    int tag = 1234;\n\n    MPI_Init(&amp;argc, &amp;argv);\n\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n    count = N/(size-1); // think size = 4 for this example\n\n    int *tempArray = malloc(count * sizeof(int)); \n    int *localMins = malloc((size-1) * sizeof(int)); \n\n    if (rank == 0) {\n\n        for(i=0; i&lt;size; i+=count) \n        {\n            // Is it better to use MPI_Isend or MPI_Bcast here?\n            MPI_Send(&amp;A[i], count, MPI_INT, dest, tag, MPI_COMM_WORLD);\n            printf(\"P0 sent a %d elements to P%d.\\n\", count, dest);\n            dest++;\n        }\n    }\n    else {\n\n        for(i=0; i&lt;size; i+=count) \n        {       \n            MPI_Recv(tempArray, count, MPI_INT, 0, tag, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n            localMins[k] = findMin(tempArray, count);\n            printf(\"Min for P%d is %d.\\n\", rank, localMins[k]);\n            k++;            \n        }\n    }\n\n    MPI_Finalize();\n\n    int gMin = findMin(localMins, (size-1)); // where should I assign this\n    printf(\"Global min: %d\\n\", gMin); // and where should I print the results?\n\n    return 0;\n}\n</code></pre>\n\n<p>There could be multiple errors on my code and sorry for cannot specify an exact problem here. Thanks for any suggestion.</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 5, "creation_date": 1441197967, "post_id": 32353493, "comment_id": 52580099, "body": "It means the author wanted to keep the lines short for readability on ancient CRTs."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441199752, "post_id": 32353580, "comment_id": 52581470, "body": "Some of the things in that document are good advise, some are seriously obscure style, with no rationale provided... Probably not a good document to read when deciding a style in modern C programming."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441200813, "post_id": 32353580, "comment_id": 52582245, "body": "@Lundin So... what things?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441201032, "post_id": 32353580, "comment_id": 52582420, "body": "@FUZxxl To answer that, I would have to write a whole essay in this limited comment field."}, {"owner": {"reputation": 149, "user_id": 3306561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fb388c8ec1a1610a0c0057162c3f87f?s=128&d=identicon&r=PG&f=1", "display_name": "Reclzz", "link": "https://stackoverflow.com/users/3306561/reclzz"}, "edited": false, "score": 0, "creation_date": 1441218941, "post_id": 32353580, "comment_id": 52594107, "body": "@user5292516 Thank you for the pdf. I&#39;ve been searching for an answer, probably didn&#39;t use the right string."}], "tags": [], "owner": {"reputation": 101, "user_id": 5292516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5960e12987718f815e3551073ce60eda?s=128&d=identicon&r=PG&f=1", "display_name": "user5292516", "link": "https://stackoverflow.com/users/5292516/user5292516"}, "is_accepted": false, "score": 10, "last_activity_date": 1441197999, "creation_date": 1441197999, "answer_id": 32353580, "question_id": 32353493, "link": "https://stackoverflow.com/questions/32353493/placement-of-int-for-functions/32353580#32353580", "title": "Placement of int for functions", "body": "<p>No, white-space is generally ignored in C. That's just coding style.</p>\n\n<p>Here's the coding style for <a href=\"https://www.cis.upenn.edu/~lee/06cse480/data/cstyle.ms.pdf\" rel=\"noreferrer\">SunOS</a>:</p>\n\n<blockquote>\n  <p>Each function should be preceded by a block comment prologue that gives the name and a short description of what the function does. <strong>The type of the value returned should be alone on a line in column 1</strong> (int should be specified explicitly). </p>\n</blockquote>\n\n<p>This falls in line with another rule:</p>\n\n<blockquote>\n  <p>Lines longer than 80 columns are not handled well by all terminals and should be avoided if possible</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 4, "creation_date": 1441199599, "post_id": 32354123, "comment_id": 52581362, "body": "Placing storage class specifier and return type on the same line and then a line break makes it easy to find a function definition: Just grep for <code>^function_name(</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441200199, "post_id": 32354123, "comment_id": 52581790, "body": "@FUZxxl Or you could simply click on the function name in your modern IDE... or you could use the search feature of your modern IDE and type in <code>function_name</code> there. Or you could place the cursor on the function&#39;s call and use an IDE feature to go directly to the function. And so on. Lots of such fancy stuff was invented in the early 90s. I feel we should no longer adapt our coding style to suit old command prompts..."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1441200751, "post_id": 32354123, "comment_id": 52582195, "body": "Many people (especially UNIX folks) don&#39;t develop with an IDE. Personally, I don&#39;t use an IDE either and I don&#39;t think the Solaris developers use IDEs either. Working on a command prompt is quick, not taxing to your computer and you don&#39;t need a mouse which is a good thing if you hate mice (like me)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441201952, "post_id": 32354123, "comment_id": 52583117, "body": "@FUZxxl If an IDE is taxing your computer, you are either running Eclipse or your computer is very bad... in either case, upgrade to something that makes you productive instead. And if you hate the mouse, you can always learn all the keyboard shortcuts of an IDE. Anyway, my point is that your coding style should only be concerned about readability and program safety, nothing else. External factors should not be allowed to affect it."}, {"owner": {"reputation": 842, "user_id": 727918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002b146f53365b3f19bf037894422424?s=128&d=identicon&r=PG", "display_name": "Dave Pacheco", "link": "https://stackoverflow.com/users/727918/dave-pacheco"}, "edited": false, "score": 2, "creation_date": 1458695034, "post_id": 32354123, "comment_id": 59973296, "body": "Style and choice of editors is pretty subjective.  FUZxxl explained why someone might prefer this style; it doesn&#39;t seem constructive to argue with people&#39;s preferences.  The illumos codebase is both large and widely-used, and I don&#39;t think it&#39;s constructive to call its style questionable, rare, or obscure.  Besides that, I can promise you that many of the contributors do know quite well what &quot;static&quot; and &quot;extern&quot; mean -- your note about that is purely FUD."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 842, "user_id": 727918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002b146f53365b3f19bf037894422424?s=128&d=identicon&r=PG", "display_name": "Dave Pacheco", "link": "https://stackoverflow.com/users/727918/dave-pacheco"}, "edited": false, "score": 0, "creation_date": 1458719349, "post_id": 32354123, "comment_id": 59980956, "body": "@DavePacheco Then please explain to me what an <code>inline int</code> is, if it is such well-known and sound practice to use that style."}, {"owner": {"reputation": 842, "user_id": 727918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002b146f53365b3f19bf037894422424?s=128&d=identicon&r=PG", "display_name": "Dave Pacheco", "link": "https://stackoverflow.com/users/727918/dave-pacheco"}, "edited": false, "score": 1, "creation_date": 1458753085, "post_id": 32354123, "comment_id": 60004381, "body": "&quot;inline int&quot; by itself is not a C construct. &quot;inline int foo(void) { ... }&quot; is a definition of a function &quot;foo&quot; that takes no arguments, returns int, and whose instructions should be inlined where the function is logically called. The presence of a newline does not impact the semantics at all. I think you&#39;re trying to make an argument about style, but I&#39;m not debating style; I&#39;m claiming only two facts: that this style is used in widely-used codebases (e.g., ZFS and DTrace), and that many people who use it fully understand the underlying C semantics."}, {"owner": {"reputation": 165, "user_id": 6101443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zfA4LJ7wRkU/AAAAAAAAAAI/AAAAAAAAHBE/rtkpt-uC07M/photo.jpg?sz=128", "display_name": "Bryan Cantrill", "link": "https://stackoverflow.com/users/6101443/bryan-cantrill"}, "edited": false, "score": 1, "creation_date": 1458758263, "post_id": 32354123, "comment_id": 60007596, "body": "The code in question is in a source base that has a rigorous style guide, programmatic style checker -- and a style that dates back to the dawn of C and Unix.  In particular, the style of placing the return type on a separate line dates to 7th Edition Unix; the notion that &quot;they haven&#39;t given their coding style much thought&quot; is entirely ignorant of the history of C and Unix.  Even if it&#39;s a style that you personally disagree with, at least show some reverence for the fact that it&#39;s the style of the framers of modern computing -- one that happens to live on in illumos."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 165, "user_id": 6101443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zfA4LJ7wRkU/AAAAAAAAAAI/AAAAAAAAHBE/rtkpt-uC07M/photo.jpg?sz=128", "display_name": "Bryan Cantrill", "link": "https://stackoverflow.com/users/6101443/bryan-cantrill"}, "edited": false, "score": 0, "creation_date": 1458804107, "post_id": 32354123, "comment_id": 60023765, "body": "@BryanCantrill &quot;...style that dates back to the dawn of C&quot; And that&#39;s the root of the problem, it is a style originating from the dark ages where storage class specifiers were barely used for functions, and function specifiers had not yet been invented. What &quot;rigorous style guide&quot; do you refer to? I hope it isn&#39;t the &quot;Linux kernel coding style guide&quot;, because that one is of very questionable quality and written by some hobbyist."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 0, "last_activity_date": 1441199405, "creation_date": 1441199405, "answer_id": 32354123, "question_id": 32353493, "link": "https://stackoverflow.com/questions/32353493/placement-of-int-for-functions/32354123#32354123", "title": "Placement of int for functions", "body": "<p>It is all coding style and thus subjective. What's most important when it comes to coding style is that you pick one and stick to it consistently.</p>\n\n<p>Here's some recommendations for coding style, which is ultimately personal opinion, although in this answer my \"personal\" opinion happens to be what I believe is most common in all C code I have ever read: </p>\n\n<hr>\n\n<p><strong>Storage class specifier and return type</strong></p>\n\n<p>The most common style is to put the storage class specifier (and function specifiers such as <code>inline</code>) and the return type at the same line as the function name: </p>\n\n<pre><code>static int outdec64 \n</code></pre>\n\n<p>That's de facto coding style and by far the most common. It also makes the function declaration style consistent with variable decaration style. I would therefore strongly recommend to use that style.</p>\n\n<p>A less common alternative is to split the storage specifier and put it on a line of its own:</p>\n\n<pre><code>static \nint outdec64 \n</code></pre>\n\n<p>Although less common, there's at least a sound rationale for this style: keep storage specifier separate.</p>\n\n<p>Some people like to put the return type on a line of its own, like in your example. But then they usually haven't given their coding style much thought, because when you mix in storage class specifiers, the code turns weird. The storage specifier <code>static</code> doesn't refer to the return type, but to the function as whole. So why write it together with the return type? In my experience, people who use that style are typically oblivious to what the keywords <code>static</code>, <code>extern</code> and <code>inline</code> mean, when written in front of a function.</p>\n\n<hr>\n\n<p><strong>Function parameters</strong></p>\n\n<p>Two de facto standard styles exist: all parameters on a single line </p>\n\n<pre><code>outdec64 (unsigned char *out, unsigned char *chr, int num) \n</code></pre>\n\n<p>or each parameter on its own line, each of them indented</p>\n\n<pre><code>outdec64 (unsigned char *out, \n          unsigned char *chr, \n          int num) \n</code></pre>\n\n<p>These two styles are usually mixed, so that functions with few parameters put them on a single line, while functions with plenty of parameters put them on different lines.</p>\n\n<p>Any other style than these two is rare and therefore questionable.</p>\n\n<hr>\n\n<p>As you can see, your example follows neither of these de facto standards, so at least I would regard it as obscure style.</p>\n"}], "owner": {"reputation": 149, "user_id": 3306561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fb388c8ec1a1610a0c0057162c3f87f?s=128&d=identicon&r=PG&f=1", "display_name": "Reclzz", "link": "https://stackoverflow.com/users/3306561/reclzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 32354123, "answer_count": 2, "score": 2, "last_activity_date": 1441199777, "creation_date": 1441197751, "last_edit_date": 1441199777, "question_id": 32353493, "link": "https://stackoverflow.com/questions/32353493/placement-of-int-for-functions", "title": "Placement of int for functions", "body": "<p>I've been looking over the Illumos source code lately and noticed something odd.</p>\n\n<p>In their source the function types are written like:</p>\n\n<pre><code>static int\noutdec64(unsigned char *out, \nunsigned char *chr, int num) \n{\n ... Code ... \n}\n</code></pre>\n\n<p>Which is definitely not the way I learned it. Does it have any specific meaning?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 1434, "user_id": 4928207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122e2222eb8cace8c9d2e67ea65d8c47?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Jansen", "link": "https://stackoverflow.com/users/4928207/mark-jansen"}, "is_accepted": false, "score": 0, "last_activity_date": 1441197493, "creation_date": 1441197493, "answer_id": 32353396, "question_id": 32353329, "link": "https://stackoverflow.com/questions/32353329/createdirectory-fails-with-permission-denied/32353396#32353396", "title": "CreateDirectory fails with permission denied", "body": "<p><code>swprintf(sbuff, len, L\"%p\", in_name);</code></p>\n\n<p>You try to create the directory <code>0x1324000</code> (or whatever the address of your <code>in_name</code> is).</p>\n\n<p>Use <code>%S</code> (note the uppercase <code>S</code>) or <code>%ws</code>, depending on the runtime you are linking against.</p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/ms647550(VS.85).aspx\" rel=\"nofollow\">this</a> if you are using Visual studio.</p>\n"}], "owner": {"reputation": 1, "user_id": 5292520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8c163dd644d0ec5292df0282b9b9a0e?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjeev Mehta", "link": "https://stackoverflow.com/users/5292520/sanjeev-mehta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441200059, "creation_date": 1441197283, "last_edit_date": 1441200059, "question_id": 32353329, "link": "https://stackoverflow.com/questions/32353329/createdirectory-fails-with-permission-denied", "title": "CreateDirectory fails with permission denied", "body": "<p>I am running one dll under window C# application. APP call dll api for all the transaction with the system.\nWhile I try for creating directory at C# app level it creates successfully but the calls fail with permission denied if dll calls createDirectory method. Process has full control permission.</p>\n\n<p>................\ncode snippet\n................</p>\n\n<pre><code>int dlnaFileSystemNewDirPeer(char *in_name)\n{\n    int len = dlna_strlen(in_name);\n    wchar_t sbuff[100];\n    swprintf(sbuff, len, L\"%p\", in_name);\n    int ret = CreateDirectory(sbuff, NULL);\n    int err = GetLastError();\n    if (err) {\n        printf(\"CreateDirectory fails with error:%d\\n\", err);\n        return err;\n    }\n    return ret;\n}\n</code></pre>\n"}, {"tags": ["c", "openssl", "sha256"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1441197521, "post_id": 32353321, "comment_id": 52579742, "body": "One thing is certainly that <code>echo a</code> will print <code>a</code>, <code>\\n</code>. The newline can be suppressed by <code>echo -n a</code>. But the result still differs, so this isn&#39;t the whole answer."}], "answers": [{"comments": [{"owner": {"reputation": 21279, "user_id": 507793, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6G686.jpg?s=128&g=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/507793/matthew"}, "edited": false, "score": 1, "creation_date": 1441197704, "post_id": 32353400, "comment_id": 52579905, "body": "OP is also processing 100 characters in their example."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 904, "user_id": 4004688, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1002512873/picture?type=large", "display_name": "Itay Sela", "link": "https://stackoverflow.com/users/4004688/itay-sela"}, "edited": false, "score": 1, "creation_date": 1441198188, "post_id": 32353400, "comment_id": 52580252, "body": "@ItaySela: The whole point of a cryptographically secure hash is that a <i>minute</i> change in input will give a <i>completely</i> different output. And since a hash is supposed to work on binary data as well, zero bytes <i>do</i> matter. ;-)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1441197819, "last_edit_date": 1441197819, "creation_date": 1441197500, "answer_id": 32353400, "question_id": 32353321, "link": "https://stackoverflow.com/questions/32353321/sha256-has-table-cli-and-openssl-library/32353400#32353400", "title": "SHA256 has table cli and openssl library", "body": "<p>When you do <code>echo a</code> it prints the letter <em>and</em> a newline. So the string you use in the C program should be <code>\"a\\n\"</code>.</p>\n\n<p>Also, you do the checksum of <em>all</em> of the array, not only the two letters used in the command line example. Use the proper length instead.</p>\n"}], "owner": {"reputation": 904, "user_id": 4004688, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1002512873/picture?type=large", "display_name": "Itay Sela", "link": "https://stackoverflow.com/users/4004688/itay-sela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 32353400, "answer_count": 1, "score": 0, "last_activity_date": 1441197819, "creation_date": 1441197265, "last_edit_date": 1441197730, "question_id": 32353321, "link": "https://stackoverflow.com/questions/32353321/sha256-has-table-cli-and-openssl-library", "title": "SHA256 has table cli and openssl library", "body": "<p>I'm trying to understand how the openssl library works compared to the CLI, and can't manage to find how to use SHA256 in both of those to get the same answer.</p>\n\n<p>im using <strong>OpenSSL 1.0.1e-fips 11 Feb 2013</strong></p>\n\n<p>my CLI command is </p>\n\n<pre><code>echo a | openssl sha256\n</code></pre>\n\n<p>output</p>\n\n<p>(stdin)= 87428fc522803d31065e7bce3cf03fe47596631e5e07bbd7a0fde60c4cf25c7</p>\n\n<p>C program</p>\n\n<pre><code>int main( int argc, char *argv[] ) {\n    unsigned char       msg[ 100 ];\n    long unsigned int   msg_len;\n    unsigned char       md[ SHA256_DIGEST_LENGTH ];      // SHA256_DIGEST_LENGTH = 32\n\n    msg_len = 100;\n    memset( msg, 0, msg_len );\n    msg[ 0 ] = 'a';\n    msg[ 1 ] = '\\0';\n\n    if ( ! simpleSHA256( msg, msg_len, md ) ) {\n        return 1;\n    }\n\n    hex_print( md );          // for 0&lt;=i&lt;=32 do printf( \"%02x\", md[ i ] );\n}\n</code></pre>\n\n<p>where</p>\n\n<pre><code>bool simpleSHA256( void *input, unsigned long length, unsigned char *md ) {\n    SHA256_CTX    context;\n    if ( ! SHA256_Init( &amp;context ) )\n        return false;\n    if ( ! SHA256_Update( &amp;context, (unsigned char*)input, length ) )\n        return false;\n    if ( ! SHA256_Final( md, &amp;context ) ) \n        return false;\n\n    return true;\n}\n</code></pre>\n\n<p>with output:</p>\n\n<pre><code>653504743d03afc72051d85fce9bcb8afd05d7911e5c9fe91265fa36d7d98b0\n</code></pre>\n\n<p>what am I doing wrong? cause both of those are suppose to give back the same output</p>\n"}, {"tags": ["c", "floating-accuracy"], "comments": [{"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441197364, "post_id": 32353301, "comment_id": 52579633, "body": "if m is negative you can easily get the wrong answer (e.g. 2^-2)"}, {"owner": {"reputation": 1000, "user_id": 1537366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3caa378c940acd69a32cbee6730f9f1e?s=128&d=identicon&r=PG", "display_name": "user1537366", "link": "https://stackoverflow.com/users/1537366/user1537366"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1441197406, "post_id": 32353301, "comment_id": 52579661, "body": "@DavidW Sorry, I meant positive integers."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1441197537, "post_id": 32353301, "comment_id": 52579751, "body": "@user1537366  Mention that in question."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1441197685, "post_id": 32353301, "comment_id": 52579882, "body": "If <code>int</code> is a 64-bit integer, <code>double</code> may not be able to accurately represent <code>INT_MAX</code>. In this case <code>(int)pow(INT_MAX, 1) != INT_MAX</code>."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1441197729, "post_id": 32353301, "comment_id": 52579922, "body": "Yes, it will. E.g. when n = 2 and m &gt; the number of significant digits in the mantissa."}], "answers": [{"comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1441197979, "post_id": 32353522, "comment_id": 52580104, "body": "&quot;On an ordinary platform where an int has 32 bits and a double is a 64 bit IEEE 754 floating point type, your assumption is true.&quot; \u2013 no, not quite."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1441198002, "post_id": 32353522, "comment_id": 52580120, "body": "Is the (&quot;most common&quot;, etc.) implementation of the calculation of <code>pow</code> guaranteed to always return <code>calculated &gt;= actual</code>? Intermediate floating point rounding can result in a slightly smaller value than a full integer, and the <code>(int)</code> cast rounds down."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1441198024, "post_id": 32353522, "comment_id": 52580134, "body": "@TheParamagneticCroissant How so? Please tell me where it isn&#39;t."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1441198185, "post_id": 32353522, "comment_id": 52580248, "body": "@FUZxxl Sorry, I was thinking of a different situation."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1441198194, "post_id": 32353522, "comment_id": 52580256, "body": "@Jongware The standard says \u201cThe pow functions compute x raised to the power y.\u201d I read this as \u201cthe result must be the floating pointer number that is closest to the actual result\u201d"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1441199907, "post_id": 32353522, "comment_id": 52581577, "body": "@FUZxxl: well of course; at least, that&#39;s the general idea. However, it seems to me <a href=\"http://stackoverflow.com/a/9824880/2564301\">current implementations use <code>exp</code></a> and a series of approximations. Would an (&quot;any&quot;, &quot;common&quot;, etc.) implementation check if the inputs are whole numbers and then put a limit on the number of convergence checks? (I immediately see a problem here ... how can you see if a <code>double</code> contains <code>a whole number</code>?)"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1441200228, "post_id": 32353522, "comment_id": 52581812, "body": "@Jongware The accepted answer in the question you linked shows an implementation that specifically checks for integer base and exponent and is exact. It&#39;s from Apples (BSD&#39;s) libm."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1441206037, "post_id": 32353522, "comment_id": 52586154, "body": "@FUZxxl: You are reading too much into that sentence from the standard. See 5.2.4.2.2/6 &quot;The accuracy of the floating-point operations (<code>+</code>, <code>-</code>, <code>*</code>, <code>&#47;</code>) and of the library functions in <code>&lt;math.h&gt;</code> and <code>&lt;complex.h&gt;</code> that return floating-point results is implementation-defined.&quot;"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1441211628, "post_id": 32353522, "comment_id": 52589864, "body": "@rici Well okay, so don&#39;t use floating point math then. I believe though that if your implementation defines <code>__STDC_IEC_559__</code> (most do), then <code>pow</code> has to be accurate but I need to check further."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1441219930, "post_id": 32353522, "comment_id": 52594694, "body": "@FUZxxl: <code>__STDC_IEC_559__</code> guarantees the features listed in Annex F, which include conformance with the 1985 edition of IEEE-754, not the 2008 version. In 1985, only +, -, *, / and sqrt are required to be correctly rounded, and even in 2008 the additional functions would be optional. Notwithstanding all of that, I do use floating point, a lot. But when I convert to an integer, I make sure to round rather than truncate."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1441197835, "creation_date": 1441197835, "answer_id": 32353522, "question_id": 32353301, "link": "https://stackoverflow.com/questions/32353301/will-intpown-m-be-wrong-for-some-positive-integers-n-m/32353522#32353522", "title": "Will (int)pow(n,m) be wrong for some positive integers n,m?", "body": "<p>On platforms where an <code>int</code> has 64 bits and a <code>double</code> has also 64 bits, this may not work as a <code>double</code> (the arguments and result of <code>pow()</code>) doesn't have enough mantissa to represent each 64  bit integer exactly. On an ordinary platform where an <code>int</code> has 32 bits and a <code>double</code> is a 64 bit IEEE&nbsp;754 floating point type, your assumption is true.</p>\n"}, {"comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1441198065, "post_id": 32353542, "comment_id": 52580165, "body": "@TheParamagneticCroissant Show me one counterexample of positive n and m where this is not true. I can&#39;t think of any, but I&#39;m open to being wrong."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1441198205, "post_id": 32353542, "comment_id": 52580269, "body": "sorry, I was thinking about a different situation. I still believe there are examples, for which I&#39;m searching."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1441198352, "post_id": 32353542, "comment_id": 52580395, "body": "it depends on implementation. Some bad ones simply calculate pow(n, m) by <code>exp(log(n)*m)</code> and can&#39;t return the correct result for many integers"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1441210851, "post_id": 32353542, "comment_id": 52589425, "body": "some examples: <a href=\"http://stackoverflow.com/q/7937286/995714\">stackoverflow.com/q/7937286/995714</a> <a href=\"http://stackoverflow.com/q/17122496/995714\">stackoverflow.com/q/17122496/995714</a>"}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 0, "last_activity_date": 1441197901, "creation_date": 1441197901, "answer_id": 32353542, "question_id": 32353301, "link": "https://stackoverflow.com/questions/32353301/will-intpown-m-be-wrong-for-some-positive-integers-n-m/32353542#32353542", "title": "Will (int)pow(n,m) be wrong for some positive integers n,m?", "body": "<p>It depends on the sizes of your integers and doubles.</p>\n\n<p>With a 32 bit integer and a 64 bit IEEE 754 double, then it will give you a correct answer for all possible integers.</p>\n\n<p>An IEEE 754 binary64 floating point number (which is the usual representation of doubles on most modern machines) can exactly represent all integers [0,2^53].</p>\n"}, {"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1441207551, "post_id": 32355889, "comment_id": 52587293, "body": "I think the answer is more complicated than this. Even if <code>pow</code> is implemented via <code>log</code> and <code>exp</code>, those operations are required to &quot;round correctly&quot; by IEEE rules, see <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point#Recommended_operations\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>. The question is, if those operations <i>are</i> rounded correctly, will the answer ever be off? Of course you can&#39;t assume every C implementation abides by IEEE rules, but most modern ones will."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1441221410, "post_id": 32355889, "comment_id": 52595470, "body": "@MarkRansom: As that link points out, those operations are recommended, and conformance is optional. Anyway, &quot;most modern C implementations&quot; conform to IEEE-754-1985, as per Annex F of the current C standard; there is no reason to assume they will conform to optional features in IEEE-754-2008."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1441283187, "post_id": 32355889, "comment_id": 52621962, "body": "<code>pow(x, y)</code> is equivalent to <code>exp(y*log(x))</code>, not <code>exp(x*log(y))</code>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441711527, "post_id": 32355889, "comment_id": 52775043, "body": "Can you name a concrete implementation that is widespread and does so?"}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441731621, "post_id": 32355889, "comment_id": 52788628, "body": "@FUZxxl - it&#39;s right there, in the second link I provided."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441732410, "post_id": 32355889, "comment_id": 52789028, "body": "@BrettHale But the documentation claims \u201cGiven two IEEE double machine numbers y, x it computes the correctly rounded (to nearest) value of X^y.\u201d So it does not yield wrong results for integer bases and exponents."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441734894, "post_id": 32355889, "comment_id": 52790454, "body": "@FUZxxl - I haven&#39;t tested the results. But my understanding is that &#39;correct rounding to nearest&#39; means RN{x}, x within 1/2ulp of the exact result here."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441736182, "post_id": 32355889, "comment_id": 52791122, "body": "@BrettHale But if the integer is representable exactly as a floating point number (all 32 bit integers are representable as IEEE-754 <code>double</code> numbers), then the nearest number is the integer itself, rendering OPs assumption correct."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441736210, "post_id": 32355889, "comment_id": 52791136, "body": "Again, you have yet to show me a single case on a common implementation that yields a wrong result within the constraints specified by OP."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441737847, "post_id": 32355889, "comment_id": 52792103, "body": "@FUZxxl - The burden of proof isn&#39;t really on me. I&#39;m going with IEEE-754 requirements. Your answer makes the claim of exact results, with no reference to <i>any</i> standard or implementation, let alone <i>all</i> implementations. The top answer has already pointed out that this is not the case with the MS implementation -  assuming that&#39;s widespread enough for you."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441739382, "post_id": 32355889, "comment_id": 52792841, "body": "@BrettHale Well, so far every single implementation either of us cited has the property OP asked about. So why do you still refuse to believe this is actually the case? Clearly, neither of us was able to find a common implementation of the libc that does not exhibits OPs property. Of course, the standard does not guarantee this but it does not guarantee that <code>malloc()</code> ever succeeds either but almost all programs assume this."}], "tags": [], "owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "is_accepted": false, "score": 3, "last_activity_date": 1441285597, "last_edit_date": 1441285597, "creation_date": 1441204051, "answer_id": 32355889, "question_id": 32353301, "link": "https://stackoverflow.com/questions/32353301/will-intpown-m-be-wrong-for-some-positive-integers-n-m/32355889#32355889", "title": "Will (int)pow(n,m) be wrong for some positive integers n,m?", "body": "<p>Some implementations evaluate <code>pow(x,y)</code> as <code>exp(y*log(x))</code> in any case, and others use a square-multiply powering for integral exponents.</p>\n\n<p><a href=\"https://sourceware.org/git/?p=glibc.git;a=tree;f=sysdeps;hb=HEAD\" rel=\"nofollow\">glibc</a> for example has 'C' <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/ieee754/dbl-64/e_pow.c;hb=HEAD\" rel=\"nofollow\">implementations</a>, as well as platform-specific implementations with lookup tables, polynomial approximations, etc. Many Sun/BSD derivatives appear to handle integral exponents as a special case.</p>\n\n<p>More importantly, IEEE-754 doesn't require it. Nor does it specify the required accuracy of the result. glibc <a href=\"http://www.gnu.org/software/libc/manual/html_node/Errors-in-Math-Functions.html\" rel=\"nofollow\">documents</a> its maximum ulp errors, though this page might not be up to date.</p>\n\n<p>In summary, <strong>don't assume an exact integral result</strong>, even if <code>pow(n,m)</code> has an exact floating-point representation.</p>\n"}, {"comments": [{"owner": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1486785298, "post_id": 32356961, "comment_id": 71508618, "body": "Sir , Can You See This Question <a href=\"http://stackoverflow.com/questions/42164550/what-is-happening-here-in-pow-function\" title=\"what is happening here in pow function\">stackoverflow.com/questions/42164550/&hellip;</a> , It is about pow, but dont has good answer as of now."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 8, "last_activity_date": 1441220968, "last_edit_date": 1495535372, "creation_date": 1441206932, "answer_id": 32356961, "question_id": 32353301, "link": "https://stackoverflow.com/questions/32353301/will-intpown-m-be-wrong-for-some-positive-integers-n-m/32356961#32356961", "title": "Will (int)pow(n,m) be wrong for some positive integers n,m?", "body": "<p>The C standard does not impose any requirements on the accuracy of floating point arithmetic. The accuracy is <em>implementation-defined</em> which means that implementations are required to document it. However, implementations are left with a significant \"out\": (&sect;5.2.4.2.2 paragraph 6, emphasis added.)</p>\n\n<blockquote>\n  <p>The accuracy of the floating-point operations (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>) and of the library functions in <code>&lt;math.h&gt;</code> and <code>&lt;complex.h&gt;</code> that return floating-point results is implementation-defined, as is the accuracy of the conversion between floating-point internal representations and string representations performed by the library functions in <code>&lt;stdio.h&gt;</code>, <code>&lt;stdlib.h&gt;</code>, and <code>&lt;wchar.h&gt;</code>. <strong>The implementation may state that the\n  accuracy is unknown.</strong></p>\n</blockquote>\n\n<p>And, indeed, gcc takes advantage of this by specifying that <a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.2.0/gcc/Floating-point-implementation.html#Floating-point-implementation\" rel=\"nofollow noreferrer\">the accuracy is unknown</a>. Nonetheless, the accuracy of glibc computations is pretty good, even if not guaranteed.</p>\n\n<p>The MS libc implementation is known to occasionally produce an error of 1ULP for the <code>pow</code> function with integer arguments, resulting in an incorrect value if the result of the <code>pow</code> operation is simply truncated to an <code>int</code>. (I couldn't find any specification in the Visual Studio documentation about floating point accuracy, but I believe that the list of SO questions below provides evidence of my assertion.)</p>\n\n<p>On x86 architectures, most implementations make some attempt to implement IEEE 754, since the native floating point representation conforms. However, until the 2008 revision, IEEE-754 only required correctly-rounded results from <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and <code>sqrt</code>. Since the revision, <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point#Recommended_operations\" rel=\"nofollow noreferrer\">it recommends</a> that a number of other functions return correctly-rounded results, but all of these recommendations are optional, and few math libraries implement all of them.</p>\n\n<p>If you really want to use <code>pow</code> to compute integer powers of integers, it is advisable (and easy) to use <code>lround(pow(n, m))</code> instead of <code>(long)(pow(n, m))</code>, which will round the result to the nearest integer, rather than optimistically relying on the error being positive. That should give the correct integer value for results up to 2<sup>52</sup> (with IEEE-754 doubles) if <code>pow</code> is within 1ULP. Between 2<sup>52</sup> and 2<sup>53</sup>, a 1ULP error would be 0.5, which will sometimes round to the wrong integer. Beyond 2<sup>53</sup> not all integers are representable as doubles.</p>\n\n<p>SO is actually full of questions resulting from this particular problem. See:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/25695679/1566221\">Reversing a five digit number with POW function in C</a></li>\n<li><a href=\"https://stackoverflow.com/q/3509423/1566221\">C&#39;s pow() function as per header file &lt;math.h&gt; not working properly</a></li>\n<li><a href=\"https://stackoverflow.com/q/18155883/1566221\">Strange behaviour of the pow function</a></li>\n<li><a href=\"https://stackoverflow.com/q/27479620/1566221\">Why am I getting unexpected output when using floor with pow?</a></li>\n<li><a href=\"https://stackoverflow.com/q/9704195/1566221\">Why pow(10,5) = 9,999 in C++</a></li>\n<li><a href=\"https://stackoverflow.com/q/7937286/995714\">return value of pow() gets rounded down if assigned to an integer</a> (found by <a href=\"https://stackoverflow.com/users/995714/l%c6%b0u-v%c4%a9nh-ph%c3%bac\">L\u01b0u V\u0129nh Ph\u00fac</a>)</li>\n<li><a href=\"https://stackoverflow.com/q/17122496/995714\">wrong output by power function - C</a> (also)</li>\n</ul>\n\n<p>and undoubtedly many more.</p>\n"}], "owner": {"reputation": 1000, "user_id": 1537366, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3caa378c940acd69a32cbee6730f9f1e?s=128&d=identicon&r=PG", "display_name": "user1537366", "link": "https://stackoverflow.com/users/1537366/user1537366"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 32356961, "answer_count": 4, "score": 5, "last_activity_date": 1441285597, "creation_date": 1441197218, "last_edit_date": 1441260082, "question_id": 32353301, "link": "https://stackoverflow.com/questions/32353301/will-intpown-m-be-wrong-for-some-positive-integers-n-m", "title": "Will (int)pow(n,m) be wrong for some positive integers n,m?", "body": "<p>Assuming <code>n</code> and <code>m</code> are positive integers, and n<sup>m</sup> is within the range of an integer, will <code>(int)pow(n,m)</code> ever give a wrong answer?</p>\n\n<p>I have tried many <code>n</code> for <code>m=2</code> and have not gotten any wrong answers so far.</p>\n"}, {"tags": ["c", "performance", "gcc", "inlining"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1441197514, "post_id": 32353161, "comment_id": 52579737, "body": "Could it be that with a lot of inlining your code just suddenly starts thrashing the cache just to load the instructions? And the <code>fnew</code> function gets generated by gcc in a place which causes the decoder to get more cache misses. What hints that to me is that defining it static allows the compiler to make stronger assumptions from where it will be called and co-locate it there. My experience from a large project (several MB binary) has been that I could get large performance improvements from deinlining functions just to shrink cache usage by code."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1441197596, "post_id": 32353161, "comment_id": 52579808, "body": "Can you make a minimal self-contained example so we can toy around with this, too? This is really interesting."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441198670, "post_id": 32353161, "comment_id": 52580647, "body": "@FUZxxl : unfortunately no. While modifications lead to reproducible results, the relation between modification and effect seems totally random. Which makes it impossible to consciously produce a minimal self-contained example..."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1441198954, "post_id": 32353161, "comment_id": 52580873, "body": "@Art : maybe. Note that I&#39;m not forcibly inlining anything, I&#39;m letting the compiler decide, because in most circumstances, functions to inline are very small (1-5 lines), so it seems only common sense.  I also tried to look at the assembly generated. The &quot;slow&quot; and &quot;fast&quot; versions of <code>fdec</code> look surprisingly similar. There must be some subtle difference somewhere, but the generated assembly is way too large for me to analyze and find such subtle thing."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441199029, "post_id": 32353161, "comment_id": 52580929, "body": "@Cyan You should consider reporting a compiler bug or at least asking this question on the gcc mailing list. Does the problem persist if you switch to clang?"}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441199268, "post_id": 32353161, "comment_id": 52581109, "body": "@FUZxxl : yes, that could be something for the gcc team. Performance with clang is bad no matter what, but I know clang is more conservative with auto-inlining, and plan to look into it later into the development process. For the time being, the currently described issue is expected to be gcc-related, strictly."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1441200089, "post_id": 32353161, "comment_id": 52581706, "body": "@Cyan &quot;it seems only common sense&quot;. You&#39;d be surprised. I once deinlined a two line lock function that could be compiled down to a handful of instructions, shrunk the program by 100kB and improved overall performance by around 10%. This was over a decade ago, so hopefully gcc has improved somewhat, but in my experience all the settings in compilers are tuned for winning microbenchmarks that usually don&#39;t need to care about cache usage by instructions. Not saying that this happens here, but the compiler is often not as smart as we&#39;d like it to be."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1441200590, "post_id": 32353161, "comment_id": 52582079, "body": "@Art good point, but since there is no &quot;inline&quot; statenent in this particular piece of code, I don&#39;t see what more could be done to refrain gcc from inlining it.  Plus, in most cases, inlining is really wanted and good for performance."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1441201517, "post_id": 32353161, "comment_id": 52582773, "body": "@Cyan: Can you put the code on github or something, if it&#39;s not closed source?  External links aren&#39;t ideal, but they&#39;re better than the hand-waving in the question.  I suspect there&#39;s an alignment / cache-line issue.  Changes to the inlining parameter will change the size of functions, and bump other code over by multiples 16B.  This is a similar effect to changing the contents of a function: it gets bigger and changes the alignment of other functions."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1441201651, "post_id": 32353161, "comment_id": 52582882, "body": "Look at performance counters for the &quot;slow&quot; and &quot;fast&quot; versions, and see if any are different.  e.g. a lot more cache misses could indicate false sharing of a cache line between threads.  Also, profile and see if there&#39;s a new hotspot in the &quot;slow&quot; version."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1441204113, "post_id": 32353161, "comment_id": 52584647, "body": "@Peter : I was expecting the compiler to always make sure a function starts at ideal aligned position, using noop to fill gaps."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441205428, "post_id": 32353161, "comment_id": 52585710, "body": "Current tests are done on a Broadwell cpu (i7-5600u)"}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441208698, "post_id": 32353161, "comment_id": 52588102, "body": "Is there a way to have a look at function alignment ?"}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1441209286, "post_id": 32353161, "comment_id": 52588442, "body": "@PeterCordes : I&#39;ve been compiling the target source code with option <code>-falign-functions=64</code>, which if I understand properly force functions to be aligned on 64-bytes, hence cache lines. Performance of the slow version does not change, remains slow. But surprisingly, the fast version becomes slow with this option. Removing it gives back initial performance."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441212949, "post_id": 32353161, "comment_id": 52590628, "body": "I&#39;m leaning towards an alignment issue, although a fairly complex one. Are there tools to consult alignment of code ? Are there docs which explain how it works at cpu level regarding instruction alignment ?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1441226576, "post_id": 32353161, "comment_id": 52598217, "body": "@Cyan: Converted my recent comments to an answer.  Continue discussion there."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1441229830, "post_id": 32353161, "comment_id": 52599731, "body": "I might miss it, but what compiler flags do you specify? Is there <code>-O2</code> or <code>-O3</code>?"}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1441241622, "post_id": 32353161, "comment_id": 52603086, "body": "@maxim all tests are done at <code>-O3</code> setting"}], "answers": [{"comments": [{"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441205678, "post_id": 32356313, "comment_id": 52585892, "body": "The question states that the <code>inline</code> keyword is not used."}, {"owner": {"reputation": 11, "user_id": 3886280, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001938503506/picture?type=large", "display_name": "Akio Takahashi", "link": "https://stackoverflow.com/users/3886280/akio-takahashi"}, "reply_to_user": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441206669, "post_id": 32356313, "comment_id": 52586640, "body": "A function without &#39;inline&#39; can be inlined by the compiler. So I think your program is optimized with inlining."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441208542, "post_id": 32356313, "comment_id": 52588004, "body": "Yes it is. Most small functions are being inlined, except when the compiler detects that it&#39;s called very rarely. Using <code>gcc -fdump-ipa-inline</code>, one can see the inlining decision of gcc. Beware, this is a large dump, which can be difficult to read.  I did it on both the slow and fast versions. From the dump, it seems that inlining decisions are identical."}, {"owner": {"reputation": 1054, "user_id": 1984745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VQNmH.jpg?s=128&g=1", "display_name": "gbronner", "link": "https://stackoverflow.com/users/1984745/gbronner"}, "edited": false, "score": 0, "creation_date": 1441208696, "post_id": 32356313, "comment_id": 52588099, "body": "You can also look at the assembly code generated by the compilation -- I think you compile it with -s.  Worst case, you generate the assembly code using the &#39;fast&#39; version, save the assembly code, then add the extra function, comment out the offending function, and link it with the compiled assembly code."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441209525, "post_id": 32356313, "comment_id": 52588609, "body": "I did the &quot;generate assembly&quot; exercise. Problem is, the result is a huge file (several tens of thousands lines). It&#39;s way too large for me to decode usefully. My attempt to spot a difference between the &quot;fast&quot; and &quot;slow&quot; versions failed, they look mostly identical. Since all labels are different, it&#39;s impossible to make a simple &quot;file comparison&quot;, so reading the assembly is the only solution I found to compare. Not practical with such quantity of code."}, {"owner": {"reputation": 11, "user_id": 3886280, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001938503506/picture?type=large", "display_name": "Akio Takahashi", "link": "https://stackoverflow.com/users/3886280/akio-takahashi"}, "reply_to_user": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441210284, "post_id": 32356313, "comment_id": 52589095, "body": "@Cyan The result of -fdump-ipa-inline shows candidates for inlining, not actually inlined. Use -fdump-tree-all according to <a href=\"http://stackoverflow.com/questions/9190359/how-to-find-out-which-functions-were-not-inlined\">this</a>, or use -fno-inline to check whether if inlining optimization is the cause or not."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441211206, "post_id": 32356313, "comment_id": 52589637, "body": "<code>-fdump-ipa-inline</code> does give the inlined functions, but not at the beginning, which is only about candidates. Later on in the files, it states the definitive answer for each candidate. Besides, I&#39;m sure that inlining is, on average, massively beneficial. This is confirmed by making the test with <code>-fno-inline</code> as suggested : speed is reduced by a factor 3."}, {"owner": {"reputation": 11, "user_id": 3886280, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001938503506/picture?type=large", "display_name": "Akio Takahashi", "link": "https://stackoverflow.com/users/3886280/akio-takahashi"}, "edited": false, "score": 0, "creation_date": 1441213571, "post_id": 32356313, "comment_id": 52591046, "body": "It is one of mechanisms that cause performance drops. If the assembly code is essentially identical, inlining is not related to your problem. I&#39;m afraid to say that I can&#39;t guess things cause 20% performance drops without changes of algorithm or code flow."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1441226796, "post_id": 32356313, "comment_id": 52598333, "body": "Hm, I&#39;d expect the inline &quot;hint&quot; to be always followed if technically possible. I think it basically turns heuristics off."}], "tags": [], "owner": {"reputation": 11, "user_id": 3886280, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001938503506/picture?type=large", "display_name": "Akio Takahashi", "link": "https://stackoverflow.com/users/3886280/akio-takahashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1441205478, "last_edit_date": 1441205478, "creation_date": 1441205147, "answer_id": 32356313, "question_id": 32353161, "link": "https://stackoverflow.com/questions/32353161/large-performance-drop-with-gcc-maybe-related-to-inline/32356313#32356313", "title": "large performance drop with gcc, maybe related to inline", "body": "<p>In my experience, the performance drops may be caused by disabling inlining optimization.</p>\n\n<p>The 'inline' modifier doesn't indicate to force a function to be inlined. It gives compilers a hint to inline a function. So when the compiler's criteria of inlining optimizaion will not be satisfied by trivial modifications of code, a function which is modified with inline is normally compiled to a static function.</p>\n\n<p>And there is a thing make the problem more complex, nested inline optimizations. If you have a inline function, fA, that calls a inline function, fB, like this:</p>\n\n<pre><code>inline void fB(int x, int y) {\n    return x * y;\n}\n\ninline void fA() {\n    for(int i = 0; i &lt; 0x10000000; ++i) {\n        fB(i, i+1);\n    }\n}\n\nvoid main() {\n    fA();\n}\n</code></pre>\n\n<p>In this case, we expect that both fA and fB are inlined. But if the inlining criteia is not met, the performance can't be predictable. That is, large performance drops occur when inlining is disable about fB, but very slight drops for fA. And you know, compiler's internal decisions are much complex.</p>\n\n<p>The reasons cause disabling inlining, for example, size of inlining function, size of .c file, number of local variables, and so on.</p>\n\n<p>Actually, in C#, I am experienced this performance drops. In my case, 60% performance drop occurs when one local variable is added to a simple inlining function.</p>\n\n<h2>EDIT:</h2>\n\n<p>You can investigate what happens by reading compiled assembly code. I guess there are unexpected real callings to functions modified with 'inline'.</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1441227605, "post_id": 32362729, "comment_id": 52598724, "body": "May be try <code>-falign-functions=N</code> to see if it makes any difference?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1441228131, "post_id": 32362729, "comment_id": 52598966, "body": "@MaximEgorushkin: OP already tried, see comments on the question.  <code>-falign-functions=64</code> is apparently enough to flip performance from &quot;fast&quot; to &quot;slow&quot;."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441241855, "post_id": 32362729, "comment_id": 52603143, "body": "I could get some good results by using <code>-falign-loops=32</code> : then the generated binary seems to be always fast. So my latest suspicion is that the critical alignment condition must be applied on the main decoding loop. For reference, <code>-falign-loops=16</code> tend to produce &quot;slow&quot; version. The difficulty is that any change somewhere else in the code can randomly change the result, hence the suspicion for an alignment issue. However, I&#39;m very surprised that the binary size is <i>exactly the same</i> at align 16 and 32, which is counter intuitive : I would expect the 32 version to be larger."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441242776, "post_id": 32362729, "comment_id": 52603306, "body": "@Cyan: that is funny that the binary ends up the same size.  Maybe something else was still being aligned to 32, and <code>-falign-loops=32</code> just pushes something over by 16, leading to less padding after.  If you&#39;re lucky, <code>-falign-loops=32</code> will be the trick to robust good performance, even in the face of other changes.  32B code boundaries are always uop cache-line boundaries.  Like I keep saying, though, we can&#39;t do anything more than hand-wave until you post a link to the code, or find the actual spot in your loop where the &quot;slow&quot; version stalls, but the &quot;fast&quot; version doesn&#39;t."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1441243468, "post_id": 32362729, "comment_id": 52603425, "body": "For other speedups, are you using <code>-O3 -march=native</code>?  For a codec, esp. if you use arithmetic coding that represents a symbol with less than a full byte, you might find the bit-manipulation instructions useful. (BMI/BMI2, introduced with Haswell).  I haven&#39;t used them myself, but <code>bextr</code> looks very useful for unpacking bits from a bitstream.  The intrinsic is <code>uint64_t _bextr_u64 (uint64_t a, unsigned int start, unsigned int len)</code>.  So if you want to make a version of your functions for CPUs with BMI, you might get a speedup on them.  And of course vectors if applicable."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441243832, "post_id": 32362729, "comment_id": 52603501, "body": "While <code>-falign-loops=32</code> seems to work, it has a downside : it&#39;s a gcc-only command flag (not compatible with clang).  As a way to mitigate this issue, I tried to implement this option from within the source code, using <code>#pragma GCC optimize (&quot;align-loops=32&quot;)</code> as suggested by GCC doc. But it did not work : the resulting binary remained slow, as if the pragma was ignored.  I tried to get the size and alignment of the loop from generated assembly but failed (too complex dump).  Finally, I tried to <code>perf</code> slow and fast versions, unfortunately <code>-pg</code> change alignments, only generated fast  ..."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441244523, "post_id": 32362729, "comment_id": 52603654, "body": "@Cyan: <code>gcc -pg</code> adds instructions to instrument the binary, producing data that can be read by <code>gprof</code>.  <code>perf</code> uses hardware performance counters to profile any binary, with counts per-instruction.  <code>-pg</code> and <code>perf</code> are totally separate things.  I haven&#39;t used <code>#pragma</code>s, so IDK what&#39;s going wrong there.  Maybe it&#39;s the alignment of a loop in another function that pushes the start of your hot function to a better location?"}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1441245241, "post_id": 32362729, "comment_id": 52603846, "body": "Come on ... Thanks for reminding me correctly these tools. I&#39;ll send some results from <code>perf</code> in chat."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1441245996, "post_id": 32362729, "comment_id": 52603998, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/88641/discussion-between-cyan-and-peter-cordes\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1441309121, "last_edit_date": 1495542580, "creation_date": 1441226528, "answer_id": 32362729, "question_id": 32353161, "link": "https://stackoverflow.com/questions/32353161/large-performance-drop-with-gcc-maybe-related-to-inline/32362729#32362729", "title": "large performance drop with gcc, maybe related to inline", "body": "<p>Turning my comments into an answer, because it was turning into a long discussion.  Discussion showed that the performance problem is sensitive to alignment.</p>\n\n<p>There are links to some perf-tuning info at <a href=\"https://stackoverflow.com/tags/x86/info\">https://stackoverflow.com/tags/x86/info</a>, include Intel's optimization guide, and Agner Fog's very excellent stuff.  Some of Agner Fog's assembly optimization advice doesn't fully apply to Sandybridge and later CPUs.  If you want the low-level details on a specific CPU, though, the microarch guide is very good.</p>\n\n<p>Without at least an external link to code that I can try myself, I can't do more than handwave.  If you don't post the code anywher, you're going to need to use profiling / CPU performance counter tools like Linux <code>perf</code> or Intel VTune to track this down in a reasonable amount of time.</p>\n\n<hr>\n\n<p>In chat, the OP found <a href=\"http://pzemtsov.github.io/2014/05/12/mystery-of-unstable-performance.html\" rel=\"nofollow noreferrer\">someone else having this issue, but with code posted</a>.  <strong>This is probably the same issue the OP is seeing</strong>, and is one of the major ways code alignment matters for Sandybridge-style uop caches.</p>\n\n<p>There's a 32B boundary in the middle of the loop in the slow version.  The instructions that start before the boundary decode to 5 uops.  So in the first cycle, the uop cache serves up <code>mov/add/movzbl/mov</code>.  In the 2nd cycle, there's only a single <code>mov</code> uop left in the current cache line.  Then the 3rd cycle cycle issues the last 2 uops of the loop: <code>add</code> and <code>cmp+ja</code>.</p>\n\n<p>The problematic <code>mov</code> starts at <code>0x..ff</code>.  I guess instructions that span a 32B boundary go into (one of) the uop cacheline(s) for their starting address.</p>\n\n<p>In the fast version, an iteration only takes 2 cycles to issue: The same first cycle, then <code>mov / add / cmp+ja</code> in the 2nd.</p>\n\n<p>If one of the first 4 instructions had been one byte longer (e.g. padded with a useless prefix, or a REX prefix), there would be no problem.  There wouldn't be an odd-man-out at the end of the first cacheline, because the <code>mov</code> would start after the 32B boundary and be part of the next uop cache line.</p>\n\n<p>AFAIK, assemble &amp; check disassembly output is the only way to use longer versions of the same instructions (see Agner Fog's Optimizing Assembly) to get 32B boundaries at multiples of 4 uops.  I'm not aware of a GUI that shows alignment of assembled code as you're editing.  (And obviously, doing this only works for hand-written asm, and is brittle.  Changing the code at all will break the hand-alignment.)</p>\n\n<p>This is why Intel's optimization guide recommends aligning critical loops to 32B.</p>\n\n<p>It would be really cool if an assembler had a way to request that preceding instructions be assembled using longer encodings to pad out to a certain length.  Maybe a <code>.startencodealign</code> / <code>.endencodealign 32</code> pair of directives, to apply padding to code between the directives to make it end on a 32B boundary.  This could make terrible code if used badly, though.</p>\n\n<hr>\n\n<p>Changes to the inlining parameter will change the size of functions, and bump other code over by multiples 16B. This is a similar effect to changing the contents of a function: it gets bigger and changes the alignment of other functions.</p>\n\n<blockquote>\n  <p>I was expecting the compiler to always make sure a function starts at\n  ideal aligned position, using noop to fill gaps.</p>\n</blockquote>\n\n<p>There's a tradeoff. It would hurt performance to align every function to 64B (the start of a cache line). Code density would go down, with more cache lines needed to hold the instructions. 16B is good, because it's the instruction fetch/decode chunk size on most recent CPUs.</p>\n\n<p><a href=\"http://agner.org/optimize/\" rel=\"nofollow noreferrer\">Agner Fog</a> has the low-level details for each microarch.  He hasn't updated it for Broadwell, though, but the uop cache probably hasn't changed since Sandybridge. I assume there's one fairly small loop that dominates the runtime. I'm not sure exactly what to look for first.  Maybe the \"slow\" version has some branch targets near the end of a 32B block of code (and hence near the end of a uop cacheline), leading to significantly less than 4 uops per clock coming out of the frontend.</p>\n\n<p>Look at performance counters for the \"slow\" and \"fast\" versions (e.g. with <code>perf stat ./cmd</code>), and see if any are different. e.g. a lot more cache misses could indicate false sharing of a cache line between threads.  Also, profile and see if there's a new hotspot in the \"slow\" version.  (e.g. with <code>perf record ./cmd &amp;&amp; perf report</code> on Linux).</p>\n\n<p>How many uops/clock is the \"fast\" version getting? If it's above 3, frontend bottlenecks (maybe in the uop cache) that are sensitive to alignment could be the issue.  Either that or L1 / uop-cache misses if different alignment means your code needs more cache lines than are available.</p>\n\n<p>Anyway, this bears repeating: <strong>use a profiler / performance counters to find the new bottleneck</strong> that the \"slow\" version has, but the \"fast\" version doesn't.  Then you can spend time looking at the disassembly of that block of code.  (Don't look at gcc's asm output.  You need to see the alignment in the disassembly of the final binary.)  Look at the 16B and 32B boundaries, since presumably they'll be in different places between the two versions, and we think that's the cause of the problem.</p>\n\n<p>Alignment can also make macro-fusion fail, if a compare/jcc splits a 16B boundary exactly.  Although that is unlikely in your case, since your functions are always aligned to some multiple of 16B.</p>\n\n<p>re: automated tools for alignment: no, I'm not aware of anything that can look at a binary and tell you anything useful about alignment.  I wish there was an editor to show groups of 4 uops and 32B boundaries alongside your code, and update as you edit.</p>\n\n<p><a href=\"https://software.intel.com/en-us/articles/intel-architecture-code-analyzer-download\" rel=\"nofollow noreferrer\">Intel's IACA</a> can sometimes be useful for analyzing a loop, but IIRC it doesn't know about taken branches, and I think doesn't have a sophisticated model of the frontend, which is obviously the issue if misalignment breaks performance for you.</p>\n"}], "owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 1, "accepted_answer_id": 32362729, "answer_count": 2, "score": 10, "last_activity_date": 1441333620, "creation_date": 1441196872, "last_edit_date": 1441333620, "question_id": 32353161, "link": "https://stackoverflow.com/questions/32353161/large-performance-drop-with-gcc-maybe-related-to-inline", "title": "large performance drop with gcc, maybe related to inline", "body": "<p>I'm currently experiencing some weird effect with <code>gcc</code> (tested version: 4.8.4).</p>\n\n<p>I've got a performance oriented code, which runs pretty fast. Its speed depends for a large part on inlining many small functions.</p>\n\n<p>Since inlining across multiple <code>.c</code> files is difficult (<code>-flto</code> is not yet widely available), I've kept a lot of small functions (typically 1 to 5 lines of code each) into a common C file, into which I'm developing a codec, and its associated decoder. It's \"relatively\" large by my standard (about ~2000 lines, although a lot of them are just comments and blank lines), but breaking it into smaller parts opens new problems, so I would prefer to avoid that, if that is possible.</p>\n\n<p>Encoder and Decoder are related, since they are inverse operations. But from a programming perspective, they are completely separated, sharing nothing in common, except a few typedef and very low-level functions (such as reading from unaligned memory position).</p>\n\n<p>The strange effect is this one:</p>\n\n<p>I recently added a new function <code>fnew</code> to the encoder side. It's a new \"entry point\". It's not used nor called from anywhere within the <code>.c</code> file.</p>\n\n<p>The simple fact that it exists makes the performance of the <em>decoder</em> function <code>fdec</code> drops substantially, by more than 20%, which is way too much to be ignored.</p>\n\n<p>Now, keep in mind than encoding and decoding operations are completely separated, and share almost nothing, save some minor <code>typedef</code> (<code>u32</code>, <code>u16</code> and such) and associated operations (read/write).</p>\n\n<p>When defining the new encoding function <code>fnew</code> as <code>static</code>, performance of the decoder <code>fdec</code> increases back to normal. Since <code>fnew</code> isn't called from the <code>.c</code>, I guess it's the same as if it was not there (dead code elimination).</p>\n\n<p>If <code>static fnew</code> is now called from the encoder side, performance of <code>fdec</code> remains strong.</p>\n\n<p>But as soon as <code>fnew</code> is modified, <code>fdec</code> performance just drops substantially.</p>\n\n<p>Presuming <code>fnew</code> modifications crossed a threshold, I increased the following <code>gcc</code> parameter: <code>--param max-inline-insns-auto=60</code> (by default, its value is supposed to be 40.) And it worked : performance of <code>fdec</code> is now back to normal.</p>\n\n<p>And I guess this game will continue forever with each little modification of <code>fnew</code> or anything else similar, requiring further tweak.</p>\n\n<p>This is just plain weird. There is no logical reason for some little modification in function <code>fnew</code> to have knock-on effect on completely unrelated function <code>fdec</code>, which only relation is to be in the same file.</p>\n\n<p>The only tentative explanation I could invent so far is that maybe the simple presence of <code>fnew</code> is enough to cross some kind of <code>global file threshold</code> which would impact <code>fdec</code>. <code>fnew</code> can be made \"not present\" when it's: 1. not there, 2. <code>static</code> but not called from anywhere 3. <code>static</code> and small enough to be inlined. But it's just hiding the problem. Does that mean I can't add any new function?</p>\n\n<p>Really, I couldn't find any satisfying explanation anywhere on the net.</p>\n\n<p>I was curious to know if someone already experienced some equivalent side-effect, and found a solution to it.</p>\n\n<p><em>[Edit]</em></p>\n\n<p>Let's go for some more crazy test.\nNow I'm adding <em>another</em> completely useless function, just to play with. Its content is strictly exactly a copy-paste of <code>fnew</code>, but the name of the function is obviously different, so let's call it <code>wtf</code>.</p>\n\n<p>When <code>wtf</code> exists, it doesn't matter if <code>fnew</code> is static or not, nor what is the value of <code>max-inline-insns-auto</code>: performance of <code>fdec</code> is back to normal.\nEven though <code>wtf</code> is not used nor called from anywhere... :'(</p>\n\n<p><em>[Edit 2]</em> \nthere is no <code>inline</code> instruction. All functions are either normal or <code>static</code>. Inlining decision is solely within compiler's realm, which has worked fine so far.</p>\n\n<p><em>[Edit 3]</em>\nAs suggested by Peter Cordes, the issue is not related to inline, but to instruction alignment. On newer Intel cpus (Sandy Bridge and later), hot loop benefit from being aligned on 32-bytes boundaries.\nProblem is, by default, <code>gcc</code> align them on 16-bytes boundaries. Which gives a 50% chance to be on proper alignment depending on length of previous code. Hence a difficult to understand issue, which \"looks random\".</p>\n\n<p>Not all loop are sensitive. It only matters for critical loops, and only if their length make them cross one more 32-bytes instruction segment when being less ideally aligned.</p>\n"}, {"tags": ["c++", "c", "visual-studio-2013", "linker", "unresolved-external"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1441197789, "post_id": 32353144, "comment_id": 52579968, "body": "You need to link all the compiled files together."}, {"owner": {"reputation": 1684, "user_id": 2079393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b3eda883f78462a71003d9b3d5003?s=128&d=identicon&r=PG", "display_name": "MaxP", "link": "https://stackoverflow.com/users/2079393/maxp"}, "edited": false, "score": 0, "creation_date": 1441197866, "post_id": 32353144, "comment_id": 52580027, "body": "The linker says that missing function has a <code>struct Stru1</code> parameter, while file.h defines functions with <code>struct Str1</code> parameter. So maybe something is missing (or miscopied) either in your code or in the question. Also, unless the compiler default language is C++, you need the extern &quot;C&quot; bracing C-implemented functions."}], "answers": [{"tags": [], "owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "is_accepted": false, "score": 0, "last_activity_date": 1441197866, "creation_date": 1441197866, "answer_id": 32353530, "question_id": 32353144, "link": "https://stackoverflow.com/questions/32353144/lnk2001-unresolved-external-symbol-void-cdecl-func1struct-stru1/32353530#32353530", "title": "LNK2001: unresolved external symbol &quot;void __cdecl func1(struct Stru1 *)&quot;", "body": "<p>You most probably forgot to add your file1.c to project for building.</p>\n\n<p>Below is something you should not do in c++:</p>\n\n<pre><code>#include \"file1.h\"\n#include \"file2.h\"  \n    func1(variable);\n    func2(variable);\n #include \"file1.c\"\n#include \"file2.c\" \n</code></pre>\n\n<p>those #include \"file1.c\"/#include \"file2.c\", is whats your project is for - you add new files inside IDE.</p>\n"}], "owner": {"reputation": 840, "user_id": 5292347, "user_type": "registered", "accept_rate": 24, "profile_image": "https://lh3.googleusercontent.com/-ahmB1uSwJo8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFI54d1HiMALNuMeDWm_Lt8Ap5Aw/photo.jpg?sz=128", "display_name": "Carlos Siestrup", "link": "https://stackoverflow.com/users/5292347/carlos-siestrup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1390, "favorite_count": 0, "closed_date": 1441198323, "answer_count": 1, "score": -1, "last_activity_date": 1441211202, "creation_date": 1441196824, "last_edit_date": 1441211202, "question_id": 32353144, "link": "https://stackoverflow.com/questions/32353144/lnk2001-unresolved-external-symbol-void-cdecl-func1struct-stru1", "closed_reason": "Duplicate", "title": "LNK2001: unresolved external symbol &quot;void __cdecl func1(struct Stru1 *)&quot;", "body": "<p>Let me edit the question:\nThe files are:</p>\n\n<pre><code>file1.h\nfile1.c\nfile3.h\nfile2.h\nfile2.c\nfile4.h\nfile5.h\nmain_code.cpp\n</code></pre>\n\n<p>file1.h</p>\n\n<pre><code>#include \"file3.h\"\ntypedef struct{} Str1;\nvoid func1(Str1 *str1);\nvoid func2(Str1 *str1);\n</code></pre>\n\n<p>file1.c</p>\n\n<pre><code>#include \"file3.h\"\n#include \"file1.h\"\n#include \"file2.h\"\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nvoid func1(Str1 *str1){}\nvoid func2(Str1 *str1){}\n</code></pre>\n\n<p>file2.h</p>\n\n<pre><code>#include \"file3.h\"\n#include \"file1.h\"\n</code></pre>\n\n<p>file2.c</p>\n\n<pre><code>#include \"file3.h\"\n#include \"file1.h\"\n#include \"file2.h\"\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n</code></pre>\n\n<p>file3.h</p>\n\n<pre><code>Doesnt include others.\n</code></pre>\n\n<p>file4.h</p>\n\n<pre><code>#include \"file1.h\"\n#include \"file2.h\"\n#include \"file5.h\"\n</code></pre>\n\n<p>file5.h</p>\n\n<pre><code>#include \"file3.h\"\n</code></pre>\n\n<p>main_code.cpp</p>\n\n<pre><code>#include \"file1.h\"\n#include \"file2.h\"\n#include \"file4.h\"\n#include \"file5.h\"\nfunc1(variable)\nfunc2(variable)\n</code></pre>\n\n<p>The erro \"LNK2001: unresolved external symbol\" happen with func1 and func2 so I didnt place what functions the others have. I already tried placing the include in the \"extern C\" but didnt work.\nAnd if I add to main_code.cpp</p>\n\n<pre><code>  #include \"file1.c\"\n</code></pre>\n\n<p>Then the program works...</p>\n"}, {"tags": ["c", "ip", "c-preprocessor", "low-level"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1441196975, "post_id": 32353105, "comment_id": 52579322, "body": "Why don&#39;t you actually <i>post</i> the compiler error?"}, {"owner": {"reputation": 1684, "user_id": 2079393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143b3eda883f78462a71003d9b3d5003?s=128&d=identicon&r=PG", "display_name": "MaxP", "link": "https://stackoverflow.com/users/2079393/maxp"}, "edited": false, "score": 0, "creation_date": 1441198196, "post_id": 32353105, "comment_id": 52580259, "body": "It should work. Probably something else is in the way."}], "answers": [{"tags": [], "owner": {"reputation": 4596, "user_id": 3743145, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/680680d82143e4d33dc569913e5ef8c5?s=128&d=identicon&r=PG", "display_name": "kyb", "link": "https://stackoverflow.com/users/3743145/kyb"}, "is_accepted": true, "score": 0, "last_activity_date": 1441203114, "creation_date": 1441203114, "answer_id": 32355528, "question_id": 32353105, "link": "https://stackoverflow.com/questions/32353105/c-pass-the-predefined-list-of-arguments-to-function/32355528#32355528", "title": "C. Pass the #predefined list of arguments to function", "body": "<p>No problem with such code. GCC ate it without any warnings. The problem is with my compilier. \nYou can test on ideone <a href=\"https://ideone.com/\" rel=\"nofollow\">https://ideone.com/</a> 0VIkz5</p>\n"}], "owner": {"reputation": 4596, "user_id": 3743145, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/680680d82143e4d33dc569913e5ef8c5?s=128&d=identicon&r=PG", "display_name": "kyb", "link": "https://stackoverflow.com/users/3743145/kyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 32355528, "answer_count": 1, "score": -1, "last_activity_date": 1441203114, "creation_date": 1441196734, "question_id": 32353105, "link": "https://stackoverflow.com/questions/32353105/c-pass-the-predefined-list-of-arguments-to-function", "title": "C. Pass the #predefined list of arguments to function", "body": "<p>In C there is the way to initialize array or struct with predefined list of values:</p>\n\n<pre><code>#define STRUCT_DUMMY_VAL1  \"dummy\", 21, 2.3\nstruct dummy d = {STRUCT_DUMMY_VAL1};\n\n#define INT_ARRAY_VAL1     1,2,3\nint a[] = {INT_ARRAY_VAL1};\n</code></pre>\n\n<p>Is there the way to pass the predefined list of arguments to function?</p>\n\n<pre><code>#define IP_ADDR  192,168,3,3\nip_addr_assemble(u8_t,u8_t,u8_t,u8_t);\nvoid dosmth(){\n    u32_t ip = ip_addr_assemble(IP_ADDR);  // Compile error\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1441196788, "post_id": 32353022, "comment_id": 52579156, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/897366/how-do-pointer-to-pointers-work-in-c\">How do pointer to pointers work in C?</a>"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1441197055, "post_id": 32353022, "comment_id": 52579385, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/29692986/not-able-to-understand-the-notations-and-with-pointers\">Not able to understand the notations : * and ** with pointers</a>"}, {"owner": {"reputation": 19, "user_id": 5181116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vqJj.png?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/5181116/jean"}, "edited": false, "score": 0, "creation_date": 1441201796, "post_id": 32353022, "comment_id": 52583003, "body": "\u662f\u7684\u5462\uff0c\u6700\u8fd1\u4e00\u76f4\u5728\u5b66\u4e60\u7b97\u6cd5\uff0c\u6307\u9488\u90a3\u90e8\u5206\u770b\u4e86\u4e0d\u5c11\uff0c\u73b0\u5728\u7ed3\u6784\u4f53\u6307\u9488\u53c8\u6765\u4e86\u3002\u638c\u63e1\u7684\u4e0d\u624e\u5b9e\u5462\u3002"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 0, "last_activity_date": 1441196695, "creation_date": 1441196695, "answer_id": 32353094, "question_id": 32353022, "link": "https://stackoverflow.com/questions/32353022/struct-pointers-too-many-pointer-symbols/32353094#32353094", "title": "struct pointers,too many pointer symbols", "body": "<p>Nothing really, a pointer is a pointer is a pointer, it's how you <em>use</em> it that makes all the difference. </p>\n\n<p>This pattern (passing a pointer to a pointer to something) is a ways of emulating <em>pass by reference</em> (which C doesn't have) for a pointer. This means that when you change the pointer using e.g. <code>*top_ptr = top-&gt;Next</code> that change will be in the calling function as well.</p>\n"}], "owner": {"reputation": 19, "user_id": 5181116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8vqJj.png?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/5181116/jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 32353094, "answer_count": 1, "score": -3, "last_activity_date": 1441197958, "creation_date": 1441196536, "last_edit_date": 1441197958, "question_id": 32353022, "link": "https://stackoverflow.com/questions/32353022/struct-pointers-too-many-pointer-symbols", "title": "struct pointers,too many pointer symbols", "body": "<p>Recently, I've been learning algorithms, so I try to code leetcode. There are some programs like</p>\n\n<pre><code>int pop(struct node ** top_pt){\n//\u5f39\u51fa\u6570\u636e\u5e76\u4e14\u91ca\u653e\u5185\u5b58\nif (*top_pt==NULL){\n    printf(\"stack overflow\\n\");\n    exit(0);\n}\n\nstruct Node *top=*top_pt;\n//\u6ee1\u9012\u589e\nint res=top-&gt;val;\n\n*top_pt=top-&gt;Next;\nfree(top);\nreturn res;\n</code></pre>\n\n<p>}</p>\n\n<p>so, what is the difference between the pointers like <code>*</code> and <code>**</code>?</p>\n"}, {"tags": ["c", "linux", "console-application", "ncurses"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441195031, "post_id": 32352409, "comment_id": 52577930, "body": "You could also consider changing the colour settings of your terminal emulator to use black on white if you like it better."}, {"owner": {"reputation": 657, "user_id": 4887425, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/386236b5ee2cc08f9db611f4820b2dac?s=128&d=identicon&r=PG&f=1", "display_name": "sadljkfhalskdjfh", "link": "https://stackoverflow.com/users/4887425/sadljkfhalskdjfh"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441195104, "post_id": 32352409, "comment_id": 52577982, "body": "@FUZxxl I don&#39;t use X, I use the tty/console."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441195267, "post_id": 32352409, "comment_id": 52578110, "body": "What operating system? On Linux you  can <a href=\"http://askubuntu.com/questions/147462/how-can-i-change-the-tty-colors\">change the colours</a> for the virtual terminal as you like."}, {"owner": {"reputation": 657, "user_id": 4887425, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/386236b5ee2cc08f9db611f4820b2dac?s=128&d=identicon&r=PG&f=1", "display_name": "sadljkfhalskdjfh", "link": "https://stackoverflow.com/users/4887425/sadljkfhalskdjfh"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1441195323, "post_id": 32352409, "comment_id": 52578154, "body": "@FUZxxl Yes it&#39;s on Linux, I edited the post to make that more clear."}, {"owner": {"reputation": 657, "user_id": 4887425, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/386236b5ee2cc08f9db611f4820b2dac?s=128&d=identicon&r=PG&f=1", "display_name": "sadljkfhalskdjfh", "link": "https://stackoverflow.com/users/4887425/sadljkfhalskdjfh"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1441195778, "post_id": 32352409, "comment_id": 52578444, "body": "@user3121023 Yes, I have looked at them, but those don&#39;t do much better than <code>attron()</code>. They change the text colour <i>up to the newline</i> and not to the edge of the screen."}, {"owner": {"reputation": 657, "user_id": 4887425, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/386236b5ee2cc08f9db611f4820b2dac?s=128&d=identicon&r=PG&f=1", "display_name": "sadljkfhalskdjfh", "link": "https://stackoverflow.com/users/4887425/sadljkfhalskdjfh"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1441196298, "post_id": 32352409, "comment_id": 52578802, "body": "@user3121023 Yes. It doesn&#39;t appear to work (at least over SSH). I also used <code>use_default_colors()</code> afterwards."}], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 4887425, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/386236b5ee2cc08f9db611f4820b2dac?s=128&d=identicon&r=PG&f=1", "display_name": "sadljkfhalskdjfh", "link": "https://stackoverflow.com/users/4887425/sadljkfhalskdjfh"}, "edited": false, "score": 0, "creation_date": 1441197267, "post_id": 32353030, "comment_id": 52579552, "body": "Thanks, on my old version, I put <code>start_color()</code> <i>before</i> <code>assume_default_colors()</code>... how silly of me."}], "tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 1, "last_activity_date": 1441196559, "creation_date": 1441196559, "answer_id": 32353030, "question_id": 32352409, "link": "https://stackoverflow.com/questions/32352409/change-entire-content-of-console-to-reverse-video/32353030#32353030", "title": "Change entire content of console to reverse video", "body": "<p>This gave me black text on a white background.</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n\nint main(void)\n{\n    initscr();\n    if (has_colors()) {\n        assume_default_colors( COLOR_BLACK, COLOR_WHITE);\n        start_color();\n    }\n    printw(\"line 1\\n\");\n    printw(\"line 2\\n\");\n    printw(\"line 3\\n\");\n    printw(\"press enter\");\n    getch();\n    endwin();\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 657, "user_id": 4887425, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/386236b5ee2cc08f9db611f4820b2dac?s=128&d=identicon&r=PG&f=1", "display_name": "sadljkfhalskdjfh", "link": "https://stackoverflow.com/users/4887425/sadljkfhalskdjfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 32353030, "answer_count": 1, "score": 2, "last_activity_date": 1441196559, "creation_date": 1441194731, "last_edit_date": 1441195300, "question_id": 32352409, "link": "https://stackoverflow.com/questions/32352409/change-entire-content-of-console-to-reverse-video", "title": "Change entire content of console to reverse video", "body": "<p>I have written a small pager in C using ncurses on Linux. Because this pager is only for myself, and because I find it easier to read text with the whole page in reverse video, I want to find a way to change the entire screen colour to reverse video, i.e. not just until the last character before the newline. Something like the difference between the commands <code>emacs</code> and <code>emacs -r</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 5, "creation_date": 1441194328, "post_id": 32352174, "comment_id": 52577448, "body": "This is at least the 100th question about returning pointers to local variables."}, {"owner": {"reputation": 182, "user_id": 5184415, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203025935607711/picture?type=large", "display_name": "venki", "link": "https://stackoverflow.com/users/5184415/venki"}, "edited": false, "score": 1, "creation_date": 1441194704, "post_id": 32352174, "comment_id": 52577697, "body": "duplicate so many questions regarding this why don&#39;t you make it duplicate no effort"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5243814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5627aab1af4f30384e2aeae4e3c84646?s=128&d=identicon&r=PG&f=1", "display_name": "kashish", "link": "https://stackoverflow.com/users/5243814/kashish"}, "edited": false, "score": 0, "creation_date": 1441198751, "post_id": 32352223, "comment_id": 52580712, "body": "but if i take      &#39;char *z&#39;      inside func() and put     &#39;z=t&#39;    before while loop and then       &#39;return z;&#39;               then it works.. why does it works in this case??"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 15, "user_id": 5243814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5627aab1af4f30384e2aeae4e3c84646?s=128&d=identicon&r=PG&f=1", "display_name": "kashish", "link": "https://stackoverflow.com/users/5243814/kashish"}, "edited": false, "score": 0, "creation_date": 1441199851, "post_id": 32352223, "comment_id": 52581535, "body": "@kashish It does not work, it <i>seems</i> to work. Another beauty of UB. Please read the linked content for more info on this. :)"}, {"owner": {"reputation": 15, "user_id": 5243814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5627aab1af4f30384e2aeae4e3c84646?s=128&d=identicon&r=PG&f=1", "display_name": "kashish", "link": "https://stackoverflow.com/users/5243814/kashish"}, "edited": false, "score": 0, "creation_date": 1441201797, "post_id": 32352223, "comment_id": 52583006, "body": "i got this..thank :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1441194467, "last_edit_date": 1441194467, "creation_date": 1441194157, "answer_id": 32352223, "question_id": 32352174, "link": "https://stackoverflow.com/questions/32352174/function-returning-pointer-to-string-not-working/32352223#32352223", "title": "function returning pointer to string not working", "body": "<p>In your <code>fuc()</code>, <code>char t[10];</code> is a local variable. Once your function finishes execution, there is no existence of <code>t</code>. So, in the caller, the returned pointer becomes invalid.</p>\n\n<p>Using that returned pointer further leads to  <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behaviour</a>.</p>\n\n<p>If you want to return the pointer from <code>fuc()</code>, you need to make use of dynamic memory allocation function , like <a href=\"http://linux.die.net/man/3/malloc\" rel=\"nofollow\"><code>malloc()</code></a> and family. In that case, inside the caller function, once you're done using the memory, you need to take care for <a href=\"http://linux.die.net/man/3/free\" rel=\"nofollow\"><code>free()</code></a>-ing the allocated memory, too.</p>\n\n<p>That said, from the logical point of view, inside your <code>fuc()</code>, you're iterating over <code>t</code> without any check on the <em>bounds</em>. You should check for the size of <code>t</code> before using the index.</p>\n\n<p>Furthermore, <code>main()</code> is not a proper form of the function. At Least, it should be <code>int main(void)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 2, "last_activity_date": 1441194170, "creation_date": 1441194170, "answer_id": 32352227, "question_id": 32352174, "link": "https://stackoverflow.com/questions/32352174/function-returning-pointer-to-string-not-working/32352227#32352227", "title": "function returning pointer to string not working", "body": "<p>Array <code>t</code> is local to function <code>func()</code> so once you exit the function you can't access array <code>t</code> which will lead to undefined behavior.</p>\n\n<p>You should allocate memory on heap.</p>\n\n<pre><code>char *t = malloc(10);\n</code></pre>\n\n<p>Now you can return a pointer from the function <code>func()</code></p>\n"}], "owner": {"reputation": 15, "user_id": 5243814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5627aab1af4f30384e2aeae4e3c84646?s=128&d=identicon&r=PG&f=1", "display_name": "kashish", "link": "https://stackoverflow.com/users/5243814/kashish"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "closed_date": 1441197764, "accepted_answer_id": 32352223, "answer_count": 2, "score": -3, "last_activity_date": 1442539262, "creation_date": 1441194047, "last_edit_date": 1442539262, "question_id": 32352174, "link": "https://stackoverflow.com/questions/32352174/function-returning-pointer-to-string-not-working", "closed_reason": "Duplicate", "title": "function returning pointer to string not working", "body": "<p>I want to know why doesn't the following work correctly? Though I have tried the other ways that work, but for the sake of more clarity I would like to know the problem occurring here. </p>\n\n<pre><code>char *fuc(char *s)\n{\n     char t[10];\n     int r=0;\n     while(s[r] != '\\0')\n     {\n        t[r] = s[r];\n        r++; \n     }\n     t[r]='\\0';\n     return &amp;t[0];   \n}\n\nmain()\n{\n    char s[]=\"abcde\";\n    char *p;\n    p=func(s);\n    puts(p);\n}\n</code></pre>\n"}, {"tags": ["c", "eclipse", "debugging", "breakpoints"], "comments": [{"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1441193203, "post_id": 32351760, "comment_id": 52576726, "body": "Are some of them release builds and others debug builds?"}, {"owner": {"reputation": 1, "user_id": 5292186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82547d0c4cc9d4de416cca1a18fd8f0?s=128&d=identicon&r=PG&f=1", "display_name": "richard", "link": "https://stackoverflow.com/users/5292186/richard"}, "reply_to_user": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1441197586, "post_id": 32351760, "comment_id": 52579800, "body": "@Thomas: Sorry, I&#39;m not sure what you mean. Where can I check that? But all source files I need for debugging belong to the same project."}, {"owner": {"reputation": 1, "user_id": 5292186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82547d0c4cc9d4de416cca1a18fd8f0?s=128&d=identicon&r=PG&f=1", "display_name": "richard", "link": "https://stackoverflow.com/users/5292186/richard"}, "reply_to_user": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1441198040, "post_id": 32351760, "comment_id": 52580148, "body": "Build mode is set to &quot;Default&quot; for the project."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441219727, "post_id": 32351760, "comment_id": 52594579, "body": "assure all compile/link steps have NO optimization and all compile/link steps have the parameter -g (or for gcc -ggdb) .  Assure that the debugger has permissions to read all the source files, including the directories the source files are in."}, {"owner": {"reputation": 1, "user_id": 5292186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82547d0c4cc9d4de416cca1a18fd8f0?s=128&d=identicon&r=PG&f=1", "display_name": "richard", "link": "https://stackoverflow.com/users/5292186/richard"}, "edited": false, "score": 0, "creation_date": 1441223237, "post_id": 32351760, "comment_id": 52596446, "body": "I tried -ggdb option instead of -g, which I had set before in the makefiles. The src folder and all subdirectories have read and write permissions for any user."}], "owner": {"reputation": 1, "user_id": 5292186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82547d0c4cc9d4de416cca1a18fd8f0?s=128&d=identicon&r=PG&f=1", "display_name": "richard", "link": "https://stackoverflow.com/users/5292186/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441192835, "creation_date": 1441192835, "question_id": 32351760, "link": "https://stackoverflow.com/questions/32351760/cant-set-breakpoints-in-some-source-files", "title": "Can&#39;t set breakpoints in some source files", "body": "<p>I'm using Eclipse Mars on an Ubuntu 14.04 virtual machine running in VirtualBox. Currently I'm trying to debug initdb of postgresql after I've change some code. Now initdb is starting correctly in the debugger.</p>\n\n<p>The problem: When I set a breakpoint in certain source files, this breakpoint gets set and the little blue dot appears in the column on the left of the editor. But: The gdb process prints the following error message on the console: \"No source file named $P.\", where $P equals the path of the source file, in which I set the breakpoint. Furthermore, the debugger doesn't halt the program execution at such a breakpoint.</p>\n\n<p>This kind of problem I've seen quite a lot while I tried to find a solution, but what makes my situation different is this: The problem I described above doesn't appear with all source files in my project folder. It's only with some source files and in others I can set working breakpoints without any problem.</p>\n\n<p>I appreciate any help.</p>\n"}, {"tags": ["c", "linux", "io", "linux-kernel"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1441192002, "post_id": 32351370, "comment_id": 52575920, "body": "An xy problem. The first thing you find is not necessarily the best."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1441195166, "post_id": 32351370, "comment_id": 52578024, "body": "I agree with stark -- I don&#39;t see how you&#39;re going to find out <i>access time information</i> using these -- but IO statistics are available in <code>&#47;proc&#47;PID&#47;io</code> pseudofile for the process <code>PID</code>, and in <code>&#47;proc&#47;PID&#47;task&#47;TID&#47;io</code> per thread; these are Linux-specific kernel-provided pseudofiles so are always in the C/POSIX locale."}], "owner": {"reputation": 453, "user_id": 3719323, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/54ec9ddce183a25228d1035a71532812?s=128&d=identicon&r=PG&f=1", "display_name": "userDtrm", "link": "https://stackoverflow.com/users/3719323/userdtrm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441191673, "creation_date": 1441191673, "question_id": 32351370, "link": "https://stackoverflow.com/questions/32351370/retrieving-i-o-access-time-from-task-io-accounting-in-linux", "title": "Retrieving I/O access time from task_io_accounting in Linux", "body": "<p>I need to collect I/O access time information for a particular task (i.e., decoding a video frame) using Linux kernel information \"task_io_accounting\". <a href=\"http://lxr.free-electrons.com/source/include/linux/task_io_accounting.h\" rel=\"nofollow\">Here</a>, I found a header file that describes a structure corresponding to \"task_io_accounting\". However, I'm not sure how to use this to gather I/O access time information. </p>\n\n<p>Could someone please assist me with this and point me into the right direction?.</p>\n"}, {"tags": ["c", "ipc", "named-pipes"], "answers": [{"tags": [], "owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": false, "score": 0, "last_activity_date": 1441192099, "creation_date": 1441192099, "answer_id": 32351503, "question_id": 32351075, "link": "https://stackoverflow.com/questions/32351075/how-to-communicate-two-processes-using-pipes/32351503#32351503", "title": "How to communicate two processes using pipes", "body": "<p>You have to wait for incoming data - when <code>a == 0</code>, there is still no data in pipe. After <code>int a = ...</code> add this:</p>\n\n<pre><code>if ( a == 0 )\n{\n  i--; // repeat last iteration\n  continue;\n}\n</code></pre>\n\n<p>It is good idea to send number of lines first and then you will know how many text lines will arrive.</p>\n"}, {"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 1, "last_activity_date": 1441196903, "creation_date": 1441196903, "answer_id": 32353177, "question_id": 32351075, "link": "https://stackoverflow.com/questions/32351075/how-to-communicate-two-processes-using-pipes/32353177#32353177", "title": "How to communicate two processes using pipes", "body": "<p>The <code>read</code> call returned all the data that you have written to the fifo. Your strings are 20 bytes long (19 bytes text and a terminating \\0). Plus the \"hi2\" which is 4 bytes. And the second read returns size 124 (6*20+4).</p>\n\n<p>Fifos contain a stream of data, not separate messages. You don't get one successful read for each successful write. You can get fewer or more reads than writes and it's up to you to invent a protocol that allows you to separate messages and buffering in the reader to collect and reassemble messages if they come in spread over multiple reads. </p>\n\n<p>The reason your printf only prints the \"first\" message (there are no messages, just a stream of bytes) is because it's zero-terminated. So the other strings are in your buffer, but since you're printing the whole buffer as a string only the first string in it will be shown.</p>\n"}], "owner": {"reputation": 1, "user_id": 3852652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be1ccedc5f3ce1c5e05b1c37d2686dc0?s=128&d=identicon&r=PG&f=1", "display_name": "shiva rama krishna", "link": "https://stackoverflow.com/users/3852652/shiva-rama-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1441196903, "creation_date": 1441190771, "last_edit_date": 1441192244, "question_id": 32351075, "link": "https://stackoverflow.com/questions/32351075/how-to-communicate-two-processes-using-pipes", "title": "How to communicate two processes using pipes", "body": "<p>I am using named pipes to communicate between two processes.</p>\n\n<p>Writer.c</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    int fd;\n    char * myfifo = \"/tmp/myfifo\";\n\n    /* create the FIFO (named pipe) */\n    mkfifo(myfifo, 0666);\n\n    /* write \"Hi\" to the FIFO */\n    fd = open(myfifo, O_WRONLY);\n    write(fd, \"hi\", sizeof(\"hi\"));\n    write(fd, \"4:1.jpg,2.jpg;3.jpg\", sizeof(\"4:1.jpg,2.jpg;3.jpg\"));\n    write(fd, \"hi2\", sizeof(\"hi2\"));\n    write(fd, \"5:1.jpg,2.jpg;3.jpg\", sizeof(\"5:1.jpg,2.jpg;3.jpg\"));\n    write(fd, \"6:1.jpg,2.jpg;3.jpg\", sizeof(\"6:1.jpg,2.jpg;3.jpg\"));\n    write(fd, \"7:1.jpg,2.jpg;3.jpg\", sizeof(\"6:1.jpg,2.jpg;3.jpg\"));\n    write(fd, \"8:1.jpg,2.jpg;3.jpg\", sizeof(\"6:1.jpg,2.jpg;3.jpg\"));\n    write(fd, \"9:1.jpg,2.jpg;3.jpg\", sizeof(\"6:1.jpg,2.jpg;3.jpg\"));\n    sleep(5);\nreturn 0;\n\n}\n</code></pre>\n\n<p>Reader.c</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MAX_BUF 2048\n\nint main()\n{\n    int fd;\n    char * myfifo = \"/tmp/myfifo\";\n    char buf[MAX_BUF];\n    /* open, read, and display the message from the FIFO */\n    fd = open(myfifo, O_RDONLY);\n      int i;\n      for( i =0; i &lt; 6 ; i++)\n      {\n      int a = read(fd, buf, MAX_BUF);\n       printf(\"buf has : %s with size = %d \\n\", buf,a);\n       }\n\n    return 0;\n}\n</code></pre>\n\n<p>The output is like below:</p>\n\n<pre><code>buf has : hi with size = 3\nbuf has : 4:1.jpg,2.jpg;3.jpg with size = 124\nbuf has : 4:1.jpg,2.jpg;3.jpg with size = 0\nbuf has : 4:1.jpg,2.jpg;3.jpg with size = 0\nbuf has : 4:1.jpg,2.jpg;3.jpg with size = 0\nbuf has : 4:1.jpg,2.jpg;3.jpg with size = 0\n</code></pre>\n\n<p>I am wondering where the other strings have gone? Can some one please tell me what was wrong. I need the output to be like all the strings has to come one after the other.</p>\n"}, {"tags": ["c", "bitwise-operators"], "comments": [{"owner": {"reputation": 582, "user_id": 1294836, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0095d6765f160d34b04fec8f91e6d1d6?s=128&d=identicon&r=PG", "display_name": "suneet saini", "link": "https://stackoverflow.com/users/1294836/suneet-saini"}, "edited": false, "score": 0, "creation_date": 1441194422, "post_id": 32351026, "comment_id": 52577507, "body": "<code>&amp;&amp;</code> is a logical operator while <code>&amp;</code> is bitwise operator."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441382752, "post_id": 32351026, "comment_id": 52672820, "body": "You now have two answers. If any or all answered your question, please accept the one most fitting. You can also upvote any answer you like. This is the stackoverflow way to say &quot;thank you for your time&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1441191349, "post_id": 32351133, "comment_id": 52575497, "body": "You are using the incorrect format strings. Correct would be to use <code>inttypes.h</code>, here <code>PRIx64</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1441192627, "post_id": 32351133, "comment_id": 52576325, "body": "@Olaf Nah, just add <code>static_assert(sizeof(uint64_t)==sizeof(unsigned long long), &quot;bleh&quot;)</code> in some header file. No need to spew PRI PRI PRI all over the code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441193150, "post_id": 32351133, "comment_id": 52576691, "body": "@Lundin: Why would I make my code generate a compile-time error just because I am too lazy to write it portable? If I compile on a platform which does not assert, I&#39;ll have to change it anyway, having to maintain two versions (<code>#ifdef</code> comes to mind ...)."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441194207, "post_id": 32351133, "comment_id": 52577378, "body": "I&#39;m with @Lundin on this - the PRIxxx format specifiers are an ugly and overly verbose kludge and they tend to make code less readable."}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1441194855, "post_id": 32351133, "comment_id": 52577795, "body": "I&#39;m with @Olaf. Yes, they&#39;re ugly and boring to use; but there&#39;re some things that are even more."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1441194860, "post_id": 32351133, "comment_id": 52577799, "body": "@Olaf Because the format specifiers is a non-important trifle; what you really should be concerned about is the <i>type of each integer literal</i> in your program. It is absolutely essential that you can guarantee which size each integer literal has. A programmer who tries to write portable programs and therefore have the integer literals change size whimsically between different systems will no doubt introduce numerous type-related bugs. And all such bugs tend to be very subtle, caused by implicit promotions and similar."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1441194942, "post_id": 32351133, "comment_id": 52577866, "body": "So when you get a compiler error, then there&#39;s usually a compiler option you can go set to state the size of int, long and long long - the size of integer literals will follow. And <i>that</i> is how you ensure portability in a deterministic manner."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441195717, "post_id": 32351133, "comment_id": 52578398, "body": "@Lundin: I&#39;d appreciate if you can show me the options for gcc to set the size of <code>int</code>, etc. for ARM e.g. Until now, I was very sure, the AAPCS enforces specific sizes for them. As does POSIX (ILP32/I32LP64). For imposing a specific size: That depends. If you have specific requirements, e.g. a peripheral register, I agree. Otherwise a min. size is often sufficient (e.g. a loop-counter)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1441197641, "post_id": 32351133, "comment_id": 52579842, "body": "@Olaf I&#39;m not sure how to do that for GCC. It may be that the GCC port sets them at the point where the specific port is built, so probably not something that is easily tweaked (<a href=\"http://www.delorie.com/gnu/docs/gcc/gccint_112.html\" rel=\"nofollow noreferrer\">this link suggests that some constants need to be set by the port</a>). Other compilers that come with a GUI typically have some user-friendly option where you can easily change type sizes."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441201520, "post_id": 32351133, "comment_id": 52582777, "body": "@Lundin: The sizes (and representation) of the standard types are target-specific with minimum ranges guaranteed by the standard. The actual representation is normally defined by the Procedure Call Standard and ABI of the target platform (CPU and OS (if any). Which compiler does allow to set the sizes for these types by an option? This is quite uncommon, maybe except for some 8-bit embedded compilers which allow to have 8-bit <code>int</code> (IIRC, Microchip for the PICs did allow this). But this is non--standard (<code>int</code> has a min. range of <code>+&#47;-32767</code>)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1441203489, "post_id": 32351133, "comment_id": 52584211, "body": "@Olaf I&#39;ve seen some flavour of this on many compilers. Not to set the size below the standard limits mind you (though some might indeed allow that too), but rather set size of int to 16 or 32, size of enum to 8 or 16, set size of long to 32 or 64 etc. Similarly, set signedness for char and enum, floating point standard etc. I think at least Mplab, Codewarrior and maybe Keil(?) allow this."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441205854, "post_id": 32351133, "comment_id": 52586015, "body": "About <code>enum</code>: this is possible, as the standard leaves this to the compiler, <i>*iff</i> all constants can be represented in the given type (so this setting would only be for the minimum type). But the constants still have to be <code>int</code> (one major reason <code>enum</code> is of little use to define constants). Signed-ness of <code>char</code> is left to the implementation anyway, but AAPCS requires <code>unsigned</code> (reason is likely ARMv4 had no sign-extend byte-load instructions). And for float the standard does not require a specific format, but only certain precision (<code>float</code> 6, <code>double</code> 10 decimal digits, etc.)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441205876, "post_id": 32351133, "comment_id": 52586030, "body": "ARM AAPCS clearly defines the sizes for the standard integer types and <code>char</code> to be unsigned at least (too lazy to check for floating point). And many options (e.g. setting signed-ness of <code>char</code>) is just to get code working which relied on implementation defined behaviour. Actually this is an argument more to use <code>stdint</code>/<code>inttypes</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1441190929, "creation_date": 1441190929, "answer_id": 32351133, "question_id": 32351026, "link": "https://stackoverflow.com/questions/32351026/how-do-i-print-out-all-8-bytes-of-8-byte-variables-and-how-can-i-apply-the/32351133#32351133", "title": "How do I print out all 8 bytes of 8 byte variables and how can I apply the `&amp;&amp;` bit wise operator on them?", "body": "<p>You need to add a field width and zero padding flag to the <code>%llX</code> format specifier:</p>\n\n<pre><code>printf(\"a is %016llX b is %016llX c is %016llx\" ,a, b, c);\n</code></pre>\n\n<p>The <code>16</code> says the field should be 16 characters wide (16 hex digits for a 64 bit number), and the leading <code>0</code> says that field should be padded on the left with zeros.</p>\n\n<p>Also, <code>&amp;&amp;</code> is the logical AND operator.  The bitwise AND operator is <code>&amp;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1441193340, "post_id": 32351719, "comment_id": 52576814, "body": "@paulr: Thanks for the edit. Just to let you know I did not DV your answer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1441193700, "post_id": 32351719, "comment_id": 52577054, "body": "@PaulR: Well, you might be complaining, but this is read by quite some beginners. Don&#39;t you agree they should it learn the correct and most standard/portable way first? Once they learned, they should be able to know when to follow the rules and when you can &quot;stretch&quot; them a bit. This is much like driving a car: you first have to exactly follow the speed limit and later you know you can drive 10-20% faster sometimes."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1441194094, "post_id": 32351719, "comment_id": 52577306, "body": "Well very few code examples are perfect (e.g. you are missing <code>#include &lt;stdio.h&gt;</code> in your code above) - it&#39;s a matter of judgement as to what level of code quality is required to answer a specific question."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1441194588, "post_id": 32351719, "comment_id": 52577616, "body": "<code>ULL</code> will be <i>at least</i> 64 bits, so you could specify a 64-bit constant that way, with a <code>(uint64_t)</code> cast to be certain. But all these examples should be using <code>UINT64_C(val)</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1441194759, "post_id": 32351719, "comment_id": 52577738, "body": "@BrettHale: Thanks for the input. To be true, I always forget about this macro. However, that will convert to <code>uint_least64_t</code> actually - for good reasons, as my cast will truncate any other type. I&#39;ll add that info."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 1, "creation_date": 1441194839, "post_id": 32351719, "comment_id": 52577784, "body": "Remember how <code>&lt;stdint.h&gt;</code> was going to make life easy? Ha!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1441195259, "post_id": 32351719, "comment_id": 52578104, "body": "@BrettHale: As an embedded developer, I actually think it does. At least if people finally stop using their hand-crafted <code>u8</code>, etc. OTOH, I do not use <code>printf</code>, etc. in my projects very often. But I agree, I&#39;d prefer integrated type-specifiers, but that blow up <code>printf</code> even more. <code>&quot;%zu&quot;</code> for instance should better have followed the <code>inttypes.h</code> way. But C is not a synonym for consistency anyway."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441384254, "post_id": 32351719, "comment_id": 52673662, "body": "A <code>printf()</code> alternative to <code>%016&quot; PRIx64</code>: <code>printf(&quot;a is %016llx&quot;, a*1ull);</code>  Yet <code>PRIx64</code> is better even thought disjointed in the format."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441384755, "post_id": 32351719, "comment_id": 52673901, "body": "@chux: Looks not less ugly, but it would at least be correct."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 4, "last_activity_date": 1441382602, "last_edit_date": 1441382602, "creation_date": 1441192745, "answer_id": 32351719, "question_id": 32351026, "link": "https://stackoverflow.com/questions/32351026/how-do-i-print-out-all-8-bytes-of-8-byte-variables-and-how-can-i-apply-the/32351719#32351719", "title": "How do I print out all 8 bytes of 8 byte variables and how can I apply the `&amp;&amp;` bit wise operator on them?", "body": "<p>The <code>&amp;&amp;</code> operator is a <em>logical</em> and. It yields a boolean (true/false, in C represented by an <code>int</code> value of <code>1</code>/<code>0</code> guaranteed) result iff both operands are non-zero. It also evaluates strictly left operand first and the right only iff the result depends on it (i.e. if the left operand is non-zero; this works correspondingly for a chain of identical logical operators).</p>\n\n<p>You need the bit-wise <code>&amp;</code> (and) operator which evaluates all (integer) operands:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;  // format-strings for stdint.h types\n\nint main(void)\n{\n    uint64_t a = 0x2345678987654321U;\n    uint64_t b = 0x2345678987654321U;\n    uint64_t c = 0x11111111U;\n    b = b &amp; 0xFFFFFFFFFFFFFF00U;\n    printf(\"a is %016\" PRIx64 \" b is %016\" PRIx64 \" c is %016\" PRIx64, a, b, c);\n}\n</code></pre>\n\n<p>Note I added <code>U</code> suffix to the constants to ensure they are unsigned. You might add a width suffix, but that is not required and actually quite useless, because <code>LL</code>, making the constant <code>long long</code> would not guarantee 64 bits (it could well be >64 bits). If you want constants with a specific type, cast them, e.g.:</p>\n\n<pre><code>#define U64_CONST ((uint64_t)0x123U)\n</code></pre>\n\n<p>An alternative way to get <strong>at least</strong> a 64 bit unsigned type:</p>\n\n<pre><code>#define U64_CONST UINT64_C(0x123U)\n</code></pre>\n\n<p>This macro will generate a <code>uint_least64_t</code> (see <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.20\" rel=\"nofollow\">`stdint.h</a> for more). As always, enable warnings to let your compiler help you finding constants which do not fit into the given type.</p>\n\n<p>For similar reasons, the correct <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow\"><code>printf</code></a> (see the link why I added <code>016</code>) and <code>scanf</code> format-specifiers for <code>stdint.h</code> types are in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.8\" rel=\"nofollow\"><code>inttypes.h</code></a>. Each is a macro with a string-literal containing the correct format-specifier for your platform. Use string-literal concatenation (two adjacent string-literals are combined to a single string-literal - note there is no operator in-between) to assemble the format-string.</p>\n\n<p><strong>Note:</strong> The above is - of course - also valid for types of other bit-sizes (and possible more important).</p>\n"}], "owner": {"reputation": 39, "user_id": 5292146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c1cb0d1ee7add58fae98467d8ec372?s=128&d=identicon&r=PG&f=1", "display_name": "vikas mandal", "link": "https://stackoverflow.com/users/5292146/vikas-mandal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1476, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1441382602, "creation_date": 1441190592, "last_edit_date": 1441194425, "question_id": 32351026, "link": "https://stackoverflow.com/questions/32351026/how-do-i-print-out-all-8-bytes-of-8-byte-variables-and-how-can-i-apply-the", "title": "How do I print out all 8 bytes of 8 byte variables and how can I apply the `&amp;&amp;` bit wise operator on them?", "body": "<p>How do I print out all 8 bytes of 8 byte variables and how can I apply the <code>&amp;&amp;</code> bit wise operator on them ?</p>\n\n<pre><code>int main(void)\n{\n     uint64_t a = 0x2345678987654321;\n     uint64_t b = 0x2345678987654321;\n     uint64_t c = 0x11111111;\n     b= 0x2345678987654321 &amp;&amp; 0xFFFFFFFFFFFFFF00;\n     printf(\"a is %llX b is %llX c is %llx\" ,a, b, c);\n     return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "utf-8", "libxml2", "biometrics"], "comments": [{"owner": {"reputation": 1233, "user_id": 2560990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b42b19b1b40ef800b3f0ded4adde9de?s=128&d=identicon&r=PG", "display_name": "robin.koch", "link": "https://stackoverflow.com/users/2560990/robin-koch"}, "edited": false, "score": 0, "creation_date": 1441190489, "post_id": 32350837, "comment_id": 52574952, "body": "&quot;raw buffer of crypted data&quot; means unencoded binary data? If so encode it with Base64"}, {"owner": {"reputation": 17, "user_id": 5219820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b4a8d64d1e891d2805f3efa91fbd1181?s=128&d=identicon&r=PG&f=1", "display_name": "Lion.24", "link": "https://stackoverflow.com/users/5219820/lion-24"}, "reply_to_user": {"reputation": 1233, "user_id": 2560990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b42b19b1b40ef800b3f0ded4adde9de?s=128&d=identicon&r=PG", "display_name": "robin.koch", "link": "https://stackoverflow.com/users/2560990/robin-koch"}, "edited": false, "score": 0, "creation_date": 1441190744, "post_id": 32350837, "comment_id": 52575113, "body": "Yes that&#39;s seems to be raw binary data...."}, {"owner": {"reputation": 17, "user_id": 5219820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b4a8d64d1e891d2805f3efa91fbd1181?s=128&d=identicon&r=PG&f=1", "display_name": "Lion.24", "link": "https://stackoverflow.com/users/5219820/lion-24"}, "reply_to_user": {"reputation": 1233, "user_id": 2560990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b42b19b1b40ef800b3f0ded4adde9de?s=128&d=identicon&r=PG", "display_name": "robin.koch", "link": "https://stackoverflow.com/users/2560990/robin-koch"}, "edited": false, "score": 0, "creation_date": 1441197299, "post_id": 32350837, "comment_id": 52579575, "body": "@robin.koch I&#39;ve try what you suggested. Well, I&#39;m speechless, You are my hero !!!! Thank you very much. I think without your help I will still be searching the answer."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5219820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b4a8d64d1e891d2805f3efa91fbd1181?s=128&d=identicon&r=PG&f=1", "display_name": "Lion.24", "link": "https://stackoverflow.com/users/5219820/lion-24"}, "edited": false, "score": 0, "creation_date": 1441204457, "post_id": 32353513, "comment_id": 52584903, "body": "Base64 is enough for what i&#39;m trying to now.  Thank you once again!"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1441355304, "post_id": 32353513, "comment_id": 52655588, "body": "more on, <code>0xff</code> is not a valid utf-8 byte.  This is the reason the library complaints about."}], "tags": [], "owner": {"reputation": 1233, "user_id": 2560990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b42b19b1b40ef800b3f0ded4adde9de?s=128&d=identicon&r=PG", "display_name": "robin.koch", "link": "https://stackoverflow.com/users/2560990/robin-koch"}, "is_accepted": true, "score": 1, "last_activity_date": 1441197811, "creation_date": 1441197811, "answer_id": 32353513, "question_id": 32350837, "link": "https://stackoverflow.com/questions/32350837/c-libxml-encoding-issue/32353513#32353513", "title": "C libxml encoding issue.", "body": "<p>Encode all your binary data with base64. XML parsers usually can/will not handle binary data.<br><br>\nI don't know how much binary data you process, so if base64 encoding/decoding becomes inefficient take a look at <a href=\"http://www.xml.com/pub/a/98/07/binary/binary.html\" rel=\"nofollow\">http://www.xml.com/pub/a/98/07/binary/binary.html</a></p>\n"}], "owner": {"reputation": 17, "user_id": 5219820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b4a8d64d1e891d2805f3efa91fbd1181?s=128&d=identicon&r=PG&f=1", "display_name": "Lion.24", "link": "https://stackoverflow.com/users/5219820/lion-24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 32353513, "answer_count": 1, "score": 0, "last_activity_date": 1441197811, "creation_date": 1441190061, "question_id": 32350837, "link": "https://stackoverflow.com/questions/32350837/c-libxml-encoding-issue", "title": "C libxml encoding issue.", "body": "<p>I'm facing an issue since two days with libxml2 and it annoys me a lot.</p>\n\n<p>Basically, I send a xml buffer throught de network with socket. When I receive it on the server and try to parse it, it says :</p>\n\n<blockquote>\n  <p>parser error : Input is not proper UTF-8, indicate encoding !\n  Bytes: 0xFF 0xFF 0xFF 0xFF</p>\n</blockquote>\n\n<p>The one tag of the xml tree (biometricData) I'm trying to send contains weird bizarre caracters cuz this is a raw buffer of crypted data.</p>\n\n<pre><code>&lt;biometricData&gt;\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n\n&lt;/biometricHeader&gt;&lt;biometricData&gt;\n                               ^\n</code></pre>\n\n<p>Client side : </p>\n\n<pre><code>xmlDocDumpMemoryEnc(doc, &amp;(*out), &amp;buffersize, \"UTF-8\");\n</code></pre>\n\n<p>Server side: </p>\n\n<pre><code>int verify(unsigned char *data, int len) //The routine to check the data and authenticate user.\n\n xmlParserCtxtPtr ctx_ptr = xmlNewParserCtxt();\n doc = xmlCtxtReadMemory(ctx_ptr, (const char*)data, len, \"data.xml\", \"UTF-8\", 0);\n</code></pre>\n\n<p>The server throw this error : </p>\n\n<pre><code>Entity: line 2: parser error : Input is not proper UTF-8, indicate encoding !\nBytes: 0xFF 0xFF 0xFF 0xFF\nd&gt;2.23.42.9.10.4.2&lt;/oid&gt;&lt;/formatOwner&gt;&lt;/format&gt;&lt;/biometricHeader&gt;&lt;biometricData&gt;\n                                                                               ^\n</code></pre>\n\n<p>I try to change to change the encoding to ISO-8859-1 for the server side and it works! But, when I try to do nodeGetContent(biometricData) the data get not in their original encoding, so the buffer is completely useless.</p>\n\n<p>Thank for you taking time. \nI've search towards the xmlCharEncodingHandler but I do not succeed... </p>\n"}, {"tags": ["c", "postgresql", "function", "libpq"], "answers": [{"tags": [], "owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "is_accepted": false, "score": 0, "last_activity_date": 1441191138, "creation_date": 1441191138, "answer_id": 32351190, "question_id": 32350187, "link": "https://stackoverflow.com/questions/32350187/how-to-call-a-pg-function-with-libpq-and-get-the-param-value/32351190#32351190", "title": "how to call a pg function with libpq and get the param value", "body": "<p>It's just like any other query.</p>\n\n<pre><code>SELECT * FROM query_callouts('cursorname', 4, 'msg')\n</code></pre>\n\n<p>I suspect some if not all of your parameters should be <code>OUT</code> parameters not <code>INOUT</code> parameters, though. You don't ever use the input value of <code>errtext</code> at least.</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 4992628, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-witbjBlgNUU/AAAAAAAAAAI/AAAAAAAAAA0/5BnzF0zyZb8/photo.jpg?sz=128", "display_name": "shang hai old Lee", "link": "https://stackoverflow.com/users/4992628/shang-hai-old-lee"}, "edited": false, "score": 0, "creation_date": 1441195670, "post_id": 32351346, "comment_id": 52578365, "body": "this is can work in my psql,but how to work in my c/c++ code with libpq?"}, {"owner": {"reputation": 85043, "user_id": 1995738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fXrVi.png?s=128&g=1", "display_name": "klin", "link": "https://stackoverflow.com/users/1995738/klin"}, "reply_to_user": {"reputation": 65, "user_id": 4992628, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-witbjBlgNUU/AAAAAAAAAAI/AAAAAAAAAA0/5BnzF0zyZb8/photo.jpg?sz=128", "display_name": "shang hai old Lee", "link": "https://stackoverflow.com/users/4992628/shang-hai-old-lee"}, "edited": false, "score": 0, "creation_date": 1441196564, "post_id": 32351346, "comment_id": 52578981, "body": "I do not know what you&#39;re asking. Your question should be more specific.  <a href=\"http://www.postgresql.org/docs/9.4/static/libpq-example.html\" rel=\"nofollow noreferrer\">Here</a> you can find complete example programs, if you don&#39;t know how to use libpq."}, {"owner": {"reputation": 65, "user_id": 4992628, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-witbjBlgNUU/AAAAAAAAAAI/AAAAAAAAAA0/5BnzF0zyZb8/photo.jpg?sz=128", "display_name": "shang hai old Lee", "link": "https://stackoverflow.com/users/4992628/shang-hai-old-lee"}, "edited": false, "score": 0, "creation_date": 1441197240, "post_id": 32351346, "comment_id": 52579530, "body": "oh, thank you, I get it code by your link,it is I need. I not use libpq to"}], "tags": [], "owner": {"reputation": 85043, "user_id": 1995738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fXrVi.png?s=128&g=1", "display_name": "klin", "link": "https://stackoverflow.com/users/1995738/klin"}, "is_accepted": true, "score": 0, "last_activity_date": 1441192053, "last_edit_date": 1441192053, "creation_date": 1441191603, "answer_id": 32351346, "question_id": 32350187, "link": "https://stackoverflow.com/questions/32350187/how-to-call-a-pg-function-with-libpq-and-get-the-param-value/32351346#32351346", "title": "how to call a pg function with libpq and get the param value", "body": "<p>You can call the function just like you are executing any query:</p>\n\n<pre><code>select * from query_callouts('mycur', 0, '');\n\n io_cursor_ref | opstatus | errtext\n---------------+----------+---------\n mycur         |        0 |\n(1 row) \n</code></pre>\n\n<p><code>opstatus</code> and <code>errtext</code> would be set to the appropriate values if an exception occurs.\n<code>io_cursor_ref</code> contains the name you have passed to the function.</p>\n\n<blockquote>\n  <p>Internally, a refcursor value is simply the string name of a so-called\n  portal containing the active query for the cursor. This name can be\n  passed around, assigned to other refcursor variables, and so on,\n  without disturbing the portal.</p>\n</blockquote>\n\n<p>Note, you can use a refcursor only within a transaction.</p>\n\n<blockquote>\n  <p>All portals are implicitly closed at transaction end. Therefore a\n  refcursor value is usable to reference an open cursor only until the\n  end of the transaction.</p>\n</blockquote>\n\n<p>You can use explicit transaction:</p>\n\n<pre><code>begin;\nselect * from query_callouts('mycur', 0, '');\nfetch all in mycur;\n-- save or show the query result\n-- and finally\ncommit;\n</code></pre>\n\n<p>or use <code>mycur</code> inside a function.</p>\n\n<p>The quotes are from <a href=\"http://www.postgresql.org/docs/9.4/static/plpgsql-cursors.html\" rel=\"nofollow\">the documentation</a>.</p>\n"}], "owner": {"reputation": 65, "user_id": 4992628, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-witbjBlgNUU/AAAAAAAAAAI/AAAAAAAAAA0/5BnzF0zyZb8/photo.jpg?sz=128", "display_name": "shang hai old Lee", "link": "https://stackoverflow.com/users/4992628/shang-hai-old-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 32351346, "answer_count": 2, "score": 1, "last_activity_date": 1441192053, "creation_date": 1441188130, "question_id": 32350187, "link": "https://stackoverflow.com/questions/32350187/how-to-call-a-pg-function-with-libpq-and-get-the-param-value", "title": "how to call a pg function with libpq and get the param value", "body": "<p>ALL\n        I have a postgresql function,so this:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION query_callouts(\n\n    INOUT io_cursor_ref refcursor,\n    INOUT opstatus integer,\n    INOUT errtext character varying)\n  RETURNS record AS\n$BODY$\nDECLARE\n\nBEGIN\n\n  OPEN $1 FOR\n    SELECT tablename FROM pg_tables limit 10;\n    --SELECT * from call_out_numbers;\n\n  RETURN;\n  Exception\n    When Others Then\n        GET STACKED DIAGNOSTICS opstatus = RETURNED_SQLSTATE,\n                               errText = MESSAGE_TEXT;\nEND;\n\n$BODY$\n  LANGUAGE plpgsql VOLATILE\n  COST 100;\nALTER FUNCTION query_callouts(refcursor, integer, character varying)\n  OWNER TO postgres;\n</code></pre>\n\n<p>I want to known ,how to use libpq in my c codes to visit the function - query_callouts and get the param   io_cursor_ref  and opstatus and errtext?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 4, "creation_date": 1441186852, "post_id": 32349675, "comment_id": 52572641, "body": "Take a look <a href=\"http://man7.org/linux/man-pages/man3/strftime.3.html\" rel=\"nofollow noreferrer\">HERE</a> and do not ask so simple question before at least put the name of function on google..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1441187070, "post_id": 32349675, "comment_id": 52572781, "body": "Well <a href=\"http://en.cppreference.com/w/c/chrono/strftime\" rel=\"nofollow noreferrer\"><code>strftime</code></a> uses the time from a <a href=\"http://en.cppreference.com/w/c/chrono/tm\" rel=\"nofollow noreferrer\"><code>struct tm</code></a> pointer. If you follow the reference links I&#39;m sure you should find out a way to get from your time in seconds to the formatted string."}, {"owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1441188131, "post_id": 32349675, "comment_id": 52573524, "body": "@JoachimPileborg  I have edited the post and wrote some code, is that correct ?"}, {"owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441188543, "post_id": 32349675, "comment_id": 52573813, "body": "@LPs Is my above code correct?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441194084, "post_id": 32349675, "comment_id": 52577298, "body": "Do you have time in seconds in <code>long tv_sec</code> from what source?  Time in seconds since when?  If you are using GNU functions, <code>tv_sec</code> is type <code>time_t</code>, not necessarily <code>long</code> and typically represents seconds since Jan 1, 1970 - universal time.   OTOH if you ave some other source of &quot;seconds&quot;, the solution is different.  Post how code &quot;have time in seconds long <code>tv_sec</code>&quot; and if you want the date to be local time or universal time ((UTC](<a href=\"https://en.wikipedia.org/wiki/Coordinated_Universal_Time\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Coordinated_Universal_Time</a>))"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "edited": false, "score": 0, "creation_date": 1441189535, "post_id": 32350585, "comment_id": 52574409, "body": "I only have the time in seconds not in timet_t"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "edited": false, "score": 0, "creation_date": 1441189974, "post_id": 32350585, "comment_id": 52574667, "body": "Time_t are seconds from epoch"}, {"owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "edited": false, "score": 0, "creation_date": 1441191905, "post_id": 32350585, "comment_id": 52575866, "body": "my question is If I have the time in seconds, just in a single variable can I convert it to strftime ?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "edited": false, "score": 0, "creation_date": 1441194998, "post_id": 32350585, "comment_id": 52577912, "body": "@AndreAhmed Your seconds start from some point in the past. Linux time.h calculate date and time since 1/1/1970. Then you must add seconds from 1/1/1970 to your start date and time and then use the code posted."}, {"owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "edited": false, "score": 0, "creation_date": 1441196598, "post_id": 32350585, "comment_id": 52579014, "body": "strftime(buffer,80,&quot;%Y-%m-%d %X&quot;, gmtime_r(&amp;value-&gt;timestamp,&amp;timeStruct)); is that correct? where value-&gt;timeStamp is the seconds"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441208758, "post_id": 32350585, "comment_id": 52588142, "body": "&quot;Time_t are seconds from epoch&quot; is not supported by the C spec.  &quot;The range and precision of times representable in clock_t and time_t are implementation-defined.&quot;  C11dr &#167;7.27.1 4.  Even the epoch of Jan 1, 1970 is not specified.  So this answer may work for OP yet fail on another machine."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441213439, "post_id": 32350585, "comment_id": 52590968, "body": "@chux Are you kidding me? -1 for such a picky comment? I think stakoverflow aim to answer to OP questions, not to give a full cross platforms unswer. BTW I wrote &quot;epoch in Linux time.h&quot; that is crystal..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441215015, "post_id": 32350585, "comment_id": 52591964, "body": "Aside from unqualified assertions like &quot;Time_t are seconds from epoch&quot; 1) Code should rather than magic numbers like <code>946684800</code> set the fields of a <code>struct tm</code> to the epoch and add the seconds to its fields, then call <code>mktime()</code> 2) address the issue of timezone as *nix <code>time_t</code> represents universal time yet code is using <code>mktime()</code> which is local making <code>946684800</code> wrong, unless near the UK.  3)  make clear OP&#39;s likely incorrect type of <code>long tv_sec</code> (expect  <code>time_t tv_sec</code>) 4)  avoid skipping glossing over return value of <code>gmtime()</code> for new users."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441215031, "post_id": 32350585, "comment_id": 52591972, "body": "Concerning DV: rather than rail on those that DV <i>and</i> comment, remaining courteous in comments encourages explanations and resolution."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 0, "last_activity_date": 1441207189, "last_edit_date": 1441207189, "creation_date": 1441189334, "answer_id": 32350585, "question_id": 32349675, "link": "https://stackoverflow.com/questions/32349675/getting-timestamp-using-strftime/32350585#32350585", "title": "Getting timestamp using strftime", "body": "<p>Ensure that <code>timestampInSecs</code> is <code>time_t</code> type and try this:</p>\n\n<pre><code>    char buffer[80];\n\n    strftime(buffer,80,\"%Y-%m-%d %X\", gmtime(&amp;timestampInSecs));\n\n    printf(\"Formatted date &amp; time : |%s|\\n\", buffer );\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Example: if you have <code>timestampInSecs</code> that represent seconds from <code>1/1/2000</code> you must compensate the variable with all seconds from <code>1/1/1970</code> (epoch in Linux time.h)\nFrom 1/1/1970 to 1/1/2000 we have:</p>\n\n<ul>\n<li><code>10957</code> days</li>\n<li><code>262968</code> hours</li>\n<li><code>946684800</code> seconds</li>\n</ul>\n\n<p>At the end you have to sum <code>946684800</code> to your variable to be able to use <code>strftime</code> as shown in my code.</p>\n\n<p>Then what you must do is to calculate seconds between <code>1/1/1970</code> and your start date and time (the date and time of <code>timestampInSecs=0</code>)</p>\n"}], "owner": {"reputation": 43, "user_id": 5285623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b32e7927505a49759cc7533d51d089cb?s=128&d=identicon&r=PG&f=1", "display_name": "AndreAhmed", "link": "https://stackoverflow.com/users/5285623/andreahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 32350585, "answer_count": 1, "score": 0, "last_activity_date": 1441207189, "creation_date": 1441186700, "last_edit_date": 1441188563, "question_id": 32349675, "link": "https://stackoverflow.com/questions/32349675/getting-timestamp-using-strftime", "title": "Getting timestamp using strftime", "body": "<p>I have time in seconds <code>long tv_sec</code>, and I want to get the correct date, and time, using the format  <code>%Y-%m-%d %X</code>, using the function <code>stftime</code>. \nSo I have the time stamps in seconds and I want to convert it using <code>stftime</code>.</p>\n\n<p>This is my trial</p>\n\n<pre><code>struct tm dateStruct;\n  memset(dateStruct, 0, sizeof(struct tm));\n\n  gmtime(&amp;timestampInSecs,dateStruct);\n\n  char buffer[80];\n\n  strftime(buffer,80,\"%Y-%m-%d %X\", dateStruct);\n  printf(\"Formatted date &amp; time : |%s|\\n\", buffer );\n</code></pre>\n"}, {"tags": ["c++", "c", "xilinx", "microblaze"], "comments": [{"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 1, "creation_date": 1441186291, "post_id": 32349445, "comment_id": 52572280, "body": "<a href=\"https://forums.xilinx.com/t5/Embedded-Development-Tools/ASM-and-microblaze/td-p/10846\" rel=\"nofollow noreferrer\">forums.xilinx.com/t5/Embedded-Development-Tools/&hellip;</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441186949, "post_id": 32349445, "comment_id": 52572710, "body": "Using two <code>asm</code> instructions for apparently belonging instructions is very likely to break your program, independent on the platform; at least without being <code>volatile</code> (gcc syntax; your compiler might vary)."}, {"owner": {"reputation": 1, "user_id": 5291822, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C3vM6yPTt0g/AAAAAAAAAAI/AAAAAAAAACo/6Gib0yutyp4/photo.jpg?sz=128", "display_name": "Hisham Gadollo", "link": "https://stackoverflow.com/users/5291822/hisham-gadollo"}, "edited": false, "score": 0, "creation_date": 1441189697, "post_id": 32349445, "comment_id": 52574505, "body": "Okay, how I can solve such problem ?"}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 1, "creation_date": 1441190971, "post_id": 32349445, "comment_id": 52575254, "body": "I think he meant to either use <code>asm volatile(...)</code> for each one or <code>asm(&quot;imm    0\\n\\tbrlid  r15, 372&quot;)</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1441220200, "post_id": 32349445, "comment_id": 52594843, "body": "does the CPU your coding for have an &#39;imm&#39; instruction?"}, {"owner": {"reputation": 1, "user_id": 5291822, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C3vM6yPTt0g/AAAAAAAAAAI/AAAAAAAAACo/6Gib0yutyp4/photo.jpg?sz=128", "display_name": "Hisham Gadollo", "link": "https://stackoverflow.com/users/5291822/hisham-gadollo"}, "edited": false, "score": 0, "creation_date": 1441612664, "post_id": 32349445, "comment_id": 52732182, "body": "yes it has such instruction"}], "owner": {"reputation": 1, "user_id": 5291822, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C3vM6yPTt0g/AAAAAAAAAAI/AAAAAAAAACo/6Gib0yutyp4/photo.jpg?sz=128", "display_name": "Hisham Gadollo", "link": "https://stackoverflow.com/users/5291822/hisham-gadollo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441186051, "creation_date": 1441186051, "question_id": 32349445, "link": "https://stackoverflow.com/questions/32349445/i-want-to-add-the-imm-instruction-in-the-main-file-but-the-compiler-refuses", "title": "I want to add the imm instruction in the main file but the compiler refuses", "body": "<p>I want to execute the following code :</p>\n\n<pre><code>int main()\n{\n    init_platform();\n\n    print(\"Hello World\\n\\r\");\n\nasm(\"imm    0\");\nasm(\"brlid  r15, 372\");\n\n    cleanup_platform();\n\n    return 0;\n}\n</code></pre>\n\n<p>but the compiler shows me the following message: \nFatal error: An IMM instruction should not be present in the .s file</p>\n"}, {"tags": ["c", "regex", "string", "scanf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1441185753, "post_id": 32349263, "comment_id": 52571898, "body": "The <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code> family of functions</a> does <i>not</i> use regular expressions."}, {"owner": {"reputation": 1, "user_id": 5181269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12acab5d04161b9a1ad599fc1a048836?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar", "link": "https://stackoverflow.com/users/5181269/ammar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1441185954, "post_id": 32349263, "comment_id": 52572041, "body": "Sorry, my bad, this isn&#39;t regex. It&#39;s just utilizing the %[chars] function of scanf, where everything matching [chars] is read. The question still stands as to how I can achieve what I&#39;m trying to do."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1441186004, "post_id": 32349263, "comment_id": 52572080, "body": "As for how to read your CSV file, it&#39;s not as simple as one would think because CSV file formats usually contains many corner cases that makes them harder to parse than one would think. Try to find an existing library to read and parse your file."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441186113, "post_id": 32349263, "comment_id": 52572156, "body": "<code>fscanf</code> is totally unsuited for reading CSV. You should read line by line using <code>fgets</code> and then parse the string yourself. But as pointed out in another comment, try to find some code out there."}, {"owner": {"reputation": 1, "user_id": 5181269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12acab5d04161b9a1ad599fc1a048836?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar", "link": "https://stackoverflow.com/users/5181269/ammar"}, "edited": false, "score": 0, "creation_date": 1441186192, "post_id": 32349263, "comment_id": 52572215, "body": "Well, I am reading the line using fgets, and then parsing it using sscanf. I&#39;m not using fscanf"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441186240, "post_id": 32349263, "comment_id": 52572245, "body": "@Ammar Sorry, I meant <code>sscanf</code> which is very similar to <code>fscanf</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441186307, "post_id": 32349263, "comment_id": 52572289, "body": "@Ammar <a href=\"http://stackoverflow.com/questions/12911299/read-csv-file-in-c\">this SO article</a> may help."}, {"owner": {"reputation": 1, "user_id": 5181269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12acab5d04161b9a1ad599fc1a048836?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar", "link": "https://stackoverflow.com/users/5181269/ammar"}, "edited": false, "score": 0, "creation_date": 1441187135, "post_id": 32349263, "comment_id": 52572816, "body": "That will definitely help. Thanks"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441192975, "post_id": 32349263, "comment_id": 52576573, "body": "@Michael-Walz, the solution you reference does not hande quoted fields, which can contain the separator character."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1441193150, "post_id": 32349263, "comment_id": 52576690, "body": "@PaulOgilvie yes, but it may help to get started."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1491317863, "last_edit_date": 1491317863, "creation_date": 1441190885, "answer_id": 32351114, "question_id": 32349263, "link": "https://stackoverflow.com/questions/32349263/c-regex-how-to-match-any-string-ending-with-or-any-empty-string/32351114#32351114", "title": "C regex how to match any string ending with &quot; or any empty string?", "body": "<p>The following is a basic CSV parser:</p>\n\n<pre><code>void readCSVline(char *line);\nchar *readCSVfield(char *line, char *buf);\nvoid readCSVdemo(void)\n{\n    char line[]= \"0,,10004,10004,\\\"Albany Hwy After Galliers Av\\\",\\\"\\\",-32.13649428,116.0176090070,3\";\n    readCSVline(line);\n\n}\n/* readCSVline is where you put your \"intelligence* about fields to read\n * and what to do with them\n */\nvoid readCSVline(char *line)\n{\n    char field1[80], *lineptr=line;\n    int nfields=0;\n\n    while (*lineptr) {\n        lineptr= readCSVfield(lineptr, field1);\n        printf(\"%s\\n\", field1);\n        nfields++;\n    }\n    printf(\"%d fields read.\\n\", nfields);\n}\n/* readCSVfield reads a field from a CSV line until the next comma or end-of-line.\n * It returns where the reading stopped.\n */\nchar *readCSVfield(char *line, char *buf)\n{\n    int instr= FALSE;   // track whether we are in a string\n    char *cptr= line;\n\n    while (*cptr)\n    {\n        if (instr) {\n            if (*cptr=='\"') {\n                char cc= *++cptr;\n                if (cc=='\"')        // escaped double quote\n                    *buf++ = '\"';\n                else {\n                    *buf='\\0';\n                    cptr--;\n                    instr= FALSE;\n                }\n            }\n            else *buf++ = *cptr;\n        }\n        else switch (*cptr) {\n        case '\"': instr= TRUE; break;\n        case ',': cptr++; *buf= '\\0'; return(cptr);\n        case ' ': case '\\t': case '\\n': case '\\r': break;\n        default: *buf++ = *cptr;\n        }\n        cptr++;\n    }\n    *buf= '\\0';\n    return(cptr);\n}\n</code></pre>\n\n<p><strong>Note: processing linefeeds in a quoted string</strong></p>\n\n<p>Often the parser is called with a line that the caller has read. To be able to process carriage return/linefeeds that are in a quoted string, the parser must process seeing a <code>\\n</code> by getting the next line. The signature for <code>readCSVfield</code> should then include the line buffer and its size.</p>\n"}], "owner": {"reputation": 1, "user_id": 5181269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12acab5d04161b9a1ad599fc1a048836?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar", "link": "https://stackoverflow.com/users/5181269/ammar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1491317863, "creation_date": 1441185617, "last_edit_date": 1441185975, "question_id": 32349263, "link": "https://stackoverflow.com/questions/32349263/c-regex-how-to-match-any-string-ending-with-or-any-empty-string", "title": "C regex how to match any string ending with &quot; or any empty string?", "body": "<p>I'm trying to produce code to read input from a comma separated text file line by line. I'm only interested in 3 of the fields, so I'm skipping over the rest. Problem is that 2 of the fields are string contained in quotation marks, and one of them is actually optional. </p>\n\n<p>For example, two successive lines might look like:</p>\n\n<pre><code>0,,10004,10004,\"Albany Hwy After Galliers Av\",\"\",-32.13649428,116.0176090070,3\n0,,10005,10005,\"Albany Hwy Armadale Kelmscott Hospital\",\"Armadale Kelmscott Hospital\",-32.13481555555560,116.017707222222,3\n</code></pre>\n\n<p>Since I'm not interested in the strings (I'm only interested in a few of the numbers), I'm just skipping over them using the * operator in scanf. For the first string, it's easy, since that's a mandatory field, so I can just skip the first double quote match to a regex of everything up to the second double quote, like so:</p>\n\n<pre><code>\\\"%*[^\\\"]\n</code></pre>\n\n<p>What I'm having trouble with is the second field, right after the first. The problem is that this field is optional; thus it may have text, it may not. Whenever it doesn't, the regex I listed above doesn't work properly, and the whole scanf operation fails for that line. Despite my best efforts, I cannot produce a regex that successfully matches everything up to the second double quotation mark, as well as matching empty strings. Does anyone know how I could modify my regex to perform such a function? </p>\n\n<p>p.s. here is an example of what my scanf operation looks like:</p>\n\n<pre><code>    res = sscanf(buf, \"%*d,,%ld,%*ld,\\\"%*[^\\\"]\\\",\\\"%*[]\\\",%lf,%lf,%*d\", &amp;cursid, &amp;curslat, &amp;curslong);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8084, "user_id": 512728, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GZ3bk.jpg?s=128&g=1", "display_name": "Jan Doggen", "link": "https://stackoverflow.com/users/512728/jan-doggen"}, "edited": false, "score": 4, "creation_date": 1441185029, "post_id": 32348883, "comment_id": 52571397, "body": "Please <a href=\"https://stackoverflow.com/posts/32348883/edit\">edit</a> your question and include 1) a short sample file, 2) expected result and 3) actual result."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1441185289, "post_id": 32348883, "comment_id": 52571566, "body": "Also please indent your code properly and please make it a habit to give your variables meaningful names, rather than one-letter ones."}, {"owner": {"reputation": 1301, "user_id": 3339818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVVg1.jpg?s=128&g=1", "display_name": "surajs1n", "link": "https://stackoverflow.com/users/3339818/surajs1n"}, "edited": false, "score": 1, "creation_date": 1441185435, "post_id": 32348883, "comment_id": 52571670, "body": "Where did you define <code>BUFSIZ</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1441186265, "creation_date": 1441186265, "answer_id": 32349523, "question_id": 32348883, "link": "https://stackoverflow.com/questions/32348883/write-a-program-that-reads-an-input-file-and-identifies-all-duplicated-words/32349523#32349523", "title": "Write a program that reads an input file and identifies all duplicated words", "body": "<p>You need different indexes for <code>dup</code> and <code>unique</code> buffers</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main()\n{\n    FILE* inp;\n    char word[BUFSIZ],input[BUFSIZ][BUFSIZ],dup[BUFSIZ][BUFSIZ],unique[BUFSIZ][BUFSIZ];\n    int c=0,k=0,NumWord=0,n=0,found=0,m=1,g=0,j=0,h=0,b=1,d=1,a=0,size,detect=1,p=0;\n    char arr[BUFSIZ][BUFSIZ];\n\n    int dup_idx =0;\n    int unique_idx =0;\n\n    inp=fopen(\"u.txt\",\"r\")  ;\n\n    if(inp==NULL)\n    {\n        perror(\"Error in opening a file\") ;return ;\n    }\n\n    while(fscanf(inp,\"%s\",word)!=EOF)\n    {\n        strcpy(input[c++],word)  ;\n        ++NumWord;\n\n    }\n\n    size = NumWord - 1  ;\n\n    for( a=0 ; a &lt; size ;a++)\n    {\n        //detect=1;\n        for(b = 0; b &lt; NumWord ; b++)\n        {\n                if(strcmp(input[a],input[b])==0 &amp;&amp; detect==1)\n                {\n                    strcpy(dup[dup_idx++],input[a]) ;\n                    ++detect;\n                    ++found;\n                }\n        }\n\n        b = ++d;\n        if(!found)\n        {\n            strcpy(unique[unique_idx++],input[a]) ;\n        }\n\n        detect=1;\n    }\n\n    printf(\"Dup: \");\n    for( g = 0; g &lt; dup_idx ; g++){\n        printf(\"%s \",dup[g]);\n    }\n\n    printf(\"\\nUnique: \");\n    for( g = 0; g &lt; unique_idx ; g++){\n        printf(\"%s \",dup[g]);\n    }\n\n    printf(\"\\n\");\n\n    fclose(inp);\n\n  return (EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1441186278, "creation_date": 1441186278, "answer_id": 32349534, "question_id": 32348883, "link": "https://stackoverflow.com/questions/32348883/write-a-program-that-reads-an-input-file-and-identifies-all-duplicated-words/32349534#32349534", "title": "Write a program that reads an input file and identifies all duplicated words", "body": "<p>First, you need to initialize your string buffers <code>dup</code> and <code>unique</code>. This is probably not the cause of your problems but if you don't, your program has undefined behaviour when you print <code>dup</code>.</p>\n\n<pre><code>memset(dup, 0, sizeof dup);\nmemset(dup, 0, sizeof unique);\n</code></pre>\n\n<p>Second, I don't understand the way you assign <code>b</code>. A simplistic start would be to remove the line <code>b = ++d;</code> and assign <code>b</code> in the <code>for</code> loop:</p>\n\n<pre><code>for(b = a + 1; b &lt; NumWord ; b++)\n</code></pre>\n\n<p>It is sufficient to look in the rest of the array, because if a word has a duplicate prior to itself it will have been detected when that prior word was processed.</p>\n"}], "owner": {"reputation": 11, "user_id": 5281584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/72630e6f9571b1e8ecea8802abb33fe5?s=128&d=identicon&r=PG&f=1", "display_name": "D.Prog", "link": "https://stackoverflow.com/users/5281584/d-prog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1441552569, "creation_date": 1441184585, "last_edit_date": 1441184678, "question_id": 32348883, "link": "https://stackoverflow.com/questions/32348883/write-a-program-that-reads-an-input-file-and-identifies-all-duplicated-words", "title": "Write a program that reads an input file and identifies all duplicated words", "body": "<p>The program should print first the list of duplicated words followed by the list of unique words.</p>\n\n<p>ive been trying to code this but it still wont work it only prints a few unique words pls help me\nthis is what ive done so far btw im using codeblocks</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main()\n{\n\n FILE* inp;\n char word[BUFSIZ],input[BUFSIZ][BUFSIZ],dup[BUFSIZ][BUFSIZ],unique[BUFSIZ][BUFSIZ];\nint c=0,k=0,NumWord=0,n=0,found=0,m=1,g=0,j=0,h=0,b=1,d=1,a=0,size,detect=1,p=0;\nchar arr[BUFSIZ][BUFSIZ];\n\ninp=fopen(\"u.txt\",\"r\")  ;\n\nif(inp==NULL){perror(\"Error in opening a file\") ;return ;}\nwhile(fscanf(inp,\"%s\",word)!=EOF)\n{\n    strcpy(input[c++],word)  ;\n    ++NumWord;\n\n}\n\nsize = NumWord - 1  ;\n\nfor( a=0 ; a &lt; size ;a++)\n{\n    //detect=1;\n    for( ; b &lt; NumWord ; b++)\n    {\n            if(strcmp(input[a],input[b])==0 &amp;&amp; detect==1)\n            {\n                strcpy(dup[a],input[a]) ;\n                ++detect;\n                ++h;\n                ++found;\n            }\n    }\n\n        b = ++d;\n        if(!found)\n        {\n            strcpy(unique[n++],input[a]) ;\n        }\n    detect=1;\n}\n\n   for( g = 0; g &lt;h ; g++){\n       printf(\"%s \",dup[g]);\n\n      }\n   fclose(inp);\n\n  return (EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": ["c", "frama-c"], "comments": [{"owner": {"reputation": 1240, "user_id": 1292352, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33b9666840e0a005c0d91df41e8212de?s=128&d=identicon&r=PG", "display_name": "Anne", "link": "https://stackoverflow.com/users/1292352/anne"}, "edited": false, "score": 0, "creation_date": 1441184431, "post_id": 32348387, "comment_id": 52571050, "body": "You should give the command line you use to run frama-c, because the results heavily depend on the options you use."}, {"owner": {"reputation": 40, "user_id": 3688511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9Ol7.jpg?s=128&g=1", "display_name": "FedeXu", "link": "https://stackoverflow.com/users/3688511/fedexu"}, "reply_to_user": {"reputation": 1240, "user_id": 1292352, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33b9666840e0a005c0d91df41e8212de?s=128&d=identicon&r=PG", "display_name": "Anne", "link": "https://stackoverflow.com/users/1292352/anne"}, "edited": false, "score": 0, "creation_date": 1441185464, "post_id": 32348387, "comment_id": 52571694, "body": "i don&#39;t use the command line, i use the gui... the setting are all default except the timeout is set to 90... the prover is Alt-Ergo(native)"}, {"owner": {"reputation": 8560, "user_id": 1633665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b603faf464ae55fcdd7dc2fb3b7ac063?s=128&d=identicon&r=PG", "display_name": "Virgile", "link": "https://stackoverflow.com/users/1633665/virgile"}, "edited": false, "score": 0, "creation_date": 1441196579, "post_id": 32348387, "comment_id": 52578993, "body": "If you have trouble with ACSL specifications, you need to show them to us in order we can help. Also, WP does not handle dynamic memory very well, the creation and destruction functions are likely to cause problems in any case."}, {"owner": {"reputation": 40, "user_id": 3688511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9Ol7.jpg?s=128&g=1", "display_name": "FedeXu", "link": "https://stackoverflow.com/users/3688511/fedexu"}, "edited": false, "score": 0, "creation_date": 1441201513, "post_id": 32348387, "comment_id": 52582771, "body": "as I&#39;ve sayed i&#39;m not able to write ACSL and what i wrote seem it isn&#39;t compilable. I&#39;ve asked if someone can do an exemple with my code of a precondition / postcondition for exemple for the struct or the create function so I can compile it and figure out how to write statements in ACSL =("}], "owner": {"reputation": 40, "user_id": 3688511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9Ol7.jpg?s=128&g=1", "display_name": "FedeXu", "link": "https://stackoverflow.com/users/3688511/fedexu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441183132, "creation_date": 1441183132, "question_id": 32348387, "link": "https://stackoverflow.com/questions/32348387/frama-c-and-acsl-implementation-on-c-stack", "title": "Frama-C and ACSL implementation on C stack", "body": "<p>i have some trouble to implement the precondition and postcondition in ACSL into my code.</p>\n\n<p>I'd like to complete an exercise, i have implemented a stack (like the informal specification in the comment) and now i need to implement the precondition and postcondition like in the informal specification. The trouble i have is that i have tried to write the ACSL part and tried to compile frama-C with my implementation but it's not working, all the lines are with the red dots.</p>\n\n<p>I don't understand why it's not working but it's really probable that i'm not able to write ACSL code.</p>\n\n<p>There is someone can help me? if someone can write some example on my stack implementation it would greatly help to me.</p>\n\n<p>Thanks a lot advance</p>\n\n<p>Code i wrote,\nthe file Stack.h is the implementation of the Stack, i wrote a simply linear main.c to prove the correctness (in test case) of the code. The informal    specific of the exercise is the comment before the code of stack.h</p>\n\n<p>File Stack.h :</p>\n\n<pre><code>/*  create_stack\n\n    Inputs: none\n    Outputs: S (a stack)\n    Preconditions: none\n    Postconditions: S is defined and empty\n\ndestroy_stack\n\n    Inputs: S (a stack)\n    Outputs: S' (i.e. S changed)\n    Preconditions: none\n    Postconditions: S' is undefined. All resources (e.g. memory)   allocated to S have been released. No stack operation can be performed on S'.\n\nis_empty\n\n    Inputs: S (a stack)\n    Outputs: is_empty (boolean)\n    Preconditions: none\n    Postconditions: is_empty is true iff S is empty.\n\ntop\n\n    Inputs: S (a stack)\n    Outputs: E (a stack element)\n    Preconditions: S is not empty\n    Postconditions: E is the top element on S (S is unchanged)\n\n pop\n\n    Inputs: S (a stack)\n    Outputs: S' (i.e. S is changed)\n    Preconditions: S is not empty\n    Postconditions: Because S is not empty, it consist of two parts: a top element T and a stack R of remaining elements. S'=R.\n\npush\n\n    Inputs: S (a stack) and V (a value)\n    Outputs: S' (i.e. S changed)\n    Preconditions: V is of appropriate type for an element of S\n    Postconditions: S' has V as its top element and S as its remaining */\n\n#define STACK_MAX 100\n\nstruct Stack {\nint     data[STACK_MAX];\nint     size;\n};\ntypedef struct Stack Stack;\n\n\nStack *Stack_Init()\n{\nStack *S = malloc(sizeof(Stack));   //alloco la memoria per il puntatore\nassert(S != NULL);          //controllo che non sia null\nS-&gt;size = 0;            //inizializzo il puntatore\nreturn S;               //ritorno il puntatore\n}\n\nvoid Stack_Destroy(Stack *S)\n{\nfree(S);\n}\n\nint Stack_Is_Empty(Stack *S)\n{\nif (S-&gt;size == 0) \nreturn 1;\nelse \nreturn 0; \n}\n\nint Stack_Top(Stack *S)\n{\n\nreturn S-&gt;data[S-&gt;size-1];      //restituisco l'elemento in testa\n}\n\nvoid Stack_Pop(Stack *S)\n{\n\n    S-&gt;size--;\n}\n\nvoid Stack_Push(Stack *S, int d)\n{\nif (S-&gt;size &lt; STACK_MAX)\n    S-&gt;data[S-&gt;size++] = d;\nelse\n    fprintf(stderr, \"Error: stack full\\n\");\n}\n</code></pre>\n\n<p>File main.c :</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;assert.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include \"stack.h\"\n\n    int main (){\n\n    struct Stack* S = Stack_Init();  //chiamo la funzione che mi ritorna il puntatore alla memoria di una struttura Stack inizializzata a 0 con dim massima 100\n    int p;\n    printf(\"che elemento vuoi inserire?\\n\");\n    scanf(\"%d\", &amp;p);\n    Stack_Push(S,p);\n    printf(\"inseriscine un altro \\n\");\n    scanf(\"%d\", &amp;p);\n    Stack_Push(S,p);\n    printf(\"l'elemento che ora \u00e8 in testa \u00e8 %d \\n\", Stack_Top(S));\n    printf(\"togliamone uno\\n\");\n    Stack_Pop(S);\n    printf(\"l'elemento che ora \u00e8 in testa \u00e8 %d \\n\", Stack_Top(S));\n    printf(\"lo stack e vuoto ? \\n %d \\n\", Stack_Is_Empty(S));\n    printf(\"togliamone un altro\\n\");\n    Stack_Pop(S);\n    printf(\"ora lo stack e vuoto ? \\n %d \\n\", Stack_Is_Empty(S));\n    printf(\"distruggiamo lo stack \\n\");\n    Stack_Destroy(S);\n\n    return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "file", "uart", "termios"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1441183817, "post_id": 32348340, "comment_id": 52570719, "body": "Post what you code so far."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1441186906, "post_id": 32348340, "comment_id": 52572680, "body": "&quot;But if I open a file using either fopen() or open() ...&quot; : What file? a different one, or one referencing the tty that corresponds to the serial device?"}], "answers": [{"tags": [], "owner": {"reputation": 957, "user_id": 4737610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3f9188a1bec6ed7475e1b9dde7f45d?s=128&d=identicon&r=PG&f=1", "display_name": "S.I.J", "link": "https://stackoverflow.com/users/4737610/s-i-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1441185668, "creation_date": 1441185668, "answer_id": 32349279, "question_id": 32348340, "link": "https://stackoverflow.com/questions/32348340/termios-and-opening-files/32349279#32349279", "title": "Termios and opening files", "body": "<p>Check if you are using the same BAUD rate which your sensor works on. This is is the main problem most of the times.</p>\n"}], "owner": {"reputation": 1, "user_id": 5291586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2323bc5946300e10d7f96c9c5ecaff80?s=128&d=identicon&r=PG&f=1", "display_name": "igor", "link": "https://stackoverflow.com/users/5291586/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441185892, "creation_date": 1441182991, "last_edit_date": 1441185892, "question_id": 32348340, "link": "https://stackoverflow.com/questions/32348340/termios-and-opening-files", "title": "Termios and opening files", "body": "<p>I need to \"talk\" with a certain sensor through a UART connection. \nUsing the termios everything works with no problems and I'm able to have continuous communications with it- writing and reading multiple times.</p>\n\n<p>But if I open a file for r/w purposes using either <code>fopen()</code> or <code>open()</code> at any time during this communication, the UART connection stops working properly:\nmessages can still be sent, but when read they're incomplete.\nEven closing and reopening the same UART connection results in errors.\nCode is written in C, and am currently using Eclipse on some Linux distro. All of this on VM.</p>\n\n<p>Any ideas on what could cause this problem?</p>\n\n<p>P. S.: any suggestions regarding posting here would also be appreciated</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 3009, "user_id": 1133730, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c326a6611c28ad0410a5910fffd18180?s=128&d=identicon&r=PG", "display_name": "fersarr", "link": "https://stackoverflow.com/users/1133730/fersarr"}, "is_accepted": false, "score": -1, "last_activity_date": 1441182783, "last_edit_date": 1441182783, "creation_date": 1441182380, "answer_id": 32348144, "question_id": 32348099, "link": "https://stackoverflow.com/questions/32348099/what-does-this-mean-c-programming-no-condition/32348144#32348144", "title": "What does this mean? C programming no condition", "body": "<p>The condition is to check if the end of the string has been reached and not go past it. As you know, in C, strings are ended with a <code>'\\0'</code> character</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1441182417, "creation_date": 1441182417, "answer_id": 32348160, "question_id": 32348099, "link": "https://stackoverflow.com/questions/32348099/what-does-this-mean-c-programming-no-condition/32348160#32348160", "title": "What does this mean? C programming no condition", "body": "<p>The expression <code>*s++ = *t++</code> still has a result, and that result that can be used as a condition. More precisely, the result will be the character copied, and as you (should) know all non-zero values are considered \"true\", and as you also (should) know strings in C are <em>zero</em> terminated.</p>\n\n<p>So what the loop does is copy characters until the string terminator is reached.</p>\n"}, {"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": -1, "last_activity_date": 1441182429, "creation_date": 1441182429, "answer_id": 32348167, "question_id": 32348099, "link": "https://stackoverflow.com/questions/32348099/what-does-this-mean-c-programming-no-condition/32348167#32348167", "title": "What does this mean? C programming no condition", "body": "<p>Its checking if the end of string <code>\\0</code> <code>NUL</code> is reached or not, while copying the value of <code>*t</code> to <code>*s</code> and then incrementing both the pointers.</p>\n\n<p>And to answer your 2nd question, consider this,</p>\n\n<p>What is the difference between</p>\n\n<pre><code>if(a != 0)\n</code></pre>\n\n<p>&amp;</p>\n\n<pre><code>if(a)\n</code></pre>\n\n<p>Its just two ways of writing the same code. The only difference that i can think of is <strong>code clarity</strong>. The first one is more verbose, its easier to read, understand and maintain.</p>\n"}], "owner": {"reputation": 149, "user_id": 3881335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hWXNB.jpg?s=128&g=1", "display_name": "Mod Mark", "link": "https://stackoverflow.com/users/3881335/mod-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "closed_date": 1441183374, "answer_count": 3, "score": 1, "last_activity_date": 1441182783, "creation_date": 1441182237, "last_edit_date": 1441182473, "question_id": 32348099, "link": "https://stackoverflow.com/questions/32348099/what-does-this-mean-c-programming-no-condition", "closed_reason": "Duplicate", "title": "What does this mean? C programming no condition", "body": "<pre><code>void strcpy(char *s, char *t)\n{\n    while ((*s++ = *t++) != '\\0');\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void strcpy(char *s, char *t)\n{\n    while (*s++ = *t++);\n}\n</code></pre>\n\n<p>are the same, what does this mean? what does removing the condition do?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1441182361, "post_id": 32347970, "comment_id": 52569769, "body": "I&#39;m afraid you need <code>strlen</code>. Is there any reason you can&#39;t use <code>strlen</code> ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441184288, "post_id": 32347970, "comment_id": 52570970, "body": "@MichaelWalz Why use strlen when the sizes are known at compile time? That&#39;s just useless processing to get a value which you already know."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441184387, "post_id": 32347970, "comment_id": 52571028, "body": "@Lundin correct, but without using the quirks of your (BTW good) answer youn can&#39;t."}, {"owner": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441187542, "post_id": 32347970, "comment_id": 52573097, "body": "char *a[] = {&quot;ab\\0cd&quot;,&quot;cdef&quot;}; in this case i want sizeof string &quot;ab\\0cd&quot; as 5 so i cant use strlen @MichaelWalz"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1441187565, "post_id": 32347970, "comment_id": 52573116, "body": "@Ravindrakanmus Check my Answer."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441184402, "post_id": 32348028, "comment_id": 52571040, "body": "The OP explicitly asked for a way that doesn&#39;t use strlen. There may be plenty of reasons why, execution speed is one of them."}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 2, "last_activity_date": 1441182024, "creation_date": 1441182024, "answer_id": 32348028, "question_id": 32347970, "link": "https://stackoverflow.com/questions/32347970/array-of-pointers-to-find-sizeof-string/32348028#32348028", "title": "Array of pointers to find sizeof string", "body": "<p>Iterate over <code>a[0]</code> untill <code>\\0</code> is found.</p>\n\n<p>i.e. <code>a[0][0], a[0][1], a[0][2], ....</code></p>\n\n<p>But, as people say, what is the need to re-invent the wheel. It is better to use <code>strlen()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "edited": false, "score": 0, "creation_date": 1441187624, "post_id": 32348238, "comment_id": 52573159, "body": "char *a[] = {&quot;ab\\0cd&quot;,&quot;cdef&quot;}; in this case i want sizeof string &quot;ab\\0cd&quot; as 5 so i cant use strlen @Grzegorz"}, {"owner": {"reputation": 1083, "user_id": 5147212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0948323093255d680801e7fcbc7965?s=128&d=identicon&r=PG&f=1", "display_name": "Sigve Kolbeinson", "link": "https://stackoverflow.com/users/5147212/sigve-kolbeinson"}, "edited": false, "score": 0, "creation_date": 1441188115, "post_id": 32348238, "comment_id": 52573515, "body": "But you can use <code>sizeof()</code>. @Grzegorz Szpetkowski mention <code>strlen()</code> to highlight how its result would differ from <code>sizeof()</code>. because <code>&quot;abcd&quot;</code> = <code>{&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;\\0&#39;}</code>, strlen will return 4, and sizeof will return 5. Also, <code>&quot;ab\\0cd&quot;</code> = <code>{&#39;a&#39;,&#39;b&#39;,&#39;\\0&#39;,&#39;c&#39;,&#39;d&#39;,&#39;\\0&#39;}</code>, and strlen will return 2 whereas sizeof will return 6"}, {"owner": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "edited": false, "score": 0, "creation_date": 1441188570, "post_id": 32348238, "comment_id": 52573833, "body": "@Sigve..Yeah you are right..for &quot;ab\\0cd&quot; sizeof will return 6..But my question how to trace with this declarartion char *a[] = {&quot;ab\\0cd&quot;,&quot;bb\\0cd\\0hh&quot;};"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "edited": false, "score": 0, "creation_date": 1441188723, "post_id": 32348238, "comment_id": 52573931, "body": "@Ravindrakanmus You just messed up the whole Answers by doing that, please Ask a new Question. I already give you the Answer."}, {"owner": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1441188926, "post_id": 32348238, "comment_id": 52574048, "body": "@Michi Its my declaration char *a[] = {&quot;ab\\0cd\\0hh&quot;,&quot;hgad&quot;}; I want length of this string &quot;ab\\0cd\\0hh&quot; as 8..how should i get it?"}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": true, "score": 5, "last_activity_date": 1441182648, "creation_date": 1441182648, "answer_id": 32348238, "question_id": 32347970, "link": "https://stackoverflow.com/questions/32347970/array-of-pointers-to-find-sizeof-string/32348238#32348238", "title": "Array of pointers to find sizeof string", "body": "<p>As <code>\"abcd\"</code> is compile-time known  array of type <code>char[5]</code> and it is written directly into source code, you could just use:</p>\n\n<pre><code>sizeof(\"abcd\")\n</code></pre>\n\n<p>Notice, that:</p>\n\n<pre><code>sizeof(\"abcd\") == strlen(\"abcd\") + 1\n</code></pre>\n\n<p>as the former includes terminating <code>NUL</code> character.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1441184570, "last_edit_date": 1441184570, "creation_date": 1441184029, "answer_id": 32348699, "question_id": 32347970, "link": "https://stackoverflow.com/questions/32347970/array-of-pointers-to-find-sizeof-string/32348699#32348699", "title": "Array of pointers to find sizeof string", "body": "<p>Put the actual string constants as separate declarations:</p>\n\n<pre><code>const char STR1[] = \"abcd\";\nconst char STR2[] = \"cdef\";\n</code></pre>\n\n<p>Then either build up a couple of corresponding tables:</p>\n\n<pre><code>const char* STR_TABLE [] = \n{\n  STR1,\n  STR2\n};\n\nconst size_t STR_SIZES [] =\n{\n  sizeof(STR1),\n  sizeof(STR2)\n};\n</code></pre>\n\n<p>Or alternatively, use a struct:</p>\n\n<pre><code>typedef struct\n{\n  const char*  str;\n  size_t       size;\n} str_t;\n\nconst str_t STR_TABLE [] = \n{\n  { STR1, sizeof(STR1) },\n  { STR1, sizeof(STR2) },\n};\n</code></pre>\n\n<p>It should be noted that the size of a character array is not the same as the string length, because string length doesn't take the nul termination in account, which <code>sizeof</code> does. To get the string length out of the above example, at compile-time, use <code>sizeof(STR1)-1</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "edited": false, "score": 0, "creation_date": 1441187870, "post_id": 32349897, "comment_id": 52573343, "body": "char *a[] = {&quot;ab\\0cd&quot;,&quot;cdef&quot;}; in this case i want sizeof string &quot;ab\\0cd&quot; as 5 so i cant use strlen @Michi"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "edited": false, "score": 0, "creation_date": 1441187940, "post_id": 32349897, "comment_id": 52573389, "body": "@Ravindrakanmus, my answer did what you asked, now you come with something else, Why ? you just terminated your string when you added \\0."}, {"owner": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "edited": false, "score": 0, "creation_date": 1441188158, "post_id": 32349897, "comment_id": 52573545, "body": "Yeah actually i want like this only..so please let me know if you know the logic for this.."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "edited": false, "score": 0, "creation_date": 1441188680, "post_id": 32349897, "comment_id": 52573908, "body": "@Ravindrakanmus You just messed up the whole Answers by doing that, please Ask a new Question. I already give you the Answer."}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 0, "last_activity_date": 1441187342, "creation_date": 1441187342, "answer_id": 32349897, "question_id": 32347970, "link": "https://stackoverflow.com/questions/32347970/array-of-pointers-to-find-sizeof-string/32349897#32349897", "title": "Array of pointers to find sizeof string", "body": "<p>Probably this is what you need:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint size(char *ptr){\n    int offset = 0;\n    int len = 0;\n\n    while (*(ptr + offset) != '\\0'){\n        ++len;\n        ++offset;\n    }\n\n    return len;\n}\n\nint main(void){\n    char *a[] = {\"abcd\",\"cdef\"};\n\n    int len = size(a[0]);\n    printf(\"The size of\\t%s\\tis\\t%d\\n\",a[0], len);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>The size of abcd    is  4</p>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 5023774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t5Jd9-EJiKI/AAAAAAAAAAI/AAAAAAAAELU/h3_awC_bKwc/photo.jpg?sz=128", "display_name": "Ravindra kanmus", "link": "https://stackoverflow.com/users/5023774/ravindra-kanmus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 32348238, "answer_count": 4, "score": -1, "last_activity_date": 1441187342, "creation_date": 1441181834, "last_edit_date": 1441182221, "question_id": 32347970, "link": "https://stackoverflow.com/questions/32347970/array-of-pointers-to-find-sizeof-string", "title": "Array of pointers to find sizeof string", "body": "<p>Suppose we have the scenario..</p>\n\n<pre><code>char *a[] = {\"abcd\",\"cdef\"};\n</code></pre>\n\n<p>I want to know the sizeof of string \"abcd\", I dont want to use <code>strlen</code>.</p>\n\n<p>Please answer me how to get sizeof of the string \"abcd\"?</p>\n"}, {"tags": ["c", "oop"], "comments": [{"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 8, "creation_date": 1441181812, "post_id": 32347910, "comment_id": 52569473, "body": "With C? You can&#39;t."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1441181964, "post_id": 32347910, "comment_id": 52569560, "body": "You have to pass <code>self</code> explicitly. As muc as you cannot overload operators. Or make the C compiler ride a horse. Or <code>for ch in &quot;hello world&quot;:</code> is not valid C or C++. Or &quot;Vielleicht sollte man erst denken und dann schreiben.&quot; is not a valid English sentence (but valid in another language). Or ..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441182461, "post_id": 32347910, "comment_id": 52569834, "body": "Unrelated to the question, but what&#39;s the point of <code>stopwatch_t * self = _self;</code> ? Why can&#39;t you use <code>_self</code> directly ?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441182671, "post_id": 32347910, "comment_id": 52569978, "body": "@MichaelWalz: it could be C code."}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 2, "creation_date": 1441182714, "post_id": 32347910, "comment_id": 52570002, "body": "You are making a confusion. <a href=\"http://en.cppreference.com/w/c/language\" rel=\"nofollow noreferrer\"><code>C</code></a> does not support <code>OOP</code>. <a href=\"http://en.cppreference.com/w/cpp/language\" rel=\"nofollow noreferrer\"><code>C++</code></a> does. <code>C</code> and <code>C++</code> are different languages (they are related, <i>most</i> of <code>C</code> is included in <code>C++</code> but the <code>OOP</code> is one of the reasons <code>C++</code> emerged)."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 11, "creation_date": 1441182944, "post_id": 32347910, "comment_id": 52570162, "body": "@axiac. OOP is a programming style. You can get it in C (and the Linux kernel has a lot of OOP code)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1441183242, "post_id": 32347910, "comment_id": 52570340, "body": "@BasileStarynkevitch I don&#39;t uderstand your comment &quot; it could be C code&quot;.  IMO <code>stopwatch_t * self = _self; _self-&gt;...</code> can be replaced by <code>self-&gt;...</code>. Could you explain please ?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 3, "creation_date": 1441183303, "post_id": 32347910, "comment_id": 52570381, "body": "I just meant that OOP is a <i>style</i> or <i>paradigm</i> and many C programs are using it (without using the impossible <code>Receiver-&gt;Method(args)</code> syntax)."}, {"owner": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1441183839, "post_id": 32347910, "comment_id": 52570732, "body": "@MichaelWalz: It&#39;s a leftover from many attempts to make it work. You are right, it should work with _self directly."}, {"owner": {"reputation": 7884, "user_id": 543873, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55576366e4295fb7840a319399d53f57?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/543873/michael"}, "edited": false, "score": 1, "creation_date": 1441207565, "post_id": 32347910, "comment_id": 52587302, "body": "Actually, to everyone saying it&#39;s impossible, that is not true, although the hack is so terrible I&#39;m not going to put it as an answer.  Basically you would need to have each object have different function pointers which uniquely held the self pointer for that object and then call the real underlying function, passing that parameter explicitly.  Then you could use the syntax <code>Stopwatch-&gt;tick()</code> where that particular <code>tick</code> contained something like <code>realTick(self)</code> where self=Stopwatch for that instance."}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "edited": false, "score": 0, "creation_date": 1441183704, "post_id": 32347964, "comment_id": 52570653, "body": "As where I come from is an embedded environment, sticking to ANSI-C, things will always work. However I see it&#39;s not possible and I see that it might be obfuscated in this example why to do it. I&#39;ve been inspired by WiringPi and been working a lot in C# lately so I wanted to see how close I could go to the same benefits of OOP in C#/C++ in C. Call me obsolete, but not all platforms support C++, and maybe C99 could be fine, but again, if it is ANSI-C it will work."}, {"owner": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "edited": false, "score": 1, "creation_date": 1441192826, "post_id": 32347964, "comment_id": 52576459, "body": "I didn&#39;t imply the book was any good, I just saw it as a reference on many topics where people advice to use that for starting on OOP in C and hence I thought it was a decent starting point.  I agree with you on your points regarding C89/C99, and is probably following C99 as it&#39;s implemented in the compiler without truly realizing it."}], "tags": [], "owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "is_accepted": false, "score": 6, "last_activity_date": 1441185631, "last_edit_date": 1441185631, "creation_date": 1441181808, "answer_id": 32347964, "question_id": 32347910, "link": "https://stackoverflow.com/questions/32347910/oop-in-c-implicitly-pass-self-as-parameter/32347964#32347964", "title": "OOP in C, implicitly pass self as parameter", "body": "<p>That's simpy not a language feature of C, and that probably was one of the motivations to invent C++, so with C alone, this is impossible.</p>\n\n<p>There's a lot of libraries in C, and basically all I know use the same approach as you, using structs to store states (in your case, <code>stopwatch_t</code>), but just skip the function pointers in the structs wherever possible; this is not because C programmers don't like OOP, but because it's less redundant to do e.g.</p>\n\n<pre><code> stoplib_tick(Stopwatch);\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code> Stopwatch-&gt;tick(Stopwatch);\n</code></pre>\n\n<p>Also, it's a bad idea to carry around a bunch of function pointers <strong>in every instance of your struct</strong> that are always the same; it's just a waste of space, and a possible cause for error. If you want, you can make <strong>one</strong> struct that contains all the function pointers for your type, and call them from that table. Basically, that's what VTables in C++ are, underneath.</p>\n\n<p>Hence, no C programmer would do this; unless your function pointer is actually something that might change, you just don't keep the operations you can do on a struct in that struct.</p>\n\n<p>I don't know that book you're referring to, but if it preaches doing that, I don't like it.</p>\n\n<p>Seriously, if you want C with object orientation, go for C++; aside from coding for a few kernels, there's very little you can't do with C++ that you can do with C, and it was really invented half an eternity ago to bring object orientation to C programmers. Don't be the 1960s.</p>\n\n<p><strong>EDIT</strong> started to read the PDF you link to -- seriously, who would use ANSI-C nowadays? <strong>Especially</strong> if you want to comfortably work with structs etc, you should not use anything older than C99 (considering that's pretty old already...), and hence, that book is hopelessly outdated, unless you come up with a system of huge importance and heritage (\"hi, I'm working on nuclear weapon control systems from the 1980s and I need to fix this and that\"), I'd say I can't think of a case where it would make sense following these examples; obviously, \"I'm learning to do OOP in C from scratch\" shouldn't be based on things that have been obsolete for more than a decade.</p>\n\n<p><strong>EDIT</strong>: you comment</p>\n\n<blockquote>\n  <p>As where I come from is an embedded environment, sticking to ANSI-C, things will always work. </p>\n</blockquote>\n\n<p>I kind of reluctantly agree. C99 support is lacking on some platforms, but: most compilers support the <em>vast majority of C99 features</em>. ANSI-C (should more correctly be called C89, because C99 is also an ANSI standard) is really more than 25 years old now, and without knowing, your code might even not comply with C89. The code in the book sure as hell is <strong>not</strong> valid ANSI-C, no matter what the author claims. ANSI-C doesn't have <code>//</code> comments, for example; this is but a minor mistake, and I'd guess all compilers, unless set to pedantic mode wouldn't complain,  but still, it's not a good sight.</p>\n\n<p>So: do yourself a favor and don't rely on a book that's selectively using hard-to-use language statuses and try to use whatever your compiler supports. </p>\n\n<p>Also: the more I read that book, the less a good excercise in (modern) OOP it seems to be (p. 3, on the PDF page 9):</p>\n\n<blockquote>\n  <p>The generic pointer <code>void *</code> is used throughout. On the one hand it makes it\n  impossible to discover what a set looks like, but on the other hand it permits us to\n  pass virtually anything to <code>add()</code> and the other functions.</p>\n</blockquote>\n\n<p>Yes, because type safety isn't a concept vital to the success of C, and because it's a good idea to pass <code>void*</code> and then, first line of the method, cast it to your desired pointer type. Aargh! If you want terrible bugs, that's how you get them.</p>\n\n<p>Look at things like CPython: Python is a OO language, yet the interpreter/compiler is written in C. Python does C-OOP with the PyObject struct, which, as a main feature, has a type reference, so to avoid doing these blind casts. You shouldn't be able to pass a <code>const char[]</code> where you're expecting a pointer to one of your objects, and the whole point of polymorphism is that you can use daughter types of your type, but not completely disparate types, with a function. The book really doesn't do OOP any good. Read something else. I'm pretty sure there's books on CPython's design, and I'd personally think that they can't be worse.</p>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "edited": false, "score": 0, "creation_date": 1441183448, "post_id": 32348034, "comment_id": 52570476, "body": "I see it&#39;s not possible and probably the reason why I can&#39;t wrap my head around it. But I&#39;ll look into your suggestions, and thanks for the positive constructive feedback."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1441183644, "post_id": 32348034, "comment_id": 52570618, "body": "However <code>Recv-&gt;method(arg...)</code> is just a syntax issue. You could accept to type <code>SEND(Recv,Method_sel,arg...)</code>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 16, "last_activity_date": 1598143834, "last_edit_date": 1598143834, "creation_date": 1441182035, "answer_id": 32348034, "question_id": 32347910, "link": "https://stackoverflow.com/questions/32347910/oop-in-c-implicitly-pass-self-as-parameter/32348034#32348034", "title": "OOP in C, implicitly pass self as parameter", "body": "<blockquote>\n<p>I can't wrap my head around how to structure my &quot;object&quot; so instead of</p>\n<p><code>Stopwatch-&gt;tick(Stopwatch);</code></p>\n<p>I can write <code>Stopwatch-&gt;tick();</code></p>\n</blockquote>\n<p>This is not possible in standard C. You need to pass the receiver as an <em>explicit</em> formal argument to your C functions (in contrast with C++ which has <code>this</code> as an <em>implicit</em> formal).</p>\n<p>However:</p>\n<ul>\n<li><p>you generally want to pack all the method functions in one single <code>struct</code> with several function members (and have each instance start with a pointer to that <code>struct</code>). Read about <a href=\"https://en.wikipedia.org/wiki/Virtual_method_table\" rel=\"nofollow noreferrer\">vtable</a>-s.</p>\n</li>\n<li><p>you could have some macro (or perhaps inline function) to avoid giving <code>Stopwatch</code> twice; you'll still write <code>TICK(Stopwatch)</code> not <code>Stopwatch-&gt;tick();</code>; the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow noreferrer\">statement-expr</a> extension of <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> could be useful.</p>\n</li>\n</ul>\n<p>Look into GTK and its <a href=\"https://developer.gnome.org/gobject/stable/howto-gobject.html\" rel=\"nofollow noreferrer\">Gobject system</a> as an example of a cute object system for C. Read also about the <a href=\"https://dl.acm.org/doi/abs/10.1145/38765.38822?casa_token=qSqs7VrsI2EAAAAA:m_oEZ4oGjf_vwzIsALrlrj4U40CC5DIneuUQcqHZGXbujJ7sKK7VyrlXV0Tca_vaQOz-5TMUAxE\" rel=\"nofollow noreferrer\">ObjVLisp model</a> and wikipage on <a href=\"https://en.wikipedia.org/wiki/Virtual_method_table\" rel=\"nofollow noreferrer\">virtual method tables</a>. Maybe see <a href=\"http://starynkevitch.net/Basile/bismon-chariot-doc.pdf\" rel=\"nofollow noreferrer\">this draft</a> report and <a href=\"http://refpersys.org/\" rel=\"nofollow noreferrer\">RefPerSys</a> and also the <a href=\"http://bootstrappingartificialintelligence.fr/WordPress3/\" rel=\"nofollow noreferrer\">blog of the late J.Pitrat</a>.</p>\n<p>BTW, you could decide that you have first class method selectors (perhaps as integers, or pointers to some common selector type) and code a variadic <code>send</code> <a href=\"https://en.wikipedia.org/wiki/Dynamic_dispatch\" rel=\"nofollow noreferrer\">dispatching</a> function (so you would code <code>send(StopWatch,TICK_SEL)</code> instead of your dreamed <code>Stopwatch-&gt;tick()</code>) or macro. You might find <a href=\"https://sourceware.org/libffi/\" rel=\"nofollow noreferrer\">libffi</a> useful. The old <a href=\"https://en.wikipedia.org/wiki/XView\" rel=\"nofollow noreferrer\">Xview</a> could be inspirational.</p>\n<p>At last, as many fancy object layer implementors, you might use some metaprogramming and provide some C code generating tool (like <code>moc</code> in Qt). You might even consider customizing your <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> compiler with <a href=\"http://gcc-melt.org/\" rel=\"nofollow noreferrer\">MELT</a> for such purposes. Or making a <a href=\"https://softwareengineering.stackexchange.com/a/257873/40065\">translator</a> (see <a href=\"https://softwareengineering.stackexchange.com/a/273895/40065\">this</a>) from your fancy OOP dialect to C (like <a href=\"https://github.com/GNOME/vala\" rel=\"nofollow noreferrer\">VALA</a> or <a href=\"http://swig.org/\" rel=\"nofollow noreferrer\">SWIG</a> or <a href=\"https://www-sop.inria.fr/mimosa/fp/Bigloo/\" rel=\"nofollow noreferrer\">Bigloo</a> or <a href=\"http://call-cc.org/\" rel=\"nofollow noreferrer\">Chicken-Scheme</a> do; see also <a href=\"https://softwareengineering.stackexchange.com/a/257873/40065\">this</a>). Or preprocess your code with an external preprocessor (your own one, or <a href=\"http://www.gnu.org/software/m4/m4.html\" rel=\"nofollow noreferrer\"><code>m4</code></a> or <a href=\"http://en.nothingisreal.com/wiki/GPP\" rel=\"nofollow noreferrer\">GPP</a>, etc...).</p>\n"}, {"comments": [{"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 1, "creation_date": 1441192865, "post_id": 32350069, "comment_id": 52576493, "body": "In general, OOP is used for inheritance; your example does not show how to achieve late-binding however."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 1, "creation_date": 1441193420, "post_id": 32350069, "comment_id": 52576866, "body": "@MatthieuM. Rather, inheritance can be used for OOP. My example doesn&#39;t show this because that was not what the question was about. In the case inheritance is needed, you typically make a new struct, also incomplete type, which contains the parent plus whatever extra types you need. You&#39;ll then have to make the definition of the incomplete type visible both to the parent and the child. If this wasn&#39;t done when the parent was created, it isn&#39;t inheritable. Similarly the parent can decide to only expose some members to the child (roughly the same as private vs protected)."}, {"owner": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "edited": false, "score": 0, "creation_date": 1441193551, "post_id": 32350069, "comment_id": 52576961, "body": "Thanks for the useful explanation and example, it explained a lot to me and I realize that my approach even though it works might not be the best way to go - atleast in C. Do you have any source that let me go more in-depth with OOP in C as I realize the book isn&#39;t worth much."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "edited": false, "score": 0, "creation_date": 1441194402, "post_id": 32350069, "comment_id": 52577500, "body": "@CarstenFarving Sadly, there&#39;s a lack of teaching about proper use of incomplete/opaque type in general. What you might want to look for to find most information, is probably the term <i>ADT</i> (abstact data type), which is and old term that pre-dates OO. Roughly, an ADT is a poor man&#39;s class which doesn&#39;t necessarily concern itself with the OO corner stones private encapsulation and inheritance/polymorphism, but has strong focus on the 3rd and perhaps most important corner stone, which is modularisation into autonomous objects that only concern themselves with their own designated purpose."}, {"owner": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "edited": false, "score": 0, "creation_date": 1441195291, "post_id": 32350069, "comment_id": 52578131, "body": "@Lundin That is probably also what is most important for me at this point as that mainly is what I&#39;m trying to achieve. Thanks for your input, it&#39;s highly appriciated"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 9, "last_activity_date": 1441187810, "creation_date": 1441187810, "answer_id": 32350069, "question_id": 32347910, "link": "https://stackoverflow.com/questions/32347910/oop-in-c-implicitly-pass-self-as-parameter/32350069#32350069", "title": "OOP in C, implicitly pass self as parameter", "body": "<p>Why I never liked that book much, is that tries to turn C into C++. Everyone must first realize that C++ programming is not necessarily the same as object-oriented programming. OOP is a way to do <em>program design</em> and it is quite unrelated to language syntax. C++ just makes it easier and prettier, is all. But just because C++ has a feature that makes code prettier in some situation, it doesn't necessarily mean that the feature is at all related to OOP (take for example operator overloading).</p>\n\n<p>So don't try to turn C into C++. Accept that C has different syntax, which may not be as pretty. C actually has lots of functionality available that lets you implement OOP design. True encapsulation with private/public variables or functions is 100% achievable in C.</p>\n\n<p>Since C is not C++, you don't want member functions inside the struct. The only function pointer you'll want there are special cases such as callback functions and similar. So instead of <code>Stopwatch-&gt;tick(&amp;Stopwatch)</code>, it is better not to use function pointers at all, but to call the member function directly: <code>sw_tick(&amp;Stopwatch)</code>. Where <code>sw</code> is some unique prefix for the stopwatch module.</p>\n\n<p>This allows you to implement Stopwatch as an object of <em>incomplete type</em> (also called \"opaque type\"), which is the very core of OOP in C. Incomplete type allows you to hide the contents of the struct to the caller.</p>\n\n<p>Then rewrite the whole stopwatch \"class\" (call it class or ADT or whatever) as something like this:</p>\n\n<p>stopwatch.h</p>\n\n<pre><code>typedef struct stopwatch_t stopwatch_t; // incomplete type\n\nstopwatch_t* sw_new (void);             // \"constructor\"\n\nvoid sw_delete (stopwatch_t* sw);       // \"destructor\"\n\nvoid sw_tick (const stopwatch_t* sw);   // public member function\n// any number of public functions here\n// mind const correctness!\n</code></pre>\n\n<p>stopwatch.c</p>\n\n<pre><code>struct stopwatch_t        // implementation\n{\n  // true private variables:\n\n  unsigned int milliseconds;\n  unsigned int seconds;\n  unsigned int minutes;\n  unsigned int hours;\n  bool is_enabled;\n};\n\nstopwatch_t* sw_new (void)\n{\n  // same as what you already have\n}\n\n// the module is responsible for cleaning up its own mess, NOT THE CALLER\nvoid sw_delete (stopwatch_t* sw)\n{\n  free(sw);\n}\n\n// any number of public member functions:\nvoid sw_tick (const stopwatch_t* sw)\n{\n  // here sw is the \"self\"/\"this\" pointer\n}\n\n// any number of private member functions:\nstatic void sw_do_stuff (stopwatch_t* sw)\n{\n}\n</code></pre>\n\n<p>The caller will only be able to declare pointers to objects, but never an instance of them. That's no big deal, lots of C and C++ libraries work that way. A pointer to incomplete type is somewhat similar to a pointer to an abstract base class in C++. You can't declare instances of those either.</p>\n\n<p>If you need to mix private and public member variables, you would typedef a struct in the h file where the public member variables are declared as plain struct members, and the private member variables are declared through an incomplete type.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1441199407, "post_id": 32352591, "comment_id": 52581224, "body": "Nice. I would not cast malloc since we&#39;re in C, and prefer <code>sometype *x = malloc(sizeof *x)</code>. Also, I believe the last <code>offset</code> is guaranteed to be <code>0</code>: a pointer to a struct (IIRC) is always safely castable to a pointer of its first member."}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1441201048, "post_id": 32352591, "comment_id": 52582438, "body": "@chi: Indeed; and I actually make use of the 0-offset it in the <code>static</code> functions, however I prefer my consumers not to assume it in case I change my mind and move <code>base</code>."}], "tags": [], "owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "is_accepted": false, "score": 11, "last_activity_date": 1531306737, "last_edit_date": 1531306737, "creation_date": 1441195213, "answer_id": 32352591, "question_id": 32347910, "link": "https://stackoverflow.com/questions/32347910/oop-in-c-implicitly-pass-self-as-parameter/32352591#32352591", "title": "OOP in C, implicitly pass self as parameter", "body": "<p><em>Note: there are already a number of good answers, which explain why the \"method call\" syntax is not available in C, however they do not explain what to do instead but just point at resources. Basic OO in C is actually relatively simple, so here is a quick HOW TO.</em></p>\n\n<p>This HOW TO is separated in two sections:</p>\n\n<ul>\n<li>the first section shows how to achieve <em>encapsulation</em></li>\n<li>the second section shows how to layer <em>late binding</em> on top</li>\n</ul>\n\n<p><strong>Encapsulation</strong></p>\n\n<p>Often times, OO is actually used to mean <em>encapsulation</em>. The idea of encapsulation is to obtain a modular design with well defined interfaces over the state of the program in the hope of making it easier to <em>maintain invariants</em>.</p>\n\n<p>In C, this is traditionally achieved through <em>opaque pointers</em>:</p>\n\n<pre><code>// stop_watch.h\ntypedef struct stop_swatch_ stop_watch;\n\nstop_watch* stop_watch_create();\nstop_watch* stop_watch_clone(stop_watch const* sw);\nvoid stop_watch_dispose(stop_watch* sw);\n\nvoid stop_watch_tick(stop_watch* sw);\nvoid stop_watch_start(stop_watch* sw);\nvoid stop_watch_stop(stop_watch* sw);\nvoid stop_watch_reset(stop_watch* sw);\n</code></pre>\n\n<p>This header is the only thing the user sees, and therefore it cannot name the internals of the <code>struct stop_watch_</code>. Of course, this being C, the user can still mess with them, but at least we made it a bit harder on them.</p>\n\n<p><em>Note: the <code>.c</code> is left as an exercise to the reader; it's plain boring C code after all.</em></p>\n\n<p><strong>Late Binding</strong></p>\n\n<p>Late Binding is deciding at run-time which function to call; it can for example be achieved through <code>virtual</code> methods in C++, Java, ...</p>\n\n<p>It can be done in C, with relative ease, as well. You will just not benefit from all the sugar.</p>\n\n<pre><code>// stop_watch.h\ntypedef struct stop_watch_functions_ stop_watch_functions;\n\ntypedef struct {\n    stop_watch_functions const* functions;\n} stop_watch;\n\nstruct stop_watch_functions_ {\n    void (*clone)(stop_watch const*);\n    void (*dispose)(stop_watch*);\n\n    void (*tick)(stop_watch*);\n    void (*start)(stop_watch*);\n    void (*stop)(stop_watch*);\n    void (*reset)(stop_watch*);\n};\n\nstop_watch* stop_watch_clone(stop_watch const* sw);\nvoid stop_watch_dispose(stop_watch* sw);\n\nvoid stop_watch_tick(stop_watch* sw);\nvoid stop_watch_start(stop_watch* sw);\nvoid stop_watch_stop(stop_watch* sw);\nvoid stop_watch_reset(stop_watch* sw);\n</code></pre>\n\n<p>Alright, so we define:</p>\n\n<ul>\n<li>a v-table: <code>stop_watch_functions</code></li>\n<li>a struct to hold onto that v-table: <code>stop_watch</code>; it is meant to be part of the instance of the concrete stop-watch.</li>\n</ul>\n\n<p>Let's move on to the implementation:</p>\n\n<pre><code>// stop_watch.c\nstop_watch* stop_watch_clone(stop_watch const* sw) {\n    return (*sw-&gt;functions-&gt;clone)(sw);\n}\n\nvoid stop_watch_dispose(stop_watch* sw) {\n    return (*sw-&gt;functions-&gt;dispose)(sw);\n}\n\nvoid stop_watch_tick(stop_watch* sw) {\n    return (*sw-&gt;functions-&gt;tick)(sw);\n}\n\nvoid stop_watch_start(stop_watch* sw) {\n    return (*sw-&gt;functions-&gt;start)(sw);\n}\n\nvoid stop_watch_stop(stop_watch* sw)  {\n    return (*sw-&gt;functions-&gt;stop)(sw);\n}\n\nvoid stop_watch_reset(stop_watch* sw) {\n    return (*sw-&gt;functions-&gt;reset)(sw);\n}\n</code></pre>\n\n<p>Pretty straightforward, right?</p>\n\n<p>And finally, let's move on to a <em>concrete</em> stop-watch implementation:</p>\n\n<pre><code>// my_stop_watch.h\n#include \"stop_watch.h\"\n\ntypedef struct my_stop_watch_ my_stop_watch;\n\nmy_stop_watch* my_stop_watch_create();\n\nstop_watch* my_stop_watch_upcast(my_stop_watch* msw);\nmy_stop_watch* my_stop_watch_downcast(stop_watch* sw);\n</code></pre>\n\n<p>Okay, the header is boring; all the good stuff in hidden away after all:</p>\n\n<pre><code>// my_stop_watch.c\n#include \"my_stop_watch.h\"\n\nstruct my_stop_watch_ {\n    stop_watch base;\n\n    unsigned int milliseconds;\n    unsigned int seconds;\n    unsigned int minutes;\n    unsigned int hours;\n\n    bool is_enabled;\n};\n\nstatic stop_watch* my_stop_watch_clone(stop_watch const* sw) {\n    my_stop_watch* new = malloc(sizeof(my_stop_watch));\n    memset(new, (my_stop_watch const*)sw, sizeof(my_stop_watch));\n}\n\nstatic void my_stop_watch_dispose(stop_watch* sw) {\n    free(sw);\n}\n\nstatic void my_stop_watch_tick(stop_watch* sw) {\n    my_stop_watch* msw = (my_stop_watch*)sw;\n    /* do something */\n}\n\nstatic void my_stop_watch_start(stop_watch* sw) {\n    my_stop_watch* msw = (my_stop_watch*)sw;\n    /* do something */\n}\n\nstatic void my_stop_watch_stop(stop_watch* sw) {\n    my_stop_watch* msw = (my_stop_watch*)sw;\n    /* do something */\n}\n\nstatic void my_stop_watch_reset(stop_watch* sw) {\n    my_stop_watch* msw = (my_stop_watch*)sw;\n    /* do something */\n}\n\nstatic stop_watch_functions const my_stop_watch_table = {\n    &amp;my_stop_watch_clone,\n    &amp;my_stop_watch_dispose,\n\n    &amp;my_stop_watch_tick,\n    &amp;my_stop_watch_start,\n    &amp;my_stop_watch_stop,\n    &amp;my_stop_watch_reset\n};\n\nmy_stop_watch* my_stop_watch_create() {\n    my_stop_watch* msw = malloc(sizeof(my_stop_watch*));\n\n    msw-&gt;base = &amp;my_stop_watch_table;\n\n    /* do something */\n\n    return msw;\n}\n\nstop_watch* my_stop_watch_upcast(my_stop_watch* msw) {\n    return &amp;msw-&gt;base;\n}\n\nmy_stop_watch* my_stop_watch_downcast(stop_watch* sw) {\n    if (sw-&gt;functions != &amp;my_stop_watch_table) {\n        return NULL;\n    }\n\n    return (my_stop_watch*)((char*)sw - offsetof(my_stop_watch, base));\n}\n</code></pre>\n\n<p>Here I used the strategy of most C++ implementations (with a virtual table); there are other strategies available, but this one is widely applicable.</p>\n"}], "owner": {"reputation": 511, "user_id": 5259611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-bmJWAnfGbiM/AAAAAAAAAAI/AAAAAAAAAIk/dzzTQ8i2dtM/photo.jpg?sz=128", "display_name": "Carsten Farving", "link": "https://stackoverflow.com/users/5259611/carsten-farving"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6633, "favorite_count": 8, "accepted_answer_id": 32348034, "answer_count": 4, "score": 16, "last_activity_date": 1598143834, "creation_date": 1441181626, "last_edit_date": 1441207782, "question_id": 32347910, "link": "https://stackoverflow.com/questions/32347910/oop-in-c-implicitly-pass-self-as-parameter", "title": "OOP in C, implicitly pass self as parameter", "body": "<p>I've been working on an example to learn OOP in C. Currently I've come up with this code which is working, however I'm interested in making the methods implicitly pass self as a parameter.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n//#include \"Stopwatch.h\"\n\n\ntypedef struct stopwatch_s\n{\n    unsigned int milliseconds;\n    unsigned int seconds;\n    unsigned int minutes;\n    unsigned int hours;\n\n    bool is_enabled;\n\n    void ( *tick )      ( struct stopwatch_s* );\n    void ( *start )     ( struct stopwatch_s* );\n    void ( *stop )      ( struct stopwatch_s* );\n    void ( *reset )     ( struct stopwatch_s* );\n} stopwatch_t;\n\nstatic void tick (stopwatch_t* _self)\n{\n    stopwatch_t * self = _self;\n    if (self-&gt;is_enabled)\n    {\n        self-&gt;milliseconds++;\n        if (self-&gt;milliseconds &gt;= 1000)\n        {\n            self-&gt;milliseconds = 0;\n            self-&gt;seconds++;\n\n            if (self-&gt;seconds &gt;= 60)\n            {\n                self-&gt;seconds = 0;\n                self-&gt;minutes++;\n\n                if (self-&gt;minutes &gt;= 60)\n                {\n                    self-&gt;minutes = 0;\n                    self-&gt;hours++;\n                }\n            }\n        }\n    }\n}\n\nstatic void start (stopwatch_t* _self)\n{\n    stopwatch_t * self = _self;\n    self-&gt;is_enabled = true;\n}\n\nstatic void stop (stopwatch_t* _self)\n{\n    stopwatch_t * self = _self;\n    self-&gt;is_enabled = false;\n}\n\nstatic void reset (stopwatch_t* _self)\n{\n    stopwatch_t * self = _self;\n    self-&gt;is_enabled = false;\n    self-&gt;milliseconds = 0;\n    self-&gt;seconds = 0;\n    self-&gt;minutes = 0;\n    self-&gt;hours = 0;\n}\n\nvoid * new_stopwatch()\n{\n    stopwatch_t * newInstance = (stopwatch_t *)calloc(1, sizeof(stopwatch_t));\n    newInstance-&gt;is_enabled = false;\n    newInstance-&gt;milliseconds = 0;\n    newInstance-&gt;seconds = 0;\n    newInstance-&gt;minutes = 0;\n    newInstance-&gt;hours = 0;\n    newInstance-&gt;tick = &amp;tick;\n    newInstance-&gt;start = &amp;start;\n    newInstance-&gt;stop = &amp;stop;\n    newInstance-&gt;reset = &amp;reset;\n\n    return newInstance;\n}\n\nvoid main()\n{\n    struct stopwatch_s * Stopwatch = new_stopwatch();\n    printf (\"Initial: %d\\n\", Stopwatch-&gt;milliseconds);\n    Stopwatch-&gt;start (Stopwatch);\n    Stopwatch-&gt;tick (Stopwatch);\n    Stopwatch-&gt;tick (Stopwatch);\n    Stopwatch-&gt;tick (Stopwatch);\n    printf (\"Started: %d\\n\", Stopwatch-&gt;milliseconds);\n    Stopwatch-&gt;stop (Stopwatch);\n    Stopwatch-&gt;tick (Stopwatch);\n    printf (\"Stopped: %d\\n\", Stopwatch-&gt;milliseconds);\n    Stopwatch-&gt;reset (Stopwatch);\n    printf (\"Reset: %d\\n\", Stopwatch-&gt;milliseconds);    \n}\n</code></pre>\n\n<p>I've tried reading and following <a href=\"http://www.cs.rit.edu/~ats/books/ooc.pdf\" rel=\"noreferrer\">Object Oriented Programming with ANSI-C</a>, but can't wrap my head around how to structure my \"object\" so instead of </p>\n\n<pre><code>Stopwatch-&gt;tick(Stopwatch);\n</code></pre>\n\n<p>I can write</p>\n\n<pre><code>Stopwatch-&gt;tick();\n</code></pre>\n"}, {"tags": ["c", "r"], "comments": [{"owner": {"reputation": 661302, "user_id": 3732271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6e12042dc31b1ef27471482f9ff91f?s=128&d=identicon&r=PG&f=1", "display_name": "akrun", "link": "https://stackoverflow.com/users/3732271/akrun"}, "edited": false, "score": 3, "creation_date": 1441181743, "post_id": 32347904, "comment_id": 52569422, "body": "You may find some discussion <a href=\"http://stackoverflow.com/questions/28983292/is-the-apply-family-really-not-vectorized\">here</a> useful"}, {"owner": {"reputation": 86941, "user_id": 3001626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNguN.png?s=128&g=1", "display_name": "David Arenburg", "link": "https://stackoverflow.com/users/3001626/david-arenburg"}, "reply_to_user": {"reputation": 661302, "user_id": 3732271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6e12042dc31b1ef27471482f9ff91f?s=128&d=identicon&r=PG&f=1", "display_name": "akrun", "link": "https://stackoverflow.com/users/3732271/akrun"}, "edited": false, "score": 2, "creation_date": 1441181991, "post_id": 32347904, "comment_id": 52569582, "body": "As mentioned by @akrun, the term <i>vectorized</i> itself is not well defined. To me, this function is vectorized because it both runs a compiled C loop (which isn&#39;t such a big deal by itself), but it also doesn&#39;t run <code>eval(R_fcall,..</code> in each iteration, unlike R <code>*apply</code> of <code>for</code> loop functions which make its much more efficient. I&#39;m actually surprised you&#39;ve posted this question as I initially wrote the above linked question due a discussion under one of <i>your</i> answers on CV."}], "answers": [{"comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1441187573, "post_id": 32349826, "comment_id": 52573121, "body": "BTW: The final macro mod_iterate() looks wrong: two assignments to <code>i1</code> without intervening sequence point. (the same for i2)"}, {"owner": {"reputation": 5942, "user_id": 3986320, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/YB28g.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/3986320/tim"}, "edited": false, "score": 0, "creation_date": 1441188572, "post_id": 32349826, "comment_id": 52573834, "body": "Thanks for putting the puzzles together, now it gets clear for me."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1441188575, "post_id": 32349826, "comment_id": 52573838, "body": "But <i>why</i> assign twice? <code>i1 = ((i1+1) == n1) ? 0 : i1+1;</code> looks simpler to me."}], "tags": [], "owner": {"reputation": 42885, "user_id": 547331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39cb6add19f5b4f82c5152065d2065e7?s=128&d=identicon&r=PG", "display_name": "Martin Morgan", "link": "https://stackoverflow.com/users/547331/martin-morgan"}, "is_accepted": true, "score": 5, "last_activity_date": 1441187497, "last_edit_date": 1441187497, "creation_date": 1441187132, "answer_id": 32349826, "question_id": 32347904, "link": "https://stackoverflow.com/questions/32347904/how-does-r-base-c-code-handle-vectorization/32349826#32349826", "title": "How does R base C code handle vectorization?", "body": "<p>Actually, you're not quoting the code that defines the R function. In R we see</p>\n\n<pre><code>&gt; dexp\nfunction (x, rate = 1, log = FALSE) \n.Call(C_dexp, x, 1/rate, log)\n&lt;bytecode: 0x3582cf8&gt;\n&lt;environment: namespace:stats&gt;\n</code></pre>\n\n<p>which tells us that the dexp() function is defined in the stats package. With a little digging we see in the stats NAMESPACE</p>\n\n<pre><code>useDynLib(stats, .registration = TRUE, .fixes = \"C_\")\n</code></pre>\n\n<p>which tells us that the prefix C_ is added to the function name when exposed to R. So we're looking for a C function called <code>dexp</code> in the stats package. There are two relevant entries</p>\n\n<pre><code>init.c:147:    CALLDEF_MATH2_1(dexp),\ndistn.c:144:DEFMATH2_1(dexp)\n</code></pre>\n\n<p>the first is a macro making the C function available to R, the second is a macro defining the function. For the later, the macro is defined as</p>\n\n<pre><code>#define DEFMATH2_1(name) \\\n    SEXP do_##name(SEXP sa, SEXP sb, SEXP sI) { \\\n        return math2_1(sa, sb, sI, name); \\\n    }\n</code></pre>\n\n<p>which tells us to look for the math2_1 function, a little further up the file</p>\n\n<pre><code>static SEXP math2_1(SEXP sa, SEXP sb, SEXP sI, double (*f)(double, double, int))\n{\n    SEXP sy;\n    R_xlen_t i, ia, ib, n, na, nb;\n    double ai, bi, *a, *b, *y;\n    int m_opt;\n    int naflag;\n\n    if (!isNumeric(sa) || !isNumeric(sb))\n    error(R_MSG_NONNUM_MATH);\n\n    SETUP_Math2;\n    m_opt = asInteger(sI);\n\n    mod_iterate(na, nb, ia, ib) {\n//  if ((i+1) % NINTERRUPT) R_CheckUserInterrupt();\n    ai = a[ia];\n    bi = b[ib];\n    if_NA_Math2_set(y[i], ai, bi)\n    else {\n        y[i] = f(ai, bi, m_opt);\n        if (ISNAN(y[i])) naflag = 1;\n    }\n    }\n    FINISH_Math2;\n    return sy;\n} /* math2_1() */\n</code></pre>\n\n<p>That <code>mod_iterate()</code> call is actually another macro</p>\n\n<pre><code>#define mod_iterate(n1,n2,i1,i2) for (i=i1=i2=0; i&lt;n; \\\n    i1 = (++i1 == n1) ? 0 : i1,\\\n    i2 = (++i2 == n2) ? 0 : i2,\\\n    ++i)\n</code></pre>\n\n<p>and you can see, at least with the eye of faith, that the C code is implementing a loop, so the magic implied by the original question (that compact C code results in vectorized calculations) is not there -- it is an iteration at the C level.</p>\n\n<p><code>math2_1</code> takes as it's final argument a function, which in this case is the <code>dexp</code> quoted in the original question. This function is applied to each element in the iteration.</p>\n"}], "owner": {"reputation": 5942, "user_id": 3986320, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/YB28g.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/3986320/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 32349826, "answer_count": 1, "score": 3, "last_activity_date": 1441187497, "creation_date": 1441181607, "question_id": 32347904, "link": "https://stackoverflow.com/questions/32347904/how-does-r-base-c-code-handle-vectorization", "title": "How does R base C code handle vectorization?", "body": "<p>If we look at any function written in C in <a href=\"https://github.com/wch/r-source/blob/ed66b715221d2720f5b334470335635bada520b1/src/nmath/dexp.c\" rel=\"nofollow\">R base source</a> code we can see that the code is quite simple, e.g.</p>\n\n<pre><code>#include \"nmath.h\"\n#include \"dpq.h\"\n\ndouble dexp(double x, double scale, int give_log)\n{\n#ifdef IEEE_754\n    /* NaNs propagated correctly */\n    if (ISNAN(x) || ISNAN(scale)) return x + scale;\n#endif\n    if (scale &lt;= 0.0) ML_ERR_return_NAN;\n\n    if (x &lt; 0.)\n    return R_D__0;\n    return (give_log ?\n        (-x / scale) - log(scale) :\n        exp(-x / scale) / scale);\n}\n</code></pre>\n\n<p>While the function is vectorized if called from R:</p>\n\n<pre><code>dexp(rep(1, 5), 1:2)\n## [1] 0.3678794 0.2706706 0.3678794 0.2706706 0.3678794\n</code></pre>\n\n<p>How is it so? What makes it properly vectorized?</p>\n"}, {"tags": ["c++", "c", "dev-c++"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1441181476, "post_id": 32347831, "comment_id": 52569275, "body": "Is it the IDE (Dev-C++) that crashes, or your program? If it&#39;s your program then you have two different problems that should be asked in two different questions."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1441182874, "post_id": 32347831, "comment_id": 52570117, "body": "Dev-C++ is not a good IDE, recomendation: move to CodeBlocks or Visual Studio?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2487382"}, "edited": false, "score": 0, "creation_date": 1441183026, "post_id": 32347831, "comment_id": 52570209, "body": "Or Clion. Nobody ever suggesting Clion."}, {"owner": {"reputation": 1554, "user_id": 4499919, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n2u5L.jpg?s=128&g=1", "display_name": "udit043", "link": "https://stackoverflow.com/users/4499919/udit043"}, "reply_to_user": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1441183775, "post_id": 32347831, "comment_id": 52570688, "body": "@DavidHaim Why Dev-C++ is not good ?"}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 2, "creation_date": 1441184297, "post_id": 32347831, "comment_id": 52570978, "body": "for many reasons. first of all, it have never being stable, every version has its bugs. second of all, you don&#39;t get important features like code completion/intellisense. third of all, the error messages you get in compile time are ugly as hell."}], "answers": [{"tags": [], "owner": {"reputation": 1554, "user_id": 4499919, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n2u5L.jpg?s=128&g=1", "display_name": "udit043", "link": "https://stackoverflow.com/users/4499919/udit043"}, "is_accepted": true, "score": 0, "last_activity_date": 1441183727, "creation_date": 1441183727, "answer_id": 32348593, "question_id": 32347831, "link": "https://stackoverflow.com/questions/32347831/dev-c-4-9-9-2-project-options-not-working/32348593#32348593", "title": "Dev-C++ 4.9.9.2 Project Options not working", "body": "<p>Its Dev-C++ problem , update it . <a href=\"http://sourceforge.net/p/orwelldevcpp/tickets/82/\" rel=\"nofollow\">Details</a></p>\n"}], "owner": {"reputation": 15, "user_id": 4684051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f791a51cd1998bb27bffb6e2d1f3bf12?s=128&d=identicon&r=PG&f=1", "display_name": "Batnyam Baasanjav", "link": "https://stackoverflow.com/users/4684051/batnyam-baasanjav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 32348593, "answer_count": 1, "score": 0, "last_activity_date": 1441183727, "creation_date": 1441181344, "last_edit_date": 1441182775, "question_id": 32347831, "link": "https://stackoverflow.com/questions/32347831/dev-c-4-9-9-2-project-options-not-working", "title": "Dev-C++ 4.9.9.2 Project Options not working", "body": "<p>I just created new console application project by <code>Dev-C++ 4.9.9.2</code> . But Project Options(Alt+P) not working and <code>Error: Access violation at address 0012F64B</code>. Write of address 0012F64B. How to fix this problem. </p>\n"}, {"tags": ["c", "pic", "mplab"], "comments": [{"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 1, "creation_date": 1441180033, "post_id": 32347331, "comment_id": 52568420, "body": "why should <code>void</code> prevent a <code>for</code> loop?"}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 4, "creation_date": 1441180081, "post_id": 32347331, "comment_id": 52568452, "body": "And if you don&#39;t show us your <code>for</code> variant of the <code>decode()</code> function, we cannot tell what&#39;s wrong."}, {"owner": {"reputation": 579, "user_id": 5226749, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Ta78V.png?s=128&g=1", "display_name": "Vito Royeca", "link": "https://stackoverflow.com/users/5226749/vito-royeca"}, "edited": false, "score": 2, "creation_date": 1441180199, "post_id": 32347331, "comment_id": 52568520, "body": "Where did you call the <code>decode</code> function?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1441180293, "post_id": 32347331, "comment_id": 52568567, "body": "<code>int result[5]; &#47;&#47; can store four value</code>...why four?"}, {"owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "reply_to_user": {"reputation": 579, "user_id": 5226749, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Ta78V.png?s=128&g=1", "display_name": "Vito Royeca", "link": "https://stackoverflow.com/users/5226749/vito-royeca"}, "edited": false, "score": 0, "creation_date": 1441180490, "post_id": 32347331, "comment_id": 52568678, "body": "@jovit.royeca I have update the code. calling the <code>decode</code> @SouravGhosh , because, i decide to store four value. I think five value also can store"}, {"owner": {"reputation": 579, "user_id": 5226749, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Ta78V.png?s=128&g=1", "display_name": "Vito Royeca", "link": "https://stackoverflow.com/users/5226749/vito-royeca"}, "edited": false, "score": 0, "creation_date": 1441181226, "post_id": 32347331, "comment_id": 52569127, "body": "What is the data type of <code>rxbuf</code> ? Maybe you are passing a wrong data type to <code>decode</code> ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441183023, "post_id": 32347331, "comment_id": 52570208, "body": "You probably want to add a check for NULL on the return value of each strstr call."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1441183292, "post_id": 32347331, "comment_id": 52570376, "body": "Anyway this is just incoherent ramblings... In the headline you ask how to insert a for loop. Then in the question you claim that you use a loop in the decode function, even though none is present. And then you ask about a compiler error which is not present in the code. And then finally you accept an answer related to parameter passing."}], "answers": [{"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 0, "last_activity_date": 1441181602, "creation_date": 1441181602, "answer_id": 32347900, "question_id": 32347331, "link": "https://stackoverflow.com/questions/32347331/how-to-insert-for-loop-in-void-function/32347900#32347900", "title": "How to insert for loop in void function?", "body": "<p><code>result</code> in main and <code>result</code> in <code>decode</code> are two different variables.</p>\n\n<p>If you want <code>decode</code> to know about the <code>result</code> from <code>main</code> you should pass it as a parameter:</p>\n\n<pre><code>void decode(unsigned char* msg, int result[5])\n{\n    // Remove declaration of result \n    // Keep the rest of the code\n}\n\nint main()\n{\n  /* other code */\n            decode (rxbuf, result); // calling decode funtion\n  /* other code */\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 32347900, "answer_count": 1, "score": -5, "last_activity_date": 1441181602, "creation_date": 1441179864, "last_edit_date": 1441180365, "question_id": 32347331, "link": "https://stackoverflow.com/questions/32347331/how-to-insert-for-loop-in-void-function", "title": "How to insert for loop in void function?", "body": "<p>is there possible to insert <code>for loop</code> in <code>void function</code> ? </p>\n\n<pre><code>void decode(unsigned char* msg)\n{\n\n    int result[5];// can store our value\n    unsigned char lala[50];\n\n    if (strstr(msg, \"UI01?\") != msg) // write in Hyperterminal\n    {\n        sprintf(lala, \"UI01 %d \\r\\n\", result[0]); // UIO1 ADC Value\n        sendString(lala);\n    }\n    else if (strstr(msg, \"UI02?\") != msg) // write in Hyperterminal\n    {\n        sprintf(lala, \"UI02 %d \\r\\n\", result[1]); // UIO2 ADC Value\n        sendString(lala);\n    }\n    else if (strstr(msg, \"UI03?\") != msg) // write in Hyperterminal\n    {\n        sprintf(lala, \"UI02 %d \\r\\n\", result[2]); // UIO3 ADC Value\n        sendString(lala);\n    }\n    else if (strstr(msg, \"UI04?\") != msg) // write in Hyperterminal\n    {\n        sprintf(lala, \"UI02 %d \\r\\n\", result[3]); // UIO4 ADC Value\n        sendString(lala);\n    }\n}\n\n\nint main()\n{\n\n    int result[5]; // can store four value\n    int a = 0;     // start from UI0-UI4\n\n    while (1)\n\n    {\n        for (a = 0; a &lt; 5; a++)\n        {\n            AD1CHS0bits.CH0SA = a;  // UI0-UI4\n            AD1CHS0bits.CH0NA = 0;  // Vreferences as channel 0 -ve input\n            AD1CON1bits.ADON = 1;   // 1 = A/D Converter module is operating\n            AD1CON1bits.SAMP = 1;   // sapling mode\n            __delay32(50);          // delay after sampling\n            AD1CON1bits.SAMP = 0;   //sampling bit  \n            while (!AD1CON1bits.DONE);\n            result[a] = ADC1BUF0;   // have 4 result\n        }\n    }\n\n    if (U1STAbits.URXDA == 1) //check if data avilbe\n     {\n         rxbuf [len] = U1RXREG;\n         if (rxbuf[len]== '\\r')//press enter\n         {\n             sendChar (rxbuf[len]);\n             sendChar ('\\n'); //new line\n             decode (rxbuf); // calling decode funtion\n             len = 0 ;\n         }\n         else\n         {\n             sendChar (rxbuf[len]);\n             len++;\n         }         \n     }\n}\n</code></pre>\n\n<p>from the code above, in <code>void decode</code> enable the code <code>UIO1?</code> is type in Hyperterminal,  it will reply ADC value. Followed by <code>UIO2?</code> until <code>UIO4?</code> .</p>\n\n<p>in the <code>while(1)</code> loop, the code is used to scan <code>UIO1</code> until <code>UIO4</code>. Actually <code>UIO1</code> until <code>UIO4</code> have analog value to be read in digital value. I am using <code>for loop</code>, because it look more simple.</p>\n\n<p>The problem is, in the <code>void decode</code> loop, I got error: subscripted value is neither array nor pointer . How to read the <code>result</code> value ?</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 532, "user_id": 1835951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b6a1bc568a2e7da75c55447b84f897f?s=128&d=identicon&r=PG", "display_name": "NiBZ", "link": "https://stackoverflow.com/users/1835951/nibz"}, "edited": false, "score": 4, "creation_date": 1441179941, "post_id": 32347252, "comment_id": 52568363, "body": "Is <code>power</code> a <code>float</code> or a <code>double</code> ? If it is a float, you need to use <code>%f</code> instead of <code>%lf</code> for printing it."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1441180145, "post_id": 32347252, "comment_id": 52568488, "body": "post a self-contained example."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 532, "user_id": 1835951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b6a1bc568a2e7da75c55447b84f897f?s=128&d=identicon&r=PG", "display_name": "NiBZ", "link": "https://stackoverflow.com/users/1835951/nibz"}, "edited": false, "score": 1, "creation_date": 1441180193, "post_id": 32347252, "comment_id": 52568515, "body": "@NiBZ, no. <code>l</code> has <i>no</i> effect on <code>f</code> or any other floating point specifier, becasue floats are upgraded to doubles automagically."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1441180443, "post_id": 32347252, "comment_id": 52568660, "body": "What is the type of <code>ex</code>? If it is a <code>long</code> you need format specifier <code>%ld</code> to print it."}, {"owner": {"reputation": 7842, "user_id": 8715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8495abb9d44de2866b83a6d164948e0c?s=128&d=identicon&r=PG", "display_name": "AntonioCS", "link": "https://stackoverflow.com/users/8715/antoniocs"}, "reply_to_user": {"reputation": 532, "user_id": 1835951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b6a1bc568a2e7da75c55447b84f897f?s=128&d=identicon&r=PG", "display_name": "NiBZ", "link": "https://stackoverflow.com/users/1835951/nibz"}, "edited": false, "score": 0, "creation_date": 1441218069, "post_id": 32347252, "comment_id": 52593609, "body": "@NiBZ Thanks. Before reading your comment I did try %f. Don&#39;t know why I didn&#39;t try %f in the first place. I thought that because power was a double I needed to use a different specifier, but no, a simpler %f would have done it. Thanks!"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1441237589, "post_id": 32347252, "comment_id": 52602149, "body": "Antonio, the presence of the <code>l</code> (ell) should have zero effect on the treatment of a double, ISO C specifically states that the <code>l</code> modifier <code>has no effect on a following a, A, e, E, f, F, g, or G conversion specifier</code>. If removing the <code>l</code> was the only thing you changed, your implementation of C is broken."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1441248695, "post_id": 32347252, "comment_id": 52604570, "body": "Note that <code>pow</code> will suffer from floating point rounding. Bit shifting will give you exact values."}], "answers": [{"comments": [{"owner": {"reputation": 7842, "user_id": 8715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8495abb9d44de2866b83a6d164948e0c?s=128&d=identicon&r=PG", "display_name": "AntonioCS", "link": "https://stackoverflow.com/users/8715/antoniocs"}, "edited": false, "score": 0, "creation_date": 1441217620, "post_id": 32347528, "comment_id": 52593384, "body": "@paxdiable I have added the types"}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1441237971, "last_edit_date": 1495542580, "creation_date": 1441180447, "answer_id": 32347528, "question_id": 32347252, "link": "https://stackoverflow.com/questions/32347252/c-pow-function-printing-wrong-value-but-function-returns-correct-results/32347528#32347528", "title": "c pow function printing wrong value but function returns correct results", "body": "<p>You should first check the type of <code>power</code>, which you haven't shown.</p>\n\n<p>Disagreements between format specifiers and the variables you pass to <code>printf</code> are undefined behaviour, which is why:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n    int i = 42;\n    double d = 3.14159;\n    printf(\"POWER::: %lf\\n\", i);\n    printf(\"POWER::: %lf\\n\", d);\n    return 0;\n}\n</code></pre>\n\n<p>can give you:</p>\n\n<pre><code>POWER::: 0.000000\nPOWER::: 3.141590\n</code></pre>\n\n<p>with impunity.</p>\n\n<p>For a more detailed reason <em>why</em> these incorrect results can happen, see <a href=\"https://stackoverflow.com/questions/2424528/printf-of-a-size-t-variable-with-lld-ld-and-d-type-identifiers/2424554#2424554\">this answer</a>. It doesn't specifically cover floating point values but the theory is the same. If you tell <code>printf</code> to expect one thing then give it a totally different thing, you can hardly complain if it becomes confused :-)</p>\n\n<p>If <code>power</code> is an integral type, you need to either change it to a non-integral type, or change the format specifier. One way or another, they should match.</p>\n\n<hr>\n\n<p>In any case, you don't need to resort to floating point at all for this task provided you have a 32-bit integer (and the color codes are all 24-bit). You can just use code like:</p>\n\n<pre><code>for (int i = strlen(hexString), mult = 1; i &gt; 0; i--, mult *= 16) {\n    c = hexString[i - 1];\n    printf(\"MULT::: %d\\n\", mult);       \n    num += convertHexCharToDec(&amp;c) * mult;\n}\n</code></pre>\n"}], "owner": {"reputation": 7842, "user_id": 8715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8495abb9d44de2866b83a6d164948e0c?s=128&d=identicon&r=PG", "display_name": "AntonioCS", "link": "https://stackoverflow.com/users/8715/antoniocs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 32347528, "answer_count": 1, "score": 1, "last_activity_date": 1441237971, "creation_date": 1441179660, "last_edit_date": 1441217977, "question_id": 32347252, "link": "https://stackoverflow.com/questions/32347252/c-pow-function-printing-wrong-value-but-function-returns-correct-results", "title": "c pow function printing wrong value but function returns correct results", "body": "<p>I have done a little function that converts hex colour values to rgb values in c.</p>\n\n<p>The function is working correctly, if I pass it in  \"#008080\" I get:</p>\n\n<pre><code>HEX: #008080 RGB: 0, 128, 128\n</code></pre>\n\n<p>The issue I am having is when I am trying to print the value returned by pow() (for debugging purposes) this is what I get:</p>\n\n<pre><code>EX::: 0\nPOWER::: 0.000000\nEX::: 1\nPOWER::: 0.000000\nEX::: 0\nPOWER::: 0.000000\nEX::: 1\nPOWER::: 0.000000\nEX::: 0\nPOWER::: 0.000000\nEX::: 1\nPOWER::: 0.00000\n</code></pre>\n\n<p>This is the code that outputs this:</p>\n\n<pre><code>int num = 0;\nchar c;\ndouble power;\n\nfor (int i = strlen(hexString), ex = 0; i &gt; 0; i--, ex++) {\n    c = hexString[i - 1];\n    power = pow(16.0, ex);\n    printf(\"EX::: %d\\n\", ex);\n    printf(\"POWER::: %lf\\n\", power);       \n    num += convertHexCharToDec(&amp;c) * power;\n}\n</code></pre>\n\n<p>If I run this with GDB I can see that the power variable has the values of 1 and then 16.</p>\n\n<p>What is the problem here? The function outputs the correct value, I can see the correct value in the debugger so why can't I see the correct values??</p>\n\n<p>Thanks</p>\n\n<p>Edit: \nAdded power variable type</p>\n\n<p>Edit2:\nAfter messing a bit more with printfs specifiers I discovered that I should have used %f specifier.</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["c", "performance"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 4, "creation_date": 1441179493, "post_id": 32347004, "comment_id": 52568091, "body": "I&#39;d go with <code>(width + height) * 2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1441184170, "post_id": 32347060, "comment_id": 52570900, "body": "but floating-point math isn&#39;t associative like normal math, so many times the compiler can&#39;t optimize those out"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1441187408, "post_id": 32347060, "comment_id": 52572999, "body": "You have to use <code>-ffast-math</code> if you want gcc to do optimizations that require changing the order of FP operations."}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": true, "score": 7, "last_activity_date": 1441179021, "creation_date": 1441179021, "answer_id": 32347060, "question_id": 32347004, "link": "https://stackoverflow.com/questions/32347004/performance-of-4-times-an-add-operation-vs-2-times-a-multiplication-operation-a/32347060#32347060", "title": "Performance of 4 Times an Add Operation vs. 2 Times a Multiplication Operation Added Together in C", "body": "<p>The compiler will figure that out, and use whatever is fastest. Possibly even compute <code>perimeter</code> at compile time.</p>\n\n<p>You should concentrate on writing the most readable code. That helps both humans and the compiler to understand your intentions.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 5, "last_activity_date": 1441193000, "last_edit_date": 1441193000, "creation_date": 1441188122, "answer_id": 32350179, "question_id": 32347004, "link": "https://stackoverflow.com/questions/32347004/performance-of-4-times-an-add-operation-vs-2-times-a-multiplication-operation-a/32350179#32350179", "title": "Performance of 4 Times an Add Operation vs. 2 Times a Multiplication Operation Added Together in C", "body": "<p>If you want to see what a compiler will do with something, don't give it compile-time-constant data.  Also, don't do it in <code>main</code>, because gcc disables some optimizations for \"cold\" functions, and <code>main</code> is automatically marked that way.</p>\n\n<p>I tried it on <a href=\"https://goo.gl/S7IP7O\" rel=\"nofollow\">godbolt</a> to see if different compiler versions made a difference.</p>\n\n<pre><code>double f1(double width, double height) {\n    return width + width + height + height;\n    // compiles to ((width+width) + height) + height\n    // 3 instructions, but can't happen in parallel.  latency=12c(Skylake), 9c(Haswell)\n    // with -march=haswell (implying -mfma),\n    // compiles to fma(2.0*width + height) + height, with 2.0 as a memory operand from rodata.\n}\n\ndouble f2(double width, double height) {\n    return width * 2 + height * 2;\n    // compiles to (width+width) + (height+height)\n    // 3 instructions, with the first two independent.  Latency=8c(Skylake), 7c(Haswell)\n    // with -mfma: compiles to weight=+weight;  fma(2.0*height + weight)\n}\n\ndouble f3(double width, double height) {\n    return (height + width) * 2;\n    // compiles to 2 instructions: tmp=w+h. tmp+=tmp\n    // latency=8(Skylake), 6(Haswell)\n}\n\ndouble f4(double width, double height) {\n    return (width + height) * 2;\n    // compiles to 3 instructions, including a move because gcc (even 5.2) is dumb and generates the temporary in the wrong register.\n    // clang is fine and does the same as for f3()\n}\n</code></pre>\n\n<p>With <code>-ffast-math</code>, they all generate 2 instructions: <code>tmp=(width+height); tmp+=tmp;</code>.  gcc 4.9.2, 5.1, and 5.2 all generate an extra <code>mov</code> in many of the sequences, even with -ffast-math.  They don't have this problem with 3-operand AVX versions, of course, but AVX is too new to use without checking that it's supported.  (Even Silvermont doesn't support it.)</p>\n"}], "owner": {"reputation": 850, "user_id": 4434334, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-UG-DyV6Tsms/AAAAAAAAAAI/AAAAAAAAAok/o621Vw1NXU8/photo.jpg?sz=128", "display_name": "Tim Visser", "link": "https://stackoverflow.com/users/4434334/tim-visser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 32347060, "answer_count": 2, "score": 2, "last_activity_date": 1441193000, "creation_date": 1441178842, "question_id": 32347004, "link": "https://stackoverflow.com/questions/32347004/performance-of-4-times-an-add-operation-vs-2-times-a-multiplication-operation-a", "title": "Performance of 4 Times an Add Operation vs. 2 Times a Multiplication Operation Added Together in C", "body": "<p>In ANSI C, which of the following is faster, and why? Or doesn't it make a difference because it will be compiled to the same?</p>\n\n<pre><code>int main(void) {\n    double width = 4.5678;\n    double height = 6.7890;\n\n    double perimeter = width + width + height + height;\n\n    return 0;\n}\n</code></pre>\n\n<p>Or the following:</p>\n\n<pre><code>int main(void) {\n    double width = 4.5678;\n    double height = 6.7890;\n\n    double perimeter = width * 2 + height * 2;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "combinatorics"], "comments": [{"owner": {"reputation": 181, "user_id": 2526200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000504414583/picture?type=large", "display_name": "SJPRO", "link": "https://stackoverflow.com/users/2526200/sjpro"}, "edited": false, "score": 0, "creation_date": 1441178935, "post_id": 32346908, "comment_id": 52567739, "body": "(maxp+i) is about not bothering to enter the for loop if the current index plus the maximum allowed is equal to or exceeds the maximum allowed."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441181399, "post_id": 32346908, "comment_id": 52569239, "body": "I really do not understand what is your problem. The posted code doesn&#39;t remove element from array. It seems to count (seq) how many sequence with a diff of 1 there are inside of array..."}, {"owner": {"reputation": 181, "user_id": 2526200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000504414583/picture?type=large", "display_name": "SJPRO", "link": "https://stackoverflow.com/users/2526200/sjpro"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441184622, "post_id": 32346908, "comment_id": 52571160, "body": "Yes, my mistake. The routine returns 1 if the combinatoric sequence needs to be &quot;deleted&quot; . i am piping the output to a file and I need to exclude such combinations."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441184830, "post_id": 32346908, "comment_id": 52571294, "body": "Indeed, your code return 1 <code>if (seq &gt;= maxp)</code>. Then return 1 each time a sequenze of n, n+1, n+2..... is greater then max seq num."}, {"owner": {"reputation": 181, "user_id": 2526200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000504414583/picture?type=large", "display_name": "SJPRO", "link": "https://stackoverflow.com/users/2526200/sjpro"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441185073, "post_id": 32346908, "comment_id": 52571419, "body": "Yes but the code is not working properly, that is the issue.  With a maxp of 1 in a set of 10 numbers and a subset of 9 (which generates 10 combinations without repetition)  I get  0,2,3,4,5,6,7,8,9  included and it must be excluded because  comparing 0 and 2 is ok, no n and n+1 comparing 2 and 3 is n and n+1 but it is also ok because I allow 1 (maxp)  but then in 3 and 4 the routine should end and return 1 excluding that combination but it does not.  (the code seems to check only position 0 and 1 of the array in that case -that is why the fprinft)"}, {"owner": {"reputation": 181, "user_id": 2526200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000504414583/picture?type=large", "display_name": "SJPRO", "link": "https://stackoverflow.com/users/2526200/sjpro"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441186360, "post_id": 32346908, "comment_id": 52572320, "body": "I added some code that it seems to solve the issue but i am not sure it does it the right way (based on the fprintf added for control)  The code is else seq = 0;  (after the first if structure  The results that the program yield seem to be correct (2 tests only) but I am not sure the code is executing the way I want to yield that result."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441186535, "post_id": 32346908, "comment_id": 52572443, "body": "As I answered case 3,4 is not checked because of the inner loop is not executed form <code>i = 1</code>. It just execute 1 time for <code>i=0</code>."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1441189602, "post_id": 32346908, "comment_id": 52574447, "body": "btw you are hiding <code>j</code>, you have it declared twice in <code>todel</code>."}, {"owner": {"reputation": 181, "user_id": 2526200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000504414583/picture?type=large", "display_name": "SJPRO", "link": "https://stackoverflow.com/users/2526200/sjpro"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441429800, "post_id": 32346908, "comment_id": 52687213, "body": "@LPs I think I solved the issue, the program is working quite well now, thanks for the help. On a side note, not to open another discussion, I have made a simple program to pipe to it from the files generated by the prev program which I can not open into memory since some are 200+ GB in size and in order to run things against the generated things I must pipe, but the program I made reads from stdin, stores into a char[100], do stuff and prints it back to stdout, the thing is I am using the condition while str != NULL . Continues .."}, {"owner": {"reputation": 181, "user_id": 2526200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000504414583/picture?type=large", "display_name": "SJPRO", "link": "https://stackoverflow.com/users/2526200/sjpro"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1441429879, "post_id": 32346908, "comment_id": 52687226, "body": "@LPs the program executes fine untile the last line which then keeps repeating infinitely. I think I should check for eof but the compiler throws a mismatch comparing str to eof. What can/should I do ? . Thanks in advance."}], "owner": {"reputation": 181, "user_id": 2526200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000504414583/picture?type=large", "display_name": "SJPRO", "link": "https://stackoverflow.com/users/2526200/sjpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441185652, "creation_date": 1441178548, "last_edit_date": 1441179296, "question_id": 32346908, "link": "https://stackoverflow.com/questions/32346908/comparing-elements-of-an-array-in-c-to-proceed-in-the-removal-of-element", "title": "Comparing elements of an array in C to proceed in the removal of element", "body": "<p>I have a problem that I can not figure out (it is probably an easy solution but I can not see it).</p>\n\n<p>The thing is, I have a program that generates all the possible combinations of numbers. The program ask for the size of the set and size of the subsets and generates all the possible combinations accordingly. So far so good ... now ...</p>\n\n<p>I want to write some routines that check for some things in order to eliminate those combinations, one of those routines is the one who checks the array looking to exclude the sequences that exceed a given number of sequenced numbers, for this the program asks for the maximum of numbers in sequences allowed. For example</p>\n\n<ul>\n<li>Size of the set ? : 10 (stores in n)</li>\n<li>size of the subset?: 10 (stores in k)</li>\n<li>maximum of seq num: 10 (stores in maxp)</li>\n</ul>\n\n<p>the array is called <code>comb[]</code> <code>(integer)</code> it is initialized as</p>\n\n<pre><code>for (i = 0; i &lt; k; i++)\n        comb[i] = i;\n</code></pre>\n\n<p>but I have trouble with the routine that exludes certain combinations. The routine is</p>\n\n<pre><code>int todel (int comb[], int k)\n{\n\n    int i, j, seq;\n\n    for (i = 0, seq = 0; (i+maxp) &lt; k; i++)\n    {\n        int j = 0;\n\n        for (j = i; j &lt; maxp; j++)\n        {\n            fprintf(stderr, \"checkin comb %d with comb %d\\n\", j, j+1);\n            if (comb[j] == (comb[j+1] - 1))\n            {\n                seq++;\n            }\n            if (seq &gt;= maxp) return 1;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>if I have a set of 10 a subset of 10 and a max allowed of 10, the program does not need to exlude anything.</p>\n\n<p>But for a set 10 subset 9 and a max allowed of 1 the program should exclude all 10 combinations. But as it is the program is allowing the following combination</p>\n\n<blockquote>\n  <p>0,2,3,4,5,6,7,8,9</p>\n</blockquote>\n\n<p>and it should exclude it because 0,2 does not match the criteria, 2,3 and all thw following does.</p>\n\n<p>Another thing is that if I set the maximum allowed to 0 it takes all combinations as valid instead of none.</p>\n\n<p>I know the fix should not be very hard and I am missing something really dumb.</p>\n\n<p>I hope some insight from you (probably insults too).</p>\n\n<p>Thank you !</p>\n"}, {"tags": ["c", "networking", "linux-kernel"], "comments": [{"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1441178688, "post_id": 32346870, "comment_id": 52567575, "body": "In what source did you &quot;discover&quot; calls to those functions...?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1441178702, "post_id": 32346870, "comment_id": 52567585, "body": "You <i>do</i> have the ultimate documentation for the functions: The source. Read the source and try to understand what they do that way instead."}, {"owner": {"reputation": 1, "user_id": 5291313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fda63318858b0e540aefe8e0993f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "Rumman Sadhit", "link": "https://stackoverflow.com/users/5291313/rumman-sadhit"}, "edited": false, "score": 0, "creation_date": 1441179125, "post_id": 32346870, "comment_id": 52567866, "body": "I discovered those functions in Linux Kernel Networking - Implementation and Theory this book.I searched them in google for documentation"}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1441179617, "post_id": 32346870, "comment_id": 52568174, "body": "Here is a cross-ref for the first function <a href=\"http://lxr.free-electrons.com/ident?i=ip_route_input_noref\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/ident?i=ip_route_input_noref</a>.  Here is its link to the actual source code:  <a href=\"http://lxr.free-electrons.com/source/net/ipv4/route.c#L1843\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/net/ipv4/route.c#L1843</a>   as @JoachimPileborg recommended, you can read the &quot;ultimate&quot; documentation to determine what it does."}], "owner": {"reputation": 1, "user_id": 5291313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fda63318858b0e540aefe8e0993f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "Rumman Sadhit", "link": "https://stackoverflow.com/users/5291313/rumman-sadhit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441178629, "creation_date": 1441178428, "last_edit_date": 1441178629, "question_id": 32346870, "link": "https://stackoverflow.com/questions/32346870/what-does-ip-route-input-noref-ip-check-mc-rcu-and-ip-route-input-mc-fun", "title": "what does ip_route_input_noref() , ip_check_mc_rcu() and ip_route_input_mc() functions do?", "body": "<p>Recently i was researching Linux networking subsystem. There i found these functions <code>ip_route_input_noref()</code> , <code>ip_check_mc_rcu()</code> and <code>ip_route_input_mc()</code>.I searched a lot but did not find any documentation about these functions.Would you please tell me what does these functions actually do.</p>\n"}, {"tags": ["java", "c", "int", "bitwise-operators", "unsigned-char"], "comments": [{"owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "edited": false, "score": 0, "creation_date": 1441178472, "post_id": 32346819, "comment_id": 52567438, "body": "A char is a 16bit data type. Why are you using byte? Also, I think your c example conversion is undefined and will have different results for different integer representations."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 4, "creation_date": 1441178494, "post_id": 32346819, "comment_id": 52567452, "body": "What&#39;s up with that weird code? It&#39;s just <code>b = a &amp; 0xFF</code>"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1441178615, "post_id": 32346819, "comment_id": 52567531, "body": "Note that <code>unsigned char</code> isn&#39;t guaranteed to be any particular size."}, {"owner": {"reputation": 7193, "user_id": 1856325, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ZO1bm.png?s=128&g=1", "display_name": "FreeNickname", "link": "https://stackoverflow.com/users/1856325/freenickname"}, "reply_to_user": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "edited": false, "score": 0, "creation_date": 1441179120, "post_id": 32346819, "comment_id": 52567861, "body": "@matt, it isn&#39;t (in C). <a href=\"http://stackoverflow.com/questions/881894/is-char-guaranteed-to-be-exactly-8-bit-long\">discussion on SO</a>. It is guaranteed to be one byte. It will be 16 bit long, if one byte on your machine is 16 bits long. But it is a weird machine you have."}, {"owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "reply_to_user": {"reputation": 7193, "user_id": 1856325, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ZO1bm.png?s=128&g=1", "display_name": "FreeNickname", "link": "https://stackoverflow.com/users/1856325/freenickname"}, "edited": false, "score": 0, "creation_date": 1441179878, "post_id": 32346819, "comment_id": 52568323, "body": "@FreeNickname Sorry, I was refering to java. A <a href=\"http://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.2.1\" rel=\"nofollow noreferrer\">java char</a> is 16 bits. That was my second point though, that the casting that OP is asking about is not uniquely defined."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1441185403, "post_id": 32346819, "comment_id": 52571640, "body": "In case you missed the implications of my previous comment, it means the conversion is not guaranteed to yield <code>46</code>."}], "answers": [{"comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1441178671, "post_id": 32346933, "comment_id": 52567561, "body": "<code>(a ^ 0xFFFFFFFF) + 1</code> is a funny way of writing <code>-a</code>"}, {"owner": {"reputation": 192, "user_id": 4781985, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PaV6eTJ0J9o/AAAAAAAAAAI/AAAAAAAACXs/c4iYOw0LXzs/photo.jpg?sz=128", "display_name": "Maks", "link": "https://stackoverflow.com/users/4781985/maks"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1441179158, "post_id": 32346933, "comment_id": 52567889, "body": "I just wanted to show what exactly hides behind &quot;-&quot; (negative) operation. That&#39;s not nice that unsigned primitives are not supported by java"}], "tags": [], "owner": {"reputation": 192, "user_id": 4781985, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PaV6eTJ0J9o/AAAAAAAAAAI/AAAAAAAACXs/c4iYOw0LXzs/photo.jpg?sz=128", "display_name": "Maks", "link": "https://stackoverflow.com/users/4781985/maks"}, "is_accepted": false, "score": -1, "last_activity_date": 1441178857, "last_edit_date": 1441178857, "creation_date": 1441178622, "answer_id": 32346933, "question_id": 32346819, "link": "https://stackoverflow.com/questions/32346819/in-java-how-to-simulate-converting-negative-numbers-casted-by-unsigned-char-in/32346933#32346933", "title": "In Java,how to simulate &quot;converting negative numbers casted by unsigned char in c&quot;?", "body": "<pre><code>int a = -1234;\n    byte b = a &lt; 0 ? (byte) -((byte) ((a ^ 0xFFFFFFFF) + 1)) : (byte)a;\n\n    System.out.println(b);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1170, "user_id": 4916015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6DCah.jpg?s=128&g=1", "display_name": "Riddhesh Sanghvi", "link": "https://stackoverflow.com/users/4916015/riddhesh-sanghvi"}, "is_accepted": true, "score": 1, "last_activity_date": 1441180351, "last_edit_date": 1441180351, "creation_date": 1441178682, "answer_id": 32346961, "question_id": 32346819, "link": "https://stackoverflow.com/questions/32346819/in-java-how-to-simulate-converting-negative-numbers-casted-by-unsigned-char-in/32346961#32346961", "title": "In Java,how to simulate &quot;converting negative numbers casted by unsigned char in c&quot;?", "body": "<pre><code>int a = -1234;\n\na = (byte) a &amp; 0xFF;\nSystem.out.println(a); \n//Output: 46\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1441180333, "creation_date": 1441180333, "answer_id": 32347491, "question_id": 32346819, "link": "https://stackoverflow.com/questions/32346819/in-java-how-to-simulate-converting-negative-numbers-casted-by-unsigned-char-in/32347491#32347491", "title": "In Java,how to simulate &quot;converting negative numbers casted by unsigned char in c&quot;?", "body": "<p>It isn't simulate, it is called casting.</p>\n\n<pre><code>char a = (char)-1234;\nbyte b = (byte)-1234;\nint unsigned = b&gt;=0?b:128 - b;\nSystem.out.println((int)a + \", \" + Byte.toUnsignedInt(b) + \", \" + unsigned);\n//output\n//64302, 46, 46\n</code></pre>\n"}], "owner": {"reputation": 7341, "user_id": 4822120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cb73b37b475eb2c8c710875ac9d842ba?s=128&d=identicon&r=PG&f=1", "display_name": "ggrr", "link": "https://stackoverflow.com/users/4822120/ggrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 32346961, "answer_count": 3, "score": 0, "last_activity_date": 1502354759, "creation_date": 1441178277, "last_edit_date": 1502354759, "question_id": 32346819, "link": "https://stackoverflow.com/questions/32346819/in-java-how-to-simulate-converting-negative-numbers-casted-by-unsigned-char-in", "title": "In Java,how to simulate &quot;converting negative numbers casted by unsigned char in c&quot;?", "body": "<p>for example, in c, converting -1234 to unsigned char would become 46:</p>\n\n<pre><code>int main(){\n    int a=-1234;\n    unsigned char b=a;\n    printf(\"%d\\n\",b);\n    return 0;\n};\n</code></pre>\n\n<p>I want to convert the code to java version, now the code is:</p>\n\n<pre><code>public class Test{\n    public static void main(String[] args){\n        int a=-1234;\n        int b=(a%(Byte.MAX_VALUE-Byte.MIN_VALUE+1))+(a&lt;0?(Byte.MAX_VALUE-Byte.MIN_VALUE+1):0);\n        System.out.println(b);\n    }\n}\n</code></pre>\n\n<p>Is there any faster (or simpler) way to do this (e.g.:bitwise operation)?</p>\n"}, {"tags": ["c", "arm", "c-preprocessor", "armcc"], "comments": [{"owner": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "edited": false, "score": 0, "creation_date": 1441178891, "post_id": 32346812, "comment_id": 52567708, "body": "What compiler errors do you get when you try to compile code using the PACKSTRUCT macro? What compiler are you using?"}, {"owner": {"reputation": 267, "user_id": 4998931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/522504466/picture?type=large", "display_name": "Michael Vaysman", "link": "https://stackoverflow.com/users/4998931/michael-vaysman"}, "reply_to_user": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "edited": false, "score": 0, "creation_date": 1441179261, "post_id": 32346812, "comment_id": 52567949, "body": "My IDE is uKeil 5. Some of errors: ..\\bglib\\cmd_def.h(846): error:  #20: identifier &quot;pack&quot; is undefined   PACKSTRUCT(struct ble_msg_system_reset_cmd_t ..\\bglib\\cmd_def.h(846): error:  #18: expected a &quot;)&quot;   PACKSTRUCT(struct ble_msg_system_reset_cmd_t ..\\bglib\\cmd_def.h(846): error:  #79: expected a type specifier"}, {"owner": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "edited": false, "score": 0, "creation_date": 1441181807, "post_id": 32346812, "comment_id": 52569471, "body": "The IDE is not the same thing as the compiler. In my answer, I assumed you&#39;re using Keil&#39;s armcc. Is that correct?"}, {"owner": {"reputation": 267, "user_id": 4998931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/522504466/picture?type=large", "display_name": "Michael Vaysman", "link": "https://stackoverflow.com/users/4998931/michael-vaysman"}, "reply_to_user": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "edited": false, "score": 0, "creation_date": 1441184356, "post_id": 32346812, "comment_id": 52571014, "body": "@Pinetwig Oh, sorry!! You are right, it&#39;s armcc!"}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 4998931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/522504466/picture?type=large", "display_name": "Michael Vaysman", "link": "https://stackoverflow.com/users/4998931/michael-vaysman"}, "edited": false, "score": 0, "creation_date": 1441185798, "post_id": 32347903, "comment_id": 52571928, "body": "After reading the links that you provided, I see that armcc supports the gnucc packing too... After adding of arm based PACKSTRUCT, I get many other errors: <b><i>1) ..\\bglib\\cmd_def.h(862): error:  #20: identifier &quot;pack&quot; is undefined</i></b> <b><i>2) ..\\bglib\\cmd_def.h(862): error:  #247: function &quot;__pragma&quot; has already been defined</i></b> <b><i>3) ..\\bglib\\cmd_def.h(862): error:  #141-D: unnamed prototyped parameters not allowed when body is present</i></b> What am I doing wrong? Thanks!"}, {"owner": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "reply_to_user": {"reputation": 267, "user_id": 4998931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/522504466/picture?type=large", "display_name": "Michael Vaysman", "link": "https://stackoverflow.com/users/4998931/michael-vaysman"}, "edited": false, "score": 0, "creation_date": 1441187103, "post_id": 32347903, "comment_id": 52572800, "body": "Hmmm, pack and __pragma are the symbols used in the MSVC macro. It seems like these macros are also defined in apitypes.h, which is included before the definition in cmd_def.h (which is bad form - Don&#39;t Repeat Yourself). Try changing the definition there, too!"}, {"owner": {"reputation": 267, "user_id": 4998931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/522504466/picture?type=large", "display_name": "Michael Vaysman", "link": "https://stackoverflow.com/users/4998931/michael-vaysman"}, "edited": false, "score": 0, "creation_date": 1441188083, "post_id": 32347903, "comment_id": 52573494, "body": "Thank you, It really helped! Now, I have only 90 errors and 0 warnings! :) Each error is about non-__packed structures in __packed structures. What should be done to fix those errors? May be I should to define all structures as __packed?"}, {"owner": {"reputation": 267, "user_id": 4998931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/522504466/picture?type=large", "display_name": "Michael Vaysman", "link": "https://stackoverflow.com/users/4998931/michael-vaysman"}, "edited": false, "score": 0, "creation_date": 1441258160, "post_id": 32347903, "comment_id": 52607069, "body": "Everything all right now! I added _packed before each structure that contains another structure and commented the PUCKSTRUCT. Now - 0 errors, 0 wornings :)"}], "tags": [], "owner": {"reputation": 603, "user_id": 4738637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTwAk.jpg?s=128&g=1", "display_name": "Pinetwig", "link": "https://stackoverflow.com/users/4738637/pinetwig"}, "is_accepted": true, "score": 2, "last_activity_date": 1441181605, "creation_date": 1441181605, "answer_id": 32347903, "question_id": 32346812, "link": "https://stackoverflow.com/questions/32346812/conditionally-using-packed-struct-with-armcc-packstruct-in-bglib/32347903#32347903", "title": "Conditionally using packed struct with armcc (PACKSTRUCT in BGLib)", "body": "<p>Yes, packed structs affect how the struct is stored in memory, which is often used as a quick-and-dirty way of converting structs to binary data.</p>\n\n<p>The PACKSTRUCT macro isn't written for the keil armcc compiler. To fix this, we must first find how we can identify when armcc is used. On <a href=\"http://www.keil.com/support/man/docs/armcc/armcc_pge1397113341080.htm\" rel=\"nofollow\">this page</a>, we can see that armcc provides the define __ARMCC_VERSION, which we can use.</p>\n\n<p>Now, how do we declare a packed struct using armcc? <a href=\"http://www.keil.com/support/man/docs/armcc/armcc_pge1397114178466.htm\" rel=\"nofollow\">Here</a>, we see that we should use the __packed qualifier:</p>\n\n<pre><code>/* Compability */\n#ifndef PACKSTRUCT\n    #ifdef PACKED\n        #define PACKSTRUCT(a) a PACKED \n    #else\n/*Default packed configuration*/\n        #ifdef __GNUC__\n            #ifdef _WIN32\n                #define PACKSTRUCT( decl ) decl __attribute__((__packed__,gcc_struct))\n            #else\n                #define PACKSTRUCT( decl ) decl __attribute__((__packed__))\n            #endif\n            #define ALIGNED __attribute__((aligned(0x4)))\n        #else   // not __GNUC__\n            #ifdef __ARMCC_VERSION\n                #define PACKSTRUCT( decl ) __packed decl\n                #define ALIGNED\n            #else // Assume msvc\n                #define PACKSTRUCT( decl ) __pragma( pack(push, 1) ) decl __pragma( pack(pop) )\n                #define ALIGNED\n            #endif\n        #endif\n    #endif\n#endif\n</code></pre>\n"}], "owner": {"reputation": 267, "user_id": 4998931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/522504466/picture?type=large", "display_name": "Michael Vaysman", "link": "https://stackoverflow.com/users/4998931/michael-vaysman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 32347903, "answer_count": 1, "score": 1, "last_activity_date": 1441191932, "creation_date": 1441178233, "last_edit_date": 1441191932, "question_id": 32346812, "link": "https://stackoverflow.com/questions/32346812/conditionally-using-packed-struct-with-armcc-packstruct-in-bglib", "title": "Conditionally using packed struct with armcc (PACKSTRUCT in BGLib)", "body": "<p>I try to make work the BLE121LR module with an external MCU (EFM32).\nAs I can understand, this piece of code declares converting of the struct to binary data, am I right?\nCan somebody explain me how to add the ARM (EFM32) support for it?\nThanks a lot!!</p>\n\n<p>Code:</p>\n\n<pre><code>/* Compability */\n#ifndef PACKSTRUCT\n    #ifdef PACKED\n        #define PACKSTRUCT(a) a PACKED \n    #else\n/*Default packed configuration*/\n        #ifdef __GNUC__\n            #ifdef _WIN32\n                #define PACKSTRUCT( decl ) decl __attribute__((__packed__,gcc_struct))\n            #else\n                #define PACKSTRUCT( decl ) decl __attribute__((__packed__))\n            #endif\n            #define ALIGNED __attribute__((aligned(0x4)))\n        #else //msvc\n            #define PACKSTRUCT( decl ) __pragma( pack(push, 1) ) decl __pragma( pack(pop) )\n            #define ALIGNED\n        #endif\n    #endif\n#endif\n</code></pre>\n"}, {"tags": ["c", "memcpy"], "comments": [{"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 2, "creation_date": 1441175207, "post_id": 32345949, "comment_id": 52565770, "body": "<code>=</code> and <code>memcpy</code> aren&#39;t equivalent in every case (in fact, they usually aren&#39;t)."}, {"owner": {"reputation": 165, "user_id": 1860397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d2da6ef5ff8f5a1db31561ba99adf6?s=128&d=identicon&r=PG", "display_name": "symphonic", "link": "https://stackoverflow.com/users/1860397/symphonic"}, "edited": false, "score": 0, "creation_date": 1441175272, "post_id": 32345949, "comment_id": 52565802, "body": "See this <a href=\"http://stackoverflow.com/questions/4544804/in-what-cases-should-i-use-memcpy-over-standard-operators-in-c\">answer</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2011, "user_id": 5272893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2637f33878f35b750c76ccc428025a32?s=128&d=identicon&r=PG&f=1", "display_name": "serge-sans-paille", "link": "https://stackoverflow.com/users/5272893/serge-sans-paille"}, "is_accepted": true, "score": 2, "last_activity_date": 1441175760, "creation_date": 1441175760, "answer_id": 32346129, "question_id": 32345949, "link": "https://stackoverflow.com/questions/32345949/whats-the-efficiency-difference-between-memcpy-and-equal-sign-in-c/32346129#32346129", "title": "What&#39;s the efficiency difference between memcpy and equal sign in C?", "body": "<p>C != C++... let's assume C case, where you cannot overload the assignment operator.</p>\n\n<p>It's worth having a look to the output of clang for your test case:</p>\n\n<pre><code>struct A { char* name; int value; };\nstruct B { struct A happy[10]; }; \n\nvoid foo() {\n  struct A a1, a2;\n  struct B b1, b2;\n  memcpy(&amp;a1, &amp;a2, sizeof(struct A));\n  b1 = b2;\n}\n</code></pre>\n\n<p>Running the following command makes clang output the LLVM bytecode:</p>\n\n<pre><code>clang -S -emit-llvm foo.c -o -\n</code></pre>\n\n<p>Which outputs</p>\n\n<pre><code>; Function Attrs: nounwind uwtable\ndefine void @foo() #0 {\n  %a1 = alloca %struct.A, align 8\n  %a2 = alloca %struct.A, align 8\n  %b1 = alloca %struct.B, align 8\n  %b2 = alloca %struct.B, align 8\n  %1 = bitcast %struct.A* %a1 to i8*\n  %2 = bitcast %struct.A* %a2 to i8*\n  call void @llvm.memcpy.p0i8.p0i8.i64(i8* %1, i8* %2, i64 16, i32 8, i1 false)\n  %3 = bitcast %struct.B* %b1 to i8*\n  %4 = bitcast %struct.B* %b2 to i8*\n  call void @llvm.memcpy.p0i8.p0i8.i64(i8* %3, i8* %4, i64 160, i32 8, i1 false)\n  ret void\n}\n</code></pre>\n\n<p>The interesting part is that in both case (call to <code>memcpy</code> or assign operator) a call to <code>@llvm.memcpy.p0i8.p0i8.i64</code> is generated!</p>\n"}, {"tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": false, "score": 4, "last_activity_date": 1441175891, "creation_date": 1441175891, "answer_id": 32346168, "question_id": 32345949, "link": "https://stackoverflow.com/questions/32345949/whats-the-efficiency-difference-between-memcpy-and-equal-sign-in-c/32346168#32346168", "title": "What&#39;s the efficiency difference between memcpy and equal sign in C?", "body": "<h2>C++</h2>\n\n<p>In C++ a structure can be plain old data (C types) or complex - requiring construction and copy constructors to be called.</p>\n\n<p>the difference between memcpy and = is that = works.</p>\n\n<p>When = is applied to a complex structure, it copies each of the members following their rules.\nWhen = is applied to a simple structure (plain-old-data or POD) then it does a \"memcpy\".</p>\n\n<h2>C</h2>\n\n<p>In C complex copies were not originally allowed, so some old code would memcpy over using =.  In C they equate to the same operation.</p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 5, "last_activity_date": 1441175959, "creation_date": 1441175959, "answer_id": 32346179, "question_id": 32345949, "link": "https://stackoverflow.com/questions/32345949/whats-the-efficiency-difference-between-memcpy-and-equal-sign-in-c/32346179#32346179", "title": "What&#39;s the efficiency difference between memcpy and equal sign in C?", "body": "<p>Now that the c++ tag has beed removed, we are talking C and not C++.</p>\n\n<p>Assuming <code>a1</code>and <code>a2</code> being variables of the same <code>struct</code> type</p>\n\n<pre><code>memcpy(&amp;a1, &amp;a2, sizeof(struct A));\n</code></pre>\n\n<p>and </p>\n\n<pre><code>a1 = a2;\n</code></pre>\n\n<p>do exactly the same thing.</p>\n\n<p>But it is entirely up to the compiler if the assignement operator <em>actually</em> uses <code>memcpy</code> or not.</p>\n"}], "owner": {"reputation": 1798, "user_id": 4438921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kYGzp.jpg?s=128&g=1", "display_name": "linrongbin", "link": "https://stackoverflow.com/users/4438921/linrongbin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "closed_date": 1441176131, "accepted_answer_id": 32346129, "answer_count": 3, "score": 2, "last_activity_date": 1441175959, "creation_date": 1441175040, "last_edit_date": 1441175262, "question_id": 32345949, "link": "https://stackoverflow.com/questions/32345949/whats-the-efficiency-difference-between-memcpy-and-equal-sign-in-c", "closed_reason": "Duplicate", "title": "What&#39;s the efficiency difference between memcpy and equal sign in C?", "body": "<p>I often use memcpy to copy a struct in C/C++.\nI see someone use equal sign directly copy struct in C/C++.\nFor example:</p>\n\n<pre><code>struct A { char* name; int value; };\nstruct B { struct A happy[10]; }; \n\nstruct A a1, a2;\nstruct B b1, b2;\nmemcpy(&amp;a1, &amp;a2, sizeof(struct A));\nb1 = b2;\n</code></pre>\n\n<p>What's the efficiency difference between memcpy and equal sign ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1441174996, "post_id": 32345924, "comment_id": 52565688, "body": "Always check the return value of <code>fopen</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1441194848, "post_id": 32345924, "comment_id": 52577791, "body": "Also <code>while (i != EOF)</code> is weak.  <code>i</code> could have the value of <code>1</code> and then<code>printf(&quot;b = %f &amp; %d \\n&quot;, b, i);</code> is undefined behavior.  Better to do <code>while (i == 4)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 5291168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af9c7b541ce73d7dcda666ca715e2ad?s=128&d=identicon&r=PG&f=1", "display_name": "Koobz866", "link": "https://stackoverflow.com/users/5291168/koobz866"}, "is_accepted": false, "score": 4, "last_activity_date": 1441176337, "last_edit_date": 1441176337, "creation_date": 1441175378, "answer_id": 32346036, "question_id": 32345924, "link": "https://stackoverflow.com/questions/32345924/c-reading-double-values-from-text-file/32346036#32346036", "title": "C, Reading double values from text file", "body": "<p>Figured it out, the <code>%f</code> in <code>fscanf</code> should be <code>%lf</code></p>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 3, "last_activity_date": 1441176388, "last_edit_date": 1441176388, "creation_date": 1441175575, "answer_id": 32346084, "question_id": 32345924, "link": "https://stackoverflow.com/questions/32345924/c-reading-double-values-from-text-file/32346084#32346084", "title": "C, Reading double values from text file", "body": "<p>Change the specifier to <code>%lf</code> in <code>fsacnf</code> and <code>printf</code> statements. Like this -</p>\n\n<pre><code>fscanf(inp,\"%lf %lf %lf %lf\", &amp;a, &amp;b, &amp;c, &amp;d);\n</code></pre>\n\n<p>Other problems -</p>\n\n<p>1.Also <code>i</code> is declared as <code>double</code> but in <code>printf</code> you print it with specifier <code>%d</code> ,so you pass wrong argument -</p>\n\n<pre><code>printf(\"a = %f &amp; %d \\n\", a, i); // similar in all printf's \n</code></pre>\n\n<p>So according to me  declare <code>i</code> as <code>int</code> and then print it.</p>\n\n<p>2.Also you should always check return of <code>fopen</code> so check it.</p>\n"}], "owner": {"reputation": 71, "user_id": 5291168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af9c7b541ce73d7dcda666ca715e2ad?s=128&d=identicon&r=PG&f=1", "display_name": "Koobz866", "link": "https://stackoverflow.com/users/5291168/koobz866"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10785, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1441176388, "creation_date": 1441174947, "question_id": 32345924, "link": "https://stackoverflow.com/questions/32345924/c-reading-double-values-from-text-file", "title": "C, Reading double values from text file", "body": "<p>Hi just getting some weird outputs from trying to read the inputs as double values in C. This issue does not occur when the inputs are integers is there anyway to make it work with double?</p>\n\n<pre><code>    #include \"stdafx.h\"\n    int main(void)\n    {\n        double a, b, c, d, i;\n        FILE *inp;\n        inp = fopen(\"C:\\\\Users\\\\student\\\\Documents\\\\Visual Studio2012\\\\Projects\\\\ConsoleApplication3\\\\test.txt\", \"r\");\n        i = fscanf(inp, \"%f %f %f %f\", &amp;a, &amp;b, &amp;c, &amp;d);\n        while (i != EOF)\n        {\n            printf(\"a = %f &amp; %d \\n\", a, i);\n            printf(\"b = %f &amp; %d \\n\", b, i);\n            printf(\"c = %f &amp; %d \\n\", c, i);\n            printf(\"d = %f &amp; %d \\n\", d, i);\n            printf(\"%d \\n\", EOF);\n            i = fscanf(inp, \"%f %f %f %f\", &amp;a, &amp;b, &amp;c, &amp;d);\n        }\n\n        fclose(inp);\n\n\n        return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays", "random"], "comments": [{"owner": {"reputation": 4709, "user_id": 2001149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqsJM.png?s=128&g=1", "display_name": "Santosh A", "link": "https://stackoverflow.com/users/2001149/santosh-a"}, "edited": false, "score": 2, "creation_date": 1441173020, "post_id": 32345418, "comment_id": 52564911, "body": "<code>a[i][j] = GetRand(0, 100);</code> instead of <code>a[i][j] = -1;</code>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1441173190, "post_id": 32345418, "comment_id": 52564979, "body": "I&#39;m not convinced the actual problem and your description of the problem match up here.  You say it &quot;starts at [6][19]&quot;.  I bet that has more to do with the scrollback buffer in your terminal.  Try piping the output through <code>more</code> or <code>less</code>.  The other part appears to be confusion about how to compile and link multiple source files.  Of course, you could just include the code for <code>GetRand</code> in your other source file.  You won&#39;t be able to link these two source files unless <code>main</code> only appears in one of them."}, {"owner": {"reputation": 11, "user_id": 5278385, "user_type": "registered", "profile_image": "https://graph.facebook.com/766028660174124/picture?type=large", "display_name": "Mimic03", "link": "https://stackoverflow.com/users/5278385/mimic03"}, "edited": false, "score": 0, "creation_date": 1441174009, "post_id": 32345418, "comment_id": 52565308, "body": "My bad about the output. So i wrote a[i][j] = GetRand(0, 100); instead of a[i][j] = -1; And now my array has random numbers from 0 to 100, my problem is i need it to have some -1 values.  For example: [2][3]=9 [2][4]=-1 [2][5]=23 [2][6]=-1  and i have no idea how i can achieve that"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1441172940, "creation_date": 1441172940, "answer_id": 32345471, "question_id": 32345418, "link": "https://stackoverflow.com/questions/32345418/fill-a-defined-2d-array-with-random-numbers-in-c-average-max-value/32345471#32345471", "title": "Fill a defined 2D Array with random numbers in C / Average / Max Value", "body": "<p>It's very simple: Just assign the result of your <code>GetRand</code> function to the matrix entry.</p>\n"}], "owner": {"reputation": 11, "user_id": 5278385, "user_type": "registered", "profile_image": "https://graph.facebook.com/766028660174124/picture?type=large", "display_name": "Mimic03", "link": "https://stackoverflow.com/users/5278385/mimic03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5227, "favorite_count": 0, "accepted_answer_id": 32345471, "answer_count": 1, "score": -2, "last_activity_date": 1441197304, "creation_date": 1441172689, "last_edit_date": 1441197304, "question_id": 32345418, "link": "https://stackoverflow.com/questions/32345418/fill-a-defined-2d-array-with-random-numbers-in-c-average-max-value", "title": "Fill a defined 2D Array with random numbers in C / Average / Max Value", "body": "<p>I've created this 2D 21x21 array that has all it's values set to -1. I wrote it to print the address and value and somehow it only starts at [6][19] why?</p>\n\n<p>What i want to do is to replace some of the -1 values with random numbers from 0 to 100 in the same array. I know i need to seed it with srand but i'm having problems connecting the functions since i'm a total beginner in C.</p>\n\n<p>EDIT 1:</p>\n\n<p>Now i can print the whole array and fill it with random numbers. For the -1 values i just assigned directly which for this case its fine.</p>\n\n<p>What i'm trying now is finding the average of all the values and the maximum number, so what i have is:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt; \n\n\nint main()\n{\n\nint a[21][21], i , j;\n\nfor (i = 0; i &lt; 21; i++)\n{\n    for ( j = 0; j &lt; 21; j++)\n    {\n        a[i][j] = GetRand(0, 100);\n        a[7][15] = -1;\n        a[10][6] = -1;\n        a[13][5] = -1;\n        a[15][17] = -1;\n        a[17][17] = -1;\n        a[19][6] = -1;\n        printf(\"%3d\" , a[i][j]);\n    }\n    printf(\"\\n\");\n}\nreturn 0;\n}\n\n\n\n// random seed\nint GetRand(int min, int max);\nint get() {\n int i, r;\nfor (i = 0; i &lt; 21; i++)\n {\nr = GetRand(0, 100);\nprintf(\"Your number is %d \\n\", r);\n }\n return(0);\n }\n\nint GetRand(int min, int max)\n{\nstatic int Init = 0;\nint rc;\n\nif (Init == 0)\n{\nsrand(time(NULL));\nInit = 1;\n}\n\nrc = (rand() % (max - min +1) +min);\n\nreturn (rc);\n}\n\n\n\n// average\n\nint avg()\n\nfloat sum=0.0;\n\nfor(i = 0; i &lt;= 21; i = i + 1) {\n\n\n    for(j = 0; j &lt;= 21; j = j + 1){\n\n\n         sum = sum + a[21][21];\n     }\n\nprintf(\"The the average number is %.2f\\n\", sum/21);\n}\n\n\n\n\n //find maximum of all values    \n\n int *pv = &amp;a[0][0];\n max = min = 0;\n for (i = 1; i &lt; i*j; ++i){\n    if (pv[i] &gt; pv[max])\n        max =i;\n    if (pv[i] &lt; pv[min])\n        min = i;\n}\nprintf(\"The max value is %d in row %d, col %d\\n\", pv[max], max/j, max%j);\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>For the average function the compiler tells me that expected a declaration before i, which is \"float sum=0.0;\" but i haven't been able to fix that yet.</p>\n\n<p>For the finding the max function i'm not sure yet what i'm doing there, i just have a vague idea of how it's done...am i going in the right direction?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "opengl-es-2.0", "hud"], "comments": [{"owner": {"reputation": 1668, "user_id": 5085551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAUCW.jpg?s=128&g=1", "display_name": "VB_overflow", "link": "https://stackoverflow.com/users/5085551/vb-overflow"}, "edited": false, "score": 0, "creation_date": 1441727699, "post_id": 32345164, "comment_id": 52786395, "body": "What is the GPU on your platform (PowerVr, Adreno, Mali, Nvidia Tegra ...) ? Also what is the resolution ?"}, {"owner": {"reputation": 1151, "user_id": 868707, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d6908f049c52e111e2143f768b152d19?s=128&d=identicon&r=PG", "display_name": "ReX357", "link": "https://stackoverflow.com/users/868707/rex357"}, "reply_to_user": {"reputation": 1668, "user_id": 5085551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAUCW.jpg?s=128&g=1", "display_name": "VB_overflow", "link": "https://stackoverflow.com/users/5085551/vb-overflow"}, "edited": false, "score": 0, "creation_date": 1441727838, "post_id": 32345164, "comment_id": 52786493, "body": "@VB_overflow Vivante GPU / Freescale iMX6 board. Resolution is 1920x1080."}], "answers": [{"comments": [{"owner": {"reputation": 1151, "user_id": 868707, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d6908f049c52e111e2143f768b152d19?s=128&d=identicon&r=PG", "display_name": "ReX357", "link": "https://stackoverflow.com/users/868707/rex357"}, "edited": false, "score": 0, "creation_date": 1441812135, "post_id": 32475227, "comment_id": 52827850, "body": "Thank you this is a very detailed answer. I was able to get my fps backup to 48fps by removing a lot of glDisable &amp; glEnable calls that were happening and were not necessary. The gpu seems to sync at 30, 48 and 60fps. One avenue I wanna try to explore is there is no KMS support on the kernel I currently use and therefore zero copy isnt implemented which could save a lot of memcpy calls. But nice work, bounty awarded!"}, {"owner": {"reputation": 1668, "user_id": 5085551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAUCW.jpg?s=128&g=1", "display_name": "VB_overflow", "link": "https://stackoverflow.com/users/5085551/vb-overflow"}, "reply_to_user": {"reputation": 1151, "user_id": 868707, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d6908f049c52e111e2143f768b152d19?s=128&d=identicon&r=PG", "display_name": "ReX357", "link": "https://stackoverflow.com/users/868707/rex357"}, "edited": false, "score": 0, "creation_date": 1441879834, "post_id": 32475227, "comment_id": 52857547, "body": "Thank you ! An additional note : if you are GPU bound because of the fullscreen transparent quad for texts then, at some point, whatever cpu side optimization you add you will get no more fps improvement, and then the only solution will be to separate this big quad in sub quads fitting the text zones or reduce resolution. You can easily test if you are GPU bound  because of blending by switching your quad to be opaque instead of transparent or by reducing resolution, if you gain fps by doing this then you are GPU bound."}], "tags": [], "owner": {"reputation": 1668, "user_id": 5085551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAUCW.jpg?s=128&g=1", "display_name": "VB_overflow", "link": "https://stackoverflow.com/users/5085551/vb-overflow"}, "is_accepted": true, "score": 3, "last_activity_date": 1441789154, "creation_date": 1441789154, "answer_id": 32475227, "question_id": 32345164, "link": "https://stackoverflow.com/questions/32345164/opengl-es-2-0-cairo-hud/32475227#32475227", "title": "OpenGL ES 2.0 + Cairo: HUD", "body": "<p>On mobile devices GPUs are very sensitive to blending, this for multiple reasons :</p>\n\n<ul>\n<li>Blending consumes more bandwidth (need to read current pixel to mix it with new one)</li>\n<li>Blending can break hidden surface removal optimizations</li>\n<li>Blending can also break tile based defered rendering optimizations</li>\n</ul>\n\n<p>So in short <em>mobile GPUs love opaque polygons and hate transparent ones</em>. </p>\n\n<p>Note that <em>the total surface occupied by transparent polygons on screen is also very important</em> due to the \"tile based\" nature of most mobile GPUs (when a tile/bin is covered by transparent polygons you can lose some GPU optimizations for it).</p>\n\n<p>Also, since you say you get a sharp drop from 60fps to 30fps, I would conclude that your device GPU is blocking, waiting for the screen 60Hz vertical sync to swap, so this means that your frame DT can only be multiples of 16ms, so you probably only can get fps values like : 60, 30, 15, 7.5, ...</p>\n\n<p>So if you were at 60fps, but add something in your app main loop which would drop the <em>theorical</em> fps to only 57fps, then because of the vertical sync wait, you will abruptly go to 30fps. VSync can be disabled, or techniques like triple buffering can be used to mitigate this, but with OpenGLES the way of doing this is specific to the OS &amp; hardware you are working with ... there is no \"official way of doing it which works on all devices\".</p>\n\n<p>So, knowing all this here are some propositions to get back to 60fps :</p>\n\n<ol>\n<li>Use a reduced resolution, ex: 1280x720 instead of 1920x1080, this will reduce bandwith usage &amp; fragment processing. Not ideal of course, but this could be used as a test to confirm that you have a bandwith or fragment issue (if you get 60fps back after reducing resolution, then you have this kind of issue)</li>\n<li>Use 16bit (R5G6B5) backbuffer instead of 32bits backbuffer (R8G8B8A8), this can reduce bandwith usage, but with some visual quality loss</li>\n<li>Reduce area of blended surfaces: in your case this would mean that you should organize your texts by \"blocks\", each block fitting as much as possible the text like in this picture from IOS <a href=\"https://developer.apple.com/library/ios/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Performance/Performance.html\" rel=\"nofollow noreferrer\">docs</a> :<a href=\"https://i.stack.imgur.com/oTl2H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oTl2H.png\" alt=\"enter image description here\"></a></li>\n<li>Find a way to disable Vsync on your device / use triple buffering. If you have access to Vivante GPU docs (I do not) this may be described inside.</li>\n</ol>\n\n<p>Point 3 is the best thing to do (this is what was done in most mobile games I worked on), however this will need some non negligible extra work. Points 1, 2 and 3 are more straightforward but are only \"half solutions\".</p>\n"}], "owner": {"reputation": 1151, "user_id": 868707, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d6908f049c52e111e2143f768b152d19?s=128&d=identicon&r=PG", "display_name": "ReX357", "link": "https://stackoverflow.com/users/868707/rex357"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 32475227, "answer_count": 1, "score": 6, "last_activity_date": 1441794623, "creation_date": 1441171313, "last_edit_date": 1441794623, "question_id": 32345164, "link": "https://stackoverflow.com/questions/32345164/opengl-es-2-0-cairo-hud", "title": "OpenGL ES 2.0 + Cairo: HUD", "body": "<p>I am trying to render a HUD over an OpenGL ES 2.0 application written in C on an ARM Linux platform.</p>\n\n<p>I am currently using 2 triangles positioned close to the near clipping plane and tiling the texture onto them. The texture is the size of the screen and is mostly transparent except for the parts where I have text rendered. The texture is generated using Pango/Cairo </p>\n\n<p>If I turn on the HUD (uncommenting the call to render_ui), I currently take a 50% performance hit (Goes from 60fps to 30fps).</p>\n\n<p>Here is the code to render the HUD:</p>\n\n<pre><code>void render_ui(OGL_STATE_T *state) {\n\n    glUseProgram(state-&gt;uiHandle);\n\n    matIdentity(modelViewMatrix);\n    matTranslate(modelViewMatrix, 0, 0, -0.51);\n\n    const GLfloat *mvMat2 = modelViewMatrix;\n\n    glViewport(0,0,state-&gt;screen_width, state-&gt;screen_height);\n\n    glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA);\n    glEnable(GL_BLEND);\n\n    glBindBuffer(GL_ARRAY_BUFFER, state-&gt;uiVB);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, state-&gt;uiIB);\n\n    glActiveTexture(GL_TEXTURE0);\n    glBindTexture(GL_TEXTURE_2D, state-&gt;uiTex);\n    glUniform1i(_uiTexUniform, 0);\n\n    glUniformMatrix4fv(_uiProjectionUniform, 1, 0, pMat);\n    glUniformMatrix4fv(_uiModelViewUniform, 1, 0, mvMat2);\n\n    glVertexAttribPointer(_uiPositionSlot, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), 0); \n    glVertexAttribPointer(_uiColorSlot, 4, GL_FLOAT, GL_FALSE, sizeof(Vertex),\n            (GLvoid *) (sizeof(GLfloat) * 3));\n    glVertexAttribPointer(_uiTexCoordSlot, 2, GL_FLOAT, GL_FALSE, sizeof(Vertex),\n            (GLvoid *) (sizeof(GLfloat) * 7));\n\n    glEnableVertexAttribArray(_uiPositionSlot);\n    glEnableVertexAttribArray(_uiColorSlot);\n    glEnableVertexAttribArray(_uiTexCoordSlot);\n\n    glDrawElements(GL_TRIANGLES, uiIndicesArraySize / uiIndicesElementSize,\n            GL_UNSIGNED_BYTE, 0);   \n\n    glDisableVertexAttribArray(_uiTexCoordSlot);\n    glDisable(GL_BLEND);\n\n    GLenum err;\n\n    if ((err = glGetError()) != GL_NO_ERROR)\n        printf(\"There was an error\");\n}\n</code></pre>\n\n<p>There has to be a more sensible way of doing this.</p>\n"}, {"tags": ["c", "linux", "fork", "copy-on-write"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1441171288, "post_id": 32345110, "comment_id": 52564262, "body": "The processes <b>do</b> have distinct <b>virtual</b> address spaces. Look here: <a href=\"http://stackoverflow.com/questions/5365580/fork-same-memory-addresses\" title=\"fork same memory addresses\">stackoverflow.com/questions/5365580/fork-same-memory-address&zwnj;&#8203;es</a>"}, {"owner": {"reputation": 43, "user_id": 5290983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3876c54d6a76cadda3f02cae5a9cc4fd?s=128&d=identicon&r=PG&f=1", "display_name": "Setian", "link": "https://stackoverflow.com/users/5290983/setian"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1441172608, "post_id": 32345110, "comment_id": 52564729, "body": "Thx! teacher. Now I&#39;ve known it&#39;s a virtual address, then, Are there no way that demonstrate COPY ON WRITE? At least, I wanna see different physical address between parents and child"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1441173214, "post_id": 32345110, "comment_id": 52564985, "body": "Maybe you find something useful for finding out the physical address here: <a href=\"http://stackoverflow.com/questions/2440385/how-to-find-the-physical-address-of-a-variable-from-user-space-in-linux\" title=\"how to find the physical address of a variable from user space in linux\">stackoverflow.com/questions/2440385/&hellip;</a>"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1441173286, "post_id": 32345110, "comment_id": 52565015, "body": "BTW, these are all resources from the internet, they&#39;re publicly available. First search, then ask."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1441259540, "post_id": 32345110, "comment_id": 52607636, "body": "Sorry, edit your question and put the observed behaviour (program output) and the expected one.  I have tried your program and it works perfectly, showing the different virtual address spaces and the different stack pointers in parent and child.  Perhaps you misinterpreted the program output.  Also, the copying of stack segments is not the same as the COPY ON WRITE feature.  What do you exactly want to know?"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1441403970, "post_id": 32346841, "comment_id": 52682423, "body": "I&#39;d say at least with the last the 3rd part of your answer you are on the wrong trail."}], "tags": [], "owner": {"reputation": 19, "user_id": 2248810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2dbed17794c07eb646239adf4127d2?s=128&d=identicon&r=PG", "display_name": "gaurav", "link": "https://stackoverflow.com/users/2248810/gaurav"}, "is_accepted": false, "score": -1, "last_activity_date": 1485764548, "last_edit_date": 1485764548, "creation_date": 1441178340, "answer_id": 32346841, "question_id": 32345110, "link": "https://stackoverflow.com/questions/32345110/how-can-i-demonstrate-copy-on-write-in-fork-linux/32346841#32346841", "title": "how can I demonstrate COPY ON WRITE in fork(), linux", "body": "<p>Pointer and variables are duplicated for the forked process.\nIn the kernel, fork is actually implemented by a clone system call. This clone interfaces effectively provides a level of abstraction in how the Linux kernel can create processes.</p>\n\n<p>clone allows you to explicitly specify which parts of the new process are copied into the new process, and which parts are shared between the two processes. \nThis means the parent and child share the same memory, which includes program code and data.\nthe memory is actually shared, rather than copied, between the two processes when fork is called.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 2, "last_activity_date": 1441266336, "last_edit_date": 1441266336, "creation_date": 1441265719, "answer_id": 32369599, "question_id": 32345110, "link": "https://stackoverflow.com/questions/32345110/how-can-i-demonstrate-copy-on-write-in-fork-linux/32369599#32369599", "title": "how can I demonstrate COPY ON WRITE in fork(), linux", "body": "<p>To illustrate the <em>copy on write</em> feature, I have just developed the following code snippet:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; // for system()\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt; // for execl(), fork()\n#include &lt;wait.h&gt;       // for wait()\n\n#define D(x) __FILE__\":%d:%s: \" x, __LINE__, __func__\n#define PAGESIZE    4096U\n#define NPAGES      100000U\n\n/* auxiliary routines to do time accounting */\nt_start(struct timespec *t)\n{\n    clock_gettime(CLOCK_REALTIME, t);\n} /* t_start */\n\nt_print(struct timespec *t)\n{\n    struct timespec now;\n\n    clock_gettime(CLOCK_REALTIME, &amp;now); /* stop */\n    now.tv_nsec -= t-&gt;tv_nsec;\n    now.tv_sec -= t-&gt;tv_sec;\n    if (now.tv_nsec &lt; 0) {\n        now.tv_nsec += 1000000000L;\n        now.tv_sec--;\n    } /* if */\n    printf(D(\"elapsed: %d.%09d\\n\"),\n           now.tv_sec, now.tv_nsec);\n} /* t_print */\n\nvoid testv(\n        struct timespec *t,\n        char *b,\n        size_t bs,\n        const char *fmt,\n        va_list p)\n{\n    int i;\n    static char c = 0;\n    vprintf(fmt, p);\n    t_start(t);\n    for (i = 0; i &lt; bs; i += PAGESIZE)\n        b[i] = c;\n    c++;\n    t_print(t);\n} /* testv */\n\nvoid test(struct timespec *t,\n        char *b,\n        size_t bs,\n        const char *fmt,\n        ...)\n{\n    va_list p;\n    va_start(p, fmt);\n    testv(t, b, bs, fmt, p);\n    va_end(p);\n} /* test */\n\nint main(int argc, char *argv[])\n{   \n    static char buffer[NPAGES*PAGESIZE];\n    struct timespec ts;\n    int i, res;\n\n    test(&amp;ts, buffer, sizeof buffer,\n            D(\"The first test (expect high time--page allocating)\\n\"));\n    test(&amp;ts, buffer, sizeof buffer,\n            D(\"The second test (expect low time)\\n\"));\n\n    switch(res = fork()) { \n    case -1:\n        fprintf(stderr,\n                D(\"Cannot fork: %s(errno=%d)\\n\"),\n                strerror(errno), errno);\n        exit(EXIT_FAILURE);\n    case 0: /* child */\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"child[%d]: third test (expect high time--copy on write)\\n\"),\n                getpid());\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"child[%d]: fourth test (expect low time)\\n\"),\n                getpid());\n        exit(EXIT_SUCCESS);\n    default: /* parent */\n        printf(D(\"parent[%d]: waiting for child[%d] to finish\\n\"),\n                getpid(), res);\n        wait(NULL); /* expect so the calls don't get intermixed */\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"parent[%d]: third test (expect medium time--swapping)\\n\"),\n                getpid());\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"parent[%d]: third test (expect low time)\\n\"),\n                getpid());\n        exit(EXIT_SUCCESS);\n    } /* if */\n    /*NOTREACHED*/\n} /* main */\n</code></pre>\n\n<p>I'll try to explain the code now:</p>\n\n<ul>\n<li>first some functions are prepared to do some timestamping and allow to calculate times from the code execution.  <code>t_start()</code> just starts a timer and <code>t_print()</code> takes a second timestamp and prints de difference time between last <code>t_start()</code> and now.</li>\n<li><code>test()</code> does some test.  It measures the time to write the whole buffer (in jumps of one page to make it run as fast as possible, to show the page faults that happen on it)</li>\n<li><code>main()</code> does some tests before <code>fork()</code>ing, as we want to assure all buffer pages exist and are allocated before forking.  We shall see also that the initial time to get all pages in core memory is on the same order as child needs to do the copy on write (well, 50% more in the child)</li>\n<li><code>main()</code> <code>fork()</code>s a child and waits for it to execute.  I could have done the test in the reverse, but the parent can <code>wait()</code> for the child, but not in the opposite.</li>\n<li>then, both, parent and child do some tests, showing that the child has to go 50% further to wait for the copy on write thing to happen.</li>\n</ul>\n\n<p>The program results are here:</p>\n\n<pre><code>$ time pru\npru.c:70:main: The first test (expect high time--page allocating)\npru.c:30:t_print: elapsed: 0.126230771\npru.c:72:main: The second test (expect low time)\npru.c:30:t_print: elapsed: 0.002087815\npru.c:82:main: child[4392]: third test (expect high time--copy on write)\npru.c:30:t_print: elapsed: 0.152463844\npru.c:85:main: child[4392]: fourth test (expect low time)\npru.c:30:t_print: elapsed: 0.001906929\npru.c:70:main: The first test (expect high time--page allocating)\npru.c:30:t_print: elapsed: 0.126230771\npru.c:72:main: The second test (expect low time)\npru.c:30:t_print: elapsed: 0.002087815\npru.c:89:main: parent[4390]: waiting for child[4392] to finish\npru.c:93:main: parent[4390]: third test (expect medium time--swapping)\npru.c:30:t_print: elapsed: 0.046004906\npru.c:96:main: parent[4390]: third test (expect low time)\npru.c:30:t_print: elapsed: 0.001905371\n0m0.35s real     0m0.05s user     0m0.30s system\n</code></pre>\n\n<p>As you can see, almost 90% the time is system time, time the system has had to page in.</p>\n\n<p>All the tests have been made in a i5/8Gb mem/Debian 64bit, so, as the memory requirements for parent and child was the whole memory (1000000 pages of 4K makes 4Gb per process) the timing for swap in is justified.</p>\n\n<p>on the other side, I have modified the program to measure the time in the <code>fork()</code> showing:</p>\n\n<pre><code>$ pru\npru.c:70:main: pid=4786: The first test (expect high time--page allocating)\npru.c:30:t_print: pid=4786: elapsed: 0.128644899\npru.c:73:main: pid=4786: The second test (expect low time)\npru.c:30:t_print: pid=4786: elapsed: 0.001815846\npru.c:85:main: child[4788]: fork time:\npru.c:30:t_print: pid=4788: elapsed: 0.003451545\npru.c:88:main: child[4788]: third test (expect high time--copy on write)\npru.c:30:t_print: pid=4788: elapsed: 0.151911675\npru.c:91:main: child[4788]: fourth test (expect low time)\npru.c:30:t_print: pid=4788: elapsed: 0.001831539\npru.c:70:main: pid=4786: The first test (expect high time--page allocating)\npru.c:30:t_print: pid=4786: elapsed: 0.128644899\npru.c:73:main: pid=4786: The second test (expect low time)\npru.c:30:t_print: pid=4786: elapsed: 0.001815846\npru.c:95:main: parent[4786]: fork time:\npru.c:30:t_print: pid=4786: elapsed: 0.003405556\npru.c:97:main: parent[4786]: waiting for child[4788] to finish\npru.c:101:main: parent[4786]: third test (expect medium time--swapping)\npru.c:30:t_print: pid=4786: elapsed: 0.046373034\npru.c:104:main: parent[4786]: third test (expect low time)\npru.c:30:t_print: pid=4786: elapsed: 0.001782398\n</code></pre>\n\n<p>As you can see, fork times (in the parent or in the child) are by far too low compared with the time to do the copy (on writing the pages).</p>\n\n<p>Following is the final code with <code>fork()</code> timestamping:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; // for system()\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt; // for execl(), fork()\n#include &lt;wait.h&gt;       // for wait()\n\n#define D(x) __FILE__\":%d:%s: \" x, __LINE__, __func__\n#define PAGESIZE    4096U\n#define NPAGES      100000U\n\n/* auxiliary routines to do time accounting */\nt_start(struct timespec *t)\n{\n    clock_gettime(CLOCK_REALTIME, t);\n} /* t_start */\n\nt_print(struct timespec *t)\n{\n    struct timespec now;\n\n    clock_gettime(CLOCK_REALTIME, &amp;now); /* stop */\n    now.tv_nsec -= t-&gt;tv_nsec;\n    now.tv_sec -= t-&gt;tv_sec;\n    if (now.tv_nsec &lt; 0) {\n        now.tv_nsec += 1000000000L;\n        now.tv_sec--;\n    } /* if */\n    printf(D(\"pid=%d: elapsed: %d.%09d\\n\"),\n           getpid(), now.tv_sec, now.tv_nsec);\n} /* t_print */\n\nvoid testv(\n        struct timespec *t,\n        char *b,\n        size_t bs,\n        const char *fmt,\n        va_list p)\n{\n    int i;\n    static char c = 0;\n    vprintf(fmt, p);\n    t_start(t);\n    for (i = 0; i &lt; bs; i += PAGESIZE)\n        b[i] = c;\n    c++;\n    t_print(t);\n} /* testv */\n\nvoid test(struct timespec *t,\n        char *b,\n        size_t bs,\n        const char *fmt,\n        ...)\n{\n    va_list p;\n    va_start(p, fmt);\n    testv(t, b, bs, fmt, p);\n    va_end(p);\n} /* test */\n\nint main(int argc, char *argv[])\n{   \n    static char buffer[NPAGES*PAGESIZE];\n    struct timespec ts;\n    int i, res, pid = getpid();\n\n    test(&amp;ts, buffer, sizeof buffer,\n            D(\"pid=%d: The first test (expect high time--page allocating)\\n\"),\n            pid);\n    test(&amp;ts, buffer, sizeof buffer,\n            D(\"pid=%d: The second test (expect low time)\\n\"),\n            pid);\n\n    t_start(&amp;ts);\n    switch(res = fork()) { \n    case -1:\n        fprintf(stderr,\n                D(\"Cannot fork: %s(errno=%d)\\n\"),\n                strerror(errno), errno);\n        exit(EXIT_FAILURE);\n    case 0: /* child */\n        pid = getpid();\n        printf(D(\"child[%d]: fork time:\\n\"), pid);\n        t_print(&amp;ts);\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"child[%d]: third test (expect high time--copy on write)\\n\"),\n                getpid());\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"child[%d]: fourth test (expect low time)\\n\"),\n                getpid());\n        exit(EXIT_SUCCESS);\n    default: /* parent */\n        printf(D(\"parent[%d]: fork time:\\n\"), pid);\n        t_print(&amp;ts);\n        printf(D(\"parent[%d]: waiting for child[%d] to finish\\n\"),\n                getpid(), res);\n        wait(NULL); /* expect so the calls don't get intermixed */\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"parent[%d]: third test (expect medium time--swapping)\\n\"),\n                getpid());\n        test(&amp;ts, buffer, sizeof buffer,\n                D(\"parent[%d]: third test (expect low time)\\n\"),\n                getpid());\n        exit(EXIT_SUCCESS);\n    } /* switch */\n    /*NOTREACHED*/\n} /* main */\n</code></pre>\n\n<h2>NOTE</h2>\n\n<p>In the output appears the first part of the output twice (one in the parent and one in the child process)  As <code>printf()</code> works by buffering (and I have filtered output to <code>sed -e 's/^/    /'</code> to include the four spaces required to paste the output here as a code snippet, and the contents of the buffered output have not been flushed out at <code>fork()</code>'s time, it appears in both outputs, the parent's and the child's.  I have included it to show that the data segments of both, parent and child, <strong>are exactly equal</strong>, including <code>&lt;stdio.h&gt;</code> internal structures like non-flushed output.  A <code>fflush(stdout);</code> or <code>fflush(NULL);</code> before <code>fork()</code> solves this problem, making it only appear once.</p>\n"}], "owner": {"reputation": 43, "user_id": 5290983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3876c54d6a76cadda3f02cae5a9cc4fd?s=128&d=identicon&r=PG&f=1", "display_name": "Setian", "link": "https://stackoverflow.com/users/5290983/setian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "closed_date": 1441404052, "answer_count": 2, "score": 1, "last_activity_date": 1485764548, "creation_date": 1441170973, "question_id": 32345110, "link": "https://stackoverflow.com/questions/32345110/how-can-i-demonstrate-copy-on-write-in-fork-linux", "closed_reason": "Duplicate", "title": "how can I demonstrate COPY ON WRITE in fork(), linux", "body": "<p>According to COW mechanism, pages in the parent's region are not copied to the child's region until write. so I made this code\nPlz see this code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; // for system()\n#include &lt;unistd.h&gt; // for execl(), fork()\n#include &lt;wait.h&gt;       // for wait()\nint main(int argc, char *argv[]) {   \n    int pid, i;               /* fork another process */ \n    char *ptr = \"ptr\";\n    char *b = ptr;\n    printf(\"%s , %p, %p\\n \" , b, b, &amp;b); \n    pid = fork();\n\n    if(pid &lt; 0) {             /* error occurred */    \n            fprintf(stderr,\"Fork Failed\");    \n            exit(-1);   \n    }   \n    else if (pid== 0) {           /* child process */\n            printf(\"it should be same with parent : %s , %p, %p\\n \" , b, b, &amp;b); \n            b = \"hello\";\n            printf(\"it might be differ : %s , %p, %p\\n \" , b, b, &amp;b); \n    }   \n    else {    \n            wait(NULL);    \n            printf(\"parent : %s , %p, %p\\n \" , b, b, &amp;b); \n            exit(0);   \n    }   \n}\n</code></pre>\n\n<p>I thought child process's stack use different address space from parent's one when I wrote something ( b = \"hello\"), but address of 'b' are same both parent's and child's. \nwhy are they same? </p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 4709, "user_id": 2001149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqsJM.png?s=128&g=1", "display_name": "Santosh A", "link": "https://stackoverflow.com/users/2001149/santosh-a"}, "edited": false, "score": 0, "creation_date": 1441170930, "post_id": 32345053, "comment_id": 52564112, "body": "Can you show the <code>caller</code> function of <code>toUpper</code> ?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 7, "creation_date": 1441170945, "post_id": 32345053, "comment_id": 52564120, "body": "Show us the calling code. Did you pass a string literal as a paramater? Modifiying string literals is undefined behavior."}, {"owner": {"reputation": 2470, "user_id": 1905854, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a1fc2596592b749bdc2a520ab5118c92?s=128&d=identicon&r=PG", "display_name": "B. Nadolson", "link": "https://stackoverflow.com/users/1905854/b-nadolson"}, "edited": false, "score": 0, "creation_date": 1441171286, "post_id": 32345053, "comment_id": 52564260, "body": "Suggestion: #include &lt;ctype.h&gt; and use isalpha(&#39;a&#39;).  Don&#39;t write roll your own functions when there are standard C functions that already do this."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "reply_to_user": {"reputation": 2470, "user_id": 1905854, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a1fc2596592b749bdc2a520ab5118c92?s=128&d=identicon&r=PG", "display_name": "B. Nadolson", "link": "https://stackoverflow.com/users/1905854/b-nadolson"}, "edited": false, "score": 1, "creation_date": 1441171775, "post_id": 32345053, "comment_id": 52564450, "body": "@B.Nadolson seems he wants to roll his own"}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1441171901, "post_id": 32345053, "comment_id": 52564495, "body": "You should also do some basic defensive programming steps in your function e.g. checking whether <code>s !=NULL</code> and some max length since you are writing to the argument."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1441172889, "post_id": 32345053, "comment_id": 52564846, "body": "I likewise suspect a read-only literal. If it is tossing a seg-fault, it will be trivial to run in a debugger, letting the bullets spray in above the shoulder area, and check the call-stack and local vars once the event takes place. Short of that, old-school debug output to a console is darn near as effective. Either way, more research is required on <i>your</i> part."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1441173013, "post_id": 32345053, "comment_id": 52564908, "body": "Stop passing non-modifiable data,  replace the if with <code>if (*s&gt;=&#39;a&#39; &amp;&amp; *s&lt;=&#39;z&#39;)</code>, and change <code>+=</code> to <code>-=</code>."}, {"owner": {"reputation": 3, "user_id": 4678071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc3e0c737e30d08671cea47551e6b29?s=128&d=identicon&r=PG&f=1", "display_name": "MathDude857", "link": "https://stackoverflow.com/users/4678071/mathdude857"}, "edited": false, "score": 0, "creation_date": 1441173153, "post_id": 32345053, "comment_id": 52564958, "body": "Thanks for the feedback guys. Here&#39;s my calling sequence:  char *s = &quot;Hello&quot;;      toUpper(s);"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1441175843, "post_id": 32345053, "comment_id": 52566079, "body": "@MattJohnson That&#39;s the bug then. Please read the linked duplicate."}], "answers": [{"tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 3, "last_activity_date": 1441176377, "last_edit_date": 1495540684, "creation_date": 1441173391, "answer_id": 32345579, "question_id": 32345053, "link": "https://stackoverflow.com/questions/32345053/segmentation-error-for-implementation-of-toupper-in-c/32345579#32345579", "title": "Segmentation Error for Implementation of toUpper() in C", "body": "<pre><code>char *s = \"Hello\";\n</code></pre>\n\n<p>String literals are non-modifiable. By an accident of history they are compatible with <code>char*</code>. Hence the runtime error that you encountered. If you enable warnings your compiler will tell you that you are making a mistake here. </p>\n\n<p>More information here: <a href=\"https://stackoverflow.com/questions/4493139/are-string-literals-const\">Are string literals const?</a></p>\n\n<p>Pass a modifiable string instead:</p>\n\n<pre><code>char s[] = \"Hello\";\ntoUpper(s);\n</code></pre>\n\n<p>Then you'll need to fix the bugs in your function. The body of the loop should read:</p>\n\n<pre><code>if (*s &gt;= 'a' &amp;&amp; *s &lt;= 'z')\n    *s -= ('a' - 'A');\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4678071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc3e0c737e30d08671cea47551e6b29?s=128&d=identicon&r=PG&f=1", "display_name": "MathDude857", "link": "https://stackoverflow.com/users/4678071/mathdude857"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "closed_date": 1441175820, "accepted_answer_id": 32345579, "answer_count": 1, "score": -1, "last_activity_date": 1441176377, "creation_date": 1441170757, "last_edit_date": 1441173628, "question_id": 32345053, "link": "https://stackoverflow.com/questions/32345053/segmentation-error-for-implementation-of-toupper-in-c", "closed_reason": "Duplicate", "title": "Segmentation Error for Implementation of toUpper() in C", "body": "<p>I am attempting my own implementation of the <code>toupper()</code> function in C; my function should work for strings of any length. I am not sure why my compiler is throwing a segmentation error when I attempt to change the contents of the string as seen below. Is there any way around this error? (I have tried using arrays as opposed to pointers, but to no avail.) <strong>Note: <code>isLetter()</code> is a function I wrote that determines whether a character is an alphabetical character.</strong> </p>\n\n<pre><code>void toUpper(char *s){\nwhile(*s != '\\0'){\n    if(isLetter(*s)&amp;&amp;(*s&gt; 90)){     \n        *s += ('a' - 'A');\n    }\n    s++;\n}\n</code></pre>\n\n<p>I call the function like this:</p>\n\n<pre><code>char *s = \"Hello\";\ntoUpper(s); \n</code></pre>\n"}]